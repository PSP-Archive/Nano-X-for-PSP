cscope 15 $HOME/work/microwindows-0.91/src               0003521766
	@contrib/GPL/tpcal/tpcal.c

19 
	~<°dio.h
>

20 
	~<î∫o.h
>

21 
	~<°dlib.h
>

22 
	~<time.h
>

23 
	~<°rög.h
>

24 
	~"wödows.h
"

25 
	~"mou_ç.h
"

26 
	~"å™sf‹m.h
"

28 
	gxext
, 
	gyext
;

29 
CALIBRATION_PAIRS
 
	g˝s
;

30 
CALIBRATION_PAIR
* 
	gp˝
 = 0;

32 
	$DøwAbout
(
HDC
 
hdc
, 
RECT
 
r
)

34 c⁄° 
vî_maj‹
 = 0;

35 c⁄° 
vî_mö‹
 = 5;

36 c⁄° 
≠p_«me
[] = "Touch Panel Calibrator";

37 c⁄° 
tôÀ
[] = "%s, version %d.%d";

38 c⁄° 
c›yright
[] = "(C) 1999 Bradley D. LaRonde <brad@ltc.com>";

39 c⁄° 
w¨ø¡y
[] = "ABSOLUTELY NO WARRANTY";

40 c⁄° 
li˚n£1
[] = "This is free software,ánd youáre welcomeÅo";

41 c⁄° 
li˚n£2
[] = "redistribute it under certain conditions.";

43 c⁄° 
Àadög
 = 15;

45 
s
[1024];

47 
	`•rötf
(
s
, 
tôÀ
, 
≠p_«me
, 
vî_maj‹
, 
vî_mö‹
);

48 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

49 
	`DøwText
(
hdc
, 
s
, -1, &
r
, 
DT_CENTER
);

51 
r
.
t›
 +
Àadög
;

52 
	`DøwText
(
hdc
, 
c›yright
, -1, &
r
, 
DT_CENTER
);

54 
r
.
t›
 +
Àadög
;

55 
	`DøwText
(
hdc
, 
w¨ø¡y
, -1, &
r
, 
DT_CENTER
);

57 
r
.
t›
 +
Àadög
;

58 
	`DøwText
(
hdc
, 
li˚n£1
, -1, &
r
, 
DT_CENTER
);

59 
r
.
t›
 +
Àadög
;

60 
	`DøwText
(
hdc
, 
li˚n£2
, -1, &
r
, 
DT_CENTER
);

61 
	}
}

63 
	$DøwD⁄e
(
HDC
 
hdc
, 
RECT
 
r
)

65 c⁄° 
d⁄emsg
[] = "Calibration is done!";

66 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

67 
	`DøwText
(
hdc
, 
d⁄emsg
, -1, &
r
, 
DT_CENTER
);

68 
	}
}

71 
	$DøwT¨gë
(
HDC
 
hdc
, 
POINT
 
p
)

73 c⁄° 
sˇÀ
 = 9;

74 c⁄° 
˚¡î
 = 3;

82 
	`Re˘™gÀ
(
hdc
, 
p
.
x
 - 
˚¡î
,Ö.
y
 - center,Ö.x + center + 1,Ö.y + center + 1);

85 
	`MoveToEx
(
hdc
, 
p
.
x
 - 
sˇÀ
,Ö.
y
, 
NULL
);

86 
	`LöeTo
(
hdc
, 
p
.
x
 + 
sˇÀ
 + 1,Ö.
y
);

88 
	`MoveToEx
(
hdc
, 
p
.
x
,Ö.
y
 - 
sˇÀ
, 
NULL
);

89 
	`LöeTo
(
hdc
, 
p
.
x
,Ö.
y
 + 
sˇÀ
 + 1);

90 
	}
}

92 
	$DøwLabñAlign
(
HDC
 
hdc
, 
POINT
 
p
, 
LPCSTR
 
psz
, 
Æign
)

94 
RECT
 
r
;

95 c⁄° 
w
 = 180;

96 c⁄° 
h
 = 14;

97 c⁄° 
m
 = 15;

99 
Æign
)

103 
r
.
À·
 = 
p
.
x
 + 
m
;

104 
r
.
right
 = 
p
.
x
 + 
w
 + 
m
;

105 
r
.
t›
 = 
p
.
y
 - (
h
/2);

106 
r
.
bŸtom
 = 
p
.
y
 + (
h
/2);

111 
r
.
À·
 = 
p
.
x
 - (
w
 + 
m
);

112 
r
.
right
 = 
p
.
x
 - 
m
;

113 
r
.
t›
 = 
p
.
y
 - (
h
/2);

114 
r
.
bŸtom
 = 
p
.
y
 + (
h
/2);

119 
r
.
À·
 = 
p
.
x
 - (
w
/2);

120 
r
.
right
 = 
p
.
x
 + (
w
/2);

121 
r
.
t›
 = 
p
.
y
 + 
m
;

122 
r
.
bŸtom
 = 
p
.
y
 + 
m
 + 
h
;

127 
r
.
À·
 = 
p
.
x
;

128 
r
.
right
 = 
p
.
x
 + 
w
;

129 
r
.
t›
 = 
p
.
y
;

130 
r
.
bŸtom
 = 
p
.
y
 + 
h
;

134 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

135 
	`DøwText
(
hdc
, 
psz
, -1, &
r
, 
DT_LEFT
);

136 
	}
}

138 
	$DøwLabñ
(
HDC
 
hdc
, 
POINT
 
p
, 
LPCSTR
 
psz
)

140 i‡–
p
.
x
 < (
xext
 * 1 / 4) )

141  
	`DøwLabñAlign
(
hdc
, 
p
, 
psz
, 1);

143 i‡–
p
.
x
 > (
xext
 * 3 / 4) )

144  
	`DøwLabñAlign
(
hdc
, 
p
, 
psz
, 2);

146  
	`DøwLabñAlign
(
hdc
, 
p
, 
psz
, 3);

147 
	}
}

149 
POINT
 
	$GëT¨gë
(
n
)

151 c⁄° 
ö£t
 = 10;

152 
POINT
 
p
;

154 
n
)

157 
p
.
x
 = 
xext
 / 2;Ö.
y
 = 
yext
 / 2;

158 
p˝
 = &
˝s
.
˚¡î
;

162 
p
.
x
 = 
ö£t
;Ö.
y
 = inset;

163 
p˝
 = &
˝s
.
ul
;

167 
p
.
x
 = 
xext
 - 
ö£t
;Ö.
y
 = inset;

168 
p˝
 = &
˝s
.
ur
;

172 
p
.
x
 = 
xext
 - 
ö£t
;Ö.
y
 = 
yext
 - inset;

173 
p˝
 = &
˝s
.
Ã
;

177 
p
.
x
 = 
ö£t
;Ö.
y
 = 
yext
 - inset;

178 
p˝
 = &
˝s
.
Œ
;

183 
p
.
x
 = 
	`øndom
(Ë/ (
RAND_MAX
 / 
xext
);

184 
p
.
y
 = 
	`øndom
(Ë/ (
RAND_MAX
 / 
yext
);

185 
p˝
 = 0;

189  
p
;

190 
	}
}

192 
	gtŸÆ_èrgës
 = 5;

193 
	gcuºít_èrgë
 = 0;

194 
POINT
 
	gcuºít_èrgë_loˇti⁄
;

196 
	$DoPaöt
(
HDC
 
hdc
)

198 c⁄° 
szIn°ru˘i⁄s
[] = "PleaseÅouchÅhe center ofÅheÅarget.";

200 
POINT
 
p
;

201 
i
, 
n
;

202 
ﬁd_r›
;

203 
POINT
 
œ°
 = 
cuºít_èrgë_loˇti⁄
;

204 
HPEN
 
hOldPí
;

206 i‡(
cuºít_èrgë
 =
tŸÆ_èrgës
) {

207 
RECT
 
r
 = {10, 
yext
/2, 
xext
 - 10, yext/2 + 40};

208 
	`DøwD⁄e
(
hdc
, 
r
);

212 i‡(
cuºít_èrgë
 == 0)

214 
RECT
 
r
 = {10, 
yext
 - 85, 
xext
 - 10, yext - 10};

215 
	`DøwAbout
(
hdc
, 
r
);

218 
cuºít_èrgë_loˇti⁄
 = 
	`GëT¨gë
(
cuºít_èrgë
);

220 
ﬁd_r›
 = 
	`SëROP2
(
hdc
, 
R2_XORPEN
);

221 
hOldPí
 = 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_PEN
));

223 
n
 = 20;

224 
i
=0; i < 
n
; i++)

226 
p
.
x
 = 
œ°
.x + ((
cuºít_èrgë_loˇti⁄
.x -Üa°.xË* 
i
 / 
n
);

227 
p
.
y
 = 
œ°
.y + ((
cuºít_èrgë_loˇti⁄
.y -Üa°.yË* 
i
 / 
n
);

228 
	`DøwT¨gë
(
hdc
, 
p
);

229 
	`SÀï
(60);

230 
	`DøwT¨gë
(
hdc
, 
p
);

234 
	`SëROP2
(
hdc
, 
R2_COPYPEN
);

235 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
BLACK_PEN
));

237 
	`DøwT¨gë
(
hdc
, 
cuºít_èrgë_loˇti⁄
);

238 
	`DøwLabñ
(
hdc
, 
cuºít_èrgë_loˇti⁄
, 
szIn°ru˘i⁄s
);

241 
	`SëROP2
(
hdc
, 
ﬁd_r›
);

242 
	`Sñe˘Obje˘
(
hdc
, 
hOldPí
);

243 
	}
}

245 
	#GET_X_LPARAM
(
Õ
Ë(()()
	`LOWORD
÷p))

	)

246 
	#GET_Y_LPARAM
(
Õ
Ë(()()
	`HIWORD
÷p))

	)

248 
LRESULT
 
CALLBACK
 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

250 
PAINTSTRUCT
 
ps
;

251 
HDC
 
hdc
;

253 
msg
) {

254 
WM_PAINT
:

255 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

256 
	`DoPaöt
(
hdc
);

257 
	`EndPaöt
(
hwnd
, &
ps
);

260 
WM_NCHITTEST
:

261  
HTCLIENT
;

263 
WM_LBUTTONUP
:

264 i‡–
p˝
 != 0 )

266 
p˝
->
s¸ìn
.
x
 = 
cuºít_èrgë_loˇti⁄
.x * 
TRANSFORMATION_UNITS_PER_PIXEL
;

267 
p˝
->
s¸ìn
.
y
 = 
cuºít_èrgë_loˇti⁄
.y * 
TRANSFORMATION_UNITS_PER_PIXEL
;

268 
p˝
->
devi˚
.
x
 = 
	`GET_X_LPARAM
(
Õ
);

269 
p˝
->
devi˚
.
y
 = 
	`GET_Y_LPARAM
(
Õ
);

272 i‡–++
cuºít_èrgë
 =
tŸÆ_èrgës
 )

274 
TRANSFORMATION_COEFFICIENTS
 
tc
;

276 
	`CÆcTønsf‹m©i⁄C€fficõ¡sSim∂e
(&
˝s
, &
tc
);

277 
	`¥ötf
("%d %d %d %d %d %d %d\n",

278 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

279 
	`CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(&
˝s
, &
tc
);

280 
	`¥ötf
("%d %d %d %d %d %d %d\n",

281 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

282 
	`CÆcTønsf‹m©i⁄C€fficõ¡sEvíBëãr
(&
˝s
, &
tc
);

283 
	`¥ötf
("%d %d %d %d %d %d %d\n",

284 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

286 
	`CÆcTønsf‹m©i⁄C€fficõ¡sBe°
(&
˝s
, &
tc
);

287 
	`¥ötf
("%d %d %d %d %d %d %d\n",

288 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

289 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

290 
	`Upd©eWödow
(
hwnd
);

291 
	`Po°QuôMesßge
(0);

294 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

295 
	`Upd©eWödow
(
hwnd
);

299  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

303 
	}
}

305 
WINAPI
 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
, 
nShowCmd
)

307 
WNDCLASS
 
wc
;

308 
RECT
 
r
;

309 
HWND
 
hwnd
;

310 
MSG
 
msg
;

311 
MWCOORD
 
big
;

313 
	`§™dom
(
	`time
(
NULL
));

317 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

318 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

319 
wc
.
cbClsExåa
 = 0;

320 
wc
.
cbWndExåa
 = 0;

321 
wc
.
hIn°™˚
 = 0;

322 
wc
.
hIc⁄
 = 0;

323 
wc
.
hCurs‹
 = 0;

324 
wc
.
hbrBackground
 = (
HBRUSH
)
	`GëStockObje˘
(
WHITE_BRUSH
);

325 
wc
.
ÕszMíuName
 = 
NULL
;

326 
wc
.
ÕszCœssName
 = "tpcal";

327 
	`Regi°îCœss
(&
wc
);

329 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
r
);

330 
xext
 = 
r
.
right
;

331 
yext
 = 
r
.
bŸtom
;

333 
hwnd
 = 
	`Cª©eWödowEx
(0L, "tpcal", "Touch Panel Calibration",

334 
WS_VISIBLE
, 0, 0, 
xext
, 
yext
,

335 
NULL
, (
HMENU
)1, NULL, NULL);

338 
big
 = 1000000;

339 
	`GdRe°ri˘Mou£
(-
big
, -big, big, big);

342 
	`SëC≠tuª
(
hwnd
);

344 
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

345 
	`Tøn¶©eMesßge
(&
msg
);

346 
	`Di•©chMesßge
(&
msg
);

350 
	}
}

352 
	gíabÀ_poötög_co‹dö©e_å™sf‹m
;

354 
	$MwU£rInô
(
ac
, ** 
av
)

356 
íabÀ_poötög_co‹dö©e_å™sf‹m
 = 0;

358 i‡–
ac
 > 1 )

359 
tŸÆ_èrgës
 = 
	`©ﬁ
(
av
[1]);

362 
	}
}

	@contrib/GPL/tpcal/transform.c

20 
	~"wödows.h
"

21 
	~"mou_ç.h
"

22 
	~"å™sf‹m.h
"

24 
	$CÆcTønsf‹m©i⁄C€fficõ¡sSim∂e
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
)

32 
mö_s¸ìn_x
 = 
p˝
->
ul
.
s¸ìn
.
x
;

33 
mö_s¸ìn_y
 = 
p˝
->
ul
.
s¸ìn
.
y
;

34 
max_s¸ìn_x
 = 
p˝
->
Ã
.
s¸ìn
.
x
;

35 
max_s¸ìn_y
 = 
p˝
->
Ã
.
s¸ìn
.
y
;

37 
mö_devi˚_x
 = 
p˝
->
ul
.
devi˚
.
x
;

38 
mö_devi˚_y
 = 
p˝
->
ul
.
devi˚
.
y
;

39 
max_devi˚_x
 = 
p˝
->
Ã
.
devi˚
.
x
;

40 
max_devi˚_y
 = 
p˝
->
Ã
.
devi˚
.
y
;

42 
±c
->
s
 = (1 << 16);

43 
±c
->
a
 =Ötc->
s
 * (
mö_s¸ìn_x
 - 
max_s¸ìn_x
Ë/ (
mö_devi˚_x
 - 
max_devi˚_x
);

44 
±c
->
b
 = 0;

45 
±c
->
c
 = (±c->
a
 * -
mö_devi˚_x
Ë+ (±c->
s
 * 
mö_s¸ìn_x
);

46 
±c
->
d
 = 0;

47 
±c
->
e
 =Ötc->
s
 * (
mö_s¸ìn_y
 - 
max_s¸ìn_y
Ë/ (
mö_devi˚_y
 - 
max_devi˚_y
);

48 
±c
->
f
 = (±c->
e
 * -
mö_devi˚_y
Ë+ (±c->
s
 * 
mö_s¸ìn_y
);

51 
	}
}

53 
	$CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
)

62 
ve˘‹
[3][2] =

64 {
p˝
->
ul
.
s¸ìn
.
x
,Ö˝->ul.s¸ìn.
y
},

65 {
p˝
->
ur
.
s¸ìn
.
x
,Ö˝->ur.s¸ìn.
y
},

66 {
p˝
->
Ã
.
s¸ìn
.
x
,Ö˝->Ã.s¸ìn.
y
}

69 
m©rix
[3][3] =

71 {
p˝
->
ul
.
devi˚
.
x
,Ö˝->ul.devi˚.
y
, 1.0},

72 {
p˝
->
ur
.
devi˚
.
x
,Ö˝->ur.devi˚.
y
, 1.0},

73 {
p˝
->
Ã
.
devi˚
.
x
,Ö˝->Ã.devi˚.
y
, 1.0}

76 
i
, 
j
, 
r
, 
k
;

77 
p
, 
q
;

79 
i
 = 0; i < 3; i++) {

80 
p
 = 
m©rix
[
i
][i];

82 
j
 = 0; j < 3; j++) {

83 
m©rix
[
i
][
j
] = m©rix[i][j] / 
p
;

86 
j
 = 0; j < 2; j++) {

87 
ve˘‹
[
i
][
j
] = ve˘‹[i][j] / 
p
;

90 
r
 = 0;Ñ < 3;Ñ++) {

91 i‡(
r
 !
i
) {

92 
q
 = 
m©rix
[
r
][
i
];

94 
m©rix
[
r
][
i
] = 0.0;

96 
k
 = 
i
 + 1; k < 3; k++) {

97 
m©rix
[
r
][
k
] = m©rix[r][k] - (
q
 * m©rix[
i
][k]);

100 
k
 = 0; k < 2; k++) {

101 
ve˘‹
[
r
][
k
] = ve˘‹[r][k] - (
q
 * ve˘‹[
i
][k]);

107 
±c
->
s
 = 1 << 16;

108 
±c
->
a
 = 
ve˘‹
[0][0] *Ötc->
s
;

109 
±c
->
b
 = 
ve˘‹
[1][0] *Ötc->
s
;

110 
±c
->
c
 = 
ve˘‹
[2][0] *Ötc->
s
;

111 
±c
->
d
 = 
ve˘‹
[0][1] *Ötc->
s
;

112 
±c
->
e
 = 
ve˘‹
[1][1] *Ötc->
s
;

113 
±c
->
f
 = 
ve˘‹
[2][1] *Ötc->
s
;

116 
	}
}

118 
	$CÆcTønsf‹m©i⁄C€fficõ¡sEvíBëãr
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
)

124 
ve˘‹
[4][2] =

126 {
p˝
->
ul
.
s¸ìn
.
x
,Ö˝->ul.s¸ìn.
y
},

127 {
p˝
->
ur
.
s¸ìn
.
x
,Ö˝->ur.s¸ìn.
y
},

128 {
p˝
->
Ã
.
s¸ìn
.
x
,Ö˝->Ã.s¸ìn.
y
},

129 {
p˝
->
Œ
.
s¸ìn
.
x
,Ö˝->Œ.s¸ìn.
y
}

132 
m©rix
[4][4] =

134 {
p˝
->
ul
.
devi˚
.
x
,Ö˝->ul.devi˚.x *Ö˝->ul.devi˚.
y
,Öcp->ul.device.y, 1.0},

135 {
p˝
->
ur
.
devi˚
.
x
,Ö˝->ur.devi˚.x *Ö˝->ur.devi˚.
y
,Öcp->ur.device.y, 1.0},

136 {
p˝
->
Ã
.
devi˚
.
x
,Ö˝->Ã.devi˚.x *Ö˝->Ã.devi˚.
y
,Öcp->lr.device.y, 1.0},

137 {
p˝
->
Œ
.
devi˚
.
x
,Ö˝->Œ.devi˚.x *Ö˝->Œ.devi˚.
y
,Öcp->ll.device.y, 1.0}

140 
i
, 
j
, 
r
, 
k
;

141 
p
, 
q
;

143 
i
 = 0; i < 4; i++) {

144 
p
 = 
m©rix
[
i
][i];

146 
j
 = 0; j < 4; j++) {

147 
m©rix
[
i
][
j
] = m©rix[i][j] / 
p
;

150 
j
 = 0; j < 2; j++) {

151 
ve˘‹
[
i
][
j
] = ve˘‹[i][j] / 
p
;

154 
r
 = 0;Ñ < 4;Ñ++) {

155 i‡(
r
 !
i
) {

156 
q
 = 
m©rix
[
r
][
i
];

158 
m©rix
[
r
][
i
] = 0.0;

160 
k
 = 
i
 + 1; k < 4; k++) {

161 
m©rix
[
r
][
k
] = m©rix[r][k] - (
q
 * m©rix[
i
][k]);

164 
k
 = 0; k < 2; k++) {

165 
ve˘‹
[
r
][
k
] = ve˘‹[r][k] - (
q
 * ve˘‹[
i
][k]);

172 
±c
->
s
 = 1 << 16;

173 
±c
->
a
 = 
ve˘‹
[0][0] *Ötc->
s
;

174 
±c
->
b
 = 
ve˘‹
[2][0] *Ötc->
s
;

175 
±c
->
c
 = 
ve˘‹
[3][0] *Ötc->
s
;

176 
±c
->
d
 = 
ve˘‹
[0][1] *Ötc->
s
;

177 
±c
->
e
 = 
ve˘‹
[2][1] *Ötc->
s
;

178 
±c
->
f
 = 
ve˘‹
[3][1] *Ötc->
s
;

181 
	}
}

183 
	$CÆcTønsf‹m©i⁄C€fficõ¡sBe°
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
)

189 c⁄° 
fú°_poöt
 = 0;

190 c⁄° 
œ°_poöt
 = 4;

191 
i
;

193 
Sx
=0, 
Sy
=0, 
Sxy
=0, 
Sx2
=0, 
Sy2
=0, 
Sm
=0, 
Sn
=0, 
Smx
=0, 
Smy
=0, 
Snx
=0, 
Sny
=0, 
S
=0;

194 
t1
, 
t2
, 
t3
, 
t4
, 
t5
, 
t6
, 
q
;

197 
CALIBRATION_PAIR
 *
˝
 = (CALIBRATION_PAIR*)
p˝
;

211 
i
 = 
fú°_poöt
; i < 
œ°_poöt
 + 1; i++) {

212 
Sx
 +
˝
[
i
].
devi˚
.
x
;

213 
Sy
 +
˝
[
i
].
devi˚
.
y
;

214 
Sxy
 +
˝
[
i
].
devi˚
.
x
 * cp[i].devi˚.
y
;

215 
Sx2
 +
˝
[
i
].
devi˚
.
x
 * cp[i].device.x;

216 
Sy2
 +
˝
[
i
].
devi˚
.
y
 * cp[i].device.y;

217 
Sm
 +
˝
[
i
].
s¸ìn
.
x
;

218 
Sn
 +
˝
[
i
].
s¸ìn
.
y
;

219 
Smx
 +
˝
[
i
].
s¸ìn
.
x
 * cp[i].
devi˚
.x;

220 
Smy
 +
˝
[
i
].
s¸ìn
.
x
 * cp[i].
devi˚
.
y
;

221 
Snx
 +
˝
[
i
].
s¸ìn
.
y
 * cp[i].
devi˚
.
x
;

222 
Sny
 +
˝
[
i
].
s¸ìn
.
y
 * cp[i].
devi˚
.y;

223 
S
 += 1;

227 
	`¥ötf
("%f, %f, %f, %f, "

230 
Sx
, 
Sy
, 
Sxy
, 
Sx2
, 
Sy2
, 
Sm
, 
Sn
, 
Smx
, 
Smy
, 
Snx
, 
Sny
, 
S
);

250 
t1
 = 
Sxy
 * 
Sy
 - 
Sx
 * 
Sy2
;

251 
t2
 = 
Sxy
 * 
Sx
 - 
Sx2
 * 
Sy
;

252 
t3
 = 
Sx2
 * 
Sy2
 - 
Sxy
 * Sxy;

253 
t4
 = 
Sy2
 * 
S
 - 
Sy
 * Sy;

254 
t5
 = 
Sx
 * 
Sy
 - 
Sxy
 * 
S
;

255 
t6
 = 
Sx2
 * 
S
 - 
Sx
 * Sx;

257 
q
 = 
t1
 * 
Sx
 + 
t2
 * 
Sy
 + 
t3
 * 
S
;

272 i‡(
q
 == 0)

275 
±c
->
s
 = 1 << 16;

276 
±c
->
a
 = ((
t4
 * 
Smx
 + 
t5
 * 
Smy
 + 
t1
 * 
Sm
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

277 
±c
->
b
 = ((
t5
 * 
Smx
 + 
t6
 * 
Smy
 + 
t2
 * 
Sm
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

278 
±c
->
c
 = ((
t1
 * 
Smx
 + 
t2
 * 
Smy
 + 
t3
 * 
Sm
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

279 
±c
->
d
 = ((
t4
 * 
Snx
 + 
t5
 * 
Sny
 + 
t1
 * 
Sn
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

280 
±c
->
e
 = ((
t5
 * 
Snx
 + 
t6
 * 
Sny
 + 
t2
 * 
Sn
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

281 
±c
->
f
 = ((
t1
 * 
Snx
 + 
t2
 * 
Sny
 + 
t3
 * 
Sn
Ë/ 
q
 + 0.5/65536Ë*Ötc->
s
;

288 i‡–(
±c
->
a
 =0x80000000Ë|| (±c->
b
 == 0x80000000) ||

289 (
±c
->
c
 =0x80000000Ë|| (±c->
d
 == 0x80000000) ||

290 (
±c
->
e
 =0x80000000Ë|| (±c->
f
 == 0x80000000) )

294 
	}
}

	@contrib/GPL/tpcal/transform.h

22 
MWPOINT
 
	ms¸ìn
, 
	mdevi˚
;

23 } 
	tCALIBRATION_PAIR
;

27 
CALIBRATION_PAIR
 
	m˚¡î
;

28 
CALIBRATION_PAIR
 
	mul
;

29 
CALIBRATION_PAIR
 
	mur
;

30 
CALIBRATION_PAIR
 
	mÃ
;

31 
CALIBRATION_PAIR
 
	mŒ
;

32 } 
	tCALIBRATION_PAIRS
;

34 
CÆcTønsf‹m©i⁄C€fficõ¡sSim∂e
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
);

35 
CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
);

36 
CÆcTønsf‹m©i⁄C€fficõ¡sEvíBëãr
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
);

37 
CÆcTønsf‹m©i⁄C€fficõ¡sBe°
(
CALIBRATION_PAIRS
 *
p˝
, 
TRANSFORMATION_COEFFICIENTS
 *
±c
);

	@contrib/ntimers.c

3 
	$GsAddTimî
(
GsTimî
* 
√wtimî
) {

4 
i
;

5 
GsTimî
* 
curTimî
;

6 if(
our_timîs
.
numof
++>0) {

7 
curTimî
=
our_timî
->
hód
;

8 
curTimî
=
our_timî
->
hód
;curTimî!=
NULL
;curTimî=curTimî->
√xt
) {

9 if(
curTimî
->
due
>
√wtimî
->due) {

10 if(
our_timî
->
hód
==
curTimî
) {

11 
√wtimî
->
√xt
=
our_timî
->
hód
;

12 
our_timî
->
hód
=
√wtimî
;

15 
√wtimî
->
√xt
=
curTimî
;

16 
¥evTimî
->
√xt
=
√wtimî
;

19 
¥evTimî
=
curTimî
;

21 
our_timî
->
èû
->
√xt
=
√wtimî
;

22 
our_timî
->
èû
=
√wtimî
;

23 
√wtimî
->
√xt
=
NULL
;

26 
our_timî
->
hód
=
√wtimî
;

27 
our_timî
->
èû
=
√wtimî
;

28 
√wtimî
->
√xt
=
NULL
;

29 
	}
}

	@contrib/ntimers.h

1 #i‚de‡
__NTIMER_H__


2 
	#__NTIMER_H__


	)

4 
	sGsTimî
 {

5 
GsTimî
* 
	m√xt
;

6 
	mdue
;

7 * 
	msome_func
;

8 * 
	msome_¨gs
;

11 
	sGsTimîHﬁdî
 {

12 
GsTimî
* 
	mhód
;

13 
GsTimî
* 
	mèû
;

14 
	mnumof
;

	@contrib/speedtst/speed.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<time.h
>

5 #ifde‡
TEST_FOR_X


6 
	~<X11/Xlib.h
>

8 
	#MWINCLUDECOLORS


	)

9 
	~<mi¸owö/«no-X.h
>

12 
	#NUM_POINTS
 80

	)

14 
time_t
 
	g°¨t_time
, 
	gíd_time
;

16 
	$°¨t_timî
()

18 
	`time
(&
°¨t_time
);

19 
	}
}

21 
	$íd_timî
()

23 
	`time
(&
íd_time
);

24 
	`¥ötf
("start=%lu,Énd=%lu,Åime=%lu\n",

25 
°¨t_time
, 
íd_time
,Énd_time-start_time);

26 
	}
}

28 
	$maö
()

30 #ifde‡
TEST_FOR_X


31 
Di•œy
 *
di•œy
;

32 
Wödow
 
wödow
;

33 
GC
 
gc
;

34 
XGCVÆues
 
gcVÆues
;

35 
Cﬁ‹m≠
 
cﬁ‹m≠
;

36 
Pixm≠
 
§c_pixm≠
;

37 
fgCﬁ‹
, 
bgCﬁ‹
;

38 
s¸ìnNum
;

39 
XPoöt
 
poöts
[
NUM_POINTS
];

41 
GR_WINDOW_ID
 
wödow
;

42 
GR_WINDOW_ID
 
§c_pixm≠
;

43 * 
§c_pixm≠_buf
[320*240*2];

44 
GR_GC_ID
 
gc
;

45 
GR_POINT
 
poöts
[
NUM_POINTS
];

48 
c
, 
c1
, 
cou¡
=4500;

49 
x
, 
y
, 
x1
, 
y1
, 
x2
, 
y2
;

51 #ifde‡
TEST_FOR_X


52 if(!(
di•œy
=
	`XO≥nDi•œy
(""))) {

53 
	`¥ötf
("Cannot connectÅo X.\n");

55 
s¸ìnNum
 = 
	`DeÁu…S¸ìn
(
di•œy
);

56 
cﬁ‹m≠
 = 
	`DeÁu…Cﬁ‹m≠
(
di•œy
, 
s¸ìnNum
);

58 
bgCﬁ‹
 = 
	`BœckPixñ
(
di•œy
, 
s¸ìnNum
);

59 
fgCﬁ‹
 = 
	`WhôePixñ
(
di•œy
, 
s¸ìnNum
);

60 
wödow
 = 
	`XCª©eSim∂eWödow
(
di•œy
, 
	`RoŸWödow
(di•œy, 
s¸ìnNum
),

62 
fgCﬁ‹
, 
bgCﬁ‹
);

63 
§c_pixm≠
 = 
	`XCª©ePixm≠
(
di•œy
, 
wödow
, 320, 240, 16);

64 
	`XM≠Rai£d
(
di•œy
, 
wödow
);

65 
gcVÆues
.
background
 = 
bgCﬁ‹
;

66 
gcVÆues
.
f‹eground
 = 
fgCﬁ‹
;

67 
gcVÆues
.
löe_width
 = 1;

68 
gcVÆues
.
löe_°yÀ
 = 
LöeSﬁid
;

69 
gcVÆues
.
fûl_°yÀ
 = 
FûlSﬁid
;

70 
gcVÆues
.
fûl_ruÀ
 = 
WödögRuÀ
;

71 
gcVÆues
.
¨c_mode
 = 
ArcPõSli˚
;

72 
gc
 = 
	`XCª©eGC
(
di•œy
, 
wödow
,

73 
GCF‹eground
 | 
GCBackground
 | 
GCLöeWidth
 | 
GCLöeStyÀ
 |

74 
GCFûlStyÀ
,

75 &
gcVÆues
);

78 
	`GrO≥n
();

79 
wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 639, 479, 0, 
BLACK
, 
BLUE
);

80 
§c_pixm≠
 = 
	`GrNewPixm≠
(640, 480, 
§c_pixm≠_buf
);

81 
	`GrM≠Wödow
(
wödow
);

82 
gc
 = 
	`GrNewGC
();

83 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

84 
	`GrSëGCBackground
(
gc
, 
BLACK
);

85 
	`GrSëGCMode
(
gc
, 
GR_MODE_COPY
);

94 
	`¥ötf
("Horizontal Line(XDrawLine)\n");

95 
	`°¨t_timî
();

96 
c
=0; c<
cou¡
*20; c++)

98 
y1
=
	`øndom
()%480;

99 #ifde‡
TEST_FOR_X


100 
	`XDøwLöe
(
di•œy
, 
wödow
, 
gc
, 0, 
y1
, 639, y1);

101 
	`XFlush
(
di•œy
);

103 
	`GrLöe
(
wödow
, 
gc
, 0, 
y1
, 639, y1);

104 
	`GrFlush
();

107 
	`íd_timî
();

108 #ifde‡
TEST_FOR_X


109 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

111 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

116 
	`¥ötf
("Vertical Line(XDrawLine)\n");

117 
	`°¨t_timî
();

118 
c
=0; c<
cou¡
*19; c++)

120 
x1
=
	`øndom
()%640;

121 #ifde‡
TEST_FOR_X


122 
	`XDøwLöe
(
di•œy
, 
wödow
, 
gc
, 
x1
, 0, x1, 479);

123 
	`XFlush
(
di•œy
);

125 
	`GrLöe
(
wödow
, 
gc
, 
x1
, 0, x1, 479);

126 
	`GrFlush
();

129 
	`íd_timî
();

130 #ifde‡
TEST_FOR_X


131 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

133 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

138 
	`¥ötf
("General Line(XDrawLine)\n");

139 
	`°¨t_timî
();

140 
c
=0; c<
cou¡
*22; c++)

142 
x1
 = 
	`øndom
()%640;

143 
x2
 = 
	`øndom
()%640;

144 
y1
 = 
	`øndom
()%480;

145 
y2
 = 
	`øndom
()%480;

146 #ifde‡
TEST_FOR_X


147 
	`XDøwLöe
(
di•œy
, 
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

148 
	`XFlush
(
di•œy
);

150 
	`GrLöe
(
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

151 
	`GrFlush
();

154 
	`íd_timî
();

155 #ifde‡
TEST_FOR_X


156 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

158 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

163 
	`¥ötf
("XPoint\n");

164 
	`°¨t_timî
();

165 
c
=0; c<
cou¡
*25; c++)

167 
x1
 = 
	`øndom
()%640;

168 
y1
 = 
	`øndom
()%480;

169 #ifde‡
TEST_FOR_X


170 
	`XDøwPoöt
(
di•œy
, 
wödow
, 
gc
, 
x1
, 
y1
);

171 
	`XFlush
(
di•œy
);

173 
	`GrPoöt
(
wödow
, 
gc
, 
x1
, 
y1
);

174 
	`GrFlush
();

177 
	`íd_timî
();

178 #ifde‡
TEST_FOR_X


179 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

181 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

186 
	`¥ötf
("XRectangle\n");

187 
	`°¨t_timî
();

188 
c
=0; c<
cou¡
*20; c++)

190 
x1
=
	`øndom
()%639;

191 
y1
=
	`øndom
()%479;

192 
x2
=
	`øndom
()%(639-
x1
)+1;

193 
y2
=
	`øndom
()%(479-
y1
)+1;

194 #ifde‡
TEST_FOR_X


195 
	`XDøwRe˘™gÀ
(
di•œy
, 
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

196 
	`XFlush
(
di•œy
);

198 
	`GrRe˘
(
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

199 
	`GrFlush
();

202 
	`íd_timî
();

203 #ifde‡
TEST_FOR_X


204 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

206 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

211 
	`¥ötf
("XFillRectangle\n");

212 
	`°¨t_timî
();

213 
c
=0; c<
cou¡
*18; c++)

215 
x1
=
	`øndom
()%639;

216 
y1
=
	`øndom
()%479;

217 
x2
=
	`øndom
()%(639-
x1
)+1;

218 
y2
=
	`øndom
()%(479-
y1
)+1;

219 #ifde‡
TEST_FOR_X


220 
	`XFûlRe˘™gÀ
(
di•œy
, 
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

221 
	`XFlush
(
di•œy
);

223 
	`GrFûlRe˘
(
wödow
, 
gc
, 
x1
, 
y1
, 
x2
, 
y2
);

224 
	`GrFlush
();

227 
	`íd_timî
();

228 #ifde‡
TEST_FOR_X


230 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

232 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

237 
	`¥ötf
("XFillPolygon\n");

238 
	`°¨t_timî
();

239 
c
=0; c<
cou¡
; c++)

241 
c1
=0; c1<
NUM_POINTS
; c1++)

243 
poöts
[
c1
].
x
 = 
	`øndom
()%640;

244 
poöts
[
c1
].
y
 = 
	`øndom
()%480;

246 #ifde‡
TEST_FOR_X


247 
	`XFûlPﬁyg⁄
(
di•œy
, 
wödow
, 
gc
, 
poöts
, 
NUM_POINTS
,

249 
	`XFlush
(
di•œy
);

251 
	`GrFûlPﬁy
(
wödow
, 
gc
, 
NUM_POINTS
, 
poöts
);

252 
	`GrFlush
();

255 
	`íd_timî
();

256 #ifde‡
TEST_FOR_X


257 
	`XCÀ¨Wödow
(
di•œy
, 
wödow
);

259 
	`GrCÀ¨Wödow
(
wödow
, 
GR_TRUE
);

265 
	`¥ötf
("XCopyArea\n");

266 
	`°¨t_timî
();

267 
c
=0; c<
cou¡
*5; c++)

269 
x1
=
	`øndom
()%320;

270 
y1
=
	`øndom
()%240;

271 
x2
=
	`øndom
()%319+1;

272 
y2
=
	`øndom
()%239+1;

274 #ifde‡
TEST_FOR_X


275 
	`XC›yAªa
(
di•œy
, 
§c_pixm≠
, 
wödow
, 
gc
,

276 0, 0, 
x2
, 
y2
, 
x1
, 
y1
);

277 
	`XFlush
(
di•œy
);

279 
	`GrC›yAªa
(
wödow
, 
gc
, 
x1
, 
y1
, 
x2
 ,
y2
, 
§c_pixm≠
,

281 
	`GrFlush
();

284 
	`íd_timî
();

286 #ifde‡
TEST_FOR_X


287 
	`XDe°royWödow
(
di•œy
, 
wödow
);

289 
	`GrClo£
();

291 
	}
}

	@demos/mwin/assert.c

1 
	~<as£π.h
>

3 #i‡
PSP


4 
	$__as£π
(c⁄° * 
s
, 
n
, c⁄° *
s1
)

6 
	}
}

	@demos/mwin/malpha.c

8 
	~"wödows.h
"

9 
	~"wöã∫.h
"

10 
	~"wötoﬁs.h
"

12 #i‡
PSP


13 
	~<p•kî√l.h
>

14 
	~<p•debug.h
>

17 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

18 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

20 
	#Ârötf
(...)

	)

25 
MWIMAGEHDR
 
image_ˇr8
;

27 
	#APPCLASS
 "ã°"

	)

30 
LRESULT
 
CALLBACK
 
WndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

31 
LRESULT
 
CALLBACK
 
ChûdWndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

34 
	$Regi°îAµCœss
()

36 
WNDCLASS
 
wc
;

38 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

39 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

40 
wc
.
cbClsExåa
 = 0;

41 
wc
.
cbWndExåa
 = 0;

42 
wc
.
hIn°™˚
 = 0;

43 
wc
.
hIc⁄
 = 0;

44 
wc
.
hCurs‹
 = 0;

45 
wc
.
hbrBackground
 = (
HBRUSH
)
	`GëStockObje˘
(
GRAY_BRUSH
);

46 
wc
.
ÕszMíuName
 = 
NULL
;

47 
wc
.
ÕszCœssName
 = 
APPCLASS
;

48 
	`Regi°îCœss
–&
wc
);

51 
	}
}

53 
HWND


54 
	$Cª©eAµWödow
()

56 
HWND
 
hwnd
;

57 
width
, 
height
;

58 
RECT
 
r
;

59 
√xtid
 = 0;

61 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
r
);

62 
width
 = 
height
 = 
r
.
right
 / 2;

64 
hwnd
 = 
	`Cª©eWödowEx
(
WS_EX_LAYERED
, 
APPCLASS
,

66 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

67 
CW_USEDEFAULT
, CW_USEDEFAULT,

68 
width
, 
height
,

69 
NULL
, (
HMENU
)++
√xtid
, NULL, NULL);

71  
hwnd
;

72 
	}
}

74 
LRESULT
 
CALLBACK


75 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

77 
PAINTSTRUCT
 
ps
;

78 
HWND
 
sibwp
;

79 
HDC
 
hdcMem
;

80 
HBITMAP
 
hbmp
, 
hbmpOrg
;

81 
HBRUSH
 
hbr
;

82 
RECT
 
rc
;

83 
mw∑ötSîül
;

85 
msg
) {

86 
WM_ERASEBKGND
:

90 
WM_PAINT
:

101 
mwf‹˚NC∑öt
 = 
TRUE
;

104 ++
hwnd
->
unm≠cou¡
;

105 
	`SídMesßge
(
roŸwp
, 
WM_PAINT
, 0, 0);

106 
sibwp
=
hwnd
->
siblögs
; sibwp; sibwp=sibwp->siblings)

107 
	`SídMesßge
(
sibwp
, 
WM_PAINT
, 0, 0);

108 --
hwnd
->
unm≠cou¡
;

111 
sibwp
=
hwnd
->
∑ª¡
->
chûdªn
; sibwp != hwnd;

112 
sibwp
=sibwp->
siblögs
)

114 if(
sibwp
->
∑ötSîül
 !
mw∑ötSîül
)

115 
	`Po°Mesßge
(
sibwp
, 
WM_PAINT
, 0, 0);

118 
	`BegöPaöt
(
hwnd
, &
ps
);

119 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

122 
hdcMem
 = 
	`Cª©eCom∑tibÀDC
(
ps
.
hdc
);

123 
hbmp
 = 
	`Cª©eCom∑tibÀBôm≠
(
hdcMem
, 
rc
.
right
,Ñc.
bŸtom
);

124 
hbmpOrg
 = 
	`Sñe˘Obje˘
(
hdcMem
, 
hbmp
);

127 
hbr
 = (
HBRUSH
)
	`GëCœssL⁄g
(
hwnd
, 
GCL_HBRBACKGROUND
);

128 
	`FûlRe˘
(
hdcMem
, &
rc
, 
hbr
);

129 
	`Sñe˘Obje˘
(
hdcMem
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

130 
	`SëBkMode
(
hdcMem
, 
TRANSPARENT
);

131 
	#TEXTSTRING
 "Thi†dem⁄°øã†Æph®bÀndög"

	)

132 
	`TextOut
(
hdcMem
, 0, 20, 
TEXTSTRING
, 
	`°æí
(TEXTSTRING));

135 
	`BôB…
(
ps
.
hdc
, 0, 0, 
rc
.
right
,Ñc.
bŸtom
, 
hdcMem
, 0, 0,

136 
MWROP_BLENDCONSTANT
 | 150);

137 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdcMem
, 
hbmpOrg
));

138 
	`DñëeDC
(
hdcMem
);

140 
	`EndPaöt
(
hwnd
, &
ps
);

144  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

147 
	}
}

149 
WINAPI


150 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

151 
nShowCmd
)

153 
MSG
 
msg
;

158 
mwERASEMOVE
 = 
FALSE
;

160 
	`Regi°îAµCœss
();

163 
	`MwSëDeskt›WÆÕ≠î
(&
image_ˇr8
);

165 #i‡
PSP


166 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

172 
	`Upd©eWödow
(
	`GëDeskt›Wödow
());

174 #i‡
PSP


175 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

178 
	`Cª©eAµWödow
();

179 
	`Cª©eAµWödow
();

181 #i‡
PSP


182 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

186  
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

187 #i‡
PSP


188 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

191 
	`Tøn¶©eMesßge
(&
msg
);

192 #i‡
PSP


193 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

196 
	`Di•©chMesßge
(&
msg
);

197 #i‡
PSP


198 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

203 
	}
}

	@demos/mwin/mdemo.c

8 #i‡
PSP


9 
	~<p•kî√l.h
>

10 
	~<p•debug.h
>

13 
	#MWINCLUDECOLORS


	)

14 
	~"wödows.h
"

15 
	~"wöã∫.h
"

17 
	~"devi˚.h
"

19 #i‡
DOS_TURBOC


20 
	g_°kÀn
 = 4096;

23 
	#CLIPDEMO
 0

	)

25 #i‚de‡
ELKS


26 
	#TIMERDEMO
 1

	)

27 
	#GRAPH3D
 0

	)

28 
	#IMAGE
 0

	)

30 
	#ARCDEMO
 1

	)

31 
	#CHILD
 1

	)

32 
	#CLIENT3D
 0

	)

33 
	#USEBLIT
 1

	)

35 #i‡
GRAPH3D


36 
	~"gøph3d.h
"

39 
MWIMAGEHDR
 
image_ˇr8
;

40 
MWIMAGEHDR
 
image_zi⁄208
;

41 
MWIMAGEHDR
 
image_≥nguö
;

42 
MWIMAGEHDR
 
image_undî4
;

43 
MWIMAGEHDR
 
image_mi¸owö
;

44 
MWIMAGEHDR
 
image_cs1
;

45 
MWIMAGEHDR
 
image_æe8
;

47 #i‡
CHILD


48 #i‡
ELKS
 | 
MSDOS


49 
PMWIMAGEHDR
 
	gimage
 = &
image_cs1
;

51 
PMWIMAGEHDR
 
	gimage
 = &
image_≥nguö
;

55 #i‡
IMAGE


56 
PMWIMAGEHDR
 
	gimage2
 = &
image_zi⁄208
;

59 
	#APPCLASS
 "ã°"

	)

60 
	#APPCHILD
 "ã°2"

	)

62 #i‡
PSP


64 
PSP_MODULE_INFO
("MDEMO", 0, 1, 1);

67 
PSP_MAIN_THREAD_ATTR
(
THREAD_ATTR_USER
 | 
THREAD_ATTR_VFPU
);

71 
LRESULT
 
CALLBACK
 
WndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

72 
LRESULT
 
CALLBACK
 
ChûdWndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

75 
	$MwU£rInô
(
ac
, **
av
)

79 
	}
}

82 
	$Regi°îAµCœss
()

84 
WNDCLASS
 
wc
;

86 #i‡(!
ELKS
 && !
PSP
)

87 
	`MwRegi°îBuâ⁄C⁄åﬁ
(
NULL
);

88 
	`MwRegi°îEdôC⁄åﬁ
(
NULL
);

89 
	`MwRegi°îLi°boxC⁄åﬁ
(
NULL
);

90 
	`MwRegi°îProgªssB¨C⁄åﬁ
(
NULL
);

93 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

94 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

95 
wc
.
cbClsExåa
 = 0;

96 
wc
.
cbWndExåa
 = 0;

97 
wc
.
hIn°™˚
 = 0;

98 
wc
.
hIc⁄
 = 0;

99 
wc
.
hCurs‹
 = 0;

100 
wc
.
hbrBackground
 = (
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

101 
wc
.
ÕszMíuName
 = 
NULL
;

102 
wc
.
ÕszCœssName
 = 
APPCLASS
;

103 
	`Regi°îCœss
–&
wc
);

105 #i‡
CHILD


106 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
ChûdWndProc
;

107 
wc
.
ÕszCœssName
 = 
APPCHILD
;

108  
	`Regi°îCœss
–&
wc
);

111 
	}
}

113 
HWND


114 
	$Cª©eAµWödow
()

116 
HWND
 
hwnd
, 
hli°
;

117 
√xtid
 = 1;

118 
width
, 
height
;

119 
RECT
 
r
;

120 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
r
);

121 
width
 = 
height
 = 
r
.
right
 / 2;

123 
hwnd
 = 
	`Cª©eWödowEx
(0L, 
APPCLASS
,

125 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

126 
CW_USEDEFAULT
, CW_USEDEFAULT,

127 
width
, 
height
,

128 
NULL
, (
HMENU
)
√xtid
++, NULL, NULL);

130 #i‡
CHILD


131 if(
hwnd


132 #i‡
GRAPH3D


133 && (
√xtid
 & 03)!=2

136 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

138 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

139 4, 4, 
width
 / 3-6, 
height
 / 3,

140 
hwnd
, (
HMENU
)2, 
NULL
, NULL);

141 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

143 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

144 
width
 / 3, 
height
 / 3, width / 3-6, height / 3,

145 
hwnd
, (
HMENU
)3, 
NULL
, NULL);

146 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

148 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

149 
width
 * 3 / 5, 
height
 * 3 / 5,

150 
width
 * 2 / 3, 
height
 * 2 / 3,

151 
hwnd
, (
HMENU
)4, 
NULL
, NULL);

152 
	`Cª©eWödowEx
(0L, "EDIT",

154 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

155 
width
 * 5 / 8, 10, 100, 18,

156 
hwnd
, (
HMENU
)5, 
NULL
, NULL);

157 
	`Cª©eWödowEx
(0L, "PROGBAR",

159 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

160 
width
 * 5 / 8, 32, 100, 18,

161 
hwnd
, (
HMENU
)6, 
NULL
, NULL);

163 
hli°
 = 
	`Cª©eWödowEx
(0L, "LISTBOX",

165 
WS_HSCROLL
|
WS_VSCROLL
|
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

166 
width
 * 5 / 8, 54, 100, 48,

167 
hwnd
, (
HMENU
)7, 
NULL
, NULL);

168 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Cherry");

169 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Apple");

170 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Orange");

172 
	`Cª©eWödowEx
(0L, "BUTTON",

174 
BS_AUTOCHECKBOX
 | 
WS_CHILD
 | 
WS_VISIBLE
,

175 
width
 * 5 / 8 + 50, 106, 50, 14,

176 
hwnd
, (
HMENU
)8, 
NULL
, NULL);

179  
hwnd
;

180 
	}
}

182 #i‡
CHILD


183 
LRESULT
 
CALLBACK


184 
	$ChûdWndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

186 
RECT
 
rc
;

187 
PAINTSTRUCT
 
ps
;

189 
msg
) {

190 
WM_PAINT
:

191 
	`BegöPaöt
(
hwnd
, &
ps
);

192 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

193 #i‡
USEBLIT


195 
HDC
 
hdcMem
;

196 
HBITMAP
 
hbmp
, 
hbmpOrg
;

199 
hdcMem
 = 
	`Cª©eCom∑tibÀDC
(
ps
.
hdc
);

205 
hbmp
 = 
	`Cª©eCom∑tibÀBôm≠
(
hdcMem
, 
image
->
width
, image->
height
);

206 
hbmpOrg
 = 
	`Sñe˘Obje˘
(
hdcMem
, 
hbmp
);

209 
	`DøwDIB
(
hdcMem
, 0, 0, 
image
);

214 
	`SåëchB…
(
ps
.
hdc
, 0, 0, 
rc
.
right
*4/5,Ñc.
bŸtom
*4/5, 
hdcMem
,

215 0, 0, 
image
->
width
, image->
height
, 
MWROP_SRCCOPY
);

216 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdcMem
, 
hbmpOrg
));

217 
	`DñëeDC
(
hdcMem
);

220 
	`DøwDIB
(
ps
.
hdc
, 
rc
.
À·
,Ñc.
t›
, 
image
);

222 
	`EndPaöt
(
hwnd
, &
ps
);

225  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

228 
	}
}

231 
LRESULT
 
CALLBACK


232 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

234 
PAINTSTRUCT
 
ps
;

235 
HDC
 
hdc
;

236 #i‡
CLIENT3D
 | 
IMAGE
 | 
GRAPH3D


237 
RECT
 
rc
;

239 #i‡
GRAPH3D


240 
cou¡up
 = 1;

241 
id
;

242 
vec1
 
gx
, 
gy
;

244 #i‡
TIMERDEMO


245 
POINT
 
mou£±
;

247 #i‡
ARCDEMO


248 
°¨tdegªes
 = 0;

249 
íddegªes
 = 30;

252  
msg
) {

253 #i‡
TIMERDEMO


254 
WM_CREATE
:

255 
	`SëTimî
(
hwnd
, 1, 100, 
NULL
);

256 
mou£±
.
x
 = 60;

257 
mou£±
.
y
 = 20;

260 
WM_TIMER
:

261 #i‡
GRAPH3D


262 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

263 if(
cou¡up
) {

264 
mou£±
.
y
 += 20;

265 if(
mou£±
.
y
 >
rc
.
bŸtom
) {

266 
mou£±
.
y
 -= 20;

267 
cou¡up
 = 0;

270 
mou£±
.
y
 -= 20;

271 if(
mou£±
.
y
 < 20) {

272 
mou£±
.
y
 += 20;

273 
cou¡up
 = 1;

276 
	`SídMesßge
(
hwnd
, 
WM_MOUSEMOVE
, 0,

277 
	`MAKELONG
(
mou£±
.
x
, mou£±.
y
));

279 #i‡
ARCDEMO


280 
°¨tdegªes
 += 10;

281 if(
°¨tdegªes
 >= 360)

282 
°¨tdegªes
 = 0;

283 
íddegªes
 += 15;

284 if(
íddegªes
 >= 360)

285 
íddegªes
 = 0;

286 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

290 
WM_DESTROY
:

291 
	`KûlTimî
(
hwnd
, 1);

294 
WM_SIZE
:

297 
WM_MOVE
:

300 #i‡
CLIENT3D


301 
WM_SETFOCUS
:

302 
	`Po°Mesßge
((
HWND
)
wp
, 
WM_PAINT
, 0, 0L);

305 
WM_KILLFOCUS
:

306 
	`Po°Mesßge
((
HWND
)
wp
, 
WM_PAINT
, 0, 0L);

308 
WM_ERASEBKGND
:

309 if(
	`GëFocus
(Ë!
hwnd
)

310  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

313 #i‡
GRAPH3D


314 
WM_ERASEBKGND
:

315 if((
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03) == 1)

317  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

319 
WM_PAINT
:

320 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

322 #i‡
CLIENT3D


323 if(
	`GëFocus
(Ë=
hwnd
) {

324 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

325 
	`Døw3dShadow
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

326 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

327 
	`GëSysCﬁ‹
(
COLOR_3DDKSHADOW
),

328 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
));

329 
	`InÊ©eRe˘
(&
rc
, -1, -1);

330 
	`FûlRe˘
(
hdc
, &
rc
, 
	`GëStockObje˘
(
GRAY_BRUSH
));

333 #i‡
IMAGE


334 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

335 
	`DøwDIB
(
hdc
, 
rc
.
À·
+2,Ñc.
t›
+2, 
image2
);

337 #i‡
ARCDEMO


339 
x
, 
y
, 
w
, 
h
;

340 
RECT
 
rc
;

342 if(
hdc
 !
NULL
) {

343 
	`GëWödowRe˘
(
hwnd
, &
rc
);

344 
rc
.
t›
 += 13;

345 
	`InÊ©eRe˘
(&
rc
, -3, -3);

350 
x
 = 
rc
.
À·
;

351 
y
 = 
rc
.
t›
;

352 
w
 = 
rc
.
right
 -Ñc.
À·
;

353 
h
 = 
rc
.
bŸtom
 -Ñc.
t›
;

354 
w
 += 10;

355 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
	`RGB
(0,255,0));

356 
	`GdArcAngÀ
(
hdc
->
psd
, 
x
+
w
/2, 
y
+
h
/2, w/2, h/2, 
°¨tdegªes
*64,

357 
íddegªes
*64, 
MWPIE
);

358 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
	`RGB
(0,0,0));

359 
	`GdArcAngÀ
(
hdc
->
psd
, 
x
+
w
/2, 
y
+
h
/2, w/2, h/2, 
°¨tdegªes
*64,

360 
íddegªes
*64, 
MWARCOUTLINE
);

364 
	`EndPaöt
(
hwnd
, &
ps
);

368 #i‡
GRAPH3D


369 
id
 = ()
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03;

370 
	`öô3
(
hdc
, 
id
 =1? 
hwnd
: 
NULL
);

371 
id
) {

373 
	`ro£
(1.0, 7, 13);

378 
	`look3
(-2 * 
gx
, -2 * 
gy
, 1.2);

379 
	`døwgrid
(-8.0, 8.0, 10, -8.0, 8.0, 10);

382 
	`£tcﬁ‹3
(
BLACK
);

383 
	`cú˛e3
(1.0);

386 
	`£tcﬁ‹3
(
BLUE
);

387 
	`daisy
(1.0, 20);

391 #i‡
CLIPDEMO


392 if(
id
 == 1) {

393 
HRGN
 
hrgn
, 
hrgn2
;

396 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

397 
	`InÊ©eRe˘
(&
rc
, -80, -80);

398 ()
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
)) {

400 
hrgn
 = 
	`Cª©eEŒùticRgnIndúe˘
(&
rc
);

403 
hrgn
 = 
	`Cª©eRoundRe˘Rgn
(
rc
.
À·
,Ñc.
t›
,

404 
rc
.
right
,Ñc.
bŸtom
, 100, 100);

407 
hrgn
 = 
	`Cª©eRe˘RgnIndúe˘
(&
rc
);

412 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

413 
hrgn2
 = 
	`Cª©eRe˘RgnIndúe˘
(&
rc
);

414 
	`Sñe˘ClùRgn
(
hdc
, 
hrgn2
);

415 
	`ExtSñe˘ClùRgn
(
hdc
, 
hrgn
, 
RGN_XOR
);

416 
	`DñëeObje˘
(
hrgn2
);

418 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

419 
	`FûlRe˘
(
hdc
, &
rc
, 
	`GëStockObje˘
(
BLACK_BRUSH
));

422 
	`Sñe˘ClùRgn
(
hdc
, 
hrgn
);

423 
	`DñëeObje˘
(
hrgn
);

427 
	`∑öt3
(
hdc
);

430 
	`EndPaöt
(
hwnd
, &
ps
);

433 
WM_LBUTTONDOWN
:

436 
WM_MOUSEMOVE
:

437 #i‡
GRAPH3D


438 if((
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03) == 1) {

439 
POINT
 
±
;

441 
	`POINTSTOPOINT
(
±
, 
Õ
);

442 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

443 
gx
 = (
vec1
)
±
.
x
 / 
rc
.
right
;

444 
gy
 = (
vec1
)
±
.
y
 / 
rc
.
bŸtom
;

445 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
FALSE
);

446 
mou£±
.
x
 = 
±
.x;

447 
mou£±
.
y
 = 
±
.y;

452 
WM_LBUTTONUP
:

455 
WM_RBUTTONDOWN
:

459  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

462 
	}
}

464 
WINAPI


465 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

466 
nShowCmd
)

468 
MSG
 
msg
;

469 
HWND
 
hwnd
;

470 
RECT
 
rc
;

472 
	`Regi°îAµCœss
();

473 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
rc
);

474 #i‡!(
ELKS
 | 
MSDOS
)

476 
	`Cª©eWödowEx
(0L, 
APPCHILD
, "", 
WS_BORDER
 | 
WS_VISIBLE
,

477 
rc
.
right
-130-1,Ñc.
bŸtom
-153-1, 130, 153,

478 
	`GëDeskt›Wödow
(), (
HMENU
)1000, 
NULL
, NULL);

480 
	`Cª©eAµWödow
();

481 
	`Cª©eAµWödow
();

482 
	`Cª©eAµWödow
();

483 #i‡!(
ELKS
 | 
MSDOS
)

484 
	`Cª©eAµWödow
();

485 
	`Cª©eAµWödow
();

486 
	`Cª©eAµWödow
();

487 
	`Cª©eAµWödow
();

488 
	`Cª©eAµWödow
();

489 
hwnd
 = 
	`Cª©eAµWödow
();

490 
	`GëWödowRe˘
(
hwnd
, &
rc
);

491 
	`Off£tRe˘
(&
rc
, 50, 50);

492 
	`MoveWödow
(
hwnd
, 
rc
.
À·
,Ñc.
t›
,Ñc.
bŸtom
-rc.top,

493 
rc
.
right
-rc.
À·
, 
TRUE
);

495 #i‡!(
ELKS
 | 
MSDOS
)

497 
	`MwSëDeskt›WÆÕ≠î
(&
image_mi¸owö
);

503  
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

504 
	`Tøn¶©eMesßge
(&
msg
);

505 
	`Di•©chMesßge
(&
msg
);

508 
	}
}

	@demos/mwin/mdemo.stretch.c

7 
	#MWINCLUDECOLORS


	)

8 
	~"wödows.h
"

9 
	~"wöã∫.h
"

11 
	~"devi˚.h
"

13 #i‡
DOS_TURBOC


14 
	g_°kÀn
 = 4096;

17 
	#CLIPDEMO
 0

	)

19 #i‚de‡
ELKS


20 
	#TIMERDEMO
 1

	)

21 
	#GRAPH3D
 0

	)

22 
	#IMAGE
 0

	)

24 
	#ARCDEMO
 1

	)

25 
	#CHILD
 1

	)

26 
	#CLIENT3D
 0

	)

28 #i‡
GRAPH3D


29 
	~"gøph3d.h
"

32 
MWIMAGEHDR
 
image_ˇr8
;

33 
MWIMAGEHDR
 
image_zi⁄208
;

34 
MWIMAGEHDR
 
image_≥nguö
;

35 
MWIMAGEHDR
 
image_undî4
;

36 
MWIMAGEHDR
 
image_mi¸owö
;

37 
MWIMAGEHDR
 
image_cs1
;

38 
MWIMAGEHDR
 
image_æe8
;

40 #i‡
CHILD


41 #i‡
ELKS
 | 
MSDOS


42 
PMWIMAGEHDR
 
	gimage
 = &
image_cs1
;

44 
PMWIMAGEHDR
 
	gimage
 = &
image_≥nguö
;

48 #i‡
IMAGE


49 
PMWIMAGEHDR
 
	gimage2
 = &
image_zi⁄208
;

52 
	#APPCLASS
 "ã°"

	)

53 
	#APPCHILD
 "ã°2"

	)

56 
LRESULT
 
CALLBACK
 
WndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

57 
LRESULT
 
CALLBACK
 
ChûdWndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

60 
	$MwU£rInô
(
ac
, **
av
)

64 
	}
}

67 
	$Regi°îAµCœss
()

69 
WNDCLASS
 
wc
;

71 #i‡(!
ELKS
 && !
PSP
)

72 
	`MwRegi°îBuâ⁄C⁄åﬁ
(
NULL
);

73 
	`MwRegi°îEdôC⁄åﬁ
(
NULL
);

74 
	`MwRegi°îLi°boxC⁄åﬁ
(
NULL
);

75 
	`MwRegi°îProgªssB¨C⁄åﬁ
(
NULL
);

78 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

79 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

80 
wc
.
cbClsExåa
 = 0;

81 
wc
.
cbWndExåa
 = 0;

82 
wc
.
hIn°™˚
 = 0;

83 
wc
.
hIc⁄
 = 0;

84 
wc
.
hCurs‹
 = 0;

85 
wc
.
hbrBackground
 = (
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

86 
wc
.
ÕszMíuName
 = 
NULL
;

87 
wc
.
ÕszCœssName
 = 
APPCLASS
;

88 
	`Regi°îCœss
–&
wc
);

90 #i‡
CHILD


91 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
ChûdWndProc
;

92 
wc
.
ÕszCœssName
 = 
APPCHILD
;

93  
	`Regi°îCœss
–&
wc
);

96 
	}
}

98 
HWND


99 
	$Cª©eAµWödow
()

101 
HWND
 
hwnd
, 
hli°
;

102 
√xtid
 = 1;

103 
width
, 
height
;

104 
RECT
 
r
;

105 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
r
);

106 
width
 = 
height
 = 
r
.
right
 / 2;

108 
hwnd
 = 
	`Cª©eWödowEx
(0L, 
APPCLASS
,

110 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

111 
CW_USEDEFAULT
, CW_USEDEFAULT,

112 
width
, 
height
,

113 
NULL
, (
HMENU
)
√xtid
++, NULL, NULL);

115 #i‡
CHILD


116 if(
hwnd


117 #i‡
GRAPH3D


118 && (
√xtid
 & 03)!=2

121 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

123 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

124 4, 4, 
width
 / 3, 
height
 / 3,

125 
hwnd
, (
HMENU
)2, 
NULL
, NULL);

126  
hwnd
;

127 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

129 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

130 
width
 / 3, 
height
 / 3, width / 3, height / 3,

131 
hwnd
, (
HMENU
)3, 
NULL
, NULL);

132 
	`Cª©eWödowEx
(0L, 
APPCHILD
,

134 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

135 
width
 * 3 / 5, 
height
 * 3 / 5,

136 
width
 * 2 / 3, 
height
 * 2 / 3,

137 
hwnd
, (
HMENU
)4, 
NULL
, NULL);

138 
	`Cª©eWödowEx
(0L, "EDIT",

140 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

141 
width
 * 5 / 8, 10, 100, 18,

142 
hwnd
, (
HMENU
)5, 
NULL
, NULL);

143 
	`Cª©eWödowEx
(0L, "PROGBAR",

145 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

146 
width
 * 5 / 8, 32, 100, 18,

147 
hwnd
, (
HMENU
)6, 
NULL
, NULL);

149 
hli°
 = 
	`Cª©eWödowEx
(0L, "LISTBOX",

151 
WS_HSCROLL
|
WS_VSCROLL
|
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

152 
width
 * 5 / 8, 54, 100, 48,

153 
hwnd
, (
HMENU
)7, 
NULL
, NULL);

154 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Cherry");

155 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Apple");

156 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Orange");

158 
	`Cª©eWödowEx
(0L, "BUTTON",

160 
BS_AUTOCHECKBOX
 | 
WS_CHILD
 | 
WS_VISIBLE
,

161 
width
 * 5 / 8 + 50, 106, 50, 14,

162 
hwnd
, (
HMENU
)8, 
NULL
, NULL);

165  
hwnd
;

166 
	}
}

168 #i‡
CHILD


169 
LRESULT
 
CALLBACK


170 
	$ChûdWndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

172 
HDC
 
hdcMem
;

173 
HBITMAP
 
hbmp
, 
hbmpOrg
;

174 
RECT
 
rc
;

175 
PAINTSTRUCT
 
ps
;

177 
msg
) {

178 
WM_PAINT
:

179 
	`BegöPaöt
(
hwnd
, &
ps
);

180 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

183 
hdcMem
 = 
	`Cª©eCom∑tibÀDC
(
ps
.
hdc
);

185 
hbmp
 = 
	`Cª©eCom∑tibÀBôm≠
(
hdcMem
, 
image
->
width
, image->
height
);

186 
hbmpOrg
 = 
	`Sñe˘Obje˘
(
hdcMem
, 
hbmp
);

189 
	`DøwDIB
(
hdcMem
, 0, 0, 
image
);

193 
	`SåëchB…
(
ps
.
hdc
, 0, 0, 
rc
.
right
,Ñc.
bŸtom
, 
hdcMem
, 0, 0, 
image
->
width
, image->
height
, 
MWROP_SRCCOPY
);

194 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdcMem
, 
hbmpOrg
));

195 
	`DñëeDC
(
hdcMem
);

197 
	`EndPaöt
(
hwnd
, &
ps
);

200  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

203 
	}
}

206 
LRESULT
 
CALLBACK


207 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

209 
PAINTSTRUCT
 
ps
;

210 
HDC
 
hdc
;

211 #i‡
CLIENT3D
 | 
IMAGE
 | 
GRAPH3D


212 
RECT
 
rc
;

214 #i‡
GRAPH3D


215 
cou¡up
 = 1;

216 
id
;

217 
vec1
 
gx
, 
gy
;

219 #i‡
TIMERDEMO


220 
POINT
 
mou£±
;

222 #i‡
ARCDEMO


223 
°¨tdegªes
 = 0;

224 
íddegªes
 = 30;

227  
msg
) {

228 #i‡
TIMERDEMO


229 
WM_CREATE
:

230 
	`SëTimî
(
hwnd
, 1, 100, 
NULL
);

231 
mou£±
.
x
 = 60;

232 
mou£±
.
y
 = 20;

235 
WM_TIMER
:

236 #i‡
GRAPH3D


237 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

238 if(
cou¡up
) {

239 
mou£±
.
y
 += 20;

240 if(
mou£±
.
y
 >
rc
.
bŸtom
) {

241 
mou£±
.
y
 -= 20;

242 
cou¡up
 = 0;

245 
mou£±
.
y
 -= 20;

246 if(
mou£±
.
y
 < 20) {

247 
mou£±
.
y
 += 20;

248 
cou¡up
 = 1;

251 
	`SídMesßge
(
hwnd
, 
WM_MOUSEMOVE
, 0,

252 
	`MAKELONG
(
mou£±
.
x
, mou£±.
y
));

254 #i‡
ARCDEMO


255 
°¨tdegªes
 += 10;

256 if(
°¨tdegªes
 >= 360)

257 
°¨tdegªes
 = 0;

258 
íddegªes
 += 15;

259 if(
íddegªes
 >= 360)

260 
íddegªes
 = 0;

261 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

265 
WM_DESTROY
:

266 
	`KûlTimî
(
hwnd
, 1);

269 
WM_SIZE
:

272 
WM_MOVE
:

275 #i‡
CLIENT3D


276 
WM_SETFOCUS
:

277 
	`Po°Mesßge
((
HWND
)
wp
, 
WM_PAINT
, 0, 0L);

280 
WM_KILLFOCUS
:

281 
	`Po°Mesßge
((
HWND
)
wp
, 
WM_PAINT
, 0, 0L);

283 
WM_ERASEBKGND
:

284 if(
	`GëFocus
(Ë!
hwnd
)

285  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

288 #i‡
GRAPH3D


289 
WM_ERASEBKGND
:

290 if((
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03) == 1)

292  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

294 
WM_PAINT
:

295 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

297 #i‡
CLIENT3D


298 if(
	`GëFocus
(Ë=
hwnd
) {

299 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

300 
	`Døw3dShadow
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

301 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

302 
	`GëSysCﬁ‹
(
COLOR_3DDKSHADOW
),

303 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
));

304 
	`InÊ©eRe˘
(&
rc
, -1, -1);

305 
	`FûlRe˘
(
hdc
, &
rc
, 
	`GëStockObje˘
(
GRAY_BRUSH
));

308 #i‡
IMAGE


309 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

310 
	`DøwDIB
(
hdc
, 
rc
.
À·
+2,Ñc.
t›
+2, 
image2
);

312 #i‡
ARCDEMO


314 
x
, 
y
, 
w
, 
h
;

315 
RECT
 
rc
;

317 if(
hdc
 !
NULL
) {

318 
	`GëWödowRe˘
(
hwnd
, &
rc
);

319 
rc
.
t›
 += 13;

320 
	`InÊ©eRe˘
(&
rc
, -3, -3);

325 
x
 = 
rc
.
À·
;

326 
y
 = 
rc
.
t›
;

327 
w
 = 
rc
.
right
 -Ñc.
À·
;

328 
h
 = 
rc
.
bŸtom
 -Ñc.
t›
;

329 
w
 += 10;

330 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
	`RGB
(0,255,0));

331 
	`GdArcAngÀ
(
hdc
->
psd
, 
x
+
w
/2, 
y
+
h
/2, w/2, h/2, 
°¨tdegªes
*64,

332 
íddegªes
*64, 
MWPIE
);

333 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
	`RGB
(0,0,0));

334 
	`GdArcAngÀ
(
hdc
->
psd
, 
x
+
w
/2, 
y
+
h
/2, w/2, h/2, 
°¨tdegªes
*64,

335 
íddegªes
*64, 
MWARCOUTLINE
);

340 
	`EndPaöt
(
hwnd
, &
ps
);

344 #i‡
GRAPH3D


345 
id
 = ()
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03;

346 
	`öô3
(
hdc
, 
id
 =1? 
hwnd
: 
NULL
);

347 
id
) {

349 
	`ro£
(1.0, 7, 13);

354 
	`look3
(-2 * 
gx
, -2 * 
gy
, 1.2);

355 
	`døwgrid
(-8.0, 8.0, 10, -8.0, 8.0, 10);

358 
	`£tcﬁ‹3
(
BLACK
);

359 
	`cú˛e3
(1.0);

362 
	`£tcﬁ‹3
(
BLUE
);

363 
	`daisy
(1.0, 20);

367 #i‡
CLIPDEMO


368 if(
id
 == 1) {

369 
HRGN
 
hrgn
, 
hrgn2
;

372 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

373 
	`InÊ©eRe˘
(&
rc
, -80, -80);

374 ()
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
)) {

376 
hrgn
 = 
	`Cª©eEŒùticRgnIndúe˘
(&
rc
);

379 
hrgn
 = 
	`Cª©eRoundRe˘Rgn
(
rc
.
À·
,Ñc.
t›
,

380 
rc
.
right
,Ñc.
bŸtom
, 100, 100);

383 
hrgn
 = 
	`Cª©eRe˘RgnIndúe˘
(&
rc
);

388 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

389 
hrgn2
 = 
	`Cª©eRe˘RgnIndúe˘
(&
rc
);

390 
	`Sñe˘ClùRgn
(
hdc
, 
hrgn2
);

391 
	`ExtSñe˘ClùRgn
(
hdc
, 
hrgn
, 
RGN_XOR
);

392 
	`DñëeObje˘
(
hrgn2
);

394 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

395 
	`FûlRe˘
(
hdc
, &
rc
, 
	`GëStockObje˘
(
BLACK_BRUSH
));

398 
	`Sñe˘ClùRgn
(
hdc
, 
hrgn
);

399 
	`DñëeObje˘
(
hrgn
);

403 
	`∑öt3
(
hdc
);

406 
	`EndPaöt
(
hwnd
, &
ps
);

409 
WM_LBUTTONDOWN
:

412 
WM_MOUSEMOVE
:

413 #i‡
GRAPH3D


414 if((
	`GëWödowL⁄g
(
hwnd
, 
GWL_ID
) & 03) == 1) {

415 
POINT
 
±
;

417 
	`POINTSTOPOINT
(
±
, 
Õ
);

418 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

419 
gx
 = (
vec1
)
±
.
x
 / 
rc
.
right
;

420 
gy
 = (
vec1
)
±
.
y
 / 
rc
.
bŸtom
;

421 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
FALSE
);

422 
mou£±
.
x
 = 
±
.x;

423 
mou£±
.
y
 = 
±
.y;

428 
WM_LBUTTONUP
:

431 
WM_RBUTTONDOWN
:

435  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

438 
	}
}

440 
WINAPI


441 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

442 
nShowCmd
)

444 
MSG
 
msg
;

445 
HWND
 
hwnd
;

446 
RECT
 
rc
;

448 
	`Regi°îAµCœss
();

449 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
rc
);

450 #i‡!(
ELKS
 | 
MSDOS
)

456 
	`Cª©eAµWödow
();

457 
	`Cª©eAµWödow
();

459 #i‡!(
ELKS
 | 
MSDOS
)

471 #i‡!(
ELKS
 | 
MSDOS
)

473 
	`MwSëDeskt›WÆÕ≠î
(&
image_mi¸owö
);

479  
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

480 
	`Tøn¶©eMesßge
(&
msg
);

481 
	`Di•©chMesßge
(&
msg
);

484 
	}
}

	@demos/mwin/mine.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<time.h
>

4 
	~<°rög.h
>

8 
mwCuºítBuâ⁄s
;

11 #ifde‡
__πems__


12 
	#§™dom
 
§™d


	)

13 
	#øndom
 
ønd


	)

16 
	#MWINCLUDECOLORS


	)

17 
	~"wödows.h
"

18 
	~"wötoﬁs.h
"

21 
	mÊag
;

22 
	mvÆue
;

23 
BOOL
 
	mã°
;

24 
BOOL
 
	mhô
;

25 
BOOL
 
	mbombout
;

26 
BOOL
 
	mîr‹
;

27 }
	tBOM
;

30 
	mx
;

31 
	my
;

32 
BOOL
 
	mNY
;

33 }
	tNO
;

36 
	mhighsc‹e
;

37 
	m«me
[20];

38 }
	tSCORE
;

41 
DWORD
 
	mdwStyÀ
;

42 
LPSTR
 
	m•C≠ti⁄
;

43 
HMENU
 
	mhMíu
;

44 
HCURSOR
 
	mhCurs‹
;

45 
HICON
 
	mhIc⁄
;

46 
WNDPROC
 
	mMaöWödowProc
;

47 
	mlx
, 
	mty
, 
	mrx
, 
	mby
;

48 
COLORREF
 
	miBkCﬁ‹
;

49 
DWORD
 
	mdwAddD©a
;

50 
HWND
 
	mhHo°ög
;

51 } 
	tMAINWINCREATE
, *
	tPMAINWINCREATE
;

53 
	#IDOK
 0

	)

54 
	#GëCh¨Width
(Ë11

	)

55 
	#GëCh¨Height
(Ë13

	)

57 
MWIMAGEHDR
 
image_möeÊag
;

58 
MWIMAGEHDR
 
image_möeÁ˚
;

59 
MWIMAGEHDR
 
image_möeÁ˚lo°
;

60 
MWIMAGEHDR
 
image_möebomb
;

61 
MWIMAGEHDR
 
image_möed⁄e
;

62 
MWIMAGEHDR
 
image_möehôÁl£
;

64 
HWND
 
Cª©eMaöWödow
(
PMAINWINCREATE
 
pCª©eInfo
);

65 
BOOL
 
PtInRe˘2
(c⁄° 
RECT
 *
Õrc
, 
x
, 
y
);

66 
Døw3DUpFøme
(
HDC
 
hDC
, 
l
, 
t
, 
r
, 
b
, 
fûlc
);

67 
SórchGround
(
HDC
 
hdc
,
x
,
y
);

68 
O≥n
(
HWND
 
hWnd
,
x
,
y
);

69 
LRESULT
 
Te°MyWöProc
(
HWND
 
hWnd
,
UINT
 
mesßge
,
WPARAM
 
wP¨am
,
LPARAM
 
lP¨am
);

70 
InôMyWöCª©eInfo
(
PMAINWINCREATE
 
pCª©eInfo
);

71 
InôAbHo°edCª©eInfo
(
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
);

72 
InôHighSc‹eCª©eInfo
 (
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
);

73 
InôC⁄gøtuœti⁄Cª©eInfo
 (
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
);

74 * 
Te°MyWödow
(* 
d©a
);

75 
BombGame
(
HWND
 
hWnd
, 
x
, 
y
);

76 
Föished
(
HWND
 
hWnd
);

77 
C™˚l3DFøme
(
HDC
 
hdc
, 
l
,
t
,
r
,
b
);

78 
TextVÆue
(
HDC
 
hdc
, 
x
,
y
,
vÆue
);

79 
BombOut
(
HWND
 
hWnd
);

80 
BŸhBuâ⁄DownProc
(
HWND
 
hWnd
, 
x
, 
y
);

81 
DøwDigô
(
HDC
 
hdc
, * 
buf„r
, 
CLOCK
);

83 
	#ID_ABOUT
 300

	)

84 
	#ID_NEW
 301

	)

85 
	#ID_LARGE
 302

	)

86 
	#ID_MIDDLE
 303

	)

87 
	#ID_SMALL
 304

	)

88 
	#ID_CLOSE
 305

	)

89 
	#ID_HIGHSCORE
 306

	)

90 
	#ID_CLOCK
 400

	)

92 
	#WIDTH_LARGEWIN
 544

	)

93 
	#HEIGHT_LARGEWIN
 371

	)

94 
	#WIDTH_MIDDLEWIN
 287

	)

95 
	#HEIGHT_MIDDLEWIN
 332

	)

96 
	#WIDTH_SMALLWIN
 178

	)

97 
	#HEIGHT_SMALLWIN
 206

	)

99 
	#WIDTH_FACE
 30

	)

100 
	#HEIGHT_FACE
 30

	)

102 
	#WIDTH_DIGIT
 11

	)

103 
	#WIDTH_BOMNUM
 (2*
WIDTH_DIGIT
)

	)

104 
	#HEIGHT_BOMNUM
 30

	)

106 
	#WIDTH_CLOCK
 (3*
WIDTH_DIGIT
)

	)

107 
	#HEIGHT_CLOCK
 30

	)

108 
	#FREQ_CLOCK
 1000

	)

110 
	#WIDTH_BOX
 18

	)

111 
	#HEIGHT_BOX
 18

	)

114 
	gwöwidth
 = 
WIDTH_LARGEWIN
;

115 
	gwöheight
 = 
HEIGHT_LARGEWIN
;

116 
	gsg_boxnumx
 = 30;

117 
	gsg_boxnumy
 = 18;

118 
	gbombnum
 = 99;

122 
	gwöwidth
 = 
WIDTH_MIDDLEWIN
;

123 
	gwöheight
 = 
HEIGHT_MIDDLEWIN
;

124 
	gsg_boxnumx
 = 16;

125 
	gsg_boxnumy
 = 16;

126 
	gbombnum
 = 40;

130 
	gwöwidth
 = 
WIDTH_SMALLWIN
;

131 
	gwöheight
 = 
HEIGHT_SMALLWIN
;

132 
	gsg_boxnumx
 = 8;

133 
	gsg_boxnumy
 = 8;

134 
	gbombnum
 = 10;

137 
BOM
 
	gbom
[30][18];

138 
NO
 
	gNoAdr
[540];

139 
SCORE
 
	gsc‹e
[3];

140 
	gôime
, 
	gÀ·bombnum
;

141 
	gﬁdx
, 
	gﬁdy
, 
	gadrx
, 
	gadry
;

142 
	gÊag_bombout
, 
	gÊag_föished
, 
	gÊag_size
 = 2;

143 
	g£c⁄d
 = 0 ;

144 
BOOL
 
	gbTimî
;

145 
HWND
 
	ghHighsc‹e
,
	ghC⁄gøtuœã
;

146 
	goff£tx
;

147 
	gx_Á˚
, 
	gx_bomnum
, 
	gx_˛ock
;

149 
	$C™˚l3DFøme
(
HDC
 
hdc
, 
l
, 
t
, 
w
, 
h
)

151 
HBRUSH
 
hbr
;

152 
RECT
 
rc
;

154 
	`SëTextCﬁ‹
 (
hdc
,
GRAY
);

155 
	`Re˘™gÀ
(
hdc
, 
l
, 
t
,Ü + 
w
,Å + 
h
);

156 
hbr
 = 
	`Cª©eSﬁidBrush
(
LTGRAY
);

157 
	`SëRe˘
(&
rc
, 
l
+1, 
t
+1,Ü+
w
,Å+
h
);

158 
	`FûlRe˘
(
hdc
, &
rc
, 
hbr
);

159 
	`DñëeObje˘
(
hbr
);

160 
	}
}

162 
	$TextVÆue
(
HDC
 
hdc
, 
x
, 
y
, 
vÆue
)

164 
cﬁ‹
 = 0;

165 
va
[20];

166 
vÆue
)

168 1: 
cﬁ‹
=
BLUE
; ;

169 2: 
cﬁ‹
=
GREEN
; ;

170 3: 
cﬁ‹
=
RED
; ;

171 4: 
cﬁ‹
=
MAGENTA
; ;

172 5: 
cﬁ‹
=
YELLOW
; ;

173 6: 
cﬁ‹
=
CYAN
; ;

174 7: 
cﬁ‹
=
RED
; ;

175 8: 
cﬁ‹
=
GREEN
; ;

177 
	`SëBkCﬁ‹
(
hdc
,
LTGRAY
);

178 
	`SëTextCﬁ‹
(
hdc
,
cﬁ‹
);

179 
	`•rötf
(
va
,"%d",
vÆue
);

181 
	`TextOut
(
hdc
, 
x
 + ((
WIDTH_BOX
 - 
	`GëCh¨Width
 ()) >> 1),

182 
y
 + ((
HEIGHT_BOX
 - 
	`GëCh¨Height
 ()Ë>> 1), 
va
, -1);

183 
	}
}

185 
	$SórchGround
(
HDC
 
hdc
,
x
,
y
)

187 
x1
=0,
y1
=0;

188 
i
=1;

190 
bom
[
x
][
y
].
ã°
=
TRUE
;

191 
NoAdr
[
ôime
].
x
=x;

192 
NoAdr
[
ôime
].
y
=y;

193 
NoAdr
[
ôime
].
NY
=
FALSE
;

194 
ôime
++;

195 
	`C™˚l3DFøme
(
hdc
,
x
*
WIDTH_BOX
+
off£tx
, 
y
*
HEIGHT_BOX
+
HEIGHT_FACE
,

196 
WIDTH_BOX
, 
HEIGHT_BOX
);

197  
i
 <= 8 )

199 
i
)

201 1: 
x1
=
x
-1; 
y1
=
y
; ;

202 2: 
x1
=
x
-1; 
y1
=
y
-1; ;

203 3: 
x1
=
x
-1; 
y1
=
y
+1; ;

204 4: 
x1
=
x
+1; 
y1
=
y
; ;

205 5: 
x1
=
x
+1; 
y1
=
y
-1; ;

206 6: 
x1
=
x
+1; 
y1
=
y
+1; ;

207 7: 
y1
=
y
-1; 
x1
=
x
; ;

208 8: 
y1
=
y
+1; 
x1
=
x
; ;

210 if–
x1
>=0 && 
y1
>=0 && x1<
sg_boxnumx
 && y1<
sg_boxnumy


211 &&!
bom
[
x1
][
y1
].
hô
&& !bom[x1][y1].
ã°
 && !bom[x1][y1].
vÆue
 )

212 
	`SórchGround
(
hdc
,
x1
,
y1
);

214 if–
x1
>=0 && 
y1
>=0 && x1<
sg_boxnumx
 && y1<
sg_boxnumy


215 &&!
bom
[
x1
][
y1
].
hô


216 &&!
bom
[
x1
][
y1
].
ã°
 && bom[x1][y1].
vÆue
!=0 )

218 
bom
[
x1
][
y1
].
ã°
=
TRUE
;

219 
NoAdr
[
ôime
].
x
=
x1
;

220 
NoAdr
[
ôime
].
y
=
y1
;

221 
NoAdr
[
ôime
].
NY
=
TRUE
;

222 
ôime
++;

223 
	`C™˚l3DFøme
(
hdc
, 
x1
*
WIDTH_BOX
+
off£tx
, 
y1
*
HEIGHT_BOX
+
HEIGHT_FACE
,

224 
WIDTH_BOX
, 
HEIGHT_BOX
);

225 
	`TextVÆue
(
hdc
, 
x1
*
WIDTH_BOX
+
off£tx
, 
y1
*
HEIGHT_BOX
+
HEIGHT_FACE
,

226 
bom
[
x1
][
y1
].
vÆue
);

228 
i
++;

230 
	}
}

232 
BOOL
 
	$O≥n
(
HWND
 
hWnd
,
x
,
y
)

234 
x1
=0,
y1
=0;

235 
i
=1;

236 
HDC
 
hdc
;

238 
hdc
 = 
	`GëDC
(
hWnd
);

239  
i
 <= 8 )

241  
i
 ) {

242 1: 
x1
=
x
-1; 
y1
=
y
; ;

243 2: 
x1
=
x
-1; 
y1
=
y
-1; ;

244 3: 
x1
=
x
-1; 
y1
=
y
+1; ;

245 4: 
x1
=
x
+1; 
y1
=
y
; ;

246 5: 
x1
=
x
+1; 
y1
=
y
-1; ;

247 6: 
x1
=
x
+1; 
y1
=
y
+1; ;

248 7: 
y1
=
y
-1; 
x1
=
x
; ;

249 8: 
y1
=
y
+1; 
x1
=
x
; ;

252 if–
x1
>=0 && 
y1
>=0 && x1<
sg_boxnumx
 && y1<
sg_boxnumy


253 && !
bom
[
x1
][
y1
].
hô
 && bom[x1][y1].
Êag
) {

254 
	`Rñó£DC
(
hWnd
, 
hdc
);

255  
FALSE
;

258 if–
x1
>=0 && 
y1
>=0 && x1<
sg_boxnumx
 && y1<
sg_boxnumy


259 && !
bom
[
x1
][
y1
].
ã°
 && !bom[x1][y1].
vÆue


260 && !
bom
[
x1
][
y1
].
Êag
 ){

261 
	`SórchGround
(
hdc
,
x1
,
y1
);

264 if–
x1
>=0 && 
y1
>=0 && x1<
sg_boxnumx
 && y1<
sg_boxnumy


265 && !
bom
[
x1
][
y1
].
ã°
 && bom[x1][y1].
vÆue
!=0 )

267 
bom
[
x1
][
y1
].
ã°
=
TRUE
;

268 
NoAdr
[
ôime
].
x
=
x1
;

269 
NoAdr
[
ôime
].
y
=
y1
;

270 
NoAdr
[
ôime
].
NY
=
TRUE
;

271 
ôime
++;

272 
	`C™˚l3DFøme
(
hdc
, 
x1
*
WIDTH_BOX
+
off£tx
, 
y1
*
HEIGHT_BOX
+
HEIGHT_FACE
,

273 
WIDTH_BOX
, 
HEIGHT_BOX
);

274 
	`TextVÆue
(
hdc
, 
x1
*
WIDTH_BOX
+
off£tx
, 
y1
*
HEIGHT_BOX
+
HEIGHT_FACE
,

275 
bom
[
x1
][
y1
].
vÆue
);

277 
i
++;

280 
	`Rñó£DC
(
hWnd
, 
hdc
);

281  
TRUE
;

282 
	}
}

284 
	$BombOut
(
HWND
 
hWnd
)

286 
i
,
j
;

287 
HDC
 
hdc
;

289 
hdc
=
	`GëDC
(
hWnd
);

291 
i
 = 0; i < 
sg_boxnumx
; i++) {

292 
j
 = 0; j < 
sg_boxnumy
; j++) {

293 i‡(
bom
[
i
][
j
].
Êag
 && !bom[i][j].
hô
) {

294 
	`C™˚l3DFøme
(
hdc
,
i
*
WIDTH_BOX
+
off£tx
,
j
*
HEIGHT_BOX
+
HEIGHT_FACE
,

295 
WIDTH_BOX
,
HEIGHT_BOX
);

297 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+1, 
j
*
HEIGHT_BOX
+1+
HEIGHT_FACE
,

298 &
image_möebomb
);

299 
bom
[
i
][
j
].
bombout
 = 
TRUE
;

301 i‡(!
bom
[
i
][
j
].
Êag
 && bom[i][j].
hô
){

302 
	`C™˚l3DFøme
(
hdc
,
i
*
WIDTH_BOX
+
off£tx
,
j
*
HEIGHT_BOX
+
HEIGHT_FACE
,

303 
WIDTH_BOX
,
HEIGHT_BOX
);

305 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+1, 
j
*
HEIGHT_BOX
+1+
HEIGHT_FACE
,

306 &
image_möehôÁl£
);

307 
bom
[
i
][
j
].
îr‹
 = 
TRUE
;

313 
	`DøwDIB
(
hdc
, 
x_Á˚
, 0, &
image_möeÁ˚lo°
);

314 
Êag_bombout
 = 1;

315 
bTimî
 = 
FALSE
;

316 
	`Rñó£DC
(
hWnd
, 
hdc
);

317 
	}
}

319 
	$Föished
(
HWND
 
hWnd
)

321 
i
,
j
;

322 
HDC
 
hdc
;

323 
RECT
 
bombnumbî
;

324 
MAINWINCREATE
 
Cª©eInfo
;

326 
hdc
 = 
	`GëDC
(
hWnd
);

328 
i
 = 0; i < 
sg_boxnumx
; i++) {

329 
j
 = 0; j < 
sg_boxnumy
; j++) {

330 i‡(
bom
[
i
][
j
].
Êag
 && !bom[i][j].
hô
) {

332 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+3, 
j
*
HEIGHT_BOX
+3+
HEIGHT_FACE
,

333 &
image_möeÊag
);

334 
bom
[
i
][
j
].
hô
 = 
TRUE
;

339 
	`DøwDIB
(
hdc
, 
x_Á˚
+1, 1, &
image_möed⁄e
);

340 
Êag_föished
 = 1;

341 
bTimî
 = 
FALSE
;

342 
	`Rñó£DC
(
hWnd
, 
hdc
);

344 
À·bombnum
 = 0;

346 
	`SëRe˘
 (&
bombnumbî
, 
x_bomnum
, 0,

347 
x_bomnum
 + 
WIDTH_BOMNUM
, 
HEIGHT_BOMNUM
);

348 
	`InvÆid©eRe˘
 (
hWnd
, &
bombnumbî
, 
FALSE
);

350 i‡(
£c⁄d
 < 
sc‹e
[
Êag_size
].
highsc‹e
){

351 
	`InôC⁄gøtuœti⁄Cª©eInfo
(
hWnd
, &
Cª©eInfo
);

352 
hC⁄gøtuœã
 = 
	`Cª©eMaöWödow
 (&
Cª©eInfo
);

354 
	}
}

357 
HMENU
 
	$¸óãpmíuabout
()

359 
HMENU
 
hmnu
;

360 
MENUITEMINFO
 
mii
;

361 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

362 
mii
.
ty≥
 = 
MFT_STRING
;

363 
mii
.
id
 = 0;

364 
mii
.
ty≥d©a
 = (
DWORD
)"About";

365 
hmnu
 = 
	`Cª©eP›upMíu
 (&
mii
);

367 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

368 
mii
.
ty≥
 = 
MFT_STRING
 ;

369 
mii
.
°©e
 = 0;

370 
mii
.
id
 = 
ID_ABOUT
;

371 
mii
.
ty≥d©a
 = (
DWORD
)"About Bomb Game";

372 
	`In£πMíuIãm
(
hmnu
, 3, 
TRUE
, &
mii
);

374  
hmnu
;

375 
	}
}

377 
HMENU
 
	$¸óãpmíu°¨t
()

379 
HMENU
 
hmnu
;

380 
MENUITEMINFO
 
mii
;

381 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

382 
mii
.
ty≥
 = 
MFT_STRING
;

383 
mii
.
id
 = 0;

384 
mii
.
ty≥d©a
 = (
DWORD
)"Start";

385 
hmnu
 = 
	`Cª©eP›upMíu
 (&
mii
);

387 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

388 
mii
.
ty≥
 = 
MFT_STRING
 ;

389 
mii
.
°©e
 = 0;

390 
mii
.
id
 = 
ID_NEW
;

391 
mii
.
ty≥d©a
 = (
DWORD
)"New Game";

392 
	`In£πMíuIãm
(
hmnu
, 0, 
TRUE
, &
mii
);

394 
mii
.
ty≥
 = 
MFT_STRING
 ;

395 
mii
.
°©e
 = 0;

396 
mii
.
id
 = 
ID_HIGHSCORE
;

397 
mii
.
ty≥d©a
 = (
DWORD
)"High Score";

398 
	`In£πMíuIãm
(
hmnu
, 1, 
TRUE
, &
mii
);

400 
mii
.
ty≥
 = 
MFT_STRING
 ;

401 
mii
.
°©e
 = 0;

402 
mii
.
id
 = 
ID_CLOSE
;

403 
mii
.
ty≥d©a
 = (
DWORD
)"Quit Game";

404 
	`In£πMíuIãm
(
hmnu
, 2, 
TRUE
, &
mii
);

406  
hmnu
;

407 
	}
}

409 
HMENU
 
	$¸óãpmíuÀvñ
()

411 
HMENU
 
hmnu
;

412 
MENUITEMINFO
 
mii
;

413 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

414 
mii
.
ty≥
 = 
MFT_STRING
;

415 
mii
.
id
 = 0;

416 
mii
.
ty≥d©a
 = (
DWORD
)"Level";

417 
hmnu
 = 
	`Cª©eP›upMíu
 (&
mii
);

419 
mii
.
ty≥
 = 
MFT_STRING
 ;

420 
mii
.
°©e
 = 0;

421 
mii
.
id
 = 
ID_LARGE
;

422 
mii
.
ty≥d©a
 = (
DWORD
)"Large";

423 
	`In£πMíuIãm
(
hmnu
, 0, 
TRUE
, &
mii
);

425 
mii
.
ty≥
 = 
MFT_STRING
 ;

426 
mii
.
°©e
 = 0;

427 
mii
.
id
 = 
ID_MIDDLE
;

428 
mii
.
ty≥d©a
 = (
DWORD
)"Middle";

429 
	`In£πMíuIãm
(
hmnu
, 1, 
TRUE
, &
mii
);

431 
mii
.
ty≥
 = 
MFT_STRING
 ;

432 
mii
.
°©e
 = 0;

433 
mii
.
id
 = 
ID_SMALL
;

434 
mii
.
ty≥d©a
 = (
DWORD
)"Small";

435 
	`In£πMíuIãm
(
hmnu
, 2, 
TRUE
, &
mii
);

437  
hmnu
;

438 
	}
}

440 
HMENU
 
	$¸óãmíu1
()

442 
HMENU
 
hmnu
;

443 
MENUITEMINFO
 
mii
;

445 
hmnu
 = 
	`Cª©eMíu
();

447 
	`mem£t
 (&
mii
, 0, (
MENUITEMINFO
));

448 
mii
.
ty≥
 = 
MFT_STRING
;

449 
mii
.
id
 = 100;

450 
mii
.
ty≥d©a
 = (
DWORD
)"Start";

451 
mii
.
hsubmíu
 = 
	`¸óãpmíu°¨t
();

453 
	`In£πMíuIãm
(
hmnu
, 0, 
TRUE
, &
mii
);

455 
mii
.
ty≥
 = 
MFT_STRING
;

456 
mii
.
id
 = 110;

457 
mii
.
ty≥d©a
 = (
DWORD
)"Level";

458 
mii
.
hsubmíu
 = 
	`¸óãpmíuÀvñ
();

459 
	`In£πMíuIãm
(
hmnu
, 1, 
TRUE
, &
mii
);

461 
mii
.
ty≥
 = 
MFT_STRING
;

462 
mii
.
id
 = 120;

463 
mii
.
ty≥d©a
 = (
DWORD
)"About";

464 
mii
.
hsubmíu
 = 
	`¸óãpmíuabout
();

465 
	`In£πMíuIãm
(
hmnu
, 2, 
TRUE
, &
mii
);

467  
hmnu
;

468 
	}
}

471 
	$BŸhBuâ⁄DownProc
(
HWND
 
hWnd
,
adrx
,
adry
)

473 
ã°_›í
 = 0;

474 
i
 = 1;

475 
adrx1
 = 0, 
adry1
 = 0;

476 
Êag_›íed
 = 1;

478 i‡(!
bom
[
adrx
][
adry
].
ã°
)

480 i‡(!
bom
[
adrx
][
adry
].
vÆue
)

482 i‡(
bom
[
adrx
][
adry
].
hô
)

484 
i
 <= 8)

486 
i
)

489 
adrx1
 = 
adrx
-1;

490 
adry1
 = 
adry
;

494 
adrx1
 = 
adrx
-1;

495 
adry1
 = 
adry
-1;

499 
adrx1
 = 
adrx
-1;

500 
adry1
 = 
adry
+1;

504 
adrx1
 = 
adrx
;

505 
adry1
 = 
adry
-1;

509 
adrx1
 = 
adrx
;

510 
adry1
 = 
adry
+1;

514 
adrx1
 = 
adrx
+1;

515 
adry1
 = 
adry
;

519 
adrx1
 = 
adrx
+1;

520 
adry1
 = 
adry
+1;

524 
adrx1
 = 
adrx
+1;

525 
adry1
 = 
adry
-1;

529 i‡(
adrx1
>=0 && 
adry1
>=0 &&ádrx1<
sg_boxnumx
 &&ádry1<
sg_boxnumy


530 && 
bom
[
adrx1
][
adry1
].
hô
)

531 
ã°_›í
++;

533 if(
adrx
>=0 && 
adry1
>=0 && 
adrx1
<
sg_boxnumx
 &&ádry1<
sg_boxnumy


534 && !
bom
[
adrx1
][
adry1
].
ã°
)

535 
Êag_›íed
 = 0;

536 
i
++;

538 i‡((
ã°_›í
 =
bom
[
adrx
][
adry
].
vÆue
Ë&& !
Êag_›íed
)

540 i‡(!
	`O≥n
 (
hWnd
, 
adrx
, 
adry
))

541 
	`BombOut
 (
hWnd
);

542 i‡(
ôime
 =(
sg_boxnumx
*
sg_boxnumy
-
bombnum
))

543 
	`Föished
(
hWnd
);

547 
	}
}

549 
	$DøwDigô
(
HDC
 
hdc
, * 
buf„r
, 
CLOCK
)

551 
x
;

553 i‡(
CLOCK
)

554 
x
 = 
x_˛ock
;

556 
x
 = 
x_bomnum
;

558 
	`SëBkMode
(
hdc
, 
OPAQUE
);

559 
	`SëBkCﬁ‹
(
hdc
, 
LTGRAY
);

560 
	`TextOut
(
hdc
, 
x
, 0, 
buf„r
, -1);

562 
	}
}

564 
LRESULT
 
	$Te°MyWöProc
(
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

566 
HDC
 
hdc
;

567 
bomn
[30], 
£c⁄ds
[30];

568 
i
, 
j
;

569 
øn1
, 
øn2
;

570 
RECT
 
bombªgi⁄
, 
Á˚
, 
⁄îe˘
, 
bombnumbî
, 
˛ock
;

571 
RECT
 
wöposôi⁄
;

572 
MAINWINCREATE
 
Cª©eInfo
;

574 
PAINTSTRUCT
 
ps
;

575 
mesßge
) {

577 
WM_CREATE
:

579 
FILE
* 
pHighsc‹e
;

580 
buf„r
[256];

581 if–
	`LﬂdBôm≠
(&
bmpbom
,"res/lei.bmp")<0)

582 
	`Ârötf
(
°dîr
,"bitmapÉrror");

584 
fVÆidbom
 = 
TRUE
;

586 if–
	`LﬂdBôm≠
(&
bmpÁ˚
,"res/face1.bmp")<0)

587 
	`Ârötf
(
°dîr
,"bitmapÉrror");

589 
fVÆidÁ˚
 = 
TRUE
;

591 if–
	`LﬂdBôm≠
(&
bôm≠1
,"res/face.bmp")<0)

592 
	`Ârötf
(
°dîr
,"bitmapÉrror");

594 
fVÆid1
 = 
TRUE
;

596 if–
	`LﬂdBôm≠
(&
bmpÊag
,"res/flag.bmp")<0)

597 
	`Ârötf
(
°dîr
,"bitmapÉrror");

599 
fVÆidÊag
 = 
TRUE
;

601 if–
	`LﬂdBôm≠
(&
bmpföÆÁ˚
,"res/finished.bmp")<0)

602 
	`Ârötf
(
°dîr
,"bitmapÉrror");

604 
fVÆidföÆÁ˚
 = 
TRUE
;

606 if–
	`LﬂdBôm≠
(&
bmphôÁl£
,"res/hitfalse.bmp")<0)

607 
	`Ârötf
(
°dîr
,"bitmapÉrror");

609 
fVÆidhôÁl£
 = 
TRUE
;

611 
i
 = 0; i < 10; i++){

612 
	`•rötf
(
buf„r
, "ªs/%d.bmp", 
i
);

613 
	`LﬂdBôm≠
(
sg_bmpDigô
 + 
i
, 
buf„r
);

616 i‡((
pHighsc‹e
 = 
	`f›í
("res/.highscore.bomb","r"))){

617 
i
 = 0; i < 3; i++)

618 
	`fsˇnf
(
pHighsc‹e
, "%d, %s",

619 &
sc‹e
[
i
].
highsc‹e
, sc‹e[i].
«me
);

620 
	`f˛o£
(
pHighsc‹e
);

623 
i
 = 0; i < 3; i++){

624 
sc‹e
[
i
].
highsc‹e
 = 999;

625 
	`°r˝y
(
sc‹e
[
i
].
«me
, "unknown");

628 
	`SëTimî
(
hWnd
, 
ID_CLOCK
, 
FREQ_CLOCK
, 
NULL
);

630 
	`Po°Mesßge
(
hWnd
,
WM_COMMAND
,
ID_NEW
,0);

633 
WM_COMMAND
:

634 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_ABOUT
)

636 
	`InôAbHo°edCª©eInfo
(
hWnd
,&
Cª©eInfo
);

637 
	`Cª©eMaöWödow
(&
Cª©eInfo
);

640 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_CLOSE
)

642 
	`Po°Mesßge
(
hWnd
, 
WM_CLOSE
, 0, 0);

645 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_HIGHSCORE
)

647 
	`InôHighSc‹eCª©eInfo
(
hWnd
,&
Cª©eInfo
);

648 
hHighsc‹e
 = 
	`Cª©eMaöWödow
(&
Cª©eInfo
);

649 
	`ShowWödow
(
hHighsc‹e
,
SW_SHOW
);

652 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_LARGE
)

654 
bombnum
 = 99;

655 
sg_boxnumx
 = 30;

656 
sg_boxnumy
 = 18;

657 
wöwidth
 = 
WIDTH_LARGEWIN
;

658 
Êag_size
 = 2;

659 
	`GëWödowRe˘
(
hWnd
, &
wöposôi⁄
);

660 
	`MoveWödow
(
hWnd
, 
wöposôi⁄
.
À·
, wöposôi⁄.
t›
,

661 
WIDTH_LARGEWIN
, 
HEIGHT_LARGEWIN
, 
FALSE
);

662 
	`Po°Mesßge
(
hWnd
, 
WM_COMMAND
, 
ID_NEW
, 0);

664 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_MIDDLE
)

666 
bombnum
 = 40;

667 
sg_boxnumx
 = 16;

668 
sg_boxnumy
 = 16;

669 
wöwidth
 = 
WIDTH_MIDDLEWIN
;

670 
Êag_size
 = 1;

671 
	`GëWödowRe˘
(
hWnd
, &
wöposôi⁄
);

672 
	`MoveWödow
(
hWnd
, 
wöposôi⁄
.
À·
, wöposôi⁄.
t›
,

673 
WIDTH_MIDDLEWIN
, 
HEIGHT_MIDDLEWIN
, 
FALSE
);

674 
	`Po°Mesßge
(
hWnd
, 
WM_COMMAND
, 
ID_NEW
, 0);

677 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_SMALL
)

679 
bombnum
 = 10;

680 
sg_boxnumx
 = 8;

681 
sg_boxnumy
 = 8;

682 
wöwidth
 = 
WIDTH_SMALLWIN
;

683 
Êag_size
 = 0;

684 
	`GëWödowRe˘
(
hWnd
, &
wöposôi⁄
);

685 
	`MoveWödow
(
hWnd
, 
wöposôi⁄
.
À·
, wöposôi⁄.
t›
,

686 
WIDTH_SMALLWIN
, 
HEIGHT_SMALLWIN
, 
FALSE
);

687 
	`Po°Mesßge
(
hWnd
, 
WM_COMMAND
, 
ID_NEW
, 0);

690 i‡(
	`LOWORD
(
wP¨am
Ë=
ID_NEW
)

692 
bTimî
 = 
FALSE
;

693 
£c⁄d
 = 0;

694 
ôime
 = 0;

695 
À·bombnum
 = 
bombnum
;

696 
Êag_bombout
 = 0;

697 
Êag_föished
 = 0;

698 
x_bomnum
 = 
wöwidth
 / 6;

699 
x_Á˚
 = (
wöwidth
*2) / 5;

700 
x_˛ock
 = (
wöwidth
*3) / 5;

701 
off£tx
 = (
wöwidth
 - 
WIDTH_BOX
*
sg_boxnumx
)/2-2;

702 
	`SëRe˘
 (&
˛ock
, 
x_˛ock
, 0,

703 
x_˛ock
 + 
WIDTH_CLOCK
, 
HEIGHT_CLOCK
);

705 
	`SëRe˘
 (&
Á˚
, 
x_Á˚
, 0,

706 
x_Á˚
 + 
WIDTH_FACE
, 
HEIGHT_FACE
);

708 
	`SëRe˘
 (&
bombªgi⁄
, 
off£tx
, 
HEIGHT_FACE
,

709 
WIDTH_BOX
*
sg_boxnumx
+
off£tx
,

710 
HEIGHT_BOX
*
sg_boxnumy
+
HEIGHT_FACE
);

712 
	`SëRe˘
 (&
bombnumbî
, 
x_bomnum
, 0,

713 
x_bomnum
 + 
WIDTH_BOMNUM
, 
HEIGHT_BOMNUM
);

717 
i
 = 0; i < 
sg_boxnumx
; i++)

718 
j
 = 0; j < 
sg_boxnumy
; j++)

719 { 
bom
[
i
][
j
].
Êag
 = 0;

720 
bom
[
i
][
j
].
hô
 = 
FALSE
;

721 
bom
[
i
][
j
].
vÆue
 = 0;

722 
bom
[
i
][
j
].
ã°
 = 
FALSE
;

723 
bom
[
i
][
j
].
bombout
 = 
FALSE
;

724 
bom
[
i
][
j
].
îr‹
 = 
FALSE
;

726 
i
 = 0; i < (
sg_boxnumx
*
sg_boxnumy
); i++)

727 
NoAdr
[
i
].
NY
 = 
FALSE
;

729 
	`§™dom
–
	`time
(
NULL
));

730 
i
 = 0;

731  
i
 < 
bombnum
 )

733 
øn1
 = 
	`øndom
()%
sg_boxnumx
;

734 
øn2
 = 
	`øndom
()%
sg_boxnumy
;

735 if(!
bom
[
øn1
][
øn2
].
Êag
)

737 
bom
[
øn1
][
øn2
].
Êag
 = 1;

738 
i
++;

740 #ifde‡
__πems__


741 
i
++;

745 
i
 = 0; i < 
sg_boxnumx
; i++)

746 
j
 = 0; j < 
sg_boxnumy
; j++)

748 i‡(!
bom
[
i
][
j
].
Êag
) {

749 if(
i
-1>=0&&
j
-1>=0&&
bom
[i-1][j-1].
Êag
)

750 
bom
[
i
][
j
].
vÆue
++;

752 if(
i
-1>=0&&
bom
[i-1][
j
].
Êag
)

753 
bom
[
i
][
j
].
vÆue
++;

755 if(
i
-1>=0&&
j
+1<
sg_boxnumy
&&
bom
[i-1][j+1].
Êag
)

756 
bom
[
i
][
j
].
vÆue
++;

758 if(
j
-1>=0&&
bom
[
i
][j-1].
Êag
)

759 
bom
[
i
][
j
].
vÆue
++;

761 if(
j
+1<
sg_boxnumy
&&
bom
[
i
][j+1].
Êag
)

762 
bom
[
i
][
j
].
vÆue
++;

764 if(
i
+1<
sg_boxnumx
&&
j
+1<
sg_boxnumy
&&
bom
[i+1][j+1].
Êag
)

765 
bom
[
i
][
j
].
vÆue
++;

767 if(
i
+1<
sg_boxnumx
&&
bom
[i+1][
j
].
Êag
)

768 
bom
[
i
][
j
].
vÆue
++;

770 if(
i
+1<
sg_boxnumx
&&
j
-1>=0&&
bom
[i+1][j-1].
Êag
)

771 
bom
[
i
][
j
].
vÆue
++;

774 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
TRUE
);

778 
WM_TIMER
:

779 i‡(
wP¨am
 =
ID_CLOCK
)

780 i‡(
bTimî
){

781 i‡(
£c⁄d
 < 1000){

782 
£c⁄d
++;

783 
	`InvÆid©eRe˘
(
hWnd
, &
˛ock
, 
FALSE
);

788 
WM_LBUTTONDOWN
:

790 
ﬁdx
 = 
	`LOWORD
 (
lP¨am
);

791 
ﬁdy
 = 
	`HIWORD
 (
lP¨am
);

793 
adrx
 = (
ﬁdx
-
off£tx
)/
WIDTH_BOX
;

794 
adry
 = (
ﬁdy
-
HEIGHT_FACE
)/
HEIGHT_BOX
;

796 i‡(
hC⁄gøtuœã
 || 
hHighsc‹e
)

799 i‡(!
	`PtInRe˘2
 (&
bombªgi⁄
, 
ﬁdx
, 
ﬁdy
)) {

800 i‡(
	`PtInRe˘2
 (&
Á˚
, 
ﬁdx
, 
ﬁdy
)){

801 
	`Po°Mesßge
 (
hWnd
, 
WM_COMMAND
, 
ID_NEW
, 0);

807 i‡(
Êag_bombout
)

809 i‡(
Êag_föished
)

811 i‡(!
bTimî
)

812 
bTimî
 = 
TRUE
;

814 i‡(
bom
[
adrx
][
adry
].
hô
)

818 i‡(
	`GëShi·KeySètus
() & 0x00000200) {

820 if(
mwCuºítBuâ⁄s
 & 
MWBUTTON_R
) {

821 
	`BŸhBuâ⁄DownProc
(
hWnd
,
adrx
,
adry
);

826 i‡(
bom
[
adrx
][
adry
].
ã°
)

829 i‡(
bom
[
adrx
][
adry
].
Êag
) {

830 
	`BombOut
(
hWnd
);

833 i‡(
bom
[
adrx
][
adry
].
vÆue
 != 0)

835 
NoAdr
[
ôime
].
x
 = 
adrx
;

836 
NoAdr
[
ôime
].
y
 = 
adry
;

837 
NoAdr
[
ôime
].
NY
 = 
TRUE
;

838 
ôime
++;

839 
bom
[
adrx
][
adry
].
ã°
 = 
TRUE
;

841 
	`SëRe˘
 (&
⁄îe˘
, 
adrx
*
WIDTH_BOX
+
off£tx
,

842 
adry
*
HEIGHT_BOX
+
HEIGHT_FACE
,

843 (
adrx
+1)*
WIDTH_BOX
+
off£tx
,

844 (
adry
+1)*
HEIGHT_BOX
+
HEIGHT_FACE
);

845 
	`InvÆid©eRe˘
 (
hWnd
, &
⁄îe˘
, 
FALSE
);

848 
hdc
 = 
	`GëDC
(
hWnd
);

849 
	`SórchGround
 (
hdc
, 
adrx
, 
adry
);

850 
	`Rñó£DC
(
hWnd
, 
hdc
);

853 i‡(
ôime
 =(
sg_boxnumx
*
sg_boxnumy
 - 
bombnum
))

854 
	`Föished
(
hWnd
);

858 
WM_MBUTTONDOWN
:

859 
ﬁdx
 = 
	`LOWORD
 (
lP¨am
);

860 
ﬁdy
 = 
	`HIWORD
 (
lP¨am
);

861 
adrx
 = (
ﬁdx
-
off£tx
)/
WIDTH_BOX
;

862 
adry
 = (
ﬁdy
-
HEIGHT_FACE
)/
HEIGHT_BOX
;

864 i‡(!
	`PtInRe˘2
 (&
bombªgi⁄
, 
ﬁdx
, 
ﬁdy
))

866 i‡(
Êag_bombout
)

868 i‡(
Êag_föished
)

871 i‡(!
bTimî
)

872 
bTimî
 = 
TRUE
;

876 
	`BŸhBuâ⁄DownProc
(
hWnd
,
adrx
,
adry
);

879 
WM_RBUTTONDOWN
:

881 
	`SëC≠tuª
 (
hWnd
);

883 
ﬁdx
 = 
	`LOWORD
 (
lP¨am
);

884 
ﬁdy
 = 
	`HIWORD
 (
lP¨am
);

885 
adrx
 = (
ﬁdx
-
off£tx
)/
WIDTH_BOX
;

886 
adry
 = (
ﬁdy
-
HEIGHT_FACE
)/
HEIGHT_BOX
;

888 i‡(!
	`PtInRe˘2
 (&
bombªgi⁄
, 
ﬁdx
, 
ﬁdy
))

890 i‡(
Êag_bombout
)

892 i‡(
Êag_föished
)

895 i‡(!
bTimî
)

896 
bTimî
 = 
TRUE
;

901 i‡(
	`GëShi·KeySètus
() & 0x00000100){

903 if(
mwCuºítBuâ⁄s
 & 
MWBUTTON_L
) {

904 
	`BŸhBuâ⁄DownProc
(
hWnd
,
adrx
,
adry
);

909 i‡(
bom
[
adrx
][
adry
].
ã°
)

911 i‡(!
bom
[
adrx
][
adry
].
hô
 )

913 
bom
[
adrx
][
adry
].
hô
 = 
TRUE
;

914 
À·bombnum
--;

917 { 
bom
[
adrx
][
adry
].
hô
 = 
FALSE
;

918 
À·bombnum
++;

920 
	`SëRe˘
 (&
⁄îe˘
, 
adrx
*
WIDTH_BOX
+
off£tx
,

921 
adry
*
HEIGHT_BOX
+
HEIGHT_FACE
,

922 (
adrx
+1)*
WIDTH_BOX
+
off£tx
,

923 (
adry
+1)*
HEIGHT_BOX
+
HEIGHT_FACE
);

924 
	`InvÆid©eRe˘
 (
hWnd
, &
⁄îe˘
, 
FALSE
);

925 
	`InvÆid©eRe˘
 (
hWnd
, &
bombnumbî
, 
FALSE
);

928 
WM_PAINT
:

929 
hdc
 = 
	`BegöPaöt
 (
hWnd
, &
ps
);

931 
	`•rötf
(
£c⁄ds
, "%03d", 
£c⁄d
);

932 
	`DøwDigô
(
hdc
, 
£c⁄ds
, 
TRUE
);

934 i‡(
À·bombnum
 >= 0){

935 
	`•rötf
(
bomn
,"%02d",
À·bombnum
);

936 
	`DøwDigô
(
hdc
, 
bomn
, 
FALSE
);

939 i‡(
Êag_föished
)

940 
	`DøwDIB
(
hdc
, 
x_Á˚
+1, 1, &
image_möed⁄e
);

942 
	`DøwMyBôm≠
 (
hdc
, 
fVÆidföÆÁ˚
?&
bmpföÆÁ˚
:
NULL
,

945 i‡(
Êag_bombout
)

946 
	`DøwDIB
(
hdc
, 
x_Á˚
, 0, &
image_möeÁ˚lo°
);

948 
	`DøwDIB
(
hdc
, 
x_Á˚
, 0, &
image_möeÁ˚
);

950 
i
 = 0; i < 
sg_boxnumx
; i++)

951 
j
 = 0; j < 
sg_boxnumy
; j++)

953 i‡(!
bom
[
i
][
j
].
ã°
 && !bom[i][j].
bombout
){

954 
	`SëTextCﬁ‹
 (
hdc
,
BLACK
);

955 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

956 
	`Døw3DUpFøme
(
hdc
,

957 
i
*
WIDTH_BOX
+
off£tx
,

958 
j
*
HEIGHT_BOX
+
HEIGHT_FACE
,

959 (
i
+1)*
WIDTH_BOX
+
off£tx
,

960 (
j
+1)*
HEIGHT_BOX
+
HEIGHT_FACE
,

961 
LTGRAY
);

965 i‡–
bom
[
i
][
j
].
hô
)

966 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+3, 
j
*
HEIGHT_BOX
+3+
HEIGHT_FACE
,

967 &
image_möeÊag
);

969 i‡(
bom
[
i
][
j
].
îr‹
) {

970 
	`C™˚l3DFøme
(
hdc
,
i
*
WIDTH_BOX
+
off£tx
,

971 
j
*
HEIGHT_BOX
+
HEIGHT_FACE
,

972 
WIDTH_BOX
,
HEIGHT_BOX
);

974 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+1, 
j
*
HEIGHT_BOX
+1+
HEIGHT_FACE
,

975 &
image_möehôÁl£
);

978 i‡(
bom
[
i
][
j
].
bombout
) {

979 
	`C™˚l3DFøme
(
hdc
,
i
*
WIDTH_BOX
+
off£tx
,

980 
j
*
HEIGHT_BOX
+
HEIGHT_FACE
,

981 
WIDTH_BOX
,
HEIGHT_BOX
);

983 
	`DøwDIB
(
hdc
, 
i
*
WIDTH_BOX
+
off£tx
+1, 
j
*
HEIGHT_BOX
+1+
HEIGHT_FACE
,

984 &
image_möebomb
);

988  
i
 = 0; i < 
ôime
; i++ )

990 
	`C™˚l3DFøme
(
hdc
,(
NoAdr
[
i
].
x
)*
WIDTH_BOX
+
off£tx
,

991 (
NoAdr
[
i
].
y
)*
HEIGHT_BOX
+
HEIGHT_FACE
,

992 
WIDTH_BOX
, 
HEIGHT_BOX
);

993 if(
NoAdr
[
i
].
NY
)

994 
	`TextVÆue
(
hdc
,(
NoAdr
[
i
].
x
)*
WIDTH_BOX
+
off£tx
,

995 (
NoAdr
[
i
].
y
)*
HEIGHT_BOX
+
HEIGHT_FACE
,

996 
bom
[
NoAdr
[
i
].
x
][NoAdr[i].
y
].
vÆue
);

998 
	`EndPaöt
 (
hWnd
, &
ps
);

1001 
WM_CLOSE
:

1002 
	`KûlTimî
(
hWnd
, 
ID_CLOCK
);

1003 
	`De°royWödow
 (
hWnd
);

1004 
	`Po°QuôMesßge
 (0);

1007  
	`DefWödowProc
(
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1010 
	`InôMyWöCª©eInfo
(
PMAINWINCREATE
 
pCª©eInfo
)

1012 
pCª©eInfo
->
dwStyÀ
 = 
WS_CAPTION
 | 
WS_BORDER
 | 
WS_SYSMENU
 | 
WS_VISIBLE
;

1013 
pCª©eInfo
->
•C≠ti⁄
="Microwindows Minesweeper";

1014 
pCª©eInfo
->
hMíu
 = 0;

1015 
pCª©eInfo
->
hCurs‹
 = 0;

1016 
pCª©eInfo
->
hIc⁄
 = 0;

1017 
pCª©eInfo
->
MaöWödowProc
 = 
Te°MyWöProc
;

1018 
pCª©eInfo
->
lx
 = 0;

1019 
pCª©eInfo
->
ty
 = 0;

1020 
pCª©eInfo
->
rx
 = 
wöwidth
;

1021 
pCª©eInfo
->
by
 = 
wöheight
;

1022 
pCª©eInfo
->
iBkCﬁ‹
 = 
LTGRAY
;

1023 
pCª©eInfo
->
dwAddD©a
 = 0;

1024 
pCª©eInfo
->
hHo°ög
 = 
HWND_DESKTOP
;

1027 * 
	`Te°MyWödow
(* 
d©a
)

1029 
MSG
 
Msg
;

1030 
MAINWINCREATE
 
Cª©eInfo
;

1031 
HWND
 
hMaöWnd
;

1033 
	`InôMyWöCª©eInfo
(&
Cª©eInfo
);

1035 
hMaöWnd
 = 
	`Cª©eMaöWödow
(&
Cª©eInfo
);

1037 i‡(
hMaöWnd
 == 0)

1038  
NULL
;

1040 
	`ShowWödow
(
hMaöWnd
,
SW_SHOWNORMAL
);

1041  
	`GëMesßge
(&
Msg
, 
NULL
, 0, 0) ) {

1042 
	`Tøn¶©eMesßge
 (&
Msg
);

1043 
	`Di•©chMesßge
(&
Msg
);

1046  
NULL
;

1049 
WINAPI


1050 
	`WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

1051 
nShowCmd
)

1053 
	`Te°MyWödow
 (
NULL
);

1058 
LRESULT
 
	`AbHo°edWöProc
 (
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1060 
PAINTSTRUCT
 
ps
;

1062 
mesßge
) {

1063 
WM_CREATE
:

1066 
WM_PAINT
:

1068 
HDC
 
hdc
;

1070 
hdc
 = 
	`BegöPaöt
 (
hWnd
, &
ps
);

1071 
	`SëBkCﬁ‹
(
hdc
,
LTGRAY
);

1072 
	`TextOut
 (
hdc
, 10, 25, "Minesweeper Ver 0.9 (1999/08/27)", -1);

1073 
	`TextOut
 (
hdc
, 10, 55,

1075 
	`TextOut
 (
hdc
, 10, 75,

1077 
	`EndPaöt
 (
hWnd
, &
ps
);

1081 
WM_CLOSE
:

1082 
	`De°royWödow
 (
hWnd
);

1086  
	`DefWödowProc
(
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1088 
	`InôAbHo°edCª©eInfo
 (
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
)

1090 
pCª©eInfo
->
dwStyÀ
 = 
WS_BORDER
 | 
WS_CAPTION
 | 
WS_VISIBLE
;

1091 
pCª©eInfo
->
•C≠ti⁄
 = "Theábout window" ;

1092 
pCª©eInfo
->
hMíu
 = 0;

1093 
pCª©eInfo
->
hCurs‹
 = 0;

1094 
pCª©eInfo
->
hIc⁄
 = 0;

1095 
pCª©eInfo
->
MaöWödowProc
 = 
AbHo°edWöProc
;

1096 
pCª©eInfo
->
lx
 = 100;

1097 
pCª©eInfo
->
ty
 = 200;

1098 
pCª©eInfo
->
rx
 = 540;

1099 
pCª©eInfo
->
by
 = 390;

1100 
pCª©eInfo
->
iBkCﬁ‹
 = 
LTGRAY
;

1101 
pCª©eInfo
->
dwAddD©a
 = 0;

1102 
pCª©eInfo
->
hHo°ög
 = hHosting;

1106 
	#IDC_RESET
 110

	)

1107 
LRESULT
 
	`HighSc‹eWöProc
 (
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1109 
PAINTSTRUCT
 
ps
;

1110 
HWND
 
hRESET
, 
hOK
;

1112 
mesßge
) {

1113 
WM_CREATE
:

1114 
hRESET
 = 
	`Cª©eWödowEx
 (0L, "button",

1116 
WS_CHILD
 | 
BS_PUSHBUTTON
 | 
WS_VISIBLE
,

1118 
hWnd
, (
HMENU
)
IDC_RESET
, 0, 0L);

1120 
hOK
 = 
	`Cª©eWödowEx
 (0L, "button",

1122 
WS_CHILD
 | 
BS_PUSHBUTTON
 | 
WS_VISIBLE
,

1124 
hWnd
, (
HMENU
)
IDOK
, 0, 0L);

1127 
WM_COMMAND
:

1129 
id
 = 
	`LOWORD
(
wP¨am
);

1130 
i
;

1132 i‡(
id
 =
IDC_RESET
 && 
	`HIWORD
(
wP¨am
Ë=
BN_CLICKED
) {

1133 
i
 = 0; i < 3; i++){

1134 
sc‹e
[
i
].
highsc‹e
 = 999;

1135 
	`°r˝y
(
sc‹e
[
i
].
«me
, "unknown");

1139 
FILE
* 
pHighsc‹e
;

1140 i‡((
pHighsc‹e
 = 
	`f›í
("res/.highscore.bomb", "w+"))){

1141 
i
 = 0; i < 3; i++)

1142 
	`Ârötf
(
pHighsc‹e
, "%d, %s\n",

1143 
sc‹e
[
i
].
highsc‹e
,sc‹e[i].
«me
);

1144 
	`f˛o£
(
pHighsc‹e
);

1147 
	`InvÆid©eRe˘
(
hWnd
, 
NULL
, 
TRUE
);

1149 i‡(
id
 =
IDOK
 && 
	`HIWORD
(
wP¨am
Ë=
BN_CLICKED
)

1150 
	`Po°Mesßge
(
hWnd
, 
WM_CLOSE
, 0, 0);

1154 
WM_PAINT
:

1156 
HDC
 
hdc
;

1157 
buf„r
[50];

1158 
i
;

1160 
hdc
 = 
	`BegöPaöt
 (
hWnd
, &
ps
);

1161 
	`SëBkCﬁ‹
(
hdc
,
LTGRAY
);

1162 
	`TextOut
(
hdc
, 130, 15, "”¢–€∞Ò", -1);

1163 
	`TextOut
(
hdc
, 15, 45, "SMALL" , -1);

1164 
	`TextOut
(
hdc
, 15, 75, "MIDDLE", -1 );

1165 
	`TextOut
(
hdc
, 15, 105, "LARGE", -1 );

1166 
i
 = 0; i < 3; i++){

1167 
	`•rötf
(
buf„r
, "%3d %s",

1168 
sc‹e
[
i
].
highsc‹e
, sc‹e[i].
«me
);

1169 
	`TextOut
(
hdc
, 150, 45+
i
*30, 
buf„r
, -1);

1171 
	`EndPaöt
 (
hWnd
, &
ps
);

1175 
WM_CLOSE
:

1176 
	`De°royWödow
 (
hRESET
);

1177 
	`De°royWödow
 (
hOK
);

1178 
	`De°royWödow
 (
hWnd
);

1179 
hHighsc‹e
 = 
HWND_DESKTOP
;

1183  
	`DefWödowProc
(
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1186 
	`InôHighSc‹eCª©eInfo
 (
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
)

1188 
pCª©eInfo
->
dwStyÀ
 = 
WS_BORDER
 | 
WS_CAPTION
;

1189 
pCª©eInfo
->
•C≠ti⁄
 = "High Score" ;

1190 
pCª©eInfo
->
hMíu
 = 0;

1191 
pCª©eInfo
->
hCurs‹
 = 0;

1192 
pCª©eInfo
->
hIc⁄
 = 0;

1193 
pCª©eInfo
->
MaöWödowProc
 = 
HighSc‹eWöProc
;

1194 
pCª©eInfo
->
lx
 = 100;

1195 
pCª©eInfo
->
ty
 = 200;

1196 
pCª©eInfo
->
rx
 = 470;

1197 
pCª©eInfo
->
by
 = 410;

1198 
pCª©eInfo
->
iBkCﬁ‹
 = 
LTGRAY
;

1199 
pCª©eInfo
->
dwAddD©a
 = 0;

1200 
pCª©eInfo
->
hHo°ög
 = hHosting;

1205 
	#IDC_CTRL_NAME
 100

	)

1207 
LRESULT
 
	`C⁄gøtuœti⁄WöProc
 (
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1209 
HWND
 
hProm±
, 
hName
, 
hOK
;

1211 
mesßge
) {

1212 
WM_CREATE
:

1214 
hProm±
 = 
	`Cª©eWödow
 ("static",

1216 
SS_SIMPLE
 | 
WS_VISIBLE
,

1217 
IDC_STATIC
,

1218 10, 10, 185, 24, 
hWnd
, 0);

1219 
hName
 = 
	`Cª©eWödow
 ("edit",

1220 
	`gëlogö
(),

1221 
WS_CHILD
 | 
WS_VISIBLE
 | 
WS_BORDER
,

1222 
IDC_CTRL_NAME
,

1223 10, 40, 175, 26, 
hWnd
, 0);

1225 
hOK
 = 
	`Cª©eWödow
 ("button",

1227 
WS_CHILD
 | 
BS_PUSHBUTTON
 | 
WS_VISIBLE
,

1229 
hWnd
, (
HMENU
)
IDOK
, 0, 0L);

1232 
WM_COMMAND
:

1234 
id
 = 
	`LOWORD
(
wP¨am
);

1236 i‡(
id
 =
IDOK
 && 
	`HIWORD
(
wP¨am
Ë=
BN_CLICKED
) {

1237 
sc‹e
[
Êag_size
].
highsc‹e
 = 
£c⁄d
;

1238 
	`SídMesßge
 (
hName
, 
WM_GETTEXT
,

1239 19, (
LPARAM
)
sc‹e
[
Êag_size
].
«me
);

1241 
FILE
* 
pHighsc‹e
;

1242 
i
;

1243 i‡((
pHighsc‹e
 = 
	`f›í
("res/.highscore.bomb", "w+"))){

1244 
i
 = 0; i < 3; i++)

1245 
	`Ârötf
(
pHighsc‹e
, "%d, %s\n",

1246 
sc‹e
[
i
].
highsc‹e
,sc‹e[i].
«me
);

1247 
	`f˛o£
(
pHighsc‹e
);

1250 
	`Po°Mesßge
 (
hWnd
, 
WM_CLOSE
, 0, 0);

1254 
WM_CLOSE
:

1255 
	`De°royWödow
 (
hProm±
);

1256 
	`De°royWödow
 (
hName
);

1257 
	`De°royWödow
 (
hOK
);

1258 
	`De°royWödow
 (
hWnd
);

1259 
hC⁄gøtuœã
 = 
HWND_DESKTOP
;

1263  
	`DefWödowProc
(
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1266 
	`InôC⁄gøtuœti⁄Cª©eInfo
 (
HWND
 
hHo°ög
, 
PMAINWINCREATE
 
pCª©eInfo
)

1268 
pCª©eInfo
->
dwStyÀ
 = 
WS_BORDER
 | 
WS_CAPTION
 | 
WS_VISIBLE
;

1269 
pCª©eInfo
->
•C≠ti⁄
 = "Congratulation" ;

1270 
pCª©eInfo
->
hMíu
 = 0;

1271 
pCª©eInfo
->
hCurs‹
 = 0;

1272 
pCª©eInfo
->
hIc⁄
 = 0;

1273 
pCª©eInfo
->
MaöWödowProc
 = 
C⁄gøtuœti⁄WöProc
;

1274 
pCª©eInfo
->
lx
 = 50;

1275 
pCª©eInfo
->
ty
 = 60;

1276 
pCª©eInfo
->
rx
 = 255;

1277 
pCª©eInfo
->
by
 = 200;

1278 
pCª©eInfo
->
iBkCﬁ‹
 = 
LTGRAY
;

1279 
pCª©eInfo
->
dwAddD©a
 = 0;

1280 
pCª©eInfo
->
hHo°ög
 = hHosting;

1283 
HWND


1284 
	`Cª©eMaöWödow
(
PMAINWINCREATE
 
pCª©eInfo
)

1286 
HWND
 
hwnd
;

1287 
RECT
 
rc
;

1288 
WNDCLASS
 
wc
;

1290 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_HREDRAW
 | 
CS_VREDRAW
;

1291 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
pCª©eInfo
->
MaöWödowProc
;

1292 
wc
.
cbClsExåa
 = 0;

1293 
wc
.
cbWndExåa
 = 0;

1294 
wc
.
hIn°™˚
 = 0;

1295 
wc
.
hIc⁄
 = 
pCª©eInfo
->hIcon;

1296 
wc
.
hCurs‹
 = 
pCª©eInfo
->hCursor;

1297 
wc
.
hbrBackground
 = (
HBRUSH
)
	`Cª©eSﬁidBrush
(
pCª©eInfo
->
iBkCﬁ‹
);

1298 
wc
.
ÕszMíuName
 = 0;

1299 
wc
.
ÕszCœssName
 = 
pCª©eInfo
->
•C≠ti⁄
;

1300 
	`Regi°îCœss
(&
wc
);

1302 
	`SëRe˘
(&
rc
, 
pCª©eInfo
->
lx
,ÖCª©eInfo->
ty
,ÖCª©eInfo->
rx
,

1303 
pCª©eInfo
->
by
);

1304 
	`Adju°WödowRe˘Ex
(&
rc
, 
pCª©eInfo
->
dwStyÀ
, 
FALSE
, 0L);

1306 
hwnd
 = 
	`Cª©eWödowEx
(0L, 
pCª©eInfo
->
•C≠ti⁄
,

1307 
pCª©eInfo
->
•C≠ti⁄
,

1308 
pCª©eInfo
->
dwStyÀ
,

1309 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.À·,Ñc.
bŸtom
-rc.top,

1310 
pCª©eInfo
->
hHo°ög
,

1311 (
HMENU
)0, (
HINSTANCE
)0,

1312 (
PVOID
)
pCª©eInfo
->
dwAddD©a
);

1313  
hwnd
;

1316 
BOOL


1317 
	`PtInRe˘2
(c⁄° 
RECT
 *
Õrc
, 
x
, 
y
)

1319 
POINT
 
p
;

1321 
p
.
x
 = x;

1322 
p
.
y
 = y;

1323  
	`PtInRe˘
(
Õrc
, 
p
);

1327 
	`Døw3DUpFøme
(
HDC
 
hDC
, 
l
, 
t
, 
r
, 
b
, 
fûlc
)

1329 
RECT
 
rc
;

1330 
HBRUSH
 
hbr
;

1332 
	`SëRe˘
(&
rc
, 
l
, 
t
, 
r
, 
b
);

1333 
	`Døw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

1334 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

1335 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
),

1336 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
));

1337 
	`InÊ©eRe˘
(&
rc
, -1, -1);

1338 
	`Døw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

1339 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

1340 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
),

1341 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
));

1342 
	`InÊ©eRe˘
(&
rc
, -1, -1);

1344 
hbr
 = 
	`Cª©eSﬁidBrush
(
LTGRAY
);

1345 
	`FûlRe˘
(
hDC
, &
rc
, 
hbr
);

1346 
	`DñëeObje˘
(
hbr
);

	@demos/mwin/mstretch.c

6 
	#MWINCLUDECOLORS


	)

7 
	~"wödows.h
"

8 
	~"devi˚.h
"

10 
MWIMAGEHDR
 
image_≥nguö
;

12 
PMWIMAGEHDR
 
	gimage
 = &
image_≥nguö
;

14 
	#APPCHILD
 "ã°2"

	)

17 
LRESULT
 
CALLBACK
 
ChûdWndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

20 
	$Regi°îAµCœss
()

22 
WNDCLASS
 
wc
;

24 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

25 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
ChûdWndProc
;

26 
wc
.
cbClsExåa
 = 0;

27 
wc
.
cbWndExåa
 = 0;

28 
wc
.
hIn°™˚
 = 0;

29 
wc
.
hIc⁄
 = 0;

30 
wc
.
hCurs‹
 = 0;

31 
wc
.
hbrBackground
 = (
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

32 
wc
.
ÕszMíuName
 = 
NULL
;

33 
wc
.
ÕszCœssName
 = 
APPCHILD
;

34  
	`Regi°îCœss
–&
wc
);

35 
	}
}

37 
LRESULT
 
CALLBACK


38 
	$ChûdWndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

40 
HDC
 
hdcMem
;

41 
HBITMAP
 
hbmp
, 
hbmpOrg
;

42 
RECT
 
rc
;

43 
PAINTSTRUCT
 
ps
;

45 
msg
) {

46 
WM_PAINT
:

47 
	`BegöPaöt
(
hwnd
, &
ps
);

48 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

51 
hdcMem
 = 
	`Cª©eCom∑tibÀDC
(
ps
.
hdc
);

52 
hbmp
 = 
	`Cª©eCom∑tibÀBôm≠
(
hdcMem
, 
image
->
width
, image->
height
);

53 
hbmpOrg
 = 
	`Sñe˘Obje˘
(
hdcMem
, 
hbmp
);

56 
	`DøwDIB
(
hdcMem
, 0, 0, 
image
);

59 
	`SåëchB…
(
ps
.
hdc
, 0, 0, 
rc
.
right
,Ñc.
bŸtom
, 
hdcMem
,

60 0, 0, 
image
->
width
, image->
height
, 
MWROP_SRCCOPY
);

61 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdcMem
, 
hbmpOrg
));

62 
	`DñëeDC
(
hdcMem
);

63 
	`EndPaöt
(
hwnd
, &
ps
);

66  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

69 
	}
}

71 
WINAPI


72 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

73 
nShowCmd
)

75 
MSG
 
msg
;

76 
RECT
 
rc
;

78 
	`Regi°îAµCœss
();

79 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
rc
);

82 
	`Cª©eWödowEx
(0L, 
APPCHILD
, "", 
WS_BORDER
 | 
WS_VISIBLE
,

84 
	`GëDeskt›Wödow
(), (
HMENU
)1000, 
NULL
, NULL);

86 
	`Cª©eWödowEx
(0L, 
APPCHILD
, "", 
WS_BORDER
 | 
WS_VISIBLE
,

88 
	`GëDeskt›Wödow
(), (
HMENU
)1001, 
NULL
, NULL);

91  
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

92 
	`Tøn¶©eMesßge
(&
msg
);

93 
	`Di•©chMesßge
(&
msg
);

96 
	}
}

	@demos/mwin/mterm.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<f˙é.h
>

12 
	~<uni°d.h
>

13 
	~<î∫o.h
>

14 
	~<sig«l.h
>

15 
	#MWINCLUDECOLORS


	)

16 
	~"wödows.h
"

17 
	~"wöã∫.h
"

18 
	~"wötoﬁs.h
"

20 
	#COLS
 80

	)

21 
	#ROWS
 24

	)

22 
	#XMARGIN
 2

	)

23 
	#YMARGIN
 2

	)

24 
	#FGCOLOR
 
GREEN


	)

25 
	#BKCOLOR
 
BLACK


	)

26 
	#FONTNAME
 
SYSTEM_FIXED_FONT


	)

28 
	#APPCLASS
 "mãrm"

	)

30 #i‡
DOS_DJGPP


31 
	#kûÕg
 
kûl


	)

32 
	#SIGCHLD
 17

	)

36 
LRESULT
 
CALLBACK
 
WndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

37 
EmOutCh¨
(
HWND
 
hwnd
, 
ch
);

38 
Cª©ePtyShñl
();

39 
RódPtyShñl
(
fd
, *
buf
, 
cou¡
);

40 
WrôePtyShñl
(
fd
, *
buf
, 
cou¡
);

41 
Clo£PtyShñl
(
fd
);

44 
	gâyfd
 = -1;

45 
	gxpos
 = 
XMARGIN
;

46 
	gypos
 = 
YMARGIN
;

47 
	gnCh¨Width
, 
	gnCh¨Height
;

48 
	gnS¸ìnWidth
, 
	gnS¸ìnHeight
;

51 
	$Regi°îAµCœss
()

53 
WNDCLASS
 
wc
;

55 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

56 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

57 
wc
.
cbClsExåa
 = 0;

58 
wc
.
cbWndExåa
 = 0;

59 
wc
.
hIn°™˚
 = 0;

60 
wc
.
hIc⁄
 = 0;

61 
wc
.
hCurs‹
 = 0;

62 
wc
.
hbrBackground
 = 
	`Cª©eSﬁidBrush
(
BKCOLOR
);

63 
wc
.
ÕszMíuName
 = 
NULL
;

64 
wc
.
ÕszCœssName
 = 
APPCLASS
;

65 
	`Regi°îCœss
–&
wc
);

67 
	}
}

69 
HWND


70 
	$Cª©eAµWödow
()

72 
HWND
 
hwnd
;

73 
HDC
 
hdc
;

74 
w
, 
h
;

75 
RECT
 
rc
;

77 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
rc
);

78 
w
 = 
rc
.
right
 - 40;

79 
h
 = 
rc
.
bŸtom
;

82 
hdc
 = 
	`GëDC
(
NULL
);

83 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONTNAME
));

84 
	`SëRe˘
(&
rc
, 0, 0, 0, 0);

85 
nCh¨Height
 = 
	`DøwText
(
hdc
, "m", 1, &
rc
, 
DT_CALCRECT
);

86 
nCh¨Width
 = 
rc
.
right
;

87 
nS¸ìnWidth
 = 
	`mö
(
w
, 
nCh¨Width
*
COLS
);

88 
nS¸ìnHeight
 = 
	`mö
(
h
, 
nCh¨Height
*
ROWS
);

89 
	`Rñó£DC
(
NULL
, 
hdc
);

91 
hwnd
 = 
	`Cª©eWödowEx
(0L, 
APPCLASS
,

93 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

94 
CW_USEDEFAULT
, CW_USEDEFAULT,

95 
nS¸ìnWidth
+4, 
nS¸ìnHeight
+24,

96 
NULL
, (
HMENU
)1, NULL, NULL);

98  
hwnd
;

99 
	}
}

101 
LRESULT
 
CALLBACK


102 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

104 
ch
;

105 
HDC
 
hdc
;

106 
RECT
 
rc
;

107 
PAINTSTRUCT
 
ps
;

109 
msg
) {

110 
WM_CREATE
:

111 
âyfd
 = 
	`Cª©ePtyShñl
();

114 
	`MwRegi°îFdI≈ut
(
hwnd
, 
âyfd
);

115 
xpos
 = 
XMARGIN
;

116 
ypos
 = 
YMARGIN
;

119 
WM_DESTROY
:

120 
	`MwUƒegi°îFdI≈ut
(
hwnd
, 
âyfd
);

121 
	`Clo£PtyShñl
(
âyfd
);

124 
WM_CHAR
:

125 
ch
 = ()
wp
;

127 if(
âyfd
 == -1) {

128 
	`EmOutCh¨
(
hwnd
, 
ch
);

129 if(
ch
 == '\r')

130 
	`EmOutCh¨
(
hwnd
, '\n');

132 
	`WrôePtyShñl
(
âyfd
, &
ch
, 1);

135 
WM_FDINPUT
:

136 if(
	`RódPtyShñl
(
âyfd
, &
ch
, 1) == 1)

137 
	`EmOutCh¨
(
hwnd
, 
ch
);

140 
WM_PAINT
:

141 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

142 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

143 
	`Døw3dIn£t
(
hdc
, 0, 0, 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
);

144 
	`EndPaöt
(
hwnd
, &
ps
);

148  
	`DefWödowProc
(
hwnd
, 
msg
, 
wp
, 
Õ
);

151 
	}
}

153 
WINAPI


154 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

155 
nShowCmd
)

157 
MSG
 
msg
;

158 
MWIMAGEHDR
 
image_ˇr8
;

160 
	`Regi°îAµCœss
();

161 
	`MwSëDeskt›WÆÕ≠î
(&
image_ˇr8
);

163 
	`Cª©eAµWödow
();

166 
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

167 
	`Tøn¶©eMesßge
(&
msg
);

168 
	`Di•©chMesßge
(&
msg
);

171 
	}
}

174 
	$EmOutCh¨
(
HWND
 
hwnd
, 
ch
)

176 
HDC
 
hdc
;

177 
RECT
 
rc
;

179 
ch
) {

181 
xpos
 = 
XMARGIN
;

184 
ypos
 +
nCh¨Height
;

185 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

186 if(
ypos
 > (
ROWS
-1)*
nCh¨Height
 + 
YMARGIN
) {

187 
ypos
 -
nCh¨Height
;

190 
hdc
 = 
	`GëDC
(
hwnd
);

191 
	`BôB…
(
hdc
, 
XMARGIN
, 
YMARGIN
, 
rc
.
right
-XMARGIN*2,

192 
rc
.
bŸtom
-
nCh¨Height
-
YMARGIN
*2,

193 
hdc
, 
XMARGIN
, 
nCh¨Height
+
YMARGIN
, 
SRCCOPY
);

194 
rc
.
t›
 = 
ypos
;

195 
rc
.
À·
 +
XMARGIN
;

196 
rc
.
right
 -
XMARGIN
;

197 
rc
.
bŸtom
 -
YMARGIN
;

198 
	`FûlRe˘
(
hdc
, &
rc
,

199 (
HBRUSH
)
	`GëCœssL⁄g
(
hwnd
, 
GCL_HBRBACKGROUND
));

200 
	`Rñó£DC
(
hwnd
, 
hdc
);

204 
	`wrôe
(
STDERR_FILENO
, "\007", 1);

207 
xpos
 +
nCh¨Width
;

208 (
xpos
/
nCh¨Width
) & 7)

209 
	`EmOutCh¨
(
hwnd
, ' ');

212 if(
xpos
 <
XMARGIN
)

214 
xpos
 -
nCh¨Width
;

215 
	`EmOutCh¨
(
hwnd
, ' ');

216 
xpos
 -
nCh¨Width
;

221 
hdc
 = 
	`GëDC
(
hwnd
);

222 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONTNAME
));

223 
	`SëBkCﬁ‹
(
hdc
, 
BKCOLOR
);

224 
	`SëTextCﬁ‹
(
hdc
, 
FGCOLOR
);

225 
	`SëRe˘
(&
rc
, 
xpos
, 
ypos
, xpos+
nCh¨Width
, ypos+
nCh¨Height
);

226 
	`ExtTextOut
(
hdc
, 
xpos
, 
ypos
, 
ETO_OPAQUE
, &
rc
, (*)&
ch
, 1, 
NULL
);

227 
	`Rñó£DC
(
hwnd
, 
hdc
);

228 
xpos
 +
nCh¨Width
;

229 if(
xpos
 > (
COLS
-1)*
nCh¨Width
) {

230 
xpos
 = 
XMARGIN
;

231 
	`EmOutCh¨
(
hwnd
, '\n');

233 
	}
}

235 #i‡
ELKS


236 
	#SHELL
 "/bö/ßsh"

	)

238 #i‡
DOS_DJGPP


239 
	#SHELL
 "bash"

	)

241 
	#SHELL
 "/bö/sh"

	)

245 
	gpid
;

248 
	$±ysig«Àd
(
signo
)

250 
signo
) {

251 
SIGINT
:

252 #i‡!
ELKS


254 
	`kûÕg
(
pid
, 
SIGINT
);

257 
SIGCHLD
:

258 
	`De°royWödow
(
	`GëA˘iveWödow
());

259 
	`Cª©eAµWödow
();

262 
	`Ârötf
(
°dîr
, "Unˇughàsig«»%d\n", 
signo
);

263 
	}
}

269 
	$Cª©ePtyShñl
()

271 
n
 = 0;

272 
tfd
;

273 
±y_«me
[12];

274 * 
¨gv
[2];

276 
agaö
:

277 
	`•rötf
(
±y_«me
, "/dev/±yp%d", 
n
);

278 i‡((
tfd
 = 
	`›í
(
±y_«me
, 
O_RDWR
 | 
O_NONBLOCK
)) < 0) {

279 i‡((
î∫o
 =
EBUSY
 ||Éºnÿ=
EIO
Ë&& 
n
 < 10) {

280 ++
n
;

281 
agaö
;

283 
	`Ârötf
(
°dîr
, "C™'à¸óãÖty %s\n", 
±y_«me
);

286 
	`sig«l
(
SIGCHLD
, 
±ysig«Àd
);

287 
	`sig«l
(
SIGINT
, 
±ysig«Àd
);

288 i‡((
pid
 = 
	`f‹k
()) == -1) {

289 
	`Ârötf
(
°dîr
, "NoÖrocesses\n");

292 i‡(!
pid
) {

293 
	`˛o£
(
STDIN_FILENO
);

294 
	`˛o£
(
STDOUT_FILENO
);

295 
	`˛o£
(
STDERR_FILENO
);

296 
	`˛o£
(
tfd
);

298 
	`£tsid
();

299 
±y_«me
[5] = 't';

300 i‡((
tfd
 = 
	`›í
(
±y_«me
, 
O_RDWR
)) < 0) {

301 
	`Ârötf
(
°dîr
, "Chûd: C™'à›íÖty %s\n", 
±y_«me
);

302 
	`exô
(1);

304 
	`dup2
(
tfd
, 
STDIN_FILENO
);

305 
	`dup2
(
tfd
, 
STDOUT_FILENO
);

306 
	`dup2
(
tfd
, 
STDERR_FILENO
);

308 
¨gv
[0] = 
SHELL
;

309 
¨gv
[1] = 
NULL
;

310 
	`execv
(
¨gv
[0],árgv);

311 
	`exô
(1);

313  
tfd
;

314 
	}
}

317 
	$RódPtyShñl
(
fd
, *
buf
, 
cou¡
)

319  
	`ªad
(
fd
, 
buf
, 
cou¡
);

320 
	}
}

323 
	$WrôePtyShñl
(
fd
, *
buf
, 
cou¡
)

325  
	`wrôe
(
fd
, 
buf
, 
cou¡
);

326 
	}
}

329 
	$Clo£PtyShñl
(
fd
)

331 if(
âyfd
 != -1)

332 
	`˛o£
(
fd
);

333 
	}
}

	@demos/mwin/mtest.c

2 
	~<wödows.h
>

4 
LRESULT
 
CALLBACK
 
w¥oc
(
HWND
,
UINT
,
WPARAM
,
LPARAM
);

6 
WINAPI
 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
,

7 
PSTR
 
szCmdLöe
, 
iCmdShow
)

9 
szAµName
[]="HolaWin";

10 
HWND
 
hwnd
;

11 
MSG
 
msg
;

12 
WNDCLASS
 
wnd˛ass
;

14 
wnd˛ass
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_HREDRAW
 | 
CS_VREDRAW
;

15 
wnd˛ass
.
Õ‚WndProc
 = (
WNDPROC
)
w¥oc
;

16 
wnd˛ass
.
cbClsExåa
 =0;

17 
wnd˛ass
.
cbWndExåa
 =0;

18 
wnd˛ass
.
hIn°™˚
 =0;

19 
wnd˛ass
.
hIc⁄
 =0;

20 
wnd˛ass
.
hCurs‹
 =0;

21 
wnd˛ass
.
hbrBackground
 =(
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

22 
wnd˛ass
.
ÕszMíuName
 =
NULL
;

23 
wnd˛ass
.
ÕszCœssName
 = 
szAµName
;

25 
	`Regi°îCœss
(&
wnd˛ass
);

26 
hwnd
=
	`Cª©eWödowEx
(0L,

27 
szAµName
,

29 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

30 
CW_USEDEFAULT
,

31 
CW_USEDEFAULT
,

34 
NULL
,

35 
NULL
,

36 
NULL
,

37 
NULL
);

40 
	`ShowWödow
(
hwnd
,
iCmdShow
);

41 
	`Upd©eWödow
(
hwnd
);

43 
	`GëMesßge
(&
msg
,
NULL
,0,0)) {

44 
	`Tøn¶©eMesßge
(&
msg
);

45 
	`Di•©chMesßge
(&
msg
);

47  
msg
.
wP¨am
;

48 
	}
}

49 
LRESULT
 
CALLBACK
 
	$w¥oc
(
HWND
 
hwnd
, 
UINT
 
iMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

51 
HDC
 
hdc
;

52 
PAINTSTRUCT
 
ps
;

53 
RECT
 
ª˘
;

55 
iMsg
) {

56 
WM_CREATE
:

58 
WM_PAINT
:

60 
hdc
=
	`BegöPaöt
(
hwnd
,&
ps
);

61 
	`GëClõ¡Re˘
(
hwnd
,&
ª˘
);

62 
	`DøwText
(
hdc
, "Hﬁa, NOS §æ§ø§§«—", -1, &
ª˘
,

63 
DT_SINGLELINE
|
DT_CENTER
|
DT_VCENTER
);

64 
	`EndPaöt
(
hwnd
,&
ps
);

66 
WM_DESTROY
:

67 
	`Po°QuôMesßge
(0);

70  
	`DefWödowProc
(
hwnd
,
iMsg
,
wP¨am
,
lP¨am
);

73 
	}
}

	@demos/mwin/mtest2.c

1 
	#MWINCLUDECOLORS


	)

2 
	~<wödows.h
>

4 
LRESULT
 
CALLBACK
 
w¥oc
(
HWND
,
UINT
,
WPARAM
,
LPARAM
);

6 
WINAPI
 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
,

7 
PSTR
 
szCmdLöe
, 
iCmdShow
)

9 
szAµName
[]="HolaWin";

10 
HWND
 
hwnd
;

11 
MSG
 
msg
;

12 
WNDCLASS
 
wnd˛ass
;

14 
width
, 
height
;

15 
RECT
 
r
;

16 
HWND
 
hli°
,
hedô
;

18 
	`GëWödowRe˘
(
	`GëDeskt›Wödow
(), &
r
);

19 
width
 = 
height
 = 
r
.
right
 / 2;

21 
	`MwRegi°îBuâ⁄C⁄åﬁ
(
NULL
);

22 
	`MwRegi°îEdôC⁄åﬁ
(
NULL
);

23 
	`MwRegi°îLi°boxC⁄åﬁ
(
NULL
);

24 
	`MwRegi°îProgªssB¨C⁄åﬁ
(
NULL
);

25 
	`MwRegi°îSèticC⁄åﬁ
(
NULL
);

26 
	`MwRegi°îComboboxC⁄åﬁ
(
NULL
);

27 
	`MwRegi°îS¸ﬁlb¨C⁄åﬁ
(
NULL
);

29 
wnd˛ass
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_HREDRAW
 | 
CS_VREDRAW
;

30 
wnd˛ass
.
Õ‚WndProc
 = (
WNDPROC
)
w¥oc
;

31 
wnd˛ass
.
cbClsExåa
 =0;

32 
wnd˛ass
.
cbWndExåa
 =0;

33 
wnd˛ass
.
hIn°™˚
 =0;

34 
wnd˛ass
.
hIc⁄
 =0;

35 
wnd˛ass
.
hCurs‹
 =0;

36 
wnd˛ass
.
hbrBackground
 =(
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

37 
wnd˛ass
.
ÕszMíuName
 =
NULL
;

38 
wnd˛ass
.
ÕszCœssName
 = 
szAµName
;

40 
	`Regi°îCœss
(&
wnd˛ass
);

41 
hwnd
=
	`Cª©eWödowEx
(0L,

42 
szAµName
,

44 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

45 
CW_USEDEFAULT
,

46 
CW_USEDEFAULT
,

47 
width
,

48 
height
,

49 
NULL
,

50 
NULL
,

51 
NULL
,

52 
NULL
);

53 #i‡!
ELKS


55 
hedô
=
	`Cª©eWödowEx
(0L, "EDIT",

57 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

58 
width
 * 5 / 8, 10, 100, 18,

59 
hwnd
, (
HMENU
)5, 
NULL
, NULL);

61 
	`Cª©eWödowEx
(0L, "PROGBAR",

63 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

64 
width
 * 5 / 8, 32, 100, 18,

65 
hwnd
, (
HMENU
)6, 
NULL
, NULL);

67 
hli°
 = 
	`Cª©eWödowEx
(0L, "LISTBOX",

69 
WS_VSCROLL
|

71 
WS_BORDER
|
WS_CHILD
 | 
WS_VISIBLE
,

72 
width
 * 5 / 8, 54, 100, 54,

73 
hwnd
, (
HMENU
)7, 
NULL
, NULL);

75 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Cherry");

76 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Apple");

77 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Orange");

78 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Banana");

79 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Smooth");

80 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"00000");

81 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"11111");

82 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"22222");

83 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"33333");

84 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"44444");

85 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"55555");

86 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"66666");

87 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"77777");

88 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"88888");

89 
	`SídMesßge
(
hli°
, 
LB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"99999");

91 
	`Cª©eWödowEx
(0L, "BUTTON",

93 
WS_CHILD
 | 
WS_VISIBLE
,

94 
width
 * 5 / 8 + 50, 106+16+6, 50, 14,

95 
hwnd
, (
HMENU
)8, 
NULL
, NULL);

97 
	`Cª©eWödowEx
(0L, "STATIC",

99 
WS_CHILD
 | 
WS_VISIBLE
,

100 
width
 * 5 / 8, 106+34+6, 100, 18,

101 
hwnd
, (
HMENU
)9, 
NULL
, NULL);

104 
HWND
 
hcombo
;

106 
hcombo
 = 
	`Cª©eWödowEx
(0L, "COMBOBOX",

109 
CBS_SIMPLE
 |

112 
CBS_DROPDOWNLIST
 |

115 
CBS_DROPDOWN
 |

118 
WS_VSCROLL
 | 
WS_CHILD
 | 
WS_VISIBLE
,

119 
width
 * 5 / 8, 106+14+4+18+4, 100, (18*5),

120 
hwnd
, (
HMENU
)10, 
NULL
, NULL);

122 
	`SídMesßge
(
hcombo
, 
CB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Cherry");

123 
	`SídMesßge
(
hcombo
, 
CB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Apple");

124 
	`SídMesßge
(
hcombo
, 
CB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Orange");

125 
	`SídMesßge
(
hcombo
, 
CB_ADDSTRING
, 0, (
LPARAM
)(
LPSTR
)"Banana");

130 
	`Cª©eWödowEx
(0L, "SCROLLBAR",

132 
SBS_VERT
 |

133 
WS_CHILD
 | 
WS_VISIBLE
 ,

134 
width
 * 5 / 8 -(18*2), 106+68, 18, 128,

135 
hwnd
, (
HMENU
)11, 
NULL
, NULL);

137 
	`Cª©eWödowEx
(0L, "SCROLLBAR",

139 
SBS_HORZ
 |

140 
WS_CHILD
 | 
WS_VISIBLE
 ,

141 
width
 * 5 / 8 -18 , 106+68, 128, 18,

142 
hwnd
, (
HMENU
)12, 
NULL
, NULL);

147 
	`ShowWödow
(
hwnd
,
iCmdShow
);

148 
	`Upd©eWödow
(
hwnd
);

150 
	`GëMesßge
(&
msg
,
NULL
,0,0)) {

151 
	`Tøn¶©eMesßge
(&
msg
);

152 
	`Di•©chMesßge
(&
msg
);

155  
msg
.
wP¨am
;

156 
	}
}

157 
LRESULT
 
CALLBACK
 
	$w¥oc
(
HWND
 
hwnd
, 
UINT
 
iMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

159 
HDC
 
hdc
;

160 
PAINTSTRUCT
 
ps
;

161 
RECT
 
ª˘
;

162 
HGDIOBJ
 
ﬁdf⁄t
;

164 
iMsg
) {

165 
WM_CREATE
:

167 
WM_PAINT
:

169 
hdc
=
	`BegöPaöt
(
hwnd
,&
ps
);

175 
	`GëClõ¡Re˘
(
hwnd
,&
ª˘
);

176 
ﬁdf⁄t
=
	`Sñe˘Obje˘
(
hdc
,
	`Cª©eF⁄t
(12,

178 
FF_DONTCARE
|
DEFAULT_PITCH
,

180 
	`DøwText
(
hdc
, "Hﬁa, NOS, §§§Â¥˙∏’", -1, &
ª˘
,

181 
DT_SINGLELINE
|
DT_CENTER
|
DT_VCENTER
);

182 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
,
ﬁdf⁄t
));

187 
	`EndPaöt
(
hwnd
,&
ps
);

189 
WM_DESTROY
:

190 
	`Po°QuôMesßge
(0);

193  
	`DefWödowProc
(
hwnd
,
iMsg
,
wP¨am
,
lP¨am
);

196 
	}
}

	@demos/mwin/muserfd.c

1 
	~<wödows.h
>

2 
	~<wöã∫.h
>

3 
	~<°dio.h
>

4 
	~<°dlib.h
>

7 #i‡
DOS_DJGPP
 | 
deföed
(
__FªeBSD__
)

8 
	~<sys/ty≥s.h
>

11 
	#MAX_TEST_FD
 (500)

	)

13 
LRESULT
 
CALLBACK
 
w¥oc
(
HWND
,
UINT
,
WPARAM
,
LPARAM
);

15 
WINAPI
 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
,

16 
PSTR
 
szCmdLöe
, 
iCmdShow
)

18 
szAµName
[]="HolaWin";

19 
HWND
 
hwnd
;

20 
WNDCLASS
 
wnd˛ass
;

21 
øndom_fd
[
MAX_TEST_FD
][2], 
fd
, 
uƒeg_fd
;

23 
wnd˛ass
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_HREDRAW
 | 
CS_VREDRAW
;

24 
wnd˛ass
.
Õ‚WndProc
 = (
WNDPROC
)
w¥oc
;

25 
wnd˛ass
.
cbClsExåa
 =0;

26 
wnd˛ass
.
cbWndExåa
 =0;

27 
wnd˛ass
.
hIn°™˚
 =0;

28 
wnd˛ass
.
hIc⁄
 =0;

29 
wnd˛ass
.
hCurs‹
 =0;

30 
wnd˛ass
.
hbrBackground
 =(
HBRUSH
)
	`GëStockObje˘
(
LTGRAY_BRUSH
);

31 
wnd˛ass
.
ÕszMíuName
 =
NULL
;

32 
wnd˛ass
.
ÕszCœssName
 = 
szAµName
;

34 
	`Regi°îCœss
(&
wnd˛ass
);

35 
hwnd
=
	`Cª©eWödowEx
(0L,

36 
szAµName
,

38 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

39 
CW_USEDEFAULT
,

40 
CW_USEDEFAULT
,

43 
NULL
,

44 
NULL
,

45 
NULL
,

46 
NULL
);

53 
	`¥ötf
 ("SelectáÑandomÜist of fd'sÅoÅest with.\n");

55 
fd
 = 0; fd < 
MAX_TEST_FD
; fd++)

57 
øndom_fd
[
fd
][0] = 
	`øndom
 (Ë% 
FD_SETSIZE
;

58 
øndom_fd
[
fd
][1] = 
	`øndom
 () % 3;

61 
fd
 = 0; fd < 
MAX_TEST_FD
; fd++)

63 
øndom_fd
[
fd
][1])

66 
	`MwRegi°îFdI≈ut
 (
hwnd
, 
øndom_fd
[
fd
][0]);

70 
	`MwRegi°îFdOuçut
 (
hwnd
, 
øndom_fd
[
fd
][0]);

74 
	`MwRegi°îFdEx˚±
 (
hwnd
, 
øndom_fd
[
fd
][0]);

79 
	`¥ötf
 ("Bad fdÅype, fd index = %i,Åype = %i !\n",

80 
fd
, 
øndom_fd
[fd][1]);

85 
uƒeg_fd
 = 
	`øndom
 (Ë% 
MAX_TEST_FD
;

87 
fd
 = 0; fd < 
MAX_TEST_FD
; fd++)

89 
øndom_fd
[
uƒeg_fd
][1])

92 
	`MwUƒegi°îFdI≈ut
 (
hwnd
, 
øndom_fd
[
uƒeg_fd
][0]);

96 
	`MwUƒegi°îFdOuçut
 (
hwnd
, 
øndom_fd
[
uƒeg_fd
][0]);

100 
	`MwUƒegi°îFdEx˚±
 (
hwnd
, 
øndom_fd
[
uƒeg_fd
][0]);

105 
	`¥ötf
 ("Bad fdÅype !\n");

109 
uƒeg_fd
++;

110 i‡(
uƒeg_fd
 >
MAX_TEST_FD
)

111 
uƒeg_fd
 = 0;

116 
	}
}

118 
LRESULT
 
CALLBACK
 
	$w¥oc
(
HWND
 
hwnd
, 
UINT
 
iMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

120 
HDC
 
hdc
;

121 
PAINTSTRUCT
 
ps
;

122 
RECT
 
ª˘
;

124 
iMsg
) {

125 
WM_CREATE
:

127 
WM_PAINT
:

129 
WM_MOUSEFIRST
:

131 
hdc
=
	`BegöPaöt
(
hwnd
,&
ps
);

132 
	`GëClõ¡Re˘
(
hwnd
,&
ª˘
);

133 
	`DøwText
(
hdc
, "Hﬁa, NOS", -1, &
ª˘
,

134 
DT_SINGLELINE
|
DT_CENTER
|
DT_VCENTER
);

135 
	`EndPaöt
(
hwnd
,&
ps
);

137 
WM_DESTROY
:

138 
	`Po°QuôMesßge
(0);

141  
	`DefWödowProc
(
hwnd
,
iMsg
,
wP¨am
,
lP¨am
);

144 
	}
}

	@demos/mwobjects/mwo-test.cc

7 
	#MWINCLUDECOLORS


	)

8 
	~<mwobje˘s.h
>

9 
	~<io°ªam
>

11 
MWIMAGEHDR
 
image_mi¸owö
;

12 
MWIMAGEHDR
 
image_zi⁄208
;

14 
PMWIMAGEHDR
 
	gimage
 = &
image_zi⁄208
;

16 
usög
 
«me•a˚
 
	gMi¸oWödowsObje˘s
;

18 ˛as†
	cTe°WödowCœss


19 : 
public
 
WödowCœss


21 
public
:

23 
Te°WödowCœss
 (
LPCSTR
 
ÕszCœssName
);

27 ˛as†
	cTe°ChûdWödow


28 : 
public
 
Wödow


30 
public
:

32 
Te°ChûdWödow
 ();

34 
HWND
 
¸óã
 (
LPCSTR
 
ÕszCœssName
,

35 
HWND
 
∑ª¡
,

36 
x
, 
y
,

37 
nWidth
, 
nHeight
);

39 
	$£t_åa˚
 (
boﬁ
 
t
)

40 { 
åa˚
 = 
t
; }

42 
¥Ÿe˘ed
:

44 
vútuÆ
 
LRESULT
 
	`mesßge_h™dÀr
 (
UINT
 
msg
,

45 
WPARAM
 
wP¨am
,

46 
LPARAM
 
lP¨am
);

47 
¥iv©e
:

49 
boﬁ
 
åa˚
;

51 
	}
};

53 ˛as†
	cTe°Wödow


54 : 
public
 
Wödow


56 
public
:

58 
Te°Wödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
 = 
Ál£
);

60 
	m¥iv©e
:

62 
boﬁ
 
åa˚
;

63 
Wödow
 
	mbuâ⁄
;

64 
Te°ChûdWödow
 
	mimage
[3];

68 ˛as†
	cTe°3dWödow


69 : 
public
 
Wödow


71 
public
:

73 
Te°3dWödow
 (
LPCSTR
 
ÕszChûd
);

75 
	m¥Ÿe˘ed
:

77 
vútuÆ
 
LRESULT
 
mesßge_h™dÀr
 (
UINT
 
msg
,

78 
WPARAM
 
wP¨am
,

79 
LPARAM
 
lP¨am
);

80 
	m¥iv©e
:

82 
vec1
 
gx
;

83 
vec1
 
	mgy
;

85 
vec1
 
	mœ°_gx
;

86 
vec1
 
	mœ°_gy
;

90 ˛as†
	cTe°Ro£Wödow


91 : 
public
 
Te°Wödow


93 
public
:

95 
Te°Ro£Wödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
 = 
Ál£
);

97 
	m¥Ÿe˘ed
:

99 
vútuÆ
 
LRESULT
 
mesßge_h™dÀr
 (
UINT
 
msg
,

100 
WPARAM
 
wP¨am
,

101 
LPARAM
 
lP¨am
);

104 ˛as†
	cTe°Cú˛eWödow


105 : 
public
 
Te°Wödow


107 
public
:

109 
Te°Cú˛eWödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
 = 
Ál£
);

111 
	m¥Ÿe˘ed
:

113 
vútuÆ
 
LRESULT
 
mesßge_h™dÀr
 (
UINT
 
msg
,

114 
WPARAM
 
wP¨am
,

115 
LPARAM
 
lP¨am
);

118 ˛as†
	cTe°DaisyWödow


119 : 
public
 
Te°Wödow


121 
public
:

123 
Te°DaisyWödow
 (
LPCSTR
 
ÕszCœss
, 
boﬁ
 
åa˚
 = 
Ál£
);

125 
	m¥Ÿe˘ed
:

127 
vútuÆ
 
LRESULT
 
mesßge_h™dÀr
 (
UINT
 
msg
,

128 
WPARAM
 
wP¨am
,

129 
LPARAM
 
lP¨am
);

132 ˛as†
	cTe°FûeDes¸ùt‹


133 : 
public
 
FûeDes¸ùt‹


135 
public
:

137 
do_fd_ã°
 ();

139 
	m¥Ÿe˘ed
:

141 
LRESULT
 
ªad
 ();

142 
LRESULT
 
wrôe
 ();

143 
LRESULT
 
ex˚±
 ();

146 ˛as†
	cTe°Aµliˇti⁄


147 : 
public
 
Aµliˇti⁄


149 íum { 
GROUPS
 = 2 };

151 
	gpublic
:

153 
Te°Aµliˇti⁄
 ();

155 
	g¥Ÿe˘ed
:

157 
vútuÆ
 
öôüli£
 ();

158 
vútuÆ
 
shutdown
 ();

160 
	g¥iv©e
:

162 
Te°WödowCœss
 
maö_˛ass
;

164 
Te°3dWödow
 *
	gt3d
 [
GROUPS
];

165 
Te°Ro£Wödow
 *
	gå
 [
GROUPS
];

166 
Te°Cú˛eWödow
 *
	gtc
 [
GROUPS
];

167 
Te°DaisyWödow
 *
	gtd
 [
GROUPS
];

169 
Te°FûeDes¸ùt‹
 *
	gfd
;

173 
	gTe°WödowCœss
::
	$Te°WödowCœss
 (
LPCSTR
 
ÕszCœssName
)

174 : 
	`WödowCœss
 (
ÕszCœssName
,

175 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
)

177 
	`£t_background
 ((
HBRUSH
Ë
	`GëStockObje˘
 (
LTGRAY_BRUSH
));

178 
	}
}

180 
	gTe°ChûdWödow
::
	$Te°ChûdWödow
 ()

182 
	}
}

184 
HWND


185 
Te°ChûdWödow
::
	$¸óã
 (
LPCSTR
 
ÕszCœssName
,

186 
HWND
 
∑ª¡
,

187 
x
, 
y
,

188 
nWidth
, 
nHeight
)

190  
Wödow
::
	`¸óã
 (0,

191 
ÕszCœssName
,

193 
WS_BORDER
 | 
WS_CHILD
 | 
WS_VISIBLE
,

194 
x
, 
y
, 
nWidth
, 
nHeight
,

195 
∑ª¡
, 0, 0, 0);

196 
	}
}

198 
LRESULT


199 
	gTe°ChûdWödow
::
	$mesßge_h™dÀr
 (
UINT
 
msg
,

200 
WPARAM
 
wP¨am
,

201 
LPARAM
 
lP¨am
)

203 
Paöt
 
	`∑öt
 (*
this
);

205 
msg
)

207 
WM_PAINT
:

208 
∑öt
.
	`begö
 ();

210 
	`DøwDIB
 (
∑öt
,Öaöt.
	`À·
 (),Öaöt.
	`t›
 (), 
image
);

212 
∑öt
.
	`íd
 ();

216  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

219 
	}
}

221 
	gTe°Wödow
::
	$Te°Wödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
)

222 : 
	$åa˚
 (
åa˚
)

224 
Re˘
 
	`rc
 (
	`GëDeskt›Wödow
 ());

225 
width
;

226 
height
;

228 
width
 = 
height
 = 
rc
.
	`right
 () / 2;

230 i‡(
åa˚
)

231 
cout
 << "¸óã: hwnd=" << 
	`gë_h™dÀ
 ()

232 << " " << 
rc
 << 
ídl
;

234 
	`¸óã
 (0, 
ÕszCœssName
, "Micro C++ Application",

235 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

236 
CW_USEDEFAULT
, CW_USEDEFAULT,

237 
width
, 
height
,

240 
buâ⁄
.
	`¸óã
 (0, "BUTTON", "Ok",

241 
WS_CHILD
 | 
WS_VISIBLE
,

242 
width
 * 5 / 8, 10, 50, 14,

243 *
this
, 0, 0, 0);

245 
image
[0].
	`¸óã
 (
ÕszCœssName
, *
this
,

247 
width
 / 3, 
height
 / 3);

248 
image
[1].
	`¸óã
 (
ÕszCœssName
, *
this
,

249 
width
 / 3, 
height
 / 3,

250 
width
 / 3, 
height
 / 3);

251 
image
[2].
	`¸óã
 (
ÕszCœssName
, *
this
,

252 
width
 * 3 / 5, 
height
 * 3 / 5,

253 
width
 * 2 / 3, 
height
 * 2 / 3);

255 
image
[0].
	`£t_åa˚
 (
åa˚
);

256 
image
[1].
	`£t_åa˚
 (
åa˚
);

257 
image
[2].
	`£t_åa˚
 (
åa˚
);

259 
	}
}

261 
	gTe°3dWödow
::
	$Te°3dWödow
 (
LPCSTR
 
ÕszCœssName
)

262 : 
	`gx
 (0),

263 
	`gy
 (0),

264 
	`œ°_gx
 (0),

265 
	`œ°_gy
 (0)

267 
Re˘
 
	`ª˘
 (
	`GëDeskt›Wödow
 ());

268 
width
;

269 
height
;

271 
width
 = 
height
 = 
ª˘
.
	`right
 () / 2;

273 
	`¸óã
 (0, 
ÕszCœssName
, "Micro C++ Application",

274 
WS_OVERLAPPEDWINDOW
 | 
WS_VISIBLE
,

275 
CW_USEDEFAULT
, CW_USEDEFAULT,

276 
width
, 
height
,

278 
	}
}

280 
LRESULT


281 
	gTe°3dWödow
::
	$mesßge_h™dÀr
 (
UINT
 
msg
,

282 
WPARAM
 
wP¨am
,

283 
LPARAM
 
lP¨am
)

285 
Paöt
 
	`∑öt
 (*
this
, 
lP¨am
);

286 
Re˘
 
rc
;

288 
msg
)

290 
WM_PAINT
:

291 
∑öt
.
	`begö
 (
åue
);

293 
	`look3
 (-2 * 
gx
, -2 * 
gy
, 1.2);

294 
	`døwgrid
 (-8.0, 8.0, 10, -8.0, 8.0, 10);

296 
œ°_gx
 = 
gx
;

297 
œ°_gy
 = 
gy
;

299 
∑öt
.
	`íd
 ();

302 
WM_MOUSEMOVE
:

304 
rc
.
	`gë_˛õ¡
 (*
this
);

305 
gx
 = (
vec1
Ë
∑öt
.
	`gë_poöt_x
 (Ë/ 
rc
.
	`right
 ();

306 
gy
 = (
vec1
Ë
∑öt
.
	`gë_poöt_y
 (Ë/ 
rc
.
	`bŸtom
 ();

308 i‡(
gx
 > 
œ°_gx
 || 
gy
 > 
œ°_gy
)

309 
	`övÆid©e_ª˘
 (0, 
FALSE
);

313  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

316 
	}
}

318 
	gTe°Ro£Wödow
::
	$Te°Ro£Wödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
)

319 : 
	$Te°Wödow
 (
ÕszCœssName
, 
åa˚
)

321 
	}
}

323 
LRESULT


324 
	gTe°Ro£Wödow
::
	$mesßge_h™dÀr
 (
UINT
 
msg
,

325 
WPARAM
 
wP¨am
,

326 
LPARAM
 
lP¨am
)

328 
Paöt
 
	`∑öt
 (*
this
);

330 
msg
)

332 
WM_PAINT
:

333 
∑öt
.
	`begö
 (
åue
);

335 
	`ro£
 (1.0, 7, 13);

337 
∑öt
.
	`íd
 ();

341  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

344 
	}
}

346 
	gTe°Cú˛eWödow
::
	$Te°Cú˛eWödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
)

347 : 
	$Te°Wödow
 (
ÕszCœssName
, 
åa˚
)

349 
	}
}

351 
LRESULT


352 
	gTe°Cú˛eWödow
::
	$mesßge_h™dÀr
 (
UINT
 
msg
,

353 
WPARAM
 
wP¨am
,

354 
LPARAM
 
lP¨am
)

356 
Paöt
 
	`∑öt
 (*
this
);

358 
msg
)

360 
WM_PAINT
:

361 
∑öt
.
	`begö
 (
åue
);

363 
	`£tcﬁ‹3
 (
BLACK
);

364 
	`cú˛e3
 (1.0);

366 
∑öt
.
	`íd
 ();

370  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

373 
	}
}

375 
	gTe°DaisyWödow
::
	$Te°DaisyWödow
 (
LPCSTR
 
ÕszCœssName
, 
boﬁ
 
åa˚
)

376 : 
	$Te°Wödow
 (
ÕszCœssName
, 
åa˚
)

378 
	}
}

380 
LRESULT


381 
	gTe°DaisyWödow
::
	$mesßge_h™dÀr
 (
UINT
 
msg
,

382 
WPARAM
 
wP¨am
,

383 
LPARAM
 
lP¨am
)

385 
Paöt
 
	`∑öt
 (*
this
);

387 
msg
)

389 
WM_PAINT
:

390 
∑öt
.
	`begö
 (
åue
);

392 
	`£tcﬁ‹3
 (
BLUE
);

393 
	`daisy
 (1.0, 20);

395 
∑öt
.
	`∑öt_3d
 ();

397 
∑öt
.
	`ãxt_out
 (10, 250, "D©êbuûà: %s", 
__DATE__
);

399 
∑öt
.
	`íd
 ();

402 
WM_LBUTTONDOWN
:

403 
cout
 << "À· dow¿: " << *
this
 << 
ídl
;

404 
	`SídMesßge
 (*
this
, 
WM_FDINPUT
, 200, 0);

405  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

408 
WM_RBUTTONDOWN
:

409 
cout
 << "righàdow¿: " << *
this
 << 
ídl
;

410 
	`SídMesßge
 (*
this
, 
WM_FDOUTPUT
, 200, 0);

411  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

414 
WM_LBUTTONDBLCLK
:

415 
cout
 << "doubÀÜe· : " << *
this
 << 
ídl
;

416 
	`SídMesßge
 (*
this
, 
WM_FDEXCEPT
, 200, 0);

417  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

421  
Wödow
::
	`mesßge_h™dÀr
 (
msg
, 
wP¨am
, 
lP¨am
);

424 
	}
}

427 
	gTe°FûeDes¸ùt‹
::
	$do_fd_ã°
 ()

429 
	}
}

431 
LRESULT


432 
Te°FûeDes¸ùt‹
::
	$ªad
 ()

434 
cout
 << "ã°Ñód fd f‹ `" << *
	`gë_wödow
 (Ë<< "'ánd fd " << *
this
 << 
ídl
;

436 
	}
}

438 
LRESULT


439 
	gTe°FûeDes¸ùt‹
::
	$wrôe
 ()

441 
cout
 << "ã° wrôêfd f‹ `" << *
	`gë_wödow
 (Ë<< "'ánd fd " << *
this
 << 
ídl
;

443 
	}
}

445 
LRESULT


446 
	gTe°FûeDes¸ùt‹
::
	$ex˚±
 ()

448 
cout
 << "ã°Éx˚± fd f‹ `" << *
	`gë_wödow
 (Ë<< "'ánd fd " << *
this
 << 
ídl
;

450 
	}
}

452 
	gTe°Aµliˇti⁄
::
	$Te°Aµliˇti⁄
 ()

453 : 
	`Aµliˇti⁄
 (
image_mi¸owö
),

454 
	`maö_˛ass
 ("test")

456 
i
 = 0; i < 
GROUPS
; i++)

458 
t3d
 [
i
] = 0;

459 
å
 [
i
] = 0;

460 
tc
 [
i
] = 0;

461 
td
 [
i
] = 0;

463 
	}
}

466 
	gTe°Aµliˇti⁄
::
	$öôüli£
 ()

468 
maö_˛ass
.
	`ªgi°î_˛ass
 ();

470 
i
 = 0; i < 
GROUPS
; i++)

472 
t3d
 [
i
] = 
√w
 
	`Te°3dWödow
 ("test");

473 
å
 [
i
] = 
√w
 
	`Te°Ro£Wödow
 ("test");

474 
tc
 [
i
] = 
√w
 
	`Te°Cú˛eWödow
 ("test");

475 
td
 [
i
] = 
√w
 
	`Te°DaisyWödow
 ("test");

478 
fd
 = 
√w
 
	`Te°FûeDes¸ùt‹
 ();

480 
cout
 << "©èchÅÿ" << *
td
[
GROUPS
 - 1] << 
ídl
;

482 
td
[
GROUPS
 - 1]->
	`©èch
 (200, *
fd
);

485 
	}
}

488 
	gTe°Aµliˇti⁄
::
	$shutdown
 ()

490 
i
 = 0; i < 
GROUPS
; i++)

492 i‡(
t3d
 [
i
])

493 
dñëe
 
t3d
 [
i
];

494 
t3d
 [
i
] = 0;

496 i‡(
å
 [
i
])

497 
dñëe
 
å
 [
i
];

498 
å
 [
i
] = 0;

500 i‡(
tc
 [
i
])

501 
dñëe
 
tc
 [
i
];

502 
tc
 [
i
] = 0;

504 i‡(
td
 [
i
])

505 
dñëe
 
td
 [
i
];

506 
td
 [
i
] = 0;

510 
	}
}

512 
Te°Aµliˇti⁄
 
	gã°_≠∂iˇti⁄
;

	@demos/nanowm/actions.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	#MWINCLUDECOLORS


	)

10 
	~"«no-X.h
"

11 
	~"nxdøw.h
"

15 
	~"«nowm.h
"

20 
	$ªdøw_nˇªa
(
wö
 *
wödow
)

22 
GR_WINDOW_INFO
 
öfo
;

23 
GR_WM_PROPERTIES
 
¥›s
;

24 
GR_BOOL
 
a˘ive
;

26 
	`D¥ötf
("c⁄èöî_exposuª wödow %d\n", 
wödow
->
wid
);

28 
	`GrGëWödowInfo
(
wödow
->
wid
, &
öfo
);

30 
	`GrGëWMPr›îtõs
(
wödow
->
˛õ¡id
, &
¥›s
);

37 i‡(
¥›s
.
Êags
 == 0)

40 
a˘ive
 = (
wödow
->
˛õ¡id
 =
	`GrGëFocus
());

41 
	`nxPaötNCAªa
(
wödow
->
wid
, 
öfo
.
width
, info.
height
, 
¥›s
.
tôÀ
,

42 
a˘ive
, 
¥›s
.props);

45 i‡(
¥›s
.
tôÀ
)

46 
	`‰ì
(
¥›s
.
tôÀ
);

47 
	}
}

49 
	$c⁄èöî_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
)

51 
	`D¥ötf
("c⁄èöî_exposuª wödow %d\n", 
wödow
->
wid
);

53 
	`ªdøw_nˇªa
(
wödow
);

54 
	}
}

56 
GR_BOOL


57 
	$PtInRe˘
(
GR_RECT
 *
¥c
, 
GR_SIZE
 
x
, GR_SIZE 
y
)

59  (
x
 >
¥c
->x && x < (¥c->x+¥c->
width
) &&

60 
y
 >
¥c
->y && y < (¥c->y+¥c->
height
));

61 
	}
}

63 
	$c⁄èöî_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

65 
pos_size
 *
pos
;

66 
GR_RECT
 
r
;

67 
GR_COORD
 
cxb‹dî
 = 0, 
cyb‹dî
 = 0;

68 
GR_WINDOW_INFO
 
öfo
;

69 
GR_GC_ID
 
gc
;

70 
	`D¥ötf
("c⁄èöî_buâ⁄dow¿wödow %d\n", 
wödow
->
wid
);

72 if(
wödow
->
a˘ive
) ;

74 
	`GrGëWödowInfo
(
wödow
->
wid
, &
öfo
);

77 i‡(
öfo
.
¥›s
 & 
GR_WM_PROPS_BORDER
) {

78 
cxb‹dî
 = 1;

79 
cyb‹dî
 = 1;

81 i‡(
öfo
.
¥›s
 & 
GR_WM_PROPS_APPFRAME
) {

82 
cxb‹dî
 = 
CXBORDER
;

83 
cyb‹dî
 = 
CYBORDER
;

87 i‡((
öfo
.
¥›s
 & (
GR_WM_PROPS_CAPTION
|
GR_WM_PROPS_CLOSEBOX
)) ==

88 (
GR_WM_PROPS_CAPTION
|
GR_WM_PROPS_CLOSEBOX
)) {

91 
r
.
x
 = 
öfo
.
width
 - 
CXCLOSEBOX
 - 
cxb‹dî
 - 2;

92 
r
.
y
 = 
cyb‹dî
 + 2;

93 
r
.
width
 = 
CXCLOSEBOX
;

94 
r
.
height
 = 
CYCLOSEBOX
;

97 i‡(
	`PtInRe˘
(&
r
, 
evít
->
x
,Évít->
y
)) {

99 
	`GrClo£Wödow
(
wödow
->
˛õ¡id
);

105 
	`GrSëFocus
(
wödow
->
˛õ¡id
);

113 
r
.
x
 = 
öfo
.
width
 - 5;

114 
r
.
y
 = 
öfo
.
height
 - 5;

115 
r
.
width
 = 5;

116 
r
.
height
 = 5;

118 if(
	`PtInRe˘
(&
r
,
evít
->
x
,Évít->
y
)) {

120 
pos_size
 * 
pos
;

122 if(!
wödow
->
d©a
)

123 if(!(
wödow
->
d©a
 = 
	`mÆloc
((
pos_size
)))) ;

125 
wödow
->
sizög
 = 
GR_TRUE
;

126 
pos
 = (
pos_size
*)
wödow
->
d©a
;

129 
	`GrGëWödowInfo
(
wödow
->
˛õ¡id
,&
öfo
);

130 
pos
->
xoff
 = -
öfo
.
width
;

131 
pos
->
yoff
 = -
öfo
.
height
;

133 
	`GrGëWödowInfo
(
wödow
->
wid
,&
öfo
);

134 
pos
->
xoff
 +
öfo
.
width
;

135 
pos
->
yoff
 +
öfo
.
height
;

137 
gc
 = 
	`GrNewGC
();

138 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

139 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
öfo
.
x
, info.
y
, info.
width
, info.
height
);

140 
	`GrDe°royGC
(
gc
);

143 
pos
->
width
 = 
öfo
.width;

144 
pos
->
height
 = 
öfo
.height;

150 i‡(!(
öfo
.
¥›s
 & 
GR_WM_PROPS_CAPTION
))

154 
r
.
x
 = 
cxb‹dî
;

155 
r
.
y
 = 
cyb‹dî
;

156 
r
.
width
 = 
öfo
.width - 
cxb‹dî
*2;

157 
r
.
height
 = 
CYCAPTION
;

160 i‡(!
	`PtInRe˘
(&
r
, 
evít
->
x
,Évít->
y
))

164 i‡(!(
öfo
.
¥›s
 & 
GR_WM_PROPS_NORAISE
))

165 
	`GrRai£Wödow
(
wödow
->
wid
);

168 i‡(
öfo
.
¥›s
 & 
GR_WM_PROPS_NOMOVE
)

171 if(!
wödow
->
d©a
)

172 if(!(
wödow
->
d©a
 = 
	`mÆloc
((
pos_size
)))) ;

174 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

176 
	`GrGëWödowInfo
(
wödow
->
wid
,&
öfo
);

178 
pos
->
xoff
 = 
evít
->
x
;

179 
pos
->
yoff
 = 
evít
->
y
;

181 #ifde‡
OUTLINE_MOVE


182 
pos
->
x‹ig
 = 
öfo
.
x
;

183 
pos
->
y‹ig
 = 
öfo
.
y
;

184 
pos
->
width
 = 
öfo
.width;

185 
pos
->
height
 = 
öfo
.height;

187 
gc
 = 
	`GrNewGC
();

188 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

189 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
öfo
.
x
, info.
y
, info.
width
, info.
height
);

190 
	`GrDe°royGC
(
gc
);

192 
wödow
->
a˘ive
 = 
GR_TRUE
;

193 
	}
}

195 
	$c⁄èöî_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

197 
	`D¥ötf
("c⁄èöî_buâ⁄u∞wödow %d\n", 
wödow
->
wid
);

199 if(
wödow
->
a˘ive
) {

200 
pos_size
 * 
pos
 = (pos_sizê*)
wödow
->
d©a
;

201 #ifde‡
OUTLINE_MOVE


202 
GR_GC_ID
 
gc
;

203 
gc
 = 
	`GrNewGC
();

204 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

205 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
pos
->
x‹ig
,Öos->
y‹ig
,Öos->
width
,Öos->
height
);

207 
	`GrMoveWödow
(
wödow
->
wid
, 
pos
->
x‹ig
,Öos->
y‹ig
);

210 
	`‰ì
(
pos
);

211 
wödow
->
a˘ive
 = 
GR_FALSE
;

212 
wödow
->
d©a
 = 0;

215 if(
wödow
->
sizög
) {

216 
GR_WINDOW_INFO
 
öfo
;

217 
GR_GC_ID
 
gc
;

219 
pos_size
 * 
pos
 = (pos_sizê*)
wödow
->
d©a
;

221 
gc
 = 
	`GrNewGC
();

222 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

224 
	`GrGëWödowInfo
(
wödow
->
wid
, &
öfo
);

226 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
öfo
.
x
, info.
y
, 
pos
->
width
,Öos->
height
);

228 
	`GrResizeWödow
(
wödow
->
wid
,
evít
->
roŸx
 - 
öfo
.
x
,Évít->
roŸy
 - info.
y
);

229 
	`GrResizeWödow
(
wödow
->
˛õ¡id
,
evít
->
roŸx
 - 
öfo
.
x
 - 
pos
->
xoff
,

230 
evít
->
roŸy
 - 
öfo
.
y
 - 
pos
->
yoff
);

231 
	`GrDe°royGC
(
gc
);

232 
	`‰ì
(
wödow
->
d©a
);

233 
wödow
->
sizög
 = 
GR_FALSE
;

234 
wödow
->
d©a
 = 0;

236 
	}
}

238 
	$c⁄èöî_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

240 
pos_size
 *
pos
;

241 
GR_WINDOW_INFO
 
öfo
;

242 
GR_GC_ID
 
gc
;

244 
	`D¥ötf
("c⁄èöî_mou£moved wödow %d\n", 
wödow
->
wid
);

246 if(
wödow
->
sizög
) {

248 
pos_size
 * 
pos
 = (pos_size*)
wödow
->
d©a
;

249 
	`GrGëWödowInfo
(
wödow
->
wid
, &
öfo
);

251 
gc
 = 
	`GrNewGC
();

252 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

255 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
öfo
.
x
, info.
y
, 
pos
->
width
,Öos->
height
);

257 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
öfo
.
x
, info.
y
,

258 
evít
->
roŸx
 - 
öfo
.
x
,Évít->
roŸy
 - info.
y
);

259 
	`GrDe°royGC
(
gc
);

263 
pos
->
width
 = 
evít
->
roŸx
 - 
öfo
.
x
;

264 
pos
->
height
 = 
evít
->
roŸy
 - 
öfo
.
y
;

269 if(!
wödow
->
a˘ive
) ;

271 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

273 #ifde‡
OUTLINE_MOVE


274 
gc
 = 
	`GrNewGC
();

275 
	`GrSëGCMode
(
gc
, 
GR_MODE_XOR
|
GR_MODE_EXCLUDECHILDREN
);

276 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
pos
->
x‹ig
,Öos->
y‹ig
,Öos->
width
,Öos->
height
);

277 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
,
gc
,
evít
->
roŸx
 - 
pos
->
xoff
,Évít->
roŸy
 -Öos->
yoff
,

278 
pos
->
width
,Öos->
height
);

280 
pos
->
x‹ig
 = 
evít
->
roŸx
 -Öos->
xoff
;

281 
pos
->
y‹ig
 = 
evít
->
roŸy
 -Öos->
yoff
;

283 
	`GrDe°royGC
(
gc
);

285 
	`GrMoveWödow
(
wödow
->
wid
, 
evít
->
roŸx
 - 
pos
->
xoff
,

286 
evít
->
roŸy
 - 
pos
->
yoff
);

288 
	}
}

291 
	$t›b¨_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
)

293 
wö
 *
pwö
 = 
	`föd_wödow
(
wödow
->
pid
);

294 
˛õ¡öfo
 *
ci
 = 
pwö
->
d©a
;

295 
GR_WM_PROPERTIES
 
¥›
;

297 
	`D¥ötf
("t›b¨_exposuª wödow %d\n", 
wödow
->
wid
);

299 
	`GrGëWMPr›îtõs
(
ci
->
cid
, &
¥›
);

300 i‡(
¥›
.
tôÀ
) {

301 
	`GrText
(
wödow
->
wid
, 
buâ⁄sgc
, 0, 0, 
¥›
.
tôÀ
, -1,

302 
GR_TFASCII
|
GR_TFTOP
);

303 
	`‰ì
(
¥›
.
tôÀ
);

305 
	}
}

307 
	$˛o£buâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
)

309 
	`D¥ötf
("˛o£buâ⁄_exposuª wödow %d\n", 
wödow
->
wid
);

311 
	`GrBôm≠
(
wödow
->
wid
, 
buâ⁄sgc
, 0, 0, 
TITLE_BAR_HEIGHT
,

312 
TITLE_BAR_HEIGHT
, 
wödow
->
a˘ive
 ? 
˛o£buâ⁄_¥es£d
 :

313 
˛o£buâ⁄_nŸ¥es£d
);

314 
	}
}

316 
	$t›b¨_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

318 
posôi⁄
 *
pos
;

320 
	`D¥ötf
("t›b¨_buâ⁄dow¿wödow %d\n", 
wödow
->
wid
);

322 
	`GrRai£Wödow
(
wödow
->
pid
);

324 if(
wödow
->
a˘ive
) ;

326 if(!
wödow
->
d©a
)

327 if(!(
wödow
->
d©a
 = 
	`mÆloc
((
posôi⁄
)))) ;

329 
pos
 = (
posôi⁄
 *Ë
wödow
->
d©a
;

331 
pos
->
x
 = 
evít
->x + 
TITLE_BAR_HEIGHT
;

332 
pos
->
y
 = 
evít
->y;

334 
wödow
->
a˘ive
 = 
GR_TRUE
;

335 
	}
}

337 
	$ªsizeb¨_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

339 
GR_WINDOW_INFO
 
wi
;

340 
pos_size
 *
pos
;

342 
	`D¥ötf
("ªsizeb¨_buâ⁄dow¿wödow %d\n", 
wödow
->
wid
);

344 
	`GrRai£Wödow
(
wödow
->
pid
);

346 if(
wödow
->
a˘ive
) ;

348 if(!
wödow
->
d©a
)

349 if(!(
wödow
->
d©a
 = 
	`mÆloc
((
pos_size
)))) ;

351 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

353 
	`GrGëWödowInfo
(
wödow
->
pid
, &
wi
);

355 
pos
->
xoff
 = 
evít
->
x
;

356 
pos
->
yoff
 = 
evít
->
y
;

357 
pos
->
x‹ig
 = 
wi
.
x
;

358 
pos
->
y‹ig
 = 
wi
.
y
;

359 
pos
->
width
 = 
wi
.width;

360 
pos
->
height
 = 
wi
.height;

362 
wödow
->
a˘ive
 = 
GR_TRUE
;

363 
	}
}

365 
	$˛o£buâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

367 
	`D¥ötf
("˛o£buâ⁄_buâ⁄dow¿wödow %d\n", 
wödow
->
wid
);

369 
	`GrRai£Wödow
(
wödow
->
pid
);

371 
wödow
->
a˘ive
 = 
GR_TRUE
;

372 
	`˛o£buâ⁄_exposuª
(
wödow
, 
NULL
);

373 
	}
}

376 
	$t›b¨_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

378 
	`D¥ötf
("t›b¨_buâ⁄u∞wödow %d\n", 
wödow
->
wid
);

380 
wödow
->
a˘ive
 = 
GR_FALSE
;

381 
	}
}

383 
	$˛o£buâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
)

385 
wö
 *
pwö
 = 
	`föd_wödow
(
wödow
->
pid
);

386 
˛õ¡öfo
 *
ci
 = 
pwö
->
d©a
;

388 
	`D¥ötf
("˛o£buâ⁄_buâ⁄u∞wödow %d\n", 
wödow
->
wid
);

390 
wödow
->
a˘ive
 = 
GR_FALSE
;

391 
	`˛o£buâ⁄_exposuª
(
wödow
, 
NULL
);

393 
	`GrClo£Wödow
(
ci
->
cid
);

394 
	}
}

396 
	$t›b¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

398 
posôi⁄
 *
pos
;

399 
GR_WM_PROPERTIES
 
¥›s
;

401 
	`D¥ötf
("t›b¨_mou£moved wödow %d\n", 
wödow
->
wid
);

403 if(!
wödow
->
a˘ive
) ;

405 
pos
 = (
posôi⁄
 *Ë
wödow
->
d©a
;

408 
	`GrGëWMPr›îtõs
(
wödow
->
pid
, &
¥›s
);

409 i‡(
¥›s
.
tôÀ
)

410 
	`‰ì
(
¥›s
.
tôÀ
);

411 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

412 
¥›s
.¥›†|
GR_WM_PROPS_NOBACKGROUND
;

413 
	`GrSëWMPr›îtõs
(
wödow
->
pid
, &
¥›s
);

415 
	`GrMoveWödow
(
wödow
->
pid
, 
evít
->
roŸx
 - 
pos
->
x
,

416 
evít
->
roŸy
 - 
pos
->
y
);

418 
¥›s
.¥›†&~
GR_WM_PROPS_NOBACKGROUND
;

419 
	`GrSëWMPr›îtõs
(
wödow
->
pid
, &
¥›s
);

420 
	}
}

422 
	$À·b¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

424 
GR_COORD
 
√wx
;

425 
GR_SIZE
 
√wwidth
;

426 
pos_size
 *
pos
;

428 
	`D¥ötf
("À·b¨_mou£moved wödow %d\n", 
wödow
->
wid
);

430 if(!
wödow
->
a˘ive
) ;

432 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

434 
√wx
 = 
evít
->
roŸx
 - 
pos
->
xoff
;

435 
√wwidth
 = 
pos
->
width
 +Öos->
x‹ig
 - 
evít
->
roŸx
 -Öos->
xoff
;

437 
	`GrMoveWödow
(
wödow
->
pid
, 
√wx
, 
pos
->
y‹ig
);

438 
	`GrResizeWödow
(
wödow
->
pid
, 
√wwidth
, 
pos
->
height
);

439 
	}
}

441 
	$À·ªsize_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

443 
GR_COORD
 
√wx
;

444 
GR_SIZE
 
√wwidth
, 
√wheight
;

445 
pos_size
 *
pos
;

447 
	`D¥ötf
("À·ªsize_mou£moved wödow %d\n", 
wödow
->
wid
);

449 if(!
wödow
->
a˘ive
) ;

451 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

453 
√wx
 = 
evít
->
roŸx
 - 
pos
->
xoff
;

454 
√wheight
 = 
evít
->
roŸy
 - 
pos
->
y‹ig
;

455 
√wwidth
 = 
pos
->
width
 +Öos->
x‹ig
 - 
evít
->
roŸx
 -Öos->
xoff
;

457 
	`GrMoveWödow
(
wödow
->
pid
, 
√wx
, 
pos
->
y‹ig
);

458 
	`GrResizeWödow
(
wödow
->
pid
, 
√wwidth
, 
√wheight
);

459 
	}
}

461 
	$bŸtomb¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

463 
GR_SIZE
 
√wheight
;

464 
pos_size
 *
pos
;

466 
	`D¥ötf
("bŸtomb¨_mou£moved wödow %d\n", 
wödow
->
wid
);

468 if(!
wödow
->
a˘ive
) ;

470 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

472 
√wheight
 = 
evít
->
roŸy
 - 
pos
->
y‹ig
;

474 
	`GrResizeWödow
(
wödow
->
pid
, 
pos
->
width
, 
√wheight
);

475 
	}
}

477 
	$righåesize_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

479 
GR_SIZE
 
√wwidth
, 
√wheight
;

480 
pos_size
 *
pos
;

482 
	`D¥ötf
("righåesize_mou£moved wödow %d\n", 
wödow
->
wid
);

484 if(!
wödow
->
a˘ive
) ;

486 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

488 
√wheight
 = 
evít
->
roŸy
 - 
pos
->
y‹ig
;

489 
√wwidth
 = 
evít
->
roŸx
 - 
pos
->
x‹ig
;

491 
	`GrResizeWödow
(
wödow
->
pid
, 
√wwidth
, 
√wheight
);

492 
	}
}

494 
	$rightb¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
)

496 
GR_SIZE
 
√wwidth
;

497 
pos_size
 *
pos
;

499 
	`D¥ötf
("rightb¨_mou£moved wödow %d\n", 
wödow
->
wid
);

501 if(!
wödow
->
a˘ive
) ;

503 
pos
 = (
pos_size
 *Ë
wödow
->
d©a
;

505 
√wwidth
 = 
evít
->
roŸx
 - 
pos
->
x‹ig
;

507 
	`GrResizeWödow
(
wödow
->
pid
, 
√wwidth
, 
pos
->
height
);

509 
	}
}

	@demos/nanowm/assert.c

1 
	~<as£π.h
>

3 #i‡
PSP


4 
	$__as£π
(c⁄° * 
s
, 
n
, c⁄° *
s1
)

6 
	}
}

	@demos/nanowm/clients.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	#MWINCLUDECOLORS


	)

10 
	~"«no-X.h
"

11 
	~"nxdøw.h
"

15 
	~"«nowm.h
"

18 
	#DEFAULT_WINDOW_STYLE
 (
GR_WM_PROPS_APPFRAME
 | 
GR_WM_PROPS_CAPTION
 |\

19 
GR_WM_PROPS_CLOSEBOX
)

	)

21 #i‡
PSP


22 
	#Ârötf
(...)

	)

25 
GR_COORD
 
	gœ°x
 = 
FIRST_WINDOW_LOCATION
;

26 
GR_COORD
 
	gœ°y
 = 
FIRST_WINDOW_LOCATION
;

32 
	$√w_˛õ¡_wödow
(
GR_WINDOW_ID
 
wid
)

34 
wö
 
wödow
;

35 
GR_WINDOW_ID
 
pid
;

36 
GR_WINDOW_INFO
 
wöfo
;

37 
GR_COORD
 
x
, 
y
, 
width
, 
height
, 
xoff£t
, 
yoff£t
;

38 
GR_WM_PROPS
 
°yÀ
;

39 
GR_WM_PROPERTIES
 
¥›s
;

42 
	`GrGëWödowInfo
(
wid
, &
wöfo
);

43 
°yÀ
 = 
wöfo
.
¥›s
;

46 i‡(
wöfo
.
∑ª¡
 !
GR_ROOT_WINDOW_ID
 ||

47 (
°yÀ
 & 
GR_WM_PROPS_NODECORATE
))

51 i‡(
wöfo
.
b‹dîsize
) {

64 
	`GrUnm≠Wödow
(
wid
);

67 
¥›s
.
Êags
 = 
°yÀ
 | 
GR_WM_FLAGS_BORDERSIZE
;

68 
¥›s
.
b‹dîsize
 = 0;

69 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
);

72 
	`GrM≠Wödow
(
wid
);

77 i‡((
°yÀ
 & 
GR_WM_PROPS_APPMASK
Ë=
GR_WM_PROPS_APPWINDOW
) {

78 
GR_WM_PROPERTIES
 
¥
;

80 
°yÀ
 = (°yÀ & ~
GR_WM_PROPS_APPMASK
)|
DEFAULT_WINDOW_STYLE
;

81 
¥
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

82 
¥
.
¥›s
 = 
°yÀ
;

83 
	`GrSëWMPr›îtõs
(
wid
, &
¥
);

87 i‡(
°yÀ
 & 
GR_WM_PROPS_APPFRAME
) {

88 
width
 = 
wöfo
.width + 
CXFRAME
;

89 
height
 = 
wöfo
.heighà+ 
CYFRAME
;

90 
xoff£t
 = 
CXBORDER
;

91 
yoff£t
 = 
CYBORDER
;

92 } i‡(
°yÀ
 & 
GR_WM_PROPS_BORDER
) {

93 
width
 = 
wöfo
.width + 2;

94 
height
 = 
wöfo
.height + 2;

95 
xoff£t
 = 1;

96 
yoff£t
 = 1;

98 
width
 = 
wöfo
.width;

99 
height
 = 
wöfo
.height;

100 
xoff£t
 = 0;

101 
yoff£t
 = 0;

103 i‡(
°yÀ
 & 
GR_WM_PROPS_CAPTION
) {

104 
height
 +
CYCAPTION
;

105 
yoff£t
 +
CYCAPTION
;

106 i‡(
°yÀ
 & 
GR_WM_PROPS_APPFRAME
) {

108 ++
height
;

109 ++
yoff£t
;

114 i‡(
°yÀ
 & 
GR_WM_PROPS_NOAUTOMOVE
) {

115 
x
 = 
wöfo
.x;

116 
y
 = 
wöfo
.y;

119 
x
 = 
œ°x
 + 
WINDOW_STEP
;

120 if((
x
 + 
width
Ë> 
si
.
cﬁs
)

121 
x
 = 
FIRST_WINDOW_LOCATION
;

122 
œ°x
 = 
x
;

123 
y
 = 
œ°y
 + 
WINDOW_STEP
;

124 if((
y
 + 
height
Ë> 
si
.
rows
)

125 
y
 = 
FIRST_WINDOW_LOCATION
;

126 
œ°y
 = 
y
;

130 
pid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 
x
, 
y
, 
width
, 
height
,

131 0, 
LTGRAY
, 
BLACK
);

132 
wödow
.
wid
 = 
pid
;

133 
wödow
.
pid
 = 
GR_ROOT_WINDOW_ID
;

134 
wödow
.
ty≥
 = 
WINDOW_TYPE_CONTAINER
;

135 
wödow
.
sizög
 = 
GR_FALSE
;

136 
wödow
.
a˘ive
 = 0;

137 
wödow
.
d©a
 = 
NULL
;

138 
wödow
.
˛õ¡id
 = 
wid
;

139 
	`add_wödow
(&
wödow
);

142 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

143 
¥›s
.¥›†
°yÀ
 | 
GR_WM_PROPS_NOBACKGROUND
;

144 
	`GrSëWMPr›îtõs
(
pid
, &
¥›s
);

146 
	`D¥ötf
("New clõ¡ wödow %d c⁄èöî %d\n", 
wid
, 
pid
);

148 
	`GrSñe˘Evíts
(
pid
, 
GR_EVENT_MASK_CHLD_UPDATE


149 | 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_BUTTON_DOWN


150 | 
GR_EVENT_MASK_MOUSE_POSITION
 | 
GR_EVENT_MASK_EXPOSURE
);

153 
	`GrRï¨ítWödow
(
wid
, 
pid
, 
xoff£t
, 
yoff£t
);

156 
	`GrM≠Wödow
(
pid
);

158 
	`GrSëFocus
(
wid
);

161 
wödow
.
wid
 = wid;

162 
wödow
.
pid
 =Öid;

163 
wödow
.
ty≥
 = 
WINDOW_TYPE_CLIENT
;

164 
wödow
.
sizög
 = 
GR_FALSE
;

165 
wödow
.
a˘ive
 = 0;

166 
wödow
.
˛õ¡id
 = 0;

167 
wödow
.
d©a
 = 
NULL
;

168 
	`add_wödow
(&
wödow
);

172 
nid
 = 
	`GrNewWödow
(
pid
, 0, 0, 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT, 0,

173 
LTGRAY
, 
BLACK
);

174 
wödow
.
wid
 = 
nid
;

175 
wödow
.
pid
 =Öid;

176 
wödow
.
ty≥
 = 
WINDOW_TYPE_UTILITYBUTTON
;

177 
wödow
.
a˘ive
 = 
GR_FALSE
;

178 
wödow
.
d©a
 = 
NULL
;

179 
	`add_wödow
(&
wödow
);

181 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


182 | 
GR_EVENT_MASK_EXPOSURE


183 | 
GR_EVENT_MASK_MOUSE_EXIT
);

184 
	`GrM≠Wödow
(
nid
);

185 
	`GrBôm≠
(
nid
, 
buâ⁄sgc
, 0, 0, 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT,

186 
utûôybuâ⁄_nŸ¥es£d
);

188 
nid
 = 
	`GrNewWödow
(
pid
, 
TITLE_BAR_HEIGHT
 + 1, 1, 
width
 - (4 *

189 
TITLE_BAR_HEIGHT
Ë- 3, TITLE_BAR_HEIGHT - 3, 1, 
LTGRAY
,

190 
BLACK
);

191 
wödow
.
wid
 = 
nid
;

192 
wödow
.
pid
 =Öid;

193 
wödow
.
ty≥
 = 
WINDOW_TYPE_TOPBAR
;

194 
wödow
.
a˘ive
 = 
GR_FALSE
;

195 
wödow
.
d©a
 = 
NULL
;

197 
	`add_wödow
(&
wödow
);

199 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


200 | 
GR_EVENT_MASK_EXPOSURE


201 | 
GR_EVENT_MASK_MOUSE_POSITION
);

202 
	`GrM≠Wödow
(
nid
);

204 
nid
 = 
	`GrNewWödow
(
pid
, 
width
 - (3 * 
TITLE_BAR_HEIGHT
), 0,

205 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT, 0, 
LTGRAY
, 
BLACK
);

206 
wödow
.
wid
 = 
nid
;

207 
wödow
.
pid
 =Öid;

208 
wödow
.
ty≥
 = 
WINDOW_TYPE_ICONISEBUTTON
;

209 
wödow
.
a˘ive
 = 
GR_FALSE
;

210 
wödow
.
d©a
 = 
NULL
;

211 
	`add_wödow
(&
wödow
);

213 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


214 | 
GR_EVENT_MASK_EXPOSURE


215 | 
GR_EVENT_MASK_MOUSE_EXIT
);

216 
	`GrM≠Wödow
(
nid
);

217 
	`GrBôm≠
(
nid
, 
buâ⁄sgc
, 0, 0, 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT,

218 
ic⁄i£buâ⁄_nŸ¥es£d
);

220 
nid
 = 
	`GrNewWödow
(
pid
, 
width
 - (2 * 
TITLE_BAR_HEIGHT
), 0,

221 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT, 0, 
LTGRAY
, 
BLACK
);

222 
wödow
.
wid
 = 
nid
;

223 
wödow
.
pid
 =Öid;

224 
wödow
.
ty≥
 = 
WINDOW_TYPE_MAXIMISEBUTTON
;

225 
wödow
.
a˘ive
 = 
GR_FALSE
;

226 
wödow
.
d©a
 = 
NULL
;

227 
	`add_wödow
(&
wödow
);

229 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


230 | 
GR_EVENT_MASK_EXPOSURE


231 | 
GR_EVENT_MASK_MOUSE_EXIT
);

232 
	`GrM≠Wödow
(
nid
);

233 
	`GrBôm≠
(
nid
, 
buâ⁄sgc
, 0, 0, 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT,

234 
maximi£buâ⁄_nŸ¥es£d
);

236 
nid
 = 
	`GrNewWödow
(
pid
, 
width
 - 
TITLE_BAR_HEIGHT
, 0,

237 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT, 0, 
LTGRAY
, 
BLACK
);

238 
wödow
.
wid
 = 
nid
;

239 
wödow
.
pid
 =Öid;

240 
wödow
.
ty≥
 = 
WINDOW_TYPE_CLOSEBUTTON
;

241 
wödow
.
a˘ive
 = 
GR_FALSE
;

242 
wödow
.
d©a
 = 
NULL
;

243 
	`add_wödow
(&
wödow
);

245 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


246 | 
GR_EVENT_MASK_EXPOSURE


247 | 
GR_EVENT_MASK_MOUSE_EXIT
);

248 
	`GrM≠Wödow
(
nid
);

249 
	`GrBôm≠
(
nid
, 
buâ⁄sgc
, 0, 0, 
TITLE_BAR_HEIGHT
, TITLE_BAR_HEIGHT,

250 
˛o£buâ⁄_nŸ¥es£d
);

252 
nid
 = 
	`GrNewWödow
(
pid
, 1, 
TITLE_BAR_HEIGHT
 + 1, 
BORDER_WIDTHS
 - 2,

253 
height
 - 
TITLE_BAR_HEIGHT
 - 
BORDER_WIDTHS
 - 1,

254 1, 
LTGRAY
, 
BLACK
);

255 
wödow
.
wid
 = 
nid
;

256 
wödow
.
pid
 =Öid;

257 
wödow
.
ty≥
 = 
WINDOW_TYPE_LEFTBAR
;

258 
wödow
.
a˘ive
 = 
GR_FALSE
;

259 
wödow
.
d©a
 = 
NULL
;

261 
	`add_wödow
(&
wödow
);

263 
	`GrSëCurs‹
(
nid
, 
h‹iz⁄èl_ªsize_cﬁumns
, 
h‹iz⁄èl_ªsize_rows
,

264 
h‹iz⁄èl_ªsize_hŸx
, 
h‹iz⁄èl_ªsize_hŸy
,

265 
BLACK
, 
WHITE
, 
h‹iz⁄èl_ªsize_fg
,

266 
h‹iz⁄èl_ªsize_bg
);

268 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


269 | 
GR_EVENT_MASK_MOUSE_POSITION
);

271 
	`GrM≠Wödow
(
nid
);

273 
nid
 = 
	`GrNewWödow
(
pid
, 1, 
height
 - 
BORDER_WIDTHS
 + 1, BORDER_WIDTHS - 2,

274 
BORDER_WIDTHS
 - 2, 1, 
LTGRAY
, 
BLACK
);

275 
wödow
.
wid
 = 
nid
;

276 
wödow
.
pid
 =Öid;

277 
wödow
.
ty≥
 = 
WINDOW_TYPE_LEFTRESIZE
;

278 
wödow
.
a˘ive
 = 
GR_FALSE
;

279 
wödow
.
d©a
 = 
NULL
;

282 
	`add_wödow
(&
wödow
);

284 
	`GrSëCurs‹
(
nid
, 
À·h™d_ªsize_cﬁumns
, 
À·h™d_ªsize_rows
,

285 
À·h™d_ªsize_hŸx
, 
À·h™d_ªsize_hŸy
,

286 
BLACK
, 
WHITE
, 
À·h™d_ªsize_fg
, 
À·h™d_ªsize_bg
);

288 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


289 | 
GR_EVENT_MASK_MOUSE_POSITION
);

291 
	`GrM≠Wödow
(
nid
);

293 
nid
 = 
	`GrNewWödow
(
pid
, 
BORDER_WIDTHS
, 
height
 - BORDER_WIDTHS + 1,

294 
width
 - (2 * 
BORDER_WIDTHS
), BORDER_WIDTHS - 2, 1,

295 
LTGRAY
, 
BLACK
);

296 
wödow
.
wid
 = 
nid
;

297 
wödow
.
pid
 =Öid;

298 
wödow
.
ty≥
 = 
WINDOW_TYPE_BOTTOMBAR
;

299 
wödow
.
a˘ive
 = 
GR_FALSE
;

300 
wödow
.
d©a
 = 
NULL
;

301 
	`add_wödow
(&
wödow
);

303 
	`GrSëCurs‹
(
nid
, 
vîtiˇl_ªsize_cﬁumns
, 
vîtiˇl_ªsize_rows
,

304 
vîtiˇl_ªsize_hŸx
, 
vîtiˇl_ªsize_hŸy
,

305 
BLACK
, 
WHITE
, 
vîtiˇl_ªsize_fg
, 
vîtiˇl_ªsize_bg
);

307 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


308 | 
GR_EVENT_MASK_MOUSE_POSITION
);

310 
	`GrM≠Wödow
(
nid
);

312 
nid
 = 
	`GrNewWödow
(
pid
, 
width
 - 
BORDER_WIDTHS
 + 1,

313 
height
 - 
BORDER_WIDTHS
 + 1, BORDER_WIDTHS - 2,

314 
BORDER_WIDTHS
 - 2, 1, 
LTGRAY
, 
BLACK
);

315 
wödow
.
wid
 = 
nid
;

316 
wödow
.
pid
 =Öid;

317 
wödow
.
ty≥
 = 
WINDOW_TYPE_RIGHTRESIZE
;

318 
wödow
.
a˘ive
 = 
GR_FALSE
;

319 
wödow
.
d©a
 = 
NULL
;

321 
	`add_wödow
(&
wödow
);

323 
	`GrSëCurs‹
(
nid
, 
righth™d_ªsize_cﬁumns
, 
righth™d_ªsize_rows
,

324 
righth™d_ªsize_hŸx
, 
righth™d_ªsize_hŸy
,

325 
BLACK
, 
WHITE
, 
righth™d_ªsize_fg
, 
righth™d_ªsize_bg
);

327 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


328 | 
GR_EVENT_MASK_MOUSE_POSITION
);

330 
	`GrM≠Wödow
(
nid
);

332 
nid
 = 
	`GrNewWödow
(
pid
, 
width
 - 
BORDER_WIDTHS
 + 1, 
TITLE_BAR_HEIGHT
 + 1,

333 
BORDER_WIDTHS
 - 2, 
height
 - 
TITLE_BAR_HEIGHT
 - BORDER_WIDTHS -1,

334 1, 
LTGRAY
, 
BLACK
);

335 
wödow
.
wid
 = 
nid
;

336 
wödow
.
pid
 =Öid;

337 
wödow
.
ty≥
 = 
WINDOW_TYPE_RIGHTBAR
;

338 
wödow
.
a˘ive
 = 
GR_FALSE
;

339 
wödow
.
d©a
 = 
NULL
;

341 
	`add_wödow
(&
wödow
);

343 
	`GrSëCurs‹
(
nid
, 
h‹iz⁄èl_ªsize_cﬁumns
, 
h‹iz⁄èl_ªsize_rows
,

344 
h‹iz⁄èl_ªsize_hŸx
, 
h‹iz⁄èl_ªsize_hŸy
,

345 
BLACK
, 
WHITE
, 
h‹iz⁄èl_ªsize_fg
,

346 
h‹iz⁄èl_ªsize_bg
);

348 
	`GrSñe˘Evíts
(
nid
, 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP


349 | 
GR_EVENT_MASK_MOUSE_POSITION
);

350 
	`GrM≠Wödow
(
nid
);

353 
	}
}

355 
	$˛õ¡_wödow_ªm≠
(
wö
 *
wödow
) {

357 
GR_WINDOW_INFO
 
wöfo
;

358 
wö
 *
pwö
;

360 if(!(
pwö
 = 
	`föd_wödow
(
wödow
->
pid
))) {

361 
	`Ârötf
(
°dîr
, "Couldn't findÖarent of destroyed window "

362 "%d\n", 
wödow
->
wid
);

366 
	`D¥ötf
("˛õ¡_wödow_ªm≠ %d (∑ª¡ %d)\n", 
wödow
->
wid
, wödow->
pid
);

367 
	`GrGëWödowInfo
(
pwö
->
wid
, &
wöfo
);

368 i‡(
wöfo
.
m≠≥d
 =
GR_FALSE
Ë
	`GrM≠Wödow
(
pwö
->
wid
);

369 
	}
}

373 
	$˛õ¡_wödow_unm≠
(
wö
 *
wödow
) {

374 
wö
 *
pwö
;

376 if(!(
pwö
 = 
	`föd_wödow
(
wödow
->
pid
))) {

377 
	`Ârötf
(
°dîr
, "Couldn't findÖarent of destroyed window "

378 "%d\n", 
wödow
->
wid
);

382 
	`GrUnm≠Wödow
(
pwö
->
wid
);

383 
	}
}

386 
	$˛õ¡_wödow_ªsize
(
wö
 *
wödow
)

388 
wö
 *
pwö
;

389 
GR_COORD
 
width
, 
height
;

390 
GR_WM_PROPS
 
°yÀ
;

391 
GR_WINDOW_INFO
 
wöfo
;

393 
	`D¥ötf
("˛õ¡_wödow_ªsizê%d (∑ª¡ %d)\n", 
wödow
->
wid
, wödow->
pid
);

394 if(!(
pwö
 = 
	`föd_wödow
(
wödow
->
pid
))) {

395 
	`Ârötf
(
°dîr
, "Couldn'àfödÖ¨íào‡ªsizêwödow %d\n", 
wödow
->
wid
);

400 
	`GrGëWödowInfo
(
pwö
->
˛õ¡id
, &
wöfo
);

401 
°yÀ
 = 
wöfo
.
¥›s
;

403 i‡(
°yÀ
 & 
GR_WM_PROPS_APPFRAME
) {

404 
width
 = 
wöfo
.width + 
CXFRAME
;

405 
height
 = 
wöfo
.heighà+ 
CYFRAME
;

406 } i‡(
°yÀ
 & 
GR_WM_PROPS_BORDER
) {

407 
width
 = 
wöfo
.width + 2;

408 
height
 = 
wöfo
.height + 2;

410 
width
 = 
wöfo
.width;

411 
height
 = 
wöfo
.height;

413 i‡(
°yÀ
 & 
GR_WM_PROPS_CAPTION
) {

414 
height
 +
CYCAPTION
;

415 i‡(
°yÀ
 & 
GR_WM_PROPS_APPFRAME
) {

417 ++
height
;

422 
	`GrResizeWödow
(
pwö
->
wid
, 
width
, 
height
);

423 
	}
}

429 
	$˛õ¡_wödow_de°roy
(
wö
 *
wödow
)

431 
wö
 *
pwö
;

432 
GR_WINDOW_ID
 
pid
;

434 
	`D¥ötf
("Clõ¡ wödow %d ha†bì¿de°royed\n", 
wödow
->
wid
);

436 if(!(
pwö
 = 
	`föd_wödow
(
wödow
->
pid
))) {

437 
	`Ârötf
(
°dîr
, "Couldn't findÖarent of destroyed window "

438 "%d\n", 
wödow
->
wid
);

443 
pid
 = 
pwö
->
wid
;

444 
	`ªmove_wödow_™d_chûdªn
(
pwö
);

446 
	`D¥ötf
("De°royög c⁄èöî %d\n", 
pid
);

447 
	`GrDe°royWödow
(
pid
);

448 
	}
}

	@demos/nanowm/events.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	#MWINCLUDECOLORS


	)

10 
	~"«no-X.h
"

14 
	~"«nowm.h
"

16 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
evít
)

18 
wö
 *
wödow
;

20 
	`D¥ötf
("do_exposure: wid %d, x %d, y %d, width %d, height %d\n",

21 
evít
->
wid
,Évít->
x
,Évít->
y
,Évít->
width
,Évít->
height
);

23 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
))) ;

25 
wödow
->
ty≥
) {

26 
WINDOW_TYPE_CONTAINER
:

27 
	`c⁄èöî_exposuª
(
wödow
, 
evít
);

30 
	`¥ötf
("UnhandledÉxposure on window %d "

31 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

35 
	}
}

37 
	$do_buâ⁄_down
(
GR_EVENT_BUTTON
 *
evít
)

39 
wö
 *
wödow
;

41 
	`D¥ötf
("do_button_down: wid %d, subwid %d,Ñootx %d,Ñooty %d, x %d, "

43 
evít
->
wid
,Évít->
subwid
,Évít->
roŸx
,Évít->
roŸy
,Évít->
x
,

44 
evít
->
y
,Évít->
buâ⁄s
,Évít->
ch™gebuâ⁄s
,

45 
evít
->
modifõrs
);

47 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
))) ;

49 
wödow
->
ty≥
) {

50 
WINDOW_TYPE_CONTAINER
:

51 
	`c⁄èöî_buâ⁄down
(
wödow
, 
evít
);

54 
	`¥ötf
("Unhandled button down on window %d "

55 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

58 
	}
}

60 
	$do_buâ⁄_up
(
GR_EVENT_BUTTON
 *
evít
)

62 
wö
 *
wödow
;

64 
	`D¥ötf
("do_button_up: wid %d, subwid %d,Ñootx %d,Ñooty %d, x %d, "

66 
evít
->
wid
,Évít->
subwid
,Évít->
roŸx
,Évít->
roŸy
,Évít->
x
,

67 
evít
->
y
,Évít->
buâ⁄s
,Évít->
ch™gebuâ⁄s
,

68 
evít
->
modifõrs
);

70 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
))) ;

72 
wödow
->
ty≥
) {

73 
WINDOW_TYPE_CONTAINER
:

74 
	`c⁄èöî_buâ⁄up
(
wödow
, 
evít
);

77 
	`¥ötf
("Unhandled button up on window %d "

78 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

81 
	}
}

83 
	$do_mou£_íãr
(
GR_EVENT_GENERAL
 *
evít
)

85 
wö
 *
wödow
;

87 
	`D¥ötf
("do_mou£_íãr: wid %d\n", 
evít
->
wid
);

89 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
)))

92 
wödow
->
ty≥
) {

94 
	`¥ötf
("Unhandled mouseÉnter from window %d "

95 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

98 
	}
}

100 
	$do_mou£_exô
(
GR_EVENT_GENERAL
 *
evít
)

102 
wö
 *
wödow
;

104 
	`D¥ötf
("do_mou£_exô: wid %d\n", 
evít
->
wid
);

106 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
))) ;

108 
wödow
->
ty≥
) {

110 
	`¥ötf
("Unhandled mouseÉxit from window %d "

111 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

114 
	}
}

116 
	$do_mou£_moved
(
GR_EVENT_MOUSE
 *
evít
)

118 
wö
 *
wödow
;

120 
	`D¥ötf
("do_mouse_moved: wid %d, subwid %d,Ñootx %d,Ñooty %d, x %d, "

121 "y %d, buâ⁄†%d, modifõr†%d\n", 
evít
->
wid
,Évít->
subwid
,

122 
evít
->
roŸx
,Évít->
roŸy
,Évít->
x
,Évít->
y
,Évít->
buâ⁄s
,

123 
evít
->
modifõrs
);

125 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
))) ;

127 
wödow
->
ty≥
) {

128 
WINDOW_TYPE_CONTAINER
:

129 
	`c⁄èöî_mou£moved
(
wödow
, 
evít
);

132 
	`¥ötf
("Unhandled mouse movement in window %d "

133 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

136 
	}
}

138 
	$do_focus_ö
(
GR_EVENT_GENERAL
 *
evít
)

140 
wö
 *
wödow
;

142 
	`¥ötf
("do_focus_ö: wid %d\n", 
evít
->
wid
);

144 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
wid
)))

147 
wödow
->
ty≥
) {

149 
	`¥ötf
("Unhandled focus in from window %d "

150 "—y≥ %d)\n", 
wödow
->
wid
, wödow->
ty≥
);

153 
	}
}

155 
	$do_key_down
(
GR_EVENT_KEYSTROKE
 *
evít
)

157 
	`D¥ötf
("do_key_down: wid %d, subwid %d,Ñootx %d,Ñooty %d, x %d, "

159 
evít
->
wid
,Évít->
subwid
,Évít->
roŸx
,

160 
evít
->
roŸy
,Évít->
x
,Évít->
y
,Évít->
buâ⁄s
,

161 
evít
->
modifõrs
,Évít->
ch
,Évít->
sˇncode
);

164 
	}
}

166 
	$do_key_up
(
GR_EVENT_KEYSTROKE
 *
evít
)

168 
	`D¥ötf
("do_key_up: wid %d, subwid %d,Ñootx %d,Ñooty %d, x %d, "

170 
evít
->
wid
,Évít->
subwid
,Évít->
roŸx
,

171 
evít
->
roŸy
,Évít->
x
,Évít->
y
,Évít->
buâ⁄s
,

172 
evít
->
modifõrs
,Évít->
ch
,Évít->
sˇncode
);

173 
	}
}

175 
	$do_upd©e
(
GR_EVENT_UPDATE
 *
evít
)

177 
wö
 *
wödow
;

179 
	`D¥ötf
("do_update: wid %d, subwid %d, x %d, y %d, width %d, height %d, "

180 "uty≥ %d\n", 
evít
->
wid
,Évít->
subwid
,Évít->
x
,Évít->
y
,Évít->
width
,

181 
evít
->
height
,Évít->
uty≥
);

183 if(!(
wödow
 = 
	`föd_wödow
(
evít
->
subwid
))) {

184 i‡(
evít
->
uty≥
 =
GR_UPDATE_MAP
Ë
	`√w_˛õ¡_wödow
”vít->
subwid
);

188 if(
wödow
->
ty≥
 =
WINDOW_TYPE_CONTAINER
) {

189 i‡(
evít
->
uty≥
 =
GR_UPDATE_ACTIVATE
)

190 
	`ªdøw_nˇªa
(
wödow
);

194 i‡(
wödow
->
ty≥
 =
WINDOW_TYPE_CLIENT
) {

195 if(
evít
->
uty≥
 =
GR_UPDATE_MAP
Ë
	`˛õ¡_wödow_ªm≠
(
wödow
);

196 if(
evít
->
uty≥
 =
GR_UPDATE_DESTROY
Ë
	`˛õ¡_wödow_de°roy
(
wödow
);

197 if(
evít
->
uty≥
 =
GR_UPDATE_UNMAP
Ë
	`˛õ¡_wödow_unm≠
(
wödow
);

198 if(
evít
->
uty≥
 =
GR_UPDATE_SIZE
Ë
	`˛õ¡_wödow_ªsize
(
wödow
);

200 
	}
}

	@demos/nanowm/nanowm.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	#MWINCLUDECOLORS


	)

11 
	~"«no-X.h
"

15 
	~"«nowm.h
"

17 #i‡
PSP


19 
	~<p•kî√l.h
>

20 
	~<p•debug.h
>

22 
PSP_MAIN_THREAD_ATTR
(
THREAD_ATTR_USER
 | 
THREAD_ATTR_VFPU
);

26 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

28 
	#¥ötf
(...)

	)

33 
	$exô_ˇŒback
()

35 
	`s˚Kî√lExôGame
();

38 
	}
}

41 
	$CÆlbackThªad
(*
¨g
)

43 
cbid
;

46 
cbid
 = 
	`s˚Kî√lCª©eCÆlback
("Exô CÆlback", 
exô_ˇŒback
, 
NULL
);

47 
	`s˚Kî√lRegi°îExôCÆlback
(
cbid
);

49 
	}
}

52 
	$SëupCÆlbacks
()

54 
thid
 = 0;

56 
thid
 = 
	`s˚Kî√lCª©eThªad
("upd©e_thªad", 
CÆlbackThªad
, 0x11, 0xFA0, 0, 0);

57 if(
thid
 >= 0)

59 
	`s˚Kî√lSèπThªad
(
thid
, 0, 0);

62  
thid
;

63 
	}
}

69 
GR_SCREEN_INFO
 
	gsi
;

71 
	$maö
(
¨gc
, *
¨gv
[])

73 
GR_EVENT
 
evít
;

74 
GR_WM_PROPERTIES
 
¥›s
;

75 
wö
 
wödow
;

77 #i‡
PSP


80 
	`p•DebugS¸ìnInô
();

81 
	`¥ötf
("BoŸ∑th: %s\n", 
g_ñf_«me
);

82 
	`SëupCÆlbacks
();

87 if(
	`GrO≥n
() < 0) {

88 #i‡!
PSP


89 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server!\n");

91 
	`¥ötf
("Couldn't connectÅo Nano-X server!\n");

93 
	`exô
(1);

96 #i‡
PSP


97 
	`¥ötf
("GrOpen succeeded.\n");

101 
	`GrSëEº‹H™dÀr
(
NULL
);

103 
	`GrGëS¸ìnInfo
(&
si
);

105 #i‡
PSP


106 
	`¥ötf
("Got info.\n");

109 
wödow
.
wid
 = 
GR_ROOT_WINDOW_ID
;

110 
wödow
.
pid
 = 
GR_ROOT_WINDOW_ID
;

111 
wödow
.
ty≥
 = 
WINDOW_TYPE_ROOT
;

112 
wödow
.
˛õ¡id
 = 1;

113 
wödow
.
sizög
 = 
GR_FALSE
;

114 
wödow
.
a˘ive
 = 0;

115 
wödow
.
d©a
 = 
NULL
;

116 
	`add_wödow
(&
wödow
);

118 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_CHLD_UPDATE
);

121 
¥›s
.
Êags
 = 
GR_WM_FLAGS_BACKGROUND
;

122 
¥›s
.
background
 = 
	`GrGëSysCﬁ‹
(
GR_COLOR_DESKTOP
);

123 
	`GrSëWMPr›îtõs
(
GR_ROOT_WINDOW_ID
, &
¥›s
);

126 
	`GrGëNextEvít
(&
evít
);

128 
evít
.
ty≥
) {

129 
GR_EVENT_TYPE_ERROR
:

130 
	`¥ötf
("«nowm:Éº‹ %d\n", 
evít
.
îr‹
.
code
);

132 
GR_EVENT_TYPE_EXPOSURE
:

133 
	`do_exposuª
(&
evít
.
exposuª
);

135 
GR_EVENT_TYPE_BUTTON_DOWN
:

136 
	`do_buâ⁄_down
(&
evít
.
buâ⁄
);

138 
GR_EVENT_TYPE_BUTTON_UP
:

139 
	`do_buâ⁄_up
(&
evít
.
buâ⁄
);

141 
GR_EVENT_TYPE_MOUSE_ENTER
:

142 
	`do_mou£_íãr
(&
evít
.
gíîÆ
);

144 
GR_EVENT_TYPE_MOUSE_EXIT
:

145 
	`do_mou£_exô
(&
evít
.
gíîÆ
);

147 
GR_EVENT_TYPE_MOUSE_POSITION
:

148 
	`do_mou£_moved
(&
evít
.
mou£
);

150 
GR_EVENT_TYPE_KEY_DOWN
:

151 
	`do_key_down
(&
evít
.
key°roke
);

153 
GR_EVENT_TYPE_KEY_UP
:

154 
	`do_key_up
(&
evít
.
key°roke
);

156 
GR_EVENT_TYPE_FOCUS_IN
:

157 
	`do_focus_ö
(&
evít
.
gíîÆ
);

159 
GR_EVENT_TYPE_CHLD_UPDATE
:

160 
	`do_upd©e
(&
evít
.
upd©e
);

163 #i‡!
PSP


164 
	`Ârötf
(
°dîr
, "Got unexpectedÉvent %d\n",

165 
evít
.
ty≥
);

171 
	`GrClo£
();

172 
	}
}

	@demos/nanowm/nanowm.h

6 #i‚de‡
__NANOWM_H


7 
	#__NANOWM_H


	)

9 #ifde‡
WMDEBUG


10 
	#D¥ötf
 
¥ötf


	)

12 
	#D¥ötf
(
ign‹e
...)

	)

16 
	#FIRST_WINDOW_LOCATION
 2

	)

19 
	#WINDOW_STEP
 20

	)

23 
	mWINDOW_TYPE_ROOT
,

24 
	mWINDOW_TYPE_CONTAINER
,

25 
WINDOW_TYPE_CLIENT


52 
	swödowli°
 {

53 
GR_WINDOW_ID
 
	mwid
;

54 
GR_WINDOW_ID
 
	mpid
;

55 
GR_WINDOW_ID
 
	m˛õ¡id
;

56 
	mty≥
;

57 
	msizög
;

58 
	ma˘ive
;

59 *
	md©a
;

60 
wödowli°
 *
	m√xt
;

62 
wödowli°
 
	twö
;

67 
	sposôi⁄
 {

68 
GR_COORD
 
	mx
;

69 
GR_COORD
 
	my
;

76 
	spos_size
 {

77 
GR_COORD
 
	mxoff
;

78 
GR_COORD
 
	myoff
;

79 
GR_COORD
 
	mx‹ig
;

80 
GR_COORD
 
	my‹ig
;

81 
GR_SIZE
 
	mwidth
;

82 
GR_SIZE
 
	mheight
;

89 
	s˛õ¡öfo
 {

90 
GR_WINDOW_ID
 
	mcid
;

95 
wö
 *
föd_wödow
(
GR_WINDOW_ID
 
wid
);

96 
add_wödow
(
wö
 *
wödow
);

97 
ªmove_wödow
(
wö
 *
wödow
);

98 
ªmove_wödow_™d_chûdªn
(
wö
 *
wödow
);

99 
√w_˛õ¡_wödow
(
GR_WINDOW_ID
 
wid
);

100 
˛õ¡_wödow_ªsize
(
wö
 *
wödow
);

101 
˛õ¡_wödow_de°roy
(
wö
 *
wödow
);

103 
˛õ¡_wödow_ªm≠
(
wö
 *
wödow
);

104 
˛õ¡_wödow_unm≠
(
wö
 *
wödow
);

106 
ªdøw_nˇªa
(
wö
 *
wödow
);

107 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
evít
);

108 
do_buâ⁄_down
(
GR_EVENT_BUTTON
 *
evít
);

109 
do_buâ⁄_up
(
GR_EVENT_BUTTON
 *
evít
);

110 
do_mou£_íãr
(
GR_EVENT_GENERAL
 *
evít
);

111 
do_mou£_exô
(
GR_EVENT_GENERAL
 *
evít
);

112 
do_mou£_moved
(
GR_EVENT_MOUSE
 *
evít
);

113 
do_focus_ö
(
GR_EVENT_GENERAL
 *
evít
);

114 
do_key_down
(
GR_EVENT_KEYSTROKE
 *
evít
);

115 
do_key_up
(
GR_EVENT_KEYSTROKE
 *
evít
);

116 
do_focus_ö
(
GR_EVENT_GENERAL
 *
evít
);

117 
do_focus_out
(
GR_EVENT_GENERAL
 *
evít
);

118 
do_upd©e
(
GR_EVENT_UPDATE
 *
evít
);

119 
do_chld_upd©e
(
GR_EVENT_UPDATE
 *
evít
);

120 
roŸwödow_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

121 
c⁄èöî_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

122 
t›b¨_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

123 
˛o£buâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

124 
maximi£buâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

125 
ª°‹ebuâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

126 
ic⁄i£buâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

127 
utûôybuâ⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

128 
utûôymíu_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

129 
utûôymíuíåy_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

130 
roŸmíu_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

131 
roŸmíuíåy_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

132 
ic⁄_exposuª
(
wö
 *
wödow
, 
GR_EVENT_EXPOSURE
 *
evít
);

133 
roŸwödow_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

134 
c⁄èöî_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

135 
t›b¨_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

136 
ªsizeb¨_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

137 
˛o£buâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

138 
maximi£buâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

139 
ª°‹ebuâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

140 
ic⁄i£buâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

141 
utûôybuâ⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

142 
ic⁄_buâ⁄down
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

143 
roŸwödow_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

144 
c⁄èöî_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

145 
t›b¨_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

146 
ªsizeb¨_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

147 
˛o£buâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

148 
maximi£buâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

149 
ª°‹ebuâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

150 
ic⁄i£buâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

151 
utûôybuâ⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

152 
ic⁄_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

153 
utûôymíuíåy_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

154 
roŸmíuíåy_buâ⁄up
(
wö
 *
wödow
, 
GR_EVENT_BUTTON
 *
evít
);

155 
˛o£buâ⁄_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

156 
maximi£buâ⁄_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

157 
ª°‹ebuâ⁄_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

158 
ic⁄i£buâ⁄_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

159 
utûôybuâ⁄_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

160 
utûôymíu_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

161 
utûôymíuíåy_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

162 
roŸmíu_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

163 
roŸmíuíåy_mou£exô
(
wö
 *
wödow
, 
GR_EVENT_GENERAL
 *
evít
);

164 
c⁄èöî_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

165 
t›b¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

166 
À·b¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

167 
À·ªsize_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

168 
bŸtomb¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

169 
righåesize_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

170 
rightb¨_mou£moved
(
wö
 *
wödow
, 
GR_EVENT_MOUSE
 *
evít
);

172 
GR_SCREEN_INFO
 
si
;

173 
wö
 *
wödows
;

174 
GR_BITMAP
 
utûôybuâ⁄_nŸ¥es£d
[];

175 
GR_BITMAP
 
utûôybuâ⁄_¥es£d
[];

176 
GR_BITMAP
 
maximi£buâ⁄_nŸ¥es£d
[];

177 
GR_BITMAP
 
maximi£buâ⁄_¥es£d
[];

178 
GR_BITMAP
 
ic⁄i£buâ⁄_nŸ¥es£d
[];

179 
GR_BITMAP
 
ic⁄i£buâ⁄_¥es£d
[];

180 
GR_BITMAP
 
˛o£buâ⁄_nŸ¥es£d
[];

181 
GR_BITMAP
 
˛o£buâ⁄_¥es£d
[];

182 
GR_BITMAP
 
ª°‹ebuâ⁄_nŸ¥es£d
[];

183 
GR_BITMAP
 
ª°‹ebuâ⁄_¥es£d
[];

184 
GR_BITMAP
 
h‹iz⁄èl_ªsize_fg
[];

185 
GR_BITMAP
 
h‹iz⁄èl_ªsize_bg
[];

186 
GR_BITMAP
 
vîtiˇl_ªsize_fg
[];

187 
GR_BITMAP
 
vîtiˇl_ªsize_bg
[];

188 
GR_BITMAP
 
righth™d_ªsize_fg
[];

189 
GR_BITMAP
 
righth™d_ªsize_bg
[];

190 
GR_BITMAP
 
À·h™d_ªsize_fg
[];

191 
GR_BITMAP
 
À·h™d_ªsize_bg
[];

192 
h‹iz⁄èl_ªsize_cﬁumns
, 
h‹iz⁄èl_ªsize_rows
;

193 
h‹iz⁄èl_ªsize_hŸx
, 
h‹iz⁄èl_ªsize_hŸy
;

194 
vîtiˇl_ªsize_cﬁumns
, 
vîtiˇl_ªsize_rows
;

195 
vîtiˇl_ªsize_hŸx
, 
vîtiˇl_ªsize_hŸy
;

196 
À·h™d_ªsize_cﬁumns
, 
À·h™d_ªsize_rows
;

197 
À·h™d_ªsize_hŸx
, 
À·h™d_ªsize_hŸy
;

198 
righth™d_ªsize_cﬁumns
, 
righth™d_ªsize_rows
;

199 
righth™d_ªsize_hŸx
, 
righth™d_ªsize_hŸy
;

	@demos/nanowm/wlist.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	#MWINCLUDECOLORS


	)

10 
	~"«no-X.h
"

14 
	~"«nowm.h
"

16  
wö
 *
	gwödows
 = 
NULL
;

22 
wö
 *
	$föd_wödow
(
GR_WINDOW_ID
 
wid
)

24 
wö
 *
w
 = 
wödows
;

26 
	`D¥ötf
("Lookög f‹ wödow %d... ", 
wid
);

28 
w
) {

29 
	`D¥ötf
("%d ", 
w
->
wid
);

30 if(
w
->
wid
 == wid) {

31 
	`D¥ötf
("found it!\n");

32  
w
;

34 
w
 = w->
√xt
;

37 
	`D¥ötf
("N›e, %d i†nŸ i¿thêli°\n", 
wid
);

38  
NULL
;

39 
	}
}

45 
	$add_wödow
(
wö
 *
wödow
)

47 
wö
 *
w
;

49 
	`D¥ötf
("Addög wödow %d\n", 
wödow
->
wid
);

51 if(!(
w
 = 
	`mÆloc
((
wö
))))  -1;

53 
w
->
wid
 = 
wödow
->wid;

54 
w
->
pid
 = 
wödow
->pid;

55 
w
->
ty≥
 = 
wödow
->type;

56 
w
->
sizög
 = 
GR_FALSE
;

57 
w
->
a˘ive
 = 
wödow
->active;

58 
w
->
˛õ¡id
 = 
wödow
->clientid;

59 
w
->
d©a
 = 
wödow
->data;

60 
w
->
√xt
 = 
wödows
;

61 
wödows
 = 
w
;

64 
	}
}

73 
	$ªmove_wödow
(
wö
 *
wödow
)

75 
wö
 *
w
 = 
wödows
;

76 
wö
 *
¥ev
 = 
NULL
;

78 
w
) {

79 if(
w
 =
wödow
) {

80 if(!
¥ev
Ë
wödows
 = 
w
->
√xt
;

81 
¥ev
->
√xt
 = 
w
->next;

82 if(
w
->
d©a
Ë
	`‰ì
(w->data);

83 
	`‰ì
(
w
);

86 
¥ev
 = 
w
;

87 
w
 = w->
√xt
;

91 
	}
}

97 
	$ªmove_wödow_™d_chûdªn
(
wö
 *
wödow
)

99 
wö
 *
t
, *
w
 = 
wödows
;

100 
wö
 *
¥ev
 = 
NULL
;

101 
GR_WINDOW_ID
 
pid
 = 
wödow
->
wid
;

103 
	`D¥ötf
("Removög wödow %dánd chûdªn\n", 
wödow
->
wid
);

105 
w
) {

106 
	`D¥ötf
("Examöög wödow %d (pid %d)\n", 
w
->
wid
, w->
pid
);

107 if((
w
->
pid
 =pidË|| (w =
wödow
)) {

108 
	`D¥ötf
("Removög wödow %d (pid %d)\n", 
w
->
wid
,

109 
w
->
pid
);

110 if(
¥ev
Ë¥ev->
√xt
 = 
w
->next;

111 
wödows
 = 
w
->
√xt
;

112 
t
 = 
w
->
√xt
;

113 if(
w
->
d©a
Ë
	`‰ì
(w->data);

114 
	`‰ì
(
w
);

115 
w
 = 
t
;

118 
¥ev
 = 
w
;

119 
w
 = w->
√xt
;

123 
	}
}

	@demos/nanox/arcdemo.c

7 
	~<°dlib.h
>

8 
	#MWINCLUDECOLORS


	)

9 
	~"«no-X.h
"

12 
	$døw
(
GR_EVENT
 *
ï
)

14 
GR_WINDOW_ID
 
wid
 = ((
GR_EVENT_EXPOSURE
 *)
ï
)->wid;

15 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

16 
x
 = 40;

17 
y
 = 40;

18 
rx
 = 30;

19 
ry
 = 30;

20 
xoff
 = (
rx
 + 10) * 2;

24 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

25 
	`GrArcAngÀ
(
wid
, 
gc
, 
x
, 
y
, 3, 3, 0, 0, 
GR_PIE
);

27 
	`GrSëGCF‹eground
(
gc
, 
BLACK
);

28 
	`GrArcAngÀ
(
wid
, 
gc
, 
x
, 
y
, 3, 3, 0, 0, 
GR_ARC
);

30 
	`GrSëGCF‹eground
(
gc
, 
BLACK
);

31 
	`GrPoöt
(
wid
, 
gc
, 
x
, 
y
);

33 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

34 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
, 
rx
, 
ry
, 0, -30, -30, 0, 
GR_PIE
);

35 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
, 
rx
, 
ry
, 30, 0, 0, -30, 
GR_PIE
);

36 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
+5, 
rx
, 
ry
, -30, 0, 0, 30, 
GR_PIE
);

37 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
+5, 
rx
, 
ry
, 0, 30, 30, 0, 
GR_PIE
);

41 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

42 
x
 +
xoff
;

43 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
, 
rx
, 
ry
, 0, -30, -30, 0, 
GR_ARCOUTLINE
);

44 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
, 
rx
, 
ry
, 30, 0, 0, -30, 
GR_ARCOUTLINE
);

45 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
+5, 
rx
, 
ry
, -30, 0, 0, 30, 
GR_ARCOUTLINE
);

46 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
+5, 
rx
, 
ry
, 0, 30, 30, 0, 
GR_ARCOUTLINE
);

49 
x
 +
xoff
;

50 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
, 
rx
, 
ry
, 0, -30, -30, 0, 
GR_ARC
);

51 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
, 
rx
, 
ry
, 30, 0, 0, -30, 
GR_ARC
);

52 
	`GrArc
(
wid
, 
gc
, 
x
, 
y
+5, 
rx
, 
ry
, -30, 0, 0, 30, 
GR_ARC
);

53 
	`GrArc
(
wid
, 
gc
, 
x
+5, 
y
+5, 
rx
, 
ry
, 0, 30, 30, 0, 
GR_ARC
);

55 
	`GrDe°royGC
(
gc
);

56 
	}
}

59 
	$maö
(
ac
, **
av
)

61 
GR_EVENT
 
ev
;

62 
GR_WINDOW_ID
 
wid
;

64 i‡(
	`GrO≥n
() < 0)

65 
	`exô
(-1);

67 
wid
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_BORDER
|
GR_WM_PROPS_CAPTION
|

68 
GR_WM_PROPS_CLOSEBOX
, "arcdemo",

69 
GR_ROOT_WINDOW_ID
, 0, 0, 250, 90, 
WHITE
);

71 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

72 
	`GrM≠Wödow
(
wid
);

75 
	`GrGëNextEvít
(&
ev
);

77 i‡(
ev
.
ty≥
 =
GR_EVENT_TYPE_CLOSE_REQ
)

79 i‡(
ev
.
ty≥
 =
GR_EVENT_TYPE_EXPOSURE
)

80 
	`døw
(&
ev
);

83 
	`GrClo£
();

86 
	}
}

	@demos/nanox/bmpdemo.c

7 
	~<°dio.h
>

8 
	~<«no-X.h
>

9 
	~<nxcﬁ‹s.h
>

11 
	#TUX


	)

13 #ifde‡
TUX


15 
	#BMAP
(
a15
, 
a14
, 
a13
, 
a12
, 
a11
, 
a10
, 
a9
, 
a8
, 
a7
, 
a6
, 
a5
, 
a4
, 
a3
, 
a2
, \

16 
a1
, 
a0
Ë(
GR_BITMAP
)◊0 | (a1 << 1Ë| (
a2
 << 2Ë| (
a3
 << 3) \

17 | (
a4
 << 4Ë| (
a5
 << 5Ë| (
a6
 << 6Ë| (
a7
 << 7Ë| (
a8
 << 8) \

18 | (
a9
 << 9Ë| (
a10
 << 10Ë| (
a11
 << 11Ë| (
a12
 << 12) \

19 | (
a13
 << 13Ë| (
a14
 << 14Ë| (
a15
 << 15))

	)

21 
	#TUX_WIDTH
 32

	)

22 
	#TUX_HEIGHT
 32

	)

24 
ªdøw
(
GR_WINDOW_ID
 
wid
, 
GR_GC_ID
 
gc
);

26 
GR_BITMAP
 
	gtux_bôs
[] = {

27 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),

28 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1),BMAP(1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0),

29 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1),BMAP(1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0),

30 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1),BMAP(1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0),

31 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1),BMAP(1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0),

32 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1),BMAP(0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0),

33 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1),BMAP(0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0),

34 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1),BMAP(1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0),

35 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0),BMAP(0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0),

36 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0),BMAP(0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0),

37 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1),BMAP(0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0),

38 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1),BMAP(0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0),

39 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0),BMAP(0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0),

40 
BMAP
(0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0),BMAP(0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0),

41 
BMAP
(0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0),BMAP(0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0),

42 
BMAP
(0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0),BMAP(0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0),

43 
BMAP
(0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0),BMAP(0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0),

44 
BMAP
(0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

45 
BMAP
(0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

46 
BMAP
(0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

47 
BMAP
(0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

48 
BMAP
(0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

49 
BMAP
(0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0),

50 
BMAP
(0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0),BMAP(0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0),

51 
BMAP
(0,0,0,0,1,0,0,0,1,0,1,1,0,0,0,0),BMAP(0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0),

52 
BMAP
(0,0,0,0,0,1,0,0,0,0,0,1,1,0,0,0),BMAP(0,0,0,0,1,0,0,0,0,1,0,1,0,0,0,0),

53 
BMAP
(0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0),BMAP(0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0),

54 
BMAP
(0,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0),BMAP(0,0,1,1,1,0,0,0,1,0,1,0,1,0,0,0),

55 
BMAP
(0,0,0,1,0,0,1,0,0,0,1,0,1,1,1,1),BMAP(1,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0),

56 
BMAP
(0,0,0,0,1,0,1,0,1,0,0,0,1,1,1,1),BMAP(1,1,1,1,1,1,0,1,1,0,0,0,0,0,0,0),

57 
BMAP
(0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,0),BMAP(0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0),

58 
BMAP
(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),BMAP(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),

61 
	#BITMAPWIDTH
 
TUX_WIDTH


	)

62 
	#BITMAPHEIGHT
 
TUX_HEIGHT


	)

63 
	#BITMAP
 
tux_bôs


	)

66 
	~"tuxmask.h
"

67 
	#BITMAPWIDTH
 
TUXMASK_WIDTH


	)

68 
	#BITMAPHEIGHT
 
TUXMASK_HEIGHT


	)

69 
	#BITMAP
 
tuxmask_bôs


	)

72 
	$ªdøw
(
GR_WINDOW_ID
 
wid
, 
GR_GC_ID
 
gc
)

74 
	`GrBôm≠
(
wid
, 
gc
, 0, 0, 
BITMAPWIDTH
, 
BITMAPHEIGHT
, 
BITMAP
);

75 
	}
}

77 
	$maö
()

79 
GR_WINDOW_ID
 
wid
;

80 
GR_GC_ID
 
gc
;

81 
GR_EVENT
 
evít
;

83 if(
	`GrO≥n
() < 0) {

84 #i‡! 
PSP


85 
	`Ârötf
(
°dîr
, "Couldn't connectÅoÅhe Nano-X server\n");

90 
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
BITMAPWIDTH
, 
BITMAPHEIGHT
,

91 0, 
GR_COLOR_WHITE
, 0);

93 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLOSE_REQ
 | 
GR_EVENT_MASK_EXPOSURE
);

95 
gc
 = 
	`GrNewGC
();

96 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_BLACK
);

97 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

99 
	`GrM≠Wödow
(
wid
);

102 
	`GrGëNextEvít
(&
evít
);

103 
evít
.
ty≥
) {

104 
GR_EVENT_TYPE_EXPOSURE
:

105 
	`ªdøw
(
wid
, 
gc
);

107 
GR_EVENT_TYPE_CLOSE_REQ
:

108 
	`GrClo£
();

114 
	}
}

	@demos/nanox/convpbm.c

9 
	~<°dio.h
>

10 
	~<°rög.h
>

11 
	~<î∫o.h
>

12 
	~<˘y≥.h
>

13 
	~<°dlib.h
>

15 *
°rdup_touµî
(*
ö
);

16 
out_w‹d
(
w‹d
);

18 *
	$°rdup_touµî
(*
ö
)

20 *
p
, *
out
;

22 
p
 = 
out
 = 
	`°rdup
(
ö
);

24 if(
out
Ëdÿ{ *
p
++ = 
	`touµî
(*
ö
); } *in++);

26  
out
;

27 
	}
}

29 
	$out_w‹d
(
w‹d
)

31 
w‹ds
 = 0;

33 
	`¥ötf
("0x%04x, ", 
w‹d
);

35 if(++
w‹ds
 == 8) {

36 
w‹ds
 = 0;

37 
	`¥ötf
("\n\t");

39 
	}
}

41 
	$maö
(
¨gc
, *
¨gv
[])

43 
FILE
 *
Â
;

44 
size_t
 
Àn
;

45 *
¥efix
;

46 
w‹d
 = 0;

47 
width
, 
height
, 
x
 = 0, 
i
, 
b
, 
w
 = 0;

48 
buf
[
BUFSIZ
];

50 if(
¨gc
 != 3) {

51 
	`Ârötf
(
°dîr
, "Usage: convpbm [input.pbm]Örefix > "

56 if(!(
Â
 = 
	`f›í
(
¨gv
[1], "r"))) {

57 
	`Ârötf
(
°dîr
, "Couldn'à›í i≈uàfûê\"%s\"\n", 
¨gv
[1]);

61 if(!(
	`fgës
(
buf
, 
BUFSIZ
, 
Â
))Ë
ªadîr
;

63 if(
	`°rcmp
(
buf
, "P4\n")) {

64 
	`Ârötf
(
°dîr
, "Didn't find valid header. PerhapsÅhis is "

69 if(
	`fsˇnf
(
Â
, "%d %d\n", &
width
, &
height
) != 2) {

70 
	`Ârötf
(
°dîr
, "FailedÅoÑead image dimensions\n");

74 if(!(
¥efix
 = 
	`°rdup_touµî
(
¨gv
[2]))Ë
nomem
;

76 
	`¥ötf
("/*\n * Microwindows bitmap converted by convbmp\n * Image "

79 "°©i¯GR_BITMAP %s_bôs[] = {\n\t", 
width
, 
height
, 
¨gv
[2],

80 
¨gv
[1], 
¥efix
, 
width
,Öªfix, 
height
,árgv[2]);

82 
	`‰ì
(
¥efix
);

84 !
	`„of
(
Â
)) {

85 
Àn
 = 
	`‰ód
(
buf
, 1, 
BUFSIZ
, 
Â
);

86 
i
 = 0; i < 
Àn
; i++) {

87 
b
 = 0; b < 8; b++) {

88 
w‹d
 <<= 1;

89 
w‹d
 |(
buf
[
i
] & 0x80) ? 0 : 1;

90 
buf
[
i
] <<= 1;

91 if(++
x
 >
width
) {

92 
x
 = 0;

93 
w‹d
 <<8 - 
b
 - 1;

94 if(
w
 == 0) {

95 
w‹d
 <<= 8;

96 
w
 = 1;

101 if(++
w
 == 2) {

102 
w
 = 0;

103 
	`out_w‹d
(
w‹d
);

104 
w‹d
 = 0;

109 
	`¥ötf
("};\n");

111 
	`f˛o£
(
Â
);

114 
ªadîr
:

115 
	`Ârötf
(
°dîr
, "RódÉº‹: %s\n", 
	`°ªº‹
(
î∫o
));

118 
nomem
:

119 
	`Ârötf
(
°dîr
, "Out of memory\n");

122 
	}
}

	@demos/nanox/dashdemo.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	#MWINCLUDECOLORS


	)

4 
	~"«no-X.h
"

6 
	gCOLS
, 
	gROWS
;

7 
GR_WINDOW_ID
 
	gg_maö
;

10 
	$døw_s¸ìn
()

12 
GR_POINT
 
åi
[4] = { {5, 115}, {105, 115}, {55, 200}, {5, 115} };

13 
GR_WINDOW_INFO
 
wöfo
;

14 
GR_GC_ID
 
gc
;

15 
dash1
[2] = { 10, 5 };

16 
dash2
[4] = { 5, 2, 1, 2 };

17 
dash3
[4] = { 5, 2, 5, 5 };

18 
dash4
[2] = { 2, 2 };

20 
	`GrGëWödowInfo
(
g_maö
, &
wöfo
);

23 
gc
 = 
	`GrNewGC
();

24 
	`GrSëGCLöeAâribuãs
(
gc
, 
GR_LINE_ONOFF_DASH
);

28 
	`GrSëGCDash
(
gc
, 
dash1
, 2);

29 
	`GrRe˘
(
g_maö
, 
gc
, 5, 5, 100, 100);

31 
	`GrSëGCDash
(
gc
, 
dash2
, 4);

32 
	`GrLöe
(
g_maö
, 
gc
, 10, 10, 95, 95);

34 
	`GrSëGCDash
(
gc
, 
dash3
, 4);

35 
	`GrEŒù£
(
g_maö
, 
gc
, 160, 55, 50, 50);

37 
	`GrSëGCDash
(
gc
, 
dash4
, 2);

38 
	`GrPﬁy
(
g_maö
, 
gc
, 4, 
åi
);

40 
	`GrDe°royGC
(
gc
);

41 
	}
}

44 
	$maö
(
¨gc
, **
¨gv
)

46 
COLS
, 
ROWS
;

48 i‡(
	`GrO≥n
() < 0) {

49 #i‡! 
PSP


50 
	`Ârötf
(
°dîr
, "Cannot open graphics\n");

52 
	`exô
(1);

55 
COLS
 = 350;

56 
ROWS
 = 300;

58 
g_maö
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "dashdemo",

59 
GR_ROOT_WINDOW_ID
, 100, 50, 
COLS
 - 120, 
ROWS
 - 60, 
BLUE
);

61 
	`GrSñe˘Evíts
(
g_maö
, 
GR_EVENT_MASK_EXPOSURE
|
GR_EVENT_MASK_CLOSE_REQ
);

62 
	`GrM≠Wödow
(
g_maö
);

65 
GR_EVENT
 
evít
;

66 
	`GrGëNextEvít
(&
evít
);

68 
evít
.
ty≥
) {

69 
GR_EVENT_TYPE_EXPOSURE
:

70 
	`døw_s¸ìn
();

73 
GR_EVENT_TYPE_CLOSE_REQ
:

74 
	`GrClo£
();

75 
	`exô
(0);

78 
	}
}

	@demos/nanox/demo.c

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	#MWINCLUDECOLORS


	)

8 
	~"«no-X.h
"

10 #i‡
PSP


12 
	~<p•kî√l.h
>

13 
	~<p•debug.h
>

14 
	~<p•di•œy.h
>

16 
PSP_MAIN_THREAD_ATTR
(
THREAD_ATTR_USER
 | 
THREAD_ATTR_VFPU
);

19 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

21 
	#¥ötf
(...)

	)

26 
	$exô_ˇŒback
()

28 
	`s˚Kî√lExôGame
();

31 
	}
}

34 
	$CÆlbackThªad
(*
¨g
)

36 
cbid
;

39 
cbid
 = 
	`s˚Kî√lCª©eCÆlback
("Exô CÆlback", 
exô_ˇŒback
, 
NULL
);

40 
	`s˚Kî√lRegi°îExôCÆlback
(
cbid
);

42 
	}
}

45 
	$SëupCÆlbacks
()

47 
thid
 = 0;

49 
thid
 = 
	`s˚Kî√lCª©eThªad
("upd©e_thªad", 
CÆlbackThªad
, 0x11, 0xFA0, 0, 0);

50 if(
thid
 >= 0)

52 
	`s˚Kî√lSèπThªad
(
thid
, 0, 0);

55  
thid
;

56 
	}
}

62 #i‡
DOS_TURBOC


63 
	g_°kÀn
 = 32768;

69 
	#_
 ((Ë0Ë

	)

70 
	#X
 ((Ë1Ë

	)

71 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

72 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

73 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

75 
	#W2_WIDTH
 70

	)

76 
	#W2_HEIGHT
 40

	)

79 
GR_WINDOW_ID
 
	gw1
;

80 
GR_WINDOW_ID
 
	gw2
;

81 
GR_WINDOW_ID
 
	gw3
;

82 
GR_WINDOW_ID
 
	gw4
;

83 
GR_WINDOW_ID
 
	gw5
;

84 
GR_GC_ID
 
	ggc1
;

85 
GR_GC_ID
 
	ggc2
;

86 
GR_GC_ID
 
	ggc3
;

87 
GR_GC_ID
 
	ggc4
;

88 
GR_COORD
 
	gbegxpos
;

89 
GR_COORD
 
	gxpos
;

90 
GR_COORD
 
	gypos
;

91 
GR_COORD
 
	glöexpos
;

92 
GR_COORD
 
	glöeypos
;

93 
GR_COORD
 
	gx‹xpos
;

94 
GR_COORD
 
	gx‹ypos
;

95 
GR_BOOL
 
	glöeok
;

96 
GR_SIZE
 
	gCOLS
, 
	gROWS
;

97 
GR_SCREEN_INFO
 
	gsi
;

99 
do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
);

100 
do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
);

101 
do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
);

102 
do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
);

103 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

104 
do_focusö
(
GR_EVENT_GENERAL
 *
gp
);

105 
do_focusout
(
GR_EVENT_GENERAL
 *
gp
);

106 
do_íãr
(
GR_EVENT_GENERAL
 *
gp
);

107 
do_exô
(
GR_EVENT_GENERAL
 *
gp
);

108 
do_idÀ
();

110 
îr‹ˇtchî
(
GR_EVENT
 *
ï
);

114 
	$maö
()

116 
GR_EVENT
 
evít
;

117 
GR_BITMAP
 
bôm≠1fg
[7];

118 
GR_BITMAP
 
bôm≠1bg
[7];

119 
GR_BITMAP
 
bôm≠2fg
[7];

120 
GR_BITMAP
 
bôm≠2bg
[7];

122 i‡(
	`GrO≥n
() < 0) {

123 #i‡! 
PSP


124 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

126 
	`exô
(1);

129 #i‡
PSP


130 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

135 
	`GrReqShmCmds
(655360);

137 
	`GrGëS¸ìnInfo
(&
si
);

138 
COLS
 = 
si
.
cﬁs
 - 40;

139 
ROWS
 = 
si
.
rows
 - 80;

142 
	`GrSëEº‹H™dÀr
(
îr‹ˇtchî
);

144 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 100, 50, 
COLS
 - 120,

145 
ROWS
 - 60, 1, 
BROWN
, 
WHITE
);

147 
w2
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 6, 6, 
W2_WIDTH
, 
W2_HEIGHT
, 2, 
GREEN
,

148 
WHITE
);

149 
w3
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 250, 30, 80, 100, 1, 
LTGRAY
,

150 
GREEN
);

151 
w4
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 350, 20, 200, 150, 5, 
BLACK
, 
WHITE
);

152 
w5
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 11, 143, 209, 100, 1, 
BLUE
, 
GREEN
);

154 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

155 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_EXPOSURE
 |

156 
GR_EVENT_MASK_FOCUS_IN
 | 
GR_EVENT_MASK_FOCUS_OUT
 |

157 
GR_EVENT_MASK_CLOSE_REQ
);

162 
	`GrSñe˘Evíts
(
w2
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

163 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_CLOSE_REQ
);

164 
	`GrSñe˘Evíts
(
w3
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

165 
GR_EVENT_MASK_MOUSE_MOTION
 | 
GR_EVENT_MASK_CLOSE_REQ
);

166 
	`GrSñe˘Evíts
(
w4
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

167 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_MOUSE_POSITION
 |

168 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_CLOSE_REQ
);

169 
	`GrSñe˘Evíts
(
w5
, 
GR_EVENT_MASK_MOUSE_ENTER
 |

170 
GR_EVENT_MASK_MOUSE_EXIT
 | 
GR_EVENT_MASK_CLOSE_REQ
);

171 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

172 
GR_EVENT_MASK_CLOSE_REQ
);

174 
	`GrM≠Wödow
(
w1
);

175 
	`GrM≠Wödow
(
w2
);

176 
	`GrM≠Wödow
(
w3
);

177 
	`GrM≠Wödow
(
w4
);

178 
	`GrM≠Wödow
(
w5
);

180 
gc1
 = 
	`GrNewGC
();

181 
gc2
 = 
	`GrNewGC
();

182 
gc3
 = 
	`GrNewGC
();

183 
gc4
 = 
	`GrNewGC
();

185 
	`GrSëGCF‹eground
(
gc1
, 
RED
);

186 
	`GrSëGCBackground
(
gc1
, 
BROWN
);

187 
	`GrSëGCF‹eground
(
gc2
, 
MAGENTA
);

188 
	`GrSëGCMode
(
gc4
, 
GR_MODE_XOR
);

190 #i‡
PSP


196 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

197 
bôm≠1fg
[1] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

198 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

199 
bôm≠1fg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

200 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

201 
bôm≠1fg
[5] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

202 
bôm≠1fg
[6] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

204 
bôm≠1bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

205 
bôm≠1bg
[1] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

206 
bôm≠1bg
[2] = 
	`MASK
(
X
,X,X,X,X,X,X);

207 
bôm≠1bg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

208 
bôm≠1bg
[4] = 
	`MASK
(
X
,X,X,X,X,X,X);

209 
bôm≠1bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

210 
bôm≠1bg
[6] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

212 
bôm≠2fg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

213 
bôm≠2fg
[1] = 
	`MASK
(
_
,
X
,_,_,_,X,_);

214 
bôm≠2fg
[2] = 
	`MASK
(
X
,
_
,_,_,_,_,X);

215 
bôm≠2fg
[3] = 
	`MASK
(
X
,
_
,_,_,_,_,X);

216 
bôm≠2fg
[4] = 
	`MASK
(
_
,
X
,_,_,_,X,_);

217 
bôm≠2fg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

219 
bôm≠2bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

220 
bôm≠2bg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

221 
bôm≠2bg
[2] = 
	`MASK
(
X
,X,X,X,X,X,X);

222 
bôm≠2bg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

223 
bôm≠2bg
[4] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

224 
bôm≠2bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

226 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

227 
	`GrSëCurs‹
(
w2
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠2fg
, 
bôm≠2bg
);

230 
	`GrCheckNextEvít
(&
evít
);

232 
evít
.
ty≥
) {

233 
GR_EVENT_TYPE_BUTTON_DOWN
:

234 
	`do_buâ⁄down
(&
evít
.
buâ⁄
);

237 
GR_EVENT_TYPE_BUTTON_UP
:

238 
	`do_buâ⁄up
(&
evít
.
buâ⁄
);

241 
GR_EVENT_TYPE_MOUSE_POSITION
:

242 
GR_EVENT_TYPE_MOUSE_MOTION
:

243 
	`do_mŸi⁄
(&
evít
.
mou£
);

246 
GR_EVENT_TYPE_KEY_DOWN
:

247 
	`do_key°roke
(&
evít
.
key°roke
);

250 
GR_EVENT_TYPE_EXPOSURE
:

251 
	`do_exposuª
(&
evít
.
exposuª
);

254 
GR_EVENT_TYPE_FOCUS_IN
:

255 
	`do_focusö
(&
evít
.
gíîÆ
);

258 
GR_EVENT_TYPE_FOCUS_OUT
:

259 
	`do_focusout
(&
evít
.
gíîÆ
);

262 
GR_EVENT_TYPE_MOUSE_ENTER
:

263 
	`do_íãr
(&
evít
.
gíîÆ
);

266 
GR_EVENT_TYPE_MOUSE_EXIT
:

267 
	`do_exô
(&
evít
.
gíîÆ
);

270 
GR_EVENT_TYPE_CLOSE_REQ
:

271 
	`GrClo£
();

272 
	`exô
(0);

274 
GR_EVENT_TYPE_NONE
:

275 
	`do_idÀ
();

279 
	}
}

286 
	$do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
)

288 
GR_PIXELVAL
 
öèbÀ
[
W2_WIDTH
 * 
W2_HEIGHT
];

289 
GR_PIXELVAL
 
ouâabÀ
[
W2_WIDTH
 * 
W2_HEIGHT
 * 6];

290 
GR_PIXELVAL
 *
öp
;

291 
GR_PIXELVAL
 *
ouç
;

292 
GR_PIXELVAL
 *
ﬁdöp
;

293 
GR_COORD
 
row
;

294 
GR_COORD
 
cﬁ
;

299 i‡(
bp
->
wid
 =
w3
) {

300 
	`GrRai£Wödow
(
w3
);

301 
	`GrRódAªa
(
w2
, 0, 0, 
W2_WIDTH
, 
W2_HEIGHT
, 
öèbÀ
);

302 
öp
 = 
öèbÀ
;

303 
ouç
 = 
ouâabÀ
;

304 
row
 = 0;Ñow < 
W2_HEIGHT
;Ñow++) {

305 
ﬁdöp
 = 
öp
;

306 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

307 *
ouç
++ = *
öp
;

308 *
ouç
++ = *
öp
++;

310 
öp
 = 
ﬁdöp
;

311 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

312 *
ouç
++ = *
öp
;

313 *
ouç
++ = *
öp
++;

315 
öp
 = 
ﬁdöp
;

316 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

317 *
ouç
++ = *
öp
;

318 *
ouç
++ = *
öp
++;

321 
	`GrAªa
(
w1
, 
gc1
, 0, 0, 
W2_WIDTH
 * 2, 
W2_HEIGHT
 * 3, 
ouâabÀ
,

322 
MWPF_PIXELVAL
);

326 i‡(
bp
->
wid
 =
w4
) {

327 
	`GrRai£Wödow
(
w4
);

328 
löexpos
 = 
bp
->
x
;

329 
löeypos
 = 
bp
->
y
;

330 
x‹xpos
 = 
bp
->
x
;

331 
x‹ypos
 = 
bp
->
y
;

332 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

333 
löeok
 = 
GR_TRUE
;

337 i‡(
bp
->
wid
 !
w1
) {

342 i‡((
bp
->
buâ⁄s
 & -(() bp->buttons)) != bp->buttons)

343 
	`GrCÀ¨Wödow
(-1, 0);

347 
	`GrRai£Wödow
(
w1
);

350 i‡(
bp
->
buâ⁄s
 & 
GR_BUTTON_L
) {

351 
	`GrCÀ¨Wödow
(
w1
, 
GR_TRUE
);

355 
begxpos
 = 
bp
->
x
;

356 
xpos
 = 
bp
->
x
;

357 
ypos
 = 
bp
->
y
;

358 
	}
}

365 
	$do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
)

367 i‡(
bp
->
wid
 =
w4
) {

368 i‡(
löeok
) {

369 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

370 
	`GrLöe
(
w4
, 
gc3
, 
bp
->
x
, bp->
y
, 
löexpos
, 
löeypos
);

372 
löeok
 = 
GR_FALSE
;

376 i‡(
bp
->
wid
 =
w2
) {

377 
	`GrClo£
();

378 
	`exô
(0);

380 
	}
}

387 
	$do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
)

389 i‡(
mp
->
wid
 =
w4
) {

390 i‡(
löeok
) {

391 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

392 
x‹xpos
 = 
mp
->
x
;

393 
x‹ypos
 = 
mp
->
y
;

394 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

399 i‡(
mp
->
wid
 =
w3
) {

400 
	`GrPoöt
(
w3
, 
gc3
, 
mp
->
x
, mp->
y
);

403 
	}
}

410 
	$do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
)

412 
GR_SIZE
 
width
;

413 
GR_SIZE
 
height
;

414 
GR_SIZE
 
ba£
;

416 i‡(
kp
->
wid
 =
w4
) {

417 i‡(
löeok
) {

418 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

419 
löeok
 = 
GR_FALSE
;

424 
	`GrGëGCTextSize
(
gc1
, &
kp
->
ch
, 1, 
GR_TFASCII
, &
width
, &
height
, &
ba£
);

425 i‡((
kp
->
ch
 == '\r') || (kp->ch == '\n')) {

426 
xpos
 = 
begxpos
;

427 
ypos
 +
height
;

430 i‡(
kp
->
ch
 == '\b') {

431 i‡(
xpos
 <
begxpos
)

433 
xpos
 -
width
;

434 
	`GrSëGCF‹eground
(
gc3
, 
BROWN
);

435 
	`GrFûlRe˘
(
w1
, 
gc3
, 
xpos
, 
ypos
 - 
height
 + 
ba£
 + 1,

436 
width
, 
height
);

439 
	`GrText
(
w1
, 
gc1
, 
xpos
, 
ypos
 + 
ba£
, &
kp
->
ch
, 1, 0);

440 
xpos
 +
width
;

441 
	}
}

448 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

450 
GR_POINT
 
poöts
[3];

452 i‡(
ï
->
wid
 !
w1
)

454 
poöts
[0].
x
 = 311;

455 
poöts
[0].
y
 = 119;

456 
poöts
[1].
x
 = 350;

457 
poöts
[1].
y
 = 270;

458 
poöts
[2].
x
 = 247;

459 
poöts
[2].
y
 = 147;

461 
	`GrFûlRe˘
(
w1
, 
gc2
, 50, 50, 150, 200);

462 
	`GrFûlPﬁy
(
w1
, 
gc2
, 3, 
poöts
);

463 
	}
}

470 
	$do_focusö
(
GR_EVENT_GENERAL
 *
gp
)

472 i‡(
gp
->
wid
 !
w1
)

474 
	`GrSëB‹dîCﬁ‹
(
w1
, 
WHITE
);

475 
	}
}

481 
	$do_focusout
(
GR_EVENT_GENERAL
 *
gp
)

483 i‡(
gp
->
wid
 !
w1
)

485 
	`GrSëB‹dîCﬁ‹
(
w1
, 
GRAY
);

486 
	}
}

493 
	$do_íãr
(
GR_EVENT_GENERAL
 *
gp
)

495 i‡(
gp
->
wid
 !
w5
)

497 
	`GrSëB‹dîCﬁ‹
(
w5
, 
WHITE
);

498 
	`GrRai£Wödow
(
w5
);

499 
	}
}

506 
	$do_exô
(
GR_EVENT_GENERAL
 *
gp
)

508 i‡(
gp
->
wid
 !
w5
)

510 
	`GrSëB‹dîCﬁ‹
(
w5
, 
GREEN
);

511 
	`GrLowîWödow
(
w5
);

512 
	}
}

520 
	$do_idÀ
()

522 
GR_COORD
 
x
;

523 
GR_COORD
 
y
;

524 
GR_SIZE
 
rx
;

525 
GR_SIZE
 
ry
;

526 
GR_PIXELVAL
 
pixñvÆ
;

528 
x
 = 
	`ønd
() % 70;

529 
y
 = 
	`ønd
() % 40;

530 
rx
 = (
	`ønd
() % 10) + 5;

531 
ry
 = (
rx
 * 
si
.
ydpcm
Ë/ si.
xdpcm
;

533 
pixñvÆ
 = 
	`ønd
(Ë% 
si
.
ncﬁ‹s
;

535 
	`GrSëGCF‹egroundPixñVÆ
(
gc3
, 
pixñvÆ
);

536 
	`GrFûlEŒù£
(
w2
, 
gc3
, 
x
, 
y
, 
rx
, 
ry
);

538 #i‡
PSP


542 
	}
}

549 
	$îr‹ˇtchî
(
GR_EVENT
 *
ï
)

551 #i‡! 
PSP


552 
	`¥ötf
("nx˛õ¡: Eº‹ (%sË", 
ï
->
îr‹
.
«me
);

553 
	`¥ötf
(
nxEº‹Såögs
[
ï
->
îr‹
.
code
],Ép->îr‹.
id
);

555 
	}
}

	@demos/nanox/demo2.c

1 
	#MWINCLUDECOLORS


	)

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<uni°d.h
>

5 
	~"«no-X.h
"

7 
	~<sig«l.h
>

10 
	$maö
(
ac
,**
av
)

12 
GR_WINDOW_ID
 
w
, 
w2
;

13 
GR_GC_ID
 
gc
;

14 
GR_EVENT
 
evít
;

15 
GR_WM_PROPERTIES
 
¥›s
;

16 
GR_FONT_ID
 
f⁄t
;

18 i‡(
	`GrO≥n
() < 0) {

19 
	`¥ötf
("Can't open graphics\n");

20 
	`exô
(1);

24 
	`GrSëEº‹H™dÀr
(
NULL
);

26 
	#WIDTH
 320

	)

27 
	#HEIGHT
 240

	)

28 
w
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 20, 20, 
WIDTH
, 
HEIGHT
,

29 0, 
GREEN
, 
BLACK
);

31 
w2
 = 
	`GrNewWödow
(
w
, 20, 20, 40, 40, 0, 
BLUE
, 
BLACK
);

33 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

34 
¥›s
.¥›†
GR_WM_PROPS_NOBACKGROUND
;

35 
¥›s
.
tôÀ
 = "Nano-X Demo2";

36 
	`GrSëWMPr›îtõs
(
w
, &
¥›s
);

38 
gc
 = 
	`GrNewGC
();

40 
f⁄t
 = 
	`GrCª©eF⁄t
("f⁄ts/pcf/lubI24.pcf", 0, 
NULL
);

41 
	`GrSëGCF⁄t
(
gc
, 
f⁄t
);

43 
	`GrSñe˘Evíts
(
w
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ


44 | 
GR_EVENT_MASK_BUTTON_DOWN


45 | 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_KEY_UP
);

46 
	`GrM≠Wödow
(
w
);

47 
	`GrSëFocus
(
w
);

54 
	`GrGëNextEvít
(&
evít
);

55 
evít
.
ty≥
) {

56 
GR_EVENT_TYPE_EXPOSURE
:

57 
	`GrSëGCF‹eground
(
gc
,
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

58 
	`GrFûlRe˘
(
w
, 
gc
, 
evít
.
exposuª
.
x
,Évít.exposuª.
y
,

59 
evít
.
exposuª
.
width
,Évít.exposuª.
height
);

60 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPTEXT
));

61 
	`GrSëGCU£Background
(
gc
, 
GR_FALSE
);

62 
	`GrText
(
w
, 
gc
, 10, 30, "HñlÿW‹ld @MNOPmn", -1, 
GR_TFASCII
);

63 
	`GrRe˘
(
w
, 
gc
, 5, 5, 300, 60);

65 
GR_EVENT_TYPE_CLOSE_REQ
:

66 
	`GrClo£
();

67 
	`exô
(0);

69 
GR_EVENT_TYPE_ERROR
:

70 
	`¥ötf
("\7demo2: Eº‹ (%sË", 
evít
.
îr‹
.
«me
);

71 
	`¥ötf
(
nxEº‹Såögs
[
evít
.
îr‹
.
code
],evít.îr‹.
id
);

74 
GR_EVENT_TYPE_BUTTON_DOWN
:

75 
	`GrUnm≠Wödow
(
w
);

76 
	`GrFlush
();

77 #i‡! 
PSP


78 
	`¶ìp
(1);

80 
	`GrM≠Wödow
(
w
);

84 
GR_EVENT_TYPE_BUTTON_DOWN
:

86 
	`GrM≠Wödow
(
w2
);

87 
	`GrMoveWödow
(
GR_ROOT_WINDOW_ID
, 0, 0);

88 { 
GR_SCREEN_INFO
 
söfo
; 
	`GrGëS¸ìnInfo
(&sinfo); }

92 
GR_EVENT_TYPE_KEY_DOWN
:

93 
kev
 = (
GR_EVENT_KEYSTROKE
 *)&
evít
;

94 
	`¥ötf
("DOWN %d (%04x) %04x\n",

95 
kev
->
ch
, kev->ch, kev->
modifõrs
);

97 
GR_EVENT_TYPE_KEY_UP
:

98 
kev
 = (
GR_EVENT_KEYSTROKE
 *)&
evít
;

99 
	`¥ötf
("UP %d (%04x) %04x\n",

100 
kev
->
ch
, kev->ch, kev->
modifõrs
);

106 
	`GrClo£
();

108 
	}
}

	@demos/nanox/demo4.c

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	~"«no-X.h
"

8 
	~"devi˚.h
"

10 
GR_GC_ID
 
	ggc1
;

11 
GR_SCREEN_INFO
 
	gsi
;

13 
	#GRAY14
 
	`MWRGB
–17, 17, 17 )

	)

14 
	#GRAY13
 
	`MWRGB
–34, 34, 34 )

	)

15 
	#GRAY12
 
	`MWRGB
–51, 51, 51 )

	)

16 
	#GRAY11
 
	`MWRGB
–68, 68, 68 )

	)

17 
	#GRAY10
 
	`MWRGB
–85, 85, 85 )

	)

18 
	#GRAY9
 
	`MWRGB
–102, 102, 102 )

	)

19 
	#GRAY8
 
	`MWRGB
–119, 119, 119 )

	)

20 
	#GRAY7
 
	`MWRGB
–136, 136, 136 )

	)

21 
	#GRAY6
 
	`MWRGB
–153, 153, 153 )

	)

22 
	#GRAY5
 
	`MWRGB
–170, 170, 170 )

	)

23 
	#GRAY4
 
	`MWRGB
–187, 187, 187 )

	)

24 
	#GRAY3
 
	`MWRGB
–204, 204, 204 )

	)

25 
	#GRAY2
 
	`MWRGB
–221, 221, 221 )

	)

26 
	#GRAY1
 
	`MWRGB
–238, 238, 238 )

	)

29 
	$maö
(
¨gc
,**
¨gv
)

31 
GR_EVENT
 
evít
;

33 i‡(
	`GrO≥n
() < 0) {

34 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

35 
	`exô
(1);

38 
	`GrGëS¸ìnInfo
(&
si
);

40 
gc1
 = 
	`GrNewGC
();

42 
	`GrSëGCF‹eground
(
gc1
, 
WHITE
);

45 
	`GrLöe
(
GR_ROOT_WINDOW_ID
, 
gc1
, 4, 4, 634, 4);

46 
	`GrLöe
(
GR_ROOT_WINDOW_ID
, 
gc1
, 4, 4, 4, 474);

47 
	`GrLöe
(
GR_ROOT_WINDOW_ID
, 
gc1
, 634, 4, 634, 474);

48 
	`GrLöe
(
GR_ROOT_WINDOW_ID
, 
gc1
, 4, 474, 634, 474);

54 
PSD
 
mempsd
;

55 
löñí
, 
size
;

56 * 
pixñs
;

58 
mempsd
 = 
s¸dev
.
	`AŒoˇãMemGC
(&scrdev);

59 
	`GdCÆcMemGCAŒoc
(
mempsd
, 50, 100, 0, 0, &
size
, &
löñí
);

60 
pixñs
 = 
	`mÆloc
(
size
);

61 
mempsd
->
Êags
 |
PSF_ADDRMALLOC
;

62 
mempsd
->
	`M≠MemGC
(mempsd, 50, 100, 
s¸dev
.
∂™es
, s¸dev.
bµ
,

63 
löñí
, 
size
, 
pixñs
);

66 
	`GdSëF‹egroundCﬁ‹
(
mempsd
, 
GREEN
);

67 
	`GdFûlRe˘
(
mempsd
, 0, 0, 50, 100);

68 
	`GdSëF‹egroundCﬁ‹
(
mempsd
, 
RED
);

69 
	`GdFûlRe˘
(
mempsd
, 5, 20, 40, 60);

72 
	`GdBlô
(&
s¸dev
, 10, 10, 50, 100, 
mempsd
, 0, 0, 0);

81 
	`GrGëNextEvít
(&
evít
);

82 if(
evít
.
ty≥
 =
GR_EVENT_TYPE_CLOSE_REQ
) ;

85 
	`GrClo£
();

88 
	}
}

	@demos/nanox/demo5.c

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	#MWINCLUDECOLORS


	)

8 
	~"«no-X.h
"

10 #i‡
PSP


11 
	#Ârötf
(...)

	)

17 
	#_
 ((Ë0Ë

	)

18 
	#X
 ((Ë1Ë

	)

19 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

20 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

21 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

23 
	#W2_WIDTH
 70

	)

24 
	#W2_HEIGHT
 40

	)

27 
GR_WINDOW_ID
 
	gw1
;

28 
GR_WINDOW_ID
 
	gw2
;

29 
GR_WINDOW_ID
 
	gw3
;

30 
GR_WINDOW_ID
 
	gw4
;

31 
GR_WINDOW_ID
 
	gw5
;

32 
GR_WINDOW_ID
 
	gp1
;

33 
GR_GC_ID
 
	ggc1
;

34 
GR_GC_ID
 
	ggc2
;

35 
GR_GC_ID
 
	ggc3
;

36 
GR_GC_ID
 
	ggc4
;

37 
GR_COORD
 
	gbegxpos
;

38 
GR_COORD
 
	gxpos
;

39 
GR_COORD
 
	gypos
;

40 
GR_COORD
 
	glöexpos
;

41 
GR_COORD
 
	glöeypos
;

42 
GR_COORD
 
	gx‹xpos
;

43 
GR_COORD
 
	gx‹ypos
;

44 
GR_BOOL
 
	glöeok
;

45 
GR_SCREEN_INFO
 
	gsi
;

47 
do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
);

48 
do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
);

49 
do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
);

50 
do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
);

51 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

52 
do_focusö
(
GR_EVENT_GENERAL
 *
gp
);

53 
do_focusout
(
GR_EVENT_GENERAL
 *
gp
);

54 
do_íãr
(
GR_EVENT_GENERAL
 *
gp
);

55 
do_exô
(
GR_EVENT_GENERAL
 *
gp
);

56 
do_idÀ
();

59 
	$maö
(
¨gc
,**
¨gv
)

61 
GR_EVENT
 
evít
;

62 
GR_BITMAP
 
bôm≠1fg
[7];

63 
GR_BITMAP
 
bôm≠1bg
[7];

64 
GR_BITMAP
 
bôm≠2fg
[7];

65 
GR_BITMAP
 
bôm≠2bg
[7];

67 i‡(
	`GrO≥n
() < 0) {

68 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

69 
	`exô
(1);

72 
	`GrGëS¸ìnInfo
(&
si
);

74 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 100, 50, 
si
.
cﬁs
 - 120,

75 
si
.
rows
 - 60, 1, 
BROWN
, 
WHITE
);

76 
w2
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 6, 6, 
W2_WIDTH
, 
W2_HEIGHT
, 2, 
GREEN
,

77 
WHITE
);

78 
w3
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 250, 30, 80, 100, 1, 
LTGRAY
,

79 
GREEN
);

80 
w4
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 350, 20, 200, 150, 5, 
BLACK
, 
WHITE
);

81 
w5
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 11, 143, 209, 100, 1, 
BLUE
, 
GREEN
);

83 
p1
 = 
	`GrNewPixm≠
(200,200,0);

85 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

86 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_EXPOSURE
 |

87 
GR_EVENT_MASK_FOCUS_IN
 | 
GR_EVENT_MASK_FOCUS_OUT
 |

88 
GR_EVENT_MASK_CLOSE_REQ
);

89 
	`GrSñe˘Evíts
(
w2
, 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_CLOSE_REQ
);

90 
	`GrSñe˘Evíts
(
w3
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

91 
GR_EVENT_MASK_MOUSE_MOTION
 | 
GR_EVENT_MASK_CLOSE_REQ
);

92 
	`GrSñe˘Evíts
(
w4
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

93 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_MOUSE_POSITION
 |

94 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_CLOSE_REQ
);

95 
	`GrSñe˘Evíts
(
w5
, 
GR_EVENT_MASK_MOUSE_ENTER
 |

96 
GR_EVENT_MASK_MOUSE_EXIT
 | 
GR_EVENT_MASK_CLOSE_REQ
);

97 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

98 
GR_EVENT_MASK_CLOSE_REQ
);

100 
	`GrM≠Wödow
(
w1
);

101 
	`GrM≠Wödow
(
w2
);

102 
	`GrM≠Wödow
(
w3
);

103 
	`GrM≠Wödow
(
w4
);

104 
	`GrM≠Wödow
(
w5
);

106 
gc1
 = 
	`GrNewGC
();

107 
gc2
 = 
	`GrNewGC
();

108 
gc3
 = 
	`GrNewGC
();

109 
gc4
 = 
	`GrNewGC
();

111 
	`GrSëGCF‹eground
(
gc1
, 
RED
);

112 
	`GrSëGCBackground
(
gc1
, 
BROWN
);

113 
	`GrSëGCF‹eground
(
gc2
, 
MAGENTA
);

114 
	`GrSëGCMode
(
gc4
, 
GR_MODE_XOR
);

116 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

117 
bôm≠1fg
[1] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

118 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

119 
bôm≠1fg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

120 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

121 
bôm≠1fg
[5] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

122 
bôm≠1fg
[6] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

124 
bôm≠1bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

125 
bôm≠1bg
[1] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

126 
bôm≠1bg
[2] = 
	`MASK
(
X
,X,X,X,X,X,X);

127 
bôm≠1bg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

128 
bôm≠1bg
[4] = 
	`MASK
(
X
,X,X,X,X,X,X);

129 
bôm≠1bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

130 
bôm≠1bg
[6] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

132 
bôm≠2fg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

133 
bôm≠2fg
[1] = 
	`MASK
(
_
,
X
,_,_,_,X,_);

134 
bôm≠2fg
[2] = 
	`MASK
(
X
,
_
,_,_,_,_,X);

135 
bôm≠2fg
[3] = 
	`MASK
(
X
,
_
,_,_,_,_,X);

136 
bôm≠2fg
[4] = 
	`MASK
(
_
,
X
,_,_,_,X,_);

137 
bôm≠2fg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

139 
bôm≠2bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

140 
bôm≠2bg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

141 
bôm≠2bg
[2] = 
	`MASK
(
X
,X,X,X,X,X,X);

142 
bôm≠2bg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

143 
bôm≠2bg
[4] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

144 
bôm≠2bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

146 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

147 
	`GrSëCurs‹
(
w2
, 7, 6, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠2fg
, 
bôm≠2bg
);

149 
	`GrRe˘
(
GR_ROOT_WINDOW_ID
, 
gc1
, 0, 0, 
si
.
cﬁs
, si.
rows
);

153 
	`GrGëNextEvít
(&
evít
);

155 
evít
.
ty≥
) {

156 
GR_EVENT_TYPE_BUTTON_DOWN
:

157 
	`do_buâ⁄down
(&
evít
.
buâ⁄
);

160 
GR_EVENT_TYPE_BUTTON_UP
:

161 
	`do_buâ⁄up
(&
evít
.
buâ⁄
);

164 
GR_EVENT_TYPE_MOUSE_POSITION
:

165 
GR_EVENT_TYPE_MOUSE_MOTION
:

166 
	`do_mŸi⁄
(&
evít
.
mou£
);

169 
GR_EVENT_TYPE_KEY_DOWN
:

170 
	`do_key°roke
(&
evít
.
key°roke
);

173 
GR_EVENT_TYPE_EXPOSURE
:

174 
	`do_exposuª
(&
evít
.
exposuª
);

177 
GR_EVENT_TYPE_FOCUS_IN
:

178 
	`do_focusö
(&
evít
.
gíîÆ
);

181 
GR_EVENT_TYPE_FOCUS_OUT
:

182 
	`do_focusout
(&
evít
.
gíîÆ
);

185 
GR_EVENT_TYPE_MOUSE_ENTER
:

186 
	`do_íãr
(&
evít
.
gíîÆ
);

189 
GR_EVENT_TYPE_MOUSE_EXIT
:

190 
	`do_exô
(&
evít
.
gíîÆ
);

193 
GR_EVENT_TYPE_CLOSE_REQ
:

194 
	`GrClo£
();

195 
	`exô
(0);

197 
GR_EVENT_TYPE_NONE
:

198 
	`do_idÀ
();

202 
	}
}

209 
	$do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
)

211 
GR_PIXELVAL
 
öèbÀ
[
W2_WIDTH
 * 
W2_HEIGHT
];

212 
GR_PIXELVAL
 
ouâabÀ
[
W2_WIDTH
 * 
W2_HEIGHT
 * 6];

213 
GR_PIXELVAL
 *
öp
;

214 
GR_PIXELVAL
 *
ouç
;

215 
GR_PIXELVAL
 *
ﬁdöp
;

216 
GR_COORD
 
row
;

217 
GR_COORD
 
cﬁ
;

222 i‡(
bp
->
wid
 =
w3
) {

223 
	`GrRai£Wödow
(
w3
);

224 
	`GrRódAªa
(
w2
, 0, 0, 
W2_WIDTH
, 
W2_HEIGHT
, 
öèbÀ
);

225 
öp
 = 
öèbÀ
;

226 
ouç
 = 
ouâabÀ
;

227 
row
 = 0;Ñow < 
W2_HEIGHT
;Ñow++) {

228 
ﬁdöp
 = 
öp
;

229 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

230 *
ouç
++ = *
öp
;

231 *
ouç
++ = *
öp
++;

233 
öp
 = 
ﬁdöp
;

234 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

235 *
ouç
++ = *
öp
;

236 *
ouç
++ = *
öp
++;

238 
öp
 = 
ﬁdöp
;

239 
cﬁ
 = 0; cﬁ < 
W2_WIDTH
; col++) {

240 *
ouç
++ = *
öp
;

241 *
ouç
++ = *
öp
++;

244 
	`GrAªa
(
w1
, 
gc1
, 0, 0, 
W2_WIDTH
 * 2, 
W2_HEIGHT
 * 3, 
ouâabÀ
,

245 
MWPF_PIXELVAL
);

249 i‡(
bp
->
wid
 =
w4
) {

254 
	`GrLöe
(
p1
, 
gc1
, 0,0, 
bp
->
x
, bp->
y
);

256 
	`GrRai£Wödow
(
w4
);

257 
löexpos
 = 
bp
->
x
;

258 
löeypos
 = 
bp
->
y
;

259 
x‹xpos
 = 
bp
->
x
;

260 
x‹ypos
 = 
bp
->
y
;

261 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

262 
löeok
 = 
GR_TRUE
;

266 i‡(
bp
->
wid
 !
w1
) {

271 i‡((
bp
->
buâ⁄s
 & -(() bp->buttons)) != bp->buttons)

272 
	`GrCÀ¨Wödow
(-1, 0);

276 
	`GrRai£Wödow
(
w1
);

279 i‡(
bp
->
buâ⁄s
 & 
GR_BUTTON_L
) {

280 
	`GrCÀ¨Wödow
(
w1
, 
GR_TRUE
);

284 
begxpos
 = 
bp
->
x
;

285 
xpos
 = 
bp
->
x
;

286 
ypos
 = 
bp
->
y
;

287 
	}
}

294 
	$do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
)

296 i‡(
bp
->
wid
 =
w4
) {

297 i‡(
löeok
) {

298 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

299 
	`GrLöe
(
w4
, 
gc3
, 
bp
->
x
, bp->
y
, 
löexpos
, 
löeypos
);

301 
löeok
 = 
GR_FALSE
;

302 
	`GrC›yAªa
(
w1
, 
gc4
, 200,200, 200,200, 
p1
,0,0,
MWROP_SRCCOPY
);

306 i‡(
bp
->
wid
 =
w2
) {

307 
	`GrClo£
();

308 
	`exô
(0);

310 
	}
}

317 
	$do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
)

319 i‡(
mp
->
wid
 =
w4
) {

320 i‡(
löeok
) {

321 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

322 
x‹xpos
 = 
mp
->
x
;

323 
x‹ypos
 = 
mp
->
y
;

324 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

329 i‡(
mp
->
wid
 =
w3
) {

330 
	`GrPoöt
(
w3
, 
gc3
, 
mp
->
x
, mp->
y
);

333 
	}
}

340 
	$do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
)

342 
GR_SIZE
 
width
;

343 
GR_SIZE
 
height
;

344 
GR_SIZE
 
ba£
;

346 i‡(
kp
->
wid
 =
w4
) {

347 i‡(
löeok
) {

348 
	`GrLöe
(
w4
, 
gc4
, 
x‹xpos
, 
x‹ypos
, 
löexpos
, 
löeypos
);

349 
löeok
 = 
GR_FALSE
;

354 
	`GrGëGCTextSize
(
gc1
, &
kp
->
ch
, 1, 
GR_TFASCII
, &
width
, &
height
, &
ba£
);

355 i‡((
kp
->
ch
 == '\r') || (kp->ch == '\n')) {

356 
xpos
 = 
begxpos
;

357 
ypos
 +
height
;

360 i‡(
kp
->
ch
 == '\b') {

361 i‡(
xpos
 <
begxpos
)

363 
xpos
 -
width
;

364 
	`GrSëGCF‹eground
(
gc3
, 
BROWN
);

365 
	`GrFûlRe˘
(
w1
, 
gc3
, 
xpos
, 
ypos
 - 
height
 + 
ba£
 + 1,

366 
width
, 
height
);

369 
	`GrText
(
w1
, 
gc1
, 
xpos
, 
ypos
 + 
ba£
, &
kp
->
ch
, 1, 0);

370 
xpos
 +
width
;

371 
	}
}

378 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

380 
GR_POINT
 
poöts
[3];

382 i‡(
ï
->
wid
 !
w1
)

384 
poöts
[0].
x
 = 311;

385 
poöts
[0].
y
 = 119;

386 
poöts
[1].
x
 = 350;

387 
poöts
[1].
y
 = 270;

388 
poöts
[2].
x
 = 247;

389 
poöts
[2].
y
 = 147;

391 
	`GrFûlRe˘
(
w1
, 
gc2
, 50, 50, 150, 200);

392 
	`GrFûlPﬁy
(
w1
, 
gc2
, 3, 
poöts
);

393 
	}
}

400 
	$do_focusö
(
GR_EVENT_GENERAL
 *
gp
)

402 i‡(
gp
->
wid
 !
w1
)

404 
	`GrSëB‹dîCﬁ‹
(
w1
, 
WHITE
);

405 
	}
}

411 
	$do_focusout
(
GR_EVENT_GENERAL
 *
gp
)

413 i‡(
gp
->
wid
 !
w1
)

415 
	`GrSëB‹dîCﬁ‹
(
w1
, 
GRAY
);

416 
	}
}

423 
	$do_íãr
(
GR_EVENT_GENERAL
 *
gp
)

425 i‡(
gp
->
wid
 !
w5
)

427 
	`GrSëB‹dîCﬁ‹
(
w5
, 
WHITE
);

428 
	`GrRai£Wödow
(
w5
);

429 
	}
}

436 
	$do_exô
(
GR_EVENT_GENERAL
 *
gp
)

438 i‡(
gp
->
wid
 !
w5
)

440 
	`GrSëB‹dîCﬁ‹
(
w5
, 
GREEN
);

441 
	`GrLowîWödow
(
w5
);

442 
	}
}

450 
	$do_idÀ
()

452 
GR_COORD
 
x
;

453 
GR_COORD
 
y
;

454 
GR_SIZE
 
rx
;

455 
GR_SIZE
 
ry
;

456 
GR_PIXELVAL
 
pixñvÆ
;

458 
x
 = 
	`ønd
() % 70;

459 
y
 = 
	`ønd
() % 40;

460 
rx
 = (
	`ønd
() % 10) + 5;

461 
ry
 = (
rx
 * 
si
.
ydpcm
Ë/ si.
xdpcm
;

463 
pixñvÆ
 = 
	`ønd
(Ë% 
si
.
ncﬁ‹s
;

465 
	`GrSëGCF‹egroundPixñVÆ
(
gc3
, 
pixñvÆ
);

466 
	`GrFûlEŒù£
(
w2
, 
gc3
, 
x
, 
y
, 
rx
, 
ry
);

467 
	}
}

	@demos/nanox/demo6.c

8 
	#USE_PIXMAPS


	)

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<°rög.h
>

13 
	~<î∫o.h
>

14 
	~<«no-X.h
>

16 
GR_WINDOW_ID
 
	gwödow
;

17 #ifde‡
USE_PIXMAPS


18 
GR_WINDOW_ID
 
	gpm≠
;

20 
GR_GC_ID
 
	ggc
;

21 
	gwidth
, 
	gheight
;

22 *
	gd©a
;

24 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
evít
)

27 #ifde‡
USE_PIXMAPS


28 
	`GrC›yAªa
(
wödow
, 
gc
, 0, 0, 
width
, 
height
, 
pm≠
, 0, 0, 
MWROP_SRCCOPY
);

30 
	`GrAªa
(
wödow
, 
gc
, 0, 0, 
width
, 
height
, 
d©a
, 
MWPF_RGB
);

32 
	}
}

34 
	$îr‹h™dÀr
(
GR_EVENT
 *
ï
)

36 
	`¥ötf
("Eº‹ (%sËcodê%d id %d", 
ï
->
îr‹
.
«me
,

37 
ï
->
îr‹
.
code
,Ép->îr‹.
id
);

38 
	`exô
(1);

39 
	}
}

41 
	$maö
(
¨gc
, *
¨gv
[])

43 
löe
[256];

44 
GR_EVENT
 
evít
;

45 
FILE
 *
öfûe
;

46 
i
, 
o
;

47 *
p
;

49 if(
¨gc
 != 2) {

50 
	`¥ötf
("Usage: demo6 <filename.ppm>\n");

51 
	`exô
(1);

54 if(!(
öfûe
 = 
	`f›í
(
¨gv
[1], "r"))) {

55 
	`¥ötf
("Couldn'à›í \"%s\" f‹Ñódög: %s\n", 
¨gv
[1],

56 
	`°ªº‹
(
î∫o
));

57 
	`exô
(2);

61 if(!
	`fgës
(
löe
, 256, 
öfûe
)Ë
åunˇãd
;

62 if(
löe
[0] != 'P' ||Üine[1] != '6') {

63 
	`¥ötf
("Unsupported PPMÅype orÇotá PPM file.\n");

64 
	`¥ötf
("Please supplyá valid P6 format file (colour, with "

70 if(!
	`fgës
(
löe
, 256, 
öfûe
)Ë
åunˇãd
;

71 } 
löe
[0] == '#');

74 
	`ssˇnf
(
löe
, "%ò%i", &
width
, &
height
);

77 if(!
	`fgës
(
löe
, 256, 
öfûe
)Ë
åunˇãd
;

78 
	`ssˇnf
(
löe
, "%i", &
i
);

79 if(
i
 != 255) {

80 
	`¥ötf
("Truecolour mode only is supported\n");

81 
	`exô
(4);

85 
i
 = 
width
 * 
height
 * 3;

87 
o
 = 
width
 * 
height
 * 4;

90 if(!(
d©a
 = 
	`mÆloc
(
o
))) {

91 
	`¥ötf
("NotÉnough memoryÅoÜoad image\n");

92 
	`exô
(5);

97 
p
 = 
d©a
;

98 
o
) {

99 if(
	`‰ód
(
p
, 1, 3, 
öfûe
Ë!3Ë
åunˇãd
;

100 
p
 += 4;

101 
o
 -= 4;

105 
	`f˛o£
(
öfûe
);

108 
	`GrSëEº‹H™dÀr
(
îr‹h™dÀr
);

110 if(
	`GrO≥n
() < 0) {

111 
	`¥ötf
("Couldn't connectÅo Nano-X server\n");

112 
	`exô
(6);

115 #ifde‡
USE_PIXMAPS


117 
pm≠
 = 
	`GrNewPixm≠
(
width
, 
height
, 
NULL
);

121 
gc
 = 
	`GrNewGC
();

123 #ifde‡
USE_PIXMAPS


125 
	`GrAªa
(
pm≠
, 
gc
, 0, 0, 
width
, 
height
, 
d©a
, 
MWPF_RGB
);

127 
	`‰ì
(
d©a
);

131 
wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
width
, 
height
, 0, 0, 0);

134 
	`GrSñe˘Evíts
(
wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

135 
GR_EVENT_MASK_CLOSE_REQ
);

138 
	`GrM≠Wödow
(
wödow
);

140 #ifde‡
USE_PIXMAPS


142 
	`GrC›yAªa
(
wödow
, 
gc
, 0, 0, 
width
, 
height
, 
pm≠
, 0, 0,

143 
MWROP_SRCCOPY
);

145 
	`GrAªa
(
wödow
, 
gc
, 0, 0, 
width
, 
height
, 
d©a
, 
MWPF_RGB
);

149 
	`GrGëNextEvít
(&
evít
);

150 
evít
.
ty≥
) {

151 
GR_EVENT_TYPE_EXPOSURE
:

152 
	`do_exposuª
(&
evít
.
exposuª
);

154 
GR_EVENT_TYPE_CLOSE_REQ
:

155 
	`GrClo£
();

156 
	`exô
(0);

162 
åunˇãd
:

163 
	`¥ötf
("Error: FileáppearsÅo beÅruncated\n");

164 
	`exô
(3);

165 
	}
}

	@demos/nanox/fontdemo.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	#MWINCLUDECOLORS


	)

7 
	~"«no-X.h
"

11 
	#FONTNAME
 "times.âf"

	)

13 
	#FGCOLOR
 
BLACK


	)

14 
	#BGCOLOR
 
WHITE


	)

16 
GR_WINDOW_ID
 
	gw
;

17 
GR_GC_ID
 
	ggc
;

18 
GR_FONT_ID
 
	gf⁄t
;

19 
GR_BOOL
 
	gØ
 = 
GR_TRUE
;

22 
	$do_∑öt
(
GR_EVENT_EXPOSURE
 *
ï
)

24 
i
, 
y
 = 0;

26 
i
=3; i<=30; ++i) {

27 
GR_FONT_INFO
 
öfo
;

28 
buf
[64];

30 
f⁄t
 = 
	`GrCª©eF⁄t
(
FONTNAME
, 
i
, 
NULL
);

31 i‡(
Ø
)

32 
	`GrSëF⁄tAâr
(
f⁄t
, 
GR_TFANTIALIAS
|
GR_TFKERNING
, 0);

34 
	`GrSëGCF⁄t
(
gc
, 
f⁄t
);

36 
	`•rötf
(
buf
, "%d ThêQuick Brow¿Fox Jum≥d Ovî ThêLazy Dog", 
i
);

37 
	`GrText
(
w
, 
gc
, 0, 
y
, 
buf
, -1, 
GR_TFASCII
|
GR_TFTOP
);

39 
	`GrGëF⁄tInfo
(
f⁄t
, &
öfo
);

40 
y
 +
öfo
.
height
;

42 
	`GrDe°royF⁄t
(
f⁄t
);

44 
	}
}

47 
	$maö
(
ac
, **
av
)

49 i‡(
	`GrO≥n
() < 0)

50 
	`exô
(1);

52 
w
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "f⁄tdemo", 
GR_ROOT_WINDOW_ID
,

53 10, 10, 640, 530, 
BGCOLOR
);

54 
	`GrSñe˘Evíts
(
w
, 
GR_EVENT_MASK_EXPOSURE
|
GR_EVENT_MASK_BUTTON_DOWN
|

55 
GR_EVENT_MASK_CLOSE_REQ
);

56 
	`GrM≠Wödow
(
w
);

58 
gc
 = 
	`GrNewGC
();

59 
	`GrSëGCU£Background
(
gc
, 
GR_FALSE
);

60 
	`GrSëGCF‹eground
(
gc
, 
FGCOLOR
);

61 
	`GrSëGCBackground
(
gc
, 
BGCOLOR
);

64 
GR_EVENT
 
evít
;

66 
	`GrGëNextEvít
(&
evít
);

67 
evít
.
ty≥
) {

68 
GR_EVENT_TYPE_EXPOSURE
:

69 
	`do_∑öt
(&
evít
.
exposuª
);

72 
GR_EVENT_TYPE_BUTTON_DOWN
:

74 
GR_WINDOW_INFO
 
öfo
;

76 
Ø
 = !aa;

77 
	`GrGëWödowInfo
(
w
, &
öfo
);

78 
	`GrSëGCF‹eground
(
gc
, 
BGCOLOR
);

79 
	`GrFûlRe˘
(
w
, 
gc
, 0, 0, 
öfo
.
width
, info.
height
);

80 
	`GrSëGCF‹eground
(
gc
, 
FGCOLOR
);

81 
	`do_∑öt
(&
evít
.
exposuª
);

85 
GR_EVENT_TYPE_CLOSE_REQ
:

86 
	`GrClo£
();

87 
	`exô
(0);

90 
	}
}

	@demos/nanox/ftdemo.c

5 
	~<°dio.h
>

6 
	~<°dlib.h
>

7 
	#MWINCLUDECOLORS


	)

8 
	~"«no-X.h
"

10 #i‡
HAVE_T1LIB_SUPPORT


11 
	#FONTNAME
 "bchr"

	)

13 
	#FONTNAME
 "bchb"

	)

14 
	#FONTNAME
 "d¸10"

	)

15 
	#FONTNAME
 "dcbx10"

	)

17 #ñi‡
HAVE_FREETYPE_SUPPORT


18 
	#FONTNAME
 "…1-r-omega-£rif"

	)

20 
	#FONTNAME
 "times"

	)

21 
	#FONTNAME
 "cour"

	)

24 
	#FONTNAME
 
GR_FONT_SYSTEM_VAR


	)

27 
	#MAXW
 400

	)

28 
	#MAXH
 400

	)

30 
GR_GC_ID
 
	ggid
;

31 
GR_FONT_ID
 
	gf⁄tid
, 
	gf⁄tid2
;

32 
GR_BOOL
 
	gkînög
 = 
GR_FALSE
;

33 
GR_BOOL
 
	gØ
 = 
GR_TRUE
;

34 
GR_BOOL
 
	gundîlöe
 = 
GR_FALSE
;

35 
	g™gÀ
 = 0;

36 
	g°©e
 = 
GR_TFBOTTOM
;

37 
	gbuf„r
[128];

38 
	gn
;

39 
Rídî
(
GR_WINDOW_ID
 
wödow
);

42 
	$maö
()

44 
FILE
 *
fûe
;

45 
GR_EVENT
 
evít
;

46 
GR_WINDOW_ID
 
wödow
;

48 i‡(
	`GrO≥n
() < 0) {

49 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

50 
	`exô
(1);

53 
wödow
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "ftdemo",

54 
GR_ROOT_WINDOW_ID
, 50,50, 
MAXW
,
MAXH
, 
WHITE
);

55 
	`GrM≠Wödow
(
wödow
);

57 
gid
 = 
	`GrNewGC
 ();

58 
	`GrSñe˘Evíts
(
wödow
, 
GR_EVENT_MASK_KEY_DOWN
 |

59 
GR_EVENT_MASK_CLOSE_REQ
 | 
GR_EVENT_MASK_EXPOSURE
);

61 i‡((
fûe
 = 
	`f›í
("bö/·demo.txt", "r")Ë=
NULL
) {

62 
	`¥ötf
("Can't openÅext file\n");

66 
n
 = 0;

68 if(
	`fgës
(
buf„r
, 128, 
fûe
Ë!
NULL
) {

69 
n
 = 0;Ç < 128 && 
buf„r
[n];Ç++) {

70 i‡(
buf„r
[
n
] == '\n')

74 
	`f˛o£
(
fûe
);

76 
f⁄tid
 = 
	`GrCª©eF⁄t
(
FONTNAME
, 20, 
NULL
);

77 
f⁄tid2
 = 
	`GrCª©eF⁄t
(
FONTNAME
, 36, 
NULL
);

79 
	`Rídî
(
wödow
);

82 
	`GrGëNextEvít
(&
evít
);

84 
evít
.
ty≥
) {

85 
GR_EVENT_TYPE_KEY_DOWN
:

86 
evít
.
key°roke
.
ch
) {

90 
™gÀ
 += 100;

91 
™gÀ
 %= 3600;

96 
™gÀ
 -= 100;

97 
™gÀ
 %= 3600;

100 
Ø
 = (Ø =
GR_FALSE
)?
GR_TRUE
:GR_FALSE;

103 
kînög
 = (kînög =
GR_FALSE
)?
GR_TRUE
:GR_FALSE;

106 
°©e
 = (°©ê=
GR_TFBOTTOM
)?
GR_TFBASELINE
: \

107 (
°©e
 =
GR_TFBASELINE
)?
GR_TFTOP
:
GR_TFBOTTOM
;

110 
undîlöe
 = undîlöe? 
GR_FALSE
: 
GR_TRUE
;

116 
	`Rídî
(
wödow
);

118 
GR_EVENT_TYPE_EXPOSURE
:

119 
	`Rídî
(
wödow
);

121 
GR_EVENT_TYPE_CLOSE_REQ
:

122 
	`GrClo£
();

123 
	`exô
(0);

128 
	}
}

130 
	$Rídî
(
GR_WINDOW_ID
 
wödow
)

132 
	`GrSëGCBackground
(
gid
, 
WHITE
);

133 
	`GrSëGCF‹eground
 (
gid
, 
WHITE
);

134 
	`GrSëGCU£Background
(
gid
, 
GR_FALSE
);

135 
	`GrFûlRe˘
(
wödow
, 
gid
, 0, 0, 
MAXW
, 
MAXH
);

136 
	`GrSëGCF‹eground
 (
gid
, 
BLACK
);

139 
	`GrSëGCF⁄t
(
gid
, 
f⁄tid
);

140 
	`GrSëF⁄tAâr
(
f⁄tid
, 
GR_TFKERNING
 | 
GR_TFANTIALIAS
, 0);

141 
	`GrText
(
wödow
, 
gid
, 5, 20, "+ RŸ©ê°rög clockwi£", 25, 
GR_TFASCII
);

142 
	`GrText
(
wödow
, 
gid
, 5, 40, "- RŸ©ê°rög cou¡î-˛ockwi£", 34, 
GR_TFASCII
);

143 
	`GrText
(
wödow
, 
gid
, 5, 60, "®ToggÀá¡i-Æüsög", 22, 
GR_TFASCII
);

144 
	`GrText
(
wödow
, 
gid
, 5, 80, "k ToggÀ kînög", 16, 
GR_TFASCII
);

145 
	`GrText
(
wödow
, 
gid
, 5, 100, "u ToggÀ undîlöe", 18, 
GR_TFASCII
);

146 
	`GrText
(
wödow
, 
gid
, 5, 120, "» ToggÀálignmíàbŸtom/ba£löe/t›", 39, 
GR_TFASCII
);

149 
	`GrSëGCF⁄t
(
gid
, 
f⁄tid2
);

150 
	`GrSëF⁄tAâr
(
f⁄tid2
, (
kînög
?
GR_TFKERNING
:0Ë| (
Ø
?
GR_TFANTIALIAS
:0) |

151 (
undîlöe
?
GR_TFUNDERLINE
: 0), -1);

152 
	`GrSëF⁄tRŸ©i⁄
(
f⁄tid2
, 
™gÀ
);

153 
	`GrText
(
wödow
, 
gid
, 
MAXW
/2, 
MAXH
/2, 
buf„r
, 
n
, 
°©e
|
GR_TFUTF8
);

156 
	`GrLöe
 (
wödow
, 
gid
, (
MAXW
/2)-10 , 
MAXH
/2, (MAXW/2)+10, MAXH/2);

157 
	`GrLöe
 (
wödow
, 
gid
, 
MAXW
/2, (
MAXH
/2)-10, MAXW/2, (MAXH/2)+10);

158 
	}
}

	@demos/nanox/getselection.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<uni°d.h
>

4 
	~<°rög.h
>

6 
	~"«no-X.h
"

8 
	gbyãs_ª˚ived
 = 0;

9 *
	gd©a
 = 
NULL
;

11 
	$gŸ_˛õ¡_d©a
(
GR_EVENT
 *
evít
)

13 
GR_EVENT_CLIENT_DATA
 *
ev
 = &
evít
->
˛õ¡d©a
;

15 
	`Ârötf
(
°dîr
, "Got client dataÖacket with serialÇumber %ld for "

16 "wödow %d from wödow %d\n", 
ev
->
£rül
,Év->
wid
,

17 
ev
->
rid
);

18 if(!(
d©a
 = 
	`ªÆloc
(d©a, 
byãs_ª˚ived
 + 
ev
->
d©Æí
))) {

19 
	`Ârötf
(
°dîr
, "Out of memory\n");

20 
	`exô
(7);

22 
	`mem˝y
(
d©a
 + 
byãs_ª˚ived
, 
ev
->d©a,Év->
d©Æí
);

23 
	`‰ì
(
ev
->
d©a
);

25 
	`Ârötf
(
°dîr
, "Got client dataÖacket with serialÇumber %ld for "

26 "wödow %d from wödow %d\n", 
ev
->
£rül
,Év->
wid
,

27 
ev
->
rid
);

28 
	`Ârötf
(
°dîr
, "AlreadyÑeceived %d bytes,ÅhisÖacket is %ld bytes "

30 
byãs_ª˚ived
, 
ev
->
d©Æí
,Év->
Àn
);

32 
byãs_ª˚ived
 +
ev
->
d©Æí
;

33 if(
byãs_ª˚ived
 =
ev
->
Àn
) {

34 
	`Ârötf
(
°dîr
, "we haveÑeceivedáll ofÅhe dataÇow.\n");

35 
	`Ârötf
(
°dîr
, "Thêd©®öÅhê∑ckë is:\n%s\n", 
d©a
);

38 if(
byãs_ª˚ived
 < 
ev
->
Àn
) {

39 
	`Ârötf
(
°dîr
, "this isÇotÅheÜast dataÖacket.\n");

41 } 
	`Ârötf
(
°dîr
, "we haveÑeceivedÅoo much data (shouldn't "

45 
	}
}

47 
	$maö
(
¨gc
, *
¨gv
[])

49 
GR_CHAR
 *
ty≥li°
, *
p
;

50 
GR_WINDOW_ID
 
sid
, 
wid
;

51 
GR_EVENT
 
evít
;

52 
n
 = 0, 
mimëy≥
 = -1;

54 if(
	`GrO≥n
() < 0) {

55 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

59 
sid
 = 
	`GrGëSñe˘i⁄Ow√r
(&
ty≥li°
);

60 if(!
sid
) {

61 
	`Ârötf
(
°dîr
, "Clipboard isÉmpty\n");

65 if(!
ty≥li°
) {

66 
	`Ârötf
(
°dîr
, "GrGetSelectionOwner()ÑeturnedánÉmpty "

67 "ty≥Üi° f‹ wödow %d\n", 
sid
);

71 
	`Ârötf
(
°dîr
, "Wödow %d own†thê£À˘i⁄\n", 
sid
);

72 
	`Ârötf
(
°dîr
, "It claimsÅo beábleÅo supply data inÅhe following "

73 "ty≥s:\n%s\n", 
ty≥li°
);

75 
p
 = 
	`°πok
(
ty≥li°
, " ");

77 if(!
	`°∫cmp
("ãxt/∂aö", 
p
, 10)) {

78 
mimëy≥
 = 
n
;

81 
n
++;

82 } (
p
 = 
	`°πok
(
NULL
, " ")));

84 if(
mimëy≥
 == -1) {

85 
	`Ârötf
(
°dîr
, "TypeÅext/plain isÇotávailable\n");

89 
	`‰ì
(
ty≥li°
);

91 
	`Ârötf
(
°dîr
, "TypeÅext/plain isávailable-Ñequesting data\n");

93 
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 1, 1, 0, 0, 0);

94 if(!
wid
) {

95 
	`Ârötf
(
°dîr
, "Couldn't getá window\n");

99 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLIENT_DATA
);

101 
	`GrReque°Clõ¡D©a
(
wid
, 
sid
, 0, 
mimëy≥
);

104 
	`GrGëNextEvítTimeout
(&
evít
, 4000);

105 
evít
.
ty≥
) {

106 
GR_EVENT_TYPE_CLIENT_DATA
:

107 if(
	`gŸ_˛õ¡_d©a
(&
evít
))

110 
GR_EVENT_TYPE_TIMEOUT
:

111 
	`Ârötf
(
°dîr
, "Timed out waiting for data\n");

119 
	}
}

	@demos/nanox/grabdemo.c

24 
	#MWINCLUDECOLORS


	)

25 
	~<°dio.h
>

26 
	~<°dlib.h
>

27 
	~<uni°d.h
>

28 
	~"«no-X.h
"

30 
	~<sig«l.h
>

32 
GR_WINDOW_ID
 
	gmaö_wödow
;

33 
GR_GC_ID
 
	gmaö_gc
;

35 
	gmesßge1
[100] = "";

36 
	gmesßge2
[100] = "";

37 
	gmesßge3
[100] = "";

38 
	gmesßge4
[100] = "";

39 
	gmesßge5
[100] = "TryÖressing keys...";

41 
	#WIDTH
 500

	)

42 
	#HEIGHT
 110

	)

45 
	$gëSîülNumbî
()

47 
£rül
 = 0;

48 i‡(++
£rül
 >= 1000)

49 
£rül
 = 0;

50  
£rül
;

51 
	}
}

54 
	$keyToCh¨
(
key
)

56 i‡((
key
 >= 32) && (key <= 127)) {

57  ()
key
;

61 
	}
}

64 c⁄° *
	$gøbKödName
(
köd
)

66 
köd
) {

67 
GR_GRAB_HOTKEY_EXCLUSIVE
:

69 
GR_GRAB_HOTKEY
:

71 
GR_GRAB_EXCLUSIVE
:

73 
GR_GRAB_EXCLUSIVE_MOUSE
:

78 
	}
}

81 
	$ª∑öt
(
x
, 
y
, 
width
, 
height
)

83 
	`GrSëGCF‹eground
(
maö_gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

84 
	`GrFûlRe˘
(
maö_wödow
, 
maö_gc
, 
x
, 
y
, 
width
, 
height
);

85 
	`GrSëGCF‹eground
(
maö_gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPTEXT
));

86 
	`GrSëGCU£Background
(
maö_gc
, 
GR_FALSE
);

87 
	`GrText
(
maö_wödow
, 
maö_gc
, 10, 20, 
mesßge1
, -1, 
GR_TFASCII
);

88 
	`GrText
(
maö_wödow
, 
maö_gc
, 10, 40, 
mesßge2
, -1, 
GR_TFASCII
);

89 
	`GrText
(
maö_wödow
, 
maö_gc
, 10, 60, 
mesßge3
, -1, 
GR_TFASCII
);

90 
	`GrText
(
maö_wödow
, 
maö_gc
, 10, 80, 
mesßge4
, -1, 
GR_TFASCII
);

91 
	`GrText
(
maö_wödow
, 
maö_gc
, 10, 100, 
mesßge5
, -1, 
GR_TFASCII
);

92 
	`GrRe˘
(
maö_wödow
, 
maö_gc
, 5, 5, 
WIDTH
 - 10, 
HEIGHT
 - 10);

93 
	}
}

96 
	$ª∑ötAŒ
()

98 
	`ª∑öt
(0,0,
WIDTH
,
HEIGHT
);

99 
	}
}

102 
	$maö
(
¨gc
,**
¨gv
)

104 
GR_EVENT
 
evít
;

105 
GR_WM_PROPERTIES
 
¥›s
;

106 
gøbResu…
;

107 
key
 = 'a';

108 
gøbKöd
 = 
GR_GRAB_HOTKEY_EXCLUSIVE
;

110 i‡(
¨gc
 >= 2)

111 
key
 = 
	`©oi
(
¨gv
[1]);

113 i‡(
¨gc
 >= 3) {

114 
¨gv
[2][0]) {

116 
gøbKöd
 = 
GR_GRAB_HOTKEY_EXCLUSIVE
;

119 
gøbKöd
 = 
GR_GRAB_HOTKEY
;

122 
gøbKöd
 = 
GR_GRAB_EXCLUSIVE
;

125 
gøbKöd
 = 
GR_GRAB_EXCLUSIVE_MOUSE
;

128 
	`¥ötf
( "Usage: %s key {n|h|x|s}\n"

134 
¨gv
[0]);

139 i‡(
	`GrO≥n
() < 0) {

140 
	`¥ötf
("Can't open graphics\n");

141 
	`exô
(1);

145 
	`GrSëEº‹H™dÀr
(
NULL
);

147 
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 20, 20, 
WIDTH
, 
HEIGHT
,

148 0, 
GREEN
, 
BLACK
);

150 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

151 
¥›s
.¥›†
GR_WM_PROPS_NOBACKGROUND
;

152 
¥›s
.
tôÀ
 = "Nano-X GrabKey Demo";

153 
	`GrSëWMPr›îtõs
(
maö_wödow
, &
¥›s
);

155 
maö_gc
 = 
	`GrNewGC
();

157 
	`¥ötf
("Ex˛usivñyÑe£rvög key %d ('%c'): ", 
key
, 
	`keyToCh¨
(key));

158 
gøbResu…
 = 
	`GrGøbKey
(
maö_wödow
, 
key
, 
gøbKöd
);

159 
	`¥ötf
("%d\n", 
gøbResu…
);

161 
	`GrSñe˘Evíts
(
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ


162 | 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_KEY_UP
);

163 
	`GrM≠Wödow
(
maö_wödow
);

164 
	`GrSëFocus
(
maö_wödow
);

166 
	`•rötf
(
mesßge1
,"ExclusivelyÑeserving key %d ('%c'): %s (Mode: %s)\n",

167 
key
, 
	`keyToCh¨
(key),

168 (
gøbResu…
 ? "success" : "failure"),

169 
	`gøbKödName
(
gøbKöd
));

172 
	`GrGëNextEvít
(&
evít
);

173 
evít
.
ty≥
) {

174 
GR_EVENT_TYPE_EXPOSURE
:

175 
	`ª∑öt
(
evít
.
exposuª
.
x
,Évít.exposuª.
y
,

176 
evít
.
exposuª
.
width
,Évít.exposuª.
height
);

178 
GR_EVENT_TYPE_CLOSE_REQ
:

179 
	`GrClo£
();

180 
	`exô
(0);

182 
GR_EVENT_TYPE_ERROR
:

183 
	`¥ötf
("\7gøbdemo: Eº‹ (%sË", 
evít
.
îr‹
.
«me
);

184 
	`¥ötf
(
nxEº‹Såögs
[
evít
.
îr‹
.
code
],evít.îr‹.
id
);

186 
GR_EVENT_TYPE_KEY_DOWN
:

187 i‡(
evít
.
key°roke
.
hŸkey
)

188 
	`•rötf
(
mesßge4
, "%03d Hotkey %d ('%c') scan %dÖressed\n",

189 
	`gëSîülNumbî
(), 
evít
.
key°roke
.
ch
,

190 
	`keyToCh¨
(
evít
.
key°roke
.
ch
),Évít.key°roke.
sˇncode
);

192 
	`•rötf
(
mesßge2
, "%03d Key %d ('%c') scan %dÖressed\n",

193 
	`gëSîülNumbî
(), 
evít
.
key°roke
.
ch
,

194 
	`keyToCh¨
(
evít
.
key°roke
.
ch
),Évít.key°roke.
sˇncode
);

195 
	`ª∑ötAŒ
();

197 
GR_EVENT_TYPE_KEY_UP
:

198 i‡(
evít
.
key°roke
.
hŸkey
)

199 
	`•rötf
(
mesßge5
, "%03d Hotkey %d ('%c')Ñeleased\n",

200 
	`gëSîülNumbî
(), 
evít
.
key°roke
.
ch
, 
	`keyToCh¨
(event.keystroke.ch));

202 
	`•rötf
(
mesßge3
, "%03d Key %d ('%c')Ñeleased\n",

203 
	`gëSîülNumbî
(), 
evít
.
key°roke
.
ch
, 
	`keyToCh¨
(event.keystroke.ch));

204 
	`ª∑ötAŒ
();

209 
	`GrClo£
();

211 
	}
}

	@demos/nanox/info.c

5 
	~<°dio.h
>

6 
	~<c⁄io.h
>

7 
	~"«no-X.h
"

9 
	$maö
()

11 
GR_SCREEN_INFO
 
si
;

12 
GR_FONT_INFO
 
fi
;

13 
GR_GC_INFO
 
gi
;

14 
GR_FONT
 
f⁄ts
;

15 
x
, 
y
;

17 
	`GrO≥n
();

18 
	`GrGëS¸ìnInfo
(&
si
);

20 
	`¥ötf
("row†%d\n", 
si
.
rows
);

21 
	`¥ötf
("cﬁ†%d\n", 
si
.
cﬁs
);

22 
	`¥ötf
("bµ = %d\n", 
si
.
bµ
);

23 
	`¥ötf
("∂™e†%d\n", 
si
.
∂™es
);

24 
	`¥ötf
("ncﬁ‹†%d\n", 
si
.
ncﬁ‹s
);

25 
	`¥ötf
("buâ⁄†0x%x\n", 
si
.
buâ⁄s
);

26 
	`¥ötf
("modifõr†0x%x\n", 
si
.
modifõrs
);

27 
	`¥ötf
("f⁄t†%d\n", 
si
.
f⁄ts
);

29 
	`gëch
();

31 
f⁄ts
 = 0; f⁄t†< 
si
.fonts; fonts++) {

33 
	`GrGëF⁄tInfo
(
f⁄ts
, &
fi
);

35 
	`¥ötf
("\nf⁄à%d\n", 
fi
.
f⁄t
);

36 
	`¥ötf
("heighà%d\n", 
fi
.
height
);

37 
	`¥ötf
("maxwidth = %d\n", 
fi
.
maxwidth
);

38 
	`¥ötf
("ba£löê%d\n", 
fi
.
ba£löe
);

39 
	`¥ötf
("fixed = %s\n", 
fi
.
fixed
 ? "TRUE" : "FALSE");

40 
	`¥ötf
("widths =\n");

41 
y
 = 0; y != 3; y++) {

42 
x
 = 0; x != 7; x++)

43 
	`¥ötf
("%2d", 
fi
.
widths
[
x
 * 
y
]);

44 
	`¥ötf
("\n");

46 
	`gëch
();

52 
	`gëch
();

54 
	`GrClo£
();

55 
	}
}

	@demos/nanox/ipcclient.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<uni°d.h
>

10 
	~<°rög.h
>

12 
	~"«no-X.h
"

14 
	$£nd_pög
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
£rvîid
,

15 
GR_SERIALNO
 
£rül
)

17 
	`¥ötf
("SídögÖög from %dÅÿ%d wôh sîü»%lu\n", 
wid
, 
£rvîid
,

18 
£rül
);

19 
	`GrSídClõ¡D©a
(
wid
, 
£rvîid
, 
£rül
, 4, 4, "ping");

20 
	}
}

22 
	$h™dÀ_∑ckë
(
GR_EVENT
 *
evít
)

24 
GR_EVENT_CLIENT_DATA
 *
pkt
 = (GR_EVENT_CLIENT_DATA *)
evít
;

26 if(
pkt
->
Àn
 =4 && !
	`memcmp
’kt->
d©a
, "pong", 4)) {

27 
	`¥ötf
("GŸÖ⁄g from %dÅÿ%d wôh sîü»%lu\n", 
pkt
->
rid
,

28 
pkt
->
wid
,Ökt->
£rül
);

29 } 
	`¥ötf
("GŸ unknow¿∑ckë from %d\n", 
pkt
->
rid
);

30 
	}
}

32 
	$maö
(
¨gc
, *
¨gv
[])

34 
GR_EVENT
 
evít
;

35 
GR_PROP
 *
d©a
;

36 
GR_SERIALNO
 
cou¡
 = 0;

37 
GR_WINDOW_ID
 
wid
, 
£rvîid
;

39 if(
	`GrO≥n
() < 0) {

40 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

44 
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 1, 1, 0, 0, 0);

45 if(!
wid
) {

46 
	`Ârötf
(
°dîr
, "Couldn't getá window\n");

47 
	`GrClo£
();

51 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLIENT_DATA
 | 
GR_EVENT_MASK_TIMER
);

53 if(
	`GrGëWödowPr›îty
(
GR_ROOT_WINDOW_ID
, "demo_ùc_£rvî", &
d©a
)

54 !(
£rvîid
)) {

55 if(!
d©a
) {

56 
	`Ârötf
(
°dîr
, "Couldn't find server ID\n");

57 
	`GrClo£
();

60 
	`Ârötf
(
°dîr
, "Server IDÖroperty is wrong size\n");

61 
	`‰ì
(
d©a
);

62 
	`GrClo£
();

67 
	`mem˝y
(&
£rvîid
, 
d©a
, (serverid));

68 
	`‰ì
(
d©a
);

70 
	`¥ötf
("Found sîvîáàwödow %d\n", 
£rvîid
);

72 
	`GrCª©eTimî
(
wid
, 1000, 
GR_TRUE
);

75 
	`GrGëNextEvít
(&
evít
);

76 
evít
.
ty≥
) {

77 
GR_EVENT_TYPE_TIMER
:

78 
	`£nd_pög
(
wid
, 
£rvîid
, 
cou¡
++);

80 
GR_EVENT_TYPE_CLIENT_DATA
:

81 
	`h™dÀ_∑ckë
(&
evít
);

84 
	`Ârötf
(
°dîr
, "Got unknownÉvent %d\n",

85 
evít
.
ty≥
);

90 
	`GrClo£
();

93 
	}
}

	@demos/nanox/ipcserver.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<uni°d.h
>

10 
	~<°rög.h
>

12 
	~"«no-X.h
"

14 
	$h™dÀ_∑ckë
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT
 *
evít
)

16 
GR_EVENT_CLIENT_DATA
 *
pkt
 = (GR_EVENT_CLIENT_DATA *)
evít
;

18 if(
pkt
->
Àn
 =4 && !
	`memcmp
’kt->
d©a
, "ping", 4)) {

19 
	`¥ötf
("GotÖingÖacket from window %d with serial %lu, "

20 "£ndögÖ⁄gÑïly\n", 
pkt
->
rid
,Ökt->
£rül
);

21 
	`GrSídClõ¡D©a
(
wid
, 
pkt
->
rid
,Ökt->
£rül
,

23 } 
	`¥ötf
("GŸ unknow¿∑ckë from wödow %d\n", 
pkt
->
rid
);

24 
	}
}

26 
	$maö
(
¨gc
, *
¨gv
[])

28 
GR_EVENT
 
evít
;

29 
GR_WINDOW_ID
 
wid
;

31 if(
	`GrO≥n
() < 0) {

32 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

36 
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 1, 1, 0, 0, 0);

37 if(!
wid
) {

38 
	`Ârötf
(
°dîr
, "Couldn't getá window\n");

39 
	`GrClo£
();

43 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLIENT_DATA
);

45 
	`GrCh™gePr›îty
(
GR_ROOT_WINDOW_ID
, "demo_ùc_£rvî", (
GR_PROP
 *)&
wid
,

46 (
wid
));

48 
	`¥ötf
("Regi°îed sîvî wödow %d\n", 
wid
);

51 
	`GrGëNextEvít
(&
evít
);

52 
evít
.
ty≥
) {

53 
GR_EVENT_TYPE_CLIENT_DATA
:

54 
	`h™dÀ_∑ckë
(
wid
, &
evít
);

57 
	`Ârötf
(
°dîr
, "Got unknownÉvent %d\n",

58 
evít
.
ty≥
);

63 
	`GrClo£
();

66 
	}
}

	@demos/nanox/landmine.c

6 
	~<°dio.h
>

7 
	~<°d¨g.h
>

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

10 #i‡
UNIX
 | 
DOS_DJGPP


11 
	~<f˙é.h
>

12 
	~<uni°d.h
>

13 
	~<time.h
>

15 
	#MWINCLUDECOLORS


	)

16 
	~"«no-X.h
"

19 
	#MINSIZE
 3

	)

20 
	#MAXSIZE
 30

	)

21 
	#SIZE
 15

	)

22 
	#MINEPERCENT
 15

	)

23 
	#SAVEFILE
 "œndmöe.ßve"

	)

24 
	#MAGIC
 649351261

	)

25 
	#MAXPARAMS
 1000

	)

27 
	#FULLSIZE
 (
MAXSIZE
 + 2Ë

	)

29 #ifde‡
__ECOS


31 
	#BOARDGAP
 2

	)

32 
	#RIGHTGAP
 2

	)

33 
	#BUTTONGAP
 5

	)

34 
	#STATUSGAP
 10

	)

36 
	#BUTTONWIDTH
 80

	)

37 
	#BUTTONHEIGHT
 25

	)

38 
	#RIGHTSIDE
 90

	)

39 
	#BOARDBORDER
 2

	)

41 
	#BOARDGAP
 10

	)

42 
	#RIGHTGAP
 15

	)

43 
	#BUTTONGAP
 20

	)

44 
	#STATUSGAP
 35

	)

46 
	#BUTTONWIDTH
 80

	)

47 
	#BUTTONHEIGHT
 25

	)

48 
	#RIGHTSIDE
 150

	)

49 
	#BOARDBORDER
 2

	)

57 
	#PRINTSTEPS
 
	`¥öéöe
(2, "Sãps: %3d\n", 
°ïs
)

	)

63 
	tCELL
;

64 
	tPOS
;

70 
	#X
 ((Ë1)

	)

71 
	#_
 ((Ë0)

	)

73 
	#BITS
(
a
,
b
,
c
,
d
,
e
,
f
,
g
,
h
,
i
) \

74 (((((((((
a
*2+
b
)*2+
c
)*2+
d
)*2+
e
)*2+
f
)*2+
g
)*2+
h
)*2+
i
Ë<< 7)

	)

77 
GR_BITMAP
 
	gtwﬁegs_fg
[] = {

78 
BITS
(
_
,_,_,_,_,_,_,_,_),

79 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

80 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

81 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

82 
BITS
(
_
,_,_,_,
X
,_,_,_,_),

83 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

84 
BITS
(
_
,
X
,_,X,_,X,_,X,_),

85 
BITS
(
_
,
X
,_,X,X,X,_,X,_),

86 
BITS
(
_
,_,_,
X
,_,X,_,_,_),

87 
BITS
(
_
,_,_,
X
,_,X,_,_,_),

88 
BITS
(
_
,_,
X
,X,_,X,X,_,_),

89 
BITS
(
_
,_,_,_,_,_,_,_,_)

92 
GR_BITMAP
 
	gtwﬁegs_bg
[] = {

93 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

94 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

95 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

96 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

97 
BITS
(
_
,
X
,X,X,X,X,X,X,_),

98 
BITS
(
X
,X,X,X,X,X,X,X,X),

99 
BITS
(
X
,X,X,X,
_
,X,X,X,X),

100 
BITS
(
X
,X,X,X,X,X,X,X,X),

101 
BITS
(
X
,X,X,X,X,X,X,X,X),

102 
BITS
(
_
,
X
,X,X,X,X,X,X,_),

103 
BITS
(
_
,
X
,X,X,X,X,X,X,_),

104 
BITS
(
_
,
X
,X,X,X,X,X,X,_)

108 
GR_BITMAP
 
	g⁄ñeg_fg
[] = {

109 
BITS
(
_
,_,_,_,_,_,_,_,_),

110 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

111 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

112 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

113 
BITS
(
_
,_,_,_,
X
,_,_,_,_),

114 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

115 
BITS
(
_
,
X
,_,X,_,X,_,X,_),

116 
BITS
(
_
,_,_,
X
,X,X,_,X,_),

117 
BITS
(
_
,_,_,_,_,
X
,_,_,_),

118 
BITS
(
_
,_,_,_,_,
X
,_,_,_),

119 
BITS
(
_
,_,_,_,_,
X
,X,_,_),

120 
BITS
(
_
,_,_,_,_,_,_,_,_),

124 
GR_BITMAP
 
	g⁄ñeg_bg
[] = {

125 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

126 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

127 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

128 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

129 
BITS
(
_
,
X
,X,X,X,X,X,X,_),

130 
BITS
(
X
,X,X,X,X,X,X,X,X),

131 
BITS
(
X
,X,X,X,
_
,X,X,X,X),

132 
BITS
(
X
,X,X,X,X,X,X,X,X),

133 
BITS
(
_
,_,
X
,X,X,X,X,X,X),

134 
BITS
(
_
,_,_,_,
X
,X,X,X,_),

135 
BITS
(
_
,_,_,_,
X
,X,X,X,_),

136 
BITS
(
_
,_,_,_,
X
,X,X,X,_)

140 
GR_BITMAP
 
	gnﬁeg_fg
[] = {

141 
BITS
(
_
,_,_,_,_,_,_,_,_),

142 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

143 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

144 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

145 
BITS
(
_
,_,_,_,
X
,_,_,_,_),

146 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

147 
BITS
(
_
,
X
,_,X,_,X,_,X,_),

148 
BITS
(
_
,_,_,
X
,X,X,_,_,_),

149 
BITS
(
_
,_,_,_,_,_,_,_,_),

150 
BITS
(
_
,_,_,_,_,_,_,_,_),

151 
BITS
(
_
,_,_,_,_,_,_,_,_),

152 
BITS
(
_
,_,_,_,_,_,_,_,_),

156 
GR_BITMAP
 
	gnﬁeg_bg
[] = {

157 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

158 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

159 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

160 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

161 
BITS
(
_
,
X
,X,X,X,X,X,X,_),

162 
BITS
(
X
,X,X,X,X,X,X,X,X),

163 
BITS
(
X
,X,X,X,
_
,X,X,X,X),

164 
BITS
(
X
,X,X,X,X,X,X,X,X),

165 
BITS
(
_
,_,
X
,X,X,X,X,_,_),

166 
BITS
(
_
,_,_,_,_,_,_,_,_),

167 
BITS
(
_
,_,_,_,_,_,_,_,_),

168 
BITS
(
_
,_,_,_,_,_,_,_,_)

175 
	#F_EMPTY
 ' '

	)

176 
	#F_REMEMBER
 '*'

	)

177 
	#F_WRONG
 'X'

	)

178 
	#F_DISPLAY
 0xf‡

	)

179 
	#F_MINE
 0x100

	)

180 
	#F_EDGE
 0x200

	)

181 
	#F_OLD
 0x400

	)

182 
	#F_REACH
 0x800

	)

183 
	#F_FLAGS
 0xff00

	)

190 
	s°©us
 {

191 
	ms_magic
;

192 
	ms_∂ayög
;

193 
	ms_size
;

194 
	ms_möes
;

195 
	ms_Àgs
;

196 
	ms_°ïs
;

197 
	ms_ödex
;

198 
	ms_sizï¨am
[
MAXPARAMS
];

199 
	ms_möï¨am
[
MAXPARAMS
];

200 
	ms_games0
[
MAXPARAMS
];

201 
	ms_games1
[
MAXPARAMS
];

202 
	ms_games2
[
MAXPARAMS
];

203 
	ms_°ïs0
[
MAXPARAMS
];

204 
	ms_°ïs1
[
MAXPARAMS
];

205 
	ms_°ïs2
[
MAXPARAMS
];

206 
CELL
 
	ms_bﬂrd
[
FULLSIZE
*FULLSIZE];

207 } 
	g°
;

213 
	#magic
 
°
.
s_magic


	)

214 
	#∂ayög
 
°
.
s_∂ayög


	)

215 
	#size
 
°
.
s_size


	)

216 
	#möes
 
°
.
s_möes


	)

217 
	#Àgs
 
°
.
s_Àgs


	)

218 
	#°ïs
 
°
.
s_°ïs


	)

219 
	#ödex
 
°
.
s_ödex


	)

220 
	#sizï¨am
 
°
.
s_sizï¨am


	)

221 
	#möï¨am
 
°
.
s_möï¨am


	)

222 
	#games0
 
°
.
s_games0


	)

223 
	#games1
 
°
.
s_games1


	)

224 
	#games2
 
°
.
s_games2


	)

225 
	#°ïs0
 
°
.
s_°ïs0


	)

226 
	#°ïs1
 
°
.
s_°ïs1


	)

227 
	#°ïs2
 
°
.
s_°ïs2


	)

228 
	#bﬂrd
 
°
.
s_bﬂrd


	)

231 
	#bﬂrdpos
(
row
, 
cﬁ
Ë((‘owË* 
FULLSIZE
Ë+ (cﬁ))

	)

232 
	#ismöe
(
˚Œ
Ë((˚ŒË& 
F_MINE
)

	)

233 
	#i£dge
(
˚Œ
Ë((˚ŒË& 
F_EDGE
)

	)

234 
	#isﬁd
(
˚Œ
Ë((˚ŒË& 
F_OLD
)

	)

235 
	#is£í
(
˚Œ
Ë(((˚ŒË& 
F_DISPLAY
Ë=
F_REMEMBER
)

	)

236 
	#isknown
(
˚Œ
Ë(((˚ŒË& 
F_DISPLAY
Ë!
F_EMPTY
)

	)

237 
	#di•œych¨
(
˚Œ
Ë((˚ŒË& 
F_DISPLAY
)

	)

238 
	#badsqu¨e
(
n
Ë((“Ë<0Ë|| (“Ë> 
size
))

	)

240 #i‡
PSP


241 
	#Ârötf
(...)

	)

247 
POS
 
	g°ïèbÀ
[8] = {

248 
FULLSIZE
, -FULLSIZE, 1, -1, FULLSIZE-1,

249 
FULLSIZE
+1, -FULLSIZE-1, -FULLSIZE+1

253 
GR_WINDOW_ID
 
	gmaöwid
;

254 
GR_WINDOW_ID
 
	gbﬂrdwid
;

255 
GR_WINDOW_ID
 
	g°©wid
;

256 
GR_WINDOW_ID
 
	gquôwid
;

257 
GR_WINDOW_ID
 
	gßvewid
;

258 
GR_WINDOW_ID
 
	g√wgamewid
;

260 
GR_GC_ID
 
	gbﬂrdgc
;

261 
GR_GC_ID
 
	g˛órgc
;

262 
GR_GC_ID
 
	gªdgc
;

263 
GR_GC_ID
 
	ggªígc
;

264 
GR_GC_ID
 
	gbœckgc
;

265 
GR_GC_ID
 
	gdñaygc
;

266 
GR_GC_ID
 
	g°©gc
;

267 
GR_GC_ID
 
	gbuâ⁄gc
;

268 
GR_GC_ID
 
	gx‹gc
;

270 
GR_SIZE
 
	gxp
;

271 
GR_SIZE
 
	gyp
;

272 
GR_SIZE
 
	g°©width
;

273 
GR_SIZE
 
	g°©height
;

274 
GR_SIZE
 
	gch¨height
;

275 
GR_COORD
 
	gch¨xpos
;

276 
GR_COORD
 
	gch¨ypos
;

278 
GR_SCREEN_INFO
 
	gsi
;

279 
GR_FONT_INFO
 
	gfi
;

281 
GR_SIZE
 
	gCOLS
, 
	gROWS
;

283 *
	gßvefûe
;

289 
dokey
(
GR_EVENT_KEYSTROKE
 *
kp
);

290 
døwbﬂrd
();

291 
døw˚Œ
(
POS
 
pos
);

292 
˛ór˚Œ
(
POS
 
pos
);

293 
døwbomb
(
POS
 
pos
, 
GR_GC_ID
 
gc
, 
GR_BOOL
 
™im©e
);

294 
døwbuâ⁄
(
GR_WINDOW_ID
 
wödow
, *
œbñ
);

295 
£tcurs‹
();

296 
dñay
();

297 
˚Œ˚¡î
(
POS
 
pos
, 
GR_COORD
 *
ªtx
, GR_COORD *
ªty
);

298 
døw°©us
();

299 
¥öéöe
(
GR_COORD
, *, ...);

300 
√wlöe
();

301 
POS
 
föd˚Œ
(
GR_COORD
 
x
, GR_COORD 
y
);

302 
√wgame
();

303 
GR_BOOL
 
check∑th
(
POS
 
pos
);

304 
movë›os
(
POS
 
√wpos
);

305 
toggÀ˚Œ
(
POS
 
pos
);

306 
födödex
();

307 
ªadgame
(*
«me
);

308 
GR_BOOL
 
wrôegame
(*
«me
);

309 
gameovî
();

310 
h™dÀevít
(
GR_EVENT
 *
ï
);

311 
d€xposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

312 
dobuâ⁄
(
GR_EVENT_BUTTON
 *
bp
);

313 
dokey
(
GR_EVENT_KEYSTROKE
 *
kp
);

316 
	$maö
(
¨gc
,**
¨gv
)

318 
GR_COORD
 
x
;

319 
GR_COORD
 
y
;

320 
GR_SIZE
 
width
;

321 
GR_SIZE
 
height
;

322 
GR_COORD
 
rightx
;

323 
GR_BOOL
 
£tsize
;

324 
GR_BOOL
 
£tmöes
;

325 
GR_SIZE
 
√wsize
 = 10;

326 
GR_COUNT
 
√wmöes
 = 25;

327 
GR_WM_PROPERTIES
 
¥›s
;

329 
£tmöes
 = 
GR_FALSE
;

330 
£tsize
 = 
GR_FALSE
;

332 
¨gc
--;

333 
¨gv
++;

334 (
¨gc
 > 0Ë&& (**
¨gv
 == '-')) {

335 
¨gv
[0][1]) {

337 i‡(
¨gc
 <= 0) {

338 
	`Ârötf
(
°dîr
, "Missing mine count\n");

339 
	`exô
(1);

341 
¨gc
--;

342 
¨gv
++;

343 
√wmöes
 = 
	`©oi
(*
¨gv
);

344 
£tmöes
 = 
GR_TRUE
;

348 i‡(
¨gc
 <= 0) {

349 
	`Ârötf
(
°dîr
, "Missing size\n");

350 
	`exô
(1);

352 
¨gc
--;

353 
¨gv
++;

354 
√wsize
 = 
	`©oi
(*
¨gv
);

355 
£tsize
 = 
GR_TRUE
;

359 
	`Ârötf
(
°dîr
, "Unknown option \"-%c\"\n",

360 
¨gv
[0][1]);

361 
	`exô
(1);

363 
¨gc
--;

364 
¨gv
++;

366 i‡(
¨gc
 > 0)

367 
ßvefûe
 = *
¨gv
;

369 
	`§™d
(
	`time
(0));

371 
	`ªadgame
(
ßvefûe
);

373 i‡(
£tsize
) {

374 i‡((
√wsize
 < 
MINSIZE
Ë|| (√wsizê> 
MAXSIZE
)) {

375 
	`Ârötf
(
°dîr
, "Illegal board size\n");

376 
	`exô
(1);

378 i‡(
√wsize
 !
size
) {

379 i‡(
°ïs
 && 
∂ayög
) {

380 
	`Ârötf
(
°dîr
,

382 
	`exô
(1);

384 
∂ayög
 = 
GR_FALSE
;

385 
size
 = 
√wsize
;

386 i‡(!
∂ayög
)

387 
möes
 = (
size
 * sizê* 
MINEPERCENT
) / 100;

391 i‡(
£tmöes
) {

392 i‡((
√wmöes
 <0Ë|| (“ewmöe†> (
size
 * size) / 2))) {

393 
	`Ârötf
(
°dîr
, "IllegalÇumber of mines\n");

394 
	`exô
(1);

396 i‡(
√wmöes
 !
möes
) {

397 i‡(
°ïs
 && 
∂ayög
) {

398 
	`Ârötf
(
°dîr
,

400 
	`exô
(1);

402 
∂ayög
 = 
GR_FALSE
;

403 
möes
 = 
√wmöes
;

407 
	`födödex
();

414 i‡(
	`GrO≥n
() < 0) {

415 
	`Ârötf
(
°dîr
, "Cannot open graphics\n");

416 
	`exô
(1);

419 
	`GrReqShmCmds
(655360);

421 
	`GrGëS¸ìnInfo
(&
si
);

422 
	`GrGëF⁄tInfo
(0, &
fi
);

423 
ch¨height
 = 
fi
.
height
;

429 
COLS
 = 
si
.
cﬁs
 - 40;

431 
COLS
 = 
si
.
cﬁs
;

433 
ROWS
 = 
si
.
rows
 - 80;

434 
maöwid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
COLS
, 
ROWS
,

435 0, 
BLACK
, 
WHITE
);

438 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

439 
¥›s
.¥›†
GR_WM_PROPS_APPFRAME
 | 
GR_WM_PROPS_CAPTION
;

440 
¥›s
.
tôÀ
 = "Land Mine";

441 
	`GrSëWMPr›îtõs
(
maöwid
, &
¥›s
);

448 
width
 = 
COLS
 - 
RIGHTSIDE
 - (
si
.
xdpcm
 * 
RIGHTGAP
 / 10Ë- 
BOARDBORDER
 * 2;

449 
height
 = (((Ë
width
Ë* 
si
.
ydpcm
Ë/ si.
xdpcm
;

450 i‡(
height
 > 
ROWS
 ) {

451 
height
 = 
ROWS
 - 
BOARDBORDER
 * 2;

452 
width
 = (((Ë
height
Ë* 
si
.
xdpcm
Ë/ si.
ydpcm
;

454 
xp
 = 
width
 / 
size
;

455 
yp
 = 
height
 / 
size
;

457 
width
 = 
xp
 * 
size
 - 1;

458 
height
 = 
yp
 * 
size
 - 1;

459 
x
 = 
BOARDBORDER
;

460 
y
 = (
ROWS
 - 
height
) / 2;

462 
rightx
 = 
x
 + 
width
 + (
si
.
xdpcm
 * 
RIGHTGAP
 / 10);

463 
bﬂrdwid
 = 
	`GrNewWödow
(
maöwid
, 
x
, 
y
, 
width
, 
height
, 
BOARDBORDER
,

464 
BLUE
, 
WHITE
);

468 
x
 = 
rightx
;

469 
y
 = (
si
.
ydpcm
 * 
BOARDGAP
 / 10);

470 
quôwid
 = 
	`GrNewWödow
(
maöwid
, 
x
, 
y
, 
BUTTONWIDTH
, 
BUTTONHEIGHT
,

471 1, 
RED
, 
WHITE
);

473 
y
 +(
si
.
ydpcm
 * 
BUTTONGAP
 / 10);

474 
ßvewid
 = 
	`GrNewWödow
(
maöwid
, 
x
, 
y
, 
BUTTONWIDTH
, 
BUTTONHEIGHT
,

475 1, 
GREEN
, 
WHITE
);

477 
y
 +(
si
.
ydpcm
 * 
BUTTONGAP
 / 10);

478 
√wgamewid
 = 
	`GrNewWödow
(
maöwid
, 
x
, 
y
, 
BUTTONWIDTH
, 
BUTTONHEIGHT
,

479 1, 
GREEN
, 
WHITE
);

484 
x
 = 
rightx
;

485 
y
 +(
si
.
ydpcm
 * 
STATUSGAP
 / 10);

486 
width
 = 
COLS
 - 
x
;

487 
height
 = 
ROWS
 - 
y
;

488 
°©wid
 = 
	`GrNewWödow
(
maöwid
, 
x
, 
y
, 
width
, 
height
, 0,

490 
°©width
 = 
width
;

491 
°©height
 = 
height
;

496 
bﬂrdgc
 = 
	`GrNewGC
();

497 
˛órgc
 = 
	`GrNewGC
();

498 
dñaygc
 = 
	`GrNewGC
();

499 
ªdgc
 = 
	`GrNewGC
();

500 
gªígc
 = 
	`GrNewGC
();

501 
°©gc
 = 
	`GrNewGC
();

502 
bœckgc
 = 
	`GrNewGC
();

503 
buâ⁄gc
 = 
	`GrNewGC
();

504 
x‹gc
 = 
	`GrNewGC
();

505 
	`GrSëGCBackground
(
bﬂrdgc
, 
BLUE
);

506 
	`GrSëGCF‹eground
(
˛órgc
, 
BLUE
);

507 
	`GrSëGCF‹eground
(
ªdgc
, 
RED
);

508 
	`GrSëGCF‹eground
(
gªígc
, 
GREEN
);

509 
	`GrSëGCF‹eground
(
°©gc
, 
GRAY
);

510 
	`GrSëGCF‹eground
(
dñaygc
, 
BLACK
);

511 
	`GrSëGCF‹eground
(
bœckgc
, 
BLACK
);

512 
	`GrSëGCMode
(
dñaygc
, 
GR_MODE_XOR
);

513 
	`GrSëGCMode
(
x‹gc
, 
GR_MODE_XOR
);

514 
	`GrSëGCU£Background
(
bﬂrdgc
, 
GR_FALSE
);

515 
	`GrSëGCU£Background
(
buâ⁄gc
, 
GR_FALSE
);

517 
	`GrSñe˘Evíts
(
maöwid
, 
GR_EVENT_MASK_CLOSE_REQ
);

519 
	`GrSñe˘Evíts
(
bﬂrdwid
, 
GR_EVENT_MASK_EXPOSURE
 |

520 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_KEY_DOWN
);

522 
	`GrSñe˘Evíts
(
°©wid
, 
GR_EVENT_MASK_EXPOSURE
);

524 
	`GrSñe˘Evíts
(
quôwid
, 
GR_EVENT_MASK_EXPOSURE
 |

525 
GR_EVENT_MASK_BUTTON_DOWN
);

527 
	`GrSñe˘Evíts
(
√wgamewid
, 
GR_EVENT_MASK_EXPOSURE
 |

528 
GR_EVENT_MASK_BUTTON_DOWN
);

530 
	`GrSñe˘Evíts
(
ßvewid
, 
GR_EVENT_MASK_EXPOSURE
 |

531 
GR_EVENT_MASK_BUTTON_DOWN
);

533 
	`£tcurs‹
();

535 
	`GrM≠Wödow
(
maöwid
);

536 
	`GrM≠Wödow
(
bﬂrdwid
);

537 
	`GrM≠Wödow
(
°©wid
);

538 
	`GrM≠Wödow
(
quôwid
);

539 
	`GrM≠Wödow
(
ßvewid
);

540 
	`GrM≠Wödow
(
√wgamewid
);

542 i‡(!
∂ayög
)

543 
	`√wgame
();

545 
GR_TRUE
) {

546 
GR_EVENT
 
evít
;

548 
	`GrGëNextEvít
(&
evít
);

549 
	`h™dÀevít
(&
evít
);

551 
	}
}

558 
	$h™dÀevít
(
GR_EVENT
 *
ï
)

560 
ï
->
ty≥
) {

561 
GR_EVENT_TYPE_BUTTON_DOWN
:

562 
	`dobuâ⁄
(&
ï
->
buâ⁄
);

565 
GR_EVENT_TYPE_EXPOSURE
:

566 
	`d€xposuª
(&
ï
->
exposuª
);

569 
GR_EVENT_TYPE_KEY_DOWN
:

570 
	`dokey
(&
ï
->
key°roke
);

573 
GR_EVENT_TYPE_CLOSE_REQ
:

574 
	`GrClo£
();

575 
	`exô
(0);

577 
	}
}

584 
	$d€xposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

586 i‡(
ï
->
wid
 =
bﬂrdwid
) {

587 
	`døwbﬂrd
();

591 i‡(
ï
->
wid
 =
°©wid
) {

592 
	`døw°©us
();

596 i‡(
ï
->
wid
 =
quôwid
) {

597 
	`døwbuâ⁄
(
quôwid
, "QUIT");

601 i‡(
ï
->
wid
 =
ßvewid
) {

602 
	`døwbuâ⁄
(
ßvewid
, "SAVE GAME");

606 i‡(
ï
->
wid
 =
√wgamewid
) {

607 
	`døwbuâ⁄
(
√wgamewid
, "NEW GAME");

610 
	}
}

617 
	$dobuâ⁄
(
GR_EVENT_BUTTON
 *
bp
)

619 i‡(
bp
->
wid
 =
bﬂrdwid
) {

620 
	`movë›os
(
	`föd˚Œ
(
bp
->
x
, bp->
y
));

624 i‡(
bp
->
wid
 =
quôwid
) {

625 
	`GrFûlRe˘
(
quôwid
, 
x‹gc
, 0, 0, 
BUTTONWIDTH
, 
BUTTONHEIGHT
);

626 
	`GrFlush
();

627 i‡(
ßvefûe
)

628 
	`wrôegame
(
ßvefûe
);

629 
	`GrClo£
();

630 
	`exô
(0);

633 i‡(
bp
->
wid
 =
ßvewid
) {

634 
	`GrFûlRe˘
(
ßvewid
, 
x‹gc
, 0, 0, 
BUTTONWIDTH
, 
BUTTONHEIGHT
);

635 
	`GrFlush
();

636 i‡(
ßvefûe
 =
NULL
)

637 
ßvefûe
 = 
SAVEFILE
;

638 i‡(
	`wrôegame
(
ßvefûe
))

639 
	`wrôe
(1, "\007", 1);

641 
	`dñay
();

642 
	`GrFûlRe˘
(
ßvewid
, 
x‹gc
, 0, 0, 
BUTTONWIDTH
, 
BUTTONHEIGHT
);

645 i‡(
bp
->
wid
 =
√wgamewid
) {

646 
	`GrFûlRe˘
(
√wgamewid
, 
x‹gc
, 0, 0, 
BUTTONWIDTH
, 
BUTTONHEIGHT
);

647 
	`GrFlush
();

651 
	`√wgame
();

652 
	`dñay
();

654 
	`GrFûlRe˘
(
√wgamewid
, 
x‹gc
, 0, 0, 
BUTTONWIDTH
, 
BUTTONHEIGHT
);

656 
	}
}

663 
	$dokey
(
GR_EVENT_KEYSTROKE
 *
kp
)

665 i‡((
kp
->
wid
 !
bﬂrdwid
Ë|| !
∂ayög
)

668 
kp
->
ch
) {

670 
	`toggÀ˚Œ
(
	`föd˚Œ
(
kp
->
x
, kp->
y
));

673 
	}
}

680 
	$døwbﬂrd
()

682 
GR_COORD
 
row
;

683 
GR_COORD
 
cﬁ
;

685 
row
 = 1;Ñow < 
size
;Ñow++) {

686 
	`GrLöe
(
bﬂrdwid
, 
bﬂrdgc
, 0, 
row
 * 
yp
 - 1, 
size
 * 
xp
 - 1,

687 
row
 * 
yp
 - 1);

688 
	`GrLöe
(
bﬂrdwid
, 
bﬂrdgc
, 
row
 * 
xp
 - 1, 0,

689 
row
 * 
xp
 - 1, 
size
 * 
yp
 - 1);

691 
row
 = 0;Ñow < 
FULLSIZE
;Ñow++) {

692 
cﬁ
 = 0; cﬁ < 
FULLSIZE
; col++) {

693 
	`døw˚Œ
(
	`bﬂrdpos
(
row
, 
cﬁ
));

696 
	}
}

703 
	$døw˚Œ
(
POS
 
pos
)

705 
GR_COORD
 
x
;

706 
GR_COORD
 
y
;

707 
GR_SIZE
 
chwidth
;

708 
GR_SIZE
 
chheight
;

709 
GR_SIZE
 
chba£
;

710 
CELL
 
˚Œ
;

711 
GR_CHAR
 
ch
;

713 
˚Œ
 = 
bﬂrd
[
pos
];

714 i‡(!
	`isknown
(
˚Œ
))

717 
ch
 = 
	`di•œych¨
(
˚Œ
);

718 i‡(
ch
 =
F_WRONG
) {

719 
	`døwbomb
(
pos
, 
gªígc
, 
GR_FALSE
);

723 i‡(
	`isﬁd
(
˚Œ
)) {

724 
	`˛ór˚Œ
(
pos
);

725 
	`˚Œ˚¡î
(
pos
, &
x
, &
y
);

726 
	`GrGëGCTextSize
(
bﬂrdgc
, &
ch
, 1, 
GR_TFASCII
, &
chwidth
,

727 &
chheight
, &
chba£
);

728 
	`GrText
(
bﬂrdwid
, 
bﬂrdgc
, 
x
 - 
chwidth
 / 2 + 1,

729 
y
 + 
chheight
 / 2, &
ch
, 1, 
GR_TFBOTTOM
);

733 
	`døwbomb
(
pos
, 
ªdgc
, 
GR_FALSE
);

734 
	}
}

741 
	$˛ór˚Œ
(
POS
 
pos
)

743 
GR_COORD
 
row
;

744 
GR_COORD
 
cﬁ
;

746 
row
 = 
pos
 / 
FULLSIZE
;

747 
cﬁ
 = 
pos
 % 
FULLSIZE
;

748 
	`GrFûlRe˘
(
bﬂrdwid
, 
˛órgc
, 
cﬁ
 * 
xp
 - xp, 
row
 * 
yp
 - yp,

749 
xp
 - 1, 
yp
 - 1);

750 
	}
}

758 
	$døwbomb
(
POS
 
pos
, 
GR_GC_ID
 
gc
, 
GR_BOOL
 
™im©e
)

763 
GR_COORD
 
x
;

764 
GR_COORD
 
y
;

765 
GR_COUNT
 
cou¡
;

767 i‡(
™im©e
)

768 
	`wrôe
(1, "\007", 1);

770 
	`˚Œ˚¡î
(
pos
, &
x
, &
y
);

772 
cou¡
 = (
™im©e
 ? 8 : 1);

774 
	`GrFûlEŒù£
(
bﬂrdwid
, 
gc
, 
x
, 
y
, 
xp
 / 2 - 3, 
yp
 / 2 - 3);

775 i‡(--
cou¡
 == 0)

777 
	`dñay
();

778 
	`˛ór˚Œ
(
pos
);

779 
	`dñay
();

781 
	}
}

788 
	$døwbuâ⁄
(
GR_WINDOW_ID
 
wödow
, *
œbñ
)

790 
GR_SIZE
 
width
;

791 
GR_SIZE
 
height
;

792 
GR_SIZE
 
ba£
;

794 
	`GrGëGCTextSize
(
buâ⁄gc
, 
œbñ
, 
	`°æí
÷abñ), 
GR_TFASCII
, &
width
,

795 &
height
, &
ba£
);

796 
	`GrText
(
wödow
, 
buâ⁄gc
, (
BUTTONWIDTH
 - 
width
) / 2,

797 (
BUTTONHEIGHT
 - 
height
) / 2 + height - 1,

798 
œbñ
, -1, 
GR_TFBOTTOM
);

799 
	}
}

807 
	$£tcurs‹
()

809 
GR_BITMAP
 *
fgbôs
;

810 
GR_BITMAP
 *
bgbôs
;

812 
Àgs
) {

814 
fgbôs
 = 
nﬁeg_fg
;

815 
bgbôs
 = 
nﬁeg_bg
;

818 
fgbôs
 = 
⁄ñeg_fg
;

819 
bgbôs
 = 
⁄ñeg_bg
;

822 
fgbôs
 = 
twﬁegs_fg
;

823 
bgbôs
 = 
twﬁegs_bg
;

826 
	`GrSëCurs‹
(
bﬂrdwid
, 9, 12, 4, 6, 
WHITE
, 
BLACK
, 
fgbôs
, 
bgbôs
);

827 
	}
}

836 
	$dñay
()

838 
GR_COUNT
 
i
;

840 
i
 = 0; i < 1; i++) {

841 
	`GrFûlRe˘
(
bﬂrdwid
, 
dñaygc
, 0, 0, 
xp
 * 
size
 - 1,

842 
yp
 * 
size
 - 1);

843 
	`GrFlush
();

845 
	}
}

853 
	$˚Œ˚¡î
(
POS
 
pos
, 
GR_COORD
 *
ªtx
, GR_COORD *
ªty
)

855 *
ªtx
 = (
pos
 % 
FULLSIZE
Ë* 
xp
 - 1 - xp / 2;

856 *
ªty
 = (
pos
 / 
FULLSIZE
Ë* 
yp
 - 1 - yp / 2;

857 
	}
}

864 
	$døw°©us
()

866 
sc‹e
;

867 
Æl°ïs
;

868 
games
;

870 
sc‹e
 = 0;

871 
games
 = 
games0
[
ödex
];

872 
Æl°ïs
 = 
°ïs0
[
ödex
];

873 
sc‹e
 +
games1
[
ödex
];

874 
games
 +
games1
[
ödex
];

875 
Æl°ïs
 +
°ïs1
[
ödex
];

876 
sc‹e
 +
games2
[
ödex
] * 2;

877 
games
 +
games2
[
ödex
];

878 
Æl°ïs
 +
°ïs2
[
ödex
];

880 
	`¥öéöe
(0, "Size: %2d\n", 
size
);

881 
	`¥öéöe
(1, "Möes: %3d\n", 
möes
);

882 
PRINTSTEPS
;

883 
	`¥öéöe
(3, "Legs: %d\n", 
Àgs
);

885 
	`¥öéöe
(5, "W⁄ games: %3d\n", 
games2
[
ödex
]);

886 
	`¥öéöe
(6, "1-Àg games:%3d\n", 
games1
[
ödex
]);

887 
	`¥öéöe
(7, "Lo° games: %3d\n", 
games0
[
ödex
]);

889 i‡(
games
) {

890 
	`¥öéöe
(9, "Legs/game: %3d.%03d\n", 
sc‹e
 / 
games
,

891 ((
sc‹e
 * 1000Ë/ 
games
) % 1000);

893 
	`¥öéöe
(10, "Sãps/game:%3d.%03d\n", 
Æl°ïs
 / 
games
,

894 ((
Æl°ïs
 * 1000Ë/ 
games
) % 1000);

896 
	}
}

904 
	$¥öéöe
(
GR_COORD
 
row
, * 
fmt
, ...)

906 
va_li°
 
≠
;

907 
GR_COUNT
 
cc
;

908 
GR_SIZE
 
width
;

909 *
˝
;

910 
buf
[256];

912 
	`va_°¨t
(
≠
, 
fmt
);

913 
	`v•rötf
(
buf
, 
fmt
, 
≠
);

914 
	`va_íd
(
≠
);

916 i‡(
row
 >= 0) {

917 
ch¨xpos
 = 0;

918 
ch¨ypos
 = 
ch¨height
 * 
row
 + charheight - 1;

921 
˝
 = 
buf
;

923 
cc
 = 0;

924 
width
 = 0;

925 *
˝
 >= ' ') {

926 
width
 +
fi
.
widths
[()*
˝
++];

927 
cc
++;

929 i‡(
width
) {

930 
	`GrText
(
°©wid
, 
°©gc
, 
ch¨xpos
, 
ch¨ypos
,

931 
˝
 - 
cc
, cc, 
GR_TFBOTTOM
);

932 
ch¨xpos
 +
width
;

935 *
˝
++) {

939 
	`√wlöe
();

942 
ch¨xpos
 = 0;

946 
	}
}

954 
	$√wlöe
()

956 
	`GrFûlRe˘
(
°©wid
, 
bœckgc
, 
ch¨xpos
, 
ch¨ypos
 - 
ch¨height
 + 1,

957 
°©width
 - 
ch¨xpos
, 
ch¨height
);

958 
ch¨xpos
 = 0;

959 
ch¨ypos
 +
ch¨height
;

960 
	}
}

968 
POS


969 
	$föd˚Œ
(
GR_COORD
 
x
, GR_COORD 
y
)

971 
GR_COORD
 
row
;

972 
GR_COORD
 
cﬁ
;

974 i‡(((
x
 % 
xp
Ë=0Ë|| ((
y
 % 
yp
) == 0))

976 
row
 = (
y
 / 
yp
) + 1;

977 
cﬁ
 = (
x
 / 
xp
) + 1;

978 i‡((
row
 <0Ë|| (row > 
size
Ë|| (
cﬁ
 <= 0) || (col > size))

980  
	`bﬂrdpos
(
row
, 
cﬁ
);

981 
	}
}

988 
	$√wgame
()

990 
GR_COORD
 
row
;

991 
GR_COORD
 
cﬁ
;

992 
GR_COUNT
 
cou¡
;

993 
CELL
 
˚Œ
;

994 
POS
 
pos
;

996 
row
 = 0;Ñow < 
FULLSIZE
;Ñow++) {

997 
cﬁ
 = 0; cﬁ < 
FULLSIZE
; col++) {

998 
˚Œ
 = 
F_EMPTY
;

999 i‡(
	`badsqu¨e
(
row
Ë|| badsqu¨e(
cﬁ
))

1000 
˚Œ
 |
F_EDGE
;

1001 
bﬂrd
[
	`bﬂrdpos
(
row
, 
cﬁ
)] = 
˚Œ
;

1005 
∂ayög
 = 
GR_TRUE
;

1006 
cou¡
 = 0;

1007 
Àgs
 = 2;

1008 
°ïs
 = 0;

1009 
	`døw°©us
();

1010 
	`£tcurs‹
();

1012 
cou¡
 < 
möes
) {

1014 
row
 = (
	`ønd
(Ë/ 16Ë% (
size
 * size + 1);

1015 } 
row
 =(
size
 * size));

1017 
cﬁ
 = (
row
 % 
size
) + 1;

1018 
row
 = (row / 
size
) + 1;

1019 
pos
 = 
	`bﬂrdpos
(
row
, 
cﬁ
);

1021 i‡((
pos
 =
	`bﬂrdpos
(1,1)) || (pos == boardpos(1,2)) ||

1022 (
pos
 =
	`bﬂrdpos
(2,1)) || (pos == boardpos(2,2)) ||

1023 (
pos
 =
	`bﬂrdpos
(
size
,size)))

1026 i‡(!
	`ismöe
(
bﬂrd
[
pos
]Ë&& 
	`check∑th
(pos))

1027 
cou¡
++;

1030 
bﬂrd
[
	`bﬂrdpos
(1,1)] = (
F_OLD
 | '0');

1032 
	`GrCÀ¨Wödow
(
bﬂrdwid
, 
GR_TRUE
);

1033 
	}
}

1041 
GR_BOOL


1042 
	$check∑th
(
POS
 
pos
)

1044 
CELL
 *
bp
;

1045 
CELL
 *
ídbp
;

1046 
POS
 
ídpos
;

1047 
GR_COUNT
 
cou¡
;

1048 
GR_COUNT
 
i
;

1049 
GR_BOOL
 
m‹e
;

1056 
bﬂrd
[
pos
] |
F_MINE
;

1058 
cou¡
 = 0;

1060 
i
 = 7; i >= 0; i--) {

1061 i‡(
bﬂrd
[
pos
 + 
°ïèbÀ
[
i
]] & (
F_MINE
 | 
F_EDGE
))

1062 
cou¡
++;

1065 i‡(
cou¡
 < 2)

1066  
GR_TRUE
;

1072 
ídpos
 = 
	`bﬂrdpos
(
size
, size);

1073 
bp
 = &
bﬂrd
[
ídpos
];

1074 
ídbp
 = 
bp
;

1075 
bp
 !
bﬂrd
)

1076 *
bp
-- &~
F_REACH
;

1077 
bﬂrd
[
	`bﬂrdpos
(1,1)] |
F_REACH
;

1085 
m‹e
 = 
GR_FALSE
;

1086 
bp
 = &
bﬂrd
[
	`bﬂrdpos
(1,1)]; b∞!
ídbp
; bp++) {

1087 i‡(*
bp
 & 
F_REACH
) {

1088 
i
 = 7; i >= 0; i--) {

1089 i‡((
bp
[
°ïèbÀ
[
i
]] & (
F_MINE
 | 
F_REACH
 | 
F_EDGE
)) == 0) {

1090 
bp
[
°ïèbÀ
[
i
]] |
F_REACH
;

1091 
m‹e
 = 
GR_TRUE
;

1097 i‡(
bﬂrd
[
ídpos
] & 
F_REACH
)

1098  
GR_TRUE
;

1099 } 
m‹e
);

1104 
bﬂrd
[
pos
] &~
F_MINE
;

1106  
GR_FALSE
;

1107 
	}
}

1118 
	$movë›os
(
POS
 
√wpos
)

1120 
POS
 
fixpos
;

1121 
CELL
 
˚Œ
;

1122 
GR_COUNT
 
cou¡
;

1123 
GR_COUNT
 
i
;

1125 i‡((
√wpos
 < 0Ë|| (√wpo†>(
FULLSIZE
 * FULLSIZE)Ë|| !
∂ayög
)

1128 
˚Œ
 = 
bﬂrd
[
√wpos
];

1130 i‡(
	`i£dge
(
˚Œ
Ë|| (
	`is£í
(˚Œ)Ë|| 
	`isﬁd
(cell))

1133 
cou¡
 = 
	`isﬁd
(
˚Œ
);

1134 
i
 = 0; i < 8; i++)

1135 i‡(
	`isﬁd
(
bﬂrd
[
√wpos
 + 
°ïèbÀ
[
i
]]))

1136 
cou¡
++;

1138 i‡(
cou¡
 <= 0)

1141 
˚Œ
 = (˚Œ & 
F_FLAGS
Ë| 
F_OLD
;

1142 
°ïs
++;

1144 
PRINTSTEPS
;

1146 i‡(
	`ismöe
(
˚Œ
)) {

1147 
Àgs
--;

1148 
bﬂrd
[
√wpos
] = (
F_REMEMBER
 | 
F_MINE
);

1149 
˚Œ
 = (
F_EMPTY
 | 
F_OLD
);

1150 
bﬂrd
[
√wpos
] = 
˚Œ
;

1151 
	`døwbomb
(
√wpos
, 
ªdgc
, 
GR_TRUE
);

1152 
	`˛ór˚Œ
(
√wpos
);

1153 
	`£tcurs‹
();

1154 
i
 = 0; i < 8; i++) {

1155 
fixpos
 = 
√wpos
 + 
°ïèbÀ
[
i
];

1156 i‡(
	`isﬁd
(
bﬂrd
[
fixpos
])) {

1157 
bﬂrd
[
fixpos
]--;

1158 
	`døw˚Œ
(
fixpos
);

1161 
	`døw°©us
();

1164 
cou¡
 = 0;

1165 
i
 = 0; i < 8; i++)

1166 i‡(
	`ismöe
(
bﬂrd
[
√wpos
 + 
°ïèbÀ
[
i
]]))

1167 
cou¡
++;

1168 
bﬂrd
[
√wpos
] = 
˚Œ
 | (
cou¡
 + '0');

1170 
	`døw˚Œ
(
√wpos
);

1172 i‡((
Àgs
 <0Ë|| (
√wpos
 =
	`bﬂrdpos
(
size
,size)))

1173 
	`gameovî
();

1174 
	}
}

1182 
	$toggÀ˚Œ
(
POS
 
pos
)

1184 
CELL
 
˚Œ
;

1186 i‡((
pos
 <0Ë|| !
∂ayög
)

1189 
˚Œ
 = 
bﬂrd
[
pos
];

1190 i‡(
	`isknown
(
˚Œ
)) {

1191 i‡(!
	`is£í
(
˚Œ
))

1193 
bﬂrd
[
pos
] = (bﬂrd[pos] & 
F_FLAGS
Ë| 
F_EMPTY
;

1194 
	`˛ór˚Œ
(
pos
);

1198 
bﬂrd
[
pos
] = (bﬂrd[pos] & 
F_FLAGS
Ë| 
F_REMEMBER
;

1199 
	`døw˚Œ
(
pos
);

1200 
	}
}

1208 
	$gameovî
()

1210 
POS
 
pos
;

1211 
CELL
 
˚Œ
;

1213 
∂ayög
 = 
GR_FALSE
;

1214 
Àgs
) {

1216 
games0
[
ödex
]++;

1217 
°ïs0
[
ödex
] +
°ïs
;

1220 
games1
[
ödex
]++;

1221 
°ïs1
[
ödex
] +
°ïs
;

1224 
games2
[
ödex
]++;

1225 
°ïs2
[
ödex
] +
°ïs
;

1229 
pos
 = 0;Öo†< (
FULLSIZE
 * FULLSIZE);Öos++) {

1230 
˚Œ
 = 
bﬂrd
[
pos
];

1231 i‡(
	`is£í
(
˚Œ
))

1232 
˚Œ
 = (˚Œ & 
F_FLAGS
Ë| 
F_WRONG
;

1233 i‡(
	`ismöe
(
˚Œ
))

1234 
˚Œ
 = (˚Œ & 
F_FLAGS
Ë| 
F_REMEMBER
;

1235 
bﬂrd
[
pos
] = 
˚Œ
;

1238 
	`døwbﬂrd
();

1239 
	`døw°©us
();

1240 
	}
}

1249 
	$födödex
()

1251 
ödex
 = 0; index < 
MAXPARAMS
; index++) {

1252 i‡((
sizï¨am
[
ödex
] =
size
Ë&& (
möï¨am
[ödex] =
möes
))

1255 
ödex
 = 0; index < 
MAXPARAMS
; index++) {

1256 i‡(
sizï¨am
[
ödex
] == 0) {

1257 
sizï¨am
[
ödex
] = 
size
;

1258 
möï¨am
[
ödex
] = 
möes
;

1262 
	`Ârötf
(
°dîr
, "Too manyÖarameters in save file\n");

1263 
	`exô
(1);

1264 
	}
}

1272 
	$ªadgame
(*
«me
)

1274 
fd
;

1276 
fd
 = -1;

1277 i‡(
«me
)

1278 
fd
 = 
	`›í
(
«me
, 0);

1280 i‡(
fd
 < 0) {

1281 
magic
 = 
MAGIC
;

1282 
size
 = 
SIZE
;

1283 
möes
 = (
size
 * sizê* 
MINEPERCENT
) / 100;

1284 
∂ayög
 = 
GR_FALSE
;

1288 i‡(
	`ªad
(
fd
, &
°
, (st)) != (st))

1289 
magic
 = 0;

1290 
	`˛o£
(
fd
);

1292 i‡((
magic
 !
MAGIC
Ë|| (
size
 > 
MAXSIZE
)) {

1293 
	`Ârötf
(
°dîr
, "Save file format is incorrect\n");

1294 
	`exô
(1);

1296 
	}
}

1303 
GR_BOOL


1304 
	$wrôegame
(*
«me
)

1306 
fd
;

1308 i‡(
«me
 =
NULL
)

1309  
GR_TRUE
;

1311 
fd
 = 
	`¸ót
(
«me
, 0666);

1312 i‡(
fd
 < 0)

1313  
GR_TRUE
;

1315 i‡(
	`wrôe
(
fd
, &
°
, (st)) != (st)) {

1316 
	`˛o£
(
fd
);

1317  
GR_TRUE
;

1319 
	`˛o£
(
fd
);

1320  
GR_FALSE
;

1321 
	}
}

	@demos/nanox/launcher.c

56 
	~<time.h
>

57 
	~<°dio.h
>

58 
	~<î∫o.h
>

59 
	~<°dlib.h
>

60 
	~<°rög.h
>

61 
	~<˘y≥.h
>

62 
	~<sig«l.h
>

63 
	~<uni°d.h
>

64 
	~<sys/waô.h
>

66 
	~<«no-X.h
>

67 
	~<nxcﬁ‹s.h
>

69 
	~"œunchî.h
"

72 
pid_t
 
	gs•id
;

74 #i‚de‡
WAIT_ANY


78 
	#WAIT_ANY
 (
pid_t
)-1

	)

81 
	$ª≠î
(
signum
) {

82 
pid_t
 
pid
;

84 (
pid
 = 
	`waôpid
(
WAIT_ANY
, 
NULL
, 
WNOHANG
) > 0))

85 if(
pid
 =
s•id
) sspid = -1;

86 
	}
}

88 *
	$my_mÆloc
(
size_t
 
size
)

90 *
ªt
;

92 if(!(
ªt
 = 
	`mÆloc
(
size
))) {

93 
	`Ârötf
(
°dîr
, "Out of memory\n");

94 
	`exô
(1);

97  
ªt
;

98 
	}
}

100 
	$ußge
()

102 
	`Ârötf
(
°dîr
, "Usage:Üauncher <config-file>\n");

103 
	`exô
(3);

104 
	}
}

106 
	$‰ì_¥og_ôem
(
¥og_ôem
 *
¥og
)

108 
n
;

110 
n
 = 0;Ç < 
MAX_ARGUMENTS
;Ç++)

111 if(
¥og
->
¨gv
[
n
]Ë
	`‰ì
(prog->argv[n]);

112 
	`‰ì
(
¥og
->
comm™d
);

113 
	`‰ì
(
¥og
);

114 
	}
}

116 
¥og_ôem
 *
	$make_¥og_ôem
(*
buf
, 
löío
)

118 *
p
, *
µ
, *
comm™d
;

119 
¥og_ôem
 *
¥og
;

120 
n
;

122 
p
 = 
buf
;

124 
¥og
 = 
	`my_mÆloc
((
¥og_ôem
));

126 
n
 = 0;Ç < 
MAX_ARGUMENTS
;Ç++Ë
¥og
->
¨gv
[n] = 
NULL
;

128 
	`is•a˚
(*
p
))Ö++;

129 if(!*
p
) {

130 
	`Ârötf
(
°dîr
, "PrematureÉnd ofÜine onÜine %d of config "

131 "fûe\n", 
löío
);

134 
comm™d
 = 
p
;

135 *
p
 && (!
	`is•a˚
(*p)))Ö++;

136 *
p
++ = 0;

137 if(!(
¥og
->
comm™d
 = 
	`°rdup
(command))) {

138 
	`‰ì
(
¥og
);

139 
nomem
;

141 
µ
 = 
p
 - 1;

142 --
µ
 !
comm™d
) {

143 if(*
µ
 == '/') {

144 
µ
++;

148 if(!(
¥og
->
¨gv
[0] = 
	`°rdup
(
µ
))) {

149 
	`‰ì
(
¥og
->
comm™d
);

150 
	`‰ì
(
¥og
);

151 
nomem
;

154 
n
 = 1;

155 *
p
) {

156 
	`is•a˚
(*
p
))Ö++;

157 if(!*
p
) ;

158 
µ
 = 
p
;

159 *
p
 && (!
	`is•a˚
(*p)))Ö++;

160 *
p
++ = 0;

161 if(!(
¥og
->
¨gv
[
n
] = 
	`°rdup
(
µ
))Ë
nomem
;

162 if(++
n
 =(
MAX_ARGUMENTS
 - 1)) {

163 
	`Ârötf
(
°dîr
, "Too manyárguments onÜine "

164 "%d o‡thêc⁄fig fûe\n", 
löío
);

169  
¥og
;

171 
nomem
:

172 
	`Ârötf
(
°dîr
, "Out of memoryÖarsingÜine %d ofÅhe config "

173 "fûe\n", 
löío
);

175 
	}
}

177 
	$£t_wödow_background_cﬁour
(*
buf
, 
löío
)

179 
GR_WM_PROPERTIES
 
¥›s
;

180 *
p
 = 
buf
, *
µ
;

182 
	`is•a˚
(*
p
))Ö++;

183 if(!*
p
) {

184 
	`Ârötf
(
°dîr
, "PrematureÉnd ofÜine onÜine %d of config "

185 "fûe\n", 
löío
);

188 
µ
 = 
p
;

189 *
p
 && (!
	`is•a˚
(*p)))Ö++;

190 *
p
 = 0;

194 if(!
	`°rcmp
(
µ
, "BLACK")Ë
¥›s
.
background
 = 
GR_COLOR_BLACK
;

195 if(!
	`°rcmp
(
µ
, "WHITE")Ë
¥›s
.
background
 = 
GR_COLOR_WHITE
;

196 if(!
	`°rcmp
(
µ
, "RED")Ë
¥›s
.
background
 = 
GR_COLOR_RED
;

197 if(!
	`°rcmp
(
µ
, "GREEN")Ë
¥›s
.
background
 = 
GR_COLOR_GREEN
;

198 if(!
	`°rcmp
(
µ
, "BLUE")Ë
¥›s
.
background
 = 
GR_COLOR_BLUE
;

199 if(!
	`°rcmp
(
µ
, "CYAN")Ë
¥›s
.
background
 = 
GR_COLOR_CYAN
;

200 if(!
	`°rcmp
(
µ
, "MAGENTA")Ë
¥›s
.
background
 = 
GR_COLOR_MAGENTA
;

201 if(!
	`°rcmp
(
µ
, "YELLOW")Ë
¥›s
.
background
 = 
GR_COLOR_YELLOW
;

202 if(!
	`°rcmp
(
µ
, "BROWN")Ë
¥›s
.
background
 = 
GR_COLOR_BROWN
;

203 if(!
	`°rcmp
(
µ
, "GRAY")Ë
¥›s
.
background
 = 
GR_COLOR_GRAY
;

205 
	`Ârötf
(
°dîr
, "Invalid colour \"%s\" onÜine %d of config "

206 "fûe\n", 
µ
, 
löío
);

210 
¥›s
.
Êags
 = 
GR_WM_FLAGS_BACKGROUND
;

211 
	`GrSëWMPr›îtõs
(
GR_ROOT_WINDOW_ID
, &
¥›s
);

212 
	}
}

214 
	$∑r£_c⁄fig_löe
(
l°©e
 *
°©e
, *
buf
, 
löío
)

216 *
p
, *
µ
, *
«me
, *
ic⁄
;

217 
n
;

218 
lôem
 *
√w_lôem
, *
li
;

219 
ssôem
 *
√w_ssôem
, *
tmp_ssôem
;

220 
°ôem
 *
√w_°ôem
, *
tmp_°ôem
;

221 
GR_IMAGE_INFO
 
imageöfo
;

223 
p
 = 
buf
;

225 if((!*
p
) || (*p == '#') || (*p == '\n')) ;

227 
	`is•a˚
(*
p
))Ö++;

228 
«me
 = 
p
;

229 *
p
 && (!
	`is•a˚
(*p)))Ö++;

230 if(!*
p
Ë
¥em©uª
;

231 *
p
++ = 0;

233 if(!
	`°rcmp
(
«me
, "$screensaver")) {

234 
√w_ssôem
 = 
	`my_mÆloc
((
ssôem
));

235 if(!(
√w_ssôem
->
¥og
 = 
	`make_¥og_ôem
(
p
, 
löío
))) {

236 
	`‰ì
(
√w_ssôem
);

239 
°©e
->
numssôems
++;

240 
√w_ssôem
->
√xt
 = 
NULL
;

241 if(!
°©e
->
ssôems
Ë°©e->ssôem†
√w_ssôem
;

243 
tmp_ssôem
 = 
°©e
->
ssôems
;

244 
tmp_ssôem
->
√xt
)Åmp_ssitem =Åmp_ssitem->next;

245 
tmp_ssôem
->
√xt
 = 
√w_ssôem
;

248 } if(!
	`°rcmp
(
«me
, "$startup")) {

249 
√w_°ôem
 = 
	`my_mÆloc
((
°ôem
));

250 if(!(
√w_°ôem
->
¥og
 = 
	`make_¥og_ôem
(
p
, 
löío
))) {

251 
	`‰ì
(
√w_°ôem
);

254 
√w_°ôem
->
√xt
 = 
NULL
;

255 if(!
°©e
->
°ôems
Ë°©e->°ôem†
√w_°ôem
;

257 
tmp_°ôem
 = 
°©e
->
°ôems
;

258 
tmp_°ôem
->
√xt
)Åmp_stitem =Åmp_stitem->next;

259 
tmp_°ôem
->
√xt
 = 
√w_°ôem
;

262 } if(!
	`°rcmp
(
«me
, "$screensaver_timeout")) {

263 
n
 = 
	`°πﬁ
(
p
, 
NULL
, 10);

264 
	`GrSëS¸ìnSavîTimeout
(
n
);

266 } if(!
	`°rcmp
(
«me
, "$screensaver_rotate_time")) {

267 
°©e
->
rŸ©ess
 = 
	`°πﬁ
(
p
, 
NULL
, 10);

269 } if(!
	`°rcmp
(
«me
, "$random_screensaver")) {

270 
	`§™d
(
	`time
(0));

271 
°©e
->
øndomss
 = 1;

273 } if(!
	`°rcmp
(
«me
, "$window_background_image")) {

274 
	`is•a˚
(*
p
))Ö++;

275 if(!*
p
Ë
¥em©uª
;

276 
µ
 = 
p
;

277 *
p
 && (!
	`is•a˚
(*p)))Ö++;

278 *
p
 = 0;

279 
°©e
->
wödow_background_image
 = 
	`°rdup
(
µ
);

281 } if(!
	`°rcmp
(
«me
, "$window_background_mode")) {

282 
°©e
->
wödow_background_mode
 = (Ë
	`°πﬁ
(
p
, 
NULL
, 10);

284 } if(!
	`°rcmp
(
«me
, "$window_background_colour")) {

285 
	`£t_wödow_background_cﬁour
(
p
, 
löío
);

289 
	`is•a˚
(*
p
))Ö++;

290 if(!*
p
Ë
¥em©uª
;

291 
ic⁄
 = 
p
;

292 *
p
 && (!
	`is•a˚
(*p)))Ö++;

293 if(!*
p
Ë
¥em©uª
;

294 *
p
++ = 0;

296 
√w_lôem
 = 
	`my_mÆloc
((
lôem
));

297 if(!(
√w_lôem
->
«me
 = 
	`°rdup
(name))) {

298 
	`‰ì
(
√w_lôem
);

299 
nomem
;

301 if(!(
√w_lôem
->
ic⁄
 = 
	`°rdup
(icon))) {

302 
	`‰ì
(
√w_lôem
->
«me
);

303 
	`‰ì
(
√w_lôem
);

304 
nomem
;

306 if(!(
√w_lôem
->
¥og
 = 
	`make_¥og_ôem
(
p
, 
löío
))) {

307 
	`‰ì
(
√w_lôem
->
«me
);

308 
	`‰ì
(
√w_lôem
->
ic⁄
);

309 
	`‰ì
(
√w_lôem
);

312 
√w_lôem
->
ic⁄id
 = 0;

313 if(
	`°rcmp
("-", 
ic⁄
)) {

314 
li
 = 
°©e
->
lôems
;

315 
li
) {

316 if(!(
	`°rcmp
(
ic⁄
, 
li
->
«me
))) {

317 
√w_lôem
->
ic⁄id
 = 
li
->iconid;

320 
li
 =Üi->
√xt
;

322 if(!
√w_lôem
->
ic⁄id
) {

323 if(!(
√w_lôem
->
ic⁄id
 = 
	`GrLﬂdImageFromFûe
(
ic⁄
, 0))){

324 
	`Ârötf
(
°dîr
, "Couldn'tÜoad icon \"%s\"\n",

325 
ic⁄
);

327 
	`GrGëImageInfo
(
√w_lôem
->
ic⁄id
, &
imageöfo
);

328 if((
imageöfo
.
width
 !
ICON_WIDTH
) ||

329 (
imageöfo
.
height
 !
ICON_HEIGHT
)) {

330 
	`Ârötf
(
°dîr
, "Icon \"%s\" isÅhe "

332 "\n", 
ic⁄
, 
imageöfo
.
width
,

333 
imageöfo
.
height
, 
ICON_WIDTH
,

334 
ICON_HEIGHT
);

335 
	`GrFªeImage
(
√w_lôem
->
ic⁄id
);

336 
√w_lôem
->
ic⁄id
 = 0;

342 
√w_lôem
->
¥ev
 = 
NULL
;

343 
√w_lôem
->
√xt
 = 
NULL
;

344 if(!
°©e
->
lôems
) {

345 
°©e
->
œ°lôem
 = 
√w_lôem
;

346 
°©e
->
lôems
 = 
√w_lôem
;

348 
√w_lôem
->
√xt
 = 
°©e
->
lôems
;

349 
°©e
->
lôems
->
¥ev
 = 
√w_lôem
;

350 
°©e
->
lôems
 = 
√w_lôem
;

353 
°©e
->
numlôems
++;

357 
nomem
:

358 
	`Ârötf
(
°dîr
, "Out of memory\n");

359 
	`exô
(1);

361 
¥em©uª
:

362 
	`Ârötf
(
°dîr
, "PrematureÉnd ofÜine onÜine %d of config file\n",

363 
löío
);

364 
	}
}

366 
	$ªad_c⁄fig
(
l°©e
 *
°©e
)

368 
löío
 = 1;

369 
FILE
 *
Â
;

370 *
buf
 = 
	`my_mÆloc
(256);

372 if(!(
Â
 = 
	`f›í
(
°©e
->
c⁄fig_fûe
, "r"))) {

373 
	`Ârötf
(
°dîr
, "Couldn't open config file \"%s\"\n",

374 
°©e
->
c⁄fig_fûe
);

375 
	`exô
(2);

378 
°©e
->
lôems
 = 
NULL
;

379 
°©e
->
numlôems
 = 0;

380 
°©e
->
ssôems
 = 
NULL
;

381 
°©e
->
øndomss
 = 0;

382 
°©e
->
numssôems
 = 0;

383 
°©e
->
°ôems
 = 
NULL
;

384 
°©e
->
rŸ©ess
 = 0;

386 
	`fgës
(
buf
, 256, 
Â
)) {

387 
	`∑r£_c⁄fig_löe
(
°©e
, 
buf
, 
löío
);

388 
löío
++;

391 
	`f˛o£
(
Â
);

392 
	`‰ì
(
buf
);

394 if(
°©e
->
øndomss
Ë
	`choo£_øndom_s¸ìnßvî
(state);

395 
°©e
->
curssôem
 = sèã->
ssôems
;

397 if(!
°©e
->
numlôems
) {

398 
	`Ârötf
(
°dîr
, "No validÜauncher items in config file\n");

399 
	`exô
(5);

401 
	}
}

403 
	$døw_ôem
(
l°©e
 *
°©e
, 
lôem
 *
ôem
)

405 
GR_SIZE
 
width
, 
height
, 
ba£
, 
x
, 
Àn
;

407 
	`GrDøwImageToFô
(
ôem
->
wid
, 
°©e
->
gc
, 
ICON_X_POSITION
, 
ICON_Y_POSITION
,

408 
ICON_WIDTH
, 
ICON_HEIGHT
, 
ôem
->
ic⁄id
);

410 
Àn
 = 
	`°æí
(
ôem
->
«me
);

411 
	`GrGëGCTextSize
(
°©e
->
gc
, 
ôem
->
«me
, 
Àn
, 0, &
width
, &
height
, &
ba£
);

412 if(
width
 >
ITEM_WIDTH
Ë
x
 = 0;

413 
x
 = (
ITEM_WIDTH
 - 
width
) / 2;

415 
	`GrText
(
ôem
->
wid
, 
°©e
->
gc
, 
x
, 
TEXT_Y_POSITION
, iãm->
«me
, 
Àn
, 0);

416 
	}
}

418 
	$h™dÀ_exposuª_evít
(
l°©e
 *
°©e
)

420 
GR_EVENT_EXPOSURE
 *
evít
 = &
°©e
->evít.
exposuª
;

421 
lôem
 *
i
 = 
°©e
->
lôems
;

423 if(
evít
->
wid
 =
°©e
->
maö_wödow
) ;

425 
i
) {

426 if(
evít
->
wid
 =
i
->wid) {

427 
	`døw_ôem
(
°©e
, 
i
);

430 
i
 = i->
√xt
;

433 
	`Ârötf
(
°dîr
, "GotÉxposureÉvent for unknown window %d\n",

434 
evít
->
wid
);

435 
	}
}

437 
pid_t
 
	$œunch_¥ogøm
(
¥og_ôem
 *
¥og
)

439 
pid_t
 
pid
;

441 if((
pid
 = 
	`f‹k
()Ë=-1Ë
	`≥º‹
("Couldn't fork");

442 if(!
pid
) {

443 if(
	`execvp
(
¥og
->
comm™d
,Örog->
¨gv
) == -1)

444 
	`Ârötf
(
°dîr
, "Couldn't start \"%s\": %s\n",

445 
¥og
->
comm™d
, 
	`°ªº‹
(
î∫o
));

446 
	`exô
(7);

449  
pid
;

450 
	}
}

452 
	$h™dÀ_mou£_evít
(
l°©e
 *
°©e
)

454 
GR_EVENT_MOUSE
 *
evít
 = &
°©e
->evít.
mou£
;

455 
lôem
 *
i
 = 
°©e
->
lôems
;

457 if(
evít
->
wid
 =
°©e
->
maö_wödow
) ;

459 
i
) {

460 if(
evít
->
wid
 =
i
->wid) {

461 
	`œunch_¥ogøm
(
i
->
¥og
);

464 
i
 = i->
√xt
;

467 
	`Ârötf
(
°dîr
, "GŸ mou£Évíàf‹ unknow¿wödow %d\n", 
evít
->
wid
);

468 
	}
}

470 
	$choo£_øndom_s¸ìnßvî
(
l°©e
 *
°©e
)

472 
i
;

473 
ssôem
 *
s
;

475 if(!
°©e
->
numssôems
) ;

478 
i
 = 
	`ønd
(Ë% 
°©e
->
numssôems
;

479 
s
 = 
°©e
->
ssôems
;

480 
i
--Ë
s
 = s->
√xt
;

481 } 
s
 =
°©e
->
curssôem
);

483 
°©e
->
curssôem
 = 
s
;

484 
	}
}

486 
	$a˘iv©e_s¸ìnßvî
(
l°©e
 *
°©e
)

488 
s•id
 = 
	`œunch_¥ogøm
(
°©e
->
curssôem
->
¥og
);

490 if(
°©e
->
øndomss
Ë
	`choo£_øndom_s¸ìnßvî
(state);

492 
°©e
->
curssôem
 = sèã->curssôem->
√xt
;

493 if(!
°©e
->
curssôem
Ë°©e->curssôem = sèã->
ssôems
;

495 
	}
}

497 
	$dó˘iv©e_s¸ìnßvî
(
l°©e
 *
°©e
)

499 if(
s•id
 >0Ë
	`kûl
(s•id, 
SIGINT
);

500 
	}
}

502 
	$h™dÀ_s¸ìnßvî_evít
(
l°©e
 *
°©e
)

504 
GR_EVENT_SCREENSAVER
 *
evít
 = &
°©e
->evít.
s¸ìnßvî
;

506 if(
evít
->
a˘iv©e
 !
GR_TRUE
) {

507 if(
°©e
->
s§Ÿ©ëimî
 > 0)

508 
	`GrDe°royTimî
(
°©e
->
s§Ÿ©ëimî
);

512 if(!
°©e
->
ssôems
) {

513 
	`Ârötf
(
°dîr
, "Got screensaveráctivateÉvent withÇo "

518 
	`a˘iv©e_s¸ìnßvî
(
°©e
);

520 if(
°©e
->
rŸ©ess
) {

521 
°©e
->
s§Ÿ©ëimî
 = 
	`GrCª©eTimî
(°©e->
maö_wödow
,

522 
°©e
->
rŸ©ess
 * 1000 );

523 } 
°©e
->
s§Ÿ©ëimî
 = -1;

524 
	}
}

526 
	$h™dÀ_timî_evít
(
l°©e
 *
°©e
)

528 
GR_EVENT_TIMER
 *
evít
 = &
°©e
->evít.
timî
;

530 if(
evít
->
tid
 !
°©e
->
s§Ÿ©ëimî
) ;

532 
	`dó˘iv©e_s¸ìnßvî
(
°©e
);

533 
	`a˘iv©e_s¸ìnßvî
(
°©e
);

534 
	}
}

536 
	$h™dÀ_evít
(
l°©e
 *
°©e
)

538 
°©e
->
evít
.
ty≥
) {

539 
GR_EVENT_TYPE_EXPOSURE
:

540 
	`h™dÀ_exposuª_evít
(
°©e
);

542 
GR_EVENT_TYPE_BUTTON_DOWN
:

543 
	`h™dÀ_mou£_evít
(
°©e
);

545 
GR_EVENT_TYPE_CLOSE_REQ
:

547 
GR_EVENT_TYPE_SCREENSAVER
:

548 
	`h™dÀ_s¸ìnßvî_evít
(
°©e
);

550 
GR_EVENT_TYPE_TIMER
:

551 
	`h™dÀ_timî_evít
(
°©e
);

553 
GR_EVENT_TYPE_NONE
:

556 
	`Ârötf
(
°dîr
, "Got unknownÉventÅype %d\n",

557 
°©e
->
evít
.
ty≥
);

560 
	}
}

562 
	$do_evít_lo›
(
l°©e
 *
°©e
)

565 
	`GrGëNextEvít
(&
°©e
->
evít
);

566 
	`h™dÀ_evít
(
°©e
);

567 } 
°©e
->
evít
.
ty≥
 !
GR_EVENT_TYPE_CLOSE_REQ
);

568 
	}
}

570 
	$do_°¨tups
(
l°©e
 *
°©e
)

572 
°ôem
 *
tmp
, *
°
 = 
°©e
->
°ôems
;

574 
°
) {

575 
	`œunch_¥ogøm
(
°
->
¥og
);

576 
tmp
 = 
°
;

577 
°
 = st->
√xt
;

578 
	`‰ì_¥og_ôem
(
tmp
->
¥og
);

579 
	`‰ì
(
tmp
);

581 
	}
}

583 
	$öôüli£
(
l°©e
 *
°©e
)

585 
GR_SCREEN_INFO
 
si
;

586 
GR_IMAGE_ID
 
back_image
;

587 
GR_IMAGE_INFO
 
imageöfo
;

588 
rows
 = 1, 
cﬁumns
 = 1, 
width
, 
height
, 
x
 = 0, 
y
 = 0;

589 
GR_WM_PROPERTIES
 
¥›s
;

590 
lôem
 *
i
;

592 if(
	`GrO≥n
() < 0) {

593 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

594 
	`exô
(4);

597 
°©e
->
wödow_background_mode
 = 0;

598 
°©e
->
wödow_background_image
 = 
NULL
;

599 
s•id
 = -1;

601 
	`ªad_c⁄fig
(
°©e
);

603 
	`GrGëS¸ìnInfo
(&
si
);

605 if(
si
.
rows
 > si.
cﬁs
) {

606 
rows
 = 
°©e
->
numlôems
;

607 (((
rows
 / 
cﬁumns
Ë+Ñow†% cﬁumnsË* 
ITEM_HEIGHT
) >

608 
si
.
rows
) {

609 
cﬁumns
++;

611 if((
cﬁumns
 * 
ITEM_WIDTH
Ë> 
si
.
cﬁs
Ë
toom™y
;

612 
rows
 = (row†/ 
cﬁumns
) + (rows % columns);

613 
width
 = 
cﬁumns
 * 
ITEM_WIDTH
 + 1 + columns;

614 
height
 = 
rows
 * 
ITEM_HEIGHT
 + 1 +Ñows;

616 
cﬁumns
 = 
°©e
->
numlôems
;

617 (((
cﬁumns
 / 
rows
Ë+ (cﬁumn†%Ñows)Ë* 
ITEM_WIDTH
) >

618 
si
.
cﬁs
) {

619 
rows
++;

621 if((
rows
 * 
ITEM_HEIGHT
Ë> 
si
.rowsË
toom™y
;

622 
cﬁumns
 = (cﬁumn†/ 
rows
) + (columns %Ñows);

623 
width
 = 
cﬁumns
 * 
ITEM_WIDTH
 + 1 + columns;

624 
height
 = (
rows
 * 
ITEM_HEIGHT
) + 1 +Ñows;

625 
y
 = 
si
.
rows
 - (row†* 
ITEM_HEIGHT
) - 1 -Ñows;

628 
°©e
->
gc
 = 
	`GrNewGC
();

629 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
ITEM_TEXT_COLOUR
);

630 
	`GrSëGCBackground
(
°©e
->
gc
, 
ITEM_BACKGROUND_COLOUR
);

632 if(
°©e
->
wödow_background_image
) {

633 if(!(
back_image
 = 
	`GrLﬂdImageFromFûe
(

634 
°©e
->
wödow_background_image
, 0))) {

635 
	`Ârötf
(
°dîr
, "Couldn'tÜoad background image\n");

637 
	`GrGëImageInfo
(
back_image
, &
imageöfo
);

638 if(!(
°©e
->
background_pixm≠
 = 
	`GrNewPixm≠
(

639 
imageöfo
.
width
,

640 
imageöfo
.
height
, 
NULL
))) {

641 
	`Ârötf
(
°dîr
, "Couldn'tállocateÖixmap "

644 
	`GrDøwImageToFô
(
°©e
->
background_pixm≠
,

645 
°©e
->
gc
, 0, 0, 
imageöfo
.
width
,

646 
imageöfo
.
height
, 
back_image
);

647 
	`GrFªeImage
(
back_image
);

648 
	`GrSëBackgroundPixm≠
(
GR_ROOT_WINDOW_ID
,

649 
°©e
->
background_pixm≠
,

650 
°©e
->
wödow_background_mode
);

651 
	`GrCÀ¨Wödow
(
GR_ROOT_WINDOW_ID
, 
GR_TRUE
);

656 if(
°©e
->
ssôems
)

657 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_SCREENSAVER
);

659 
°©e
->
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 
y
, 
width
, 
height
,

660 0, 
ITEM_BACKGROUND_COLOUR
, 0);

661 
	`GrSñe˘Evíts
(
°©e
->
maö_wödow
, 
GR_EVENT_MASK_CLOSE_REQ
 |

662 
GR_EVENT_MASK_TIMER
);

663 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

664 
¥›s
.¥›†
GR_WM_PROPS_NOMOVE
 | 
GR_WM_PROPS_NODECORATE
 |

665 
GR_WM_PROPS_NOAUTOMOVE
 | 
GR_WM_PROPS_NOAUTORESIZE
;

666 
	`GrSëWMPr›îtõs
(
°©e
->
maö_wödow
, &
¥›s
);

668 
i
 = 
°©e
->
œ°lôem
;

669 
y
 = 0;

670 
i
) {

671 
i
->
wid
 = 
	`GrNewWödow
(
°©e
->
maö_wödow
,

672 (
x
 * 
ITEM_WIDTH
) + x + 1,

673 (
y
 * 
ITEM_HEIGHT
Ë+ y + 1, 
ITEM_WIDTH
,

674 
ITEM_HEIGHT
, 1, 
ITEM_BACKGROUND_COLOUR
,

675 
ITEM_BORDER_COLOUR
);

676 
	`GrSñe˘Evíts
(
i
->
wid
, 
GR_EVENT_MASK_EXPOSURE
 |

677 
GR_EVENT_MASK_BUTTON_DOWN
);

678 
	`GrM≠Wödow
(
i
->
wid
);

679 
i
 = i->
¥ev
;

680 if(++
x
 =
cﬁumns
) {

681 
x
 = 0;

682 
y
++;

686 
	`GrM≠Wödow
(
°©e
->
maö_wödow
);

688 
	`sig«l
(
SIGCHLD
, &
ª≠î
);

690 
	`do_°¨tups
(
°©e
);

694 
toom™y
:

695 
	`Ârötf
(
°dîr
, "Too many itemsÅo fit on screen\n");

696 
	`exô
(6);

697 
	}
}

699 
	$maö
(
¨gc
, *
¨gv
[])

701 
l°©e
 *
°©e
;

703 if(
¨gc
 !2Ë
	`ußge
();

705 
°©e
 = 
	`my_mÆloc
((
l°©e
));

706 
°©e
->
c⁄fig_fûe
 = 
	`°rdup
(
¨gv
[1]);

708 
	`öôüli£
(
°©e
);

710 
	`do_evít_lo›
(
°©e
);

712 
	`GrClo£
();

715 
	}
}

	@demos/nanox/launcher.h

32 #i‚de‡
LAUNCHER_H


33 
	#LAUNCHER_H


	)

35 
	#ITEM_WIDTH
 100

	)

36 
	#ITEM_HEIGHT
 60

	)

37 
	#ITEM_TEXT_COLOUR
 
GR_COLOR_BLACK


	)

38 
	#ITEM_BORDER_COLOUR
 
GR_COLOR_BLACK


	)

39 
	#ITEM_BACKGROUND_COLOUR
 
GR_COLOR_GRAY80


	)

40 
	#ICON_WIDTH
 32

	)

41 
	#ICON_HEIGHT
 32

	)

42 
	#ICON_X_POSITION
 ((
ITEM_WIDTH
 - 
ICON_WIDTH
Ë/ 2)

	)

43 
	#ICON_Y_POSITION
 6

	)

44 
	#TEXT_Y_POSITION
 (
ITEM_HEIGHT
 - 6)

	)

45 
	#MAX_ARGUMENTS
 12

	)

47 
	scomm™d_¨gv
 {

48 *
	mcomm™d
;

49 *
	m¨gv
[
MAX_ARGUMENTS
];

51 
comm™d_¨gv
 
	t¥og_ôem
;

53 
	sœunchî_ôem
 {

54 *
	m«me
;

55 *
	mic⁄
;

56 
¥og_ôem
 *
	m¥og
;

57 
œunchî_ôem
 *
	m√xt
;

58 
œunchî_ôem
 *
	m¥ev
;

59 
GR_IMAGE_ID
 
	mic⁄id
;

60 
GR_WINDOW_ID
 
	mwid
;

62 
œunchî_ôem
 
	tlôem
;

64 
	s¥og_li°
 {

65 
¥og_ôem
 *
	m¥og
;

66 
¥og_li°
 *
	m√xt
;

68 
¥og_li°
 
	tssôem
;

69 
¥og_li°
 
	t°ôem
;

71 
	sœunchî_°©e
 {

72 *
	mc⁄fig_fûe
;

73 
GR_WINDOW_ID
 
	mmaö_wödow
;

74 
lôem
 *
	mlôems
;

75 
lôem
 *
	mœ°lôem
;

76 
	mnumlôems
;

77 
ssôem
 *
	mssôems
;

78 
ssôem
 *
	mcurssôem
;

79 
	mnumssôems
;

80 
	møndomss
;

81 
	mrŸ©ess
;

82 
GR_TIMER_ID
 
	ms§Ÿ©ëimî
;

83 
°ôem
 *
	m°ôems
;

84 
GR_GC_ID
 
	mgc
;

85 
GR_EVENT
 
	mevít
;

86 
	mwödow_background_mode
;

87 *
	mwödow_background_image
;

88 
GR_WINDOW_ID
 
	mbackground_pixm≠
;

90 
œunchî_°©e
 
	tl°©e
;

92 
ª≠î
(
signum
);

93 *
my_mÆloc
(
size_t
 
size
);

94 
ußge
();

95 
‰ì_¥og_ôem
(
¥og_ôem
 *
ôem
);

96 
¥og_ôem
 *
make_¥og_ôem
(*
comm™d
, 
löío
);

97 
£t_wödow_background_cﬁour
(*
buf
, 
löío
);

98 
∑r£_c⁄fig_löe
(
l°©e
 *
°©e
, *
buf
, 
löío
);

99 
ªad_c⁄fig
(
l°©e
 *
°©e
);

100 
døw_ôem
(
l°©e
 *
°©e
, 
lôem
 *
ôem
);

101 
h™dÀ_exposuª_evít
(
l°©e
 *
°©e
);

102 
pid_t
 
œunch_¥ogøm
(
¥og_ôem
 *
¥og
);

103 
h™dÀ_mou£_evít
(
l°©e
 *
°©e
);

104 
choo£_øndom_s¸ìnßvî
(
l°©e
 *
°©e
);

105 
a˘iv©e_s¸ìnßvî
(
l°©e
 *
°©e
);

106 
dó˘iv©e_s¸ìnßvî
(
l°©e
 *
°©e
);

107 
h™dÀ_s¸ìnßvî_evít
(
l°©e
 *
°©e
);

108 
h™dÀ_timî_evít
(
l°©e
 *
°©e
);

109 
h™dÀ_evít
(
l°©e
 *
°©e
);

110 
do_evít_lo›
(
l°©e
 *
°©e
);

111 
do_°¨tups
(
l°©e
 *
°©e
);

112 
öôüli£
(
l°©e
 *
°©e
);

	@demos/nanox/logfont.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<°rög.h
>

7 
	~<uni°d.h
>

8 #i‡
UNIX


9 
	~<time.h
>

11 
	#MWINCLUDECOLORS


	)

12 
	~"«no-X.h
"

14 
	#FONT
 "¨ül.âf"

	)

20 
	#MAXW
 630

	)

21 
	#MAXH
 470

	)

23 
	$maö
(
¨gc
, **
¨gv
)

25 
GR_WINDOW_ID
 
wödow
;

26 
GR_EVENT
 
evít
;

27 
GR_GC_ID
 
gc
;

28 
GR_FONT_ID
 
f⁄tid
;

29 
x
, 
y
, 
∫d
 = 0;

30 
MWLOGFONT
 
lf
;

31 
des¸ùti⁄
[128];

33 
	`§™d
(
	`time
(0));

35 
	`GrO≥n
();

36 
wödow
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "logfont",

37 
GR_ROOT_WINDOW_ID
, 5, 5, 
MAXW
, 
MAXH
, 
BLACK
);

38 
	`GrSñe˘Evíts
(
wödow
, 
GR_EVENT_MASK_EXPOSURE
|
GR_EVENT_MASK_CLOSE_REQ
);

39 
	`GrM≠Wödow
(
wödow
);

41 
gc
 = 
	`GrNewGC
();

43 
	`GrSëGCU£Background
(
gc
,
GR_FALSE
);

44 
	`GrSëGCBackground
(
gc
, 
	`GR_RGB
(0, 0, 0));

46 
y
 = 30;

47 
x
 = 0;

50 
	`GrCheckNextEvít
(&
evít
);

52 if(
evít
.
ty≥
 =
GR_EVENT_TYPE_CLOSE_REQ
) {

53 
	`GrClo£
();

54 
	`exô
(0);

59 
	`MWLF_CÀ¨
(&
lf
);

60 
des¸ùti⁄
[0] = '\0';

62 
lf
.
lfHeight
 = 12;

64 i‡–
∫d
 & 1 ) {

65 
lf
.
lfWeight
 = 
MWLF_WEIGHT_BOLD
;

66 
	`°rˇt
(
des¸ùti⁄
,"Bold ");

69 i‡–
∫d
 & 2 ) {

70 
lf
.
lfIèlic
 = 1;

71 
	`°rˇt
(
des¸ùti⁄
,"Italics ");

73 i‡–
∫d
 & 4 ) {

74 
lf
.
lfOblique
 = 1;

75 
	`°rˇt
(
des¸ùti⁄
,"Oblique ");

78 i‡–
∫d
 & 8 ) {

79 
lf
.
lfM⁄o•a˚
 = 1;

80 
	`°rˇt
(
des¸ùti⁄
,"Monospace ");

82 
lf
.
lfPr›‹ti⁄Æ
 = 1;

83 
	`°rˇt
(
des¸ùti⁄
,"Proportional ");

86 i‡–
¨gc
 > 1 )

87 
	`°r˝y
(
lf
.
lfFa˚Name
,
¨gv
[1]);

89 
	`°r˝y
(
lf
.
lfFa˚Name
, 
FONT
);

91 
f⁄tid
 = 
	`GrCª©eF⁄t
(0, 0, &
lf
);

93 
	`GrSëF⁄tSize
(
f⁄tid
,26);

95 
	`GrSëF⁄tAâr
(
f⁄tid
, 
GR_TFKERNING
 | 
GR_TFANTIALIAS
, 0);

96 
	`GrSëGCF⁄t
(
gc
, 
f⁄tid
);

98 
	`GrSëGCF‹eground
(
gc
, 0xffffff);

102 
	`GrText
(
wödow
, 
gc
,
x
,
y
, 
des¸ùti⁄
, -1, 
GR_TFTOP
|
GR_TFASCII
);

103 
	`GrDe°royF⁄t
(
f⁄tid
);

105 
∫d
++;

106 
y
 += 30;

107 i‡–
y
 > 460 )

108 
y
 = 0;

111 
	`GrClo£
();

112 
	}
}

	@demos/nanox/move.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	#MWINCLUDECOLORS


	)

4 
	~"«no-X.h
"

6 #i‡
PSP


7 
	#Ârötf
(...)

	)

14 
	$maö
(
ac
,**
av
)

16 
GR_COORD
 
off£t_x
 = 0, 
off£t_y
 = 0;

17 
GR_WINDOW_ID
 
wödow1
, 
subwödow1
, 
subsubwö1
;

18 
GR_WINDOW_ID
 
wödow2
, 
subwödow2
;

20 
GR_EVENT
 
evít
;

22 
	`Ârötf
(
°dîr
,"This isá demoÖrogram.\n");

23 
	`Ârötf
(
°dîr
,"Left-button drags window\n");

24 
	`Ârötf
(
°dîr
,"Right-buttonÑaises window\n");

26 
	`GrO≥n
();

27 
wödow1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 20, 20, 100, 60, 4, 
BLACK
, 
BLUE
);

28 
subwödow1
 = 
	`GrNewWödow
(
wödow1
, 5, 5, 90, 50, 4, 
WHITE
, 
RED
);

29 
subsubwö1
 = 
	`GrNewWödow
(
subwödow1
, 10, 10, 10, 10, 2, 
GREEN
, 
BLUE
);

31 
wödow2
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 20, 100, 100, 60, 4, 
BLACK
, 
BLUE
);

32 
subwödow2
 = 
	`GrNewWödow
(
wödow2
, 5, 5, 90, 50, 4, 
WHITE
, 
RED
);

35 
	`GrSñe˘Evíts
(
wödow1
,

36 
GR_EVENT_MASK_EXPOSURE
 |

37 
GR_EVENT_MASK_BUTTON_DOWN
 |

38 
GR_EVENT_MASK_BUTTON_UP
 |

39 
GR_EVENT_MASK_MOUSE_ENTER
 |

40 
GR_EVENT_MASK_MOUSE_EXIT
 |

41 
GR_EVENT_MASK_MOUSE_MOTION
 |

42 
GR_EVENT_MASK_CLOSE_REQ
);

44 
	`GrSñe˘Evíts
(
wödow2
,

45 
GR_EVENT_MASK_EXPOSURE
 |

46 
GR_EVENT_MASK_BUTTON_DOWN
 |

47 
GR_EVENT_MASK_BUTTON_UP
 |

48 
GR_EVENT_MASK_MOUSE_ENTER
 |

49 
GR_EVENT_MASK_MOUSE_EXIT
 |

50 
GR_EVENT_MASK_MOUSE_MOTION
 |

51 
GR_EVENT_MASK_CLOSE_REQ
);

53 
	`GrSñe˘Evíts
(
subsubwö1
,

54 
GR_EVENT_MASK_BUTTON_DOWN
 |

57 
	`GrM≠Wödow
(
subsubwö1
);

58 
	`GrM≠Wödow
(
subwödow1
);

59 
	`GrM≠Wödow
(
wödow1
);

62 
	`GrM≠Wödow
(
subwödow2
);

63 
	`GrM≠Wödow
(
wödow2
);

66 
	`GrGëNextEvít
(&
evít
);

68 
evít
.
ty≥
) {

69 
GR_EVENT_TYPE_NONE
:

71 
GR_EVENT_TYPE_BUTTON_DOWN
:

72 
off£t_x
 = 
evít
.
buâ⁄
.
x
;

73 
off£t_y
 = 
evít
.
buâ⁄
.
y
;

75 i‡(
evít
.
buâ⁄
.
ch™gebuâ⁄s
 & 
GR_BUTTON_R
) {

76 
	`GrRai£Wödow
(
evít
.
buâ⁄
.
wid
);

78 i‡(
evít
.
buâ⁄
.
wid
 =
subsubwö1
) {

79 
GR_WINDOW_INFO
 
wöfo
;

80 
	`GrGëWödowInfo
(
subsubwö1
, &
wöfo
);

81 i‡(
wöfo
.
∑ª¡
 =
subwödow1
) {

82 
	`GrRï¨ítWödow
(
subsubwö1
, 
subwödow2
, 10, 10);

84 
	`GrRï¨ítWödow
(
subsubwö1
, 
subwödow1
, 10, 10);

87 
GR_EVENT_TYPE_MOUSE_MOTION
:

88 i‡(
evít
.
mou£
.
buâ⁄s
 =
GR_BUTTON_L
 &&

89 (
evít
.
mou£
.
wid
 =
wödow1
 ||Évít.mou£.wid =
wödow2
)) {

90 
	`GrMoveWödow
(
evít
.
mou£
.
wid
,

91 
evít
.
mou£
.
roŸx
 - 
off£t_x
,

92 
evít
.
mou£
.
roŸy
 - 
off£t_y
);

94 i‡(
evít
.
mou£
.
buâ⁄s
 =
GR_BUTTON_R
) {

95 
	`GrResizeWödow
(
evít
.
mou£
.
wid
,

96 
evít
.
mou£
.
x
 + 1,

97 
evít
.
mou£
.
y
 + 1);

100 
GR_EVENT_TYPE_EXPOSURE
:

105 
GR_EVENT_TYPE_CLOSE_REQ
:

106 
	`GrClo£
();

107 
	`exô
(0);

109 
	`Ârötf
(
°dîr
, "%d\n", 
evít
.
ty≥
);

112 
	`GrClo£
();

113 
	}
}

	@demos/nanox/npanel.c

12 
	#SHOW_WINDOW_MOTION


	)

18 #unde‡
USE_WEIRD_POINTER


20 
	~<°dio.h
>

21 
	~<sig«l.h
>

22 
	~<sys/time.h
>

23 
	~<sys/waô.h
>

24 
	~<°dlib.h
>

25 
	~<uni°d.h
>

26 
	#MWINCLUDECOLORS


	)

27 
	~"«no-X.h
"

32 
	#_
 ((Ë0Ë

	)

33 
	#X
 ((Ë1Ë

	)

34 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

35 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

36 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

38 
	#DEC_HEIGHT
 7

	)

39 
	#IDLE_DELAY
 100000

	)

41 
GR_WINDOW_ID
 
	gw1
;

42 
GR_GC_ID
 
	ggc
;

43 
GR_GC_ID
 
	gbgc
;

44 
GR_SCREEN_INFO
 
	gsi
;

45 
	gfwidth
, 
	gfheight
;

46 
	gfba£
;

47 
	gnum_≠ps
 = 0;

49 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

50 
do_buâ⁄down
(
GR_EVENT_BUTTON
 *
ï
);

51 
do_buâ⁄up
(
GR_EVENT_BUTTON
 *
ï
);

52 
do_upd©e
(
GR_EVENT_UPDATE
 *
ï
);

53 
do_mou£
(
GR_EVENT_MOUSE
 *
ï
);

55 
	s≠p_öfo
 {

56 
	m≠p_id
[10];

57 
	m≠p_∑th
[64];

58 } 
	gAµs
[] = {

59 #i‡
ELKS


74 
m™aged_wödow
 
	tmwö
;

75 
	sm™aged_wödow
 {

76 
GR_WINDOW_ID
 
	mwid
;

77 
GR_WINDOW_ID
 
	mfid
;

78 
GR_COORD
 
	mx
;

79 
GR_COORD
 
	my
;

80 
GR_SIZE
 
	mwidth
;

81 
mwö
 * 
	m√xt
;

84 
mwö
 * 
	gmwös
 = 
NULL
;

85 
mwö
 * 
	gö_mŸi⁄
 = 
NULL
;

86 
GR_COORD
 
	gmove_xoff
;

87 
GR_COORD
 
	gmove_yoff
;

89 #i‚de‡
WAIT_ANY


93 
	#WAIT_ANY
 (
pid_t
)-1

	)

99 
	$ª≠î
(
signum
Ë{ 
	`waôpid
(
WAIT_ANY
, 
NULL
, 
WNOHANG
Ë> 0); 
	}
}

102 
	$maö
(
¨gc
,**
¨gv
)

104 
GR_EVENT
 
evít
;

105 
≠p_öfo
 * 
a˘
;

106 
width
, 
height
;

108 #ifde‡
USE_WEIRD_POINTER


109 
GR_BITMAP
 
bôm≠1fg
[7];

110 
GR_BITMAP
 
bôm≠1bg
[7];

113 
a˘
 = 
Aµs
;á˘->
≠p_id
[0] !'\0';á˘++, 
num_≠ps
++);

115 i‡(
	`GrO≥n
() < 0) {

116 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

117 
	`exô
(1);

120 
	`GrGëS¸ìnInfo
(&
si
);

122 
	`sig«l
(
SIGCHLD
, &
ª≠î
);

124 
gc
 = 
	`GrNewGC
();

125 
bgc
 = 
	`GrNewGC
();

127 
	`GrSëGCF‹eground
(
bgc
, 
GRAY
);

128 
	`GrSëGCF⁄t
(
gc
, 
	`GrCª©eF⁄t
(
GR_FONT_SYSTEM_FIXED
, 0, 
NULL
));

130 
	`GrGëGCTextSize
(
gc
, "A", 1, 
GR_TFASCII
, &
fwidth
, &
fheight
, &
fba£
);

131 
width
 = 
fwidth
 * 8 + 4;

132 
height
 = (
fheight
Ë* 
num_≠ps
 + 4;

134 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 5, 5, 
width
,

135 
height
, 1, 
WHITE
, 
BLACK
);

137 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_BUTTON_DOWN


138 | 
GR_EVENT_MASK_CLOSE_REQ
);

139 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_EXPOSURE
 |

140 
GR_EVENT_MASK_CHLD_UPDATE
);

142 
	`GrM≠Wödow
(
w1
);

144 #ifde‡
USE_WEIRD_POINTER


145 
bôm≠1bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

146 
bôm≠1bg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

147 
bôm≠1bg
[2] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

148 
bôm≠1bg
[3] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

149 
bôm≠1bg
[4] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

150 
bôm≠1bg
[5] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

151 
bôm≠1bg
[6] = 
	`MASK
(
X
,X,X,X,X,X,X);

153 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,_,_,_,_,_);

154 
bôm≠1fg
[1] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

155 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

156 
bôm≠1fg
[3] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

157 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

158 
bôm≠1fg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

159 
bôm≠1fg
[6] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

161 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

164 
	`GrFûlRe˘
(
GR_ROOT_WINDOW_ID
, 
bgc
, 0, 0, 
si
.
cﬁs
, si.
rows
);

166 
	`GrSëGCF‹eground
(
gc
, 
BLACK
);

167 
	`GrSëGCBackground
(
gc
, 
WHITE
);

170 
	`GrGëNextEvít
(&
evít
);

172 
evít
.
ty≥
) {

173 
GR_EVENT_TYPE_EXPOSURE
:

174 
	`do_exposuª
(&
evít
.
exposuª
);

176 
GR_EVENT_TYPE_BUTTON_DOWN
:

177 
	`do_buâ⁄down
(&
evít
.
buâ⁄
);

179 
GR_EVENT_TYPE_BUTTON_UP
:

180 
	`do_buâ⁄up
(&
evít
.
buâ⁄
);

182 
GR_EVENT_TYPE_UPDATE
:

183 
	`do_upd©e
(&
evít
.
upd©e
);

185 
GR_EVENT_TYPE_MOUSE_POSITION
:

186 
	`do_mou£
(&
evít
.
mou£
);

188 
GR_EVENT_TYPE_CLOSE_REQ
:

189 
	`GrClo£
();

190 
	`exô
(0);

193 
	}
}

195 
mwö
 * 
	$IsDec‹©i⁄
(
GR_WINDOW_ID
 
wid
)

197 
mwö
 * 
mwp
;

198 
mwp
 = 
mwös
; mwp; mw∞mwp->
√xt
) {

199 i‡(
mwp
->
fid
 =
wid
) {

200  
mwp
;

203  
NULL
;

204 
	}
}

206 
mwö
 * 
	$FödWödow
(
GR_WINDOW_ID
 
wid
)

208 
mwö
 * 
mwp
;

209 
mwp
 = 
mwös
; mwp; mw∞mwp->
√xt
) {

210 i‡(
mwp
->
wid
 == wid) {

211  
mwp
;

214  
NULL
;

215 
	}
}

217 
mwö
 * 
	$NewWödow
(
GR_WINDOW_ID
 
wid
)

219 
mwö
 * 
mwp
 = 
	`mÆloc
((mwin));

221 i‡(
mwp
) {

222 
mwp
->
wid
 = wid;

223 
mwp
->
√xt
 = 
mwös
;

224 
mwös
 = 
mwp
;

226  
mwp
;

227 
	}
}

230 
	$do_upd©e
(
GR_EVENT_UPDATE
 *
ï
)

232 
mwö
 * 
mwp
;

233 
mwö
 * 
tmwp
;

234 
GR_WINDOW_INFO
 
wöfo
;

236 i‡(
	`IsDec‹©i⁄
(
ï
->
wid
)) ;

238 i‡((
mwp
 = 
	`FödWödow
(
ï
->
wid
)Ë=
NULL
) {

240 i‡(
ï
->
uty≥
 !
GR_UPDATE_MAP
) ;

241 i‡((
mwp
 = 
	`NewWödow
(
ï
->
wid
)Ë=
NULL
) {

242 
	`¥ötf
("malloc failed\n");

245 
	`GrGëWödowInfo
(
ï
->
wid
, &
wöfo
);

246 
mwp
->
x
 = 
ï
->x - 
wöfo
.
b‹dîsize
;

247 
mwp
->
y
 = 
ï
->y - 
wöfo
.
b‹dîsize
;

248 
mwp
->
width
 = 
ï
->width + 2 * 
wöfo
.
b‹dîsize
;

249 
	`GrMoveWödow
(
mwp
->
wid
, mwp->
x
 + 
wöfo
.
b‹dîsize
,

250 
mwp
->
y
 + 
DEC_HEIGHT
 +

251 2 * 
wöfo
.
b‹dîsize
);

252 
mwp
->
fid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, mwp->
x
 + 1,

253 
mwp
->
y
 + 1, mwp->
width
 - 2,

254 
DEC_HEIGHT
 - 2, 1, 
BLUE
, 
BLACK
);

255 
	`GrSñe˘Evíts
(
mwp
->
fid
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

256 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_MOUSE_POSITION
);

257 
	`GrM≠Wödow
(
mwp
->
fid
);

259 
ï
->
uty≥
) {

260 
GR_UPDATE_UNMAP
:

261 
	`GrUnm≠Wödow
(
mwp
->
fid
);

262 
	`GrDe°royWödow
(
mwp
->
fid
);

263 i‡(
mwös
 =
mwp
) {

264 
mwös
 = 
mwp
->
√xt
;

265 } 
tmwp
 = 
mwös
;Åmwp;Åmw∞tmwp->
√xt
) {

266 i‡(
tmwp
->
√xt
 =
mwp
) {

267 
tmwp
->
√xt
 = 
mwp
->next;

270 
	`‰ì
(
mwp
);

272 
GR_UPDATE_MOVE
:

273 
	`GrGëWödowInfo
(
ï
->
wid
, &
wöfo
);

274 i‡((
ï
->
x
 =(
mwp
->x + 
wöfo
.
b‹dîsize
)) &&

275 (
ï
->
y
 =(
mwp
->y + 
wöfo
.
b‹dîsize


276 + 
DEC_HEIGHT
))) {

279 
mwp
->
x
 = 
ï
->x - 
wöfo
.
b‹dîsize
;

280 
mwp
->
y
 = 
ï
->y - 
wöfo
.
b‹dîsize
 - 
DEC_HEIGHT
;

281 
	`GrMoveWödow
(
mwp
->
fid
, mwp->
x
 + 1, mwp->
y
 + 1);

286 
	}
}

292 
	$do_mou£
(
GR_EVENT_MOUSE
 *
ï
)

294 #ifde‡
SHOW_WINDOW_MOTION


295 
GR_WINDOW_INFO
 
wöfo
;

297 if(!
ö_mŸi⁄
) ;

299 
ö_mŸi⁄
->
x
 = 
ï
->
roŸx
 - 
move_xoff
 - 1;

300 
ö_mŸi⁄
->
y
 = 
ï
->
roŸy
 - 
move_yoff
 - 1;

301 
	`GrMoveWödow
(
ö_mŸi⁄
->
fid
, in_mŸi⁄->
x
 + 1, in_mŸi⁄->
y
 + 1);

302 
	`GrGëWödowInfo
(
ö_mŸi⁄
->
wid
, &
wöfo
);

303 
	`GrMoveWödow
(
ö_mŸi⁄
->
wid
, in_mŸi⁄->
x
 + 
wöfo
.
b‹dîsize
 - 1,

304 
ö_mŸi⁄
->
y
 + 2 * 
wöfo
.
b‹dîsize
 + 
DEC_HEIGHT
 - 1);

306 
	}
}

312 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

314 
≠p_öfo
 * 
a˘
;

315 
≠p_no
;

317 i‡(
ï
->
wid
 =
w1
) {

318 
a˘
=
Aµs
,
≠p_no
=0;a˘->
≠p_id
[0]!='\0';act++,app_no++) {

319 
	`GrText
(
w1
, 
gc
, 2, 2 + 
fheight
 * (
≠p_no
 + 1),

320 
a˘
->
≠p_id
, -1, 
GR_TFBOTTOM
);

322 } i‡(
ï
->
wid
 =
GR_ROOT_WINDOW_ID
) {

323 
	`GrFûlRe˘
(
GR_ROOT_WINDOW_ID
, 
bgc
, 
ï
->
x
,Ép->
y
,

324 
ï
->
width
,Ép->
height
);

326 
	}
}

328 ** 
ívú⁄
;

331 
	$do_buâ⁄down
(
GR_EVENT_BUTTON
 *
ï
)

333 
mwö
 * 
mwp
;

334 
≠p_no
;

336 i‡(
ï
->
wid
 =
w1
) {

337 
≠p_no
 = 
ï
->
y
 / 
fheight
;

338 i‡(
≠p_no
 >
num_≠ps
) {

339 
≠p_no
 = 
num_≠ps
 - 1;

342 i‡(!
	`vf‹k
()) {

343 * 
«rgv
[2];

345 
«rgv
[0] = 
Aµs
[
≠p_no
].
≠p_∑th
;

346 
«rgv
[1] = 0;

347 
	`execve
(
«rgv
[0],Ç¨gv, 
ívú⁄
);

349 
	`exô
(1);

351 } i‡((
mwp
 = 
	`IsDec‹©i⁄
(
ï
->
wid
)Ë!
NULL
) {

352 
	`GrRai£Wödow
(
mwp
->
wid
);

353 
	`GrRai£Wödow
(
mwp
->
fid
);

354 
ö_mŸi⁄
 = 
mwp
;

355 
move_xoff
 = 
ï
->
x
;

356 
move_yoff
 = 
ï
->
y
;

358 
	}
}

361 
	$do_buâ⁄up
(
GR_EVENT_BUTTON
 *
ï
)

363 #ifde‡
SHOW_WINDOW_MOTION


364 
ö_mŸi⁄
 = 
NULL
;

366 
mwö
 * 
mwp
;

367 
GR_WINDOW_INFO
 
wöfo
;

369 i‡((
mwp
 = 
	`IsDec‹©i⁄
(
ï
->
wid
)Ë!
NULL
) {

370 i‡(
mwp
 =
ö_mŸi⁄
) {

371 
mwp
->
x
 = 
ï
->
roŸx
 - 1 - 
move_xoff
;

372 
mwp
->
y
 = 
ï
->
roŸy
 - 1 - 
move_yoff
;

373 
	`GrMoveWödow
(
mwp
->
fid
, mwp->
x
 + 1, mwp->
y
 + 1);

374 
	`GrGëWödowInfo
(
mwp
->
wid
, &
wöfo
);

375 
	`GrMoveWödow
(
mwp
->
wid
, mwp->
x
 + 
wöfo
.
b‹dîsize
,

376 
mwp
->
y
 + 2 * 
wöfo
.
b‹dîsize
 + 
DEC_HEIGHT
);

377 
ö_mŸi⁄
 = 
NULL
;

381 
	}
}

	@demos/nanox/nsaver.c

35 
	~<î∫o.h
>

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<time.h
>

39 
	~<m©h.h
>

40 
	~<sys/time.h
>

42 
	~<«no-X.h
>

43 
	~<nxcﬁ‹s.h
>

44 
	~"nßvî.h
"

46 *
	$my_mÆloc
(
size_t
 
size
)

48 *
ªt
;

50 if(!(
ªt
 = 
	`mÆloc
(
size
))) {

51 
	`Ârötf
(
°dîr
, "Out of memory\n");

52 
	`exô
(1);

55  
ªt
;

56 
	}
}

58 
GR_COLOR
 
	$gë_øndom_cﬁour
(
mö_brighäess
)

60 
r
, 
g
, 
b
;

63 
r
 = 
	`RANDRANGE
(0, 255);

64 
g
 = 
	`RANDRANGE
(0, 255);

65 
b
 = 
	`RANDRANGE
(0, 255);

66 } (
r
 + 
g
 + 
b
Ë/ 3 < 
mö_brighäess
);

68 (
	`MWRGB
(
r
, 
g
, 
b
));

69 
	}
}

71 
	$gë_øndom_poöt_⁄_s¸ìn
(
n°©e
 *
°©e
, 
GR_COORD
 *
x
, GR_COORD *
y
,

72 
GR_COLOR
 *
c
)

74 if(
x
Ë*x = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
 - 1);

75 if(
y
Ë*y = 
	`RANDRANGE
(0, 
°©e
->
si
.
rows
 - 1);

76 if(
c
Ë*¯
	`gë_øndom_cﬁour
(
GRP_MINBRIGHTNESS
);

77 
	}
}

79 
	$nŸ_squ¨e
(
n
)

81 
n
) {

82 if(
n
 & 1) {

83 if(
n
 - 1)  1;

86 
n
 >>= 1;

89 
	}
}

91 
	$make_øndom_squ¨e
(
n°©e
 *
°©e
, 
mö_brighäess
, 
mö_size
,

92 
max_size
, 
√ed_squ¨e
, 
GR_COORD
 *
ªtx
,

93 
GR_COORD
 *
ªty
, 
GR_SIZE
 *
ªtsize
)

95 
x1
, 
x2
, 
y
, 
size
, 
tmp
;

96 
GR_COLOR
 
cﬁour
 = 
	`gë_øndom_cﬁour
(
mö_brighäess
);

98 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
cﬁour
);

101 
x1
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
);

102 
x2
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
);

103 if(
x1
 > 
x2
) {

104 
tmp
 = 
x1
;

105 
x1
 = 
x2
;

106 
x2
 = 
tmp
;

108 
size
 = 
x2
 - 
x1
;

109 } 
size
 < 
mö_size
 || sizê> 
max_size
 ||

110 (
√ed_squ¨e
 && 
	`nŸ_squ¨e
(
size
)));

112 
y
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
rows
 - 
size
 - 1);

114 *
ªtx
 = 
x1
;

115 *
ªty
 = 
y
;

116 *
ªtsize
 = 
size
;

117 
	}
}

119 #ifde‡
HAVE_USLEEP


120 
	$m¶ìp
(
ms
)

122 
	`u¶ìp
(
ms
 * 1000);

123 
	}
}

125 
	$m¶ìp
(
ms
)

127 
time•ec
 
ªq
, 
ªm
;

129 
ªq
.
tv_£c
 = 
ms
 / 1000000;

130 
ªq
.
tv_n£c
 = (
ms
 % 1000000) * 1000000;

132 
	`«no¶ìp
(&
ªq
, &
ªm
) == -1) {

133 if(
î∫o
 =
EINTR
) {

134 
ªq
.
tv_£c
 = 
ªm
.tv_sec;

135 
ªq
.
tv_n£c
 = 
ªm
.tv_nsec;

138 
	`≥º‹
("nanosleep() failed");

142 
	}
}

145 
GR_WINDOW_ID
 
	$ˇ±uª_s¸ìn
(
n°©e
 *
°©e
)

147 
GR_WINDOW_ID
 
pid
;

149 #i‡
CAPTURESCREEN_DELAY


153 
	`m¶ìp
(
CAPTURESCREEN_DELAY
);

156 
pid
 = 
	`GrNewPixm≠
(
°©e
->
si
.
cﬁs
, sèã->si.
rows
, 
NULL
);

157 
	`GrC›yAªa
(
pid
, 
°©e
->
maö_gc
, 0, 0, sèã->
si
.
cﬁs
,

158 
°©e
->
si
.
rows
, 
GR_ROOT_WINDOW_ID
, 0, 0, 0);

160  
pid
;

161 
	}
}

163 
	$ßvî1_öô
(
n°©e
 *
°©e
Ë{
	}
}

165 
	$ßvî1_exposuª
(
n°©e
 *
°©e
)

167 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

168 
	}
}

170 
	$ßvî1_™im©e
(
n°©e
 *
°©e
Ë{
	}
}

172 
	$ßvî2_öô
(
n°©e
 *
°©e
)

174 
s2°©e
 *
s
 = 
	`my_mÆloc
((s2state));

175 
°©e
->
¥iv
 = 
s
;

176 
s
->
pixñs
 = 
SAVER2_MAXPIXELS
;

177 
°©e
->
™im©e_öãrvÆ
 = 
SAVER2_DELAY
;

178 
	}
}

180 
	$ßvî2_exposuª
(
n°©e
 *
°©e
)

182 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

183 
	}
}

185 
	$ßvî2_™im©e
(
n°©e
 *
°©e
)

187 
GR_COORD
 
x
, 
y
;

188 
GR_COLOR
 
c
;

189 
pixñs
 = 
SAVER2_PIXELS_PER_FRAME
;

190 
s2°©e
 *
s
 = 
°©e
->
¥iv
;

192 
pixñs
--) {

193 if(!(
s
->
pixñs
--)) {

194 
s
->
pixñs
 = 
SAVER2_MAXPIXELS
;

195 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

197 
	`gë_øndom_poöt_⁄_s¸ìn
(
°©e
, &
x
, &
y
, &
c
);

198 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
c
);

199 
	`GrPoöt
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
x
, 
y
);

201 
	}
}

203 
	$ßvî3_öô
(
n°©e
 *
°©e
)

205 
s3°©e
 *
s
 = 
	`my_mÆloc
((s3state));

206 
°©e
->
¥iv
 = 
s
;

207 
s
->
max£gmíts
 = 
SAVER3_MAXSEGMENTS
;

208 
s
->
œ°x
 = 0;

209 
s
->
œ°y
 = 0;

210 
°©e
->
™im©e_öãrvÆ
 = 
SAVER3_DELAY
;

211 
	}
}

213 
	$ßvî3_exposuª
(
n°©e
 *
°©e
)

215 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

216 
	}
}

218 
	$ßvî3_™im©e
(
n°©e
 *
°©e
)

220 
GR_COORD
 
√wx
, 
√wy
;

221 
GR_COLOR
 
c
;

222 
s3°©e
 *
s
 = 
°©e
->
¥iv
;

223 
pixñs
 = 
SAVER3_SEGMENTS_PER_FRAME
;

225 
pixñs
--) {

226 if(!(
s
->
max£gmíts
--)) {

227 
s
->
max£gmíts
 = 
SAVER3_MAXSEGMENTS
;

228 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

230 
	`gë_øndom_poöt_⁄_s¸ìn
(
°©e
, &
√wx
, &
√wy
, &
c
);

231 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
c
);

232 
	`GrLöe
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
s
->
œ°x
, s->
œ°y
,

233 
√wx
, 
√wy
);

234 
s
->
œ°x
 = 
√wx
;

235 
s
->
œ°y
 = 
√wy
;

237 
	}
}

239 
	$ßvî4_öô
(
n°©e
 *
°©e
)

241 
i
;

242 
GR_COORD
 
x
, 
y
;

244 
s4°©e
 *
s
 = 
	`my_mÆloc
((s4state));

245 
°©e
->
¥iv
 = 
s
;

247 
s
->
Àngth
 = 0;

249 
i
 = 0; i < 
SAVER4_NUMWORMS
; i++) {

250 
s
->
tù
 = 0;

251 
	`gë_øndom_poöt_⁄_s¸ìn
(
°©e
, &
x
, &
y
, &
s
->
w‹ms
[
i
].
cﬁour
);

252 
s
->
w‹ms
[
i
].
x
 = x;

253 
s
->
w‹ms
[
i
].
poöts
[0].
x
 = x;

254 
s
->
w‹ms
[
i
].
y
 = y;

255 
s
->
w‹ms
[
i
].
poöts
[0].
y
 = y;

258 
°©e
->
™im©e_öãrvÆ
 = 
SAVER4_DELAY
;

259 
	}
}

261 
	$ßvî4_exposuª
(
n°©e
 *
°©e
)

263 
i
;

264 
s4°©e
 *
s
 = 
°©e
->
¥iv
;

266 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

268 if(!
s
->
Àngth
) ;

270 
i
 = 0; i < 
SAVER4_NUMWORMS
; i++) {

271 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
s
->
w‹ms
[
i
].
cﬁour
);

272 
	`GrPoöts
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
s
->
Àngth
,

273 
s
->
w‹ms
[
i
].
poöts
);

275 
	}
}

277 
	$ßvî4_gë_√w_w‹m_posôi⁄
(
n°©e
 *
°©e
, 
w‹m
, 
√wtù
)

279 
s4°©e
 *
s
 = 
°©e
->
¥iv
;

280 
s4w‹m
 *
w
 = &
s
->
w‹ms
[
w‹m
];

282 
w
->
d
 +
	`FRANDRANGE
(-
SAVER4_MAXROTATION
, SAVER4_MAXROTATION);

283 
w
->
x
 +
	`cos
(w->
d
Ë* 
SAVER4_VELOCITY
;

284 
w
->
y
 +
	`sö
(w->
d
Ë* 
SAVER4_VELOCITY
;

285 if(
w
->
x
 < 0Ëw->x = 
°©e
->
si
.
cﬁs
 - 1 + w->x;

286 if(
w
->
x
 >
°©e
->
si
.
cﬁs
) w->x -= state->si.cols;

287 if(
w
->
y
 < 0Ëw->y = 
°©e
->
si
.
rows
 - 1 + w->y;

288 if(
w
->
y
 >
°©e
->
si
.
rows
) w->y -= state->si.rows;

289 
w
->
poöts
[
√wtù
].
x
 = (
GR_COORD
)w->x;

290 
w
->
poöts
[
√wtù
].
y
 = (
GR_COORD
)w->y;

291 
	}
}

293 
	$ßvî4_™im©e
(
n°©e
 *
°©e
)

295 
i
, 
èû
, 
√wtù
;

296 
s4°©e
 *
s
 = 
°©e
->
¥iv
;

298 if(
s
->
Àngth
 =
SAVER4_WORMLENGTH
Ë
èû
 = s->
tù
 + 1;

299 
èû
 = 0;

300 if(
èû
 =
SAVER4_WORMLENGTH
)Åail = 0;

301 
√wtù
 = 
s
->
tù
 + 1;

302 if(
√wtù
 =
SAVER4_WORMLENGTH
)Çewtip = 0;

304 
i
 = 0; i < 
SAVER4_NUMWORMS
; i++) {

305 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

306 
	`GrFûlRe˘
(
°©e
->
maö_wödow
, sèã->
maö_gc
,

307 
s
->
w‹ms
[
i
].
poöts
[
èû
].
x
,

308 
s
->
w‹ms
[
i
].
poöts
[
èû
].
y
,

309 
SAVER4_WORMTHICKNESS
,

310 
SAVER4_WORMTHICKNESS
);

311 
	`ßvî4_gë_√w_w‹m_posôi⁄
(
°©e
, 
i
, 
√wtù
);

312 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
s
->
w‹ms
[
i
].
cﬁour
);

313 
	`GrFûlRe˘
(
°©e
->
maö_wödow
, sèã->
maö_gc
,

314 
s
->
w‹ms
[
i
].
poöts
[
√wtù
].
x
,

315 
s
->
w‹ms
[
i
].
poöts
[
√wtù
].
y
,

316 
SAVER4_WORMTHICKNESS
,

317 
SAVER4_WORMTHICKNESS
);

320 
s
->
tù
 = 
√wtù
;

321 if(
s
->
Àngth
 < 
SAVER4_WORMLENGTH
) s->length++;

322 
	}
}

324 
	$ßvî5_öô
(
n°©e
 *
°©e
)

326 
i
;

328 
s5°©e
 *
s
 = 
	`my_mÆloc
((s5state));

329 
°©e
->
¥iv
 = 
s
;

331 
s
->
num°¨s
 = 0;

333 
i
 = 0; i < 
SAVER5_NUMSTARS
; i++) {

334 
s
->
°¨s
[
i
].
™gÀ
 = 
	`FRANDRANGE
(0, (2 * 
M_PI
));

335 
s
->
°¨s
[
i
].
pos
 = 1;

338 
°©e
->
™im©e_öãrvÆ
 = 
SAVER5_DELAY
;

339 
	}
}

341 
	$ßvî5_døw°¨
(
n°©e
 *
°©e
, 
s5°©e
 *
s
, 
°¨
, 
dñëe
)

343 
›p
, 
adj
;

344 
GR_COORD
 
x
, 
y
;

346 if(
dñëe
Ë
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

347 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_WHITE
);

349 
›p
 = ()(
	`sö
(
s
->
°¨s
[
°¨
].
™gÀ
Ë* s->°¨s[°¨].
pos
);

350 
adj
 = ()(
	`cos
(
s
->
°¨s
[
°¨
].
™gÀ
Ë* s->°¨s[°¨].
pos
);

352 
x
 = (
°©e
->
si
.
cﬁs
 / 2Ë+ 
adj
;

353 
y
 = (
°©e
->
si
.
rows
 / 2Ë+ 
›p
;

355 if((
x
 < 0Ë|| (
y
 < 0Ë|| (x >
°©e
->
si
.
cﬁs
Ë|| (y >°©e->si.
rows
))

358 
	`GrPoöt
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
x
, 
y
);

361 
	}
}

363 
	$ßvî5_exposuª
(
n°©e
 *
°©e
)

365 
i
;

366 
s5°©e
 *
s
 = 
°©e
->
¥iv
;

368 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

370 
i
 = 0; i < 
SAVER5_NUMSTARS
; i++) {

371 
	`ßvî5_døw°¨
(
°©e
, 
s
, 
i
, 0);

373 
	}
}

375 
	$ßvî5_™im©e
(
n°©e
 *
°©e
)

377 
i
;

378 
posôi⁄
, 
sˇÀ
, 
ö¸emít
;

379 
s5°©e
 *
s
 = 
°©e
->
¥iv
;

381 if(
s
->
num°¨s
 < 
SAVER5_NUMSTARS
) {

382 
s
->
num°¨s
 +
SAVER5_STARS_INCREMENT
;

383 if(
s
->
num°¨s
 > 
SAVER5_NUMSTARS
)

384 
s
->
num°¨s
 = 
SAVER5_NUMSTARS
;

387 
i
 = 0; i < 
s
->
num°¨s
; i++) {

388 
	`ßvî5_døw°¨
(
°©e
, 
s
, 
i
, 1);

389 
posôi⁄
 = ()
s
->
°¨s
[
i
].
pos
 /

390 ()(
°©e
->
si
.
cﬁs
 / 2);

391 
sˇÀ
 = 
	`sö
((
posôi⁄
 * 
M_PI_2
Ë+ 
M_PI
 + M_PI_2) + 1.0;

392 
ö¸emít
 = (
sˇÀ
 * 
SAVER5_STARS_ACCEL_RATE
) + 1;

393 
s
->
°¨s
[
i
].
pos
 +(Ë
ö¸emít
;

394 if(
	`ßvî5_døw°¨
(
°©e
, 
s
, 
i
, 0)) {

395 
s
->
°¨s
[
i
].
pos
 = 1;

396 
s
->
°¨s
[
i
].
™gÀ
 = 
	`FRANDRANGE
(0, (2 * 
M_PI
));

397 
	`ßvî5_døw°¨
(
°©e
, 
s
, 
i
, 0);

400 
	}
}

402 
	$ßvî6_öô
(
n°©e
 *
°©e
)

404 
i
, 
n
;

406 
s6°©e
 *
s
 = 
	`my_mÆloc
((s6state));

407 
°©e
->
¥iv
 = 
s
;

409 
s
->
√w_bﬁt_time
 = 0;

411 
i
 = 0; i < 
SAVER6_MAXBOLTS
; i++) {

412 
s
->
bﬁts
[
i
].
duøti⁄
 = 0;

413 
n
 = 0;Ç < 
SAVER6_MAXFORKS
;Ç++) {

414 
s
->
bﬁts
[
i
].
f‹ks
[
n
].
vÆid
 = 0;

418 
°©e
->
™im©e_öãrvÆ
 = 
SAVER6_DELAY
;

419 
	}
}

421 
	$ßvî6_døwf‹k
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
dñëe
)

423 
i
;

425 if(
dñëe
Ë
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

426 
i
 = 0; i < 
SAVER6_THICKNESS
; i++) {

427 if(!
dñëe
) {

428 if((
i
 < 2Ë|| (ò>
SAVER6_THICKNESS
 - 2))

429 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
,

430 
GR_COLOR_CORNFLOWERBLUE
);

431 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_WHITE
);

433 
	`GrPﬁy
(
°©e
->
maö_wödow
, sèã->
maö_gc
,

434 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vÆid
,

435 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[
i
]);

437 
	}
}

439 
	$ßvî6_døwbﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
dñëe
)

441 
n
;

443 
n
 = 0;Ç < 
SAVER6_MAXFORKS
;Ç++)

444 if(
s
->
bﬁts
[
bﬁt
].
f‹ks
[
n
].
vÆid
)

445 
	`ßvî6_døwf‹k
(
°©e
, 
s
, 
bﬁt
, 
n
, 
dñëe
);

446 
	}
}

448 
	$ßvî6_døwlighäög
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
dñëe
)

450 
i
;

452 
i
 = 0; i < 
SAVER6_MAXBOLTS
; i++) {

453 if(
s
->
bﬁts
[
i
].
duøti⁄
) {

454 if(
dñëe
Ë
s
->
bﬁts
[
i
].
duøti⁄
--;

455 
	`ßvî6_døwbﬁt
(
°©e
, 
s
, 
i
, 
dñëe
);

458 
	}
}

460 
	$ßvî6_exposuª
(
n°©e
 *
°©e
)

462 
s6°©e
 *
s
 = 
°©e
->
¥iv
;

464 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

466 
	`ßvî6_døwlighäög
(
°©e
, 
s
, 0);

467 
	}
}

469 
	$ßvî6_£tvîti˚s
(
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
vît
, 
GR_COORD
 
x
,

470 
GR_COORD
 
y
)

472 
i
;

474 
i
 = 0; i < 
SAVER6_THICKNESS
; i++) {

475 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[
i
][
vît
].
x
 = x + i;

476 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[
i
][
vît
].
y
 = y;

478 
	}
}

480 
	$ßvî6_≥πurb
(
n°©e
 *
°©e
, 
GR_COORD
 *
x
, GR_COORD *
y
, 
max≥πurb
)

482 *
x
 +()
	`FRANDRANGE
(0, (
max≥πurb
 - 1.0)) -

483 ()(
max≥πurb
 / 2.0);

484 if(*
x
 < 0) *x = 0;

485 if(*
x
 > (
°©e
->
si
.
cﬁs
 - 1)) *x = state->si.cols - 1;

487 *
y
 +()
	`FRANDRANGE
(0, (
max≥πurb
 - 1.0)) -

488 ()(
max≥πurb
 / 2.0);

489 if(*
y
 < 0) *y = 0;

490 if(*
y
 > (
°©e
->
si
.
cﬁs
 - 1)) *y = state->si.cols - 1;

491 
	}
}

493 
	$ßvî6_makef‹k
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
GR_COORD
 
x
,

494 
GR_COORD
 
y
)

496 
i
, 
vîti˚s
;

497 
Àngth
, 
ö¸
, 
pos
, 
™gÀ
, 
sˇÀ
;

498 
GR_COORD
 
ex
, 
ey
, 
nx
, 
ny
, 
xÀn
, 
yÀn
;

500 
	`ßvî6_£tvîti˚s
(
s
, 
bﬁt
, 
f‹k
, 0, 
x
 , 
y
);

502 
sˇÀ
 = ()(
°©e
->
si
.
rows
 - 
y
) / ()state->si.rows;

504 
vîti˚s
 = ()(
sˇÀ
 * ()
	`RANDRANGE
(
SAVER6_MINFULLVERTICES
,

505 
SAVER6_MAXVERTICES
));

507 if(
vîti˚s
 < 
SAVER6_MINVERTICES
) vertices = SAVER6_MINVERTICES;

509 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vÆid
 = 
vîti˚s
;

511 
ey
 = 
°©e
->
si
.
rows
 - 
SAVER6_MAXEND_Y
 +

512 ()
	`FRANDRANGE
(0, 
SAVER6_MAXEND_Y
 - 1.0);

513 if((
ey
 - 
y
Ë<0Ëey = 
SAVER6_MINDROP
;

514 if(
ey
 >(
°©e
->
si
.
rows
 - 1))Éy = state->si.rows - 1;

516 if(!
f‹k
) {

517 
ex
 = 
x
 + 
	`FRANDRANGE
(0, ((
°©e
->
si
.
cﬁs
 - 1.0) / 2.0));

519 
ex
 = 
x
 + (
	`FRANDRANGE
(0, (
ey
 - 
y
)) / 2.0) - ((ey - y) / 2.0);

522 if(
ex
 >
°©e
->
si
.
cﬁs
)Éx = state->si.cols - 1;

523 if(
ex
 < 0)Éx = 0;

525 
xÀn
 = 
	`MAX
(
x
, 
ex
Ë- 
	`MIN
(x,Éx);

526 
yÀn
 = 
	`MAX
(
y
, 
ey
Ë- 
	`MIN
(y,Éy);

528 
Àngth
 = 
	`sqπ
((()(
xÀn
 * xÀnË+ ()(
yÀn
 * ylen)));

529 
ö¸
 = 
Àngth
 / (
vîti˚s
 - 1);

530 
™gÀ
 = 
	`©™
((()
xÀn
 / ()
yÀn
));

532 
i
 = 
vîti˚s
 - 1; i ; i--) {

533 
pos
 = (
ö¸
 * (
i
 - 1)Ë+ (
	`FRANDRANGE
(0, 
SAVER6_MAXZIGZAG
) -

534 (()
SAVER6_MAXZIGZAG
 / 2.0));

535 if(
pos
 < 0)Öos = 0;

536 if(
pos
 > 
Àngth
)Öos =Üength;

537 
nx
 = 
x
 - (
pos
 * 
	`sö
(
™gÀ
));

538 
ny
 = 
y
 + 
pos
 * 
	`cos
(
™gÀ
);

539 
	`ßvî6_≥πurb
(
°©e
, &
nx
, &
ny
, 
SAVER6_MAXZIGZAG
);

540 
	`ßvî6_£tvîti˚s
(
s
, 
bﬁt
, 
f‹k
, 
i
, 
nx
 , 
ny
);

542 
	}
}

544 
	$ßvî6_makef‹ks
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
,

545 *
vît
, *
√xtf‹k
)

547 
thisvît
 = 1, 
thisf‹k
;

548 
¥ob
;

550 if(*
vît
 =(
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vÆid
 - 1))  0;

551 if(*
√xtf‹k
 =
SAVER6_MAXFORKS
)  0;

553 
¥ob
 = ()
SAVER6_FORK_PROBABILITY
 * (()*
vît
 /

554 ()
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vÆid
) *

555 (1.0 / (()
f‹k
 + 1.0));

556 if(()
	`FRANDRANGE
(0, 1Ë< 
¥ob
) {

557 
thisf‹k
 = *
√xtf‹k
;

558 
	`ßvî6_makef‹k
(
°©e
, 
s
, 
bﬁt
, 
thisf‹k
,

559 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[0][*
vît
].
x
,

560 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[0][*
vît
].
y
);

561 *
√xtf‹k
 += 1;

562 
	`ßvî6_makef‹ks
(
°©e
, 
s
, 
bﬁt
, 
thisf‹k
, &
thisvît
,

563 
√xtf‹k
));

566 *
vît
 += 1;

569 
	}
}

571 
	$ßvî6_makebﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
)

573 
GR_COORD
 
x
;

574 
vît
 = 1, 
√xtf‹k
 = 1, 
n
;

576 
n
 = 0;Ç < 
SAVER6_MAXFORKS
;Ç++)

577 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
n
].
vÆid
 = 0;

579 
x
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
 - 1);

581 
	`ßvî6_makef‹k
(
°©e
, 
s
, 
bﬁt
, 0, 
x
, 0);

583 
	`ßvî6_makef‹ks
(
°©e
, 
s
, 
bﬁt
, 0, &
vît
, &
√xtf‹k
));

584 
	}
}

586 
	$ßvî6_√wbﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
)

588 
i
;

590 
i
 = 0; i < 
SAVER6_MAXBOLTS
; i++) {

591 if(!
s
->
bﬁts
[
i
].
duøti⁄
) {

592 
	`ßvî6_makebﬁt
(
°©e
, 
s
, 
i
);

593 
s
->
bﬁts
[
i
].
duøti⁄
 = 
	`RANDRANGE
(
SAVER6_MINDURATION
,

594 
SAVER6_MAXDURATION
);

595 
	`ßvî6_døwbﬁt
(
°©e
, 
s
, 
i
, 0);

600 
s
->
√w_bﬁt_time
 = 
	`RANDRANGE
(1, 
SAVER6_MAXNEWBOLTTIME
);

601 
	}
}

603 
	$ßvî6_≥πurb_bﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
)

605 
m
, 
o
;

606 
GR_COORD
 
x
, 
ox
, 
y
, 
oy
;

608 
m
 = 1; m < 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vÆid
; m++) {

609 
ox
 = 
x
 = 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[0][
m
].x;

610 
oy
 = 
y
 = 
s
->
bﬁts
[
bﬁt
].
f‹ks
[
f‹k
].
vîti˚s
[0][
m
].y;

611 
	`ßvî6_≥πurb
(
°©e
, &
x
, &
y
, 
SAVER6_MAXZIGZAG
);

612 
	`ßvî6_£tvîti˚s
(
s
, 
bﬁt
, 
f‹k
, 
m
, 
x
, 
y
);

613 
o
 = 
f‹k
 + 1; o < 
SAVER6_MAXFORKS
; o++) {

614 if((
s
->
bﬁts
[
bﬁt
].
f‹ks
[
o
].
vîti˚s
[0][0].
x
 =
ox
) &&

615 (
s
->
bﬁts
[
bﬁt
].
f‹ks
[
o
].
vîti˚s
[0][0].
y


616 =
oy
)) {

617 
	`ßvî6_£tvîti˚s
(
s
, 
bﬁt
, 
o
, 0, 
x
, 
y
);

621 
	}
}

623 
	$ßvî6_≥πurb_lighäög
(
n°©e
 *
°©e
, 
s6°©e
 *
s
)

625 
i
, 
n
;

627 
i
 = 0; i < 
SAVER6_MAXBOLTS
; i++) {

628 if(!
s
->
bﬁts
[
i
].
duøti⁄
) ;

629 
n
 = 0;Ç < 
SAVER6_MAXFORKS
;Ç++) {

630 if(!
s
->
bﬁts
[
i
].
f‹ks
[
n
].
vÆid
) ;

631 
	`ßvî6_≥πurb_bﬁt
(
°©e
, 
s
, 
i
, 
n
);

634 
	}
}

636 
	$ßvî6_™im©e
(
n°©e
 *
°©e
)

638 
s6°©e
 *
s
 = 
°©e
->
¥iv
;

640 
	`ßvî6_døwlighäög
(
°©e
, 
s
, 1);

641 
	`ßvî6_≥πurb_lighäög
(
°©e
, 
s
);

642 
	`ßvî6_døwlighäög
(
°©e
, 
s
, 0);

644 if(!
s
->
√w_bﬁt_time
--Ë
	`ßvî6_√wbﬁt
(
°©e
, s);

645 
	}
}

649 
	$ßvî7_døw°¨
(
n°©e
 *
°©e
, 
s7°©e
 *
s
)

651 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
SAVER7_STARCOLOUR
);

652 
	`GrFûlEŒù£
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
s
->
°¨x
, s->
°¨y
,

653 
SAVER7_STARRADIUS
, SAVER7_STARRADIUS);

654 
	}
}

656 
	$ßvî7_døw∂™ë
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
, 
îa£
)

658 if(
îa£
Ë
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

659 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
s
->
∂™ës
[
∂™ë
].
cﬁour
);

661 if((
s
->
∂™ës
[
∂™ë
].
ax
 < 0Ë|| (s->∂™ës[∂™ë].
ay
 < 0) ||

662 (
s
->
∂™ës
[
∂™ë
].
ax
 >
°©e
->
si
.
cﬁs
) ||

663 (
s
->
∂™ës
[
∂™ë
].
ay
 >
°©e
->
si
.
rows
)) {

667 
	`GrFûlEŒù£
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
s
->
∂™ës
[
∂™ë
].
ax
,

668 
s
->
∂™ës
[
∂™ë
].
ay
,

669 
SAVER7_PLANETRADIUS
, SAVER7_PLANETRADIUS);

670 
	}
}

672 
	$ßvî7_ˇlc_∂™ë_posôi⁄
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
)

674 if(
s
->
∂™ës
[
∂™ë
].
r
 > -
SAVER7_ALMOSTDIST
) {

675 
s
->
∂™ës
[
∂™ë
].
ax
 = ()((Ë
°©e
->
si
.
cﬁs
 *

676 (0.5 + (
s
->
∂™ës
[
∂™ë
].
x
 / (s->∂™ës[∂™ë].
r
 +

677 
SAVER7_DIST
))));

678 
s
->
∂™ës
[
∂™ë
].
ay
 = ()((Ë
°©e
->
si
.
rows
 *

679 (0.5 + (
s
->
∂™ës
[
∂™ë
].
y
 / (s->∂™ës[∂™ë].
r
 +

680 
SAVER7_DIST
))));

682 
s
->
∂™ës
[
∂™ë
].
ax
 = -1;

683 
s
->
∂™ës
[
∂™ë
].
ay
 = -1;

685 
	}
}

687 
	$ßvî7_öô
(
n°©e
 *
°©e
)

689 
i
;

690 
s7°©e
 *
s
 = 
	`my_mÆloc
((s7state));

691 
°©e
->
¥iv
 = 
s
;

693 
s
->
°¨x
 = 
°©e
->
si
.
cﬁs
 / 2;

694 
s
->
°¨y
 = 
°©e
->
si
.
rows
 / 2;

696 
i
 = 0; i < 
SAVER7_PLANETS
; i++) {

697 
s
->
∂™ës
[
i
].
r
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTDIM
,

698 
SAVER7_MAX_STARTDIM
);

699 
s
->
∂™ës
[
i
].
x
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTDIM
,

700 
SAVER7_MAX_STARTDIM
);

701 
s
->
∂™ës
[
i
].
y
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTDIM
,

702 
SAVER7_MAX_STARTDIM
);

703 
s
->
∂™ës
[
i
].
rv
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTVEL
,

704 
SAVER7_MAX_STARTVEL
);

705 
s
->
∂™ës
[
i
].
xv
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTVEL
,

706 
SAVER7_MAX_STARTVEL
);

707 
s
->
∂™ës
[
i
].
yv
 = 
	`FRANDRANGE
(
SAVER7_MIN_STARTVEL
,

708 
SAVER7_MAX_STARTVEL
);

709 
s
->
∂™ës
[
i
].
cﬁour
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
ncﬁ‹s
 - 1);

710 
	`ßvî7_ˇlc_∂™ë_posôi⁄
(
°©e
, 
s
, 
i
);

711 
	`ßvî7_døw∂™ë
(
°©e
, 
s
, 
i
, 0);

714 
	`ßvî7_døw°¨
(
°©e
, 
s
);

716 
°©e
->
™im©e_öãrvÆ
 = 
SAVER7_DELAY
;

717 
	}
}

719 
	$ßvî7_exposuª
(
n°©e
 *
°©e
)

721 
i
;

722 
s7°©e
 *
s
 = 
°©e
->
¥iv
;

724 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

726 
i
 = 0; i < 
SAVER7_PLANETS
; i++)

727 
	`ßvî7_døw∂™ë
(
°©e
, 
s
, 
i
, 0);

729 
	`ßvî7_døw°¨
(
°©e
, 
s
);

730 
	}
}

732 
	$ßvî7_movïœ√t
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
)

734 
di°
;

735 
ac˚l
;

737 
di°
 = (
s
->
∂™ës
[
∂™ë
].
x
 * s->planets[planet].x) +

738 (
s
->
∂™ës
[
∂™ë
].
y
 * s->planets[planet].y) +

739 (
s
->
∂™ës
[
∂™ë
].
r
 * s->planets[planet].r);

740 if(
di°
 < 
SAVER7_COLLIDE
) dist = SAVER7_COLLIDE;

741 
di°
 = 
	`sqπ
(dist);

742 
di°
 = dist * dist * dist;

744 #ifde‡
SAVER7_USE_DAMPING


745 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
r
 * 
SAVER7_G
 / 
di°
;

746 if(
ac˚l
 > 
SAVER7_MAX_ACCEL
)áccel = SAVER7_MAX_ACCEL;

747 if(
ac˚l
 < -
SAVER7_MAX_ACCEL
)áccel = -SAVER7_MAX_ACCEL;

748 
s
->
∂™ës
[
∂™ë
].
rv
 = (s->∂™ës[∂™ë].rv + 
ac˚l
) *

749 
SAVER7_DAMPING_FACTOR
;

750 
s
->
∂™ës
[
∂™ë
].
r
 +s->∂™ës[∂™ë].
rv
;

751 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
x
 * 
SAVER7_G
 / 
di°
;

752 if(
ac˚l
 > 
SAVER7_MAX_ACCEL
)áccel = SAVER7_MAX_ACCEL;

753 if(
ac˚l
 < -
SAVER7_MAX_ACCEL
)áccel = -SAVER7_MAX_ACCEL;

754 
s
->
∂™ës
[
∂™ë
].
xv
 = (s->∂™ës[∂™ë].xv + 
ac˚l
) *

755 
SAVER7_DAMPING_FACTOR
;

756 
s
->
∂™ës
[
∂™ë
].
x
 +s->∂™ës[∂™ë].
xv
;

757 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
y
 * 
SAVER7_G
 / 
di°
;

758 if(
ac˚l
 > 
SAVER7_MAX_ACCEL
)áccel = SAVER7_MAX_ACCEL;

759 if(
ac˚l
 < -
SAVER7_MAX_ACCEL
)áccel = -SAVER7_MAX_ACCEL;

760 
s
->
∂™ës
[
∂™ë
].
yv
 = (s->∂™ës[∂™ë].yv + 
ac˚l
) *

761 
SAVER7_DAMPING_FACTOR
;

762 
s
->
∂™ës
[
∂™ë
].
y
 +s->∂™ës[∂™ë].
yv
;

764 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
r
 * 
SAVER7_G
 / 
di°
;

765 
s
->
∂™ës
[
∂™ë
].
rv
 +
ac˚l
;

766 
s
->
∂™ës
[
∂™ë
].
r
 +s->∂™ës[∂™ë].
rv
;

767 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
x
 * 
SAVER7_G
 / 
di°
;

768 
s
->
∂™ës
[
∂™ë
].
xv
 +
ac˚l
;

769 
s
->
∂™ës
[
∂™ë
].
x
 +s->∂™ës[∂™ë].
xv
;

770 
ac˚l
 = 
s
->
∂™ës
[
∂™ë
].
y
 * 
SAVER7_G
 / 
di°
;

771 
s
->
∂™ës
[
∂™ë
].
yv
 +
ac˚l
;

772 
s
->
∂™ës
[
∂™ë
].
y
 +s->∂™ës[∂™ë].
yv
;

774 
	}
}

776 
	$ßvî7_™im©e
(
n°©e
 *
°©e
)

778 
i
;

779 
s7°©e
 *
s
 = 
°©e
->
¥iv
;

781 
i
 = 0; i < 
SAVER7_PLANETS
; i++) {

782 
	`ßvî7_movïœ√t
(
°©e
, 
s
, 
i
);

783 
	`ßvî7_døw∂™ë
(
°©e
, 
s
, 
i
, 1);

784 
	`ßvî7_ˇlc_∂™ë_posôi⁄
(
°©e
, 
s
, 
i
);

785 
	`ßvî7_døw∂™ë
(
°©e
, 
s
, 
i
, 0);

787 
	`ßvî7_døw°¨
(
°©e
, 
s
);

788 
	}
}

793 
	$ßvî8_öô
(
n°©e
 *
°©e
)

795 
ªd
 = 0, 
gªí
 = 0, 
blue
 = 0, 
°ï
, 
i
 = 0;

797 
s8°©e
 *
s
 = 
	`my_mÆloc
((s8state));

798 
°©e
->
¥iv
 = 
s
;

800 
s
->
cuºít_löe
 = 0;

802 
°ï
 = 512 / 
SAVER8_NUMCOLOURS
;

804 
gªí
 = 255; gªí > 0; gªí -
°ï
, 
blue
 +°ï, 
i
++)

805 
	`GrFödCﬁ‹
(
	`GR_RGB
(0, 
gªí
, 
blue
), &
s
->
cﬁours
[
i
]);

806 
blue
 = 255; bluê> 0; bluê-
°ï
, 
ªd
 +°ï, 
i
++)

807 
	`GrFödCﬁ‹
(
	`GR_RGB
(
ªd
, 0, 
blue
), &
s
->
cﬁours
[
i
]);

809 
s
->
rows
 = 
	`my_mÆloc
((
GR_PIXELVAL
Ë* 
°©e
->
si
.
cﬁs
 *

810 
SAVER8_LINES_PER_FRAME
);

812 
°©e
->
™im©e_öãrvÆ
 = 
SAVER8_DELAY1
;

813 
	}
}

815 
	$ßvî8_døw∑âîn
(
n°©e
 *
°©e
)

817 
x
, 
y
, 
cﬁ
, 
√wÁ˘‹
, 
löes
 = 
SAVER8_LINES_PER_FRAME
;

818 
s8°©e
 *
s
 = 
°©e
->
¥iv
;

819 
GR_PIXELVAL
 *
p
 = 
s
->
rows
;

821 if(!
s
->
cuºít_löe
) {

822 
°©e
->
™im©e_öãrvÆ
 = 
SAVER8_DELAY1
;

824 
√wÁ˘‹
 = 
	`RANDRANGE
(
SAVER8_MINFACTOR
,

825 
SAVER8_MAXFACTOR
);

826 } 
√wÁ˘‹
 =
s
->
Á˘‹
);

827 
s
->
Á˘‹
 = 
√wÁ˘‹
;

830 
y
 = 
s
->
cuºít_löe
;

831 
s
->
cuºít_löe
 < 
°©e
->
si
.
rows
) {

832 if(!--
löes
) ;

833 
x
 = 0; x < 
°©e
->
si
.
cﬁs
; x++) {

834 
cﬁ
 = ((((
x
 * xË+ (
s
->
cuºít_löe
 * s->current_line))

835 / 
s
->
Á˘‹
Ë% 
SAVER8_NUMCOLOURS
);

836 *
p
++ = 
s
->
cﬁours
[
cﬁ
];

838 
s
->
cuºít_löe
++;

841 
	`GrAªa
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 0, 
y
, sèã->
si
.
cﬁs
,

842 
s
->
cuºít_löe
 - 
y
, s->
rows
, 
MWPF_PIXELVAL
);

844 if(
löes
) {

845 
°©e
->
™im©e_öãrvÆ
 = 
SAVER8_DELAY2
;

846 
s
->
cuºít_löe
 = 0;

848 
	}
}

850 
	$ßvî8_exposuª
(
n°©e
 *
°©e
)

852 
s8°©e
 *
s
 = 
°©e
->
¥iv
;

854 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

855 
s
->
cuºít_löe
 = 0;

856 
	`ßvî8_døw∑âîn
(
°©e
);

857 
	}
}

859 
	$ßvî8_™im©e
(
n°©e
 *
°©e
)

861 
	`ßvî8_døw∑âîn
(
°©e
);

862 
	}
}

866 
	$ßvî9_öô
(
n°©e
 *
°©e
)

868 
s9°©e
 *
s
 = 
	`my_mÆloc
((s9state));

869 
°©e
->
¥iv
 = 
s
;

871 
s
->
pid
 = 
	`ˇ±uª_s¸ìn
(
°©e
);

873 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

874 
	`GrLöe
(
s
->
pid
, 
°©e
->
maö_gc
, 0, 0, sèã->
si
.
cﬁs
, 0);

876 
°©e
->
™im©e_öãrvÆ
 = 
SAVER9_DELAY
;

877 
	}
}

879 
	$ßvî9_exposuª
(
n°©e
 *
°©e
)

881 
s9°©e
 *
s
 = 
°©e
->
¥iv
;

883 
	`GrC›yAªa
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 0, 0, sèã->
si
.
cﬁs
,

884 
°©e
->
si
.
rows
, 
s
->
pid
, 0, 0, 0);

885 
	}
}

887 
	$ßvî9_™im©e
(
n°©e
 *
°©e
)

889 
GR_COORD
 
x
, 
y
;

890 
GR_SIZE
 
w
, 
h
;

891 
s9°©e
 *
s
 = 
°©e
->
¥iv
;

893 
x
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
 - 2);

894 
y
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
rows
 - 2);

895 
w
 = 
	`RANDRANGE
(1, 
°©e
->
si
.
cﬁs
 - 
x
);

896 
h
 = 
	`RANDRANGE
(1, 
°©e
->
si
.
rows
 - 
y
);

898 
	`GrC›yAªa
(
s
->
pid
, 
°©e
->
maö_gc
, 
x
, 
y
 + 1, 
w
, 
h
, s->pid, x, y, 0);

899 
	`GrC›yAªa
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
x
, 
y
 + 1, 
w
, 
h
, 
s
->
pid
,

900 
x
, 
y
, 0);

901 
	}
}

905 
	$ßvî10_öô
(
n°©e
 *
°©e
)

907 
s10°©e
 *
s
 = 
	`my_mÆloc
((s10state));

908 
°©e
->
¥iv
 = 
s
;

910 
s
->
s¸ìn
 = 
	`ˇ±uª_s¸ìn
(
°©e
);

911 
s
->
•Ÿ
 = 
	`GrNewPixm≠
(
SAVER10_SPOTDIA
 + 
SAVER10_OVERSIZE
 * 2,

912 
SAVER10_SPOTDIA
 + 
SAVER10_OVERSIZE
 * 2, 
NULL
);

914 
s
->
x
 = 
	`RANDRANGE
((
SAVER10_SPOTDIA
 / 2Ë+ 
SAVER10_OVERSIZE
,

915 
°©e
->
si
.
cﬁs
 - 1 - (
SAVER10_SPOTDIA
 / 2) -

916 
SAVER10_OVERSIZE
);

917 
s
->
y
 = 
	`RANDRANGE
((
SAVER10_SPOTDIA
 / 2Ë+ 
SAVER10_OVERSIZE
,

918 
°©e
->
si
.
rows
 - 1 - (
SAVER10_SPOTDIA
 / 2) -

919 
SAVER10_OVERSIZE
);

920 
s
->
dúe˘i⁄
 = 
	`FRANDRANGE
(0, 2 * 
PI
) - PI;

922 
°©e
->
™im©e_öãrvÆ
 = 
SAVER10_DELAY
;

923 
	}
}

925 
	$ßvî10_exposuª
(
n°©e
 *
°©e
)

927 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

928 
	}
}

930 
	$ßvî10_™im©e
(
n°©e
 *
°©e
)

932 
i
, 
x
, 
y
, 
w
, 
xx
, 
yy
, 
ªåy
;

933 
s10°©e
 *
s
 = 
°©e
->
¥iv
;

934 
d
, 
√wx
, 
√wy
;

937 
√wx
 = 
s
->
x
 + 
	`cos
(s->
dúe˘i⁄
Ë* 
SAVER10_VELOCITY
;

938 
√wy
 = 
s
->
y
 + 
	`sö
(s->
dúe˘i⁄
Ë* 
SAVER10_VELOCITY
;

939 if((
√wx
 < (
SAVER10_SPOTDIA
 / 2Ë+ 
SAVER10_OVERSIZE
) ||

940 (
√wx
 > 
°©e
->
si
.
cﬁs
 - (
SAVER10_SPOTDIA
 / 2)

941 - 
SAVER10_OVERSIZE
) ||

942 (
√wy
 < (
SAVER10_SPOTDIA
 / 2) + 3) ||

943 (
√wy
 > 
°©e
->
si
.
rows
 - (
SAVER10_SPOTDIA
 / 2)

944 - 
SAVER10_OVERSIZE
)) {

945 
s
->
dúe˘i⁄
 = 
	`FRANDRANGE
(0, 2 * 
PI
);

946 
ªåy
 = 1;

947 } 
ªåy
 = 0;

948 } 
ªåy
);

950 
s
->
x
 = 
√wx
;

951 
s
->
y
 = 
√wy
;

953 
y
 = 
s
->y - (
SAVER10_SPOTDIA
 / 2);

954 
yy
 = 
SAVER10_OVERSIZE
;

955 
i
 = 0; i < 
SAVER10_SPOTDIA
; i++) {

956 
d
 = 
	`sö
(
	`acos
((()
i
/(()
SAVER10_SPOTDIA
 / 2.0)) - 1))

957 * ()
SAVER10_SPOTDIA
 / 2.0;

958 
w
 = (Ë2 * 
d
;

959 
x
 = (Ë
s
->x - 
d
;

960 
xx
 = (Ë(
SAVER10_SPOTDIA
 / 2Ë- 
d
 + 
SAVER10_OVERSIZE
;

961 if(!
w
) ;

962 
	`GrC›yAªa
(
s
->
•Ÿ
, 
°©e
->
maö_gc
, 
xx
, 
yy
, 
w
, 1, s->
s¸ìn
,

963 
x
, 
y
, 0);

964 
y
++;

965 
yy
++;

968 
x
 = 
s
->x - (
SAVER10_SPOTDIA
 / 2Ë- 
SAVER10_OVERSIZE
;

969 
y
 = 
s
->y - (
SAVER10_SPOTDIA
 / 2Ë- 
SAVER10_OVERSIZE
;

970 if(
x
 < 0) x = 0;

971 if(
y
 < 0) y = 0;

973 
	`GrC›yAªa
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
x
, 
y
, 
SAVER10_SPOTDIA
 +

974 2 * 
SAVER10_OVERSIZE
, 
SAVER10_SPOTDIA
 +

975 2 * 
SAVER10_OVERSIZE
, 
s
->
•Ÿ
, 0, 0, 0);

976 
	}
}

978 
	$ßvî11_öô
(
n°©e
 *
°©e
)

980 
s11°©e
 *
s
 = 
	`my_mÆloc
((s11state));

981 
°©e
->
¥iv
 = 
s
;

983 
°©e
->
™im©e_öãrvÆ
 = 
SAVER11_DELAY
;

984 
	}
}

986 
	$ßvî11_exposuª
(
n°©e
 *
°©e
)

988 
s11°©e
 *
s
 = 
°©e
->
¥iv
;

990 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

992 
	`make_øndom_squ¨e
(
°©e
, 
SAVER11_MIN_BRIGHTNESS
, 
SAVER11_MIN_SIZE
,

993 
SAVER11_MAX_SIZE
, 0, &
s
->
x
, &s->
y
, &s->
size
);

994 
	}
}

996 
	$ßvî11_™im©e
(
n°©e
 *
°©e
)

998 
s11°©e
 *
s
 = 
°©e
->
¥iv
;

1000 
	`make_øndom_squ¨e
(
°©e
, 
SAVER11_MIN_BRIGHTNESS
, 
SAVER11_MIN_SIZE
,

1001 
SAVER11_MAX_SIZE
, 0, &
s
->
x
, &s->
y
, &s->
size
);

1003 
	`GrFûlRe˘
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
s
->
x
, s->
y
, s->
size
,

1004 
s
->
size
);

1005 
	}
}

1007 
	$ßvî12_√w_sh≠e
(
n°©e
 *
°©e
)

1009 
s12°©e
 *
s
 = 
°©e
->
¥iv
;

1011 
	`make_øndom_squ¨e
(
°©e
, 
SAVER12_MIN_BRIGHTNESS
, 
SAVER12_MIN_SIZE
,

1012 
SAVER12_MAX_SIZE
, 1, &
s
->
x
, &s->
y
, &s->
size
);

1014 
s
->
t
 = 0;

1015 
s
->
kt
 = 
	`RANDRANGE
(0, s->
size
);

1016 
	}
}

1018 
	$ßvî12_öô
(
n°©e
 *
°©e
)

1020 
s12°©e
 *
s
 = 
	`my_mÆloc
((s12state));

1021 
°©e
->
¥iv
 = 
s
;

1023 
	`ßvî12_√w_sh≠e
(
°©e
);

1025 
°©e
->
™im©e_öãrvÆ
 = 
SAVER12_DELAY
;

1026 
	}
}

1028 
	$ßvî12_exposuª
(
n°©e
 *
°©e
)

1030 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

1032 
	`ßvî12_√w_sh≠e
(
°©e
);

1033 
	}
}

1035 
	$ßvî12_™im©e
(
n°©e
 *
°©e
)

1037 
x1
, 
y1
, 
x2
, 
y2
;

1038 
s12°©e
 *
s
 = 
°©e
->
¥iv
;

1040 if(
s
->
t
 >s->
size
Ë
	`ßvî12_√w_sh≠e
(
°©e
);

1042 
x1
 = 0; x1 < 
s
->
size
; x1++) {

1043 
y1
 = (
x1
 ^ ((
s
->
t
 + s->
kt
Ë% s->
size
)) % s->size;

1044 
x2
 = (
x1
 % 
s
->
size
Ë+ s->
x
;

1045 
y2
 = 
y1
 + 
s
->
y
;

1046 
	`GrPoöt
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 
x2
, 
y2
);

1049 
s
->
t
++;

1050 
	}
}

1054 
	$ßvî13_öô
(
n°©e
 *
°©e
)

1056 
s13°©e
 *
s
 = 
	`my_mÆloc
((s13state));

1057 
°©e
->
¥iv
 = 
s
;

1059 
s
->
s¸ìn
 = 
	`my_mÆloc
((
GR_PIXELVAL
Ë* 
°©e
->
si
.
rows
 *

1060 
°©e
->
si
.
cﬁs
);

1061 
s
->
rows
 = 
	`my_mÆloc
((
GR_PIXELVAL
Ë* 
°©e
->
si
.
cﬁs
 *

1062 
SAVER13_ZOOM_FACTOR
 * 
SAVER13_ROWS_BUFFER
);

1063 
s
->
rownum
 = 0;

1065 
s
->
x
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
cﬁs
 - (state->si.cols /

1066 
SAVER13_ZOOM_FACTOR
));

1067 
s
->
x
 = 
	`RANDRANGE
(0, 
°©e
->
si
.
rows
 - (state->si.rows /

1068 
SAVER13_ZOOM_FACTOR
));

1069 
s
->
dúe˘i⁄
 = 
	`FRANDRANGE
(0, 2 * 
PI
) - PI;

1071 
°©e
->
™im©e_öãrvÆ
 = 1;

1073 #i‡
CAPTURESCREEN_DELAY


1074 
	`m¶ìp
(
CAPTURESCREEN_DELAY
);

1077 
	`GrRódAªa
(
GR_ROOT_WINDOW_ID
, 0, 0, 
°©e
->
si
.
cﬁs
, sèã->si.
rows
,

1078 
s
->
s¸ìn
);

1079 
	}
}

1081 
	$ßvî13_exposuª
(
n°©e
 *
°©e
)

1083 
s13°©e
 *
s
 = 
°©e
->
¥iv
;

1084 
	`GrCÀ¨Wödow
(
°©e
->
maö_wödow
, 0);

1085 
s
->
rownum
 = 0;

1086 
	}
}

1088 
	$ßvî13_move_p‹èl
(
n°©e
 *
°©e
)

1090 
ªåy
;

1091 
√wx
, 
√wy
;

1092 
s13°©e
 *
s
 = 
°©e
->
¥iv
;

1095 
√wx
 = 
s
->
x
 + 
	`cos
(s->
dúe˘i⁄
Ë* 
SAVER13_VELOCITY
;

1096 
√wy
 = 
s
->
y
 + 
	`sö
(s->
dúe˘i⁄
Ë* 
SAVER13_VELOCITY
;

1097 if(
√wx
 < 0 ||Çewx > 
°©e
->
si
.
cﬁs
 -

1098 (
°©e
->
si
.
cﬁs
 / 
SAVER13_ZOOM_FACTOR
) ||

1099 
√wy
 < 0 ||Çewy > 
°©e
->
si
.
rows
 -

1100 (
°©e
->
si
.
rows
 / 
SAVER13_ZOOM_FACTOR
)) {

1101 
s
->
dúe˘i⁄
 = 
	`FRANDRANGE
(0, 2 * 
PI
);

1102 
ªåy
 = 1;

1103 } 
ªåy
 = 0;

1104 } 
ªåy
);

1105 
s
->
x
 = 
√wx
;

1106 
s
->
y
 = 
√wy
;

1107 
	}
}

1109 
	$ßvî13_™im©e
(
n°©e
 *
°©e
)

1111 
rows
, 
r
, 
y
, 
i
, 
n
;

1112 
s13°©e
 *
s
 = 
°©e
->
¥iv
;

1113 
GR_PIXELVAL
 *
§c
, *
d°
;

1115 
rows
 = (
°©e
->
si
.row†/ 
SAVER13_ZOOM_FACTOR
Ë- 
s
->
rownum
;

1116 if(
rows
 > 
SAVER13_ROWS_BUFFER
)Ñows = SAVER13_ROWS_BUFFER;

1117 
d°
 = 
s
->
rows
;

1118 
y
 = 
s
->y + s->
rownum
;

1119 
r
 = 0;Ñ < 
rows
;Ñ++) {

1120 
§c
 = &
s
->
s¸ìn
[(
y
++ * 
°©e
->
si
.
cﬁs
Ë+ ()s->
x
];

1121 
i
 = 0; i < 
SAVER13_ZOOM_FACTOR
; i++)

1122 
n
 = 0;Ç < 
°©e
->
si
.
cﬁs
;Ç++)

1123 *
d°
++ = 
§c
[
n
 / 
SAVER13_ZOOM_FACTOR
];

1126 
	`GrAªa
(
°©e
->
maö_wödow
, sèã->
maö_gc
, 0, 
s
->
rownum
 *

1127 
SAVER13_ZOOM_FACTOR
, 
°©e
->
si
.
cﬁs
,

1128 
SAVER13_ZOOM_FACTOR
 * 
rows
,

1129 
s
->
rows
, 
MWPF_PIXELVAL
);

1131 
s
->
rownum
 +
rows
;

1132 if(
s
->
rownum
 >
°©e
->
si
.
rows
 / 
SAVER13_ZOOM_FACTOR
) {

1133 
s
->
rownum
 = 0;

1134 
	`ßvî13_move_p‹èl
(
°©e
);

1135 
°©e
->
™im©e_öãrvÆ
 = 
SAVER13_DELAY
;

1136 } 
°©e
->
™im©e_öãrvÆ
 = 1;

1138 
	}
}

1140 
	$öô
(
n°©e
 *
°©e
)

1142 
GR_WM_PROPERTIES
 
¥›s
;

1143 
GR_BITMAP
 
curs‹
 = 0;

1145 if(!
	`GrO≥n
()) {

1146 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

1150 
	`GrGëS¸ìnInfo
(&
°©e
->
si
);

1152 
°©e
->
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0,

1153 
°©e
->
si
.
cﬁs
, sèã->si.
rows
, 0, 
GR_COLOR_BLACK
, 0);

1155 
	`GrSñe˘Evíts
(
°©e
->
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

1156 
GR_EVENT_MASK_BUTTON_UP
 |

1157 
GR_EVENT_MASK_BUTTON_DOWN
 |

1158 
GR_EVENT_MASK_MOUSE_MOTION
 |

1159 
GR_EVENT_MASK_KEY_UP
 |

1160 
GR_EVENT_MASK_KEY_DOWN
 |

1161 
GR_EVENT_MASK_FOCUS_OUT
 |

1162 
GR_EVENT_MASK_CLOSE_REQ
);

1164 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

1165 
¥›s
.¥›†
GR_WM_PROPS_NOMOVE
 | 
GR_WM_PROPS_NODECORATE
 |

1166 
GR_WM_PROPS_NOAUTOMOVE
 | 
GR_WM_PROPS_NOAUTORESIZE
;

1167 
	`GrSëWMPr›îtõs
(
°©e
->
maö_wödow
, &
¥›s
);

1169 
°©e
->
maö_gc
 = 
	`GrNewGC
();

1170 
	`GrSëGCF‹eground
(
°©e
->
maö_gc
, 
GR_COLOR_WHITE
);

1171 
	`GrSëGCBackground
(
°©e
->
maö_gc
, 
GR_COLOR_BLACK
);

1173 
°©e
->
™im©e_öãrvÆ
 = 0;

1175 
	`§™d
(
	`time
(0));

1177 
öô_fun˘i⁄s
[
°©e
->
ßvî
](state);

1179 
	`ˇlcuœã_timeout
(
°©e
);

1181 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_SCREENSAVER
);

1183 
	`GrSëCurs‹
(
°©e
->
maö_wödow
, 1, 1, 1, 1, 0, 0, &
curs‹
, &cursor);

1185 
	`GrM≠Wödow
(
°©e
->
maö_wödow
);

1187 
	`GrSëFocus
(
°©e
->
maö_wödow
);

1190 
	}
}

1192 
	$ˇlcuœã_timeout
(
n°©e
 *
°©e
)

1194 
timevÆ
 
t
;

1195 
u
;

1197 
	`gëtimeofday
(&
t
, 
NULL
);

1198 
u
 = 
t
.
tv_u£c
 + (
°©e
->
™im©e_öãrvÆ
 * 1000);

1199 
°©e
->
timeout
.
tv_£c
 = 
t
.tv_£¯+ (
u
 / 1000000);

1200 
°©e
->
timeout
.
tv_u£c
 = 
u
 % 1000000;

1201 
	}
}

1203 
	$timeout_dñay
(
n°©e
 *
°©e
)

1205 
timevÆ
 
t
;

1206 sig√d 
s
, 
m
, 
ªt
;

1208 
	`gëtimeofday
(&
t
, 
NULL
);

1210 if(!
°©e
->
™im©e_öãrvÆ
)  0;

1212 if((
t
.
tv_£c
 > 
°©e
->
timeout
.tv_sec) ||

1213 ((
t
.
tv_£c
 =
°©e
->
timeout
.tv_sec) &&

1214 
t
.
tv_u£c
 >
°©e
->
timeout
.tv_usec))  1;

1216 
s
 = 
°©e
->
timeout
.
tv_£c
 - 
t
.tv_sec;

1217 
m
 = ((
°©e
->
timeout
.
tv_u£c
 - 
t
.tv_usec) / 1000);

1218 
ªt
 = ()((1000 * 
s
Ë+ 
m
);

1220 if(
ªt
 <= 0)  1;

1221  
ªt
;

1222 
	}
}

1224 
	$do_™im©e
(
n°©e
 *
°©e
)

1226 
timevÆ
 
t
;

1228 if(!
°©e
->
™im©e_öãrvÆ
) ;

1230 
	`gëtimeofday
(&
t
, 
NULL
);

1232 if((
t
.
tv_£c
 > 
°©e
->
timeout
.tv_sec) ||

1233 ((
t
.
tv_£c
 =
°©e
->
timeout
.tv_sec) &&

1234 (
t
.
tv_u£c
 >
°©e
->
timeout
.tv_usec))) {

1235 
™im©e_fun˘i⁄s
[
°©e
->
ßvî
](state);

1236 
	`ˇlcuœã_timeout
(
°©e
);

1238 
	}
}

1240 
	$do_s¸ìnßvî_evít
(
n°©e
 *
°©e
)

1242 
GR_EVENT_SCREENSAVER
 *
evít
 = &
°©e
->evít.
s¸ìnßvî
;

1244 if(
evít
->
a˘iv©e
 !
GR_FALSE
) {

1245 
	`Ârötf
(
°dîr
, "GotáÇon-deactivate screensaverÉvent\n");

1250 
	}
}

1252 
	$h™dÀ_evít
(
n°©e
 *
°©e
)

1254 
°©e
->
evít
.
ty≥
) {

1255 
GR_EVENT_TYPE_EXPOSURE
:

1256 
exposuª_fun˘i⁄s
[
°©e
->
ßvî
](state);

1257 
GR_EVENT_TYPE_TIMEOUT
:

1258 
GR_EVENT_TYPE_NONE
:

1260 
GR_EVENT_TYPE_SCREENSAVER
:

1261 if(
	`do_s¸ìnßvî_evít
(
°©e
))  0;

1263 
GR_EVENT_TYPE_CLOSE_REQ
:

1264 
GR_EVENT_TYPE_BUTTON_UP
:

1265 
GR_EVENT_TYPE_BUTTON_DOWN
:

1266 
GR_EVENT_TYPE_MOUSE_MOTION
:

1267 
GR_EVENT_TYPE_KEY_UP
:

1268 
GR_EVENT_TYPE_KEY_DOWN
:

1269 
GR_EVENT_TYPE_FOCUS_OUT
:

1272 
	`Ârötf
(
°dîr
, "Got unknownÉventÅype %d\n",

1273 
°©e
->
evít
.
ty≥
);

1276 
	`do_™im©e
(
°©e
);

1278 
	}
}

1280 
	$maö
(
¨gc
, *
¨gv
[])

1282 
ªt
;

1283 
n°©e
 *
°©e
 = 
	`my_mÆloc
((nstate));

1285 if(
¨gc
 == 2) {

1286 
°©e
->
ßvî
 = 
	`©oi
(
¨gv
[1]) - 1;

1287 if((
°©e
->
ßvî
Ë< 0 || (°©e->ßvî >
NUM_SAVERS
)) {

1288 
	`Ârötf
(
°dîr
, "Invalid saverÇumber \"%s\"\n",

1289 
¨gv
[1]);

1292 } 
°©e
->
ßvî
 = 0;

1294 if((
ªt
 = 
	`öô
(
°©e
))) Ñet;

1297 
	`GrGëNextEvítTimeout
(&
°©e
->
evít
, 
	`timeout_dñay
(state));

1298 } 
	`h™dÀ_evít
(
°©e
));

1300 
	`GrClo£
();

1303 
	}
}

	@demos/nanox/nsaver.h

1 #i‚de‡
NSAVER_H


2 
	#NSAVER_H


	)

36 #ifde‡
UCLIBC_HACK


37 #unde‡
RAND_MAX


38 
	#RAND_MAX
 32767

	)

41 
	#MAX
(
X
, 
Y
Ë((XË> (YË? (XË: (Y))

	)

42 
	#MIN
(
X
, 
Y
Ë((XË< (YË? (XË: (Y))

	)

43 
	#RANDRANGE
(
LO
, 
HI
Ë((
	`ønd
(Ë% (()(HIË- ()(LOË+ 1)Ë+ ()(LO))

	)

44 
	#FRANDRANGE
(
LO
, 
HI
Ë((()
	`ønd
() * (()(HI) - ()(LO)) / \

45 ()(()
RAND_MAX
 + 1.0)Ë+ ()(
LO
))

	)

47 
	#PI
 3.14159265358979323846264338327

	)

48 
	#CAPTURESCREEN_DELAY
 500

	)

49 
	#GRP_MINBRIGHTNESS
 150

	)

52 
GR_WINDOW_ID
 
	mmaö_wödow
;

53 
GR_GC_ID
 
	mmaö_gc
;

54 
GR_EVENT
 
	mevít
;

55 
	m™im©e_öãrvÆ
;

56 
timevÆ
 
	mtimeout
;

57 
	mßvî
;

58 *
	m¥iv
;

59 
GR_SCREEN_INFO
 
	msi
;

60 } 
	tn°©e
;

62 *
my_mÆloc
(
size_t
 
size
);

63 
GR_COLOR
 
gë_øndom_cﬁour
(
mö_brighäess
);

64 
gë_øndom_poöt_⁄_s¸ìn
(
n°©e
 *
°©e
, 
GR_COORD
 *
x
, GR_COORD *
y
,

65 
GR_COLOR
 *
c
);

66 
nŸ_squ¨e
(
n
);

67 
make_øndom_squ¨e
(
n°©e
 *
°©e
, 
mö_brighäess
, 
mö_size
,

68 
max_size
, 
√ed_squ¨e
, 
GR_COORD
 *
ªtx
, GR_COORD *
ªty
,

69 
GR_SIZE
 *
ªtsize
);

70 
öô
(
n°©e
 *
°©e
);

71 
ˇlcuœã_timeout
(
n°©e
 *
°©e
);

72 
timeout_dñay
(
n°©e
 *
°©e
);

73 
timeout_dñay
(
n°©e
 *
°©e
);

74 
do_™im©e
(
n°©e
 *
°©e
);

75 
do_s¸ìnßvî_evít
(
n°©e
 *
°©e
);

76 
h™dÀ_evít
(
n°©e
 *
°©e
);

77 
m¶ìp
(
ms
);

78 
GR_WINDOW_ID
 
ˇ±uª_s¸ìn
(
n°©e
 *
°©e
);

80 
	#NUM_SAVERS
 13

	)

82 
ßvî1_öô
(
n°©e
 *
°©e
);

83 
ßvî1_exposuª
(
n°©e
 *
°©e
);

84 
ßvî1_™im©e
(
n°©e
 *
°©e
);

86 
	#SAVER2_DELAY
 30

	)

87 
	#SAVER2_MAXPIXELS
 65535

	)

88 
	#SAVER2_PIXELS_PER_FRAME
 16

	)

91 
	mpixñs
;

92 } 
	ts2°©e
;

94 
ßvî2_öô
(
n°©e
 *
°©e
);

95 
ßvî2_exposuª
(
n°©e
 *
°©e
);

96 
ßvî2_™im©e
(
n°©e
 *
°©e
);

98 
	#SAVER3_DELAY
 30

	)

99 
	#SAVER3_MAXSEGMENTS
 65535

	)

100 
	#SAVER3_SEGMENTS_PER_FRAME
 4

	)

103 
	mmax£gmíts
;

104 
GR_COORD
 
	mœ°x
;

105 
GR_COORD
 
	mœ°y
;

106 } 
	ts3°©e
;

108 
ßvî3_öô
(
n°©e
 *
°©e
);

109 
ßvî3_exposuª
(
n°©e
 *
°©e
);

110 
ßvî3_™im©e
(
n°©e
 *
°©e
);

112 
	#SAVER4_DELAY
 30

	)

113 
	#SAVER4_NUMWORMS
 5

	)

114 
	#SAVER4_WORMLENGTH
 50

	)

115 
	#SAVER4_VELOCITY
 2

	)

116 
	#SAVER4_MAXROTATION
 (
PI
/8)

	)

117 
	#SAVER4_WORMTHICKNESS
 3

	)

120 
	mx
;

121 
	my
;

122 
	md
;

123 
GR_COLOR
 
	mcﬁour
;

124 
GR_POINT
 
	mpoöts
[
SAVER4_WORMLENGTH
];

125 } 
	ts4w‹m
;

128 
	mÀngth
;

129 
	mtù
;

130 
s4w‹m
 
	mw‹ms
[
SAVER4_NUMWORMS
];

131 } 
	ts4°©e
;

133 
ßvî4_öô
(
n°©e
 *
°©e
);

134 
ßvî4_exposuª
(
n°©e
 *
°©e
);

135 
ßvî4_gë_√w_w‹m_posôi⁄
(
n°©e
 *
°©e
, 
w‹m
, 
√wtù
);

136 
ßvî4_w‹m_cﬁlides
(
n°©e
 *
°©e
, 
s4°©e
 *
s
, 
x
, 
y
, 
thisw‹m
,

137 
thi•oöt
);

138 
ßvî4_™im©e
(
n°©e
 *
°©e
);

140 
	#SAVER5_DELAY
 30

	)

141 
	#SAVER5_NUMSTARS
 300

	)

142 
	#SAVER5_STARS_INCREMENT
 2

	)

143 
	#SAVER5_STARS_ACCEL_RATE
 30

	)

146 
	m™gÀ
;

147 
	mpos
;

148 } 
	ts5°¨
;

151 
	mnum°¨s
;

152 
s5°¨
 
	m°¨s
[
SAVER5_NUMSTARS
];

153 } 
	ts5°©e
;

155 
ßvî5_öô
(
n°©e
 *
°©e
);

156 
ßvî5_døw°¨
(
n°©e
 *
°©e
, 
s5°©e
 *
s
, 
°¨
, 
dñëe
);

157 
ßvî5_exposuª
(
n°©e
 *
°©e
);

158 
ßvî5_™im©e
(
n°©e
 *
°©e
);

160 
	#SAVER6_DELAY
 8

	)

161 
	#SAVER6_MAXVERTICES
 20

	)

162 
	#SAVER6_MINFULLVERTICES
 5

	)

163 
	#SAVER6_MINVERTICES
 3

	)

164 
	#SAVER6_MINDROP
 10

	)

165 
	#SAVER6_MAXBOLTS
 4

	)

166 
	#SAVER6_MAXFORKS
 20

	)

167 
	#SAVER6_MAXEND_Y
 50

	)

168 
	#SAVER6_THICKNESS
 6

	)

169 
	#SAVER6_MINDURATION
 10

	)

170 
	#SAVER6_MAXDURATION
 20

	)

171 
	#SAVER6_MAXNEWBOLTTIME
 300

	)

172 
	#SAVER6_MAXZIGZAG
 10

	)

173 
	#SAVER6_MAXPERTURBATION
 5

	)

174 
	#SAVER6_FORK_PROBABILITY
 0.5

	)

177 
	mvÆid
;

178 
GR_POINT
 
	mvîti˚s
[
SAVER6_THICKNESS
][
SAVER6_MAXVERTICES
];

179 } 
	ts6f‹k
;

182 
	mduøti⁄
;

183 
s6f‹k
 
	mf‹ks
[
SAVER6_MAXFORKS
];

184 } 
	ts6bﬁt
;

187 
	m√w_bﬁt_time
;

188 
s6bﬁt
 
	mbﬁts
[
SAVER6_MAXBOLTS
];

189 } 
	ts6°©e
;

191 
ßvî6_öô
(
n°©e
 *
°©e
);

192 
ßvî6_døwf‹k
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
dñëe
);

193 
ßvî6_døwbﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
dñëe
);

194 
ßvî6_døwlighäög
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
dñëe
);

195 
ßvî6_exposuª
(
n°©e
 *
°©e
);

196 
ßvî6_£tvîti˚s
(
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
vît
, 
GR_COORD
 
x
,

197 
GR_COORD
 
y
);

198 
ßvî6_makef‹k
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
, 
GR_COORD
 
x
,

199 
GR_COORD
 
y
);

200 
ßvî6_makef‹ks
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
,

201 *
vît
, *
√xtf‹k
);

202 
ßvî6_≥πurb
(
n°©e
 *
°©e
, 
GR_COORD
 *
x
, GR_COORD *
y
, 
max≥πurb
);

203 
ßvî6_makebﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
);

204 
ßvî6_√wbﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
);

205 
ßvî6_≥πurb_bﬁt
(
n°©e
 *
°©e
, 
s6°©e
 *
s
, 
bﬁt
, 
f‹k
);

206 
ßvî6_≥πurb_lighäög
(
n°©e
 *
°©e
, 
s6°©e
 *
s
);

207 
ßvî6_™im©e
(
n°©e
 *
°©e
);

211 
	#SAVER7_DELAY
 10

	)

212 
	#SAVER7_PLANETS
 15

	)

213 
	#SAVER7_PLANETS_USE_DAMPING


	)

214 
	#SAVER7_STARCOLOUR
 
GR_COLOR_YELLOW


	)

215 
	#SAVER7_STARRADIUS
 5

	)

216 
	#SAVER7_PLANETRADIUS
 3

	)

217 
	#SAVER7_DIST
 16.0

	)

218 
	#SAVER7_ALMOSTDIST
 (
SAVER7_DIST
 - 0.01)

	)

219 
	#SAVER7_MAX_STARTDIM
 (
SAVER7_ALMOSTDIST
 / 2.0)

	)

220 
	#SAVER7_MIN_STARTDIM
 -
SAVER7_MAX_STARTDIM


	)

221 
	#SAVER7_MAX_STARTVEL
 0.04

	)

222 
	#SAVER7_MIN_STARTVEL
 -
SAVER7_MAX_STARTVEL


	)

223 
	#SAVER7_G
 -0.02

	)

224 
	#SAVER7_COLLIDE
 0.0001

	)

225 
	#SAVER7_DAMPING_FACTOR
 0.999999

	)

226 
	#SAVER7_MAX_ACCEL
 0.1

	)

229 
	mr
;

230 
	mrv
;

231 
	mx
;

232 
	mxv
;

233 
	my
;

234 
	myv
;

235 
GR_COORD
 
	max
;

236 
GR_COORD
 
	may
;

237 
GR_COLOR
 
	mcﬁour
;

238 } 
	ts7∂™ë
;

241 
s7∂™ë
 
	m∂™ës
[
SAVER7_PLANETS
];

242 
GR_COORD
 
	m°¨x
;

243 
GR_COORD
 
	m°¨y
;

244 } 
	ts7°©e
;

246 
ßvî7_öô
(
n°©e
 *
°©e
);

247 
ßvî7_exposuª
(
n°©e
 *
°©e
);

248 
ßvî7_™im©e
(
n°©e
 *
°©e
);

250 
ßvî7_døw°¨
(
n°©e
 *
°©e
, 
s7°©e
 *
s
);

251 
ßvî7_døw∂™ë
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
, 
îa£
);

252 
ßvî7_ˇlc_∂™ë_posôi⁄
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
);

253 
ßvî7_movïœ√t
(
n°©e
 *
°©e
, 
s7°©e
 *
s
, 
∂™ë
);

258 
	#SAVER8_DELAY1
 1

	)

259 
	#SAVER8_DELAY2
 10000

	)

260 
	#SAVER8_NUMCOLOURS
 64

	)

261 
	#SAVER8_MINFACTOR
 1

	)

262 
	#SAVER8_MAXFACTOR
 20

	)

263 
	#SAVER8_LINES_PER_FRAME
 64

	)

266 
GR_PIXELVAL
 *
	mrows
;

267 
	mrownum
;

268 
GR_PIXELVAL
 
	mcﬁours
[
SAVER8_NUMCOLOURS
];

269 
	mcuºít_löe
;

270 
	mÁ˘‹
;

271 } 
	ts8°©e
;

273 
ßvî8_öô
(
n°©e
 *
°©e
);

274 
ßvî8_døw∑âîn
(
n°©e
 *
°©e
);

275 
ßvî8_exposuª
(
n°©e
 *
°©e
);

276 
ßvî8_™im©e
(
n°©e
 *
°©e
);

278 
	#SAVER9_DELAY
 30

	)

281 
GR_WINDOW_ID
 
	mpid
;

282 } 
	ts9°©e
;

284 
ßvî9_öô
(
n°©e
 *
°©e
);

285 
ßvî9_exposuª
(
n°©e
 *
°©e
);

286 
ßvî9_™im©e
(
n°©e
 *
°©e
);

288 
	#SAVER10_DELAY
 20

	)

289 
	#SAVER10_SPOTDIA
 49

	)

290 
	#SAVER10_VELOCITY
 3

	)

291 
	#SAVER10_OVERSIZE
 (2 * 
SAVER10_VELOCITY
)

	)

294 
GR_WINDOW_ID
 
	ms¸ìn
;

295 
GR_WINDOW_ID
 
	m•Ÿ
;

296 
	mx
;

297 
	my
;

298 
	mdúe˘i⁄
;

299 } 
	ts10°©e
;

301 
ßvî10_öô
(
n°©e
 *
°©e
);

302 
ßvî10_exposuª
(
n°©e
 *
°©e
);

303 
ßvî10_™im©e
(
n°©e
 *
°©e
);

305 
	#SAVER11_DELAY
 50

	)

306 
	#SAVER11_MIN_BRIGHTNESS
 100

	)

307 
	#SAVER11_MIN_SIZE
 20

	)

308 
	#SAVER11_MAX_SIZE
 150

	)

311 
GR_COORD
 
	mx
;

312 
GR_COORD
 
	my
;

313 
GR_SIZE
 
	msize
;

314 } 
	ts11°©e
;

316 
ßvî11_öô
(
n°©e
 *
°©e
);

317 
ßvî11_exposuª
(
n°©e
 *
°©e
);

318 
ßvî11_™im©e
(
n°©e
 *
°©e
);

322 
	#SAVER12_DELAY
 10

	)

323 
	#SAVER12_MIN_BRIGHTNESS
 100

	)

324 
	#SAVER12_MIN_SIZE
 64

	)

325 
	#SAVER12_MAX_SIZE
 256

	)

328 
	mt
;

329 
	mkt
;

330 
GR_COORD
 
	mx
;

331 
GR_COORD
 
	my
;

332 
GR_SIZE
 
	msize
;

333 } 
	ts12°©e
;

335 
ßvî12_√w_sh≠e
(
n°©e
 *
°©e
);

336 
ßvî12_öô
(
n°©e
 *
°©e
);

337 
ßvî12_exposuª
(
n°©e
 *
°©e
);

338 
ßvî12_™im©e
(
n°©e
 *
°©e
);

340 
	#SAVER13_DELAY
 10

	)

341 
	#SAVER13_ZOOM_FACTOR
 8

	)

342 
	#SAVER13_ROWS_BUFFER
 64

	)

343 
	#SAVER13_VELOCITY
 4

	)

346 
GR_PIXELVAL
 *
	ms¸ìn
;

347 
GR_PIXELVAL
 *
	mrows
;

348 
	mrownum
;

349 
	mx
;

350 
	my
;

351 
	mdúe˘i⁄
;

352 } 
	ts13°©e
;

354 
ßvî13_öô
(
n°©e
 *
°©e
);

355 
ßvî13_exposuª
(
n°©e
 *
°©e
);

356 
ßvî13_™im©e
(
n°©e
 *
°©e
);

357 
ßvî13_move_p‹èl
(
n°©e
 *
°©e
);

359 (*
	tßvî_fun˘i⁄
)(
	tn°©e
 *);

361 
ßvî_fun˘i⁄
 
öô_fun˘i⁄s
[
NUM_SAVERS
] = {

362 
ßvî1_öô
,

363 
ßvî2_öô
,

364 
ßvî3_öô
,

365 
ßvî4_öô
,

366 
ßvî5_öô
,

367 
ßvî6_öô
,

368 
ßvî7_öô
,

369 
ßvî8_öô
,

370 
ßvî9_öô
,

371 
ßvî10_öô
,

372 
ßvî11_öô
,

373 
ßvî12_öô
,

374 
ßvî13_öô


375 
	}
};

376 
ßvî_fun˘i⁄
 
	gexposuª_fun˘i⁄s
[
NUM_SAVERS
] = {

377 
ßvî1_exposuª
,

378 
ßvî2_exposuª
,

379 
ßvî3_exposuª
,

380 
ßvî4_exposuª
,

381 
ßvî5_exposuª
,

382 
ßvî6_exposuª
,

383 
ßvî7_exposuª
,

384 
ßvî8_exposuª
,

385 
ßvî9_exposuª
,

386 
ßvî10_exposuª
,

387 
ßvî11_exposuª
,

388 
ßvî12_exposuª
,

389 
ßvî13_exposuª
,

391 
ßvî_fun˘i⁄
 
	g™im©e_fun˘i⁄s
[
NUM_SAVERS
] = {

392 
ßvî1_™im©e
,

393 
ßvî2_™im©e
,

394 
ßvî3_™im©e
,

395 
ßvî4_™im©e
,

396 
ßvî5_™im©e
,

397 
ßvî6_™im©e
,

398 
ßvî7_™im©e
,

399 
ßvî8_™im©e
,

400 
ßvî9_™im©e
,

401 
ßvî10_™im©e
,

402 
ßvî11_™im©e
,

403 
ßvî12_™im©e
,

404 
ßvî13_™im©e


	@demos/nanox/nterm.c

8 
	~<°dio.h
>

9 
	~<°rög.h
>

10 
	~<°dlib.h
>

11 
	~<f˙é.h
>

12 
	~<uni°d.h
>

13 
	~<î∫o.h
>

14 
	~<sig«l.h
>

16 
	#MWINCLUDECOLORS


	)

17 
	~"«no-X.h
"

19 
	#HAVEBLIT
 0

	)

21 
	#_
 ((Ë0Ë

	)

22 
	#X
 ((Ë1Ë

	)

23 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

24 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

25 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

27 #i‡
DOS_DJGPP


28 
	#SIGCHLD
 17

	)

31 
GR_WINDOW_ID
 
	gw1
;

32 
GR_GC_ID
 
	ggc1
;

33 
GR_GC_ID
 
	ggc3
;

34 
GR_COORD
 
	gxpos
;

35 
GR_COORD
 
	gypos
;

36 
GR_SCREEN_INFO
 
	gsi
;

37 
	gtfdMa°î
,
	gtfdSœve
;

39 
ãxt_öô
();

40 
ãrm_öô
();

41 
do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
);

42 
do_focusö
(
GR_EVENT_GENERAL
 *
gp
);

43 
do_focusout
(
GR_EVENT_GENERAL
 *
gp
);

44 
do_fdöput
();

45 
¥ötg
(* 
ãxt
);

46 
H™dÀEvít
(
GR_EVENT
 *
ï
);

47 
ch¨_dñ
(
GR_COORD
 
x
, GR_COORD 
y
);

48 
ch¨_out
(
GR_CHAR
 
ch
);

49 
sigchûd
(
signo
);

51 
	$maö
(
¨gc
, ** 
¨gv
)

53 
GR_BITMAP
 
bôm≠1fg
[7];

54 
GR_BITMAP
 
bôm≠1bg
[7];

56 i‡(
	`GrO≥n
() < 0) {

57 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

58 
	`exô
(1);

61 
	`GrGëS¸ìnInfo
(&
si
);

63 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 50, 30, 
si
.
cﬁs
 - 10,

64 
si
.
rows
 - 60, 1, 
WHITE
, 
LTBLUE
);

66 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

67 
GR_EVENT_MASK_KEY_DOWN
 | 
GR_EVENT_MASK_EXPOSURE
 |

68 
GR_EVENT_MASK_FOCUS_IN
 | 
GR_EVENT_MASK_FOCUS_OUT
 |

69 
GR_EVENT_MASK_CLOSE_REQ
);

71 
	`GrM≠Wödow
(
w1
);

73 
gc1
 = 
	`GrNewGC
();

74 
gc3
 = 
	`GrNewGC
();

76 
	`GrSëGCF‹eground
(
gc1
, 
GRAY
);

77 
	`GrSëGCBackground
(
gc1
, 
LTBLUE
);

78 
	`GrSëGCF⁄t
(
gc1
, 
	`GrCª©eF⁄t
(
GR_FONT_SYSTEM_FIXED
, 0, 
NULL
));

80 
	`GrSëGCF‹eground
(
gc3
, 
WHITE
);

81 
	`GrSëGCBackground
(
gc3
, 
BLACK
);

83 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,
X
,_,X,_,_);

84 
bôm≠1fg
[1] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

85 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

86 
bôm≠1fg
[3] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

87 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

88 
bôm≠1fg
[5] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

89 
bôm≠1fg
[6] = 
	`MASK
(
_
,_,
X
,_,X,_,_);

91 
bôm≠1bg
[0] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

92 
bôm≠1bg
[1] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

93 
bôm≠1bg
[2] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

94 
bôm≠1bg
[3] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

95 
bôm≠1bg
[4] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

96 
bôm≠1bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

97 
bôm≠1bg
[6] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

99 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

103 
	`GrSëGCF‹eground
(
gc1
, 
BLACK
);

104 
	`GrSëGCBackground
(
gc1
, 
WHITE
);

105 
	`ãxt_öô
();

106 i‡(
	`ãrm_öô
() < 0) {

107 
	`GrClo£
();

108 
	`exô
(1);

111 
	`GrRegi°îI≈ut
(
tfdMa°î
);

114 
	`GrMaöLo›
(
H™dÀEvít
);

117 
GR_EVENT
 
ev
;

119 
	`GrGëNextEvít
(&
ev
);

120 
	`H™dÀEvít
(&
ev
);

125 
	}
}

128 
	$H™dÀEvít
(
GR_EVENT
 *
ï
)

130 
ï
->
ty≥
) {

131 
GR_EVENT_TYPE_KEY_DOWN
:

132 
	`do_key°roke
(&
ï
->
key°roke
);

135 
GR_EVENT_TYPE_FOCUS_IN
:

136 
	`do_focusö
(&
ï
->
gíîÆ
);

139 
GR_EVENT_TYPE_FOCUS_OUT
:

140 
	`do_focusout
(&
ï
->
gíîÆ
);

143 
GR_EVENT_TYPE_CLOSE_REQ
:

144 
	`GrClo£
();

145 
	`exô
(0);

147 
GR_EVENT_TYPE_FDINPUT
:

148 
	`do_fdöput
();

151 
	}
}

153 #i‡
ELKS


154 * 
	g«rgv
[2] = {"/bö/ßsh", 
NULL
};

156 #i‡
DOS_DJGPP


157 * 
	g«rgv
[2] = {"bash", 
NULL
};

159 * 
	g«rgv
[2] = {"/bö/sh", 
NULL
};

163 
	$sigchûd
(
signo
)

165 
	`¥ötg
("We haveá signalÑightÇow!\n");

166 
	`GrClo£
();

167 
	`exô
(0);

168 
	}
}

170 
	$ãrm_öô
()

172 
±y_«me
[12];

173 
n
 = 0;

174 
pid_t
 
pid
;

176 
agaö
:

177 
	`•rötf
(
±y_«me
, "/dev/±yp%d", 
n
);

178 i‡((
tfdMa°î
 = 
	`›í
(
±y_«me
, 
O_RDWR
 | 
O_NONBLOCK
)) < 0) {

179 i‡((
î∫o
 =
EBUSY
 ||Éºnÿ=
EIO
Ë&& 
n
 < 10) {

180 
n
++;

181 
agaö
;

183 
	`Ârötf
(
°dîr
, "C™'à¸óãÖty %s\n", 
±y_«me
);

186 
	`sig«l
(
SIGCHLD
, 
sigchûd
);

187 
	`sig«l
(
SIGINT
, 
sigchûd
);

189 #ifde‡
__uClöux__


190 #unde‡
f‹k


191 
	#f‹k
(Ë
	`vf‹k
()

	)

193 i‡((
pid
 = 
	`f‹k
()) == -1) {

194 
	`Ârötf
(
°dîr
, "NoÖrocesses\n");

197 i‡(!
pid
) {

198 
	`˛o£
(
STDIN_FILENO
);

199 
	`˛o£
(
STDOUT_FILENO
);

200 
	`˛o£
(
STDERR_FILENO
);

202 
	`˛o£
(
tfdMa°î
);

203 
	`£tsid
();

204 
±y_«me
[5] = 't';

205 i‡((
tfdSœve
 = 
	`›í
(
±y_«me
, 
O_RDWR
)) < 0) {

206 
	`Ârötf
(
°dîr
, "Chûd: C™'à›íÖty %s\n", 
±y_«me
);

207 
	`exô
(1);

209 
	`dup2
(
tfdSœve
, 
STDIN_FILENO
);

210 
	`dup2
(
tfdSœve
, 
STDOUT_FILENO
);

211 
	`dup2
(
tfdSœve
, 
STDERR_FILENO
);

212 
	`execv
(
«rgv
[0],Çargv);

213 
	`exô
(1);

216 
	}
}

219 
GR_SIZE
 
	gwidth
;

220 
GR_SIZE
 
	gheight
;

221 
GR_SIZE
 
	gba£
;

223 
	$ãxt_öô
()

225 
	`GrGëGCTextSize
(
gc1
, "A", 1, 
GR_TFASCII
, &
width
, &
height
, &
ba£
);

226 
	}
}

228 
	$ch¨_dñ
(
GR_COORD
 
x
, GR_COORD 
y
)

230 
xpos
 -
width
;

231 
	`GrFûlRe˘
(
w1
, 
gc3
, 
x
, 
y
 + 1, 
width
, 
height
);

232 
	}
}

234 
	$ch¨_out
(
GR_CHAR
 
ch
)

236 
ch
) {

238 
xpos
 = 0;

241 
ypos
 +
height
;

242 if(
ypos
 > 
si
.
rows
 - 60 - 
height
) {

243 
ypos
 -
height
;

244 #i‡
HAVEBLIT


245 
	`bogl_cfb8_blô
(50, 30, 
si
.
cﬁs
-120,

246 
si
.
rows
-60-
height
, 50, 30+height);

247 
	`GrFûlRe˘
(
w1
, 
gc3
, 50, 
ypos
, 
si
.
cﬁs
-120, 
height
);

251 
ypos
 = 0;

252 
	`GrCÀ¨Wödow
(
w1
, 
GR_FALSE
);

259 
xpos
 +
width
;

260 (
xpos
/
width
) & 7)

261 
	`ch¨_out
(' ');

264 i‡(
xpos
 <= 0)

266 
	`ch¨_dñ
(
xpos
, 
ypos
);

269 
	`GrText
(
w1
, 
gc1
, 
xpos
+1, 
ypos
, &
ch
, 1, 
GR_TFTOP
);

270 
xpos
 +
width
;

271 
	}
}

273 
	$¥ötg
(* 
ãxt
)

275 
i
;

277 
i
 = 0; i < 
	`°æí
(
ãxt
); i++) {

278 
	`ch¨_out
(
ãxt
[
i
]);

280 
	}
}

287 
	$do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
)

289 
foo
;

291 
foo
 = 
kp
->
ch
;

292 
	`wrôe
(
tfdMa°î
, &
foo
, 1);

293 
	}
}

300 
	$do_focusö
(
GR_EVENT_GENERAL
 *
gp
)

302 i‡(
gp
->
wid
 !
w1
)

304 
	`GrSëB‹dîCﬁ‹
(
w1
, 
LTBLUE
);

305 
	}
}

311 
	$do_focusout
(
GR_EVENT_GENERAL
 *
gp
)

313 i‡(
gp
->
wid
 !
w1
)

315 
	`GrSëB‹dîCﬁ‹
(
w1
, 
GRAY
);

316 
	}
}

322 
	$do_fdöput
()

324 
c
;

326 i‡(
	`ªad
(
tfdMa°î
, &
c
, 1) == 1)

327 
	`ch¨_out
(
c
);

328 
	}
}

	@demos/nanox/ntetris.c

75 
	~<°dio.h
>

76 
	~<°rög.h
>

77 
	~<°dlib.h
>

78 
	~<f˙é.h
>

79 
	~<uni°d.h
>

80 
	~<time.h
>

81 
	~<˘y≥.h
>

82 
	~<î∫o.h
>

83 
	~<sys/time.h
>

85 #ifde‡
__ECOS


86 
	#øndom
 
ønd


	)

87 
	#§™dom
 
§™d


	)

90 
	~<«no-X.h
>

91 
	~<nxcﬁ‹s.h
>

93 
	~"¡ëris.h
"

95 *
	$my_mÆloc
(
size_t
 
size
)

97 *
ªt
;

99 if(!(
ªt
 = 
	`mÆloc
(
size
))) {

100 
	`Ârötf
(
°dîr
, "Out of memory\n");

101 
	`exô
(1);

104  
ªt
;

105 
	}
}

107 #ifde‡
HAVE_USLEEP


108 
	$m¶ìp
(
ms
)

110 
	`u¶ìp
(
ms
 * 1000);

111 
	}
}

113 
	$m¶ìp
(
ms
)

115 
time•ec
 
ªq
, 
ªm
;

117 
ªq
.
tv_£c
 = 
ms
 / 1000000;

118 
ªq
.
tv_n£c
 = (
ms
 % 1000000) * 1000000;

120 
	`«no¶ìp
(&
ªq
, &
ªm
) == -1) {

121 if(
î∫o
 =
EINTR
) {

122 
ªq
.
tv_£c
 = 
ªm
.tv_sec;

123 
ªq
.
tv_n£c
 = 
ªm
.tv_nsec;

126 
	`≥º‹
("nanosleep() failed");

130 
	}
}

133 #ifde‡
USE_HISCORE_FILE


134 
	$ªad_hisc‹e
(
n°©e
 *
°©e
)

136 
FILE
 *
f
;

137 
i
, 
n
;

139 if(!(
f
 = 
	`f›í
(
HISCORE_FILE
, "r"))) {

140 if(
î∫o
 !
ENOENT
)

141 
	`≥º‹
("Couldn't open high score file forÑeading");

142 
°©e
->
hisc‹e
 = sèã->
fhisc‹e
 = 0;

146 
i
 = 
	`fsˇnf
(
f
, "%d", &
n
);

147 
	`f˛o£
(
f
);

149 if(
i
 != 1) {

150 
	`Ârötf
(
°dîr
, "Couldn'tÑead high score file\n");

151 
n
 = 0;

154 
°©e
->
hisc‹e
 = sèã->
fhisc‹e
 = 
n
;

155 
	}
}

157 
	$wrôe_hisc‹e
(
n°©e
 *
°©e
)

159 
FILE
 *
f
;

161 if(
°©e
->
sc‹e
 > sèã->
hisc‹e
) state->hiscore = state->score;

162 if(
°©e
->
hisc‹e
 <°©e->
fhisc‹e
) ;

164 if(!(
f
 = 
	`f›í
(
HISCORE_FILE
, "w"))) {

165 
	`≥º‹
("Couldn't open high score file for writing");

169 if((
	`Ârötf
(
f
, "%d", 
°©e
->
hisc‹e
)) == -1)

170 
	`≥º‹
("Couldn't writeÅo high score file");

171 
°©e
->
fhisc‹e
 = sèã->
hisc‹e
;

173 
	`f˛o£
(
f
);

174 
	}
}

176 
	$ªad_hisc‹e
(
n°©e
 *
°©e
)

178 
°©e
->
hisc‹e
 = 0;

179 
	}
}

181 
	$wrôe_hisc‹e
(
n°©e
 *
°©e
Ë{
	}
}

184 
	$wûl_cﬁlide
(
n°©e
 *
°©e
, 
x
, 
y
, 
‹õ¡©i⁄
)

186 
r
, 
c
, 
xx
, 
yy
;

187 
ch
 = 0;

189 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
, sèã->cuºít_sh≠e.
y
, 1);

190 
r
 = 0; 
ch
 < 3;Ñ++) {

191 
ch
 = 0;

192 
c
 = 0; 
ch
 < 2; c++) {

193 
ch
 = 
sh≠es
[
°©e
->
cuºít_sh≠e
.
ty≥
]

194 [
‹õ¡©i⁄
][
r
][
c
];

195 if(
ch
 == 1) {

196 
yy
 = 
y
 + 
r
;

197 
xx
 = 
x
 + 
c
;

198 if((
yy
 =
WELL_HEIGHT
Ë|| (
xx
 =
WELL_WIDTH
) ||

199 (
°©e
->
blocks
[0][
yy
][
xx
])) {

200 
	`døw_sh≠e
(
°©e
,

201 
°©e
->
cuºít_sh≠e
.
x
,

202 
°©e
->
cuºít_sh≠e
.
y
, 0);

208 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
, sèã->cuºít_sh≠e.
y
, 0);

211 
	}
}

213 
	$døw_sh≠e
(
n°©e
 *
°©e
, 
GR_COORD
 
x
, GR_COORD 
y
, 
îa£
)

215 
r
, 
c
, 
yy
, 
xx
;

216 
GR_COLOR
 
cﬁ
;

217 
ch
 = 0;

219 if(
îa£
Ë
cﬁ
 = 0;

220 
cﬁ
 = 
°©e
->
cuºít_sh≠e
.
cﬁour
;

222 
r
 = 0; 
ch
 < 3;Ñ++) {

223 
ch
 = 0;

224 
c
 = 0; 
ch
 < 2; c++) {

225 
ch
 = 
sh≠es
[
°©e
->
cuºít_sh≠e
.
ty≥
]

226 [
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
][
r
][
c
];

227 if(
ch
 == 1) {

228 
yy
 = 
y
 + 
r
;

229 
xx
 = 
x
 + 
c
;

230 
°©e
->
blocks
[0][
yy
][
xx
] = 
cﬁ
;

234 
	}
}

236 
	$døw_wñl
(
n°©e
 *
°©e
, 
f‹˚døw
)

238 
x
, 
y
;

240 
y
 = 
WELL_NOTVISIBLE
; y < 
WELL_HEIGHT
; y++) {

241 
x
 = 0; x < 
WELL_WIDTH
; x++) {

242 if(
f‹˚døw
 || (
°©e
->
blocks
[0][
y
][
x
] !=

243 
°©e
->
blocks
[1][
y
][
x
])) {

244 
°©e
->
blocks
[1][
y
][
x
] = state->blocks[0][y][x];

245 
	`GrSëGCF‹eground
(
°©e
->
wñlgc
,

246 
°©e
->
blocks
[0][
y
][
x
]);

247 
	`GrFûlRe˘
(
°©e
->
wñl_wödow
, sèã->
wñlgc
,

248 (
BLOCK_SIZE
 * 
x
),

249 (
BLOCK_SIZE
 * (
y
 - 
WELL_NOTVISIBLE
)),

250 
BLOCK_SIZE
, BLOCK_SIZE);

255 
	`GrFlush
();

256 
	}
}

258 
	$døw_sc‹e
(
n°©e
 *
°©e
)

260 
buf
[32];

262 
	`GrFûlRe˘
(
°©e
->
sc‹e_wödow
, sèã->
sc‹egcb
, 0, 0,

263 
SCORE_WINDOW_WIDTH
, 
SCORE_WINDOW_HEIGHT
);

265 
	`•rötf
(
buf
, "%d", 
°©e
->
sc‹e
);

266 
	`GrText
(
°©e
->
sc‹e_wödow
, sèã->
sc‹egcf
, 
TEXT_X_POSITION
,

267 
TEXT2_Y_POSITION
, 
buf
, 
	`°æí
(buf), 0);

268 
	`•rötf
(
buf
, "%d", 
°©e
->
hisc‹e
);

269 
	`GrText
(
°©e
->
sc‹e_wödow
, sèã->
sc‹egcf
, 
TEXT_X_POSITION
,

270 
TEXT_Y_POSITION
, 
buf
, 
	`°æí
(buf), 0);

271 
	}
}

273 
	$døw_√xt_sh≠e
(
n°©e
 *
°©e
)

275 
r
, 
c
, 
°¨tx
, 
°¨ty
, 
x
, 
y
;

276 
ch
 = 0;

278 
	`GrFûlRe˘
(
°©e
->
√xt_sh≠e_wödow
, sèã->
√xtsh≠egcb
, 0, 0,

279 
NEXT_SHAPE_WINDOW_WIDTH
, 
NEXT_SHAPE_WINDOW_HEIGHT
);

281 
	`GrSëGCF‹eground
(
°©e
->
√xtsh≠egcf
, sèã->
√xt_sh≠e
.
cﬁour
);

283 
°¨tx
 = (
BLOCK_SIZE
 * ((
NEXT_SHAPE_WINDOW_SIZE
 / 2) -

284 (
sh≠e_sizes
[
°©e
->
√xt_sh≠e
.
ty≥
]

285 [
°©e
->
√xt_sh≠e
.
‹õ¡©i⁄
][0] / 2)));

286 
°¨ty
 = (
BLOCK_SIZE
 * ((
NEXT_SHAPE_WINDOW_SIZE
 / 2) -

287 (
sh≠e_sizes
[
°©e
->
√xt_sh≠e
.
ty≥
]

288 [
°©e
->
√xt_sh≠e
.
‹õ¡©i⁄
][1] / 2)));

290 
r
 = 0; 
ch
 < 3;Ñ++) {

291 
ch
 = 0;

292 
c
 = 0; 
ch
 < 2; c++) {

293 
ch
 = 
sh≠es
[
°©e
->
√xt_sh≠e
.
ty≥
]

294 [
°©e
->
√xt_sh≠e
.
‹õ¡©i⁄
][
r
][
c
];

295 if(
ch
 == 1) {

296 
x
 = 
°¨tx
 + (
c
 * 
BLOCK_SIZE
);

297 
y
 = 
°¨ty
 + (
r
 * 
BLOCK_SIZE
);

298 
	`GrFûlRe˘
(
°©e
->
√xt_sh≠e_wödow
,

299 
°©e
->
√xtsh≠egcf
, 
x
, 
y
,

300 
BLOCK_SIZE
, BLOCK_SIZE);

304 
	}
}

306 
	$døw_√w_game_buâ⁄
(
n°©e
 *
°©e
)

308 
	`GrFûlRe˘
(
°©e
->
√w_game_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

309 
NEW_GAME_BUTTON_WIDTH
, 
NEW_GAME_BUTTON_HEIGHT
);

310 
	`GrText
(
°©e
->
√w_game_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

311 
TEXT_Y_POSITION
, "New Game", 8, 0);

312 
	}
}

314 
	$døw_™ti˛ockwi£_buâ⁄
(
n°©e
 *
°©e
)

316 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

317 
	`GrFûlRe˘
(
°©e
->
™ti˛ockwi£_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

318 
ANTICLOCKWISE_BUTTON_WIDTH
, 
ANTICLOCKWISE_BUTTON_HEIGHT
);

319 
	`GrText
(
°©e
->
™ti˛ockwi£_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

320 
TEXT_Y_POSITION
, " /", 4, 0);

321 
	}
}

323 
	$døw_˛ockwi£_buâ⁄
(
n°©e
 *
°©e
)

325 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

326 
	`GrFûlRe˘
(
°©e
->
˛ockwi£_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

327 
CLOCKWISE_BUTTON_WIDTH
, 
CLOCKWISE_BUTTON_HEIGHT
);

328 
	`GrText
(
°©e
->
˛ockwi£_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

329 
TEXT_Y_POSITION
, " \\", 4, 0);

330 
	}
}

332 
	$døw_À·_buâ⁄
(
n°©e
 *
°©e
)

334 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

335 
	`GrFûlRe˘
(
°©e
->
À·_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

336 
LEFT_BUTTON_WIDTH
, 
LEFT_BUTTON_HEIGHT
);

337 
	`GrText
(
°©e
->
À·_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

338 
TEXT_Y_POSITION
, " <", 3, 0);

339 
	}
}

341 
	$døw_right_buâ⁄
(
n°©e
 *
°©e
)

343 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

344 
	`GrFûlRe˘
(
°©e
->
right_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

345 
RIGHT_BUTTON_WIDTH
, 
RIGHT_BUTTON_HEIGHT
);

346 
	`GrText
(
°©e
->
right_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

347 
TEXT_Y_POSITION
, " >", 4, 0);

348 
	}
}

350 
	$døw_dr›_buâ⁄
(
n°©e
 *
°©e
)

352 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

353 
	`GrFûlRe˘
(
°©e
->
dr›_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

354 
DROP_BUTTON_WIDTH
, 
DROP_BUTTON_HEIGHT
);

355 
	`GrText
(
°©e
->
dr›_buâ⁄
, sèã->
buâ⁄gcf
, 
TEXT_X_POSITION
,

356 
TEXT_Y_POSITION
, " Drop", 8, 0);

357 
	}
}

359 
	$døw_∑u£_c⁄töue_buâ⁄
(
n°©e
 *
°©e
)

361 if((
°©e
->
ru¬ög_buâ⁄s_m≠≥d
Ë&& (°©e->°©ê=
STATE_STOPPED
)) {

362 
	`GrUnm≠Wödow
(
°©e
->
∑u£_c⁄töue_buâ⁄
);

363 
	`GrUnm≠Wödow
(
°©e
->
™ti˛ockwi£_buâ⁄
);

364 
	`GrUnm≠Wödow
(
°©e
->
˛ockwi£_buâ⁄
);

365 
	`GrUnm≠Wödow
(
°©e
->
À·_buâ⁄
);

366 
	`GrUnm≠Wödow
(
°©e
->
right_buâ⁄
);

367 
	`GrUnm≠Wödow
(
°©e
->
dr›_buâ⁄
);

368 
°©e
->
ru¬ög_buâ⁄s_m≠≥d
 = 0;

371 if((!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
Ë&& (°©e->°©ê=
STATE_RUNNING
)){

372 
	`GrM≠Wödow
(
°©e
->
∑u£_c⁄töue_buâ⁄
);

373 
	`GrM≠Wödow
(
°©e
->
™ti˛ockwi£_buâ⁄
);

374 
	`GrM≠Wödow
(
°©e
->
˛ockwi£_buâ⁄
);

375 
	`GrM≠Wödow
(
°©e
->
À·_buâ⁄
);

376 
	`GrM≠Wödow
(
°©e
->
right_buâ⁄
);

377 
	`GrM≠Wödow
(
°©e
->
dr›_buâ⁄
);

378 
°©e
->
ru¬ög_buâ⁄s_m≠≥d
 = 1;

381 if(!
°©e
->
ru¬ög_buâ⁄s_m≠≥d
) ;

382 
	`GrFûlRe˘
(
°©e
->
∑u£_c⁄töue_buâ⁄
, sèã->
buâ⁄gcb
, 0, 0,

383 
PAUSE_CONTINUE_BUTTON_WIDTH
, 
PAUSE_CONTINUE_BUTTON_HEIGHT
);

384 if(
°©e
->°©ê=
STATE_PAUSED
) {

385 
	`GrText
(
°©e
->
∑u£_c⁄töue_buâ⁄
, sèã->
buâ⁄gcf
,

386 
TEXT_X_POSITION
, 
TEXT_Y_POSITION
, " Continue", 9, 0);

388 
	`GrText
(
°©e
->
∑u£_c⁄töue_buâ⁄
, sèã->
buâ⁄gcf
,

389 
TEXT_X_POSITION
, 
TEXT_Y_POSITION
, " Pause", 8, 0);

391 
	}
}

393 
	$block_is_Æl_ö_wñl
(
n°©e
 *
°©e
)

395 if(
°©e
->
cuºít_sh≠e
.
y
 >
WELL_NOTVISIBLE
)

399 
	}
}

401 
	$dñëe_löe
(
n°©e
 *
°©e
, 
löe
)

403 
x
, 
y
;

405 if(
löe
 < 
WELL_NOTVISIBLE
) ;

407 
y
 = 
löe
 - 1; y; y--)

408 
x
 = 
WELL_WIDTH
; x; x--)

409 
°©e
->
blocks
[0][
y
 + 1][
x
] = state->blocks[0][y][x];

411 
	`døw_wñl
(
°©e
, 0);

412 
	}
}

414 
	$block_ªached_bŸtom
(
n°©e
 *
°©e
)

416 
x
, 
y
, 
ƒ
;

418 if(!
	`block_is_Æl_ö_wñl
(
°©e
)) {

419 
°©e
->°©ê
STATE_STOPPED
;

423 
y
 = 
WELL_HEIGHT
 - 1; y; y--) {

424 
ƒ
 = 0;

425 
x
 = 0; x < 
WELL_WIDTH
; x++) {

426 if(!
°©e
->
blocks
[0][
y
][
x
]) {

427 
ƒ
 = 1;

431 if(
ƒ
) ;

432 
	`m¶ìp
(
DELETE_LINE_DELAY
);

433 
	`dñëe_löe
(
°©e
, 
y
);

434 
°©e
->
sc‹e
 +
SCORE_INCREMENT
;

435 if((
LEVELS
 > (
°©e
->
Àvñ
 + 1)) && (((state->level + 1) *

436 
LEVEL_DIVISOR
Ë<
°©e
->
sc‹e
))

437 
°©e
->
Àvñ
++;

438 
	`døw_sc‹e
(
°©e
);

439 
y
++;

442 
	`choo£_√w_sh≠e
(
°©e
);

443 
	`døw_√xt_sh≠e
(
°©e
);

444 
	}
}

446 
	$move_block
(
n°©e
 *
°©e
, 
dúe˘i⁄
)

448 if(
dúe˘i⁄
 == 0) {

449 if(!
°©e
->
cuºít_sh≠e
.
x
) ;

451 if(!
	`wûl_cﬁlide
(
°©e
, (°©e->
cuºít_sh≠e
.
x
 - 1),

452 
°©e
->
cuºít_sh≠e
.
y
,

453 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
)) {

454 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

455 
°©e
->
cuºít_sh≠e
.
y
, 1);

456 
°©e
->
cuºít_sh≠e
.
x
--;

457 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

458 
°©e
->
cuºít_sh≠e
.
y
, 0);

459 
	`døw_wñl
(
°©e
, 0);

463 if(!
	`wûl_cﬁlide
(
°©e
, (°©e->
cuºít_sh≠e
.
x
 + 1),

464 
°©e
->
cuºít_sh≠e
.
y
,

465 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
)) {

466 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

467 
°©e
->
cuºít_sh≠e
.
y
, 1);

468 
°©e
->
cuºít_sh≠e
.
x
++;

469 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

470 
°©e
->
cuºít_sh≠e
.
y
, 0);

471 
	`døw_wñl
(
°©e
, 0);

474 
	}
}

476 
	$rŸ©e_block
(
n°©e
 *
°©e
, 
dúe˘i⁄
)

478 
√w‹õ¡©i⁄
 = 0;

480 if(
dúe˘i⁄
 == 0) {

481 if(!
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
)

482 
√w‹õ¡©i⁄
 = 
MAXORIENTATIONS
 - 1;

483 
√w‹õ¡©i⁄
 = 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
 - 1;

485 
√w‹õ¡©i⁄
 = 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
 + 1;

486 if(
√w‹õ¡©i⁄
 =
MAXORIENTATIONS
)Çeworientation = 0;

489 if(!
	`wûl_cﬁlide
(
°©e
, sèã->
cuºít_sh≠e
.
x
, sèã->cuºít_sh≠e.
y
,

490 
√w‹õ¡©i⁄
)) {

491 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

492 
°©e
->
cuºít_sh≠e
.
y
, 1);

493 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
 = 
√w‹õ¡©i⁄
;

494 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

495 
°©e
->
cuºít_sh≠e
.
y
, 0);

496 
	`døw_wñl
(
°©e
, 0);

498 
	}
}

500 
	$dr›_block_1
(
n°©e
 *
°©e
)

502 if(
	`wûl_cﬁlide
(
°©e
, sèã->
cuºít_sh≠e
.
x
,

503 (
°©e
->
cuºít_sh≠e
.
y
 + 1),

504 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
)) {

505 
	`block_ªached_bŸtom
(
°©e
);

509 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
, sèã->cuºít_sh≠e.
y
, 1);

510 
°©e
->
cuºít_sh≠e
.
y
++;

511 
	`døw_sh≠e
(
°©e
, sèã->
cuºít_sh≠e
.
x
, sèã->cuºít_sh≠e.
y
, 0);

513 
	`døw_wñl
(
°©e
, 0);

516 
	}
}

518 
	$dr›_block
(
n°©e
 *
°©e
)

520 !
	`dr›_block_1
(
°©e
)Ë
	`m¶ìp
(
DROP_BLOCK_DELAY
);

521 
	}
}

523 
	$h™dÀ_exposuª_evít
(
n°©e
 *
°©e
)

525 
GR_EVENT_EXPOSURE
 *
evít
 = &
°©e
->evít.
exposuª
;

527 if(
evít
->
wid
 =
°©e
->
sc‹e_wödow
) {

528 
	`døw_sc‹e
(
°©e
);

531 if(
evít
->
wid
 =
°©e
->
√xt_sh≠e_wödow
) {

532 
	`døw_√xt_sh≠e
(
°©e
);

535 if(
evít
->
wid
 =
°©e
->
√w_game_buâ⁄
) {

536 
	`døw_√w_game_buâ⁄
(
°©e
);

539 if(
evít
->
wid
 =
°©e
->
∑u£_c⁄töue_buâ⁄
) {

540 
	`døw_∑u£_c⁄töue_buâ⁄
(
°©e
);

543 if(
evít
->
wid
 =
°©e
->
™ti˛ockwi£_buâ⁄
) {

544 
	`døw_™ti˛ockwi£_buâ⁄
(
°©e
);

547 if(
evít
->
wid
 =
°©e
->
˛ockwi£_buâ⁄
) {

548 
	`døw_˛ockwi£_buâ⁄
(
°©e
);

551 if(
evít
->
wid
 =
°©e
->
À·_buâ⁄
) {

552 
	`døw_À·_buâ⁄
(
°©e
);

555 if(
evít
->
wid
 =
°©e
->
right_buâ⁄
) {

556 
	`døw_right_buâ⁄
(
°©e
);

559 if(
evít
->
wid
 =
°©e
->
dr›_buâ⁄
) {

560 
	`døw_dr›_buâ⁄
(
°©e
);

563 if(
evít
->
wid
 =
°©e
->
wñl_wödow
) {

564 
	`døw_wñl
(
°©e
, 1);

567 
	}
}

569 
	$h™dÀ_mou£_evít
(
n°©e
 *
°©e
)

571 
GR_EVENT_MOUSE
 *
evít
 = &
°©e
->evít.
mou£
;

573 if(
evít
->
wid
 =
°©e
->
√w_game_buâ⁄
) {

574 
°©e
->°©ê
STATE_NEWGAME
;

577 if(
evít
->
wid
 =
°©e
->
∑u£_c⁄töue_buâ⁄
) {

578 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

579 
°©e
->°©ê
STATE_PAUSED
;

582 if(
evít
->
wid
 =
°©e
->
™ti˛ockwi£_buâ⁄
) {

583 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

584 
	`rŸ©e_block
(
°©e
, 0);

587 if(
evít
->
wid
 =
°©e
->
˛ockwi£_buâ⁄
) {

588 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

589 
	`rŸ©e_block
(
°©e
, 1);

592 if(
evít
->
wid
 =
°©e
->
À·_buâ⁄
) {

593 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

594 
	`move_block
(
°©e
, 0);

597 if(
evít
->
wid
 =
°©e
->
right_buâ⁄
) {

598 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

599 
	`move_block
(
°©e
, 1);

602 if(
evít
->
wid
 =
°©e
->
dr›_buâ⁄
) {

603 if(
°©e
->°©ê=
STATE_PAUSED
Ë°©e->°©ê
STATE_RUNNING
;

604 
	`dr›_block
(
°©e
);

607 
	}
}

609 
	$h™dÀ_keybﬂrd_evít
(
n°©e
 *
°©e
)

611 
GR_EVENT_KEYSTROKE
 *
evít
 = &
°©e
->evít.
key°roke
;

613 
evít
->
ch
) {

616 
MWKEY_CANCEL
:

617 
°©e
->°©ê
STATE_EXIT
;

621 
MWKEY_APP1
:

622 
°©e
->°©ê
STATE_NEWGAME
;

626 if(
°©e
->°©ê=
STATE_STOPPED
) ;

628 
°©e
->°©ê
STATE_RUNNING
;

630 
evít
->
ch
) {

633 
°©e
->°©ê
STATE_PAUSED
;

637 
MWKEY_LEFT
:

638 
	`move_block
(
°©e
, 0);

642 
MWKEY_RIGHT
:

643 
	`move_block
(
°©e
, 1);

647 
MWKEY_UP
:

648 
	`rŸ©e_block
(
°©e
, 0);

652 
MWKEY_DOWN
:

653 
	`rŸ©e_block
(
°©e
, 1);

656 
MWKEY_MENU
:

657 
	`dr›_block
(
°©e
);

660 
	}
}

662 
	$h™dÀ_evít
(
n°©e
 *
°©e
)

664 
°©e
->
evít
.
ty≥
) {

665 
GR_EVENT_TYPE_EXPOSURE
:

666 
	`h™dÀ_exposuª_evít
(
°©e
);

668 
GR_EVENT_TYPE_BUTTON_DOWN
:

669 
	`h™dÀ_mou£_evít
(
°©e
);

671 
GR_EVENT_TYPE_KEY_DOWN
:

672 
	`h™dÀ_keybﬂrd_evít
(
°©e
);

674 
GR_EVENT_TYPE_CLOSE_REQ
:

675 
°©e
->°©ê
STATE_EXIT
;

677 
GR_EVENT_TYPE_TIMEOUT
:

680 
	`Ârötf
(
°dîr
, "UnhandledÉventÅype %d\n",

681 
°©e
->
evít
.
ty≥
);

684 
	}
}

686 
	$˛ór_wñl
(
n°©e
 *
°©e
)

688 
x
, 
y
;

690 
y
 = 0; y < 
WELL_HEIGHT
; y++)

691 
x
 = 0; x < 
WELL_WIDTH
; x++) {

692 
°©e
->
blocks
[0][
y
][
x
] = 0;

693 
°©e
->
blocks
[1][
y
][
x
] = 0;

695 
	}
}

697 
	$choo£_√w_sh≠e
(
n°©e
 *
°©e
)

699 
°©e
->
cuºít_sh≠e
.
ty≥
 = sèã->
√xt_sh≠e
.type;

700 
°©e
->
cuºít_sh≠e
.
‹õ¡©i⁄
 = sèã->
√xt_sh≠e
.orientation;

701 
°©e
->
cuºít_sh≠e
.
cﬁour
 = sèã->
√xt_sh≠e
.colour;

702 
°©e
->
cuºít_sh≠e
.
x
 = (
WELL_WIDTH
 / 2) - 2;

703 
°©e
->
cuºít_sh≠e
.
y
 = 
WELL_NOTVISIBLE
 -

704 
sh≠e_sizes
[
°©e
->
√xt_sh≠e
.
ty≥
]

705 [
°©e
->
√xt_sh≠e
.
‹õ¡©i⁄
][1] - 1;

706 
°©e
->
√xt_sh≠e
.
ty≥
 = 
	`øndom
(Ë% 
MAXSHAPES
;

707 
°©e
->
√xt_sh≠e
.
‹õ¡©i⁄
 = 
	`øndom
(Ë% 
MAXORIENTATIONS
;

708 
°©e
->
√xt_sh≠e
.
cﬁour
 = 
block_cﬁours
[
	`øndom
() %

709 (
MAX_BLOCK_COLOUR
 + 1)];

710 
	}
}

712 
	$√w_game
(
n°©e
 *
°©e
)

714 
	`˛ór_wñl
(
°©e
);

715 if(
°©e
->
sc‹e
 > sèã->
hisc‹e
) state->hiscore = state->score;

716 
°©e
->
sc‹e
 = 0;

717 
°©e
->
Àvñ
 = 0;

718 
	`døw_sc‹e
(
°©e
);

719 
	`choo£_√w_sh≠e
(
°©e
);

720 
	`døw_√xt_sh≠e
(
°©e
);

721 
	`døw_wñl
(
°©e
, 1);

722 if(
°©e
->°©ê=
STATE_NEWGAME
Ë°©e->°©ê
STATE_RUNNING
;

723 
	}
}

725 
	$öô_game
(
n°©e
 *
°©e
)

727 
GR_WM_PROPERTIES
 
¥›s
;

728 
GR_COORD
 
x
 = 
MAIN_WINDOW_X_POSITION
;

730 if(
	`GrO≥n
() < 0) {

731 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

732 
	`exô
(1);

735 
°©e
->
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 
x
,

736 
MAIN_WINDOW_Y_POSITION
,

737 
MAIN_WINDOW_WIDTH
,

738 
MAIN_WINDOW_HEIGHT
, 0,

739 
MAIN_WINDOW_BACKGROUND_COLOUR
, 0);

741 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

742 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 |

743 
GR_WM_PROPS_CLOSEBOX
;

744 
¥›s
.
tôÀ
 = "Nano-Tetris";

745 
	`GrSëWMPr›îtõs
(
°©e
->
maö_wödow
, &
¥›s
);

746 
	`GrSñe˘Evíts
(
°©e
->
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

747 
GR_EVENT_MASK_CLOSE_REQ
 |

748 
GR_EVENT_MASK_KEY_DOWN
 |

749 
GR_EVENT_MASK_TIMEOUT
);

751 
°©e
->
sc‹e_wödow
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

752 
SCORE_WINDOW_X_POSITION
,

753 
SCORE_WINDOW_Y_POSITION
,

754 
SCORE_WINDOW_WIDTH
,

755 
SCORE_WINDOW_HEIGHT
, 0,

756 
SCORE_WINDOW_BACKGROUND_COLOUR
, 0);

757 
	`GrSñe˘Evíts
(
°©e
->
sc‹e_wödow
, 
GR_EVENT_MASK_EXPOSURE
);

758 
	`GrM≠Wödow
(
°©e
->
sc‹e_wödow
);

759 
°©e
->
sc‹egcf
 = 
	`GrNewGC
();

760 
	`GrSëGCF‹eground
(
°©e
->
sc‹egcf
, 
SCORE_WINDOW_FOREGROUND_COLOUR
);

761 
	`GrSëGCBackground
(
°©e
->
sc‹egcf
, 
SCORE_WINDOW_BACKGROUND_COLOUR
);

762 
°©e
->
sc‹egcb
 = 
	`GrNewGC
();

763 
	`GrSëGCF‹eground
(
°©e
->
sc‹egcb
, 
SCORE_WINDOW_BACKGROUND_COLOUR
);

765 
°©e
->
√xt_sh≠e_wödow
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

766 
NEXT_SHAPE_WINDOW_X_POSITION
,

767 
NEXT_SHAPE_WINDOW_Y_POSITION
,

768 
NEXT_SHAPE_WINDOW_WIDTH
,

769 
NEXT_SHAPE_WINDOW_HEIGHT
, 0,

770 
NEXT_SHAPE_WINDOW_BACKGROUND_COLOUR
, 0);

771 
	`GrSñe˘Evíts
(
°©e
->
√xt_sh≠e_wödow
, 
GR_EVENT_MASK_EXPOSURE
);

772 
	`GrM≠Wödow
(
°©e
->
√xt_sh≠e_wödow
);

773 
°©e
->
√xtsh≠egcf
 = 
	`GrNewGC
();

774 
°©e
->
√xtsh≠egcb
 = 
	`GrNewGC
();

775 
	`GrSëGCF‹eground
(
°©e
->
√xtsh≠egcb
,

776 
NEXT_SHAPE_WINDOW_BACKGROUND_COLOUR
);

778 
°©e
->
√w_game_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

779 
NEW_GAME_BUTTON_X_POSITION
,

780 
NEW_GAME_BUTTON_Y_POSITION
,

781 
NEW_GAME_BUTTON_WIDTH
,

782 
NEW_GAME_BUTTON_HEIGHT
, 0,

783 
BUTTON_BACKGROUND_COLOUR
, 0);

784 
	`GrSñe˘Evíts
(
°©e
->
√w_game_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

785 
GR_EVENT_MASK_BUTTON_DOWN
);

786 
	`GrM≠Wödow
(
°©e
->
√w_game_buâ⁄
);

787 
°©e
->
buâ⁄gcf
 = 
	`GrNewGC
();

788 
	`GrSëGCF‹eground
(
°©e
->
buâ⁄gcf
, 
BUTTON_FOREGROUND_COLOUR
);

789 
	`GrSëGCBackground
(
°©e
->
buâ⁄gcf
, 
BUTTON_BACKGROUND_COLOUR
);

790 
°©e
->
buâ⁄gcb
 = 
	`GrNewGC
();

791 
	`GrSëGCF‹eground
(
°©e
->
buâ⁄gcb
, 
BUTTON_BACKGROUND_COLOUR
);

793 
°©e
->
∑u£_c⁄töue_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

794 
PAUSE_CONTINUE_BUTTON_X_POSITION
,

795 
PAUSE_CONTINUE_BUTTON_Y_POSITION
,

796 
PAUSE_CONTINUE_BUTTON_WIDTH
,

797 
PAUSE_CONTINUE_BUTTON_HEIGHT
, 0,

798 
BUTTON_BACKGROUND_COLOUR
, 0);

799 
	`GrSñe˘Evíts
(
°©e
->
∑u£_c⁄töue_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

800 
GR_EVENT_MASK_BUTTON_DOWN
);

802 
°©e
->
™ti˛ockwi£_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

803 
ANTICLOCKWISE_BUTTON_X_POSITION
,

804 
ANTICLOCKWISE_BUTTON_Y_POSITION
,

805 
ANTICLOCKWISE_BUTTON_WIDTH
,

806 
ANTICLOCKWISE_BUTTON_HEIGHT
, 0,

807 
BUTTON_BACKGROUND_COLOUR
,

809 
	`GrSñe˘Evíts
(
°©e
->
™ti˛ockwi£_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

810 
GR_EVENT_MASK_BUTTON_DOWN
);

812 
°©e
->
˛ockwi£_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

813 
CLOCKWISE_BUTTON_X_POSITION
,

814 
CLOCKWISE_BUTTON_Y_POSITION
,

815 
CLOCKWISE_BUTTON_WIDTH
,

816 
CLOCKWISE_BUTTON_HEIGHT
, 0,

817 
BUTTON_BACKGROUND_COLOUR
,

819 
	`GrSñe˘Evíts
(
°©e
->
˛ockwi£_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

820 
GR_EVENT_MASK_BUTTON_DOWN
);

822 
°©e
->
À·_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

823 
LEFT_BUTTON_X_POSITION
,

824 
LEFT_BUTTON_Y_POSITION
,

825 
LEFT_BUTTON_WIDTH
,

826 
LEFT_BUTTON_HEIGHT
, 0,

827 
BUTTON_BACKGROUND_COLOUR
,

829 
	`GrSñe˘Evíts
(
°©e
->
À·_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

830 
GR_EVENT_MASK_BUTTON_DOWN
);

832 
°©e
->
right_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

833 
RIGHT_BUTTON_X_POSITION
,

834 
RIGHT_BUTTON_Y_POSITION
,

835 
RIGHT_BUTTON_WIDTH
,

836 
RIGHT_BUTTON_HEIGHT
, 0,

837 
BUTTON_BACKGROUND_COLOUR
,

839 
	`GrSñe˘Evíts
(
°©e
->
right_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

840 
GR_EVENT_MASK_BUTTON_DOWN
);

842 
°©e
->
dr›_buâ⁄
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

843 
DROP_BUTTON_X_POSITION
,

844 
DROP_BUTTON_Y_POSITION
,

845 
DROP_BUTTON_WIDTH
,

846 
DROP_BUTTON_HEIGHT
, 0,

847 
BUTTON_BACKGROUND_COLOUR
,

849 
	`GrSñe˘Evíts
(
°©e
->
dr›_buâ⁄
, 
GR_EVENT_MASK_EXPOSURE
 |

850 
GR_EVENT_MASK_BUTTON_DOWN
);

852 
°©e
->
wñl_wödow
 = 
	`GrNewWödow
(°©e->
maö_wödow
,

853 
WELL_WINDOW_X_POSITION
,

854 
WELL_WINDOW_Y_POSITION
,

855 
WELL_WINDOW_WIDTH
,

856 
WELL_WINDOW_HEIGHT
, 0,

857 
WELL_WINDOW_BACKGROUND_COLOUR
, 0);

858 
	`GrSñe˘Evíts
(
°©e
->
wñl_wödow
, 
GR_EVENT_MASK_EXPOSURE
);

859 
	`GrM≠Wödow
(
°©e
->
wñl_wödow
);

860 
°©e
->
wñlgc
 = 
	`GrNewGC
();

862 
	`GrM≠Wödow
(
°©e
->
maö_wödow
);

864 
°©e
->°©ê
STATE_STOPPED
;

865 
°©e
->
sc‹e
 = 0;

866 
	`ªad_hisc‹e
(
°©e
);

867 
°©e
->
Àvñ
 = 0;

868 
°©e
->
ru¬ög_buâ⁄s_m≠≥d
 = 0;

870 
	`§™dom
(
	`time
(0));

872 
	`choo£_√w_sh≠e
(
°©e
);

873 
	`√w_game
(
°©e
);

874 
	}
}

876 
	$ˇlcuœã_timeout
(
n°©e
 *
°©e
)

878 
timevÆ
 
t
;

879 
u
;

881 
	`gëtimeofday
(&
t
, 
NULL
);

882 
u
 = 
t
.
tv_u£c
 + (
dñays
[
°©e
->
Àvñ
] * 1000);

883 
°©e
->
timeout
.
tv_£c
 = 
t
.tv_£¯+ (
u
 / 1000000);

884 
°©e
->
timeout
.
tv_u£c
 = 
u
 % 1000000;

885 
	}
}

887 
	$timeout_dñay
(
n°©e
 *
°©e
)

889 
timevÆ
 
t
;

890 sig√d 
s
, 
m
, 
ªt
;

892 
	`gëtimeofday
(&
t
, 
NULL
);

894 if((
t
.
tv_£c
 > 
°©e
->
timeout
.tv_sec) ||

895 ((
t
.
tv_£c
 =
°©e
->
timeout
.tv_sec) &&

896 
t
.
tv_u£c
 >
°©e
->
timeout
.tv_usec))  1;

898 
s
 = 
°©e
->
timeout
.
tv_£c
 - 
t
.tv_sec;

899 
m
 = ((
°©e
->
timeout
.
tv_u£c
 - 
t
.tv_usec) / 1000);

900 
ªt
 = ()((1000 * 
s
Ë+ 
m
);

907 if(
ªt
 <= 0)  1;

908  
ªt
;

909 
	}
}

911 
	$do_upd©e
(
n°©e
 *
°©e
)

913 
timevÆ
 
t
;

915 
	`gëtimeofday
(&
t
, 
NULL
);

917 if((
t
.
tv_£c
 > 
°©e
->
timeout
.tv_sec) ||

918 ((
t
.
tv_£c
 =
°©e
->
timeout
.tv_sec) &&

919 (
t
.
tv_u£c
 >
°©e
->
timeout
.tv_usec))) {

920 
	`dr›_block_1
(
°©e
);

921 
	`ˇlcuœã_timeout
(
°©e
);

923 
	}
}

925 
	$do_∑u£
(
n°©e
 *
°©e
)

927 
	`døw_∑u£_c⁄töue_buâ⁄
(
°©e
);

928 
°©e
->°©ê=
STATE_PAUSED
) {

929 
	`GrGëNextEvít
(&
°©e
->
evít
);

930 
	`h™dÀ_evít
(
°©e
);

932 
	`døw_∑u£_c⁄töue_buâ⁄
(
°©e
);

933 
	}
}

935 
	$waô_f‹_°¨t
(
n°©e
 *
°©e
)

937 
	`døw_∑u£_c⁄töue_buâ⁄
(
°©e
);

938 
°©e
->°©ê=
STATE_STOPPED
) {

939 
	`GrGëNextEvít
(&
°©e
->
evít
);

940 
	`h™dÀ_evít
(
°©e
);

942 if(
°©e
->°©ê=
STATE_NEWGAME
Ë°©e->°©ê
STATE_RUNNING
;

943 
	`døw_∑u£_c⁄töue_buâ⁄
(
°©e
);

944 
	`ˇlcuœã_timeout
(
°©e
);

945 
	}
}

947 
	$run_game
(
n°©e
 *
°©e
)

949 
°©e
->°©ê=
STATE_RUNNING
) {

950 
	`GrGëNextEvítTimeout
(&
°©e
->
evít
, 
	`timeout_dñay
(state));

951 
	`h™dÀ_evít
(
°©e
);

952 if(
°©e
->°©ê=
STATE_PAUSED
Ë
	`do_∑u£
(state);

953 if(
°©e
->°©ê=
STATE_RUNNING
Ë
	`do_upd©e
(state);

955 
	}
}

957 
	$maö_game_lo›
(
n°©e
 *
°©e
)

959 
	`waô_f‹_°¨t
(
°©e
);

960 
°©e
->°©ê!
STATE_EXIT
) {

961 if(
°©e
->°©ê=
STATE_RUNNING
Ë
	`run_game
(state);

962 if(
°©e
->°©ê=
STATE_STOPPED
Ë
	`waô_f‹_°¨t
(state);

963 if(
°©e
->°©ê!
STATE_EXIT
Ë
	`√w_game
(state);

965 
	}
}

967 
	$maö
(
¨gc
, *
¨gv
[])

969 
n°©e
 *
°©e
 = 
	`my_mÆloc
((nstate));

971 
	`öô_game
(
°©e
);

972 
	`maö_game_lo›
(
°©e
);

974 
	`wrôe_hisc‹e
(
°©e
);

976 
	`GrClo£
();

979 
	}
}

	@demos/nanox/ntetris.h

1 #i‚de‡
NTETRIS_H


2 
	#NTETRIS_H


	)

41 #i‚de‡
__ECOS


42 
	#USE_HISCORE_FILE


	)

43 
	#HISCORE_FILE
 "/u§/games/«nŸëris.hisc‹e"

	)

45 #unde‡
HAVE_USLEEP


46 
	#BLOCK_SIZE
 10

	)

47 
	#BORDER_WIDTH
 10

	)

48 
	#CONTROL_BAR_WIDTH
 90

	)

49 
	#BUTTON_HEIGHT
 20

	)

50 
	#BUTTON_WIDTH
 (
CONTROL_BAR_WIDTH
 - 
BORDER_WIDTH
)

	)

51 
	#BUTTON_BACKGROUND_COLOUR
 
GR_COLOR_GRAY75


	)

52 
	#BUTTON_FOREGROUND_COLOUR
 
GR_COLOR_BLACK


	)

53 
	#MOVEMENT_BUTTON_WIDTH
 ((
BUTTON_WIDTH
 / 2Ë- 1)

	)

54 
	#TEXT_X_POSITION
 5

	)

55 
	#TEXT_Y_POSITION
 15

	)

56 
	#TEXT2_Y_POSITION
 30

	)

57 
	#WELL_WIDTH
 12

	)

58 
	#WELL_HEIGHT
 28

	)

59 
	#WELL_VISIBLE_HEIGHT
 24

	)

60 
	#WELL_NOTVISIBLE
 (
WELL_HEIGHT
 - 
WELL_VISIBLE_HEIGHT
)

	)

61 
	#LEVEL_DIVISOR
 500

	)

62 #ifde‡
__ECOS


63 
	#DROP_BLOCK_DELAY
 10

	)

65 
	#DROP_BLOCK_DELAY
 25

	)

67 
	#DELETE_LINE_DELAY
 300

	)

68 
	#SCORE_INCREMENT
 100

	)

70 
	#MAIN_WINDOW_X_POSITION
 0

	)

71 
	#MAIN_WINDOW_Y_POSITION
 0

	)

72 
	#MAIN_WINDOW_WIDTH
 (
CONTROL_BAR_WIDTH
 + (2 * 
BORDER_WIDTH
) + \

73 (
WELL_WIDTH
 * 
BLOCK_SIZE
))

	)

74 
	#MAIN_WINDOW_HEIGHT
 ((2 * 
BORDER_WIDTH
) + \

75 (
WELL_VISIBLE_HEIGHT
 * 
BLOCK_SIZE
))

	)

76 
	#MAIN_WINDOW_BACKGROUND_COLOUR
 
GR_COLOR_NAVYBLUE


	)

78 
	#SCORE_WINDOW_WIDTH
 
BUTTON_WIDTH


	)

79 
	#SCORE_WINDOW_HEIGHT
 35

	)

80 
	#SCORE_WINDOW_X_POSITION
 
BORDER_WIDTH


	)

81 
	#SCORE_WINDOW_Y_POSITION
 
BORDER_WIDTH


	)

82 
	#SCORE_WINDOW_BACKGROUND_COLOUR
 
GR_COLOR_BLACK


	)

83 
	#SCORE_WINDOW_FOREGROUND_COLOUR
 
GR_COLOR_GREEN


	)

85 
	#NEXT_SHAPE_WINDOW_SIZE
 6

	)

86 
	#NEXT_SHAPE_WINDOW_WIDTH
 (
NEXT_SHAPE_WINDOW_SIZE
 * 
BLOCK_SIZE
)

	)

87 
	#NEXT_SHAPE_WINDOW_HEIGHT
 (
NEXT_SHAPE_WINDOW_SIZE
 * 
BLOCK_SIZE
)

	)

88 
	#NEXT_SHAPE_WINDOW_X_POSITION
 (
BORDER_WIDTH
 + 10)

	)

89 
	#NEXT_SHAPE_WINDOW_Y_POSITION
 ((2 * 
BORDER_WIDTH
Ë+ 
SCORE_WINDOW_HEIGHT
)

	)

90 
	#NEXT_SHAPE_WINDOW_BACKGROUND_COLOUR
 
GR_COLOR_BLACK


	)

92 
	#NEW_GAME_BUTTON_WIDTH
 
BUTTON_WIDTH


	)

93 
	#NEW_GAME_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

94 
	#NEW_GAME_BUTTON_X_POSITION
 
BORDER_WIDTH


	)

95 
	#NEW_GAME_BUTTON_Y_POSITION
 ((3 * 
BORDER_WIDTH
Ë+ 
SCORE_WINDOW_HEIGHT
 \

96 + 
NEXT_SHAPE_WINDOW_HEIGHT
)

	)

98 
	#PAUSE_CONTINUE_BUTTON_WIDTH
 
BUTTON_WIDTH


	)

99 
	#PAUSE_CONTINUE_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

100 
	#PAUSE_CONTINUE_BUTTON_X_POSITION
 
BORDER_WIDTH


	)

101 
	#PAUSE_CONTINUE_BUTTON_Y_POSITION
 ((4 * 
BORDER_WIDTH
) + \

102 
SCORE_WINDOW_HEIGHT
 + 
NEXT_SHAPE_WINDOW_HEIGHT
 + \

103 
NEW_GAME_BUTTON_HEIGHT
)

	)

105 
	#ANTICLOCKWISE_BUTTON_WIDTH
 
MOVEMENT_BUTTON_WIDTH


	)

106 
	#ANTICLOCKWISE_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

107 
	#ANTICLOCKWISE_BUTTON_X_POSITION
 
BORDER_WIDTH


	)

108 
	#ANTICLOCKWISE_BUTTON_Y_POSITION
 ((5 * 
BORDER_WIDTH
) + \

109 
SCORE_WINDOW_HEIGHT
 + 
NEXT_SHAPE_WINDOW_HEIGHT
 + \

110 
NEW_GAME_BUTTON_HEIGHT
 + 
PAUSE_CONTINUE_BUTTON_HEIGHT
)

	)

112 
	#CLOCKWISE_BUTTON_WIDTH
 
MOVEMENT_BUTTON_WIDTH


	)

113 
	#CLOCKWISE_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

114 
	#CLOCKWISE_BUTTON_X_POSITION
 (
ANTICLOCKWISE_BUTTON_X_POSITION
 + \

115 
ANTICLOCKWISE_BUTTON_WIDTH
 + 2)

	)

116 
	#CLOCKWISE_BUTTON_Y_POSITION
 
ANTICLOCKWISE_BUTTON_Y_POSITION


	)

118 
	#LEFT_BUTTON_WIDTH
 
MOVEMENT_BUTTON_WIDTH


	)

119 
	#LEFT_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

120 
	#LEFT_BUTTON_X_POSITION
 
BORDER_WIDTH


	)

121 
	#LEFT_BUTTON_Y_POSITION
 (
ANTICLOCKWISE_BUTTON_Y_POSITION
 + \

122 
ANTICLOCKWISE_BUTTON_HEIGHT
 + 2)

	)

124 
	#RIGHT_BUTTON_WIDTH
 
MOVEMENT_BUTTON_WIDTH


	)

125 
	#RIGHT_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

126 
	#RIGHT_BUTTON_X_POSITION
 (
LEFT_BUTTON_X_POSITION
 + 
LEFT_BUTTON_WIDTH
 + 2)

	)

127 
	#RIGHT_BUTTON_Y_POSITION
 
LEFT_BUTTON_Y_POSITION


	)

129 
	#DROP_BUTTON_WIDTH
 
BUTTON_WIDTH


	)

130 
	#DROP_BUTTON_HEIGHT
 
BUTTON_HEIGHT


	)

131 
	#DROP_BUTTON_X_POSITION
 
BORDER_WIDTH


	)

132 
	#DROP_BUTTON_Y_POSITION
 (
LEFT_BUTTON_Y_POSITION
 + 
LEFT_BUTTON_HEIGHT
 + 2)

	)

134 
	#WELL_WINDOW_WIDTH
 (
BLOCK_SIZE
 * 
WELL_WIDTH
)

	)

135 
	#WELL_WINDOW_HEIGHT
 (
BLOCK_SIZE
 * 
WELL_VISIBLE_HEIGHT
)

	)

136 
	#WELL_WINDOW_X_POSITION
 (
CONTROL_BAR_WIDTH
 + 
BORDER_WIDTH
)

	)

137 
	#WELL_WINDOW_Y_POSITION
 
BORDER_WIDTH


	)

138 
	#WELL_WINDOW_BACKGROUND_COLOUR
 
GR_COLOR_BLACK


	)

141 
	mSTATE_STOPPED
,

142 
	mSTATE_RUNNING
,

143 
	mSTATE_PAUSED
,

144 
	mSTATE_NEWGAME
,

145 
	mSTATE_EXIT
,

146 
	mSTATE_UNKNOWN


149 
GR_COLOR
 
	tblock
;

151 
	s¡ëris_sh≠e
 {

152 
	mty≥
;

153 
	m‹õ¡©i⁄
;

154 
GR_COLOR
 
	mcﬁour
;

155 
	mx
;

156 
	my
;

158 
¡ëris_sh≠e
 
	tsh≠e
;

160 
	s¡ëris_°©e
 {

161 
block
 
	mblocks
[2][
WELL_HEIGHT
][
WELL_WIDTH
];

162 
	msc‹e
;

163 
	mhisc‹e
;

164 
	mfhisc‹e
;

165 
	mÀvñ
;

166 
	m°©e
;

167 
	mru¬ög_buâ⁄s_m≠≥d
;

168 
sh≠e
 
	mcuºít_sh≠e
;

169 
sh≠e
 
	m√xt_sh≠e
;

170 
GR_WINDOW_ID
 
	mmaö_wödow
;

171 
GR_WINDOW_ID
 
	msc‹e_wödow
;

172 
GR_WINDOW_ID
 
	m√xt_sh≠e_wödow
;

173 
GR_WINDOW_ID
 
	m√w_game_buâ⁄
;

174 
GR_WINDOW_ID
 
	m∑u£_c⁄töue_buâ⁄
;

175 
GR_WINDOW_ID
 
	m™ti˛ockwi£_buâ⁄
;

176 
GR_WINDOW_ID
 
	m˛ockwi£_buâ⁄
;

177 
GR_WINDOW_ID
 
	mÀ·_buâ⁄
;

178 
GR_WINDOW_ID
 
	mright_buâ⁄
;

179 
GR_WINDOW_ID
 
	mdr›_buâ⁄
;

180 
GR_WINDOW_ID
 
	mwñl_wödow
;

181 
GR_GC_ID
 
	msc‹egcf
;

182 
GR_GC_ID
 
	msc‹egcb
;

183 
GR_GC_ID
 
	m√xtsh≠egcf
;

184 
GR_GC_ID
 
	m√xtsh≠egcb
;

185 
GR_GC_ID
 
	mbuâ⁄gcf
;

186 
GR_GC_ID
 
	mbuâ⁄gcb
;

187 
GR_GC_ID
 
	mwñlgc
;

188 
GR_EVENT
 
	mevít
;

189 
timevÆ
 
	mtimeout
;

191 
¡ëris_°©e
 
	tn°©e
;

193 *
my_mÆloc
(
size_t
 
size
);

194 
m¶ìp
(
ms
);

195 
ªad_hisc‹e
(
n°©e
 *
°©e
);

196 
wrôe_hisc‹e
(
n°©e
 *
°©e
);

197 
wûl_cﬁlide
(
n°©e
 *
°©e
, 
x
, 
y
, 
‹õ¡©i⁄
);

198 
døw_sh≠e
(
n°©e
 *
°©e
, 
GR_COORD
 
x
, GR_COORD 
y
, 
îa£
);

199 
døw_wñl
(
n°©e
 *
°©e
, 
f‹˚døw
);

200 
døw_sc‹e
(
n°©e
 *
°©e
);

201 
døw_√xt_sh≠e
(
n°©e
 *
°©e
);

202 
døw_√w_game_buâ⁄
(
n°©e
 *
°©e
);

203 
døw_™ti˛ockwi£_buâ⁄
(
n°©e
 *
°©e
);

204 
døw_˛ockwi£_buâ⁄
(
n°©e
 *
°©e
);

205 
døw_À·_buâ⁄
(
n°©e
 *
°©e
);

206 
døw_right_buâ⁄
(
n°©e
 *
°©e
);

207 
døw_dr›_buâ⁄
(
n°©e
 *
°©e
);

208 
døw_∑u£_c⁄töue_buâ⁄
(
n°©e
 *
°©e
);

209 
block_is_Æl_ö_wñl
(
n°©e
 *
°©e
);

210 
dñëe_löe
(
n°©e
 *
°©e
, 
löe
);

211 
block_ªached_bŸtom
(
n°©e
 *
°©e
);

212 
move_block
(
n°©e
 *
°©e
, 
dúe˘i⁄
);

213 
rŸ©e_block
(
n°©e
 *
°©e
, 
dúe˘i⁄
);

214 
dr›_block
(
n°©e
 *
°©e
);

215 
h™dÀ_exposuª_evít
(
n°©e
 *
°©e
);

216 
h™dÀ_mou£_evít
(
n°©e
 *
°©e
);

217 
h™dÀ_keybﬂrd_evít
(
n°©e
 *
°©e
);

218 
h™dÀ_evít
(
n°©e
 *
°©e
);

219 
˛ór_wñl
(
n°©e
 *
°©e
);

220 
choo£_√w_sh≠e
(
n°©e
 *
°©e
);

221 
√w_game
(
n°©e
 *
°©e
);

222 
öô_game
(
n°©e
 *
°©e
);

223 
ˇlcuœã_timeout
(
n°©e
 *
°©e
);

224 
timeout_dñay
(
n°©e
 *
°©e
);

225 
do_upd©e
(
n°©e
 *
°©e
);

226 
do_∑u£
(
n°©e
 *
°©e
);

227 
waô_f‹_°¨t
(
n°©e
 *
°©e
);

228 
run_game
(
n°©e
 *
°©e
);

229 
maö_game_lo›
(
n°©e
 *
°©e
);

231 
	#LEVELS
 12

	)

232 c⁄° 
	gdñays
[] = {600, 550, 500, 450, 400, 350,

234 
	#MAX_BLOCK_COLOUR
 3

	)

235 c⁄° 
GR_COLOR
 
	gblock_cﬁours
[] = {

236 
GR_COLOR_RED
, 
GR_COLOR_GREEN
, 
GR_COLOR_BLUE
, 
GR_COLOR_YELLOW


254 
	#MAXSHAPES
 7

	)

255 
	#MAXORIENTATIONS
 4

	)

256 
	#MAXCOLS
 5

	)

257 
	#MAXROWS
 4

	)

258 c⁄° 
	gsh≠es
[
MAXSHAPES
][
MAXORIENTATIONS
][
MAXROWS
][
MAXCOLS
] = {

404 c⁄° 
	gsh≠e_sizes
[
MAXSHAPES
][
MAXORIENTATIONS
][2] = {

	@demos/nanox/nxcal.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<gë›t.h
>

10 
	~"«no-X.h
"

11 
	~"nxcﬁ‹s.h
"

13 
	#DEFAULT_DATA_FILE
 "nxˇl.d©"

	)

15 
	spoöt
 {

16 
	mx
;

17 
	my
;

20 
	#TARGET_DIST
 15

	)

21 
	#CROSS_SIZE
 15

	)

23 
poöt
 
	göput
[4];

24 
poöt
 
	gèrgë
[4];

26 
GR_WINDOW_ID
 
	gg_wid
;

27 
GR_SCREEN_INFO
 
	gg_si
;

29 
	gg_rŸ©e
 = 
MWPORTRAIT_NONE
;

31 
	g°©e
 = 0;

33 
	$ußge
()

35 
	`¥ötf
("Usage:Çxcal [-f] [-d <datafile>]\n");

36 
	`exô
(0);

37 
	}
}

40 
	$sw≠em
(*
a
, *
b
)

42 
t
 = *
a
;

43 *
a
 = *
b
;

44 *
b
 = 
t
;

45 
	}
}

48 
	$ˇlcuœã_å™sf‹m
(
GR_TRANSFORM
 * 
å™s
)

51 
GR_CAL_DATA
 
d©a
;

52 
xdiff
 = 0, 
ydiff
 = 0;

53 
xysw≠
 = 0;

58 
g_rŸ©e
) {

59 
MWPORTRAIT_NONE
:

60 
MWPORTRAIT_DOWN
:

61 i‡(
	`abs
(
öput
[0].
x
 - input[1].x) < 50)

62 
xysw≠
 = 1;

65 
MWPORTRAIT_RIGHT
:

66 
MWPORTRAIT_LEFT
:

67 i‡(
	`abs
(
öput
[1].
x
 - input[2].x) < 50)

68 
xysw≠
 = 1;

79 
g_rŸ©e
) {

80 
MWPORTRAIT_NONE
:

81 
MWPORTRAIT_DOWN
:

83 i‡(!
xysw≠
) {

84 
d©a
.
möx
 = (
öput
[0].
x
 + input[3].x) / 2;

85 
d©a
.
maxx
 = (
öput
[1].
x
 + input[2].x) / 2;

87 
d©a
.
möy
 = (
öput
[0].
y
 + input[1].y) / 2;

88 
d©a
.
maxy
 = (
öput
[3].
y
 + input[2].y) / 2;

90 
xdiff
 = (Ë(
d©a
.
maxx
 -

91 
d©a
.
möx
Ë/ (
èrgë
[1].
x
 -

92 
èrgë
[0].
x
);

93 
ydiff
 = (Ë(
d©a
.
maxy
 -

94 
d©a
.
möy
Ë/ (
èrgë
[2].
y
 -

95 
èrgë
[1].
y
);

97 
d©a
.
xªs
 = 
g_si
.
cﬁs
;

98 
d©a
.
yªs
 = 
g_si
.
rows
;

100 
d©a
.
möy
 = (
öput
[0].
y
 + input[3].y) / 2;

101 
d©a
.
maxy
 = (
öput
[1].
y
 + input[2].y) / 2;

103 
d©a
.
möx
 = (
öput
[0].
x
 + input[1].x) / 2;

104 
d©a
.
maxx
 = (
öput
[3].
x
 + input[2].x) / 2;

106 
xdiff
 = (Ë(
d©a
.
maxx
 -

107 
d©a
.
möx
Ë/ (
èrgë
[2].
y
 -

108 
èrgë
[1].
y
);

109 
ydiff
 = (Ë(
d©a
.
maxy
 -

110 
d©a
.
möy
Ë/ (
èrgë
[1].
x
 -

111 
èrgë
[0].
x
);

112 
d©a
.
xªs
 = 
g_si
.
rows
;

113 
d©a
.
yªs
 = 
g_si
.
cﬁs
;

118 
MWPORTRAIT_RIGHT
:

119 
MWPORTRAIT_LEFT
:

121 i‡(!
xysw≠
) {

122 
d©a
.
möx
 = (
öput
[2].
x
 + input[3].x) / 2;

123 
d©a
.
maxx
 = (
öput
[0].
x
 + input[1].x) / 2;

125 
d©a
.
möy
 = (
öput
[0].
y
 + input[3].y) / 2;

126 
d©a
.
maxy
 = (
öput
[1].
y
 + input[2].y) / 2;

128 
ydiff
 = (Ë(
d©a
.
maxy
 -

129 
d©a
.
möy
Ë/ (
èrgë
[1].
x
 -

130 
èrgë
[0].
x
);

131 
xdiff
 = (Ë(
d©a
.
maxx
 -

132 
d©a
.
möx
Ë/ (
èrgë
[2].
y
 -

133 
èrgë
[1].
y
);

138 
d©a
.
xªs
 = 
g_si
.
rows
;

139 
d©a
.
yªs
 = 
g_si
.
cﬁs
;

141 
d©a
.
maxy
 = (
öput
[2].
y
 + input[3].y) / 2;

142 
d©a
.
möy
 = (
öput
[0].
y
 + input[1].y) / 2;

144 
d©a
.
möx
 = (
öput
[0].
x
 + input[3].x) / 2;

145 
d©a
.
maxx
 = (
öput
[1].
x
 + input[2].x) / 2;

147 
ydiff
 = (Ë(
d©a
.
maxy
 -

148 
d©a
.
möy
Ë/ (
èrgë
[2].
y
 -

149 
èrgë
[1].
y
);

150 
xdiff
 = (Ë(
d©a
.
maxx
 -

151 
d©a
.
möx
Ë/ (
èrgë
[1].
x
 -

152 
èrgë
[0].
x
);

154 
d©a
.
xªs
 = 
g_si
.
cﬁs
;

155 
d©a
.
yªs
 = 
g_si
.
rows
;

161 
d©a
.
möx
 -(Ë(
xdiff
 * 
TARGET_DIST
);

162 
d©a
.
möy
 -(Ë(
ydiff
 * 
TARGET_DIST
);

164 
d©a
.
maxx
 +(Ë(
xdiff
 * 
TARGET_DIST
);

165 
d©a
.
maxy
 +(Ë(
ydiff
 * 
TARGET_DIST
);

172 i‡(
g_rŸ©e
 =
MWPORTRAIT_DOWN
 || g_rŸ©ê=
MWPORTRAIT_LEFT
) {

173 
	`sw≠em
(&
d©a
.
möx
, &d©a.
maxx
);

174 
	`sw≠em
(&
d©a
.
möy
, &d©a.
maxy
);

179 
	`GrCÆcTønsf‹m
(&
d©a
, 
å™s
);

180 
	}
}

183 
	$døw_èrgë
(
GR_WINDOW_ID
 
wid
, 
GR_GC_ID
 
gc
, 
x
, 
y
)

186 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_WHITE
);

188 
	`GrFûlRe˘
(
wid
, 
gc
, 
x
 - 1, 
y
 - (
CROSS_SIZE
 / 2) - 1, 2,

189 
CROSS_SIZE
 / 2);

190 
	`GrFûlRe˘
(
wid
, 
gc
, 
x
 - 1, 
y
 + 1, 2, 
CROSS_SIZE
 / 2);

192 
	`GrFûlRe˘
(
wid
, 
gc
, 
x
 - (
CROSS_SIZE
 / 2Ë- 1, 
y
 - 1, CROSS_SIZE / 2, 2);

193 
	`GrFûlRe˘
(
wid
, 
gc
, 
x
 + 1, 
y
 - 1, 
CROSS_SIZE
 / 2, 2);

194 
	}
}

197 
	$døw_ãxt
(*
°r
, 
row
, 
GR_GC_ID
 
gc
)

199 
tw
, 
th
, 
tb
;

201 
	`GrGëGCTextSize
(
gc
, 
°r
, -1, 
GR_TFTOP
, &
tw
, &
th
, &
tb
);

202 
	`GrText
(
g_wid
, 
gc
, (
g_si
.
cﬁs
 - 
tw
Ë/ 2, 
row
, 
°r
, -1, 
GR_TFTOP
);

203 
	}
}

206 
	$ªdøw
()

208 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

209 
	`GrSëGCF‹eground
(
gc
, 
	`MWRGB
(30, 30, 30));

210 
	`GrFûlRe˘
(
g_wid
, 
gc
, 0, 0, 
g_si
.
cﬁs
, g_si.
rows
);

212 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_WHITE
);

213 
	`GrSëGCBackground
(
gc
, 
	`MWRGB
(30, 30, 30));

215 
	`døw_ãxt
("Mi¸owödow†CÆibøti⁄", 95, 
gc
);

216 
	`døw_ãxt
("TouchÅhê¸os†haú†fúmlyÅo", 120, 
gc
);

217 
	`døw_ãxt
("ˇlibøã you∏h™dhñd", 140, 
gc
);

219 
	`døw_èrgë
(
g_wid
, 
gc
, 
èrgë
[
°©e
].
x
,Å¨gë[°©e].
y
);

220 
	`GrDe°royGC
(
gc
);

221 
	}
}

224 
	$h™dÀ_pos
(
GR_EVENT_MOUSE
 * 
øw
)

227 i‡(
øw
->
buâ⁄s
 & 
GR_BUTTON_L
) {

228 
öput
[
°©e
].
x
 = 
øw
->
roŸx
;

229 
öput
[
°©e
].
y
 = 
øw
->
roŸy
;

233 i‡(!
°©e
 && !
öput
[°©e].
x
 && !öput[°©e].
y
)

236 i‡(
°©e
 == 3)

239 
°©e
++;

240 
	`ªdøw
();

243 
	}
}

248 
	$ˇlibøã
(
GR_TRANSFORM
 * 
å™s
)

251 
	`GrGëS¸ìnInfo
(&
g_si
);

253 
èrgë
[0].
x
 = 
TARGET_DIST
;

254 
èrgë
[0].
y
 = 
TARGET_DIST
;

256 
èrgë
[1].
x
 = 
g_si
.
cﬁs
 - 
TARGET_DIST
;

257 
èrgë
[1].
y
 = 
TARGET_DIST
;

259 
èrgë
[2].
x
 = 
g_si
.
cﬁs
 - 
TARGET_DIST
;

260 
èrgë
[2].
y
 = 
g_si
.
rows
 - 
TARGET_DIST
;

262 
èrgë
[3].
x
 = 
TARGET_DIST
;

263 
èrgë
[3].
y
 = 
g_si
.
rows
 - 
TARGET_DIST
;

265 
	`GrSëTønsf‹m
(
NULL
);

267 
g_wid
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_NODECORATE
, "nxˇl", 
GR_ROOT_WINDOW_ID
,

268 0, 0, 
g_si
.
cﬁs
, g_si.
rows
, 
GR_COLOR_BLACK
);

270 
	`GrSñe˘Evíts
(
g_wid
,

271 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_MOUSE_POSITION
);

273 
	`GrM≠Wödow
(
g_wid
);

274 
	`GrSëFocus
(
g_wid
);

277 
GR_EVENT
 
evít
;

278 
	`GrGëNextEvít
(&
evít
);

280 i‡(
evít
.
ty≥
 =
GR_EVENT_TYPE_EXPOSURE
)

281 
	`ªdøw
();

282 i‡(
evít
.
ty≥
 =
GR_EVENT_TYPE_MOUSE_POSITION
)

283 i‡(
	`h™dÀ_pos
(&
evít
.
mou£
)) {

284 
	`ˇlcuœã_å™sf‹m
(
å™s
);

288 
	}
}

291 
	$maö
(
¨gc
, **
¨gv
)

293 
ªt
 = 0;

295 
f‹˚_ˇlibøã
 = 0;

296 
d©afûe
[128];

298 
GR_TRANSFORM
 
å™s
;

299 
GR_SCREEN_INFO
 
si
;

301 
d©afûe
[0] = 0;

303 i‡(
	`GrO≥n
() < 0) {

304 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

308 
	`GrGëS¸ìnInfo
(&
si
);

309 
g_rŸ©e
 = 
si
.
p‹åaô
;

312 *
›èrg
;

314 sig√d 
ch
 = 
	`gë›t
(
¨gc
, 
¨gv
, "fd:");

315 i‡(
ch
 == -1)

317 
ch
) {

319 
f‹˚_ˇlibøã
 = 1;

322 
	`°∫˝y
(
d©afûe
, 
›èrg
, (datafile) - 1);

325 
	`ußge
();

329 i‡(!
	`°æí
(
d©afûe
))

330 
	`°r˝y
(
d©afûe
, 
DEFAULT_DATA_FILE
);

332 
ªt
 = 
	`GrLﬂdTønsf‹mD©a
(
d©afûe
, &
å™s
);

334 i‡(!
ªt
 && !
f‹˚_ˇlibøã
)

335 
	`GrSëTønsf‹m
(&
å™s
);

337 
	`ˇlibøã
(&
å™s
);

338 
	`GrSëTønsf‹m
(&
å™s
);

339 
	`GrSaveTønsf‹mD©a
(&
å™s
, 
d©afûe
);

342 
	`GrClo£
();

344 
	}
}

	@demos/nanox/nxclock.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

11 
	~<time.h
>

12 
	~<sys/time.h
>

13 
	#MWINCLUDECOLORS


	)

14 
	~"«no-X.h
"

18 
	#CWIDTH
 100

	)

19 
	#CHEIGHT
 100

	)

24 
	#_
 ((Ë0Ë

	)

25 
	#X
 ((Ë1Ë

	)

26 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

27 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

28 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

30 
GR_WINDOW_ID
 
	gw1
;

31 
GR_GC_ID
 
	ggc1
;

32 
GR_GC_ID
 
	ggc2
;

33 
	glh
 = -1, 
	glm
 = -1, 
	gls
 = -1;

34 
time_t
 
	gthí
;

36 
	gåig
[91] =

45 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

46 
do_˛ock
();

48 
do_idÀ
();

50 
bsö
(
™gÀ
);

51 
bcos
(
™gÀ
);

52 
døw_time
(
hour
, 
möuãs
, 
£c
, 
GR_GC_ID
 
gc
);

55 
	$maö
(
ac
, **
av
)

57 
GR_EVENT
 
evít
;

58 
GR_BITMAP
 
bôm≠1fg
[7];

59 
GR_BITMAP
 
bôm≠1bg
[7];

61 i‡(
	`GrO≥n
() < 0) {

62 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

63 
	`exô
(1);

67 
w1
 = 
	`GrNewWödowEx
(

68 
GR_WM_PROPS_NOAUTOMOVE
|
GR_WM_PROPS_BORDER
|
GR_WM_PROPS_CAPTION
|

69 
GR_WM_PROPS_CLOSEBOX
, "nx˛ock", 
GR_ROOT_WINDOW_ID
,

70 10, 10, 
CWIDTH
, 
CHEIGHT
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOW
));

72 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

74 
gc1
 = 
	`GrNewGC
();

75 
gc2
 = 
	`GrNewGC
();

77 
	`GrSëGCF‹eground
(
gc1
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOW
));

78 
	`GrSëGCBackground
(
gc1
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWTEXT
));

79 
	`GrSëGCF‹eground
(
gc2
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWTEXT
));

80 
	`GrSëGCBackground
(
gc2
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOW
));

82 
bôm≠1bg
[0] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

83 
bôm≠1bg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

84 
bôm≠1bg
[2] = 
	`MASK
(
X
,X,X,X,X,X,X);

85 
bôm≠1bg
[3] = 
	`MASK
(
X
,X,X,X,X,X,X);

86 
bôm≠1bg
[4] = 
	`MASK
(
X
,X,X,X,X,X,X);

87 
bôm≠1bg
[5] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

88 
bôm≠1bg
[6] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

90 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

91 
bôm≠1fg
[1] = 
	`MASK
(
_
,
X
,_,X,_,X,_);

92 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

93 
bôm≠1fg
[3] = 
	`MASK
(
X
,
_
,_,X,X,_,X);

94 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,_,_,_,_,_);

95 
bôm≠1fg
[5] = 
	`MASK
(
_
,
X
,_,_,_,X,_);

96 
bôm≠1fg
[6] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

98 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

99 
	`GrM≠Wödow
(
w1
);

102 
	`GrGëNextEvítTimeout
(&
evít
, 500L);

104 
evít
.
ty≥
) {

105 
GR_EVENT_TYPE_EXPOSURE
:

106 
	`do_exposuª
(&
evít
.
exposuª
);

109 
GR_EVENT_TYPE_CLOSE_REQ
:

110 
	`GrClo£
();

111 
	`exô
(0);

113 
GR_EVENT_TYPE_TIMEOUT
:

114 
	`do_˛ock
();

118 
	}
}

120 
	$bsö
(
™gÀ
)

122 if(
™gÀ
 < 91) {

123  
åig
[
™gÀ
];

124 } i‡(
™gÀ
 < 181) {

125  
åig
[180 - 
™gÀ
];

126 } i‡(
™gÀ
 < 271) {

127  -
åig
[
™gÀ
 - 180];

128 } i‡(
™gÀ
 < 361) {

129  -
åig
[360 - 
™gÀ
];

133 
	}
}

135 
	$bcos
(
™gÀ
)

137 if(
™gÀ
 < 91) {

138  
åig
[90 - 
™gÀ
];

139 } i‡(
™gÀ
 < 181) {

140  -
åig
[
™gÀ
 - 90];

141 } i‡(
™gÀ
 < 271) {

142  -
åig
[270 - 
™gÀ
];

143 } i‡(
™gÀ
 < 361) {

144  
åig
[
™gÀ
 - 270];

148 
	}
}

154 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

156 
GR_COORD
 
midx
 = 
CWIDTH
 / 2;

157 
GR_COORD
 
midy
 = 
CHEIGHT
 / 2;

158 
i
, 
l
;

162 
	`GrEŒù£
(
w1
, 
gc2
, 
midx
, 
midy
, midx - 1, midy - 1);

163 
i
 = 0; i < 60; i++) {

164 i‡(
i
%5 == 0) {

165 
l
 = 5;

167 
l
 = 0;

169 
	`GrLöe
(
w1
, 
gc2
,

170 
midx
 + (((midx - 3Ë* 
	`bsö
(
i
 * 6)) >> 8),

171 
midy
 + (((midy - 3Ë* 
	`bcos
(
i
 * 6)) >> 8),

172 
midx
 + (((midx - 3 - 
l
Ë* 
	`bsö
(
i
 * 6)) >> 8),

173 
midy
 + (((midy - 3 - 
l
Ë* 
	`bcos
(
i
 * 6)) >> 8));

176 
lh
 = -1; 
lm
 = -1; 
ls
 = -1;

177 
thí
 = 0;

178 
	`do_˛ock
();

179 
	}
}

181 
	$døw_time
(
hour
, 
möuãs
, 
£c
, 
GR_GC_ID
 
gc
)

183 
GR_COORD
 
midx
 = 
CWIDTH
 / 2;

184 
GR_COORD
 
midy
 = 
CHEIGHT
 / 2;

186 
	`GrLöe
(
w1
, 
gc1
,

187 
midx
 + (((midx - 8 - midx / 10Ë* 
	`bsö
(
ls
)) >> 8),

188 
midy
 - (((midy - 8 - midy / 10Ë* 
	`bcos
(
ls
)) >> 8),

189 
midx
 + (((midx - 8 - midx / 4Ë* 
	`bsö
(
ls
)) >> 8),

190 
midy
 - (((midy - 8 - 
midx
 / 4Ë* 
	`bcos
(
ls
)) >> 8));

191 
	`GrLöe
(
w1
, 
gc2
,

192 
midx
 + (((midx - 8 - midx / 10Ë* 
	`bsö
(
£c
)) >> 8),

193 
midy
 - (((midy - 8 - midy / 10Ë* 
	`bcos
(
£c
)) >> 8),

194 
midx
 + (((midx - 8 - midx / 4Ë* 
	`bsö
(
£c
)) >> 8),

195 
midy
 - (((midy - 8 - 
midx
 / 4Ë* 
	`bcos
(
£c
)) >> 8));

196 i‡((
lm
 !
möuãs
Ë|| (
ls
 == minutes)) {

197 
	`GrLöe
(
w1
, 
gc1
,

198 
midx
 + (((midx - 8 - midx / 10Ë* 
	`bsö
(
lm
)) >> 8),

199 
midy
 - (((midy - 8 - midy / 10Ë* 
	`bcos
(
lm
)) >> 8),

200 
midx
 + (((midx / 5Ë* 
	`bsö
(
lm
)) >> 8),

201 
midy
 - (((midy / 5Ë* 
	`bcos
(
lm
)) >> 8));

202 
	`GrLöe
(
w1
, 
gc2
,

203 
midx
 + (((midx - 8 - midx / 10Ë* 
	`bsö
(
möuãs
)) >> 8),

204 
midy
 - (((midy - 8 - midy / 10Ë* 
	`bcos
(
möuãs
)) >> 8),

205 
midx
 + (((midx / 5Ë* 
	`bsö
(
möuãs
)) >> 8),

206 
midy
 - (((midy / 5Ë* 
	`bcos
(
möuãs
)) >> 8));

207 
	`GrLöe
(
w1
, 
gc1
,

208 
midx
 + (((midx - 8 - midx / 2Ë* 
	`bsö
(
lh
)) >> 8),

209 
midy
 - (((midy - 8 - midy / 2Ë* 
	`bcos
(
lh
)) >> 8),

210 
midx
 + (((midx / 5Ë* 
	`bsö
(
lh
)) >> 8),

211 
midy
 - (((midy / 5Ë* 
	`bcos
(
lh
)) >> 8));

212 
	`GrLöe
(
w1
, 
gc2
,

213 
midx
 + (((midx - 8 - midx / 2Ë* 
	`bsö
(
hour
)) >> 8),

214 
midy
 - (((midy - 8 - midy / 2Ë* 
	`bcos
(
hour
)) >> 8),

215 
midx
 + (((midx / 5Ë* 
	`bsö
(
hour
)) >> 8),

216 
midy
 - (((midy / 5Ë* 
	`bcos
(
hour
)) >> 8));

218 
lh
 = 
hour
;

219 
lm
 = 
möuãs
;

220 
ls
 = 
£c
;

221 
	}
}

227 
	$do_˛ock
()

229 
timevÆ
 
tv
;

230 
timez⁄e
 
tz
;

231 
tm
 * 
ç
;

232 
time_t
 
now
;

233 
möuãs
, 
hour
, 
£c
;

235 
	`gëtimeofday
(&
tv
, &
tz
);

236 
now
 = 
tv
.
tv_£c
 - (60 * 
tz
.
tz_möuãswe°
);

237 i‡(
now
 =
thí
) {

240 
thí
 = 
now
;

241 
ç
 = 
	`gmtime
(&
now
);

242 
möuãs
 = 
ç
->
tm_mö
 * 6;

243 
£c
 = 
ç
->
tm_£c
 * 6;

244 
hour
 = 
ç
->
tm_hour
;

245 i‡(
hour
 > 12) {

246 
hour
 -= 12;

248 
hour
 = hour*30 + 
möuãs
/12;

249 
	`døw_time
(
hour
, 
möuãs
, 
£c
, 
gc2
);

250 
	}
}

256 
	$do_idÀ
()

258 
time•ec
 
idÀtime
;

259 
idÀtime
.
tv_£c
 = 0;

260 
idÀtime
.
tv_n£c
 = 100000;

261 
	`«no¶ìp
(&
idÀtime
, 
NULL
);

262 
	}
}

	@demos/nanox/nxev.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	#MWINCLUDECOLORS


	)

13 
	~"«no-X.h
"

16 
GR_WINDOW_ID
 
	gw1
;

17 
GR_WINDOW_ID
 
	gw2
;

18 
GR_GC_ID
 
	ggc1
;

20 
	#ALT_CURSOR


	)

22 
	#WIDTH
 100

	)

23 
	#HEIGHT
 100

	)

25 #ifde‡
ALT_CURSOR


29 
	#_
 ((Ë0Ë

	)

30 
	#X
 ((Ë1Ë

	)

31 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

32 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

33 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

36 
	s_xœt
 {

37 
GR_UPDATE_TYPE
 
	mty≥
;

38 c⁄° * 
	m«me
;

40 
_xœt
 
	tXLAT
;

42 
XLAT
 
	gupd©e_ty≥s
[] = {

44 { 
GR_UPDATE_MAP
, "GR_UPDATE_MAP" },

45 { 
GR_UPDATE_UNMAP
, "GR_UPDATE_UNMAP" },

46 { 
GR_UPDATE_MOVE
, "GR_UPDATE_MOVE" },

47 { 
GR_UPDATE_SIZE
, "GR_UPDATE_SIZE" },

48 { 
GR_UPDATE_UNMAPTEMP
, "GR_UPDATE_UNMAPTEMP" },

49 { 
GR_UPDATE_ACTIVATE
, "GR_UPDATE_ACTIVATE" },

50 { 
GR_UPDATE_DESTROY
, "GR_UPDATE_DESTROY" }

52 
	#NR_UPDATES
 7

	)

54 
	sXLAT
 {

55 
	mevít_ty≥
;

56 * 
	mevít_desc
;

59 
XLAT
 
	gèbÀ
[] = {

60 { 
GR_EVENT_TYPE_ERROR
, "GR_EVENT_TYPE_ERROR" },

61 { 
GR_EVENT_TYPE_NONE
, "GR_EVENT_TYPE_NONE" },

62 { 
GR_EVENT_TYPE_EXPOSURE
, "GR_EVENT_TYPE_EXPOSURE" },

63 { 
GR_EVENT_TYPE_BUTTON_DOWN
, "GR_EVENT_TYPE_BUTTON_DOWN" },

64 { 
GR_EVENT_TYPE_BUTTON_UP
, "GR_EVENT_TYPE_BUTTON_UP" },

65 { 
GR_EVENT_TYPE_MOUSE_ENTER
, "GR_EVENT_TYPE_MOUSE_ENTER" },

66 { 
GR_EVENT_TYPE_MOUSE_EXIT
, "GR_EVENT_TYPE_MOUSE_EXIT" },

67 { 
GR_EVENT_TYPE_MOUSE_MOTION
, "GR_EVENT_TYPE_MOUSE_MOTION" },

68 { 
GR_EVENT_TYPE_MOUSE_POSITION
, "GR_EVENT_TYPE_MOUSE_POSITION" },

69 { 
GR_EVENT_TYPE_KEY_DOWN
, "GR_EVENT_TYPE_KEY_DOWN" },

70 { 
GR_EVENT_TYPE_KEY_UP
, "GR_EVENT_TYPE_KEY_UP" },

71 { 
GR_EVENT_TYPE_FOCUS_IN
, "GR_EVENT_TYPE_FOCUS_IN" },

72 { 
GR_EVENT_TYPE_FOCUS_OUT
, "GR_EVENT_TYPE_FOCUS_OUT" },

73 { 
GR_EVENT_TYPE_FDINPUT
, "GR_EVENT_TYPE_FDINPUT" },

74 { 
GR_EVENT_TYPE_UPDATE
, "GR_EVENT_TYPE_UPDATE" },

75 { 
GR_EVENT_TYPE_CHLD_UPDATE
, "GR_EVENT_TYPE_CHLD_UPDATE" },

76 { 
GR_EVENT_TYPE_CLOSE_REQ
, "GR_EVENT_TYPE_CLOSE_REQ" },

79 
	#èbÀ_SZ
 ((
èbÀ
Ë/ —abÀ[0]))

	)

82 
	$lookupEvít
(
ty≥
)

84 
i
;

86 
i
 = 0; i < 
èbÀ_SZ
; i++)

87 i‡(
èbÀ
[
i
].
evít_ty≥
 =
ty≥
)

88  
èbÀ
[
i
].
evít_desc
;

90  
NULL
;

91 
	}
}

94 
	$maö
(
¨gc
, **
¨gv
)

96 
GR_EVENT
 
evít
;

98 i‡(
	`GrO≥n
() < 0) {

99 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

100 
	`exô
(1);

103 
	`GrReqShmCmds
(65536);

105 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
,

107 
WIDTH
, 
HEIGHT
,

109 
WHITE
, 
BLACK
);

110 
	`GrSñe˘Evíts
(
w1
, 0xffffffffl);

112 
w2
 = 
	`GrNewWödow
(
w1
,

114 
WIDTH
 / 4, 
HEIGHT
 / 4,

116 
WHITE
, 
BLACK
);

117 
	`GrSñe˘Evíts
(
w2
, 0xffffffffl);

121 
GR_WM_PROPERTIES
 
¥›s
;

123 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

125 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 | \

126 
GR_WM_PROPS_CAPTION
 | 
GR_WM_PROPS_CLOSEBOX
;

127 
¥›s
.
tôÀ
 = "nano-X Events";

128 
	`GrSëWMPr›îtõs
(
w1
, &
¥›s
);

131 
	`GrM≠Wödow
(
w1
);

132 
	`GrM≠Wödow
(
w2
);

134 
gc1
 = 
	`GrNewGC
();

136 
	`GrSëGCF‹eground
(
gc1
, 
BLACK
);

137 
	`GrSëGCBackground
(
gc1
, 
WHITE
);

140 #ifde‡
ALT_CURSOR


142 
GR_BITMAP
 
bôm≠1fg
[7];

143 
GR_BITMAP
 
bôm≠1bg
[7];

145 
bôm≠1bg
[0] = 
	`MASK
(
X
,X,X,X,X,X,X);

146 
bôm≠1bg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

147 
bôm≠1bg
[2] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

148 
bôm≠1bg
[3] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

149 
bôm≠1bg
[4] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

150 
bôm≠1bg
[5] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

151 
bôm≠1bg
[6] = 
	`MASK
(
X
,X,X,X,X,X,X);

153 
bôm≠1fg
[0] = 
	`MASK
(
X
,X,X,X,X,X,X);

154 
bôm≠1fg
[1] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

155 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

156 
bôm≠1fg
[3] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

157 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

158 
bôm≠1fg
[5] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

159 
bôm≠1fg
[6] = 
	`MASK
(
X
,X,X,X,X,X,X);

161 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
WHITE
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

167 
	`GrGëNextEvít
(&
evít
);

169 
	`¥ötf
("%s (0x%x)\n", \

170 
	`lookupEvít
(
evít
.
ty≥
),Évent.type);

172 
evít
.
ty≥
) {

173 
GR_EVENT_TYPE_EXPOSURE
:

175 
	`¥ötf
("\twid = %d\n", 
evít
.
exposuª
.
wid
);

176 
	`¥ötf
("\t(X, Y) = (%d, %d)\n", \

177 
evít
.
exposuª
.
x
,Évít.exposuª.
y
);

178 
	`¥ötf
("\twidth = %d, height = %d\n", \

179 
evít
.
exposuª
.
width
,Évít.exposuª.
height
);

182 
GR_EVENT_TYPE_BUTTON_DOWN
:

183 
GR_EVENT_TYPE_BUTTON_UP
:

185 
	`¥ötf
("\twid = %d\n", 
evít
.
buâ⁄
.
wid
);

186 
	`¥ötf
("\tsub-wödow id = %d\n", 
evít
.
buâ⁄
.
subwid
);

187 
	`¥ötf
("\troot window (X, Y) coordinates = (%d, %d)\n", \

188 
evít
.
buâ⁄
.
roŸx
,Évít.buâ⁄.
roŸy
);

189 
	`¥ötf
("\t(X, Y) = (%d, %d)\n", \

190 
evít
.
buâ⁄
.
x
,Évít.buâ⁄.
y
);

191 
	`¥ötf
("\tbuâ⁄s: %04X, ", 
evít
.
buâ⁄
.
buâ⁄s
);

192 
	`¥ötf
("ch™ged buâ⁄s: %04X\n", 
evít
.
buâ⁄
.
ch™gebuâ⁄s
);

193 
	`¥ötf
("\tmodifõrs: %04X\n", 
evít
.
buâ⁄
.
modifõrs
);

196 
GR_EVENT_TYPE_MOUSE_ENTER
:

197 
GR_EVENT_TYPE_MOUSE_EXIT
:

198 
GR_EVENT_TYPE_MOUSE_MOTION
:

199 
GR_EVENT_TYPE_MOUSE_POSITION
:

201 
	`¥ötf
("\twid = %d\n", 
evít
.
mou£
.
wid
);

202 
	`¥ötf
("\tsub-wödow id = %d\n", 
evít
.
mou£
.
subwid
);

203 
	`¥ötf
("\troot window (X, Y) coordinates = (%d, %d)\n", \

204 
evít
.
mou£
.
roŸx
,Évít.mou£.
roŸy
);

205 
	`¥ötf
("\t(X, Y) = (%d, %d)\n", \

206 
evít
.
mou£
.
x
,Évít.mou£.
y
);

207 
	`¥ötf
("\tbuâ⁄s: %04X\n", 
evít
.
mou£
.
buâ⁄s
);

208 
	`¥ötf
("\tmodifõrs: %04X\n", 
evít
.
mou£
.
modifõrs
);

211 
GR_EVENT_TYPE_KEY_DOWN
:

212 
GR_EVENT_TYPE_KEY_UP
:

214 
	`¥ötf
("\twid = %d\n", 
evít
.
key°roke
.
wid
);

215 
	`¥ötf
("\tsub-wödow id = %d\n", 
evít
.
key°roke
.
subwid
);

216 
	`¥ötf
("\troot window (X, Y) coordinates = (%d, %d)\n", \

217 
evít
.
key°roke
.
roŸx
,Évít.key°roke.
roŸy
);

218 
	`¥ötf
("\t(X, Y) = (%d, %d)\n", \

219 
evít
.
key°roke
.
x
,Évít.key°roke.
y
);

220 
	`¥ötf
("\tbuâ⁄s: %04X\n", 
evít
.
key°roke
.
buâ⁄s
);

221 
	`¥ötf
("\tmodifõrs: %04X\n", 
evít
.
key°roke
.
modifõrs
);

222 
	`¥ötf
("\tUnicode-16 keyvalue: %d, ASCII: %d\n", \

223 ()
evít
.
key°roke
.
ch
,Évent.keystroke.ch);

224 
	`¥ötf
("\tscancode: %02X\n",

225 ()
evít
.
key°roke
.
sˇncode
);

228 
GR_EVENT_TYPE_FOCUS_IN
:

229 
	`¥ötf
("\twid = %d\n", 
evít
.
gíîÆ
.
wid
);

230 
	`¥ötf
("\tﬁd focu†%d\n", 
evít
.
gíîÆ
.
Ÿhîid
);

232 
GR_EVENT_TYPE_FOCUS_OUT
:

233 
	`¥ötf
("\twid = %d\n", 
evít
.
gíîÆ
.
wid
);

234 
	`¥ötf
("\äew focu†%d\n", 
evít
.
gíîÆ
.
Ÿhîid
);

236 
GR_EVENT_TYPE_UPDATE
:

237 
GR_EVENT_TYPE_CHLD_UPDATE
:

239 
	`¥ötf
("\twid = %d\n", 
evít
.
upd©e
.
wid
);

240 
	`¥ötf
("\tsub-wödow id = %d\n", 
evít
.
upd©e
.
subwid
);

241 
	`¥ötf
("\t(X, Y) = (%d, %d)\n", \

242 
evít
.
upd©e
.
x
,Évít.upd©e.
y
);

243 
	`¥ötf
("\twidth = %d, height = %d\n", \

244 
evít
.
upd©e
.
width
,Évít.upd©e.
height
);

246 
GR_UPDATE_TYPE
 
u
 = 
evít
.
upd©e
.
uty≥
;

247 c⁄° * 
p
;

249 
p
 = (
u
 > 
NR_UPDATES
)? \

251 
upd©e_ty≥s
[
u
].
«me
;

253 
	`¥ötf
("\tupdate_type: %s (%d)\n",

254 
p
, 
u
);

258 
GR_EVENT_TYPE_TIMEOUT
:

259 
	`¥ötf
("\ttimeout?\n");

261 
GR_EVENT_TYPE_CLOSE_REQ
:

262 
	`GrClo£
();

263 
	`exô
(0);

269 
	}
}

	@demos/nanox/nxeyes.c

32 
	~<time.h
>

33 
	~<m©h.h
>

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

37 
	~<«no-X.h
>

38 
	~<nxcﬁ‹s.h
>

39 
	~"nxeyes.h
"

41 
	#EYE_SPACING
 4

	)

42 
	#BLINK_CLOSED_TIME
 100

	)

43 
	#BLINK_MIN_OPEN_TIME
 1000

	)

44 
	#BLINK_MAX_OPEN_TIME
 8000

	)

45 
	#MAX_EYE_MOVEMENT
 10

	)

48 
GR_WINDOW_ID
 
	mwid
;

49 
GR_GC_ID
 
	mgc
;

50 
	mbuâ⁄_down
;

51 
	mmou£_moved
;

52 
GR_COORD
 
	mx
;

53 
GR_COORD
 
	my
;

54 
GR_COORD
 
	mmou£x
;

55 
GR_COORD
 
	mmou£y
;

56 
GR_COORD
 
	mﬁdx
;

57 
GR_COORD
 
	mﬁdy
;

58 
	meyes_˛o£d
;

59 
GR_TIMER_ID
 
	mtid
;

60 
GR_COORD
 
	mlx
;

61 
GR_COORD
 
	mly
;

62 
GR_COORD
 
	mrx
;

63 
GR_COORD
 
	mry
;

64 
GR_COORD
 
	mﬁx
;

65 
GR_COORD
 
	mﬁy
;

66 
GR_COORD
 
	m‹x
;

67 
GR_COORD
 
	m‹y
;

68 
	mquô
;

69 } 
	tnxeyes_°©e
;

71 
nxeyes_°©e
 *
öô
();

72 
buâ⁄_evít
(
GR_EVENT_BUTTON
 *
ev
, 
nxeyes_°©e
 *
°©e
);

73 
posôi⁄_evít
(
GR_EVENT_MOUSE
 *
ev
, 
nxeyes_°©e
 *
°©e
);

74 
°¨t_blök_timî
(
nxeyes_°©e
 *
°©e
);

75 
timî_evít
(
GR_EVENT_TIMER
 *
ev
, 
nxeyes_°©e
 *
°©e
);

76 
ˇlcuœã_pupû_posôi⁄
(
GR_COORD
 
wödow_x
, GR_COORD 
wödow_y
,

77 
GR_COORD
 
eye˚¡ª_x
, GR_COORD 
eye˚¡ª_y
,

78 
GR_COORD
 
mou£x
, GR_COORD 
mou£y
,

79 
GR_COORD
 *
ªtx
, GR_COORD *
ªty
);

80 
døw_eyes
(
nxeyes_°©e
 *
°©e
, 
fuŒ_ªdøw
);

82 
nxeyes_°©e
 *
	$öô
()

84 
nxeyes_°©e
 *
°©e
;

85 
GR_REGION_ID
 
rid1
, 
rid2
;

86 
GR_SCREEN_INFO
 
si
;

87 
GR_WM_PROPERTIES
 
¥›s
;

89 if(!(
°©e
 = 
	`mÆloc
((
nxeyes_°©e
)))Ë 
NULL
;

90 
°©e
->
ﬁdx
 = sèã->
ﬁdy
 = sèã->
x
 = sèã->
y
 = 0;

91 
°©e
->
buâ⁄_down
 = sèã->
eyes_˛o£d
 = sèã->
quô
 = 0;

92 
°©e
->
ﬁx
 = sèã->
‹x
 = 
EYEMASK_WIDTH
 / 2;

93 
°©e
->
ﬁy
 = sèã->
‹y
 = 
EYEMASK_HEIGHT
 / 2;

94 
	`GrGëS¸ìnInfo
(&
si
);

95 
°©e
->
mou£x
 = 
si
.
xpos
;

96 
°©e
->
mou£y
 = 
si
.
ypos
;

97 
°©e
->
mou£_moved
 = 1;

98 
°©e
->
gc
 = 
	`GrNewGC
();

99 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

100 
	`GrSëGCBackground
(
°©e
->
gc
, 
GR_COLOR_BLACK
);

102 
°©e
->
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, (
EYEFG_HEIGHT
 * 2) +

103 
EYE_SPACING
, 
EYEFG_HEIGHT
, 0, 
GR_COLOR_WHITE
, 0);

105 
rid1
 = 
	`GrNewBôm≠Regi⁄
(
eyemask_bôs
, 
EYEMASK_WIDTH
, 
EYEMASK_HEIGHT
);

106 
rid2
 = 
	`GrNewBôm≠Regi⁄
(
eyemask_bôs
, 
EYEMASK_WIDTH
, 
EYEMASK_HEIGHT
);

107 
	`GrOff£tRegi⁄
(
rid2
, 
EYEMASK_WIDTH
 + 
EYE_SPACING
, 0);

108 
	`GrUni⁄Regi⁄
(
rid1
,Ñid1, 
rid2
);

109 
	`GrSëWödowRegi⁄
(
°©e
->
wid
, 
rid1
, 
GR_WINDOW_BOUNDING_MASK
);

110 
	`GrDe°royRegi⁄
(
rid1
);

111 
	`GrDe°royRegi⁄
(
rid2
);

113 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

114 
¥›s
.¥›†
GR_WM_PROPS_NODECORATE
;

115 
	`GrSëWMPr›îtõs
(
°©e
->
wid
, &
¥›s
);

117 
	`GrSñe˘Evíts
(
°©e
->
wid
, 
GR_EVENT_MASK_CLOSE_REQ
 |

118 
GR_EVENT_MASK_MOUSE_POSITION
 |

119 
GR_EVENT_MASK_BUTTON_UP
 |

120 
GR_EVENT_MASK_BUTTON_DOWN
 |

121 
GR_EVENT_MASK_EXPOSURE
 |

122 
GR_EVENT_MASK_TIMER
);

124 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_MOUSE_POSITION
);

126 
	`GrM≠Wödow
(
°©e
->
wid
);

128 
	`§™d
(
	`time
(0));

129 
	`°¨t_blök_timî
(
°©e
);

131  
°©e
;

132 
	}
}

134 
	$buâ⁄_evít
(
GR_EVENT_BUTTON
 *
ev
, 
nxeyes_°©e
 *
°©e
)

136 if(
ev
->
wid
 !
°©e
->wid) ;

137 if(
ev
->
ty≥
 =
GR_EVENT_TYPE_BUTTON_DOWN
) {

138 if(
ev
->
buâ⁄s
 & 
GR_BUTTON_L
) {

139 
°©e
->
buâ⁄_down
 = 1;

140 
°©e
->
x
 = 
ev
->x;

141 
°©e
->
y
 = 
ev
->y;

142 
	`GrRai£Wödow
(
°©e
->
wid
);

144 if(
ev
->
buâ⁄s
 & 
GR_BUTTON_R
Ë
°©e
->
quô
 = 1;

145 } 
°©e
->
buâ⁄_down
 = 0;

146 
	}
}

148 
	$posôi⁄_evít
(
GR_EVENT_MOUSE
 *
ev
, 
nxeyes_°©e
 *
°©e
)

150 
GR_COORD
 
√wx
, 
√wy
;

152 
°©e
->
mou£_moved
 = 1;

153 
°©e
->
mou£x
 = 
ev
->
roŸx
;

154 
°©e
->
mou£y
 = 
ev
->
roŸy
;

156 if(
ev
->
wid
 =
GR_ROOT_WINDOW_ID
) ;

158 if(!
°©e
->
buâ⁄_down
) ;

160 
√wx
 = 
ev
->
roŸx
 - 
°©e
->
x
;

161 
√wy
 = 
ev
->
roŸy
 - 
°©e
->
y
;

163 if(
√wx
 !
°©e
->
ﬁdx
 || 
√wy
 !°©e->
ﬁdy
) {

164 
	`GrMoveWödow
(
ev
->
wid
, 
√wx
, 
√wy
);

165 
°©e
->
ﬁdx
 = 
√wx
;

166 
°©e
->
ﬁdy
 = 
√wy
;

168 
	}
}

170 
	$°¨t_blök_timî
(
nxeyes_°©e
 *
°©e
)

172 
time
;

174 if(
°©e
->
eyes_˛o£d
Ë
time
 = 
BLINK_CLOSED_TIME
;

175 
time
 = (
	`ønd
(Ë% (
BLINK_MAX_OPEN_TIME
 - 
BLINK_MIN_OPEN_TIME
)) +

176 
BLINK_MIN_OPEN_TIME
;

178 
°©e
->
tid
 = 
	`GrCª©eTimî
(°©e->
wid
, 
time
);

179 
	}
}

181 
	$timî_evít
(
GR_EVENT_TIMER
 *
ev
, 
nxeyes_°©e
 *
°©e
)

183 if(
ev
->
tid
 !
°©e
->tid) ;

186 
	`GrDe°royTimî
(
°©e
->
tid
);

187 
°©e
->
tid
 = 0;

189 if(
°©e
->
eyes_˛o£d
) {

190 
°©e
->
eyes_˛o£d
 = 0;

191 
	`°¨t_blök_timî
(
°©e
);

193 
°©e
->
eyes_˛o£d
 = 1;

194 
	`°¨t_blök_timî
(
°©e
);

197 
	`døw_eyes
(
°©e
, 1);

198 
	}
}

200 
	$ˇlcuœã_pupû_posôi⁄
(
GR_COORD
 
wödow_x
, GR_COORD 
wödow_y
,

201 
GR_COORD
 
eye˚¡ª_x
, GR_COORD 
eye˚¡ª_y
,

202 
GR_COORD
 
mou£x
, GR_COORD 
mou£y
,

203 
GR_COORD
 *
ªtx
, GR_COORD *
ªty
)

205 
a
;

206 
ªvx
, 
ªvy
;

207 
GR_COORD
 
rx
, 
ry
, 
dx
, 
dy
, 
x
, 
y
;

209 
rx
 = 
eye˚¡ª_x
 + 
wödow_x
;

210 
dx
 = 
mou£x
 - 
rx
;

211 if(
dx
 < 0) {

212 
dx
 = -dx;

213 
ªvx
 = 1;

214 } 
ªvx
 = 0;

216 
ry
 = 
eye˚¡ª_y
 + 
wödow_y
;

217 
dy
 = 
mou£y
 - 
ry
;

218 if(
dy
 < 0) {

219 
dy
 = -dy;

220 
ªvy
 = 1;

221 } 
ªvy
 = 0;

223 if(
	`hypŸ
(
dx
, 
dy
Ë<
MAX_EYE_MOVEMENT
) {

224 
x
 = 
dx
;

225 
y
 = 
dy
;

227 
a
 = 
	`©™
(()
dy
 / ()
dx
);

228 
x
 = (
GR_COORD
)(
	`cos
(
a
Ë* ()
MAX_EYE_MOVEMENT
);

229 
y
 = (
GR_COORD
)(
	`sö
(
a
Ë* ()
MAX_EYE_MOVEMENT
);

232 if(
ªvx
Ë
x
 = -x;

233 if(
ªvy
Ë
y
 = -y;

235 *
ªtx
 = 
x
 + 
eye˚¡ª_x
 - (
PUPIL_WIDTH
 / 2);

236 *
ªty
 = 
y
 + 
eye˚¡ª_y
 - (
PUPIL_WIDTH
 / 2);

237 
	}
}

239 
	$døw_eyes
(
nxeyes_°©e
 *
°©e
, 
fuŒ_ªdøw
)

241 
GR_COORD
 
x
, 
y
;

242 
GR_BITMAP
 *
bôs
;

244 if(
fuŒ_ªdøw
) {

245 if(
°©e
->
eyes_˛o£d
Ë
bôs
 = 
eye˛o£_bôs
;

246 
bôs
 = 
eyefg_bôs
;

248 
	`GrBôm≠
(
°©e
->
wid
, sèã->
gc
, 0, 0, 
EYEFG_WIDTH
,

249 
EYEFG_HEIGHT
, 
bôs
);

250 
	`GrBôm≠
(
°©e
->
wid
, sèã->
gc
, 
EYEFG_WIDTH
 + 
EYE_SPACING
, 0,

251 
EYEFG_WIDTH
, 
EYEFG_HEIGHT
, 
bôs
);

254 if(
°©e
->
mou£_moved
) {

255 
x
 = 
EYEFG_WIDTH
 / 2;

256 
y
 = 
EYEFG_HEIGHT
 / 2;

257 
	`ˇlcuœã_pupû_posôi⁄
(
°©e
->
ﬁdx
, sèã->
ﬁdy
,

258 (
EYEFG_WIDTH
 / 2),

259 (
EYEFG_HEIGHT
 / 2), 
°©e
->
mou£x
,

260 
°©e
->
mou£y
, &°©e->
lx
, &°©e->
ly
);

261 
	`ˇlcuœã_pupû_posôi⁄
(
°©e
->
ﬁdx
, sèã->
ﬁdy
,

262 (
EYEFG_WIDTH
 / 2) + EYEFG_WIDTH

263 + 
EYE_SPACING
, (
EYEFG_WIDTH
 / 2),

264 
°©e
->
mou£x
, sèã->
mou£y
, &°©e->
rx
, &°©e->
ry
);

267 if(
°©e
->
eyes_˛o£d
) ;

269 
	`GrCÀ¨Aªa
(
°©e
->
wid
, sèã->
ﬁx
, sèã->
ﬁy
, 
PUPIL_WIDTH
,

270 
PUPIL_HEIGHT
, 0);

271 
	`GrBôm≠
(
°©e
->
wid
, sèã->
gc
, sèã->
lx
, sèã->
ly
, 
PUPIL_WIDTH
,

272 
PUPIL_HEIGHT
, 
pupû_bôs
);

273 
	`GrCÀ¨Aªa
(
°©e
->
wid
, sèã->
‹x
, sèã->
‹y
, 
PUPIL_WIDTH
,

274 
PUPIL_HEIGHT
, 0);

275 
	`GrBôm≠
(
°©e
->
wid
, sèã->
gc
, sèã->
rx
, sèã->
ry
, 
PUPIL_WIDTH
,

276 
PUPIL_HEIGHT
, 
pupû_bôs
);

278 
°©e
->
ﬁx
 = sèã->
lx
;

279 
°©e
->
ﬁy
 = sèã->
ly
;

280 
°©e
->
‹x
 = sèã->
rx
;

281 
°©e
->
‹y
 = sèã->
ry
;

282 
	}
}

284 
	$maö
()

286 
GR_EVENT
 
evít
;

287 
nxeyes_°©e
 *
°©e
;

289 if(
	`GrO≥n
() < 0) {

290 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

294 if(!(
°©e
 = 
	`öô
())) {

295 
	`Ârötf
(
°dîr
, "Couldn'tállocate state structure\n");

299 !
°©e
->
quô
) {

300 
	`GrGëNextEvít
(&
evít
);

301 
evít
.
ty≥
) {

302 
GR_EVENT_TYPE_CLOSE_REQ
:

303 
°©e
->
quô
 = 1;

305 
GR_EVENT_TYPE_MOUSE_POSITION
:

306 
	`posôi⁄_evít
(&
evít
.
mou£
, 
°©e
);

308 
GR_EVENT_TYPE_BUTTON_UP
:

309 
GR_EVENT_TYPE_BUTTON_DOWN
:

310 
	`buâ⁄_evít
(&
evít
.
buâ⁄
, 
°©e
);

312 
GR_EVENT_TYPE_EXPOSURE
:

313 
	`døw_eyes
(
°©e
, 1);

315 
GR_EVENT_TYPE_TIMER
:

316 
	`timî_evít
(&
evít
.
timî
, 
°©e
);

321 if(
°©e
->
mou£_moved
) {

322 
	`døw_eyes
(
°©e
, 0);

323 
°©e
->
mou£_moved
 = 0;

327 
	`GrClo£
();

328 
	`‰ì
(
°©e
);

331 
	}
}

	@demos/nanox/nxeyes.h

9 
	#EYEFG_WIDTH
 39

	)

10 
	#EYEFG_HEIGHT
 39

	)

12 
GR_BITMAP
 
	geyefg_bôs
[] = {

37 
	#EYEMASK_WIDTH
 39

	)

38 
	#EYEMASK_HEIGHT
 39

	)

40 
GR_BITMAP
 
	geyemask_bôs
[] = {

65 
	#PUPIL_WIDTH
 9

	)

66 
	#PUPIL_HEIGHT
 9

	)

68 
GR_BITMAP
 
	gpupû_bôs
[] = {

80 
	#EYECLOSE_WIDTH
 39

	)

81 
	#EYECLOSE_HEIGHT
 39

	)

83 
GR_BITMAP
 
	geye˛o£_bôs
[] = {

	@demos/nanox/nxlsclients.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	#MWINCLUDECOLORS


	)

10 
	~"«no-X.h
"

11 
	~"wödef.h
"

14 
	#LIMIT
 10000

	)

16 
	s_cﬁour
 {

17 
	mcﬁour
;

18 * 
	m«me
;

20 
_cﬁour
 
	tCOLOURS
;

22 
COLOURS
 
	gcﬁour_èbÀ
[] = {

23 { 
BLACK
, "Black" },

24 { 
BLUE
, "Blue" },

25 { 
GREEN
, "Green"},

26 { 
CYAN
, "Cyan" },

27 { 
RED
, "Red" },

28 { 
MAGENTA
, "Magenta" },

29 { 
BROWN
, "Brown" },

30 { 
LTGRAY
, "LightGray" },

31 { 
GRAY
, "Gray" },

32 { 
DKGRAY
, "DarkGray" },

33 { 
LTBLUE
, "LightBlue" },

34 { 
LTGREEN
, "LightGreen" },

35 { 
LTCYAN
, "LightCyan" },

36 { 
LTRED
, "LightRed" },

37 { 
LTMAGENTA
, "LightMagenta" },

38 { 
YELLOW
, "Yellow" },

39 { 
WHITE
, "White" }

41 
	#NR_COLOURS
 ((
cﬁour_èbÀ
Ë/ (cﬁour_èbÀ[0]))

	)

44 
	$lookupCﬁour
(
c
)

46 
i
;

48 
i
 = 0; i < 
NR_COLOURS
; i++)

49 i‡(
c
 =
cﬁour_èbÀ
[
i
].
cﬁour
)

50  
cﬁour_èbÀ
[
i
].
«me
;

53 
	}
}

55 
	s_xœt
 {

56 
	mevít_ty≥
;

57 * 
	mevít_desc
;

59 
_xœt
 
	tXLAT
;

61 
XLAT
 
	gevít_èbÀ
[] = {

62 { 
GR_EVENT_TYPE_ERROR
, "GR_EVENT_MASK_ERROR" },

64 { 
GR_EVENT_TYPE_EXPOSURE
, "GR_EVENT_MASK_EXPOSURE" },

65 { 
GR_EVENT_TYPE_BUTTON_DOWN
, "GR_EVENT_MASK_BUTTON_DOWN" },

66 { 
GR_EVENT_TYPE_BUTTON_UP
, "GR_EVENT_MASK_BUTTON_UP" },

67 { 
GR_EVENT_TYPE_MOUSE_ENTER
, "GR_EVENT_MASK_MOUSE_ENTER" },

68 { 
GR_EVENT_TYPE_MOUSE_EXIT
, "GR_EVENT_MASK_MOUSE_EXIT" },

69 { 
GR_EVENT_TYPE_MOUSE_MOTION
, "GR_EVENT_MASK_MOUSE_MOTION" },

70 { 
GR_EVENT_TYPE_MOUSE_POSITION
, "GR_EVENT_MASK_MOUSE_POSITION" },

71 { 
GR_EVENT_TYPE_KEY_DOWN
, "GR_EVENT_MASK_KEY_DOWN" },

72 { 
GR_EVENT_TYPE_KEY_UP
, "GR_EVENT_MASK_KEY_UP" },

73 { 
GR_EVENT_TYPE_FOCUS_IN
, "GR_EVENT_MASK_FOCUS_IN" },

74 { 
GR_EVENT_TYPE_FOCUS_OUT
, "GR_EVENT_MASK_FOCUS_OUT" },

75 { 
GR_EVENT_TYPE_FDINPUT
, "GR_EVENT_MASK_FDINPUT" },

76 { 
GR_EVENT_TYPE_UPDATE
, "GR_EVENT_MASK_UPDATE" },

77 { 
GR_EVENT_TYPE_CHLD_UPDATE
, "GR_EVENT_MASK_CHLD_UPDATE" },

78 { 
GR_EVENT_TYPE_CLOSE_REQ
, "GR_EVENT_MASK_CLOSE_REQ" }

80 
	#NR_MASKS
 ((
evít_èbÀ
Ë/ ”vít_èbÀ[0]))

	)

82 
	s_wm_¥›s
 {

83 
GR_WM_PROPS
 
	m¥›
;

84 * 
	m¥›_symbﬁ
;

85 * 
	m¥›_des¸
;

87 
_wm_¥›s
 
	tWM_PROPS
;

89 
WM_PROPS
 
	g¥›s_èbÀ
[] = {

91 { 
GR_WM_PROPS_NOBACKGROUND
, "GR_WM_PROPS_NOBACKGROUND", "Don't draw window background" },

92 { 
GR_WM_PROPS_NOFOCUS
, "GR_WM_PROPS_NOFOCUS", "Don't set focusÅoÅhis window" },

93 { 
GR_WM_PROPS_NOMOVE
, "GR_WM_PROPS_NOMOVE", "Don'tÜet user move window" },

94 { 
GR_WM_PROPS_NORAISE
, "GR_WM_PROPS_NORAISE", "Don'tÜet userÑaise window" },

95 { 
GR_WM_PROPS_NODECORATE
, "GR_WM_PROPS_NODECORATE", "Don'tÑedecorate window" },

96 { 
GR_WM_PROPS_NOAUTOMOVE
, "GR_WM_PROPS_NOAUTOMOVE", "Don't move window on decorating" },

99 { 
GR_WM_PROPS_APPWINDOW
, "GR_WM_PROPS_APPWINDOW", "LeaveáppearanceÅo WM" },

100 { 
GR_WM_PROPS_APPMASK
, "GR_WM_PROPS_APPMASK", "Appearance mask" },

101 { 
GR_WM_PROPS_BORDER
, "GR_WM_PROPS_BORDER", "SingleÜine border" },

102 { 
GR_WM_PROPS_APPFRAME
, "GR_WM_PROPS_APPFRAME", "3Dápp frame" },

103 { 
GR_WM_PROPS_CAPTION
, "GR_WM_PROPS_CAPTION", "Title bar" },

104 { 
GR_WM_PROPS_CLOSEBOX
, "GR_WM_PROPS_CLOSEBOX", "Close box" },

106 { 
GR_WM_PROPS_MAXIMIZED
, "GR_WM_PROPS_MAXIMIZED", "Application is maximized" }

109 
	#NR_PROPS
 ((
¥›s_èbÀ
Ë/ ’r›s_èbÀ[0]))

	)

112 
	$maö
(
¨gc
, * 
¨gv
[])

114 
GR_WINDOW_ID
 
w
;

115 
GR_WINDOW_INFO
 
öfo
;

117 i‡(
	`GrO≥n
() < 0) {

118 
	`Ârötf
(
°dîr
, "nxlsclients: cannot open graphics\n");

119 
	`exô
(1);

122 
w
 = 0; w < 
LIMIT
; w++) {

123 
öfo
.
wid
 = -1;

125 
	`GrGëWödowInfo
(
w
, &
öfo
);

127 i‡(
öfo
.
wid
 == -1) {

128 
	`¥ötf
("Quîy wid = %d, GrGëWödowInfo(Ëi†nŸ w‹kög!\n", 
w
);

131 i‡(
öfo
.
wid
 == 0) {

133 
	`¥ötf
("Quîy wid = %d --> d€†nŸÉxi°\n", 
w
);

137 
	`¥ötf
("Wödow id = %d\n", 
öfo
.
wid
);

138 
	`¥ötf
("\tAbsﬁuã uµî-À· X: %d\n", 
öfo
.
x
);

139 
	`¥ötf
("\tAbsﬁuã uµî-À· Y: %d\n", 
öfo
.
y
);

140 
	`¥ötf
("\tWidth = %d\n", 
öfo
.
width
);

141 
	`¥ötf
("\tHeighà%d\n", 
öfo
.
height
);

142 
	`¥ötf
("\tBorder: size = %d, colour = %s (#%06lX)\n", \

143 
öfo
.
b‹dîsize
,

144 
	`lookupCﬁour
(
öfo
.
b‹dîcﬁ‹
), info.bordercolor);

145 
	`¥ötf
("\tBackground colour = %s (#%06lX)\n", \

146 
	`lookupCﬁour
(
öfo
.
background
), info.background);

148 
	`¥ötf
("\tP¨íà%d\n", 
öfo
.
∑ª¡
);

149 
	`¥ötf
("\tFú° chûd = %d\n", 
öfo
.
chûd
);

150 
	`¥ötf
("\tNexàsiblög? = %d\n", 
öfo
.
siblög
);

152 
	`¥ötf
("\t%söput-⁄ly, ", (
öfo
.
öput⁄ly
 =
TRUE
)?"": "not ");

153 
	`¥ötf
("%sm≠≥d", (
öfo
.
m≠≥d
 =
TRUE
)?"": "not ");

154 i‡(
öfo
.
m≠≥d
 !
TRUE
)

155 
	`¥ötf
(",Ñólized = %d", 
öfo
.
ªÆized
);

156 
	`¥ötf
("\n");

158 
	`¥ötf
("\tEvíàmask (0x%08lX):\n", 
öfo
.
evítmask
);

160 
i
, 
n
 = 0;

161 
GR_EVENT_MASK
 
tmp
 = 
öfo
.
evítmask
;

163 
i
 = 0; i < 
NR_MASKS
; i++) {

164 
GR_EVENT_MASK
 
mask
 = 
	`GR_EVENTMASK
(
evít_èbÀ
[
i
].
evít_ty≥
);

166 i‡((
tmp
 & 
mask
) == mask) {

167 
	`¥ötf
("\t\t%s\n", 
evít_èbÀ
[
i
].
evít_desc
);

168 
n
++;

171 i‡(!
n
)

172 
	`¥ötf
("\t\tGR_EVENT_MASK_NONE (?!?!?)\n");

176 
	`¥ötf
("\tWM Properties:\n");

178 
GR_WM_PROPERTIES
 
wm_¥›s
;

180 
	`GrGëWMPr›îtõs
(
w
, &
wm_¥›s
);

182 
	`¥ötf
("\t\tTitle: ");

183 i‡((
wm_¥›s
.
Êags
 & 
GR_WM_FLAGS_TITLE
 ) == GR_WM_FLAGS_TITLE)

184 
	`¥ötf
("'%s'\n", (*)
wm_¥›s
.
tôÀ
 ?

185 (*)
wm_¥›s
.
tôÀ
 : "(null)");

187 
	`¥ötf
("<untitled>\n");

188 i‡(
wm_¥›s
.
tôÀ
)

189 
	`‰ì
(
wm_¥›s
.
tôÀ
);

191 
	`¥ötf
("\t\tBackground colour: ");

192 i‡((
wm_¥›s
.
Êags
 & 
GR_WM_FLAGS_BACKGROUND
) == GR_WM_FLAGS_BACKGROUND)

193 
	`¥ötf
("%†(#%06lX)\n", 
	`lookupCﬁour
(
wm_¥›s
.
background
),

194 
wm_¥›s
.
background
);

196 
	`¥ötf
("<unspecified>\n");

198 
	`¥ötf
("\t\tBorder size: ");

199 i‡((
wm_¥›s
.
Êags
 & 
GR_WM_FLAGS_BORDERSIZE
) == GR_WM_FLAGS_BORDERSIZE)

200 
	`¥ötf
("%d\n", 
wm_¥›s
.
b‹dîsize
);

202 
	`¥ötf
("<unspecified>\n");

204 
	`¥ötf
("\t\tPr›îty bô†(0x%08lX):\n", 
wm_¥›s
.
¥›s
);

206 
i
, 
n
 = 0;

208 
i
 = 0; i < 
NR_PROPS
; i++) {

209 
GR_WM_PROPS
 
¥›
 = 
¥›s_èbÀ
[
i
].prop;

210 i‡((
wm_¥›s
.
¥›s
 & 
¥›
) ==Örop) {

211 
	`¥ötf
("\t\t\t%s (%s)\n", \

212 
¥›s_èbÀ
[
i
].
¥›_symbﬁ
, \

213 
¥›s_èbÀ
[
i
].
¥›_des¸
);

214 
n
++;

218 i‡(!
n
)

219 
	`¥ötf
("\t\tNONE (?!?!?)\n");

225 
	`GrClo£
();

228 
	}
}

	@demos/nanox/nxmag.c

45 
	~<°dio.h
>

46 
	~<°dlib.h
>

47 
	~<time.h
>

49 
	~<«no-X.h
>

50 
	~<nxcﬁ‹s.h
>

52 
	#DEFAULT_MAGNIFICATION
 10

	)

53 
	#DEFAULT_WIDTH
 15

	)

54 
	#DEFAULT_HEIGHT
 15

	)

55 
	#DEFAULT_UPDATE_PERIOD
 40

	)

56 
	#DEFAULT_FORCEUPDATE
 15

	)

59 
	mx
;

60 
	my
;

61 
	mlx
;

62 
	mly
;

63 
	mfu
;

64 
	mwidth
;

65 
	mheight
;

66 
	mpwidth
;

67 
	mpheight
;

68 
	mf‹˚upd©e
;

69 
	mmagnifiˇti⁄
;

70 
GR_GC_ID
 
	mgc
;

71 
GR_WINDOW_ID
 
	mwid
;

72 
GR_PIXELVAL
 *
	möbuf
;

73 
GR_PIXELVAL
 *
	moutbuf
;

74 } 
	tnm°©e
;

76 
	$ªad_öput
(
nm°©e
 *
°©e
)

78 
	`GrRódAªa
(
GR_ROOT_WINDOW_ID
, 
°©e
->
x
, sèã->
y
, sèã->
width
,

79 
°©e
->
height
, sèã->
öbuf
);

80 
	}
}

82 
	$magnify
(
nm°©e
 *
°©e
)

84 
x
, 
y
, 
i
;

85 
GR_PIXELVAL
 
pix
, *
p
, *
µ
 = 
°©e
->
outbuf
;

87 
y
 = 0; y < 
°©e
->
pheight
; y++) {

88 
p
 = 
°©e
->
öbuf
 + ((
y
 / sèã->
magnifiˇti⁄
Ë* sèã->
width
);

89 
x
 = 0; x < 
°©e
->
width
; x++) {

90 
pix
 = *
p
++;

91 
i
 = 0; i < 
°©e
->
magnifiˇti⁄
; i++)

92 *
µ
++ = 
pix
;

95 
	}
}

97 
	$døw_ouçut
(
nm°©e
 *
°©e
)

99 
	`GrAªa
(
°©e
->
wid
, sèã->
gc
, 0, 0, sèã->
pwidth
, sèã->
pheight
,

100 
°©e
->
outbuf
, 
MWPF_PIXELVAL
);

101 
	}
}

103 
	$do_upd©e
(
nm°©e
 *
°©e
)

105 if(
°©e
->
x
 =°©e->
lx
 && sèã->
y
 =°©e->
ly
 &&

106 
°©e
->
f‹˚upd©e
 && --°©e->
fu
)

109 
	`ªad_öput
(
°©e
);

110 
	`magnify
(
°©e
);

111 
	`døw_ouçut
(
°©e
);

113 
°©e
->
lx
 = sèã->
x
;

114 
°©e
->
ly
 = sèã->
y
;

115 
°©e
->
fu
 = sèã->
f‹˚upd©e
;

116 
	}
}

118 
	$mou£_moved
(
nm°©e
 *
°©e
, 
GR_EVENT_MOUSE
 *
ev
)

120 
°©e
->
x
 = 
ev
->
roŸx
 - sèã->
width
 / 2;

121 
°©e
->
y
 = 
ev
->
roŸy
 - sèã->
height
 / 2;

122 
	}
}

124 
nm°©e
 *
	$öô
(
¨gc
, **
¨gv
)

126 
i
;

127 *
p
;

128 
GR_COORD
 
x
 = 0;

129 
nm°©e
 *
°©e
;

130 
GR_SCREEN_INFO
 
si
;

131 
GR_WM_PROPERTIES
 
¥›s
;

132 
upd©ïîiod
 = 
DEFAULT_UPDATE_PERIOD
;

134 if(!(
°©e
 = 
	`mÆloc
((
nm°©e
)))Ë 
NULL
;

136 
°©e
->
width
 = 
DEFAULT_WIDTH
;

137 
°©e
->
height
 = 
DEFAULT_HEIGHT
;

138 
°©e
->
f‹˚upd©e
 = 
DEFAULT_FORCEUPDATE
;

139 
°©e
->
magnifiˇti⁄
 = 
DEFAULT_MAGNIFICATION
;

141 
¨gv
++;

142 
¨gc
--;

143 
¨gc
 > 0) {

144 if(
¨gv
[0][0] !'-'Ë
bad¨gs
;

145 if(
¨gc
 < 2Ë
bad¨gs
;

146 
i
 = 
	`°πﬁ
(
¨gv
[1], &
p
, 10);

147 if(*
p
Ë
bad¨gs
;

148 
¨gv
[0][1]) {

150 
°©e
->
width
 = 
i
;

153 
°©e
->
height
 = 
i
;

156 
°©e
->
magnifiˇti⁄
 = 
i
;

159 
upd©ïîiod
 = 
i
;

162 
°©e
->
f‹˚upd©e
 = 
i
;

165 
bad¨gs
;

167 
¨gc
 -= 2;

168 
¨gv
 += 2;

171 if(
	`GrO≥n
() < 0) {

172 
	`‰ì
(
°©e
);

173  
NULL
;

176 
°©e
->
pwidth
 = sèã->
width
 * sèã->
magnifiˇti⁄
;

177 
°©e
->
pheight
 = sèã->
height
 * sèã->
magnifiˇti⁄
;

179 if(!(
°©e
->
öbuf
 = 
	`mÆloc
((
GR_PIXELVAL
Ë* sèã->
width
 *

180 
°©e
->
height
))) {

181 
	`‰ì
(
°©e
);

182  
NULL
;

185 if(!(
°©e
->
outbuf
 = 
	`ˇŒoc
((
GR_PIXELVAL
Ë* sèã->
pwidth
 *

186 
°©e
->
pheight
, 1))) {

187 
	`‰ì
(
°©e
->
öbuf
);

188 
	`‰ì
(
°©e
);

189  
NULL
;

192 
	`GrGëS¸ìnInfo
(&
si
);

193 
°©e
->
x
 = 
si
.
xpos
 - sèã->
width
 / 2;

194 
°©e
->
y
 = 
si
.
ypos
 - sèã->
height
 / 2;

195 
°©e
->
lx
 = -1;

196 
°©e
->
ly
 = -1;

198 
°©e
->
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 
x
, 0, sèã->
pwidth
,

199 
°©e
->
pheight
, 0, 
GR_COLOR_WHITE
, 0);

201 
	`GrSñe˘Evíts
(
°©e
->
wid
, 
GR_EVENT_TYPE_EXPOSURE
 |

202 
GR_EVENT_MASK_TIMER
 |

203 
GR_EVENT_MASK_CLOSE_REQ
);

205 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_MOUSE_POSITION
);

207 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
;

208 
¥›s
.
tôÀ
 = "nxmag";

209 
	`GrSëWMPr›îtõs
(
°©e
->
wid
, &
¥›s
);

211 
	`GrM≠Wödow
(
°©e
->
wid
);

213 
°©e
->
gc
 = 
	`GrNewGC
();

215 
	`GrCª©eTimî
(
°©e
->
wid
, 
upd©ïîiod
);

217 
	`do_upd©e
(
°©e
);

219  
°©e
;

221 
bad¨gs
:

222 
	`Ârötf
(
°dîr
, "usage: -w <width> -h <height> -m <magnification> "

224 
	`‰ì
(
°©e
);

225  
NULL
;

226 
	}
}

228 
	$maö
(
¨gc
, *
¨gv
[])

230 
GR_EVENT
 
ev
;

231 
nm°©e
 *
°©e
;

233 if(!(
°©e
 = 
	`öô
(
¨gc
, 
¨gv
)))  1;

236 
	`GrGëNextEvít
(&
ev
);

237 
ev
.
ty≥
) {

238 
GR_EVENT_TYPE_EXPOSURE
:

239 
	`døw_ouçut
(
°©e
);

241 
GR_EVENT_TYPE_TIMER
:

242 
	`do_upd©e
(
°©e
);

244 
GR_EVENT_TYPE_MOUSE_POSITION
:

245 
	`mou£_moved
(
°©e
, &
ev
.
mou£
);

247 
GR_EVENT_TYPE_CLOSE_REQ
:

248 
	`‰ì
(
°©e
->
öbuf
);

249 
	`‰ì
(
°©e
->
outbuf
);

250 
	`‰ì
(
°©e
);

251 
	`GrClo£
();

254 
	`Ârötf
(
°dîr
, "Got unknownÉventÅype %d\n",

255 
ev
.
ty≥
);

261 
	}
}

	@demos/nanox/nxterm.c

33 
	~<°dio.h
>

34 
	~<sig«l.h
>

35 
	~<sys/time.h
>

36 
	~<utmp.h
>

37 
	~<uni°d.h
>

38 
	~<î∫o.h
>

39 
	~<°dlib.h
>

40 
	~<pwd.h
>

41 
	~<°rög.h
>

42 
	~<sys/io˘l.h
>

43 
	~<ãrmios.h
>

44 
	~<sys/ty≥s.h
>

45 
	~<sys/°©.h
>

46 
	~<f˙é.h
>

47 
	#MWINCLUDECOLORS


	)

48 
	~"«no-X.h
"

49 
	~"nxãrm.h
"

51 
	#TITLE
 "nxãrm"

	)

53 
	#SMALLBUFFER
 80

	)

54 
	#LARGEBUFFER
 1024

	)

59 #ifde‡
löux


60 
	#NSIG
 
_NSIG


	)

63 #ifde‡
__FªeBSD__


64 
	~<libutû.h
>

72 
GR_WINDOW_ID
 
	gw1
;

73 
GR_GC_ID
 
	ggc1
;

74 
GR_FONT_ID
 
	gªgF⁄t
;

77 
GR_SCREEN_INFO
 
	gsi
;

78 
GR_FONT_INFO
 
	gfi
;

79 
GR_WINDOW_INFO
 
	gwi
;

80 
GR_GC_INFO
 
	ggi
;

81 
GR_BOOL
 
	ghavefocus
 = 
GR_FALSE
;

83 
pid_t
 
	gpid
;

84 
	gwöw
, 
	gwöh
, 
	gc⁄sﬁe
;

85 
	gpùeh
;

86 
	gcblök
 = 0, 
	gvisuÆbñl
 = 0, 
	gdebug
 = 0;

87 #ifde‡
__FªeBSD__


88 
	g±y
[
SMALLBUFFER
];

89 
wösize
 
	gwösz
;

92 
	#f⁄h
 
fi
.
height


	)

93 
	#f⁄w
 
fi
.
maxwidth


	)

95 
ãrm_öô
();

96 
maximize
();

97 
sigpùe
(
sig
);

98 
sigchld
(
sig
);

99 
sigquô
(
sig
);

100 
sÊush
();

101 
löeRedøw
();

102 
ßdd
 (
c
);

103 
show_curs‹
 ();

104 
døw_curs‹
 ();

105 
hide_curs‹
 ();

106 
vs¸ﬁl
(
löes
);

107 
esc5
(
c
);

108 
esc4
(
c
);

109 
esc3
(
c
);

110 
esc2
(
c
);

111 
esc1
(
c
);

112 
esc0
(
c
);

113 
¥ötc
(
c
);

114 
öô
();

115 
ãrm
();

116 
ußge
(*
s
);

117 *
mysig«l
(
signum
, *
h™dÀr
);

118 
sigchûd
(
signo
);

128 
	gisMaximized
=0;

130 
	$maximize
()

132 
x0
, 
y0
, 
w
, 
h
, 
w_max
,
h_max
;

134 i‡(!
isMaximized
)

137 
w_max
=
si
.
cﬁs
-
wi
.
b‹dîsize
;

138 
h_max
=
si
.
rows
-
wi
.
b‹dîsize
;

139 
	`GrMoveWödow
(
w1
,0,0);

140 
	`GrResizeWödow
(
w1
,
w_max
, 
h_max
);

141 
isMaximized
=1;

145 
	`GrResizeWödow
(
w1
, 
w
, 
h
);

146 
	`GrMoveWödow
(
w1
, 
x0
, 
y0
);

147 
isMaximized
=0;

149 
	}
}

159 
	$sigpùe
(
sig
)

163 
	`kûl
(-
pid
, 
SIGHUP
);

164 
	`_exô
(
sig
);

165 
	}
}

168 
	$sigchld
(
sig
)

171 
	`_exô
(
sig
);

172 
	}
}

175 
	$sigquô
(
sig
)

177 
	`sig«l
(
sig
, 
SIG_IGN
);

178 
	`kûl
(-
pid
, 
SIGHUP
);

179 
	}
}

186 
	gbgmode
, 
	gesc°©e
, 
	gcurx
, 
	gcury
, 
	gcur⁄
, 
	gcurvis
;

187 
	gßvx
, 
	gßvy
, 
	gwøp
, 
	g°yÀ
;

188 
	gcﬁ
, 
	grow
, 
	gcﬁmask
 = 0x7f, 
	growmask
 = 0x7f;

194 
	gsbuf˙t
 = 0;

195 
	gsbufx
, 
	gsbufy
;

196 
	glöeBuf„r
[
SMALLBUFFER
+1];

197 *
	gsbuf
=
löeBuf„r
;

199 
	$sÊush
()

201 i‡(
sbuf˙t
)

203 
	`GrText
(
w1
,
gc1
, 
sbufx
*
f⁄w
, 
sbufy
*
f⁄h
, 
sbuf
, 
sbuf˙t
, 
GR_TFTOP
);

204 
sbuf˙t
 = 0;

206 
	}
}

209 
	$löeRedøw
()

211 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

212 
	`GrFûlRe˘
(
w1
, 
gc1
, 
curx
*
f⁄w
, 
cury
*
f⁄h
, (
cﬁ
-curx)*fonw, fonh);

213 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

215 i‡(
sbuf˙t
)

217 
sbuf
[
sbuf˙t
] = 0;

218 
	`GrText
(
w1
,
gc1
, 
sbufx
*
f⁄w
, 
sbufy
*
f⁄h
, 
sbuf
, 
sbuf˙t
, 
GR_TFTOP
);

220 
	}
}

222 
	$ßdd
 (
c
)

224 i‡(
sbuf˙t
 =
SMALLBUFFER
)

226 
	`sÊush
 ();

229 i‡(!
sbuf˙t
)

231 
sbufx
 = 
curx
;

232 
sbufy
 = 
cury
;

235 
sbuf
[
sbuf˙t
++] = 
c
;

236 
	}
}

238 
	$show_curs‹
 ()

240 
	`GrSëGCMode
(
gc1
,
GR_MODE_XOR
);

241 
	`GrSëGCF‹eground
(
gc1
, 
WHITE
);

242 
	`GrFûlRe˘
(
w1
, 
gc1
, 
curx
*
f⁄w
, 
cury
*
f⁄h
+1, fonw, fonh-1);

243 
	`GrSëGCF‹eground
(
gc1
, 
gi
.
f‹eground
);

244 
	`GrSëGCMode
(
gc1
,
GR_MODE_COPY
);

245 
	}
}

248 
	$døw_curs‹
 ()

250 i‡(!
curvis
)

252 
curvis
 = 1;

253 
	`show_curs‹
();

255 
	}
}

256 
	$hide_curs‹
 ()

258 i‡(
curvis
)

260 
curvis
 = 0;

261 
	`show_curs‹
();

263 
	}
}

266 
	$vs¸ﬁl
(
löes
)

268 
	`hide_curs‹
();

269 
	`GrC›yAªa
(
w1
,
gc1
,0, 0, 
wöw
, 
wöh
-(
löes
*
f⁄h
),

270 
w1
, 0, (
löes
*
f⁄h
), 
MWROP_SRCCOPY
);

272 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

273 
	`GrFûlRe˘
(
w1
, 
gc1
, 0, 
wöh
-(
löes
*
f⁄h
),

274 
wöw
, (
löes
*
f⁄h
));

275 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

276 
	}
}

278 
	$esc5
(
c
)

281 
	`GrSëGCBackground
(
gc1
, 
c
);

282 
	`GrGëGCInfo
(
gc1
,&
gi
);

283 
esc°©e
 = 0;

284 
	}
}

286 
	$esc4
(
c
)

288 
	`GrSëGCF‹eground
(
gc1
,
c
);

289 
	`GrGëGCInfo
(
gc1
,&
gi
);

290 
esc°©e
 = 0;

291 
	}
}

293 
	$esc3
(
c
)

295 
curx
 = (
c
 - 32Ë& 
cﬁmask
;

296 i‡(
curx
 >
cﬁ
)

297 
curx
 = 
cﬁ
 - 1;

298 i‡(
curx
 < 0)

299 
curx
 = 0;

300 
esc°©e
 = 0;

301 
	}
}

304 
	$esc2
(
c
)

306 
cury
 = (
c
 - 32Ë& 
rowmask
;

307 i‡(
cury
 >
row
)

308 
cury
 = 
row
 - 1;

309 i‡(
cury
 < 0)

310 
cury
 = 0;

311 
esc°©e
 = 3;

312 
	}
}

315 
	$esc1
(
c
)

317 
Revî£Mode
=0;

318 
esc°©e
 = 0;

320 
c
)

323 
	`hide_curs‹
();

324 i‡((
cury
 -= 1) < 0)

325 
cury
 = 0;

329 
	`hide_curs‹
();

330 i‡((
cury
 +1Ë>
row
)

331 
cury
 = 
row
 - 1;

335 
	`hide_curs‹
();

336 i‡((
curx
 +1Ë>
cﬁ
)

337 
curx
 = 
cﬁ
 - 1;

341 
	`hide_curs‹
();

342 i‡((
curx
 -= 1) < 0)

343 
curx
 = 0;

347 
	`GrCÀ¨Wödow
(
w1
, 0);

348 
curx
 = 0;

349 
cury
 = 0;

353 
curx
 = 0;

354 
cury
 = 0;

358 i‡((
cury
 -= 1) < 0)

360 
cury
 = 0;

361 
	`vs¸ﬁl
(1);

367 i‡(
cury
 < 
row
-1)

369 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

370 
	`GrFûlRe˘
(
w1
,
gc1
, 0,(
cury
+1)*
f⁄h
, 
wöw
, (
row
-1-cury)*fonh);

371 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

373 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

374 
	`GrFûlRe˘
(
w1
, 
gc1
, 
curx
*
f⁄w
, 
cury
*
f⁄h
, (
cﬁ
-curx)*fonw, fonh);

375 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

379 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

380 
	`GrFûlRe˘
(
w1
, 
gc1
, 
curx
*
f⁄w
, 
cury
*
f⁄h
, (
cﬁ
-curx)*fonw, fonh);

381 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

385 i‡(
cury
 < 
row
-1)

387 
	`vs¸ﬁl
(1);

389 
curx
 = 0;

393 i‡(
cury
 < 
row
-1)

395 
	`vs¸ﬁl
(1);

397 
curx
 = 0;

401 
esc°©e
 = 2;

405 
esc°©e
 = 4;

409 
esc°©e
 = 5;

414 i‡(
cury
 > 0)

416 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

417 
	`GrFûlRe˘
(
w1
,
gc1
, 0, 0, 
wöw
, 
cury
*
f⁄h
);

418 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

420 i‡(
curx
 > 0)

422 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

423 
	`GrFûlRe˘
(
w1
,
gc1
, 0, 
cury
*
f⁄h
, 
curx
*
f⁄w
, fonh);

424 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

429 
cur⁄
 = 1;

433 
cur⁄
 = 0;

437 
ßvx
 = 
curx
;

438 
ßvy
 = 
cury
;

442 
curx
 = 
ßvx
;

443 
cury
 = 
ßvy
;

447 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

448 
	`GrRe˘
(
w1
,
gc1
, 0, 
cury
*
f⁄h
, 
wöw
, fonh);

449 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

450 
curx
 = 0;

454 i‡(
curx
 > 0)

456 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

457 
	`GrRe˘
(
w1
,
gc1
,0, 
cury
*
f⁄h
, 
curx
*
f⁄w
, fonh);

458 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

464 if(!
Revî£Mode
)

466 
	`GrSëGCF‹eground
(
gc1
,
gi
.
background
);

467 
	`GrSëGCBackground
(
gc1
,
gi
.
f‹eground
);

468 
Revî£Mode
=1;

475 if(
Revî£Mode
)

477 
	`GrSëGCF‹eground
(
gc1
,
gi
.
f‹eground
);

478 
	`GrSëGCBackground
(
gc1
,
gi
.
background
);

479 
Revî£Mode
=0;

485 
wøp
 = 1;

489 
wøp
 = 0;

531 
	}
}

537 
	$esc0
 (
c
)

539 
c
)

557 i‡(
visuÆbñl
)

568 
	`GrBñl
();

573 
	`löeRedøw
();

574 i‡(--
curx
 < 0)

576 
curx
 = 0;

582 
b‹g
,
i
;

584 
b‹g
=(((
curx
 >> 3) + 1) << 3);

585 if(
b‹g
 >
cﬁ
)

587 
b‹g
=
cﬁ
-1;

589 
b‹g
=b‹g-
curx
;

590 
i
=0; i < 
b‹g
; ++i){
	`ßdd
(' ');}

591 i‡((
curx
 = ((curx >> 3Ë+ 1Ë<< 3Ë>
cﬁ
)

593 
curx
 = 
cﬁ
 - 1;

599 
	`sÊush
();

600 i‡(++
cury
 >
row
)

602 
	`vs¸ﬁl
(1);

603 
cury
 = 
row
-1;

608 
	`sÊush
();

609 
curx
 = 0;

613 
	`sÊush
();

614 
esc°©e
 = 1;

621 
	`ßdd
(
c
);

622 i‡(++
curx
 >
cﬁ
)

624 
	`sÊush
();

625 i‡(!
wøp
)

627 
curx
 = 
cﬁ
-1;

631 
curx
 = 0;

632 i‡(++
cury
 >
row
)

634 
	`vs¸ﬁl
(1);

640 
	}
}

643 
	$¥ötc
(
c
)

645 
esc°©e
)

648 
	`esc0
(
c
);

652 
	`sÊush
();

653 
	`esc1
(
c
);

657 
	`sÊush
();

658 
	`esc2
(
c
);

662 
	`sÊush
();

663 
	`esc3
(
c
);

667 
	`sÊush
();

668 
	`esc4
(
c
);

672 
	`sÊush
();

673 
	`esc5
(
c
);

677 
esc°©e
 = 0;

680 
	}
}

683 
	$öô
()

685 
curx
 = 
ßvx
 = 0;

686 
cury
 = 
ßvy
 = 0;

687 
wøp
 = 1;

688 
cur⁄
 = 1;

689 
curvis
 = 0;

690 
esc°©e
 = 0;

691 
	}
}

699 
	$ãrm
()

701 
ö
, 
l
;

702 
GR_EVENT
 
wevít
;

703 
GR_EVENT_KEYSTROKE
 *
kp
;

704 
buf
[
LARGEBUFFER
];

706 
	`GrRegi°îI≈ut
(
pùeh
);

708 i‡(
havefocus
)

709 
	`døw_curs‹
();

710 
	`GrGëNextEvít
(&
wevít
);

712 
wevít
.
ty≥
) {

713 
GR_EVENT_TYPE_CLOSE_REQ
:

714 
	`GrClo£
();

715 
	`exô
(0);

718 
GR_EVENT_TYPE_KEY_DOWN
:

719 
kp
=(
GR_EVENT_KEYSTROKE
 *)&
wevít
;

721 i‡(
kp
->
ch
 & 
MWKEY_NONASCII_MASK
)

723 *
buf
 = 
kp
->
ch
 & 0xff;

724 
	`wrôe
(
pùeh
, 
buf
,1);

727 
GR_EVENT_TYPE_FOCUS_IN
:

728 
havefocus
 = 
GR_TRUE
;

731 
GR_EVENT_TYPE_FOCUS_OUT
:

732 
havefocus
 = 
GR_FALSE
;

733 
	`hide_curs‹
();

736 
GR_EVENT_TYPE_UPDATE
:

741 i‡(
wevít
.
upd©e
.
uty≥
 =
GR_UPDATE_UNMAPTEMP
)

742 
curvis
 = 0;

745 
GR_EVENT_TYPE_FDINPUT
:

746 
	`hide_curs‹
();

747 (
ö
 = 
	`ªad
(
pùeh
, 
buf
, (buf))) > 0) {

748 
l
=0;Ü<
ö
;Ü++) {

749 
	`¥ötc
(
buf
[
l
]);

750 i‡(
buf
[
l
] == '\n')

751 
	`¥ötc
('\r');

753 
	`sÊush
();

758 
	}
}

761 
	$ußge
(*
s
)

763 i‡(
s
)

764 
	`Ârötf
(
°dîr
, "îr‹: %s\n", 
s
);

765 
	`¥ötf
("usage:Çxterm [-b] [-d] [-f <font family>] [-s <font size>]\n");

766 
	`¥ötf
(" [-g <geometry>] [-v] [-c] [-h] [program {args}]\n");

767 
	`exô
(0);

768 
	}
}

771 *
	$mysig«l
(
signum
, *
h™dÀr
)

773 
siga˘i⁄
 
ß
, 
so
;

775 
ß
.
ß_h™dÀr
 = 
h™dÀr
;

776 
	`sigem±y£t
(&
ß
.
ß_mask
);

777 
ß
.
ß_Êags
 = 
SA_RESTART
;

778 
	`siga˘i⁄
(
signum
, &
ß
, &
so
);

780  
so
.
ß_h™dÀr
;

781 
	}
}

787 
	$maö
(
¨gc
, **
¨gv
)

789 
GR_BITMAP
 
bôm≠1fg
[7];

790 
GR_BITMAP
 
bôm≠1bg
[7];

791 
GR_WM_PROPERTIES
 
¥›s
;

793 
xp
, 
yp
, 
fsize
;

794 *
Ámûy
, *
shñl
 = 
NULL
, *
˝å
, *
geomëry
 = NULL;

795 
∑sswd
 *
pw
;

796 
buf
[80];

797 
uid
;

798 
thesh
[128];

799 #ifde‡
__FªeBSD__


800 *
±r
;

803 #ifde‡
SIGTTOU


805 
	`sig«l
(
SIGTTOU
, 
SIG_IGN
);

809 i‡(!(
pw
 = 
	`gëpwuid
((
uid
 = 
	`gëuid
()))))

811 
	`Ârötf
(
°dîr
, "error: wterm can't determine determine yourÜoginÇame\n");

812 
	`exô
(-1);

816 i‡(
	`GrO≥n
() < 0)

818 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

819 
	`exô
(1);

822 
	`GrGëS¸ìnInfo
(&
si
);

827 
c⁄sﬁe
 = 0;

828 
¨gv
++;

829 *
¨gv
 && **argv=='-')

830 *(*
¨gv
+1))

833 
cblök
 = 1;

834 
¨gv
++;

838 
c⁄sﬁe
 = 1;

839 
¨gv
++;

843 
debug
 = 1;

844 
¨gv
++;

848 i‡(*++
¨gv
) {

849 
Ámûy
 = *
¨gv
++;

851 
	`ußge
("-f optionÑequiresánárgument");

856 i‡(*++
¨gv
) {

857 
fsize
 = 
	`©oi
(*
¨gv
++);

859 
	`ußge
("-s optionÑequiresánárgument");

864 i‡(*++
¨gv
) {

865 
geomëry
 = *
¨gv
++;

867 
	`ußge
("-g optionÑequiresánárgument");

873 
	`ußge
("");

876 
visuÆbñl
 = 1;

877 
¨gv
++;

881 
	`ußge
("unknown option");

888 i‡(*
¨gv
) {

889 
shñl
 = *
¨gv
;

891 i‡(!
shñl
) {

892 
shñl
 = 
	`gëív
("SHELL=");

894 i‡(!
shñl
) {

895 
shñl
 = 
pw
->
pw_shñl
;

897 i‡(!
shñl
) {

898 
shñl
 = "/bin/sh";

901 i‡(!*
¨gv
) {

908 
˝å
 = 
	`°ºchr
(
shñl
, '/');

909 
	`•rötf
 (
thesh
, "-%s", 
˝å
 ? c±∏+ 1 : 
shñl
);

910 *--
¨gv
 = 
thesh
;

913 
cﬁ
 = 80;

914 
row
 = 25;

915 
xp
 = 0;

916 
yp
 = 0;

917 i‡(
geomëry
)

919 i‡(
cﬁ
 < 1)

921 
cﬁ
 = 80;

923 i‡(
row
 < 1)

925 
row
 = 25;

927 i‡(
cﬁ
 > 0x7f)

928 
cﬁmask
 = 0xffff;

929 i‡(
row
 > 0x7f)

930 
rowmask
 = 0xffff;

933 
ªgF⁄t
=
	`GrCª©eF⁄t
(
GR_FONT_SYSTEM_FIXED
, 0, 
NULL
);

936 
	`GrGëF⁄tInfo
(
ªgF⁄t
, &
fi
);

938 
wöw
=
cﬁ
*
fi
.
maxwidth
;

939 
wöh
=
row
*
fi
.
height
;

940 
w1
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 10,10,
wöw
, 
wöh
,0,
BLACK
,
LTBLUE
);

941 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
;

942 
¥›s
.
tôÀ
 = 
TITLE
;

943 
	`GrSëWMPr›îtõs
(
w1
, &
¥›s
);

945 
	`GrSñe˘Evíts
(
w1
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

946 
GR_EVENT_MASK_KEY_DOWN
 |

947 
GR_EVENT_MASK_FOCUS_IN
 | 
GR_EVENT_MASK_FOCUS_OUT
 |

948 
GR_EVENT_MASK_UPDATE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

950 
	`GrM≠Wödow
(
w1
);

952 
gc1
 = 
	`GrNewGC
();

953 
	`GrSëGCF⁄t
(
gc1
, 
ªgF⁄t
);

955 
	#_
 ((Ë0Ë

	)

956 
	#X
 ((Ë1Ë

	)

957 
	#MASK
(
a
,
b
,
c
,
d
,
e
,
f
,
g
) \

958 (((((((((((((
a
 * 2Ë+ 
b
Ë* 2Ë+ 
c
Ë* 2Ë+ 
d
) * 2) \

959 + 
e
Ë* 2Ë+ 
f
Ë* 2Ë+ 
g
Ë<< 9)

	)

960 
bôm≠1fg
[0] = 
	`MASK
(
_
,_,
X
,_,X,_,_);

961 
bôm≠1fg
[1] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

962 
bôm≠1fg
[2] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

963 
bôm≠1fg
[3] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

964 
bôm≠1fg
[4] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

965 
bôm≠1fg
[5] = 
	`MASK
(
_
,_,_,
X
,_,_,_);

966 
bôm≠1fg
[6] = 
	`MASK
(
_
,_,
X
,_,X,_,_);

968 
bôm≠1bg
[0] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

969 
bôm≠1bg
[1] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

970 
bôm≠1bg
[2] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

971 
bôm≠1bg
[3] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

972 
bôm≠1bg
[4] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

973 
bôm≠1bg
[5] = 
	`MASK
(
_
,_,
X
,X,X,_,_);

974 
bôm≠1bg
[6] = 
	`MASK
(
_
,
X
,X,X,X,X,_);

975 
	`GrSëCurs‹
(
w1
, 7, 7, 3, 3, 
GREEN
, 
BLACK
, 
bôm≠1fg
, 
bôm≠1bg
);

976 
	`GrSëGCF‹eground
(
gc1
, 
GREEN
);

977 
	`GrSëGCBackground
(
gc1
, 
BLACK
);

978 
	`GrGëWödowInfo
(
w1
,&
wi
);

979 
	`GrGëGCInfo
(
gc1
,&
gi
);

981 
	`•rötf
(
buf
, "wãrm: %s", 
shñl
);

986 #ifde‡
__FªeBSD__


987 
	`puãnv
 ("TERM=wterm");

989 
	`puãnv
 ("TERM=vt52");

997 i‡(
ãrmˇp_°rög
)

999 
	`•rötf
 (
ãrmˇp_°rög
 + 
	`°æí
 (termcap_string), "li#%d:co#%d:",

1000 
row
, 
cﬁ
);

1001 
	`puãnv
 (
ãrmˇp_°rög
);

1008 
	`•rötf
 (
buf
, "%d", 
cﬁ
);

1009 
	`£ãnv
 ("COLUMNS", 
buf
, 1);

1010 
	`•rötf
 (
buf
, "%d", 
row
);

1011 
	`£ãnv
 ("LINES", 
buf
, 1);

1013 
	`öô
();

1018 #ifde‡
__FªeBSD__


1019 
wösz
.
ws_cﬁ
 = 
cﬁ
;

1020 
wösz
.
ws_row
 = 
row
;

1021 i‡((
pid
 = 
	`f‹k±y
(&
pùeh
, 
±y
, 
NULL
, &
wösz
)) < 0)

1023 
	`Ârötf
(
°dîr
,"wterm: can't createÖty\r\n");

1024 
	`≥º‹
("wterm");

1025 
	`¶ìp
(2);

1026 
	`GrKûlWödow
(
w1
);

1027 
	`exô
(-1);

1030 i‡((
±r
 = 
	`rödex
(
±y
, '/')))

1032 
	`°r˝y
(
±y
, 
±r
 + 1);

1035 i‡(!
pid
)

1037 
i
;

1038 
i
 = 
	`gëdèbÀsize
(); --i >= 3; )

1039 
	`˛o£
 (
i
);

1043 
i
 = 
NSIG
; --i >= 0; )

1044 
	`sig«l
 (
i
, 
SIG_DFL
);

1047 
	`£ãuid
(
	`gëuid
());

1048 
	`£ãgid
(
	`gëgid
());

1051 
	`execvp
(
shñl
, 
¨gv
);

1054 
	`Ârötf
(
°dîr
,"wterm: can't start shell\r\n");

1055 
	`¶ìp
(3);

1056 
	`GrKûlWödow
(
w1
);

1057 
	`_exô
(-1);

1060 
pùeh
 = 
	`ãrm_öô
();

1067 
	`mysig«l
(
SIGTERM
, 
sigquô
);

1068 
	`mysig«l
(
SIGHUP
, 
sigquô
);

1069 
	`mysig«l
(
SIGINT
, 
SIG_IGN
);

1070 
	`mysig«l
(
SIGQUIT
, 
sigquô
);

1071 
	`mysig«l
(
SIGPIPE
, 
sigpùe
);

1072 
	`mysig«l
(
SIGCHLD
, 
sigchld
);

1076 i‡(
c⁄sﬁe
)

1081 
visuÆbñl
 = 1;

1082 
c⁄sﬁe
 = 0;

1083 
	`io˘l
(
pùeh
, 
TIOCCONS
, 0);

1086 
	`ãrm
();

1088 
	}
}

1090 #i‡
ELKS


1091 * 
	g«rgv
[2] = {"/bö/ßsh", 
NULL
};

1093 #i‡
DOS_DJGPP


1094 * 
	g«rgv
[2] = {"bash", 
NULL
};

1096 * 
	g«rgv
[2] = {"/bö/sh", 
NULL
};

1100 
	$sigchûd
(
signo
)

1102 
	`GrClo£
();

1103 
	`exô
(0);

1104 
	}
}

1106 
	$ãrm_öô
()

1108 
tfd
;

1109 
n
 = 0;

1110 
pid_t
 
pid
;

1111 
±y_«me
[12];

1113 
agaö
:

1114 
	`•rötf
(
±y_«me
, "/dev/±yp%d", 
n
);

1115 i‡((
tfd
 = 
	`›í
(
±y_«me
, 
O_RDWR
 | 
O_NONBLOCK
)) < 0) {

1116 i‡((
î∫o
 =
EBUSY
 ||Éºnÿ=
EIO
Ë&& 
n
 < 10) {

1117 
n
++;

1118 
agaö
;

1120 
	`Ârötf
(
°dîr
, "C™'à¸óãÖty %s\n", 
±y_«me
);

1123 
	`sig«l
(
SIGCHLD
, 
sigchûd
);

1124 
	`sig«l
(
SIGINT
, 
sigchûd
);

1125 i‡((
pid
 = 
	`f‹k
()) == -1) {

1126 
	`Ârötf
(
°dîr
, "NoÖrocesses\n");

1129 i‡(!
pid
) {

1130 
	`˛o£
(
STDIN_FILENO
);

1131 
	`˛o£
(
STDOUT_FILENO
);

1132 
	`˛o£
(
tfd
);

1134 
	`£tsid
();

1135 
±y_«me
[5] = 't';

1136 i‡((
tfd
 = 
	`›í
(
±y_«me
, 
O_RDWR
)) < 0) {

1137 
	`Ârötf
(
°dîr
, "Chûd: C™'à›íÖty %s\n", 
±y_«me
);

1138 
	`exô
(1);

1140 
	`˛o£
(
STDERR_FILENO
);

1141 
	`dup2
(
tfd
, 
STDIN_FILENO
);

1142 
	`dup2
(
tfd
, 
STDOUT_FILENO
);

1143 
	`dup2
(
tfd
, 
STDERR_FILENO
);

1144 
	`execv
(
«rgv
[0],Çargv);

1145 
	`exô
(1);

1147  
tfd
;

1148 
	}
}

1151 
	$_wrôe_utmp
(*
löe
, *
u£r
, *
ho°
, 
time
)

1153 
fh
, 
off£t
, 
isEm±y
, 
isLöe
;

1154 
utmp
 
ut
;

1156 i‡((
fh
 = 
	`›í
("/ëc/utmp", 
O_RDWR
)) < 0) {

1162 
off£t
 = 0;

1163 
isEm±y
 = -1;

1164 
isLöe
 = -1;

1166 (
isLöe
 < 0Ë&& (
	`ªad
(
fh
, &
ut
, (ut)) == (ut))) {

1167 i‡(!
ut
.
ut_löe
[0])

1169 i‡(
isEm±y
 < 0)

1171 
isEm±y
 = 
off£t
;

1176 i‡(!
	`°∫cmp
(
ut
.
ut_löe
, 
löe
, (ut.ut_line))) {

1177 
isLöe
 = 
off£t
;

1180 
off£t
 +(
ut
);

1183 i‡(
isLöe
 != -1) {

1185 
	`l£ek
(
fh
, 
isLöe
, 
SEEK_SET
);

1186 } i‡(
isEm±y
 != -1) {

1188 
	`l£ek
(
fh
, 
isLöe
, 
SEEK_SET
);

1193 i‡(
time
)

1195 
	`°∫˝y
(
ut
.
ut_löe
, 
löe
, (ut.ut_line));

1196 
	`°∫˝y
(
ut
.
ut_«me
, 
u£r
, (ut.ut_name));

1197 
	`°∫˝y
(
ut
.
ut_ho°
, 
ho°
, (ut.ut_host));

1198 
ut
.
ut_time
 = 
time
;

1202 
	`mem£t
(&
ut
, 0, (ut));

1204 
	`wrôe
(
fh
, &
ut
, (ut));

1205 
	`˛o£
(
fh
);

1206 
	}
}

	@demos/nanox/nxterm.h

6 #ifde‡
__MINT__


8 
	gãrmˇp_°rög
[1024] =

19 #ñi‡
deföed
(
löux
Ë|| deföed(
__FªeBSD__
)

21 
	gãrmˇp_°rög
[1024] =

32 #ñi‡
deföed
(
sun
)

36 
	gãrmˇp_°rög
[1024] =

47 #ñi‡
deföed
(
__NëBSD__
)

49 
	gãrmˇp_°rög
[1024] =

62 #îr‹ 
o›s
, 
a
 
√w
 
›î©ög
 
sy°em
?

	@demos/nanox/nxview.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	#MWINCLUDECOLORS


	)

12 
	~"«no-X.h
"

15 
	$maö
(
¨gc
,**
¨gv
)

17 
GR_IMAGE_ID
 
image_id
;

18 
GR_WINDOW_ID
 
wödow_id
;

19 
GR_GC_ID
 
gc_id
;

20 
GR_SIZE
 
w
 = -1;

21 
GR_SIZE
 
h
 = -1;

22 
GR_EVENT
 
evít
;

23 
GR_SCREEN_INFO
 
söfo
;

24 
GR_IMAGE_INFO
 
öfo
;

25 
tôÀ
[256];

27 i‡(
¨gc
 < 2) {

28 
	`¥ötf
("Usage:Çxview <image file> [stretch]\n");

29 
	`exô
(1);

32 i‡(
	`GrO≥n
() < 0) {

33 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

34 
	`exô
(1);

37 i‡(!(
image_id
 = 
	`GrLﬂdImageFromFûe
(
¨gv
[1], 0))) {

38 
	`Ârötf
(
°dîr
, "C™'àlﬂd imagêfûe: %s\n", 
¨gv
[1]);

39 
	`exô
(1);

42 if(
¨gc
 > 2) {

44 
	`GrGëS¸ìnInfo
(&
söfo
);

45 
w
 = 
söfo
.
cﬁs
/2;

46 
h
 = 
söfo
.
rows
/2;

48 
	`GrGëImageInfo
(
image_id
, &
öfo
);

49 
w
 = 
öfo
.
width
;

50 
h
 = 
öfo
.
height
;

53 
	`•rötf
(
tôÀ
, "nxvõw %s", 
¨gv
[1]);

54 
wödow_id
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, 
tôÀ
,

55 
GR_ROOT_WINDOW_ID
, 0, 0, 
w
, 
h
, 
BLACK
);

57 
	`GrSñe˘Evíts
(
wödow_id
,

58 
GR_EVENT_MASK_CLOSE_REQ
|
GR_EVENT_MASK_EXPOSURE
);

60 
	`GrM≠Wödow
(
wödow_id
);

62 
gc_id
 = 
	`GrNewGC
();

65 
	`GrGëNextEvít
(&
evít
);

66 
evít
.
ty≥
) {

67 
GR_EVENT_TYPE_CLOSE_REQ
:

68 
	`GrDe°royWödow
(
wödow_id
);

69 
	`GrDe°royGC
(
gc_id
);

70 
	`GrFªeImage
(
image_id
);

71 
	`GrClo£
();

72 
	`exô
(0);

74 
GR_EVENT_TYPE_EXPOSURE
:

75 
	`GrDøwImageToFô
(
wödow_id
, 
gc_id
, 0,0, 
w
,
h
, 
image_id
);

81 
	}
}

	@demos/nanox/oneshot.c

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

35 
	~<«no-X.h
>

36 
	~<nxcﬁ‹s.h
>

38 
	#WINDOW_WIDTH
 160

	)

39 
	#WINDOW_HEIGHT
 160

	)

40 
	#TIMER_PERIOD
 500

	)

42 
GR_WINDOW_ID
 
	gmaö_wödow
;

43 
GR_GC_ID
 
	ggc
;

44 
	gcuºít_cﬁour
 = 
GR_COLOR_BLACK
;

45 
GR_TIMER_ID
 
	gtimî_id
 = 0;

47 
	$ªdøw
()

49 
	`GrFûlRe˘
(
maö_wödow
, 
gc
, 0, 0, 
WINDOW_WIDTH
, 
WINDOW_HEIGHT
);

50 
	}
}

52 
	$timeout
()

54 
timî_id
 = 0;

55 
cuºít_cﬁour
 = (cuºít_cﬁou∏=
GR_COLOR_BLACK
Ë? 
GR_COLOR_WHITE
 :

56 
GR_COLOR_BLACK
;

57 
	`GrSëGCF‹eground
(
gc
, 
cuºít_cﬁour
);

58 
	`ªdøw
();

59 
	}
}

61 
	$buâ⁄_down
()

63 if(
timî_id
) ;

64 
timî_id
 = 
	`GrCª©eTimî
(
maö_wödow
, 
TIMER_PERIOD
, 
GR_FALSE
);

65 
	}
}

67 
	$buâ⁄_up
()

69 if(!
timî_id
) ;

70 
	`GrDe°royTimî
(
timî_id
);

71 
timî_id
 = 0;

72 
	}
}

74 
	$öô
()

76 
GR_WM_PROPERTIES
 
¥›s
;

78 if(
	`GrO≥n
() < 0) {

79 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

83 
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
WINDOW_WIDTH
,

84 
WINDOW_HEIGHT
, 0, 
GR_COLOR_WHITE
, 0);

86 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

87 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 |

88 
GR_WM_PROPS_CLOSEBOX
;

89 
¥›s
.
tôÀ
 = "oneshot";

90 
	`GrSëWMPr›îtõs
(
maö_wödow
, &
¥›s
);

92 
	`GrSñe˘Evíts
(
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

93 
GR_EVENT_MASK_BUTTON_DOWN
 |

94 
GR_EVENT_MASK_BUTTON_UP
 |

95 
GR_EVENT_MASK_CLOSE_REQ
 |

96 
GR_EVENT_MASK_TIMER
);

98 
gc
 = 
	`GrNewGC
();

99 
	`GrSëGCF‹eground
(
gc
, 
cuºít_cﬁour
);

101 
	`GrM≠Wödow
(
maö_wödow
);

104 
	}
}

106 
	$h™dÀ_evít
(
GR_EVENT
 *
ev
)

108 
ev
->
ty≥
) {

109 
GR_EVENT_TYPE_CLOSE_REQ
:

111 
GR_EVENT_TYPE_EXPOSURE
:

112 
	`ªdøw
();

114 
GR_EVENT_TYPE_BUTTON_DOWN
:

115 
	`buâ⁄_down
();

117 
GR_EVENT_TYPE_BUTTON_UP
:

118 
	`buâ⁄_up
();

120 
GR_EVENT_TYPE_TIMER
:

121 
	`timeout
();

124 
	`Ârötf
(
°dîr
, "GŸ unknow¿evíà%d\n", 
ev
->
ty≥
);

128 
	}
}

130 
	$maö
(
¨gc
, *
¨gv
[])

132 
GR_EVENT
 
ev
;

134 if(
	`öô
())  -1;

137 
	`GrGëNextEvít
(&
ev
);

138 } !
	`h™dÀ_evít
(&
ev
));

140 
	`GrClo£
();

143 
	}
}

	@demos/nanox/pcfdemo.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	#MWINCLUDECOLORS


	)

7 
	~"«no-X.h
"

9 
GR_FONT_ID
 
	gf⁄t
 = 0;

10 
GR_WINDOW_ID
 
	gmaö_wid
;

11 
GR_FONT_INFO
 
	gföfo
;

14 
	$døw_°rög
()

16 
cou¡
 = 0;

17 
x
 = 0;

18 
y
 = 10;

19 
ch
;

20 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

22 
	`GrSëGCF⁄t
(
gc
, 
f⁄t
);

24 
	`GrSëGCF‹eground
(
gc
, 
	`GR_RGB
(255, 255, 255));

25 
	`GrSëGCBackground
(
gc
, 
	`GR_RGB
(0, 0, 0));

27 
	`¥ötf
("Fú° ch¨ = %d,Üa° ch¨ = %d\n", 
föfo
.
fú°ch¨
,

28 
föfo
.
œ°ch¨
);

29 
	`¥ötf
("Max width = %d, max heighà%d\n", 
föfo
.
maxwidth
,

30 
föfo
.
height
);

32 
ch
 = 0; ch < 255; ch++) {

33 i‡(
ch
 < 
föfo
.
fú°ch¨
 || ch > föfo.
œ°ch¨
)

34 
	`GrFûlRe˘
(
maö_wid
, 
gc
, 
x
, 
y
, 
föfo
.
maxwidth
,

35 
föfo
.
height
);

37 
	`GrText
(
maö_wid
, 
gc
, 
x
, 
y
, &
ch
, 1,

38 
GR_TFTOP
 | 
GR_TFASCII
);

40 i‡(++
cou¡
 >= 16) {

41 
x
 = 0;

42 
y
 +
föfo
.
height
;

43 
cou¡
 = 0;

45 
x
 +
föfo
.
maxwidth
 + 2;

48 
	`GrDe°royGC
(
gc
);

49 
	}
}

52 
	$maö
(
¨gc
, **
¨gv
)

54 
width
, 
height
;

56 i‡(
¨gc
 < 2)

59 i‡(
	`GrO≥n
() == -1)

62 
f⁄t
 = 
	`GrCª©eF⁄t
(
¨gv
[1], 12, 0);

63 i‡(!
f⁄t
)

64 
	`¥ötf
("U«bÀÅÿlﬂd %s\n", 
¨gv
[1]);

66 
	`GrGëF⁄tInfo
(
f⁄t
, &
föfo
);

68 
width
 = ((
föfo
.
maxwidth
 + 2) * 16);

69 
height
 =

70 (((
föfo
.
œ°ch¨
 - föfo.
fú°ch¨
) / 16) +

71 5Ë* 
föfo
.
height
;

73 
maö_wid
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "pcfdemo",

74 
GR_ROOT_WINDOW_ID
, 0, 0, 
width
, 
height
, 
BLACK
);

75 
	`GrSñe˘Evíts
(
maö_wid
, 
GR_EVENT_MASK_EXPOSURE
|
GR_EVENT_MASK_CLOSE_REQ
);

76 
	`GrM≠Wödow
(
maö_wid
);

79 
GR_EVENT
 
evít
;

80 
	`GrGëNextEvít
(&
evít
);

82 i‡(
evít
.
ty≥
 =
GR_EVENT_TYPE_EXPOSURE
)

83 
	`døw_°rög
();

85 if(
evít
.
ty≥
 =
GR_EVENT_TYPE_CLOSE_REQ
) {

86 
	`GrClo£
();

87 
	`exô
(0);

90 
	}
}

	@demos/nanox/periodic.c

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

35 
	~<«no-X.h
>

36 
	~<nxcﬁ‹s.h
>

38 
	#WINDOW_WIDTH
 160

	)

39 
	#WINDOW_HEIGHT
 160

	)

40 
	#TIMER_PERIOD
 250

	)

42 
GR_WINDOW_ID
 
	gmaö_wödow
;

43 
GR_GC_ID
 
	ggc
;

44 
	gcuºít_cﬁour
 = 
GR_COLOR_BLACK
;

45 
GR_TIMER_ID
 
	gtimî_id
 = 0;

47 
	$ªdøw
()

49 
	`GrFûlRe˘
(
maö_wödow
, 
gc
, 0, 0, 
WINDOW_WIDTH
, 
WINDOW_HEIGHT
);

50 
	}
}

52 
	$timeout
()

54 
cuºít_cﬁour
 = (cuºít_cﬁou∏=
GR_COLOR_BLACK
Ë? 
GR_COLOR_WHITE
 :

55 
GR_COLOR_BLACK
;

56 
	`GrSëGCF‹eground
(
gc
, 
cuºít_cﬁour
);

57 
	`ªdøw
();

58 
	}
}

60 
	$buâ⁄_down
()

62 if(
timî_id
) {

63 
	`GrDe°royTimî
(
timî_id
);

64 
timî_id
 = 0;

65 } 
timî_id
 = 
	`GrCª©eTimî
(
maö_wödow
, 
TIMER_PERIOD
, 
GR_TRUE
);

66 
	}
}

68 
	$öô
()

70 
GR_WM_PROPERTIES
 
¥›s
;

72 if(
	`GrO≥n
() < 0) {

73 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

77 
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
WINDOW_WIDTH
,

78 
WINDOW_HEIGHT
, 0, 
GR_COLOR_WHITE
, 0);

80 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

81 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 |

82 
GR_WM_PROPS_CLOSEBOX
;

83 
¥›s
.
tôÀ
 = "periodic";

84 
	`GrSëWMPr›îtõs
(
maö_wödow
, &
¥›s
);

86 
	`GrSñe˘Evíts
(
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

87 
GR_EVENT_MASK_BUTTON_DOWN
 |

88 
GR_EVENT_MASK_CLOSE_REQ
 |

89 
GR_EVENT_MASK_TIMER
);

91 
gc
 = 
	`GrNewGC
();

92 
	`GrSëGCF‹eground
(
gc
, 
cuºít_cﬁour
);

94 
	`GrM≠Wödow
(
maö_wödow
);

96 
timî_id
 = 
	`GrCª©eTimî
(
maö_wödow
, 
TIMER_PERIOD
, 
GR_TRUE
);

99 
	}
}

101 
	$h™dÀ_evít
(
GR_EVENT
 *
ev
)

103 
ev
->
ty≥
) {

104 
GR_EVENT_TYPE_CLOSE_REQ
:

106 
GR_EVENT_TYPE_EXPOSURE
:

107 
	`ªdøw
();

109 
GR_EVENT_TYPE_BUTTON_DOWN
:

110 
	`buâ⁄_down
();

112 
GR_EVENT_TYPE_TIMER
:

113 
	`timeout
();

116 
	`Ârötf
(
°dîr
, "GŸ unknow¿evíà%d\n", 
ev
->
ty≥
);

120 
	}
}

122 
	$maö
(
¨gc
, *
¨gv
[])

124 
GR_EVENT
 
ev
;

126 if(
	`öô
())  -1;

129 
	`GrGëNextEvít
(&
ev
);

130 } !
	`h™dÀ_evít
(&
ev
));

132 
	`GrClo£
();

135 
	}
}

	@demos/nanox/polydemo.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	#MWINCLUDECOLORS


	)

7 
	~"«no-X.h
"

10 
	$døw
(
GR_EVENT
 * 
e
)

12 
GR_WINDOW_ID
 
wid
 = ((
GR_EVENT_EXPOSURE
 *)
e
)->wid;

13 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

14 
GR_POINT
 
poöts
[4];

15 
x
 = 10;

16 
y
 = 10;

17 
sz
 = 20;

18 
sz2
 = 5;

20 
	`GrSëGCBackground
(
gc
, 
BLACK
);

23 
poöts
[0].
x
 = x;

24 
poöts
[0].
y
 = y;

25 
poöts
[1].
x
 = x + 
sz
;

26 
poöts
[1].
y
 = y;

27 
poöts
[2].
x
 = x + (
sz
 / 2);

28 
poöts
[2].
y
 = y + 
sz
;

29 
poöts
[3].
x
 = x;

30 
poöts
[3].
y
 = y;

32 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

33 
	`GrFûlPﬁy
(
wid
, 
gc
, 3, 
poöts
);

36 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

37 
	`GrPﬁy
(
wid
, 
gc
, 4, 
poöts
);

40 
y
 +
sz
 + 10;

41 
poöts
[0].
x
 = x;

42 
poöts
[0].
y
 = y;

43 
poöts
[1].
x
 = x + 
sz
 + 1;

44 
poöts
[1].
y
 = y;

45 
poöts
[2].
x
 = x + (
sz
 / 2);

46 
poöts
[2].
y
 = y + 
sz
;

47 
poöts
[3].
x
 = x;

48 
poöts
[3].
y
 = y;

50 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

51 
	`GrFûlPﬁy
(
wid
, 
gc
, 3, 
poöts
);

54 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

55 
	`GrPﬁy
(
wid
, 
gc
, 4, 
poöts
);

58 
y
 +
sz
 + 10;

59 
poöts
[0].
x
 = x;

60 
poöts
[0].
y
 = y;

61 
poöts
[1].
x
 = x + 
sz
 - 1;

62 
poöts
[1].
y
 = y;

63 
poöts
[2].
x
 = x + (
sz
 / 2);

64 
poöts
[2].
y
 = y + 
sz
;

65 
poöts
[3].
x
 = x;

66 
poöts
[3].
y
 = y;

68 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

69 
	`GrFûlPﬁy
(
wid
, 
gc
, 3, 
poöts
);

72 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

73 
	`GrPﬁy
(
wid
, 
gc
, 4, 
poöts
);

76 
x
 = 60;

77 
y
 = 60;

78 
sz
 = 10;

79 
sz2
 = 8;

81 
poöts
[0].
x
 = x;

82 
poöts
[0].
y
 = y;

83 
y
 -
sz
;

84 
poöts
[1].
x
 = x + 
sz2
;

85 
poöts
[1].
y
 = y;

86 
y
 -
sz
;

87 
poöts
[2].
x
 = x;

88 
poöts
[2].
y
 = y;

89 
poöts
[3].
x
 = x;

90 
poöts
[3].
y
 = 60;

92 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

93 
	`GrFûlPﬁy
(
wid
, 
gc
, 3, 
poöts
);

96 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

97 
	`GrPﬁy
(
wid
, 
gc
, 4, 
poöts
);

100 
x
 = 60;

101 
y
 = 90;

102 
poöts
[0].
x
 = x;

103 
poöts
[0].
y
 = y;

104 
y
 -
sz
;

105 
poöts
[1].
x
 = x + 
sz2
;

106 
poöts
[1].
y
 = y;

107 
y
 -
sz
;

108 
poöts
[2].
x
 = x;

109 
poöts
[2].
y
 = y;

110 
poöts
[3].
x
 = x;

111 
poöts
[3].
y
 = 90;

113 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

114 
	`GrFûlPﬁy
(
wid
, 
gc
, 3, 
poöts
);

118 
GR_POINT
 
±1
[5] = {{10,120},{150,130},{120,220},{60,160},{15,200}};

119 
GR_POINT
 
±2
[5] = {{10,220},{150,230},{120,320},{60,360},{15,300}};

122 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

123 
	`GrFûlPﬁy
(
wid
,
gc
,5,
±1
);

126 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

127 
	`GrPﬁy
(
wid
,
gc
,5,
±1
);

130 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

131 
	`GrFûlPﬁy
(
wid
,
gc
,5,
±2
);

134 
	`GrSëGCF‹eground
(
gc
, 
GREEN
);

135 
	`GrPﬁy
(
wid
,
gc
,5,
±2
);

138 
	`GrDe°royGC
(
gc
);

139 
	}
}

142 
	$maö
(
ac
, **
av
)

144 
GR_EVENT
 
evít
;

145 
GR_WINDOW_ID
 
w
;

147 i‡(
	`GrO≥n
() < 0) {

148 #i‡! 
PSP


149 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

151 
	`exô
(1);

155 
w
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_NOAUTOMOVE
 | 
GR_WM_PROPS_BORDER
 |

156 
GR_WM_PROPS_CAPTION
 | 
GR_WM_PROPS_CLOSEBOX
,

157 "pﬁydemo", 
GR_ROOT_WINDOW_ID
,

158 10, 10, 220, 362, 
	`GR_RGB
(0, 0, 0));

159 
	`GrSñe˘Evíts
(
w
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

160 
	`GrM≠Wödow
(
w
);

163 
	`GrGëNextEvít
(&
evít
);

165 
evít
.
ty≥
) {

166 
GR_EVENT_TYPE_EXPOSURE
:

167 
	`døw
(&
evít
);

169 
GR_EVENT_TYPE_CLOSE_REQ
:

170 
	`GrClo£
();

171 
	`exô
(0);

175 
	}
}

	@demos/nanox/pressure.c

32 
	~<°dio.h
>

33 
	~<°dlib.h
>

35 
	~<«no-X.h
>

36 
	~<nxcﬁ‹s.h
>

38 
	#FIX_PRECISION
 10

	)

39 
	~<fixed.h
>

44 
	#DEFAULT_MIN_PRESSURE
 190

	)

45 
	#DEFAULT_MAX_PRESSURE
 215

	)

49 
	#DEFAULT_MIN_PRESSURE
 0

	)

50 
	#DEFAULT_MAX_PRESSURE
 100

	)

53 
	#MAX_BLOB_RAD
 20

	)

54 
	#WINDOW_WIDTH
 160

	)

55 
	#WINDOW_HEIGHT
 160

	)

57 
GR_WINDOW_ID
 
	gmaö_wödow
, 
	gmaö_pixm≠
;

58 
GR_GC_ID
 
	ggc
;

59 
	gmö_z
 = 
DEFAULT_MIN_PRESSURE
;

60 
	gmax_z
 = 
DEFAULT_MAX_PRESSURE
;

61 
	gmax_d
 = 
MAX_BLOB_RAD
;

63 
	$öô
(
¨gc
, *
¨gv
[])

65 
GR_PROP
 *
¥›
;

66 
GR_COORD
 
x
 = 0;

67 
GR_WM_PROPERTIES
 
¥›s
;

68 
möz
, 
maxz
;

70 if(
¨gc
 > 1) {

71 if(
¨gc
 != 3) {

72 
	`Ârötf
(
°dîr
, "Usage: %s min_pressure max_pressure\n",

73 
¨gv
[0]);

76 
möz
 = 
	`©oi
(
¨gv
[1]);

77 
maxz
 = 
	`©oi
(
¨gv
[2]);

78 if(
möz
 =0 || 
maxz
 == 0 || minz >= maxz) {

79 
	`Ârötf
(
°dîr
, "Invalid calibrationÖarameters\n");

82 
mö_z
 = 
möz
;

83 
max_z
 = 
maxz
;

86 if(
	`GrO≥n
() < 0) {

87 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

91 if(
	`GrGëWödowPr›îty
(
GR_ROOT_WINDOW_ID
, "WINDOW_MANAGER", &
¥›
)) {

92 
	`‰ì
(
¥›
);

93 
x
 = 
GR_OFF_SCREEN
;

96 
maö_wödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 
x
, 0, 
WINDOW_WIDTH
,

97 
WINDOW_HEIGHT
, 0, 
GR_COLOR_WHITE
, 0);

100 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

101 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 |

102 
GR_WM_PROPS_CLOSEBOX
;

103 
¥›s
.
tôÀ
 = "pressure";

104 
	`GrSëWMPr›îtõs
(
maö_wödow
, &
¥›s
);

106 
	`GrSñe˘Evíts
(
maö_wödow
, 
GR_EVENT_MASK_EXPOSURE
 |

107 
GR_EVENT_MASK_MOUSE_MOTION
 |

109 
GR_EVENT_MASK_BUTTON_DOWN
 |

110 
GR_EVENT_MASK_BUTTON_UP
 |

111 
GR_EVENT_MASK_CLOSE_REQ
);

113 
maö_pixm≠
 = 
	`GrNewPixm≠
(
WINDOW_WIDTH
, 
WINDOW_HEIGHT
, 
NULL
);

115 
gc
 = 
	`GrNewGC
();

116 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_WHITE
);

117 
	`GrFûlRe˘
(
maö_pixm≠
, 
gc
, 0, 0, 
WINDOW_WIDTH
, 
WINDOW_HEIGHT
);

118 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_BLACK
);

120 
	`GrM≠Wödow
(
maö_wödow
);

123 
	}
}

125 
	$h™dÀ_exposuª_evít
(
GR_EVENT_EXPOSURE
 *
ev
)

127 
	`GrC›yAªa
(
maö_wödow
, 
gc
, 
ev
->
x
,Év->
y
,Év->
width
,Év->
height
,

128 
maö_pixm≠
, 
ev
->
x
,Év->
y
, 0);

129 
	}
}

131 
	$h™dÀ_mou£_evít
(
GR_EVENT_MOUSE
 *
ev
)

133 
z
 = 
ev
->z, 
ød
;

136 if(
z
 < 
mö_z
) ;

139 
z
 = (z > 
max_z
) ? max_z : z;

142 
ød
 = 
	`fixtoöt
(
	`fixmu…
(
	`fixdiv
(
	`öâofix
(
z
 - 
mö_z
),

143 
	`öâofix
(
max_z
 - 
mö_z
)), i¡tofix(
MAX_BLOB_RAD
)));

145 
	`GrFûlEŒù£
(
maö_pixm≠
, 
gc
, 
ev
->
x
,Év->
y
, 
ød
,Ñad);

146 
	`GrFûlEŒù£
(
maö_wödow
, 
gc
, 
ev
->
x
,Év->
y
, 
ød
,Ñad);

147 
	}
}

149 
	$h™dÀ_evít
(
GR_EVENT
 *
ev
)

151 
ev
->
ty≥
) {

152 
GR_EVENT_TYPE_CLOSE_REQ
:

154 
GR_EVENT_TYPE_EXPOSURE
:

155 
	`h™dÀ_exposuª_evít
((
GR_EVENT_EXPOSURE
 *)
ev
);

157 
GR_EVENT_TYPE_MOUSE_POSITION
:

158 
GR_EVENT_TYPE_MOUSE_MOTION
:

159 
	`h™dÀ_mou£_evít
((
GR_EVENT_MOUSE
 *)
ev
);

161 
GR_EVENT_TYPE_BUTTON_DOWN
:

162 
GR_EVENT_TYPE_BUTTON_UP
:

165 
	`Ârötf
(
°dîr
, "GŸ unknow¿evíà%d\n", 
ev
->
ty≥
);

169 
	}
}

171 
	$maö
(
¨gc
, *
¨gv
[])

173 
GR_EVENT
 
ev
;

175 if(
	`öô
(
¨gc
, 
¨gv
))  -1;

178 
	`GrGëNextEvít
(&
ev
);

179 } !
	`h™dÀ_evít
(&
ev
));

181 
	`GrClo£
();

184 
	}
}

	@demos/nanox/rgndemo.c

8 
	~<°dio.h
>

9 
	~<«no-X.h
>

10 
	~<nxcﬁ‹s.h
>

12 
	~"tuxmask.h
"

14 
	#WINDOW_WIDTH
 190

	)

15 
	#WINDOW_HEIGHT
 305

	)

16 
	#NUMGCS
 5

	)

19 
ªdøw
(
GR_WINDOW_ID
 
wid
, 
GR_GC_ID
 *
gc
);

20 
GR_GC_ID
 
£tup_sögÀ_ª˘_ªgi⁄
();

21 
GR_GC_ID
 
£tup_mu…i_ª˘_ªgi⁄
();

22 
GR_GC_ID
 
£tup_sim∂e_pﬁy_ªgi⁄
();

23 
GR_GC_ID
 
£tup_bôm≠_ªgi⁄
();

24 
GR_GC_ID
 
£tup_com∂ex_pﬁy_ªgi⁄
();

27 
	$ªdøw
(
GR_WINDOW_ID
 
wid
, 
GR_GC_ID
 *
gc
)

29 
i
, 
y
;

31 
i
 = 0; i < 
NUMGCS
; i++)

32 
y
 = 40; y < 
WINDOW_HEIGHT
; y += 3)

33 
	`GrLöe
(
wid
, 
gc
[
i
], 0, 
y
, 
WINDOW_WIDTH
 - 1, y - 40);

34 
	}
}

36 
GR_GC_ID
 
	$£tup_sögÀ_ª˘_ªgi⁄
()

38 
GR_GC_ID
 
gc
;

39 
GR_RECT
 
ª˘
;

40 
GR_REGION_ID
 
rg
;

42 
gc
 = 
	`GrNewGC
();

43 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_BLACK
);

44 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

45 
rg
 = 
	`GrNewRegi⁄
();

46 
ª˘
.
x
 = 0;

47 
ª˘
.
y
 = 0;

48 
ª˘
.
width
 = 60;

49 
ª˘
.
height
 = 40;

50 
	`GrUni⁄Re˘WôhRegi⁄
(
rg
, &
ª˘
);

51 
	`GrSëGCRegi⁄
(
gc
, 
rg
);

52 
	`GrSëGCClùOrigö
(
gc
, 25, 35);

54  
gc
;

55 
	}
}

57 
GR_GC_ID
 
	$£tup_mu…i_ª˘_ªgi⁄
()

59 
GR_GC_ID
 
gc
;

60 
GR_RECT
 
ª˘
;

61 
GR_REGION_ID
 
rg
;

63 
gc
 = 
	`GrNewGC
();

64 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_BLUE
);

65 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

66 
rg
 = 
	`GrNewRegi⁄
();

67 
ª˘
.
x
 = 10;

68 
ª˘
.
y
 = 0;

69 
ª˘
.
width
 = 10;

70 
ª˘
.
height
 = 60;

71 
	`GrUni⁄Re˘WôhRegi⁄
(
rg
, &
ª˘
);

72 
ª˘
.
x
 = 40;

73 
ª˘
.
y
 = 0;

74 
ª˘
.
width
 = 10;

75 
ª˘
.
height
 = 60;

76 
	`GrUni⁄Re˘WôhRegi⁄
(
rg
, &
ª˘
);

77 
ª˘
.
x
 = 0;

78 
ª˘
.
y
 = 10;

79 
ª˘
.
width
 = 60;

80 
ª˘
.
height
 = 10;

81 
	`GrUni⁄Re˘WôhRegi⁄
(
rg
, &
ª˘
);

82 
ª˘
.
x
 = 0;

83 
ª˘
.
y
 = 40;

84 
ª˘
.
width
 = 60;

85 
ª˘
.
height
 = 10;

86 
	`GrUni⁄Re˘WôhRegi⁄
(
rg
, &
ª˘
);

87 
	`GrSëGCRegi⁄
(
gc
, 
rg
);

88 
	`GrSëGCClùOrigö
(
gc
, 105, 15);

90  
gc
;

91 
	}
}

93 
GR_GC_ID
 
	$£tup_sim∂e_pﬁy_ªgi⁄
()

95 
GR_GC_ID
 
gc
;

96 
GR_REGION_ID
 
rg
;

97 
GR_POINT
 
poöts
[] = { {15, 0}, {45, 0}, {60, 15}, {60, 45}, {45, 60},

100 
gc
 = 
	`GrNewGC
();

101 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_PURPLE
);

102 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

103 
rg
 = 
	`GrNewPﬁyg⁄Regi⁄
(
GR_POLY_WINDING
, 8, 
poöts
);

104 
	`GrSëGCRegi⁄
(
gc
, 
rg
);

105 
	`GrSëGCClùOrigö
(
gc
, 25, 95);

107  
gc
;

108 
	}
}

110 
GR_GC_ID
 
	$£tup_bôm≠_ªgi⁄
()

112 
GR_GC_ID
 
gc
;

113 
GR_REGION_ID
 
rg
;

115 
gc
 = 
	`GrNewGC
();

116 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_FORESTGREEN
);

117 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

118 
rg
 = 
	`GrNewBôm≠Regi⁄
(
tuxmask_bôs
, 
TUXMASK_WIDTH
, 
TUXMASK_HEIGHT
);

119 
	`GrSëGCRegi⁄
(
gc
, 
rg
);

120 
	`GrSëGCClùOrigö
(
gc
, 100, 80);

122  
gc
;

123 
	}
}

125 
GR_GC_ID
 
	$£tup_com∂ex_pﬁy_ªgi⁄
()

127 
GR_GC_ID
 
gc
;

128 
GR_REGION_ID
 
rg
;

129 
GR_POINT
 
poöts
[] = { {0, 0}, {99, 0}, {99, 99}, {0, 99}, {0, 19},

134 
gc
 = 
	`GrNewGC
();

135 
	`GrSëGCF‹eground
(
gc
, 
GR_COLOR_ORANGE
);

136 
	`GrSëGCBackground
(
gc
, 
GR_COLOR_WHITE
);

137 
rg
 = 
	`GrNewPﬁyg⁄Regi⁄
(
GR_POLY_EVENODD
, 20, 
poöts
);

138 
	`GrSëGCRegi⁄
(
gc
, 
rg
);

139 
	`GrSëGCClùOrigö
(
gc
, 25, 180);

141  
gc
;

142 
	}
}

144 
	$maö
()

146 
GR_WINDOW_ID
 
wid
;

147 
GR_GC_ID
 
gc
[
NUMGCS
];

148 
GR_EVENT
 
evít
;

150 if(
	`GrO≥n
() < 0) {

151 #i‡! 
PSP


152 
	`Ârötf
(
°dîr
, "Couldn't connectÅoÅhe Nano-X server\n");

157 
wid
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "rgndemo",

158 
GR_ROOT_WINDOW_ID
, 0, 0, 
WINDOW_WIDTH
, 
WINDOW_HEIGHT
,

159 
GR_COLOR_GRAY80
);

161 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLOSE_REQ
 | 
GR_EVENT_MASK_EXPOSURE
);

163 
gc
[0] = 
	`£tup_sögÀ_ª˘_ªgi⁄
();

164 
gc
[1] = 
	`£tup_mu…i_ª˘_ªgi⁄
();

165 
gc
[2] = 
	`£tup_sim∂e_pﬁy_ªgi⁄
();

166 
gc
[3] = 
	`£tup_bôm≠_ªgi⁄
();

167 
gc
[4] = 
	`£tup_com∂ex_pﬁy_ªgi⁄
();

169 
	`GrM≠Wödow
(
wid
);

172 
	`GrGëNextEvít
(&
evít
);

173 
evít
.
ty≥
) {

174 
GR_EVENT_TYPE_EXPOSURE
:

175 
	`ªdøw
(
wid
, 
gc
);

177 
GR_EVENT_TYPE_CLOSE_REQ
:

178 
	`GrClo£
();

184 
	}
}

	@demos/nanox/setportrait.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

10 
	~<«no-X.h
>

12 
	$ußge
()

14 
	`Ârötf
(
°dîr
, "Usage: setportrait <none|left|right|down>\n");

15 
	`exô
(-1);

16 
	}
}

18 
	$maö
(
¨gc
, *
¨gv
[])

20 
p‹åaô
 = -1;

22 if(
¨gc
 !2Ë
	`ußge
();

24 if(!
	`°rcmp
("n⁄e", 
¨gv
[1])Ë
p‹åaô
 = 
MWPORTRAIT_NONE
;

25 if(!
	`°rcmp
("À·", 
¨gv
[1])Ë
p‹åaô
 = 
MWPORTRAIT_LEFT
;

26 if(!
	`°rcmp
("right", 
¨gv
[1])Ë
p‹åaô
 = 
MWPORTRAIT_RIGHT
;

27 if(!
	`°rcmp
("down", 
¨gv
[1])Ë
p‹åaô
 = 
MWPORTRAIT_DOWN
;

28 
	`ußge
();

30 if(
	`GrO≥n
() < 0) {

31 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

35 
	`GrSëP‹åaôMode
(
p‹åaô
);

37 
	`GrClo£
();

40 
	}
}

	@demos/nanox/setselection.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<uni°d.h
>

5 
	~"«no-X.h
"

7 
	$maö
(
¨gc
, *
¨gv
[])

9 
GR_WINDOW_ID
 
wid
;

10 
GR_EVENT
 
evít
;

11 
FILE
 *
Â
;

12 *
buf
 = 
NULL
;

13 
buf_size
 = 0;

14 
d©a_Àn
 = 0;

15 
ªt
 = 0;

16 
GR_EVENT_CLIENT_DATA_REQ
 *
ªq
;

17 
GR_EVENT_SELECTION_CHANGED
 *
sc
;

19 if(
¨gc
 != 2) {

20 
	`Ârötf
(
°dîr
, "Usage: setselection <text file>\n");

24 if(!(
Â
 = 
	`f›í
(
¨gv
[1], "r"))) {

25 
	`Ârötf
(
°dîr
, "Couldn't openÅext file\n");

30 
d©a_Àn
 +
ªt
;

31 
buf_size
 = 
d©a_Àn
 + 65536;

32 if(!(
buf
 = 
	`ªÆloc
(buf, 
buf_size
))) {

33 
	`Ârötf
(
°dîr
, "Out of memory\n");

36 } (
ªt
 = 
	`‰ód
(
buf
 + 
d©a_Àn
, 1, 65536, 
Â
)) > 0);

37 if(
ªt
 < 0) {

38 
	`Ârötf
(
°dîr
, "FailedÅoÑeadÅext file sucessfully\n");

42 if(
	`GrO≥n
() < 0) {

43 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

47 
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 1, 1, 0, 0, 0);

48 if(!
wid
) {

49 
	`Ârötf
(
°dîr
, "Couldn't getá window\n");

53 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLIENT_DATA_REQ
 |

54 
GR_EVENT_MASK_SELECTION_CHANGED
);

56 
	`GrSëSñe˘i⁄Ow√r
(
wid
, "nota/realtypeÅext/plainÇon/existant "

60 
	`GrGëNextEvít
(&
evít
);

61 
evít
.
ty≥
) {

62 
GR_EVENT_TYPE_CLIENT_DATA_REQ
:

63 
ªq
 = &
evít
.
˛õ¡d©¨eq
;

64 
	`Ârötf
(
°dîr
, "GotÑequest with serial "

66 "ty≥ %d\n", 
ªq
->
£rül
,Ñeq->
rid
,

67 
ªq
->
mimëy≥
);

68 
	`GrSídClõ¡D©a
(
wid
, 
ªq
->
rid
,Ñeq->
£rül
,

69 
d©a_Àn
, d©a_Àn, 
buf
);

71 
GR_EVENT_TYPE_SELECTION_CHANGED
:

72 
sc
 = &
evít
.
£À˘i⁄ch™ged
;

73 if(
sc
->
√w_ow√r
 !
wid
) {

74 
	`Ârötf
(
°dîr
, "Lost selectionÅo "

75 "wödow %d\n", 
sc
->
√w_ow√r
);

84 
	}
}

	@demos/nanox/slider.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~<uni°d.h
>

13 
	#MWINCLUDECOLORS


	)

14 
	~"«no-X.h
"

17 
	#WIDTH_IN_TILES
 4

	)

18 
	#HEIGHT_IN_TILES
 4

	)

19 
	#MAX_TILES
 (
WIDTH_IN_TILES
 * 
HEIGHT_IN_TILES
)

	)

20 
	#USE_IMAGE
 1

	)

22 
	gvÆue
[
WIDTH_IN_TILES
][
HEIGHT_IN_TILES
];

23 
	gˇlc_width
, 
	gˇlc_height
;

24 
	gtûe_width
 = 40;

25 
	gtûe_height
 = 40;

27 #i‡
USE_IMAGE


28 * 
	gimage_addr
;

29 
	gusög_image
 = 1;

30 
GR_WINDOW_ID
 
	gimage
;

33 
GR_WINDOW_ID
 
	gma°î
;

34 
GR_WINDOW_ID
 
	gbuâ⁄s
;

35 
GR_WINDOW_ID
 
	gtûes
;

36 
GR_GC_ID
 
	ggc1
;

39 
H™dÀEvíts
();

40 
Re‰eshWödow
();

41 
R™domi£Tûes
();

42 
MoveTûe
();

43 
DøwTûe
();

46 
	$maö
(
¨gc
,**
¨gv
)

48 i‡(
	`GrO≥n
() < 0) {

49 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

50 
	`exô
(1);

53 
gc1
 = 
	`GrNewGC
();

55 #i‡
USE_IMAGE


56 
image
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 300, 0, (
WIDTH_IN_TILES
 * 
tûe_width
),

57 (
HEIGHT_IN_TILES
 * 
tûe_height
), 4, 
BLACK
, 
WHITE
);

59 if(
¨gc
 != 2)

61 
usög_image
 = 0;

64 
image_addr
 = 
	`mÆloc
(4 * (
WIDTH_IN_TILES
 * 
tûe_width
) *

65 (
HEIGHT_IN_TILES
 * 
tûe_height
) );

67 
image
 = 
	`GrNewPixm≠
((
WIDTH_IN_TILES
 * 
tûe_width
),

68 (
HEIGHT_IN_TILES
 * 
tûe_height
), 
image_addr
);

70 
	`GrDøwImageFromFûe
(
image
, 
gc1
, 0, 0,

71 
GR_IMAGE_MAX_SIZE
, GR_IMAGE_MAX_SIZE, 
¨gv
[1], 0);

76 
ˇlc_width
 = 10 + (
WIDTH_IN_TILES
 * 
tûe_width
);

77 
ˇlc_height
 = 15 + 35 + (
HEIGHT_IN_TILES
 * 
tûe_height
);

80 i‡(
ˇlc_width
 < 240) calc_width=240;

81 i‡(
ˇlc_height
 < 320) calc_height=320;

83 
ma°î
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
ˇlc_width
, 
ˇlc_height
, 1, 
RED
, 
WHITE
);

84 
buâ⁄s
 = 
	`GrNewWödow
((
GR_WINDOW_ID
Ë
ma°î
, 5, 5, (
ˇlc_width
 - 5), 35, 1, 
RED
, RED);

86 
tûes
 = 
	`GrNewWödow
((
GR_WINDOW_ID
Ë
ma°î
, (
ˇlc_width
/2Ë- (
WIDTH_IN_TILES
 * 
tûe_width
 /2),

87 45 + ((
ˇlc_height
 - 50)/2Ë- (
HEIGHT_IN_TILES
 * 
tûe_height
 /2),

88 (
WIDTH_IN_TILES
 * 
tûe_width
), (
HEIGHT_IN_TILES
 * 
tûe_height
), 1, 
RED
, RED);

90 
	`GrM≠Wödow
(
ma°î
);

91 
	`GrM≠Wödow
(
buâ⁄s
);

92 
	`GrM≠Wödow
(
tûes
);

95 
	`§™dom
((Ë
	`gëpid
());

97 
	`R™domi£Tûes
();

99 
	`GrSñe˘Evíts
(
ma°î
, 
GR_EVENT_MASK_EXPOSURE
|
GR_EVENT_MASK_CLOSE_REQ
|

100 
GR_EVENT_MASK_KEY_DOWN
);

101 
	`GrSñe˘Evíts
(
buâ⁄s
, 
GR_EVENT_MASK_BUTTON_DOWN
);

102 
	`GrSñe˘Evíts
(
tûes
, 
GR_EVENT_MASK_BUTTON_DOWN
);

104 
	`Re‰eshWödow
();

106 
GR_TRUE
) {

107 
GR_EVENT
 
evít
;

109 
	`GrGëNextEvít
(&
evít
);

110 
	`H™dÀEvíts
(&
evít
);

112 
	}
}

119 
	$H™dÀEvíts
(
GR_EVENT
 *
ï
)

121 
hﬁe_x_pos
, 
hﬁe_y_pos
;

122 
ãmpx
, 
ãmpy
;

124 
ï
->
ty≥
) {

125 
GR_EVENT_TYPE_BUTTON_DOWN
:

126 i‡(
ï
->
buâ⁄
.
wid
 =
buâ⁄s
) {

127 i‡(
ï
->
buâ⁄
.
x
 < (
ˇlc_width
/2)) {

129 
	`R™domi£Tûes
();

130 
	`Re‰eshWödow
();

133 
	`GrClo£
();

134 #i‡
USE_IMAGE


135 i‡(
usög_image
)

136 
	`‰ì
(
image_addr
);

138 
	`exô
(0);

142 i‡(
ï
->
buâ⁄
.
wid
 =
tûes
) {

144 
	`MoveTûe
–()(
ï
->
buâ⁄
.
x
 / 
tûe_width
),

145 ()(
ï
->
buâ⁄
.
y
 / 
tûe_height
) );

149 
GR_EVENT_TYPE_KEY_DOWN
:

150 i‡(
ï
->
key°roke
.
wid
 =
ma°î
) {

151 
hﬁe_x_pos
 = 0;

152 
hﬁe_y_pos
 = 0;

155 
ãmpx
 = 0;Åempx < 
WIDTH_IN_TILES
;Åempx++)

156 
ãmpy
 = 0;Åempy < 
HEIGHT_IN_TILES
;Åempy++)

157 i‡(
vÆue
[
ãmpx
][
ãmpy
] =
MAX_TILES
) {

158 
hﬁe_x_pos
 = 
ãmpx
;

159 
hﬁe_y_pos
 = 
ãmpy
;

162 
ï
->
key°roke
.
ch
) {

165 
MWKEY_CANCEL
:

166 
	`GrClo£
();

167 #i‡
USE_IMAGE


168 i‡(
usög_image
)

169 
	`‰ì
(
image_addr
);

171 
	`exô
(0);

175 
	`R™domi£Tûes
();

176 
	`Re‰eshWödow
();

180 
MWKEY_DOWN
:

181 i‡(
hﬁe_y_pos
 != 0) {

182 
	`MoveTûe
(
hﬁe_x_pos
, 
hﬁe_y_pos
 - 1);

186 
MWKEY_UP
:

187 i‡(
hﬁe_y_pos
 !(
HEIGHT_IN_TILES
-1) ) {

188 
	`MoveTûe
(
hﬁe_x_pos
, 
hﬁe_y_pos
 + 1);

192 
MWKEY_RIGHT
:

193 i‡(
hﬁe_x_pos
 != 0) {

194 
	`MoveTûe
(
hﬁe_x_pos
 - 1, 
hﬁe_y_pos
);

198 
MWKEY_LEFT
:

199 i‡(
hﬁe_x_pos
 !(
WIDTH_IN_TILES
-1) ) {

200 
	`MoveTûe
(
hﬁe_x_pos
 + 1, 
hﬁe_y_pos
);

207 
GR_EVENT_TYPE_EXPOSURE
:

208 
	`Re‰eshWödow
();

210 
GR_EVENT_TYPE_CLOSE_REQ
:

211 
	`GrClo£
();

212 
	`exô
(0);

215 
	}
}

218 
	$Re‰eshWödow
()

220 
xpos
, 
ypos
;

222 
	`GrSëGCF‹eground
(
gc1
, 
WHITE
);

223 
	`GrSëGCBackground
(
gc1
, 
RED
);

226 
	`GrRe˘
(
buâ⁄s
, 
gc1
, 0, 0, (
ˇlc_width
 - 12)/2, 34);

227 
	`GrRe˘
(
buâ⁄s
, 
gc1
, (
ˇlc_width
 - 8)/2, 0, (calc_width - 12)/2, 34);

230 
	`GrText
(
buâ⁄s
, 
gc1
, (
ˇlc_width
 - 10)/4, 22, "Again", 5, 0);

231 
	`GrText
(
buâ⁄s
, 
gc1
, (
ˇlc_width
 - 10)*3/4, 22, "Quit", 4, 0);

233 
	`GrText
(
buâ⁄s
, 
gc1
, 5, 22, "Again", 5, 0);

234 
	`GrText
(
buâ⁄s
, 
gc1
, (
ˇlc_width
 / 2) + 5, 22, "Quit", 4, 0);

238 
ypos
=0; ypos< 
HEIGHT_IN_TILES
; ypos++){

239 
xpos
=0; xpos< 
WIDTH_IN_TILES
; xpos++){

240 
	`DøwTûe
(
xpos
, 
ypos
);

243 
	}
}

246 
	$R™domi£Tûes
()

248 
cou¡
, 
xpos
, 
ypos
;

251 
ypos
=0; ypos< 
HEIGHT_IN_TILES
; ypos++){

252 
xpos
=0; xpos< 
WIDTH_IN_TILES
; xpos++){

253 
vÆue
[
xpos
][
ypos
] = 1 + xpo†+ (
WIDTH_IN_TILES
 * ypos);

258 
xpos
 = 
WIDTH_IN_TILES
 - 1;

259 
ypos
 = 
HEIGHT_IN_TILES
 - 1;

262 
cou¡
=0; cou¡< 
MAX_TILES
 * 1000; count++){

263 
	`øndom
() % 4) {

265 i‡(
ypos
 < 
HEIGHT_IN_TILES
 - 1) {

266 
vÆue
[
xpos
][
ypos
] = value[xpos][ypos+1];

267 
ypos
++;

268 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

272 i‡(
xpos
 > 0) {

273 
vÆue
[
xpos
][
ypos
] = value[xpos - 1][ypos];

274 
xpos
--;

275 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

279 i‡(
ypos
 > 0) {

280 
vÆue
[
xpos
][
ypos
] = value[xpos][ypos - 1];

281 
ypos
--;

282 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

286 i‡(
xpos
 < 
WIDTH_IN_TILES
 - 1) {

287 
vÆue
[
xpos
][
ypos
] = value[xpos + 1][ypos];

288 
xpos
++;

289 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

294 
	}
}

297 
	$MoveTûe
(
xpos
, 
ypos
)

300 i‡(
ypos
 > 0 && 
vÆue
[
xpos
][ypo†- 1] =
MAX_TILES
) {

301 
vÆue
[
xpos
][
ypos
 - 1] = value[xpos][ypos];

302 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

303 
	`DøwTûe
(
xpos
, 
ypos
 - 1);

304 
	`DøwTûe
(
xpos
, 
ypos
);

307 i‡(
xpos
 < (
WIDTH_IN_TILES
 - 1Ë&& 
vÆue
[xpo†+ 1][
ypos
] =
MAX_TILES
) {

308 
vÆue
[
xpos
 + 1][
ypos
] = value[xpos][ypos];

309 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

310 
	`DøwTûe
(
xpos
 + 1, 
ypos
);

311 
	`DøwTûe
(
xpos
, 
ypos
);

314 i‡(
ypos
 < (
HEIGHT_IN_TILES
 - 1Ë&& 
vÆue
[
xpos
][ypo†+ 1] =
MAX_TILES
) {

315 
vÆue
[
xpos
][
ypos
 + 1] = value[xpos][ypos];

316 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

317 
	`DøwTûe
(
xpos
, 
ypos
 + 1);

318 
	`DøwTûe
(
xpos
, 
ypos
);

321 i‡(
xpos
 > 0 && 
vÆue
[xpo†- 1][
ypos
] =
MAX_TILES
) {

322 
vÆue
[
xpos
 - 1][
ypos
] = value[xpos][ypos];

323 
vÆue
[
xpos
][
ypos
] = 
MAX_TILES
;

324 
	`DøwTûe
(
xpos
 - 1, 
ypos
);

325 
	`DøwTûe
(
xpos
, 
ypos
);

329 i‡(
vÆue
[
WIDTH_IN_TILES
 - 1][
HEIGHT_IN_TILES
 - 1] =
MAX_TILES
) {

330 
wö√r
 = 0;

331 
ypos
=0; ypos< 
HEIGHT_IN_TILES
; ypos++){

332 
xpos
=0; xpos< 
WIDTH_IN_TILES
; xpos++){

333 i‡(
vÆue
[
xpos
][
ypos
] =
wö√r
 + 1)

334 
wö√r
++;

336 
wö√r
=0;

339 i‡(
wö√r
 =
MAX_TILES
) {

341 
lo›
 = 
MAX_TILES
;

342 
lo›
=0;Üo› < 
MAX_TILES
;Üoop++) {

343 
wö√r
=0; wö√∏< (
MAX_TILES
 - 
lo›
) ; winner++) {

346 
xpos
 = 
wö√r
 % 
WIDTH_IN_TILES
;

347 
ypos
 = ()(
wö√r
/
WIDTH_IN_TILES
);

348 
vÆue
[
xpos
][
ypos
] = 
lo›
 + 
wö√r
 + 1;

349 
	`DøwTûe
(
wö√r
 % 
WIDTH_IN_TILES
, ()(winner/WIDTH_IN_TILES));

351 
	`GrFlush
();

352 
wö√r
=0; winner < 10000000 ; winner++);

356 
	`GrSëGCF‹eground
(
gc1
, 
WHITE
);

357 
	`GrSëGCBackground
(
gc1
, 
RED
);

358 
	`GrText
(
tûes
, 
gc1
, ((
WIDTH_IN_TILES
 * 
tûe_width
)/2Ë- 40, (
HEIGHT_IN_TILES
 * 
tûe_height
)/2, "Well Done!!", -1, 0);

362 
	}
}

366 
	$DøwTûe
(
xpos
, 
ypos
)

368 
ãxt
[]="00";

371 
	`GrSëGCF‹eground
(
gc1
, 
RED
);

372 
	`GrFûlRe˘
(
tûes
, 
gc1
, (
xpos
* 
tûe_width
), (
ypos
*
tûe_height
),Åile_width,Åile_height);

374 i‡(
vÆue
[
xpos
][
ypos
] !
MAX_TILES
 ) {

376 
	`GrSëGCF‹eground
(
gc1
, 
WHITE
);

377 
	`GrSëGCBackground
(
gc1
, 
RED
);

378 
	`GrRe˘
(
tûes
, 
gc1
, (
xpos
*
tûe_width
), (
ypos
*
tûe_height
),Åile_width,Åile_height);

380 #i‡
USE_IMAGE


381 i‡(
usög_image
) {

383 
	`GrC›yAªa
(
tûes
, 
gc1
, 1 + (
xpos
*
tûe_width
), 1 + (
ypos
*
tûe_height
),

384 
tûe_width
 - 2, 
tûe_height
 - 2, 
image
,

385 1 + (((
vÆue
[
xpos
][
ypos
] - 1Ë% 
WIDTH_IN_TILES
Ë* 
tûe_width
),

386 1 + ((()(
vÆue
[
xpos
][
ypos
] - 1Ë/ 
WIDTH_IN_TILES
Ë* 
tûe_height
), 0);

390 i‡(
vÆue
[
xpos
][
ypos
] > 9)

391 
ãxt
[0] = 48 + ()(
vÆue
[
xpos
][
ypos
]/10);

393 
ãxt
[0] = 32;

395 
ãxt
[1] = 48 + 
vÆue
[
xpos
][
ypos
] % 10;

397 
	`GrText
(
tûes
, 
gc1
, (
xpos
*
tûe_width
Ë+ (tûe_width /2Ë- 5, (
ypos
*
tûe_height
Ë+ (tûe_height/2Ë+ 5, &
ãxt
, -1, 0);

398 #i‡
USE_IMAGE


402 
	}
}

	@demos/nanox/snap_jpg.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<î∫o.h
>

7 
	~<°rög.h
>

8 
	~<«no-X.h
>

9 
	~<j≥glib.h
>

12 
	#PIXEL888TOCOLORVAL
(
p
) \

13 ((((
p
Ë& 0xff0000Ë>> 16Ë| (’Ë& 0xff00Ë| ((’Ë& 0xffË<< 16))

	)

16 
	#PIXEL565TOCOLORVAL
(
p
) \

17 ((((
p
Ë& 0xf800Ë>> 8Ë| ((’Ë& 0x07e0Ë<< 5Ë| ((’Ë& 0x1fË<< 19))

	)

19 
	#PIXEL555TOCOLORVAL
(
p
) \

20 ((((
p
Ë& 0x7c00Ë>> 7Ë| ((’Ë& 0x03e0Ë<< 6Ë| ((’Ë& 0x1fË<< 19))

	)

23 
	#PIXEL332TOCOLORVAL
(
p
) \

24 ((((
p
Ë& 0xe0)Ë| ((’Ë& 0x1cË<< 11Ë| ((’Ë& 0x03Ë<< 19))

	)

28 
	$ßve_image
(*
fb
, 
GR_WINDOW_FB_INFO
 * 
öfo
, *
fûe
)

30 
y
;

31 
FILE
 *
Â
;

32 
cﬁ‹vÆ
 = 0;

33 
j≥g_com¥ess_°ru˘
 
cöfo
;

34 
j≥g_îr‹_mgr
 
jîr
;

36 
Â
 = 
	`f›í
(
fûe
, "wb");

37 i‡(!
Â
) {

38 
	`Ârötf
(
°dîr
, "Bad fileÇame (error [%s])\n",

39 
	`°ªº‹
(
î∫o
));

43 
cöfo
.
îr
 = 
	`j≥g_°d_îr‹
(&
jîr
);

45 
	`j≥g_¸óã_com¥ess
(&
cöfo
);

46 
	`j≥g_°dio_de°
(&
cöfo
, 
Â
);

48 
cöfo
.
ö_cﬁ‹_•a˚
 = 
JCS_RGB
;

50 
cöfo
.
image_width
 = 
öfo
->
xªs
;

51 
cöfo
.
image_height
 = 
öfo
->
yªs
;

53 
cöfo
.
öput_comp⁄íts
 = 3;

54 
	`j≥g_£t_deÁu…s
(&
cöfo
);

56 
	`j≥g_°¨t_com¥ess
(&
cöfo
, 
TRUE
);

58 
y
 = 0; y < 
öfo
->
yªs
; y++) {

59 
JSAMPROW
 
row
[1];

61 
x
;

62 *
de°
 = 
	`Æloˇ
(
öfo
->
xªs
 * 3);

64 *
±r
 = 
de°
;

65 *
ch
 = (
fb
 + (
y
 * 
öfo
->
pôch
));

67 
x
 = 0; x < 
öfo
->
xªs
; x++) {

68 
öfo
->
bµ
) {

70 
cﬁ‹vÆ
 = 
	`PIXEL332TOCOLORVAL
(*
ch
);

74 
cﬁ‹vÆ
 =

75 
	`PIXEL555TOCOLORVAL
(*((*)
ch
));

80 
cﬁ‹vÆ
 = 
	`PIXEL888TOCOLORVAL
(*((*)
ch
));

84 
±r
[2] = (
cﬁ‹vÆ
 >> 16) & 0xFF;

85 
±r
[1] = (
cﬁ‹vÆ
 >> 8) & 0xFF;

86 
±r
[0] = (
cﬁ‹vÆ
 & 0xFF);

88 
±r
 += 3;

89 
ch
 +
öfo
->
byã•p
;

92 
row
[0] = 
de°
;

93 
	`j≥g_wrôe_sˇ∆öes
(&
cöfo
, 
row
, 1);

96 
	`j≥g_föish_com¥ess
(&
cöfo
);

97 
	`j≥g_de°roy_com¥ess
(&
cöfo
);

98 
	`f˛o£
(
Â
);

101 
	}
}

104 
	$maö
(
¨gc
, **
¨gv
)

106 
GR_WINDOW_FB_INFO
 
fböfo
;

107 *
fb
;

109 i‡(
¨gc
 < 2) {

110 
	`¥ötf
("Usage: snap_jpg <filename>\n");

114 i‡(
	`GrO≥n
() == -1) {

115 
	`Ârötf
(
°dîr
, "Error -Åhe Nano-X server isÇotÑunning\n");

119 
	`¥ötf
("TakögÅhêpi˘uªánd st‹ög iàö [%s]\n", 
¨gv
[1]);

121 
fb
 = 
	`GrO≥nClõ¡Fømebuf„r
();

123 i‡(!
fb
) {

124 
	`Ârötf
(
°dîr
,

129 
	`GrGëWödowFBInfo
(
GR_ROOT_WINDOW_ID
, &
fböfo
);

131 i‡(
	`ßve_image
(
fb
, &
fböfo
, 
¨gv
[1]) == -1)

132 
	`¥ötf
("Error!\n");

134 
	`¥ötf
("Su˚ssfuŒy saved [%s]\n", 
¨gv
[1]);

136 
	`GrClo£Clõ¡Fømebuf„r
();

137 
	`GrClo£
();

139 
	}
}

	@demos/nanox/snap_ppm.c

37 
	~<°dio.h
>

38 
	~<î∫o.h
>

39 
	~<°rög.h
>

40 
	~<uni°d.h
>

41 
	~<°dlib.h
>

43 
	~<«no-X.h
>

45 
	s¢≠_°©e
 {

46 *
	mouäame
;

47 
GR_PIXELVAL
 *
	mpixñs
;

48 
GR_SCREEN_INFO
 
	msöfo
;

50 
¢≠_°©e
 
	t¢≠°©e
;

52 
	$oom
()

54 
	`Ârötf
(
°dîr
, "Out of memory\n");

55 
	}
}

57 
¢≠°©e
 *
	$öô
(
¨gc
, *
¨gv
[])

59 
¢≠°©e
 *
°©e
;

61 if(
¨gc
 != 2) {

62 
	`Ârötf
(
°dîr
, "Usage: snap output.ppm\n");

63  
NULL
;

66 if(
	`GrO≥n
() < 0) {

67 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

68  
NULL
;

71 if(!(
°©e
 = 
	`mÆloc
((
¢≠°©e
)))) {

72 
	`oom
();

73  
NULL
;

76 
°©e
->
ouäame
 = 
¨gv
[1];

78 
	`GrGëS¸ìnInfo
(&
°©e
->
söfo
);

80 if(!(
°©e
->
pixñs
 = 
	`mÆloc
((
GR_PIXELVAL
Ë* sèã->
söfo
.
rows


81 * 
°©e
->
söfo
.
cﬁs
))) {

82 
	`‰ì
(
°©e
);

83 
	`oom
();

84  
NULL
;

87 (
°©e
);

88 
	}
}

90 
	$wrôeout
(
¢≠°©e
 *
°©e
)

92 
FILE
 *
Â
;

93 
x
, 
y
;

94 
rgb
[3], *
µ
;

95 
GR_PALETTE
 *
∑Àâe
 = 
NULL
;

97 if(!(
Â
 = 
	`f›í
(
°©e
->
ouäame
, "w"))) {

98 
	`Ârötf
(
°dîr
, "Couldn't open output file \"%s\": %s\n",

99 
°©e
->
ouäame
, 
	`°ªº‹
(
î∫o
));

103 if(
	`Ârötf
(
Â
, "P6\n%d %d\n255\n", 
°©e
->
söfo
.
cﬁs
, sèã->söfo.
rows
)

105 
badwrôe
;

107 if(
°©e
->
söfo
.
pixty≥
 =
MWPF_PALETTE
) {

108 if(!(
∑Àâe
 = 
	`mÆloc
((
GR_PALETTE
)))) {

109 
	`oom
();

112 
	`GrGëSy°emPÆëã
(
∑Àâe
);

115 
y
 = 0; y < 
°©e
->
söfo
.
rows
; y++) {

116 
x
 = 0; x < 
°©e
->
söfo
.
cﬁs
; x++) {

118 
µ
 = (*)
°©e
->
pixñs
 +

119 ((
x
 + (
y
 * 
°©e
->
söfo
.
cﬁs
)) *

120 (
GR_PIXELVAL
));

122 
°©e
->
söfo
.
pixty≥
) {

124 
MWPF_TRUECOLOR0888
:

125 
MWPF_TRUECOLOR888
:

126 
rgb
[0] = 
µ
[2];

127 
rgb
[1] = 
µ
[1];

128 
rgb
[2] = 
µ
[0];

130 
MWPF_PALETTE
:

131 
rgb
[0] = 
∑Àâe
->∑Àâe[
µ
[0]].
r
;

132 
rgb
[1] = 
∑Àâe
->∑Àâe[
µ
[0]].
g
;

133 
rgb
[2] = 
∑Àâe
->∑Àâe[
µ
[0]].
b
;

135 
MWPF_TRUECOLOR565
:

136 
rgb
[0] = 
µ
[1] & 0xf8;

137 
rgb
[1] = ((
µ
[1] & 0x07) << 5) |

138 ((
µ
[0] & 0xe0) >> 3);

139 
rgb
[2] = (
µ
[0] & 0x1f) << 3;

141 
MWPF_TRUECOLOR555
:

142 
rgb
[0] = (
µ
[1] & 0x7c) << 1;

143 
rgb
[1] = ((
µ
[1] & 0x03) << 6) |

144 ((
µ
[0] & 0xe0) >> 2);

145 
rgb
[2] = (
µ
[0] & 0x1f) << 3;

147 
MWPF_TRUECOLOR332
:

148 
rgb
[0] = 
µ
[0] & 0xe0;

149 
rgb
[1] = (
µ
[0] & 0x1c) << 3;

150 
rgb
[2] = (
µ
[0] & 0x03) << 6;

153 
	`Ârötf
(
°dîr
, "UnsupportedÖixel "

155 
	`f˛o£
(
Â
);

159 if(
	`fwrôe
(
rgb
, 3, 1, 
Â
Ë< 0Ë
badwrôe
;

163 
	`f˛o£
(
Â
);

164 if(
∑Àâe
Ë
	`‰ì
(palette);

167 
badwrôe
:

168 
	`Ârötf
(
°dîr
, "Eº‹ wrôögÅÿouçuàfûe: %s\n", 
	`°ªº‹
(
î∫o
));

169 
	`f˛o£
(
Â
);

170 if(
∑Àâe
Ë
	`‰ì
(palette);

172 
	}
}

174 
	$˛ónup
(
¢≠°©e
 *
°©e
)

176 if(
°©e
) {

177 if(
°©e
->
pixñs
Ë
	`‰ì
(state->pixels);

178 
	`‰ì
(
°©e
);

180 
	`GrClo£
();

181 
	}
}

183 
	$maö
(
¨gc
, *
¨gv
[])

185 
ªt
 = 0;

186 
¢≠°©e
 *
°©e
 = 
NULL
;

188 if((
°©e
 = 
	`öô
(
¨gc
, 
¨gv
))) {

189 
	`GrRódAªa
(
GR_ROOT_WINDOW_ID
, 0, 0, 
°©e
->
söfo
.
cﬁs
,

190 
°©e
->
söfo
.
rows
, sèã->
pixñs
);

191 if(
	`wrôeout
(
°©e
)Ë
ªt
 = 2;

192 } 
ªt
 = 1;

194 
	`˛ónup
(
°©e
);

195  
ªt
;

196 
	}
}

	@demos/nanox/t1demo.c

12 
	~<°dio.h
>

13 
	~<°dlib.h
>

14 #i‡
UNIX
 | 
DOS_DJGPP


15 
	~<time.h
>

17 
	#MWINCLUDECOLORS


	)

18 
	~"«no-X.h
"

20 
	#CLIP_POLYGON
 0

	)

21 
	#HZKBIG5
 1

	)

23 
	#WIDTH
 340

	)

24 
	#HEIGHT
 340

	)

26 #i‡
HAVE_EUCJP_SUPPORT


27 
	#MAXFONTS
 4

	)

28 
	#FONT1
 "k12x10.‚t"

	)

29 
	#FONT2
 "k12x12.‚t"

	)

30 
	#FONT3
 "k16x16.‚t"

	)

31 
	#FONT4
 "k24x24.‚t"

	)

32 
	#FONT5
 ""

	)

33 #ñi‡
HAVE_HZK_SUPPORT


34 
	#MAXFONTS
 1

	)

35 
	#FONT1
 "HZXFONT"

	)

36 
	#FONT2
 ""

	)

37 
	#FONT3
 ""

	)

38 
	#FONT4
 ""

	)

39 
	#FONT5
 ""

	)

40 #ñi‡
HAVE_T1LIB_SUPPORT


41 
	#MAXFONTS
 5

	)

42 
	#FONT1
 "bchr"

	)

43 
	#FONT2
 "bchb"

	)

44 
	#FONT3
 "d¸10"

	)

45 
	#FONT4
 "dcbx10"

	)

46 
	#FONT5
 "bchri"

	)

47 #ñi‡
HAVE_FREETYPE_SUPPORT


48 
	#MAXFONTS
 5

	)

49 
	#FONT1
 "…1-r-omega-£rif"

	)

50 
	#FONT2
 "¨ül"

	)

51 
	#FONT3
 "times"

	)

52 
	#FONT4
 "cour"

	)

53 
	#FONT5
 "timesi"

	)

54 #ñi‡
HAVE_PCF_SUPPORT


55 
	#MAXFONTS
 5

	)

56 
	#FONT1
 "7x14.pcf.gz"

	)

57 
	#FONT2
 "9x15.pcf.gz"

	)

58 
	#FONT3
 "hñvB12.pcf.gz"

	)

59 
	#FONT4
 "jisk™24.pcf.gz"

	)

60 
	#FONT5
 "gb24°.pcf.gz"

	)

61 #ñi‡
HAVE_BIG5_SUPPORT
 | 
HAVE_GB2312_SUPPORT
 | 
HAVE_JISX0213_SUPPORT
 | 
HAVE_KSC5601_SUPPORT


62 
	#MAXFONTS
 5

	)

63 
	#FONT1
 ""

	)

64 
	#FONT2
 ""

	)

65 
	#FONT3
 ""

	)

66 
	#FONT4
 ""

	)

67 
	#FONT5
 ""

	)

68 #ñi‡
HAVE_FNT_SUPPORT


69 
	#MAXFONTS
 5

	)

70 
	#FONT1
 "/tmp/hñvB12.‚t"

	)

71 
	#FONT2
 "/tmp/˛R6x8.‚t"

	)

72 
	#FONT3
 "/tmp/jisk™24.‚t"

	)

73 
	#FONT4
 "/tmp/jisk™16-2000-1.‚t"

	)

74 
	#FONT5
 "/tmp/gbk16-xke.‚t"

	)

76 
	#MAXFONTS
 5

	)

77 
	#FONT1
 ""

	)

78 
	#FONT2
 ""

	)

79 
	#FONT3
 ""

	)

80 
	#FONT4
 ""

	)

81 
	#FONT5
 ""

	)

84 
	#RAND
(
max
Ë((Ë((()(max)Ë* 
	`ønd
(Ë/ (
RAND_MAX
 + 1.0)))

	)

86 *
	g«mes
[5] = { 
FONT1
, 
FONT2
, 
FONT3
, 
FONT4
, 
FONT5
 };

89 
	$maö
(
ac
, **
av
)

91 
GR_WINDOW_ID
 
wödow
;

92 
GR_GC_ID
 
gc
;

93 
GR_FONT_ID
 
f⁄tid
;

94 
x
, 
y
, 
‚um
;

95 
GR_REGION_ID
 
ªgi⁄id
;

96 #i‡
CLIP_POLYGON


97 
GR_POINT
 
poöts
[] = { {20, 20}, {300, 20}, {300, 300}, {20, 300} };

99 
GR_RECT
 
˛ù_ª˘
 = { 20, 20, 300, 300 };

102 i‡(
	`GrO≥n
() < 0)

103 
	`exô
(1);

105 
wödow
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
,

107 
GR_ROOT_WINDOW_ID
, 50, 50, 
WIDTH
, 
HEIGHT
, 
BLACK
);

108 
	`GrSñe˘Evíts
(
wödow
,

109 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

110 
	`GrM≠Wödow
(
wödow
);

112 
gc
 = 
	`GrNewGC
();

113 
	`GrSëGCU£Background
(
gc
, 
GR_FALSE
);

114 
	`GrSëGCBackground
(
gc
, 
BLACK
);

116 #i‡
CLIP_POLYGON


118 
ªgi⁄id
 = 
	`GrNewPﬁyg⁄Regi⁄
(
MWPOLY_EVENODD
, 3, 
poöts
);

121 
ªgi⁄id
 = 
	`GrNewRegi⁄
();

122 
	`GrUni⁄Re˘WôhRegi⁄
(
ªgi⁄id
, &
˛ù_ª˘
);

124 
	`GrSëGCRegi⁄
(
gc
, 
ªgi⁄id
);

126 
	`§™d
(
	`time
(0));

128 
GR_EVENT
 
evít
;

130 
	`GrCheckNextEvít
(&
evít
);

131 i‡(
evít
.
ty≥
 =
GR_EVENT_TYPE_CLOSE_REQ
) {

132 
	`GrClo£
();

133 
	`exô
(0);

136 
f⁄tid
 = 
	`GrCª©eF⁄t
(
«mes
[
‚um
=
	`RAND
(
MAXFONTS
)], 0, 
NULL
);

137 
	`GrSëF⁄tSize
(
f⁄tid
, 
	`RAND
(80) + 1);

138 
	`GrSëF⁄tRŸ©i⁄
(
f⁄tid
, 330);

139 
	`GrSëF⁄tAâr
(
f⁄tid
, 
GR_TFKERNING
 | 
GR_TFANTIALIAS
, 0);

140 
	`GrSëGCF⁄t
(
gc
, 
f⁄tid
);

142 
	`GrSëGCF‹eground
(
gc
, 
	`ønd
() & 0xffffff);

145 
x
 = 
	`RAND
(
WIDTH
);

146 
y
 = 
	`RAND
(
HEIGHT
);

148 #i‡
HAVE_HZK_SUPPORT


150 #i‡
HZKBIG5


152 
buf„r
[] = {

155 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, 
buf„r
, 7, 
GR_TFUC16
);

158 
x
 = 
	`RAND
(
WIDTH
);

159 
y
 = 
	`RAND
(
HEIGHT
);

160 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
,

161 "Mi¸owödows,≈w™Ô®œ•Œ§§≠^§Â¬I∞}¶r≈È", -1, 
GR_TFASCII
);

164 
x
 = 
	`RAND
(
WIDTH
);

165 
y
 = 
	`RAND
(
HEIGHT
);

166 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "£t£u£v£w£∏£π£∫", -1, 
GR_TFASCII
);

170 
buf„r
[] = {

182 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, 
buf„r
, 9, 
GR_TFUC16
);

185 
x
 = 
	`RAND
(
WIDTH
);

186 
y
 = 
	`RAND
(
HEIGHT
);

187 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
,

188 "Mi¸owödows,ª∂”≠ π”√÷–”¢Œƒµ„’Û◊÷ÃÂ", -1, 
GR_TFASCII
);

191 #ñi‡
HAVE_BIG5_SUPPORT


193 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "\151\261\144\261\144\151", 6, 
MWTF_DBCS_BIG5
);

194 #ñi‡
HAVE_GB2312_SUPPORT


196 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "\275\241\275\241", 4, 
MWTF_DBCS_GB
);

197 #ñi‡
HAVE_EUCJP_SUPPORT


199 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "\242\241", 2, 
MWTF_DBCS_EUCJP
);

200 #ñi‡
HAVE_JISX0213_SUPPORT


202 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "\242\241", 2, 
MWTF_DBCS_JIS
);

203 #ñi‡
HAVE_KSC5601_SUPPORT


205 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "\273\273", 2, 
MWTF_DBCS_KSC
);

206 #ñi‡
HAVE_FREETYPE_SUPPORT


208 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "Mi¸owödows", -1, 
GR_TFASCII
);

209 #ñi‡
HAVE_PCF_SUPPORT


212 i‡(
‚um
 == 3) {

214 
ãxt
[] =

216 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, 
ãxt
, 5, 
GR_TFUC16
);

217 } i‡(
‚um
 == 4) {

219 
ãxt
[] =

223 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, 
ãxt
, 5, 
GR_TFUC16
);

225 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, "Mi¸owödows", -1, 
GR_TFASCII
);

226 #ñi‡
HAVE_FNT_SUPPORT


228 i‡(
‚um
 == 2 || fnum == 3) {

230 
ãxt
[] =

232 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, 
ãxt
, 5, 
GR_TFUC16
);

233 } i‡(
‚um
 == 4) {

235 
ãxt
[] =

237 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, 
ãxt
, 5, 
GR_TFUC16
);

239 
	`GrText
(
wödow
, 
gc
, 
x
,
y
, "Mi¸owödows", -1, 
GR_TFASCII
);

242 
	`GrText
(
wödow
, 
gc
, 
x
, 
y
, "Mi¸owödows", -1, 
GR_TFASCII
);

244 
	`GrFlush
();

245 
	`GrDe°royF⁄t
(
f⁄tid
);

247 
	`GrDe°royRegi⁄
(
ªgi⁄id
);

248 
	`GrClo£
();

250 
	}
}

	@demos/nanox/tsdemo.c

4 
	#MWINCLUDECOLORS


	)

5 
	~<°dlib.h
>

6 
	~"«no-X.h
"

8 
	#_
 ((Ë0Ë

	)

9 
	#X
 ((Ë1Ë

	)

12 
GR_BITMAP
 
	gg_°ù∂e1
[] = {

22 
GR_BITMAP
 
	gg_°ù∂e2
[] = {

27 
GR_BITMAP
 
	gg_°ù∂e3
[] = {

32 #ifde‡
NOTUSED


33 
GR_BITMAP
 
	gg_°ù∂e4
[] = {

41 
GR_BITMAP
 
	gg_°ù∂e1
[] = {

51 
GR_BITMAP
 
	gg_°ù∂e2
[] = {

56 
GR_BITMAP
 
	gg_°ù∂e3
[] = {

61 
GR_BITMAP
 
	gg_°ù∂e4
[] = {

70 
	gg_x
;

71 
GR_WINDOW_ID
 
	gg_maö
, 
	gg_pixm≠
;

74 
	$døw_£t
(*
«me
, 
mode
)

76 
x
;

77 
tw
, 
th
, 
tb
;

78 
GR_POINT
 
poöts
[4];

79 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

81 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

82 
	`GrSëGCBackground
(
gc
, 
GRAY
);

84 
	`GrGëGCTextSize
(
gc
, 
«me
, -1, 
GR_TFTOP
, &
tw
, &
th
, &
tb
);

86 
x
 = 
g_x
 + (
tw
 - 50) / 2;

88 
	`GrText
(
g_maö
, 
gc
, 
g_x
, 5, 
«me
, -1, 
GR_TFTOP
);

90 
g_x
 +(
tw
 + 10);

92 
	`GrSëGCFûlMode
(
gc
, 
mode
);

94 i‡(
mode
 =
GR_FILL_STIPPLE
)

95 
	`GrSëGCF‹eground
(
gc
, 
YELLOW
);

97 
	`GrSëGCF‹eground
(
gc
, 
WHITE
);

98 
	`GrSëGCBackground
(
gc
, 
BLUE
);

101 i‡(
mode
 =
GR_FILL_TILE
) {

102 
	`GrSëGCTûe
(
gc
, 
g_pixm≠
, 16, 16);

105 i‡(
mode
 =
GR_FILL_STIPPLE
 || modê=
GR_FILL_OPAQUE_STIPPLE
)

106 
	`GrSëGCStù∂e
(
gc
, 
g_°ù∂e2
, 2, 2);

108 
	`GrFûlRe˘
(
g_maö
, 
gc
, 
x
, 25, 50, 50);

110 i‡(
mode
 =
GR_FILL_STIPPLE
 || modê=
GR_FILL_OPAQUE_STIPPLE
)

111 
	`GrSëGCStù∂e
(
gc
, 
g_°ù∂e1
, 7, 7);

113 
	`GrFûlEŒù£
(
g_maö
, 
gc
, 
x
 + 25, 105, 25, 25);

115 i‡(
mode
 =
GR_FILL_STIPPLE
 || modê=
GR_FILL_OPAQUE_STIPPLE
)

116 
	`GrSëGCStù∂e
(
gc
, 
g_°ù∂e3
, 3, 2);

118 
poöts
[0].
x
 =Öoints[3].x = x;

119 
poöts
[0].
y
 =Öoints[3].y = 165;

121 
poöts
[1].
x
 = x + 50;

122 
poöts
[1].
y
 = 165;

124 
poöts
[2].
x
 = x + 25;

125 
poöts
[2].
y
 = 215;

127 
	`GrFûlPﬁy
(
g_maö
, 
gc
, 4, 
poöts
);

129 
	`GrDe°royGC
(
gc
);

130 
	}
}

133 
	$lﬂd_pixm≠
()

135 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

137 
g_pixm≠
 = 
	`GrNewPixm≠
(16, 16, 0);

138 
	`GrDøwImageFromFûe
(
g_pixm≠
, 
gc
, 0, 0, -1, -1, "bin/nxroach.pgm", 0);

140 
	`GrDe°royGC
(
gc
);

141 
	}
}

144 
	$maö
(
¨gc
, **
¨gv
)

146 
COLS
, 
ROWS
;

148 i‡(
	`GrO≥n
() == -1)

149 
	`exô
(1);

151 
COLS
 = 480;

152 
ROWS
 = 300;

154 
	`lﬂd_pixm≠
();

156 
g_maö
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
, "tsdemo",

157 
GR_ROOT_WINDOW_ID
, 100, 50, 
COLS
 - 120, 
ROWS
 - 60, 
GRAY
);

159 
	`GrSñe˘Evíts
(
g_maö
,

160 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

161 
	`GrM≠Wödow
(
g_maö
);

164 
GR_EVENT
 
evít
;

166 
	`GrGëNextEvít
(&
evít
);

168 
evít
.
ty≥
) {

169 
GR_EVENT_TYPE_EXPOSURE
:

170 
g_x
 = 5;

171 
	`døw_£t
("GR_FILL_STIPPLE", 
GR_FILL_STIPPLE
);

172 
	`døw_£t
("GR_FILL_OPAQUE_STIPPLE", 
GR_FILL_OPAQUE_STIPPLE
);

173 
	`døw_£t
("GR_FILL_TILE", 
GR_FILL_TILE
);

176 
GR_EVENT_TYPE_CLOSE_REQ
:

177 
	`GrClo£
();

178 
	`exô
(0);

181 
	}
}

	@demos/nanox/tux.c

35 
	~<°dio.h
>

36 
	~<°dlib.h
>

37 
	~<«no-X.h
>

38 
	~<nxcﬁ‹s.h
>

39 
	~"tuxmask.h
"

41 
	#DEFAULT_TUX_FILE
 "bö/tux.gif"

	)

43 
	gbuâ⁄_down
 = 0, 
	gx
 = 0, 
	gy
 = 0;

45 
GR_WINDOW_ID
 
	$öô
(*
tuxfûe
)

47 
GR_GC_ID
 
gc
;

48 
GR_IMAGE_ID
 
iid
;

49 
GR_WINDOW_ID
 
wid
;

50 
GR_REGION_ID
 
rid
;

51 
GR_WINDOW_ID
 
pid
;

52 
GR_IMAGE_INFO
 
iif
;

53 
GR_WM_PROPERTIES
 
¥›s
;

54 
GR_SCREEN_INFO
 
söfo
;

55 
x
, 
y
;

57 if(
	`GrO≥n
() < 0) {

58 #i‡! 
PSP


59 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

63 
	`GrGëS¸ìnInfo
(&
söfo
);

65 if(!(
iid
 = 
	`GrLﬂdImageFromFûe
(
tuxfûe
, 0))) {

66 #i‡! 
PSP


67 
	`Ârötf
(
°dîr
, "FaûedÅÿlﬂd imagêfûê\"%s\"\n", 
tuxfûe
);

71 
	`GrGëImageInfo
(
iid
, &
iif
);

72 
pid
 = 
	`GrNewPixm≠
(
iif
.
width
, iif.
height
, 
NULL
);

73 
gc
 = 
	`GrNewGC
();

74 
	`GrDøwImageToFô
(
pid
, 
gc
, 0, 0, 
iif
.
width
, iif.
height
, 
iid
);

75 
	`GrDe°royGC
(
gc
);

76 
	`GrFªeImage
(
iid
);

78 
x
 = 
söfo
.
cﬁs
 - 
iif
.
width
;

79 
y
 = 
söfo
.
rows
 - 
iif
.
height
;

80 
wid
 = 
	`GrNewWödowEx
(
GR_WM_PROPS_APPWINDOW
|
GR_WM_PROPS_NOAUTOMOVE
, 
NULL
,

81 
GR_ROOT_WINDOW_ID
, 
x
, 
y
, 
iif
.
width
, iif.
height
, 
GR_COLOR_GREEN
);

83 
	`GrSëBackgroundPixm≠
(
wid
, 
pid
, 
GR_BACKGROUND_TOPLEFT
);

85 
rid
 = 
	`GrNewBôm≠Regi⁄
(
tuxmask_bôs
, 
TUXMASK_WIDTH
, 
TUXMASK_HEIGHT
);

86 
	`GrSëWödowRegi⁄
(
wid
, 
rid
, 
GR_WINDOW_BOUNDING_MASK
);

87 
	`GrDe°royRegi⁄
(
rid
);

89 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

90 
¥›s
.¥›†
GR_WM_PROPS_NODECORATE
;

91 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
);

93 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_CLOSE_REQ
 |

94 
GR_EVENT_MASK_MOUSE_POSITION
 |

95 
GR_EVENT_MASK_BUTTON_UP
 |

96 
GR_EVENT_MASK_BUTTON_DOWN
);

98 
	`GrM≠Wödow
(
wid
);

100  
wid
;

101 
	}
}

103 
	$buâ⁄_evít
(
GR_EVENT_BUTTON
 *
ev
)

105 if(
ev
->
ty≥
 =
GR_EVENT_TYPE_BUTTON_DOWN
) {

106 if(
ev
->
buâ⁄s
 & 
GR_BUTTON_R
) {

107 
	`GrClo£
();

108 
	`exô
(0);

110 
buâ⁄_down
 = 1;

111 
x
 = 
ev
->x;

112 
y
 = 
ev
->y;

113 
	`GrRai£Wödow
(
ev
->
wid
);

114 } 
buâ⁄_down
 = 0;

115 
	}
}

117 
	$posôi⁄_evít
(
GR_EVENT_MOUSE
 *
ev
)

119 
√wx
 = 0, 
√wy
 = 0, 
ﬁdx
 = 0, 
ﬁdy
 = 0;

121 if(!
buâ⁄_down
) ;

123 
√wx
 = 
ev
->
roŸx
 - 
x
;

124 
√wy
 = 
ev
->
roŸy
 - 
y
;

126 if(
√wx
 !
ﬁdx
 || 
√wy
 !
ﬁdy
) {

127 
	`GrMoveWödow
(
ev
->
wid
, 
√wx
, 
√wy
);

128 
ﬁdx
 = 
√wx
;

129 
ﬁdy
 = 
√wy
;

131 
	}
}

133 
	$maö
(
¨gc
, *
¨gv
[])

135 *
tuxfûe
;

136 
GR_EVENT
 
evít
;

137 
GR_WINDOW_ID
 
wid
;

139 if(
¨gc
 >2Ë
tuxfûe
 = 
¨gv
[1];

140 
tuxfûe
 = 
DEFAULT_TUX_FILE
;

142 if(!(
wid
 = 
	`öô
(
tuxfûe
)))  1;

145 
	`GrGëNextEvít
(&
evít
);

146 
evít
.
ty≥
) {

147 
GR_EVENT_TYPE_CLOSE_REQ
:

150 
GR_EVENT_TYPE_MOUSE_POSITION
:

151 
	`posôi⁄_evít
(&
evít
.
mou£
);

153 
GR_EVENT_TYPE_BUTTON_UP
:

154 
GR_EVENT_TYPE_BUTTON_DOWN
:

155 
	`buâ⁄_evít
(&
evít
.
buâ⁄
);

163 
	}
}

	@demos/nanox/tuxmask.h

8 
	#TUXMASK_WIDTH
 80

	)

9 
	#TUXMASK_HEIGHT
 94

	)

11 
GR_BITMAP
 
	gtuxmask_bôs
[] = {

	@demos/nanox/wait.c

6 
	~"«no-X.h
"

8 
	$maö
()

10 
c
;

11 
	`ªad
(
	`GrO≥n
(), &
c
, 1);

13 
	}
}

	@demos/nanox/world.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	#MWINCLUDECOLORS


	)

12 
	~"«no-X.h
"

14 #i‡
deföed
(
MSDOS
Ë|| deföed(
__ECOS
)

15 
	~<f˙é.h
>

18 #i‡
deföed
(
__FªeBSD__
)

19 
	~<uni°d.h
>

20 
	~<sys/ty≥s.h
>

21 
	~<f˙é.h
>

24 #i‡
LINUX
 || 
DOS_DJGPP
 || 
deföed
(
__CYGWIN__
)

25 
	~<sys/ty≥s.h
>

26 
	~<sys/°©.h
>

27 
	~<f˙é.h
>

28 
	~<uni°d.h
>

31 #i‚de‡
O_BINARY


32 
	#O_BINARY
 0

	)

35 #i‡
deföed
(
DOS_DJGPP
Ë|| deföed(
__ECOS
)

36 
	#MAPFILE
 "/w‹ld.m≠"

	)

38 
	#MAPFILE
 "demos/«nox/w‹ld.m≠"

	)

41 
	#SELECTBUTTON
 
GR_BUTTON_L


	)

42 
	#COORDBUTTON
 
GR_BUTTON_R


	)

48 
	tFLOAT
;

50 
	#SCALE
 100

	)

52 
	#FFMUL
(
a
,
b
Ë(((
FLOAT
)◊Ë* (bË+ (
SCALE
 / 2)Ë/ SCALE)

	)

53 
	#FFDIV
(
a
,
b
Ë(((
FLOAT
)◊Ë* 
SCALE
Ë/ (b))

	)

54 
	#FIMUL
(
a
,
b
Ë((
FLOAT
)◊Ë* (b))

	)

55 
	#FIDIV
(
a
,
b
Ë((
FLOAT
)◊Ë/ (b))

	)

56 
	#ITOF
(
a
Ë((
FLOAT
)◊Ë* 
SCALE
)

	)

57 
	#FTOI
(
a
Ë(((
FLOAT
)◊Ë+ (
SCALE
 / 2)Ë/ SCALE)

	)

60 
	#QSPAN
 (90L*60*
SCALE
Ë

	)

61 
	#HSPAN
 (
QSPAN
*2Ë

	)

62 
	#WSPAN
 (
QSPAN
*4Ë

	)

64 
	#ABS
(
n
Ë((“Ë< 0Ë? -“Ë: (n))

	)

71 
	mCode
;

72 
	mL©
;

73 
	mL⁄
;

74 } 
	tMWPACKED
 
	tDBPOINT
;

76 #i‡
MW_CPU_BIG_ENDIAN


77 
	#SHORT_SWAP
(
p
Ë’ = (’ & 0xffË<< 8Ë| (’ >> 8Ë& 0xff))

	)

78 
	#DBPOINT_CONVERT
(
p
Ë(
	`SHORT_SWAP
’->
Code
),SHORT_SWAP’->
L©
),SHORT_SWAP’->
L⁄
))

	)

80 
	#DBPOINT_CONVERT
(
p
Ë((Ì)

	)

83 
	#POINTSize
 (
DBPOINT
)

	)

84 
	#PCou¡
 128

	)

94 
FLOAT
 
	gX_SˇÀ
;

95 
FLOAT
 
	gY_SˇÀ
;

100 
FLOAT
 
	gL©ôude
, 
	gL⁄gôude
;

101 
FLOAT
 
	gzoom
;

103 
FLOAT
 
	gœåadius
;

104 
FLOAT
 
	gl⁄gødius
;

105 
FLOAT
 
	gvõwl⁄g
;

106 
FLOAT
 
	gvõwœt
;

108 
GR_SIZE
 
	gm≠width
;

109 
GR_SIZE
 
	gm≠height
;

110 
GR_COORD
 
	gm≠x‹ig
;

111 
GR_COORD
 
	gm≠y‹ig
;

112 
GR_COORD
 
	g£À˘x
;

113 
GR_COORD
 
	g£À˘y
;

114 
GR_COORD
 
	g£À˘±rx
;

115 
GR_COORD
 
	g£À˘±ry
;

116 
GR_SIZE
 
	g£À˘width
;

117 
GR_SIZE
 
	g£À˘height
;

118 
	g£À˘mode
;

119 
GR_BOOL
 
	g£À˘visibÀ
;

120 
GR_SIZE
 
	g£À˘xsˇÀ
;

121 
GR_SIZE
 
	g£À˘ysˇÀ
;

122 
GR_BOOL
 
	gco‹dvisibÀ
;

123 
GR_BOOL
 
	gco‹díabÀd
;

124 
GR_COORD
 
	gco‹dx
;

125 
GR_COORD
 
	gco‹dy
;

126 
GR_COORD
 
	g±rx
;

127 
GR_COORD
 
	g±ry
;

128 
	gco‹d°rög
[32];

130 
GR_WINDOW_ID
 
	gmaöwid
;

131 
GR_WINDOW_ID
 
	gm≠wid
;

132 
GR_GC_ID
 
	gm≠gc
;

133 
GR_GC_ID
 
	gx‹gc
;

134 
GR_SIZE
 
	gCOLS
, 
	gROWS
;

140 
	#SELECT_NONE
 0

	)

141 
	#SELECT_SCALE
 1

	)

142 
	#SELECT_MOVE
 2

	)

155 
GR_COLOR
 
	gcode_cﬁ‹s
[] = {

156 
BLACK
, 
GREEN
, 
RED
, BLACK, 
BROWN
, GREEN, 
BLUE
, BLUE

159 
checkevít
();

160 
d€xposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

161 
dobuâ⁄down
(
GR_EVENT_BUTTON
 *
bp
);

162 
dobuâ⁄up
(
GR_EVENT_BUTTON
 *
bp
);

163 
d›osôi⁄
(
GR_EVENT_MOUSE
 *
mp
);

164 
dokeydown
(
GR_EVENT_KEYSTROKE
 *
kp
);

165 
show£À˘i⁄
(
GR_BOOL
 
show
);

166 
showco‹ds
(
GR_BOOL
 
show
);

167 
möto°r
(*
buf
, 
möuãs
);

168 
£tzoom
(
FLOAT
 
√wzoom
);

169 
lﬂd
(*
‚
);

172 
	$maö
(
¨gc
, **
¨gv
)

174 
GR_SCREEN_INFO
 
si
;

175 
GR_WM_PROPERTIES
 
¥›s
;

177 i‡(
	`GrO≥n
() < 0) {

178 
	`Ârötf
(
°dîr
, "Cannot open graphics\n");

179 
	`exô
(1);

182 
	`GrReqShmCmds
(65536);

184 
	`GrGëS¸ìnInfo
(&
si
);

185 #ifde‡
__ECOS


187 
COLS
 = 
si
.
cﬁs
 - 10;

188 
ROWS
 = 
si
.
rows
 - 40;

190 
COLS
 = 
si
.
cﬁs
 - 40;

191 
ROWS
 = 
si
.
rows
 - 80;

194 
maöwid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
COLS
, 
ROWS
,

195 0, 
BLACK
, BLACK);

198 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

199 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
;

200 
¥›s
.
tôÀ
 = "NanoX World Map";

201 
	`GrSëWMPr›îtõs
(
maöwid
, &
¥›s
);

203 
m≠width
 = 
COLS
 - 2;

204 
m≠height
 = 
ROWS
 - 2;

205 
m≠x‹ig
 = 
m≠width
 / 2;

206 
m≠y‹ig
 = 
m≠height
 / 2;

207 
£À˘xsˇÀ
 = 4;

208 
£À˘ysˇÀ
 = 3;

209 
co‹dx
 = 0;

210 
co‹dy
 = 
ROWS
 - 1;

211 
m≠wid
 = 
	`GrNewWödow
(
maöwid
, 1, 1, 
m≠width
, 
m≠height
,

213 1, 
BLACK
, 
WHITE
);

215 1, 
LTGRAY
, 
BLACK
);

217 
	`GrSñe˘Evíts
(
maöwid
, 
GR_EVENT_MASK_CLOSE_REQ
);

218 
	`GrSñe˘Evíts
(
m≠wid
, 
GR_EVENT_MASK_EXPOSURE
 |

219 
GR_EVENT_MASK_BUTTON_DOWN
 | 
GR_EVENT_MASK_BUTTON_UP
 |

220 
GR_EVENT_MASK_MOUSE_POSITION
 | 
GR_EVENT_MASK_KEY_DOWN
);

222 
	`GrM≠Wödow
(
maöwid
);

223 
	`GrM≠Wödow
(
m≠wid
);

225 
m≠gc
 = 
	`GrNewGC
();

226 
x‹gc
 = 
	`GrNewGC
();

227 
	`GrSëGCMode
(
x‹gc
, 
GR_MODE_XOR
);

229 
L⁄gôude
 = 
	`ITOF
(0);

230 
L©ôude
 = 
	`ITOF
(0);

231 
	`£tzoom
(
	`ITOF
(1));

234 
	`checkevít
();

235 
	}
}

239 
	$checkevít
()

241 
GR_EVENT
 
evít
;

243 
	`GrGëNextEvít
(&
evít
);

244 
evít
.
ty≥
) {

245 
GR_EVENT_TYPE_EXPOSURE
:

246 
	`d€xposuª
(&
evít
.
exposuª
);

248 
GR_EVENT_TYPE_BUTTON_DOWN
:

249 
	`dobuâ⁄down
(&
evít
.
buâ⁄
);

251 
GR_EVENT_TYPE_BUTTON_UP
:

252 
	`dobuâ⁄up
(&
evít
.
buâ⁄
);

254 
GR_EVENT_TYPE_MOUSE_POSITION
:

255 
	`d›osôi⁄
(&
evít
.
mou£
);

257 
GR_EVENT_TYPE_KEY_DOWN
:

258 
	`dokeydown
(&
evít
.
key°roke
);

260 
GR_EVENT_TYPE_CLOSE_REQ
:

261 
	`GrClo£
();

262 
	`exô
(0);

264 
	}
}

268 
	$d€xposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

270 i‡(
ï
->
wid
 !
m≠wid
)

275 
£À˘visibÀ
 = 
GR_FALSE
;

276 
co‹dvisibÀ
 = 
GR_FALSE
;

277 
	`lﬂd
(
MAPFILE
);

278 
	`show£À˘i⁄
(
GR_TRUE
);

279 
	`showco‹ds
(
GR_TRUE
);

280 
	}
}

284 
	$dobuâ⁄down
(
GR_EVENT_BUTTON
 *
bp
)

286 i‡(
bp
->
wid
 !
m≠wid
)

289 i‡(
bp
->
ch™gebuâ⁄s
 & 
SELECTBUTTON
) {

290 
	`show£À˘i⁄
(
GR_FALSE
);

291 
£À˘x
 = 
bp
->
x
;

292 
£À˘y
 = 
bp
->
y
;

293 
£À˘±rx
 = 
bp
->
x
;

294 
£À˘±ry
 = 
bp
->
y
;

295 
£À˘width
 = 0;

296 
£À˘height
 = 0;

297 
£À˘mode
 = 
SELECT_SCALE
;

298 
	`show£À˘i⁄
(
GR_TRUE
);

301 i‡(
bp
->
ch™gebuâ⁄s
 & 
COORDBUTTON
) {

302 
	`showco‹ds
(
GR_FALSE
);

303 
±rx
 = 
bp
->
x
;

304 
±ry
 = 
bp
->
y
;

305 
co‹díabÀd
 = 
GR_TRUE
;

306 
	`showco‹ds
(
GR_TRUE
);

308 
	}
}

312 
	$dobuâ⁄up
(
GR_EVENT_BUTTON
 *
bp
)

314 i‡(
bp
->
wid
 !
m≠wid
)

317 i‡(
bp
->
ch™gebuâ⁄s
 & 
COORDBUTTON
) {

318 
	`showco‹ds
(
GR_FALSE
);

319 
co‹díabÀd
 = 
GR_FALSE
;

322 i‡(
bp
->
ch™gebuâ⁄s
 & 
SELECTBUTTON
) {

323 
	`show£À˘i⁄
(
GR_FALSE
);

324 i‡(
£À˘mode
 =
SELECT_NONE
)

326 
£À˘mode
 = 
SELECT_NONE
;

327 i‡(
£À˘width
 <= 0)

329 
L⁄gôude
 +=

330 
	`FIDIV
(
	`FIMUL
(
võwl⁄g
, 
£À˘x
 - 
m≠x‹ig
), 
m≠width
);

331 
L©ôude
 -=

332 
	`FIDIV
(
	`FIMUL
(
võwœt
, 
£À˘y
 - 
m≠y‹ig
), 
m≠height
);

333 
	`£tzoom
(
	`FIDIV
(
	`FIMUL
(
zoom
, 
m≠width
), 
£À˘width
));

334 
	`GrCÀ¨Wödow
(
m≠wid
, 
GR_TRUE
);

336 
	}
}

340 
	$d›osôi⁄
(
GR_EVENT_MOUSE
 *
mp
)

342 
GR_SIZE
 
ãmp
;

344 i‡(
mp
->
wid
 !
m≠wid
)

347 i‡(
co‹díabÀd
) {

348 
	`showco‹ds
(
GR_FALSE
);

349 
±rx
 = 
mp
->
x
;

350 
±ry
 = 
mp
->
y
;

351 
	`showco‹ds
(
GR_TRUE
);

354 
	`show£À˘i⁄
(
GR_FALSE
);

355 
£À˘mode
) {

356 
SELECT_SCALE
:

357 
£À˘width
 = 
	`ABS
(
mp
->
x
 - 
£À˘x
) * 2 + 1;

358 
£À˘height
 = 
	`ABS
(
mp
->
y
 - 
£À˘y
) * 2 + 1;

359 
ãmp
 = ((Ë
£À˘width
Ë* 
£À˘ysˇÀ


360 / 
£À˘xsˇÀ
;

361 i‡(
£À˘height
 < 
ãmp
)

362 
£À˘height
 = 
ãmp
;

363 
ãmp
 = ((Ë
£À˘height
Ë* 
£À˘xsˇÀ


364 / 
£À˘ysˇÀ
;

365 i‡(
£À˘width
 < 
ãmp
)

366 
£À˘width
 = 
ãmp
;

369 
SELECT_MOVE
:

370 
£À˘x
 +(
mp
->
x
 - 
£À˘±rx
);

371 
£À˘y
 +(
mp
->
y
 - 
£À˘±ry
);

375 
£À˘±rx
 = 
mp
->
x
;

376 
£À˘±ry
 = 
mp
->
y
;

377 
	`show£À˘i⁄
(
GR_TRUE
);

378 
	}
}

382 
	$dokeydown
(
GR_EVENT_KEYSTROKE
 *
kp
)

384 i‡(
kp
->
wid
 !
m≠wid
)

387 i‡(
£À˘mode
 !
SELECT_NONE
) {

388 
kp
->
ch
) {

390 
£À˘mode
 = 
SELECT_SCALE
;

394 
£À˘mode
 = 
SELECT_MOVE
;

398 
	`show£À˘i⁄
(
GR_FALSE
);

399 
£À˘mode
 = 
SELECT_NONE
;

405 
kp
->
ch
) {

408 
	`GrClo£
();

409 
	`exô
(0);

412 
L⁄gôude
 = 
	`ITOF
(0);

413 
L©ôude
 = 
	`ITOF
(0);

414 
	`£tzoom
(
	`ITOF
(1));

415 
	`GrCÀ¨Wödow
(
m≠wid
, 
GR_TRUE
);

417 
	}
}

427 
	$show£À˘i⁄
(
GR_BOOL
 
show
)

429 i‡((
show
 =0Ë=(
£À˘visibÀ
 == 0))

431 i‡(
£À˘mode
 =
SELECT_NONE
)

433 
	`GrRe˘
(
m≠wid
, 
x‹gc
, 
£À˘x
 - 
£À˘width
 / 2,

434 
£À˘y
 - 
£À˘height
 / 2, 
£À˘width
, selectheight);

435 
£À˘visibÀ
 = 
show
;

436 
	}
}

444 
	$showco‹ds
(
GR_BOOL
 
show
)

446 
cuæ⁄g
;

447 
cuæ©
;

448 
FLOAT
 
±æ©
;

449 
FLOAT
 
±æ⁄g
;

451 i‡(((
show
 =0Ë=(
co‹dvisibÀ
 =0)Ë|| !
co‹díabÀd
)

454 i‡(
show
) {

455 
±æ©
 = 
	`FIDIV
(
	`FIMUL
(
võwœt
, 
±ry
), 
m≠height
 - 1);

456 
±æ⁄g
 = 
	`FIDIV
(
	`FIMUL
(
võwl⁄g
, 
±rx
), 
m≠width
 - 1);

458 
cuæ©
 = 
	`FTOI
(
L©ôude
 + 
œåadius
 - 
±æ©
);

459 
cuæ⁄g
 = 
	`FTOI
(
L⁄gôude
 - 
l⁄gødius
 + 
±æ⁄g
);

461 i‡(
cuæ⁄g
 > 180*60)

462 
cuæ⁄g
 -= 360*60;

463 i‡(
cuæ⁄g
 < -180*60)

464 
cuæ⁄g
 += 360*60;

466 
	`möto°r
(
co‹d°rög
, 
cuæ⁄g
);

467 
	`°rˇt
(
co‹d°rög
, " ");

468 
	`möto°r
(
co‹d°rög
 + 
	`°æí
(co‹d°rög), 
cuæ©
);

471 
	`GrText
(
m≠wid
, 
x‹gc
, 
co‹dx
, 
co‹dy
, 
co‹d°rög
, -1, 
GR_TFBOTTOM
);

472 
co‹dvisibÀ
 = 
show
;

473 
	}
}

481 
	$möto°r
(*
buf
, 
möuãs
)

483 i‡(
möuãs
 < 0) {

484 
möuãs
 = -minutes;

485 *
buf
++ = '-';

487 
	`•rötf
(
buf
, "%ld'%02ld", ()(
möuãs
 / 60), ()(minutes % 60));

488 
	}
}

496 
	$degtomö
(*
s
)

498 
deg
, 
möuãs
;

499 
°r
[10],*
	`°rchr
(),*
˝
;

501 
	`°r˝y
(
°r
,
s
);

502 i‡(
˝
 = 
	`°rchr
(
°r
,'\047')) {

503 *
˝
 = '\0';

504 
möuãs
 = 
	`©oi
(++
˝
);

506 
möuãs
 = 0;

507 i‡((
deg
 = 
	`©oi
(
°r
)) < 0)

508 
möuãs
 = -minutes;

509 (
deg
 * 60 + 
möuãs
);

510 
	}
}

519 
	$£tzoom
(
FLOAT
 
√wzoom
)

521 
zoom
 = 
√wzoom
;

523 
Y_SˇÀ
 = 
	`FIDIV
(
	`FIMUL
(
zoom
, 
m≠height
 * 3), 180 * 4);

524 
X_SˇÀ
 = 
	`FIDIV
(
	`FIMUL
(
zoom
, 
m≠width
), 360);

526 
võwl⁄g
 = 
	`FFDIV
(
WSPAN
, 
zoom
);

527 
võwœt
 = 
	`FFDIV
(
HSPAN
 * 4 / 3, 
zoom
);

528 
l⁄gødius
 = 
	`FIDIV
(
võwl⁄g
, 2);

529 
œåadius
 = 
	`FIDIV
(
võwœt
, 2);

530 
	}
}

537 
	$lﬂd
(*
‚
)

539 
DBPOINT
 *
µ
;

540 
DBPOINT
 *
≥nd
;

541 
FLOAT
 
x
, 
y
, 
L⁄Prv
, 
L©Prv
;

542 
ﬁdl⁄g
 = 0L;

543 
GR_COORD
 
x√w
, 
y√w
;

544 
GR_COORD
 
xﬁd
 = 0, 
yﬁd
 = 0;

545 
GR_BOOL
 
is_out
;

546 
GR_BOOL
 
was_out
;

547 
GR_BOOL
 
√w£g
 = 
GR_FALSE
;

548 
GR_COLOR
 
ﬁdcﬁ‹
;

549 
GR_COLOR
 
√wcﬁ‹
;

550 
n
;

551 
fh
;

552 
DBPOINT
 
p
[
PCou¡
];

554 
L⁄Prv
 = 
	`ITOF
(0);

555 
L©Prv
 = 
	`ITOF
(0);

556 
ﬁdcﬁ‹
 = -1;

557 
is_out
 = 
GR_FALSE
;

558 
was_out
 = 
GR_FALSE
;

560 
fh
 = 
	`›í
(
‚
, 
O_BINARY
 | 
O_RDONLY
);

561 i‡(
fh
 < 0) {

562 
	`GrClo£
();

563 
	`Ârötf
(
°dîr
, "C™nŸ o≥¿%s\n", 
‚
);

564 
	`exô
(1);

567 (
n
 = 
	`ªad
(
fh
, 
p
, 
PCou¡
 * 
POINTSize
)) > 0) {

568 
µ
 = 
p
,
≥nd
 =Ö + 
n
/
POINTSize
;Öp <Öend;Öp++)

570 
	`DBPOINT_CONVERT
(
µ
);

572 
x
 = 
	`ITOF
(
µ
->
L⁄
Ë- 
L⁄gôude
;

573 
y
 = 
	`ITOF
(
µ
->
L©
Ë- 
L©ôude
;

576 i‡(
x
 < -
HSPAN
)

577 
x
 +
WSPAN
;

578 i‡(
x
 > 
HSPAN
)

579 
x
 -
WSPAN
;

581 i‡(
µ
->
Code
 > 5) {

582 
√wcﬁ‹
 = 
code_cﬁ‹s
[
µ
->
Code
 / 1000];

583 i‡(
√wcﬁ‹
 !
ﬁdcﬁ‹
) {

584 
ﬁdcﬁ‹
 = 
√wcﬁ‹
;

585 
	`GrSëGCF‹eground
(
m≠gc
, 
ﬁdcﬁ‹
);

587 
√w£g
 = 
GR_TRUE
;

590 i‡(
ﬁdcﬁ‹
 =
BLACK
)

591 
go_⁄
;

594 i‡((
x
 < -
l⁄gødius
 || x >Üongradius ||

595 
y
 < -
œåadius
 || y >Üatradius))

597 
is_out
 = 1;

598 i‡(
was_out
) {

599 
L⁄Prv
 = 
x
;

600 
L©Prv
 = 
y
;

601 
go_⁄
;

605 
xﬁd
 = 
m≠x‹ig
 + 
	`FTOI
(
	`FFMUL
(
L⁄Prv
, 
X_SˇÀ
)) / 60;

606 
yﬁd
 = 
m≠y‹ig
 - 
	`FTOI
(
	`FFMUL
(
L©Prv
, 
Y_SˇÀ
)) / 60;

608 
is_out
 = 0;

609 i‡(
was_out
) {

610 
xﬁd
 = 
m≠x‹ig
 +

611 
	`FTOI
(
	`FFMUL
(
L⁄Prv
, 
X_SˇÀ
)) / 60;

612 
yﬁd
 = 
m≠y‹ig
 -

613 
	`FTOI
(
	`FFMUL
(
L©Prv
, 
Y_SˇÀ
)) / 60;

617 
L⁄Prv
 = 
x
;

618 
L©Prv
 = 
y
;

621 
x√w
 = 
m≠x‹ig
 + 
	`FTOI
(
	`FFMUL
(
x
, 
X_SˇÀ
)) / 60;

622 
y√w
 = 
m≠y‹ig
 - 
	`FTOI
(
	`FFMUL
(
y
, 
Y_SˇÀ
)) / 60;

625 i‡(
√w£g
 || 
	`ABS
(
ﬁdl⁄g
 - 
µ
->
L⁄
) > 180*60) {

626 
xﬁd
 = 
x√w
;

627 
yﬁd
 = 
y√w
;

629 
ﬁdl⁄g
 = 
µ
->
L⁄
;

631 
	`GrLöe
(
m≠wid
, 
m≠gc
, 
xﬁd
, 
yﬁd
, 
x√w
, 
y√w
);

632 
xﬁd
 = 
x√w
;

633 
yﬁd
 = 
y√w
;

634 
go_⁄
:

635 
was_out
 = 
is_out
;

636 
√w£g
 = 
GR_FALSE
;

639 
	`˛o£
(
fh
);

640 
	}
}

	@demos/nbreaker/animate.c

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

40 
	~<«no-X.h
>

41 
	~"nbªakî.h
"

45 
	$™im©e
(
nb°©e
 *
°©e
)

47 
co‹ds
 
√wpos
;

48 
ªt
, 
i
 = 32;

49 
GR_PIXMAP_ID
 
˘mp
;

52 if(
°©e
->
Êags
.
∑u£d
) ;

55 if(
°©e
->°©ê=
STATE_FADING
) {

57 
°©e
->
Ádñevñ
 -°©e->
Ádî©e
;

60 if(
°©e
->
Ádñevñ
 <= 0) {

63 
°©e
->°©ê°©e->
√xt°©e
;

66 
˘mp
 = 
°©e
->
√wˇnvas
;

67 
°©e
->
√wˇnvas
 = sèã->
ˇnvas
;

68 
°©e
->
ˇnvas
 = 
˘mp
;

75 if(
°©e
->°©ê!
STATE_TITLESCREEN
) {

76 if(
°©e
->
bÆl
.
∑rked
) {

78 
	`døw_background
(
°©e
, 0,

79 
°©e
->
ˇnvasheight
 -

80 
°©e
->
b©height
 -

81 
°©e
->
bÆl
.
s
->
h
,

82 
°©e
->
ˇnvaswidth
,

83 
°©e
->
b©height
 +

84 
°©e
->
bÆl
.
s
->
h
);

86 
	`døw_b©
(
°©e
);

88 
	`døw_bÆl
(
°©e
);

91 
	`døw_background
(
°©e
, 0,

92 
°©e
->
ˇnvasheight
 -

93 
°©e
->
b©height
,

94 
°©e
->
ˇnvaswidth
,

95 
°©e
->
b©height
);

97 
	`døw_b©
(
°©e
);

104 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 0, 0,

105 
°©e
->
ˇnvaswidth
, sèã->
ˇnvasheight
,

106 
°©e
->
√wˇnvas
, 0, 0, 0);

108 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 0, 0,

109 
°©e
->
ˇnvaswidth
, sèã->
ˇnvasheight
,

110 
°©e
->
ﬁdˇnvas
, 0, 0,

111 
GR_CONST_BLEND
 | 
°©e
->
Ádñevñ
);

115 
	`døw_ˇnvas
(
°©e
, 0, 0, sèã->
ˇnvaswidth
,

116 
°©e
->
ˇnvasheight
);

123 if(
°©e
->
Êags
.
À·
)

124 
	`move_b©
(
°©e
, sèã->
b©x
 - sèã->
b©v
);

127 if(
°©e
->
Êags
.
right
)

128 
	`move_b©
(
°©e
, sèã->
b©x
 + sèã->
b©v
);

131 
	`™im©e_powîs
(
°©e
);

134 if(
°©e
->
bÆl
.
∑rked
) ;

143 
	`ˇlc_√w_bÆl_co‹ds
(
°©e
, &
√wpos
);

144 
ªt
 = 
	`check_bÆl_cﬁlisi⁄
(
°©e
, &
√wpos
);

145 } 
ªt
 =1 && --
i
);

150 if(
ªt
 == 2) ;

154 if(!
i
) {

155 
	`Ârötf
(
°dîr
, "InternalÉrror: stuck in collisionÜoop\n");

156 
	`∑rk_bÆl
(
°©e
);

157 
	`move_bÆl
(
°©e
);

162 
°©e
->
bÆl
.
x
 = 
√wpos
.x;

163 
°©e
->
bÆl
.
y
 = 
√wpos
.y;

164 
	`move_bÆl
(
°©e
);

165 
	}
}

	@demos/nbreaker/ball.c

36 
	~<m©h.h
>

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

41 
	~<«no-X.h
>

42 
	~<nxcﬁ‹s.h
>

43 
	~"nbªakî.h
"

47 
	$lo°_bÆl
(
nb°©e
 *
°©e
)

50 if(!
°©e
->
numbÆls
--) {

53 
°©e
->°©ê
STATE_GAMELOST
;

55 
	`ßve_hisc‹e
(
°©e
);

58 
	`£t_Àvñ_a˘ive
(
°©e
);

63 
	`døw_background
(
°©e
, 0, sèã->
sc‹es
.
h
, sèã->
ˇnvaswidth
,

64 
°©e
->
bÆl
.
s
->
h
 + (
BALLS_BORDER
 * 2));

66 
	`døw_bÆls
(
°©e
);

68 
	`døw_ˇnvas
(
°©e
, 0, sèã->
sc‹es
.
h
, sèã->
ˇnvaswidth
,

69 
°©e
->
bÆl
.
s
->
h
 + (
BALLS_BORDER
 * 2));

71 
	`∑rk_bÆl
(
°©e
);

72 
	`move_bÆl
(
°©e
);

77 
	`døw_b©
(
°©e
);

79 
	`døw_ˇnvas
(
°©e
, sèã->
b©x
 - (°©e->
b©widths
[°©e->
b©
] / 2),

80 
°©e
->
ˇnvasheight
 - sèã->
b©height
,

81 
°©e
->
b©widths
[°©e->
b©
], sèã->
b©height
);

82 
	}
}

86 
	$∑rk_bÆl
(
nb°©e
 *
°©e
)

88 
°©e
->
bÆl
.
∑rked
 = 1;

90 
°©e
->
bÆl
.
x
 = sèã->
b©x
 - (°©e->bÆl.
s
->
w
 / 2);

91 
°©e
->
bÆl
.
y
 = sèã->
ˇnvasheight
 -

92 
°©e
->
b©height
 - sèã->
bÆl
.
s
->
h
;

94 
°©e
->
bÆl
.
d
 = 0;

95 
	}
}

102 
	$ˇlc_√w_bÆl_co‹ds
(
nb°©e
 *
°©e
, 
co‹ds
 *
c
)

104 
c
->
x
 = 
°©e
->
bÆl
.x + 
	`sö
(°©e->bÆl.
d
Ë* sèã->bÆl.
v
;

105 
c
->
y
 = 
°©e
->
bÆl
.y - 
	`cos
(°©e->bÆl.
d
Ë* sèã->bÆl.
v
;

106 
	}
}

111 
	$n‹mÆi£_™gÀ
(
d
)

113 if(
d
 < 0Ë d + (2 * 
M_PI
);

114 if(
d
 > (2 * 
M_PI
)) d -= (2 * M_PI);

115  
d
;

116 
	}
}

125 
	$check_bÆl_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
co‹ds
 *
c
)

127 
i
, 
bc
;

128 
grid
 *
g
 = 
°©e
->grid;

131 if(
c
->
y
 < 
°©e
->
bÆl
.
s
->
h
 + (2 * 
BALLS_BORDER
Ë+ sèã->
sc‹es
.h) {

133 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
(
M_PI
 - state->ball.d);

138 if(
c
->
y
 > 
°©e
->
ˇnvasheight
 - sèã->
bÆl
.
s
->
h
) {

141 if(
°©e
->
Êags
.
sf
) {

142 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
(
M_PI
 - state->ball.d);

149 
	`lo°_bÆl
(
°©e
);

150 
	`move_bÆl
(
°©e
);

156 if(
c
->
x
 < 0) {

158 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
((2 * 
M_PI
) - state->ball.d);

163 if(
c
->
x
 > 
°©e
->
ˇnvaswidth
 - sèã->
bÆl
.
s
->
w
) {

165 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
((2 * 
M_PI
) - state->ball.d);

170 if(
c
->
y
 > 
°©e
->
ˇnvasheight
 - sèã->
b©height
 - sèã->
bÆl
.
s
->
h
 &&

171 
c
->
x
 > 
°©e
->
b©x
 -

172 (
°©e
->
b©widths
[°©e->
b©
] / 2Ë- sèã->
bÆl
.
s
->
w
 &&

173 
c
->
x
 < 
°©e
->
b©x
 +

174 (
°©e
->
b©widths
[°©e->
b©
] / 2)) {

179 if(
°©e
->
bÆl
.
y
 > sèã->
ˇnvasheight
 - sèã->
b©height
 -

180 
°©e
->
bÆl
.
s
->
h
)

184 if(
°©e
->
powîtimes
.
°ickyb©
) {

185 
	`∑rk_bÆl
(
°©e
);

186 
	`move_bÆl
(
°©e
);

191 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
(((
c
->
x
 +

192 (
°©e
->
bÆl
.
s
->
w
 / 2)

193 - 
°©e
->
b©x
) /

194 
°©e
->
b©widths
[°©e->
b©
] /

195 2Ë* 
M_PI
);

201 
bc
 = 0;

203 
i
 = 0; i < 
°©e
->
width
 * sèã->
height
; i++) {

206 if(
g
->
b
 && 
c
->
y
 + 
°©e
->
bÆl
.
s
->
h
 > g->y && c->y < g->y +

207 
°©e
->
brickheight
 && 
c
->
x
 + sèã->
bÆl
.
s
->
w


208 > 
g
->
x
 && 
c
->x < g->x + 
°©e
->
brickwidth
) {

214 if(
	`brick_cﬁlisi⁄
(
°©e
, 
g
))  2;

219 if(!
°©e
->
Êags
.
nb
 && !
bc
) {

220 
bc
 = 1;

222 if(
°©e
->
bÆl
.
x
 + sèã->bÆl.
s
->
w
 < 
g
->x) {

223 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
((2 *

224 
M_PI
Ë- 
°©e
->
bÆl
.
d
);

226 } if(
°©e
->
bÆl
.
x
 >
g
->x +

227 
°©e
->
brickwidth
) {

228 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
((2 *

229 
M_PI
Ë- 
°©e
->
bÆl
.
d
);

231 } if(
°©e
->
bÆl
.
y
 + sèã->bÆl.
s
->
h


232 < 
g
->
y
) {

233 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
(
M_PI
 -

234 
°©e
->
bÆl
.
d
);

236 } if(
°©e
->
bÆl
.
y
 >
g
->y +

237 
°©e
->
brickheight
) {

238 
°©e
->
bÆl
.
d
 = 
	`n‹mÆi£_™gÀ
(
M_PI
 -

239 
°©e
->
bÆl
.
d
);

243 
	`Ârötf
(
°dîr
, "InternalÉrror: "

249 
g
++;

253 if(
bc
)  1;

255 
	}
}

260 
	$move_bÆl
(
nb°©e
 *
°©e
)

262 
x
, 
w
, 
y
, 
h
;

265 if(
°©e
->
bÆl
.
lx
 =°©e->bÆl.
x
 && sèã->bÆl.
ly
 =°©e->bÆl.
y
)

275 if(
°©e
->
bÆl
.
x
 < sèã->bÆl.
lx
) {

276 
x
 = ()
°©e
->
bÆl
.x;

277 
w
 = 
°©e
->
bÆl
.
lx
 - 
x
 + sèã->bÆl.
s
->w;

279 
x
 = 
°©e
->
bÆl
.
lx
;

280 
w
 = ()
°©e
->
bÆl
.
x
 - x + sèã->bÆl.
s
->w;

282 if(
°©e
->
bÆl
.
y
 < sèã->bÆl.
ly
) {

283 
y
 = ()
°©e
->
bÆl
.y;

284 
h
 = 
°©e
->
bÆl
.
ly
 - 
y
 + sèã->bÆl.
s
->h;

286 
y
 = 
°©e
->
bÆl
.
ly
;

287 
h
 = ()
°©e
->
bÆl
.
y
 - y + sèã->bÆl.
s
->h;

291 
	`døw_background
(
°©e
, sèã->
bÆl
.
lx
, sèã->bÆl.
ly
,

292 
°©e
->
bÆl
.
s
->
w
, sèã->bÆl.s->
h
);

295 
	`ªdøw_powîs
(
°©e
, sèã->
bÆl
.
lx
, sèã->bÆl.
ly
, sèã->bÆl.
s
->
w
,

296 
°©e
->
bÆl
.
s
->
h
);

299 
	`døw_bÆl
(
°©e
);

302 
	`døw_ˇnvas
(
°©e
, 
x
, 
y
, 
w
, 
h
);

303 
	}
}

307 
	$ªdøw_bÆl
(
nb°©e
 *
°©e
)

310 
	`døw_background
(
°©e
, ()°©e->
bÆl
.
x
, ()°©e->bÆl.
y
,

311 
°©e
->
bÆl
.
s
->
w
, sèã->bÆl.s->
h
);

314 
	`ªdøw_powîs
(
°©e
, ()°©e->
bÆl
.
x
, ()°©e->bÆl.
y
,

315 
°©e
->
bÆl
.
s
->
w
, sèã->bÆl.s->
h
);

318 
	`døw_bÆl
(
°©e
);

321 
	`døw_ˇnvas
(
°©e
, sèã->
bÆl
.
lx
, sèã->bÆl.
ly
, sèã->bÆl.
s
->
w
,

322 
°©e
->
bÆl
.
s
->
h
);

323 
	}
}

	@demos/nbreaker/bat.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

46 
	$ch™ge_b©
(
nb°©e
 *
°©e
, 
√wb©
)

48 
ox1
, 
ox2
, 
nx1
, 
nx2
, 
x
, 
w
;

51 if(
°©e
->
b©widths
[
√wb©
] > sèã->b©widths[°©e->
b©
]) {

53 
x
 = 
°©e
->
b©x
 - (°©e->
b©widths
[
√wb©
] / 2);

55 if(
x
 < 0Ë
	`move_b©
(
°©e
, sèã->
b©widths
[
√wb©
] / 2);

58 
x
 +
°©e
->
b©widths
[
√wb©
];

60 if(
x
 > 
°©e
->
ˇnvaswidth
)

61 
	`move_b©
(
°©e
, sèã->
ˇnvaswidth
 -

62 
°©e
->
b©widths
[
√wb©
] / 2);

67 
ox1
 = 
°©e
->
b©x
 - (°©e->
b©widths
[°©e->
b©
] / 2);

68 
ox2
 = 
ox1
 + 
°©e
->
b©widths
[°©e->
b©
];

69 
nx1
 = 
°©e
->
b©x
 - (°©e->
b©widths
[
√wb©
] / 2);

70 
nx2
 = 
nx1
 + 
°©e
->
b©widths
[
√wb©
];

73 
	`døw_background
(
°©e
, 
ox1
, sèã->
ˇnvasheight
 - sèã->
b©height
,

74 
°©e
->
b©widths
[°©e->
b©
], sèã->
b©height
);

77 
°©e
->
b©
 = 
√wb©
;

78 
	`døw_b©
(
°©e
);

81 if(
ox1
 < 
nx1
Ë
x
 = ox1;

82 
x
 = 
nx1
;

83 if(
ox2
 > 
nx2
Ë
w
 = ox2 - 
x
;

84 
w
 = 
nx2
 - 
x
;

87 
	`døw_ˇnvas
(
°©e
, 
x
, sèã->
ˇnvasheight
 - sèã->
b©height
, 
w
,

88 
°©e
->
b©height
);

89 
	}
}

93 
	$move_b©
(
nb°©e
 *
°©e
, 
x
)

95 
•rôe
 *
s
;

96 
powî
 *
p
, *
≤ext
;

97 
ox
, 
nx
, 
l
, 
r
, 
w
, 
h
, 
y
, 
y2
;

102 if(
°©e
->
Êags
.
∑u£d
) ;

105 
w
 = 
°©e
->
b©widths
[°©e->
b©
];

106 
y
 = 
°©e
->
ˇnvasheight
 - sèã->
b©height
;

109 if(
x
 - (
w
 / 2) < 0) x = w / 2;

110 if(
x
 + (
w
 / 2Ë> 
°©e
->
ˇnvaswidth
) x = state->canvaswidth - (w / 2);

113 if(
°©e
->
bÆl
.
∑rked
Ë°©e->bÆl.
x
 = x - (°©e->bÆl.
s
->
w
 / 2);

117 if(
°©e
->°©ê!
STATE_RUNNING
) {

118 
°©e
->
b©x
 = 
x
;

123 if(
°©e
->
b©x
 =
x
) ;

127 
ox
 = 
°©e
->
b©x
 - (
w
 / 2);

128 
°©e
->
b©x
 = 
x
;

129 
nx
 = 
°©e
->
b©x
 - (
w
 / 2);

130 if(
ox
 > 
nx
) {

131 
l
 = 
nx
;

132 
r
 = 
ox
 + 
w
;

134 
l
 = 
ox
;

135 
r
 = 
nx
 + 
w
;

137 
w
 = 
r
 - 
l
;

138 
h
 = 
°©e
->
b©height
;

142 
y2
 = 
y
;

143 if(
°©e
->
bÆl
.
∑rked
) {

144 
	`move_bÆl
(
°©e
);

145 
y2
 -
°©e
->
bÆl
.
s
->
h
;

146 
h
 +
°©e
->
bÆl
.
s
->h;

150 
p
 = 
°©e
->
powîs
;Ö;Ö = 
≤ext
) {

151 
≤ext
 = 
p
->
√xt
;

154 
s
 = 
°©e
->
powî•rôes
[
p
->
ty≥
];

157 if(
p
->
y
 + 
s
->
h
 > 
°©e
->
ˇnvasheight
 - sèã->
b©height
 &&

158 
p
->
x
 + 
s
->
w
 > 
l
 &&Ö->x < 
r
) {

161 
	`døw_background
(
°©e
, 
p
->
x
,Ö->
y
, 
s
->
w
, s->
h
);

164 
	`døw_ˇnvas
(
°©e
, 
p
->
x
,Ö->
y
 - sèã->
powîv
, 
s
->
w
,

165 
s
->
h
);

168 
	`powî_cﬁlisi⁄
(
°©e
, 
p
);

171 
	`de°roy_powî
(
°©e
, 
p
);

176 
	`døw_background
(
°©e
, 
l
, 
y
, 
w
, sèã->
b©height
);

178 
	`døw_b©
(
°©e
);

180 
	`døw_ˇnvas
(
°©e
, 
l
, 
y2
, 
w
, 
h
);

181 
	}
}

	@demos/nbreaker/brick.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

48 
	$de°roy_brick
(
nb°©e
 *
°©e
, 
grid
 *
g
)

50 
immuèbÀ
;

53 
	`døw_background
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
,

54 
°©e
->
brickheight
);

56 
	`ªdøw_powîs
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
, sèã->
brickheight
);

58 
	`døw_ˇnvas
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
,

59 
°©e
->
brickheight
);

62 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_HUGE_BONUS
)

63 
	`ö¸emít_sc‹e
(
°©e
, sèã->
hugeb⁄u•oöts
);

64 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_LARGE_BONUS
)

65 
	`ö¸emít_sc‹e
(
°©e
, sèã->
œrgeb⁄u•oöts
);

66 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_MEDIUM_BONUS
)

67 
	`ö¸emít_sc‹e
(
°©e
, sèã->
mediumb⁄u•oöts
);

68 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_SMALL_BONUS
)

69 
	`ö¸emít_sc‹e
(
°©e
, sèã->
smÆlb⁄u•oöts
);

70 
	`ö¸emít_sc‹e
(
°©e
, sèã->
n‹mÆpoöts
);

76 
immuèbÀ
 = 
g
->
b
->
Êags
 & 
BRICK_FLAG_IMMUTABLE
;

77 
g
->
b
 = 
NULL
;

81 if(!
immuèbÀ
 && !--
°©e
->
numbricks
) {

82 
	`ö¸emít_Àvñ
(
°©e
);

87 if(
g
->
powî
 !
NOPOWER
)

88 
	`√w_powî
(
°©e
, 
g
->
powî
, g->
x
 + (°©e->
brickwidth
 / 2),

89 
g
->
y
);

92 
	}
}

100 
	$brick_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
grid
 *
g
)

104 if(
°©e
->
powîtimes
.
powîbÆl
 || sèã->
Êags
.
nb
)

105  
	`de°roy_brick
(
°©e
, 
g
);

109 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_IMMUTABLE
)  0;

114 
g
->
hôs
++;

118 if(((
g
->
b
->
Êags
 & 
BRICK_FLAG_2_HITS
Ë&& g->
hôs
 < 2) ||

119 ((
g
->
b
->
Êags
 & 
BRICK_FLAG_3_HITS
Ë&& g->
hôs
 < 3)) {

121 
	`døw_background
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
,

122 
°©e
->
brickheight
);

125 
	`døw_brick
(
°©e
, 
g
, 0, 0, sèã->
brickwidth
,

126 
°©e
->
brickheight
);

128 
	`ªdøw_powîs
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
,

129 
°©e
->
brickheight
);

131 
	`døw_ˇnvas
(
°©e
, 
g
->
x
, g->
y
, sèã->
brickwidth
,

132 
°©e
->
brickheight
);

134 }  
	`de°roy_brick
(
°©e
, 
g
);

137 
	}
}

	@demos/nbreaker/cheat.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

53 
	$chótcmp
(*
a
, *
b
)

55 
m
 = 0;

58 if(!
b
)  0;

62 *
a
 =*
b
) {

65 if(!*
a
)  1;

68 
m
 = 1;

70 
a
++;

71 
b
++;

77 if(!*
a
 && *
b
 && 
m
)  2;

79 
	}
}

90 
	$do_chót
(
nb°©e
 *
°©e
, 
GR_KEY
 
key
)

92 
i
, 
Àn
, 
∑πül_m©ch
 = 0;

95 if(
key
 > 127) ;

103 
Àn
 = 
	`°æí
(
°©e
->
chót°©e
);

104 
°©e
->
chót°©e
[
Àn
] = 
key
;

107 if((
i
 = 
	`chótcmp
(
°©e
->
chót°©e
, sèã->
chóts
[
SFCHEAT
]))) {

108 if(
i
 == 1) {

110 
°©e
->
Êags
.
sf
 ^= 1;

112 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

114 } 
∑πül_m©ch
 = 1;

118 if((
i
 = 
	`chótcmp
(
°©e
->
chót°©e
, sèã->
chóts
[
TPCHEAT
]))) {

119 if(
i
 == 1) {

121 
	`ö¸emít_Àvñ
(
°©e
);

122 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

124 } 
∑πül_m©ch
 = 1;

128 if((
i
 = 
	`chótcmp
(
°©e
->
chót°©e
, sèã->
chóts
[
NBCHEAT
]))) {

129 if(
i
 == 1) {

131 
°©e
->
Êags
.
nb
 ^= 1;

132 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

134 } 
∑πül_m©ch
 = 1;

138 if((
i
 = 
	`chótcmp
(
°©e
->
chót°©e
, sèã->
chóts
[
NPDCHEAT
]))) {

139 if(
i
 == 1) {

141 
°©e
->
Êags
.
≈d
 ^= 1;

142 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

144 } 
∑πül_m©ch
 = 1;

148 if((
i
 = 
	`chótcmp
(
°©e
->
chót°©e
, sèã->
chóts
[
NPUTOCHEAT
]))) {

149 if(
i
 == 1) {

151 
°©e
->
Êags
.
≈uto
 ^= 1;

152 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

154 } 
∑πül_m©ch
 = 1;

159 if(!
∑πül_m©ch
Ë
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

160 
	}
}

	@demos/nbreaker/draw.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

39 
	~<«no-X.h
>

40 
	~<nxcﬁ‹s.h
>

41 
	~"nbªakî.h
"

46 
	$døw_tûed_background
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

48 
tûex
 = 0, 
tûey
 = 0, 
‰omx
, 
‰omy
, 
cx
, 
cy
;

49 
de°width
, 
de°height
, 
§cwidth
, 
§cheight
, 
cwidth
, 
cheight
;

50 
dwidth
 = 
°©e
->
ˇnvaswidth
;

51 
dheight
 = 
°©e
->
ˇnvasheight
;

52 
swidth
 = 
°©e
->
background
->
w
;

53 
sheight
 = 
°©e
->
background
->
h
;

57 if(
swidth
 > 
dwidth
Ë
§cwidth
 = dwidth;

58 
§cwidth
 = 
swidth
;

59 if(
sheight
 > 
dheight
Ë
§cheight
 = dheight;

60 
§cheight
 = 
sheight
;

63 ;
tûey
 < 
dheight
;Åûey +
§cheight
, 
tûex
 = 0) {

65 if(
tûey
 > (
y
 + 
h
)) ;

67 if(
y
 > (
tûey
 + 
§cheight
)) ;

69 if((
tûey
 + 
§cheight
Ë> 
dheight
Ë
de°height
 = dheight -Åiley;

70 
de°height
 = 
§cheight
;

72 ;
tûex
 < 
dwidth
;Åûex +
§cwidth
) {

75 if(
tûex
 > (
x
 + 
w
)) ;

78 if(
x
 > (
tûex
 + 
§cwidth
)) ;

81 if((
tûex
 + 
§cwidth
Ë> 
dwidth
)

82 
de°width
 = 
dwidth
 - 
tûex
;

83 
de°width
 = 
§cwidth
;

88 if((
tûex
 >
x
Ë&& (—ûex + 
de°width
Ë<(x + 
w
))) {

89 
‰omx
 = 0;

90 
cx
 = 
tûex
;

91 
cwidth
 = 
de°width
;

95 if(
x
 > 
tûex
) {

96 
‰omx
 = 
x
 - 
tûex
;

97 
cwidth
 = 
de°width
 - 
‰omx
;

101 
‰omx
 = 0;

102 
cwidth
 = 
x
 + 
w
 - 
tûex
;

105 if(
cwidth
 > 
w
) cwidth = w;

107 if(
cwidth
 > 
de°width
) cwidth = destwidth;

110 
cx
 = 
tûex
 + 
‰omx
;

114 if((
tûey
 >
y
Ë&& (—ûey + 
de°height
Ë<(y + 
h
))) {

115 
‰omy
 = 0;

116 
cy
 = 
tûey
;

117 
cheight
 = 
de°height
;

119 if(
y
 > 
tûey
) {

120 
‰omy
 = 
y
 - 
tûey
;

121 
cheight
 = 
de°height
 - 
‰omy
;

123 
‰omy
 = 0;

124 
cheight
 = 
y
 + 
h
 - 
tûey
;

126 if(
cheight
 > 
h
) cheight = h;

127 if(
cheight
 > 
de°height
) cheight = destheight;

128 
cy
 = 
tûey
 + 
‰omy
;

132 if((
cwidth
 > 0Ë&& (
cheight
 > 0)) {

133 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 
cx
, 
cy
,

134 
cwidth
, 
cheight
,

135 
°©e
->
background
->
p
,

136 
‰omx
, 
‰omy
, 0);

140 
	}
}

143 
	$fûl_ö_ª˘™gÀ
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
,

144 
xx
, 
yy
, 
ww
, 
hh
)

146 
xxx
, 
yyy
;

149 
xxx
 = 
xx
 + 
ww
;

150 
yyy
 = 
yy
 + 
hh
;

153 if(
x
 > 
xx
) xx = x;

154 if(
y
 > 
yy
) yy = y;

155 if(
x
 + 
w
 < 
xxx
) xxx = x + w;

156 if(
y
 + 
h
 < 
yyy
) yyy = y + h;

159 
ww
 = 
xxx
 - 
xx
;

160 
hh
 = 
yyy
 - 
yy
;

163 if(
ww
 > 0 && 
hh
 > 0)

164 
	`GrFûlRe˘
(
°©e
->
ˇnvas
, sèã->
gc
, 
xx
, 
yy
, 
ww
, 
hh
);

166 
	}
}

170 
	$døw_˚¡ªd_background
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

172 
bgx
, 
bgy
, 
xx
, 
yy
, 
ww
, 
hh
;

175 if(
°©e
->
background
->
w
 >°©e->
ˇnvaswidth
Ë
bgx
 = 0;

176 
bgx
 = (
°©e
->
ˇnvaswidth
 / 2Ë- (°©e->
background
->
w
 / 2);

177 if(
°©e
->
background
->
h
 >°©e->
ˇnvasheight
Ë
bgy
 = 0;

178 
bgy
 = (
°©e
->
ˇnvasheight
 / 2Ë- (°©e->
background
->
h
 / 2);

181 if(
x
 < 
bgx
 + 
°©e
->
background
->
w
 && 
y
 < bgx + sèã->background->
h
 &&

182 
x
 + 
w
 > 
bgx
 && 
y
 + 
h
 > 
bgy
) {

184 
xx
 = (
x
 > 
bgx
) ? x : bgx;

185 
yy
 = (
y
 > 
bgy
) ? y : bgy;

187 
ww
 = (
x
 + 
w
 < 
bgx
 + 
°©e
->
background
->wË? x + w - 
xx
 :

188 
bgx
 + 
°©e
->
background
->
w
 - 
xx
;

189 
hh
 = (
y
 + 
h
 < 
bgy
 + 
°©e
->
background
->hË? y + h - 
yy
 :

190 
bgy
 + 
°©e
->
background
->
h
 - 
yy
;

192 if(
ww
 > 0 && 
hh
 > 0)

193 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 
xx
, 
yy
, 
ww
, 
hh
,

194 
°©e
->
background
->
p
, 
xx
 - 
bgx
, 
yy
 - 
bgy
, 0);

198 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_BLACK
);

201 
	`fûl_ö_ª˘™gÀ
(
°©e
, 
x
, 
y
, 
w
, 
h
, 0, 0, sèã->
ˇnvaswidth
, 
bgy
);

203 
	`fûl_ö_ª˘™gÀ
(
°©e
, 
x
, 
y
, 
w
, 
h
, 0, 
bgy
, 
bgx
, sèã->
background
->h);

205 
	`fûl_ö_ª˘™gÀ
(
°©e
, 
x
, 
y
, 
w
, 
h
, 
bgx
 + sèã->
background
->w, 
bgy
,

206 
°©e
->
ˇnvaswidth
 - 
bgx
 + sèã->
background
->
w
,

207 
°©e
->
background
->
h
);

209 
	`fûl_ö_ª˘™gÀ
(
°©e
, 
x
, 
y
, 
w
, 
h
, 0, 
bgy
 + sèã->
background
->h,

210 
°©e
->
ˇnvaswidth
, sèã->
ˇnvasheight
 - 
bgy
 +

211 
°©e
->
background
->
h
);

212 
	}
}

216 
	$døw_background
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

218 if(
°©e
->
backgroundtûed
Ë
	`døw_tûed_background
(°©e, 
x
, 
y
, 
w
, 
h
);

219 
	`døw_˚¡ªd_background
(
°©e
, 
x
, 
y
, 
w
, 
h
);

220 
	}
}

223 
	$døw_•œsh
(
nb°©e
 *
°©e
)

225 if(!
°©e
->
•œsh
) ;

227 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, sèã->
•œsh
->
a
,

228 (
°©e
->
ˇnvaswidth
 / 2Ë- (°©e->
•œsh
->
w
 / 2),

229 (
°©e
->
ˇnvasheight
 / 2Ë- (°©e->
•œsh
->
h
 / 2),

230 
°©e
->
•œsh
->
w
, sèã->•œsh->
h
, sèã->•œsh->
p
,

231 0, 0, 
GR_ALPHA_BLEND
);

232 
	}
}

237 
	$døw_brick
(
nb°©e
 *
°©e
, 
grid
 *
g
, 
x
, 
y
, 
w
, 
h
)

239 
GR_ALPHA_ID
 
a
;

240 
Æpha
 = 0;

243 if(!
g
->
b
) ;

250 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_2_HITS
 && g->
hôs
 =1Ë
Æpha
 = 155;

251 if(
g
->
b
->
Êags
 & 
BRICK_FLAG_3_HITS
) {

252 if(
g
->
hôs
 =1Ë
Æpha
 = 190;

253 if(
g
->
hôs
 =2Ë
Æpha
 = 128;

258 if(
Æpha
) {

260 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_BLACK
);

261 
	`GrFûlRe˘
(
°©e
->
brickÆpha
, sèã->
gc
, 0, 0,

262 
°©e
->
brickwidth
, sèã->
brickheight
);

265 
	`GrC›yAªa
(
°©e
->
brickÆpha
, sèã->
gc
, 0, 0,

266 
°©e
->
brickwidth
, sèã->
brickheight
,

267 
g
->
b
->
s
->
a
, 0, 0, 
GR_CONST_ADD
 | 
Æpha
);

268 
a
 = 
°©e
->
brickÆpha
;

270 } 
a
 = 
g
->
b
->
s
->a;

274 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, 
a
, 
g
->
x
 + x, g->
y
 + y,

275 
w
, 
h
, 
g
->
b
->
s
->
p
, 
x
, 
y
, 
GR_ALPHA_BLEND
);

276 
	}
}

281 
	$døw_bricks
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

283 
tûex
 = 0, 
tûey
 = 0, 
‰omx
, 
‰omy
;

284 
de°width
, 
de°height
, 
§cwidth
, 
§cheight
, 
cwidth
, 
cheight
;

285 
offy
 = 
°©e
->
sc‹es
.
h
 + sèã->
bÆl
.
s
->h + (
BALLS_BORDER
 * 2);

286 
dwidth
 = 
°©e
->
ˇnvaswidth
;

287 
dheight
 = 
°©e
->
height
 * sèã->
brickheight
;

288 
swidth
 = 
°©e
->
brickwidth
;

289 
sheight
 = 
°©e
->
brickheight
;

290 
grid
 *
g
 = 
°©e
->grid - 1;

292 
y
 -
offy
;

293 if(
y
 < 0) y = 0;

295 if(
swidth
 > 
dwidth
Ë
§cwidth
 = dwidth;

296 
§cwidth
 = 
swidth
;

297 if(
sheight
 > 
dheight
Ë
§cheight
 = dheight;

298 
§cheight
 = 
sheight
;

300 ;
tûey
 < 
dheight
;Åûey +
§cheight
, 
tûex
 = 0) {

301 if(
tûey
 > (
y
 + 
h
)) ;

302 if(
y
 > (
tûey
 + 
§cheight
)) {

303 
g
 +
°©e
->
width
;

306 if((
tûey
 + 
§cheight
Ë> 
dheight
Ë
de°height
 = dheight -Åiley;

307 
de°height
 = 
§cheight
;

308 ;
tûex
 < 
dwidth
;Åûex +
§cwidth
) {

309 
g
++;

310 if(
tûex
 > (
x
 + 
w
)) ;

311 if(
x
 > (
tûex
 + 
§cwidth
)) ;

312 if((
tûex
 + 
§cwidth
Ë> 
dwidth
)

313 
de°width
 = 
dwidth
 - 
tûex
;

314 
de°width
 = 
§cwidth
;

316 if((
tûex
 >
x
Ë&& (—ûex + 
de°width
Ë<(x + 
w
))) {

317 
‰omx
 = 0;

318 
cwidth
 = 
de°width
;

320 if(
x
 > 
tûex
) {

321 
‰omx
 = 
x
 - 
tûex
;

322 
cwidth
 = 
de°width
 - 
‰omx
;

324 
‰omx
 = 0;

325 
cwidth
 = 
x
 + 
w
 - 
tûex
;

327 if(
cwidth
 > 
w
) cwidth = w;

328 if(
cwidth
 > 
de°width
) cwidth = destwidth;

331 if((
tûey
 >
y
)&&(—ûey + 
de°height
)<=(y + 
h
))) {

332 
‰omy
 = 0;

333 
cheight
 = 
de°height
;

335 if(
y
 > 
tûey
) {

336 
‰omy
 = 
y
 - 
tûey
;

337 
cheight
 = 
de°height
 - 
‰omy
;

339 
‰omy
 = 0;

340 
cheight
 = 
y
 + 
h
 - 
tûey
;

342 if(
cheight
 > 
h
) cheight = h;

343 if(
cheight
 > 
de°height
) cheight = destheight;

345 if((
cwidth
 > 0Ë&& (
cheight
 > 0))

346 
	`døw_brick
(
°©e
, 
g
, 
‰omx
, 
‰omy
, 
cwidth
,

347 
cheight
);

350 
	}
}

353 
	$døw_b©
(
nb°©e
 *
°©e
)

355 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, sèã->
b©s
[°©e->
b©
]->
a
,

356 
°©e
->
b©x
 - (°©e->
b©widths
[°©e->
b©
] / 2),

357 
°©e
->
ˇnvasheight
 - sèã->
b©height
,

358 
°©e
->
b©widths
[°©e->
b©
], sèã->
b©height
,

359 
°©e
->
b©s
[°©e->
b©
]->
p
, 0, 0, 
GR_ALPHA_BLEND
);

360 
	}
}

365 
	$døw_bÆl
(
nb°©e
 *
°©e
)

367 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, sèã->
bÆl
.
s
->
a
,

368 
°©e
->
bÆl
.
x
, sèã->bÆl.
y
, sèã->bÆl.
s
->
w
,

369 
°©e
->
bÆl
.
s
->
w
, sèã->bÆl.s->
p
, 0, 0,

370 
GR_ALPHA_BLEND
);

371 
°©e
->
bÆl
.
lx
 = ()°©e->bÆl.
x
;

372 
°©e
->
bÆl
.
ly
 = ()°©e->bÆl.
y
;

373 
	}
}

376 
	$døw_bÆls
(
nb°©e
 *
°©e
)

378 
i
, 
s
, 
x
, 
y
;

381 
s
 = 
°©e
->
bÆl
.s->
w
;

382 
x
 = 
BALLS_BORDER
;

383 
y
 = 
°©e
->
sc‹es
.
h
 + 
BALLS_BORDER
;

385 
i
 = 0; i < 
°©e
->
numbÆls
; i++) {

388 if(
x
 + 
s
 + 
BALLS_BORDER
 > 
°©e
->
ˇnvaswidth
) ;

390 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, sèã->
bÆl
.
s
->
a
,

391 
x
, 
y
, 
s
, s, 
°©e
->
bÆl
.s->
p
, 0, 0,

392 
GR_ALPHA_BLEND
);

394 
x
 +
s
 + 
BALLS_BORDER
;

396 
	}
}

405 
	$døw_sc‹es
(
nb°©e
 *
°©e
)

407 
buf
[128];

410 
	`¢¥ötf
(
buf
, 128, "Score: %d HiScore: %d Level: %d",

411 
°©e
->
sc‹es
.
s
, sèã->sc‹es.
hi
, sèã->
Àvñ
);

414 
	`døw_background
(
°©e
, 0, 0, sèã->
ˇnvaswidth
, sèã->
sc‹es
.
h
);

417 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
SCORE_BGCOLOUR
);

418 
	`GrFûlRe˘
(
°©e
->
sc‹es
.
p
, sèã->
gc
, 0, 0, sèã->
ˇnvaswidth
,

419 
°©e
->
sc‹es
.
h
);

422 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
SCORE_FGCOLOUR
);

423 
	`GrSëGCBackground
(
°©e
->
gc
, 
SCORE_BGCOLOUR
);

424 
	`GrText
(
°©e
->
sc‹es
.
p
, sèã->
gc
, 
SCORE_BORDER
, SCORE_BORDER, 
buf
,

425 -1, 
GR_TFTOP
);

429 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
SCORE_ALPHACOLOUR
);

430 
	`GrFûlRe˘
(
°©e
->
sc‹es
.
a
, sèã->
gc
, 0, 0, sèã->
ˇnvaswidth
,

431 
°©e
->
sc‹es
.
h
);

432 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

433 
	`GrSëGCBackground
(
°©e
->
gc
, 
SCORE_ALPHACOLOUR
);

434 
	`GrText
(
°©e
->
sc‹es
.
a
, sèã->
gc
, 
SCORE_BORDER
, SCORE_BORDER, 
buf
,

435 -1, 
GR_TFTOP
);

439 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, sèã->
sc‹es
.
a
, 0, 0,

440 
°©e
->
ˇnvaswidth
, sèã->
sc‹es
.
h
, sèã->sc‹es.
p
,

441 0, 0, 
GR_ALPHA_BLEND
);

442 
	}
}

445 
	$døw_powî
(
nb°©e
 *
°©e
, 
powî
 *
p
, 
x
, 
y
, 
w
, 
h
)

447 
•rôe
 *
s
 = 
°©e
->
powî•rôes
[
p
->
ty≥
];

448 
	`GrC›yAªaAÕha
(
°©e
->
ˇnvas
, sèã->
gc
, 
s
->
a
, 
x
,

449 
y
, 
w
, 
h
, 
s
->
p
, 
x
 -Ö->x, y -Ö->y,

450 
GR_ALPHA_BLEND
);

451 
	}
}

454 
	$døw_ˇnvas
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

456 
	`GrC›yAªa
(
°©e
->
wid
, sèã->
gc
, 
x
, 
y
, 
w
, 
h
, sèã->
ˇnvas
, x, y, 0);

457 
	}
}

	@demos/nbreaker/dump.c

37 
	~<°dio.h
>

39 
	~<«no-X.h
>

40 
	~"nbªakî.h
"

42 #ifde‡
NB_DEBUG


47 *
	$‚ame
(*
f
)

49  
f
 ? f : "<unnamed>";

50 
	}
}

53 
	$dump_bricks
(
brick
 *
b
)

56 if(!
b
) {

57 
	`¥ötf
("\t<empty>\n");

62 
b
) {

65 
	`¥ötf
("\t\"%c\"", 
b
->
idítifõr
);

68 if(
b
->
s
Ë
	`¥ötf
(" (\"%s\")", 
	`‚ame
(b->s->
‚ame
));

70 if(
b
->
Êags
 & 
BRICK_FLAG_IMMUTABLE
Ë
	`¥ötf
(" Immutable");

71 if(
b
->
Êags
 & 
BRICK_FLAG_2_HITS
Ë
	`¥ötf
(" 2hits");

72 if(
b
->
Êags
 & 
BRICK_FLAG_3_HITS
Ë
	`¥ötf
(" 3hits");

73 if(
b
->
Êags
 & 
BRICK_FLAG_SMALL_BONUS
Ë
	`¥ötf
(" smallbonus");

74 if(
b
->
Êags
 & 
BRICK_FLAG_MEDIUM_BONUS
Ë
	`¥ötf
(" mediumbonus");

75 if(
b
->
Êags
 & 
BRICK_FLAG_LARGE_BONUS
Ë
	`¥ötf
("Üargebonus");

76 if(
b
->
Êags
 & 
BRICK_FLAG_HUGE_BONUS
Ë
	`¥ötf
(" hugebonus");

77 
	`¥ötf
("\n");

78 
b
 = b->
√xt
;

80 
	}
}

84 
	$dump_grid
(
nb°©e
 *
°©e
, 
grid
 *
g
)

86 
grid
 *
gp
;

87 
x
, 
y
;

89 
powîs
[] = " WSTPNFRI";

92 if(!
g
) {

93 
	`¥ötf
("\t<empty>\n");

98 
	`¥ötf
("\tbricks:\n\t\t");

99 
x
 = 0; x < 
°©e
->
width
 + 2; x++Ë
	`putch¨
('-');

100 
	`putch¨
('\n');

102 
gp
 = 
g
;

103 
y
 = 0; y < 
°©e
->
height
; y++) {

104 
	`¥ötf
("\t\t|");

105 
x
 = 0; x < 
°©e
->
width
; x++) {

108 if(!
gp
->
b
Ë
	`putch¨
(' ');

109 
	`putch¨
(
gp
->
b
->
idítifõr
);

110 
gp
++;

112 
	`¥ötf
("|\n");

115 
	`¥ötf
("\t\t");

116 
x
 = 0; x < 
°©e
->
width
 + 2; x++Ë
	`putch¨
('-');

119 
	`¥ötf
("\n\tpowers:\n\t\t");

120 
x
 = 0; x < 
°©e
->
width
 + 2; x++Ë
	`putch¨
('-');

121 
	`putch¨
('\n');

123 
gp
 = 
g
;

124 
y
 = 0; y < 
°©e
->
height
; y++) {

125 
	`¥ötf
("\t\t|");

126 
x
 = 0; x < 
°©e
->
width
; x++) {

128 
	`putch¨
(
powîs
[
gp
->
powî
 + 1]);

129 
gp
++;

131 
	`¥ötf
("|\n");

134 
	`¥ötf
("\t\t");

135 
x
 = 0; x < 
°©e
->
width
 + 2; x++Ë
	`putch¨
('-');

136 
	`putch¨
('\n');

137 
	}
}

140 
	$dump_Àvñs
(
nb°©e
 *
°©e
)

142 
Àvñ
 *
l
;

143 
num
 = 1;

146 
	`¥ötf
("Levels:\n");

147 if(!
°©e
->
Àvñs
) {

148 
	`¥ötf
("\t<empty>\n");

153 
l
 = 
°©e
->
Àvñs
;Ü;Ü =Ü->
√xt
) {

155 
	`¥ötf
("\tLevñ %d\n\éevñ bricks:\n", 
num
++);

157 
	`dump_bricks
(
l
->
bricks
);

159 
	`¥ötf
("\tbackground«mê\"%s\"\n", 
	`‚ame
(
l
->
background«me
));

160 
	`¥ötf
("\tbackgroundtûed = %s\n", 
l
->
backgroundtûed
 ?

162 
	`¥ötf
("\äumbrick†%d\n", 
l
->
numbricks
);

164 
	`dump_grid
(
°©e
, 
l
->
grid
);

166 
	}
}

169 
	$¥öt°©e
(
°©e
)

171 
°©e
) {

172 
STATE_TITLESCREEN
:

173 
	`¥ötf
("STATE_TITLESCREEN\n");

175 
STATE_FADING
:

176 
	`¥ötf
("STATE_FADING\n");

178 
STATE_RUNNING
:

179 
	`¥ötf
("STATE_RUNNING\n");

181 
STATE_GAMEWON
:

182 
	`¥ötf
("STATE_GAMEWON\n");

184 
STATE_GAMELOST
:

185 
	`¥ötf
("STATE_GAMELOST\n");

187 
STATE_FINISHED
:

188 
	`¥ötf
("STATE_FINISHED\n");

191 
	`¥ötf
("unknow¿(%d)\n", 
°©e
);

194 
	}
}

198 
	$dump_°©e
(
nb°©e
 *
°©e
)

200 
i
;

201 
powî
 *
p
;

202 
•rôe
 *
s
;

204 
powîs
[
NUMPOWERS
] = "WSTPNF";

206 *
chóts
[] = { "SolidFloor", "Teleport", "NoBounce",

210 
	`¥ötf
("Printing NanoBreaker Game State\n"

214 
	`¥ötf
("state = ");

215 
	`¥öt°©e
(
°©e
->state);

218 
	`¥ötf
("gamedú = \"%s\"\ngamefûê\"%s\"\n", 
	`‚ame
(
°©e
->
gamedú
),

219 
	`‚ame
(
°©e
->
gamefûe
));

223 
	`¥ötf
("tôÀbackground = \"%s\"\n", 
	`‚ame
(
°©e
->
tôÀbackground
));

224 
	`¥ötf
("tôÀbackgroundtûed = %s\n", 
°©e
->
tôÀbackgroundtûed
 ?

228 
	`¥ötf
("tôÀ•œsh = \"%s\"\n", 
	`‚ame
(
°©e
->
tôÀ•œsh
));

229 
	`¥ötf
("gamew⁄•œsh = \"%s\"\n", 
	`‚ame
(
°©e
->
gamew⁄•œsh
));

230 
	`¥ötf
("gamño°•œsh = \"%s\"\n", 
	`‚ame
(
°©e
->
gamño°•œsh
));

233 
	`¥ötf
("sprites = \n");

234 if(!
°©e
->
•rôñi°
Ë
	`¥ötf
("\t<empty>\n");

235 
s
 = 
°©e
->
•rôñi°
; s; s = s->
√xt
)

236 
	`¥ötf
("\t\"%s\" (%d * %d) is in use %dÅime%s\n",

237 
	`‚ame
(
s
->
‚ame
), s->
w
, s->
h
, s->
ußge
,

238 
s
->
ußge
 > 1 ? "s" : "");

242 
	`¥ötf
("background = ");

243 if(!
°©e
->
background
Ë
	`¥ötf
("none\n");

244 
	`¥ötf
("\"%s\" (%d * %d), %stiled\n",

245 
	`‚ame
(
°©e
->
background
->
‚ame
), sèã->background->
w
,

246 
°©e
->
background
->
h
, sèã->
backgroundtûed
 ? "" : "not ");

251 
	`¥ötf
("normalpoints = %d\nsmallbonuspoints = %d\nmediumbonuspoints = "

254 "√wÀvñbÆl†%d\n", 
°©e
->
n‹mÆpoöts
,

255 
°©e
->
smÆlb⁄u•oöts
, sèã->
mediumb⁄u•oöts
,

256 
°©e
->
œrgeb⁄u•oöts
, sèã->
hugeb⁄u•oöts
,

257 
°©e
->
powîuµoöts
, sèã->
powîdow≈oöts
,

258 
°©e
->
°¨tbÆls
, sèã->
√wÀvñbÆls
);

263 
	`¥ötf
("width = %d\nheight = %d\nbrickwidth = %d\nbrickheight = %d\n"

264 "brickÆph®%d\n", 
°©e
->
width
, sèã->
height
,

265 
°©e
->
brickwidth
, sèã->
brickheight
, sèã->
brickÆpha
);

266 
	`¥ötf
("bricks =\n");

267 
	`dump_bricks
(
°©e
->
bricks
);

271 
	`¥ötf
("batheight = %d\nsmall bat width = %d\nnormal bat width = %d\n"

272 "œrgêb© width = %d\n", 
°©e
->
b©height
,

273 
°©e
->
b©widths
[
SMALLBAT
], sèã->b©widths[
NORMALBAT
],

274 
°©e
->
b©widths
[
LARGEBAT
]);

275 
	`¥ötf
("small bat = ");

276 if(!
°©e
->
b©s
[
SMALLBAT
]Ë
	`¥ötf
("none\n");

277 
	`¥ötf
("\"%s\"\n", 
	`‚ame
(
°©e
->
b©s
[
SMALLBAT
]->
‚ame
));

278 
	`¥ötf
("normal bat = ");

279 if(!
°©e
->
b©s
[
NORMALBAT
]Ë
	`¥ötf
("none\n");

280 
	`¥ötf
("\"%s\"\n", 
	`‚ame
(
°©e
->
b©s
[
NORMALBAT
]->
‚ame
));

281 
	`¥ötf
("large bat = ");

282 if(!
°©e
->
b©s
[
SMALLBAT
]Ë
	`¥ötf
("none\n");

283 
	`¥ötf
("\"%s\"\n", 
	`‚ame
(
°©e
->
b©s
[
LARGEBAT
]->
‚ame
));

284 
	`¥ötf
("current bat = ");

285 
°©e
->
b©
) {

286 
NORMALBAT
:

287 
	`¥ötf
("NORMALBAT\n");

289 
SMALLBAT
:

290 
	`¥ötf
("SMALLBAT\n");

292 
LARGEBAT
:

293 
	`¥ötf
("LARGEBAT\n");

296 
	`¥ötf
("unknow¿(%d)\n", 
°©e
->
b©
);

298 
	`¥ötf
("b©x = %d\nb©v = %d\n", 
°©e
->
b©x
, sèã->
b©v
);

301 
	`¥ötf
("Power sprites:\n");

302 
i
 = 0; i < 
NUMPOWERS
; i++) {

303 
	`¥ötf
("\t%¯", 
powîs
[
i
]);

304 if(
°©e
->
powî•rôes
[
i
])

305 
	`¥ötf
("\"%s\"\n",

306 
	`‚ame
(
°©e
->
powî•rôes
[
i
]->
‚ame
));

307 
	`¥ötf
("<empty>\n");

311 
	`¥ötf
("splash = ");

312 if(!
°©e
->
•œsh
Ë
	`¥ötf
("none\n");

313 
	`¥ötf
("\"%s\" (%d * %d)\n", 
	`‚ame
(
°©e
->
•œsh
->
‚ame
),

314 
°©e
->
•œsh
->
w
, sèã->•œsh->
h
);

317 
	`¥ötf
("powîu±imê%d\≈owîdow¡imê%d\n", 
°©e
->
powîu±ime
,

318 
°©e
->
powîdow¡ime
);

321 
	`¥ötf
("Cheat sequences:\n");

322 
i
 = 0; i < 
NUMCHEATS
; i++) {

323 
	`¥ötf
("\t%†", 
chóts
[
i
]);

324 if(
°©e
->
chóts
[
i
]Ë
	`¥ötf
("\"%s\"\n", state->cheats[i]);

325 
	`¥ötf
("disabled\n");

327 
	`¥ötf
("chót°©ê\"%s\"\n", 
°©e
->
chót°©e
);

328 
	`¥ötf
("SﬁidFlo‹ fœg i†%s\n", 
°©e
->
Êags
.
sf
 ? "active" :

330 
	`¥ötf
("NoBoun˚ fœg i†%s\n", 
°©e
->
Êags
.
nb
 ? "active" :

332 
	`¥ötf
("NoPowîDow¿Êag i†%s\n", 
°©e
->
Êags
.
≈d
 ?

334 
	`¥ötf
("NoPowîUpTimeouàÊag i†%s\n", 
°©e
->
Êags
.
≈uto
 ?

338 
	`¥ötf
("Pau£d fœg i†%s\n", 
°©e
->
Êags
.
∑u£d
 ? "active" :

340 
	`¥ötf
("Le· fœg i†%s\n", 
°©e
->
Êags
.
À·
 ? "active" :

342 
	`¥ötf
("RighàÊag i†%s\n", 
°©e
->
Êags
.
right
 ? "active" :

346 
	`¥ötf
("Àvñ = %d\¬umÀvñ†%d\n", 
°©e
->
Àvñ
, sèã->
numÀvñs
);

351 
	`¥ötf
("wid = %d\nwinx = %d\ncanvas = %d\noldcanvas = %d\n"

353 "ˇnvasheighà%d\n", 
°©e
->
wid
, sèã->
wöx
, sèã->
ˇnvas
,

354 
°©e
->
ﬁdˇnvas
, sèã->
√wˇnvas
, sèã->
tid
,

355 
°©e
->
ˇnvaswidth
, sèã->
ˇnvasheight
);

358 
	`dump_grid
(
°©e
, sèã->
grid
);

361 
	`¥ötf
("numbrick†%d\n", 
°©e
->
numbricks
);

364 
	`¥ötf
("ball = ");

365 if(!
°©e
->
bÆl
.
s
Ë
	`¥ötf
("none\n");

366 
	`¥ötf
("\"%s\" (%d * %d)\n", 
	`‚ame
(
°©e
->
bÆl
.
s
->
‚ame
),

367 
°©e
->
bÆl
.
s
->
w
, sèã->bÆl.s->
h
);

368 
	`¥ötf
("ball x = %f\nball y = %f\nball d = %f\nball v = %d\n"

371 "%d\n", 
°©e
->
bÆl
.
x
, sèã->bÆl.
y
, sèã->bÆl.
d
,

372 
°©e
->
bÆl
.
v
, sèã->bÆl.
lx
, sèã->bÆl.
ly
,

373 
°©e
->
bÆl
.
∑rked
 ? "Yes" : "No", sèã->bÆl.
sv
,

374 
°©e
->
bÆl
.
nv
, sèã->bÆl.
fv
);

377 
	`¥ötf
("currentÖowers:\n");

378 if(!
°©e
->
powîs
Ë
	`¥ötf
("\t<empty>\n");

379 
p
 = 
°©e
->
powîs
;Ö;Ö =Ö->
√xt
)

380 
	`¥ötf
("\t%¯© (%d, %d)\n", 
powîs
[
p
->
ty≥
],Ö->
x
,Ö->
y
);

383 
	`¥ötf
("score = %d\nhiscore = %d\n file hiscore = %d\n"

384 "sc‹êpixm≠ = %d\n", 
°©e
->
sc‹es
.
s
,

385 
°©e
->
sc‹es
.
hi
, sèã->sc‹es.
fhi
, sèã->sc‹es.
p
);

388 
	`¥ötf
("powîv = %d\«nim©ïîiod = %d\n", 
°©e
->
powîv
,

389 
°©e
->
™im©ïîiod
);

392 
	`¥ötf
("œ°™im = %ldS %lduS\n", 
°©e
->
œ°™im
.
tv_£c
,

393 
°©e
->
œ°™im
.
tv_u£c
);

396 
	`¥ötf
("powertimes:\n"

403 
°©e
->
powîtimes
.
wideb©
,

404 
°©e
->
powîtimes
.
¶owmŸi⁄
,

405 
°©e
->
powîtimes
.
°ickyb©
,

406 
°©e
->
powîtimes
.
powîbÆl
,

407 
°©e
->
powîtimes
.
«ºowb©
,

408 
°©e
->
powîtimes
.
Á°mŸi⁄
);

411 
	`¥ötf
("Ádî©ê%d\nÁdñevñ = %d\n", 
°©e
->
Ádî©e
,

412 
°©e
->
Ádñevñ
);

415 
	`¥ötf
("nextstate = ");

416 
	`¥öt°©e
(
°©e
->
√xt°©e
);

419 
	`dump_Àvñs
(
°©e
);

420 
	}
}

	@demos/nbreaker/event.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

39 
	~<«no-X.h
>

40 
	~<nxcﬁ‹s.h
>

41 
	~"nbªakî.h
"

47 
	$a˘i⁄_¥es£d
(
nb°©e
 *
°©e
)

49 if(
°©e
->°©ê=
STATE_TITLESCREEN
Ë
	`ö¸emít_Àvñ
(state);

50 if(
°©e
->°©ê=
STATE_GAMEWON
 ||

51 
°©e
->°©ê=
STATE_GAMELOST
)

52 
	`ª£t_game
(
°©e
);

53 
°©e
->
bÆl
.
∑rked
 = 0;

54 
	}
}

59 
	$h™dÀ_exposuª_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_EXPOSURE
 *
ev
)

61 
	`døw_ˇnvas
(
°©e
, 
ev
->
x
,Év->
y
,Év->
width
,Év->
height
);

62 
	}
}

65 
	$h™dÀ_buâ⁄_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_BUTTON
 *
ev
)

67 
	`a˘i⁄_¥es£d
(
°©e
);

68 
	}
}

71 
	$h™dÀ_mou£_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_MOUSE
 *
ev
)

73 
	`move_b©
(
°©e
, 
ev
->
x
 - sèã->
wöx
);

74 
	}
}

77 
	$h™dÀ_key°roke_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_KEYSTROKE
 *
ev
)

82 if(
ev
->
ty≥
 =
GR_EVENT_TYPE_KEY_UP
) {

83 
ev
->
ch
) {

84 
MWKEY_LEFT
:

85 
°©e
->
Êags
.
À·
 = 0;

87 
MWKEY_RIGHT
:

88 
°©e
->
Êags
.
right
 = 0;

99 
ev
->
ch
) {

101 
	`a˘i⁄_¥es£d
(
°©e
);

103 
MWKEY_F1
:

104 
°©e
->
Êags
.
∑u£d
 ^= 1;

106 
MWKEY_F2
:

107 
	`lo°_bÆl
(
°©e
);

109 #ifde‡
DEBUG_POWERS


113 
MWKEY_F3
:

114 
	`a˘iv©e_wideb©
(
°©e
);

116 
MWKEY_F4
:

117 
	`a˘iv©e_¶owmŸi⁄
(
°©e
);

119 
MWKEY_F5
:

120 
	`a˘iv©e_°ickyb©
(
°©e
);

122 
MWKEY_F6
:

123 
	`a˘iv©e_powîbÆl
(
°©e
);

125 
MWKEY_F7
:

126 
	`a˘iv©e_«ºowb©
(
°©e
);

128 
MWKEY_F8
:

129 
	`a˘iv©e_Á°mŸi⁄
(
°©e
);

132 
MWKEY_LEFT
:

135 
°©e
->
Êags
.
À·
 = 1;

136 
°©e
->
Êags
.
right
 = 0;

138 
MWKEY_RIGHT
:

141 
°©e
->
Êags
.
À·
 = 0;

142 
°©e
->
Êags
.
right
 = 1;

144 #ifde‡
NB_DEBUG


147 
MWKEY_F10
:

148 
	`dump_°©e
(
°©e
);

153 
MWKEY_ESCAPE
:

158 
	`do_chót
(
°©e
, 
ev
->
ch
);

163 
	}
}

170 
	$h™dÀ_upd©e_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_UPDATE
 *
ev
)

172 
°©e
->
wöx
 = 
ev
->
roŸx
;

173 
	}
}

178 
	$h™dÀ_timî_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_TIMER
 *
ev
)

180 
	`do_powî_timîs
(
°©e
);

181 
	}
}

	@demos/nbreaker/game.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

45 
	$ª£t_game
(
nb°©e
 *
°©e
)

48 
°©e
->°©ê
STATE_TITLESCREEN
;

49 
°©e
->
Àvñ
 = 0;

50 
°©e
->
sc‹es
.
s
 = 0;

51 
°©e
->
numbÆls
 = sèã->
°¨tbÆls
;

52 
	`∑rk_bÆl
(
°©e
);

54 
°©e
->
powîtimes
.
wideb©
 = 0;

55 
°©e
->
powîtimes
.
¶owmŸi⁄
 = 0;

56 
°©e
->
powîtimes
.
°ickyb©
 = 0;

57 
°©e
->
powîtimes
.
powîbÆl
 = 0;

58 
°©e
->
powîtimes
.
«ºowb©
 = 0;

59 
°©e
->
powîtimes
.
Á°mŸi⁄
 = 0;

61 
°©e
->
b©
 = 
NORMALBAT
;

63 
°©e
->
bÆl
.
v
 = sèã->bÆl.
nv
;

65 
	`£t_Àvñ_a˘ive
(
°©e
);

66 
	}
}

	@demos/nbreaker/init.c

36 
	~<°dio.h
>

37 
	~<°rög.h
>

38 
	~<°dlib.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

45 
	$ußge
()

47 
	`Ârötf
(
°dîr
, "Usage:Çbreaker [ -d game-dir ] [ game-file ]\n");

48 
	}
}

51 
	$∑r£_cmd_¨gs
(
nb°©e
 *
°©e
, 
¨gc
, *
¨gv
[])

53 
i
;

56 
i
 = 1; i < 
¨gc
; i++) {

59 if(*
¨gv
[
i
] !'-'Ë
°©e
->
gamefûe
 =árgv[i];

60 if(
¨gv
[
i
][1] == 'd') {

64 if(++
i
 < 
¨gc
Ë
°©e
->
gamedú
 = 
¨gv
[i];

66 
	`ußge
();

72 
	`ußge
();

77 
	}
}

80 
	$£tup_deÁu…_°©e
(
nb°©e
 *
°©e
)

82 
i
;

83 
GR_FONT_ID
 
fid
;

84 
GR_FONT_INFO
 
fi
;

86 
°©e
->°©ê
STATE_TITLESCREEN
;

87 
°©e
->
gamedú
 = 
DEFAULT_GAME_DIR
;

88 
°©e
->
gamefûe
 = 
DEFAULT_GAME_FILE
;

89 
°©e
->
tôÀbackground
 = 
NULL
;

90 
°©e
->
tôÀbackgroundtûed
 = 
DEFAULT_BACKGROUND_TILED
;

91 
°©e
->
tôÀ•œsh
 = 
NULL
;

92 
°©e
->
gamew⁄•œsh
 = 
NULL
;

93 
°©e
->
gamño°•œsh
 = 
NULL
;

94 
°©e
->
•rôñi°
 = 
NULL
;

95 
°©e
->
background
 = 
NULL
;

96 
°©e
->
backgroundtûed
 = 1;

97 
°©e
->
n‹mÆpoöts
 = 
DEFAULT_NORMALPOINTS
;

98 
°©e
->
smÆlb⁄u•oöts
 = 
DEFAULT_SMALLBONUSPOINTS
;

99 
°©e
->
mediumb⁄u•oöts
 = 
DEFAULT_MEDIUMBONUSPOINTS
;

100 
°©e
->
œrgeb⁄u•oöts
 = 
DEFAULT_LARGEBONUSPOINTS
;

101 
°©e
->
hugeb⁄u•oöts
 = 
DEFAULT_HUGEBONUSPOINTS
;

102 
°©e
->
powîuµoöts
 = 
DEFAULT_POWERUPPOINTS
;

103 
°©e
->
powîdow≈oöts
 = 
DEFAULT_POWERDOWNPOINTS
;

104 
°©e
->
°¨tbÆls
 = 
DEFAULT_STARTBALLS
;

105 
°©e
->
√wÀvñbÆls
 = 
DEFAULT_NEWLEVELBALLS
;

106 
°©e
->
brickwidth
 = 
DEFAULT_BRICK_WIDTH
;

107 
°©e
->
brickheight
 = 
DEFAULT_BRICK_HEIGHT
;

108 
°©e
->
bricks
 = 
NULL
;

109 
°©e
->
brickÆpha
 = 0;

110 
°©e
->
width
 = 
DEFAULT_WIDTH
;

111 
°©e
->
height
 = 
DEFAULT_HEIGHT
;

112 
°©e
->
b©height
 = 
DEFAULT_BAT_HEIGHT
;

113 
°©e
->
b©widths
[
NORMALBAT
] = 
DEFAULT_NORMALBAT_WIDTH
;

114 
°©e
->
b©widths
[
SMALLBAT
] = 
DEFAULT_SMALLBAT_WIDTH
;

115 
°©e
->
b©widths
[
LARGEBAT
] = 
DEFAULT_LARGEBAT_WIDTH
;

116 
i
 = 0; i < 
NUMBATS
; i++Ë
°©e
->
b©s
[i] = 
NULL
;

117 
°©e
->
b©
 = 
NORMALBAT
;

118 
°©e
->
b©x
 = 0;

119 
°©e
->
b©v
 = 
DEFAULT_BAT_VELOCITY
;

120 
°©e
->
powîv
 = 
DEFAULT_POWER_VELOCITY
;

121 
°©e
->
™im©ïîiod
 = 
DEFAULT_ANIMATE_PERIOD
;

122 
i
 = 0; i < 
NUMPOWERS
; i++Ë
°©e
->
powî•rôes
[i] = 
NULL
;

123 
°©e
->
•œsh
 = 
NULL
;

124 
°©e
->
powîu±ime
 = 
DEFAULT_POWERUP_TIME
;

125 
°©e
->
powîdow¡ime
 = 
DEFAULT_POWERDOWN_TIME
;

126 
i
 = 0; i < 
NUMCHEATS
; i++Ë
°©e
->
chóts
[i] = 
NULL
;

127 
	`mem£t
(
°©e
->
chót°©e
, 0, 
MAXCHEATLEN
 + 1);

128 
°©e
->
Êags
.
sf
 = 0;

129 
°©e
->
Êags
.
nb
 = 0;

130 
°©e
->
Êags
.
≈d
 = 0;

131 
°©e
->
Êags
.
≈uto
 = 0;

132 
°©e
->
Êags
.
∑u£d
 = 0;

133 
°©e
->
Êags
.
À·
 = 0;

134 
°©e
->
Êags
.
right
 = 0;

135 
°©e
->
Àvñs
 = 
NULL
;

136 
°©e
->
Àvñ
 = 0;

137 
°©e
->
numÀvñs
 = 0;

138 
°©e
->
wid
 = 0;

139 
°©e
->
wöx
 = 0;

140 
°©e
->
ˇnvas
 = 0;

141 
°©e
->
ˇnvaswidth
 = 0;

142 
°©e
->
ˇnvasheight
 = 0;

143 
°©e
->
grid
 = 
NULL
;

144 
°©e
->
numbricks
 = 0;

145 
°©e
->
powîs
 = 
NULL
;

146 
°©e
->
sc‹es
.
s
 = 0;

147 
°©e
->
sc‹es
.
hi
 = 0;

148 
°©e
->
sc‹es
.
fhi
 = 0;

149 
°©e
->
sc‹es
.
p
 = 0;

150 
°©e
->
gc
 = 
	`GrNewGC
();

151 
fid
 = 
	`GrCª©eF⁄t
(
SCORE_FONT
, 0, 
NULL
);

152 
	`GrGëF⁄tInfo
(
fid
, &
fi
);

153 
°©e
->
sc‹es
.
h
 = (2 * 
SCORE_BORDER
Ë+ 
fi
.
height
;

154 
	`GrSëGCF⁄t
(
°©e
->
gc
, 
fid
);

155 
°©e
->
bÆl
.
x
 = 0;

156 
°©e
->
bÆl
.
y
 = 0;

157 
°©e
->
bÆl
.
d
 = 0;

158 
°©e
->
bÆl
.
v
 = 
DEFAULT_NORMAL_BALL_VELOCITY
;

159 
°©e
->
bÆl
.
lx
 = 0;

160 
°©e
->
bÆl
.
ly
 = 0;

161 
°©e
->
bÆl
.
∑rked
 = 1;

162 
°©e
->
bÆl
.
s
 = 
NULL
;

163 
°©e
->
bÆl
.
sv
 = 
DEFAULT_SLOW_BALL_VELOCITY
;

164 
°©e
->
bÆl
.
nv
 = 
DEFAULT_NORMAL_BALL_VELOCITY
;

165 
°©e
->
bÆl
.
fv
 = 
DEFAULT_FAST_BALL_VELOCITY
;

166 
°©e
->
numbÆls
 = 0;

167 
	`gëtimeofday
(&
°©e
->
œ°™im
, 
NULL
);

168 
°©e
->
powîtimes
.
wideb©
 = 0;

169 
°©e
->
powîtimes
.
¶owmŸi⁄
 = 0;

170 
°©e
->
powîtimes
.
°ickyb©
 = 0;

171 
°©e
->
powîtimes
.
powîbÆl
 = 0;

172 
°©e
->
powîtimes
.
«ºowb©
 = 0;

173 
°©e
->
powîtimes
.
Á°mŸi⁄
 = 0;

174 
°©e
->
Ádî©e
 = 
DEFAULT_FADERATE
;

175 
°©e
->
Ádñevñ
 = 0;

176 
°©e
->
√xt°©e
 = 
STATE_TITLESCREEN
;

177 
	}
}

180 
nb°©e
 *
	$öô
(
¨gc
, *
¨gv
[])

182 
GR_PROP
 *
¥›
;

183 
nb°©e
 *
°©e
;

184 
GR_SCREEN_INFO
 
si
;

185 
GR_BITMAP
 
curs‹
 = 0;

186 
GR_WM_PROPERTIES
 
¥›s
;

189 if(
	`GrO≥n
() < 1) {

190 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

191  
NULL
;

196 
	`GrGëS¸ìnInfo
(&
si
);

197 if(!
si
.
ÆphabÀnd
) {

198 
	`Ârötf
(
°dîr
, "Error: Nano-X server was built withoutálpha "

201  
NULL
;

205 if(!(
°©e
 = 
	`mÆloc
((
nb°©e
)))Ë 
NULL
;

206 
	`£tup_deÁu…_°©e
(
°©e
);

209 if(
	`∑r£_cmd_¨gs
(
°©e
, 
¨gc
, 
¨gv
)) {

210 
	`‰ì
(
°©e
);

211  
NULL
;

215 if(
	`lﬂd_game_fûe
(
°©e
)) {

216 
	`‰ì
(
°©e
);

217  
NULL
;

221 
	`lﬂd_hisc‹e
(
°©e
);

224 
°©e
->
ˇnvaswidth
 = sèã->
width
 * sèã->
brickwidth
;

225 
°©e
->
ˇnvasheight
 = sèã->
sc‹es
.
h
 + sèã->
bÆl
.
s
->h +

226 (2 * 
BALLS_BORDER
) +

227 (
°©e
->
height
 * sèã->
brickheight
) +

228 3 * 
°©e
->
brickheight
 + sèã->
b©height
;

231 
°©e
->
b©x
 = sèã->
ˇnvaswidth
 / 2;

234 
°©e
->
sc‹es
.
p
 = 
	`GrNewPixm≠
(°©e->
ˇnvaswidth
, sèã->sc‹es.
h
,

235 
NULL
);

236 
°©e
->
sc‹es
.
a
 = 
	`GrNewAÕha
(°©e->
ˇnvaswidth
, sèã->sc‹es.
h
);

237 
°©e
->
ˇnvas
 = 
	`GrNewPixm≠
(°©e->
ˇnvaswidth
, sèã->
ˇnvasheight
,

238 
NULL
);

241 if(
°©e
->
Ádî©e
) {

242 
°©e
->
√wˇnvas
 = 
	`GrNewPixm≠
(°©e->
ˇnvaswidth
,

243 
°©e
->
ˇnvasheight
, 
NULL
);

244 
°©e
->
ﬁdˇnvas
 = 
	`GrNewPixm≠
(°©e->
ˇnvaswidth
,

245 
°©e
->
ˇnvasheight
, 
NULL
);

247 
°©e
->
brickÆpha
 = 
	`GrNewAÕha
(°©e->
brickwidth
, sèã->
brickheight
);

250 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_BLACK
);

251 
	`GrFûlRe˘
(
°©e
->
ˇnvas
, sèã->
gc
, 0, 0, sèã->
ˇnvaswidth
,

252 
°©e
->
ˇnvasheight
);

258 if(
	`GrGëWödowPr›îty
(
GR_ROOT_WINDOW_ID
, "WINDOW_MANAGER", &
¥›
)) {

259 
	`‰ì
(
¥›
);

260 
°©e
->
wöx
 = 
GR_OFF_SCREEN
;

264 
°©e
->
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, sèã->
wöx
, 0,

265 
°©e
->
ˇnvaswidth
, sèã->
ˇnvasheight
, 0, 0, 0);

268 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
;

269 
¥›s
.
tôÀ
 = "NanoBreaker";

270 
	`GrSëWMPr›îtõs
(
°©e
->
wid
, &
¥›s
);

273 
	`GrSëCurs‹
(
°©e
->
wid
, 1, 1, 1, 1, 0, 0, &
curs‹
, &cursor);

276 
	`GrSñe˘Evíts
(
°©e
->
wid
, 
GR_EVENT_MASK_CLOSE_REQ
 |

277 
GR_EVENT_MASK_EXPOSURE
 |

278 
GR_EVENT_MASK_BUTTON_DOWN
 |

279 
GR_EVENT_MASK_KEY_DOWN
 |

280 
GR_EVENT_MASK_KEY_UP
 |

281 
GR_EVENT_MASK_UPDATE
 |

282 
GR_EVENT_MASK_TIMER
);

288 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_MOUSE_POSITION
);

291 
	`GrM≠Wödow
(
°©e
->
wid
);

295 
°©e
->
tid
 = 
	`GrCª©eTimî
(°©e->
wid
, 1000, 
GR_TRUE
);

298 
	`ª£t_game
(
°©e
);

300  
°©e
;

301 
	}
}

	@demos/nbreaker/levels.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<°rög.h
>

40 
	~<«no-X.h
>

41 
	~<nxcﬁ‹s.h
>

42 
	~"nbªakî.h
"

45 
	$ö¸emít_Àvñ
(
nb°©e
 *
°©e
)

48 if(
°©e
->
Àvñ
 =°©e->
numÀvñs
) {

50 
°©e
->°©ê
STATE_GAMEWON
;

52 
	`ßve_hisc‹e
(
°©e
);

55 if(
°©e
->°©ê=
STATE_TITLESCREEN
) {

56 
°©e
->°©ê
STATE_RUNNING
;

59 } 
°©e
->
numbÆls
 +°©e->
√wÀvñbÆls
;

60 
°©e
->
Àvñ
++;

63 
	`∑rk_bÆl
(
°©e
);

65 
	`£t_Àvñ_a˘ive
(
°©e
);

66 
	}
}

73 
	$£t_Àvñ_a˘ive
(
nb°©e
 *
°©e
)

75 
i
;

76 
Àvñ
 *
Àv
;

77 
grid
 *
g
, *
gg
;

78 
bgch™ged
;

79 
•rôe
 *
s
 = 
NULL
;

80 
powî
 *
p
, *
≤ext
;

81 
GR_PIXMAP_ID
 
˘mp
;

82 *
backgroundfûe
;

85 
	`de°roy_•rôe
(
°©e
, sèã->
•œsh
);

88 if(
°©e
->°©ê=
STATE_TITLESCREEN
) {

90 
backgroundfûe
 = 
°©e
->
tôÀbackground
;

92 
°©e
->
backgroundtûed
 = sèã->
tôÀbackgroundtûed
;

96 
°©e
->
•œsh
 = 
	`lﬂd_•rôe
(°©e, sèã->
tôÀ•œsh
, -1, -1);

99 
Àv
 = 
°©e
->
Àvñs
, 
i
 = 1; i < sèã->
Àvñ
;

100 
Àv
 =Üev->
√xt
, 
i
++);

102 
°©e
->
numbricks
 = 
Àv
->numbricks;

103 
backgroundfûe
 = 
Àv
->
background«me
;

104 
°©e
->
backgroundtûed
 = 
Àv
->backgroundtiled;

107 if(
°©e
->°©ê=
STATE_GAMEWON
) {

108 
°©e
->
•œsh
 = 
	`lﬂd_•rôe
(°©e, sèã->
gamew⁄•œsh
,

112 } if(
°©e
->°©ê=
STATE_GAMELOST
) {

113 
°©e
->
•œsh
 = 
	`lﬂd_•rôe
(state,

114 
°©e
->
gamño°•œsh
, -1, -1);

117 
°©e
->
•œsh
 = 
NULL
;

120 
g
 = 
°©e
->
grid
;

121 
gg
 = 
Àv
->
grid
;

122 
i
 = 0; i < 
°©e
->
width
 * sèã->
height
; i++)

123 *
g
++ = *
gg
++;

128 if(
backgroundfûe
) {

133 if(
°©e
->
background
 && sèã->background->
‚ame
 &&

134 !
	`°rcmp
(
backgroundfûe
,

135 
°©e
->
background
->
‚ame
))

136 
bgch™ged
 = 0;

137 
bgch™ged
 = 1;

140 } 
bgch™ged
 = 1;

143 if(
bgch™ged
 && !(
s
 = 
	`lﬂd_•rôe
(
°©e
, 
backgroundfûe
, -1, -1))) {

149 if(!(
s
 = 
	`make_em±y_•rôe
(
°©e
, 
backgroundfûe
, 16, 16))) {

153 
s
 = 
°©e
->
background
;

156 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_BLACK
);

157 
	`GrFûlRe˘
(
s
->
p
, 
°©e
->
gc
, 0, 0, 16, 16);

161 
°©e
->
backgroundtûed
 = 1;

166 if(
bgch™ged
 && 
s
 !
°©e
->
background
) {

168 
	`de°roy_•rôe
(
°©e
, sèã->
background
);

170 
°©e
->
background
 = 
s
;

174 
p
 = 
°©e
->
powîs
;Ö;Ö = 
≤ext
) {

175 
≤ext
 = 
p
->
√xt
;

176 
	`‰ì
(
p
);

178 
°©e
->
powîs
 = 
NULL
;

184 if(
°©e
->
Ádî©e
) {

186 
˘mp
 = 
°©e
->
ﬁdˇnvas
;

187 
°©e
->
ﬁdˇnvas
 = sèã->
ˇnvas
;

188 
°©e
->
ˇnvas
 = 
˘mp
;

191 
°©e
->
√xt°©e
 = state->state;

194 
°©e
->°©e
STATE_FADING
;

197 
°©e
->
Ádñevñ
 = 256;

201 
	`døw_background
(
°©e
, 0, 0, sèã->
ˇnvaswidth
, sèã->
ˇnvasheight
);

204 if(
°©e
->°©ê!
STATE_TITLESCREEN
 && !(°©e->°©ê=
STATE_FADING


205 && 
°©e
->
√xt°©e
 =
STATE_TITLESCREEN
)) {

207 
	`døw_bricks
(
°©e
, 0, 0, sèã->
ˇnvaswidth
,

208 
°©e
->
ˇnvasheight
);

209 
	`døw_sc‹es
(
°©e
);

210 
	`døw_bÆls
(
°©e
);

211 
	`døw_b©
(
°©e
);

213 if(
°©e
->°©ê!
STATE_GAMELOST
 &&

214 
°©e
->°©ê!
STATE_GAMEWON
)

215 
	`døw_bÆl
(
°©e
);

218 
	`døw_•œsh
(
°©e
);

222 if(
°©e
->°©ê=
STATE_FADING
) {

225 
˘mp
 = 
°©e
->
√wˇnvas
;

226 
°©e
->
√wˇnvas
 = sèã->
ˇnvas
;

227 
°©e
->
ˇnvas
 = 
˘mp
;

230 
°©e
->
Ádñevñ
 -°©e->
Ádî©e
;

233 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 0, 0, sèã->
ˇnvaswidth
,

234 
°©e
->
ˇnvasheight
, sèã->
√wˇnvas
, 0, 0, 0);

235 
	`GrC›yAªa
(
°©e
->
ˇnvas
, sèã->
gc
, 0, 0, sèã->
ˇnvaswidth
,

236 
°©e
->
ˇnvasheight
, sèã->
ﬁdˇnvas
, 0, 0,

237 
GR_CONST_BLEND
 | 
°©e
->
Ádñevñ
);

241 
	`døw_ˇnvas
(
°©e
, 0, 0, sèã->
ˇnvaswidth
, sèã->
ˇnvasheight
);

242 
	}
}

	@demos/nbreaker/loader.c

37 
	~<°dio.h
>

38 
	~<î∫o.h
>

39 
	~<˘y≥.h
>

40 
	~<°dlib.h
>

41 
	~<°rög.h
>

42 
	~<uni°d.h
>

44 
	~<«no-X.h
>

45 
	~<nxcﬁ‹s.h
>

47 
	~"nbªakî.h
"

51 
	$ªdeföew¨nög
(*
«me
, 
löe
, *
gamefûe
)

53 
	`Ârötf
(
°dîr
, "Warning:Ñedefining %s onÜine %d of game file "

54 "\"%s\"\n", 
«me
, 
löe
, 
gamefûe
);

55 
	}
}

59 
	$nŸöÀvblockîr
(*
«me
, 
löe
, *
gamefûe
)

61 
	`Ârötf
(
°dîr
, "Error: %s whileÇot ináÜevel block on "

62 "löê%d o‡gamêfûê\"%s\"\n", 
«me
, 
löe
, 
gamefûe
);

63 
	}
}

69 
	$∑r£_rows
(
nb°©e
 *
°©e
, 
Àvñ
 *
Àv
, 
FILE
 *
Â
, *
löe
)

71 
brick
 *
b
;

72 
x
, 
y
;

73 
buf
[256], *
p
;

74 
grid
 *
g
 = 
Àv
->grid;

75 
°¨éöe
 = *
löe
;

77 
y
 = 0;

80 
	`fgës
(
buf
, 256, 
Â
)) {

82 
x
 = 0;

83 *
löe
 = *line + 1;

86 if(!(
p
 = 
	`°rchr
(
buf
, '\n'))) {

89 
	`Ârötf
(
°dîr
, "TooÜongÜine onÜine %d of game file "

90 "\"%s\"\n", *
löe
, 
°©e
->
gamefûe
);

93 *
p
 = 0;

96 if(!
	`memcmp
(
buf
, "EndRows", 7))  0;

99 if(
y
 =
°©e
->
height
) {

101 
	`Ârötf
(
°dîr
, "Too manyÑows inÜevel definition on"

103 *
löe
, 
°©e
->
gamefûe
);

108 
p
 = 
buf
; *p;Ö++) {

112 if(++
x
 > 
°©e
->
width
) {

113 
	`Ârötf
(
°dîr
, "Error:ÑowÅooÜong onÜine "

115 *
löe
, 
°©e
->
gamefûe
,

116 
°©e
->
width
);

120 if(*
p
 =' 'Ë
b
 = 
NULL
;

124 
b
 = 
°©e
->
bricks
; b && b->
idítifõr
 !*
p
;

125 
b
 = b->
√xt
);

127 if(!
b
) {

131 
b
 = 
Àv
->
bricks
; b &&

132 
b
->
idítifõr
 !*
p
;

133 
b
 = b->
√xt
);

136 if(!
b
) {

139 
	`Ârötf
(
°dîr
, "Error: undefined brick"

141 "fûê\"%s\"\n", *
p
, *
löe
,

142 
°©e
->
gamefûe
);

151 if(
b
 && !(b->
Êags
 & 
BRICK_FLAG_IMMUTABLE
))

152 
Àv
->
numbricks
++;

155 
g
->
b
 = b;

156 
g
++;

158 
g
 +
°©e
->
width
 - 
x
;

159 
y
++;

166 if(
	`„of
(
Â
)) {

167 
	`Ârötf
(
°dîr
, "Error:ÖrematureÉnd of file insideÑows "

169 "\"%s\"\n", 
°¨éöe
, 
°©e
->
gamefûe
);

170 } 
	`Ârötf
(
°dîr
, "ErrorÑeading from game file \"%s\": %s\n",

171 
°©e
->
gamefûe
, 
	`°ªº‹
(
î∫o
));

173 
	}
}

175 
	$∑r£_powîs
(
nb°©e
 *
°©e
, 
Àvñ
 *
Àv
, 
FILE
 *
Â
, *
löe
)

177 
x
, 
y
, 
i
;

178 
buf
[256], *
p
;

179 
grid
 *
g
 = 
Àv
->grid;

180 
°¨éöe
 = *
löe
;

181 
powîs
[] = " WSTPNF";

183 
y
 = 0;

186 
	`fgës
(
buf
, 256, 
Â
)) {

188 
x
 = 0;

189 *
löe
 = *line + 1;

192 if(!(
p
 = 
	`°rchr
(
buf
, '\n'))) {

195 
	`Ârötf
(
°dîr
, "TooÜongÜine onÜine %d of game file "

196 "\"%s\"\n", *
löe
, 
°©e
->
gamefûe
);

199 *
p
 = 0;

202 if(!
	`memcmp
(
buf
, "EndPowers", 9))

206 if(
y
 =
°©e
->
height
) {

208 
	`Ârötf
(
°dîr
, "Too manyÑows inÜevel definition on"

210 *
löe
, 
°©e
->
gamefûe
);

215 
p
 = 
buf
; *p;Ö++) {

219 if(++
x
 > 
°©e
->
width
) {

220 
	`Ârötf
(
°dîr
, "Error:ÑowÅooÜong onÜine "

222 *
löe
, 
°©e
->
gamefûe
,

223 
°©e
->
width
);

228 
i
 = 0; 
powîs
[i] &&Öowîs[i] !*
p
; i++);

232 if(!
powîs
[
i
]) {

233 
	`Ârötf
(
°dîr
, "Error: invalidÖower \"%c\" "

235 *
p
, *
löe
, 
°©e
->
gamefûe
);

240 
g
->
powî
 = 
i
 - 1;

241 
g
++;

243 
g
 +
°©e
->
width
 - 
x
;

244 
y
++;

251 if(
	`„of
(
Â
)) {

252 
	`Ârötf
(
°dîr
, "Error:ÖrematureÉnd of file insideÖowers "

254 "\"%s\"\n", 
°¨éöe
, 
°©e
->
gamefûe
);

255 } 
	`Ârötf
(
°dîr
, "ErrorÑeading from game file \"%s\": %s\n",

256 
°©e
->
gamefûe
, 
	`°ªº‹
(
î∫o
));

258 
	}
}

261 
	$∑r£_brick
(
nb°©e
 *
°©e
, 
öÀvñ
, 
Àvñ
 *
Àv
, 
löe
,

262 *
buf
)

264 
i
;

265 *
Êags
, 
f
;

266 
brick
 *
b
 = 
NULL
;

270 
b
 = 
°©e
->
bricks
; b && b->
idítifõr
 !*
buf
; b = b->
√xt
);

274 if(!
b
 && 
öÀvñ
)

275 
b
 = 
Àv
->
bricks
; b && b->
idítifõr
 !*
buf
; b = b->
√xt
);

279 if(
b
) {

280 
	`Ârötf
(
°dîr
, "Warning: ignoring duplicate brick definition "

281 "⁄Üöê%d o‡gamêfûê\"%s\"\n", 
löe
,

282 
°©e
->
gamefûe
);

287 if(!(
b
 = 
	`mÆloc
((
brick
)))) {

288 
	`oom
();

292 
b
->
idítifõr
 = *
buf
;

294 
buf
 += 2;

301 if((
Êags
 = 
	`°rchr
(
buf
, ' '))) *flags++ = 0;

303 
b
->
Êags
 = 0;

306 if(
Êags
) {

308 (
f
 = *
Êags
++)) {

310 if(
f
 ='I'Ë
b
->
Êags
 |
BRICK_FLAG_IMMUTABLE
;

311 if(
f
 ='2'Ë
b
->
Êags
 |
BRICK_FLAG_2_HITS
;

312 if(
f
 ='3'Ë
b
->
Êags
 |
BRICK_FLAG_3_HITS
;

313 if(
f
 ='S'Ë
b
->
Êags
 |
BRICK_FLAG_SMALL_BONUS
;

314 if(
f
 ='M'Ë
b
->
Êags
 |
BRICK_FLAG_MEDIUM_BONUS
;

315 if(
f
 ='L'Ë
b
->
Êags
 |
BRICK_FLAG_LARGE_BONUS
;

316 if(
f
 ='H'Ë
b
->
Êags
 |
BRICK_FLAG_HUGE_BONUS
;

320 
	`Ârötf
(
°dîr
, "Warning: ignoring invalid "

323 "o‡gamêfûê\"%s\"\n", 
f
,

324 
b
->
idítifõr
, 
löe
,

325 
°©e
->
gamefûe
);

332 
i
 = 0;

333 if(
b
->
Êags
 & 
BRICK_FLAG_IMMUTABLE
Ë
i
++;

334 if(
b
->
Êags
 & 
BRICK_FLAG_2_HITS
Ë
i
++;

335 if(
b
->
Êags
 & 
BRICK_FLAG_3_HITS
Ë
i
++;

338 if(
i
 > 1) {

339 
	`Ârötf
(
°dîr
, "Warning: brick flags I, 2,ánd 3áre mutually "

341 "gamêfûê\"%s\")\n", 
b
->
idítifõr
, 
löe
,

342 
°©e
->
gamefûe
);

343 
b
->
Êags
 &~(
BRICK_FLAG_IMMUTABLE
 | 
BRICK_FLAG_2_HITS
 |

344 
BRICK_FLAG_3_HITS
);

349 
i
 = 0;

350 if(
b
->
Êags
 & 
BRICK_FLAG_SMALL_BONUS
Ë
i
++;

351 if(
b
->
Êags
 & 
BRICK_FLAG_MEDIUM_BONUS
Ë
i
++;

352 if(
b
->
Êags
 & 
BRICK_FLAG_LARGE_BONUS
Ë
i
++;

353 if(
b
->
Êags
 & 
BRICK_FLAG_HUGE_BONUS
Ë
i
++;

356 if(
i
 > 1) {

357 
	`Ârötf
(
°dîr
, "Warning: brick flags S, M, L,ánd Háre "

359 "%d o‡gamêfûê\"%s\")\n", 
b
->
idítifõr
,

360 
löe
, 
°©e
->
gamefûe
);

361 
b
->
Êags
 &~(
BRICK_FLAG_SMALL_BONUS
 | 
BRICK_FLAG_LARGE_BONUS
 |

362 
BRICK_FLAG_MEDIUM_BONUS
 | 
BRICK_FLAG_HUGE_BONUS
);

366 if(!(
b
->
s
 = 
	`lﬂd_•rôe
(
°©e
, 
buf
, sèã->
brickwidth
,

367 
°©e
->
brickheight
))) {

369 if(!(
b
->
s
 = 
	`make_em±y_•rôe
(
°©e
, 
buf
, sèã->
brickwidth
,

370 
°©e
->
brickheight
))) {

373 
	`Ârötf
(
°dîr
, "Error: failedÅo create brick "

375 
löe
, 
°©e
->
gamefûe
);

376 
	`‰ì
(
b
);

380 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_BLUE
);

381 
	`GrFûlRe˘
(
b
->
s
->
p
, 
°©e
->
gc
, 0, 0, sèã->
brickwidth
,

382 
°©e
->
brickheight
);

383 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

384 
	`GrFûlRe˘
(
b
->
s
->
a
, 
°©e
->
gc
, 0, 0, sèã->
brickwidth
,

385 
°©e
->
brickheight
);

390 if(
öÀvñ
) {

391 
b
->
√xt
 = 
Àv
->
bricks
;

392 
Àv
->
bricks
 = 
b
;

394 
b
->
√xt
 = 
°©e
->
bricks
;

395 
°©e
->
bricks
 = 
b
;

399 
	}
}

402 
grid
 *
	$√wgrid
(
nb°©e
 *
°©e
)

404 
x
, 
xx
, 
y
, 
yy
;

405 
grid
 *
g
, *
gg
;

408 if(!(
gg
 = 
g
 = 
	`mÆloc
(
°©e
->
width
 * sèã->
height
 * (
grid
))))

409  
NULL
;

413 
yy
 = 
°©e
->
sc‹es
.
h
 + sèã->
bÆl
.
s
->h + (
BALLS_BORDER
 * 2);

416 
y
 = 0; y < 
°©e
->
height
; y++, 
yy
 +°©e->
brickheight
) {

418 
x
 = 0, 
xx
 = 0; x < 
°©e
->
width
; x++,

419 
xx
 +
°©e
->
brickwidth
) {

421 
g
->
b
 = 
NULL
;

422 
g
->
x
 = 
xx
;

423 
g
->
y
 = 
yy
;

424 
g
->
hôs
 = 0;

425 
g
->
powî
 = -1;

426 
g
++;

430  
gg
;

431 
	}
}

434 
	$∑r£_powî•rôe
(
nb°©e
 *
°©e
, *
buf
, 
löe
)

436 
•rôe
 *
s
;

437 
powî
;

440 *
buf
) {

442 
powî
 = 
POWERW
;

445 
powî
 = 
POWERS
;

448 
powî
 = 
POWERT
;

451 
powî
 = 
POWERP
;

454 
powî
 = 
POWERN
;

457 
powî
 = 
POWERF
;

460 
powî
 = 
NOPOWER
;

465 if(
powî
 =
NOPOWER
) {

466 
	`Ârötf
(
°dîr
, "InvalidÖower \"%c\" onÜine %d of game file "

467 "\"%s\"\n", *
buf
, 
löe
, 
°©e
->
gamefûe
);

473 if(
°©e
->
powî•rôes
[
powî
]) {

474 
	`ªdeföew¨nög
("PowîS¥ôe", 
löe
, 
°©e
->
gamefûe
);

475 
	`de°roy_•rôe
(
°©e
, sèã->
powî•rôes
[
powî
]);

479 if(!(
s
 = 
	`lﬂd_•rôe
(
°©e
, 
buf
 + 2, -1, -1))) {

481 if(!(
s
 = 
	`make_em±y_•rôe
(
°©e
, 
buf
 + 2, 
DEFAULT_POWER_WIDTH
,

482 
DEFAULT_POWER_HEIGHT
))) {

485 
	`Ârötf
(
°dîr
, "Error: failedÅo createÖower sprite "

487 
löe
, 
°©e
->
gamefûe
);

492 if(
powî
 =
POWERW
 ||Öowî =
POWERS
 ||Öowî =
POWERT
 ||

493 
powî
 =
POWERP
)

494 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_GREEN
);

495 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_RED
);

496 
	`GrFûlRe˘
(
s
->
p
, 
°©e
->
gc
, 0, 0, 
DEFAULT_POWER_WIDTH
,

497 
DEFAULT_POWER_HEIGHT
);

498 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

499 
	`GrFûlRe˘
(
s
->
a
, 
°©e
->
gc
, 0, 0, 
DEFAULT_POWER_WIDTH
,

500 
DEFAULT_POWER_HEIGHT
);

504 
°©e
->
powî•rôes
[
powî
] = 
s
;

507 
	}
}

510 
	$lﬂd_game_fûe
(
nb°©e
 *
°©e
)

512 
FILE
 *
Â
;

513 
löe
 = 1;

514 
Àvñ
 *
l
, *
Àv
 = 
NULL
;

515 
buf
[256], *
p
;

516 
öÀvñblock
 = 0;

519 
	`¢¥ötf
(
buf
, 256, "%s/%s", 
°©e
->
gamedú
, sèã->
gamefûe
);

522 if(!(
Â
 = 
	`f›í
(
buf
, "r"))) {

524 
	`Ârötf
(
°dîr
, "FailedÅo open game file \"%s\": %s\n",

525 
buf
, 
	`°ªº‹
(
î∫o
));

530 
	`fgës
(
buf
, 256, 
Â
)) {

533 if(!(
p
 = 
	`°rchr
(
buf
, '\n'))) {

536 
	`Ârötf
(
°dîr
, "TooÜongÜine onÜine %d of game file "

537 "\"%s\"\n", 
löe
, 
°©e
->
gamefûe
);

540 *
p
 = 0;

543 if(*
buf
 == '#' || *buf == 0) {

545 } if(!
	`memcmp
(
buf
, "TitleBackground ", 16)) {

546 if(
°©e
->
tôÀbackground
) {

547 
	`ªdeföew¨nög
("TôÀBackground", 
löe
,

548 
°©e
->
gamefûe
);

549 
	`‰ì
(
°©e
->
tôÀbackground
);

551 if(!(
°©e
->
tôÀbackground
 = 
	`°rdup
(
buf
 + 16))) {

552 
	`oom
();

553 
îr
;

555 } if(!
	`memcmp
(
buf
, "TitleBackgroundTiled ", 21)) {

559 if(!
	`°rcmp
(
buf
 + 21, "Yes"))

560 
°©e
->
backgroundtûed
 = 1;

561 if(!
	`°rcmp
(
buf
 + 21, "No"))

562 
°©e
->
backgroundtûed
 = 0;

563 
∑r£îr
;

564 } if(!
	`memcmp
(
buf
, "TitleSplash ", 12)) {

565 if(
°©e
->
tôÀ•œsh
) {

566 
	`ªdeföew¨nög
("TôÀS∂ash", 
löe
,

567 
°©e
->
gamefûe
);

568 
	`‰ì
(
°©e
->
tôÀ•œsh
);

570 if(!(
°©e
->
tôÀ•œsh
 = 
	`°rdup
(
buf
 + 12))) {

571 
	`oom
();

572 
îr
;

574 } if(!
	`memcmp
(
buf
, "GameWonSplash ", 14)) {

575 if(
°©e
->
gamew⁄•œsh
) {

576 
	`ªdeföew¨nög
("GameW⁄S∂ash", 
löe
,

577 
°©e
->
gamefûe
);

578 
	`‰ì
(
°©e
->
gamew⁄•œsh
);

580 if(!(
°©e
->
gamew⁄•œsh
 = 
	`°rdup
(
buf
 + 14))) {

581 
	`oom
();

582 
îr
;

584 } if(!
	`memcmp
(
buf
, "GameLostSplash ", 15)) {

585 if(
°©e
->
gamño°•œsh
) {

586 
	`ªdeföew¨nög
("GameLo°S∂ash", 
löe
,

587 
°©e
->
gamefûe
);

588 
	`‰ì
(
°©e
->
gamño°•œsh
);

590 if(!(
°©e
->
gamño°•œsh
 = 
	`°rdup
(
buf
 + 15))) {

591 
	`oom
();

592 
îr
;

594 } if(!
	`memcmp
(
buf
, "NormalPoints ", 13)) {

597 
°©e
->
n‹mÆpoöts
 = 
	`°πﬁ
(
buf
 + 13, &
p
, 10);

598 if(*
p
Ë
∑r£îr
;

599 } if(!
	`memcmp
(
buf
, "SmallBonusPoints ", 17)) {

600 
°©e
->
smÆlb⁄u•oöts
 = 
	`°πﬁ
(
buf
 + 17, &
p
, 10);

601 if(*
p
Ë
∑r£îr
;

602 } if(!
	`memcmp
(
buf
, "MediumBonusPoints ", 18)) {

603 
°©e
->
mediumb⁄u•oöts
 = 
	`°πﬁ
(
buf
 + 18, &
p
, 10);

604 if(*
p
Ë
∑r£îr
;

605 } if(!
	`memcmp
(
buf
, "LargeBonusPoints ", 17)) {

606 
°©e
->
œrgeb⁄u•oöts
 = 
	`°πﬁ
(
buf
 + 17, &
p
, 10);

607 if(*
p
Ë
∑r£îr
;

608 } if(!
	`memcmp
(
buf
, "HugeBonusPoints ", 16)) {

609 
°©e
->
hugeb⁄u•oöts
 = 
	`°πﬁ
(
buf
 + 16, &
p
, 10);

610 if(*
p
Ë
∑r£îr
;

611 } if(!
	`memcmp
(
buf
, "PowerUpPoints ", 14)) {

612 
°©e
->
powîuµoöts
 = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

613 if(*
p
Ë
∑r£îr
;

614 } if(!
	`memcmp
(
buf
, "PowerDownPoints ", 16)) {

615 
°©e
->
powîdow≈oöts
 = 
	`°πﬁ
(
buf
 + 16, &
p
, 10);

616 if(*
p
Ë
∑r£îr
;

617 } if(!
	`memcmp
(
buf
, "StartBalls ", 11)) {

618 
°©e
->
°¨tbÆls
 = 
	`°πﬁ
(
buf
 + 11, &
p
, 10);

619 if(*
p
Ë
∑r£îr
;

620 } if(!
	`memcmp
(
buf
, "NewLevelBalls ", 14)) {

621 
°©e
->
√wÀvñbÆls
 = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

622 if(*
p
Ë
∑r£îr
;

623 } if(!
	`memcmp
(
buf
, "BallImage ", 10)) {

626 if(
°©e
->
bÆl
.
s
) {

627 
	`ªdeföew¨nög
("BÆlImage", 
löe
,

628 
°©e
->
gamefûe
);

629 
	`de°roy_•rôe
(
°©e
, sèã->
bÆl
.
s
);

632 if(!(
°©e
->
bÆl
.
s
 = 
	`lﬂd_•rôe
(°©e, 
buf
 + 10,

635 if(!(
°©e
->
bÆl
.
s
 = 
	`make_em±y_•rôe
(state,

636 
buf
 + 10,

637 
DEFAULT_BALL_SIZE
,

638 
DEFAULT_BALL_SIZE
))) {

641 
	`Ârötf
(
°dîr
, "Couldn't create "

644 "\"%s\"\n", 
löe
,

645 
°©e
->
gamefûe
);

646 
îr
;

650 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

651 
	`GrFûlEŒù£
(
°©e
->
bÆl
.
s
->
p
, sèã->
gc
,

652 
DEFAULT_BALL_SIZE
 / 2,

653 
DEFAULT_BALL_SIZE
 / 2,

654 (
DEFAULT_BALL_SIZE
 / 2) - 1,

655 (
DEFAULT_BALL_SIZE
 / 2) - 1);

656 
	`GrFûlEŒù£
(
°©e
->
bÆl
.
s
->
a
, sèã->
gc
,

657 
DEFAULT_BALL_SIZE
 / 2,

658 
DEFAULT_BALL_SIZE
 / 2,

659 (
DEFAULT_BALL_SIZE
 / 2) - 1,

660 (
DEFAULT_BALL_SIZE
 / 2) - 1);

662 } if(!
	`memcmp
(
buf
, "SlowBallVelocity ", 17)) {

663 
°©e
->
bÆl
.
sv
 = 
	`°πﬁ
(
buf
 + 17, &
p
, 10);

664 if(*
p
Ë
∑r£îr
;

665 } if(!
	`memcmp
(
buf
, "NormalBallVelocity ", 19)) {

666 
°©e
->
bÆl
.
nv
 = 
	`°πﬁ
(
buf
 + 19, &
p
, 10);

667 if(*
p
Ë
∑r£îr
;

668 } if(!
	`memcmp
(
buf
, "FastBallVelocity ", 17)) {

669 
°©e
->
bÆl
.
fv
 = 
	`°πﬁ
(
buf
 + 17, &
p
, 10);

670 if(*
p
Ë
∑r£îr
;

671 } if(!
	`memcmp
(
buf
, "BatVelocity ", 12)) {

672 
°©e
->
b©v
 = 
	`°πﬁ
(
buf
 + 12, &
p
, 10);

673 if(*
p
Ë
∑r£îr
;

674 } if(!
	`memcmp
(
buf
, "PowerVelocity ", 14)) {

675 
°©e
->
powîv
 = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

676 if(*
p
Ë
∑r£îr
;

677 } if(!
	`memcmp
(
buf
, "AnimatePeriod ", 14)) {

678 
°©e
->
™im©ïîiod
 = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

679 if(*
p
Ë
∑r£îr
;

680 } if(!
	`memcmp
(
buf
, "BrickWidth ", 11)) {

681 
°©e
->
brickwidth
 = 
	`°πﬁ
(
buf
 + 11, &
p
, 10);

682 if(*
p
Ë
∑r£îr
;

683 } if(!
	`memcmp
(
buf
, "BrickHeight ", 12)) {

684 
°©e
->
brickheight
 = 
	`°πﬁ
(
buf
 + 12, &
p
, 10);

685 if(*
p
Ë
∑r£îr
;

686 } if(!
	`memcmp
(
buf
, "Brick ", 6)) {

688 if(
	`∑r£_brick
(
°©e
, 
öÀvñblock
, 
Àv
, 
löe
, 
buf
 + 6))

689 
îr
;

690 } if(!
	`memcmp
(
buf
, "Width ", 6)) {

691 if(
Àv
) {

692 
	`Ârötf
(
°dîr
, "Error: Width must be set "

695 
löe
, 
°©e
->
gamefûe
);

696 
îr
;

698 
°©e
->
width
 = 
	`°πﬁ
(
buf
 + 6, &
p
, 10);

699 if(*
p
Ë
∑r£îr
;

700 } if(!
	`memcmp
(
buf
, "Height ", 7)) {

701 if(
Àv
) {

702 
	`Ârötf
(
°dîr
, "Error: Height must be set "

705 
löe
, 
°©e
->
gamefûe
);

706 
îr
;

708 
°©e
->
height
 = 
	`°πﬁ
(
buf
 + 7, &
p
, 10);

709 if(*
p
Ë
∑r£îr
;

710 } if(!
	`memcmp
(
buf
, "BatHeight ", 10)) {

711 
°©e
->
b©height
 = 
	`°πﬁ
(
buf
 + 10, &
p
, 10);

712 if(*
p
Ë
∑r£îr
;

713 } if(!
	`memcmp
(
buf
, "NormalBatWidth ", 15)) {

714 
°©e
->
b©widths
[
NORMALBAT
] = 
	`°πﬁ
(
buf
 + 15, &
p
, 10);

715 if(*
p
Ë
∑r£îr
;

716 } if(!
	`memcmp
(
buf
, "SmallBatWidth ", 14)) {

717 
°©e
->
b©widths
[
SMALLBAT
] = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

718 if(*
p
Ë
∑r£îr
;

719 } if(!
	`memcmp
(
buf
, "LargeBatWidth ", 14)) {

720 
°©e
->
b©widths
[
LARGEBAT
] = 
	`°πﬁ
(
buf
 + 14, &
p
, 10);

721 if(*
p
Ë
∑r£îr
;

722 } if(!
	`memcmp
(
buf
, "NormalBat ", 10)) {

723 if(
°©e
->
b©s
[
NORMALBAT
]) {

724 
	`ªdeföew¨nög
("N‹mÆB©", 
löe
,

725 
°©e
->
gamefûe
);

726 
	`de°roy_•rôe
(
°©e
, sèã->
b©s
[
NORMALBAT
]);

728 if(!(
°©e
->
b©s
[
NORMALBAT
] = 
	`lﬂd_•rôe
(state,

729 
buf
 + 10, 
°©e
->
b©widths
[
NORMALBAT
],

730 
°©e
->
b©height
))) {

731 if(!(
°©e
->
b©s
[
NORMALBAT
] =

732 
	`make_em±y_•rôe
(
°©e
, 
buf
 + 10,

733 
°©e
->
b©widths
[
NORMALBAT
],

734 
°©e
->
b©height
))) {

735 
	`Ârötf
(
°dîr
, "Couldn't create "

738 "\"%s\"\n", 
löe
,

739 
°©e
->
gamefûe
);

740 
îr
;

742 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_RED
);

743 
	`GrFûlRe˘
(
°©e
->
b©s
[
NORMALBAT
]->
p
,

744 
°©e
->
gc
, 0, 0,

745 
°©e
->
b©widths
[
NORMALBAT
],

746 
°©e
->
b©height
);

747 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

748 
	`GrFûlRe˘
(
°©e
->
b©s
[
NORMALBAT
]->
a
,

749 
°©e
->
gc
, 0, 0,

750 
°©e
->
b©widths
[
NORMALBAT
],

751 
°©e
->
b©height
);

753 } if(!
	`memcmp
(
buf
, "SmallBat ", 9)) {

754 if(
°©e
->
b©s
[
SMALLBAT
]) {

755 
	`ªdeföew¨nög
("SmÆlB©", 
löe
,

756 
°©e
->
gamefûe
);

757 
	`de°roy_•rôe
(
°©e
, sèã->
b©s
[
SMALLBAT
]);

759 if(!(
°©e
->
b©s
[
SMALLBAT
] = 
	`lﬂd_•rôe
(state,

760 
buf
 + 9, 
°©e
->
b©widths
[
SMALLBAT
],

761 
°©e
->
b©height
))) {

762 if(!(
°©e
->
b©s
[
SMALLBAT
] =

763 
	`make_em±y_•rôe
(
°©e
, 
buf
 + 9,

764 
°©e
->
b©widths
[
SMALLBAT
],

765 
°©e
->
b©height
))) {

766 
	`Ârötf
(
°dîr
, "Couldn't create "

769 "\"%s\"\n", 
löe
,

770 
°©e
->
gamefûe
);

771 
îr
;

773 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_RED
);

774 
	`GrFûlRe˘
(
°©e
->
b©s
[
SMALLBAT
]->
p
,

775 
°©e
->
gc
, 0, 0,

776 
°©e
->
b©widths
[
SMALLBAT
],

777 
°©e
->
b©height
);

778 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

779 
	`GrFûlRe˘
(
°©e
->
b©s
[
SMALLBAT
]->
a
,

780 
°©e
->
gc
, 0, 0,

781 
°©e
->
b©widths
[
SMALLBAT
],

782 
°©e
->
b©height
);

784 } if(!
	`memcmp
(
buf
, "LargeBat ", 9)) {

785 if(
°©e
->
b©s
[
LARGEBAT
]) {

786 
	`ªdeföew¨nög
("L¨geB©", 
löe
,

787 
°©e
->
gamefûe
);

788 
	`de°roy_•rôe
(
°©e
, sèã->
b©s
[
LARGEBAT
]);

790 if(!(
°©e
->
b©s
[
LARGEBAT
] = 
	`lﬂd_•rôe
(state,

791 
buf
 + 9, 
°©e
->
b©widths
[
LARGEBAT
],

792 
°©e
->
b©height
))) {

793 if(!(
°©e
->
b©s
[
LARGEBAT
] =

794 
	`make_em±y_•rôe
(
°©e
, 
buf
 + 9,

795 
°©e
->
b©widths
[
LARGEBAT
],

796 
°©e
->
b©height
))) {

797 
	`Ârötf
(
°dîr
, "Couldn't create "

800 "\"%s\"\n", 
löe
,

801 
°©e
->
gamefûe
);

802 
îr
;

804 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_RED
);

805 
	`GrFûlRe˘
(
°©e
->
b©s
[
LARGEBAT
]->
p
,

806 
°©e
->
gc
, 0, 0,

807 
°©e
->
b©widths
[
LARGEBAT
],

808 
°©e
->
b©height
);

809 
	`GrSëGCF‹eground
(
°©e
->
gc
, 
GR_COLOR_WHITE
);

810 
	`GrFûlRe˘
(
°©e
->
b©s
[
LARGEBAT
]->
a
,

811 
°©e
->
gc
, 0, 0,

812 
°©e
->
b©widths
[
LARGEBAT
],

813 
°©e
->
b©height
);

815 } if(!
	`memcmp
(
buf
, "PowerSprite ", 12)) {

817 if(
	`∑r£_powî•rôe
(
°©e
, 
buf
 + 12, 
löe
)Ë
îr
;

818 } if(!
	`memcmp
(
buf
, "PowerUpTimeout ", 15)) {

819 
°©e
->
powîu±ime
 = 
	`°πﬁ
(
buf
 + 15, &
p
, 10);

820 if(*
p
Ë
∑r£îr
;

821 } if(!
	`memcmp
(
buf
, "PowerDownTimeout ", 17)) {

822 
°©e
->
powîdow¡ime
 = 
	`°πﬁ
(
buf
 + 17, &
p
, 10);

823 if(*
p
Ë
∑r£îr
;

824 } if(!
	`memcmp
(
buf
, "FadeRate ", 9)) {

825 
°©e
->
Ádî©e
 = 
	`°πﬁ
(
buf
 + 9, &
p
, 10);

826 if(*
p
Ë
∑r£îr
;

827 if(
°©e
->
Ádî©e
 > 255 || state->faderate < 0) {

828 
	`Ârötf
(
°dîr
, "Invalid fadeÑate onÜine "

829 "%d o‡gamêfûê\"%s\"\n", 
löe
,

830 
°©e
->
gamefûe
);

831 
îr
;

833 } if(!
	`memcmp
(
buf
, "SolidFloorCheat ", 16)) {

834 if(
°©e
->
chóts
[
SFCHEAT
]) {

835 
	`ªdeföew¨nög
("SﬁidFlo‹Chót", 
löe
,

836 
°©e
->
gamefûe
);

837 
	`‰ì
(
°©e
->
chóts
[
SFCHEAT
]);

839 if(!(
°©e
->
chóts
[
SFCHEAT
] = 
	`°rdup
(
buf
 + 16))) {

840 
	`oom
();

841 
îr
;

843 if(
	`°æí
(
°©e
->
chóts
[
SFCHEAT
]Ë> 
MAXCHEATLEN
) {

844 
	`Ârötf
(
°dîr
, "Cheat sequenceÅooÜong on "

846 
löe
, 
°©e
->
gamefûe
);

847 
îr
;

849 } if(!
	`memcmp
(
buf
, "TeleportCheat ", 14)) {

850 if(
°©e
->
chóts
[
TPCHEAT
]) {

851 
	`ªdeföew¨nög
("Tñï‹tChót", 
löe
,

852 
°©e
->
gamefûe
);

853 
	`‰ì
(
°©e
->
chóts
[
TPCHEAT
]);

855 if(!(
°©e
->
chóts
[
TPCHEAT
] = 
	`°rdup
(
buf
 + 14))) {

856 
	`oom
();

857 
îr
;

859 if(
	`°æí
(
°©e
->
chóts
[
TPCHEAT
]Ë> 
MAXCHEATLEN
) {

860 
	`Ârötf
(
°dîr
, "Cheat sequenceÅooÜong on "

862 
löe
, 
°©e
->
gamefûe
);

863 
îr
;

865 } if(!
	`memcmp
(
buf
, "NoBounceCheat ", 14)) {

866 if(
°©e
->
chóts
[
NBCHEAT
]) {

867 
	`ªdeföew¨nög
("NoBoun˚Chót", 
löe
,

868 
°©e
->
gamefûe
);

869 
	`‰ì
(
°©e
->
chóts
[
NBCHEAT
]);

871 if(!(
°©e
->
chóts
[
NBCHEAT
] = 
	`°rdup
(
buf
 + 14))) {

872 
	`oom
();

873 
îr
;

875 if(
	`°æí
(
°©e
->
chóts
[
NBCHEAT
]Ë> 
MAXCHEATLEN
) {

876 
	`Ârötf
(
°dîr
, "Cheat sequenceÅooÜong on "

878 
löe
, 
°©e
->
gamefûe
);

879 
îr
;

882 } if(!
	`memcmp
(
buf
, "NoPowerDownCheat ", 17)) {

883 if(
°©e
->
chóts
[
NPDCHEAT
]) {

884 
	`ªdeföew¨nög
("NoPowîDownChót", 
löe
,

885 
°©e
->
gamefûe
);

886 
	`‰ì
(
°©e
->
chóts
[
NPDCHEAT
]);

888 if(!(
°©e
->
chóts
[
NPDCHEAT
] = 
	`°rdup
(
buf
 + 17))) {

889 
	`oom
();

890 
îr
;

892 if(
	`°æí
(
°©e
->
chóts
[
NPDCHEAT
]Ë> 
MAXCHEATLEN
) {

893 
	`Ârötf
(
°dîr
, "Cheat sequenceÅooÜong on "

895 
löe
, 
°©e
->
gamefûe
);

896 
îr
;

899 } if(!
	`memcmp
(
buf
, "NoPowerUpTimeoutCheat ", 22)) {

900 if(
°©e
->
chóts
[
NPUTOCHEAT
]) {

901 
	`ªdeföew¨nög
("NoPowîUpTimeoutChót", 
löe
,

902 
°©e
->
gamefûe
);

903 
	`‰ì
(
°©e
->
chóts
[
NPUTOCHEAT
]);

905 if(!(
°©e
->
chóts
[
NPUTOCHEAT
] = 
	`°rdup
(
buf
 + 22))) {

906 
	`oom
();

907 
îr
;

909 if(
	`°æí
(
°©e
->
chóts
[
NPUTOCHEAT
]Ë> 
MAXCHEATLEN
) {

910 
	`Ârötf
(
°dîr
, "Cheat sequenceÅooÜong on "

912 
löe
, 
°©e
->
gamefûe
);

913 
îr
;

915 } if(!
	`memcmp
(
buf
, "BeginLevel", 10)) {

919 if(
öÀvñblock
) {

920 
	`Ârötf
(
°dîr
, "Error: BeginLevel while "

922 "o‡gamêfûê\"%s\"\n", 
löe
,

923 
°©e
->
gamefûe
);

924 
îr
;

926 
öÀvñblock
 = 1;

929 if(!(
Àv
 = 
	`mÆloc
((
Àvñ
)))) {

930 
	`oom
();

931 
îr
;

934 
Àv
->
bricks
 = 
NULL
;

935 
Àv
->
background«me
 = 
NULL
;

936 
Àv
->
backgroundtûed
 = 
DEFAULT_BACKGROUND_TILED
;

937 
Àv
->
numbricks
 = 0;

938 
Àv
->
√xt
 = 
NULL
;

941 if(!(
Àv
->
grid
 = 
	`√wgrid
(
°©e
))) {

942 
	`oom
();

943 
îr
;

948 if(!
°©e
->
Àvñs
Ë°©e->Àvñ†
Àv
;

950 
l
 = 
°©e
->
Àvñs
;Ü->
√xt
;Ü =Ü->next);

951 
l
->
√xt
 = 
Àv
;

953 } if(!
	`memcmp
(
buf
, "LevelBackground ", 16)) {

954 if(!
öÀvñblock
) {

955 
	`nŸöÀvblockîr
("LevñBackground", 
löe
,

956 
°©e
->
gamefûe
);

957 
îr
;

959 if(
Àv
->
background«me
) {

960 
	`ªdeföew¨nög
("LevñBackground", 
löe
,

961 
°©e
->
gamefûe
);

962 
	`‰ì
(
Àv
->
background«me
);

964 if(!(
Àv
->
background«me
 = 
	`°rdup
(
buf
 + 16))) {

965 
	`oom
();

966 
îr
;

968 } if(!
	`memcmp
(
buf
, "LevelBackgroundTiled ", 21)) {

969 if(!
öÀvñblock
) {

970 
	`nŸöÀvblockîr
("LevñBackgroundTûed", 
löe
,

971 
°©e
->
gamefûe
);

972 
îr
;

974 if(!
	`°rcmp
(
buf
 + 21, "Yes")Ë
Àv
->
backgroundtûed
 = 1;

975 if(!
	`°rcmp
(
buf
 + 21, "No"))

976 
Àv
->
backgroundtûed
 = 0;

977 
∑r£îr
;

978 } if(!
	`memcmp
(
buf
, "BeginRows", 9)) {

979 if(!
öÀvñblock
) {

980 
	`nŸöÀvblockîr
("BegöRows", 
löe
,

981 
°©e
->
gamefûe
);

982 
îr
;

985 if(
	`∑r£_rows
(
°©e
, 
Àv
, 
Â
, &
löe
)Ë
îr
;

986 } if(!
	`memcmp
(
buf
, "EndRows", 7)) {

989 
	`Ârötf
(
°dîr
, "Error: EndRows without corresponding "

991 "\"%s\"\n", 
löe
, 
°©e
->
gamefûe
);

992 
îr
;

993 } if(!
	`memcmp
(
buf
, "BeginPowers", 11)) {

994 if(!
öÀvñblock
) {

995 
	`nŸöÀvblockîr
("BegöPowîs", 
löe
,

996 
°©e
->
gamefûe
);

997 
îr
;

999 if(
	`∑r£_powîs
(
°©e
, 
Àv
, 
Â
, &
löe
)Ë
îr
;

1000 } if(!
	`memcmp
(
buf
, "EndPowers", 9)) {

1001 
	`Ârötf
(
°dîr
, "Error: EndPowers without "

1003 "o‡gamêfûê\"%s\"\n", 
löe
,

1004 
°©e
->
gamefûe
);

1005 
îr
;

1006 } if(!
	`memcmp
(
buf
, "EndLevel", 8)) {

1007 if(!
öÀvñblock
) {

1008 
	`Ârötf
(
°dîr
, "Error: EndLevel whileÇot in "

1010 "fûê\"%s\"\n", 
löe
, 
°©e
->
gamefûe
);

1011 
îr
;

1013 
öÀvñblock
 = 0;

1014 
°©e
->
numÀvñs
++;

1016 
	`Ârötf
(
°dîr
, "Unknown command \"%s\" onÜine %d "

1017 "o‡gamêfûê\"%s\"\n", 
buf
,

1018 
löe
, 
°©e
->
gamefûe
);

1022 
löe
++;

1027 if(
	`„º‹
(
Â
)) {

1028 
	`Ârötf
(
°dîr
, "ErrorÑeading from game file \"%s\" onÜine "

1029 "%d: %s\n", 
°©e
->
gamefûe
, 
löe
,

1030 
	`°ªº‹
(
î∫o
));

1031 
îr
;

1035 if(!(
°©e
->
grid
 = 
	`√wgrid
(state))) {

1036 
	`oom
();

1037 
îr
;

1040 
	`f˛o£
(
Â
);

1044 
∑r£îr
:

1045 
	`Ârötf
(
°dîr
, "P¨£Éº‹ o¿löê%d o‡gamêfûê\"%s\"\n", 
löe
,

1046 
°©e
->
gamefûe
);

1047 
îr
:

1048 
	`f˛o£
(
Â
);

1050 
	}
}

	@demos/nbreaker/misc.c

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

41 
	~<«no-X.h
>

42 
	~<nxcﬁ‹s.h
>

43 
	~"nbªakî.h
"

48 
	$my‰ì
(*
p
)

50 if(
p
Ë
	`‰ì
(p);

51 
	}
}

54 
	$oom
()

56 
	`Ârötf
(
°dîr
, "Out of memory\n");

57 
	}
}

	@demos/nbreaker/nbreaker.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

39 
	~<«no-X.h
>

40 
	~<nxcﬁ‹s.h
>

41 
	~"nbªakî.h
"

51 
	$˛ónup
(
nb°©e
 *
°©e
)

53 
i
;

54 #ifde‡
THOROUGH_CLEANUP


55 
brick
 *
b
, *
b√xt
 = 
°©e
->
bricks
;

56 
Àvñ
 *
l
, *
 ext
 = 
°©e
->
Àvñs
;

57 
powî
 *
p
, *
≤ext
 = 
°©e
->
powîs
;

60 
	`ßve_hisc‹e
(
°©e
);

62 #ifde‡
THOROUGH_CLEANUP


65 (
b
 = 
b√xt
)) {

66 
b√xt
 = 
b
->
√xt
;

67 
	`‰ì
(
b
);

70 
	`de°roy_Æl_•rôes
(
°©e
);

73 
	`GrDe°royWödow
(
°©e
->
wid
);

74 
	`GrDe°royWödow
(
°©e
->
ˇnvas
);

76 if(
°©e
->
Ádî©e
) {

77 
	`GrDe°royWödow
(
°©e
->
√wˇnvas
);

78 
	`GrDe°royWödow
(
°©e
->
ﬁdˇnvas
);

80 
	`GrDe°royWödow
(
°©e
->
sc‹es
.
p
);

81 
	`GrDe°royWödow
(
°©e
->
brickÆpha
);

82 
	`GrDe°royTimî
(
°©e
->
tid
);

85 
	`my‰ì
(
°©e
->
tôÀbackground
);

86 
	`my‰ì
(
°©e
->
tôÀ•œsh
);

87 
	`my‰ì
(
°©e
->
gamew⁄•œsh
);

88 
	`my‰ì
(
°©e
->
gamño°•œsh
);

91 
i
 = 0; i < 
NUMCHEATS
; i++Ë
	`my‰ì
(
°©e
->
chóts
[i]);

94 (
l
 = 
 ext
)) {

95 
 ext
 = 
l
->
√xt
;

96 
b√xt
 = 
l
->
bricks
;

98 (
b
 = 
b√xt
)) {

99 
b√xt
 = 
b
->
√xt
;

100 
	`‰ì
(
b
);

102 
	`my‰ì
(
l
->
grid
);

103 
	`my‰ì
(
l
->
background«me
);

104 
	`‰ì
(
l
);

107 
	`my‰ì
(
°©e
->
grid
);

110 (
p
 = 
≤ext
)) {

111 
≤ext
 = 
p
->
√xt
;

112 
	`‰ì
(
p
);

115 
	`‰ì
(
°©e
);

117 
	`GrClo£
();

118 
	}
}

124 
	$ˇlc_timeout
(
nb°©e
 *
°©e
)

126 
ñ≠£d
;

127 
timevÆ
 
tv
;

129 
	`gëtimeofday
(&
tv
, 
NULL
);

133 
ñ≠£d
 = ((
tv
.
tv_£c
 - 
°©e
->
œ°™im
.tv_sec) * 1000) +

134 ((
tv
.
tv_u£c
 - 
°©e
->
œ°™im
.tv_usec) / 1000);

137  
°©e
->
™im©ïîiod
 - 
ñ≠£d
;

138 
	}
}

143 
	$nbªakî
(
nb°©e
 *
°©e
)

145 
GR_EVENT
 
ev
;

146 
timeout
;

151 if(
°©e
->°©ê=
STATE_RUNNING
 ||

152 
°©e
->°©ê=
STATE_FADING
) {

153 if((
timeout
 = 
	`ˇlc_timeout
(
°©e
)) <= 0) {

157 
	`gëtimeofday
(&
°©e
->
œ°™im
, 
NULL
);

158 
	`™im©e
(
°©e
);

166 if((
timeout
 = 
	`ˇlc_timeout
(
°©e
)) <= 0)

167 
timeout
 = 1;

169 } 
timeout
 = 0;

173 
	`GrGëNextEvítTimeout
(&
ev
, 
timeout
);

177 
ev
.
ty≥
) {

178 
GR_EVENT_TYPE_CLOSE_REQ
:

179 
°©e
->°©ê
STATE_FINISHED
;

181 
GR_EVENT_TYPE_EXPOSURE
:

182 
	`h™dÀ_exposuª_evít
(
°©e
, &
ev
.
exposuª
);

184 
GR_EVENT_TYPE_BUTTON_DOWN
:

185 
	`h™dÀ_buâ⁄_evít
(
°©e
, &
ev
.
buâ⁄
);

187 
GR_EVENT_TYPE_MOUSE_POSITION
:

188 
	`h™dÀ_mou£_evít
(
°©e
, &
ev
.
mou£
);

190 
GR_EVENT_TYPE_KEY_UP
:

191 
GR_EVENT_TYPE_KEY_DOWN
:

192 if(
	`h™dÀ_key°roke_evít
(
°©e
, &
ev
.
key°roke
))

193 
°©e
->°©ê
STATE_FINISHED
;

195 
GR_EVENT_TYPE_UPDATE
:

196 
	`h™dÀ_upd©e_evít
(
°©e
, &
ev
.
upd©e
);

198 
GR_EVENT_TYPE_TIMER
:

199 
	`h™dÀ_timî_evít
(
°©e
, &
ev
.
timî
);

201 
GR_EVENT_TYPE_TIMEOUT
:

205 
	`Ârötf
(
°dîr
, "Got unknownÉventÅype %d\n",

206 
ev
.
ty≥
);

211 } 
°©e
->°©ê!
STATE_FINISHED
);

212 
	}
}

214 
	$maö
(
¨gc
, *
¨gv
[])

216 
nb°©e
 *
°©e
;

218 if(!(
°©e
 = 
	`öô
(
¨gc
, 
¨gv
)))  1;

219 
	`nbªakî
(
°©e
);

220 
	`˛ónup
(
°©e
);

223 
	}
}

	@demos/nbreaker/nbreaker.h

37 #i‚de‡
NBREAKER_H


38 
	#NBREAKER_H


	)

42 
	#NB_DEBUG


	)

46 
	#DEBUG_POWERS


	)

51 
	#THOROUGH_CLEANUP


	)

54 
	#DEFAULT_GAME_DIR
 "/u§/sh¨e/nbªakî"

	)

56 
	#DEFAULT_GAME_FILE
 "deÁu….nbk"

	)

58 
	#DEFAULT_BACKGROUND_TILED
 1

	)

60 
	#DEFAULT_NORMALPOINTS
 1

	)

62 
	#DEFAULT_SMALLBONUSPOINTS
 5

	)

64 
	#DEFAULT_MEDIUMBONUSPOINTS
 25

	)

66 
	#DEFAULT_LARGEBONUSPOINTS
 150

	)

68 
	#DEFAULT_HUGEBONUSPOINTS
 1000

	)

70 
	#DEFAULT_POWERUPPOINTS
 20

	)

72 
	#DEFAULT_POWERDOWNPOINTS
 -10

	)

74 
	#DEFAULT_STARTBALLS
 5

	)

76 
	#DEFAULT_NEWLEVELBALLS
 2

	)

78 
	#DEFAULT_BRICK_WIDTH
 40

	)

80 
	#DEFAULT_BRICK_HEIGHT
 20

	)

82 
	#DEFAULT_BAT_HEIGHT
 25

	)

84 
	#DEFAULT_NORMALBAT_WIDTH
 60

	)

86 
	#DEFAULT_SMALLBAT_WIDTH
 40

	)

88 
	#DEFAULT_LARGEBAT_WIDTH
 80

	)

90 
	#DEFAULT_POWERUP_TIME
 30

	)

92 
	#DEFAULT_POWERDOWN_TIME
 20

	)

94 
	#DEFAULT_WIDTH
 15

	)

96 
	#DEFAULT_HEIGHT
 15

	)

98 
	#DEFAULT_POWER_WIDTH
 80

	)

100 
	#DEFAULT_POWER_HEIGHT
 35

	)

102 
	#DEFAULT_BALL_SIZE
 20

	)

104 
	#DEFAULT_BAT_VELOCITY
 10

	)

106 
	#DEFAULT_ANIMATE_PERIOD
 20

	)

108 
	#DEFAULT_SLOW_BALL_VELOCITY
 4

	)

110 
	#DEFAULT_NORMAL_BALL_VELOCITY
 8

	)

112 
	#DEFAULT_FAST_BALL_VELOCITY
 12

	)

114 
	#DEFAULT_POWER_VELOCITY
 10

	)

116 
	#DEFAULT_FADERATE
 10

	)

119 
	#HISCORE_FILE
 "hisc‹e"

	)

121 
	#SCORE_FONT
 
GR_FONT_SYSTEM_VAR


	)

123 
	#SCORE_FGCOLOUR
 
GR_COLOR_WHITE


	)

125 
	#SCORE_BGCOLOUR
 
GR_COLOR_BLACK


	)

127 
	#SCORE_ALPHACOLOUR
 
GR_COLOR_GREY40


	)

129 
	#SCORE_BORDER
 4

	)

131 
	#BALLS_BORDER
 4

	)

133 
	#MAXCHEATLEN
 16

	)

138 
	#NUMBATS
 3

	)

140 
	#NUMPOWERS
 6

	)

142 
	#NUMCHEATS
 5

	)

146 
	mx
;

147 
	my
;

148 } 
	tco‹ds
;

151 
	s_•rôe
 {

154 *
	m‚ame
;

156 
	mw
;

157 
	mh
;

160 
GR_PIXMAP_ID
 
	mp
;

161 
GR_ALPHA_ID
 
	ma
;

165 
	mußge
;

169 
_•rôe
 *
	m√xt
;

170 
_•rôe
 *
	m¥ev
;

172 
_•rôe
 
	t•rôe
;

176 
	s_brick
 {

178 
•rôe
 *
	ms
;

181 
	midítifõr
;

183 
	mÊags
;

186 
_brick
 *
	m√xt
;

188 
_brick
 
	tbrick
;

195 
brick
 *
	mb
;

198 
	mx
;

199 
	my
;

203 
	mhôs
;

206 
	mpowî
;

207 } 
	tgrid
;

211 
	s_Àvñ
 {

213 
brick
 *
	mbricks
;

215 *
	mbackground«me
;

217 
	mbackgroundtûed
;

221 
	mnumbricks
;

223 
grid
 *
	mgrid
;

225 
_Àvñ
 *
	m√xt
;

227 
_Àvñ
 
	tÀvñ
;

232 
	s_powî
 {

234 
	mty≥
;

236 
	mx
;

237 
	my
;

239 
_powî
 *
	m√xt
;

241 
_powî
 
	tpowî
;

246 
	ms
;

248 
	mhi
;

251 
	mfhi
;

254 
GR_PIXMAP_ID
 
	mp
;

257 
GR_ALPHA_ID
 
	ma
;

260 
	mh
;

261 } 
	tsc‹es_t
;

267 
	mx
;

268 
	my
;

271 
	md
;

273 
	mv
;

276 
	mlx
;

277 
	mly
;

279 
	m∑rked
;

281 
•rôe
 *
	ms
;

283 
	msv
;

285 
	mnv
;

287 
	mfv
;

288 } 
	tbÆl_t
;

293 
	msf
 : 1;

295 
	mnb
 : 1;

297 
	m≈d
 : 1;

299 
	m≈uto
 : 1;

301 
	m∑u£d
 : 1;

303 
	mÀ·
 : 1;

305 
	mright
 : 1;

306 } 
	tÊags_t
;

311 
	mwideb©
;

312 
	m¶owmŸi⁄
;

313 
	m°ickyb©
;

314 
	mpowîbÆl
;

315 
	m«ºowb©
;

316 
	mÁ°mŸi⁄
;

317 } 
	tpowîtimes_t
;

319 
	~<sys/time.h
>

325 
	m°©e
;

327 *
	mgamedú
;

329 *
	mgamefûe
;

331 *
	mtôÀbackground
;

333 
	mtôÀbackgroundtûed
;

335 *
	mtôÀ•œsh
;

337 *
	mgamew⁄•œsh
;

339 *
	mgamño°•œsh
;

341 
•rôe
 *
	m•rôñi°
;

343 
•rôe
 *
	mbackground
;

345 
	mbackgroundtûed
;

347 
	mn‹mÆpoöts
;

349 
	msmÆlb⁄u•oöts
;

351 
	mmediumb⁄u•oöts
;

353 
	mœrgeb⁄u•oöts
;

355 
	mhugeb⁄u•oöts
;

357 
	mpowîuµoöts
;

360 
	mpowîdow≈oöts
;

362 
	m°¨tbÆls
;

364 
	m√wÀvñbÆls
;

366 
	mbrickwidth
;

368 
	mbrickheight
;

370 
brick
 *
	mbricks
;

374 
GR_ALPHA_ID
 
	mbrickÆpha
;

376 
	mwidth
;

378 
	mheight
;

380 
	mb©height
;

382 
	mb©widths
[
NUMBATS
];

384 
	mb©
;

386 
	mb©x
;

388 
	mb©v
;

390 
	mpowîv
;

392 
	m™im©ïîiod
;

394 
•rôe
 *
	mb©s
[
NUMBATS
];

396 
•rôe
 *
	mpowî•rôes
[
NUMPOWERS
];

398 
•rôe
 *
	m•œsh
;

400 
	mpowîu±ime
;

402 
	mpowîdow¡ime
;

404 *
	mchóts
[
NUMCHEATS
];

407 
	mchót°©e
[
MAXCHEATLEN
 + 1];

409 
Êags_t
 
	mÊags
;

411 
Àvñ
 *
	mÀvñs
;

413 
	mÀvñ
;

415 
	mnumÀvñs
;

417 
GR_GC_ID
 
	mgc
;

419 
GR_WINDOW_ID
 
	mwid
;

425 
GR_COORD
 
	mwöx
;

429 
GR_PIXMAP_ID
 
	mˇnvas
;

431 
GR_PIXMAP_ID
 
	mﬁdˇnvas
;

432 
GR_PIXMAP_ID
 
	m√wˇnvas
;

435 
GR_TIMER_ID
 
	mtid
;

437 
	mˇnvaswidth
;

439 
	mˇnvasheight
;

441 
grid
 *
	mgrid
;

443 
	mnumbricks
;

445 
powî
 *
	mpowîs
;

447 
bÆl_t
 
	mbÆl
;

449 
	mnumbÆls
;

451 
sc‹es_t
 
	msc‹es
;

454 
timevÆ
 
	mœ°™im
;

456 
powîtimes_t
 
	mpowîtimes
;

458 
	mÁdî©e
;

460 
	mÁdñevñ
;

462 
	m√xt°©e
;

463 } 
	tnb°©e
;

468 
	#BRICK_FLAG_IMMUTABLE
 (1 << 0)

	)

470 
	#BRICK_FLAG_2_HITS
 (1 << 1)

	)

472 
	#BRICK_FLAG_3_HITS
 (1 << 2)

	)

474 
	#BRICK_FLAG_SMALL_BONUS
 (1 << 3)

	)

476 
	#BRICK_FLAG_MEDIUM_BONUS
 (1 << 4)

	)

478 
	#BRICK_FLAG_LARGE_BONUS
 (1 << 5)

	)

480 
	#BRICK_FLAG_HUGE_BONUS
 (1 << 6)

	)

485 
	mNORMALBAT
 = 0,

487 
	mSMALLBAT
,

489 
	mLARGEBAT


495 
	mNOPOWER
 = -1,

497 
	mPOWERW
,

499 
	mPOWERS
,

501 
	mPOWERT
,

503 
	mPOWERP
,

505 
	mPOWERN
,

507 
	mPOWERF
,

513 
	mSFCHEAT
 = 0,

515 
	mTPCHEAT
,

517 
	mNBCHEAT
,

519 
	mNPDCHEAT
,

521 
	mNPUTOCHEAT


527 
	mSTATE_TITLESCREEN
,

529 
	mSTATE_FADING
,

531 
	mSTATE_RUNNING
,

533 
	mSTATE_GAMEWON
,

535 
	mSTATE_GAMELOST
,

537 
	mSTATE_FINISHED


543 
™im©e
(
nb°©e
 *
°©e
);

546 
lo°_bÆl
(
nb°©e
 *
°©e
);

547 
∑rk_bÆl
(
nb°©e
 *
°©e
);

548 
move_bÆl
(
nb°©e
 *
°©e
);

549 
ˇlc_√w_bÆl_co‹ds
(
nb°©e
 *
°©e
, 
co‹ds
 *
c
);

550 
check_bÆl_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
co‹ds
 *
c
);

551 
ªdøw_bÆl
(
nb°©e
 *
°©e
);

554 
ch™ge_b©
(
nb°©e
 *
°©e
, 
√wb©
);

555 
move_b©
(
nb°©e
 *
°©e
, 
x
);

558 
brick_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
grid
 *
g
);

561 
do_chót
(
nb°©e
 *
°©e
, 
GR_KEY
 
key
);

564 
døw_background
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
);

565 
døw_•œsh
(
nb°©e
 *
°©e
);

566 
døw_brick
(
nb°©e
 *
°©e
, 
grid
 *
g
, 
x
, 
y
, 
w
, 
h
);

567 
døw_bricks
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
);

568 
døw_b©
(
nb°©e
 *
°©e
);

569 
døw_bÆl
(
nb°©e
 *
°©e
);

570 
døw_bÆls
(
nb°©e
 *
°©e
);

571 
døw_sc‹es
(
nb°©e
 *
°©e
);

572 
døw_powî
(
nb°©e
 *
°©e
, 
powî
 *
p
, 
x
, 
y
, 
w
, 
h
);

573 
døw_ˇnvas
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
);

575 #ifde‡
NB_DEBUG


577 
dump_°©e
(
nb°©e
 *
°©e
);

581 
h™dÀ_exposuª_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_EXPOSURE
 *
ev
);

582 
h™dÀ_buâ⁄_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_BUTTON
 *
ev
);

583 
h™dÀ_mou£_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_MOUSE
 *
ev
);

584 
h™dÀ_key°roke_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_KEYSTROKE
 *
ev
);

585 
h™dÀ_upd©e_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_UPDATE
 *
ev
);

586 
h™dÀ_timî_evít
(
nb°©e
 *
°©e
, 
GR_EVENT_TIMER
 *
ev
);

589 
ª£t_game
(
nb°©e
 *
°©e
);

592 
nb°©e
 *
öô
(
¨gc
, *
¨gv
[]);

595 
ö¸emít_Àvñ
(
nb°©e
 *
°©e
);

596 
£t_Àvñ_a˘ive
(
nb°©e
 *
°©e
);

599 
lﬂd_game_fûe
(
nb°©e
 *
°©e
);

602 
my‰ì
(*
p
);

603 
oom
();

606 
a˘iv©e_wideb©
(
nb°©e
 *
°©e
);

607 
a˘iv©e_¶owmŸi⁄
(
nb°©e
 *
°©e
);

608 
a˘iv©e_°ickyb©
(
nb°©e
 *
°©e
);

609 
a˘iv©e_powîbÆl
(
nb°©e
 *
°©e
);

610 
a˘iv©e_«ºowb©
(
nb°©e
 *
°©e
);

611 
a˘iv©e_Á°mŸi⁄
(
nb°©e
 *
°©e
);

612 
do_powî_timîs
(
nb°©e
 *
°©e
);

613 
√w_powî
(
nb°©e
 *
°©e
, 
ty≥
, 
x
, 
y
);

614 
ªdøw_powîs
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
);

615 
de°roy_powî
(
nb°©e
 *
°©e
, 
powî
 *
p
);

616 
powî_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
powî
 *
p
);

617 
™im©e_powîs
(
nb°©e
 *
°©e
);

620 
ö¸emít_sc‹e
(
nb°©e
 *
°©e
, 
poöts
);

621 
lﬂd_hisc‹e
(
nb°©e
 *
°©e
);

622 
ßve_hisc‹e
(
nb°©e
 *
°©e
);

625 
•rôe
 *
make_em±y_•rôe
(
nb°©e
 *
°©e
, *
‚ame
, 
width
, 
height
);

626 
•rôe
 *
lﬂd_•rôe
(
nb°©e
 *
°©e
, *
‚ame
, 
width
, 
height
);

627 
de°roy_•rôe
(
nb°©e
 *
°©e
, 
•rôe
 *
s
);

628 
de°roy_Æl_•rôes
(
nb°©e
 *
°©e
);

	@demos/nbreaker/powers.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

39 
	~<«no-X.h
>

40 
	~<nxcﬁ‹s.h
>

41 
	~"nbªakî.h
"

44 
	$a˘iv©e_wideb©
(
nb°©e
 *
°©e
)

47 
°©e
->
powîtimes
.
wideb©
 = sèã->
powîu±ime
;

50 
°©e
->
powîtimes
.
«ºowb©
 = 0;

53 
	`ch™ge_b©
(
°©e
, 
LARGEBAT
);

54 
	}
}

57 
	$a˘iv©e_¶owmŸi⁄
(
nb°©e
 *
°©e
)

60 
°©e
->
powîtimes
.
¶owmŸi⁄
 = sèã->
powîu±ime
;

63 
°©e
->
powîtimes
.
Á°mŸi⁄
 = 0;

66 
°©e
->
bÆl
.
v
 = sèã->bÆl.
sv
;

67 
	}
}

70 
	$a˘iv©e_°ickyb©
(
nb°©e
 *
°©e
)

73 
°©e
->
powîtimes
.
°ickyb©
 = sèã->
powîu±ime
;

74 
	}
}

77 
	$a˘iv©e_powîbÆl
(
nb°©e
 *
°©e
)

80 
°©e
->
powîtimes
.
powîbÆl
 = sèã->
powîu±ime
;

81 
	}
}

84 
	$a˘iv©e_«ºowb©
(
nb°©e
 *
°©e
)

87 
°©e
->
powîtimes
.
«ºowb©
 = sèã->
powîdow¡ime
;

90 
°©e
->
powîtimes
.
wideb©
 = 0;

93 
	`ch™ge_b©
(
°©e
, 
SMALLBAT
);

94 
	}
}

97 
	$a˘iv©e_Á°mŸi⁄
(
nb°©e
 *
°©e
)

100 
°©e
->
powîtimes
.
Á°mŸi⁄
 = sèã->
powîdow¡ime
;

103 
°©e
->
powîtimes
.
¶owmŸi⁄
 = 0;

106 
°©e
->
bÆl
.
v
 = sèã->bÆl.
fv
;

107 
	}
}

113 
	$dec_powî
(*
i
)

115 
tmp
 = *
i
 - 1;

116 if(
tmp
 >0Ë*
i
 =Åmp;

117  
tmp
;

118 
	}
}

122 
	$do_powî_timîs
(
nb°©e
 *
°©e
)

126 if(!
°©e
->
Êags
.
≈uto
) {

129 if(!
	`dec_powî
(&
°©e
->
powîtimes
.
wideb©
))

130 
	`ch™ge_b©
(
°©e
, 
NORMALBAT
);

133 if(!
	`dec_powî
(&
°©e
->
powîtimes
.
¶owmŸi⁄
))

134 
°©e
->
bÆl
.
v
 = sèã->bÆl.
nv
;

136 
	`dec_powî
(&
°©e
->
powîtimes
.
°ickyb©
);

137 
	`dec_powî
(&
°©e
->
powîtimes
.
powîbÆl
);

141 if(!
	`dec_powî
(&
°©e
->
powîtimes
.
«ºowb©
))

142 
	`ch™ge_b©
(
°©e
, 
NORMALBAT
);

145 if(!
	`dec_powî
(&
°©e
->
powîtimes
.
Á°mŸi⁄
))

146 
°©e
->
bÆl
.
v
 = sèã->bÆl.
nv
;

147 
	}
}

151 
	$√w_powî
(
nb°©e
 *
°©e
, 
ty≥
, 
x
, 
y
)

153 
powî
 *
p
, *
≤
;

154 
•rôe
 *
s
 = 
°©e
->
powî•rôes
[
ty≥
];

157 if(!(
p
 = 
	`mÆloc
((
powî
)))) {

158 
	`oom
();

163 
p
->
ty≥
 =Åype;

164 
p
->
y
 = y;

168 
p
->
x
 = x - (
s
->
w
 / 2);

172 if(
p
->
x
 < 0)Ö->x = 0;

173 if(
p
->
x
 + 
s
->
w
 > 
°©e
->
ˇnvaswidth
)

174 
p
->
x
 = 
°©e
->
ˇnvaswidth
 - 
s
->
w
;

176 
p
->
√xt
 = 
NULL
;

179 if(!
°©e
->
powîs
Ë°©e->powî†
p
;

182 
≤
 = 
°©e
->
powîs
;Ön->
√xt
;Ön =Ön->next);

183 
≤
->
√xt
 = 
p
;

187 
	`døw_powî
(
°©e
, 
p
,Ö->
x
,Ö->
y
, 
s
->
w
, s->
h
);

190 
	`døw_ˇnvas
(
°©e
, 
p
->
x
,Ö->
y
, 
s
->
w
, s->
h
);

191 
	}
}

196 
	$ªdøw_powîs
(
nb°©e
 *
°©e
, 
x
, 
y
, 
w
, 
h
)

198 
powî
 *
p
;

199 
•rôe
 *
s
;

200 
px
, 
py
, 
pxx
, 
pyy
, 
pw
, 
ph
;

203 
p
 = 
°©e
->
powîs
;Ö;Ö =Ö->
√xt
) {

206 
s
 = 
°©e
->
powî•rôes
[
p
->
ty≥
];

209 if(
x
 > 
p
->xË
px
 = x;

210 
px
 = 
p
->
x
;

213 if(
y
 > 
p
->yË
py
 = y;

214 
py
 = 
p
->
y
;

217 if(
x
 + 
w
 > 
p
->x + 
s
->wË
pxx
 =Ö->x + s->w;

218 
pxx
 = 
x
 + 
w
;

221 if(
y
 + 
h
 > 
p
->y + 
s
->hË
pyy
 =Ö->y + s->h;

222 
pyy
 = 
y
 + 
h
;

225 
pw
 = 
pxx
 - 
px
;

226 
ph
 = 
pyy
 - 
py
;

229 if(
pw
 > 0 && 
ph
 > 0Ë
	`døw_powî
(
°©e
, 
p
, 
px
, 
py
,Öw,Öh);

231 
	}
}

234 
	$de°roy_powî
(
nb°©e
 *
°©e
, 
powî
 *
p
)

236 
powî
 *
µ
;

239 if(
p
 =
°©e
->
powîs
Ë°©e->powî†p->
√xt
;

242 
µ
 = 
°©e
->
powîs
;Ö∞&&Öp->
√xt
 !
p
;Öp =Öp->next);

245 if(!
µ
) {

246 
	`Ârötf
(
°dîr
, "InternalÉrror: couldn't find "

252 
µ
->
√xt
 = 
p
->next;

256 
	`‰ì
(
p
);

257 
	}
}

261 
	$powî_cﬁlisi⁄
(
nb°©e
 *
°©e
, 
powî
 *
p
)

263 
p
->
ty≥
) {

264 
POWERW
:

265 
	`a˘iv©e_wideb©
(
°©e
);

267 
POWERS
:

268 
	`a˘iv©e_¶owmŸi⁄
(
°©e
);

270 
POWERT
:

271 
	`a˘iv©e_°ickyb©
(
°©e
);

273 
POWERP
:

274 
	`a˘iv©e_powîbÆl
(
°©e
);

276 
POWERN
:

277 
	`a˘iv©e_«ºowb©
(
°©e
);

279 
POWERF
:

280 
	`a˘iv©e_Á°mŸi⁄
(
°©e
);

283 
	}
}

288 
	$™im©e_powîs
(
nb°©e
 *
°©e
)

290 
•rôe
 *
s
;

291 
powî
 *
p
, *
≤ext
;

294 
p
 = 
°©e
->
powîs
;Ö;Ö = 
≤ext
) {

298 
≤ext
 = 
p
->
√xt
;

301 
s
 = 
°©e
->
powî•rôes
[
p
->
ty≥
];

304 
	`døw_background
(
°©e
, 
p
->
x
,Ö->
y
, 
s
->
w
, s->
h
);

307 
	`døw_bricks
(
°©e
, 
p
->
x
,Ö->
y
, 
s
->
w
, s->
h
);

310 
p
->
y
 +
°©e
->
powîv
;

313 if(
p
->
y
 + 
s
->
h
 > 
°©e
->
ˇnvasheight
) {

316 
	`døw_ˇnvas
(
°©e
, 
p
->
x
,Ö->
y
 - sèã->
powîv
,

317 
s
->
w
, s->
h
);

320 
	`de°roy_powî
(
°©e
, 
p
);

323 } if(
p
->
y
 + 
s
->
h
 > 
°©e
->
ˇnvasheight
 - sèã->
b©height


324 && 
p
->
x
 + 
s
->
w
 > 
°©e
->
b©x
 -

325 (
°©e
->
b©widths
[°©e->
b©
] / 2) &&

326 
p
->
x
 < 
°©e
->
b©x
 +

327 (
°©e
->
b©widths
[°©e->
b©
] / 2)) {

330 
	`døw_ˇnvas
(
°©e
, 
p
->
x
,Ö->
y
 - sèã->
powîv
,

331 
s
->
w
, s->
h
);

334 
	`powî_cﬁlisi⁄
(
°©e
, 
p
);

337 
	`de°roy_powî
(
°©e
, 
p
);

341 
	`døw_powî
(
°©e
, 
p
,Ö->
x
,Ö->
y
, 
s
->
w
, s->
h
);

346 
	`ªdøw_bÆl
(
°©e
);

349 
p
 = 
°©e
->
powîs
;Ö;Ö =Ö->
√xt
)

350 
	`døw_ˇnvas
(
°©e
, 
p
->
x
,Ö->
y
 - sèã->
powîv
, 
s
->
w
,

351 
s
->
h
 + 
°©e
->
powîv
);

353 
	}
}

	@demos/nbreaker/scores.c

36 
	~<î∫o.h
>

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

41 
	~<«no-X.h
>

42 
	~<nxcﬁ‹s.h
>

43 
	~"nbªakî.h
"

46 
	$ö¸emít_sc‹e
(
nb°©e
 *
°©e
, 
poöts
)

48 
°©e
->
sc‹es
.
s
 +
poöts
;

49 
	`døw_sc‹es
(
°©e
);

51 
	`døw_ˇnvas
(
°©e
, 0, 0, sèã->
ˇnvaswidth
, sèã->
sc‹es
.
h
);

52 
	}
}

55 
	$lﬂd_hisc‹e
(
nb°©e
 *
°©e
)

57 
FILE
 *
Â
;

58 
i
, 
n
;

59 
buf
[256];

62 
	`¢¥ötf
(
buf
, 256, "%s/"
HISCORE_FILE
, 
°©e
->
gamedú
);

65 if(!(
Â
 = 
	`f›í
(
buf
, "r"))) {

70 if(
î∫o
 !
ENOENT
)

71 
	`Ârötf
(
°dîr
, "Couldn't open high score file \"%s\""

72 "f‹Ñódög: %s\n", 
buf
, 
	`°ªº‹
(
î∫o
));

74 
°©e
->
sc‹es
.
hi
 = sèã->sc‹es.
fhi
 = 0;

78 
i
 = 
	`fsˇnf
(
Â
, "%d", &
n
);

80 
	`f˛o£
(
Â
);

84 if(
i
 != 1) {

85 
	`Ârötf
(
°dîr
, "Couldn'tÑead high score file\n");

86 
n
 = 0;

91 
°©e
->
sc‹es
.
hi
 = sèã->sc‹es.
fhi
 = 
n
;

92 
	}
}

95 
	$ßve_hisc‹e
(
nb°©e
 *
°©e
)

97 
FILE
 *
Â
;

98 
buf
[256];

101 if(
°©e
->
sc‹es
.
s
 > sèã->sc‹es.
hi
)

102 
°©e
->
sc‹es
.
hi
 = sèã->sc‹es.
s
;

108 if(
°©e
->
sc‹es
.
hi
 <°©e->sc‹es.
fhi
) ;

111 
	`¢¥ötf
(
buf
, 256, "%s/"
HISCORE_FILE
, 
°©e
->
gamedú
);

115 if(!(
Â
 = 
	`f›í
(
buf
, "w"))) {

116 
	`Ârötf
(
°dîr
, "Couldn't open high score file for writing: "

117 "%s\n", 
	`°ªº‹
(
î∫o
));

123 if((
	`Ârötf
(
Â
, "%d", 
°©e
->
sc‹es
.
hi
)) == -1) {

124 
	`Ârötf
(
°dîr
, "Couldn't writeÅo high score file: %s",

125 
	`°ªº‹
(
î∫o
));

127 } 
°©e
->
sc‹es
.
fhi
 = sèã->sc‹es.
hi
;

129 
	`f˛o£
(
Â
);

130 
	}
}

	@demos/nbreaker/sprite.c

43 
	~<°dio.h
>

44 
	~<°dlib.h
>

45 
	~<°rög.h
>

47 
	~<«no-X.h
>

48 
	~"nbªakî.h
"

53 
•rôe
 *
	$make_•rôe
(
nb°©e
 *
°©e
, *
‚ame
, 
w
, 
h
,

54 
GR_PIXMAP_ID
 
p
, 
GR_ALPHA_ID
 
a
)

56 
•rôe
 *
s
;

59 if(!(
s
 = 
	`mÆloc
((
•rôe
)))) {

60 
	`oom
();

61  
NULL
;

65 if(!
‚ame
Ë
s
->‚amê
NULL
;

67 if(!(
s
->
‚ame
 = 
	`°rdup
(fname))) {

68 
	`oom
();

69 
	`‰ì
(
s
);

70  
NULL
;

75 
s
->
w
 = w;

76 
s
->
h
 = h;

77 
s
->
p
 =Ö;

78 
s
->
a
 =á;

79 
s
->
ußge
 = 1;

82 
s
->
√xt
 = 
°©e
->
•rôñi°
;

83 if(
s
->
√xt
Ës->√xt->
¥ev
 = s;

84 
s
->
¥ev
 = 
NULL
;

85 
°©e
->
•rôñi°
 = 
s
;

87  
s
;

88 
	}
}

94 
•rôe
 *
	$make_em±y_•rôe
(
nb°©e
 *
°©e
, *
‚ame
, 
width
, 
height
)

96 
•rôe
 *
s
;

97 
GR_ALPHA_ID
 
a
;

98 
GR_PIXMAP_ID
 
p
;

102 if(!(
a
 = 
	`GrNewAÕha
(
width
, 
height
)))

103  
NULL
;

104 if(!(
p
 = 
	`GrNewPixm≠
(
width
, 
height
, 
NULL
))) {

105 
	`GrDe°royWödow
(
a
);

106  
NULL
;

110 if(!(
s
 = 
	`make_•rôe
(
°©e
, 
‚ame
, 
width
, 
height
, 
p
, 
a
))) {

111 
	`GrDe°royWödow
(
a
);

112 
	`GrDe°royWödow
(
p
);

113  
NULL
;

114 }  
s
;

115 
	}
}

121 
•rôe
 *
	$lﬂd_•rôe
(
nb°©e
 *
°©e
, *
‚ame
, 
width
, 
height
)

123 
•rôe
 *
s
;

124 
buf
[256];

125 
GR_ALPHA_ID
 
a
;

126 
GR_PIXMAP_ID
 
p
;

127 
GR_IMAGE_ID
 
img
;

128 
GR_IMAGE_INFO
 
ii
;

131 if(!
‚ame
Ë 
NULL
;

136 
s
 = 
°©e
->
•rôñi°
; s; s = s->
√xt
) {

137 if((
width
 =-1 || (width =
s
->
w
 && 
height
 =s->
h
)) &&

138 
s
->
‚ame
 && !
	`°rcmp
(fname, s->fname)) {

139 
s
->
ußge
++;

140  
s
;

146 if(
	`¢¥ötf
(
buf
, 256, "%s/%s", 
°©e
->
gamedú
, 
‚ame
) >= 256){

147 
	`Ârötf
(
°dîr
, "Warning: imageÖath \"%s/%s\" isÅooÜong\n",

148 
°©e
->
gamedú
, sèã->
gamefûe
);

149  
NULL
;

153 if(!(
img
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

154 
	`Ârötf
(
°dîr
, "Warning: failedÅoÜoad image \"%s\"- make "

157 "ty≥ ha†bì¿buûàötÿthê£rvî\n", 
buf
);

158  
NULL
;

163 if(
width
 =-1 || 
height
 == -1) {

164 
	`GrGëImageInfo
(
img
, &
ii
);

165 
width
 = 
ii
.width;

166 
height
 = 
ii
.height;

170 if(!(
a
 = 
	`GrNewAÕha
(
width
, 
height
))) {

171 
	`GrFªeImage
(
img
);

172  
NULL
;

174 if(!(
p
 = 
	`GrNewPixm≠
(
width
, 
height
, 
NULL
))) {

175 
	`GrFªeImage
(
img
);

176 
	`GrDe°royWödow
(
a
);

177  
NULL
;

182 
	`GrDøwImageToFô
(
p
, 
°©e
->
gc
, 0, 0, 
width
, 
height
, 
img
, 
a
);

183 
	`GrFªeImage
(
img
);

187 if(!(
s
 = 
	`make_•rôe
(
°©e
, 
‚ame
, 
width
, 
height
, 
p
, 
a
))) {

188 
	`GrDe°royWödow
(
a
);

189 
	`GrDe°royWödow
(
p
);

190  
NULL
;

191 }  
s
;

192 
	}
}

197 
	$de°roy_•rôe
(
nb°©e
 *
°©e
, 
•rôe
 *
s
)

199 if(!
s
) ;

201 if(!--
s
->
ußge
) {

203 
	`my‰ì
(
s
->
‚ame
);

204 
	`GrDe°royWödow
(
s
->
p
);

205 
	`GrDe°royWödow
(
s
->
a
);

207 if(
s
 =
°©e
->
•rôñi°
Ë°©e->•rôñi° = s->
√xt
;

208 
s
->
¥ev
->
√xt
 = s->next;

209 if(
s
->
√xt
Ës->√xt->
¥ev
 = s->prev;

210 
	`‰ì
(
s
);

212 
	}
}

216 
	$de°roy_Æl_•rôes
(
nb°©e
 *
°©e
)

218 
•rôe
 *
s
, *
¢ext
 = 
°©e
->
•rôñi°
;

220 (
s
 = 
¢ext
)) {

221 
	`my‰ì
(
s
->
‚ame
);

222 
	`GrDe°royWödow
(
s
->
p
);

223 
	`GrDe°royWödow
(
s
->
a
);

224 
¢ext
 = 
s
->
√xt
;

225 
	`‰ì
(
s
);

227 
°©e
->
•rôñi°
 = 
NULL
;

228 
	}
}

	@demos/nxkbd/keyctrl.c

2 
	~"devi˚.h
"

6 
MWPALENTRY
 
	g∑Àâe
[2] = {

7 
RGBDEF
( 0, 0, 0 ),

8 
RGBDEF
( 255, 255, 255 ),

11 
MWUCHAR
 
	gimagebôs
[] = {

75 
MWIMAGEHDR
 
	gimage_key˘æ
 = {

81 
∑Àâe
,

82 
imagebôs
,

	@demos/nxkbd/keynorm.c

2 
	~"devi˚.h
"

6 
MWPALENTRY
 
	g∑Àâe
[2] = {

7 
RGBDEF
( 0, 0, 0 ),

8 
RGBDEF
( 255, 255, 255 ),

11 
MWUCHAR
 
	gimagebôs
[] = {

75 
MWIMAGEHDR
 
	gimage_keyn‹m
 = {

81 
∑Àâe
,

82 
imagebôs
,

	@demos/nxkbd/keynum.c

2 
	~"devi˚.h
"

6 
MWPALENTRY
 
	g∑Àâe
[2] = {

7 
RGBDEF
( 0, 0, 0 ),

8 
RGBDEF
( 255, 255, 255 ),

11 
MWUCHAR
 
	gimagebôs
[] = {

75 
MWIMAGEHDR
 
	gimage_keynum
 = {

81 
∑Àâe
,

82 
imagebôs
,

	@demos/nxkbd/keyshft.c

2 
	~"devi˚.h
"

6 
MWPALENTRY
 
	g∑Àâe
[2] = {

7 
RGBDEF
( 0, 0, 0 ),

8 
RGBDEF
( 255, 255, 255 ),

11 
MWUCHAR
 
	gimagebôs
[] = {

75 
MWIMAGEHDR
 
	gimage_keysh·
 = {

81 
∑Àâe
,

82 
imagebôs
,

	@demos/nxkbd/nxkbd.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	#MWINCLUDECOLORS


	)

22 
	~"«no-X.h
"

24 
	#TITLE
 "So· Keybﬂrd"

	)

25 
	#DISKIMAGES
 0

	)

26 
	#_SOFTKBD_DEBUG
 1

	)

29 
	#NORM
 1000

	)

30 
	#CNTRL
 1001

	)

31 
	#SHIFT
 1002

	)

32 
	#NUM
 1003

	)

33 
	#INTL
 1004

	)

36 
	#BS
 '\b'

	)

37 
	#F1
 2000

	)

38 
	#NONE
 3000

	)

41 
	#SCANCODES
 41

	)

44 
	#BM_WIDTH
 160

	)

45 
	#BM_HEIGHT
 61

	)

47 #i‡
PSP


49 
	~<p•kî√l.h
>

50 
	~<p•debug.h
>

53 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

55 
	#Ârötf
(...)

	)

60 
	skeycﬁumn
 {

61 
	mxoff£t
;

62 
	msˇncode
;

65 
	skeyrow
 {

66 
	myoff£t
;

67 
	mheight
;

68 
keycﬁumn
 
	mcﬁumns
[12];

72 
keyrow
 
	gkeyrows
[4] = {

83 
	#C
(
x
Ë((x)&0x1f)

	)

86 
	gn‹mÆ
[
SCANCODES
] = {

87 'q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', 
BS
,

89 
CNTRL
, 'z', 'x', 'c', 'v', 'b', 'n', 'm', ',', '.', ';',

90 
SHIFT
, 
INTL
, ' ', 
NUM
, '\'', '=', '\\', '/'

93 
	gc⁄åﬁ
[
SCANCODES
] = {

94 
C
('q'),C('w'),C('e'),C('r'),C('t'),C('y'),C('u'),C('i'),C('o'),C('p'),'\033',

95 
C
('a'),C('s'),C('d'),C('f'),C('g'),C('h'),C('j'),C('k'),C('l'),C('_'),'\r',

96 
CNTRL
,
C
('z'),C('x'),C('c'),C('v'),C('b'),C('n'),C('m'),C('\\'),C(']'),C('^'),

97 
SHIFT
,
INTL
,' ',
NUM
,
NONE
,NONE,NONE,'\177'

100 
	gshi·
[
SCANCODES
] = {

101 'Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P', 
BS
,

103 
CNTRL
, 'Z', 'X', 'C', 'V', 'B', 'N', 'M', '<', '>', ':',

104 
SHIFT
, 
INTL
, ' ', 
NUM
, '"', '+', '|', '?'

107 
	gnum
[
SCANCODES
] = {

108 '1', '2', '3', '4', '5', '6', '7', '8', '9', '0', 
BS
,

110 
CNTRL
, 
F1
, F1+1, F1+2, F1+3, F1+4, F1+5, F1+6, F1+7, '`', '~',

111 
SHIFT
, 
INTL
, ' ', 
NUM
, '[', ']', '{', '}'};

113 *
	g‚key
[] = {

118 
	sœyout_°©e
 {

119 *
	mfûíame
;

120 
GR_IMAGE_HDR
 *
	mimagehdr
;

121 *
	msˇncode_å™¶©i⁄s
;

122 
	msshi·
;

123 
	m˘æ_œyout
, 
	mshi·_œyout
, 
	mnum_œyout
;

127 
GR_IMAGE_HDR
 
image_keyn‹m
;

128 
GR_IMAGE_HDR
 
image_key˘æ
;

129 
GR_IMAGE_HDR
 
image_keysh·
;

130 
GR_IMAGE_HDR
 
image_keynum
;

132 
œyout_°©e
 
	gœyout_°©es
[] = {

135 &
image_keyn‹m
,

136 
n‹mÆ
,

142 &
image_keysh·
,

143 
shi·
,

149 &
image_key˘æ
,

150 
c⁄åﬁ
,

156 &
image_keynum
,

157 
num
,

162 
	#N_LAYOUT_STATES
 ((
œyout_°©es
Ë/ ÷ayout_°©es[0]))

	)

164 
GR_WINDOW_ID
 
	gw
;

165 
GR_GC_ID
 
	ggc
;

166 
	gcuºít_œyout
 = 0;

167 #i‡
DISKIMAGES


168 
GR_IMAGE_ID
 
	gœyout_images
[
N_LAYOUT_STATES
];

169 
	gœyout_images_lﬂded
[
N_LAYOUT_STATES
];

172 
KbdWrôe
(
c
);

173 
KbdO≥n
();

174 
KbdClo£
();

177 
	$push_ch¨a˘î
(
c
)

179 #i‡
_SOFTKBD_DEBUG


180 
	`Ârötf
(
°dîr
, "pushed %d (0x%xË'%c'\n", 
c
, c, c);

182 
	`KbdWrôe
(
c
);

183 
	}
}

186 
	$di•œy_œyout
(
œyout
)

188 #i‡
DISKIMAGES


189 
	#LIBDIR
 "."

	)

190 i‡(!
œyout_images_lﬂded
[
œyout
] ) {

191 
buf
[128];

197 
	`•rötf
(
buf
, "%s/%s", 
LIBDIR
, 
œyout_°©es
[
œyout
].
fûíame
);

198 
œyout_images
[
œyout
] = 
	`GrLﬂdImageFromFûe
(
buf
, 0);

199 
œyout_images_lﬂded
[
œyout
] = 1;

201 
	`GrDøwImageToFô
(
w
, 
gc
, 0, 0, -1, -1, 
œyout_images
[
œyout
]);

203 
	`GrDøwImageBôs
(
w
, 
gc
, 0, 0, 
œyout_°©es
[
œyout
].
imagehdr
);

205 
	}
}

208 
	$¥o˚ss_sˇncode
(
sˇncode
)

210 
c
;

212 
c
 = 
œyout_°©es
[
cuºít_œyout
].
sˇncode_å™¶©i⁄s
[
sˇncode
];

213 #i‡
_SOFTKBD_DEBUG


214 
	`¥ötf
("sˇncodê%d ", 
sˇncode
);

215 
	`¥ötf
("current_layout = %d ('%s'), scancode (translated) = %d\n",

216 
cuºít_œyout
, 
œyout_°©es
[cuºít_œyout].
fûíame
, 
c
);

219 
c
) {

221 i‡(
c
 < 256)

225 i‡(
c
 >
F1
 && c < F1+10) {

226 *
p
 = 
‚key
[
c
-
F1
];

227 *
p
)

228 
	`push_ch¨a˘î
(*
p
++);

233 i‡(
c
 =
NONE
)

235 
	`Ârötf
(
°dîr
, "nxkbd: key with unknownÅranslationÖressed\n");

237 
CNTRL
:

238 
cuºít_œyout
 = 
œyout_°©es
[cuºít_œyout].
˘æ_œyout
;

239 
	`di•œy_œyout
(
cuºít_œyout
);

241 
SHIFT
:

242 
cuºít_œyout
 = 
œyout_°©es
[cuºít_œyout].
shi·_œyout
;

243 
	`di•œy_œyout
(
cuºít_œyout
);

245 
NUM
:

246 
cuºít_œyout
 = 
œyout_°©es
[cuºít_œyout].
num_œyout
;

247 
	`di•œy_œyout
(
cuºít_œyout
);

249 
INTL
:

250 #i‡
_SOFTKBD_DEBUG


251 
	`¥ötf
("INTLÇot yet implemented\n");

256 i‡(
œyout_°©es
[
cuºít_œyout
].
sshi·
) {

257 
cuºít_œyout
 = 0;

258 
	`di•œy_œyout
(
cuºít_œyout
);

261 
	`push_ch¨a˘î
(
c
);

262 
	}
}

266 
	$mou£_hô
(
x
, 
y
)

268 
row
, 
cﬁumn
;

270 
row
 = 0;Ñow < 4;Ñow++) {

271 i‡(
y
 >
keyrows
[
row
].
yoff£t
 &&

272 
y
 < 
keyrows
[
row
].
yoff£t
+keyrows[row].
height
) {

273 
cﬁumn
 = 0; column < 12; column++) {

274 i‡(
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
 == 999) {

275 
	`Ârötf
(
°dîr
, "offÉnd ofÑow\n");

278 i‡(
x
 < 
keyrows
[
row
].
cﬁumns
[
cﬁumn
 + 1].
xoff£t
) {

279 
sˇncode
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].scancode;

280 
	`¥o˚ss_sˇncode
(
sˇncode
);

287 
	`Ârötf
(
°dîr
, "nxkbd: off bottom\n");

288 
	}
}

291 
	$maö
(
¨gc
, * 
¨gv
[])

293 
GR_EVENT
 
evít
;

294 
GR_WM_PROPERTIES
 
¥›s
;

296 i‡(
	`GrO≥n
() < 0) {

297 
	`Ârötf
(
°dîr
, "nxkbd: cannot open graphics\n");

298 
	`exô
(1);

301 i‡(
	`KbdO≥n
() < 0) {

302 
	`Ârötf
(
°dîr
, "nxkbd: cannot open kbdÇamedÖipe\n");

304 
	`exô
(1);

308 #i‡!
DISKIMAGES


309 
	`GrReqShmCmds
(4096);

311 
w
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
,

312 0, 0, 
BM_WIDTH
, 
BM_HEIGHT
,

313 0, 
WHITE
, 
BLACK
);

315 
	`GrSñe˘Evíts
(
w
, 
GR_EVENT_MASK_CLOSE_REQ
 |

316 
GR_EVENT_MASK_EXPOSURE
 |

319 
GR_EVENT_MASK_BUTTON_DOWN
);

322 i‡(
¥›s
.
tôÀ
)

323 
	`‰ì
(
¥›s
.
tôÀ
);

326 
¥›s
.
tôÀ
 = 
	`mÆloc
(18);

327 i‡(
¥›s
.
tôÀ
)

328 
	`°r˝y
(
¥›s
.
tôÀ
, 
TITLE
);

330 
¥›s
.
Êags
 =

331 
GR_WM_FLAG_NORESIZE
 |

332 
GR_WM_FLAG_NOBORDERS
 |

333 
GR_WM_FLAG_NOTITLEBAR
 |

334 
GR_WM_FLAG_NOFOCUS
;

337 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

338 
¥›s
.¥›†
GR_WM_PROPS_NOFOCUS
;

339 
¥›s
.¥›†| 
GR_WM_PROPS_NORAISE
 |

340 
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 | 
GR_WM_PROPS_CLOSEBOX
;

341 
¥›s
.
tôÀ
 = 
TITLE
;

342 
	`GrSëWMPr›îtõs
(
w
, &
¥›s
);

344 
	`GrM≠Wödow
(
w
);

346 
gc
 = 
	`GrNewGC
();

348 
cuºít_œyout
 = 0;

350 
	`GrGëNextEvít
(&
evít
);

352 
evít
.
ty≥
) {

353 
GR_EVENT_TYPE_CLOSE_REQ
:

354 #i‡
DISKIMAGES


356 
i
;

358 
i
=0; i < 
N_LAYOUT_STATES
; i++) {

359 if–!
œyout_images_lﬂded
[
i
] )

361 
	`GrFªeImage
(
œyout_images
[
i
]);

365 
	`GrClo£
();

366 
	`exô
(0);

368 
GR_EVENT_TYPE_EXPOSURE
:

369 
	`di•œy_œyout
(
cuºít_œyout
);

371 
GR_EVENT_TYPE_BUTTON_DOWN
:

372 
	`mou£_hô
(
evít
.
buâ⁄
.
x
,Évít.buâ⁄.
y
);

375 
GR_EVENT_TYPE_FOCUS_IN
:

376 i‡(
evít
.
gíîÆ
.
Ÿhîid
 != 1) {

377 
œ°focus
 = 
evít
.
gíîÆ
.
Ÿhîid
;

378 
	`GrSëFocus
(
œ°focus
);

387 
	}
}

	@demos/nxkbd/srvconn.c

6 
	~<uni°d.h
>

7 
	~<f˙é.h
>

8 
	~"«no-X.h
"

10 
	#KBDPIPE
 0

	)

12 #i‡
KBDPIPE


13 
	gKBD_NAMED_PIPE
[] = "/tmp/.nano-X-softkbd";

14 
	gkbd_fd
 = -1;

17 
	$KbdO≥n
()

19 i‡(
kbd_fd
 != -1)

20 
	`˛o£
(
kbd_fd
);

22 i‡((
kbd_fd
 = 
	`›í
(
KBD_NAMED_PIPE
, 
O_WRONLY
)) < 0)

25  
kbd_fd
;

26 
	}
}

29 
	$KbdClo£
()

31 if(
kbd_fd
 >= 0) {

32 
	`˛o£
(
kbd_fd
);

33 
kbd_fd
 = -1;

35 
	}
}

38 
	$KbdWrôe
(
c
)

40 
cc
 = 
c
 & 0xff;

42  
	`wrôe
(
kbd_fd
, &
cc
, 1);

43 
	}
}

48 
	$KbdO≥n
()

51 
	}
}

54 
	$KbdClo£
()

56 
	}
}

59 
	$KbdWrôe
(
c
)

61 
GR_WINDOW_ID
 
wö
 = 
	`GrGëFocus
();

64 
	`GrInje˘KeybﬂrdEvít
(
wö
, 
c
, 0, 0, 1);

65 
	`GrInje˘KeybﬂrdEvít
(
wö
, 
c
, 0, 0, 0);

67 
	}
}

	@demos/nxroach/nxroach.c

13 
	gC›yright
[] = "nxroach\nCopyright 1991 J.T. Anderson";

15 
	~<°dio.h
>

16 
	~<°dlib.h
>

17 
	~<°rög.h
>

18 
	~<m©h.h
>

19 
	~<sig«l.h
>

20 
	~<time.h
>

21 
	#MWINCLUDECOLORS


	)

22 
	~"«no-X.h
"

24 
	#N⁄e
 0

	)

25 
	#Pixm≠
 
GR_WINDOW_ID


	)

26 
	~"rﬂchm≠.h
"

28 
	#PIXBUFSIZ
 (48*48Ë

	)

29 
	#SCAMPER_EVENT
 99

	)

30 
	#BLACK_PIXEL
 
	`MW0RGB
(0,0,0Ë

	)

32 #i‡
PSP


34 
	#Ârötf
(...)

	)

38 
	sRﬂch
 {

39 
RﬂchM≠
 *
	mΩ
;

40 
	mödex
;

41 
	mx
;

42 
	my
;

43 
	mötX
;

44 
	mötY
;

45 
	mhiddí
;

46 
	mtu∫Le·
;

47 
	m°ïs
;

48 } 
	tRﬂch
;

50 
GR_COORD
 
	gdi•œy_width
, 
	gdi•œy_height
;

51 
GR_GC_ID
 
	ggc
;

52 
GR_COLOR
 
	grﬂchCﬁ‹
 = 
BLACK_PIXEL
;

53 
GR_REGION_ID
 
	groŸVisibÀ
 = 0;

54 
GR_BOOL
 
	gd⁄e
 = 
GR_FALSE
;

55 
GR_BOOL
 
	gevítBlock
 = 
GR_FALSE
;

57 
Rﬂch
 *
	grﬂches
;

58 
	gmaxRﬂches
 = 10;

59 
	gcurRﬂches
 = 0;

60 
	grﬂchS≥ed
 = 20.0;

62 
Ußge
();

63 
SigH™dÀr
(
sig
);

64 
AddRﬂch
();

65 
MoveRﬂch
(
Rx
);

66 
DøwRﬂches
();

67 
CovîRoŸ
();

68 
CÆcRoŸVisibÀ
();

69 
M¨kHiddíRﬂches
();

72 
	$maö
(
ac
, **
av
)

74 
ax
;

75 *
¨g
;

76 
RﬂchM≠
 *
Ω
;

77 
rx
;

78 
™gÀ
;

79 
GR_EVENT
 
ev
;

80 
nVis
;

81 
√edCÆc
;

82 
GR_SCREEN_INFO
 
söfo
;

87 
ax
=1;áx<
ac
;áx++) {

88 
¨g
 = 
av
[
ax
];

89 i‡(
	`°rcmp
(
¨g
, "-rc") == 0) {

90 
rﬂchCﬁ‹
 = 
	`©oi
(
av
[++
ax
]);

92 i‡(
	`°rcmp
(
¨g
, "-speed") == 0) {

93 
rﬂchS≥ed
 = 
	`©of
(
av
[++
ax
]);

95 i‡(
	`°rcmp
(
¨g
, "-roaches") == 0) {

96 
maxRﬂches
 = 
	`°πﬁ
(
av
[++
ax
], (**)
NULL
, 0);

99 
	`Ußge
();

103 
	`§™d
(()
	`time
((*)
NULL
));

108 #i‡! 
PSP


109 
	`sig«l
(
SIGKILL
, 
SigH™dÀr
);

110 
	`sig«l
(
SIGINT
, 
SigH™dÀr
);

111 
	`sig«l
(
SIGTERM
, 
SigH™dÀr
);

112 
	`sig«l
(
SIGHUP
, 
SigH™dÀr
);

115 i‡(
	`GrO≥n
() < 0) {

116 
	`Ârötf
(
°dîr
, "can't open graphics\n");

117 
	`exô
(1);

120 
	`GrGëS¸ìnInfo
(&
söfo
);

121 
di•œy_width
 = 
söfo
.
cﬁs
;

122 
di•œy_height
 = 
söfo
.
rows
;

127 
ax
=0;áx<360;áx+=
ROACH_ANGLE
) {

128 
rx
 = 
ax
 / 
ROACH_ANGLE
;

129 
™gÀ
 = 
rx
 * 0.261799387799;

130 
Ω
 = &
rﬂchPix
[
rx
];

131 
Ω
->
pixm≠
 = 
	`GrNewPixm≠FromD©a
‘p->
width
,Ñp->
height
, 
WHITE
, 
BLACK
,

132 
Ω
->
rﬂchBôs
, 
GR_BMDATA_BYTEREVERSE
|
GR_BMDATA_BYTESWAP
);

133 
Ω
->
söe
 = 
	`sö
(
™gÀ
);

134 
Ω
->
cosöe
 = 
	`cos
(
™gÀ
);

137 
rﬂches
 = (
Rﬂch
 *)
	`mÆloc
((RﬂchË* 
maxRﬂches
);

139 
gc
 = 
	`GrNewGC
();

141 
curRﬂches
 < 
maxRﬂches
)

142 
	`AddRﬂch
();

144 
	`GrSñe˘Evíts
(
GR_ROOT_WINDOW_ID
, 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CHLD_UPDATE
);

146 
√edCÆc
 = 1;

147 !
d⁄e
) {

148 i‡(
	`GrPìkEvít
(&
ev
))

149 
	`GrGëNextEvít
(&
ev
);

151 i‡(
√edCÆc
) {

152 
√edCÆc
 = 
	`CÆcRoŸVisibÀ
();

154 
nVis
 = 
	`M¨kHiddíRﬂches
();

155 i‡(
nVis
) {

156 
ev
.
ty≥
 = 
SCAMPER_EVENT
;

159 
	`DøwRﬂches
();

160 
evítBlock
 = 
GR_TRUE
;

161 
	`GrGëNextEvít
(&
ev
);

162 
evítBlock
 = 
GR_FALSE
;

166 
ev
.
ty≥
) {

167 
SCAMPER_EVENT
:

168 
rx
=0;Ñx<
curRﬂches
;Ñx++) {

169 i‡(!
rﬂches
[
rx
].
hiddí
)

170 
	`MoveRﬂch
(
rx
);

172 
	`DøwRﬂches
();

173 
	`GrDñay
(10);

176 
GR_EVENT_TYPE_EXPOSURE
:

177 
GR_EVENT_TYPE_CHLD_UPDATE
:

178 
√edCÆc
 = 1;

184 
	`CovîRoŸ
();

185 
	`GrClo£
();

187 
	}
}

190 
	$Ußge
()

192 
	`Ârötf
(
°dîr
, "Usage:Çxroach [options]\n\n");

193 
	`Ârötf
(
°dîr
, "Options:\n");

194 
	`Ârötf
(
°dîr
, " -rcÑoachcolor\n");

195 
	`Ârötf
(
°dîr
, " -roachesÇumroaches\n");

196 
	`Ârötf
(
°dîr
, " -speedÑoachspeed\n");

198 
	`exô
(1);

199 
	}
}

202 
	$SigH™dÀr
(
sig
)

209 i‡(
evítBlock
) {

210 
	`GrClo£
();

211 
	`exô
(0);

214 
d⁄e
 = 
GR_TRUE
;

216 
	}
}

222 
	$R™dI¡
(
maxVÆ
)

224  
	`ønd
(Ë% 
maxVÆ
;

225 
	}
}

231 
	$RﬂchInRe˘
(
Rﬂch
 *
rﬂch
, 
rx
, 
ry
, 
x
, 
y
,

232 
width
, 
height
)

234 i‡(
rx
 < 
x
)  0;

235 i‡((
rx
 + 
rﬂch
->
Ω
->
width
Ë> (
x
 + width))  0;

236 i‡(
ry
 < 
y
)  0;

237 i‡((
ry
 + 
rﬂch
->
Ω
->
height
Ë> (
y
 + height))  0;

240 
	}
}

246 
	$RﬂchOvîRe˘
(
Rﬂch
 *
rﬂch
, 
rx
, 
ry
, 
x
, 
y
,

247 
width
, 
height
)

249 i‡(
rx
 >(
x
 + 
width
))  0;

250 i‡((
rx
 + 
rﬂch
->
Ω
->
width
Ë<
x
)  0;

251 i‡(
ry
 >(
y
 + 
height
))  0;

252 i‡((
ry
 + 
rﬂch
->
Ω
->
height
Ë<
y
)  0;

255 
	}
}

261 
	$AddRﬂch
()

263 
Rﬂch
 *
r
;

265 i‡(
curRﬂches
 < 
maxRﬂches
) {

266 
r
 = &
rﬂches
[
curRﬂches
++];

267 
r
->
ödex
 = 
	`R™dI¡
(
ROACH_HEADINGS
);

268 
r
->
Ω
 = &
rﬂchPix
[r->
ödex
];

269 
r
->
x
 = 
	`R™dI¡
(
di•œy_width
 -Ñ->
Ω
->
width
);

270 
r
->
y
 = 
	`R™dI¡
(
di•œy_height
 -Ñ->
Ω
->
height
);

271 
r
->
ötX
 = -1;

272 
r
->
ötY
 = -1;

273 
r
->
hiddí
 = 0;

274 
r
->
°ïs
 = 
	`R™dI¡
(200);

275 
r
->
tu∫Le·
 = 
	`R™dI¡
(100) >= 50;

277 
	}
}

283 
	$Tu∫Rﬂch
(
Rﬂch
 *
rﬂch
)

285 i‡(
rﬂch
->
ödex
 !‘ﬂch->
Ω
 - 
rﬂchPix
)) ;

287 i‡(
rﬂch
->
tu∫Le·
) {

288 
rﬂch
->
ödex
 +(
	`R™dI¡
(30) / 10) + 1;

289 i‡(
rﬂch
->
ödex
 >
ROACH_HEADINGS
)

290 
rﬂch
->
ödex
 -
ROACH_HEADINGS
;

293 
rﬂch
->
ödex
 -(
	`R™dI¡
(30) / 10) + 1;

294 i‡(
rﬂch
->
ödex
 < 0)

295 
rﬂch
->
ödex
 +
ROACH_HEADINGS
;

297 
	}
}

303 
	$MoveRﬂch
(
rx
)

305 
Rﬂch
 *
rﬂch
;

306 
Rﬂch
 *
r2
;

307 
√wX
;

308 
√wY
;

309 
ii
;

311 
rﬂch
 = &
rﬂches
[
rx
];

312 
√wX
 = 
rﬂch
->
x
 + (
rﬂchS≥ed
 *Ñﬂch->
Ω
->
cosöe
);

313 
√wY
 = 
rﬂch
->
y
 - (
rﬂchS≥ed
 *Ñﬂch->
Ω
->
söe
);

315 i‡(
	`RﬂchInRe˘
(
rﬂch
, ()
√wX
, ()
√wY
,

316 0, 0, 
di•œy_width
, 
di•œy_height
)) {

318 
rﬂch
->
x
 = 
√wX
;

319 
rﬂch
->
y
 = 
√wY
;

321 i‡(
rﬂch
->
°ïs
-- <= 0) {

322 
	`Tu∫Rﬂch
(
rﬂch
);

323 
rﬂch
->
°ïs
 = 
	`R™dI¡
(200);

326 
ii
=
rx
+1; ii<
curRﬂches
; ii++) {

327 
r2
 = &
rﬂches
[
ii
];

328 i‡(
	`RﬂchOvîRe˘
(
rﬂch
, ()
√wX
, ()
√wY
,

329 
r2
->
ötX
,Ñ2->
ötY
,Ñ2->
Ω
->
width
,Ñ2->Ω->
height
)) {

331 
	`Tu∫Rﬂch
(
rﬂch
);

336 
	`Tu∫Rﬂch
(
rﬂch
);

338 
	}
}

344 
	$DøwRﬂches
()

346 
Rﬂch
 *
rﬂch
;

347 
rx
;

349 
rx
=0;Ñx<
curRﬂches
;Ñx++) {

350 
rﬂch
 = &
rﬂches
[
rx
];

352 i‡(
rﬂch
->
ötX
 >= 0) {

353 
	`GrCÀ¨Aªa
(
GR_ROOT_WINDOW_ID
, 
rﬂch
->
ötX
,Ñﬂch->
ötY
,

354 
rﬂch
->
Ω
->
width
,Ñﬂch->Ω->
height
, 
GR_FALSE
);

358 
rx
=0;Ñx<
curRﬂches
;Ñx++) {

359 
rﬂch
 = &
rﬂches
[
rx
];

361 i‡(!
rﬂch
->
hiddí
) {

362 
size
 = 
rﬂch
->
Ω
->
width
 *Ñﬂch->Ω->
height
;

363 
GR_PIXELVAL
 
rﬂchbuf
[
PIXBUFSIZ
];

364 
GR_PIXELVAL
 
s¸ìnbuf
[
PIXBUFSIZ
];

365 
i
;

367 
rﬂch
->
ötX
 =Ñﬂch->
x
;

368 
rﬂch
->
ötY
 =Ñﬂch->
y
;

369 
rﬂch
->
Ω
 = &
rﬂchPix
[rﬂch->
ödex
];

372 
	`XSëF‹eground
(
di•œy
, 
gc
, 
	`AŒocNamedCﬁ‹
(
rﬂchCﬁ‹
, 
bœck
));

373 
	`XSëFûlStyÀ
(
di•œy
, 
gc
, 
FûlStù∂ed
);

374 
	`XSëStù∂e
(
di•œy
, 
gc
, 
rﬂch
->
Ω
->
pixm≠
);

375 
	`XSëTSOrigö
(
di•œy
, 
gc
, 
rﬂch
->
ötX
,Ñﬂch->
ötY
);

376 
	`XFûlRe˘™gÀ
(
di•œy
, 
roŸWö
, 
gc
,

377 
rﬂch
->
ötX
,Ñﬂch->
ötY
,Ñﬂch->
Ω
->
width
,Ñﬂch->Ω->
height
);

381 
	`GrRódAªa
(
rﬂch
->
Ω
->
pixm≠
, 0, 0,

382 
rﬂch
->
Ω
->
width
,Ñﬂch->Ω->
height
, 
rﬂchbuf
);

385 
	`GrRódAªa
(
GR_ROOT_WINDOW_ID
, 
rﬂch
->
ötX
,Ñﬂch->
ötY
,

386 
rﬂch
->
Ω
->
width
,Ñﬂch->Ω->
height
, 
s¸ìnbuf
);

389 
i
=0; i<
size
; ++i)

390 i‡(
rﬂchbuf
[
i
] !
BLACK_PIXEL
)

391 
s¸ìnbuf
[
i
] = 
rﬂchCﬁ‹
;

394 
	`GrAªa
(
GR_ROOT_WINDOW_ID
, 
gc
, 
rﬂch
->
ötX
,Ñﬂch->
ötY
,

395 
rﬂch
->
Ω
->
width
,Ñﬂch->Ω->
height
, 
s¸ìnbuf
, 
MWPF_PIXELVAL
);

398 
rﬂch
->
ötX
 = -1;

401 
	`GrFlush
();

402 
	}
}

408 
	$CovîRoŸ
()

410 
GR_WINDOW_ID
 
rﬂchWö
;

412 
rﬂchWö
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
di•œy_width
, 
di•œy_height
,

413 0, 
CYAN
, 
BLACK
);

414 
	`GrLowîWödow
(
rﬂchWö
);

415 
	`GrM≠Wödow
(
rﬂchWö
);

416 
	`GrFlush
();

417 
	}
}

423 
	$CÆcRoŸVisibÀ
()

425 
GR_REGION_ID
 
covîed
;

426 
GR_REGION_ID
 
visibÀ
;

427 
GR_WINDOW_ID
 
∑ª¡
;

428 
GR_WINDOW_ID
 *
chûdªn
;

429 
GR_COUNT
 
nChûdªn
;

430 
GR_COUNT
 
wx
;

431 
GR_RECT
 
ª˘
;

432 
GR_WINDOW_INFO
 
öfo
;

437 
	`GrQuîyTªe
(
GR_ROOT_WINDOW_ID
, &
∑ª¡
, &
chûdªn
, &
nChûdªn
);

443 
covîed
 = 
	`GrNewRegi⁄
();

444 
wx
=0; wx<
nChûdªn
; wx++) {

445 
	`GrGëWödowInfo
(
chûdªn
[
wx
], &
öfo
);

446 i‡(
öfo
.
ªÆized
) {

447 
ª˘
.
x
 = 
öfo
.x;

448 
ª˘
.
y
 = 
öfo
.y;

449 
ª˘
.
width
 = 
öfo
.width;

450 
ª˘
.
height
 = 
öfo
.height;

451 
	`GrUni⁄Re˘WôhRegi⁄
(
covîed
, &
ª˘
);

454 
	`‰ì
(
chûdªn
);

459 
visibÀ
 = 
	`GrNewRegi⁄
();

460 
ª˘
.
x
 = 0;

461 
ª˘
.
y
 = 0;

462 
ª˘
.
width
 = 
di•œy_width
;

463 
ª˘
.
height
 = 
di•œy_height
;

464 
	`GrUni⁄Re˘WôhRegi⁄
(
visibÀ
, &
ª˘
);

465 
	`GrSubåa˘Regi⁄
(
visibÀ
, visibÀ, 
covîed
);

466 
	`GrDe°royRegi⁄
(
covîed
);

471 i‡(
roŸVisibÀ
)

472 
	`GrDe°royRegi⁄
(
roŸVisibÀ
);

473 
roŸVisibÀ
 = 
visibÀ
;

478 
wx
=0; wx<
curRﬂches
; wx++)

479 
rﬂches
[
wx
].
hiddí
 = 0;

482 
	}
}

488 
	$M¨kHiddíRﬂches
()

490 
rx
;

491 
Rﬂch
 *
r
;

492 
nVisibÀ
;

494 
nVisibÀ
 = 0;

495 
rx
=0;Ñx<
curRﬂches
;Ñx++) {

496 
r
 = &
rﬂches
[
rx
];

498 i‡(!
r
->
hiddí
) {

499 i‡(
r
->
ötX
 > 0 && 
	`GrRe˘InRegi⁄
(
roŸVisibÀ
,Ñ->ötX,Ñ->
ötY
,

500 
r
->
Ω
->
width
,Ñ->Ω->
height
Ë=
MWRECT_OUT
) {

501 
r
->
hiddí
 = 1;

504 
nVisibÀ
++;

509  
nVisibÀ
;

510 
	}
}

	@demos/nxroach/roachmap.h

1 
	~"rﬂch000.xbm
"

2 
	~"rﬂch015.xbm
"

3 
	~"rﬂch030.xbm
"

4 
	~"rﬂch045.xbm
"

5 
	~"rﬂch060.xbm
"

6 
	~"rﬂch075.xbm
"

7 
	~"rﬂch090.xbm
"

8 
	~"rﬂch105.xbm
"

9 
	~"rﬂch120.xbm
"

10 
	~"rﬂch135.xbm
"

11 
	~"rﬂch150.xbm
"

12 
	~"rﬂch165.xbm
"

13 
	~"rﬂch180.xbm
"

14 
	~"rﬂch195.xbm
"

15 
	~"rﬂch210.xbm
"

16 
	~"rﬂch225.xbm
"

17 
	~"rﬂch240.xbm
"

18 
	~"rﬂch255.xbm
"

19 
	~"rﬂch270.xbm
"

20 
	~"rﬂch285.xbm
"

21 
	~"rﬂch300.xbm
"

22 
	~"rﬂch315.xbm
"

23 
	~"rﬂch330.xbm
"

24 
	~"rﬂch345.xbm
"

26 
	#ROACH_HEADINGS
 24

	)

27 
	#ROACH_ANGLE
 15

	)

29 
	sRﬂchM≠
 {

30 *
	mrﬂchBôs
;

31 
Pixm≠
 
	mpixm≠
;

32 
	mwidth
;

33 
	mheight
;

34 
	msöe
;

35 
	mcosöe
;

36 } 
	tRﬂchM≠
;

38 
RﬂchM≠
 
	grﬂchPix
[] = {

39 {
rﬂch000_bôs
, 
N⁄e
, 
rﬂch000_height
, 
rﬂch000_width
, 0.0, 0.0},

40 {
rﬂch015_bôs
, 
N⁄e
, 
rﬂch015_height
, 
rﬂch015_width
, 0.0, 0.0},

41 {
rﬂch030_bôs
, 
N⁄e
, 
rﬂch030_height
, 
rﬂch030_width
, 0.0, 0.0},

42 {
rﬂch045_bôs
, 
N⁄e
, 
rﬂch045_height
, 
rﬂch045_width
, 0.0, 0.0},

43 {
rﬂch060_bôs
, 
N⁄e
, 
rﬂch060_height
, 
rﬂch060_width
, 0.0, 0.0},

44 {
rﬂch075_bôs
, 
N⁄e
, 
rﬂch075_height
, 
rﬂch075_width
, 0.0, 0.0},

45 {
rﬂch090_bôs
, 
N⁄e
, 
rﬂch090_height
, 
rﬂch090_width
, 0.0, 0.0},

46 {
rﬂch105_bôs
, 
N⁄e
, 
rﬂch105_height
, 
rﬂch105_width
, 0.0, 0.0},

47 {
rﬂch120_bôs
, 
N⁄e
, 
rﬂch120_height
, 
rﬂch120_width
, 0.0, 0.0},

48 {
rﬂch135_bôs
, 
N⁄e
, 
rﬂch135_height
, 
rﬂch135_width
, 0.0, 0.0},

49 {
rﬂch150_bôs
, 
N⁄e
, 
rﬂch150_height
, 
rﬂch150_width
, 0.0, 0.0},

50 {
rﬂch165_bôs
, 
N⁄e
, 
rﬂch165_height
, 
rﬂch165_width
, 0.0, 0.0},

51 {
rﬂch180_bôs
, 
N⁄e
, 
rﬂch180_height
, 
rﬂch180_width
, 0.0, 0.0},

52 {
rﬂch195_bôs
, 
N⁄e
, 
rﬂch195_height
, 
rﬂch195_width
, 0.0, 0.0},

53 {
rﬂch210_bôs
, 
N⁄e
, 
rﬂch210_height
, 
rﬂch210_width
, 0.0, 0.0},

54 {
rﬂch225_bôs
, 
N⁄e
, 
rﬂch225_height
, 
rﬂch225_width
, 0.0, 0.0},

55 {
rﬂch240_bôs
, 
N⁄e
, 
rﬂch240_height
, 
rﬂch240_width
, 0.0, 0.0},

56 {
rﬂch255_bôs
, 
N⁄e
, 
rﬂch255_height
, 
rﬂch255_width
, 0.0, 0.0},

57 {
rﬂch270_bôs
, 
N⁄e
, 
rﬂch270_height
, 
rﬂch270_width
, 0.0, 0.0},

58 {
rﬂch285_bôs
, 
N⁄e
, 
rﬂch285_height
, 
rﬂch285_width
, 0.0, 0.0},

59 {
rﬂch300_bôs
, 
N⁄e
, 
rﬂch300_height
, 
rﬂch300_width
, 0.0, 0.0},

60 {
rﬂch315_bôs
, 
N⁄e
, 
rﬂch315_height
, 
rﬂch315_width
, 0.0, 0.0},

61 {
rﬂch330_bôs
, 
N⁄e
, 
rﬂch330_height
, 
rﬂch330_width
, 0.0, 0.0},

62 {
rﬂch345_bôs
, 
N⁄e
, 
rﬂch345_height
, 
rﬂch345_width
, 0.0, 0.0},

	@demos/nxscribble/bitvector.c

16 
	~"utû.h
"

17 #unde‡
BITS_PER_VECTOR


18 
	#BITS_PER_VECTOR
 128

	)

19 
	~"bôve˘‹.h
"

21 
	~<°rög.h
>

24 
	$bôcou¡
(
max
, 
bv
)

25 
max
;

26 
BôVe˘‹
 
bv
;

28 
i
, 
cou¡
;

30 
cou¡
 = 
i
 = 0; i < 
max
; i++)

31 if(
	`IS_SET
(
i
, 
bv
))

32 
cou¡
++;

33  
cou¡
;

34 
	}
}

37 
	$BôVe˘‹ToSåög
(
max
, 
bv
)

38 
BôVe˘‹
 
bv
;

40 *
°rög
 = 
	`ãmp°rög
();

41 
i
;

43 
i
 = 0; i < 
max
; i++)

44 
°rög
[
i
] = 
	`IS_SET
(i, 
bv
) ? (i % 10) + '0' : '-' ;

45 
°rög
[
i
] = '\0';

46  
°rög
;

47 
	}
}

51 
	$SåögToBôVe˘‹
(
°rög
, 
max
, 
bv
)

52 *
°rög
;

53 
max
;

54 
BôVe˘‹
 
bv
;

56 
i
;

59 if((Ë
	`°æí
(
°rög
Ë!
max
) {

60 
	`îr‹
("StringToBitVector: strlen(%s)=%d != %d",

61 
°rög
, (Ë
	`°æí
(°rög), 
max
);

65 
i
 = 0; i < 
max
; i++)

66 if(
°rög
[
i
] != '-')

67 
	`BIT_SET
(
i
, 
bv
);

69 
	`BIT_CLEAR
(
i
, 
bv
);

70 
	}
}

74 
	$SëBôVe˘‹
(
v
)

75 
BôVe˘‹
 
v
;

77 
nöts
 = 
INTS_PER_VECTOR
;

79 --
nöts
 >= 0)

80 *
v
++ = -1;

81 
	}
}

85 
	$CÀ¨BôVe˘‹
(
nöts
, 
v
)

86 
nöts
;

87 
BôVe˘‹
 
v
;

90 --
nöts
 >= 0)

91 *
v
++ = 0;

92 
	}
}

95 
	$AssignBôVe˘‹
(
nöts
, 
v1
, 
v2
)

96 
nöts
;

97 
BôVe˘‹
 
v1
, 
v2
;

100 --
nöts
 >= 0)

101 *
v1
++ = *
v2
++;

102 
	}
}

105 
	$BôVe˘‹DeQ
(
max
, 
v
)

106 
max
;

107 
BôVe˘‹
 
v
;

109 
i
;

110 
i
 = 0; i < 
max
; i++)

111 if(
	`IS_SET
(
i
, 
v
)) {

112 
	`BIT_CLEAR
(
i
, 
v
);

113  
i
;

117 
	}
}

120 
	$BôVe˘‹Or
(
v
, 
v1
, 
v2
, 
ùv
)

121 *
v
;

122 *
v1
, *
v2
;

123 
ùv
;

125 *
vv
 = 
v
;

127 *
vv
++ = *
v1
++ | *
v2
++;

128 --
ùv
 > 0);

129  
v
;

130 
	}
}

133 
	$BôVe˘‹And
(
v
, 
v1
, 
v2
, 
ùv
)

134 *
v
;

135 *
v1
, *
v2
;

136 
ùv
;

138 *
vv
 = 
v
;

140 *
vv
++ = *
v1
++ & *
v2
++;

141 --
ùv
 > 0);

142  
v
;

143 
	}
}

146 
	$BôVe˘‹NoBôsSë
(
v
, 
ùv
)

147 *
v
;

148 
ùv
;

151 if(*
v
++)  0;

152 --
ùv
 > 0);

154 
	}
}

	@demos/nxscribble/bitvector.h

55 #i‚de‡
BITS_PER_VECTOR


56 
	#BITS_PER_VECTOR
 32

	)

59 #i‡(
BITS_PER_VECTOR
 != 16) && (BITS_PER_VECTOR != 32) && (BITS_PER_VECTOR != 64) && (BITS_PER_VECTOR != 128)

61 
	~"****** ûÀgÆ vÆuêf‹ BITS_PER_VECTORÄ******
"

69 #i‚def 
BITS_PER_INT


72 #ifde‡
unix


73 
	#BITS_PER_INT
 32

	)

75 
	#BITS_PER_INT
 16

	)

78 
	#BV_CHECK_MACHINE_ASSUMPTIONS
() \

79 if(
BITS_PER_INT
 != 8*()) \

80 
	`îr‹
("BV_CHECK_ASSUMPTIONS");

	)

88 #unde‡
BV_INDEX_MASK


89 #unde‡
BV_INDEX_SHIFT


90 #unde‡
INTS_PER_VECTOR


91 #unde‡
VECTOR_SIZE_CHECK


92 #unde‡
SET_BIT_VECTOR


93 #unde‡
IS_SET


94 #unde‡
ASSIGN_BIT_VECTOR


95 #unde‡
CLEAR_BIT_VECTOR


96 #unde‡
BIT_SET


97 #unde‡
BIT_CLEAR


103 #i‡
BITS_PER_VECTOR
 < 
BITS_PER_INT


104 #unde‡
BITS_PER_VECTOR


105 
	#BITS_PER_VECTOR
 
BITS_PER_INT


	)

112 
	#BV_INDEX_MASK
 (
BITS_PER_INT
 - 1)

	)

114 #i‡
BITS_PER_INT
==16

115 
	#BV_INDEX_SHIFT
 4

	)

118 #i‡
BITS_PER_INT
==32

119 
	#BV_INDEX_SHIFT
 5

	)

122 #i‚de‡
BV_INDEX_SHIFT


123 
	~"****** bad vÆuêf‹ BITS_PER_INTÄ******
"

130 #i‡
BITS_PER_INT
==
BITS_PER_VECTOR


131 
	#INTS_PER_VECTOR
 1

	)

133 #i‡2*
BITS_PER_INT
==
BITS_PER_VECTOR


134 
	#INTS_PER_VECTOR
 2

	)

136 
	#INTS_PER_VECTOR
 (
BITS_PER_VECTOR
 / 
BITS_PER_INT
)

	)

141 
	#BV_SIZE_CHECK
(
nbôs_√eded
) \

142 if(
nbôs_√eded
 > 
BITS_PER_VECTOR
) \

143 
	`îr‹
("%sÜine %d - %d bitsÇeeded, %d is vector size", \

144 
__FILE__
, 
__LINE__
, 
nbôs_√eded
, 
BITS_PER_VECTOR
);

	)

146 #i‚de‡
BV_TYPE_NAME


147 
	#BV_TYPE_NAME
 
BôVe˘‹


	)

154 #i‡
INTS_PER_VECTOR
==1

156 
	tBV_TYPE_NAME
[1];

158 
	#CLEAR_BIT_VECTOR
(
v
Ë–(v)[0] = 0 )

	)

159 
	#SET_BIT_VECTOR
(
v
Ë–(v)[0] = -1 )

	)

160 
	#BIT_SET
(
bô
, 
v
Ë–(v)[0] |(1 << (bô)Ë)

	)

161 
	#BIT_CLEAR
(
bô
, 
v
Ë–(v)[0] &~(1 << (bô)Ë)

	)

162 
	#IS_SET
(
bô
, 
v
Ë–((v)[0] >> (bô)Ë& 01 )

	)

163 
	#ASSIGN_BIT_VECTOR
(
v1
,
v2
Ë–(v1)[0] = (v2)[0] )

	)

171 #i‡
INTS_PER_VECTOR
==2

173 
	tBV_TYPE_NAME
[2];

175 
	#CLEAR_BIT_VECTOR
(
v
Ë–(v)[0] = (v)[1] = 0 )

	)

176 
	#SET_BIT_VECTOR
(
v
Ë–(v)[0] = (v)[1] = -1 )

	)

177 
	#ASSIGN_BIT_VECTOR
(
v1
,
v2
) \

178 –(
v1
)[0] = (
v2
)[0], (v1)[1] = (v2)[1] )

	)

186 
	tBV_TYPE_NAME
[
INTS_PER_VECTOR
];

188 
	#CLEAR_BIT_VECTOR
(
v
Ë–
	`CÀ¨BôVe˘‹
(
INTS_PER_VECTOR
, vË)

	)

189 
	#SET_BIT_VECTOR
(
v
Ë–
	`SëBôVe˘‹
(
INTS_PER_VECTOR
, vË)

	)

190 
	#ASSIGN_BIT_VECTOR
(
v1
,
v2
) \

191 –
	`AssignBôVe˘‹
(
INTS_PER_VECTOR
, 
v1
, 
v2
Ë)

	)

196 
	#BIT_SET
(
bô
, 
v
) \

197 –(
v
[
bô
>>
BV_INDEX_SHIFT
]Ë|(1 << (bô&
BV_INDEX_MASK
)Ë)

	)

199 
	#BIT_CLEAR
(
bô
, 
v
) \

200 –(
v
[
bô
>>
BV_INDEX_SHIFT
]Ë&~(1 << (bô&
BV_INDEX_MASK
)Ë)

	)

202 
	#IS_SET
(
bô
, 
v
) \

203 –((
v
[
bô
>>
BV_INDEX_SHIFT
]Ë>> (bô&
BV_INDEX_MASK
)Ë& 01 )

	)

209 
	#OR
(
v
, 
v1
, 
v2
Ë–
	`BôVe˘‹Or
((v), (v1), (v2), 
INTS_PER_VECTOR
Ë)

	)

210 
	#AND
(
v
, 
v1
, 
v2
Ë–
	`BôVe˘‹And
((v), (v1), (v2), 
INTS_PER_VECTOR
Ë)

	)

211 
	#NO_BITS_SET
(
v
Ë–
	`BôVe˘‹NoBôsSë
–(v), 
INTS_PER_VECTOR
 ) )

	)

213 
bôcou¡
();

214 *
BôVe˘‹ToSåög
();

215 
SåögToBôVe˘‹
();

216 
BôVe˘‹DeQ
();

218 *
BôVe˘‹Or
();

219 *
BôVe˘‹And
();

220 
BôVe˘‹NoBôsSë
();

	@demos/nxscribble/hre.h

22 #i‚de‡
_HRE_H_


24 
	#_HRE_H_


	)

26 
	~<sys/ty≥s.h
>

27 
	~<°dlib.h
>

30 #ifde‡
ELX


31 
	twch¨_t
;

38 #i‚de‡
åue


40 
u_ch¨
 
	tboﬁ
;

42 
	#åue
 1

	)

43 
	#Ál£
 0

	)

49 (*
	gªc_‚
)();

56 
u_ch¨
 
	tªc_c⁄fidí˚
;

61 #i‚de‡
X_H


63 #i‚de‡
__osf__


64 
	tTime
;

66 
	tTime
;

85 * 
	mri_loˇÀ
;

86 * 
	mri_«me
;

87 ** 
	mri_sub£t
;

88 } 
	tªc_öfo
;

92 
	#GESTURE
 "GESTURE"

	)

93 
	#MATHSET
 "MATHSET"

	)

94 
	#MONEYSET
 "MONEYSET"

	)

95 
	#WHITESPACE
 "WHITESPACE"

	)

96 
	#KANJI_JIS1
 "KANJI_JIS1"

	)

97 
	#KANJI_JIS1_PLUS
 "KANJI_JIS1_PLUS"

	)

98 
	#KANJI_JIS2
 "KANJI_JIS2"

	)

99 
	#HIRIGANA
 "HIRIGANA"

	)

100 
	#KATAKANA
 "KATAKANA"

	)

101 
	#UPPERCASE
 "UPPERCASE"

	)

102 
	#LOWERCASE
 "LOWERCASE"

	)

103 
	#DIGITS
 "DIGITS"

	)

104 
	#PUNCTUATION
 "PUNCTUATION"

	)

105 
	#NONALPHABETIC
 "NONALPHABETIC"

	)

106 
	#ASCII
 "ASCII"

	)

107 
	#ISO_LATIN12
 "ISO_LATIN12"

	)

119 
Time
 
	mtime
;

120 
	mx
, 
	my
;

121 } 
	t≥n_poöt
;

126 
	mx
,
	my
;

127 
	mwidth
,
	mheight
;

128 } 
	t≥n_ª˘
;

132 
	#TABLET_TIP
 0x1

	)

133 
	#TABLET_BUTTON1
 0x2

	)

134 
	#TABLET_BUTTON2
 0x4

	)

135 
	#TABLET_BUTTON3
 0x8

	)

139 
	#TABLET_PROXIMITY
 0x1

	)

140 
	#TABLET_RELATIVE
 0x2

	)

141 
	#TABLET_ABSOLUTE
 0x4

	)

142 
	#TABLET_RANGE
 0x8

	)

143 
	#TABLET_INVERT
 0x10

	)

144 
	#TABLET_TOUCH
 0x20

	)

148 
	#TABLET_ANGLEX
 0x1

	)

149 
	#TABLET_ANGLEY
 0x2

	)

150 
	#TABLET_ROTATE
 0x4

	)

157 
	#TABLET_INTEGRATED
 0x1

	)

158 
	#TABLET_PRESSURE
 0x2

	)

159 
	#TABLET_HEIGHT
 0x4

	)

163 
	#TABLET_DIMENSIONLESS
 0x1

	)

164 
	#TABLET_ENGLISH
 0x2

	)

165 
	#TABLET_METRIC
 0x4

	)

169 
	#TABLET_ULEFT
 0x1

	)

170 
	#TABLET_URIGHT
 0x2

	)

171 
	#TABLET_LLEFT
 0x4

	)

172 
	#TABLET_LRIGHT
 0x8

	)

173 
	#TABLET_CENTER
 0x10

	)

181 
	mtc_id
[20];

182 
u_sh‹t
 
	mtc_buâ⁄
;

183 
u_sh‹t
 
	mtc_≥n
;

184 
u_sh‹t
 
	mtc_™gÀ
;

185 
u_öt
 
	mtc_£ns‹
 : 8;

186 
u_öt
 
	mtc_unôs
 : 8;

187 
u_öt
 
	mtc_deÁu…_unôs
 : 8;

188 
u_öt
 
	mtc_‹igö
 : 8;

189 
	mtc_x
[2];

190 
	mtc_y
[2];

191 
	mtc_¥essuª
[2];

192 
u_öt
 
	mtc_ßm∂e_øã
;

193 
u_öt
 
	mtc_ßm∂e_di°™˚
;

195 } 
	tèbÀt_ˇp
;

207 
u_sh‹t
 
	m±_buâ⁄
;

208 
u_sh‹t
 
	m±_≥n
;

209 
	m±_¥essuª
;

210 
	m±_™gÀx
;

211 
	m±_™gÀy
;

212 
	m±_b¨ªÃŸ©e
;

213 } 
	t≥n_°©e
;

220 
u_öt
 
	mps_≈ts
;

221 
≥n_poöt
* 
	mps_±s
;

222 
u_öt
 
	mps_n°©e
;

223 
u_öt
* 
	mps_å™s
;

224 
≥n_°©e
* 
	mps_°©e
;

225 } 
	t≥n_°roke
;

234 
≥n_ª˘
 
	m¥_¨ó
;

235 
	m¥_row
, 
	m¥_cﬁ
;

236 
	m¥_rowpôch
, 
	m¥_cﬁpôch
;

237 } 
	t≥n_‰ame
;

241 
	#REC_RIGHTH
 0x0

	)

242 
	#REC_LEFTH
 0x1

	)

251 
	#REC_DEFAULT
 0x0

	)

252 
	#REC_BOTTOM_TOP
 0x1

	)

253 
	#REC_LEFT_RIGHT
 0x2

	)

254 
	#REC_RIGHT_LEFT
 0x3

	)

255 
	#REC_TOP_BOTTOM
 0x4

	)

262 
	s_Àâî£t
 {

263 
	mls_ty≥
;

264 
	u_ls_£t
 {

265 * 
	mavÆ
;

266 
wch¨_t
* 
	mwvÆ
;

267 } 
	mls_£t
;

268 } 
	tÀâî£t
;

276 
u_sh‹t
 
	mrc_u¥ef
;

277 
boﬁ
 
	mrc_ge°uª
;

278 
u_sh‹t
 
	mrc_dúe˘i⁄
;

279 
ªc_c⁄fidí˚
 
	mrc_cutoff
;

280 
èbÀt_ˇp
* 
	mrc_töfo
;

281 ** 
	mrc_sub£t
;

282 
≥n_‰ame
* 
	mrc_‰ame
;

283 
w‹d£t
 
	mrc_w‹d£t
;

284 
Àâî£t
 
	mrc_Àâî£t
;

285 * 
	mrc_c⁄ãxt
;

286 } 
	trc
;

299 
	sGe°uª
 {

300 * 
	mg_«me
;

301 
u_öt
 
	mg_nhs
;

302 
≥n_poöt
* 
	mg_h•Ÿs
;

303 
≥n_ª˘
 
	mg_bbox
;

304 (*
	mg_a˘i⁄
)(
	mGe°uª
*);

305 * 
	mg_wsöfo
;

306 } 
	tge°uª
;

308 (*
	txge°uª
)(
	tge°uª
*);

312 
	#COPY
 "COPY"

	)

313 
	#CUT
 "CUT"

	)

314 
	#PASTE
 "PASTE"

	)

315 
	#UNDO
 "UNDO"

	)

316 
	#CLEAR
 "CLEAR"

	)

317 
	#EXTEND
 "EXTEND"

	)

318 
	#RETURN
 "RETURN"

	)

319 
	#SPACE
 "SPACE"

	)

320 
	#TAB
 "TAB"

	)

321 
	#KKCONVERT
 "KKCONVERT"

	)

328 
	#REC_NONE
 0x0

	)

329 
	#REC_GESTURE
 0x1

	)

330 
	#REC_ASCII
 0x2

	)

331 
	#REC_VAR
 0x4

	)

332 
	#REC_WCHAR
 0x8

	)

333 
	#REC_OTHER
 0x10

	)

334 
	#REC_CORR
 0x20

	)

346 
	#ªc_c‹ªœti⁄
 

	)

349 
ª_ty≥
;

351 
ge°uª
* 
gvÆ
;

352 * 
avÆ
;

353 
wch¨_t
* 
wvÆ
;

354 
ªc_c‹ªœti⁄
* 
rcvÆ
;

355 } 
ª_ªsu…
;

356 
ªc_c⁄fidí˚
 
ª_c⁄f
;

357 } 
	tªc_ñemít
;

366 
	s_Rec_Æã∫©ive
 {

367 
ªc_ñemít
 
ø_ñem
;

368 
u_öt
 
ø_«…î
;

369 
_Rec_Æã∫©ive
* 
ø_√xt
;

372 
_Rec_Æã∫©ive
 
	tªc_Æã∫©ive
;

384 #unde‡
ªc_c‹ªœti⁄


387 
ªc_ñemít
 
ro_ñem
;

388 
u_öt
 
ro_n°rokes
;

389 
≥n_°roke
* 
ro_°rokes
;

390 
u_öt
* 
ro_°¨t
;

391 
u_öt
* 
ro_°›
;

392 } 
	tªc_c‹ªœti⁄
;

	@demos/nxscribble/hre_api.c

23 
	~<sys/ty≥s.h
>

24 #ifde‡
ELX


25 
	~<vxW‹ks.h
>

27 
	~<sys/°©.h
>

28 
	~<î∫o.h
>

29 
	~<°dio.h
>

30 
	~<°rög.h
>

31 
	~<loˇÀ.h
>

32 
	~<°dlib.h
>

34 
	~"hª_öã∫Æ.h
"

35 
	~"utû.h
"

38 
ªcognizî
 
__ªcognizî_öã∫Æ_öôülize
(
ªc_öfo
* 
ri
);

42 * 
	gREC_VERSION
 = "2.0";

46 
	#INTL_DOMAIN
 "ªcognôi⁄_m™agî"

	)

49 
	#dgëãxt
(
domaö
, 
msg
Ë(msg)

	)

50 
	#bödãxtdomaö
(
dú«me
, 
domaö
)

	)

58 
	#REC_MAGIC
 0x„ed

	)

59 
	#REC_END_MAGIC
 0xbìf

	)

63 
	#RI_CHECK_MAGIC
(
ªc
) \

64 –(
ªc
 !
NULL
) && \

65 (((
ªcognizî
)
ªc
)->
ªcognizî_magic
 =
REC_MAGIC
) && \

66 (((
ªcognizî
)
ªc
)->
ªcognizî_íd_magic
 =
REC_END_MAGIC
) &&\

67 (((
ªcognizî
)
ªc
)->
ªcognizî_vîsi⁄
 =
REC_VERSION
Ë)

	)

74 
__ªcognizî_öã∫Æ_föÆize
(
ªcognizî
 
r
);

78 
	#HOME
 "HOME"

	)

79 
	#USERRECHOME
 ".˛assifõrs"

	)

84 * 
sh¨ed_libøry_«me
(* 
dúe˘‹y
,* 
loˇÀ
,* 
«me
);

86 
ªc_öfo
* 
make_ªc_öfo
(* 
dúe˘‹y
,* 
«me
,** 
sub£t
);

87 
dñëe_ªc_öfo
(
ªc_öfo
* 
ri
);

89 
check_f‹_u£r_home
();

91 
öé_öôülize
();

93 
˛ónup_ªc_ñemít
(
ªc_ñemít
* 
ª
,
boﬁ
 
dñëe_poöts_p
);

97 * 
	gthe_œ°_îr‹
 = 
NULL
;

99 *
	$ß„_mÆloc
 (
nbyãs
)

101 *
ªs
 = 
	`mÆloc
(
nbyãs
);

102 i‡(
ªs
 =
NULL
) {

103 
	`îr‹
("malloc failure");

104 
	`exô
(2);

106  (
ªs
);

107 
	}
}

121 
ªcognizî


122 
	$ªcognizî_lﬂd
(* 
dúe˘‹y
,* 
«me
,** 
sub£t
)

124 
ªcognizî
 
ªc
;

126 
ªcognizî_öã∫Æ_öôülize
 
rii
;

128 
ªc_öfo
* 
röf
;

129 
boﬁ
 
öé_öô
 = 
Ál£
;

131 if–
öé_öô
 =
Ál£
 ) {

132 
öé_öô
 = 
åue
;

134 
	`öé_öôülize
();

138 
röf
 = 
	`make_ªc_öfo
(
dúe˘‹y
,
«me
,
sub£t
);

139 i‡(
röf
 =
NULL
) {

140 
the_œ°_îr‹
 =

141 
	`dgëãxt
(
INTL_DOMAIN
,

143 ((
ªcognizî
)
NULL
);

148 
ªc
 = 
	`__ªcognizî_öã∫Æ_öôülize
(
röf
);

149 i‡(
ªc
 =
NULL
) {

150 ((
ªcognizî
)
NULL
);

155 if–
ªc
->
ªcognizî_lﬂd_°©e
 =
NULL
 ||

156 
ªc
->
ªcognizî_ßve_°©e
 =
NULL
 ||

157 
ªc
->
ªcognizî_lﬂd_di˘i⁄¨y
 =
NULL
 ||

158 
ªc
->
ªcognizî_ßve_di˘i⁄¨y
 =
NULL
 ||

159 
ªc
->
ªcognizî_‰ì_di˘i⁄¨y
 =
NULL
 ||

160 
ªc
->
ªcognizî_add_to_di˘i⁄¨y
 =
NULL
 ||

161 
ªc
->
ªcognizî_dñëe_‰om_di˘i⁄¨y
 =
NULL
 ||

162 
ªc
->
ªcognizî_îr‹
 =
NULL
 ||

163 
ªc
->
ªcognizî_£t_c⁄ãxt
 =
NULL
 ||

164 
ªc
->
ªcognizî_gë_c⁄ãxt
 =
NULL
 ||

165 
ªc
->
ªcognizî_˛ór
 =
NULL
 ||

166 
ªc
->
ªcognizî_gë_buf„r
 =
NULL
 ||

167 
ªc
->
ªcognizî_£t_buf„r
 =
NULL
 ||

168 
ªc
->
ªcognizî_å™¶©e
 =
NULL
 ||

169 
ªc
->
ªcognizî_gë_exãnsi⁄_fun˘i⁄s
 =
NULL
 ||

170 
ªc
->
ªcognizî_gë_ge°uª_«mes
 =
NULL
 ||

171 
ªc
->
ªcognizî_£t_ge°uª_a˘i⁄
 =
NULL


174 
	`ªcognizî_u∆ﬂd
(
ªc
);

175 
	`Ârötf
(
°dîr
, "Unloading b/cÇull functionÖointer.\n");

176 
the_œ°_îr‹
 =

177 
	`dgëãxt
(
INTL_DOMAIN
,

179 ((
ªcognizî
)
NULL
);

185 
ªc
->
ªcognizî_öfo
 = 
röf
;

202 (
ªc
);

203 
	}
}

210 
	$ªcognizî_u∆ﬂd
(
ªcognizî
 
ªc
)

213 
ªcognizî_öã∫Æ_föÆize
 
rif
;

218 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

219 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

223 
	`__ªcognizî_öã∫Æ_föÆize
(
ªc
);

226 
	}
}

235 
	$ªcognizî_lﬂd_°©e
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
)

239 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

240 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

245 (
ªc
->
	`ªcognizî_lﬂd_°©e
‘ec,
dú
,
«me
));

246 
	}
}

255 
	$ªcognizî_ßve_°©e
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
)

259 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

260 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

266 (
ªc
->
	`ªcognizî_ßve_°©e
‘ec,
dú
,
«me
));

267 
	}
}

274 
w‹d£t
 
	$ªcognizî_lﬂd_di˘i⁄¨y
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
)

278 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

279 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

280 (
NULL
);

285 (
ªc
->
	`ªcognizî_lﬂd_di˘i⁄¨y
‘ec,
dú
,
«me
));

286 
	}
}

293 
	$ªcognizî_ßve_di˘i⁄¨y
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
,
w‹d£t
 
di˘
)

297 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

298 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

304 (
ªc
->
	`ªcognizî_ßve_di˘i⁄¨y
‘ec,
dú
,
«me
,
di˘
));

305 
	}
}

312 
	$ªcognizî_‰ì_di˘i⁄¨y
(
ªcognizî
 
ªc
,
w‹d£t
 
di˘
)

316 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

317 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

323 (
ªc
->
	`ªcognizî_‰ì_di˘i⁄¨y
‘ec,
di˘
));

324 
	}
}

332 
	$ªcognizî_add_to_di˘i⁄¨y
(
ªcognizî
 
ªc
,
Àâî£t
* 
w‹d
,
w‹d£t
 
di˘
)

336 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

337 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

343 (
ªc
->
	`ªcognizî_add_to_di˘i⁄¨y
‘ec,
w‹d
,
di˘
));

344 
	}
}

352 
	$ªcognizî_dñëe_‰om_di˘i⁄¨y
(
ªcognizî
 
ªc
,
Àâî£t
* 
w‹d
,
w‹d£t
 
di˘
)

356 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

357 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

363 (
ªc
->
	`ªcognizî_dñëe_‰om_di˘i⁄¨y
‘ec,
w‹d
,
di˘
));

364 
	}
}

372 c⁄° 
ªc_öfo
*

373 
	$ªcognizî_gë_öfo
(
ªcognizî
 
ªc
)

377 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

378 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

379 ((
ªc_öfo
*)
NULL
);

384 (
ªc
->
ªcognizî_öfo
);

385 
	}
}

392 c⁄° * 
	$ªcognizî_m™agî_vîsi⁄
(
ªcognizî
 
ªc
)

396 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

397 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

398 (
NULL
);

401 (
ªc
->
ªcognizî_vîsi⁄
);

403 
	}
}

408 * 
	$ªcognizî_îr‹
(
ªcognizî
 
ªc
)

413 if–!
	`RI_CHECK_MAGIC
(
ªc
Ë&& 
the_œ°_îr‹
 =
NULL
 ) {

414 (
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object."));

416 } if–
the_œ°_îr‹
 !
NULL
 ) {

417 * 
îr‹
 = 
the_œ°_îr‹
;

419 
the_œ°_îr‹
 = 
NULL
;

420 (
îr‹
);

425 (
ªc
->
	`ªcognizî_îr‹
(rec));

426 
	}
}

433 
	$ªcognizî_£t_c⁄ãxt
(
ªcognizî
 
ªc
,
rc
* 
ªc_xt
)

438 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

439 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

445 (
ªc
->
	`ªcognizî_£t_c⁄ãxt
‘ec,
ªc_xt
));

446 
	}
}

453 
rc
* 
	$ªcognizî_gë_c⁄ãxt
(
ªcognizî
 
ªc
)

458 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

459 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

460 (
NULL
);

465 (
	`ªcognizî_gë_c⁄ãxt
(
ªc
));

466 
	}
}

473 
	$ªcognizî_˛ór
(
ªcognizî
 
ªc
,
boﬁ
 
dñëe_poöts_p
)

478 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

479 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

485 (
ªc
->
	`ªcognizî_˛ór
‘ec,
dñëe_poöts_p
));

486 
	}
}

491 
	$ªcognizî_gë_buf„r
(
ªcognizî
 
ªc
, 
u_öt
* 
n°rokes
,
≥n_°roke
** 
°rokes
)

496 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

497 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

503 (
ªc
->
	`ªcognizî_gë_buf„r
‘ec,
n°rokes
,
°rokes
));

505 
	}
}

512 
	$ªcognizî_£t_buf„r
(
ªcognizî
 
ªc
,
u_öt
 
n°rokes
,
≥n_°roke
* 
°rokes
)

517 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

518 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

524 (
ªc
->
	`ªcognizî_£t_buf„r
‘ec,
n°rokes
,
°rokes
));

526 
	}
}

534 
	$ªcognizî_å™¶©e
(
ªcognizî
 
ªc
,

535 
u_öt
 
n°rokes
,

536 
≥n_°roke
* 
°rokes
,

537 
boﬁ
 
c‹ªœã_p
,

538 * 
ƒë
,

539 
ªc_Æã∫©ive
** 
ªt
)

541 
ªtvÆ
;

542 
msg
[80];

545 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

546 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
, 
msg
);

567 
ªtvÆ
 = 
ªc
->
	`ªcognizî_å™¶©e
(rec,

568 
n°rokes
,

569 
°rokes
,

570 
c‹ªœã_p
,

571 
ƒë
,

572 
ªt
);

573  (
ªtvÆ
);

574 
	}
}

583 
ªc_‚
* 
	$ªcognizî_gë_exãnsi⁄_fun˘i⁄s
(
ªcognizî
 
ªc
)

587 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

588 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

589 ((
ªc_‚
*)
NULL
);

594 (
ªc
->
	`ªcognizî_gë_exãnsi⁄_fun˘i⁄s
(rec));

595 
	}
}

604 
	$ªcognizî_gë_ge°uª_«mes
(
ªcognizî
 
ªc
)

608 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

609 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

610 (
NULL
);

615 (
ªc
->
	`ªcognizî_gë_ge°uª_«mes
(rec));

616 
	}
}

622 
xge°uª


623 
	$ªcognizî_åaö_ge°uªs
(
ªcognizî
 
ªc
,* 
«me
,
xge°uª
 
‚
,* 
wsöfo
)

627 if–!
	`RI_CHECK_MAGIC
(
ªc
) ) {

628 
the_œ°_îr‹
 = 
	`dgëãxt
(
INTL_DOMAIN
,"BadÑecognizer object.");

629 ((
xge°uª
)-1);

634 (
ªc
->
	`ªcognizî_£t_ge°uª_a˘i⁄
‘ec,
«me
,
‚
,
wsöfo
));

635 
	}
}

648 * 
	$sh¨ed_libøry_«me
(* 
dúe˘‹y
,* 
loˇÀ
,* 
«me
)

650 * 
ªt
 = 
NULL
;

651 
Àn
 = 
	`°æí
(
«me
);

655 if–
dúe˘‹y
 !
NULL
 ) {

656 
ªt
 = (*)
	`ß„_mÆloc
(
	`°æí
(
dúe˘‹y
Ë+ 
Àn
 + 2);

657 
	`°r˝y
(
ªt
,
dúe˘‹y
);

658 
	`°rˇt
(
ªt
,"/");

659 
	`°rˇt
(
ªt
,
«me
);

663 * 
dú
 = 
NULL
;

667 if–(
dú
 = 
	`gëív
(
RECHOME
)Ë=
NULL
 ) {

668 
dú
 = "REC_DEFAULT_HOME_DIR";

672 
ªt
 = (*)
	`ß„_mÆloc
(
	`°æí
(
dú
Ë+ såÀn(
loˇÀ
Ë+ 
Àn
 + 3);

674 
	`°r˝y
(
ªt
,
dú
);

675 
	`°rˇt
(
ªt
,"/");

676 
	`°rˇt
(
ªt
,
loˇÀ
);

677 
	`°rˇt
(
ªt
,"/");

678 
	`°rˇt
(
ªt
,
«me
);

682 (
ªt
);

683 
	}
}

691 
	$öé_öôülize
()

693 * 
dú«me
;

697 if–(
dú«me
 = 
	`gëív
(
RECHOME
)Ë=
NULL
 ) {

698 
dú«me
 = "REC_DEFAULT_HOME_DIR";

703 
	`bödãxtdomaö
(
dú«me
,
INTL_DOMAIN
);

704 
	}
}

709 
ªc_öfo
* 
	$make_ªc_öfo
(* 
dúe˘‹y
,* 
«me
,** 
sub£t
)

711 
i
,
Àn
;

712 
ªc_öfo
* 
ri
;

713 * 
loˇÀ
;

715 
ri
 = (
ªc_öfo
*)
	`ß„_mÆloc
((rec_info));

716 
ri
->
ri_loˇÀ
 = 
NULL
;

717 
ri
->
ri_«me
 = 
NULL
;

718 
ri
->
ri_sub£t
 = 
NULL
;

722 if–(
loˇÀ
 = 
	`gëív
(
LANG
)Ë=
NULL
 ) {

723 
loˇÀ
 = 
	`°rdup
(
REC_DEFAULT_LOCALE
);

726 if–(
ri
->
ri_loˇÀ
 = 
	`°rdup
(
loˇÀ
)Ë=
NULL
 ) {

727 
	`dñëe_ªc_öfo
(
ri
);

728 (
NULL
);

742 if–
sub£t
 !
NULL
 ) {

746  
Àn
 = 1; 
sub£t
[Àn] !
NULL
;Üen++ ) ;

750 
ri
->
ri_sub£t
 = (**)
	`ß„_mÆloc
((
Àn
 +1)*(*));

752  
i
 = 0; i < 
Àn
; i++ ) {

753 if–
sub£t
[
i
] !
NULL
 ) {

754 if–(
ri
->
ri_sub£t
[
i
] = 
	`°rdup
(
sub£t
[i])Ë=
NULL
 ) {

755 
	`dñëe_ªc_öfo
(
ri
);

756 (
NULL
);

759 
ri
->
ri_sub£t
[
i
] = 
sub£t
[i];

763 
ri
->
ri_sub£t
[
i
] = 
NULL
;

767 
ri
->
ri_sub£t
 = 
NULL
;

770 (
ri
);

771 
	}
}

773 
	$dñëe_ªc_öfo
(
ªc_öfo
* 
ri
)

775 if–
ri
 !
NULL
 ) {

776 if–
ri
->
ri_loˇÀ
 !
NULL
 ) {

777 
	`‰ì
(
ri
->
ri_loˇÀ
);

784 if–
ri
->
ri_sub£t
 !
NULL
 ) {

785 
i
;

786  
i
 = 0; 
ri
->
ri_sub£t
[i] !
NULL
; i++) {

787 
	`‰ì
(
ri
->
ri_sub£t
[
i
]);

789 
	`‰ì
(
ri
->
ri_sub£t
);

791 
	`‰ì
(
ri
);

793 
	}
}

798 
	$check_f‹_u£r_home
()

800 * 
homedú
 = 
	`gëív
(
HOME
);

801 * 
ªchome
 = 
NULL
;

803 if–
homedú
 =
NULL
 ) {

804 
the_œ°_îr‹
 = "HomeÉnvironment variable HOMEÇot set.";

808 
ªchome
 = (*)
	`ß„_mÆloc
(
	`°æí
(
homedú
Ë+ såÀn(
USERRECHOME
) + 2);

812 
	`°r˝y
(
ªchome
,
homedú
);

813 
	`°rˇt
(
ªchome
,"/");

814 
	`°rˇt
(
ªchome
,
USERRECHOME
);

818 if–
	`mkdú
(
ªchome
,
S_IRWXU
 | 
S_IRWXG
 | 
S_IRWXO
) < 0 ) {

822 if–
î∫o
 !
EEXIST
 ) {

823 
the_œ°_îr‹
 = "Error during creation of USERRECHOME.";

824 
	`‰ì
(
ªchome
);

829 
	`‰ì
(
ªchome
);

832 
	}
}

852 
ªcognizî
 
	$make_ªcognizî
(
ªc_öfo
* 
rif
)

854 
ªcognizî
 
ªc
;

858 
ªc
 = (
ªcognizî
)
	`ß„_mÆloc
((*rec));

859 
ªc
->
ªcognizî_magic
 = 
REC_MAGIC
;

860 
ªc
->
ªcognizî_vîsi⁄
 = 
REC_VERSION
;

861 
ªc
->
ªcognizî_öfo
 = 
rif
;

862 
ªc
->
ªcognizî_•ecific
 = 
NULL
;

863 
ªc
->
ªcognizî_íd_magic
 = 
REC_END_MAGIC
;

864 
ªc
->
ªcognizî_lﬂd_°©e
 = 
NULL
;

865 
ªc
->
ªcognizî_ßve_°©e
 = 
NULL
;

866 
ªc
->
ªcognizî_lﬂd_di˘i⁄¨y
 = 
NULL
;

867 
ªc
->
ªcognizî_ßve_di˘i⁄¨y
 = 
NULL
;

868 
ªc
->
ªcognizî_‰ì_di˘i⁄¨y
 = 
NULL
;

869 
ªc
->
ªcognizî_add_to_di˘i⁄¨y
 = 
NULL
;

870 
ªc
->
ªcognizî_dñëe_‰om_di˘i⁄¨y
 = 
NULL
;

871 
ªc
->
ªcognizî_îr‹
 = 
NULL
;

872 
ªc
->
ªcognizî_£t_c⁄ãxt
 = 
NULL
;

873 
ªc
->
ªcognizî_gë_c⁄ãxt
 = 
NULL
;

874 
ªc
->
ªcognizî_˛ór
 = 
NULL
;

875 
ªc
->
ªcognizî_gë_buf„r
 = 
NULL
;

876 
ªc
->
ªcognizî_£t_buf„r
 = 
NULL
;

877 
ªc
->
ªcognizî_å™¶©e
 = 
NULL
;

878 
ªc
->
ªcognizî_gë_exãnsi⁄_fun˘i⁄s
 = 
NULL
;

879 
ªc
->
ªcognizî_gë_ge°uª_«mes
 = 
NULL
;

880 
ªc
->
ªcognizî_£t_ge°uª_a˘i⁄
 = 
NULL
;

881 (
ªc
);

882 
	}
}

884 
	$dñëe_ªcognizî
(
ªcognizî
 
ªc
)

887 if–
ªc
 !
NULL
 ) {

888 if–
ªc
->
ªcognizî_öfo
 !
NULL
 ) {

889 
	`dñëe_ªc_öfo
(
ªc
->
ªcognizî_öfo
);

891 
	`‰ì
(
ªc
);

893 
	}
}

899 
ªc_Æã∫©ive
* 
	$make_ªc_Æã∫©ive_¨øy
(
u_öt
 
size
)

901 
i
;

902 
ªc_Æã∫©ive
* 
ri
;

904 
ri
 = (
ªc_Æã∫©ive
*Ë
	`ß„_mÆloc
(
size
 * (rec_alternative));

906  
i
 = 0; i < 
size
; i++ ) {

907 
ri
[
i
].
ø_ñem
.
ª_ty≥
 = 
REC_NONE
;

908 
ri
[
i
].
ø_ñem
.
ª_ªsu…
.
avÆ
 = 
NULL
;

909 
ri
[
i
].
ø_ñem
.
ª_c⁄f
 = 0;

910 
ri
[
i
].
ø_«…î
 = 0;

911 
ri
[
i
].
ø_√xt
 = 
NULL
;

914 (
ri
);

915 
	}
}

917 
ªc_Æã∫©ive
*

918 
	$öôülize_ªc_Æã∫©ive
(
ªc_Æã∫©ive
* 
ø
,

919 
u_öt
 
√Àm
)

921 if–
ø
 !
NULL
 ) {

922 if–(
ø
->
ø_√xt
 = 
	`make_ªc_Æã∫©ive_¨øy
(
√Àm
)Ë=
NULL
 ) {

923 (
NULL
);

926 
ø
->
ø_«…î
 = 
√Àm
;

929 (
ø
);

930 
	}
}

932 
	$dñëe_ªc_Æã∫©ive_¨øy
(
u_öt
 
«…î
,

933 
ªc_Æã∫©ive
* 
ø
,

934 
boﬁ
 
dñëe_poöts_p
)

936 
i
;

938 if–
ø
 !
NULL
 ) {

940  
i
 = 0; i < 
«…î
; i++ ) {

941 
	`˛ónup_ªc_ñemít
(&
ø
[
i
].
ø_ñem
,
dñëe_poöts_p
);

945 if–
ø
[
i
].
ø_«…î
 > 0 ) {

946 
	`dñëe_ªc_Æã∫©ive_¨øy
(
ø
[
i
].
ø_«…î
,

947 
ø
[
i
].
ø_√xt
,

948 
dñëe_poöts_p
);

952 
	`‰ì
(
ø
);

954 
	}
}

959 
ªc_ñemít
*

960 
	$öôülize_ªc_ñemít
(
ªc_ñemít
* 
ª
,

961 
ty≥
,

962 
u_öt
 
size
,

963 * 
å™s
,

964 
ªc_c⁄fidí˚
 
c⁄f
)

966 if–
ª
 !
NULL
 ) {

968 
ª
->
ª_ty≥
 = 
ty≥
;

969 
ª
->
ª_c⁄f
 = 
c⁄f
;

970 
ª
->
ª_ªsu…
.
avÆ
 = 
NULL
;

972 
ty≥
) {

974 
REC_GESTURE
:

975 if–
size
 > 0 && 
å™s
 !
NULL
 ) {

976 
ª
->
ª_ªsu…
.
gvÆ
 =

977 (
ge°uª
*)
	`ß„_mÆloc
((gesture));

978 
	`mem˝y
((*)
ª
->
ª_ªsu…
.
gvÆ
,
å™s
,(
ge°uª
));

982 
REC_ASCII
:

983 
REC_VAR
:

984 
REC_OTHER
:

985 if–
size
 > 0 && 
å™s
 !
NULL
 ) {

986 
ª
->
ª_ªsu…
.
avÆ
 =

987 (*)
	`ß„_mÆloc
((
size
+1)*());

988 
	`mem˝y
((*)
ª
->
ª_ªsu…
.
avÆ
,
å™s
,
size
*());

989 
ª
->
ª_ªsu…
.
avÆ
[
size
] = '\000';

993 
REC_WCHAR
:

994 if–
size
 > 0 && 
å™s
 !
NULL
 ) {

995 
ª
->
ª_ªsu…
.
wvÆ
 =

996 (
wch¨_t
*)
	`ß„_mÆloc
((
size
+1)*(wchar_t));

997 
	`mem˝y
((*)
ª
->
ª_ªsu…
.
wvÆ
,
å™s
,
size
*(
wch¨_t
));

998 
ª
->
ª_ªsu…
.
wvÆ
[
size
] = '\000';

1002 
REC_CORR
:

1003 if–
size
 > 0 && 
å™s
 !
NULL
 ) {

1004 
ª
->
ª_ªsu…
.
rcvÆ
 =

1005 (
ªc_c‹ªœti⁄
*)
	`ß„_mÆloc
((rec_correlation));

1006 
	`mem˝y
((*)
ª
->
ª_ªsu…
.
rcvÆ
,

1007 
å™s
,

1008 (
ªc_c‹ªœti⁄
));

1013 (
NULL
);

1018 (
ª
);

1019 
	}
}

1021 
	$˛ónup_ªc_ñemít
(
ªc_ñemít
* 
ª
,
boﬁ
 
dñëe_poöts_p
)

1023 
ª
->
ª_ty≥
) {

1025 
REC_NONE
:

1028 
REC_ASCII
:

1029 
REC_VAR
:

1030 
REC_WCHAR
:

1031 
REC_OTHER
:

1032 
	`‰ì
(
ª
->
ª_ªsu…
.
avÆ
);

1035 
REC_GESTURE
:

1036 
	`dñëe_ge°uª_¨øy
(1,
ª
->
ª_ªsu…
.
gvÆ
,
åue
);

1039 
REC_CORR
:

1040 
	`dñëe_ªc_c‹ªœti⁄
(
ª
->
ª_ªsu…
.
rcvÆ
,

1041 
dñëe_poöts_p
);

1046 
	}
}

1053 
ªc_c‹ªœti⁄
*

1054 
	$make_ªc_c‹ªœti⁄
(
ty≥
,

1055 
u_öt
 
size
,

1056 * 
å™s
,

1057 
ªc_c⁄fidí˚
 
c⁄f
,

1058 
u_öt
 
ps_size
)

1060 
ªc_c‹ªœti⁄
* 
rc
;

1062 
rc
 = (
ªc_c‹ªœti⁄
*)
	`ß„_mÆloc
((rec_correlation));

1064 
rc
->
ro_n°rokes
 = 
ps_size
;

1068 if–
	`öôülize_ªc_ñemít
(&(
rc
->
ro_ñem
),

1069 
ty≥
,

1070 
size
,

1071 
å™s
,

1072 
c⁄f
Ë=
NULL
 ) {

1073 (
NULL
);

1076 if–(
rc
->
ro_°rokes
 = 
	`make_≥n_°roke_¨øy
(
ps_size
)Ë=
NULL
 ) {

1077 (
NULL
);

1080 
rc
->
ro_°¨t
 = (
u_öt
*)
	`ß„_mÆloc
(
ps_size
 * ());

1081 
rc
->
ro_°›
 = (
u_öt
*)
	`ß„_mÆloc
(
ps_size
 * ());

1082 (
rc
);

1083 
	}
}

1085 
	$dñëe_ªc_c‹ªœti⁄
(
ªc_c‹ªœti⁄
* 
rc
,
boﬁ
 
dñëe_poöts_p
)

1087 if–
rc
 !
NULL
 ) {

1089 
	`˛ónup_ªc_ñemít
(&
rc
->
ro_ñem
,
dñëe_poöts_p
);

1091 
	`dñëe_≥n_°roke_¨øy
(
rc
->
ro_n°rokes
,rc->
ro_°rokes
,
dñëe_poöts_p
);

1093 if–
rc
->
ro_°¨t
 !
NULL
 ) {

1094 
	`‰ì
(
rc
->
ro_°¨t
);

1097 if–
rc
->
ro_°›
 !
NULL
 ) {

1098 
	`‰ì
(
rc
->
ro_°›
);

1101 
	`‰ì
(
rc
);

1104 
	}
}

1112 
ªc_‚
* 
	$make_ªc_‚_¨øy
(
u_öt
 
size
)

1114 
ªc_‚
* 
ri
 = (ªc_‚*)
	`ß„_mÆloc
((
size
 + 1) * (rec_fn));

1115 
i
;

1117  
i
 = 0; i < 
size
; i++ ) {

1118 
ri
[
i
] = 
NULL
;

1121 
ri
[
i
] = 
NULL
;

1123 (
ri
);

1124 
	}
}

1126 
	$dñëe_ªc_‚_¨øy
(
ªc_‚
* 
rf
)

1128 if–
rf
 !
NULL
 ) {

1129 
	`‰ì
(
rf
);

1131 
	}
}

1138 
≥n_°roke
* 
	$make_≥n_°roke_¨øy
(
u_öt
 
size
)

1140 
i
;

1141 
≥n_°roke
* 
ri
;

1143 
ri
 = (
≥n_°roke
*Ë
	`ß„_mÆloc
(
size
 * (pen_stroke));

1144  
i
 = 0; i < 
size
; i++ ) {

1145 
ri
[
i
].
ps_≈ts
 = 0;

1146 
ri
[
i
].
ps_±s
 = 
NULL
;

1147 
ri
[
i
].
ps_n°©e
 = 0;

1148 
ri
[
i
].
ps_°©e
 = 
NULL
;

1151 (
ri
);

1152 
	}
}

1154 
≥n_°roke
* 
	$öôülize_≥n_°roke
(
≥n_°roke
* 
ps
,

1155 
u_öt
 
≈ts
,

1156 
≥n_poöt
* 
±s
,

1157 
u_öt
 
n°©e
,

1158 
u_öt
* 
å™s
,

1159 
≥n_°©e
* 
°©e
)

1161 if–
ps
 !
NULL
 ) {

1162 
ps
->
ps_≈ts
 = 
≈ts
;

1163 
ps
->
ps_±s
 = 
±s
;

1164 
ps
->
ps_n°©e
 = 
n°©e
;

1165 
ps
->
ps_å™s
 = 
å™s
;

1166 
ps
->
ps_°©e
 = 
°©e
;

1168  (
ps
);

1169 
	}
}

1171 
	$dñëe_≥n_°roke_¨øy
(
u_öt
 
size
,
≥n_°roke
* 
ps
,
boﬁ
 
dñëe_poöts_p
)

1173 
i
;

1175 if–
ps
 !
NULL
 ) {

1177  
i
 = 0; i < 
size
; i++ ) {

1179 if–
ps
[
i
].
ps_°©e
 !
NULL
 ) {

1180 
	`‰ì
(
ps
[
i
].
ps_°©e
);

1183 if–
ps
[
i
].
ps_å™s
 !
NULL
 ) {

1184 
	`‰ì
(
ps
[
i
].
ps_å™s
);

1187 if–
dñëe_poöts_p
 ) {

1188 
	`dñëe_≥n_poöt_¨øy
(
ps
[
i
].
ps_±s
);

1193 
	`‰ì
(
ps
);

1195 
	}
}

1202 
≥n_poöt
* 
	$make_≥n_poöt_¨øy
(
u_öt
 
size
)

1204 
≥n_poöt
* 
µ
 = (≥n_poöt*)
	`ß„_mÆloc
(
size
 * (pen_point));

1205 
i
;

1207  
i
 = 0; i < 
size
; i++ ) {

1208 
µ
[
i
].
time
 = 0;

1209 
µ
[
i
].
x
 =Öp[i].
y
 = 0;

1212 (
µ
);

1213 
	}
}

1215 
	$dñëe_≥n_poöt_¨øy
(
≥n_poöt
* 
µ
)

1217 if–
µ
 !
NULL
 ) {

1218 
	`‰ì
(
µ
);

1220 
	}
}

1227 
≥n_°©e
* 
	$make_≥n_°©e_¨øy
(
u_öt
 
size
)

1229 
i
;

1231 
≥n_°©e
* 
ps
 = (≥n_°©e*)
	`ß„_mÆloc
(
size
*(pen_state));

1233  
i
 = 0; i < 
size
; i++ ) {

1234 
ps
[
i
].
±_buâ⁄
 = 0;

1235 
ps
[
i
].
±_≥n
 = 0;

1236 
ps
[
i
].
±_¥essuª
 = 0;

1237 
ps
[
i
].
±_™gÀx
 = 0.0;

1238 
ps
[
i
].
±_™gÀy
 = 0.0;

1239 
ps
[
i
].
±_b¨ªÃŸ©e
 = 0.0;

1242 (
ps
);

1244 
	}
}

1246 
≥n_°©e
* 
	$öôülize_≥n_°©e
(
≥n_°©e
* 
ps
,

1247 
u_sh‹t
 
buâ⁄
,

1248 
u_sh‹t
 
≥n
,

1249 
¥essuª
,

1250 
™gÀx
,

1251 
™gÀy
,

1252 
b¨ªÃŸ©e
)

1254 if–
ps
 !
NULL
 ) {

1255 
ps
->
±_buâ⁄
 = 
buâ⁄
;

1256 
ps
->
±_≥n
 = 
≥n
;

1257 
ps
->
±_¥essuª
 = 
¥essuª
;

1258 
ps
->
±_™gÀx
 = 
™gÀx
;

1259 
ps
->
±_™gÀy
 = 
™gÀy
;

1260 
ps
->
±_b¨ªÃŸ©e
 = 
b¨ªÃŸ©e
;

1263 (
ps
);

1264 
	}
}

1266 
	$dñëe_≥n_°©e_¨øy
(
≥n_°©e
* 
ps
)

1268 if–
ps
 !
NULL
 ) {

1269 
	`‰ì
(
ps
);

1271 
	}
}

1277 
ge°uª
*

1278 
	$make_ge°uª_¨øy
(
u_öt
 
size
)

1280 ((
ge°uª
*)
	`ß„_mÆloc
(
size
 * (gesture)));

1281 
	}
}

1283 
ge°uª
* 
	$öôülize_ge°uª
(
ge°uª
* 
g
,

1284 * 
«me
,

1285 
u_öt
 
nhs
,

1286 
≥n_poöt
* 
h•Ÿs
,

1287 
≥n_ª˘
 
bbox
,

1288 
xge°uª
 
‚
,

1289 * 
wsöfo
)

1291 if–
g
 !
NULL
 ) {

1295 
g
->
g_nhs
 = 
nhs
;

1296 
g
->
g_h•Ÿs
 = 
h•Ÿs
;

1298 
g
->
g_«me
 = 
	`°rdup
(
«me
);

1300 
g
->
g_bbox
.
x
 = 
bbox
.x;

1301 
g
->
g_bbox
.
y
 = 
bbox
.y;

1302 
g
->
g_bbox
.
width
 = 
bbox
.width;

1303 
g
->
g_bbox
.
height
 = 
bbox
.height;

1304 
g
->
g_a˘i⁄
 = 
‚
;

1305 
g
->
g_wsöfo
 = 
wsöfo
;

1308 (
g
);

1309 
	}
}

1312 
	$dñëe_ge°uª_¨øy
(
u_öt
 
size
,
ge°uª
* 
ga
,
boﬁ
 
dñëe_poöts_p
)

1314 
i
;

1316 if–
ga
 !
NULL
 ) {

1318  
i
 = 0; i < 
size
; i++ ) {

1320 
	`‰ì
(
ga
[
i
].
g_«me
);

1322 if–
dñëe_poöts_p
 ) {

1323 
	`dñëe_≥n_poöt_¨øy
(
ga
[
i
].
g_h•Ÿs
);

1327 
	`‰ì
(
ga
);

1329 
	}
}

1335 
≥n_°roke
*

1336 
	$c›y_≥n_°roke
(
≥n_°roke
* 
ps1
,≥n_°roke* 
ps2
)

1338 
u_öt
* 
å™s
 = 
NULL
;

1339 
≥n_°©e
* 
°©e
 = 
NULL
;

1341 if–(
å™s
 =

1342 
	`c›y_°©e_å™s_¨øy
(
ps2
->
ps_n°©e
,

1343 
ps2
->
ps_å™s
)Ë=
NULL
 ) {

1344 (
NULL
);

1347 if–(
°©e
 =

1348 
	`c›y_≥n_°©e_¨øy
(
ps2
->
ps_n°©e
,

1349 
ps2
->
ps_°©e
)Ë=
NULL
 ) {

1350 
	`‰ì
(
å™s
);

1351 (
NULL
);

1354 
	`öôülize_≥n_°roke
(
ps1
,

1355 
ps2
->
ps_≈ts
,

1356 
ps2
->
ps_±s
,

1357 
ps2
->
ps_n°©e
,

1358 
å™s
,

1359 
°©e
);

1360 (
ps1
);

1362 
	}
}

1364 
≥n_°roke
*

1365 
	$c›y_≥n_°roke_¨øy
(
u_öt
 
n°rokes
,

1366 
≥n_°roke
* 
°rokes
)

1368 
i
;

1369 
≥n_°roke
* 
ps
 = 
	`make_≥n_°roke_¨øy
(
n°rokes
);

1371 if–
ps
 !
NULL
 ) {

1373  
i
 = 0; i < 
n°rokes
; i++ ) {

1375 
	`c›y_≥n_°roke
(&
ps
[
i
],&
°rokes
[i]);

1381 (
ps
);

1382 
	}
}

1384 
≥n_°©e
*

1385 
	$c›y_≥n_°©e_¨øy
(
u_öt
 
n°©e
,
≥n_°©e
* 
°©e
)

1387 
≥n_°©e
* 
ps
 = 
	`make_≥n_°©e_¨øy
(
n°©e
);

1388 
i
;

1390 if–
ps
 !
NULL
 ) {

1392  
i
 = 0; i < 
n°©e
; i++ ) {

1394 
	`öôülize_≥n_°©e
(&
ps
[
i
],

1395 
°©e
[
i
].
±_buâ⁄
,

1396 
°©e
[
i
].
±_≥n
,

1397 
°©e
[
i
].
±_¥essuª
,

1398 
°©e
[
i
].
±_™gÀx
,

1399 
°©e
[
i
].
±_™gÀy
,

1400 
°©e
[
i
].
±_b¨ªÃŸ©e
);

1405 (
ps
);

1406 
	}
}

1408 
u_öt
*

1409 
	$c›y_°©e_å™s_¨øy
(
u_öt
 
¡øns
,u_öt* 
å™s
)

1411 
u_öt
* 
±
 = (u_öt*)
	`ß„_mÆloc
(
¡øns
*(u_int));

1412 
i
;

1414  
i
 = 0; i < 
¡øns
; i++ ) {

1415 
±
[
i
] = 
å™s
[i];

1417 (
±
);

1419 
	}
}

1421 
≥n_°roke
*

1422 
	$c⁄ˇã«ã_≥n_°rokes
(
n°rokes1
,

1423 
≥n_°roke
* 
°rokes1
,

1424 
n°rokes2
,

1425 
≥n_°roke
* 
°rokes2
,

1426 * 
n°rokes3
,

1427 
≥n_°roke
** 
°rokes3
)

1429 
i
;

1430 
ns
;

1431 
≥n_°roke
* 
ps
;

1435 
ns
 = 
n°rokes1
 + 
n°rokes2
;

1439 if–(
ps
 = 
	`make_≥n_°roke_¨øy
(
ns
)Ë=
NULL
 ) {

1440 (
NULL
);

1445  
i
 = 0; i < 
n°rokes1
; i++ ) {

1446 if–
	`c›y_≥n_°roke
(&
ps
[
i
],&
°rokes1
[i]Ë=
NULL
 ) {

1447 
	`dñëe_≥n_°roke_¨øy
(
ns
,
ps
,
Ál£
);

1448 (
NULL
);

1452  ; 
i
 < 
ns
; i++ ) {

1453 if–
	`c›y_≥n_°roke
(&
ps
[
i
],&
°rokes2
[ò- 
n°rokes1
]Ë=
NULL
 ) {

1454 
	`dñëe_≥n_°roke_¨øy
(
ns
,
ps
,
Ál£
);

1455 (
NULL
);

1459 *
n°rokes3
 = 
ns
;

1460 *
°rokes3
 = 
ps
;

1462 (
ps
);

1463 
	}
}

	@demos/nxscribble/hre_api.h

22 #i‚de‡
_HRE_API_H_


24 
	#_HRE_API_H_


	)

31 * 
	tªcognizî
;

37 * 
	tw‹d£t
;

39 
	~<hª.h
>

40 
	~<hª_≠i_öã∫Æ.h
>

	@demos/nxscribble/hre_api_internal.h

22 #i‚de‡
_HRE_API_INTERNAL_H_


24 
	#_HRE_API_INTERNAL_H_


	)

28 
	~<hª.h
>

42 
ªcognizî


43 
ªcognizî_lﬂd
(* 
dúe˘‹y
,* 
«me
,** 
sub£t
);

50 
ªcognizî_u∆ﬂd
(
ªcognizî
 
ªc
);

58 c⁄° 
ªc_öfo
*

59 
ªcognizî_gë_öfo
(
ªcognizî
 
ªc
);

67 c⁄° * 
ªcognizî_m™agî_vîsi⁄
(
ªcognizî
 
ªc
);

77 
ªcognizî_lﬂd_°©e
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
);

87 
ªcognizî_ßve_°©e
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
);

94 
ªcognizî_îr‹
(
ªcognizî
 
ªc
);

105 
w‹d£t


106 
ªcognizî_lﬂd_di˘i⁄¨y
(
ªcognizî
 
ªc
,* 
dúe˘‹y
,* 
«me
);

113 
ªcognizî_ßve_di˘i⁄¨y
(
ªcognizî
 
ªc
,* 
dú
,* 
«me
,
w‹d£t
 
di˘
);

121 
ªcognizî_‰ì_di˘i⁄¨y
(
ªcognizî
 
ªc
,
w‹d£t
 
di˘
);

129 
ªcognizî_add_to_di˘i⁄¨y
(
ªcognizî
 
ªc
,
Àâî£t
* 
w‹d
,
w‹d£t
 
di˘
);

137 
ªcognizî_dñëe_‰om_di˘i⁄¨y
(
ªcognizî
 
ªc
,
Àâî£t
* 
w‹d
,
w‹d£t
 
di˘
);

151 
ªcognizî_£t_c⁄ãxt
(
ªcognizî
 
ªc
,
rc
* 
ªc_xt
);

152 
rc
*

153 
ªcognizî_gë_c⁄ãxt
(
ªcognizî
 
ªc
);

162 
ªcognizî_˛ór
(
ªcognizî
 
ªc
,
boﬁ
 
dñëe_poöts_p
);

170 
ªcognizî_gë_buf„r
(
ªcognizî
 
ªc
, 
u_öt
* 
n°rokes
,
≥n_°roke
** 
°rokes
);

173 
ªcognizî_£t_buf„r
(
ªcognizî
 
ªc
,
u_öt
 
n°rokes
,
≥n_°roke
* 
°rokes
);

187 
ªcognizî_å™¶©e
(
ªcognizî
 
ªc
,

188 
u_öt
 
n°rokes
,

189 
≥n_°roke
* 
°rokes
,

190 
boﬁ
 
c‹ªœã_p
,

191 * 
ƒë
,

192 
ªc_Æã∫©ive
** 
ªt
);

200 
ªc_‚
*

201 
ªcognizî_gë_exãnsi⁄_fun˘i⁄s
(
ªcognizî
 
ªc
);

214 
ªcognizî_gë_ge°uª_«mes
(
ªcognizî
 
ªc
);

221 
xge°uª


222 
ªcognizî_£t_ge°uª_a˘i⁄
(
ªcognizî
 
ªc
,

223 * 
«me
,

224 
xge°uª
 
‚
,

225 * 
wsöof
);

234 
dñëe_ªc_Æã∫©ive_¨øy
(
u_öt
 
«…î
,

235 
ªc_Æã∫©ive
* 
ø
,

236 
boﬁ
 
dñëe_poöts_p
);

239 
dñëe_ªc_c‹ªœti⁄
(
ªc_c‹ªœti⁄
* 
c‹r
,

240 
boﬁ
 
dñëe_poöts_p
);

247 
≥n_°roke
*

248 
make_≥n_°roke_¨øy
(
u_öt
 
size
);

249 
≥n_°roke
*

250 
öôülize_≥n_°roke
(
≥n_°roke
* 
ps
,

251 
u_öt
 
≈ts
,

252 
≥n_poöt
* 
±s
,

253 
u_öt
 
n°©e
,

254 
u_öt
* 
å™s
,

255 
≥n_°©e
* 
°©e
);

257 
dñëe_≥n_°roke_¨øy
(
u_öt
 
size
,
≥n_°roke
* 
ps
,
boﬁ
 
dñëe_poöts_p
);

259 
≥n_poöt
*

260 
make_≥n_poöt_¨øy
(
u_öt
 
size
);

262 
dñëe_≥n_poöt_¨øy
(
≥n_poöt
* 
µ
);

264 
≥n_°roke
*

265 
c›y_≥n_°roke_¨øy
(
u_öt
 
n°rokes
,
≥n_°roke
* 
°rokes
);

266 
≥n_°©e
*

267 
c›y_≥n_°©e_¨øy
(
u_öt
 
n°©e
,
≥n_°©e
* 
°©e
);

268 
u_öt
*

269 
c›y_°©e_å™s_¨øy
(
u_öt
 
¡øns
,u_öt* 
å™s
);

271 
≥n_°©e
*

272 
make_≥n_°©e_¨øy
(
u_öt
 
size
);

273 
≥n_°©e
*

274 
öôülize_≥n_°©e
(
≥n_°©e
* 
ps
,

275 
u_sh‹t
 
buâ⁄
,

276 
u_sh‹t
 
≥n
,

277 
¥essuª
,

278 
™gÀx
,

279 
™gÀy
,

280 
b¨ªÃŸ©e
);

282 
dñëe_≥n_°©e_¨øy
(
≥n_°©e
* 
ps
);

	@demos/nxscribble/hre_internal.h

22 #i‚de‡
_HRE_INTERNAL_H_


24 
	#_HRE_INTERNAL_H_


	)

28 
	#w‹d£t
 *

	)

30 
	~<hª.h
>

32 #unde‡
w‹d£t


34 
	#ªcognizî
 *

	)

43 
	s_w‹d£t
 {

44 * 
	mws_∑th«me
;

45 
ªcognizî
 
	mws_ªcognizî
;

46 * 
	mws_öã∫Æ
;

47 } *
	tw‹d£t
;

49 #unde‡
ªcognizî


58 
	s_Recognizî
 {

59 
u_öt
 
	mªcognizî_magic
;

62 * 
	mªcognizî_vîsi⁄
;

64 
ªc_öfo
* 
	mªcognizî_öfo
;

65 * 
	mªcognizî_•ecific
;

67 (*
	mªcognizî_lﬂd_°©e
)(

68 
	m_Recognizî
*,

74 (*
	mªcognizî_ßve_°©e
)(

75 
	m_Recognizî
*,

81 (*
	mªcognizî_îr‹
)(

82 
	m_Recognizî
*);

83 
	mw‹d£t


84 (*
	mªcognizî_lﬂd_di˘i⁄¨y
)(

89 
	m_Recognizî
*,

92 (*
	mªcognizî_ßve_di˘i⁄¨y
)(

98 
	m_Recognizî
*,

99 *, *, 
	mw‹d£t
);

102 (*
	mªcognizî_‰ì_di˘i⁄¨y
)(

106 
	m_Recognizî
*,

107 
	mw‹d£t
);

109 (*
	mªcognizî_add_to_di˘i⁄¨y
)(

114 
	m_Recognizî
*,

115 
	mÀâî£t
*, 
	mw‹d£t
);

117 (*
	mªcognizî_dñëe_‰om_di˘i⁄¨y
)(

122 
	m_Recognizî
*,

123 
	mÀâî£t
*, 
	mw‹d£t
);

125 (*
	mªcognizî_£t_c⁄ãxt
)(

129 
	m_Recognizî
*,
	mrc
*);

130 
	mrc
*

131 (*
	mªcognizî_gë_c⁄ãxt
)(

134 
	m_Recognizî
*);

137 (*
	mªcognizî_˛ór
)(

141 
	m_Recognizî
*, 
	mboﬁ
);

143 (*
	mªcognizî_gë_buf„r
)(

148 
	m_Recognizî
*, 
	mu_öt
*, 
	m≥n_°roke
**);

151 (*
	mªcognizî_£t_buf„r
)(

156 
	m_Recognizî
*, 
	mu_öt
, 
	m≥n_°roke
*);

158 (*
	mªcognizî_å™¶©e
)(

166 
	m_Recognizî
*, 
	mu_öt
, 
	m≥n_°roke
*,

167 
	mboﬁ
, *, 
	mªc_Æã∫©ive
**);

168 
	mªc_‚
*

169 (*
	mªcognizî_gë_exãnsi⁄_fun˘i⁄s
)(

170 
	m_Recognizî
*);

172 (*
	mªcognizî_gë_ge°uª_«mes
)(

173 
	m_Recognizî
*);

174 
	mxge°uª


175 (*
	mªcognizî_£t_ge°uª_a˘i⁄
)(

176 
	m_Recognizî
*,

181 *, 
	mxge°uª
, *);

182 
u_öt
 
	mªcognizî_íd_magic
;

185 
_Recognizî
* 
	tªcognizî
;

197 
	$ªcognizî
 (*
	tªcognizî_öã∫Æ_öôülize
)(
	tªc_öfo
* 
	tri
);

203 
	#RECOGNIZER_INITIALIZE
(
_a
) \

204 
ªcognizî
 
	`__ªcognizî_öã∫Æ_öôülize
(
ªc_öfo
* 
_a
)

	)

213 (*
	tªcognizî_öã∫Æ_föÆize
)(
	tªcognizî
 
	tr
);

215 
	#RECOGNIZER_FINALIZE
(
_a
) \

216 
	`__ªcognizî_öã∫Æ_föÆize
(
ªcognizî
 
_a
)

	)

223 
ªcognizî


224 
	`make_ªcognizî
(
ªc_öfo
* 
ri
);

226 
	`dñëe_ªcognizî
(
ªcognizî
 
ªc
);

228 
ªc_Æã∫©ive
*

229 
	`make_ªc_Æã∫©ive_¨øy
(
u_öt
 
size
);

230 
ªc_c‹ªœti⁄
*

231 
	`make_ªc_c‹ªœti⁄
(
ty≥
,

232 
u_öt
 
size
,

233 * 
å™s
,

234 
ªc_c⁄fidí˚
 
c⁄f
,

235 
u_öt
 
ps_size
);

237 
ªc_‚
*

238 
	`make_ªc_‚_¨øy
(
u_öt
 
size
);

240 
	`dñëe_ªc_‚_¨øy
(
ªc_‚
* 
rf
);

242 
ge°uª
*

243 
	`öôülize_ge°uª
(
ge°uª
* 
g
,

244 * 
«me
,

245 
u_öt
 
nhs
,

246 
≥n_poöt
* 
h•Ÿs
,

247 
≥n_ª˘
 
bbox
,

248 
xge°uª
 
cback
,

249 * 
wsöfo
);

250 
ge°uª
*

251 
	`make_ge°uª_¨øy
(
u_öt
 
size
);

253 
	`dñëe_ge°uª_¨øy
(
u_öt
 
size
,
ge°uª
* 
ga
,
boﬁ
 
dñëe_poöts_p
);

255 
≥n_°roke
*

256 
	`c⁄ˇã«ã_≥n_°rokes
(
n°rokes1
,

257 
≥n_°roke
* 
°rokes1
,

258 
n°rokes2
,

259 
≥n_°roke
* 
°rokes2
,

260 * 
n°rokes3
,

261 
≥n_°roke
** 
°rokes3
);

263 
ªc_Æã∫©ive
*

264 
	`öôülize_ªc_Æã∫©ive
(
ªc_Æã∫©ive
* 
ø
,
u_öt
 
√Àm
);

265 
ªc_ñemít
*

266 
	`öôülize_ªc_ñemít
(
ªc_ñemít
* 
ª
,

267 
ty≥
,

268 
u_öt
 
size
,

269 * 
å™s
,

270 
ªc_c⁄fidí˚
 
c⁄f
);

279 
	#REC_DEFAULT_LOCALE
 "C"

	)

280 
	#RECHOME
 "RECHOME"

	)

281 
	#LANG
 "LANG"

	)

283 
	~<hª_≠i_öã∫Æ.h
>

	@demos/nxscribble/li_recognizer.c

20 
	~<sys/ty≥s.h
>

21 
	~<°dio.h
>

22 
	~<°rög.h
>

23 #i‚de‡
ELX


24 
	~<°dlib.h
>

26 
	~<m©h.h
>

27 
	~<loˇÀ.h
>

28 
	~<hª_öã∫Æ.h
>

29 
	~<£tjmp.h
>

30 
	~"utû.h
"

31 
	~"m©rix.h
"

32 
	~"sc.h
"

33 
	~"li_ªcognizî.h
"

34 
	~"li_ªcognizî_öã∫Æ.h
"

37 
	glidebug
 = 0;

41 
	#LI_MAGIC
 0xACCBADDD

	)

43 
	#CHECK_LI_MAGIC
(
_a
) \

44 ((
_a
Ë!
NULL
 && ((
li_ªcognizî
*)(_a))->
li_magic
 =
LI_MAGIC
)

	)

47 
lülg_öôülize
(
rCœssifõr
 *);

48 
lülg_ªad_˛assifõr_dige°
(
rCœssifõr
 *);

49 
lülg_ˇn⁄iˇlize_exam∂es
(
rCœssifõr
 *);

50 *
lülg_ªcognize_°roke
(
rCœssifõr
 *, 
poöt_li°
 *);

53 * 
	gli_îr_msg
 = 
NULL
;

54 
	g_zdebug_Êag
[128];

56 #i‚de‡
__ECOS


58 
	#bc›y
(
s1
,
s2
,
n
Ë
	`mem˝y
(s2,s1,n)

	)

62 *
	$°rdup
(* 
‰om
) {

63 * 
to
;

64 
Àn
 = 
	`°æí
(
‰om
) + 1;

67 
to
 = 
	`Æloˇã
(
Àn
, );

68 
	`mem˝y
(
to
, 
‰om
, 
Àn
);

69  
to
;

70 
	}
}

77 
‰ì_rCœssifõr
(
rCœssifõr
* 
rc
);

83 
poöt_li°
*

84 
	$add_exam∂e
(
poöt_li°
* 
l
,
≈ts
,
≥n_poöt
* 
±s
)

86 
≥n_poöt
* 
Õts
 = 
	`make_≥n_poöt_¨øy
(
≈ts
);

88 
poöt_li°
 *
p
 = 
	`Æloˇã
(1,Öoint_list);

90 
p
->
≈ts
 =Çpts;

91 
p
->
±s
 = 
Õts
;

92 
p
->
√xt
 = 
l
;

96 
	`bc›y
(
±s
,
Õts
,
≈ts
 * (
≥n_poöt
));

98 (
p
);

99 
	}
}

103 
	$dñëe_exam∂es
(
poöt_li°
* 
l
)

105 
poöt_li°
* 
p
;

107  ; 
l
 !
NULL
;Ü = 
p
 ) {

108 
p
 = 
l
->
√xt
;

109 
	`‰ì
(
l
->
±s
);

110 
	`‰ì
(
l
);

112 
	}
}

123 
	$ªcognize_öã∫Æ
(
rCœssifõr
* 
ªc
,
≥n_°roke
* 
°r
,* 
rc⁄f
)

125 *
ªs
 = 
NULL
;

126 
poöt_li°
 *
°roke
 = 
NULL
;

128 
°roke
 = 
	`add_exam∂e
(
NULL
, 
°r
->
ps_≈ts
, så->
ps_±s
);

129 i‡(
°roke
 =
NULL
) (NULL);

131 
ªs
 = 
	`lülg_ªcognize_°roke
(
ªc
, 
°roke
);

133 
	`dñëe_exam∂es
(
°roke
);

134 (
ªs
);

135 
	}
}

142 
	$fûe_∑th
(* 
dú
,* 
fûíame
,* 
∑th«me
)

144 * 
dŸ
;

148 
dŸ
 = 
	`°ºchr
(
fûíame
,'.');

150 if–
dŸ
 =
NULL
 ) {

156 if–
	`°rcmp
(
dŸ
,
LI_CLASSIFIER_EXTENSION
) != 0 ) {

162 
	`°r˝y
(
∑th«me
,
dú
);

163 
	`°rˇt
(
∑th«me
,"/");

164 
	`°rˇt
(
∑th«me
,
fûíame
);

167 
	}
}

172 
	$ªad_˛assifõr_poöts
(
FILE
* 
fd
,
n˛ss
,
poöt_li°
** 
ex
,** 
˙ames
)

174 
i
,
j
,
k
;

175 
buf
[
BUFSIZ
];

176 
√x
 = 0;

177 * 
«mes
[
MAXSCLASSES
];

178 
poöt_li°
* 
exam∂es
[
MAXSCLASSES
];

179 
≥n_poöt
* 
±s
;

180 
≈ts
;

184  
i
 = 0; i < 
MAXSCLASSES
; i++ ) {

185 
«mes
[
i
] = 
NULL
;

186 
exam∂es
[
i
] = 
NULL
;

194  
k
 = 0; k < 
n˛ss
; k++ ) {

198 if–
	`fsˇnf
(
fd
,"%d %s",&
√x
,
buf
) != 2 ) {

199 
	`¥ötf
("%†*FAILED* -Üöe: %d\n", 
__FUNCTION__
, 
__LINE__
);

200 
u«Œoˇã
;

205 
«mes
[
k
] = 
	`°rdup
(
buf
);

211  
i
 = 0; i < 
√x
; i++ ) {

215 if–
	`fsˇnf
(
fd
,"%d",&
≈ts
) != 1 ) {

216 
	`¥ötf
("%†*FAILED* -Üöe: %d\n", 
__FUNCTION__
, 
__LINE__
);

217 
u«Œoˇã
;

222 if–(
±s
 = 
	`make_≥n_poöt_¨øy
(
≈ts
)Ë=
NULL
 ) {

223 
	`¥ötf
("%†*FAILED* -Üöe: %d\n", 
__FUNCTION__
, 
__LINE__
);

224 
u«Œoˇã
;

229  
j
 = 0; j < 
≈ts
; j++ ) {

230 
x
,
y
;

231 
jj
;

232 if–
	`fsˇnf
(
fd
,"%d %d",&
x
,&
y
) != 2 ) {

233 
	`dñëe_≥n_poöt_¨øy
(
±s
);

234 
	`¥ötf
("%†*FAILED* -Üöe: %d\n", 
__FUNCTION__
, 
__LINE__
);

235 
	`¥ötf
("class = %d/%d/%s,Éx = %d/%d,Öt: %d/%d\n",

236 
k
, 
n˛ss
, 
«mes
[k], 
i
, 
√x
, 
j
, 
≈ts
);

237 
jj
 = 0; jj < 
j
; jj++) {

238 
	`¥ötf
("±s[%d] = %d/%d\n", 
jj
, 
±s
[jj].
x
,Öts[jj].
y
);

240 
u«Œoˇã
;

242 
±s
[
j
].
x
 = x;

243 
±s
[
j
].
y
 = y;

248 if–(
exam∂es
[
k
] = 
	`add_exam∂e
”xam∂es[k],
≈ts
,
±s
)Ë=
NULL
 ) {

249 
	`dñëe_≥n_poöt_¨øy
(
±s
);

250 
	`¥ötf
("%†*FAILED* -Üöe: %d\n", 
__FUNCTION__
, 
__LINE__
);

251 
u«Œoˇã
;

254 
	`dñëe_≥n_poöt_¨øy
(
±s
);

264 
	`bc›y
(
exam∂es
,
ex
,(examples));

265 
	`bc›y
(
«mes
,
˙ames
,(names));

271 
u«Œoˇã
:

273  ; 
k
 >= 0; k-- ) {

274 
	`dñëe_exam∂es
(
exam∂es
[
k
]);

275 
	`‰ì
(
«mes
[
k
]);

278 
	`îr‹
("Error inÑeadingÉxampleÖoints from classifier file");

280 
	}
}

284 
	$ªad_˛assifõr
(
FILE
* 
fd
,
rCœssifõr
* 
rc
)

286 
sCœssifõr
 
sc
;

288 
li_îr_msg
 = 
NULL
;

292 if–(
sc
 = 
	`sRód
(
fd
)Ë=
NULL
 ) {

298 if–
	`ªad_˛assifõr_poöts
(
fd
,
sc
->
n˛as£s
,
rc
->
ex
,rc->
˙ames
) != 0 ) {

299 
	`sFªeCœssifõr
(
sc
);

305 
rc
->
sc
 = sc;

308 
	}
}

317 
	$ªcognizî_gëCœs£s
 (
ªcognizî
 
r
, ***
li°
, *
nc
)

319 
i
, 
n˛as£s
;

320 
li_ªcognizî
* 
ªc
;

321 
sCœssifõr
 
sc
;

322 **
ªt
;

324 
ªc
 = (
li_ªcognizî
*)
r
->
ªcognizî_•ecific
;

328 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

329 
li_îr_msg
 = "Notá LIÑecognizer";

333 
sc
 = 
ªc
->
li_rc
.sc;

334 *
nc
 = 
n˛as£s
 = 
sc
->nclasses;

336 
ªt
 = 
	`Æloˇã
(
n˛as£s
, *);

338 
i
 = 0; i < 
n˛as£s
; i++) {

339 
ªt
[
i
] = 
ªc
->
li_rc
.
˙ames
[i];

341 *
li°
 = 
ªt
;

343 
	}
}

346 
	$ªcognizî_˛órSèã
 (
ªcognizî
 
r
)

350 
li_îr_msg
 = "Clearing state isÇot supported byÅhe LIÑecognizer";

353 
	}
}

355 
boﬁ
 
	$iß_li
(
ªcognizî
 
r
)

356 { (
	`CHECK_LI_MAGIC
(
r
)); 
	}
}

359 
	$ªcognizî_åaö
(
ªcognizî
 
r
,
rc
* 
ªc_xt
,
u_öt
 
n°rokes
,

360 
≥n_°roke
* 
°rokes
,
ªc_ñemít
* 
ª
,

361 
boﬁ
 
ª∂a˚_p
)

365 
li_îr_msg
 = "Training isÇot supported byÅhe LIÑecognizer";

368 
	}
}

371 
	$li_ªcognizî_gë_exam∂e
 (
ªcognizî
 
r
,

372 
˛ass
,

373 
ö°™˚
,

374 **
«me
,

375 
≥n_poöt
 **
poöts
,

376 *
≈ts
)

378 
li_ªcognizî
 *
ªc
 = (li_ªcognizî*)
r
->
ªcognizî_•ecific
;

379 
sCœssifõr
 
sc
 = 
ªc
->
li_rc
.sc;

380 
poöt_li°
 *
∂
;

382 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

383 
li_îr_msg
 = "Notá LIÑecognizer";

386 i‡(
˛ass
 > 
sc
->
n˛as£s
)

388 
∂
 = 
ªc
->
li_rc
.
ˇn⁄ex
[
˛ass
];

389 
ö°™˚
 && 
∂
)

391 
∂
 =Öl->
√xt
;

392 
ö°™˚
--;

394 i‡(!
∂
)

396 *
«me
 = 
ªc
->
li_rc
.
˙ames
[
˛ass
];

397 *
poöts
 = 
∂
->
±s
;

398 *
≈ts
 = 
∂
->npts;

400 
	}
}

409 
	$li_ªcognizî_lﬂd
(
ªcognizî
 
r
,* 
dú
,* 
fûíame
)

411 
FILE
 *
fd
;

412 * 
∑th«me
;

413 
li_ªcognizî
* 
ªc
;

414 
rCœssifõr
* 
rc
;

416 
ªc
 = (
li_ªcognizî
*)
r
->
ªcognizî_•ecific
;

420 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

421 
li_îr_msg
 = "Notá LIÑecognizer";

425 
rc
 = &(
ªc
->
li_rc
);

429 if–
fûíame
 =
NULL
 ) {

430 
li_îr_msg
 = "InvalidÖarameters";

436 if–
dú
 =
NULL
 || ()
	`°æí
(dir) <= 0 ) {

437 
dú
 = ".";

444 
∑th«me
 = 
	`Æloˇã
(
	`°æí
(
dú
Ë+ såÀn(
fûíame
) + 2, );

445 if–
	`fûe_∑th
(
dú
,
fûíame
,
∑th«me
) == -1 ) {

446 
	`‰ì
(
∑th«me
);

447 
li_îr_msg
 = "Notá LIÑecognizer classifier file";

452 
rc
->
fûe_«me
 = 
∑th«me
;

453 i‡(
	`lülg_ªad_˛assifõr_dige°
(
rc
) == 0)

455 
rc
->
fûe_«me
 = 
NULL
;

459 if–(
fd
 = 
	`f›í
(
∑th«me
,"r")Ë=
NULL
 ) {

460 
	`‰ì
(
∑th«me
);

461 
li_îr_msg
 = "Can't open classifier file";

470 if–
rc
->
fûe_«me
 !
NULL
 ) {

471 
	`‰ì_rCœssifõr
(
rc
);

476 if–
	`ªad_˛assifõr
(
fd
,
rc
) < 0 ) {

477 
	`‰ì
(
∑th«me
);

483 
	`f˛o£
(
fd
);

487 
rc
->
fûe_«me
 = 
∑th«me
;

490 i‡(
	`lülg_ˇn⁄iˇlize_exam∂es
(
rc
) != 0) {

491 
	`‰ì
(
∑th«me
);

492 
rc
->
fûe_«me
 = 
NULL
;

497 
	}
}

501 
	$li_ªcognizî_ßve
(
ªcognizî
 
r
,* 
dú
,* 
fûíame
)

505 
li_îr_msg
 = "Saving isÇot supported byÅhe LIÑecognizer";

508 
	}
}

510 
w‹d£t


511 
	$li_ªcognizî_lﬂd_di˘i⁄¨y
(
ªcognizî
 
ªc
,* 
dúe˘‹y
,* 
«me
)

515 
li_îr_msg
 = "DictionariesáreÇot supported byÅhe LIÑecognizer";

517 (
NULL
);

519 
	}
}

522 
	$li_ªcognizî_ßve_di˘i⁄¨y
(
ªcognizî
 
ªc
,

523 * 
dúe˘‹y
,

524 * 
«me
,

525 
w‹d£t
 
di˘
)

529 
li_îr_msg
 = "DictionariesáreÇot supported byÅhe LIÑecognizer";

533 
	}
}

536 
	$li_ªcognizî_‰ì_di˘i⁄¨y
(
ªcognizî
 
ªc
,
w‹d£t
 
di˘
)

540 
li_îr_msg
 = "DictionariesáreÇot supported byÅhe LIÑecognizer";

544 
	}
}

547 
	$li_ªcognizî_add_to_di˘i⁄¨y
(
ªcognizî
 
ªc
,
Àâî£t
* 
w‹d
,
w‹d£t
 
di˘
)

551 
li_îr_msg
 = "DictionariesáreÇot supported byÅhe LIÑecognizer";

555 
	}
}

558 
	$li_ªcognizî_dñëe_‰om_di˘i⁄¨y
(
ªcognizî
 
ªc
,

559 
Àâî£t
* 
w‹d
,

560 
w‹d£t
 
di˘
)

564 
li_îr_msg
 = "DictionariesáreÇot supported byÅhe LIÑecognizer";

568 
	}
}

571 
	$li_ªcognizî_îr‹
(
ªcognizî
 
ªc
)

573 * 
ªt
 = 
li_îr_msg
;

577 if–!
	`CHECK_LI_MAGIC
(
ªc
->
ªcognizî_•ecific
) ) {

578 
li_îr_msg
 = "Notá LIÑecognizer";

579 (
NULL
);

582 
li_îr_msg
 = 
NULL
;

584 (
ªt
);

585 
	}
}

588 
	$li_ªcognizî_˛ór
(
ªcognizî
 
r
,
boﬁ
 
dñëe_poöts_p
)

590 
li_ªcognizî
* 
ªc
;

592 
ªc
 = (
li_ªcognizî
*)
r
->
ªcognizî_•ecific
;

596 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

597 
li_îr_msg
 = "Notá LIÑecognizer";

602 
	}
}

605 
	$li_ªcognizî_£t_c⁄ãxt
(
ªcognizî
 
r
,
rc
* 
ªc_xt
)

609 
li_îr_msg
 = "ContextsáreÇot supported byÅhe LIÑecognizer";

612 
	}
}

614 
rc
*

615 
	$li_ªcognizî_gë_c⁄ãxt
(
ªcognizî
 
r
)

619 
li_îr_msg
 = "ContextsáreÇot supported byÅhe LIÑecognizer";

621 (
NULL
);

622 
	}
}

625 
	$li_ªcognizî_gë_buf„r
(
ªcognizî
 
r
, 
u_öt
* 
n°rokes
,
≥n_°roke
** 
°rokes
)

629 
li_îr_msg
 = "Buffer get/setáreÇot supported byÅhe LIÑecognizer";

632 
	}
}

635 
	$li_ªcognizî_£t_buf„r
(
ªcognizî
 
r
,
u_öt
 
n°rokes
,
≥n_°roke
* 
°rokes
)

639 
li_îr_msg
 = "Buffer get/setáreÇot supported byÅhe LIÑecognizer";

642 
	}
}

645 
	$li_ªcognizî_å™¶©e
(
ªcognizî
 
r
,

646 
u_öt
 
ncs
,

647 
≥n_°roke
* 
çs
,

648 
boﬁ
 
c‹ªœã_p
,

649 * 
ƒë
,

650 
ªc_Æã∫©ive
** 
ªt
)

652 * 
˛ss
 = 
NULL
;

653 
li_ªcognizî
* 
ªc
;

654 
c⁄f
;

655 
rCœssifõr
* 
rc
;

657 
ªc
 = (
li_ªcognizî
*)
r
->
ªcognizî_•ecific
;

659 *
ƒë
 = 0;

660 *
ªt
 = 
NULL
;

664 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

665 
li_îr_msg
 = "Notá LIÑecognizer";

669 
rc
 = &(
ªc
->
li_rc
);

672 i‡(
ncs
 < 1) {

673 
li_îr_msg
 = "InvalidÖarameters:Çcs";

676 if–
çs
 =
NULL
) {

677 
li_îr_msg
 = "InvalidÖarameters:Åps";

680 if–
ƒë
 =
NULL
) {

681 
li_îr_msg
 = "InvalidÖarameters:Çret";

684 if–
ªt
 =
NULL
) {

685 
li_îr_msg
 = "InvalidÖarameters:Ñet";

710 
˛ss
 = 
	`ªcognize_öã∫Æ
(
rc
,
çs
,&
c⁄f
);

711 i‡(
˛ss
 =
NULL
) {

716 *
ƒë
 = 1;

721 *
ƒë
 = 1;

722 (*
˛ss
);

723 
	}
}

726 
ªc_‚
*

727 
	$li_ªcognizî_gë_exãnsi⁄_fun˘i⁄s
(
ªcognizî
 
ªc
)

729 
ªc_‚
* 
ªt
;

733 if–!
	`CHECK_LI_MAGIC
(
ªc
->
ªcognizî_•ecific
) ) {

734 
li_îr_msg
 = "Notá LIÑecognizer";

735 (
NULL
);

738 
ªt
 = 
	`make_ªc_‚_¨øy
(
LI_NUM_EX_FNS
);

741 
ªt
[
LI_GET_CLASSES
] = (
ªc_‚
)
ªcognizî_gëCœs£s
;

742 
ªt
[
LI_CLEAR
] = (
ªc_‚
)
ªcognizî_˛órSèã
;

743 
ªt
[
LI_ISA_LI
] = (
ªc_‚
)
iß_li
;

744 
ªt
[
LI_TRAIN
] = (
ªc_‚
)
ªcognizî_åaö
;

746 (
ªt
);

747 
	}
}

750 
	$li_ªcognizî_gë_ge°uª_«mes
(
ªcognizî
 
r
)

754 
li_îr_msg
 = "GesturesáreÇot supported byÅhe LIÑecognizer";

756 (
NULL
);

757 
	}
}

759 
xge°uª


760 
	$li_ªcognizî_£t_ge°uª_a˘i⁄
(
ªcognizî
 
r
,

761 * 
«me
,

762 
xge°uª
 
‚
,

763 * 
wsöfo
)

767 
li_îr_msg
 = "GesturesáreÇot supported byÅhe LIÑecognizer";

769 (
NULL
);

770 
	}
}

783 
	$RECOGNIZER_INITIALIZE
(
ri
)

785 
ªcognizî
 
r
;

786 
li_ªcognizî
* 
ªc
;

787 
i
;

791 if–
	`°rcmp
(
ri
->
ri_loˇÀ
,
LI_SUPPORTED_LOCALE
) != 0 ) {

792 
li_îr_msg
 = "Notá supportedÜocale";

793 
	`Ârötf
(
°dîr
, "LocaleÉrror.\n");

795 (
NULL
);

804 if–
ri
->
ri_sub£t
 !
NULL
 ) {

805 
i
 = 0; 
ri
->
ri_sub£t
[i] !
NULL
; i++ ) {

807 if–
	`°rcmp
(
ri
->
ri_sub£t
[
i
],
UPPERCASE
) != 0 &&

808 
	`°rcmp
(
ri
->
ri_sub£t
[
i
],
LOWERCASE
) != 0 &&

809 
	`°rcmp
(
ri
->
ri_sub£t
[
i
],
DIGITS
) != 0 &&

810 
	`°rcmp
(
ri
->
ri_sub£t
[
i
],
GESTURE
) != 0 ) {

811 
li_îr_msg
 = "Notá supported character set";

812 
	`Ârötf
(
°dîr
, "charsetÉrror.\n");

814 (
NULL
);

820 
r
 = 
	`make_ªcognizî
(
ri
);

823 if–
r
 =
NULL
 ) {

824 
li_îr_msg
 = "Can'tállocate storage";

826 (
NULL
);

834 
ªc
 = 
	`Æloˇã
(1, 
li_ªcognizî
);

836 
r
->
ªcognizî_•ecific
 = 
ªc
;

838 
ªc
->
li_rc
.
fûe_«me
 = 
NULL
;

839 
ªc
->
li_rc
.
sc
 = 
NULL
;

843 
r
->
ªcognizî_lﬂd_°©e
 = 
li_ªcognizî_lﬂd
;

844 
r
->
ªcognizî_ßve_°©e
 = 
li_ªcognizî_ßve
;

845 
r
->
ªcognizî_lﬂd_di˘i⁄¨y
 = 
li_ªcognizî_lﬂd_di˘i⁄¨y
;

846 
r
->
ªcognizî_ßve_di˘i⁄¨y
 = 
li_ªcognizî_ßve_di˘i⁄¨y
;

847 
r
->
ªcognizî_‰ì_di˘i⁄¨y
 = 
li_ªcognizî_‰ì_di˘i⁄¨y
;

848 
r
->
ªcognizî_add_to_di˘i⁄¨y
 = 
li_ªcognizî_add_to_di˘i⁄¨y
;

849 
r
->
ªcognizî_dñëe_‰om_di˘i⁄¨y
 = 
li_ªcognizî_dñëe_‰om_di˘i⁄¨y
;

850 
r
->
ªcognizî_îr‹
 = 
li_ªcognizî_îr‹
;

851 
r
->
ªcognizî_å™¶©e
 = 
li_ªcognizî_å™¶©e
;

852 
r
->
ªcognizî_gë_c⁄ãxt
 = 
li_ªcognizî_gë_c⁄ãxt
;

853 
r
->
ªcognizî_£t_c⁄ãxt
 = 
li_ªcognizî_£t_c⁄ãxt
;

854 
r
->
ªcognizî_gë_buf„r
 = 
li_ªcognizî_gë_buf„r
;

855 
r
->
ªcognizî_£t_buf„r
 = 
li_ªcognizî_£t_buf„r
;

856 
r
->
ªcognizî_˛ór
 = 
li_ªcognizî_˛ór
;

857 
r
->
ªcognizî_gë_exãnsi⁄_fun˘i⁄s
 =

858 
li_ªcognizî_gë_exãnsi⁄_fun˘i⁄s
;

859 
r
->
ªcognizî_gë_ge°uª_«mes
 = 
li_ªcognizî_gë_ge°uª_«mes
;

860 
r
->
ªcognizî_£t_ge°uª_a˘i⁄
 =

861 
li_ªcognizî_£t_ge°uª_a˘i⁄
;

865 
ªc
->
li_magic
 = 
LI_MAGIC
;

869 
ªc
->
li_rc
.
fûe_«me
 = 
NULL
;

871  
i
 = 0; i < 
MAXSCLASSES
; i++ ) {

872 
ªc
->
li_rc
.
ex
[
i
] = 
NULL
;

873 
ªc
->
li_rc
.
˙ames
[
i
] = 
NULL
;

876 
	`lülg_öôülize
(&
ªc
->
li_rc
);

879 
li_îr_msg
 = 
NULL
;

881 (
r
);

882 
	}
}

887 
	$‰ì_rCœssifõr
(
rCœssifõr
* 
rc
)

889 
i
;

891 if–
rc
->
fûe_«me
 !
NULL
) {

892 
	`‰ì
(
rc
->
fûe_«me
);

895  
i
 = 0; 
rc
->
ex
[i] !
NULL
; i++) {

896 
	`dñëe_exam∂es
(
rc
->
ex
[
i
]);

897 
	`‰ì
(
rc
->
˙ames
[
i
]);

900 if(
rc
->
sc
 !
NULL
 ) {

901 
	`sFªeCœssifõr
(
rc
->
sc
);

903 
	}
}

907 
	$RECOGNIZER_FINALIZE
(
r
)

909 
li_ªcognizî
* 
ªc
 = (li_ªcognizî*)
r
->
ªcognizî_•ecific
;

913 if–!
	`CHECK_LI_MAGIC
(
ªc
) ) {

914 
li_îr_msg
 = "Notá LIÑecognizer";

920 
	`‰ì_rCœssifõr
(&(
ªc
->
li_rc
));

924 
	`‰ì
(
ªc
);

928 
	`dñëe_ªcognizî
(
r
);

931 
	}
}

941 #i‡
deföed
(
__ECOS
Ë|| deföed(
__CYGWIN__
)

942 
	#MAXINT
 0x7FFFFFFF

	)

944 
	~<vÆues.h
>

946 
	~<sys/time.h
>

948 #ifdef 
__u…rix


950 
röt
();

951 
expf
();

954 #ifdef 
ELX


955 
röt
 ();

956 
expf
 ();

959 
	#WORST_SCORE
 
MAXINT


	)

962 
	#DP_BAND
 3

	)

963 
	#MIN_SIM
 0

	)

964 
	#MAX_DIST
 
MAXINT


	)

965 
	#SIM_THLD
 60

	)

966 
	#DIST_THLD
 3200

	)

969 
	#LP_FILTER_WIDTH
 6

	)

970 
	#LP_FILTER_ITERS
 8

	)

971 
	#LP_FILTER_THLD
 250

	)

972 
	#LP_FILTER_MIN
 5

	)

975 
	#PE_AL_THLD
 1500

	)

976 
	#PE_ATCR_THLD
 135

	)

979 
	#T_ONE
 1

	)

980 
	#T_TWO
 20

	)

983 
	#CANONICAL_X
 108

	)

984 
	#CANONICAL_Y
 128

	)

985 
	#DIST_SQ_THRESHOLD
 (3*3Ë

	)

986 
	#NCANONICAL
 50

	)

989 
	#TAP_CHAR
 "."

	)

990 
	#TAP_TIME_THLD
 150

	)

991 
	#TAP_DIST_THLD
 75

	)

992 
	#TAP_PATHLEN
 1000

	)

996 
	#chaöcode
 
time


	)

999 
	#RGN_CONVEX
 0

	)

1000 
	#RGN_CONCAVE
 1

	)

1001 
	#RGN_PLAIN
 2

	)

1002 
	#RGN_PSEUDO
 3

	)

1005 
	sRegi⁄Li°
 {

1006 
	m°¨t
;

1007 
	míd
;

1008 
	mty≥
;

1009 
Regi⁄Li°
 *
	m√xt
;

1010 } 
	tªgi⁄_li°
;

1014 
	glülg_d˘bl
[3][3] = {{1, 0, 7}, {2, 0x7FFFFFFF, 6}, {3, 4, 5}};

1017 
	glülg_Õfwts
[2 * 
LP_FILTER_WIDTH
 + 1];

1018 
	glülg_Õfc⁄°
 = -1;

1021 
lülg_¥ïro˚ss_°roke
(
poöt_li°
 *);

1022 
poöt_li°
 *
lülg_compuã_domö™t_poöts
(point_list *);

1023 
poöt_li°
 *
lülg_öãΩﬁ©e_poöts
(point_list *);

1024 
lülg_bª¶öe
(
≥n_poöt
 *,Öí_poöà*, 
poöt_li°
 *, *);

1025 
lülg_compuã_chaö_code
(
poöt_li°
 *);

1026 
lülg_compuã_unô_chaö_code
(
poöt_li°
 *);

1027 
ªgi⁄_li°
 *
lülg_compuã_ªgi⁄s
(
poöt_li°
 *);

1028 
poöt_li°
 *
lülg_compuã_dom±s
’oöt_li° *, 
ªgi⁄_li°
 *);

1029 *
lülg_compuã_c⁄tour_™gÀ_£t
(
poöt_li°
 *, 
ªgi⁄_li°
 *);

1030 
lülg_sc‹e_°roke
(
poöt_li°
 *,Öoint_list *, *, *);

1031 
lülg_compuã_simû¨ôy
(
poöt_li°
 *,Öoint_list *);

1032 
lülg_compuã_di°™˚
(
poöt_li°
 *,Öoint_list *);

1034 
lülg_ªad_˛assifõr_dige°
(
rCœssifõr
 *);

1036 
lülg_ˇn⁄iˇlize_exam∂es
(
rCœssifõr
 *);

1037 
lülg_ˇn⁄iˇlize_exam∂e_°roke
(
poöt_li°
 *);

1038 
lülg_compuã_equùoöts
(
poöt_li°
 *);

1040 
lülg_compuã_∑thÀn
(
poöt_li°
 *);

1041 
lülg_compuã_∑thÀn_sub£t
(
poöt_li°
 *, , );

1042 
lülg_fûãr_poöts
(
poöt_li°
 *);

1043 
lülg_å™¶©e_poöts
(
poöt_li°
 *, , , , );

1044 
lülg_gë_boundög_box
(
poöt_li°
 *, *, *, *, *);

1045 
lülg_compuã_Õf_∑ømëîs
();

1046 
isqπ
();

1047 
likóèn
(, );

1048 
quadr
();

1057 
	$lülg_öôülize
(
rCœssifõr
 *
ªc
) {

1058 
i
;

1061 
i
 = 0; i < 
MAXSCLASSES
; i++) {

1062 
ªc
->
dom±s
[
i
] = 
NULL
;

1064 
	}
}

1070 *
	$lülg_ªcognize_°roke
(
rCœssifõr
 *
ªc
, 
poöt_li°
 *
°roke
) {

1071 
i
;

1072 *
«me
 = 
NULL
;

1073 
poöt_li°
 *
öput_dom±s
 = 
NULL
;

1074 *
be°_«me
 = 
NULL
;

1075 
be°_sc‹e
 = 
WORST_SCORE
;

1076 *
cuº_«me
;

1077 
poöt_li°
 *
cuº_dom±s
 = 
NULL
;

1083 i‡(
°roke
->
≈ts
 < 1Ë
d⁄e
;

1097 i‡(
	`lülg_fûãr_poöts
(
°roke
Ë!0Ë(
NULL
);

1102 i‡(
°roke
->
≈ts
 =1 || 
	`lülg_compuã_∑thÀn
(°rokeË< 
TAP_PATHLEN
)

1103 (
TAP_CHAR
);

1107 i‡(
	`lülg_¥ïro˚ss_°roke
(
°roke
Ë!0Ë
d⁄e
;

1110 
öput_dom±s
 = 
	`lülg_compuã_domö™t_poöts
(
°roke
);

1111 i‡(
öput_dom±s
 =
NULL
Ë
d⁄e
;

1114 
i
 = 0, 
cuº_«me
 = 
ªc
->
˙ames
[i], 
cuº_dom±s
 =Ñec->
dom±s
[i];

1115 
i
 < 
MAXSCLASSES
 && 
cuº_«me
 !
NULL
 && 
cuº_dom±s
 != NULL;

1116 
i
++, 
cuº_«me
 = 
ªc
->
˙ames
[i], 
cuº_dom±s
 =Ñec->
dom±s
[i]) {

1117 
sim
;

1118 
di°
;

1119 
cuº_sc‹e
;

1121 
	`lülg_sc‹e_°roke
(
öput_dom±s
, 
cuº_dom±s
, &
sim
, &
di°
);

1122 
cuº_sc‹e
 = 
di°
;

1124 i‡(
lidebug
 && 
cuº_sc‹e
 < 
DIST_THLD
)

1125 
	`Ârötf
(
°dîr
, "(%s, %d, %dË", 
cuº_«me
, 
sim
, 
di°
);

1128 i‡(
cuº_sc‹e
 < 
be°_sc‹e
 && cuº_sc‹ê<
DIST_THLD
) {

1129 
be°_sc‹e
 = 
cuº_sc‹e
;

1130 
be°_«me
 = 
cuº_«me
;

1134 i‡(
lidebug
)

1135 
	`Ârötf
(
°dîr
, "\n");

1138 
«me
 = 
be°_«me
;

1140 
d⁄e
:

1141 
	`dñëe_exam∂es
(
öput_dom±s
);

1146 (
«me
);

1147 
	}
}

1150 
	$lülg_¥ïro˚ss_°roke
(
poöt_li°
 *
poöts
) {

1151 
möx
, 
möy
, 
maxx
, 
maxy
, 
xønge
, 
yønge
, 
sˇÀ
, 
xoff
, 
yoff
;

1162 
	`lülg_gë_boundög_box
(
poöts
, &
möx
, &
möy
, &
maxx
, &
maxy
);

1163 
xønge
 = 
maxx
 - 
möx
;

1164 
yønge
 = 
maxy
 - 
möy
;

1165 
sˇÀ
 = ( ((100 * 
xønge
 + 
CANONICAL_X
 / 2) / CANONICAL_X) >

1166 ((100 * 
yønge
 + 
CANONICAL_Y
 / 2) / CANONICAL_Y))

1167 ? (100 * 
CANONICAL_X
 + 
xønge
 / 2) / xrange

1168 : (100 * 
CANONICAL_Y
 + 
yønge
 / 2) / yrange;

1169 i‡(
	`lülg_å™¶©e_poöts
(
poöts
, 
möx
, 
möy
, 
sˇÀ
, scale) != 0)

1173 
	`lülg_gë_boundög_box
(
poöts
, &
möx
, &
möy
, &
maxx
, &
maxy
);

1174 
xønge
 = 
maxx
 - 
möx
;

1175 
yønge
 = 
maxy
 - 
möy
;

1176 
xoff
 = -((
CANONICAL_X
 - 
xønge
 + 1) / 2);

1177 
yoff
 = -((
CANONICAL_Y
 - 
yønge
 + 1) / 2);

1178 i‡(
	`lülg_å™¶©e_poöts
(
poöts
, 
xoff
, 
yoff
, 100, 100) != 0) (-1);

1181 
xønge
 = 
maxx
 - 
möx
;

1182 
yønge
 = 
maxy
 - 
möy
;

1183 
poöts
->
xønge
 = xrange;

1184 
poöts
->
yønge
 = yrange;

1186 i‡(
lidebug
) {

1187 
i
;

1188 
	`Ârötf
(
°dîr
, "AfterÖre-processing: %d %d %d %d\n",

1189 
möx
, 
möy
, 
maxx
, 
maxy
);

1190 
i
 = 0; i < 
poöts
->
≈ts
; i++)

1191 
	`Ârötf
(
°dîr
, " (%d %d)\n",

1192 
poöts
->
±s
[
i
].
x
,Öoöts->±s[i].
y
);

1193 
	`fÊush
(
°dîr
);

1197 
	}
}

1200 
poöt_li°
 *
	$lülg_compuã_domö™t_poöts
(
poöt_li°
 *
poöts
) {

1201 
poöt_li°
 *
ùts
 = 
NULL
;

1202 
ªgi⁄_li°
 *
ªgi⁄s
 = 
NULL
;

1203 
poöt_li°
 *
d±s
 = 
NULL
;

1206 
ùts
 = 
	`lülg_öãΩﬁ©e_poöts
(
poöts
);

1207 i‡(
ùts
 =
NULL
) (NULL);

1208 i‡(
lidebug
) {

1209 
j
;

1210 
	`Ârötf
(
°dîr
, "A·î i¡îpﬁ©i⁄: %d i±s\n", 
ùts
->
≈ts
);

1211 
j
 = 0; j < 
ùts
->
≈ts
; j++) {

1212 
	`Ârötf
(
°dîr
, " (%d, %d), %ld\n",

1213 
ùts
->
±s
[
j
].
x
, i±s->±s[j].
y
, i±s->±s[j].
chaöcode
);

1215 
	`fÊush
(
°dîr
);

1219 
ªgi⁄s
 = 
	`lülg_compuã_ªgi⁄s
(
ùts
);

1223 
d±s
 = 
	`lülg_compuã_dom±s
(
ùts
, 
ªgi⁄s
);

1224 i‡(
lidebug
) {

1225 
j
;

1226 
	`Ârötf
(
°dîr
, "DominantÖoints: ");

1227 
j
 = 0; j < 
d±s
->
≈ts
; j++) {

1228 
	`Ârötf
(
°dîr
, "%d %d (%ld) ",

1229 
d±s
->
±s
[
j
].
x
, d±s->±s[j].
y
, d±s->±s[j].
chaöcode
);

1231 
	`Ârötf
(
°dîr
, "\n");

1232 
	`fÊush
(
°dîr
);

1237 
ªgi⁄_li°
 *
cuº
, *
√xt
;

1238 
cuº
 = 
ªgi⁄s
; cuº !
NULL
; ) {

1239 
√xt
 = 
cuº
->next;

1240 
	`‰ì
(
cuº
);

1241 
cuº
 = 
√xt
;

1244 
	`dñëe_exam∂es
(
ùts
);

1245 (
d±s
);

1246 
	}
}

1250 
poöt_li°
 *
	$lülg_öãΩﬁ©e_poöts
(
poöt_li°
 *
poöts
) {

1251 
i
, 
j
;

1252 
max±s
;

1253 
poöt_li°
 *
√w±s
;

1256 
max±s
 = 0;

1257 
i
 = 0; i < (
poöts
->
≈ts
 - 1); i++) {

1258 
≥n_poöt
 *
±a
 = &(
poöts
->
±s
[
i
]);

1259 
≥n_poöt
 *
±b
 = &(
poöts
->
±s
[
i
+1]);

1260 
max±s
 +
	`abs
(
±a
->
x
 - 
±b
->xË+ábs’è->
y
 -Ötb->y);

1264 
max±s
 +
poöts
->
≈ts
;

1266 
√w±s
 = 
	`Æloˇã
(1, 
poöt_li°
);

1267 
√w±s
->
±s
 = 
	`make_≥n_poöt_¨øy
(
max±s
);

1268 i‡(
√w±s
->
±s
 =
NULL
) {

1269 
	`‰ì
(
√w±s
);

1270 (
NULL
);

1272 
√w±s
->
≈ts
 = 
max±s
;

1273 
√w±s
->
√xt
 = 
NULL
;

1276 
j
 = 0;

1277 
i
 = 0; i < (
poöts
->
≈ts
 - 1); i++) {

1278 
≥n_poöt
 *
°¨çt
 = &(
poöts
->
±s
[
i
]);

1279 
≥n_poöt
 *
íd±
 = &(
poöts
->
±s
[
i
+1]);

1281 
	`lülg_bª¶öe
(
°¨çt
, 
íd±
, 
√w±s
, &
j
);

1283 
j
--;

1287 
√w±s
->
±s
[
j
++] = 
poöts
->±s[poöts->
≈ts
 - 1];

1288 
√w±s
->
≈ts
 = 
j
;

1291 
	`lülg_compuã_unô_chaö_code
(
√w±s
);

1293 (
√w±s
);

1294 
	}
}

1298 
	$lülg_bª¶öe
(
≥n_poöt
 *
°¨çt
,Öí_poöà*
íd±
,

1299 
poöt_li°
 *
√w±s
, *
j
) {

1300 
Ax
, 
Ay
, 
Bx
, 
By
, 
dX
, 
dY
, 
Xö¸
, 
Yö¸
;

1302 
Ax
 = 
°¨çt
->
x
;

1303 
Ay
 = 
°¨çt
->
y
;

1304 
Bx
 = 
íd±
->
x
;

1305 
By
 = 
íd±
->
y
;

1309 
dX
 = 
	`abs
(
Bx
-
Ax
);

1310 
dY
 = 
	`abs
(
By
-
Ay
);

1313 i‡(
Ax
 > 
Bx
Ë{ 
Xö¸
=-1; } { Xincr=1; }

1314 i‡(
Ay
 > 
By
Ë{ 
Yö¸
=-1; } { Yincr=1; }

1319 i‡(
dX
 >
dY
) {

1320 
dPr
 = 
dY
<<1;

1321 
dPru
 = 
dPr
 - (
dX
<<1);

1322 
P
 = 
dPr
 - 
dX
;

1325 ; 
dX
>=0; dX--) {

1326 
√w±s
->
±s
[*
j
].
x
 = 
Ax
;

1327 
√w±s
->
±s
[*
j
].
y
 = 
Ay
;

1328 (*
j
)++;

1330 i‡(
P
 > 0) {

1331 
Ax
+=
Xö¸
;

1332 
Ay
+=
Yö¸
;

1333 
P
+=
dPru
;

1336 
Ax
+=
Xö¸
;

1337 
P
+=
dPr
;

1342 
dPr
 = 
dX
<<1;

1343 
dPru
 = 
dPr
 - (
dY
<<1);

1344 
P
 = 
dPr
 - 
dY
;

1347 ; 
dY
>=0; dY--) {

1348 
√w±s
->
±s
[*
j
].
x
 = 
Ax
;

1349 
√w±s
->
±s
[*
j
].
y
 = 
Ay
;

1350 (*
j
)++;

1352 i‡(
P
 > 0) {

1353 
Ax
+=
Xö¸
;

1354 
Ay
+=
Yö¸
;

1355 
P
+=
dPru
;

1358 
Ay
+=
Yö¸
;

1359 
P
+=
dPr
;

1363 
	}
}

1366 
	$lülg_compuã_chaö_code
(
poöt_li°
 *
±s
) {

1367 
i
;

1369 
i
 = 0; i < (
±s
->
≈ts
 - 1); i++) {

1370 
≥n_poöt
 *
°¨çt
 = &(
±s
->±s[
i
]);

1371 
≥n_poöt
 *
íd±
 = &(
±s
->±s[
i
+1]);

1372 
dx
 = 
íd±
->
x
 - 
°¨çt
->x;

1373 
dy
 = 
íd±
->
y
 - 
°¨çt
->y;

1378 
tmp
 = 
	`quadr
(
	`likóèn
(
dy
, 
dx
));

1379 
dúcode
 = (12 - 
tmp
) % 8;

1381 
°¨çt
->
chaöcode
 = 
dúcode
;

1383 
	}
}

1386 
	$lülg_compuã_unô_chaö_code
(
poöt_li°
 *
±s
) {

1387 
i
;

1389 
i
 = 0; i < (
±s
->
≈ts
 - 1); i++) {

1390 
≥n_poöt
 *
°¨çt
 = &(
±s
->±s[
i
]);

1391 
≥n_poöt
 *
íd±
 = &(
±s
->±s[
i
+1]);

1392 
dx
 = 
íd±
->
x
 - 
°¨çt
->x;

1393 
dy
 = 
íd±
->
y
 - 
°¨çt
->y;

1394 
dúcode
 = 
lülg_d˘bl
[
dx
+1][
dy
+1];

1397 
°¨çt
->
chaöcode
 = 
dúcode
;

1399 
	}
}

1402 
ªgi⁄_li°
 *
	$lülg_compuã_ªgi⁄s
(
poöt_li°
 *
±s
) {

1403 
ªgi⁄_li°
 *
ªgi⁄s
 = 
NULL
;

1404 
ªgi⁄_li°
 *
cuº_ªg
 = 
NULL
;

1405 *
R
[2 + 
LP_FILTER_ITERS
];

1406 *
junk
;

1407 *
cuº
, *
√xt
;

1408 
i
, 
j
;

1411 i‡(
lülg_Õfc⁄°
 == -1)

1412 
	`lülg_compuã_Õf_∑ømëîs
();

1416 
junk
 = 
	`Æloˇã
((2 + 
LP_FILTER_ITERS
Ë* 
±s
->
≈ts
, );

1417 
i
 = 0; i < (2 + 
LP_FILTER_ITERS
); i++)

1418 
R
[
i
] = 
junk
 + (ò* 
±s
->
≈ts
);

1419 
cuº
 = 
R
[0];

1423 
cuº
[0] = 18000;

1424 
i
 = 1; i < (
±s
->
≈ts
 - 1); i++) {

1425 
d_i
 = 
±s
->±s[
i
].
chaöcode
;

1426 
d_imöus⁄e
 = 
±s
->±s[
i
-1].
chaöcode
;

1427 
a_i
;

1429 i‡(
d_imöus⁄e
 < 
d_i
)

1430 
d_imöus⁄e
 += 8;

1432 
a_i
 = (
d_imöus⁄e
 - 
d_i
) % 8;

1435 
cuº
[
i
] = ((12 - 
a_i
) % 8) * 45 * 100;

1437 
cuº
[
±s
->
≈ts
 - 1] = 18000;

1440 
√xt
 = 
R
[1];

1441 
j
 = 0; j < 
LP_FILTER_ITERS
; j++, 
cuº
 = 
R
[j], 
√xt
 = R[j+1]) {

1442 
i
 = 0; i < 
±s
->
≈ts
; i++) {

1443 
k
;

1445 
√xt
[
i
] = 0;

1447 
k
 = 
i
 - 
LP_FILTER_WIDTH
; k <= i + LP_FILTER_WIDTH; k++) {

1448 
ﬁdvÆ
 = (
k
 < 0 || k >
±s
->
≈ts
Ë? 18000 : 
cuº
[k];

1449 
√xt
[
i
] +
ﬁdvÆ
 * 
lülg_Õfwts
[
k
 - (ò- 
LP_FILTER_WIDTH
)];

1452 
√xt
[
i
] /
lülg_Õfc⁄°
;

1458 
i
 = 0; i < 
±s
->
≈ts
; i++) {

1459 
√xt
[
i
] = (
	`abs
(
cuº
[i] - 18000Ë< 
LP_FILTER_THLD
)

1461 : 
cuº
[
i
];

1463 
cuº
 = 
√xt
;

1466 i‡(
lidebug
 > 1) {

1467 
i
 = 0; i < 
±s
->
≈ts
; i++) {

1468 
	`Ârötf
(
°dîr
, "%3d: (%3d, %3d) %ld ",

1469 
i
, 
±s
->±s[i].
x
,Öts->±s[i].
y
,Öts->±s[i].
chaöcode
);

1470 
j
 = 0; j < 2 + 
LP_FILTER_ITERS
; j++)

1471 
	`Ârötf
(
°dîr
, "%d ", 
R
[
j
][
i
]);

1472 
	`Ârötf
(
°dîr
, "\n");

1478 
°¨t
, 
íd
;

1479 
cuºty≥
;

1481 
	#RGN_TYPE
(
vÆ
)\

1482 (((
vÆ
) == 18000)\

1483 ? 
RGN_PLAIN
\

1484 : ((
vÆ
Ë< 18000 ? 
RGN_CONCAVE
 : 
RGN_CONVEX
))

	)

1486 
°¨t
 = 0;

1487 
cuºty≥
 = 
	`RGN_TYPE
(
cuº
[0]);

1489 
ªgi⁄s
 = 
	`Æloˇã
(1, 
ªgi⁄_li°
);

1490 
cuº_ªg
 = 
ªgi⁄s
;

1491 
cuº_ªg
->
°¨t
 = start;

1492 
cuº_ªg
->
íd
 = 0;

1493 
cuº_ªg
->
ty≥
 = 
cuºty≥
;

1494 
cuº_ªg
->
√xt
 = 
NULL
;

1495 
i
 = 1; i < 
±s
->
≈ts
; i++) {

1496 
√xây≥
 = 
	`RGN_TYPE
(
cuº
[
i
]);

1498 i‡(
√xây≥
 !
cuºty≥
) {

1499 
ªgi⁄_li°
 *
√xt_ªg
 = 
NULL
;

1501 
íd
 = 
i
 - 1;

1502 
cuº_ªg
->
íd
 =Énd;

1503 i‡(
lidebug
 > 1)

1504 
	`Ârötf
(
°dîr
, " (%d, %d), %d\n", 
°¨t
, 
íd
, 
cuºty≥
);

1506 
°¨t
 = 
i
;

1507 
cuºty≥
 = 
√xây≥
;

1509 
√xt_ªg
 = 
	`Æloˇã
(1, 
ªgi⁄_li°
);

1510 
√xt_ªg
->
°¨t
 = start;

1511 
√xt_ªg
->
íd
 = 0;

1512 
√xt_ªg
->
ty≥
 = 
√xây≥
;

1513 
√xt_ªg
->
√xt
 = 
NULL
;

1515 
cuº_ªg
->
√xt
 = 
√xt_ªg
;

1516 
cuº_ªg
 = 
√xt_ªg
;

1519 
íd
 = 
i
 - 1;

1520 
cuº_ªg
->
íd
 =Énd;

1521 i‡(
lidebug
 > 1)

1522 
	`Ârötf
(
°dîr
, " (%d, %d), %d\n", 
°¨t
, 
íd
, 
cuºty≥
);

1525 
cuº_ªg
 = 
ªgi⁄s
; cuº_ªg; cuº_ªg = cuº_ªg->
√xt
)

1526 i‡(
cuº_ªg
->
ty≥
 =
RGN_PLAIN
) {

1527 
ªgi⁄_li°
 *
√xt_ªg
;

1529 
√xt_ªg
 = 
cuº_ªg
->
√xt
;

1530 
√xt_ªg
 !
NULL
 &&

1531 (
√xt_ªg
->
íd
 -Çext_ªg->
°¨t
Ë< 
LP_FILTER_MIN
;

1532 
√xt_ªg
 = 
cuº_ªg
->
√xt
) {

1537 
cuº_ªg
->
√xt
 = (
√xt_ªg
->next)->next;

1538 
cuº_ªg
->
íd
 = (
√xt_ªg
->
√xt
)->end;

1540 
	`‰ì
(
√xt_ªg
->
√xt
);

1541 
	`‰ì
(
√xt_ªg
);

1547 
ªgi⁄_li°
 *
tmp
, *
¥ev_ªg
;

1549 
tmp
 = 
ªgi⁄s
;

1550 
ªgi⁄s
 = 
NULL
;

1551 
¥ev_ªg
 = 
NULL
;

1552 
cuº_ªg
 = 
tmp
; cuº_ªg; cuº_ªg = cuº_ªg->
√xt
) {

1553 i‡(
cuº_ªg
->
ty≥
 =
RGN_PLAIN
) {

1554 
¨˛í
 = 
	`lülg_compuã_∑thÀn_sub£t
(
±s
,

1555 
cuº_ªg
->
°¨t
,

1556 
cuº_ªg
->
íd
);

1557 
dx
 = 
±s
->±s[
cuº_ªg
->
íd
].
x
 -

1558 
±s
->±s[
cuº_ªg
->
°¨t
].
x
;

1559 
dy
 = 
±s
->±s[
cuº_ªg
->
íd
].
y
 -

1560 
±s
->±s[
cuº_ªg
->
°¨t
].
y
;

1561 
ch‹dÀn
 = 
	`isqπ
(10000 * (
dx
 * dx + 
dy
 * dy));

1562 
©¸
 = (
ch‹dÀn
 =0Ë? 0 : (100 * 
¨˛í
 + chordlen / 2) / chordlen;

1564 i‡(
lidebug
)

1565 
	`Ârötf
(
°dîr
, "%d, %d, %d\n", 
¨˛í
, 
ch‹dÀn
, 
©¸
);

1568 i‡(
¨˛í
 >
PE_AL_THLD
 && 
©¸
 >
PE_ATCR_THLD
) {

1569 
mid
 = 
cuº_ªg
->
°¨t
 + (cuº_ªg->
íd
 - curr_reg->start) / 2;

1570 
íd
 = 
cuº_ªg
->end;

1571 
ªgi⁄_li°
 *
ßved_√xt
 = 
cuº_ªg
->
√xt
;

1573 
cuº_ªg
->
íd
 = 
mid
 - 1;

1574 i‡(
¥ev_ªg
 =
NULL
)

1575 
ªgi⁄s
 = 
cuº_ªg
;

1577 
¥ev_ªg
->
√xt
 = 
cuº_ªg
;

1578 
¥ev_ªg
 = 
cuº_ªg
;

1581 
cuº_ªg
 = 
	`Æloˇã
(1, 
ªgi⁄_li°
);

1582 
cuº_ªg
->
°¨t
 = 
mid
;

1583 
cuº_ªg
->
íd
 = 
mid
;

1584 
cuº_ªg
->
ty≥
 = 
RGN_PSEUDO
;

1585 
cuº_ªg
->
√xt
 = 
NULL
;

1586 
¥ev_ªg
->
√xt
 = 
cuº_ªg
;

1587 
¥ev_ªg
 = 
cuº_ªg
;

1590 
cuº_ªg
 = 
	`Æloˇã
(1, 
ªgi⁄_li°
);

1591 
cuº_ªg
->
°¨t
 = 
mid
 + 1;

1592 
cuº_ªg
->
íd
 =Énd;

1593 
cuº_ªg
->
ty≥
 = 
RGN_PLAIN
;

1594 
cuº_ªg
->
√xt
 = 
NULL
;

1595 
¥ev_ªg
->
√xt
 = 
cuº_ªg
;

1596 
¥ev_ªg
 = 
cuº_ªg
;

1598 
cuº_ªg
->
√xt
 = 
ßved_√xt
;

1603 i‡(
¥ev_ªg
 =
NULL
)

1604 
ªgi⁄s
 = 
cuº_ªg
;

1606 
¥ev_ªg
->
√xt
 = 
cuº_ªg
;

1607 
¥ev_ªg
 = 
cuº_ªg
;

1612 
	`‰ì
(
junk
);

1613 (
ªgi⁄s
);

1614 
	}
}

1617 
poöt_li°
 *
	$lülg_compuã_dom±s
(
poöt_li°
 *
±s
, 
ªgi⁄_li°
 *
ªgi⁄s
) {

1618 
poöt_li°
 *
d±s
 = 
NULL
;

1619 
nd±s
;

1620 *
ˇs
 = 
NULL
;

1621 
n⁄∂aö
;

1622 
ªgi⁄_li°
 *
r
;

1625 
ˇs
 = 
	`lülg_compuã_c⁄tour_™gÀ_£t
(
±s
, 
ªgi⁄s
);

1629 
n⁄∂aö
 = 0;

1630 
r
 = 
ªgi⁄s
;Ñ !
NULL
;Ñ =Ñ->
√xt
)

1631 i‡(
r
->
ty≥
 !
RGN_PLAIN
Ë
n⁄∂aö
++;

1632 
nd±s
 = 2 * (2 + 
n⁄∂aö
) - 1;

1634 
d±s
 = 
	`Æloˇã
(1, 
poöt_li°
);

1635 
d±s
->
±s
 = 
	`make_≥n_poöt_¨øy
(
nd±s
);

1636 i‡(
d±s
->
±s
 =
NULL
) {

1637 
	`‰ì
(
d±s
);

1638 (
NULL
);

1640 
d±s
->
≈ts
 = 
nd±s
;

1641 
d±s
->
√xt
 = 
NULL
;

1645 
ªgi⁄_li°
 *
cuº
;

1646 
dp
;

1647 
¥evix
;

1648 
cuºix
;

1651 
dp
 = 0;

1652 
¥evix
 = 0;

1653 
d±s
->
±s
[
dp
++] =Öts->±s[
¥evix
];

1655 
cuº
 = 
ªgi⁄s
; cuº !
NULL
; cuº = cuº->
√xt
)

1656 i‡(
cuº
->
ty≥
 !
RGN_PLAIN
) {

1657 
max_v
 = 0;

1658 
mö_v
 = 
MAXINT
;

1659 
max_ix
 = -1;

1660 
mö_ix
 = -1;

1661 
i
;

1663 
i
 = 
cuº
->
°¨t
; i <cuº->
íd
; i++) {

1664 
v
 = 
ˇs
[
i
];

1665 i‡(
v
 > 
max_v
Ë{ max_v = v; 
max_ix
 = 
i
; }

1666 i‡(
v
 < 
mö_v
Ë{ mö_v = v; 
mö_ix
 = 
i
; }

1667 i‡(
lidebug
 > 1)

1668 
	`Ârötf
(
°dîr
, " %d\n", 
v
);

1671 
cuºix
 = (
cuº
->
ty≥
 =
RGN_CONVEX
 ? 
max_ix
 : 
mö_ix
);

1674 
d±s
->
±s
[
dp
++] =Öts->±s[
¥evix
 + (
cuºix
 -Örevix) / 2];

1677 
d±s
->
±s
[
dp
++] =Öts->±s[
cuºix
];

1679 
¥evix
 = 
cuºix
;

1683 
cuºix
 = 
±s
->
≈ts
 - 1;

1684 
d±s
->
±s
[
dp
++] =Öts->±s[
¥evix
 + (
cuºix
 -Örevix) / 2];

1685 
d±s
->
±s
[
dp
++] =Öts->±s[
cuºix
];

1689 
	`lülg_compuã_chaö_code
(
d±s
);

1691 
	`‰ì
(
ˇs
);

1692 (
d±s
);

1693 
	}
}

1696 *
	$lülg_compuã_c⁄tour_™gÀ_£t
(
poöt_li°
 *
±s
,

1697 
ªgi⁄_li°
 *
ªgi⁄s
) {

1698 *
V
 = 
NULL
;

1699 
ªgi⁄_li°
 *
cuº_ªg
, *
¥ev_ªg
;

1700 
i
;

1703 
V
 = 
	`Æloˇã
(
±s
->
≈ts
, );

1705 
V
[0] = 18000;

1706 
cuº_ªg
 = 
ªgi⁄s
; cuº_ªg !
NULL
;

1707 
¥ev_ªg
 = 
cuº_ªg
, cuº_ªg = cuº_ªg->
√xt
) {

1708 
i
 = 
cuº_ªg
->
°¨t
; i <cuº_ªg->
íd
; i++) {

1709 i‡(
cuº_ªg
->
ty≥
 =
RGN_PLAIN
) {

1710 
V
[
i
] = 18000;

1713 #ifdef 
nŸdef


1715 
ªgi⁄_li°
 *
√xt_ªg
 = 
cuº_ªg
->
√xt
;

1716 
b
 = 
cuº_ªg
->
°¨t
;

1717 
h
 = 
¥ev_ªg
->
°¨t
;

1718 
t
 = 
√xt_ªg
->
íd
;

1719 
±s_bef‹e
 = 
i
 - 
h
;

1720 
±s_a·î
 = 
t
 - 
i
;

1721 
mö_±s
 = (
±s_bef‹e
 < 
±s_a·î
)

1722 ? 
±s_bef‹e


1723 : 
±s_a·î
;

1724 
k
 = (
mö_±s
 < 
T_ONE
)

1725 ? 
T_ONE


1726 : (
mö_±s
 > 
T_TWO
)

1727 ? 
T_TWO


1728 : 
mö_±s
;

1729 
sum
 = 0.0;

1731 
j
 = 1; j <
k
; j++) {

1732 
±A
 = 
i
 - 
j
;

1733 
±B
 = 
i
 + 
j
 - 1;

1734 
d_A
 = 
±s
->±s[
±A
].
chaöcode
;

1735 
d_B
 = 
±s
->±s[
±B
].
chaöcode
;

1736 
a_i
;

1738 i‡(
d_A
 < 
d_B
)

1739 
d_A
 += 8;

1741 
a_i
 = (
d_A
 - 
d_B
) % 8;

1744 i‡(
a_i
 =4 && 
cuº_ªg
->
ty≥
 =
RGN_CONVEX
)

1745 
sum
 +
M_2_PI
;

1747 
sum
 +()((12 - 
a_i
Ë% 8Ë/ 4.0 * 
M_PI
;

1749 
V
[
i
] = 
sum
 / ()
k
;

1752 
isMidPt
 = (
i
 =(
cuº_ªg
->
°¨t
 +

1753 (
cuº_ªg
->
íd
 - cuº_ªg->
°¨t
) / 2));

1754 
V
[
i
] = (
cuº_ªg
->
ty≥
 =
RGN_CONVEX
)

1755 ? (
isMidPt
 ? 18000 : 0)

1756 : (
isMidPt
 ? 0 : 18000);

1761 
V
[
±s
->
≈ts
 - 1] = 18000;

1763 (
V
);

1764 
	}
}

1774 
	$lülg_sc‹e_°roke
(
poöt_li°
 *
öput_dom±s
,Öoöt_li° *
cuº_dom±s
, *
sim
, *
di°
) {

1775 *
sim
 = 
MIN_SIM
;

1776 *
di°
 = 
MAX_DIST
;

1778 *
sim
 = 
	`lülg_compuã_simû¨ôy
(
öput_dom±s
, 
cuº_dom±s
);

1779 i‡(*
sim
 < 
SIM_THLD
Ë
d⁄e
;

1781 *
di°
 = 
	`lülg_compuã_di°™˚
(
öput_dom±s
, 
cuº_dom±s
);

1783 
d⁄e
:

1784 i‡(
lidebug
)

1785 
	`Ârötf
(
°dîr
, "%d, %d\n", *
sim
, *
di°
);

1786 
	}
}

1789 
	$lülg_compuã_simû¨ôy
(
poöt_li°
 *
öput_dom±s
,

1790 
poöt_li°
 *
cuº_dom±s
) {

1791 
sim
 = 0;

1792 
poöt_li°
 *
A
, *
B
;

1793 
N
, 
M
;

1794 **
G
 = 
NULL
;

1795 *
junk
 = 
NULL
;

1796 
i
, 
j
;

1800 i‡(
öput_dom±s
->
≈ts
 >
cuº_dom±s
->npts) {

1801 
A
 = 
öput_dom±s
;

1802 
N
 = 
öput_dom±s
->
≈ts
;

1803 
B
 = 
cuº_dom±s
;

1804 
M
 = 
cuº_dom±s
->
≈ts
;

1807 
A
 = 
cuº_dom±s
;

1808 
N
 = 
cuº_dom±s
->
≈ts
;

1809 
B
 = 
öput_dom±s
;

1810 
M
 = 
öput_dom±s
->
≈ts
;

1819 
G
 = 
	`Æloˇã
(
M
, *);

1821 
junk
 = 
	`Æloˇã
(
M
 * (
N
 + 1), );

1822 
i
 = 0; i < 
M
; i++)

1823 
G
[
i
] = 
junk
 + (ò* (
N
 + 1));

1825 
i
 = 1; i < 
M
; i++) {

1826 
bvÆ
 = 
B
->
±s
[
i
-1].
chaöcode
;

1829 
G
[
i
][0] = 0;

1831 
j
 = 1; j < 
N
; j++) {

1832 
avÆ
 = 
A
->
±s
[
j
-1].
chaöcode
;

1833 
diff
 = 
	`abs
(
bvÆ
 - 
avÆ
);

1834 i‡(
diff
 > 4) diff = 8 - diff;

1836 
G
[
i
][
j
] = (
diff
 == 0)

1838 : (
diff
 == 1)

1844 
G
[
i
][
N
] = 0;

1853 
j
 = 
N
 - 1; j >= 0; j--)

1854 
i
 = 
M
 - 1; i > 0; i--) {

1855 
max
 = 
G
[
i
][
j
 + 1];

1857 i‡(
i
 < (
M
 - 1)) {

1858 
tmp
 = 
G
[
i
 + 1][
j
 + 1];

1859 i‡(
tmp
 > 
max
) max =Åmp;

1862 
G
[
i
][
j
] +
max
;

1865 
sim
 = (10 * 
G
[1][0] + (
N
 - 1) / 2) / (N - 1);

1868 i‡(
G
 !
NULL
Ë
	`‰ì
(G);

1869 i‡(
junk
 !
NULL
Ë
	`‰ì
(junk);

1870 (
sim
);

1871 
	}
}

1874 
	$lülg_compuã_di°™˚
(
poöt_li°
 *
öput_dom±s
,

1875 
poöt_li°
 *
cuº_dom±s
) {

1876 
di°
 = 
MAX_DIST
;

1877 
poöt_li°
 *
A
, *
B
;

1878 
N
, 
M
;

1879 **
C
 = 
NULL
;

1880 *
junk
 = 
NULL
;

1881 *
BE
 = 
NULL
;

1882 *
TE
 = 
NULL
;

1883 
i
, 
j
;

1887 i‡(
öput_dom±s
->
≈ts
 >
cuº_dom±s
->npts) {

1888 
A
 = 
öput_dom±s
;

1889 
N
 = 
öput_dom±s
->
≈ts
;

1890 
B
 = 
cuº_dom±s
;

1891 
M
 = 
cuº_dom±s
->
≈ts
;

1894 
A
 = 
cuº_dom±s
;

1895 
N
 = 
cuº_dom±s
->
≈ts
;

1896 
B
 = 
öput_dom±s
;

1897 
M
 = 
öput_dom±s
->
≈ts
;

1904 
BE
 = 
	`Æloˇã
((
N
 + 1), );

1906 
TE
 = 
	`Æloˇã
((
N
 + 1), );

1908 
j
 = 1; j <
N
; j++) {

1909 
bŸ
, 
t›
;

1911 
bŸ
 = 
j
 + (
M
 - 
DP_BAND
);

1912 i‡(
bŸ
 > 
M
) bot = M;

1913 
BE
[
j
] = 
bŸ
;

1915 
t›
 = 
j
 - (
N
 - 
DP_BAND
);

1916 i‡(
t›
 < 1)Åop = 1;

1917 
TE
[
j
] = 
t›
;

1927 
C
 = 
	`Æloˇã
((
M
 + 1), *);

1929 
junk
 = 
	`Æloˇã
((
M
 + 1Ë* (
N
 + 1), );

1930 
i
 = 0; i <
M
; i++)

1931 
C
[
i
] = 
junk
 + (ò* (
N
 + 1));

1933 
i
 = 1; i <
M
; i++) {

1934 
bx
 = 
B
->
±s
[
i
-1].
x
;

1935 
by
 = 
B
->
±s
[
i
-1].
y
;

1937 
j
 = 1; j <
N
; j++) {

1938 
ax
 = 
A
->
±s
[
j
-1].
x
;

1939 
ay
 = 
A
->
±s
[
j
-1].
y
;

1940 
dx
 = 
bx
 - 
ax
;

1941 
dy
 = 
by
 - 
ay
;

1942 
di°
 = 
	`isqπ
(10000 * (
dx
 * dx + 
dy
 * dy));

1944 
C
[
i
][
j
] = 
di°
;

1953 
j
 = 
N
; j > 0; j--)

1954 
i
 = 
M
; i > 0; i--) {

1955 
mö
 = 
MAX_DIST
;

1957 i‡(
i
 > 
BE
[
j
] || i < 
TE
[j] || (j =
N
 && i =
M
))

1960 i‡(
j
 < 
N
) {

1961 i‡(
i
 >
TE
[
j
+1]) {

1962 
tmp
 = 
C
[
i
][
j
+1];

1963 i‡(
tmp
 < 
mö
) min =Åmp;

1966 i‡(
i
 < 
M
) {

1967 
tmp
 = 
C
[
i
+1][
j
+1];

1968 i‡(
tmp
 < 
mö
) min =Åmp;

1972 i‡(
i
 < 
BE
[
j
]) {

1973 
tmp
 = 
C
[
i
+1][
j
];

1974 i‡(
tmp
 < 
mö
) min =Åmp;

1977 
C
[
i
][
j
] +
mö
;

1980 
di°
 = (
C
[1][1] + 
N
 / 2) / N;

1983 i‡(
C
 !
NULL
Ë
	`‰ì
(C);

1984 i‡(
junk
 !
NULL
Ë
	`‰ì
(junk);

1985 i‡(
BE
 !
NULL
Ë
	`‰ì
(BE);

1986 i‡(
TE
 !
NULL
Ë
	`‰ì
(TE);

1987 (
di°
);

1988 
	}
}

1997 
	$lülg_ªad_˛assifõr_dige°
(
rCœssifõr
 *
ªc
) {

1998 
n˛as£s
;

1999 
FILE
 *
Â
 = 
NULL
;

2003 *
˛x_∑th
;

2004 *
dŸ
;

2008 
˛x_∑th
 = 
	`Æloˇã
(
	`°æí
(
ªc
->
fûe_«me
) + 5, );

2009 
	`°r˝y
(
˛x_∑th
, 
ªc
->
fûe_«me
);

2012 
dŸ
 = 
	`°ºchr
(
˛x_∑th
, '.');

2013 i‡(
dŸ
 =
NULL
Ë{ 
	`‰ì
(
˛x_∑th
); (-1); }

2014 *(
dŸ
 + 1) = 0;

2017 
	`°rˇt
(
˛x_∑th
, "clx");

2019 
Â
 = 
	`f›í
(
˛x_∑th
, "r");

2020 i‡(
Â
 =
NULL
Ë{ 
	`‰ì
(
˛x_∑th
); (-1); }

2022 
	`‰ì
(
˛x_∑th
);

2026 
n˛as£s
 = 0; !
	`„of
(
Â
);Çclasses++) {

2027 
poöt_li°
 *
d±s
 = 
NULL
;

2028 
˛ass
[
BUFSIZ
];

2029 
≈ts
;

2030 
j
;

2032 i‡(
	`fsˇnf
(
Â
, "%†%d", 
˛ass
, &
≈ts
) != 2) {

2033 i‡(
	`„of
(
Â
)) ;

2035 
Áûed
;

2037 
ªc
->
˙ames
[
n˛as£s
] = 
	`°rdup
(
˛ass
);

2041 
d±s
 = 
	`Æloˇã
(1, 
poöt_li°
);

2042 
d±s
->
±s
 = 
	`make_≥n_poöt_¨øy
(
≈ts
);

2043 i‡(
d±s
->
±s
 =
NULL
Ë
Áûed
;

2044 
d±s
->
≈ts
 =Çpts;

2045 
d±s
->
√xt
 = 
NULL
;

2048 
j
 = 0; j < 
≈ts
; j++) {

2049 
x
, 
y
;

2051 i‡(
	`fsˇnf
(
Â
, "%d %d", &
x
, &
y
Ë!2Ë
Áûed
;

2052 
d±s
->
±s
[
j
].
x
 = x;

2053 
d±s
->
±s
[
j
].
y
 = y;

2057 
	`lülg_compuã_chaö_code
(
d±s
);

2060 
ªc
->
dom±s
[
n˛as£s
] = 
d±s
;

2064 
Áûed
:

2065 
	`Ârötf
(
°dîr
, "read_classifier_digest failed...\n");

2066 ; 
n˛as£s
 >= 0;Çclasses--) {

2067 i‡(
ªc
->
˙ames
[
n˛as£s
] !
NULL
) {

2068 
	`‰ì
(
ªc
->
˙ames
[
n˛as£s
]);

2069 
ªc
->
˙ames
[
n˛as£s
] = 
NULL
;

2071 i‡(
ªc
->
dom±s
[
n˛as£s
] !
NULL
) {

2072 
	`dñëe_exam∂es
(
ªc
->
dom±s
[
n˛as£s
]);

2073 
ªc
->
dom±s
[
n˛as£s
] = 
NULL
;

2076 i‡(
d±s
 !
NULL
)

2077 
	`dñëe_exam∂es
(
d±s
);

2078 
	`f˛o£
(
Â
);

2082 
	`f˛o£
(
Â
);

2084 
	}
}

2093 
	$lülg_ˇn⁄iˇlize_exam∂es
(
rCœssifõr
 *
ªc
) {

2094 
i
;

2095 
n˛as£s
;

2097 i‡(
lidebug
) {

2098 
	`Ârötf
(
°dîr
, "lialg_canonicalize_examples working on %s\n",

2099 
ªc
->
fûe_«me
);

2102 
i
 = 0; i < 
MAXSCLASSES
; i++) {

2103 
ªc
->
ˇn⁄ex
[
i
] = 
NULL
;

2107 
n˛as£s
 = 0;

2108 
n˛as£s
 < 
MAXSCLASSES
 && 
ªc
->
˙ames
[n˛as£s] !
NULL
;

2109 
n˛as£s
++)

2113 
i
 = 0; i < 
n˛as£s
; i++) {

2114 
j
, 
k
;

2115 
√x
;

2116 
poöt_li°
 *
±s
, *
tmp
, *
avg
;

2117 
maxxønge
, 
maxyønge
;

2118 
möx
, 
möy
, 
maxx
, 
maxy
;

2119 
avgxønge
, 
avgyønge
, 
avgxoff
, 
avgyoff
, 
avgsˇÀ
;

2122 i‡(
lidebug
) {

2123 
	`Ârötf
(
°dîr
, "lialg_canonicalize_examples working on class %s\n",

2124 
ªc
->
˙ames
[
i
]);

2127 
±s
 = 
NULL
;

2128 
tmp
 = 
ªc
->
ex
[
i
];

2129 
√x
 = 0; 
tmp
 !
NULL
;Çex++,Åm∞tmp->
√xt
) {

2130 i‡((
±s
 = 
	`add_exam∂e
’ts, 
tmp
->
≈ts
,Åmp->±s)Ë=
NULL
) {

2131 
	`dñëe_exam∂es
(
±s
);

2137 
maxxønge
 = 0;

2138 
maxyønge
 = 0;

2139 
j
 = 0, 
tmp
 = 
±s
; j < 
√x
; j++,Åm∞tmp->
√xt
) {

2140 i‡(
	`lülg_ˇn⁄iˇlize_exam∂e_°roke
(
tmp
) != 0) {

2141 i‡(
lidebug
) {

2142 
	`Ârötf
(
°dîr
, "lialg_canonicalize_example_strokeÑeturnedÉrror\n");

2147 i‡(
tmp
->
xønge
 > 
maxxønge
) maxxrange =Åmp->xrange;

2148 i‡(
tmp
->
yønge
 > 
maxyønge
) maxyrange =Åmp->yrange;

2152 i‡(((100 * 
maxxønge
 + 
CANONICAL_X
 / 2) / CANONICAL_X) >

2153 ((100 * 
maxyønge
 + 
CANONICAL_Y
 / 2) / CANONICAL_Y)) {

2154 
maxyønge
 = (maxyøngê* 
CANONICAL_X
 + 
maxxønge
 / 2) / maxxrange;

2155 
maxxønge
 = 
CANONICAL_X
;

2158 
maxxønge
 = (maxxøngê* 
CANONICAL_Y
 + 
maxyønge
 / 2) / maxyrange;

2159 
maxyønge
 = 
CANONICAL_Y
;

2163 
j
 = 0, 
tmp
 = 
±s
; j < 
√x
; j++,Åm∞tmp->
√xt
) {

2164 
sˇÀx
 = (
tmp
->
xønge
 =0Ë? 100 : (100 * 
maxxønge
 +Åmp->xrange / 2) /Åmp->xrange;

2165 
sˇÀy
 = (
tmp
->
yønge
 =0Ë? 100 : (100 * 
maxyønge
 +Åmp->yrange / 2) /Åmp->yrange;

2166 i‡(
	`lülg_å™¶©e_poöts
(
tmp
, 0, 0, 
sˇÀx
, 
sˇÀy
) != 0) {

2167 
	`dñëe_exam∂es
(
±s
);

2173 
avg
 = 
±s
;

2174 
k
 = 0; k < 
NCANONICAL
; k++) {

2175 
xsum
 = 0;

2176 
ysum
 = 0;

2178 
j
 = 0, 
tmp
 = 
±s
; j < 
√x
; j++,Åm∞tmp->
√xt
) {

2179 
xsum
 +
tmp
->
±s
[
k
].
x
;

2180 
ysum
 +
tmp
->
±s
[
k
].
y
;

2183 
avg
->
±s
[
k
].
x
 = (
xsum
 + 
j
 / 2) / j;

2184 
avg
->
±s
[
k
].
y
 = (
ysum
 + 
j
 / 2) / j;

2188 
	`lülg_gë_boundög_box
(
avg
, &
möx
, &
möy
, &
maxx
, &
maxy
);

2189 
avgxønge
 = 
maxx
 - 
möx
;

2190 
avgyønge
 = 
maxy
 - 
möy
;

2191 
avgsˇÀ
 = (((100 * 
avgxønge
 + 
CANONICAL_X
 / 2) / CANONICAL_X) >

2192 ((100 * 
avgyønge
 + 
CANONICAL_Y
 / 2) / CANONICAL_Y))

2193 ? (100 * 
CANONICAL_X
 + 
avgxønge
 / 2) /ávgxrange

2194 : (100 * 
CANONICAL_Y
 + 
avgyønge
 / 2) /ávgyrange;

2195 i‡(
	`lülg_å™¶©e_poöts
(
avg
, 
möx
, 
möy
, 
avgsˇÀ
,ávgscale) != 0) {

2196 
	`dñëe_exam∂es
(
±s
);

2201 
	`lülg_gë_boundög_box
(
avg
, &
möx
, &
möy
, &
maxx
, &
maxy
);

2202 
avgxønge
 = 
maxx
 - 
möx
;

2203 
avgyønge
 = 
maxy
 - 
möy
;

2204 
avgxoff
 = -((
CANONICAL_X
 - 
avgxønge
 + 1) / 2);

2205 
avgyoff
 = -((
CANONICAL_Y
 - 
avgyønge
 + 1) / 2);

2206 i‡(
	`lülg_å™¶©e_poöts
(
avg
, 
avgxoff
, 
avgyoff
, 100, 100) != 0) {

2207 
	`dñëe_exam∂es
(
±s
);

2212 i‡((
ªc
->
ˇn⁄ex
[
i
] = 
	`add_exam∂e
(
NULL
, 
avg
->
≈ts
,ávg->
±s
)) == NULL) {

2213 
	`dñëe_exam∂es
(
±s
);

2216 (
ªc
->
ˇn⁄ex
[
i
])->
xønge
 = 
maxx
 - 
möx
;

2217 (
ªc
->
ˇn⁄ex
[
i
])->
yønge
 = 
maxy
 - 
möy
;

2219 i‡(
lidebug
) {

2220 
	`Ârötf
(
°dîr
, "%s,ávg±†%d\n", 
ªc
->
˙ames
[
i
], 
avg
->
≈ts
);

2221 
j
 = 0; j < 
avg
->
≈ts
; j++) {

2222 
	`Ârötf
(
°dîr
, " (%d, %d)\n",

2223 
avg
->
±s
[
j
].
x
,ávg->±s[j].
y
);

2228 
ªc
->
dom±s
[
i
] = 
	`lülg_compuã_domö™t_poöts
(
avg
);

2231 
	`dñëe_exam∂es
(
±s
);

2235 
i
 = 0; i < 
n˛as£s
; i++) {

2236 *
be°_«me
 = 
	`lülg_ªcognize_°roke
(
ªc
,Ñec->
ˇn⁄ex
[
i
]);

2238 i‡(
be°_«me
 !
ªc
->
˙ames
[
i
])

2239 
	`Ârötf
(
°dîr
, "%s, be° = %s\n", 
ªc
->
˙ames
[
i
], 
be°_«me
);

2243 
	}
}

2246 
	$lülg_ˇn⁄iˇlize_exam∂e_°roke
(
poöt_li°
 *
poöts
) {

2247 
möx
, 
möy
, 
maxx
, 
maxy
, 
xønge
, 
yønge
, 
sˇÀ
;

2250 i‡(
	`lülg_fûãr_poöts
(
poöts
) != 0) (-1);

2253 i‡(
poöts
->
≈ts
 < 2) {

2254 i‡(
lidebug
) {

2255 
	`Ârötf
(
°dîr
, "lialg_canonicalize_example_stroke:Çpts=%d\n",

2256 
poöts
->
≈ts
);

2262 
	`lülg_gë_boundög_box
(
poöts
, &
möx
, &
möy
, &
maxx
, &
maxy
);

2263 
xønge
 = 
maxx
 - 
möx
;

2264 
yønge
 = 
maxy
 - 
möy
;

2265 
sˇÀ
 = (((100 * 
xønge
 + 
CANONICAL_X
 / 2) / CANONICAL_X) >

2266 ((100 * 
yønge
 + 
CANONICAL_Y
 / 2) / CANONICAL_Y))

2267 ? (100 * 
CANONICAL_X
 + 
xønge
 / 2) / xrange

2268 : (100 * 
CANONICAL_Y
 + 
yønge
 / 2) / yrange;

2269 i‡(
	`lülg_å™¶©e_poöts
(
poöts
, 
möx
, 
möy
, 
sˇÀ
, scale) != 0) {

2270 i‡(
lidebug
) {

2271 
	`Ârötf
(
°dîr
, "lülg_å™¶©e_poöt†(möx=%d,möy=%d,sˇÀ=%dËªtu∫edÉº‹\n", 
möx
, 
möy
, 
sˇÀ
);

2277 i‡(
	`lülg_compuã_equùoöts
(
poöts
) != 0) (-1);

2280 
	`lülg_gë_boundög_box
(
poöts
, &
möx
, &
möy
, &
maxx
, &
maxy
);

2281 i‡(
	`lülg_å™¶©e_poöts
(
poöts
, 
möx
, 
möy
, 100, 100) != 0) {

2282 i‡(
lidebug
) {

2283 
	`Ârötf
(
°dîr
, "lülg_å™¶©e_poöt†(möx=%d,möy=%dËªtu∫edÉº‹\n", 
möx
, 
möy
);

2289 
xønge
 = 
maxx
 - 
möx
;

2290 
yønge
 = 
maxy
 - 
möy
;

2291 
poöts
->
xønge
 = xrange;

2292 
poöts
->
yønge
 = yrange;

2294 i‡(
lidebug
) {

2295 
i
;

2296 
	`Ârötf
(
°dîr
, "C™⁄iˇlized: %d, %d, %d, %d\n", 
möx
, 
möy
, 
maxx
, 
maxy
);

2297 
i
 = 0; i < 
poöts
->
≈ts
; i++)

2298 
	`Ârötf
(
°dîr
, " (%d %d)\n",

2299 
poöts
->
±s
[
i
].
x
,Öoöts->±s[i].
y
);

2300 
	`fÊush
(
°dîr
);

2304 
	}
}

2307 
	$lülg_compuã_equùoöts
(
poöt_li°
 *
poöts
) {

2308 
≥n_poöt
 *
equùoöts
 = 
	`make_≥n_poöt_¨øy
(
NCANONICAL
);

2309 
√quùoöts
 = 0;

2310 
∑thÀn
 = 
	`lülg_compuã_∑thÀn
(
poöts
);

2311 
equidi°
 = (
∑thÀn
 + (
NCANONICAL
 - 1) / 2) / (NCANONICAL - 1);

2312 
i
;

2313 
di°_sö˚_œ°_eq±
;

2314 
ªmaöög_£gÀn
;

2315 
di°_to_√xt_eq±
;

2317 i‡(
equùoöts
 =
NULL
) {

2318 
	`îr‹
("can'tállocate memory inÜialg_compute_equipoints");

2322 i‡(
lidebug
) {

2323 
	`Ârötf
(
°dîr
, "compute_equipoints:Çpts = %d,Öathlen = %d,Équidist = %d\n",

2324 
poöts
->
≈ts
, 
∑thÀn
, 
equidi°
);

2325 
	`fÊush
(
°dîr
);

2329 
equùoöts
[0] = 
poöts
->
±s
[0];

2330 
√quùoöts
++;

2331 
di°_sö˚_œ°_eq±
 = 0;

2333 
i
 = 1; i < 
poöts
->
≈ts
; i++) {

2334 
dx1
 = 
poöts
->
±s
[
i
].
x
 -Öoints->pts[i-1].x;

2335 
dy1
 = 
poöts
->
±s
[
i
].
y
 -Öoints->pts[i-1].y;

2336 
ídx
 = 100 * 
poöts
->
±s
[
i
-1].
x
;

2337 
ídy
 = 100 * 
poöts
->
±s
[
i
-1].
y
;

2338 
ªmaöög_£gÀn
 = 
	`isqπ
(10000 * (
dx1
 * dx1 + 
dy1
 * dy1));

2339 
di°_to_√xt_eq±
 = 
equidi°
 - 
di°_sö˚_œ°_eq±
;

2341 
ªmaöög_£gÀn
 >
di°_to_√xt_eq±
) {

2342 i‡(
dx1
 == 0) {

2344 i‡(
dy1
 >= 0)

2345 
ídy
 +
di°_to_√xt_eq±
;

2347 
ídy
 -
di°_to_√xt_eq±
;

2350 
¶›e
 = (100 * 
dy1
 + 
dx1
 / 2) / dx1;

2351 
tmp
 = 
	`isqπ
(10000 + 
¶›e
 * slope);

2352 
dx
 = (100 * 
di°_to_√xt_eq±
 + 
tmp
 / 2) /Åmp;

2353 
dy
 = (
¶›e
 * 
dx
 + 50) / 100;

2355 i‡(
dy
 < 0) dy = -dy;

2356 i‡(
dx1
 >= 0)

2357 
ídx
 +
dx
;

2359 
ídx
 -
dx
;

2360 i‡(
dy1
 >= 0)

2361 
ídy
 +
dy
;

2363 
ídy
 -
dy
;

2366 
equùoöts
[
√quùoöts
].
x
 = (
ídx
 + 50) / 100;

2367 
equùoöts
[
√quùoöts
].
y
 = (
ídy
 + 50) / 100;

2368 
√quùoöts
++;

2370 
di°_sö˚_œ°_eq±
 = 0;

2371 
ªmaöög_£gÀn
 -
di°_to_√xt_eq±
;

2372 
di°_to_√xt_eq±
 = 
equidi°
;

2375 
di°_sö˚_œ°_eq±
 +
ªmaöög_£gÀn
;

2379 i‡(
√quùoöts
 =
NCANONICAL
) {

2381 } i‡(
√quùoöts
 =(
NCANONICAL
 - 1)) {

2383 
equùoöts
[
√quùoöts
] = 
poöts
->
±s
[poöts->
≈ts
 - 1];

2385 i‡(
lidebug
) {

2386 
	`Ârötf
(
°dîr
,"lialg_compute_equipoints:Çequipoints = %d\n",

2387 
√quùoöts
);

2393 
poöts
->
≈ts
 = 
NCANONICAL
;

2394 
	`dñëe_≥n_poöt_¨øy
(
poöts
->
±s
);

2395 
poöts
->
±s
 = 
equùoöts
;

2397 
	}
}

2407 
	$lülg_compuã_∑thÀn
(
poöt_li°
 *
poöts
) {

2408 (
	`lülg_compuã_∑thÀn_sub£t
(
poöts
, 0,Öoöts->
≈ts
 - 1));

2409 
	}
}

2413 
	$lülg_compuã_∑thÀn_sub£t
(
poöt_li°
 *
poöts
,

2414 
°¨t
, 
íd
) {

2415 
∑thÀn
;

2416 
i
;

2418 
∑thÀn
 = 0;

2419 
i
 = 
°¨t
 + 1; i <
íd
; i++) {

2420 
dx
 = 
poöts
->
±s
[
i
].
x
 -Öoints->pts[i-1].x;

2421 
dy
 = 
poöts
->
±s
[
i
].
y
 -Öoints->pts[i-1].y;

2422 
di°
 = 
	`isqπ
(10000 * (
dx
 * dx + 
dy
 * dy));

2423 
∑thÀn
 +
di°
;

2426 (
∑thÀn
);

2427 
	}
}

2431 
	$lülg_fûãr_poöts
(
poöt_li°
 *
poöts
) {

2432 
fûãªd_≈ts
;

2433 
≥n_poöt
 *
fûãªd_±s
 = 
	`make_≥n_poöt_¨øy
(
poöts
->
≈ts
);

2434 
i
;

2436 i‡(
fûãªd_±s
 =
NULL
) {

2437 
	`îr‹
("can'tállocate memory inÜialg_filter_points");

2441 
fûãªd_±s
[0] = 
poöts
->
±s
[0];

2442 
fûãªd_≈ts
 = 1;

2443 
i
 = 1; i < 
poöts
->
≈ts
; i++) {

2444 
j
 = 
fûãªd_≈ts
 - 1;

2445 
dx
 = 
poöts
->
±s
[
i
].
x
 - 
fûãªd_±s
[
j
].x;

2446 
dy
 = 
poöts
->
±s
[
i
].
y
 - 
fûãªd_±s
[
j
].y;

2447 
magsq
 = 
dx
 * dx + 
dy
 * dy;

2449 i‡(
magsq
 >
DIST_SQ_THRESHOLD
) {

2450 
fûãªd_±s
[
fûãªd_≈ts
] = 
poöts
->
±s
[
i
];

2451 
fûãªd_≈ts
++;

2455 
poöts
->
≈ts
 = 
fûãªd_≈ts
;

2456 
	`dñëe_≥n_poöt_¨øy
(
poöts
->
±s
);

2457 
poöts
->
±s
 = 
fûãªd_±s
;

2459 
	}
}

2464 
	$lülg_å™¶©e_poöts
(
poöt_li°
 *
poöts
,

2465 
möx
, 
möy
,

2466 
sˇÀx
, 
sˇÀy
) {

2467 
i
;

2469 
i
 = 0; i < 
poöts
->
≈ts
; i++) {

2470 
poöts
->
±s
[
i
].
x
 = (’oöts->±s[i].x - 
möx
Ë* 
sˇÀx
 + 50) / 100;

2471 
poöts
->
±s
[
i
].
y
 = (’oöts->±s[i].y - 
möy
Ë* 
sˇÀy
 + 50) / 100;

2475 
	}
}

2478 
	$lülg_gë_boundög_box
(
poöt_li°
 *
poöts
,

2479 *
pmöx
, *
pmöy
,

2480 *
pmaxx
, *
pmaxy
) {

2481 
möx
, 
möy
, 
maxx
, 
maxy
;

2482 
i
;

2484 
möx
 = 
maxx
 = 
poöts
->
±s
[0].
x
;

2485 
möy
 = 
maxy
 = 
poöts
->
±s
[0].
y
;

2486 
i
 = 1; i < 
poöts
->
≈ts
; i++) {

2487 
≥n_poöt
 *
±
 = &(
poöts
->
±s
[
i
]);

2488 i‡(
±
->
x
 < 
möx
) minx =Öt->x;

2489 i‡(
±
->
x
 > 
maxx
) maxx =Öt->x;

2490 i‡(
±
->
y
 < 
möy
) miny =Öt->y;

2491 i‡(
±
->
y
 > 
maxy
) maxy =Öt->y;

2494 *
pmöx
 = 
möx
;

2495 *
pmöy
 = 
möy
;

2496 *
pmaxx
 = 
maxx
;

2497 *
pmaxy
 = 
maxy
;

2498 
	}
}

2500 
	$lülg_compuã_Õf_∑ømëîs
() {

2501 
i
;

2503 
i
 = 
LP_FILTER_WIDTH
; i >= 0; i--) {

2504 
x
 = 0.04 * (
i
 * i);

2505 #i‡
	`deföed
(
ARM_LINUX
Ë|| !deföed(
__GLIBC__
Ë|| deföed(
__ECOS
Ë|| deföed(
__UCLIBC__
)

2506 
tmp
 = 100.0 * 
	`exp
(()
x
);

2508 
tmp
 = 100.0 * 
	`expf
(
x
);

2510 
wt
 = 
	`röt
(()
tmp
);

2512 
lülg_Õfwts
[
LP_FILTER_WIDTH
 - 
i
] = 
wt
;

2513 
lülg_Õfwts
[
LP_FILTER_WIDTH
 + 
i
] = 
wt
;

2515 
lülg_Õfc⁄°
 = 0;

2516 
i
 = 0; i < (2 * 
LP_FILTER_WIDTH
 + 1); i++) {

2517 
lülg_Õfc⁄°
 +
lülg_Õfwts
[
i
];

2519 
	}
}

2523 
	$isqπ
(
n
) {

2524 
i
;

2525 
k0
, 
k1
, 
¬
;

2527 
¬
 = 
i
 = 
n
, 
k0
 = 2; i > 0; i >>= 2, k0 <<= 1)

2529 
¬
 <<= 2;

2531 
k1
 = (
¬
 / 
k0
 + k0) >> 1;

2532 i‡(((
k0
 ^ 
k1
) & ~1) == 0)

2534 
k0
 = 
k1
;

2536  (Ë((
k1
 + 1) >> 1);

2537 
	}
}

2541 
	$likóèn
(
è¡›
, 
ènbŸ
) {

2542 
t
;

2546 i‡((
è¡›
 =0Ë&& (
ènbŸ
 == 0))

2547 
t
 = 0;

2550 
t
 = (
è¡›
 << 16Ë/ (
	`abs
—™t›Ë+ábs(
ènbŸ
));

2551 i‡(
ènbŸ
 < 0)

2552 
t
 = 0x20000 -Å;

2554 i‡(
è¡›
 < 0Ë
t
 = 0x40000 +Å;

2556  
t
;

2557 
	}
}

2560 
	$quadr
(
t
) {

2561  (8 - (((
t
 + 0x4000) >> 15) & 7)) & 7;

2562 
	}
}

	@demos/nxscribble/li_recognizer.h

8 #i‚de‡
_LI_RECOGNIZER_H_


10 
	#_LI_RECOGNIZER_H_


	)

14 
	#LI_ISA_LI
 0

	)

16 
	$boﬁ
 (*
	tli_iß_li
)(
	tªcognizî
 
	tr
);

18 
	#LI_TRAIN
 1

	)

20 (*
	tli_ªcognizî_åaö
)(
	tªcognizî
 
	tr
,

21 
	trc
* 
	tªc_xt
,

22 
	tu_öt
 
	tn°rokes
,

23 
	t≥n_°roke
* 
	t°rokes
,

24 
	tªc_ñemít
* 
	tª
,

25 
	tboﬁ
 
	tª∂a˚_p
);

27 
	#LI_CLEAR
 2

	)

29 (*
	tli_ªcognizî_˛órSèã
)(
	tªcognizî
 
	tr
);

31 
	#LI_GET_CLASSES
 3

	)

33 (*
	tli_ªcognizî_gëCœs£s
)(
	tªcognizî
 
	tr
, ***
	tli°
, *
	tnc
);

35 
	#LI_NUM_EX_FNS
 4

	)

	@demos/nxscribble/li_recognizer_internal.h

8 #i‚de‡
_LI_RECOGNIZER_INTERNAL_H_


10 
	#_LI_RECOGNIZER_INTERNAL_H_


	)

12 
	~<hª_öã∫Æ.h
>

13 
	~"sc.h
"

15 
	sPoötLi°
 {

16 
	m≈ts
;

17 
	mxønge
, 
	myønge
;

18 
≥n_poöt
* 
	m±s
;

19 
PoötLi°
* 
	m√xt
;

20 } 
	tpoöt_li°
;

23 * 
	mfûe_«me
;

24 
sCœssifõr
 
	msc
;

25 
poöt_li°
* 
	mex
[
MAXSCLASSES
];

26 * 
	m˙ames
[
MAXSCLASSES
];

27 
poöt_li°
* 
	mˇn⁄ex
[
MAXSCLASSES
];

28 
poöt_li°
* 
	mdom±s
[
MAXSCLASSES
];

29 } 
	trCœssifõr
;

36 
u_öt
 
	mli_magic
;

37 
rCœssifõr
 
	mli_rc
;

38 } 
	tli_ªcognizî
;

42 
	#LI_DEFAULT_CLASSIFIER_FILE
 "deÁu….˛"

	)

45 
	#LI_CLASSIFIER_EXTENSION
 ".˛"

	)

48 
	#LI_SUPPORTED_LOCALE
 
REC_DEFAULT_LOCALE


	)

	@demos/nxscribble/matrix.c

18 #unde‡
PIQ_DEBUG


20 
	~<°dio.h
>

21 
	~<°dlib.h
>

22 
	~<m©h.h
>

23 
	~"utû.h
"

24 
	~"m©rix.h
"

27 
¨øy_hódî
 *
	tAºay
;

29 
	#EPSILON
 (1.0e-10Ë

	)

36 
Ve˘‹


37 
	$NewVe˘‹
(
r
)

38 
r
;

40 
¨øy_hódî
 *
a
;

41 
Ve˘‹
 
v
;

43 
a
 = (
¨øy_hódî
 *)

44 
	`Æloˇã
((
¨øy_hódî
Ë+ 
r
 * (), );

45 
a
->
ndims
 = 1;

46 
a
->
ƒows
 = 
r
;

47 
a
->
ncﬁs
 = 1;

48 
v
 = (
Ve˘‹
Ë(
a
 + 1);

50 
	#CHECK


	)

51 #ifde‡
CHECK


52 if(
	`HEADER
(
v
Ë!(
¨øy_hódî
 *Ë
a
 ||

53 
	`NDIMS
(
v
Ë!1 || 
	`NROWS
(vË!
r
 || 
	`NCOLS
(v) != 1) {

54 
	`exô_îr‹
("NewVe˘‹Éº‹: v=%x H: %x,%x D:%d,%d R:%d,%d C:%d,%d\n", 
v
, 
	`HEADER
(v), 
a
, 
	`NDIMS
(v), 1, 
	`NROWS
(v), 
r
, 
	`NCOLS
(v), 1);

58  
v
;

59 
	}
}

61 
M©rix


62 
	$NewM©rix
(
r
, 
c
)

63 
r
, 
c
;

65 
¨øy_hódî
 *
a
 = (array_header *)

66 
	`Æloˇã
((
¨øy_hódî
Ë+ 
r
 * (*), );

67 
i
;

68 
M©rix
 
m
;

70 
m
 = (
M©rix
Ë(
a
 + 1);

71 
i
 = 0; i < 
r
; i++)

72 
m
[
i
] = 
	`Æloˇã
(
c
, );

73 
a
->
ndims
 = 2;

74 
a
->
ƒows
 = 
r
;

75 
a
->
ncﬁs
 = 
c
;

76  
m
;

77 
	}
}

80 
	$FªeVe˘‹
(
v
)

81 
Ve˘‹
 
v
;

83 
	`‰ì
(
	`HEADER
(
v
));

84 
	}
}

87 
	$FªeM©rix
(
m
)

88 
M©rix
 
m
;

90 
i
;

92 
i
 = 0; i < 
	`NROWS
(
m
); i++)

93 
	`‰ì
(
m
[
i
]);

94 
	`‰ì
(
	`HEADER
(
m
));

95 
	}
}

97 
Ve˘‹


98 
	$Ve˘‹C›y
(
v
)

99 
Ve˘‹
 
v
;

101 
Ve˘‹
 
r
 = 
	`NewVe˘‹
(
	`NROWS
(
v
));

102 
i
;

104 
i
 = 0; i < 
	`NROWS
(
v
); i++)

105 
r
[
i
] = 
v
[i];

106  
r
;

107 
	}
}

109 
M©rix


110 
	$M©rixC›y
(
m
)

111 
M©rix
 
m
;

113 
M©rix
 
r
 = 
	`NewM©rix
(
	`NROWS
(
m
), 
	`NCOLS
(m));

114 
i
, 
j
;

116 
i
 = 0; i < 
	`NROWS
(
m
); i++)

117 
j
 = 0; j < 
	`NROWS
(
m
); j++)

118 
r
[
i
][
j
] = 
m
[i][j];

119  
r
;

120 
	}
}

126 
	$ZîoVe˘‹
(
v
)

127 
Ve˘‹
 
v
;

129 
i
;

130 
i
 = 0; i < 
	`NROWS
(
v
); i++) v[i] = 0.0;

131 
	}
}

135 
	$ZîoM©rix
(
m
)

136 
M©rix
 
m
;

138 
i
, 
j
;

139 
i
 = 0; i < 
	`NROWS
(
m
); i++)

140 
j
 = 0; j < 
	`NCOLS
(
m
); j++)

141 
m
[
i
][
j
] = 0.0;

142 
	}
}

145 
	$FûlM©rix
(
m
, 
fûl
)

146 
M©rix
 
m
;

147 
fûl
;

149 
i
, 
j
;

150 
i
 = 0; i < 
	`NROWS
(
m
); i++)

151 
j
 = 0; j < 
	`NCOLS
(
m
); j++)

152 
m
[
i
][
j
] = 
fûl
;

153 
	}
}

156 
	$I¬îProdu˘
(
v1
, 
v2
)

157 
Ve˘‹
 
v1
, 
v2
;

159 
ªsu…
 = 0;

160 
n
 = 
	`NROWS
(
v1
);

161 if(
n
 !
	`NROWS
(
v2
)) {

162 
	`exô_îr‹
("I¬îProdu˘ %d x %d ", 
n
, 
	`NROWS
(
v2
));

164 --
n
 >= 0)

165 
ªsu…
 +*
v1
++ * *
v2
++;

166  
ªsu…
;

167 
	}
}

170 
	$M©rixMu…ùly
(
m1
, 
m2
, 
¥od
)

171 
M©rix
 
m1
, 
m2
, 
¥od
;

173 
i
, 
j
, 
k
;

174 
sum
;

176 if(
	`NCOLS
(
m1
Ë!
	`NROWS
(
m2
)) {

177 
	`îr‹
("MatrixMultiply: Can't multiply %dx%dánd %dx%d matrices",

178 
	`NROWS
(
m1
), 
	`NCOLS
(m1), NROWS(
m2
), NCOLS(m2));

181 if(
	`NROWS
(
¥od
Ë!NROWS(
m1
Ë|| 
	`NCOLS
’rodË!NCOLS(
m2
)) {

182 
	`îr‹
("MatrixMultiply: %dx%dÅimes %dx%d doesÇot give %dx%dÖroduct",

183 
	`NROWS
(
m1
), 
	`NCOLS
(m1), NROWS(
m2
), NCOLS(m2),

184 
	`NROWS
(
¥od
), 
	`NCOLS
(prod));

188 
i
 = 0; i < 
	`NROWS
(
m1
); i++)

189 
j
 = 0; j < 
	`NCOLS
(
m2
); j++) {

190 
sum
 = 0;

191 
k
 = 0; k < 
	`NCOLS
(
m1
); k++)

192 
sum
 +
m1
[
i
][
k
] * 
m2
[k][
j
];

193 
¥od
[
i
][
j
] = 
sum
;

195 
	}
}

205 
	$Ve˘‹TimesM©rix
(
v
, 
m
, 
¥od
)

206 
Ve˘‹
 
v
;

207 
M©rix
 
m
;

208 
Ve˘‹
 
¥od
;

210 
i
, 
j
;

212 if(
	`NROWS
(
v
Ë!NROWS(
m
)) {

213 
	`îr‹
("VectorTimesMatrix: Can't multiply %d vector by %dx%d",

214 
	`NROWS
(
v
), NROWS(
m
), 
	`NCOLS
(m));

217 if(
	`NROWS
(
¥od
Ë!
	`NCOLS
(
m
)) {

218 
	`îr‹
("VectorTimesMatrix: %d vectorÅimes %dx%d mat doesÇot fit in %dÖroduct" ,

219 
	`NROWS
(
v
), NROWS(
m
), 
	`NCOLS
(m), NROWS(
¥od
));

223 
j
 = 0; j < 
	`NCOLS
(
m
); j++) {

224 
¥od
[
j
] = 0;

225 
i
 = 0; i < 
	`NROWS
(
m
); i++)

226 
¥od
[
j
] +
v
[
i
] * 
m
[i][j];

228 
	}
}

231 
	$SˇœrTimesVe˘‹
(
s
, 
v
, 
¥odu˘
)

232 
s
;

233 
Ve˘‹
 
v
, 
¥odu˘
;

235 
n
 = 
	`NROWS
(
v
);

237 if(
	`NROWS
(
v
Ë!NROWS(
¥odu˘
)) {

238 
	`îr‹
("ScalarTimesVector:Ñesult wrong size (%d!=%d)",

239 
	`NROWS
(
v
), NROWS(
¥odu˘
));

243 --
n
 >= 0)

244 *
¥odu˘
++ = 
s
 * *
v
++;

245 
	}
}

248 
	$SˇœrTimesM©rix
(
s
, 
m
, 
¥odu˘
)

249 
s
;

250 
M©rix
 
m
, 
¥odu˘
;

252 
i
, 
j
;

254 if(
	`NROWS
(
m
Ë!NROWS(
¥odu˘
) ||

255 
	`NCOLS
(
m
Ë!NCOLS(
¥odu˘
)) {

256 
	`îr‹
("ScalarTimesMatrix:Ñesult wrong size (%d!=%d)or(%d!=%d)",

257 
	`NROWS
(
m
), NROWS(
¥odu˘
),

258 
	`NCOLS
(
m
), NCOLS(
¥odu˘
));

262 
i
 = 0; i < 
	`NROWS
(
m
); i++)

263 
j
 = 0; j < 
	`NCOLS
(
m
); j++)

264 
¥odu˘
[
i
][
j
] = 
s
 * 
m
[i][j];

265 
	}
}

272 
	$QuadøticF‹m
(
v
, 
m
)

273 
Ve˘‹
 
v
;

274 
M©rix
 
m
;

276 
i
, 
j
, 
n
;

277 
ªsu…
 = 0;

279 
n
 = 
	`NROWS
(
v
);

281 if(
n
 !
	`NROWS
(
m
Ë||Ç !
	`NCOLS
(m)) {

282 
	`exô_îr‹
("QuadraticForm: bad matrix size (%dx%dÇot %dx%d)",

283 
	`NROWS
(
m
), 
	`NCOLS
(m), 
n
,Ç);

285 
i
 = 0; i < 
n
; i++)

286 
j
 = 0; j < 
n
; j++) {

288 #ifde‡
PIQ_DEBUG


289 
	`¥ötf
("%g*%g*%g [%g] %s ",

290 
m
[
i
][
j
],
v
[i],v[j],

291 
m
[
i
][
j
] * 
v
[i] * v[j],

292 
i
==
n
-1&&
j
==n-1? "=" : "+");

295 
ªsu…
 +
m
[
i
][
j
] * 
v
[i] * v[j];

297  
ªsu…
;

298 
	}
}

314 
	gDebugInvîtM©rix
 = 0;

316 
	#PERMBUFSIZE
 200

	)

318 
	#_abs
(
x
Ë((x)>=0 ? (xË: -(x))

	)

321 
	$InvîtM©rix
(
ym
, 
rm
)

322 
M©rix
 
ym
, 
rm
;

324 
i
, 
j
, 
k
;

325 
dë
, 
biga
, 
ªcù_biga
, 
hﬁd
;

326 
l
[
PERMBUFSIZE
], 
m
[PERMBUFSIZE];

327 
n
;

329 if(
	`NROWS
(
ym
Ë!
	`NCOLS
(ym)) {

330 
	`exô_îr‹
("InvertMatrix:Çot square");

333 
n
 = 
	`NROWS
(
ym
);

335 if(
n
 !
	`NROWS
(
rm
Ë||Ç !
	`NCOLS
(rm)) {

336 
	`exô_îr‹
("InvertMatrix:Ñesult wrong size");

341 if(
ym
 !
rm
)

342 
i
 = 0; i < 
n
; i++)

343 
j
 = 0; j < 
n
; j++)

344 
rm
[
i
][
j
] = 
ym
[i][j];

351 i‡(
n
 >
PERMBUFSIZE
) {

352 
	`exô_îr‹
("InvertMatrix: PERMBUFSIZE");

355 
dë
 = 1.0;

356 
k
 = 0; k < 
n
; k++) {

357 
l
[
k
] = k; 
m
[k] = k;

358 
biga
 = 
rm
[
k
][k];

361 
i
 = 
k
; i < 
n
; i++)

362 
j
 = 
k
; j < 
n
; j++)

363 i‡(
	`_abs
(
rm
[
i
][
j
]Ë> _abs(
biga
)) {

364 
biga
 = 
rm
[
i
][
j
];

365 
l
[
k
] = 
i
;

366 
m
[
k
] = 
j
;

369 if(
DebugInvîtM©rix
)

370 if(
biga
 == 0.0)

371 
	`PrötM©rix
(
m
, "found zîÿbig®%g\n", 
biga
);

374 
i
 = 
l
[
k
];

375 i‡(
i
 > 
k
)

376 
j
 = 0; j < 
n
; j++) {

377 
hﬁd
 = -
rm
[
k
][
j
];

378 
rm
[
k
][
j
] =Ñm[
i
][j];

379 
rm
[
i
][
j
] = 
hﬁd
;

383 
j
 = 
m
[
k
];

384 i‡(
j
 > 
k
)

385 
i
 = 0; i < 
n
; i++) {

386 
hﬁd
 = -
rm
[
i
][
k
];

387 
rm
[
i
][
k
] =Ñm[i][
j
];

388 
rm
[
i
][
j
] = 
hﬁd
;

393 i‡(
biga
 == 0.0) {

397 if(
DebugInvîtM©rix
Ë
	`¥ötf
("big®%g\n", 
biga
);

398 
ªcù_biga
 = 1/
biga
;

399 
i
 = 0; i < 
n
; i++)

400 i‡(
i
 !
k
)

401 
rm
[
i
][
k
] *-
ªcù_biga
;

404 
i
 = 0; i < 
n
; i++)

405 i‡(
i
 !
k
) {

406 
hﬁd
 = 
rm
[
i
][
k
];

407 
j
 = 0; j < 
n
; j++)

408 i‡(
j
 !
k
)

409 
rm
[
i
][
j
] +
hﬁd
 *Ñm[
k
][j];

413 
j
 = 0; j < 
n
; j++)

414 i‡(
j
 !
k
)

415 
rm
[
k
][
j
] *
ªcù_biga
;

417 
dë
 *
biga
;

418 if(
DebugInvîtM©rix
Ë
	`¥ötf
("dë = %g\n", 
dë
);

419 
rm
[
k
][k] = 
ªcù_biga
;

424 
k
 = 
n
 - 1; k >= 0; k--) {

425 
i
 = 
l
[
k
];

426 i‡(
i
 > 
k
)

427 
j
 = 0; j < 
n
; j++) {

428 
hﬁd
 = 
rm
[
j
][
k
];

429 
rm
[
j
][
k
] = -rm[j][
i
];

430 
rm
[
j
][
i
] = 
hﬁd
;

432 
j
 = 
m
[
k
];

433 i‡(
j
 > 
k
)

434 
i
 = 0; i < 
n
; i++) {

435 
hﬁd
 = 
rm
[
k
][
i
];

436 
rm
[
k
][
i
] = -rm[
j
][i];

437 
rm
[
j
][
i
] = 
hﬁd
;

441 if(
DebugInvîtM©rix
Ë
	`¥ötf
("ªtu∫ög, dë = %g\n", 
dë
);

443  
dë
;

444 
	}
}

447 
	~"bôve˘‹.h
"

449 
Ve˘‹


450 
	$Sli˚Ve˘‹
(
v
, 
rowmask
)

451 
Ve˘‹
 
v
;

452 
BôVe˘‹
 
rowmask
;

454 
i
, 
ri
;

456 
Ve˘‹
 
r
 = 
	`NewVe˘‹
(
	`bôcou¡
(
	`NROWS
(
v
), 
rowmask
));

457 
i
 = 
ri
 = 0; i < 
	`NROWS
(
v
); i++)

458 if(
	`IS_SET
(
i
, 
rowmask
) )

459 
r
[
ri
++] = 
v
[
i
];

460  
r
;

461 
	}
}

463 
M©rix


464 
	$Sli˚M©rix
(
m
, 
rowmask
, 
cﬁmask
)

465 
M©rix
 
m
;

466 
BôVe˘‹
 
rowmask
, 
cﬁmask
;

468 
i
, 
ri
, 
j
, 
rj
;

470 
M©rix
 
r
;

472 
r
 = 
	`NewM©rix
(
	`bôcou¡
(
	`NROWS
(
m
), 
rowmask
),

473 
	`bôcou¡
(
	`NCOLS
(
m
), 
cﬁmask
));

474 
i
 = 
ri
 = 0; i < 
	`NROWS
(
m
); i++)

475 if(
	`IS_SET
(
i
, 
rowmask
) ) {

476 
j
 = 
rj
 = 0; j < 
	`NCOLS
(
m
); j++)

477 if(
	`IS_SET
(
j
, 
cﬁmask
))

478 
r
[
ri
][
rj
++] = 
m
[
i
][
j
];

479 
ri
++;

482  
r
;

483 
	}
}

485 
M©rix


486 
	$DeSli˚M©rix
(
m
, 
fûl
, 
rowmask
, 
cﬁmask
, 
r
)

487 
M©rix
 
m
;

488 
fûl
;

489 
BôVe˘‹
 
rowmask
, 
cﬁmask
;

490 
M©rix
 
r
;

492 
i
, 
ri
, 
j
, 
rj
;

494 
	`FûlM©rix
(
r
, 
fûl
);

496 
i
 = 
ri
 = 0; i < 
	`NROWS
(
r
); i++) {

497 if(
	`IS_SET
(
i
, 
rowmask
) ) {

498 
j
 = 
rj
 = 0; j < 
	`NCOLS
(
r
); j++)

499 if(
	`IS_SET
(
j
, 
cﬁmask
))

500 
r
[
i
][
j
] = 
m
[
ri
][
rj
++];

501 
ri
++;

505  
r
;

506 
	}
}

509 
	$OuçutVe˘‹
(
f
, 
v
)

510 
FILE
 *
f
;

511 
Ve˘‹
 
v
;

513 
i
;

514 
	`Ârötf
(
f
, " V %d ", 
	`NROWS
(
v
));

515 
i
 = 0; i < 
	`NROWS
(
v
); i++)

516 
	`Ârötf
(
f
, " %g", 
v
[
i
]);

517 
	`Ârötf
(
f
, "\n");

518 
	}
}

520 
Ve˘‹


521 
	$I≈utVe˘‹
(
f
)

522 
FILE
 *
f
;

524 
Ve˘‹
 
v
;

525 
i
;

526 
check
[4];

527 
ƒows
;

529 if(
	`fsˇnf
(
f
, "%1†%d", 
check
, &
ƒows
) != 2) {

530 
	`exô_îr‹
("InputVector fscanf 1");

532 if(
check
[0] != 'V') {

533 
	`exô_îr‹
("InputVector check");

535 
v
 = 
	`NewVe˘‹
(
ƒows
);

536 
i
 = 0; i < 
ƒows
; i++) {

537 if(
	`fsˇnf
(
f
, "%lf", &
v
[
i
]) != 1) {

538 
	`exô_îr‹
("InputVector fscanf 2");

541  
v
;

542 
	}
}

545 
	$OuçutM©rix
(
f
, 
m
)

546 
FILE
* 
f
;

547 
M©rix
 
m
;

549 
i
, 
j
;

550 
	`Ârötf
(
f
, " M %d %d\n", 
	`NROWS
(
m
), 
	`NCOLS
(m));

551 
i
 = 0; i < 
	`NROWS
(
m
); i++) {

552 
j
 = 0; j < 
	`NCOLS
(
m
); j++)

553 
	`Ârötf
(
f
, " %g", 
m
[
i
][
j
]);

554 
	`Ârötf
(
f
, "\n");

556 
	}
}

558 
M©rix


559 
	$I≈utM©rix
(
f
)

560 
FILE
 *
f
;

562 
M©rix
 
m
;

563 
i
, 
j
;

564 
check
[4];

565 
ƒows
, 
ncﬁs
;

567 if(
	`fsˇnf
(
f
, "%1†%d %d", 
check
, &
ƒows
, &
ncﬁs
) != 3) {

568 
	`exô_îr‹
("InputMatrix fscanf 1");

570 if(
check
[0] != 'M') {

571 
	`exô_îr‹
("InputMatrix check");

573 
m
 = 
	`NewM©rix
(
ƒows
, 
ncﬁs
);

574 
i
 = 0; i < 
ƒows
; i++)

575 
j
 = 0; j < 
ncﬁs
; j++) {

576 if(
	`fsˇnf
(
f
, "%lf", &
m
[
i
][
j
]) != 1) {

577 
	`exô_îr‹
("InputMatrix fscanf 2");

581  
m
;

582 
	}
}

585 
	$InvîtSöguœrM©rix
(
m
, 
öv
)

586 
M©rix
 
m
, 
öv
;

588 
i
, 
j
, 
k
;

589 
BôVe˘‹
 
mask
;

590 
M©rix
 
sm
;

591 
dë
, 
maxdë
;

592 
mi
 = -1, 
mj
 = -1, 
mk
 = -1;

594 
maxdë
 = 0.0;

595 
i
 = 0; i < 
	`NROWS
(
m
); i++) {

596 
	`¥ötf
("r&c%d, ", 
i
);

597 
	`SET_BIT_VECTOR
(
mask
);

598 
	`BIT_CLEAR
(
i
, 
mask
);

599 
sm
 = 
	`Sli˚M©rix
(
m
, 
mask
, mask);

600 
dë
 = 
	`InvîtM©rix
(
sm
, sm);

601 if(
dë
 == 0.0)

602 
	`¥ötf
("det still 0\n");

604 
	`¥ötf
("dë = %g\n", 
dë
);

606 if(
	`_abs
(
dë
Ë> _abs(
maxdë
))

607 
maxdë
 = 
dë
, 
mi
 = 
i
;

608 
	`FªeM©rix
(
sm
);

610 
	`¥ötf
("\n");

612 
	`¥ötf
("maxdë=%g whíÑow %dÜe· out\n", 
maxdë
, 
mi
);

613 if(
	`Ábs
(
maxdë
) > 1.0e-6) {

614 
found
;

617 
maxdë
 = 0.0;

618 
i
 = 0; i < 
	`NROWS
(
m
); i++) {

619 
j
 = 
i
+1; j < 
	`NROWS
(
m
); j++) {

621 
	`SET_BIT_VECTOR
(
mask
);

622 
	`BIT_CLEAR
(
i
, 
mask
);

623 
	`BIT_CLEAR
(
j
, 
mask
);

624 
sm
 = 
	`Sli˚M©rix
(
m
, 
mask
, mask);

625 
dë
 = 
	`InvîtM©rix
(
sm
, sm);

633 if(
	`abs
(
dë
Ë>ábs(
maxdë
))

634 
maxdë
 = 
dë
, 
mi
 = 
i
, 
mj
 = 
j
;

635 
	`FªeM©rix
(
sm
);

639 
	`¥ötf
("maxdë=%g whíÑow†%d,%dÜe· out\n", 
maxdë
, 
mi
, 
mj
);

640 if(
	`_abs
(
maxdë
) > 1.0e-6) {

641 
found
;

644 
maxdë
 = 0.0;

645 
i
 = 0; i < 
	`NROWS
(
m
); i++) {

646 
j
 = 
i
+1; j < 
	`NROWS
(
m
); j++) {

647 
k
 = 
j
+1; k < 
	`NROWS
(
m
); k++) {

649 
	`SET_BIT_VECTOR
(
mask
);

650 
	`BIT_CLEAR
(
i
, 
mask
);

651 
	`BIT_CLEAR
(
j
, 
mask
);

652 
	`BIT_CLEAR
(
k
, 
mask
);

653 
sm
 = 
	`Sli˚M©rix
(
m
, 
mask
, mask);

654 
dë
 = 
	`InvîtM©rix
(
sm
, sm);

662 if(
	`_abs
(
dë
Ë> _abs(
maxdë
))

663 
maxdë
 = 
dë
, 
mi
 = 
i
, 
mj
 = 
j
, 
mk
 = 
k
;

664 
	`FªeM©rix
(
sm
);

668 
	`¥ötf
("maxdë=%g whíÑow†%d,%d&%dÜe· out\n", 
maxdë
, 
mi
, 
mj
, 
mk
);

669 if(
mk
 == -1)

672 
found
:

674 
	`SET_BIT_VECTOR
(
mask
);

675 if(
mi
 >0Ë
	`BIT_CLEAR
(mi, 
mask
);

676 if(
mj
 >0Ë
	`BIT_CLEAR
(mj, 
mask
);

677 if(
mk
 >0Ë
	`BIT_CLEAR
(mk, 
mask
);

678 
sm
 = 
	`Sli˚M©rix
(
m
, 
mask
, mask);

679 
dë
 = 
	`InvîtM©rix
(
sm
, sm);

680 
	`DeSli˚M©rix
(
sm
, 0.0, 
mask
, mask, 
öv
);

681 
	`FªeM©rix
(
sm
);

682 
	`PrötM©rix
(
öv
, "desliced:\n");

683  
dë
;

684 
	}
}

689 
	$PrötVe˘‹
(
v
, 
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
)

690 
Ve˘‹
 
v
;

691 *
s
; 
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
;

693 
i
;

694 
	`¥ötf
(
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
);

696 
i
 = 0; i < 
	`NROWS
(
v
); i++Ë
	`¥ötf
(" %8.4f", v[i]);

697 
	`¥ötf
("\n");

698 
	}
}

701 
	$PrötM©rix
(
m
, 
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
)

702 
M©rix
 
m
;

703 *
s
; 
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
;

705 
i
, 
j
;

706 
	`¥ötf
(
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
);

707 
i
 = 0; i < 
	`NROWS
(
m
); i++) {

708 
j
 = 0; j < 
	`NCOLS
(
m
); j++)

709 
	`¥ötf
(" %8.4f", 
m
[
i
][
j
]);

710 
	`¥ötf
("\n");

712 
	}
}

715 
	$PrötAºay
(
a
, 
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
)

716 
Aºay
 
a
;

717 *
s
; 
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
;

719 
	`NDIMS
(
a
)) {

720 1: 
	`PrötVe˘‹
((
Ve˘‹
Ë
a
, 
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
); ;

721 2: 
	`PrötM©rix
((
M©rix
Ë
a
, 
s
,
a1
,
a2
,
a3
,
a4
,
a5
,
a6
,
a7
,
a8
); ;

722 : 
	`îr‹
("PrintArray");

724 
	}
}

	@demos/nxscribble/matrix.h

35 
	#HEADER
(
a
Ë–((
¨øy_hódî
 *ËaË- 1 )

	)

37 
	#NDIMS
(
a
Ë()(
	`HEADER
◊)->
ndims
)

	)

38 
	#NROWS
(
a
Ë()(
	`HEADER
◊)->
ƒows
)

	)

39 
	#NCOLS
(
a
Ë()(
	`HEADER
◊)->
ncﬁs
)

	)

40 
	#ISVECTOR
(
a
Ë(
	`NDIMS
◊Ë=1)

	)

41 
	#ISMATRIX
(
a
Ë(
	`NDIMS
◊Ë=2)

	)

48 
	s¨øy_hódî
 {

49 
	mndims
;

50 
	mƒows
;

51 
	mncﬁs
;

52 
	mfûÀr
;

55 **
	tM©rix
;

56 *
	tVe˘‹
;

58 
Ve˘‹
 
NewVe˘‹
();

59 
M©rix
 
NewM©rix
();

60 
FªeVe˘‹
();

61 
FªeM©rix
();

62 
PrötVe˘‹
();

63 
PrötM©rix
();

64 
I¬îProdu˘
();

65 
M©rixMu…ùly
();

66 
Ve˘‹TimesM©rix
();

67 
SˇœrTimesVe˘‹
();

68 
QuadøticF‹m
();

69 
InvîtM©rix
();

70 
Ve˘‹
 
Sli˚Ve˘‹
();

71 
M©rix
 
Sli˚M©rix
();

72 
Ve˘‹
 
Ve˘‹C›y
();

73 
M©rix
 
M©rixC›y
();

74 
Ve˘‹
 
I≈utVe˘‹
();

75 
M©rix
 
I≈utM©rix
();

77 
InvîtSöguœrM©rix
();

78 
M©rix
 
DeSli˚M©rix
();

80 
OuçutVe˘‹
();

81 
OuçutM©rix
();

82 
ZîoVe˘‹
();

83 
ZîoM©rix
();

84 
FûlM©rix
();

	@demos/nxscribble/nxscribble.c

7 
	~<°dio.h
>

8 
	~<°rög.h
>

9 
	~<°dlib.h
>

10 
	#MWINCLUDECOLORS


	)

11 
	~"«no-X.h
"

12 
	~"s¸ib.h
"

14 
	#TEXTWIN_WIDTH
 200

	)

15 
	#TEXTWIN_HEIGHT
 150

	)

17 
S¸ibbÀWidgë
 
	gw
;

19 
GR_BOOL
 
	gbTextwö
 = 
GR_FALSE
;

20 
GR_WINDOW_ID
 
	gwt
 = 0;

21 
GR_GC_ID
 
	gg˘
 = 0;

22 
GR_GC_ID
 
	gg˘b
 = 0;

23 
GR_COORD
 
	gxpos
 = 0;

24 
GR_COORD
 
	gypos
 = 0;

25 
GR_SIZE
 
	gwidth
;

26 
GR_SIZE
 
	gheight
;

27 
GR_SIZE
 
	gba£
;

28 
ch¨_out
(
GR_CHAR
 
ch
);

29 
ch¨_dñ
(
GR_COORD
 
x
, GR_COORD 
y
);

31 
do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
);

32 
do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
);

33 
do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
);

34 
do_focusö
(
GR_EVENT_GENERAL
 *
gp
);

35 
do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
);

36 
do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
);

39 
	$maö
(
¨gc
, **
¨gv
)

41 
t
 = 1;

42 
GR_EVENT
 
evít
;

44 
t
 < 
¨gc
) {

45 i‡(!
	`°rcmp
("-t", 
¨gv
[
t
])) {

46 
bTextwö
 = 
GR_TRUE
;

47 ++
t
;

52 i‡(
	`GrO≥n
() < 0) {

53 
	`Ârötf
(
°dîr
, "cannot open graphics\n");

54 
	`exô
(1);

57 i‡(
bTextwö
) {

59 
wt
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 50, 20,

60 
TEXTWIN_WIDTH
, 
TEXTWIN_HEIGHT
, 5, 
BLACK
, 
GREEN
);

61 
	`GrSñe˘Evíts
(
wt
,

62 
GR_EVENT_MASK_CLOSE_REQ
 | 
GR_EVENT_MASK_KEY_DOWN


63 | 
GR_EVENT_MASK_EXPOSURE
);

64 
	`GrM≠Wödow
(
wt
);

65 
g˘
 = 
	`GrNewGC
();

66 
	`GrSëGCF‹eground
(
g˘
, 
GREEN
);

67 
	`GrGëGCTextSize
(
g˘
, "A",1, 
GR_TFASCII
, &
width
, &
height
, &
ba£
);

68 
	`GrSëGCF⁄t
(
g˘
, 
	`GrCª©eF⁄t
(
GR_FONT_SYSTEM_FIXED
, 0, 
NULL
));

69 
g˘b
 = 
	`GrNewGC
();

70 
	`GrSëGCF‹eground
(
g˘b
, 
BLACK
);

74 
w
 = 
	`¸óã_s¸ibbÀ
();

77 
	`GrGëNextEvít
(&
evít
);

79 
evít
.
ty≥
) {

80 
GR_EVENT_TYPE_BUTTON_DOWN
:

81 
	`do_buâ⁄down
(&
evít
.
buâ⁄
);

84 
GR_EVENT_TYPE_BUTTON_UP
:

85 
	`do_buâ⁄up
(&
evít
.
buâ⁄
);

88 
GR_EVENT_TYPE_MOUSE_POSITION
:

89 
GR_EVENT_TYPE_MOUSE_MOTION
:

90 
	`do_mŸi⁄
(&
evít
.
mou£
);

93 
GR_EVENT_TYPE_FOCUS_IN
:

94 
	`do_focusö
(&
evít
.
gíîÆ
);

97 
GR_EVENT_TYPE_KEY_DOWN
:

98 
	`do_key°roke
(&
evít
.
key°roke
);

101 
GR_EVENT_TYPE_EXPOSURE
:

102 
	`do_exposuª
(&
evít
.
exposuª
);

105 
GR_EVENT_TYPE_CLOSE_REQ
:

106 
	`GrClo£
();

107 
	`exô
(0);

110 
	}
}

117 
	$do_buâ⁄down
(
GR_EVENT_BUTTON
 *
bp
)

119 
	`A˘i⁄Sèπ
(
w
, 
bp
->
x
, bp->
y
);

120 
	}
}

127 
	$do_buâ⁄up
(
GR_EVENT_BUTTON
 *
bp
)

129 
	`A˘i⁄End
(
w
, 
bp
->
x
, bp->
y
);

130 
	}
}

137 
	$do_mŸi⁄
(
GR_EVENT_MOUSE
 *
mp
)

139 
	`A˘i⁄Move
(
w
, 
mp
->
x
, mp->
y
);

140 
	}
}

147 
	$do_focusö
(
GR_EVENT_GENERAL
 *
gp
)

151 i‡(
gp
->
wid
 =
w
->
wö
 && gp->wid != 1)

152 
w
->
œ°focusid
 = 
gp
->
Ÿhîid
;

154 
	}
}

161 
	$do_exposuª
(
GR_EVENT_EXPOSURE
 *
ï
)

163 i‡(
ï
->
wid
 =
w
->
wö
)

164 
	`Redi•œy
(
w
);

165 
	}
}

172 
	$do_key°roke
(
GR_EVENT_KEYSTROKE
 *
kp
)

174 i‡(
bTextwö
)

175 
	`ch¨_out
(
kp
->
ch
);

176 
	}
}

179 
	$ch¨_dñ
(
GR_COORD
 
x
, GR_COORD 
y
)

181 
xpos
 -
width
;

182 
	`GrFûlRe˘
(
wt
, 
g˘b
, 
x
+1, 
y
 , 
width
, 
height
);

183 
	}
}

186 
	$ch¨_out
(
GR_CHAR
 
ch
)

188 
ch
) {

191 
xpos
 = 0;

192 
ypos
 +
height
;

193 if(
ypos
 >
TEXTWIN_HEIGHT
 - 
height
) {

194 
ypos
 -
height
;

198 
ypos
 = 0;

199 
	`GrCÀ¨Wödow
(
wt
, 
GR_FALSE
);

205 
xpos
 +
width
;

206 (
xpos
/
width
) & 7)

207 
	`ch¨_out
(' ');

210 i‡(
xpos
 <= 0)

212 
	`ch¨_dñ
(
xpos
, 
ypos
);

213 
	`ch¨_out
(' ');

214 
	`ch¨_dñ
(
xpos
, 
ypos
);

217 
	`GrText
(
wt
, 
g˘
, 
xpos
+1, 
ypos
, &
ch
, 1, 
GR_TFTOP
);

218 
xpos
 +
width
;

220 i‡(
xpos
 >
TEXTWIN_WIDTH
-
width
)

221 
	`ch¨_out
('\n');

222 
	}
}

	@demos/nxscribble/sc.c

24 
	~<°rög.h
>

25 
	~"bôve˘‹.h
"

26 
	~"m©rix.h
"

27 
	~"utû.h
"

28 
	~"sc.h
"

29 
	~"°dio.h
"

30 
	~"°dlib.h
"

31 
	~"m©h.h
"

32 
	~"zdebug.h
"

34 
	#EPS
 (1.0e-6Ë

	)

35 
sCœssifõr


36 
	$sNewCœssifõr
()

38 
sCœssifõr
 
sc
 = 
	`Æloˇã
(1, 
s˛assifõr
);

39 
sc
->
n„©uªs
 = -1;

40 
sc
->
n˛as£s
 = 0;

41 
sc
->
˛assd›e
 = 
	`Æloˇã
(
MAXSCLASSES
, 
sCœssD›e
);

42 
sc
->
w
 = 
NULL
;

43  
sc
;

44 
	}
}

47 
	$sFªeCœssifõr
(
sc
)

48 
sCœssifõr
 
sc
;

50 
i
;

51 
sCœssD›e
 
scd
;

53 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

54 
scd
 = 
sc
->
˛assd›e
[
i
];

55 if(
scd
->
«me
Ë
	`‰ì
(scd->name);

56 if(
scd
->
sumcov
Ë
	`FªeM©rix
(scd->sumcov);

57 if(
scd
->
avîage
Ë
	`FªeVe˘‹
(scd->average);

58 
	`‰ì
(
scd
);

59 if(
sc
->
w
 && sc->w[
i
]Ë
	`FªeVe˘‹
(sc->w[i]);

61 
	`‰ì
(
sc
->
˛assd›e
);

62 if(
sc
->
w
Ë
	`‰ì
(sc->w);

63 if(
sc
->
˙°
Ë
	`FªeVe˘‹
(sc->cnst);

64 if(
sc
->
övavgcov
Ë
	`FªeM©rix
(sc->invavgcov);

65 
	`‰ì
(
sc
);

66 
	}
}

68 
sCœssD›e


69 
	$sCœssNameLookup
(
sc
, 
˛as¢ame
)

70 
sCœssifõr
 
sc
;

71 *
˛as¢ame
;

73 
i
;

74 
sCœssD›e
 
scd
;

75 
sCœssifõr
 
œ°sc
 = 
NULL
;

76 
sCœssD›e
 
œ°scd
 = 
NULL
;

79 if(
œ°sc
 =
sc
 && 
œ°scd
 !
NULL
 && 
	`STREQ
÷a°scd->
«me
, 
˛as¢ame
))

80  
œ°scd
;

83 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

84 
scd
 = 
sc
->
˛assd›e
[
i
];

85 if(
	`STREQ
(
scd
->
«me
, 
˛as¢ame
))

86  
œ°sc
 = 
sc
, 
œ°scd
 = 
scd
;

88 
œ°sc
 = 
NULL
;

89 
œ°scd
 = 
NULL
;

90  
NULL
;

91 
	}
}

93 
sCœssD›e


94 
	$sAddCœss
(
sc
, 
˛as¢ame
)

95 
sCœssifõr
 
sc
;

96 *
˛as¢ame
;

98 
sCœssD›e
 
scd
;

100 
sc
->
˛assd›e
[sc->
n˛as£s
] = 
scd
 = 
	`Æloˇã
(1, 
s˛assd›e
);

101 
scd
->
«me
 = 
	`sc›y
(
˛as¢ame
);

102 
scd
->
numbî
 = 
sc
->
n˛as£s
;

103 
scd
->
√xam∂es
 = 0;

104 
scd
->
sumcov
 = 
NULL
;

105 ++
sc
->
n˛as£s
;

106  
scd
;

107 
	}
}

110 
	$sAddExam∂e
(
sc
, 
˛as¢ame
, 
y
)

111 
sCœssifõr
 
sc
;

112 *
˛as¢ame
;

113 
Ve˘‹
 
y
;

115 
sCœssD›e
 
scd
;

116 
i
, 
j
;

117 
nfv
[50];

118 
nm1⁄
, 
ªcùn
;

120 
scd
 = 
	`sCœssNameLookup
(
sc
, 
˛as¢ame
);

121 if(
scd
 =
NULL
) {

123 
scd
 = 
	`sAddCœss
(
sc
, 
˛as¢ame
);

126 if(
sc
->
n„©uªs
 == -1) {

127 
sc
->
n„©uªs
 = 
	`NROWS
(
y
);

131 if(
scd
->
√xam∂es
 == 0) {

133 
scd
->
avîage
 = 
	`NewVe˘‹
(
sc
->
n„©uªs
);

134 
	`ZîoVe˘‹
(
scd
->
avîage
);

135 
scd
->
sumcov
 = 
	`NewM©rix
(
sc
->
n„©uªs
, sc->nfeatures);

136 
	`ZîoM©rix
(
scd
->
sumcov
);

140 if(
sc
->
n„©uªs
 !
	`NROWS
(
y
)) {

141 
	`PrötVe˘‹
(
y
, "sAddExample: funny feature vectorÇrows!=%d",

142 
sc
->
n„©uªs
);

146 
scd
->
√xam∂es
++;

147 
nm1⁄
 = ((Ë
scd
->
√xam∂es
-1)/scd->nexamples;

148 
ªcùn
 = 1.0/
scd
->
√xam∂es
;

151 
i
 = 0; i < 
sc
->
n„©uªs
; i++)

152 
nfv
[
i
] = 
y
[i] - 
scd
->
avîage
[i];

155 
i
 = 0; i < 
sc
->
n„©uªs
; i++)

156 
j
 = 
i
; j < 
sc
->
n„©uªs
; j++)

157 
scd
->
sumcov
[
i
][
j
] +
nm1⁄
 * 
nfv
[i] *Çfv[j];

160 
i
 = 0; i < 
sc
->
n„©uªs
; i++)

161 
scd
->
avîage
[
i
] = 
nm1⁄
 * scd->avîage[i] + 
ªcùn
 * 
y
[i];

163 
	}
}

166 
	$sD⁄eAddög
(
sc
)

167 
sCœssifõr
 
sc
;

169 
i
, 
j
;

170 
c
;

171 
√
, 
díom
;

172 
⁄eovîdíom
;

173 
M©rix
 
s
;

174 
M©rix
 
avgcov
;

175 
dë
;

176 
sCœssD›e
 
scd
;

178 if(
sc
->
n˛as£s
 == 0) {

179 
	`îr‹
("No classes foráddingÅo classifier");

186 
avgcov
 = 
	`NewM©rix
(
sc
->
n„©uªs
, sc->nfeatures);

187 
	`ZîoM©rix
(
avgcov
);

188 
√
 = 0;

189 
c
 = 0; c < 
sc
->
n˛as£s
; c++) {

190 
scd
 = 
sc
->
˛assd›e
[
c
];

191 
√
 +
scd
->
√xam∂es
;

192 
s
 = 
scd
->
sumcov
;

193 
i
 = 0; i < 
sc
->
n„©uªs
; i++)

194 
j
 = 
i
; j < 
sc
->
n„©uªs
; j++)

195 
avgcov
[
i
][
j
] +
s
[i][j];

198 
díom
 = 
√
 - 
sc
->
n˛as£s
;

199 if(
díom
 <= 0) {

200 
	`îr‹
("Number of classes must beÜessÅhanÇumber ofÉxamples");

204 
⁄eovîdíom
 = 1.0 / 
díom
;

205 
i
 = 0; i < 
sc
->
n„©uªs
; i++)

206 
j
 = 
i
; j < 
sc
->
n„©uªs
; j++)

207 
avgcov
[
j
][
i
] =ávgcov[i][j] *
⁄eovîdíom
;

209 
	`Z
('a'Ë
	`PrötM©rix
(
avgcov
, "Average Covariance Matrix\n");

212 
sc
->
övavgcov
 = 
	`NewM©rix
(sc->
n„©uªs
, sc->nfeatures);

213 
dë
 = 
	`InvîtM©rix
(
avgcov
, 
sc
->
övavgcov
);

214 if(
	`Ábs
(
dë
Ë<
EPS
)

215 
	`FixCœssifõr
(
sc
, 
avgcov
);

218 
sc
->
w
 = 
	`Æloˇã
(sc->
n˛as£s
, 
Ve˘‹
);

219 
sc
->
˙°
 = 
	`NewVe˘‹
(sc->
n˛as£s
);

220 
c
 = 0; c < 
sc
->
n˛as£s
; c++) {

221 
scd
 = 
sc
->
˛assd›e
[
c
];

222 
sc
->
w
[
c
] = 
	`NewVe˘‹
(sc->
n„©uªs
);

223 
	`Ve˘‹TimesM©rix
(
scd
->
avîage
, 
sc
->
övavgcov
, sc->
w
[
c
]);

224 
sc
->
˙°
[
c
] = -0.5 * 
	`I¬îProdu˘
(sc->
w
[c], 
scd
->
avîage
);

228 
	`FªeM©rix
(
avgcov
);

230 
	}
}

232 
sCœssD›e


233 
	$sCœssify
(
sc
, 
fv
) {

234  
	`sCœssifyAD
(
sc
, 
fv
, 
NULL
, NULL);

235 
	}
}

237 
sCœssD›e


238 
	$sCœssifyAD
(
sc
, 
fv
, 
≠
, 
dp
)

239 
sCœssifõr
 
sc
;

240 
Ve˘‹
 
fv
;

241 *
≠
;

242 *
dp
;

244 
disc
[
MAXSCLASSES
];

245 
i
, 
max˛ass
;

246 
díom
, 
	`exp
();

247 
sCœssD›e
 
scd
;

248 
d
;

250 if(
sc
->
w
 =
NULL
) {

251 
	`îr‹
("%xÇŸáÅøöed cœssifõr", 
sc
);

252 (
NULL
);

255 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

257 
IP
;

258 
IP
 = 
	`I¬îProdu˘
(
sc
->
w
[
i
], 
fv
);

261 
disc
[
i
] = 
IP
 + 
sc
->
˙°
[i];

267 
max˛ass
 = 0;

268 
i
 = 1; i < 
sc
->
n˛as£s
; i++)

269 if(
disc
[
i
] > disc[
max˛ass
])

270 
max˛ass
 = 
i
;

307 
	`ZZ
('C') {

308 
scd
 = 
sc
->
˛assd›e
[
max˛ass
];

309 
	`PrötVe˘‹
(
fv
, "%10.10† ", 
scd
->
«me
);

310 
	`ZZZ
('C') {

311 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

312 
scd
 = 
sc
->
˛assd›e
[
i
];

313 
	`PrötVe˘‹
(
scd
->
avîage
, "%5.5s %5g ",

314 
scd
->
«me
, 
disc
[
i
]);

319 
scd
 = 
sc
->
˛assd›e
[
max˛ass
];

330 if(
≠
) {

331 
díom
 = 0, 
i
 = 0; i < 
sc
->
n˛as£s
; i++)

333 if((
d
 = 
disc
[
i
] - disc[
max˛ass
]) > -7.0)

334 
díom
 +
	`exp
(
d
);

335 *
≠
 = 1.0 / 
díom
;

338 if(
dp
)

339 *
dp
 = 
	`MahÆ™obisDi°™˚
(
fv
, 
scd
->
avîage
, 
sc
->
övavgcov
);

341  
scd
;

342 
	}
}

349 
	$MahÆ™obisDi°™˚
(
v
, 
u
, 
sigma
)

350 
Ve˘‹
 
v
, 
u
;

351 
M©rix
 
sigma
;

353 
i
;

354 
Ve˘‹
 
•a˚
;

355 
ªsu…
;

357 if(
•a˚
 =
NULL
 || 
	`NROWS
(•a˚Ë!NROWS(
v
)) {

358 if(
•a˚
Ë
	`FªeVe˘‹
(space);

359 
•a˚
 = 
	`NewVe˘‹
(
	`NROWS
(
v
));

361 
i
 = 0; i < 
	`NROWS
(
v
); i++)

362 
•a˚
[
i
] = 
v
[i] - 
u
[i];

363 
ªsu…
 = 
	`QuadøticF‹m
(
•a˚
, 
sigma
);

364  
ªsu…
;

365 
	}
}

368 
	$FixCœssifõr
(
sc
, 
avgcov
)

369 
sCœssifõr
 
sc
;

370 
M©rix
 
avgcov
;

372 
i
;

373 
dë
;

374 
BôVe˘‹
 
bv
;

375 
M©rix
 
m
, 
r
;

380 
	`CLEAR_BIT_VECTOR
(
bv
);

381 
i
 = 0; i < 
sc
->
n„©uªs
; i++) {

382 
	`BIT_SET
(
i
, 
bv
);

383 
m
 = 
	`Sli˚M©rix
(
avgcov
, 
bv
, bv);

384 
r
 = 
	`NewM©rix
(
	`NROWS
(
m
), 
	`NCOLS
(m));

385 
dë
 = 
	`InvîtM©rix
(
m
, 
r
);

386 if(
	`Ábs
(
dë
Ë<
EPS
)

387 
	`BIT_CLEAR
(
i
, 
bv
);

388 
	`FªeM©rix
(
m
);

389 
	`FªeM©rix
(
r
);

392 
m
 = 
	`Sli˚M©rix
(
avgcov
, 
bv
, bv);

393 
r
 = 
	`NewM©rix
(
	`NROWS
(
m
), 
	`NCOLS
(m));

394 
dë
 = 
	`InvîtM©rix
(
m
, 
r
);

395 if(
	`Ábs
(
dë
Ë<
EPS
) {

396 
	`îr‹
("Can't fix classifier!");

399 
	`DeSli˚M©rix
(
r
, 0.0, 
bv
, bv, 
sc
->
övavgcov
);

401 
	`FªeM©rix
(
m
);

402 
	`FªeM©rix
(
r
);

404 
	}
}

407 
	$sDumpCœssifõr
(
sc
)

408 
sCœssifõr
 
sc
;

410 
sCœssIndex
 
c
;

412 
	`¥ötf
("\n----Cœssifõ∏%x, %d fótuªs:-----\n", ()
sc
, sc->
n„©uªs
);

413 
	`¥ötf
("%d cœs£s: ", 
sc
->
n˛as£s
);

414 
c
 = 0; c < 
sc
->
n˛as£s
; c++)

415 
	`¥ötf
("%† ", 
sc
->
˛assd›e
[
c
]->
«me
);

416 
	`¥ötf
("Discrimination functions:\n");

417 
c
 = 0; c < 
sc
->
n˛as£s
; c++) {

418 
	`PrötVe˘‹
(
sc
->
w
[
c
], "%s: %g + ", sc->
˛assd›e
[c]->
«me
, sc->
˙°
[c]);

419 
	`¥ötf
("Mean vectors:\n");

420 
	`PrötVe˘‹
(
sc
->
˛assd›e
[
c
]->
avîage
, "%s: ", sc->˛assd›e[c]->
«me
);

422 if–
sc
->
övavgcov
 !
NULL
 ) {

423 
	`PrötM©rix
(
sc
->
övavgcov
, "Inverseáverage covariance matrix:\n");

425 
	`¥ötf
("\n---------\n\n");

426 
	}
}

429 
	$sWrôe
(
outfûe
, 
sc
)

430 
FILE
 *
outfûe
;

431 
sCœssifõr
 
sc
;

433 
i
;

434 
sCœssD›e
 
scd
;

436 
	`Ârötf
(
outfûe
, "%d cœs£s\n", 
sc
->
n˛as£s
);

437 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

438 
scd
 = 
sc
->
˛assd›e
[
i
];

439 
	`Ârötf
(
outfûe
, "%s\n", 
scd
->
«me
);

441 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

442 
scd
 = 
sc
->
˛assd›e
[
i
];

443 
	`OuçutVe˘‹
(
outfûe
, 
scd
->
avîage
);

444 
	`OuçutM©rix
(
outfûe
, 
scd
->
sumcov
);

445 
	`OuçutVe˘‹
(
outfûe
, 
sc
->
w
[
i
]);

447 
	`OuçutVe˘‹
(
outfûe
, 
sc
->
˙°
);

448 
	`OuçutM©rix
(
outfûe
, 
sc
->
övavgcov
);

449 
	}
}

451 
sCœssifõr


452 
	$sRód
(
öfûe
)

453 
FILE
 *
öfûe
;

455 
i
, 
n
;

456 
sCœssifõr
 
sc
;

457 
sCœssD›e
 
scd
;

458 
buf
[100];

461 
	`Z
('a'Ë
	`¥ötf
("Reading classifier \n");

462 
sc
 = 
	`sNewCœssifõr
();

463 
	`fgës
(
buf
, 100, 
öfûe
);

464 if(
	`ssˇnf
(
buf
, "%d", &
n
) != 1) {

465 
	`îr‹
("InputÉrror in classifier file");

466 
	`sFªeCœssifõr
(
sc
);

467 (
NULL
);

469 
	`Z
('a'Ë
	`¥ötf
(" %d cœs£†\n", 
n
);

470 
i
 = 0; i < 
n
; i++) {

471 
	`fsˇnf
(
öfûe
, "%s", 
buf
);

472 
scd
 = 
	`sAddCœss
(
sc
, 
buf
);

473 
	`Z
('a'Ë
	`¥ötf
(" %†\n", 
scd
->
«me
);

475 
sc
->
w
 = 
	`Æloˇã
(sc->
n˛as£s
, 
Ve˘‹
);

476 
i
 = 0; i < 
sc
->
n˛as£s
; i++) {

477 
scd
 = 
sc
->
˛assd›e
[
i
];

478 
scd
->
avîage
 = 
	`I≈utVe˘‹
(
öfûe
);

479 
scd
->
sumcov
 = 
	`I≈utM©rix
(
öfûe
);

480 
sc
->
w
[
i
] = 
	`I≈utVe˘‹
(
öfûe
);

482 
sc
->
˙°
 = 
	`I≈utVe˘‹
(
öfûe
);

483 
sc
->
övavgcov
 = 
	`I≈utM©rix
(
öfûe
);

484 
	`Z
('a'Ë
	`¥ötf
("\n");

485  
sc
;

486 
	}
}

490 
	$sDi°™˚s
(
sc
, 
n˛o£°
)

491 
sCœssifõr
 
sc
;

493 
M©rix
 
d
 = 
	`NewM©rix
(
sc
->
n˛as£s
, sc->nclasses);

494 
i
, 
j
;

495 
mö
, 
max
 = 0;

496 
n
, 
mi
, 
mj
;

498 
	`¥ötf
("-----------\n");

499 
	`¥ötf
("Computög %d clo£°Öaú†o‡˛as£s\n", 
n˛o£°
);

500 
i
 = 0; i < 
	`NROWS
(
d
); i++) {

501 
j
 = 
i
+1; j < 
	`NCOLS
(
d
); j++) {

502 
d
[
i
][
j
] = 
	`MahÆ™obisDi°™˚
(

503 
sc
->
˛assd›e
[
i
]->
avîage
,

504 
sc
->
˛assd›e
[
j
]->
avîage
,

505 
sc
->
övavgcov
);

506 if(
d
[
i
][
j
] > 
max
) max = d[i][j];

510 
n
 = 1;Ç <
n˛o£°
;Ç++) {

511 
mö
 = 
max
;

512 
mi
 = 
mj
 = -1;

513 
i
 = 0; i < 
	`NROWS
(
d
); i++) {

514 
j
 = 
i
+1; j < 
	`NCOLS
(
d
); j++) {

515 if(
d
[
i
][
j
] < 
mö
)

516 
mö
 = 
d
[
mi
=
i
][
mj
=
j
];

519 if(
mi
 == -1)

522 
	`¥ötf
("%2d) %10.10sÅo %10.10s d=%gÇstd=%g\n",

523 
n
,

524 
sc
->
˛assd›e
[
mi
]->
«me
,

525 
sc
->
˛assd›e
[
mj
]->
«me
,

526 
d
[
mi
][
mj
],

527 
	`sqπ
(
d
[
mi
][
mj
]));

529 
d
[
mi
][
mj
] = 
max
+1;

531 
	`¥ötf
("-----------\n");

532 
	`FªeM©rix
(
d
);

533 
	}
}

	@demos/nxscribble/sc.h

29 #i‚de‡
_SC_H_


31 
	#_SC_H_


	)

33 
	#MAXSCLASSES
 100

	)

35 
s˛assifõr
 *
	tsCœssifõr
;

36 
	tsCœssIndex
;

37 
s˛assd›e
 *
	tsCœssD›e
;

39 
	ss˛assd›e
 {

40 *
	m«me
;

41 
sCœssIndex
 
	mnumbî
;

42 
Ve˘‹
 
	mavîage
;

43 
M©rix
 
	msumcov
;

44 
	m√xam∂es
;

47 
	ss˛assifõr
 {

48 
	mn„©uªs
;

49 
	mn˛as£s
;

50 
sCœssD›e
 *
	m˛assd›e
;

52 
Ve˘‹
 
	m˙°
;

53 
Ve˘‹
 *
	mw
;

54 
M©rix
 
	mövavgcov
;

57 
sCœssifõr
 
sNewCœssifõr
();

58 
sCœssifõr
 
sRód
();

59 
sWrôe
();

60 
sFªeCœssifõr
();

61 
sAddExam∂e
();

62 
sRemoveExam∂e
();

63 
sD⁄eAddög
();

64 
sCœssD›e
 
sCœssify
();

65 
sCœssD›e
 
sCœssifyAD
();

66 
sCœssD›e
 
sCœssNameLookup
();

67 
MahÆ™obisDi°™˚
();

68 
FixCœssifõr
();

69 
sDumpCœssifõr
();

70 
sDi°™˚s
();

	@demos/nxscribble/scrib.h

25 
	#MWINCLUDECOLORS


	)

26 
	~"«no-X.h
"

27 
	~"hª_≠i.h
"

28 
	~"li_ªcognizî.h
"

30 
	#CS_LETTERS
 0

	)

31 
	#CS_DIGITS
 1

	)

32 
	#CS_PUNCTUATION
 2

	)

34 
	#NUM_RECS
 3

	)

35 
	#DEFAULT_REC_DIR
 "˛assifõrs"

	)

36 #i‚de‡
REC_DEFAULT_USER_DIR


37 
	#REC_DEFAULT_USER_DIR
 "bö"

	)

41 
	#DEFAULT_LETTERS_FILE
 "Àâîs.˛"

	)

42 
	#DEFAULT_DIGITS_FILE
 "digôs.˛"

	)

43 
	#DEFAULT_PUNC_FILE
 "punc.˛"

	)

44 
	#ªc_«me
 "libli_ªcog.so"

	)

46 
	sgøffôi
 {

47 
ªcognizî
 
	mªc
[3];

49 
	m˛dú
[200];

51 
li_ªcognizî_åaö
 
	mªc_åaö
;

52 
li_ªcognizî_gëCœs£s
 
	mªc_gëCœs£s
;

60 
GR_WINDOW_ID
 
	mwö
;

61 
GR_GC_ID
 
	mgc
;

62 
GR_BOOL
 
	mdown
;

64 
GR_POINT
 *
	m±
;

65 
	mµasize
;

66 
≥n_°roke
 
	mps
;

67 
gøffôi
 
	mgøf
;

68 
	mˇpsLock
;

69 
	mpuncShi·
;

70 
	mtmpShi·
;

71 
	m˘æShi·
;

72 
	mcurCh¨Së
;

73 
	mœ°ch¨
;

74 } 
	tS¸ibbÀRec
, *
	tS¸ibbÀWidgë
;

76 
S¸ibbÀWidgë
 
¸óã_s¸ibbÀ
();

77 
de°roy_s¸ibbÀ
(
S¸ibbÀWidgë
 
w
);

78 
A˘i⁄Sèπ
(
S¸ibbÀWidgë
 
w
, 
x
, 
y
);

79 
A˘i⁄Move
(
S¸ibbÀWidgë
 
w
, 
x
, 
y
);

80 
A˘i⁄End
(
S¸ibbÀWidgë
 
w
, 
x
, 
y
);

81 
Redi•œy
 (
S¸ibbÀWidgë
 
w
);

	@demos/nxscribble/scribwidget.c

28 
	~<°dio.h
>

29 
	~<°rög.h
>

30 
	~"s¸ib.h
"

32 
S¸ibbÀRec
 
	gs¸ib
;

33 *
	gcurmsg
 = 
NULL
;

35 *
	g˛_«me
[3] = {
DEFAULT_LETTERS_FILE
,

36 
DEFAULT_DIGITS_FILE
,

37 
DEFAULT_PUNC_FILE
};

39 
gøffôi_lﬂd_ªcognizîs
(
gøffôi
 *
pg
);

40 
Recognize
 (
S¸ibbÀWidgë
 
w
);

41 
ShowMode
 (
S¸ibbÀWidgë
 
w
);

44 
	$Re£tSåoke
 (
S¸ibbÀWidgë
 
w
)

46 
w
->
ps
.
ps_≈ts
 = 0;

47 
w
->
ps
.
ps_n°©e
 = 0;

48 
w
->
ps
.
ps_å™s
 = 0;

49 
w
->
ps
.
ps_°©e
 = 0;

50 
w
->
œ°ch¨
 = 0;

51 
curmsg
 = 
NULL
;

52 
	`ShowMode
(
w
);

53 
	}
}

64 
	$Di•œyLa°
 (
S¸ibbÀWidgë
 
w
)

66 
≈t
;

68 
≈t
 = 
w
->
ps
.
ps_≈ts
;

69 i‡(
≈t
 > 2)

70 
≈t
 = 2;

71 
	`GrDøwLöes
(
w
->
wö
, w->
gc
, w->
±
 + (w->
ps
.
ps_≈ts
 - 
≈t
),Çpt);

72 
	}
}

75 
	$AddPoöt
 (
S¸ibbÀWidgë
 
w
, 
x
, 
y
)

77 
≥n_poöt
 *
µa
;

78 
GR_POINT
 *
±
;

79 
µasize
;

81 i‡(
w
->
ps
.
ps_≈ts
 =w->
µasize
)

83 
µasize
 = 
w
->ppasize + 100;

84 
µa
 = 
	`mÆloc
 (( (
≥n_poöt
Ë+  (
GR_POINT
)Ë* 
µasize
);

85 i‡(!
µa
)

87 
±
 = (
GR_POINT
 *Ë(
µa
 + 
µasize
);

88 
	`mem˝y
 (
µa
, 
w
->
ps
.
ps_±s
, w->
µasize
 *  (
≥n_poöt
));

89 
	`mem˝y
 (
±
, 
w
->±, w->
µasize
 *  (
GR_POINT
));

90 
	`‰ì
 (
w
->
ps
.
ps_±s
);

91 
w
->
ps
.
ps_±s
 = 
µa
;

92 
w
->
±
 =Öt;

93 
w
->
µasize
 =Öpasize;

95 
µa
 = &
w
->
ps
.
ps_±s
[w->ps.
ps_≈ts
];

96 
µa
->
x
 = x;

97 
µa
->
y
 = y;

99 
±
 = &
w
->±[w->
ps
.
ps_≈ts
];

100 
±
->
x
 = x;

101 
±
->
y
 = y;

103 
w
->
ps
.
ps_≈ts
++;

105 
	`Di•œyLa°
 (
w
);

106 
	}
}

108 
S¸ibbÀWidgë


109 
	$¸óã_s¸ibbÀ
()

111 
S¸ibbÀWidgë
 
√w
 = (S¸ibbÀWidgë)&
s¸ib
;

112 
GR_WM_PROPERTIES
 
¥›s
;

114 
√w
->
ˇpsLock
 = 0;

115 
√w
->
puncShi·
 = 0;

116 
√w
->
tmpShi·
 = 0;

117 
√w
->
˘æShi·
 = 0;

118 
√w
->
curCh¨Së
 = 
CS_LETTERS
;

119 
√w
->
œ°ch¨
 = 0;

120 
√w
->
down
 = 
GR_FALSE
;

123 
	`gøffôi_lﬂd_ªcognizîs
 (&
√w
->
gøf
);

125 
√w
->
µasize
 = 0;

126 
√w
->
ps
.
ps_±s
 = 0;

127 
√w
->
±
 = 0;

129 
√w
->
wö
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
,

131 0, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
), 
BLACK
);

133 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
 | 
GR_WM_FLAGS_PROPS
;

134 
¥›s
.¥›†
GR_WM_PROPS_NOFOCUS
 | 
GR_WM_PROPS_BORDER
 |

135 
GR_WM_PROPS_CAPTION
 | 
GR_WM_PROPS_CLOSEBOX
;

136 
¥›s
.
tôÀ
 = "nxScribble";

137 
	`GrSëWMPr›îtõs
(
√w
->
wö
, &
¥›s
);

139 
	`GrSñe˘Evíts
(
√w
->
wö
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

140 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_MOUSE_MOTION
 |

141 
GR_EVENT_MASK_KEY_DOWN
 |

142 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_CLOSE_REQ
);

143 
	`GrM≠Wödow
(
√w
->
wö
);

145 
√w
->
gc
 = 
	`GrNewGC
();

146 
	`GrSëGCF‹eground
(
√w
->
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPTEXT
));

147 
	`GrSëGCBackground
(
√w
->
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

148 
	`GrSëGCF⁄t
(
√w
->
gc
, 
	`GrCª©eF⁄t
(
GR_FONT_SYSTEM_FIXED
, 0, 
NULL
));

150 
	`Re£tSåoke
 (
√w
);

151  
√w
;

152 
	}
}

155 
	$de°roy_s¸ibbÀ
(
S¸ibbÀWidgë
 
w
)

157 
	`GrDe°royWödow
(
w
->
wö
);

158 
	`GrDe°royGC
(
w
->
gc
);

159 
	`‰ì
 (
w
->
ps
.
ps_±s
);

160 
	}
}

163 
	$Redi•œy
 (
S¸ibbÀWidgë
 
w
)

166 
	`ShowMode
(
w
);

167 
	}
}

170 
	$A˘i⁄Sèπ
 (
S¸ibbÀWidgë
 
w
, 
x
, 
y
)

172 
	`GrRai£Wödow
(
w
->
wö
);

173 
	`Re£tSåoke
 (
w
);

174 
w
->
down
 = 
GR_TRUE
;

175 
	`AddPoöt
 (
w
, 
x
, 
y
);

176 
	}
}

179 
	$A˘i⁄Move
 (
S¸ibbÀWidgë
 
w
, 
x
, 
y
)

181 i‡(
w
->
down
)

182 
	`AddPoöt
 (
w
, 
x
, 
y
);

183 
	}
}

186 
	$A˘i⁄End
 (
S¸ibbÀWidgë
 
w
, 
x
, 
y
)

188 
	`AddPoöt
 (
w
, 
x
, 
y
);

189 
w
->
down
 = 
GR_FALSE
;

190 
	`Recognize
 (
w
);

191 
	}
}

195 
	$SídKey
(
S¸ibbÀWidgë
 
w
, 
ch
)

197 
GR_WINDOW_ID
 
wö
 = 
	`GrGëFocus
();

200 
	`GrInje˘KeybﬂrdEvít
(
wö
, 
ch
, 0, 0, 1);

201 
	`GrInje˘KeybﬂrdEvít
(
wö
, 
ch
, 0, 0, 0);

202 
	}
}

214 
	$gøffôi_lﬂd_ªcognizîs
(
gøffôi
 *
pg
)

216 
boﬁ
 
usögDeÁu…
;

218 * 
homedú
;

220 
i
;

221 
ªc_‚
 *
‚s
;

225 
i
 = 0; i < 
NUM_RECS
; i++) {

227 
pg
->
ªc
[
i
] = 
	`ªcognizî_lﬂd
(
DEFAULT_REC_DIR
, 
ªc_«me
, 
NULL
);

228 i‡(
pg
->
ªc
[
i
] =
NULL
) {

229 
	`Ârötf
(
°dîr
,"Eº‹ÜﬂdögÑecognizî from %s.", 
DEFAULT_REC_DIR
);

232 i‡((* (*)(
pg
->
ªc
[
i
])) != 0xfeed) {

233 
	`Ârötf
(
°dîr
,"Error inÑecognizer_magic.");

240 i‡–(
homedú
 = (*)
	`gëív
("HOME")Ë=
NULL
 ) {

242 
	`°r˝y
(
pg
->
˛dú
, 
REC_DEFAULT_USER_DIR
);

243 
usögDeÁu…
 = 
åue
;

246 
	`°r˝y
(
pg
->
˛dú
, 
homedú
);

247 
	`°rˇt
(
pg
->
˛dú
, "/");

248 
	`°rˇt
(
pg
->
˛dú
, 
CLASSIFIER_DIR
);

249 
usögDeÁu…
 = 
Ál£
;

254 
i
 = 0; i < 
NUM_RECS
; i++) {

255 
ªc_ªtu∫
;

256 *
s
;

258 
ªc_ªtu∫
 = 
	`ªcognizî_lﬂd_°©e
(
pg
->
ªc
[
i
],Ög->
˛dú
, 
˛_«me
[i]);

259 i‡((
ªc_ªtu∫
 =-1Ë&& (
usögDeÁu…
 =
Ál£
)) {

260 
	`Ârötf
(
°dîr
,

262 
pg
->
˛dú
, 
˛_«me
[
i
],

263 (
s
 = 
	`ªcognizî_îr‹
(
pg
->
ªc
[
i
])) ? s : "(none)");

264 
ªc_ªtu∫
 = 
	`ªcognizî_lﬂd_°©e
(
pg
->
ªc
[
i
],

265 
REC_DEFAULT_USER_DIR
, 
˛_«me
[
i
]);

267 i‡(
ªc_ªtu∫
 == -1) {

268 
	`Ârötf
(
°dîr
, "UnableÅoÜoad default classifier file %s.\nOriginalÉrror: %s\n",

269 
˛_«me
[
i
],

270 (
s
 = 
	`ªcognizî_îr‹
(
pg
->
ªc
[
i
])) ? s : "(none)");

277 
‚s
 = 
	`ªcognizî_gë_exãnsi⁄_fun˘i⁄s
(
pg
->
ªc
[
CS_LETTERS
]);

278 i‡(
‚s
 =
NULL
) {

279 
	`Ârötf
(
°dîr
, "LI Recognizer Training:NoÉxtension functions!");

284 if–(
pg
->
ªc_åaö
 = (
li_ªcognizî_åaö
)
‚s
[
LI_TRAIN
]Ë=
NULL
 ) {

285 
	`Ârötf
(
°dîr
,

287 i‡(
‚s
 !
NULL
) {

288 
	`‰ì
(
‚s
);

293 if–(
pg
->
ªc_gëCœs£s
 = (
li_ªcognizî_gëCœs£s
)
‚s
[
LI_GET_CLASSES
]Ë=
NULL
 ) {

294 
	`Ârötf
(
°dîr
,

296 i‡(
‚s
 !
NULL
) {

297 
	`‰ì
(
‚s
);

301 
	`‰ì
(
‚s
);

303 
	}
}

306 
	$msg
(*
°r
)

308 
curmsg
 = 
°r
;

309 
	}
}

312 
	$ShowMode
 (
S¸ibbÀWidgë
 
w
)

314 *
mode
;

315 
buf
[32];

317 i‡(
w
->
˘æShi·
)

318 
mode
 = "^C";

319 i‡(
w
->
puncShi·
)

320 
mode
 = "#&^";

321 i‡(
w
->
curCh¨Së
 =
CS_DIGITS
)

322 
mode
 = "123";

323 i‡(
w
->
ˇpsLock
)

324 
mode
 = "ABC";

325 i‡(
w
->
tmpShi·
)

326 
mode
 = "Abc";

328 
mode
 = "abc";

330 i‡(
curmsg
)

331 
	`•rötf
(
buf
, "%† %s", 
mode
, 
curmsg
);

332 i‡(
w
->
œ°ch¨
 > ' ')

333 
	`•rötf
(
buf
, "%† %c", 
mode
, 
w
->
œ°ch¨
);

334 
	`•rötf
(
buf
, "%s", 
mode
);

335 
	`GrCÀ¨Wödow
(
w
->
wö
, 
GR_FALSE
);

336 
	`GrText
(
w
->
wö
, w->
gc
, 70, 0, 
buf
, 
	`°æí
(buf), 
GR_TFTOP
);

337 
	}
}

340 
	$do_ªcognize
(
gøffôi
 *
pg
, 
≥n_°roke
 *
ps
, 
ch¨£t
)

342 
ªc_ch¨
;

343 
ƒë
;

344 
ªc_Æã∫©ive
 *
ªt
;

346 
ªc_ch¨
 = 
	`ªcognizî_å™¶©e
(
pg
->
ªc
[
ch¨£t
], 1, 
ps
, 
Ál£
,

347 &
ƒë
, &
ªt
);

348 i‡(
ªc_ch¨
 != -1) {

349 
	`dñëe_ªc_Æã∫©ive_¨øy
(
ƒë
, 
ªt
, 
Ál£
);

351  
ªc_ch¨
;

352 
	}
}

354 
	tKeySym
;

357 
	$Recognize
 (
S¸ibbÀWidgë
 
w
)

359 
gøffôi
 *
gøf
 = &
w
->graf;

360 
≥n_°roke
 *
ps
 = &
w
->ps;

361 
KeySym
 
keysym
;

362 
GR_BOOL
 
c⁄åﬁ
;

363 
c
;

365 i‡(
ps
->
ps_≈ts
 == 0)

368 
w
->
œ°ch¨
 = 0;

370 
c
 = 
	`do_ªcognize
(
gøf
, 
ps
, 
w
->
puncShi·
 ? 
CS_PUNCTUATION
 : w->
curCh¨Së
);

374 
c
) {

376 
	`msg
("[Error]");

377 
w
->
tmpShi·
 = 0;

378 
w
->
puncShi·
 = 0;

379 
w
->
˘æShi·
 = 0;

380 
	`ShowMode
 (
w
);

383 
	`msg
("[Capslock]");

384 
w
->
ˇpsLock
 = !w->capsLock;

385 
	`ShowMode
 (
w
);

388 i‡(
w
->
curCh¨Së
 =
CS_DIGITS
) {

389 
w
->
curCh¨Së
 = 
CS_LETTERS
;

390 
	`msg
("[Letters]");

392 
w
->
curCh¨Së
 = 
CS_DIGITS
;

393 
	`msg
("[Digits]");

395 
w
->
tmpShi·
 = 0;

396 
w
->
puncShi·
 = 0;

397 
w
->
˘æShi·
 = 0;

398 
	`ShowMode
 (
w
);

401 
	`msg
("[Ctrlshift]");

402 
w
->
˘æShi·
 = !w->ctrlShift;

403 
w
->
tmpShi·
 = 0;

404 
w
->
puncShi·
 = 0;

405 
	`ShowMode
 (
w
);

408 
w
->
tmpShi·
 = !w->tmpShift;

409 i‡(
w
->
tmpShi·
Ë
	`msg
("[Shift]"); msg("[Unshift]");

410 
w
->
puncShi·
 = 0;

411 
w
->
˘æShi·
 = 0;

412 
	`ShowMode
 (
w
);

415 
c⁄åﬁ
 = 
GR_FALSE
;

416 
c
) {

418 
	`msg
("[Space]");

419 
keysym
 = ' ';

422 
	`msg
("[Backspace]");

423 
keysym
 = '\b';

426 
	`msg
("[Return]");

427 
keysym
 = '\r';

430 i‡(! 
w
->
puncShi·
) {

431 
	`msg
("[Puncshift]");

432 
w
->
puncShi·
 = 1;

433 
w
->
˘æShi·
 = 0;

434 
w
->
tmpShi·
 = 0;

435 
	`ShowMode
 (
w
);

438 
w
->
puncShi·
 = 0;

439 
	`ShowMode
 (
w
);

441 
keysym
 = '.';

444 i‡('A' <
c
 && c <= 'Z') {

445 
	`msg
("[Notimp]");

446 
	`ShowMode
 (
w
);

449 
keysym
 = (
KeySym
Ë
c
;

450 i‡(
w
->
˘æShi·
)

452 
c⁄åﬁ
 = 
GR_TRUE
;

453 
w
->
˘æShi·
 = 0;

454 i‡(
c
 < 'a' || 'z' < c)

456 
	`ShowMode
 (
w
);

460 i‡((
w
->
ˇpsLock
 && !w->
tmpShi·
) ||

461 (!
w
->
ˇpsLock
 && w->
tmpShi·
))

463 
keysym
 = keysym-'a'+'A';

465 
w
->
tmpShi·
 = 0;

466 
w
->
puncShi·
 = 0;

467 
	`ShowMode
(
w
);

470 i‡(
c⁄åﬁ
)

471 
keysym
 &= 0x1f;

472 
w
->
œ°ch¨
 = 
keysym
;

473 
	`ShowMode
(
w
);

474 
	`SídKey
(
w
, 
keysym
);

477 
	}
}

	@demos/nxscribble/util.c

19 
	~"utû.h
"

20 
	~<°dio.h
>

21 
	~<˘y≥.h
>

22 
	~<£tjmp.h
>

23 
	~<°rög.h
>

26 * 
li_îr_msg
;

27 
	gîr_msg
[
BUFSIZ
];

34 
	$myÆloc
(
nôems
, 
ôemsize
, 
ty≥«me
)

35 *
ty≥«me
;

37 
byãs
 = 
nôems
 * 
ôemsize
;

38 *
p
 = 
	`mÆloc
(
byãs
);

39 if(
p
 =
NULL
)

40 
	`îr‹
("Can't get mem for %d %s's (each %d bytes, %dÅotal bytes)",

41 
nôems
, 
ty≥«me
, 
ôemsize
, 
byãs
);

42  
p
;

43 
	}
}

50 
	$sc›y
(
s
)

51 *
s
;

53 *
p
 = 
	`Æloˇã
(
	`°æí
(
s
) + 1, );

54 (Ë
	`°r˝y
(
p
, 
s
);

55  
p
;

56 
	}
}

64 
	$îr‹
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
, 
j
)

65 *
a
;

67 
	`•rötf
(
îr_msg
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
, 
j
);

68 
li_îr_msg
 = 
îr_msg
;

69 
	}
}

78 
	$exô_îr‹
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
, 
j
)

79 *
a
;

81 
	`Ârötf
(
°dîr
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
, 
h
, 
i
, 
j
);

82 
	`exô
(1);

83 
	}
}

90 
	gDebugFœg
 = 1;

93 
	$debug
(
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
)

94 *
a
;

96 if(
DebugFœg
)

97 
	`Ârötf
(
°dîr
, 
a
, 
b
, 
c
, 
d
, 
e
, 
f
, 
g
);

98 
	}
}

100 
	#uµî
(
c
Ë(
	`i¶owî
(cË? 
	`touµî
(cË: (c))

	)

103 
	$uc°rcmp
(
s1
, 
s2
)

104 *
s1
, *
s2
;

106 
i
;

108 ; *
s1
 && *
s2
; s1++, s2++)

109 if–(
i
 = (
	`uµî
(*
s1
Ë- uµî(*
s2
))) != 0)

110  
i
;

111  (
	`uµî
(*
s1
Ë- uµî(*
s2
));

112 
	}
}

114 
	#NSTRINGS
 3

	)

117 
	$ãmp°rög
()

119 
°rögs
[
NSTRINGS
][100];

120 
ödex
;

121 if(
ödex
 >
NSTRINGS
) index = 0;

122  
°rögs
[
ödex
++];

123 
	}
}

	@demos/nxscribble/util.h

30 
	#Æloˇã
(
n
, 
ty≥
) \

31 ((
ty≥
 *Ë
	`myÆloc
(
n
, —y≥), "ty≥"))

	)

37 
	#STREQ
(
a
,
b
Ë–! 
	`°rcmp
◊,bË)

	)

39 *
myÆloc
();

40 *
sc›y
();

41 
debug
();

43 
îr‹
();

44 
exô_îr‹
();

45 
uc°rcmp
();

46 *
ãmp°rög
();

53 #ifde‡
unix


54 
	#GRAPHICS


	)

57 #i‚de‡
unix


61 #ifde‡
__ECOS


62 *
°rdup
(*);

64 #i‚de‡
PSP


65 
	#bc›y
 
movmem


	)

68 
	#ödex
 
°rchr


	)

69 
	#rödex
 
°ºchr


	)

	@demos/nxscribble/zdebug.h

13 
_zdebug_Êag
[];

15 
	#Z
(
f
Ëif(
_zdebug_Êag
[f] > 0)

	)

16 
	#ZZ
(
f
Ëif(
_zdebug_Êag
[f] >2)

	)

17 
	#ZZZ
(
f
Ëif(
_zdebug_Êag
[f] >3)

	)

18 
	#ZZZZ
(
f
Ëif(
_zdebug_Êag
[f] >4)

	)

20 
kludge
[];

	@demos/test/test.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

9 #i‚de‡
__PACIFIC__


10 
	~<î∫o.h
>

11 
	~<sys/ty≥s.h
>

14 #i‡
UNIX


15 
	~<uni°d.h
>

16 
	~<sys/time.h
>

18 #i‡
ELKS


19 
	~<löuxmt/posix_ty≥s.h
>

20 
	~<löuxmt/time.h
>

22 
	~"wödows.h
"

23 
	~"wöã∫.h
"

25 
	gkeyb_fd
;

26 
	gmou£_fd
;

29 
	$maö
(
ac
,**
av
)

31 i‡((
keyb_fd
 = 
	`GdO≥nKeybﬂrd
()) < 0) {

32 
	`PRINT_ERROR
("Cannot initialise keyboard");

36 i‡((
mou£_fd
 = 
	`GdO≥nMou£
()) < 0) {

37 
	`PRINT_ERROR
("Cannot initialise mouse");

38 
	`GdClo£Keybﬂrd
();

43 
	`GsSñe˘
();

46 
	}
}

49 
	$GsTîmö©e
()

51 
	`GdClo£Mou£
();

52 
	`GdClo£Keybﬂrd
();

53 
	`exô
(0);

54 
	}
}

56 #i‡
MSDOS


58 
	$GsSñe˘
()

61 if(
mou£dev
.
	`Pﬁl
())

62 
	`GsCheckMou£Evít
();

65 if(
kbddev
.
	`Pﬁl
())

66 
	`GsCheckKeybﬂrdEvít
();

68 
	}
}

71 #i‡
UNIX
 && 
deföed
(
HAVESELECT
)

73 
	$GsSñe˘
()

75 
fd_£t
 
rfds
;

76 
e
;

77 
timevÆ
 
to
;

78 
n
;

81 
	`FD_ZERO
(&
rfds
);

82 
	`FD_SET
(
mou£_fd
, &
rfds
);

83 
n
 = 
mou£_fd
;

84 
	`FD_SET
(
keyb_fd
, &
rfds
);

85 if(
keyb_fd
 > 
n
)

86 
n
 = 
keyb_fd
;

93 
to
.
tv_£c
 = 0L;

94 
to
.
tv_£c
 = 1L;

95 
to
.
tv_u£c
 = 0L;

96 
to
.
tv_u£c
 = 10000L;

99 if((
e
 = 
	`£À˘
(
n
+1, &
rfds
, 
NULL
, NULL, &
to
)) > 0) {

102 if(
	`FD_ISSET
(
mou£_fd
, &
rfds
))

103 
	`GsCheckMou£Evít
();

106 if(
	`FD_ISSET
(
keyb_fd
, &
rfds
))

107 
	`GsCheckKeybﬂrdEvít
();

110 if(!
e
) {

111 
	`¥ötf
("select()Åimeout\n");

113 if(
î∫o
 !
EINTR
)

114 
	`PRINT_ERROR
("Select() call in main failed");

115 
	}
}

123 
BOOL
 
	$GsCheckMou£Evít
()

125 
COORD
 
roŸx
;

126 
COORD
 
roŸy
;

127 
BUTTON
 
√wbuâ⁄s
;

128 
mou£°©us
;

131 
mou£°©us
 = 
	`GdRódMou£
(&
roŸx
, &
roŸy
, &
√wbuâ⁄s
);

132 if(
mou£°©us
 < 0) {

133 
	`¥ötf
("MouseÉrror\n");

134  
FALSE
;

135 } if(
mou£°©us
) {

136 
	`¥ötf
("mou£ %d,%d,%d\n", 
roŸx
, 
roŸy
, 
√wbuâ⁄s
);

137  
TRUE
;

139  
FALSE
;

140 
	}
}

147 
BOOL
 
	$GsCheckKeybﬂrdEvít
()

149 
ch
;

150 
MODIFIER
 
modifõrs
;

151 
key°©us
;

154 
key°©us
 = 
	`GdRódKeybﬂrd
(&
ch
, &
modifõrs
);

155 if(
key°©us
 < 0) {

156 if(
key°©us
 == -2)

157 
	`GsTîmö©e
();

158 
	`¥ötf
("KbdÉrror\n");

159  
FALSE
;

160 } if(
key°©us
) {

161 
	`¥ötf
("kbd '%c',%d\n", 
ch
, 
modifõrs
);

162  
TRUE
;

164  
FALSE
;

165 
	}
}

	@demos/tuxchess/board.c

9 
	~"defs.h
"

10 
	~"d©a.h
"

11 
	~"¥Ÿos.h
"

16 
öô
()

18 
	gi
;

20 
	gi
 = 0; i < 64; ++i) {

21 
	gcﬁ‹
[
i
] = 
öô_cﬁ‹
[i];

22 
	gpõ˚
[
i
] = 
öô_põ˚
[i];

24 
	gside
 = 
LIGHT
;

25 
	gxside
 = 
DARK
;

26 
	gˇ°À
 = 15;

27 
	gï
 = -1;

28 
	gfi·y
 = 0;

29 
	g∂y
 = 0;

30 
	gh∂y
 = 0;

31 
	gfú°_move
[0] = 0;

39 
BOOL
 
ö_check
(
s
)

41 
	gi
;

43 
	gi
 = 0; i < 64; ++i)

44 i‡(
	gpõ˚
[
i
] =
KING
 && 
cﬁ‹
[i] =
s
)

45  
©èck
(
i
, 
s
 ^ 1);

46  
	gTRUE
;

53 
BOOL
 
©èck
(
sq
, 
s
)

55 
	gi
, 
	gj
, 
	gn
;

57 
	gi
 = 0; i < 64; ++i)

58 i‡(
	gcﬁ‹
[
i
] =
s
) {

59 i‡(
põ˚
[
i
] =
PAWN
) {

60 i‡(
s
 =
LIGHT
) {

61 i‡(
COL
(
i
Ë!0 && i - 9 =
sq
)

62  
TRUE
;

63 i‡(
COL
(
i
Ë!7 && i - 7 =
sq
)

64  
TRUE
;

67 i‡(
COL
(
i
Ë!0 && i + 7 =
sq
)

68  
TRUE
;

69 i‡(
COL
(
i
Ë!7 && i + 9 =
sq
)

70  
TRUE
;

74 
	gj
 = 0; j < 
	goff£ts
[
põ˚
[
i
]]; ++j)

75 
	gn
 = 
i
;;) {

76 
	gn
 = 
maûbox
[
maûbox64
[
n
] + 
off£t
[
põ˚
[
i
]][
j
]];

77 i‡(
	gn
 == -1)

79 i‡(
	gn
 =
sq
)

80  
TRUE
;

81 i‡(
	gcﬁ‹
[
n
] !
EMPTY
)

83 i‡(!
	g¶ide
[
põ˚
[
i
]])

87  
	gFALSE
;

97 
gí
()

99 
	gi
, 
	gj
, 
	gn
;

102 
	gfú°_move
[
∂y
 + 1] = 
fú°_move
[ply];

104 
	gi
 = 0; i < 64; ++i)

105 i‡(
	gcﬁ‹
[
i
] =
side
) {

106 i‡(
põ˚
[
i
] =
PAWN
) {

107 i‡(
side
 =
LIGHT
) {

108 i‡(
COL
(
i
Ë!0 && 
cﬁ‹
[ò- 9] =
DARK
)

109 
gí_push
(
i
, i - 9, 17);

110 i‡(
COL
(
i
Ë!7 && 
cﬁ‹
[ò- 7] =
DARK
)

111 
gí_push
(
i
, i - 7, 17);

112 i‡(
	gcﬁ‹
[
i
 - 8] =
EMPTY
) {

113 
gí_push
(
i
, i - 8, 16);

114 i‡(
	gi
 >48 && 
cﬁ‹
[
i
 - 16] =
EMPTY
)

115 
gí_push
(
i
, i - 16, 24);

119 i‡(
COL
(
i
Ë!0 && 
cﬁ‹
[ò+ 7] =
LIGHT
)

120 
gí_push
(
i
, i + 7, 17);

121 i‡(
COL
(
i
Ë!7 && 
cﬁ‹
[ò+ 9] =
LIGHT
)

122 
gí_push
(
i
, i + 9, 17);

123 i‡(
	gcﬁ‹
[
i
 + 8] =
EMPTY
) {

124 
gí_push
(
i
, i + 8, 16);

125 i‡(
	gi
 <15 && 
cﬁ‹
[
i
 + 16] =
EMPTY
)

126 
gí_push
(
i
, i + 16, 24);

131 
	gj
 = 0; j < 
	goff£ts
[
põ˚
[
i
]]; ++j)

132 
	gn
 = 
i
;;) {

133 
	gn
 = 
maûbox
[
maûbox64
[
n
] + 
off£t
[
põ˚
[
i
]][
j
]];

134 i‡(
	gn
 == -1)

136 i‡(
	gcﬁ‹
[
n
] !
EMPTY
) {

137 i‡(
cﬁ‹
[
n
] =
xside
)

138 
gí_push
(
i
, 
n
, 1);

141 
gí_push
(
i
, 
n
, 0);

142 i‡(!
	g¶ide
[
põ˚
[
i
]])

148 i‡(
	gside
 =
LIGHT
) {

149 i‡(
ˇ°À
 & 1)

150 
gí_push
(
E1
, 
G1
, 2);

151 i‡(
	gˇ°À
 & 2)

152 
gí_push
(
E1
, 
C1
, 2);

155 i‡(
	gˇ°À
 & 4)

156 
gí_push
(
E8
, 
G8
, 2);

157 i‡(
	gˇ°À
 & 8)

158 
gí_push
(
E8
, 
C8
, 2);

162 i‡(
	gï
 != -1) {

163 i‡(
side
 =
LIGHT
) {

164 i‡(
COL
(
ï
Ë!0 && 
cﬁ‹
[ï + 7] =
LIGHT
 && 
põ˚
[ï + 7] =
PAWN
)

165 
gí_push
(
ï
 + 7,Ép, 21);

166 i‡(
COL
(
ï
Ë!7 && 
cﬁ‹
[ï + 9] =
LIGHT
 && 
põ˚
[ï + 9] =
PAWN
)

167 
gí_push
(
ï
 + 9,Ép, 21);

170 i‡(
COL
(
ï
Ë!0 && 
cﬁ‹
[ï - 9] =
DARK
 && 
põ˚
[ï - 9] =
PAWN
)

171 
gí_push
(
ï
 - 9,Ép, 21);

172 i‡(
COL
(
ï
Ë!7 && 
cﬁ‹
[ï - 7] =
DARK
 && 
põ˚
[ï - 7] =
PAWN
)

173 
gí_push
(
ï
 - 7,Ép, 21);

183 
gí_ˇps
()

185 
	gi
, 
	gj
, 
	gn
;

187 
	gfú°_move
[
∂y
 + 1] = 
fú°_move
[ply];

188 
	gi
 = 0; i < 64; ++i)

189 i‡(
	gcﬁ‹
[
i
] =
side
) {

190 i‡(
põ˚
[
i
]==
PAWN
) {

191 i‡(
side
 =
LIGHT
) {

192 i‡(
COL
(
i
Ë!0 && 
cﬁ‹
[ò- 9] =
DARK
)

193 
gí_push
(
i
, i - 9, 17);

194 i‡(
COL
(
i
Ë!7 && 
cﬁ‹
[ò- 7] =
DARK
)

195 
gí_push
(
i
, i - 7, 17);

196 i‡(
	gi
 <15 && 
cﬁ‹
[
i
 - 8] =
EMPTY
)

197 
gí_push
(
i
, i - 8, 16);

199 i‡(
	gside
 =
DARK
) {

200 i‡(
COL
(
i
Ë!0 && 
cﬁ‹
[ò+ 7] =
LIGHT
)

201 
gí_push
(
i
, i + 7, 17);

202 i‡(
COL
(
i
Ë!7 && 
cﬁ‹
[ò+ 9] =
LIGHT
)

203 
gí_push
(
i
, i + 9, 17);

204 i‡(
	gi
 >48 && 
cﬁ‹
[
i
 + 8] =
EMPTY
)

205 
gí_push
(
i
, i + 8, 16);

209 
	gj
 = 0; j < 
	goff£ts
[
põ˚
[
i
]]; ++j)

210 
	gn
 = 
i
;;) {

211 
	gn
 = 
maûbox
[
maûbox64
[
n
] + 
off£t
[
põ˚
[
i
]][
j
]];

212 i‡(
	gn
 == -1)

214 i‡(
	gcﬁ‹
[
n
] !
EMPTY
) {

215 i‡(
cﬁ‹
[
n
] =
xside
)

216 
gí_push
(
i
, 
n
, 1);

219 i‡(!
	g¶ide
[
põ˚
[
i
]])

223 i‡(
	gï
 != -1) {

224 i‡(
side
 =
LIGHT
) {

225 i‡(
COL
(
ï
Ë!0 && 
cﬁ‹
[ï + 7] =
LIGHT
 && 
põ˚
[ï + 7] =
PAWN
)

226 
gí_push
(
ï
 + 7,Ép, 21);

227 i‡(
COL
(
ï
Ë!7 && 
cﬁ‹
[ï + 9] =
LIGHT
 && 
põ˚
[ï + 9] =
PAWN
)

228 
gí_push
(
ï
 + 9,Ép, 21);

231 i‡(
COL
(
ï
Ë!0 && 
cﬁ‹
[ï - 9] =
DARK
 && 
põ˚
[ï - 9] =
PAWN
)

232 
gí_push
(
ï
 - 9,Ép, 21);

233 i‡(
COL
(
ï
Ë!7 && 
cﬁ‹
[ï - 7] =
DARK
 && 
põ˚
[ï - 7] =
PAWN
)

234 
gí_push
(
ï
 - 7,Ép, 21);

249 
gí_push
(
‰om
, 
to
, 
bôs
)

251 
gí_t
 *
	gg
;

253 i‡(
	gbôs
 & 16) {

254 i‡(
	gside
 =
LIGHT
) {

255 i‡(
to
 <
H8
) {

256 
gí_¥omŸe
(
‰om
, 
to
, 
bôs
);

261 i‡(
	gto
 >
A1
) {

262 
gí_¥omŸe
(
‰om
, 
to
, 
bôs
);

267 
	gg
 = &
gí_d©
[
fú°_move
[
∂y
 + 1]++];

268 
	gg
->
	gm
.
	gb
.
	g‰om
 = ()
‰om
;

269 
	gg
->
	gm
.
	gb
.
	gto
 = ()
to
;

270 
	gg
->
	gm
.
	gb
.
	g¥omŸe
 = 0;

271 
	gg
->
	gm
.
	gb
.
	gbôs
 = ()
bôs
;

272 i‡(
	gcﬁ‹
[
to
] !
EMPTY
)

273 
g
->
sc‹e
 = 1000000 + (
põ˚
[
to
] * 10Ë-Öõ˚[
‰om
];

275 
	gg
->
	gsc‹e
 = 
hi°‹y
[
‰om
][
to
];

282 
gí_¥omŸe
(
‰om
, 
to
, 
bôs
)

284 
	gi
;

285 
gí_t
 *
	gg
;

287 
	gi
 = 
KNIGHT
; i <
QUEEN
; ++i) {

288 
	gg
 = &
gí_d©
[
fú°_move
[
∂y
 + 1]++];

289 
	gg
->
	gm
.
	gb
.
	g‰om
 = ()
‰om
;

290 
	gg
->
	gm
.
	gb
.
	gto
 = ()
to
;

291 
	gg
->
	gm
.
	gb
.
	g¥omŸe
 = ()
i
;

292 
	gg
->
	gm
.
	gb
.
	gbôs
 = ()(
bôs
 | 32);

293 
	gg
->
	gsc‹e
 = 1000000 + (
i
 * 10);

302 
BOOL
 
makemove
(
move_byãs
 
m
)

307 i‡(
	gm
.
	gbôs
 & 2) {

308 
	g‰om
, 
	gto
;

310 i‡(
ö_check
(
side
))

311  
	gFALSE
;

312 
	gm
.
	gto
) {

314 i‡(
cﬁ‹
[
F1
] !
EMPTY
 || cﬁ‹[
G1
] != EMPTY ||

315 
©èck
(
F1
, 
xside
Ë||áâack(
G1
, xside))

316  
	gFALSE
;

317 
	g‰om
 = 
H1
;

318 
	gto
 = 
F1
;

321 i‡(
cﬁ‹
[
B1
] !
EMPTY
 || cﬁ‹[
C1
] !EMPTY || cﬁ‹[
D1
] != EMPTY ||

322 
©èck
(
C1
, 
xside
Ë||áâack(
D1
, xside))

323  
	gFALSE
;

324 
	g‰om
 = 
A1
;

325 
	gto
 = 
D1
;

328 i‡(
cﬁ‹
[
F8
] !
EMPTY
 || cﬁ‹[
G8
] != EMPTY ||

329 
©èck
(
F8
, 
xside
Ë||áâack(
G8
, xside))

330  
	gFALSE
;

331 
	g‰om
 = 
H8
;

332 
	gto
 = 
F8
;

335 i‡(
cﬁ‹
[
B8
] !
EMPTY
 || cﬁ‹[
C8
] !EMPTY || cﬁ‹[
D8
] != EMPTY ||

336 
©èck
(
C8
, 
xside
Ë||áâack(
D8
, xside))

337  
	gFALSE
;

338 
	g‰om
 = 
A8
;

339 
	gto
 = 
D8
;

342 
‰om
 = -1;

343 
	gto
 = -1;

346 
	gcﬁ‹
[
to
] = 
cﬁ‹
[
‰om
];

347 
	gpõ˚
[
to
] = 
põ˚
[
‰om
];

348 
	gcﬁ‹
[
‰om
] = 
EMPTY
;

349 
	gpõ˚
[
‰om
] = 
EMPTY
;

353 
	ghi°_d©
[
h∂y
].
	gm
.
	gb
 = 
m
;

354 
	ghi°_d©
[
h∂y
].
	gˇ±uª
 = 
põ˚
[()
m
.
to
];

355 
	ghi°_d©
[
h∂y
].
	gˇ°À
 = 
ˇ°À
;

356 
	ghi°_d©
[
h∂y
].
	gï
 = 
ï
;

357 
	ghi°_d©
[
h∂y
].
	gfi·y
 = 
fi·y
;

358 ++
	g∂y
;

359 ++
	gh∂y
;

363 
	gˇ°À
 &
ˇ°À_mask
[()
m
.
‰om
] & ca°À_mask[()m.
to
];

364 i‡(
	gm
.
	gbôs
 & 8) {

365 i‡(
	gside
 =
LIGHT
)

366 
ï
 = 
m
.
to
 + 8;

368 
	gï
 = 
m
.
to
 - 8;

371 
	gï
 = -1;

372 i‡(
	gm
.
	gbôs
 & 17)

373 
	gfi·y
 = 0;

375 ++
	gfi·y
;

378 
	gcﬁ‹
[()
m
.
to
] = 
side
;

379 i‡(
	gm
.
	gbôs
 & 32)

380 
	gpõ˚
[()
m
.
to
] = m.
¥omŸe
;

382 
	gpõ˚
[()
m
.
to
] = 
põ˚
[()m.
‰om
];

383 
	gcﬁ‹
[()
m
.
‰om
] = 
EMPTY
;

384 
	gpõ˚
[()
m
.
‰om
] = 
EMPTY
;

387 i‡(
	gm
.
	gbôs
 & 4) {

388 i‡(
	gside
 =
LIGHT
) {

389 
cﬁ‹
[
m
.
to
 + 8] = 
EMPTY
;

390 
	gpõ˚
[
m
.
to
 + 8] = 
EMPTY
;

393 
	gcﬁ‹
[
m
.
to
 - 8] = 
EMPTY
;

394 
	gpõ˚
[
m
.
to
 - 8] = 
EMPTY
;

401 
	gside
 ^= 1;

402 
	gxside
 ^= 1;

403 i‡(
ö_check
(
xside
)) {

404 
èkeback
();

405  
	gFALSE
;

407  
	gTRUE
;

413 
èkeback
()

415 
move_byãs
 
	gm
;

417 
	gside
 ^= 1;

418 
	gxside
 ^= 1;

419 --
	g∂y
;

420 --
	gh∂y
;

421 
	gm
 = 
hi°_d©
[
h∂y
].
m
.
b
;

422 
	gˇ°À
 = 
hi°_d©
[
h∂y
].
ˇ°À
;

423 
	gï
 = 
hi°_d©
[
h∂y
].
ï
;

424 
	gfi·y
 = 
hi°_d©
[
h∂y
].
fi·y
;

425 
	gcﬁ‹
[()
m
.
‰om
] = 
side
;

426 i‡(
	gm
.
	gbôs
 & 32)

427 
	gpõ˚
[()
m
.
‰om
] = 
PAWN
;

429 
	gpõ˚
[()
m
.
‰om
] = 
põ˚
[()m.
to
];

430 i‡(
	ghi°_d©
[
h∂y
].
	gˇ±uª
 =
EMPTY
) {

431 
cﬁ‹
[()
m
.
to
] = 
EMPTY
;

432 
	gpõ˚
[()
m
.
to
] = 
EMPTY
;

435 
	gcﬁ‹
[()
m
.
to
] = 
xside
;

436 
	gpõ˚
[()
m
.
to
] = 
hi°_d©
[
h∂y
].
ˇ±uª
;

438 i‡(
	gm
.
	gbôs
 & 2) {

439 
	g‰om
, 
	gto
;

441 
	gm
.
	gto
) {

443 
‰om
 = 
F1
;

444 
	gto
 = 
H1
;

447 
‰om
 = 
D1
;

448 
	gto
 = 
A1
;

451 
‰om
 = 
F8
;

452 
	gto
 = 
H8
;

455 
‰om
 = 
D8
;

456 
	gto
 = 
A8
;

459 
‰om
 = -1;

460 
	gto
 = -1;

463 
	gcﬁ‹
[
to
] = 
side
;

464 
	gpõ˚
[
to
] = 
ROOK
;

465 
	gcﬁ‹
[
‰om
] = 
EMPTY
;

466 
	gpõ˚
[
‰om
] = 
EMPTY
;

468 i‡(
	gm
.
	gbôs
 & 4) {

469 i‡(
	gside
 =
LIGHT
) {

470 
cﬁ‹
[
m
.
to
 + 8] = 
xside
;

471 
	gpõ˚
[
m
.
to
 + 8] = 
PAWN
;

474 
	gcﬁ‹
[
m
.
to
 - 8] = 
xside
;

475 
	gpõ˚
[
m
.
to
 - 8] = 
PAWN
;

	@demos/tuxchess/data.c

9 
	~"defs.h
"

13 
	gcﬁ‹
[64];

14 
	gpõ˚
[64];

15 
	gside
;

16 
	gxside
;

17 
	gˇ°À
;

20 
	gï
;

23 
	gfi·y
;

25 
	g∂y
;

27 
	gh∂y
;

33 
gí_t
 
	ggí_d©
[
GEN_STACK
];

34 
	gfú°_move
[
MAX_PLY
];

37 
	ghi°‹y
[64][64];

41 
hi°_t
 
	ghi°_d©
[
HIST_STACK
];

45 
	gmax_time
;

46 
	gmax_dïth
;

49 
	g°¨t_time
;

50 
	g°›_time
;

52 
	gnodes
;

55 
move
 
	gpv
[
MAX_PLY
][MAX_PLY];

56 
	gpv_Àngth
[
MAX_PLY
];

57 
BOOL
 
	gfﬁlow_pv
;

72 
	gmaûbox
[120] = {

87 
	gmaûbox64
[64] = {

105 
BOOL
 
	g¶ide
[6] = {

106 
FALSE
, FALSE, 
TRUE
, TRUE, TRUE, FALSE

109 
	goff£ts
[6] = {

113 
	goff£t
[6][8] = {

132 
	gˇ°À_mask
[64] = {

145 
	gpõ˚_ch¨
[6] = {

152 
	göô_cﬁ‹
[64] = {

163 
	göô_põ˚
[64] = {

	@demos/tuxchess/data.h

12 
cﬁ‹
[64];

13 
põ˚
[64];

14 
side
;

15 
xside
;

16 
ˇ°À
;

17 
ï
;

18 
fi·y
;

19 
∂y
;

20 
h∂y
;

21 
gí_t
 
gí_d©
[
GEN_STACK
];

22 
fú°_move
[
MAX_PLY
];

23 
hi°‹y
[64][64];

24 
hi°_t
 
hi°_d©
[
HIST_STACK
];

25 
max_time
;

26 
max_dïth
;

27 
°¨t_time
;

28 
°›_time
;

29 
nodes
;

30 
move
 
pv
[
MAX_PLY
][MAX_PLY];

31 
pv_Àngth
[
MAX_PLY
];

32 
BOOL
 
fﬁlow_pv
;

33 
maûbox
[120];

34 
maûbox64
[64];

35 
BOOL
 
¶ide
[6];

36 
off£ts
[6];

37 
off£t
[6][8];

38 
ˇ°À_mask
[64];

39 
põ˚_ch¨
[6];

40 
öô_cﬁ‹
[64];

41 
öô_põ˚
[64];

	@demos/tuxchess/defs.h

9 
	#BOOL
 

	)

10 
	#TRUE
 1

	)

11 
	#FALSE
 0

	)

13 
	#GEN_STACK
 1120

	)

14 
	#MAX_PLY
 32

	)

15 
	#HIST_STACK
 400

	)

17 
	#LIGHT
 0

	)

18 
	#DARK
 1

	)

20 
	#PAWN
 0

	)

21 
	#KNIGHT
 1

	)

22 
	#BISHOP
 2

	)

23 
	#ROOK
 3

	)

24 
	#QUEEN
 4

	)

25 
	#KING
 5

	)

27 
	#EMPTY
 6

	)

30 
	#A1
 56

	)

31 
	#B1
 57

	)

32 
	#C1
 58

	)

33 
	#D1
 59

	)

34 
	#E1
 60

	)

35 
	#F1
 61

	)

36 
	#G1
 62

	)

37 
	#H1
 63

	)

38 
	#A8
 0

	)

39 
	#B8
 1

	)

40 
	#C8
 2

	)

41 
	#D8
 3

	)

42 
	#E8
 4

	)

43 
	#F8
 5

	)

44 
	#G8
 6

	)

45 
	#H8
 7

	)

47 
	#ROW
(
x
Ë(x >> 3)

	)

48 
	#COL
(
x
Ë(x & 7)

	)

67 
	m‰om
;

68 
	mto
;

69 
	m¥omŸe
;

70 
	mbôs
;

71 } 
	tmove_byãs
;

74 
move_byãs
 
	mb
;

75 
	mu
;

76 } 
	tmove
;

81 
move
 
	mm
;

82 
	msc‹e
;

83 } 
	tgí_t
;

88 
move
 
	mm
;

89 
	mˇ±uª
;

90 
	mˇ°À
;

91 
	mï
;

92 
	mfi·y
;

93 } 
	thi°_t
;

	@demos/tuxchess/eval.c

9 
	~<°rög.h
>

10 
	~"defs.h
"

11 
	~"d©a.h
"

12 
	~"¥Ÿos.h
"

15 
	#DOUBLED_PAWN_PENALTY
 10

	)

16 
	#ISOLATED_PAWN_PENALTY
 20

	)

17 
	#BACKWARDS_PAWN_PENALTY
 8

	)

18 
	#PASSED_PAWN_BONUS
 20

	)

19 
	#ROOK_SEMI_OPEN_FILE_BONUS
 10

	)

20 
	#ROOK_OPEN_FILE_BONUS
 15

	)

21 
	#ROOK_ON_SEVENTH_BONUS
 20

	)

25 
	gpõ˚_vÆue
[6] = {

33 
	g∑wn_pcsq
[64] = {

44 
	gknight_pcsq
[64] = {

55 
	gbish›_pcsq
[64] = {

66 
	gkög_pcsq
[64] = {

77 
	gkög_ídgame_pcsq
[64] = {

92 
	gÊù
[64] = {

108 
	g∑wn_ønk
[2][10];

110 
	gpõ˚_m©
[2];

111 
	g∑wn_m©
[2];

113 
evÆ
()

115 
	gi
;

116 
	gf
;

117 
	gsc‹e
[2];

120 
	gi
 = 0; i < 10; ++i) {

121 
	g∑wn_ønk
[
LIGHT
][
i
] = 0;

122 
	g∑wn_ønk
[
DARK
][
i
] = 7;

124 
	gpõ˚_m©
[
LIGHT
] = 0;

125 
	gpõ˚_m©
[
DARK
] = 0;

126 
	g∑wn_m©
[
LIGHT
] = 0;

127 
	g∑wn_m©
[
DARK
] = 0;

128 
	gi
 = 0; i < 64; ++i) {

129 i‡(
	gcﬁ‹
[
i
] =
EMPTY
)

131 i‡(
	gpõ˚
[
i
] =
PAWN
) {

132 
∑wn_m©
[
cﬁ‹
[
i
]] +
põ˚_vÆue
[
PAWN
];

133 
	gf
 = 
COL
(
i
) + 1;

134 i‡(
	gcﬁ‹
[
i
] =
LIGHT
) {

135 i‡(
∑wn_ønk
[
LIGHT
][
f
] < 
ROW
(
i
))

136 
∑wn_ønk
[
LIGHT
][
f
] = 
ROW
(
i
);

139 i‡(
	g∑wn_ønk
[
DARK
][
f
] > 
ROW
(
i
))

140 
	g∑wn_ønk
[
DARK
][
f
] = 
ROW
(
i
);

144 
	gpõ˚_m©
[
cﬁ‹
[
i
]] +
põ˚_vÆue
[
põ˚
[i]];

148 
	gsc‹e
[
LIGHT
] = 
põ˚_m©
[LIGHT] + 
∑wn_m©
[LIGHT];

149 
	gsc‹e
[
DARK
] = 
põ˚_m©
[DARK] + 
∑wn_m©
[DARK];

150 
	gi
 = 0; i < 64; ++i) {

151 i‡(
	gcﬁ‹
[
i
] =
EMPTY
)

153 i‡(
	gcﬁ‹
[
i
] =
LIGHT
) {

154 
põ˚
[
i
]) {

155 
PAWN
:

156 
sc‹e
[
LIGHT
] +
evÆ_light_∑wn
(
i
);

158 
	gKNIGHT
:

159 
sc‹e
[
LIGHT
] +
knight_pcsq
[
i
];

161 
	gBISHOP
:

162 
sc‹e
[
LIGHT
] +
bish›_pcsq
[
i
];

164 
	gROOK
:

165 i‡(
∑wn_ønk
[
LIGHT
][
COL
(
i
) + 1] == 0) {

166 i‡(
∑wn_ønk
[
DARK
][
COL
(
i
) + 1] == 7)

167 
sc‹e
[
LIGHT
] +
ROOK_OPEN_FILE_BONUS
;

169 
	gsc‹e
[
LIGHT
] +
ROOK_SEMI_OPEN_FILE_BONUS
;

171 i‡(
ROW
(
i
) == 1)

172 
sc‹e
[
LIGHT
] +
ROOK_ON_SEVENTH_BONUS
;

174 
	gKING
:

175 i‡(
põ˚_m©
[
DARK
] <= 1200)

176 
sc‹e
[
LIGHT
] +
kög_ídgame_pcsq
[
i
];

178 
	gsc‹e
[
LIGHT
] +
evÆ_light_kög
(
i
);

183 
	gpõ˚
[
i
]) {

184 
	gPAWN
:

185 
sc‹e
[
DARK
] +
evÆ_d¨k_∑wn
(
i
);

187 
	gKNIGHT
:

188 
sc‹e
[
DARK
] +
knight_pcsq
[
Êù
[
i
]];

190 
	gBISHOP
:

191 
sc‹e
[
DARK
] +
bish›_pcsq
[
Êù
[
i
]];

193 
	gROOK
:

194 i‡(
∑wn_ønk
[
DARK
][
COL
(
i
) + 1] == 7) {

195 i‡(
∑wn_ønk
[
LIGHT
][
COL
(
i
) + 1] == 0)

196 
sc‹e
[
DARK
] +
ROOK_OPEN_FILE_BONUS
;

198 
	gsc‹e
[
DARK
] +
ROOK_SEMI_OPEN_FILE_BONUS
;

200 i‡(
ROW
(
i
) == 6)

201 
sc‹e
[
DARK
] +
ROOK_ON_SEVENTH_BONUS
;

203 
	gKING
:

204 i‡(
põ˚_m©
[
LIGHT
] <= 1200)

205 
sc‹e
[
DARK
] +
kög_ídgame_pcsq
[
Êù
[
i
]];

207 
	gsc‹e
[
DARK
] +
evÆ_d¨k_kög
(
i
);

215 i‡(
	gside
 =
LIGHT
)

216  
sc‹e
[
LIGHT
] - sc‹e[
DARK
];

217  
	gsc‹e
[
DARK
] - sc‹e[
LIGHT
];

220 
evÆ_light_∑wn
(
sq
)

222 
	gr
;

223 
	gf
;

225 
	gr
 = 0;

226 
	gf
 = 
COL
(
sq
) + 1;

228 
	gr
 +
∑wn_pcsq
[
sq
];

231 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] > 
ROW
(
sq
))

232 
	gr
 -
DOUBLED_PAWN_PENALTY
;

236 i‡((
	g∑wn_ønk
[
LIGHT
][
f
 - 1] == 0) &&

237 (
∑wn_ønk
[
LIGHT
][
f
 + 1] == 0))

238 
r
 -
ISOLATED_PAWN_PENALTY
;

241 i‡((
	g∑wn_ønk
[
LIGHT
][
f
 - 1] < 
ROW
(
sq
)) &&

242 (
	g∑wn_ønk
[
LIGHT
][
f
 + 1] < 
ROW
(
sq
)))

243 
	gr
 -
BACKWARDS_PAWN_PENALTY
;

246 i‡((
	g∑wn_ønk
[
DARK
][
f
 - 1] >
ROW
(
sq
)) &&

247 (
∑wn_ønk
[
DARK
][
f
] >
ROW
(
sq
)) &&

248 (
∑wn_ønk
[
DARK
][
f
 + 1] >
ROW
(
sq
)))

249 
r
 +(7 - 
ROW
(
sq
)Ë* 
PASSED_PAWN_BONUS
;

251  
	gr
;

254 
evÆ_d¨k_∑wn
(
sq
)

256 
	gr
;

257 
	gf
;

259 
	gr
 = 0;

260 
	gf
 = 
COL
(
sq
) + 1;

262 
	gr
 +
∑wn_pcsq
[
Êù
[
sq
]];

265 i‡(
	g∑wn_ønk
[
DARK
][
f
] < 
ROW
(
sq
))

266 
	gr
 -
DOUBLED_PAWN_PENALTY
;

270 i‡((
	g∑wn_ønk
[
DARK
][
f
 - 1] == 7) &&

271 (
∑wn_ønk
[
DARK
][
f
 + 1] == 7))

272 
r
 -
ISOLATED_PAWN_PENALTY
;

275 i‡((
	g∑wn_ønk
[
DARK
][
f
 - 1] > 
ROW
(
sq
)) &&

276 (
	g∑wn_ønk
[
DARK
][
f
 + 1] > 
ROW
(
sq
)))

277 
	gr
 -
BACKWARDS_PAWN_PENALTY
;

280 i‡((
	g∑wn_ønk
[
LIGHT
][
f
 - 1] <
ROW
(
sq
)) &&

281 (
∑wn_ønk
[
LIGHT
][
f
] <
ROW
(
sq
)) &&

282 (
∑wn_ønk
[
LIGHT
][
f
 + 1] <
ROW
(
sq
)))

283 
r
 +
ROW
(
sq
Ë* 
PASSED_PAWN_BONUS
;

285  
	gr
;

288 
evÆ_light_kög
(
sq
)

290 
	gr
;

291 
	gi
;

293 
	gr
 = 
kög_pcsq
[
sq
];

297 i‡(
COL
(
sq
) < 3) {

298 
	gr
 +
evÆ_lkp
(1);

299 
	gr
 +
evÆ_lkp
(2);

300 
	gr
 +
evÆ_lkp
(3) / 2;

303 i‡(
COL
(
sq
) > 4) {

304 
	gr
 +
evÆ_lkp
(8);

305 
	gr
 +
evÆ_lkp
(7);

306 
	gr
 +
evÆ_lkp
(6) / 2;

312 
	gi
 = 
COL
(
sq
); i <= COL(sq) + 2; ++i)

313 i‡((
	g∑wn_ønk
[
LIGHT
][
i
] == 0) &&

314 (
∑wn_ønk
[
DARK
][
i
] == 7))

315 
r
 -= 10;

321 
	gr
 *
põ˚_m©
[
DARK
];

322 
	gr
 /= 3100;

324  
	gr
;

329 
evÆ_lkp
(
f
)

331 
	gr
 = 0;

333 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] == 6);

334 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] == 5)

335 
r
 -= 10;

336 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] != 0)

337 
r
 -= 20;

339 
	gr
 -= 25;

341 i‡(
	g∑wn_ønk
[
DARK
][
f
] == 7)

342 
r
 -= 15;

343 i‡(
	g∑wn_ønk
[
DARK
][
f
] == 5)

344 
r
 -= 10;

345 i‡(
	g∑wn_ønk
[
DARK
][
f
] == 4)

346 
r
 -= 5;

348  
	gr
;

351 
evÆ_d¨k_kög
(
sq
)

353 
	gr
;

354 
	gi
;

356 
	gr
 = 
kög_pcsq
[
Êù
[
sq
]];

357 i‡(
COL
(
sq
) < 3) {

358 
	gr
 +
evÆ_dkp
(1);

359 
	gr
 +
evÆ_dkp
(2);

360 
	gr
 +
evÆ_dkp
(3) / 2;

362 i‡(
COL
(
sq
) > 4) {

363 
	gr
 +
evÆ_dkp
(8);

364 
	gr
 +
evÆ_dkp
(7);

365 
	gr
 +
evÆ_dkp
(6) / 2;

368 
	gi
 = 
COL
(
sq
); i <= COL(sq) + 2; ++i)

369 i‡((
	g∑wn_ønk
[
LIGHT
][
i
] == 0) &&

370 (
∑wn_ønk
[
DARK
][
i
] == 7))

371 
r
 -= 10;

373 
	gr
 *
põ˚_m©
[
LIGHT
];

374 
	gr
 /= 3100;

375  
	gr
;

378 
evÆ_dkp
(
f
)

380 
	gr
 = 0;

382 i‡(
	g∑wn_ønk
[
DARK
][
f
] == 1);

383 i‡(
	g∑wn_ønk
[
DARK
][
f
] == 2)

384 
r
 -= 10;

385 i‡(
	g∑wn_ønk
[
DARK
][
f
] != 7)

386 
r
 -= 20;

388 
	gr
 -= 25;

390 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] == 0)

391 
r
 -= 15;

392 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] == 2)

393 
r
 -= 10;

394 i‡(
	g∑wn_ønk
[
LIGHT
][
f
] == 3)

395 
r
 -= 5;

397  
	gr
;

	@demos/tuxchess/images.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~<°rög.h
>

4 
	~"«no-X.h
"

6 
	#IMAGE_PATH
 "demos/tuxchess/images"

	)

8 
GR_IMAGE_ID
 
bﬂrd_image_id
;

9 
GR_IMAGE_INFO
 
bﬂrd_öfo
;

10 
bﬂrd_w
,
bﬂrd_h
;

12 
GR_IMAGE_ID
 
w_p_image_id
;

13 
GR_IMAGE_INFO
 
w_p_öfo
;

14 
w_p_w
,
w_p_h
;

16 
GR_IMAGE_ID
 
w_n_image_id
;

17 
GR_IMAGE_INFO
 
w_n_öfo
;

18 
w_n_w
,
w_n_h
;

20 
GR_IMAGE_ID
 
w_b_image_id
;

21 
GR_IMAGE_INFO
 
w_b_öfo
;

22 
w_b_w
,
w_b_h
;

24 
GR_IMAGE_ID
 
w_r_image_id
;

25 
GR_IMAGE_INFO
 
w_r_öfo
;

26 
w_r_w
,
w_r_h
;

28 
GR_IMAGE_ID
 
w_q_image_id
;

29 
GR_IMAGE_INFO
 
w_q_öfo
;

30 
w_q_w
,
w_q_h
;

32 
GR_IMAGE_ID
 
w_k_image_id
;

33 
GR_IMAGE_INFO
 
w_k_öfo
;

34 
w_k_w
,
w_k_h
;

36 
GR_IMAGE_ID
 
b_p_image_id
;

37 
GR_IMAGE_INFO
 
b_p_öfo
;

38 
b_p_w
,
b_p_h
;

40 
GR_IMAGE_ID
 
b_n_image_id
;

41 
GR_IMAGE_INFO
 
b_n_öfo
;

42 
b_n_w
,
b_n_h
;

44 
GR_IMAGE_ID
 
b_b_image_id
;

45 
GR_IMAGE_INFO
 
b_b_öfo
;

46 
b_b_w
,
b_b_h
;

48 
GR_IMAGE_ID
 
b_r_image_id
;

49 
GR_IMAGE_INFO
 
b_r_öfo
;

50 
b_r_w
,
b_r_h
;

52 
GR_IMAGE_ID
 
b_q_image_id
;

53 
GR_IMAGE_INFO
 
b_q_öfo
;

54 
b_q_w
,
b_q_h
;

56 
GR_IMAGE_ID
 
b_k_image_id
;

57 
GR_IMAGE_INFO
 
b_k_öfo
;

58 
b_k_w
,
b_k_h
;

61 
	$lﬂd_images
()

63 
buf
[128];

65 
	`•rötf
(
buf
,"%s/bﬂrd.gif",
IMAGE_PATH
);

66 i‡(!(
bﬂrd_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

67 
	`Ârötf
(
°dîr
, "Can'tÜoad board image file\n");

68 
	`exô
(-1);

70 
	`GrGëImageInfo
(
bﬂrd_image_id
, &
bﬂrd_öfo
);

71 
bﬂrd_w
 = 
bﬂrd_öfo
.
width
;

72 
bﬂrd_h
 = 
bﬂrd_öfo
.
height
;

75 
	`•rötf
(
buf
,"%s/w_p.gif",
IMAGE_PATH
);

76 i‡(!(
w_p_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

77 
	`Ârötf
(
°dîr
, "Can'tÜoad whiteÖawn image file\n");

78 
	`exô
(-1);

80 
	`GrGëImageInfo
(
w_p_image_id
, &
w_p_öfo
);

81 
w_p_w
 = 
w_p_öfo
.
width
;

82 
w_p_h
 = 
w_p_öfo
.
height
;

85 
	`•rötf
(
buf
,"%s/w_n.gif",
IMAGE_PATH
);

86 i‡(!(
w_n_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

87 
	`Ârötf
(
°dîr
, "Can'tÜoad white knight image file\n");

88 
	`exô
(-1);

90 
	`GrGëImageInfo
(
w_n_image_id
, &
w_n_öfo
);

91 
w_n_w
 = 
w_n_öfo
.
width
;

92 
w_n_h
 = 
w_n_öfo
.
height
;

96 
	`•rötf
(
buf
,"%s/w_b.gif",
IMAGE_PATH
);

97 i‡(!(
w_b_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

98 
	`Ârötf
(
°dîr
, "Can'tÜoad white bishop image file\n");

99 
	`exô
(-1);

101 
	`GrGëImageInfo
(
w_b_image_id
, &
w_b_öfo
);

102 
w_b_w
 = 
w_b_öfo
.
width
;

103 
w_b_h
 = 
w_b_öfo
.
height
;

107 
	`•rötf
(
buf
,"%s/w_r.gif",
IMAGE_PATH
);

108 i‡(!(
w_r_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

109 
	`Ârötf
(
°dîr
, "Can'tÜoad whiteÑook image file\n");

110 
	`exô
(-1);

112 
	`GrGëImageInfo
(
w_r_image_id
, &
w_r_öfo
);

113 
w_r_w
 = 
w_r_öfo
.
width
;

114 
w_r_h
 = 
w_r_öfo
.
height
;

118 
	`•rötf
(
buf
,"%s/w_k.gif",
IMAGE_PATH
);

119 i‡(!(
w_k_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

120 
	`Ârötf
(
°dîr
, "Can'tÜoad white king image file\n");

121 
	`exô
(-1);

123 
	`GrGëImageInfo
(
w_k_image_id
, &
w_k_öfo
);

124 
w_k_w
 = 
w_k_öfo
.
width
;

125 
w_k_h
 = 
w_k_öfo
.
height
;

129 
	`•rötf
(
buf
,"%s/w_q.gif",
IMAGE_PATH
);

130 i‡(!(
w_q_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

131 
	`Ârötf
(
°dîr
, "Can'tÜoad white queen image file\n");

132 
	`exô
(-1);

134 
	`GrGëImageInfo
(
w_q_image_id
, &
w_q_öfo
);

135 
w_q_w
 = 
w_q_öfo
.
width
;

136 
w_q_h
 = 
w_q_öfo
.
height
;

140 
	`•rötf
(
buf
,"%s/b_p.gif",
IMAGE_PATH
);

141 i‡(!(
b_p_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

142 
	`Ârötf
(
°dîr
, "Can'tÜoad blackÖawn image file\n");

143 
	`exô
(-1);

145 
	`GrGëImageInfo
(
b_p_image_id
, &
b_p_öfo
);

146 
b_p_w
 = 
b_p_öfo
.
width
;

147 
b_p_h
 = 
b_p_öfo
.
height
;

150 
	`•rötf
(
buf
,"%s/b_n.gif",
IMAGE_PATH
);

151 i‡(!(
b_n_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

152 
	`Ârötf
(
°dîr
, "Can'tÜoad black knight image file\n");

153 
	`exô
(-1);

155 
	`GrGëImageInfo
(
b_n_image_id
, &
b_n_öfo
);

156 
b_n_w
 = 
b_n_öfo
.
width
;

157 
b_n_h
 = 
b_n_öfo
.
height
;

161 
	`•rötf
(
buf
,"%s/b_b.gif",
IMAGE_PATH
);

162 i‡(!(
b_b_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

163 
	`Ârötf
(
°dîr
, "Can'tÜoad black bishop image file\n");

164 
	`exô
(-1);

166 
	`GrGëImageInfo
(
b_b_image_id
, &
b_b_öfo
);

167 
b_b_w
 = 
b_b_öfo
.
width
;

168 
b_b_h
 = 
b_b_öfo
.
height
;

172 
	`•rötf
(
buf
,"%s/b_r.gif",
IMAGE_PATH
);

173 i‡(!(
b_r_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

174 
	`Ârötf
(
°dîr
, "Can'tÜoad blackÑook image file\n");

175 
	`exô
(-1);

177 
	`GrGëImageInfo
(
b_r_image_id
, &
b_r_öfo
);

178 
b_r_w
 = 
b_r_öfo
.
width
;

179 
b_r_h
 = 
b_r_öfo
.
height
;

183 
	`•rötf
(
buf
,"%s/b_k.gif",
IMAGE_PATH
);

184 i‡(!(
b_k_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

185 
	`Ârötf
(
°dîr
, "Can'tÜoad black king image file\n");

186 
	`exô
(-1);

188 
	`GrGëImageInfo
(
b_k_image_id
, &
b_k_öfo
);

189 
b_k_w
 = 
b_k_öfo
.
width
;

190 
b_k_h
 = 
b_k_öfo
.
height
;

194 
	`•rötf
(
buf
,"%s/b_q.gif",
IMAGE_PATH
);

195 i‡(!(
b_q_image_id
 = 
	`GrLﬂdImageFromFûe
(
buf
, 0))) {

196 
	`Ârötf
(
°dîr
, "Can'tÜoad black queen image file\n");

197 
	`exô
(-1);

199 
	`GrGëImageInfo
(
b_q_image_id
, &
b_q_öfo
);

200 
b_q_w
 = 
b_q_öfo
.
width
;

201 
b_q_h
 = 
b_q_öfo
.
height
;

204 
	}
}

	@demos/tuxchess/main.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<sig«l.h
>

10 
	~<sys/timeb.h
>

11 
	~"defs.h
"

12 
	~"d©a.h
"

13 
	~"¥Ÿos.h
"

15 
	#MWINCLUDECOLORS


	)

16 
	~"«no-X.h
"

17 
	#TITLE
 "TuxChess"

	)

18 
	#SCANCODES
 64

	)

19 
	#BM_WIDTH
 394

	)

20 
	#BM_HEIGHT
 413

	)

22 #i‡
PSP


23 
	#Ârötf
(...)

	)

26 
	skeycﬁumn
 {

27 
	mxoff£t
;

28 
	msˇncode
;

31 
	skeyrow
 {

32 
	myoff£t
;

33 
	mheight
;

34 
keycﬁumn
 
	mcﬁumns
[9];

37 
keyrow
 
	gkeyrows
[8] = {

56 *
	gbﬂrd_posôi⁄
[
SCANCODES
] = {

67 
GR_WINDOW_ID
 
	gma°î
;

68 
GR_WINDOW_ID
 
	gbﬂrd
;

69 
GR_WINDOW_ID
 
	gãxt
;

71 
GR_GC_ID
 
	ggc
;

72 
GR_GC_ID
 
	gãxt_gc
;

74 
GR_IMAGE_ID
 
	gbﬂrd_image_id
;

75 
GR_IMAGE_INFO
 
	gbﬂrd_öfo
;

76 
	gbﬂrd_w
,
	gbﬂrd_h
;

78 
GR_IMAGE_ID
 
	gw_p_image_id
;

79 
GR_IMAGE_INFO
 
	gw_p_öfo
;

80 
	gw_p_w
,
	gw_p_h
;

82 
GR_IMAGE_ID
 
	gw_n_image_id
;

83 
GR_IMAGE_INFO
 
	gw_n_öfo
;

84 
	gw_n_w
,
	gw_n_h
;

86 
GR_IMAGE_ID
 
	gw_b_image_id
;

87 
GR_IMAGE_INFO
 
	gw_b_öfo
;

88 
	gw_b_w
,
	gw_b_h
;

90 
GR_IMAGE_ID
 
	gw_r_image_id
;

91 
GR_IMAGE_INFO
 
	gw_r_öfo
;

92 
	gw_r_w
,
	gw_r_h
;

94 
GR_IMAGE_ID
 
	gw_q_image_id
;

95 
GR_IMAGE_INFO
 
	gw_q_öfo
;

96 
	gw_q_w
,
	gw_q_h
;

98 
GR_IMAGE_ID
 
	gw_k_image_id
;

99 
GR_IMAGE_INFO
 
	gw_k_öfo
;

100 
	gw_k_w
,
	gw_k_h
;

102 
GR_IMAGE_ID
 
	gb_p_image_id
;

103 
GR_IMAGE_INFO
 
	gb_p_öfo
;

104 
	gb_p_w
,
	gb_p_h
;

106 
GR_IMAGE_ID
 
	gb_n_image_id
;

107 
GR_IMAGE_INFO
 
	gb_n_öfo
;

108 
	gb_n_w
,
	gb_n_h
;

110 
GR_IMAGE_ID
 
	gb_b_image_id
;

111 
GR_IMAGE_INFO
 
	gb_b_öfo
;

112 
	gb_b_w
,
	gb_b_h
;

114 
GR_IMAGE_ID
 
	gb_r_image_id
;

115 
GR_IMAGE_INFO
 
	gb_r_öfo
;

116 
	gb_r_w
,
	gb_r_h
;

118 
GR_IMAGE_ID
 
	gb_q_image_id
;

119 
GR_IMAGE_INFO
 
	gb_q_öfo
;

120 
	gb_q_w
,
	gb_q_h
;

122 
GR_IMAGE_ID
 
	gb_k_image_id
;

123 
GR_IMAGE_INFO
 
	gb_k_öfo
;

124 
	gb_k_w
,
	gb_k_h
;

127 
lﬂd_images
();

128 
	g°¨t_squ¨e
 = 1;

129 
	g°_sq
[3];

130 
	g‰om
 = 999;

131 
	gto
 = 999;

136 
BOOL
 
	g·ime_ok
 = 
FALSE
;

137 
	$gë_ms
()

139 
timeb
 
timebuf„r
;

140 
	`·ime
(&
timebuf„r
);

141 i‡(
timebuf„r
.
mûlôm
 != 0)

142 
·ime_ok
 = 
TRUE
;

143  (
timebuf„r
.
time
 * 1000Ë+Åimebuf„r.
mûlôm
;

144 
	}
}

148 
	$g¥ötf
(
s
[])

150 
œ°ãxt
[128];

152 
	`GrSëGCF‹eground
(
ãxt_gc
,
BLACK
);

153 
	`GrFûlRe˘
(
ãxt
, 
ãxt_gc
, 0, 0, 394,20);

154 
	`GrSëGCF‹eground
(
ãxt_gc
,
WHITE
);

155 
	`GrSëGCBackground
(
ãxt_gc
,
BLACK
);

156 i‡(!
s
)

157 
s
 = 
œ°ãxt
;

158 
	`GrText
(
ãxt
, 
ãxt_gc
, 5, 14, 
s
, 
	`°æí
(s),0);

159 i‡(
s
 !
œ°ãxt
)

160 
	`°r˝y
(
œ°ãxt
, 
s
);

161 
	}
}

165 
	$¥o˚ss_sˇncode
(
sˇncode
)

167 
sq
[3];

168 
fö_sq
[3];

169 
i
;

170 
ãmp
[5];

172 
	`°r˝y
(
sq
,"");

173 
i
=0;i<
SCANCODES
;i++)

175 i‡(
i
 =
sˇncode
)

177 
	`°r˝y
(
sq
,
bﬂrd_posôi⁄
[
i
]);

183 i‡(
°¨t_squ¨e
)

185 
	`g¥ötf
(
sq
);

186 
	`°r˝y
(
°_sq
,
sq
);

187 
°¨t_squ¨e
 = 0;

188 
‰om
 = 
sˇncode
;

189 
to
 = 999;

193 
	`°r˝y
(
fö_sq
,
sq
);

194 
°¨t_squ¨e
 = 1;

195 
to
 = 
sˇncode
;

196 
	`•rötf
(
ãmp
,"%s%s",
°_sq
,
fö_sq
);

197 
	`g¥ötf
(
ãmp
);

199 
	}
}

203 
	$mou£_hô
(
x
, 
y
)

205 
row
, 
cﬁumn
;

207 
row
 = 0;Ñow < 8;Ñow++) {

208 i‡(
y
 >
keyrows
[
row
].
yoff£t
 &&

209 
y
 < 
keyrows
[
row
].
yoff£t
+keyrows[row].
height
) {

210 
cﬁumn
 = 0; column < 8; column++) {

211 i‡(
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
 == 999) {

212 
	`Ârötf
(
°dîr
, "offÉnd ofÑow\n");

215 i‡(
x
 < 
keyrows
[
row
].
cﬁumns
[
cﬁumn
 + 1].
xoff£t
) {

216 
sˇncode
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].scancode;

217 
	`¥o˚ss_sˇncode
(
sˇncode
);

223 
	`Ârötf
(
°dîr
, "off bottom\n");

224 
	}
}

228 
	$maö
(
¨gc
, * 
¨gv
[])

230 
GR_EVENT
 
evít
;

231 
GR_WM_PROPERTIES
 
¥›s
;

233 
compuãr_side
;

234 
s
[256];

235 
i
;

236 
BOOL
 
found
;

237 
ãmp
[50];

239 i‡(
	`GrO≥n
() < 0) {

240 
	`Ârötf
(
°dîr
, "tuxchess: cannot open graphics\n");

241 
	`exô
(1);

244 
	`lﬂd_images
();

246 
ma°î
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
BM_WIDTH
, 
BM_HEIGHT
, 0, 
WHITE
, WHITE);

247 
bﬂrd
 = 
	`GrNewWödow
((
GR_WINDOW_ID
Ë
ma°î
, 0, 0, 394, 394, 0, 
WHITE
, WHITE);

248 
ãxt
 = 
	`GrNewWödow
((
GR_WINDOW_ID
Ë
ma°î
, 0, 393, 394, 20, 0, 
WHITE
, 
BLACK
);

250 
	`GrSñe˘Evíts
(
ma°î
, 
GR_EVENT_MASK_CLOSE_REQ
 | 
GR_EVENT_MASK_EXPOSURE
 | 
GR_EVENT_MASK_BUTTON_DOWN
);

252 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

253 
¥›s
.¥›†
GR_WM_PROPS_BORDER
 | 
GR_WM_PROPS_CAPTION
 | 
GR_WM_PROPS_CLOSEBOX
;

254 
¥›s
.
tôÀ
 = 
TITLE
;

255 
	`GrSëWMPr›îtõs
(
ma°î
, &
¥›s
);

257 
	`GrM≠Wödow
(
ma°î
);

258 
	`GrM≠Wödow
(
bﬂrd
);

259 
	`GrM≠Wödow
(
ãxt
);

261 
gc
 = 
	`GrNewGC
();

262 
ãxt_gc
 = 
	`GrNewGC
();

264 
	`öô
();

265 
	`gí
();

266 
max_time
 = 1 << 25;

267 
max_dïth
 = 4;

269 i‡(
¨gc
 > 1)

270 
compuãr_side
 = 
side
;

273 
compuãr_side
 = 
EMPTY
;

274 
	`g¥ötf
("Makeá move...");

280 i‡(
side
 =
compuãr_side
)

283 
	`thök
(0);

284 i‡(!
pv
[0][0].
u
) {

285 
	`g¥ötf
("NoÜegal moves");

286 
compuãr_side
 = 
EMPTY
;

290 
	`•rötf
(
ãmp
,"Compuãr'†move: %s\n", 
	`move_°r
(
pv
[0][0].
b
));

291 
	`g¥ötf
(
ãmp
);

292 
	`makemove
(
pv
[0][0].
b
);

293 
∂y
 = 0;

294 
	`gí
();

295 
	`¥öt_bﬂrd
();

296 
	`¥öt_ªsu…
();

300 
	`GrGëNextEvít
(&
evít
);

301 
evít
.
ty≥
)

303 
GR_EVENT_TYPE_CLOSE_REQ
:

304 
	`GrClo£
();

305 
	`exô
(0);

307 
GR_EVENT_TYPE_EXPOSURE
:

308 
	`¥öt_bﬂrd
();

309 
	`g¥ötf
(
NULL
);

311 
GR_EVENT_TYPE_BUTTON_DOWN
:

312 
	`mou£_hô
(
evít
.
buâ⁄
.
x
,Évít.buâ⁄.
y
);

316 i‡(
to
 != 999)

320 
found
 = 
FALSE
;

321 
i
 = 0; i < 
fú°_move
[1]; ++i)

322 i‡(
gí_d©
[
i
].
m
.
b
.
‰om
 =‰om && gí_d©[i].m.b.
to
 ==Åo)

324 
found
 = 
TRUE
;

327 i‡(
gí_d©
[
i
].
m
.
b
.
bôs
 & 32)

328 
s
[4])

333 
i
 += 1;

336 
i
 += 2;

339 
i
 += 3;

345 i‡(!
found
 || !
	`makemove
(
gí_d©
[
i
].
m
.
b
))

346 
	`g¥ötf
("Illegal move.\n");

349 
∂y
 = 0;

350 
	`gí
();

351 
	`¥öt_bﬂrd
();

352 
	`¥öt_ªsu…
();

353 
compuãr_side
 = 
side
;

354 
to
 = 999;

360 
	}
}

366 *
	$move_°r
(
move_byãs
 
m
)

368 
°r
[6];

369 
c
;

371 i‡(
m
.
bôs
 & 32) {

372 
m
.
¥omŸe
) {

373 
KNIGHT
:

374 
c
 = 'n';

376 
BISHOP
:

377 
c
 = 'b';

379 
ROOK
:

380 
c
 = 'r';

383 
c
 = 'q';

386 
	`•rötf
(
°r
, "%c%d%c%d%c",

387 
	`COL
(
m
.
‰om
) + 'A',

388 8 - 
	`ROW
(
m
.
‰om
),

389 
	`COL
(
m
.
to
) + 'A',

390 8 - 
	`ROW
(
m
.
to
),

391 
c
);

394 
	`•rötf
(
°r
, "%c%d%c%d",

395 
	`COL
(
m
.
‰om
) + 'A',

396 8 - 
	`ROW
(
m
.
‰om
),

397 
	`COL
(
m
.
to
) + 'A',

398 8 - 
	`ROW
(
m
.
to
));

399  
°r
;

400 
	}
}

404 
	$¥öt_bﬂrd
()

406 
row
,
cﬁumn
,
i
,
x
,
y
;

408 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 1, 0, 
bﬂrd_w
, 
bﬂrd_h
, 
bﬂrd_image_id
);

410 
row
=0;row<8;row++)

412 
cﬁumn
=0;column<8;column++)

414 
i
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
sˇncode
;

415 
cﬁ‹
[
i
])

417 
LIGHT
:

418 
põ˚_ch¨
[
põ˚
[
i
]])

421 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

422 
y
 = 
keyrows
[
row
].
yoff£t
;

423 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+10, 
y
+13, 
w_p_w
, 
w_p_h
, 
w_p_image_id
);

426 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

427 
y
 = 
keyrows
[
row
].
yoff£t
;

428 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+9, 
w_n_w
, 
w_n_h
, 
w_n_image_id
);

431 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

432 
y
 = 
keyrows
[
row
].
yoff£t
;

433 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+9, 
w_b_w
, 
w_b_h
, 
w_b_image_id
);

436 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

437 
y
 = 
keyrows
[
row
].
yoff£t
;

438 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+12, 
w_r_w
, 
w_r_h
, 
w_r_image_id
);

441 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

442 
y
 = 
keyrows
[
row
].
yoff£t
;

443 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+8, 
y
+8, 
w_q_w
, 
w_q_h
, 
w_q_image_id
);

446 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

447 
y
 = 
keyrows
[
row
].
yoff£t
;

448 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+8, 
y
+5, 
w_k_w
, 
w_k_h
, 
w_k_image_id
);

453 
DARK
:

454 
põ˚_ch¨
[
põ˚
[
i
]])

457 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

458 
y
 = 
keyrows
[
row
].
yoff£t
;

459 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+10, 
y
+13, 
b_p_w
, 
b_p_h
, 
b_p_image_id
);

462 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

463 
y
 = 
keyrows
[
row
].
yoff£t
;

464 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+9, 
b_n_w
, 
b_n_h
, 
b_n_image_id
);

467 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

468 
y
 = 
keyrows
[
row
].
yoff£t
;

469 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+9, 
b_b_w
, 
b_b_h
, 
b_b_image_id
);

472 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

473 
y
 = 
keyrows
[
row
].
yoff£t
;

474 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+9, 
y
+12, 
b_r_w
, 
b_r_h
, 
b_r_image_id
);

477 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

478 
y
 = 
keyrows
[
row
].
yoff£t
;

479 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+8, 
y
+8, 
b_q_w
, 
b_q_h
, 
b_q_image_id
);

482 
x
 = 
keyrows
[
row
].
cﬁumns
[
cﬁumn
].
xoff£t
;

483 
y
 = 
keyrows
[
row
].
yoff£t
;

484 
	`GrDøwImageToFô
(
bﬂrd
, 
gc
, 
x
+8, 
y
+5, 
b_k_w
, 
b_k_h
, 
b_k_image_id
);

491 
	}
}

496 
	$¥öt_ªsu…
()

498 
i
;

501 
i
 = 0; i < 
fú°_move
[1]; ++i)

502 i‡(
	`makemove
(
gí_d©
[
i
].
m
.
b
)) {

503 
	`èkeback
();

506 i‡(
i
 =
fú°_move
[1]) {

507 i‡(
	`ö_check
(
side
)) {

508 i‡(
side
 =
LIGHT
)

509 
	`g¥ötf
("Black mates");

511 
	`g¥ötf
("White mates");

514 
	`g¥ötf
("Stalemate");

516 i‡(
	`ªps
() == 3)

517 
	`g¥ötf
("Draw byÑepetition");

518 i‡(
fi·y
 >= 100)

519 
	`g¥ötf
("Draw by fifty moveÑule");

520 
	}
}

	@demos/tuxchess/protos.h

12 
öô
();

13 
BOOL
 
ö_check
(
s
);

14 
BOOL
 
©èck
(
sq
, 
s
);

15 
gí
();

16 
gí_ˇps
();

17 
gí_push
(
‰om
, 
to
, 
bôs
);

18 
gí_¥omŸe
(
‰om
, 
to
, 
bôs
);

19 
BOOL
 
makemove
(
move_byãs
 
m
);

20 
èkeback
();

23 
thök
(
ouçut
);

24 
£¨ch
(
Æpha
, 
bëa
, 
dïth
);

25 
quõs˚
(
Æpha
, 
bëa
);

26 
ªps
();

27 
s‹t_pv
();

28 
s‹t
(
‰om
);

29 
checkup
();

32 
evÆ
();

33 
evÆ_light_∑wn
(
sq
);

34 
evÆ_d¨k_∑wn
(
sq
);

35 
evÆ_light_kög
(
sq
);

36 
evÆ_lkp
(
f
);

37 
evÆ_d¨k_kög
(
sq
);

38 
evÆ_dkp
(
f
);

41 
gë_ms
();

42 
maö
();

43 *
move_°r
(
move_byãs
 
m
);

44 
¥öt_bﬂrd
();

45 
xbﬂrd
();

46 
¥öt_ªsu…
();

47 
bích
();

	@demos/tuxchess/search.c

9 
	~<°dio.h
>

10 
	~<°rög.h
>

11 
	~"defs.h
"

12 
	~"d©a.h
"

13 
	~"¥Ÿos.h
"

15 #i‡
PSP


16 
	#¥ötf
(...)

	)

17 
	#fÊush
(
x
)

	)

21 
	~<£tjmp.h
>

22 
jmp_buf
 
	gív
;

23 
BOOL
 
	g°›_£¨ch
;

32 
thök
(
ouçut
)

34 
	gi
, 
	gj
, 
	gx
;

38 
	g°›_£¨ch
 = 
FALSE
;

39 
£tjmp
(
ív
);

40 i‡(
	g°›_£¨ch
) {

43 
	g∂y
)

44 
èkeback
();

48 
	g°¨t_time
 = 
gë_ms
();

49 
	g°›_time
 = 
°¨t_time
 + 
max_time
;

51 
	g∂y
 = 0;

52 
	gnodes
 = 0;

53 
mem£t
(
pv
, 0, (pv));

54 
mem£t
(
hi°‹y
, 0, (history));

55 i‡(
	gouçut
 == 1)

56 
¥ötf
("plyÇodes scoreÖv\n");

57 
	gi
 = 1; i <
max_dïth
; ++i) {

58 
	gfﬁlow_pv
 = 
TRUE
;

59 
	gx
 = 
£¨ch
(-10000, 10000, 
i
);

60 i‡(
	gouçut
 == 1)

61 
¥ötf
("%3d %9d %5d ", 
i
, 
nodes
, 
x
);

62 i‡(
	gouçut
 == 2)

63 
¥ötf
("%d %d %d %d",

64 
i
, 
x
, (
gë_ms
(Ë- 
°¨t_time
Ë/ 10, 
nodes
);

65 i‡(
	gouçut
) {

66 
	gj
 = 0; j < 
	gpv_Àngth
[0]; ++j)

67 
¥ötf
(" %s", 
move_°r
(
pv
[0][
j
].
b
));

68 
¥ötf
("\n");

69 
fÊush
(
°dout
);

71 i‡(
	gx
 > 9000 || x < -9000)

79 
£¨ch
(
Æpha
, 
bëa
, 
dïth
)

81 
	gi
, 
	gj
, 
	gx
;

82 
BOOL
 
	gc
, 
	gf
;

86 i‡(!
	gdïth
)

87  
quõs˚
(
Æpha
,
bëa
);

88 ++
	gnodes
;

91 i‡((
	gnodes
 & 1023) == 0)

92 
checkup
();

94 
	gpv_Àngth
[
∂y
] =Öly;

100 i‡(
	g∂y
 && 
ªps
())

104 i‡(
	g∂y
 >
MAX_PLY
 - 1)

105  
evÆ
();

106 i‡(
	gh∂y
 >
HIST_STACK
 - 1)

107  
evÆ
();

110 
	gc
 = 
ö_check
(
side
);

111 i‡(
	gc
)

112 ++
	gdïth
;

113 
gí
();

114 i‡(
	gfﬁlow_pv
)

115 
s‹t_pv
();

116 
	gf
 = 
FALSE
;

119 
	gi
 = 
fú°_move
[
∂y
]; i < 
	gfú°_move
[ply + 1]; ++i) {

120 
s‹t
(
i
);

121 i‡(!
makemove
(
gí_d©
[
i
].
m
.
b
))

123 
	gf
 = 
TRUE
;

124 
	gx
 = -
£¨ch
(-
bëa
, -
Æpha
, 
dïth
 - 1);

125 
èkeback
();

126 i‡(
	gx
 > 
	gÆpha
) {

131 
	ghi°‹y
[()
gí_d©
[
i
].
	gm
.
	gb
.
	g‰om
][()gí_d©[i].m.b.
	gto
] +
dïth
;

132 i‡(
	gx
 >
bëa
)

133  
bëa
;

134 
	gÆpha
 = 
x
;

137 
	gpv
[
∂y
][∂y] = 
gí_d©
[
i
].
m
;

138 
	gj
 = 
∂y
 + 1; j < 
	gpv_Àngth
[ply + 1]; ++j)

139 
	gpv
[
∂y
][
j
] = 
pv
[ply + 1][j];

140 
	gpv_Àngth
[
∂y
] = 
pv_Àngth
[ply + 1];

145 i‡(!
	gf
) {

146 i‡(
	gc
)

147  -10000 + 
	g∂y
;

153 i‡(
	gfi·y
 >= 100)

155  
	gÆpha
;

166 
quõs˚
(
Æpha
,
bëa
)

168 
	gi
, 
	gj
, 
	gx
;

170 ++
	gnodes
;

173 i‡((
	gnodes
 & 1023) == 0)

174 
checkup
();

176 
	gpv_Àngth
[
∂y
] =Öly;

179 i‡(
	g∂y
 >
MAX_PLY
 - 1)

180  
evÆ
();

181 i‡(
	gh∂y
 >
HIST_STACK
 - 1)

182  
evÆ
();

185 
	gx
 = 
evÆ
();

186 i‡(
	gx
 >
bëa
)

187  
bëa
;

188 i‡(
	gx
 > 
	gÆpha
)

189 
	gÆpha
 = 
x
;

191 
gí_ˇps
();

192 i‡(
	gfﬁlow_pv
)

193 
s‹t_pv
();

196 
	gi
 = 
fú°_move
[
∂y
]; i < 
	gfú°_move
[ply + 1]; ++i) {

197 
s‹t
(
i
);

198 i‡(!
makemove
(
gí_d©
[
i
].
m
.
b
))

200 
	gx
 = -
quõs˚
(-
bëa
, -
Æpha
);

201 
èkeback
();

202 i‡(
	gx
 > 
	gÆpha
) {

203 i‡(
	gx
 >
bëa
)

204  
bëa
;

205 
	gÆpha
 = 
x
;

208 
	gpv
[
∂y
][∂y] = 
gí_d©
[
i
].
m
;

209 
	gj
 = 
∂y
 + 1; j < 
	gpv_Àngth
[ply + 1]; ++j)

210 
	gpv
[
∂y
][
j
] = 
pv
[ply + 1][j];

211 
	gpv_Àngth
[
∂y
] = 
pv_Àngth
[ply + 1];

214  
	gÆpha
;

222 
ªps
()

224 
	gi
;

225 
	gb
[64];

226 
	gc
 = 0;

228 
	gr
 = 0;

231 i‡(
	gfi·y
 <= 3)

234 
mem£t
(
b
, 0, (b));

237 
	gi
 = 
h∂y
 - 1; i >h∂y - 
fi·y
 - 1; --i) {

238 i‡(++
	gb
[()
hi°_d©
[
i
].
	gm
.b.
	g‰om
] == 0)

239 --
c
;

241 ++
	gc
;

242 i‡(--
	gb
[()
hi°_d©
[
i
].
	gm
.b.
	gto
] == 0)

243 --
c
;

245 ++
	gc
;

246 i‡(
	gc
 == 0)

247 ++
r
;

250  
	gr
;

261 
s‹t_pv
()

263 
	gi
;

265 
	gfﬁlow_pv
 = 
FALSE
;

266 
	gi
 = 
fú°_move
[
∂y
]; i < 
	gfú°_move
[ply + 1]; ++i)

267 i‡(
	ggí_d©
[
i
].
	gm
.
	gu
 =
pv
[0][
∂y
].
u
) {

268 
fﬁlow_pv
 = 
TRUE
;

269 
	ggí_d©
[
i
].
	gsc‹e
 += 10000000;

281 
s‹t
(
‰om
)

283 
	gi
;

284 
	gbs
;

285 
	gbi
;

286 
gí_t
 
	gg
;

288 
	gbs
 = -1;

289 
	gbi
 = 
‰om
;

290 
	gi
 = 
‰om
; i < 
	gfú°_move
[
∂y
 + 1]; ++i)

291 i‡(
	ggí_d©
[
i
].
	gsc‹e
 > 
	gbs
) {

292 
	gbs
 = 
gí_d©
[
i
].
sc‹e
;

293 
	gbi
 = 
i
;

295 
	gg
 = 
gí_d©
[
‰om
];

296 
	ggí_d©
[
‰om
] = 
gí_d©
[
bi
];

297 
	ggí_d©
[
bi
] = 
g
;

303 
checkup
()

307 i‡(
gë_ms
(Ë>
°›_time
) {

308 
°›_£¨ch
 = 
TRUE
;

309 
l⁄gjmp
(
ív
, 0);

	@demos/vnc/include/rfbproto.h

58 
CARD16
 
	mx
;

59 
CARD16
 
	my
;

60 
CARD16
 
	mw
;

61 
CARD16
 
	mh
;

62 } 
	trfbRe˘™gÀ
;

64 
	#sz_rfbRe˘™gÀ
 8

	)

73 
CARD8
 
	mbôsPîPixñ
;

75 
CARD8
 
	mdïth
;

77 
CARD8
 
	mbigEndün
;

83 
CARD8
 
	måueCﬁour
;

90 
CARD16
 
	mªdMax
;

94 
CARD16
 
	mgªíMax
;

96 
CARD16
 
	mblueMax
;

98 
CARD8
 
	mªdShi·
;

110 
CARD8
 
	mgªíShi·
;

112 
CARD8
 
	mblueShi·
;

114 
CARD8
 
	m∑d1
;

115 
CARD16
 
	m∑d2
;

117 } 
	trfbPixñF‹m©
;

119 
	#sz_rfbPixñF‹m©
 16

	)

154 
	#rfbPrŸocﬁVîsi⁄F‹m©
 "RFB %03d.%03d\n"

	)

155 
	#rfbPrŸocﬁMaj‹Vîsi⁄
 3

	)

156 
	#rfbPrŸocﬁMö‹Vîsi⁄
 3

	)

158 
	trfbPrŸocﬁVîsi⁄Msg
[13];

160 
	#sz_rfbPrŸocﬁVîsi⁄Msg
 12

	)

172 
	#rfbC⁄nFaûed
 0

	)

173 
	#rfbNoAuth
 1

	)

174 
	#rfbVncAuth
 2

	)

198 
	#rfbVncAuthOK
 0

	)

199 
	#rfbVncAuthFaûed
 1

	)

200 
	#rfbVncAuthTooM™y
 2

	)

214 
CARD8
 
	msh¨ed
;

215 } 
	trfbClõ¡InôMsg
;

217 
	#sz_rfbClõ¡InôMsg
 1

	)

229 
CARD16
 
	m‰amebuf„rWidth
;

230 
CARD16
 
	m‰amebuf„rHeight
;

231 
rfbPixñF‹m©
 
	mf‹m©
;

232 
CARD32
 
	m«meLígth
;

234 } 
	trfbSîvîInôMsg
;

236 
	#sz_rfbSîvîInôMsg
 (8 + 
sz_rfbPixñF‹m©
)

	)

262 
	#rfbFømebuf„rUpd©e
 0

	)

263 
	#rfbSëCﬁourM≠E¡rõs
 1

	)

264 
	#rfbBñl
 2

	)

265 
	#rfbSîvîCutText
 3

	)

270 
	#rfbSëPixñF‹m©
 0

	)

271 
	#rfbFixCﬁourM≠E¡rõs
 1

	)

272 
	#rfbSëEncodögs
 2

	)

273 
	#rfbFømebuf„rUpd©eReque°
 3

	)

274 
	#rfbKeyEvít
 4

	)

275 
	#rfbPoöãrEvít
 5

	)

276 
	#rfbClõ¡CutText
 6

	)

287 
	#rfbEncodögRaw
 0

	)

288 
	#rfbEncodögC›yRe˘
 1

	)

289 
	#rfbEncodögRRE
 2

	)

290 
	#rfbEncodögCoRRE
 4

	)

291 
	#rfbEncodögHextûe
 5

	)

312 
CARD8
 
	mty≥
;

313 
CARD8
 
	m∑d
;

314 
CARD16
 
	mnRe˘s
;

316 } 
	trfbFømebuf„rUpd©eMsg
;

318 
	#sz_rfbFømebuf„rUpd©eMsg
 4

	)

329 
rfbRe˘™gÀ
 
	mr
;

330 
CARD32
 
	mícodög
;

331 } 
	trfbFømebuf„rUpd©eRe˘Hódî
;

333 
	#sz_rfbFømebuf„rUpd©eRe˘Hódî
 (
sz_rfbRe˘™gÀ
 + 4)

	)

348 
CARD16
 
	m§cX
;

349 
CARD16
 
	m§cY
;

350 } 
	trfbC›yRe˘
;

352 
	#sz_rfbC›yRe˘
 4

	)

363 
CARD32
 
	mnSubª˘s
;

364 } 
	trfbRREHódî
;

366 
	#sz_rfbRREHódî
 4

	)

378 
CARD8
 
	mx
;

379 
CARD8
 
	my
;

380 
CARD8
 
	mw
;

381 
CARD8
 
	mh
;

382 } 
	trfbCoRRERe˘™gÀ
;

384 
	#sz_rfbCoRRERe˘™gÀ
 4

	)

426 
	#rfbHextûeRaw
 (1 << 0)

	)

427 
	#rfbHextûeBackgroundS≥cifõd
 (1 << 1)

	)

428 
	#rfbHextûeF‹egroundS≥cifõd
 (1 << 2)

	)

429 
	#rfbHextûeAnySubª˘s
 (1 << 3)

	)

430 
	#rfbHextûeSubª˘sCﬁouªd
 (1 << 4)

	)

432 
	#rfbHextûePackXY
(
x
,
y
Ë(((xË<< 4Ë| (y))

	)

433 
	#rfbHextûePackWH
(
w
,
h
Ë((((w)-1Ë<< 4Ë| ((h)-1))

	)

434 
	#rfbHextûeExåa˘X
(
byã
Ë((byãË>> 4)

	)

435 
	#rfbHextûeExåa˘Y
(
byã
Ë((byãË& 0xf)

	)

436 
	#rfbHextûeExåa˘W
(
byã
Ë(((byãË>> 4Ë+ 1)

	)

437 
	#rfbHextûeExåa˘H
(
byã
Ë(((byãË& 0xfË+ 1)

	)

450 
CARD8
 
	mty≥
;

451 
CARD8
 
	m∑d
;

452 
CARD16
 
	mfú°Cﬁour
;

453 
CARD16
 
	mnCﬁours
;

458 } 
	trfbSëCﬁourM≠E¡rõsMsg
;

460 
	#sz_rfbSëCﬁourM≠E¡rõsMsg
 6

	)

469 
CARD8
 
	mty≥
;

470 } 
	trfbBñlMsg
;

472 
	#sz_rfbBñlMsg
 1

	)

481 
CARD8
 
	mty≥
;

482 
CARD8
 
	m∑d1
;

483 
CARD16
 
	m∑d2
;

484 
CARD32
 
	mÀngth
;

486 } 
	trfbSîvîCutTextMsg
;

488 
	#sz_rfbSîvîCutTextMsg
 8

	)

496 
CARD8
 
	mty≥
;

497 
rfbFømebuf„rUpd©eMsg
 
	mfu
;

498 
rfbSëCﬁourM≠E¡rõsMsg
 
	mscme
;

499 
rfbBñlMsg
 
	mb
;

500 
rfbSîvîCutTextMsg
 
	ms˘
;

501 } 
	trfbSîvîToClõ¡Msg
;

518 
CARD8
 
	mty≥
;

519 
CARD8
 
	m∑d1
;

520 
CARD16
 
	m∑d2
;

521 
rfbPixñF‹m©
 
	mf‹m©
;

522 } 
	trfbSëPixñF‹m©Msg
;

524 
	#sz_rfbSëPixñF‹m©Msg
 (
sz_rfbPixñF‹m©
 + 4)

	)

535 
CARD8
 
	mty≥
;

536 
CARD8
 
	m∑d
;

537 
CARD16
 
	mfú°Cﬁour
;

538 
CARD16
 
	mnCﬁours
;

543 } 
	trfbFixCﬁourM≠E¡rõsMsg
;

545 
	#sz_rfbFixCﬁourM≠E¡rõsMsg
 6

	)

555 
CARD8
 
	mty≥
;

556 
CARD8
 
	m∑d
;

557 
CARD16
 
	mnEncodögs
;

559 } 
	trfbSëEncodögsMsg
;

561 
	#sz_rfbSëEncodögsMsg
 4

	)

571 
CARD8
 
	mty≥
;

572 
CARD8
 
	mö¸emíèl
;

573 
CARD16
 
	mx
;

574 
CARD16
 
	my
;

575 
CARD16
 
	mw
;

576 
CARD16
 
	mh
;

577 } 
	trfbFømebuf„rUpd©eReque°Msg
;

579 
	#sz_rfbFømebuf„rUpd©eReque°Msg
 10

	)

614 
CARD8
 
	mty≥
;

615 
CARD8
 
	mdown
;

616 
CARD16
 
	m∑d
;

617 
CARD32
 
	mkey
;

618 } 
	trfbKeyEvítMsg
;

620 
	#sz_rfbKeyEvítMsg
 8

	)

628 
CARD8
 
	mty≥
;

629 
CARD8
 
	mbuâ⁄Mask
;

630 
CARD16
 
	mx
;

631 
CARD16
 
	my
;

632 } 
	trfbPoöãrEvítMsg
;

634 
	#rfbBuâ⁄1Mask
 1

	)

635 
	#rfbBuâ⁄2Mask
 2

	)

636 
	#rfbBuâ⁄3Mask
 4

	)

638 
	#sz_rfbPoöãrEvítMsg
 6

	)

647 
CARD8
 
	mty≥
;

648 
CARD8
 
	m∑d1
;

649 
CARD16
 
	m∑d2
;

650 
CARD32
 
	mÀngth
;

652 } 
	trfbClõ¡CutTextMsg
;

654 
	#sz_rfbClõ¡CutTextMsg
 8

	)

663 
CARD8
 
	mty≥
;

664 
rfbSëPixñF‹m©Msg
 
	m•f
;

665 
rfbFixCﬁourM≠E¡rõsMsg
 
	mfcme
;

666 
rfbSëEncodögsMsg
 
	m£
;

667 
rfbFømebuf„rUpd©eReque°Msg
 
	mfur
;

668 
rfbKeyEvítMsg
 
	mke
;

669 
rfbPoöãrEvítMsg
 
	m≥
;

670 
rfbClõ¡CutTextMsg
 
	mc˘
;

671 } 
	trfbClõ¡ToSîvîMsg
;

	@demos/vnc/include/vncauth.h

24 
	#MAXPWLEN
 8

	)

25 
	#CHALLENGESIZE
 16

	)

27 
vncEn¸y±AndSt‹ePasswd
(*
∑sswd
, *
‚ame
);

28 *
vncDe¸y±PasswdFromFûe
(*
‚ame
);

29 
vncR™domByãs
(*
byãs
);

30 
vncEn¸y±Byãs
(*
byãs
, *
∑sswd
);

	@demos/vnc/libvncauth/d3des.c

28 
	~"d3des.h
"

30 
s¸unch
(*, *);

31 
uns¸un
(*, *);

32 
desfunc
(*, *);

33 
cookey
(*);

35 
	gKnL
[32] = { 0L };

43 
	gbyãbô
[8] = {

46 
	gbigbyã
[24] = {

56 
	gpc1
[56] = {

62 
	gtŸrŸ
[16] = {

65 
	gpc2
[48] = {

72 
	$deskey
(*
key
, 
edf
)

74 
i
, 
j
, 
l
, 
m
, 
n
;

75 
pc1m
[56], 
p¸
[56];

76 
kn
[32];

78  
j
 = 0; j < 56; j++ ) {

79 
l
 = 
pc1
[
j
];

80 
m
 = 
l
 & 07;

81 
pc1m
[
j
] = (
key
[
l
 >> 3] & 
byãbô
[
m
]) ? 1 : 0;

83  
i
 = 0; i < 16; i++ ) {

84 if–
edf
 =
DE1
 ) 
m
 = (15 - 
i
) << 1;

85 
m
 = 
i
 << 1;

86 
n
 = 
m
 + 1;

87 
kn
[
m
] = kn[
n
] = 0L;

88  
j
 = 0; j < 28; j++ ) {

89 
l
 = 
j
 + 
tŸrŸ
[
i
];

90 if–
l
 < 28 ) 
p¸
[
j
] = 
pc1m
[l];

91 
p¸
[
j
] = 
pc1m
[
l
 - 28];

93  
j
 = 28; j < 56; j++ ) {

94 
l
 = 
j
 + 
tŸrŸ
[
i
];

95 if–
l
 < 56 ) 
p¸
[
j
] = 
pc1m
[l];

96 
p¸
[
j
] = 
pc1m
[
l
 - 28];

98  
j
 = 0; j < 24; j++ ) {

99 if–
p¸
[
pc2
[
j
]] ) 
kn
[
m
] |
bigbyã
[j];

100 if–
p¸
[
pc2
[
j
+24]] ) 
kn
[
n
] |
bigbyã
[j];

103 
	`cookey
(
kn
);

105 
	}
}

107 
	$cookey
(*
øw1
)

109 *
cook
, *
øw0
;

110 
dough
[32];

111 
i
;

113 
cook
 = 
dough
;

114  
i
 = 0; i < 16; i++, 
øw1
++ ) {

115 
øw0
 = 
øw1
++;

116 *
cook
 = (*
øw0
 & 0x00fc0000L) << 6;

117 *
cook
 |(*
øw0
 & 0x00000fc0L) << 10;

118 *
cook
 |(*
øw1
 & 0x00fc0000L) >> 10;

119 *
cook
++ |(*
øw1
 & 0x00000fc0L) >> 6;

120 *
cook
 = (*
øw0
 & 0x0003f000L) << 12;

121 *
cook
 |(*
øw0
 & 0x0000003fL) << 16;

122 *
cook
 |(*
øw1
 & 0x0003f000L) >> 4;

123 *
cook
++ |(*
øw1
 & 0x0000003fL);

125 
	`u£key
(
dough
);

127 
	}
}

129 
	$˝key
(*
öto
)

131 *
‰om
, *
ídp
;

133 
‰om
 = 
KnL
, 
ídp
 = &KnL[32];

134  
‰om
 < 
ídp
 ) *
öto
++ = *from++;

136 
	}
}

138 
	$u£key
(*
‰om
)

140 *
to
, *
ídp
;

142 
to
 = 
KnL
, 
ídp
 = &KnL[32];

143  
to
 < 
ídp
 ) *to++ = *
‰om
++;

145 
	}
}

147 
	$des
(*
öblock
, *
outblock
)

149 
w‹k
[2];

151 
	`s¸unch
(
öblock
, 
w‹k
);

152 
	`desfunc
(
w‹k
, 
KnL
);

153 
	`uns¸un
(
w‹k
, 
outblock
);

155 
	}
}

157 
	$s¸unch
(*
outof
, *
öto
)

159 *
öto
 = (*
outof
++ & 0xffL) << 24;

160 *
öto
 |(*
outof
++ & 0xffL) << 16;

161 *
öto
 |(*
outof
++ & 0xffL) << 8;

162 *
öto
++ |(*
outof
++ & 0xffL);

163 *
öto
 = (*
outof
++ & 0xffL) << 24;

164 *
öto
 |(*
outof
++ & 0xffL) << 16;

165 *
öto
 |(*
outof
++ & 0xffL) << 8;

166 *
öto
 |(*
outof
 & 0xffL);

168 
	}
}

170 
	$uns¸un
(*
outof
, *
öto
)

172 *
öto
++ = (*
outof
 >> 24) & 0xffL;

173 *
öto
++ = (*
outof
 >> 16) & 0xffL;

174 *
öto
++ = (*
outof
 >> 8) & 0xffL;

175 *
öto
++ = *
outof
++ & 0xffL;

176 *
öto
++ = (*
outof
 >> 24) & 0xffL;

177 *
öto
++ = (*
outof
 >> 16) & 0xffL;

178 *
öto
++ = (*
outof
 >> 8) & 0xffL;

179 *
öto
 = *
outof
 & 0xffL;

181 
	}
}

183 
	gSP1
[64] = {

201 
	gSP2
[64] = {

219 
	gSP3
[64] = {

237 
	gSP4
[64] = {

255 
	gSP5
[64] = {

273 
	gSP6
[64] = {

291 
	gSP7
[64] = {

309 
	gSP8
[64] = {

327 
	$desfunc
(*
block
, *
keys
)

329 
fvÆ
, 
w‹k
, 
right
, 
À·t
;

330 
round
;

332 
À·t
 = 
block
[0];

333 
right
 = 
block
[1];

334 
w‹k
 = ((
À·t
 >> 4Ë^ 
right
) & 0x0f0f0f0fL;

335 
right
 ^
w‹k
;

336 
À·t
 ^(
w‹k
 << 4);

337 
w‹k
 = ((
À·t
 >> 16Ë^ 
right
) & 0x0000ffffL;

338 
right
 ^
w‹k
;

339 
À·t
 ^(
w‹k
 << 16);

340 
w‹k
 = ((
right
 >> 2Ë^ 
À·t
) & 0x33333333L;

341 
À·t
 ^
w‹k
;

342 
right
 ^(
w‹k
 << 2);

343 
w‹k
 = ((
right
 >> 8Ë^ 
À·t
) & 0x00ff00ffL;

344 
À·t
 ^
w‹k
;

345 
right
 ^(
w‹k
 << 8);

346 
right
 = ((right << 1) | ((right >> 31) & 1L)) & 0xffffffffL;

347 
w‹k
 = (
À·t
 ^ 
right
) & 0xaaaaaaaaL;

348 
À·t
 ^
w‹k
;

349 
right
 ^
w‹k
;

350 
À·t
 = ((leftt << 1) | ((leftt >> 31) & 1L)) & 0xffffffffL;

352  
round
 = 0;Ñound < 8;Ñound++ ) {

353 
w‹k
 = (
right
 << 28) | (right >> 4);

354 
w‹k
 ^*
keys
++;

355 
fvÆ
 = 
SP7
[ 
w‹k
 & 0x3fL];

356 
fvÆ
 |
SP5
[(
w‹k
 >> 8) & 0x3fL];

357 
fvÆ
 |
SP3
[(
w‹k
 >> 16) & 0x3fL];

358 
fvÆ
 |
SP1
[(
w‹k
 >> 24) & 0x3fL];

359 
w‹k
 = 
right
 ^ *
keys
++;

360 
fvÆ
 |
SP8
[ 
w‹k
 & 0x3fL];

361 
fvÆ
 |
SP6
[(
w‹k
 >> 8) & 0x3fL];

362 
fvÆ
 |
SP4
[(
w‹k
 >> 16) & 0x3fL];

363 
fvÆ
 |
SP2
[(
w‹k
 >> 24) & 0x3fL];

364 
À·t
 ^
fvÆ
;

365 
w‹k
 = (
À·t
 << 28) | (leftt >> 4);

366 
w‹k
 ^*
keys
++;

367 
fvÆ
 = 
SP7
[ 
w‹k
 & 0x3fL];

368 
fvÆ
 |
SP5
[(
w‹k
 >> 8) & 0x3fL];

369 
fvÆ
 |
SP3
[(
w‹k
 >> 16) & 0x3fL];

370 
fvÆ
 |
SP1
[(
w‹k
 >> 24) & 0x3fL];

371 
w‹k
 = 
À·t
 ^ *
keys
++;

372 
fvÆ
 |
SP8
[ 
w‹k
 & 0x3fL];

373 
fvÆ
 |
SP6
[(
w‹k
 >> 8) & 0x3fL];

374 
fvÆ
 |
SP4
[(
w‹k
 >> 16) & 0x3fL];

375 
fvÆ
 |
SP2
[(
w‹k
 >> 24) & 0x3fL];

376 
right
 ^
fvÆ
;

379 
right
 = (right << 31) | (right >> 1);

380 
w‹k
 = (
À·t
 ^ 
right
) & 0xaaaaaaaaL;

381 
À·t
 ^
w‹k
;

382 
right
 ^
w‹k
;

383 
À·t
 = (leftt << 31) | (leftt >> 1);

384 
w‹k
 = ((
À·t
 >> 8Ë^ 
right
) & 0x00ff00ffL;

385 
right
 ^
w‹k
;

386 
À·t
 ^(
w‹k
 << 8);

387 
w‹k
 = ((
À·t
 >> 2Ë^ 
right
) & 0x33333333L;

388 
right
 ^
w‹k
;

389 
À·t
 ^(
w‹k
 << 2);

390 
w‹k
 = ((
right
 >> 16Ë^ 
À·t
) & 0x0000ffffL;

391 
À·t
 ^
w‹k
;

392 
right
 ^(
w‹k
 << 16);

393 
w‹k
 = ((
right
 >> 4Ë^ 
À·t
) & 0x0f0f0f0fL;

394 
À·t
 ^
w‹k
;

395 
right
 ^(
w‹k
 << 4);

396 *
block
++ = 
right
;

397 *
block
 = 
À·t
;

399 
	}
}

	@demos/vnc/libvncauth/d3des.h

21 
	#EN0
 0

	)

22 
	#DE1
 1

	)

24 
deskey
(*, );

31 
u£key
(*);

36 
˝key
(*);

42 
des
(*, *);

	@demos/vnc/libvncauth/vncauth.c

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<°rög.h
>

27 
	~<time.h
>

28 
	~<sys/ty≥s.h
>

29 
	~<sys/°©.h
>

30 
	~<vnˇuth.h
>

31 
	~<d3des.h
>

40 
	gfixedkey
[8] = {23,82,107,6,35,78,88,7};

49 
	$vncEn¸y±AndSt‹ePasswd
(*
∑sswd
, *
‚ame
)

51 
FILE
 *
Â
;

52 
i
;

53 
í¸y±edPasswd
[8];

55 i‡((
Â
 = 
	`f›í
(
‚ame
,"w")Ë=
NULL
)  1;

57 
	`chmod
(
‚ame
, 
S_IRUSR
|
S_IWUSR
);

61 
i
 = 0; i < 8; i++) {

62 i‡(
i
 < 
	`°æí
(
∑sswd
)) {

63 
í¸y±edPasswd
[
i
] = 
∑sswd
[i];

65 
í¸y±edPasswd
[
i
] = 0;

72 
	`deskey
(
fixedkey
, 
EN0
);

73 
	`des
(
í¸y±edPasswd
,ÉncryptedPasswd);

75 
i
 = 0; i < 8; i++) {

76 
	`putc
(
í¸y±edPasswd
[
i
], 
Â
);

79 
	`f˛o£
(
Â
);

81 
	}
}

91 
	$vncDe¸y±PasswdFromFûe
(*
‚ame
)

93 
FILE
 *
Â
;

94 
i
, 
ch
;

95 *
∑sswd
 = (*)
	`mÆloc
(9);

97 i‡((
Â
 = 
	`f›í
(
‚ame
,"r")Ë=
NULL
)  NULL;

99 
i
 = 0; i < 8; i++) {

100 
ch
 = 
	`gëc
(
Â
);

101 i‡(
ch
 =
EOF
) {

102 
	`f˛o£
(
Â
);

103  
NULL
;

105 
∑sswd
[
i
] = 
ch
;

108 
	`f˛o£
(
Â
);

110 
	`deskey
(
fixedkey
, 
DE1
);

111 
	`des
(
∑sswd
,Öasswd);

113 
∑sswd
[8] = 0;

115  (*)
∑sswd
;

116 
	}
}

125 
	$vncR™domByãs
(*
byãs
)

127 
i
;

128 
£ed
 = (Ë
	`time
(0);

130 
	`§™dom
(
£ed
);

131 
i
 = 0; i < 
CHALLENGESIZE
; i++) {

132 
byãs
[
i
] = ()(
	`øndom
() & 255);

134 
	}
}

142 
	$vncEn¸y±Byãs
(*
byãs
, *
∑sswd
)

144 
key
[8];

145 
i
;

149 
i
 = 0; i < 8; i++) {

150 i‡(
i
 < 
	`°æí
(
∑sswd
)) {

151 
key
[
i
] = 
∑sswd
[i];

153 
key
[
i
] = 0;

157 
	`deskey
(
key
, 
EN0
);

159 
i
 = 0; i < 
CHALLENGESIZE
; i += 8) {

160 
	`des
(
byãs
+
i
, bytes+i);

162 
	}
}

	@demos/vnc/vncviewer/args.c

24 
	~<sys/ut¢ame.h
>

25 
	~<vncvõwî.h
>

27 
	#FLASHPORT
 (5400Ë

	)

28 
	#CLIENTPORT
 (5500Ë

	)

29 
	#SERVERPORT
 (5900Ë

	)

31 *
	g¥ogømName
;

33 
	gho°«me
[256];

34 
	gp‹t
;

36 
Boﬁ
 
	gli°íS≥cifõd
 = 
FÆ£
;

37 
	gli°íP‹t
 = 0, 
	gÊashP‹t
 = 0;

39 *
	gdi•œy«me
 = 
NULL
;

41 
Boﬁ
 
	gsh¨eDeskt›
 = 
FÆ£
;

42 
Boﬁ
 
	gvõwO∆y
 = 
FÆ£
;

44 
CARD32
 
	gex∂icôEncodögs
[
MAX_ENCODINGS
];

45 
	gnEx∂icôEncodögs
 = 0;

46 
Boﬁ
 
	gaddC›yRe˘
 = 
True
;

47 
Boﬁ
 
	gaddRRE
 = 
True
;

48 
Boﬁ
 
	gaddCoRRE
 = 
True
;

49 
Boﬁ
 
	gaddHextûe
 = 
True
;

51 
Boﬁ
 
	gu£BGR233
 = 
FÆ£
;

52 
Boﬁ
 
	gf‹˚OwnCm≠
 = 
FÆ£
;

53 
Boﬁ
 
	gf‹˚Truecﬁour
 = 
FÆ£
;

54 
	gªque°edDïth
 = 0;

56 *
	ggeomëry
 = 
NULL
;

58 
	gwmDec‹©i⁄Width
 = 4;

59 
	gwmDec‹©i⁄Height
 = 24;

61 *
	g∑sswdFûe
 = 
NULL
;

63 
	gupd©eReque°Pîiodms
 = 0;

65 
	gupd©eReque°X
 = 0;

66 
	gupd©eReque°Y
 = 0;

67 
	gupd©eReque°W
 = 0;

68 
	gupd©eReque°H
 = 0;

70 
	gøwDñay
 = 0;

71 
	gc›yRe˘Dñay
 = 0;

73 
Boﬁ
 
	gdebug
 = 
FÆ£
;

77 
	$ußge
()

79 
	`Ârötf
(
°dîr
,"\n"

83 "<›ti⁄s>áª:\n" ,
¥ogømName
,programName);

84 
	`Ârötf
(
°dîr
,

96 
	`exô
(1);

97 
	}
}

101 
	$¥o˚ssArgs
(
¨gc
, **
¨gv
)

103 
i
;

104 
Boﬁ
 
¨gumítS≥cifõd
 = 
FÆ£
;

106 
¥ogømName
 = 
¨gv
[0];

108 
i
 = 1; i < 
¨gc
; i++) {

110 i‡(
	`°rcmp
(
¨gv
[
i
],"-display") == 0) {

112 i‡(++
i
 >
¨gc
Ë
	`ußge
();

113 
di•œy«me
 = 
¨gv
[
i
];

115 } i‡(
	`°rcmp
(
¨gv
[
i
],"-shared") == 0) {

117 
sh¨eDeskt›
 = 
True
;

119 } i‡(
	`°rcmp
(
¨gv
[
i
],"-viewonly") == 0) {

121 
võwO∆y
 = 
True
;

123 } i‡(
	`°rcmp
(
¨gv
[
i
],"-rre") == 0) {

125 
ex∂icôEncodögs
[
nEx∂icôEncodögs
++] = 
rfbEncodögRRE
;

126 
addRRE
 = 
FÆ£
;

128 } i‡(
	`°rcmp
(
¨gv
[
i
],"-corre") == 0) {

130 
ex∂icôEncodögs
[
nEx∂icôEncodögs
++] = 
rfbEncodögCoRRE
;

131 
addCoRRE
 = 
FÆ£
;

133 } i‡(
	`°rcmp
(
¨gv
[
i
],"-hextile") == 0) {

135 
ex∂icôEncodögs
[
nEx∂icôEncodögs
++] = 
rfbEncodögHextûe
;

136 
addHextûe
 = 
FÆ£
;

138 } i‡(
	`°rcmp
(
¨gv
[
i
],"-copyrect") == 0) {

140 
ex∂icôEncodögs
[
nEx∂icôEncodögs
++] = 
rfbEncodögC›yRe˘
;

141 
addC›yRe˘
 = 
FÆ£
;

143 } i‡(
	`°rcmp
(
¨gv
[
i
],"-raw") == 0) {

145 
ex∂icôEncodögs
[
nEx∂icôEncodögs
++] = 
rfbEncodögRaw
;

147 } i‡(
	`°rcmp
(
¨gv
[
i
],"-norre") == 0) {

149 
addRRE
 = 
FÆ£
;

151 } i‡(
	`°rcmp
(
¨gv
[
i
],"-nocorre") == 0) {

153 
addCoRRE
 = 
FÆ£
;

155 } i‡(
	`°rcmp
(
¨gv
[
i
],"-nohextile") == 0) {

157 
addHextûe
 = 
FÆ£
;

159 } i‡(
	`°rcmp
(
¨gv
[
i
],"-nocopyrect") == 0) {

161 
addC›yRe˘
 = 
FÆ£
;

163 } i‡(
	`°rcmp
(
¨gv
[
i
],"-bgr233") == 0) {

165 
u£BGR233
 = 
True
;

167 } i‡(
	`°rcmp
(
¨gv
[
i
],"-owncmap") == 0) {

169 
f‹˚OwnCm≠
 = 
True
;

171 } i‡(
	`°rcmp
(
¨gv
[
i
],"-truecolour") == 0) {

173 
f‹˚Truecﬁour
 = 
True
;

175 } i‡(
	`°rcmp
(
¨gv
[
i
],"-depth") == 0) {

177 i‡(++
i
 >
¨gc
Ë
	`ußge
();

178 
ªque°edDïth
 = 
	`©oi
(
¨gv
[
i
]);

180 } i‡(
	`°rcmp
(
¨gv
[
i
],"-geometry") == 0) {

182 i‡(++
i
 >
¨gc
Ë
	`ußge
();

183 
geomëry
 = 
¨gv
[
i
];

185 } i‡(
	`°rcmp
(
¨gv
[
i
],"-wmdecoration") == 0) {

187 i‡(++
i
 >
¨gc
Ë
	`ußge
();

188 i‡(
	`ssˇnf
(
¨gv
[
i
], "%dx%d",

189 &
wmDec‹©i⁄Width
, &
wmDec‹©i⁄Height
Ë!2Ë
	`ußge
();

191 } i‡(
	`°rcmp
(
¨gv
[
i
],"-passwd") == 0) {

193 i‡(++
i
 >
¨gc
Ë
	`ußge
();

194 
∑sswdFûe
 = 
¨gv
[
i
];

196 } i‡(
	`°rcmp
(
¨gv
[
i
],"-period") == 0) {

198 i‡(++
i
 >
¨gc
Ë
	`ußge
();

199 
upd©eReque°Pîiodms
 = 
	`©oi
(
¨gv
[
i
]);

201 } i‡(
	`°rcmp
(
¨gv
[
i
],"-region") == 0) {

203 i‡((
i
+4Ë>
¨gc
Ë
	`ußge
();

204 
upd©eReque°X
 = 
	`©oi
(
¨gv
[
i
+1]);

205 
upd©eReque°Y
 = 
	`©oi
(
¨gv
[
i
+2]);

206 
upd©eReque°W
 = 
	`©oi
(
¨gv
[
i
+3]);

207 
upd©eReque°H
 = 
	`©oi
(
¨gv
[
i
+4]);

208 i‡((
upd©eReque°X
 < 0Ë|| (
upd©eReque°Y
 < 0) ||

209 (
upd©eReque°W
 < 0Ë|| (
upd©eReque°H
 < 0))

210 
	`ußge
();

211 
i
 += 4;

213 } i‡(
	`°rcmp
(
¨gv
[
i
],"-rawdelay") == 0) {

215 i‡(++
i
 >
¨gc
Ë
	`ußge
();

216 
øwDñay
 = 
	`©oi
(
¨gv
[
i
]);

218 } i‡(
	`°rcmp
(
¨gv
[
i
],"-copyrectdelay") == 0) {

220 i‡(++
i
 >
¨gc
Ë
	`ußge
();

221 
c›yRe˘Dñay
 = 
	`©oi
(
¨gv
[
i
]);

223 } i‡(
	`°rcmp
(
¨gv
[
i
],"-debug") == 0) {

225 
debug
 = 
True
;

227 } i‡(
	`°rcmp
(
¨gv
[
i
],"-listen") == 0) {

229 i‡(
¨gumítS≥cifõd
Ë
	`ußge
();

231 
li°íS≥cifõd
 = 
True
;

232 i‡(++
i
 < 
¨gc
) {

233 
li°íP‹t
 = 
CLIENTPORT
+
	`©oi
(
¨gv
[
i
]);

234 
ÊashP‹t
 = 
FLASHPORT
+
	`©oi
(
¨gv
[
i
]);

237 } i‡(
¨gv
[
i
][0] != '-') {

239 i‡(
¨gumítS≥cifõd
 || 
li°íS≥cifõd
Ë
	`ußge
();

241 
¨gumítS≥cifõd
 = 
True
;

243 i‡(
	`ssˇnf
(
¨gv
[
i
], "%[^:]:%d", 
ho°«me
, &
p‹t
Ë!2Ë
	`ußge
();

245 i‡(
p‹t
 < 100)

246 
p‹t
 +
SERVERPORT
;

250 
	`ußge
();

255 i‡(
li°íS≥cifõd
) {

256 i‡(
li°íP‹t
 == 0) {

257 *
di•œy
;

258 *
cﬁ⁄Pos
;

259 
ut¢ame
 
ho°öfo
;

261 
di•œy
 = 
	`XDi•œyName
(
di•œy«me
);

262 
cﬁ⁄Pos
 = 
	`°rchr
(
di•œy
, ':');

264 
	`u«me
(&
ho°öfo
);

266 i‡(
cﬁ⁄Pos
 && ((cﬁ⁄Po†=
di•œy
) ||

267 (
	`°∫cmp
(
ho°öfo
.
nodíame
, 
di•œy
,

268 
	`°æí
(
ho°öfo
.
nodíame
)) == 0))) {

270 
li°íP‹t
 = 
CLIENTPORT
+
	`©oi
(
cﬁ⁄Pos
+1);

271 
ÊashP‹t
 = 
FLASHPORT
+
	`©oi
(
cﬁ⁄Pos
+1);

274 
	`Ârötf
(
°dîr
,"%s: cannot work out which displayÇumberÅo "

275 "li°í on.\n", 
¥ogømName
);

276 
	`Ârötf
(
°dîr
,

278 
	`exô
(1);

282 } i‡(!
¨gumítS≥cifõd
) {

284 
	`ußge
();

287 
	}
}

	@demos/vnc/vncviewer/listen.c

24 
	~<uni°d.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<sys/waô.h
>

27 
	~<sys/time.h
>

28 
	~<vncvõwî.h
>

30 
	#FLASHWIDTH
 50

	)

31 
	#FLASHDELAY
 1

	)

33 
F⁄t
 
	gÊashF⁄t
;

35 
gëFœshF⁄t
(
Di•œy
 *
d
);

36 
ÊashDi•œy
(
Di•œy
 *
d
, *
u£r
);

39 
	$li°íF‹IncomögC⁄√˘i⁄s
()

41 
Di•œy
 *
d
;

42 
XEvít
 
ev
;

43 
li°íSockë
, 
ÊashSockë
, 
sock
;

44 
fd_£t
 
fds
;

45 
ÊashU£r
[256];

46 
n
;

48 i‡(!(
d
 = 
	`XO≥nDi•œy
(
di•œy«me
))) {

49 
	`Ârötf
(
°dîr
,"%s: unableÅo open display %s\n",

50 
¥ogømName
, 
	`XDi•œyName
(
di•œy«me
));

51 
	`exô
(1);

54 
	`gëFœshF⁄t
(
d
);

56 
li°íSockë
 = 
	`Li°íAtT˝P‹t
(
li°íP‹t
);

57 
ÊashSockë
 = 
	`Li°íAtT˝P‹t
(
ÊashP‹t
);

59 i‡((
li°íSockë
 < 0Ë|| (
ÊashSockë
 < 0)Ë
	`exô
(1);

61 
	`Ârötf
(
°dîr
,"%s: Listening onÖort %d (flashÖort %d)\n",

62 
¥ogømName
,
li°íP‹t
,
ÊashP‹t
);

64 
True
) {

67 
°©us
, 
pid
;

68 (
pid

	`waô3
(&
°©us
, 
WNOHANG
, (
rußge
 *)0))>0);

71 
	`XCheckIfEvít
(
d
, &
ev
, 
AŒXEvítsPªdiˇã
, 
NULL
))

74 
	`FD_ZERO
(&
fds
);

76 
	`FD_SET
(
ÊashSockë
, &
fds
);

77 
	`FD_SET
(
li°íSockë
, &
fds
);

78 
	`FD_SET
(
	`C⁄√˘i⁄Numbî
(
d
), &
fds
);

80 
	`£À˘
(
FD_SETSIZE
, &
fds
, 
NULL
, NULL, NULL);

82 i‡(
	`FD_ISSET
(
ÊashSockë
, &
fds
)) {

84 
sock
 = 
	`Ac˚±T˝C⁄√˘i⁄
(
ÊashSockë
);

85 i‡(
sock
 < 0Ë
	`exô
(1);

86 
n
 = 
	`ªad
(
sock
, 
ÊashU£r
, 255);

87 i‡(
n
 > 0) {

88 
ÊashU£r
[
n
] = 0;

89 
	`ÊashDi•œy
(
d
, 
ÊashU£r
);

91 
	`ÊashDi•œy
(
d
, 
NULL
);

93 
	`˛o£
(
sock
);

96 i‡(
	`FD_ISSET
(
li°íSockë
, &
fds
)) {

97 
rfbsock
 = 
	`Ac˚±T˝C⁄√˘i⁄
(
li°íSockë
);

98 i‡(
rfbsock
 < 0Ë
	`exô
(1);

100 
	`XClo£Di•œy
(
d
);

104 
	`f‹k
()) {

107 
	`≥º‹
("fork");

108 
	`exô
(1);

112 
	`˛o£
(
li°íSockë
);

113 
	`˛o£
(
ÊashSockë
);

118 
	`˛o£
(
rfbsock
);

119 i‡(!(
d
 = 
	`XO≥nDi•œy
(
di•œy«me
))) {

120 
	`Ârötf
(
°dîr
,"%s: unableÅo open display \"%s\"\r\n",

121 
¥ogømName
, 
	`XDi•œyName
 (
di•œy«me
));

122 
	`exô
(1);

124 
	`gëFœshF⁄t
(
d
);

129 
	}
}

137 
	$gëFœshF⁄t
(
Di•œy
 *
d
)

139 
f⁄tName
[256];

140 **
f⁄tNames
;

141 
nF⁄tNames
;

143 
	`•rötf
(
f⁄tName
,"-*-courier-bold-r-*-*-%d-*-*-*-*-*-iso8859-1",

144 
FLASHWIDTH
);

145 
f⁄tNames
 = 
	`XLi°F⁄ts
(
d
, 
f⁄tName
, 1, &
nF⁄tNames
);

146 i‡(
nF⁄tNames
 == 1) {

147 
	`XFªeF⁄tNames
(
f⁄tNames
);

149 
	`•rötf
(
f⁄tName
,"fixed");

151 
ÊashF⁄t
 = 
	`XLﬂdF⁄t
(
d
, 
f⁄tName
);

152 
	}
}

160 
	$ÊashDi•œy
(
Di•œy
 *
d
, *
u£r
)

162 
Wödow
 
w1
, 
w2
, 
w3
, 
w4
;

163 
XSëWödowAâribuãs
 
©å
;

165 
	`XBñl
(
d
, 100);

167 
	`XF‹˚S¸ìnSavî
(
d
, 
S¸ìnSavîRe£t
);

169 
©å
.
background_pixñ
 = 
	`BœckPixñ
(
d
, 
	`DeÁu…S¸ìn
(d));

170 
©å
.
ovîride_ªdúe˘
 = 1;

171 
©å
.
ßve_undî
 = 
True
;

173 
w1
 = 
	`XCª©eWödow
(
d
, 
	`DeÁu…RoŸWödow
(d), 0, 0,

174 
	`WidthOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
)),

175 
FLASHWIDTH
, 0,

176 
C›yFromP¨ít
, CopyFromParent, CopyFromParent,

177 
CWBackPixñ
|
CWOvîrideRedúe˘
|
CWSaveUndî
,

178 &
©å
);

180 
w2
 = 
	`XCª©eWödow
(
d
, 
	`DeÁu…RoŸWödow
(d), 0, 0, 
FLASHWIDTH
,

181 
	`HeightOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
)), 0,

182 
C›yFromP¨ít
, CopyFromParent, CopyFromParent,

183 
CWBackPixñ
|
CWOvîrideRedúe˘
|
CWSaveUndî
,

184 &
©å
);

186 
w3
 = 
	`XCª©eWödow
(
d
, 
	`DeÁu…RoŸWödow
(d),

187 
	`WidthOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
))-
FLASHWIDTH
,

188 0, 
FLASHWIDTH
,

189 
	`HeightOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
)), 0,

190 
C›yFromP¨ít
, CopyFromParent, CopyFromParent,

191 
CWBackPixñ
|
CWOvîrideRedúe˘
|
CWSaveUndî
,

192 &
©å
);

194 
w4
 = 
	`XCª©eWödow
(
d
, 
	`DeÁu…RoŸWödow
(d), 0,

195 
	`HeightOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
))-
FLASHWIDTH
,

196 
	`WidthOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
)),

197 
FLASHWIDTH
, 0,

198 
C›yFromP¨ít
, CopyFromParent, CopyFromParent,

199 
CWBackPixñ
|
CWOvîrideRedúe˘
|
CWSaveUndî
,

200 &
©å
);

202 
	`XM≠Wödow
(
d
, 
w1
);

203 
	`XM≠Wödow
(
d
, 
w2
);

204 
	`XM≠Wödow
(
d
, 
w3
);

205 
	`XM≠Wödow
(
d
, 
w4
);

207 i‡(
u£r
) {

208 
GC
 
gc
;

209 
XGCVÆues
 
gcv
;

211 
gcv
.
f‹eground
 = 
	`WhôePixñ
(
d
, 
	`DeÁu…S¸ìn
(d));

212 
gcv
.
f⁄t
 = 
ÊashF⁄t
;

213 
gc
 = 
	`XCª©eGC
(
d
, 
w1
, 
GCF‹eground
|
GCF⁄t
, &
gcv
);

214 
	`XDøwSåög
(
d
, 
w1
, 
gc
,

215 
	`WidthOfS¸ìn
(
	`DeÁu…S¸ìnOfDi•œy
(
d
)Ë/ 2 - 
FLASHWIDTH
,

216 (
FLASHWIDTH
 * 3 / 4), 
u£r
, 
	`°æí
(user));

218 
	`XFlush
(
d
);

220 
	`¶ìp
(
FLASHDELAY
);

222 
	`XDe°royWödow
(
d
, 
w1
);

223 
	`XDe°royWödow
(
d
, 
w2
);

224 
	`XDe°royWödow
(
d
, 
w3
);

225 
	`XDe°royWödow
(
d
, 
w4
);

226 
	`XFlush
(
d
);

227 
	}
}

	@demos/vnc/vncviewer/nanox.c

36 
	~<vncvõwî.h
>

37 
	~<uni°d.h
>

39 
	#VW_WIDTH
 1024

	)

40 
	#VW_HEIGHT
 768

	)

41 
	#VW_X
 0

	)

42 
	#VW_Y
 0

	)

44 
	#SCROLLBAR_SIZE
 10

	)

45 
	#SCROLLBAR_BG_SIZE
 (
SCROLLBAR_SIZE
 + 2)

	)

47 
	#INVALID_PIXEL
 0xffffffff

	)

48 
	#COLORMAP_SIZE
 256

	)

53 
Cﬁ‹m≠
 
	gcm≠
;

54 
Di•œy
 *
	gdpy
;

55 
Wödow
 
	gˇnvas
;

56 
GR_GC_ID
 
	ggc
;

57 
GR_GC_ID
 
	g§cGC
;

58 
GR_GC_ID
 
	gd°GC
;

61 
	gBGR233ToPixñ
[
COLORMAP_SIZE
] = { \

76 
GR_PALETTE
 
	g§v_∑l
;

82 
CARD32
 
	gkm≠
[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0xff51, 0xff53, \

99 
Di•œy
 
	gnx_dpy
;

100 
GR_WINDOW_ID
 
	gwid
;

101 
	gpixty≥
;

103 
C›yBGR233ToS¸ìn
(
CARD8
 *
buf
, 
x
, 
y
, 
width
, 
height
);

105 
MWPIXELVAL
 
gr_f‹eground
;

110 
Boﬁ


111 
	$Cª©eXWödow
()

113 
fd
;

114 
GR_SIZE
 
w
, 
h
;

115 
GR_SCREEN_INFO
 
si
;

117 i‡((
fd
 = 
	`GrO≥n
()) < 0)

118 (
FÆ£
);

119 
nx_dpy
.
fd
 = fd;

120 
dpy
 = &
nx_dpy
;

122 
	`GrGëS¸ìnInfo
(&
si
);

124 
myF‹m©
.
bôsPîPixñ
 = 
si
.
bµ
;

125 
myF‹m©
.
dïth
 = 
si
.
bµ
;

126 
myF‹m©
.
bigEndün
 = 0;

127 
myF‹m©
.
åueCﬁour
 = (myF‹m©.
dïth
 =8 && !
u£BGR233
) ? 0 : 1;

128 i‡(
myF‹m©
.
åueCﬁour
) {

129 
myF‹m©
.
ªdMax
 = myF‹m©.
gªíMax
 = 7;

130 
myF‹m©
.
blueMax
 = 3;

131 
myF‹m©
.
ªdShi·
 = 0;

132 
myF‹m©
.
gªíShi·
 = 3;

133 
myF‹m©
.
blueShi·
 = 6;

135 
pixty≥
 = 
si
.pixtype;

137 
	`GrGëSy°emPÆëã
(&
§v_∑l
);

140 
i
 = 0; i < 
§v_∑l
.
cou¡
; i++) {

141 
	`¥ötf
("0x%02x %03d %03d %03d\n", 
i
, \

142 
§v_∑l
.
∑Àâe
[
i
].
r
, srv_∑l.∑Àâe[i].
g
, \

143 
§v_∑l
.
∑Àâe
[
i
].
b
 );

147 
w
 = (
VW_WIDTH
 > (
si
.
cﬁs
 - 
VW_X
)) ? (si.cols - VW_X) : VW_WIDTH;

148 
h
 = (
VW_HEIGHT
 > (
si
.
rows
 - 
VW_Y
)) ? (si.rows - VW_Y) : VW_HEIGHT;

149 i‡((
wid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 
VW_X
, 
VW_Y
, 
w
, 
h
,

150 2, 
LTGRAY
, 
BLACK
)) == 0) {

151 
	`Ârötf
(
°dîr
, "UnableÅo createÅop-level window\n");

152 
	`GrClo£
();

153  
FÆ£
;

156 
	`GrSñe˘Evíts
(
wid
, 
GR_EVENT_MASK_BUTTON_DOWN
 |

157 
GR_EVENT_MASK_BUTTON_UP
 | 
GR_EVENT_MASK_KEY_DOWN
 |

158 
GR_EVENT_MASK_KEY_UP
 | 
GR_EVENT_MASK_MOUSE_POSITION
);

160 
	`GrM≠Wödow
(
wid
);

161 
ˇnvas
 = 
wid
;

163 
gc
 = 
	`GrNewGC
();

164 
§cGC
 = 
	`GrNewGC
();

165 
d°GC
 = 
	`GrNewGC
();

167  
True
;

168 
	}
}

175 
	$XSt‹eCﬁ‹
(
Di•œy
 *
dpy
, 
Cﬁ‹m≠
 
cm≠
, 
XCﬁ‹
 *
xc
)

177 
öd
;

179 
öd
 = 
xc
->
pixñ
 & 0xff;

184 
§v_∑l
.
∑Àâe
[0].
r
 = (
xc
->
ªd
 / 256) & 0xff;

185 
§v_∑l
.
∑Àâe
[0].
g
 = (
xc
->
gªí
 / 256) & 0xff;

186 
§v_∑l
.
∑Àâe
[0].
b
 = (
xc
->
blue
 / 256) & 0xff;

187 
§v_∑l
.
cou¡
 = 1;

190 
	`¥ötf
("XSt‹eCﬁ‹: ind=%d,Ñ=%02x, g=%02x, b=%02x\n", 
öd
, \

191 
§v_∑l
.
∑Àâe
[0].
r
, srv_∑l.∑Àâe[0].
g
, \

192 
§v_∑l
.
∑Àâe
[0].
b
);

194 
	`GrSëSy°emPÆëã
(
öd
, &
§v_∑l
);

197 
	}
}

203 
	$XC›yAªa
(
Di•œy
 *
dpy
, 
Wödow
 
§c
, Wödow 
d°
, 
GR_GC_ID
 
gc
,

204 
x1
, 
y1
, 
w
, 
h
, 
x2
, 
y2
)

207 
	`GrC›yAªa
(
d°
, 
gc
, 
x2
, 
y2
, 
w
, 
h
, 
§c
, 
x1
, 
y1
, 
MWROP_SRCCOPY
);

209 
	}
}

215 
	$XFûlRe˘™gÀ
(
Di•œy
 *
dpy
, 
Wödow
 
ˇnvas
, 
GR_GC_ID
 
gc
,

216 
x
, 
y
, 
w
, 
h
)

218 
	`GrFûlRe˘
(
ˇnvas
, 
gc
, 
x
, 
y
, 
w
, 
h
);

221 
	}
}

227 
	$XDi•œyName
(*
di•œy
)

229 ((*)
NULL
);

230 
	}
}

237 
	$XCh™geGC
(
Di•œy
 *
dpy
, 
GR_GC_ID
 
gc
, 
vmask
, 
GR_GC_INFO
 *
gcv
)

242 i‡(
pixty≥
 =
MWPF_PALETTE
) {

246 
	`GrSëGCF‹egroundPixñVÆ
(
gc
, 
gcv
->
f‹eground
);

248 
	`GrSëGCF‹eground
(
gc
, 
gcv
->
f‹eground
);

251 
	}
}

257 
	$XBñl
(
Di•œy
 *
dpy
, 
pc
)

260 
	}
}

266 
	$XSync
(
Di•œy
 *
dpy
, 
Boﬁ
 
disc
)

269 
	}
}

275 
	$XSñe˘I≈ut
(
Di•œy
 *
dpy
, 
Wödow
 
wö
, 
evmask
)

278 
	}
}

284 
	$XSt‹eByãs
(
Di•œy
 *
dpy
, *
byãs
, 
nbyãs
)

287 
	}
}

293 
	$XSëSñe˘i⁄Ow√r
(
Di•œy
 *
dpy
, 
Atom
 
£l
, 
Wödow
 
own
, 
Time
 
t
)

296 
	}
}

302 
	$C›yD©aToS¸ìn
(
CARD8
 *
buf
, 
x
, 
y
, 
width
, 
height
)

306 
	`¥ötf
("CDTS ");

307 
	`fÊush
(
°dout
);

309 i‡(
øwDñay
 != 0) {

311 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
	`DeÁu…GC
(dpy,
	`DeÁu…S¸ìn
(dpy)),

312 
x
, 
y
, 
width
, 
height
);

314 
	`XSync
(
dpy
,
FÆ£
);

315 
	`u¶ìp
(
øwDñay
 * 1000);

317 i‡(!
u£BGR233
) {

318 
	`GrAªa
(
ˇnvas
, 
gc
, 
x
, 
y
, 
width
, 
height
, 
buf
, 
MWPF_PALETTE
);

320 
	`C›yBGR233ToS¸ìn
(
buf
, 
x
, 
y
, 
width
, 
height
);

322 
	}
}

328 
	$C›yBGR233ToS¸ìn
(
CARD8
 *
buf
, 
x
, 
y
, 
width
, 
height
)

331 
	}
}

336 
Boﬁ


337 
	$H™dÀXEvíts
(
GR_EVENT
 *
ev
)

339 
GR_BOOL
 
ªt
 = 
GR_TRUE
;

340 
buâ⁄s
;

343 
	`¥ötf
("H");

344 
	`fÊush
(
°dout
);

346 
ev
->
ty≥
) {

347 
GR_EVENT_TYPE_NONE
:

348 
ªt
 = 
GR_TRUE
;

350 
GR_EVENT_TYPE_MOUSE_POSITION
:

351 
buâ⁄s
 = (
ev
->
mou£
.buâ⁄†& 
GR_BUTTON_R
) << 2;

352 
buâ⁄s
 |
ev
->
mou£
.buâ⁄†& 
GR_BUTTON_M
;

353 
buâ⁄s
 |(
ev
->
mou£
.buâ⁄†& 
GR_BUTTON_L
) >> 2;

354 
ªt
 = 
	`SídPoöãrEvít
(
ev
->
mou£
.
x
,Év->mou£.
y
,

355 
buâ⁄s
);

357 
GR_EVENT_TYPE_BUTTON_DOWN
:

358 
GR_EVENT_TYPE_BUTTON_UP
:

359 
buâ⁄s
 = (
ev
->
buâ⁄
.buâ⁄†& 
GR_BUTTON_R
) << 2;

360 
buâ⁄s
 |
ev
->
buâ⁄
.buâ⁄†& 
GR_BUTTON_M
;

361 
buâ⁄s
 |(
ev
->
buâ⁄
.buâ⁄†& 
GR_BUTTON_L
) >> 2;

362 
ªt
 = 
	`SídPoöãrEvít
(
ev
->
buâ⁄
.
x
,Év->buâ⁄.
y
,

363 
buâ⁄s
);

365 
GR_EVENT_TYPE_KEY_DOWN
:

366 
GR_EVENT_TYPE_KEY_UP
:

367 
ªt
 = 
	`SídKeyEvít
(
km≠
[
ev
->
key°roke
.
ch
 & 0x7f],

368 (
ev
->
ty≥
 =
GR_EVENT_TYPE_KEY_DOWN
));

373 (
ªt
);

374 
	}
}

380 
	$ShutdownX
()

382 
	`GrClo£
();

383 
	}
}

	@demos/vnc/vncviewer/rfbproto.c

24 
	~<uni°d.h
>

25 
	~<î∫o.h
>

26 
	~<pwd.h
>

27 
	~<vncvõwî.h
>

28 #i‚de‡
NANOX


29 
	~<X11/X©om.h
>

31 
	~<vnˇuth.h
>

33 
Boﬁ
 
H™dÀHextûeEncodög8
(
x
, 
y
, 
w
, 
h
);

34 
Boﬁ
 
H™dÀHextûeEncodög16
(
x
, 
y
, 
w
, 
h
);

35 
Boﬁ
 
H™dÀHextûeEncodög32
(
x
, 
y
, 
w
, 
h
);

37 
	grfbsock
;

38 *
	gdeskt›Name
;

39 
rfbPixñF‹m©
 
	gmyF‹m©
;

40 
rfbSîvîInôMsg
 
	gsi
;

41 
timevÆ
 
	gupd©eReque°Time
;

42 
Boﬁ
 
	g£ndUpd©eReque°
;

44 
	gídünTe°
 = 1;

51 
	#BUFFER_SIZE
 (640*480)

	)

52 
	gbuf„r
[
BUFFER_SIZE
];

55 
PrötPixñF‹m©
(
rfbPixñF‹m©
 *
f‹m©
);

62 
Boﬁ


63 
	$C⁄√˘ToRFBSîvî
(c⁄° *
ho°«me
, 
p‹t
)

65 
ho°
;

67 i‡(!
	`SåögToIPAddr
(
ho°«me
, &
ho°
)) {

68 
	`Ârötf
(
°dîr
,"%s: couldn't convert '%s'Åo hostáddress\n",

69 
¥ogømName
,
ho°«me
);

70  
FÆ£
;

73 
rfbsock
 = 
	`C⁄√˘ToT˝Addr
(
ho°
, 
p‹t
);

75 i‡(
rfbsock
 < 0) {

76 
	`Ârötf
(
°dîr
,"%s: unableÅo connectÅo VNC server\n",

77 
¥ogømName
);

78  
FÆ£
;

81  
True
;

82 
	}
}

89 
Boﬁ


90 
	$Inôüli£RFBC⁄√˘i⁄
(
sock
)

92 
rfbPrŸocﬁVîsi⁄Msg
 
pv
;

93 
maj‹
,
mö‹
;

94 
Boﬁ
 
authWûlW‹k
 = 
True
;

95 
CARD32
 
authScheme
, 
ªas⁄Lí
, 
authResu…
;

96 *
ªas⁄
;

97 
CARD8
 
chÆÀnge
[
CHALLENGESIZE
];

98 *
∑sswd
;

99 
i
;

100 
rfbClõ¡InôMsg
 
ci
;

105 i‡(
li°íS≥cifõd
)

106 
îr‹MesßgeFromRódExa˘
 = 
FÆ£
;

108 i‡(!
	`RódExa˘
(
sock
, 
pv
, 
sz_rfbPrŸocﬁVîsi⁄Msg
)Ë 
FÆ£
;

110 
îr‹MesßgeFromRódExa˘
 = 
True
;

112 
pv
[
sz_rfbPrŸocﬁVîsi⁄Msg
] = 0;

114 i‡(
	`ssˇnf
(
pv
,
rfbPrŸocﬁVîsi⁄F‹m©
,&
maj‹
,&
mö‹
) != 2) {

115 
	`Ârötf
(
°dîr
,"%s: NŸá vÆid VNC sîvî\n",
¥ogømName
);

116  
FÆ£
;

119 
	`Ârötf
(
°dîr
,"%s: VNC server supportsÖrotocol version %d.%d "

121 
¥ogømName
,
maj‹
,
mö‹
,
rfbPrŸocﬁMaj‹Vîsi⁄
,

122 
rfbPrŸocﬁMö‹Vîsi⁄
);

124 i‡((
maj‹
 =3Ë&& (
mö‹
 < 3)) {

126 
authWûlW‹k
 = 
FÆ£
;

129 
maj‹
 = 
rfbPrŸocﬁMaj‹Vîsi⁄
;

130 
mö‹
 = 
rfbPrŸocﬁMö‹Vîsi⁄
;

133 
	`•rötf
(
pv
,
rfbPrŸocﬁVîsi⁄F‹m©
,
maj‹
,
mö‹
);

135 i‡(!
	`WrôeExa˘
(
sock
, 
pv
, 
sz_rfbPrŸocﬁVîsi⁄Msg
)Ë 
FÆ£
;

137 i‡(!
	`RódExa˘
(
sock
, (*)&
authScheme
, 4)Ë 
FÆ£
;

139 
authScheme
 = 
	`Sw≠32IfLE
(authScheme);

141 
authScheme
) {

143 
rfbC⁄nFaûed
:

144 i‡(!
	`RódExa˘
(
sock
, (*)&
ªas⁄Lí
, 4)Ë 
FÆ£
;

145 
ªas⁄Lí
 = 
	`Sw≠32IfLE
(reasonLen);

147 
ªas⁄
 = 
	`mÆloc
(
ªas⁄Lí
);

149 i‡(!
	`RódExa˘
(
sock
, 
ªas⁄
, 
ªas⁄Lí
)Ë 
FÆ£
;

151 
	`Ârötf
(
°dîr
,"%s: VNC connection failed: %.*s\n",

152 
¥ogømName
, ()
ªas⁄Lí
, 
ªas⁄
);

153  
FÆ£
;

155 
rfbNoAuth
:

156 
	`Ârötf
(
°dîr
,"%s: Nÿauthítiˇti⁄Çìded\n",
¥ogømName
);

159 
rfbVncAuth
:

160 i‡(!
authWûlW‹k
) {

161 
	`Ârötf
(
°dîr
,

166 
¥ogømName
);

167  
FÆ£
;

170 i‡(!
	`RódExa˘
(
sock
, (*)
chÆÀnge
, 
CHALLENGESIZE
)Ë 
FÆ£
;

172 i‡(
∑sswdFûe
) {

173 
∑sswd
 = 
	`vncDe¸y±PasswdFromFûe
(
∑sswdFûe
);

175 
∑ss
[32] = {"password"};

176 
∑sswd
 = 
∑ss
;

178 i‡(
	`°æí
(
∑sswd
) == 0) {

179 
	`Ârötf
(
°dîr
,"%s: RódögÖassw‹d faûed\n",
¥ogømName
);

180  
FÆ£
;

182 i‡(
	`°æí
(
∑sswd
) > 8) {

183 
∑sswd
[8] = '\0';

187 
	`vncEn¸y±Byãs
(
chÆÀnge
, 
∑sswd
);

190 
i
=0; i<
	`°æí
(
∑sswd
); i++) {

191 
∑sswd
[
i
] = '\0';

194 i‡(!
	`WrôeExa˘
(
sock
, (*)
chÆÀnge
, 
CHALLENGESIZE
)Ë 
FÆ£
;

196 i‡(!
	`RódExa˘
(
sock
, (*)&
authResu…
, 4)Ë 
FÆ£
;

198 
authResu…
 = 
	`Sw≠32IfLE
(authResult);

200 
authResu…
) {

201 
rfbVncAuthOK
:

202 
	`Ârötf
(
°dîr
,"%s: VNCáuthítiˇti⁄ suc˚eded\n",
¥ogømName
);

204 
rfbVncAuthFaûed
:

205 
	`Ârötf
(
°dîr
,"%s: VNCáuthítiˇti⁄ faûed\n",
¥ogømName
);

206  
FÆ£
;

207 
rfbVncAuthTooM™y
:

208 
	`Ârötf
(
°dîr
,"%s: VNCáuthentication failed -Åoo manyÅries\n",

209 
¥ogømName
);

210  
FÆ£
;

212 
	`Ârötf
(
°dîr
,"%s: Unknown VNCáuthenticationÑesult: %d\n",

213 
¥ogømName
,()
authResu…
);

214  
FÆ£
;

219 
	`Ârötf
(
°dîr
,

221 
¥ogømName
,()
authScheme
);

222  
FÆ£
;

225 
ci
.
sh¨ed
 = (
sh¨eDeskt›
 ? 1 : 0);

227 i‡(!
	`WrôeExa˘
(
sock
, (*)&
ci
, 
sz_rfbClõ¡InôMsg
)Ë 
FÆ£
;

229 i‡(!
	`RódExa˘
(
sock
, (*)&
si
, 
sz_rfbSîvîInôMsg
)Ë 
FÆ£
;

231 
si
.
‰amebuf„rWidth
 = 
	`Sw≠16IfLE
(si.framebufferWidth);

232 
si
.
‰amebuf„rHeight
 = 
	`Sw≠16IfLE
(si.framebufferHeight);

233 
si
.
f‹m©
.
ªdMax
 = 
	`Sw≠16IfLE
(si.format.redMax);

234 
si
.
f‹m©
.
gªíMax
 = 
	`Sw≠16IfLE
(si.format.greenMax);

235 
si
.
f‹m©
.
blueMax
 = 
	`Sw≠16IfLE
(si.format.blueMax);

236 
si
.
«meLígth
 = 
	`Sw≠32IfLE
(si.nameLength);

238 i‡(((
upd©eReque°X
 + 
upd©eReque°W
Ë> 
si
.
‰amebuf„rWidth
) ||

239 ((
upd©eReque°Y
 + 
upd©eReque°H
Ë> 
si
.
‰amebuf„rHeight
))

241 
	`Ârötf
(
°dîr
,

243 
¥ogømName
);

244  
FÆ£
;

246 i‡(
upd©eReque°W
 == 0)

247 
upd©eReque°W
 = 
si
.
‰amebuf„rWidth
 - 
upd©eReque°X
;

248 i‡(
upd©eReque°H
 == 0)

249 
upd©eReque°H
 = 
si
.
‰amebuf„rHeight
 - 
upd©eReque°Y
;

251 
deskt›Name
 = 
	`mÆloc
(
si
.
«meLígth
 + 1);

253 i‡(!
	`RódExa˘
(
sock
, 
deskt›Name
, 
si
.
«meLígth
)Ë 
FÆ£
;

255 
deskt›Name
[
si
.
«meLígth
] = 0;

257 
	`Ârötf
(
°dîr
,"%s: Deskt›Çamê\"%s\"\n",
¥ogømName
,
deskt›Name
);

259 
	`Ârötf
(
°dîr
,

261 
¥ogømName
, 
rfbPrŸocﬁMaj‹Vîsi⁄
, 
rfbPrŸocﬁMö‹Vîsi⁄
);

263 
	`Ârötf
(
°dîr
,"%s: VNC sîvî deÁu… f‹m©:\n",
¥ogømName
);

264 
	`PrötPixñF‹m©
(&
si
.
f‹m©
);

266  
True
;

267 
	}
}

274 
Boﬁ


275 
	$SëF‹m©AndEncodögs
()

277 
rfbSëPixñF‹m©Msg
 
•f
;

278 
buf
[
sz_rfbSëEncodögsMsg
 + 
MAX_ENCODINGS
 * 4];

279 
rfbSëEncodögsMsg
 *
£
 = (rfbSëEncodögsMsg *)
buf
;

280 
CARD32
 *
ícs
 = (CARD32 *)(&
buf
[
sz_rfbSëEncodögsMsg
]);

281 
Àn
 = 0;

282 
i
;

284 
•f
.
ty≥
 = 
rfbSëPixñF‹m©
;

285 
•f
.
f‹m©
 = 
myF‹m©
;

286 
•f
.
f‹m©
.
ªdMax
 = 
	`Sw≠16IfLE
(spf.format.redMax);

287 
•f
.
f‹m©
.
gªíMax
 = 
	`Sw≠16IfLE
(spf.format.greenMax);

288 
•f
.
f‹m©
.
blueMax
 = 
	`Sw≠16IfLE
(spf.format.blueMax);

290 i‡(!
	`WrôeExa˘
(
rfbsock
, (*)&
•f
, 
sz_rfbSëPixñF‹m©Msg
))

291  
FÆ£
;

293 
£
->
ty≥
 = 
rfbSëEncodögs
;

294 
£
->
nEncodögs
 = 0;

296 
i
 = 0; i < 
nEx∂icôEncodögs
; i++) {

297 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
ex∂icôEncodögs
[
i
]);

300 i‡(
	`SameMachöe
(
rfbsock
)) {

301 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
rfbEncodögRaw
);

304 i‡(
addC›yRe˘
)

305 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
rfbEncodögC›yRe˘
);

306 i‡(
addHextûe
)

307 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
rfbEncodögHextûe
);

308 i‡(
addCoRRE
)

309 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
rfbEncodögCoRRE
);

310 i‡(
addRRE
)

311 
ícs
[
£
->
nEncodögs
++] = 
	`Sw≠32IfLE
(
rfbEncodögRRE
);

313 
Àn
 = 
sz_rfbSëEncodögsMsg
 + 
£
->
nEncodögs
 * 4;

315 
£
->
nEncodögs
 = 
	`Sw≠16IfLE
(se->nEncodings);

317 i‡(!
	`WrôeExa˘
(
rfbsock
, 
buf
, 
Àn
)Ë 
FÆ£
;

319  
True
;

320 
	}
}

327 
Boﬁ


328 
	$SídIn¸emíèlFømebuf„rUpd©eReque°
()

330  
	`SídFømebuf„rUpd©eReque°
(
upd©eReque°X
, 
upd©eReque°Y
,

331 
upd©eReque°W
, 
upd©eReque°H
, 
True
);

332 
	}
}

339 
Boﬁ


340 
	$SídFømebuf„rUpd©eReque°
(
x
, 
y
, 
w
, 
h
, 
Boﬁ
 
ö¸emíèl
)

342 
rfbFømebuf„rUpd©eReque°Msg
 
fur
;

344 
fur
.
ty≥
 = 
rfbFømebuf„rUpd©eReque°
;

345 
fur
.
ö¸emíèl
 = incremental ? 1 : 0;

346 
fur
.
x
 = 
	`Sw≠16IfLE
(x);

347 
fur
.
y
 = 
	`Sw≠16IfLE
(y);

348 
fur
.
w
 = 
	`Sw≠16IfLE
(w);

349 
fur
.
h
 = 
	`Sw≠16IfLE
(h);

351 i‡(!
	`WrôeExa˘
(
rfbsock
, (*)&
fur
, 
sz_rfbFømebuf„rUpd©eReque°Msg
))

352  
FÆ£
;

354 
	`gëtimeofday
(&
upd©eReque°Time
, 
NULL
);

356 
£ndUpd©eReque°
 = 
FÆ£
;

358  
True
;

359 
	}
}

366 
Boﬁ


367 
	$SídPoöãrEvít
(
x
, 
y
, 
buâ⁄Mask
)

369 
rfbPoöãrEvítMsg
 
≥
;

371 
≥
.
ty≥
 = 
rfbPoöãrEvít
;

372 
≥
.
buâ⁄Mask
 = buttonMask;

373 i‡(
x
 < 0) x = 0;

374 i‡(
y
 < 0) y = 0;

375 
≥
.
x
 = 
	`Sw≠16IfLE
(x);

376 
≥
.
y
 = 
	`Sw≠16IfLE
(y);

377  
	`WrôeExa˘
(
rfbsock
, (*)&
≥
, 
sz_rfbPoöãrEvítMsg
);

378 
	}
}

385 
Boﬁ


386 
	$SídKeyEvít
(
CARD32
 
key
, 
Boﬁ
 
down
)

388 
rfbKeyEvítMsg
 
ke
;

390 
ke
.
ty≥
 = 
rfbKeyEvít
;

391 
ke
.
down
 = down ? 1 : 0;

392 
ke
.
key
 = 
	`Sw≠32IfLE
(key);

393  
	`WrôeExa˘
(
rfbsock
, (*)&
ke
, 
sz_rfbKeyEvítMsg
);

394 
	}
}

401 
Boﬁ


402 
	$SídClõ¡CutText
(*
°r
, 
Àn
)

404 
rfbClõ¡CutTextMsg
 
c˘
;

406 
c˘
.
ty≥
 = 
rfbClõ¡CutText
;

407 
c˘
.
Àngth
 = 
	`Sw≠32IfLE
(
Àn
);

408  (
	`WrôeExa˘
(
rfbsock
, (*)&
c˘
, 
sz_rfbClõ¡CutTextMsg
) &&

409 
	`WrôeExa˘
(
rfbsock
, 
°r
, 
Àn
));

410 
	}
}

418 
Boﬁ


419 
	$H™dÀRFBSîvîMesßge
()

421 
rfbSîvîToClõ¡Msg
 
msg
;

423 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
msg
, 1))

424  
FÆ£
;

426 
msg
.
ty≥
) {

428 
rfbSëCﬁourM≠E¡rõs
:

430 
i
;

431 
CARD16
 
rgb
[3];

432 
XCﬁ‹
 
xc
;

434 i‡(!
	`RódExa˘
(
rfbsock
, ((*)&
msg
) + 1,

435 
sz_rfbSëCﬁourM≠E¡rõsMsg
 - 1))

436  
FÆ£
;

438 
msg
.
scme
.
fú°Cﬁour
 = 
	`Sw≠16IfLE
(msg.scme.firstColour);

439 
msg
.
scme
.
nCﬁours
 = 
	`Sw≠16IfLE
(msg.scme.nColours);

441 
i
 = 0; i < 
msg
.
scme
.
nCﬁours
; i++) {

442 i‡(!
	`RódExa˘
(
rfbsock
, (*)
rgb
, 6))

443  
FÆ£
;

444 
xc
.
pixñ
 = 
msg
.
scme
.
fú°Cﬁour
 + 
i
;

445 
xc
.
ªd
 = 
	`Sw≠16IfLE
(
rgb
[0]);

446 
xc
.
gªí
 = 
	`Sw≠16IfLE
(
rgb
[1]);

447 
xc
.
blue
 = 
	`Sw≠16IfLE
(
rgb
[2]);

448 
xc
.
Êags
 = 
DoRed
|
DoGªí
|
DoBlue
;

450 
	`XSt‹eCﬁ‹
(
dpy
, 
cm≠
, &
xc
);

456 
rfbFømebuf„rUpd©e
:

458 
rfbFømebuf„rUpd©eRe˘Hódî
 
ª˘
;

459 
löesToRód
;

460 
byãsPîLöe
;

461 
i
;

463 i‡(!
	`RódExa˘
(
rfbsock
, ((*)&
msg
.
fu
) + 1,

464 
sz_rfbFømebuf„rUpd©eMsg
 - 1))

465  
FÆ£
;

467 
msg
.
fu
.
nRe˘s
 = 
	`Sw≠16IfLE
(msg.fu.nRects);

469 
i
 = 0; i < 
msg
.
fu
.
nRe˘s
; i++) {

470 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
ª˘
,

471 
sz_rfbFømebuf„rUpd©eRe˘Hódî
))

472  
FÆ£
;

474 
ª˘
.
r
.
x
 = 
	`Sw≠16IfLE
(rect.r.x);

475 
ª˘
.
r
.
y
 = 
	`Sw≠16IfLE
(rect.r.y);

476 
ª˘
.
r
.
w
 = 
	`Sw≠16IfLE
(rect.r.w);

477 
ª˘
.
r
.
h
 = 
	`Sw≠16IfLE
(rect.r.h);

479 
ª˘
.
ícodög
 = 
	`Sw≠32IfLE
(rect.encoding);

481 i‡((
ª˘
.
r
.
x
 +Ñe˘.r.
w
 > 
si
.
‰amebuf„rWidth
) ||

482 (
ª˘
.
r
.
y
 +Ñe˘.r.
h
 > 
si
.
‰amebuf„rHeight
))

484 
	`Ârötf
(
°dîr
,"%s:ÑectÅooÜarge: %dx%dát (%d, %d)\n",

485 
¥ogømName
, 
ª˘
.
r
.
w
,Ñe˘.r.
h
,Ñe˘.r.
x
,Ñe˘.r.
y
);

486  
FÆ£
;

489 i‡((
ª˘
.
r
.
h
 *Ñe˘.r.
w
) == 0) {

490 
	`Ârötf
(
°dîr
,"%s: zîÿsizêª˘ - ign‹ög\n",
¥ogømName
);

494 
ª˘
.
ícodög
) {

496 
rfbEncodögRaw
:

498 
byãsPîLöe
 = 
ª˘
.
r
.
w
 * 
myF‹m©
.
bôsPîPixñ
 / 8;

499 
löesToRód
 = 
BUFFER_SIZE
 / 
byãsPîLöe
;

501 
ª˘
.
r
.
h
 > 0) {

502 i‡(
löesToRód
 > 
ª˘
.
r
.
h
)

503 
löesToRód
 = 
ª˘
.
r
.
h
;

505 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
,
byãsPîLöe
 * 
löesToRód
))

506  
FÆ£
;

508 
	`C›yD©aToS¸ìn
((
CARD8
 *)
buf„r
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

509 
ª˘
.
r
.
w
, 
löesToRód
);

511 
ª˘
.
r
.
h
 -
löesToRód
;

512 
ª˘
.
r
.
y
 +
löesToRód
;

517 
rfbEncodögC›yRe˘
:

519 
rfbC›yRe˘
 
¸
;

521 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
¸
, 
sz_rfbC›yRe˘
))

522  
FÆ£
;

524 
¸
.
§cX
 = 
	`Sw≠16IfLE
(cr.srcX);

525 
¸
.
§cY
 = 
	`Sw≠16IfLE
(cr.srcY);

527 i‡(
c›yRe˘Dñay
 != 0) {

528 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
§cGC
, 
¸
.
§cX
, cr.
§cY
,

529 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

530 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
d°GC
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

531 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

532 
	`XSync
(
dpy
,
FÆ£
);

533 
	`u¶ìp
(
c›yRe˘Dñay
 * 1000);

534 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
d°GC
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

535 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

536 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
§cGC
, 
¸
.
§cX
, cr.
§cY
,

537 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

540 
	`XC›yAªa
(
dpy
, 
ˇnvas
, c™vas, 
gc
, 
¸
.
§cX
, cr.
§cY
,

541 
ª˘
.
r
.
w
,Ñe˘.r.
h
,Ñe˘.r.
x
,Ñe˘.r.
y
);

546 
rfbEncodögRRE
:

548 
rfbRREHódî
 
hdr
;

549 
CARD8
 
pix8
;

550 
CARD16
 
pix16
;

551 
CARD32
 
pix32
;

552 
XGCVÆues
 
gcv
;

553 
rfbRe˘™gÀ
 
subª˘
;

554 
j
;

556 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
hdr
, 
sz_rfbRREHódî
))

557  
FÆ£
;

559 
hdr
.
nSubª˘s
 = 
	`Sw≠32IfLE
(hdr.nSubrects);

561 
myF‹m©
.
bôsPîPixñ
) {

564 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix8
, 1))

565  
FÆ£
;

567 
gcv
.
f‹eground
 = (
u£BGR233
 ? 
BGR233ToPixñ
[
pix8
]

568 : 
pix8
);

569 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

570 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

571 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

573 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

574 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix8
, 1))

575  
FÆ£
;

577 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
subª˘
,

578 
sz_rfbRe˘™gÀ
))

579  
FÆ£
;

581 
subª˘
.
x
 = 
	`Sw≠16IfLE
(subrect.x);

582 
subª˘
.
y
 = 
	`Sw≠16IfLE
(subrect.y);

583 
subª˘
.
w
 = 
	`Sw≠16IfLE
(subrect.w);

584 
subª˘
.
h
 = 
	`Sw≠16IfLE
(subrect.h);

586 
gcv
.
f‹eground
 = (
u£BGR233
 ? 
BGR233ToPixñ
[
pix8
]

587 : 
pix8
);

588 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

589 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + 
subª˘
.x,

590 
ª˘
.
r
.
y
 + 
subª˘
.y, subª˘.
w
,

591 
subª˘
.
h
);

596 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix16
, 2))

597  
FÆ£
;

599 
gcv
.
f‹eground
 = 
pix16
;

600 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

601 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

602 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

604 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

605 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix16
, 2))

606  
FÆ£
;

608 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
subª˘
,

609 
sz_rfbRe˘™gÀ
))

610  
FÆ£
;

612 
subª˘
.
x
 = 
	`Sw≠16IfLE
(subrect.x);

613 
subª˘
.
y
 = 
	`Sw≠16IfLE
(subrect.y);

614 
subª˘
.
w
 = 
	`Sw≠16IfLE
(subrect.w);

615 
subª˘
.
h
 = 
	`Sw≠16IfLE
(subrect.h);

617 
gcv
.
f‹eground
 = 
pix16
;

618 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

619 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + 
subª˘
.x,

620 
ª˘
.
r
.
y
 + 
subª˘
.y, subª˘.
w
,

621 
subª˘
.
h
);

626 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix32
, 4))

627  
FÆ£
;

629 
gcv
.
f‹eground
 = 
pix32
;

630 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

631 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

632 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

634 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

635 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix32
, 4))

636  
FÆ£
;

638 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
subª˘
,

639 
sz_rfbRe˘™gÀ
))

640  
FÆ£
;

642 
subª˘
.
x
 = 
	`Sw≠16IfLE
(subrect.x);

643 
subª˘
.
y
 = 
	`Sw≠16IfLE
(subrect.y);

644 
subª˘
.
w
 = 
	`Sw≠16IfLE
(subrect.w);

645 
subª˘
.
h
 = 
	`Sw≠16IfLE
(subrect.h);

647 
gcv
.
f‹eground
 = 
pix32
;

648 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

649 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + 
subª˘
.x,

650 
ª˘
.
r
.
y
 + 
subª˘
.y, subª˘.
w
,

651 
subª˘
.
h
);

658 
rfbEncodögCoRRE
:

660 
rfbRREHódî
 
hdr
;

661 
CARD8
 
pix8
;

662 
CARD16
 
pix16
;

663 
CARD32
 
pix32
;

664 
XGCVÆues
 
gcv
;

665 
j
;

666 
CARD8
 *
±r
;

667 
x
, 
y
, 
w
, 
h
;

669 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
hdr
, 
sz_rfbRREHódî
))

670  
FÆ£
;

672 
hdr
.
nSubª˘s
 = 
	`Sw≠32IfLE
(hdr.nSubrects);

674 
myF‹m©
.
bôsPîPixñ
) {

677 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix8
, 1))

678  
FÆ£
;

680 
gcv
.
f‹eground
 = (
u£BGR233
 ? 
BGR233ToPixñ
[
pix8
]

681 : 
pix8
);

682 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

683 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

684 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

686 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
hdr
.
nSubª˘s
 * 5))

687  
FÆ£
;

689 
±r
 = (
CARD8
 *)
buf„r
;

691 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

692 
pix8
 = *
±r
++;

693 
x
 = *
±r
++;

694 
y
 = *
±r
++;

695 
w
 = *
±r
++;

696 
h
 = *
±r
++;

697 
gcv
.
f‹eground
 = (
u£BGR233
 ? 
BGR233ToPixñ
[
pix8
]

698 : 
pix8
);

699 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

700 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + x,

701 
ª˘
.
r
.
y
 + y, 
w
, 
h
);

706 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix16
, 2))

707  
FÆ£
;

709 
gcv
.
f‹eground
 = 
pix16
;

710 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

711 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

712 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

714 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
hdr
.
nSubª˘s
 * 6))

715  
FÆ£
;

717 
±r
 = (
CARD8
 *)
buf„r
;

719 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

720 
pix16
 = *(
CARD16
 *)
±r
;

721 
±r
 += 2;

722 
x
 = *
±r
++;

723 
y
 = *
±r
++;

724 
w
 = *
±r
++;

725 
h
 = *
±r
++;

726 
gcv
.
f‹eground
 = 
pix16
;

727 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

728 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + x,

729 
ª˘
.
r
.
y
 + y, 
w
, 
h
);

734 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
pix32
, 4))

735  
FÆ£
;

737 
gcv
.
f‹eground
 = 
pix32
;

738 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

739 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
,Ñe˘.r.
y
,

740 
ª˘
.
r
.
w
,Ñe˘.r.
h
);

742 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
hdr
.
nSubª˘s
 * 8))

743  
FÆ£
;

745 
±r
 = (
CARD8
 *)
buf„r
;

747 
j
 = 0; j < 
hdr
.
nSubª˘s
; j++) {

748 
pix32
 = *(
CARD32
 *)
±r
;

749 
±r
 += 4;

750 
x
 = *
±r
++;

751 
y
 = *
±r
++;

752 
w
 = *
±r
++;

753 
h
 = *
±r
++;

754 
gcv
.
f‹eground
 = 
pix32
;

755 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
);

756 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
ª˘
.
r
.
x
 + x,

757 
ª˘
.
r
.
y
 + y, 
w
, 
h
);

764 
rfbEncodögHextûe
:

766 
myF‹m©
.
bôsPîPixñ
) {

768 i‡(!
	`H™dÀHextûeEncodög8
(
ª˘
.
r
.
x
,Ñe˘.r.
y
,

769 
ª˘
.
r
.
w
,Ñe˘.r.
h
))

770  
FÆ£
;

773 i‡(!
	`H™dÀHextûeEncodög16
(
ª˘
.
r
.
x
,Ñe˘.r.
y
,

774 
ª˘
.
r
.
w
,Ñe˘.r.
h
))

775  
FÆ£
;

778 i‡(!
	`H™dÀHextûeEncodög32
(
ª˘
.
r
.
x
,Ñe˘.r.
y
,

779 
ª˘
.
r
.
w
,Ñe˘.r.
h
))

780  
FÆ£
;

787 
	`Ârötf
(
°dîr
,"%s: unknow¿ª˘Éncodög %d\n",
¥ogømName
,

788 ()
ª˘
.
ícodög
);

789  
FÆ£
;

793 
£ndUpd©eReque°
 = 
True
;

798 
rfbBñl
:

799 
	`XBñl
(
dpy
,100);

802 
rfbSîvîCutText
:

804 #i‚de‡
NANOX


805 *
°r
;

807 i‡(!
	`RódExa˘
(
rfbsock
, ((*)&
msg
) + 1,

808 
sz_rfbSîvîCutTextMsg
 - 1))

809  
FÆ£
;

811 
msg
.
s˘
.
Àngth
 = 
	`Sw≠32IfLE
(msg.sct.length);

813 
°r
 = 
	`mÆloc
(
msg
.
s˘
.
Àngth
);

815 i‡(!
	`RódExa˘
(
rfbsock
, 
°r
, 
msg
.
s˘
.
Àngth
))

816  
FÆ£
;

818 
	`XSñe˘I≈ut
(
dpy
, 
	`DeÁu…RoŸWödow
(dpy), 0);

819 
	`XSt‹eByãs
(
dpy
, 
°r
, 
msg
.
s˘
.
Àngth
);

820 
	`XSëSñe˘i⁄Ow√r
(
dpy
, 
XA_PRIMARY
, 
N⁄e
, 
CuºítTime
);

821 
	`XSñe˘I≈ut
(
dpy
, 
	`DeÁu…RoŸWödow
(dpy), 
Pr›îtyCh™geMask
);

823 
	`‰ì
(
°r
);

829 
	`Ârötf
(
°dîr
,"%s: unknown messageÅype %d from VNC server\n",

830 
¥ogømName
,
msg
.
ty≥
);

831  
FÆ£
;

834  
True
;

835 
	}
}

838 
	#GET_PIXEL8
(
pix
, 
±r
Ë(’ixË*’å)++)

	)

840 
	#GET_PIXEL16
(
pix
, 
±r
Ë(((
CARD8
*)&(pix))[0] = *(ptr)++, \

841 ((
CARD8
*)&(
pix
))[1] = *(
±r
)++)

	)

843 
	#GET_PIXEL32
(
pix
, 
±r
Ë(((
CARD8
*)&(pix))[0] = *(ptr)++, \

844 ((
CARD8
*)&(
pix
))[1] = *(
±r
)++, \

845 ((
CARD8
*)&(
pix
))[2] = *(
±r
)++, \

846 ((
CARD8
*)&(
pix
))[3] = *(
±r
)++)

	)

848 
	#DEFINE_HEXTILE
(
bµ
) \

849 
Boﬁ
 \

850 
H™dÀHextûeEncodög
##
	`bµ
(
rx
, 
ry
, 
rw
, 
rh
) \

852 
CARD
##
bµ
 
bg
, 
fg
; \

853 
XGCVÆues
 
gcv
; \

854 
i
; \

855 
CARD8
 *
±r
; \

856 
x
, 
y
, 
w
, 
h
; \

857 
sx
, 
sy
, 
sw
, 
sh
; \

858 
CARD8
 
subícodög
; \

859 
CARD8
 
nSubª˘s
; \

861 
y
 = 
ry
; y <Ñy+
rh
; y += 16) { \

862 
x
 = 
rx
; x <Ñx+
rw
; x += 16) { \

863 
w
 = 
h
 = 16; \

864 i‡(
rx
+
rw
 - 
x
 < 16) \

865 
w
 = 
rx
+
rw
 - 
x
; \

866 i‡(
ry
+
rh
 - 
y
 < 16) \

867 
h
 = 
ry
+
rh
 - 
y
; \

869 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
subícodög
, 1)) \

870  
FÆ£
; \

872 i‡(
subícodög
 & 
rfbHextûeRaw
) { \

873 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
w
 * 
h
 * (
bµ
 / 8))) \

874  
FÆ£
; \

876 
	`C›yD©aToS¸ìn
((
CARD8
 *)
buf„r
, 
x
, 
y
, 
w
, 
h
); \

880 i‡(
subícodög
 & 
rfbHextûeBackgroundS≥cifõd
) \

881 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
bg
, (
bµ
/8))) \

882  
FÆ£
; \

884 i‡((
bµ
 =8Ë&& 
u£BGR233
) \

885 
gcv
.
f‹eground
 = 
BGR233ToPixñ
[
bg
]; \

887 
gcv
.
f‹eground
 = 
bg
; \

889 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
); \

890 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
x
, 
y
, 
w
, 
h
); \

892 i‡(
subícodög
 & 
rfbHextûeF‹egroundS≥cifõd
) \

893 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
fg
, (
bµ
/8))) \

894  
FÆ£
; \

896 i‡(!(
subícodög
 & 
rfbHextûeAnySubª˘s
)) { \

900 i‡(!
	`RódExa˘
(
rfbsock
, (*)&
nSubª˘s
, 1)) \

901  
FÆ£
; \

903 
±r
 = (
CARD8
 *)
buf„r
; \

905 i‡(
subícodög
 & 
rfbHextûeSubª˘sCﬁouªd
) { \

906 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
nSubª˘s
 * (2 + (
bµ
 / 8)))) \

907  
FÆ£
; \

909 
i
 = 0; i < 
nSubª˘s
; i++) { \

910 
GET_PIXEL
##
	`bµ
(
fg
, 
±r
); \

911 
sx
 = 
	`rfbHextûeExåa˘X
(*
±r
); \

912 
sy
 = 
	`rfbHextûeExåa˘Y
(*
±r
); \

913 
±r
++; \

914 
sw
 = 
	`rfbHextûeExåa˘W
(*
±r
); \

915 
sh
 = 
	`rfbHextûeExåa˘H
(*
±r
); \

916 
±r
++; \

917 i‡((
bµ
 =8Ë&& 
u£BGR233
) \

918 
gcv
.
f‹eground
 = 
BGR233ToPixñ
[
fg
]; \

920 
gcv
.
f‹eground
 = 
fg
; \

922 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
); \

923 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
x
+
sx
, 
y
+
sy
, 
sw
, 
sh
); \

927 i‡(!
	`RódExa˘
(
rfbsock
, 
buf„r
, 
nSubª˘s
 * 2)) \

928  
FÆ£
; \

930 i‡((
bµ
 =8Ë&& 
u£BGR233
) \

931 
gcv
.
f‹eground
 = 
BGR233ToPixñ
[
fg
]; \

933 
gcv
.
f‹eground
 = 
fg
; \

935 
	`XCh™geGC
(
dpy
, 
gc
, 
GCF‹eground
, &
gcv
); \

937 
i
 = 0; i < 
nSubª˘s
; i++) { \

938 
sx
 = 
	`rfbHextûeExåa˘X
(*
±r
); \

939 
sy
 = 
	`rfbHextûeExåa˘Y
(*
±r
); \

940 
±r
++; \

941 
sw
 = 
	`rfbHextûeExåa˘W
(*
±r
); \

942 
sh
 = 
	`rfbHextûeExåa˘H
(*
±r
); \

943 
±r
++; \

944 
	`XFûlRe˘™gÀ
(
dpy
, 
ˇnvas
, 
gc
, 
x
+
sx
, 
y
+
sy
, 
sw
, 
sh
); \

950  
True
; \

951 }

	)

953 
DEFINE_HEXTILE
(8)

954 
DEFINE_HEXTILE
(16)

955 
DEFINE_HEXTILE
(32)

963 
	$PrötPixñF‹m©
(
rfbPixñF‹m©
 *
f‹m©
)

965 i‡(
f‹m©
->
bôsPîPixñ
 == 1) {

966 
	`Ârötf
(
°dîr
,"Single bitÖerÖixel.\n");

967 
	`Ârötf
(
°dîr
,

969 (
f‹m©
->
bigEndün
 ? "Most" : "Least"));

971 
	`Ârötf
(
°dîr
,"%d bô†≥∏pixñ.\n",
f‹m©
->
bôsPîPixñ
);

972 i‡(
f‹m©
->
bôsPîPixñ
 != 8) {

973 
	`Ârötf
(
°dîr
,"%s significant byte first inÉachÖixel.\n",

974 (
f‹m©
->
bigEndün
 ? "Most" : "Least"));

976 i‡(
f‹m©
->
åueCﬁour
) {

977 
	`Ârötf
(
°dîr
,"True colour: maxÑed %d green %d blue %d\n",

978 
f‹m©
->
ªdMax
, f‹m©->
gªíMax
, f‹m©->
blueMax
);

979 
	`Ârötf
(
°dîr
," shiftÑed %d green %d blue %d\n",

980 
f‹m©
->
ªdShi·
, f‹m©->
gªíShi·
, f‹m©->
blueShi·
);

982 
	`Ârötf
(
°dîr
,"Usesá colour map (notÅrue colour).\n");

985 
	}
}

	@demos/vnc/vncviewer/sockets.c

24 
	~<uni°d.h
>

25 
	~<sys/sockë.h
>

26 
	~<î∫o.h
>

27 
	~<√töë/ö.h
>

28 
	~<√töë/t˝.h
>

29 
	~<¨∑/öë.h
>

30 
	~<√tdb.h
>

31 
	~<vncvõwî.h
>

34 #i‚de‡
SOCK_STREAM


35 
	#SOCK_STREAM
 2

	)

38 
PrötInHex
(*
buf
, 
Àn
);

40 
Boﬁ
 
	gîr‹MesßgeFromRódExa˘
 = 
True
;

46 
Boﬁ


47 
	$RódExa˘
(
sock
, *
buf
, 
n
)

49 
i
 = 0;

50 
j
;

52 
i
 < 
n
) {

53 
j
 = 
	`ªad
(
sock
, 
buf
 + 
i
, (
n
 - i));

54 i‡(
j
 <= 0) {

55 i‡(
j
 < 0) {

56 
	`Ârötf
(
°dîr
,
¥ogømName
);

57 
	`≥º‹
(":Ñead");

59 i‡(
îr‹MesßgeFromRódExa˘
) {

60 
	`Ârötf
(
°dîr
,"%s:Ñód faûed\n",
¥ogømName
);

63  
FÆ£
;

65 
i
 +
j
;

67 i‡(
debug
)

68 
	`PrötInHex
(
buf
,
n
);

69  
True
;

70 
	}
}

77 
Boﬁ


78 
	$WrôeExa˘
(
sock
, *
buf
, 
n
)

80 
i
 = 0;

81 
j
;

83 
i
 < 
n
) {

84 
j
 = 
	`wrôe
(
sock
, 
buf
 + 
i
, (
n
 - i));

85 i‡(
j
 <= 0) {

86 i‡(
j
 < 0) {

87 
	`Ârötf
(
°dîr
,
¥ogømName
);

88 
	`≥º‹
(": write");

90 
	`Ârötf
(
°dîr
,"%s: wrôêÁûed\n",
¥ogømName
);

92  
FÆ£
;

94 
i
 +
j
;

96  
True
;

97 
	}
}

105 
	$C⁄√˘ToT˝Addr
(
ho°
, 
p‹t
)

107 
sock
;

108 
sockaddr_ö
 
addr
;

109 
⁄e
 = 1;

111 
addr
.
sö_Ámûy
 = 
AF_INET
;

112 
addr
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t
);

113 
addr
.
sö_addr
.
s_addr
 = 
ho°
;

115 
sock
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

116 i‡(
sock
 < 0) {

117 
	`Ârötf
(
°dîr
,
¥ogømName
);

118 
	`≥º‹
(": ConnectToTcpAddr: socket");

122 i‡(
	`c⁄√˘
(
sock
, (
sockaddr
 *)&
addr
, (addr)) < 0) {

123 
	`Ârötf
(
°dîr
,
¥ogømName
);

124 
	`≥º‹
(": ConnectToTcpAddr: connect");

125 
	`˛o£
(
sock
);

129 i‡(
	`£tsock›t
(
sock
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

130 (*)&
⁄e
, (one)) < 0) {

131 
	`Ârötf
(
°dîr
,
¥ogømName
);

132 
	`≥º‹
(": ConnectToTcpAddr: setsockopt");

133 
	`˛o£
(
sock
);

137  
sock
;

138 
	}
}

147 
	$Li°íAtT˝P‹t
(
p‹t
)

149 
sock
;

150 
sockaddr_ö
 
addr
;

151 
⁄e
 = 1;

153 
addr
.
sö_Ámûy
 = 
AF_INET
;

154 
addr
.
sö_p‹t
 = 
	`ht⁄s
(
p‹t
);

155 
addr
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

157 
sock
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0);

158 i‡(
sock
 < 0) {

159 
	`Ârötf
(
°dîr
,
¥ogømName
);

160 
	`≥º‹
(": ListenAtTcpPort: socket");

164 i‡(
	`£tsock›t
(
sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

165 (c⁄° *)&
⁄e
, (one)) < 0) {

166 
	`Ârötf
(
°dîr
,
¥ogømName
);

167 
	`≥º‹
(": ListenAtTcpPort: setsockopt");

168 
	`˛o£
(
sock
);

172 i‡(
	`böd
(
sock
, (
sockaddr
 *)&
addr
, (addr)) < 0) {

173 
	`Ârötf
(
°dîr
,
¥ogømName
);

174 
	`≥º‹
(": ListenAtTcpPort: bind");

175 
	`˛o£
(
sock
);

179 i‡(
	`li°í
(
sock
, 5) < 0) {

180 
	`Ârötf
(
°dîr
,
¥ogømName
);

181 
	`≥º‹
(": ListenAtTcpPort:Üisten");

182 
	`˛o£
(
sock
);

186  
sock
;

187 
	}
}

195 
	$Ac˚±T˝C⁄√˘i⁄
(
li°íSock
)

197 
sock
;

198 
sockaddr_ö
 
addr
;

199 
addæí
 = (
addr
);

200 
⁄e
 = 1;

202 
sock
 = 
	`ac˚±
(
li°íSock
, (
sockaddr
 *Ë&
addr
, &
addæí
);

203 i‡(
sock
 < 0) {

204 
	`Ârötf
(
°dîr
,
¥ogømName
);

205 
	`≥º‹
(": AcceptTcpConnection:áccept");

209 i‡(
	`£tsock›t
(
sock
, 
IPPROTO_TCP
, 
TCP_NODELAY
,

210 (*)&
⁄e
, (one)) < 0) {

211 
	`Ârötf
(
°dîr
,
¥ogømName
);

212 
	`≥º‹
(": AcceptTcpConnection: setsockopt");

213 
	`˛o£
(
sock
);

217  
sock
;

218 
	}
}

226 
	$SåögToIPAddr
(c⁄° *
°r
, *
addr
)

228 
ho°ít
 *
hp
;

230 i‡((*
addr
 = 
	`öë_addr
(
°r
)) == -1)

232 i‡(!(
hp
 = 
	`gëho°by«me
(
°r
)))

235 *
addr
 = *(*)
hp
->
h_addr
;

239 
	}
}

246 
Boﬁ


247 
	$SameMachöe
(
sock
)

249 
sockaddr_ö
 
≥îaddr
, 
myaddr
;

250 
addæí
 = (
sockaddr_ö
);

252 
	`gë≥î«me
(
sock
, (
sockaddr
 *)&
≥îaddr
, &
addæí
);

253 
	`gësock«me
(
sock
, (
sockaddr
 *)&
myaddr
, &
addæí
);

255  (
≥îaddr
.
sö_addr
.
s_addr
 =
myaddr
.sin_addr.s_addr);

256 
	}
}

264 
	$PrötInHex
(*
buf
, 
Àn
)

266 
i
, 
j
;

267 
c
, 
°r
[17];

269 
°r
[16] = 0;

271 
	`Ârötf
(
°dîr
,"ReadExact: ");

273 
i
 = 0; i < 
Àn
; i++)

275 i‡((
i
 % 16 == 0) && (i != 0)) {

276 
	`Ârötf
(
°dîr
," ");

278 
c
 = 
buf
[
i
];

279 
°r
[
i
 % 16] = (((
c
 > 31) && (c < 127)) ? c : '.');

280 
	`Ârötf
(
°dîr
,"%02x ",()
c
);

281 i‡((
i
 % 4) == 3)

282 
	`Ârötf
(
°dîr
," ");

283 i‡((
i
 % 16) == 15)

285 
	`Ârötf
(
°dîr
,"%s\n",
°r
);

288 i‡((
i
 % 16) != 0)

290 
j
 = 
i
 % 16; j < 16; j++)

292 
	`Ârötf
(
°dîr
," ");

293 i‡((
j
 % 4Ë=3Ë
	`Ârötf
(
°dîr
," ");

295 
°r
[
i
 % 16] = 0;

296 
	`Ârötf
(
°dîr
,"%s\n",
°r
);

299 
	`fÊush
(
°dîr
);

300 
	}
}

	@demos/vnc/vncviewer/vncviewer.c

24 
	~<vncvõwî.h
>

26 
H™dÀEvíts
(
GR_EVENT
 *
ev
);

29 
	$maö
(
¨gc
, **
¨gv
)

31 #i‚de‡
NANOX


32 
fd_£t
 
fds
;

33 
timevÆ
 
tv
, *
tvp
;

34 
msWaô
;

36 
	`¥o˚ssArgs
(
¨gc
, 
¨gv
);

38 i‡(
li°íS≥cifõd
) {

40 #i‚de‡
NANOX


41 
	`li°íF‹IncomögC⁄√˘i⁄s
();

46 i‡(!
	`C⁄√˘ToRFBSîvî
(
ho°«me
, 
p‹t
)Ë
	`exô
(1);

49 i‡(!
	`Inôüli£RFBC⁄√˘i⁄
(
rfbsock
)Ë
	`exô
(1);

51 i‡(!
	`Cª©eXWödow
()Ë
	`exô
(1);

53 i‡(!
	`SëF‹m©AndEncodögs
()) {

54 
	`ShutdownX
();

55 
	`exô
(1);

58 i‡(!
	`SídFømebuf„rUpd©eReque°
(
upd©eReque°X
, 
upd©eReque°Y
,

59 
upd©eReque°W
, 
upd©eReque°H
, 
FÆ£
)) {

60 
	`ShutdownX
();

61 
	`exô
(1);

64 
	`¥ötf
("«nox fd = %d,Ñfbsock = %d\n", 
	`C⁄√˘i⁄Numbî
(
dpy
), 
rfbsock
);

65 #ifde‡
NANOX


67 
	`GrRegi°îI≈ut
(
rfbsock
);

69 
True
) {

70 
	`GrMaöLo›
(
H™dÀEvíts
);

74 
True
) {

81 i‡(!
	`H™dÀXEvíts
()) {

82 
	`ShutdownX
();

83 
	`exô
(1);

86 
tvp
 = 
NULL
;

88 i‡(
£ndUpd©eReque°
) {

89 
	`gëtimeofday
(&
tv
, 
NULL
);

91 
msWaô
 = (
upd©eReque°Pîiodms
 +

92 ((
upd©eReque°Time
.
tv_£c
 - 
tv
.tv_sec) * 1000) +

93 ((
upd©eReque°Time
.
tv_u£c
 - 
tv
.tv_usec) / 1000));

95 i‡(
msWaô
 > 0) {

96 
tv
.
tv_£c
 = 
msWaô
 / 1000;

97 
tv
.
tv_u£c
 = (
msWaô
 % 1000) * 1000;

99 
tvp
 = &
tv
;

101 i‡(!
	`SídIn¸emíèlFømebuf„rUpd©eReque°
()) {

102 
	`ShutdownX
();

103 
	`exô
(1);

108 
	`FD_ZERO
(&
fds
);

109 
	`FD_SET
(
	`C⁄√˘i⁄Numbî
(
dpy
),&
fds
);

110 
	`FD_SET
(
rfbsock
,&
fds
);

112 i‡(
	`£À˘
(
FD_SETSIZE
, &
fds
, 
NULL
, NULL, 
tvp
) < 0) {

113 
	`≥º‹
("select");

114 
	`ShutdownX
();

115 
	`exô
(1);

118 i‡(
	`FD_ISSET
(
rfbsock
, &
fds
)) {

119 i‡(!
	`H™dÀRFBSîvîMesßge
()) {

120 
	`ShutdownX
();

121 
	`exô
(1);

128 
	}
}

130 #ifde‡
NANOX


135 
	$H™dÀEvíts
(
GR_EVENT
 *
ev
)

137 
timevÆ
 
tv
, *
tvp
;

138 
msWaô
;

143 i‡(
ev
->
ty≥
 =
GR_EVENT_TYPE_FDINPUT
) {

144 i‡(!
	`H™dÀRFBSîvîMesßge
()) {

145 
	`ShutdownX
();

146 
	`exô
(1);

149 i‡(!
	`H™dÀXEvíts
(
ev
)) {

150 
	`ShutdownX
();

151 
	`exô
(1);

154 i‡(
£ndUpd©eReque°
) {

155 
	`gëtimeofday
(&
tv
, 
NULL
);

157 
msWaô
 = (
upd©eReque°Pîiodms
 +

158 ((
upd©eReque°Time
.
tv_£c
 - 
tv
.tv_sec) * 1000) +

159 ((
upd©eReque°Time
.
tv_u£c
 - 
tv
.tv_usec) / 1000));

161 i‡(
msWaô
 > 0) {

162 
tv
.
tv_£c
 = 
msWaô
 / 1000;

163 
tv
.
tv_u£c
 = (
msWaô
 % 1000) * 1000;

165 
tvp
 = &
tv
;

167 i‡(!
	`SídIn¸emíèlFømebuf„rUpd©eReque°
()) {

168 
	`ShutdownX
();

169 
	`exô
(1);

173 
	}
}

	@demos/vnc/vncviewer/vncviewer.h

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<°rög.h
>

27 
	~<sys/time.h
>

28 #ifde‡
NANOX


29 
	#MWINCLUDECOLORS


	)

30 
	~"«no-X.h
"

32 
	tCARD32
;

33 
	tCARD16
;

34 
	tCARD8
;

36 
	~<X11/Xlib.h
>

37 
	~<X11/Xmd.h
>

39 
	~<rfb¥Ÿo.h
>

41 #ifde‡
NANOX


43 
	#Boﬁ
 
GR_BOOL


	)

44 
	#True
 
GR_TRUE


	)

45 
	#FÆ£
 
GR_FALSE


	)

46 
	#XGCVÆues
 
GR_GC_INFO


	)

48 
GR_ID
 
	tWödow
;

49 
GR_ID
 
	tCﬁ‹m≠
;

50 
CARD32
 
	tAtom
;

51 
CARD32
 
	tTime
;

53 
	#N⁄e
 0L

	)

54 
	#CuºítTime
 0L

	)

55 
	#Pr›îtyCh™geMask
 (1L<<22Ë

	)

56 
	#XA_PRIMARY
 ((
Atom
Ë1Ë

	)

59 
	#DoRed
 (1<<0)

	)

60 
	#DoGªí
 (1<<1)

	)

61 
	#DoBlue
 (1<<2)

	)

63 
	#C⁄√˘i⁄Numbî
(
dpy
Ë((dpy)->
fd
)

	)

64 
	#S¸ìnOfDi•œy
(
dpy
, 
s¸
Ë(&(dpy)->
s¸ìns
[s¸])

	)

65 
	#DeÁu…S¸ìn
(
dpy
Ë((dpy)->
deÁu…_s¸ìn
)

	)

66 
	#DeÁu…RoŸWödow
(
dpy
Ë(
	`S¸ìnOfDi•œy
(dpy,
	`DeÁu…S¸ìn
(dpy))->
roŸ
)

	)

67 
	#DeÁu…GC
(
dpy
, 
s¸
Ë(
	`S¸ìnOfDi•œy
(dpy,s¸)->
deÁu…_gc
)

	)

71 
	mpixñ
;

72 
	mªd
, 
	mgªí
, 
	mblue
;

73 
	mÊags
;

74 
	m∑d
;

75 } 
	tXCﬁ‹
;

77 
	#GCF‹eground
 (1L<<2)

	)

78 
	#GCBackground
 (1L<<3)

	)

84 
Wödow
 
	mroŸ
;

85 } 
	tS¸ìn
;

90 
	mfd
;

91 
	mdeÁu…_s¸ìn
;

92 
S¸ìn
 *
	ms¸ìns
;

93 } 
	tDi•œy
;

99 
	mdummy
;

100 } 
	tXEvít
;

105 
ídünTe°
;

107 
	#Sw≠16IfLE
(
s
) \

108 (*(*)&
ídünTe°
 ? ((((
s
Ë& 0xffË<< 8Ë| (((sË>> 8Ë& 0xff)Ë: (s))

	)

110 
	#Sw≠32IfLE
(
l
) \

111 (*(*)&
ídünTe°
 ? ((((
l
) & 0xff000000) >> 24) | \

112 (((
l
) & 0x00ff0000) >> 8) | \

113 (((
l
) & 0x0000ff00) << 8) | \

114 (((
l
Ë& 0x000000ffË<< 24)Ë: (l))

	)

116 
	#MAX_ENCODINGS
 10

	)

121 *
¥ogømName
;

122 
ho°«me
[];

123 
p‹t
;

124 
Boﬁ
 
li°íS≥cifõd
;

125 
li°íP‹t
, 
ÊashP‹t
;

126 *
di•œy«me
;

127 
Boﬁ
 
sh¨eDeskt›
;

128 
Boﬁ
 
võwO∆y
;

129 
CARD32
 
ex∂icôEncodögs
[];

130 
nEx∂icôEncodögs
;

131 
Boﬁ
 
addC›yRe˘
;

132 
Boﬁ
 
addRRE
;

133 
Boﬁ
 
addCoRRE
;

134 
Boﬁ
 
addHextûe
;

135 
Boﬁ
 
u£BGR233
;

136 
Boﬁ
 
f‹˚OwnCm≠
;

137 
Boﬁ
 
f‹˚Truecﬁour
;

138 
ªque°edDïth
;

139 *
geomëry
;

140 
wmDec‹©i⁄Width
;

141 
wmDec‹©i⁄Height
;

142 *
∑sswdFûe
;

143 
upd©eReque°Pîiodms
;

144 
upd©eReque°X
;

145 
upd©eReque°Y
;

146 
upd©eReque°W
;

147 
upd©eReque°H
;

148 
øwDñay
;

149 
c›yRe˘Dñay
;

150 
Boﬁ
 
debug
;

152 
¥o˚ssArgs
(
¨gc
, **
¨gv
);

153 
ußge
();

158 
rfbsock
;

159 
Boﬁ
 
ˇnU£CoRRE
;

160 
Boﬁ
 
ˇnU£Hextûe
;

161 *
deskt›Name
;

162 
rfbPixñF‹m©
 
myF‹m©
;

163 
rfbSîvîInôMsg
 
si
;

164 
timevÆ
 
upd©eReque°Time
;

165 
Boﬁ
 
£ndUpd©eReque°
;

167 
Boﬁ
 
C⁄√˘ToRFBSîvî
(c⁄° *
ho°«me
, 
p‹t
);

168 
Boﬁ
 
Inôüli£RFBC⁄√˘i⁄
();

169 
Boﬁ
 
SëF‹m©AndEncodögs
();

170 
Boﬁ
 
SídIn¸emíèlFømebuf„rUpd©eReque°
();

171 
Boﬁ
 
SídFømebuf„rUpd©eReque°
(
x
, 
y
, 
w
, 
h
,

172 
Boﬁ
 
ö¸emíèl
);

173 
Boﬁ
 
SídPoöãrEvít
(
x
, 
y
, 
buâ⁄Mask
);

174 
Boﬁ
 
SídKeyEvít
(
CARD32
 
key
, Boﬁ 
down
);

175 
Boﬁ
 
SídClõ¡CutText
(*
°r
, 
Àn
);

176 
Boﬁ
 
H™dÀRFBSîvîMesßge
();

178 #ifde‡
NANOX


182 
Di•œy
 *
dpy
;

183 
Wödow
 
ˇnvas
;

184 
Cﬁ‹m≠
 
cm≠
;

185 
GR_GC_ID
 
gc
;

186 
GR_GC_ID
 
§cGC
, 
d°GC
;

187 
BGR233ToPixñ
[];

189 
Boﬁ
 
Cª©eXWödow
();

190 
ShutdownX
();

191 
Boﬁ
 
H™dÀXEvíts
(
GR_EVENT
 *
ev
);

192 
Boﬁ
 
AŒXEvítsPªdiˇã
(
Di•œy
 *
dpy
, 
XEvít
 *
ev
, *
¨g
);

193 
C›yD©aToS¸ìn
(
CARD8
 *
buf
, 
x
, 
y
, 
width
, 
height
);

196 *
XDi•œyName
(*
di•œy
);

197 
XCh™geGC
(
Di•œy
 *
dpy
, 
GR_GC_ID
 
gc
, 
vmask
,

198 
GR_GC_INFO
 *
gcv
);

199 
XSt‹eCﬁ‹
(
Di•œy
 *
dpy
, 
Cﬁ‹m≠
 
cm≠
, 
XCﬁ‹
 *
xc
);

200 
XFûlRe˘™gÀ
(
Di•œy
 *
dpy
, 
Wödow
 
ˇnvas
, 
GR_GC_ID
 
gc
,

201 
x
, 
y
, 
w
, 
h
);

202 
XSync
(
Di•œy
 *
dpy
, 
Boﬁ
 
disˇrd
);

203 
XC›yAªa
(
Di•œy
 *
dpy
, 
Wödow
 
§c
, Wödow 
d°
, 
GR_GC_ID
 
gc
, \

204 
x1
, 
y1
, 
w
, 
h
, 
x2
, 
y2
);

205 
XBñl
(
Di•œy
 *
dpy
, 
≥r˚¡
);

206 
XSñe˘I≈ut
(
Di•œy
 *
dpy
, 
Wödow
 
wö
, 
evmask
);

207 
XSt‹eByãs
(
Di•œy
 *
dpy
, *
byãs
, 
nbyãs
);

208 
XSëSñe˘i⁄Ow√r
(
Di•œy
 *
dpy
, 
Atom
 
£l
, 
Wödow
 
own
, 
Time
 
t
);

214 
Di•œy
 *
dpy
;

215 
Wödow
 
ˇnvas
;

216 
Cﬁ‹m≠
 
cm≠
;

217 
GC
 
gc
;

218 
GC
 
§cGC
, 
d°GC
;

219 
BGR233ToPixñ
[];

221 
Boﬁ
 
Cª©eXWödow
();

222 
ShutdownX
();

223 
Boﬁ
 
H™dÀXEvíts
();

224 
Boﬁ
 
AŒXEvítsPªdiˇã
(
Di•œy
 *
dpy
, 
XEvít
 *
ev
, *
¨g
);

225 
C›yD©aToS¸ìn
(
CARD8
 *
buf
, 
x
, 
y
, 
width
, 
height
);

231 
Boﬁ
 
îr‹MesßgeFromRódExa˘
;

233 
Boﬁ
 
RódExa˘
(
sock
, *
buf
, 
n
);

234 
Boﬁ
 
WrôeExa˘
(
sock
, *
buf
, 
n
);

235 
Li°íAtT˝P‹t
(
p‹t
);

236 
C⁄√˘ToT˝Addr
(
ho°
, 
p‹t
);

237 
Ac˚±T˝C⁄√˘i⁄
(
li°íSock
);

238 
SåögToIPAddr
(c⁄° *
°r
, *
addr
);

239 
Boﬁ
 
SameMachöe
(
sock
);

244 
li°íF‹IncomögC⁄√˘i⁄s
();

	@drivers/SubRepl.h

3 
ölöe
 
T8p
 
	$sd
(
T8p
 
d1
, 
s1
, T8∞
d2
, 
s2
)

5 { ((
d1
<<
s1
)|(
d2
>>
s2
)); 
	}
}

7 
ölöe
 
T8p
 
	$sdm
(
T8p
 
d1
, 
s1
, T8∞
d2
, 
s2
, T8∞
m
)

9 { (((
d1
<<
s1
)|(
d2
>>
s2
))&
m
); 
	}
}

11 
ölöe
 
T8p
 
	$sdml
(
T8p
 
d
, 
s
, T8∞
m
)

13 { (
m
&(
d
<<
s
)); 
	}
}

15 
ölöe
 
T8p
 
	$sdmr
(
T8p
 
d
, 
s
, T8∞
m
)

17 { (
m
&(
d
>>
s
)); 
	}
}

32 
ölöe
 
	$B…_Shi·_Posôif_w0
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

34 
M1

M2
&~M1;

37 *
d
(*d&~
M1
Ë| 
	`sdml
(*
s
, 
S
, M1);

38 
d
+
ds
; 
s
+
ss
;

39 } --
h
!=0);

41 
	}
}

43 
ölöe
 
	$B…_Shi·_Posôif_w1
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

45 
S2
32-
S
;

46 
M1
= ~M1;

49 
T8p
 
d1
*
s
++;

50 *
d
++(*d&~
M1
)|
	`sdml
(
d1
, 
S
, M1);

51 *
d
(*d&~
M2
)| 
	`sdm
(*
s
, 
S
, 
d1
, 
S2
, M2);

52 
d
+
ds
; 
s
+
ss
;

53 } --
h
!=0);

55 
	}
}

57 
ölöe
 
	$B…_Shi·_Posôif_w2
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

59 
S2
32- 
S
;

60 
M1
= ~M1;

63 
T8p
 
d2
, 
d1
*
s
++; *
d
++(*d&~
M1
)|
	`sdml
(d1, 
S
, M1);

64 
d2
*
s
++; *
d
++
	`sd
(d2, 
S
, 
d1
, 
S2
);

65 *
d
(*d&~
M2
)|
	`sdm
(*
s
, 
S
, 
d2
, 
S2
, M2);

66 
d
+
ds
; 
s
+
ss
;

67 } --
h
!=0);

69 
	}
}

71 
ölöe
 
	$B…_Shi·_Posôif
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

73 
S2
32- 
S
;

74 
M1
= ~M1;

78 
i
;

80 
T8p
 
d1
*
s
++;

82 *
d
++(*d&~
M1
)|
	`sdml
(
d1
, 
S
, M1);

84 
i

w
;

86 dÿ{ 
T8p
 
d2
*
s
++; *
d
++
	`sd
(d2, 
S
, 
d1
, 
S2
); d1d2; } --
i
!=0);

88 *
d
(*d&~
M2
)|
	`sdm
(*
s
, 
S
, 
d1
, 
S2
, M2);

90 
d
+
ds
; 
s
+
ss
;

91 } --
h
!=0);

93 
	}
}

95 
ölöe
 
	$B…_Shi·_NuŒ_w0
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

97 
M1
|~
M2
;

100 *
d
(*d&
M1
Ë| (*
s
&~M1);

101 
d
+
ds
; 
s
+
ss
;

102 } --
h
!=0);

103 
	}
}

105 
ölöe
 
	$B…_Shi·_NuŒ_w1
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

109 *
d
++(*d&
M1
)|(*
s
++&~M1);

110 *
d
(*d&~
M2
)|(*
s
&M2);

111 
d
+
ds
; 
s
+
ss
;

112 } --
h
!=0);

114 
	}
}

116 
ölöe
 
	$B…_Shi·_NuŒ_w2
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

120 *
d
++(*d&
M1
)|(*
s
++&~M1);

121 *
d
++*
s
++;

122 *
d
(*d&~
M2
)|(*
s
&M2);

123 
d
+
ds
; 
s
+
ss
;

124 } --
h
!=0);

126 
	}
}

128 
ölöe
 
	$B…_Shi·_NuŒ_w3
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

132 *
d
++(*d&
M1
)|(*
s
++&~M1);

133 *
d
++*
s
++;

134 *
d
++*
s
++;

135 *
d
(*d&~
M2
)|(*
s
&M2);

136 
d
+
ds
; 
s
+
ss
;

137 } --
h
!=0);

139 
	}
}

141 
ölöe
 
	$B…_Shi·_NuŒ
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

145 
i
;

146 *
d
++(*d&
M1
)|(*
s
++&~M1);

147 
w
&7)

149 7: *
d
++*
s
++; 6: *d++= *s++; 5: *d++= *s++; 4: *d++= *s++;

150 3: *
d
++*
s
++; 2: *d++= *s++; 1: *d++= *s++; 0: :;

152 
i

w
>>3; i!=0; i--)

154 *
d
++*
s
++; *d++= *s++; *d++= *s++; *d++= *s++;

155 *
d
++*
s
++; *d++= *s++; *d++= *s++; *d++= *s++;

157 *
d
(*d&~
M2
)|(*
s
&M2);

158 
d
+
ds
; 
s
+
ss
;

159 } --
h
!=0);

161 
	}
}

163 
ölöe
 
	$B…_Shi·_Neg©if_w0
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

165 
S2
32+ 
S
;

166 
S
= -S;

167 
M1

M2
&~M1;

170 *
d
(*d&~
M1
Ë| 
	`sdm
(*(
s
+1), 
S2
, *s, 
S
, M1);

171 
d
+
ds
; 
s
+
ss
;

172 } --
h
!=0);

174 
	}
}

176 
ölöe
 
	$B…_Shi·_Neg©if_w1
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

178 
S2
32+ 
S
;

179 
M1
= ~M1;

180 
S
= -S;

183 
T8p
 
d1
*
s
++; T8∞
d2
= *s;

184 *
d
++(*d&~
M1
)|
	`sdm
(
d2
, 
S2
, 
d1
, 
S
, M1);

185 *
d
(*d&~
M2
)|
	`sdm
(*(
s
+1), 
S2
, *s, 
S
, M2);

186 
d
+
ds
; 
s
+
ss
;

187 } --
h
!=0);

189 
	}
}

191 
ölöe
 
	$B…_Shi·_Neg©if_w2
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

193 
S2
32+
S
;

194 
M1
= ~M1;

195 
ss
--;

196 
S
= -S;

199 
T8p
 
d1
*
s
++; T8∞
d2
= *s++;

200 *
d
++(*d&~
M1
)|
	`sdm
(
d2
, 
S2
, 
d1
, 
S
, M1);

201 
d1
*
s
++; *
d
++
	`sd
(d1, 
S2
, 
d2
, 
S
);

202 *
d
(*d&~
M2
)|
	`sdm
(*
s
, 
S2
, 
d1
, 
S
, M2);

203 
d
+
ds
; 
s
+
ss
;

204 } --
h
!=0);

206 
	}
}

208 
ölöe
 
	$B…_Shi·_Neg©if
(
P8p
 
s
, P8∞
d
, 
ss
, 
ds
, 
S
, 
T8p
 
M1
, T8∞
M2
, 
w
, 
h
)

210 
S2
32+
S
;

211 
M1
= ~M1;

212 
ss
--;

213 
S
= -S;

216 
i
;

217 
T8p
 
d1
*
s
++; T8∞
d2
= *s++;

218 *
d
++(*d&~
M1
)|
	`sdm
(
d2
, 
S2
, 
d1
, 
S
, M1);

219 
i

w
;

220 dÿ{ 
d1

d2
; d2*
s
++; *
d
++
	`sd
(d2, 
S2
, d1, 
S
); } --
i
!=0);

221 *
d
(*d&~
M2
)|
	`sdm
(*
s
, 
S2
, 
d2
, 
S
, M2);

222 
d
+
ds
; 
s
+
ss
;

223 } --
h
!=0);

225 
	}
}

	@drivers/asm.h

1 ; 26 
	gJul
 92

2 ; 
C›yright
 (
c
Ë1999 
Gªg
 
	gH´º
 <
	ggªg
@
	g˚nso·
.
	gcom
>

3 ; 
	gasm
.
	gh
 - 
Æl
ásm*.
s
 
	gTC
/
	gMC
/
Azãc
 
as£mbly
 
ö˛ude
 
	gfûe


5 ; 7/26/92 
	gv6
.3 
TSC
 
	gsuµ‹t


6 ; 11/17/92 
‹igöÆ
 
	gvîsi⁄


8 #deföê
	#__LARGE__
, 
__MEDIUM__
, 
__SMALL__
 
modñ


	)

9 #deföê
	#AZTEC
, 
TURBOC
, 
‹
 
MSC
 
C
 
Compûî


	)

11 ; 
Routöes
 
	gö˛uded
:

13 ; 
ö˛ude
 
	gasm
.
	gh
 - 
°¨t
 
the
 
as£mbly
 
	gfûe


14 ; .
	ghódî
 - 
¸óã
 
the
 
code
 
™d
 
d©a
 
	g£gs


15 ; .
	gc£g
 - 
°¨t
 
the
 
code
 
	g£gmít


16 ; .
	g˚nd
 - 
íd
 
the
 
code
 
	g£gmít


17 ; .
	gd£g
 - 
°¨t
 
the
 
d©a
 
	g£gmít


18 ; .
	gdíd
 - 
íd
 
the
 
d©a
 
	g£gmít


19 ; .
dsym
 
	g«me
,
	gty≥
 - 
de˛¨e
 
globÆ
 
C
 
d©a
 (
ty≥
=
w‹d
,
byã
)

20 ; .
˚xç
 
	g«me
 - 
ª„ªn˚
 
™
 
exã∫Æ
 
C
 
	g¥o˚duª
, 
u£
 
modñ
 
as
 
	gty≥


21 ; .
˚xån
 
	g«me
,
	gty≥
- 
ª„ªn˚
 
exã∫Æ
 
C
 
v¨übÀ
 
™d
 
ty≥
(
w‹d
,
byã
)

22 ; .
˝roc
 
	g«me
 - 
de˛¨e
 
a
 
	gC
-
ac˚ssibÀ
 
	g¥o˚duª
, 
u£
 
modñ
 
as
 
	gty≥


23 ; .
˚ndp
 
	g«me
 - 
íd
 
C
 
	g¥o˚duª


24 ; .
	g˚¡î
 - 
íãr
 
C
 
¥o˚duª
 (
£t
 
up
 
BP
 
ëc
)

25 ; .
	g˚xô
 - 
exô
 
C
 
¥o˚duª
 (
ª°‹e
 
BP
 
ëc
)

28 ; 
Check
 
Modñ
 
Symbﬁ


29 
IFNDEF
 
__LARGE__


30 
IFNDEF
 
__MEDIUM__


31 
IFNDEF
 
	g__SMALL__


32 %
OUT
 
You
 
mu°
 
suµly
 
a
 
modñ
 
	gsymbﬁ
, 
	g__LARGE__
, 
	g__SMALL__
, 
‹
 
__MEDIUM__


33 
ENDIF


34 
ENDIF


35 
	gENDIF


37 ; 
Check
 
Compûî
 
Symbﬁ


38 
IFDEF
 
AZTEC


39 
ö˛ude
 
	gasmaz
.
h


40 
ELSE


41 
IFDEF
 
TURBOC


42 
ö˛ude
 
	gasmtc
.
h


43 
ELSE


44 
IFDEF
 
MSC


45 
ö˛ude
 
	gasmmsc
.
h


46 
ELSE


47 
IFDEF
 
TSC


48 
ö˛ude
 
	gasmtsc
.
h


49 
	gELSE


50 %
OUT
 
You
 
mu°
 
suµly
 
a
 
Compûî
 
	gsymbﬁ
, 
	gAZTEC
, 
	gTURBOC
, 
MSC
 
‹
 
	gTSC
.

51 .
ERR


52 
ENDIF


53 
ENDIF


54 
ENDIF


55 
	gENDIF


57 ; 
Deföe
 
Ÿhî
 
globÆ
 
symbﬁs


58 
IFDEF
 
__LARGE__


59 
LPROG
 
	gequ
 1

60 
LDATA
 
	gequ
 1

61 
ifdef
 
AZTEC


62 
PROCP
 
equ
 
Ár


64 
PROCPTR
 
equ
 
Ár
 
±r


65 
ídif


66 
ENDIF


68 
IFDEF
 
__MEDIUM__


69 
LPROG
 
	gequ
 1

70 
LDATA
 
	gequ
 0

71 
ifdef
 
AZTEC


72 
PROCP
 
equ
 
Ár


74 
PROCPTR
 
equ
 
Ár
 
±r


75 
ídif


76 
ENDIF


78 
IFDEF
 
__SMALL__


79 
LPROG
 
	gequ
 0

80 
LDATA
 
	gequ
 0

81 
ifdef
 
AZTEC


82 
PROCP
 
equ
 
√¨


84 
PROCPTR
 
equ
 
√¨
 
±r


85 
ídif


86 
	gENDIF


	@drivers/asmmsc.h

1 ; 30 
	gAug
 92

2 ; 
C›yright
 (
c
Ë1999 
Gªg
 
	gH´º
 <
	ggªg
@
	g˚nso·
.
	gcom
>

3 ; 
	gmsc
.
	gh
 - 
	gasm
.
h
 
ö˛ude
 
MSC
 
	gCompûî


5 ; 8/30/92 
ch™ged
 
smÆl
 
modñ
 
to
 
u£
 
_TEXT
 
⁄ly
 
fixup
 
	govîÊows


6 ; 7/26/92 
	gv6
.3 .
	g˚¡î
/.
˚xô
 
ma¸os
 
	gTSC


7 ; 11/17/90 
‹igöÆ
 
	gvîsi⁄


9 ; .
	ghódî
 - 
°¨t
 
™
 
as£mbly
 
	gfûe


10 .
hódî
 
ma¸o


11 
ifdef
 
__SMALL__


12 
_TEXT
 
SEGMENT
 
WORD
 
	gPUBLIC
 'CODE'

13 
_TEXT
 
ENDS


15 
ASM_TEXT
 
SEGMENT
 
WORD
 
	gPUBLIC
 'CODE'

16 
ASM_TEXT
 
ENDS


17 
ídif


18 
_DATA
 
SEGMENT
 
WORD
 
	gPUBLIC
 'DATA'

19 
_DATA
 
ENDS


20 
CONST
 
SEGMENT
 
WORD
 
	gPUBLIC
 'CONST'

21 
CONST
 
ENDS


22 
_BSS
 
SEGMENT
 
WORD
 
	gPUBLIC
 'BSS'

23 
_BSS
 
ENDS


24 
DGROUP
 
GROUP
 
	gCONST
, 
	g_BSS
, 
_DATA


25 
ifdef
 
__LARGE__


26 
ASSUME
 
	gCS
: 
ASM_TEXT
, 
	gDS
: 
DGROUP
, 
	gSS
: DGROUP

27 
ídif


28 
ifdef
 
__MEDIUM__


29 
ASSUME
 
CS
: 
ASM_TEXT
, 
	gDS
: 
DGROUP
 ; 
smÆl
 
d©a


30 
ídif


31 
ifdef
 
__SMALL__


32 
ASSUME
 
	gCS
: 
_TEXT
, 
	gDS
: 
DGROUP
 ; 
smÆl
 
d©a


33 
ídif


34 
_BSS
 
SEGMENT


35 
_BSS
 
ENDS


36 
	gídm


38 ; .
	gc£g
 - 
°¨t
 
a
 
code
 
	g£gmít


39 .
c£g
 
ma¸o


40 
ifdef
 
__SMALL__


41 
_TEXT
 
SEGMENT


42 
ASSUME
 
	gCS
: 
_TEXT


44 
ASM_TEXT
 
SEGMENT


45 
ASSUME
 
CS
: 
ASM_TEXT


46 
ídif


47 
ídm


49 ; .
	g˚nd
 - 
íd
 
a
 
code
 
	g£gmít


50 .
˚nd
 
ma¸o


51 
ifdef
 
__SMALL__


52 
_TEXT
 
ENDS


54 
ASM_TEXT
 
ENDS


55 
ídif


56 
	gídm


58 ; .
	gd£g
 - 
°¨t
 
a
 
d©a
 
	g£gmít


59 .
d£g
 
ma¸o


60 
_DATA
 
£gmít
 
w‹d
 
	gpublic
 'DATA'

61 
	gídm


63 ; .
	gdsym
 - 
deföe
 
	gd©a


64 .
dsym
 
ma¸o
 
	g«me
,
ty≥


65 
public
 
	g_
&
«me


66 
	g_
&
«me
 
œbñ
 
ty≥


67 
	gídm


69 ; .
	gdíd
 - 
íd
 
a
 
d©a
 
	g£gmít


70 .
díd
 
ma¸o


71 
_DATA
 
íds


72 
	gídm


74 ; .
˚xç
 
	g«me
 - 
de˛¨e
 
™
 
exã∫Æ
 
	g¥o˚duª
, 
u£
 
cuºít
 
modñ
 
	g√¨
/
	gÁr


75 .
˚xç
 
ma¸o
 
«me


76 
LPROG


77 
exån
 
	g_
&
	g«me
:
Ár


79 
exån
 
_
&
«me
:
√¨


80 
ídif


81 
«me
&@ 
equ
 
_
&name

82 
ídm


84 ; .
˚xån
 
	g«me
,
	gty≥
 - 
de˛¨e
 
exã∫Æ
 
C
 
v¨übÀ
 
™d
Åype

85 .
˚xån
 
ma¸o
 
	g«me
,
ty≥


86 
exån
 
	g_
&
	g«me
:
ty≥


87 
«me
&@ 
equ
 
DGROUP
:
_
&name

88 
ídm


90 ; .
˝roc
 
	g«me
 - 
u£d
 
to
 
°¨t
 
a
 
C
 
	g¥o˚duª


91 .
˝roc
 
ma¸o
 
«me


92 
public
 
	g_
&
«me


93 
LPROG


94 
	g¨g1
 = 6

95 
_
&
«me
 
¥oc
 
Ár


97 
¨g1
 = 4

98 
_
&
«me
 
¥oc
 
√¨


99 
ídif


100 
«me
&@ 
equ
 
_
&name

101 
ídm


103 ; .
	g˚ndp
 - 
íd
 
a
 
C
 
	g¥o˚duª


104 .
˚ndp
 
ma¸o
 
«me


105 
	g_
&
«me
 
ídp


106 
	gídm


108 ; .
	g˚¡î
 - 
íãr
 
C
 
	g¥o˚duª


109 .
˚¡î
 
ma¸o


110 
push
 
bp


111 
mov
 
	gbp
,
•


112 
	gídm


114 ; .
	g˚xô
 - 
exô
 
C
 
	g¥o˚duª


115 .
˚xô
 
ma¸o


116 
p›
 
bp


117 
ªt


118 
	gídm


	@drivers/dynacal.c

7 
	~<°dio.h
>

8 
	~<uni°d.h
>

9 
	~<f˙é.h
>

10 
	~<î∫o.h
>

12 
	~<sys/ãrmios.h
>

13 
	~<«no-X.h
>

16 
	ms¸X
;

17 
	ms¸Y
;

18 
	møwX
;

19 
	møwY
;

20 } 
	gd©aPoöts
[4];

23 
ãrmios
 
	gios_ßved
;

24 
ãrmios
 
	gios_cuºít
;

26 
	#BGCOLOR
 
	`GR_RGB
(0,0,0)

	)

27 
	#FGCOLOR
 
	`GR_RGB
(255,255,255)

	)

29 *
	gö°ru˘i⁄s
[4] = {

36 
	$ˇlInôSîül
(*
dev
) {

39 
fd
 = 
	`›í
(
dev
, 
O_NONBLOCK
);

41 i‡(
fd
 <= 0) {

42 
	`≥º‹
("open serial");

46 
	`tcgë©å
(
fd
, &
ios_ßved
);

47 
ios_cuºít
 = 
ios_ßved
;

49 
	`cfmakîaw
(&
ios_cuºít
);

53 
	`cf£ti•ìd
(&
ios_cuºít
, 
B2400
);

54 
	`cf£to•ìd
(&
ios_cuºít
, 
B2400
);

57 
ios_cuºít
.
c_cÊag
 &~(
CSIZE
 | 
PARENB
);

58 
ios_cuºít
.
c_cÊag
 |
CS8
;

60 
ios_cuºít
.
c_cc
[
VMIN
] = 3;

61 
ios_cuºít
.
c_cc
[
VTIME
] = 1;

63 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ios_cuºít
);

64 
	`tcÊush
(
fd
, 
TCIOFLUSH
);

66 (
fd
);

67 
	}
}

69 
	$ˇlClo£Sîül
(
fd
) {

70 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ios_ßved
);

71 
	`tcÊush
(
fd
, 
TCIOFLUSH
);

73 
	`˛o£
(
fd
);

74 
	}
}

76 
	$ˇlRódSîül
(
fd
) {

78 
f
;

79 
vÆ
 = 
	`ªad
(
fd
, &
f
, (f));

81 i‡(
vÆ
 <= 0) (val);

83 ((Ë
f
);

84 
	}
}

88 
	$ˇlGëI≈ut
(
fd
, *
d©a
) {

90 
cou¡
 = 0;

91 
°©e
 = 0;

97 
c
 = 
	`ˇlRódSîül
(
fd
);

99 i‡(
c
 < 0 && 
î∫o
 !
EAGAIN
) (-1);

101 i‡(
cou¡
++ > 500) (0);

102 i‡(
c
 <= 0) ;

104 
°©e
) {

107 i‡(
c
 & 0x80) {

108 
d©a
[0] = (Ë
c
;

109 
°©e
 = 1;

112 
	`Ârötf
(
°dîr
, "N⁄ sèπ byãÑecõved (%2.2x)\n", 
c
);

117 i‡(!(
c
 & 0x80)) {

118 
d©a
[1] = (Ë
c
;

119 
°©e
 = 2;

122 
	`Ârötf
(
°dîr
, "Gotá start byte inÅhe middle ofÅheÖacket\n");

123 
d©a
[0] = (Ë
c
;

125 
°©e
 = 0;

132 i‡(!(
c
 & 0x80)) {

133 
d©a
[2] = (Ë
c
;

137 
	`Ârötf
(
°dîr
, "Gotá start byte inÅhe middle ofÅheÖacket\n");

138 
d©a
[0] = (Ë
c
;

140 
°©e
 = 0;

148 
	}
}

151 
	$døwText
(
GR_WINDOW_ID
 
id
, **
ãxt
, 
cou¡
) {

153 
tw
, 
th
, 
tb
;

154 
xpos
, 
ypos
;

155 
i
;

157 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

158 
GR_WINDOW_INFO
 
öfo
;

160 
	`GrGëWödowInfo
(
id
, &
öfo
);

162 
	`GrSëGCF‹eground
(
gc
, 
FGCOLOR
);

163 
	`GrSëGCBackground
(
gc
, 
BGCOLOR
);

166 
	`GrGëGCTextSize
(
gc
, 
ãxt
[0], -1, 
GR_TFTOP
, &
tw
, &
th
, &
tb
);

168 
ypos
 = (
öfo
.
height
 - ((
cou¡
 * 
th
)+ 3)) / 2;

172 
i
 = 0; i < 
cou¡
; i++) {

173 
	`GrGëGCTextSize
(
gc
, 
ãxt
[
i
], -1, 
GR_TFTOP
, &
tw
, &
th
, &
tb
);

174 
xpos
 = (
öfo
.
width
 - 
tw
) / 2;

175 
	`GrText
(
id
, 
gc
, 
xpos
, 
ypos
, 
ãxt
[
i
], -1, 
GR_TFTOP
);

177 
ypos
 +
th
 + 3;

180 
	`GrDe°royGC
(
gc
);

181 
	}
}

183 
	$doPoöts
(
GR_WINDOW_ID
 
id
, 
fd
) {

185 
d©a
[4];

186 
îr
 = 0, 
i
;

187 
fd_£t
 
fd£t
;

189 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

191 
i
 = 0; i < 4; i++) {

193 
tŸÆx
 = 0, 
tŸÆy
 = 0;

194 
p
;

198 i‡(
i
 - 1 >= 0) {

199 
	`GrSëGCF‹eground
(
gc
, 
BGCOLOR
);

200 
	`GrFûlRe˘
(
id
, 
gc
, 
d©aPoöts
[
i
 - 1].
s¸X
 - 10,

201 
d©aPoöts
[
i
 - 1].
s¸Y
 - 10, 20, 20);

205 
	`GrSëGCF‹eground
(
gc
, 
	`GR_RGB
(255,0,0));

207 
	`GrFûlRe˘
(
id
, 
gc
, 
d©aPoöts
[
i
].
s¸X
 - 10, d©aPoöts[i].
s¸Y
 - 1,

210 
	`GrFûlRe˘
(
id
, 
gc
, 
d©aPoöts
[
i
].
s¸X
 - 1, d©aPoöts[i].
s¸Y
 - 10,

213 
	`GrFlush
();

217 
	`FD_SET
(
fd
, &
fd£t
);

219 i‡(
	`£À˘
(
fd
 + 1, &
fd£t
, 0, 0, 0) != -1) {

220 
vÆ
;

221 
ödex
 = 0;

224 
vÆ
 = 
	`ˇlGëI≈ut
(
fd
, 
d©a
);

225 i‡(
vÆ
 < 0) ;

226 i‡(
vÆ
 == 0) ;

228 
tŸÆy
 +(
d©a
[2] | ((data[0] & 0x07) << 7));

229 
tŸÆx
 +(
d©a
[1] | ((data[0] & 0x38) << 4));

231 
ödex
++;

232 i‡(!(
d©a
[0] & 0x40)) ;

235 i‡(
ödex
 > 0) {

236 
d©aPoöts
[
i
].
øwX
 = 
tŸÆx
 / 
ödex
;

237 
d©aPoöts
[
i
].
øwY
 = 
tŸÆy
 / 
ödex
;

242 
	`GrDe°royGC
(
gc
);

243 (
îr
);

244 
	}
}

247 
	$maö
(
¨gc
, **
¨gv
) {

249 
£rülFd
;

250 
outFd
;

252 
GR_SCREEN_INFO
 
öfo
;

253 
GR_WINDOW_ID
 
ˇlWödow
;

254 
GR_EVENT
 
evít
;

258 i‡(
	`GrO≥n
() == -1) {

259 
	`Ârötf
(
°dîr
, "Error! UnableÅo openÅhe graphicsÉngine\n");

265 
£rülFd
 = 
	`ˇlInôSîül
("/dev/ttyS1");

266 i‡(
£rülFd
 == -1) {

267 
	`Ârötf
(
°dîr
, "Error! UnableÅo openÅheÅouchscreen device\n");

271 
	`GrGëS¸ìnInfo
(&
öfo
);

275 
d©aPoöts
[0].
s¸X
 = 10;

276 
d©aPoöts
[0].
s¸Y
 = 10;

278 
d©aPoöts
[1].
s¸X
 = 10;

279 
d©aPoöts
[1].
s¸Y
 = 
öfo
.
rows
 - 10;

281 
d©aPoöts
[2].
s¸X
 = 
öfo
.
cﬁs
 - 10;

282 
d©aPoöts
[2].
s¸Y
 = 
öfo
.
rows
 - 10;

284 
d©aPoöts
[3].
s¸X
 = 
öfo
.
cﬁs
 - 10;

285 
d©aPoöts
[3].
s¸Y
 = 10;

288 
ˇlWödow
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
öfo
.
cﬁs
, info.
rows
, 0, 
BGCOLOR
, 
FGCOLOR
);

289 
	`GrSñe˘Evíts
(
ˇlWödow
, 
GR_EVENT_MASK_EXPOSURE
);

290 
	`GrM≠Wödow
(
ˇlWödow
);

292 
	`GrPìkEvít
(&
evít
Ë!
GR_EVENT_TYPE_EXPOSURE
);

295 
	`døwText
(
ˇlWödow
, 
ö°ru˘i⁄s
, 4);

297 i‡(!
	`doPoöts
(
ˇlWödow
, 
£rülFd
)) {

299 
s¸XDñè
, 
øwXDñè
;

300 
s¸YDñè
, 
øwYDñè
;

302 
dñèX
, 
dñèY
;

304 
s¸XDñè
 = (Ë
d©aPoöts
[2].
s¸X
 - dataPoints[0].scrX;

305 
øwXDñè
 = (Ë
d©aPoöts
[2].
øwX
 - dataPoints[0].rawX;

307 
s¸YDñè
 = (Ë
d©aPoöts
[1].
s¸Y
 - dataPoints[0].scrY;

308 
øwYDñè
 = (Ë
d©aPoöts
[1].
øwY
 - dataPoints[0].rawY;

314 
dñèX
 = 
	`abs
–(
øwXDñè
 / 
s¸XDñè
Ë* ((Ë
d©aPoöts
[0].
s¸X
));

315 
dñèY
 = 
	`abs
–(
øwYDñè
 / 
s¸YDñè
Ë* ((Ë
d©aPoöts
[0].
s¸Y
));

324 i‡(
d©aPoöts
[0].
øwX
 > dataPoints[2].rawX) {

325 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[0].
øwX
 + 
dñèX
));

326 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[2].
øwX
 - 
dñèX
));

329 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[0].
øwX
 - 
dñèX
));

330 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[2].
øwX
 + 
dñèX
));

333 i‡(
d©aPoöts
[0].
øwY
 >dataPoints[1].rawY) {

334 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[0].
øwY
 + 
dñèY
));

335 
	`¥ötf
("%d\n", (Ë(
d©aPoöts
[1].
øwY
 - 
dñèY
));

338 
	`¥ötf
("%d ", (Ë(
d©aPoöts
[0].
øwY
 - 
dñèY
));

339 
	`¥ötf
("%d\n", (Ë(
d©aPoöts
[1].
øwY
 + 
dñèY
));

343 
	`Ârötf
(
°dîr
, "Error - UnableÅoÑeadÅheÅouchscreen\n");

347 
	`ˇlClo£Sîül
(
£rülFd
);

348 
	`GrClo£
();

352 
	}
}

	@drivers/elkplan4.c

9 
	~"devi˚.h
"

10 
	~"vg≠œn4.h
"

13 
	#SCREENSEG
 
$0a000


	)

14 
	#SCREENBASE
 
	`MK_FP
(0xa000, 0)

	)

15 
	#BYTESPERLINE
 80

	)

18 
gr_mode
;

20 
	gmode_èbÀ
[
MWMODE_MAX
 + 1] = {

28 
	$ega_öô
(
PSD
 
psd
)

31 
psd
->
addr
 = 
SCREENBASE
;

32 
psd
->
löñí
 = 
BYTESPERLINE
;

35 
	`£t_íabÀ_§
 (0x0f);

36 
	`£t_›
 (0);

37 
	`£t_mode
 (0);

40 
	}
}

53 
	$ega_døwh‹zlöe
(
PSD
 
psd
, 
x1
, 
x2
, 
y
, 
cﬁ‹
)

56 
push
 
bp
 ; 
£tup
 
°ack
 
‰ame
 
™d
 
¥e£rve
 
ªgi°îs


57 
mov
 
bp
, 
•


58 
push
 
si


59 
push
 
di


60 
push
 
es


62 ; 
c⁄figuª
 
the
 
gøphics
 
c⁄åﬁÀr


64 
mov
 
dx
, #$03˚ ; 
DX
 :
Gøphics
 
C⁄åﬁÀr
 
p‹t
 
addªss


66 
mov
 
Æ
, #3 ; 
£t
 
d©a
 
rŸ©e
 

67 
Àa
 
bx
, 
_mode_èbÀ


68 
add
 
bx
, 
_gr_mode


69 
mov
 
ah
, [
bx
]

70 
out
 
dx
, 
ax


72 
mov
 
ah
, [
bp
+12] ; 
pixñ
 
vÆue


73 
x‹
 
Æ
,á»; 
Së
/
Re£t
 
	`numbî
 (0)

74 
out
 
dx
, 
ax


76 
mov
 
ax
, #$0f01 ; 
AH
 :
bô
 
∂™e
 
mask
 
E«bÀ
 
Së
/
Re£t


77 
out
 
dx
, 
ax
 ; 
AL
 :
E«bÀ
 
Së
/
Re£t
 
numbî


79 
push
 
ds
 ; 
¥e£rve
 
DS


81 
mov
 
ax
, [
bp
+10] ; 
y


82 
mov
 
bx
, [
bp
+6] ; 
x1


84 ; 
compuã
 
pixñ
 
addªss


85 
mov
 
dx
, #BYTESPERLINE ; 
AX
 :[
row
 * 
BYTESPERLINE
]

86 
mul
 
dx


87 
mov
 
˛
, 
bl
 ; 
ßve
 
low
 
‹dî
 
cﬁumn
 
bôs


88 
shr
 
bx
, #1 ; 
BX
 :[
cﬁ
 / 8]

89 
shr
 
bx
, #1

90 
shr
 
bx
, #1

91 
add
 
bx
, 
ax
 ; 
BX
 :[
row
 * 
BYTESPERLINE
] + [
cﬁ
 / 8]

92 
™d
 
˛
, #$07 ; 
CL
 :[
cﬁ
 % 8]

93 
x‹
 
˛
, #$07 ; 
CL
 :7 - [
cﬁ
 % 8]

94 
mov
 
ah
, #$01 ; 
AH
 :1 << [7 - [
cﬁ
 % 8]] [
mask
]

95 
mov
 
dx
, #SCREENSEG ; 
ES
 :
EGA
 
buf„r
 
£gmít
 
addªss


96 
mov
 
es
, 
dx


97 ; 
AH
 :
bô
 
mask


98 ; 
ES
:
BX
 -> 
video
 
buf„r


99 ; 
CL
 :
numbî
 
bôs
 
to
 
shi·
 
À·


100 
mov
 
di
, 
bx
 ; 
ES
:
DI
 -> 
buf„r


101 
mov
 
dh
, 
ah
 ; 
DH
 :
unshi·ed
 
bô
 
mask
 
À·
 
byã


103 
nŸ
 
dh


104 
shl
 
dh
, 
˛
 ; 
DH
 :
ªvî£
 
bô
 
mask
 
fú°
 
byã


105 
nŸ
 
dh
 ; 
DH
 :
bô
 
mask
 
fú°
 
byã


107 
mov
 
cx
, [
bp
+8] ; 
x2


108 
™d
 
˛
, #7

109 
x‹
 
˛
, #7 ; 
CL
 :
numbî
 
of
 
bôs
 
to
 
shi·
 
À·


110 
mov
 
dl
, #$0f‡; 
DL
 :
unshi·ed
 
bô
 
mask
 
right
 
byã


111 
shl
 
dl
, 
˛
 ; 
DL
 :
bô
 
mask
 
œ°
 
byã


113 ; 
dëîmöe
 
byã
 
off£t
 
of
 
fú°
 
™d
 
œ°
 
pixñ
 
ö
 
the
 
löe


115 
mov
 
ax
, [
bp
+8] ; 
AX
 :
x2


116 
mov
 
bx
, [
bp
+6] ; 
BX
 :
x1


118 
mov
 
˛
, #3 ; 
bôs
 
to
 
c⁄vît
 
pixñs
Åÿ
byãs


120 
shr
 
ax
, 
˛
 ; 
AX
 :
byã
 
off£t
 
of
 
X2


121 
shr
 
bx
, 
˛
 ; 
BX
 :
byã
 
off£t
 
of
 
X1


122 
mov
 
cx
, 
ax


123 
sub
 
cx
, 
bx
 ; 
CX
 :[
numbî
 
of
 
byãs
 
ö
 
löe
] - 1

125 ; 
gë
 
Gøphics
 
C⁄åﬁÀr
 
p‹t
 
addªss
 
öto
 
DX


127 
mov
 
bx
, 
dx
 ; 
BH
 :
bô
 
mask
 
fú°
 
byã


128 ; 
BL
 :
bô
 
mask
 
œ°
 
byã


129 
mov
 
dx
, #$03˚ ; 
DX
 :
Gøphics
 
C⁄åﬁÀr
 
p‹t


130 
mov
 
Æ
, #8 ; 
AL
 :
Bô
 
mask
 
Regi°î
 
numbî


132 ; 
make
 
video
 
buf„r
 
addªsßbÀ
 
through
 
DS
:
SI


134 
push
 
es


135 
p›
 
ds


136 
mov
 
si
, 
di
 ; 
DS
:
SI
 -> 
video
 
buf„r


138 ; 
£t
 
pixñs
 
ö
 
À·mo°
 
byã
 
of
 
the
 
löe


140 
‹
 
bh
, bh

141 
js
 
L43
 ; 
jump
 
byã
-
Æig√d
 [
x1
 
is
 
À·mo°
]

143 
‹
 
cx
, cx

144 
jnz
 
L42
 ; 
jump
 
m‹e
 
th™
 
⁄e
 
byã
 
ö
 
the
 
löe


146 
™d
 
bl
, 
bh
 ; 
BL
 :
bô
 
mask
 
the
 
löe


147 
jmp
 
√¨
 
L44


149 
L42
: 
mov
 
ah
, 
bh
 ; 
AH
 :
bô
 
mask
 
fú°
 
byã


150 
out
 
dx
, 
ax
 ; 
upd©e
 
gøphics
 
c⁄åﬁÀr


152 
movsb
 ; 
upd©e
 
bô
 
∂™es


153 
dec
 
cx


155 ; 
u£
 
a
 
Á°
 8086 
machöe
 
ö°ru˘i⁄
 
to
 
døw
 
the
 
ªmaödî
 
of
Åhê
löe


157 
L43
: 
mov
 
ah
, #$0f‡; 
AH
 :
bô
 
mask


158 
out
 
dx
, 
ax
 ; 
upd©e
 
Bô
 
Mask
 

159 
ªp


160 
movsb
 ; 
upd©e
 
Æl
 
pixñs
 
ö
 
the
 
löe


162 ; 
£t
 
pixñs
 
ö
 
the
 
rightmo°
 
byã
 
of
Åhê
löe


164 
L44
: 
mov
 
ah
, 
bl
 ; 
AH
 :
bô
 
mask
 
œ°
 
byã


165 
out
 
dx
, 
ax
 ; 
upd©e
 
Gøphics
 
C⁄åﬁÀr


166 
movsb
 ; 
upd©e
 
bô
 
∂™es


168 
p›
 
ds
 ; 
ª°‹e
 ds

170 ; 
ª°‹e
  
Gøphics
 
C⁄åﬁÀr
 
°©e
 
™d
  
to
 
ˇŒî


171 ;;
x‹
 
ax
,áx ; 
AH
 :0, 
AL
 := 0

172 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
Së
/
Re£t
 

173 ;;
öc
 
ax
 ; 
AH
 :0, 
AL
 := 1

174 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
E«bÀ
 
Së
/
Re£t
 

175 ;;
mov
 
ax
, #$0ff08 ; 
AH
 :0xff, 
AL
 := 0

176 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
Bô
 
Mask
 

178 
p›
 
es


179 
p›
 
di


180 
p›
 
si


181 
p›
 
bp


183 
	}
}

197 
	$ega_døwvîéöe
(
PSD
 
psd
, 
x
,
y1
, 
y2
, 
cﬁ‹
)

200 
push
 
bp
 ; 
£tup
 
°ack
 
‰ame
 
™d
 
¥e£rve
 
ªgi°îs


201 
mov
 
bp
, 
•


202 
push
 
ds


204 ; 
c⁄figuª
 
the
 
gøphics
 
c⁄åﬁÀr


206 
mov
 
dx
, #$03˚ ; 
DX
 :
Gøphics
 
C⁄åﬁÀr
 
p‹t
 
addªss


208 
mov
 
Æ
, #3 ; 
£t
 
d©a
 
rŸ©e
 

209 
Àa
 
bx
, 
_mode_èbÀ


210 
add
 
bx
, 
_gr_mode


211 
mov
 
ah
, [
bx
]

212 
out
 
dx
, 
ax


214 
mov
 
ah
, [
bp
+12] ; 
cﬁ‹
 
pixñ
 
vÆue


215 
x‹
 
Æ
,á»; 
Së
/
Re£t
 
	`numbî
 (0)

216 
out
 
dx
, 
ax


218 
mov
 
ax
, #$0f01 ; 
AH
 :
bô
 
∂™e
 
mask
 
E«bÀ
 
Së
/
Re£t


219 
out
 
dx
, 
ax
 ; 
AL
 :
E«bÀ
 
Së
/
Re£t
 
numbî


221 ; 
¥ï¨e
 
to
 
døw
 
vîtiˇl
 
löe


223 
mov
 
ax
, [
bp
+8] ; 
AX
 :
y1


224 
mov
 
cx
, [
bp
+10] ; 
BX
 :
y2


225 ;;
mov
 
cx
, 
bx


226 
sub
 
cx
, 
ax
 ; 
CX
 :
dy


227 ;;
jge
 
L311
 ; 
jump
 
dy
 >= 0

228 ;;
√g
 
cx
 ; 
f‹˚
 
dy
 >= 0

229 ;;
mov
 
ax
, 
bx
 ; 
AX
 :
y2


231 
L311
: 
öc
 
cx
 ; 
CX
 :
numbî
 
of
 
pixñs
 
to
 
døw


232 
mov
 
bx
, [
bp
+6] ; 
BX
 :
x


233 
push
 
cx
 ; 
ßve
 

235 ; 
compuã
 
pixñ
 
addªss


236 
push
 
dx


237 
mov
 
dx
, #BYTESPERLINE ; 
AX
 :[
row
 * 
BYTESPERLINE
]

238 
mul
 
dx


239 
mov
 
˛
, 
bl
 ; 
ßve
 
low
 
‹dî
 
cﬁumn
 
bôs


240 
shr
 
bx
, #1 ; 
BX
 :[
cﬁ
 / 8]

241 
shr
 
bx
, #1

242 
shr
 
bx
, #1

243 
add
 
bx
, 
ax
 ; 
BX
 :[
row
 * 
BYTESPERLINE
] + [
cﬁ
 / 8]

244 
™d
 
˛
, #$07 ; 
CL
 :[
cﬁ
 % 8]

245 
x‹
 
˛
, #$07 ; 
CL
 :7 - [
cﬁ
 % 8]

246 
mov
 
ah
, #$01 ; 
AH
 :1 << [7 - [
cﬁ
 % 8]] [
mask
]

247 
mov
 
dx
, #SCREENSEG ; 
DS
 :
EGA
 
buf„r
 
£gmít
 
addªss


248 
mov
 
ds
, 
dx


249 
p›
 
dx


250 ; 
AH
 :
bô
 
mask


251 ; 
DS
:
BX
 -> 
video
 
buf„r


252 ; 
CL
 :
numbî
 
bôs
 
to
 
shi·
 
À·


254 ; 
£t
 
up
 
Gøphics
 
c⁄åﬁÀr


256 
shl
 
ah
, 
˛
 ; 
AH
 :
bô
 
mask
 
ö
 
¥›î
 
posôi⁄


257 
mov
 
Æ
, #$08 ; 
AL
 :
Bô
 
Mask
 
numbî


258 
out
 
dx
, 
ax


260 
p›
 
cx
 ; 
ª°‹e
 

262 ; 
døw
 
the
 
löe


264 
mov
 
dx
, #BYTESPERLINE ; 
ö¸emít
 
video
 
buf„r


265 
L1111
: 
‹
 [
bx
], 
Æ
 ; 
£t
 
pixñ


266 
add
 
bx
, 
dx
 ; 
ö¸emít
 
to
 
√xt
 
löe


267 
lo›
 
L1111


269 ; 
ª°‹e
  
Gøphics
 
C⁄åﬁÀr
 
°©e
 
™d
  
to
 
ˇŒî


270 ;;
x‹
 
ax
,áx ; 
AH
 :0, 
AL
 := 0

271 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
Së
/
Re£t
 

272 ;;
öc
 
ax
 ; 
AH
 :0, 
AL
 := 1

273 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
E«bÀ
 
Së
/
Re£t
 

274 ;;
mov
 
ax
, #$0ff08 ; 
AH
 :0xff, 
AL
 := 0

275 ;;
out
 
dx
, 
ax
 ; 
ª°‹e
 
Bô
 
Mask
 

277 
p›
 
ds


278 
p›
 
bp


280 
	}
}

288 
	$ega_døwpixñ
(
PSD
 
psd
, 
x
, 
y
, 
cﬁ‹
)

291 
push
 
bp


292 
mov
 
bp
, 
•


294 
mov
 
dx
, #$03˚ ; 
gøphics
 
c⁄åﬁÀr
 
p‹t
 
addªss


295 
mov
 
Æ
, #3 ; 
£t
 
d©a
 
rŸ©e
 

296 
Àa
 
bx
, 
_mode_èbÀ


297 
add
 
bx
, 
_gr_mode


298 
mov
 
ah
, [
bx
]

299 
out
 
dx
, 
ax


301 
mov
 
cx
, [
bp
+6] ; 
ECX
 :
x


302 
mov
 
ax
, [
bp
+8] ; 
EAX
 :
y


304 
mov
 
dx
, #BYTESPERLINE ; 
AX
 :[
y
 * 
BYTESPERLINE
]

305 
mul
 
dx


307 
mov
 
bx
, 
cx
 ; 
BX
 :[
x
 / 8]

308 
shr
 
bx
, #1

309 
shr
 
bx
, #1

310 
shr
 
bx
, #1

312 
add
 
bx
, 
ax
 ; 
BX
 :[
y
 * 
BYTESPERLINE
] + [
x
 / 8]

314 
™d
 
˛
, #$07 ; 
CL
 :[
x
 % 8]

315 
x‹
 
˛
, #$07 ; 
CL
 :7 - [
x
 % 8]

316 
mov
 
ch
, #$01 ; 
CH
 :1 << [7 - [
x
 % 8]] [
mask
]

317 
shl
 
ch
, 
˛


319 
mov
 
dx
, #$03˚ ; 
gøphics
 
c⁄åﬁÀr
 
p‹t
 
addªss


321 ;;
ªquúed
 
ﬁd
 
code


322 
mov
 
ax
, #$0205 ; 
£À˘
 
wrôe
 
mode
 2

323 
out
 
dx
, 
ax
 ; [
lﬂd
 
vÆue
 2 
öto
 
mode
 5]

325 ; 
√w
 
code


326 ;;
x‹
 
ax
,ax ; 
£t
 
cﬁ‹
 0

327 ;;
mov
 
ah
,[
bp
+10] ; 
cﬁ‹
 
pixñ
 
vÆue


328 ;;
out
 
dx
,
ax


330 ; 
‹igöÆ
 
code


331 
mov
 
Æ
, #$08 ; 
£t
 
the
 
bô
 
mask
 

332 
mov
 
ah
, 
ch
 ; [
lﬂd
 
bô
 
mask
 
öto
 8]

333 
out
 
dx
, 
ax


335 
push
 
ds


336 
mov
 
ax
, #SCREENSEG ; 
DS
 :
EGA
 
buf„r
 
£gmít
 
addªss


337 
mov
 
ds
, 
ax


339 ; 
√w
 
code


340 ;;
‹
 [
bx
],
Æ
 ; 
quick
 
rmw
 
to
 
£t
 
pixñ


342 ;;
the
 
fﬁlowög
 
Áûs
 
undî
 
ELKS
 
wôhout
 
˛i
/
°i


343 ;;
usög
 
ES
 
w‹ks
 
though
. 
Code
 
ch™ged
 
to
 
u£
 
sögÀ


344 ;;
rmw
 
above
 
øthî
 
th™
 
wrôe
 
mode
 2, 
but
 
the


345 ;;
ªas⁄
 
this
 
Áûuª
 
is
 
°ûl
 
unknown
...

346 ;;
˛i


347 
mov
 
Æ
, [
bx
] ; 
dummy
 
ªad
 
to
 
œtch
 
bô
 
∂™es


348 
mov
 
Æ
, [
bp
+10] ; 
pixñ
 
vÆue


349 
mov
 [
bx
], 
Æ
 ; 
wrôe
 
pixñ
 
back
 
to
 
bô
 
∂™es


350 ;;
°i


352 
p›
 
ds
 ; 
ª°‹e
 
ªgi°îs
 
™d
 

354 
mov
 
ax
, #$0005 ; 
ª°‹e
  
wrôe
 
mode
 0

355 
out
 
dx
, 
ax
 ; [
lﬂd
 
vÆue
 0 
öto
 
mode
 5]

357 ;;
mov
 
ax
, #$0ff08 ; 
ª°‹e
  
bô
 
mask


358 ;;
out
 
dx
, 
ax
 ; [
lﬂd
 
vÆue
 
ff
 
öto
 8]

360 
p›
 
bp


362 
	}
}

369 
PIXELVAL


370 
	$ega_ªadpixñ
(
PSD
 
psd
, 
x
, 
y
)

373 
push
 
bp


374 
mov
 
bp
, 
•


375 
push
 
si


376 
push
 
ds


378 
mov
 
ax
, [
bp
+8] ; 
EAX
 :
y


379 
mov
 
bx
, [
bp
+6] ; 
EBX
 :
x


380 
mov
 
dx
, #BYTESPERLINE ; 
AX
 :[
y
 * 
BYTESPERLINE
]

381 
mul
 
dx


383 
mov
 
˛
, 
bl
 ; 
ßve
 
low
 
‹dî
 
cﬁumn
 
bôs


384 
shr
 
bx
, #1 ; 
BX
 :[
x
 / 8]

385 
shr
 
bx
, #1

386 
shr
 
bx
, #1

388 
add
 
bx
, 
ax
 ; 
BX
 :[
y
 * 
BYTESPERLINE
] + [
x
 / 8]

390 
™d
 
˛
, #$07 ; 
CL
 :[
x
 % 8]

391 
x‹
 
˛
, #$07 ; 
CL
 :7 - [
x
 % 8]

393 
mov
 
dx
, #SCREENSEG ; 
DS
 :
EGA
 
buf„r
 
£gmít
 
addªss


394 
mov
 
ds
, 
dx


396 
mov
 
ch
, #$01 ; 
CH
 :1 << [7 - [
cﬁ
 % 8]] [
mask
]

397 
shl
 
ch
, 
˛
 ; 
CH
 :
bô
 
mask
 
ö
 
¥›î
 
posôi⁄


399 
mov
 
si
, 
bx
 ; 
DS
:
SI
 -> 
ªgi⁄
 
buf„r
 
byã


400 
x‹
 
bl
, b»; 
BL
 
is
 
u£d
 
to
 
accumuœã
 
the
 
pixñ
 
vÆue


402 
mov
 
dx
, #$03˚ ; 
DX
 :
Gøphics
 
C⁄åﬁÀr
 
p‹t


403 
mov
 
ax
, #$0304 ; 
AH
 :
öôül
 
bô
 
∂™e
 
numbî


404 ; 
AL
 :
Ród
 
M≠
 
Sñe˘
 
numbî


406 
L112
: 
out
 
dx
, 
ax
 ; 
£À˘
 
bô
 
∂™e


407 
mov
 
bh
, [
si
] ; 
BH
 :
byã
 
‰om
 
cuºít
 
bô
 
∂™e


408 
™d
 
bh
, 
ch
 ; 
mask
 
⁄e
 
bô


409 
√g
 
bh
 ; 
bô
 7 
of
 
BH
 :1 
masked
 bit = 1

410 ; 
bô
 7 
of
 
BH
 :0 
masked
 bit = 0

411 
rﬁ
 
bx
, #1 ; 
bô
 0 
of
 
BL
 :
√xt
 bô 
‰om
 
pixñ
 
vÆue


412 
dec
 
ah
 ; 
AH
 :
√xt
 
bô
 
∂™e
 
numbî


413 
jge
 
L112


415 
x‹
 
ax
,áx ; 
AL
 :
pixñ
 
vÆue


416 
mov
 
Æ
, 
bl


418 
p›
 
ds


419 
p›
 
si


420 
p›
 
bp


422 
	}
}

	@drivers/elksutil.c

6 
	~"devi˚.h
"

7 
	~"vg≠œn4.h
"

13 
	$GETBYTE_FP
(
FARADDR
 
addr
)

16 
push
 
bp


17 
mov
 
bp
,
•


18 
push
 
ds


20 
mov
 
bx
,[
bp
+4] ! bx = 
lo
 
addr


21 
mov
 
ax
,[
bp
+6] ! 
ds
 = 
hi
 
addr


22 
mov
 
ds
,
ax


23 
mov
 
Æ
,[
bx
] ! 
gë
 
byã
 
©
 
ds
:bx

24 
x‹
 
ah
,ah

26 
p›
 
ds


27 
p›
 
bp


29 
	}
}

35 
	$PUTBYTE_FP
(
FARADDR
 
addr
,
vÆ
)

38 
push
 
bp


39 
mov
 
bp
,
•


40 
push
 
ds


42 
mov
 
bx
,[
bp
+4] ! bx = 
lo
 
addr


43 
mov
 
ax
,[
bp
+6] ! 
ds
 = 
hi
 
addr


44 
mov
 
ds
,
ax


45 
mov
 
Æ
,[
bp
+8] !á»
vÆ


46 
mov
 [
bx
],
Æ
 ! 
put
 
byã
 
©
 
ds
:bx

48 
p›
 
ds


49 
p›
 
bp


51 
	}
}

57 
	$RMW_FP
(
FARADDR
 
addr
)

60 
push
 
bp


61 
mov
 
bp
,
•


62 
push
 
ds


64 
mov
 
bx
,[
bp
+4] ! bx = 
lo
 
addr


65 
mov
 
ax
,[
bp
+6] ! 
ds
 = 
hi
 
addr


66 
mov
 
ds
,
ax


67 
‹
 [
bx
],
Æ
 ! 
rmw
 
byã
 
©
 
ds
:bx,á»
vÆue
 
d€¢t
 
m©ãr


69 
p›
 
ds


70 
p›
 
bp


72 
	}
}

78 
	$ORBYTE_FP
(
FARADDR
 
addr
,
vÆ
)

81 
push
 
bp


82 
mov
 
bp
,
•


83 
push
 
ds


85 
mov
 
bx
,[
bp
+4] ! bx = 
lo
 
addr


86 
mov
 
ax
,[
bp
+6] ! 
ds
 = 
hi
 
addr


87 
mov
 
ds
,
ax


88 
mov
 
Æ
,[
bp
+8] !á»
vÆ


89 
‹
 [
bx
],
Æ
 ! o∏
byã
 
©
 
ds
:bx

91 
p›
 
ds


92 
p›
 
bp


94 
	}
}

100 
	$ANDBYTE_FP
(
FARADDR
 
addr
,
vÆ
)

103 
push
 
bp


104 
mov
 
bp
,
•


105 
push
 
ds


107 
mov
 
bx
,[
bp
+4] ! bx = 
lo
 
addr


108 
mov
 
ax
,[
bp
+6] ! 
ds
 = 
hi
 
addr


109 
mov
 
ds
,
ax


110 
mov
 
Æ
,[
bp
+8] !á»
vÆ


111 
™d
 [
bx
],
Æ
 !ánd 
byã
 
©
 
ds
:bx

113 
p›
 
ds


114 
p›
 
bp


116 
	}
}

122 
	$öp‹tb
(
p‹t
)

125 
push
 
bp


126 
mov
 
bp
,
•


128 
mov
 
dx
,[
bp
+4] ! dx = 
p‹t


129 
ö
 
Æ
,
dx
 ! 
öput
 
byã


130 
x‹
 
ah
,ah

132 
p›
 
bp


134 
	}
}

140 
	$ouç‹tb
(
p‹t
,
d©a
)

143 
push
 
bp


144 
mov
 
bp
,
•


146 
mov
 
dx
,[
bp
+4] ! dx = 
p‹t


147 
mov
 
Æ
,[
bp
+6] !á»
d©a


148 
out
 
dx
,
Æ


150 
p›
 
bp


152 
	}
}

158 
	$ouç‹t
(
p‹t
,
d©a
)

161 
push
 
bp


162 
mov
 
bp
,
•


164 
mov
 
dx
,[
bp
+4] ! dx = 
p‹t


165 
mov
 
ax
,[
bp
+6] !áx = 
d©a


166 
out
 
dx
,
ax


168 
p›
 
bp


170 
	}
}

176 
FARADDR


177 
	$öt10
(
ax
,
bx
)

180 
push
 
bp


181 
mov
 
bp
,
•


182 
push
 
es


183 
push
 
ds


184 
push
 
si


185 
push
 
di


187 
mov
 
ax
,[
bp
+4] ! 
gë
 
fú°
 
¨g


188 
mov
 
bx
,[
bp
+6] ! 
gë
 
£c⁄d
 
¨g


189 
$10


190 
mov
 
dx
,
es
 ! És:
bp


191 
mov
 
ax
,
bp


193 
p›
 
di


194 
p›
 
si


195 
p›
 
ds


196 
p›
 
es


197 
p›
 
bp


199 
	}
}

203 
	$kbpﬁl
()

206 
mov
 
ah
,1 ! 
ªad
, 
no
 
ªmove


207 
$16


208 
jz
 
n‹dy
 ! 
no
 
ch¨s
 
ªady


209 
mov
 
ax
,1 ! 
ch¨s
 
ªady


210 
ªt


211 
n‹dy
: 
x‹
 
ax
,ax ! 
no
 
ch¨s
 
ªady


213 
	}
}

217 
	$kbªad
()

220 
x‹
 
ah
,ah ! 
ªad
 
™d
 
ªmove


221 
$16
 !  
ax


223 
	}
}

227 
	$kbÊags
()

230 
mov
 
ah
,2 ! 
gë
 
shi·
 
°©us


231 
$16


232 
mov
 
ah
,0 ! 
low
 
bôs
 
⁄ly
 
now
...

234 
	}
}

	@drivers/fb.c

12 
	~<as£π.h
>

13 
	~<°dio.h
>

14 
	~<°dlib.h
>

15 
	~"devi˚.h
"

16 
	~"gímem.h
"

17 
	~"fb.h
"

21 
PSUBDRIVER


22 
	$£À˘_fb_subdrivî
(
PSD
 
psd
)

24 
PSUBDRIVER
 
drivî
 = 
NULL
;

25 
SUBDRIVER
 
fblöór1
;

26 
SUBDRIVER
 
fblöór2
;

27 
SUBDRIVER
 
fblöór4
;

28 
SUBDRIVER
 
fblöór8
;

29 
SUBDRIVER
 
fblöór16
;

30 
SUBDRIVER
 
fblöór24
;

31 
SUBDRIVER
 
fblöór32
;

32 
SUBDRIVER
 
fblöór32Æpha
;

33 #i‡
FBVGA


34 
SUBDRIVER
 
vg≠œn4
;

35 
SUBDRIVER
 
mem∂™4
;

38 if(
psd
->
∂™es
 =4 &&Ösd->
bµ
 == 4) {

39 if(
psd
->
Êags
 & 
PSF_MEMORY
)

40 
drivî
 = &
mem∂™4
;

41 
drivî
 = &
vg≠œn4
;

47 if(
psd
->
∂™es
 == 1) {

48 
psd
->
bµ
) {

50 
drivî
 = &
fblöór1
;

53 
drivî
 = &
fblöór2
;

56 
drivî
 = &
fblöór4
;

59 
drivî
 = &
fblöór8
;

62 
drivî
 = &
fblöór16
;

65 
drivî
 = &
fblöór24
;

68 i‡(
psd
->
pixty≥
 =
MWPF_TRUECOLOR8888
) {

69 
drivî
 = &
fblöór32Æpha
;

71 
drivî
 = &
fblöór32
;

78  
drivî
;

79 
	}
}

86 
MWBOOL


87 
	$fb_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,
löñí
,

88 
size
,*
addr
)

90 
PSUBDRIVER
 
subdrivî
;

93 
	`öômemgc
(
mempsd
, 
w
, 
h
, 
∂™es
, 
bµ
, 
löñí
, 
size
, 
addr
);

96 if(
mempsd
->
p‹åaô
 !
MWPORTRAIT_NONE
)  1;

99 
subdrivî
 = 
	`£À˘_fb_subdrivî
(
mempsd
);

100 if(!
subdrivî
)

104 if(!
	`£t_subdrivî
(
mempsd
, 
subdrivî
, 
TRUE
))

108 
	}
}

	@drivers/fb.h

16 #i‡
VTSWITCH


17 vﬁ©ûê
mwdøwög
;

18 
	#DRAWON
 ++
mwdøwög


	)

19 
	#DRAWOFF
 --
mwdøwög


	)

21 
	#DRAWON


	)

22 
	#DRAWOFF


	)

25 * 
	tADDR8
;

26 * 
	tADDR16
;

27 * 
	tADDR32
;

36 
	#CHECK
(
f
,
d
)

	)

39 
	#≠∂yOp
(
›
, 
§c
, 
pd°
, 
ty≥
) \

41 
ty≥
 
d
 = (
pd°
); \

42 
›
) { \

43 
MWMODE_XOR
: \

44 *
d
 ^(
§c
); \

45 
	`CHECK
("XOR", *
d
); \

47 
MWMODE_AND
: \

48 *
d
 &(
§c
); \

49 
	`CHECK
("AND", *
d
); \

51 
MWMODE_OR
: \

52 *
d
 |(
§c
); \

53 
	`CHECK
("OR", *
d
); \

55 
MWMODE_SRC_OUT
: \

56 
MWMODE_DST_OUT
: \

57 
MWMODE_PORTERDUFF_XOR
: \

58 
MWMODE_CLEAR
: \

59 *
d
 = 0; \

60 
	`CHECK
("CLEAR", *
d
); \

62 
MWMODE_SETTO1
: \

63 *
d
 = ~0; \

64 
	`CHECK
("SETTO1", *
d
); \

66 
MWMODE_EQUIV
: \

67 *
d
 = ~(*d ^ (
§c
)); \

68 
	`CHECK
("EQUIV", *
d
); \

70 
MWMODE_NOR
: \

71 *
d
 = ~(*d | (
§c
)); \

72 
	`CHECK
("NOR", *
d
); \

74 
MWMODE_NAND
: \

75 *
d
 = ~(*d & (
§c
)); \

76 
	`CHECK
("NAND", *
d
); \

78 
MWMODE_INVERT
: \

79 *
d
 = ~*d; \

80 
	`CHECK
("INVERT", *
d
); \

82 
MWMODE_COPYINVERTED
: \

83 *
d
 = ~(
§c
); \

84 
	`CHECK
("COPYINVERTED", *
d
); \

86 
MWMODE_ORINVERTED
: \

87 *
d
 |~(
§c
); \

88 
	`CHECK
("ORINVERTED", *
d
); \

90 
MWMODE_ANDINVERTED
: \

91 *
d
 &~(
§c
); \

92 
	`CHECK
("ANDINVERTED", *
d
); \

94 
MWMODE_ORREVERSE
: \

95 *
d
 = ~*d | (
§c
); \

96 
	`CHECK
("ORREVERSE", *
d
); \

98 
MWMODE_ANDREVERSE
: \

99 *
d
 = ~*d & (
§c
); \

100 
	`CHECK
("ANDREVERSE", *
d
); \

102 
MWMODE_SRC_OVER
: \

103 
MWMODE_SRC_IN
: \

104 
MWMODE_SRC_ATOP
: \

105 
MWMODE_COPY
: \

106 *
d
 = (
§c
); \

107 
	`CHECK
("COPY", *
d
); \

109 
MWMODE_DST_OVER
: \

110 
MWMODE_DST_IN
: \

111 
MWMODE_DST_ATOP
: \

112 
MWMODE_NOOP
: \

113 
	`CHECK
("NOOP", *
d
); \

115 
MWMODE_XOR_FGBG
: \

116 *
d
 ^(
§c
Ë^ 
gr_background
; \

117 
	`CHECK
("XOR_FGBG", *
d
); \

120 }

	)

123 
	#DEFINE_≠∂yOpR
 \

124 
ölöe
 
	`≠∂yOpR
(
›
, 
§c
, 
d°
) \

126 
›
) { \

127 
MWMODE_XOR
: \

128  (
§c
Ë^ (
d°
); \

129 
MWMODE_AND
: \

130  (
§c
Ë& (
d°
); \

131 
MWMODE_OR
: \

132  (
§c
Ë| (
d°
); \

133 
MWMODE_SRC_OUT
: \

134 
MWMODE_DST_OUT
: \

135 
MWMODE_PORTERDUFF_XOR
: \

136 
MWMODE_CLEAR
: \

138 
MWMODE_SETTO1
: \

140 
MWMODE_EQUIV
: \

141  ~((
§c
Ë^ (
d°
)); \

142 
MWMODE_NOR
: \

143  ~((
§c
Ë| (
d°
)); \

144 
MWMODE_NAND
: \

145  ~((
§c
Ë& (
d°
)); \

146 
MWMODE_INVERT
: \

147  ~(
d°
); \

148 
MWMODE_COPYINVERTED
: \

149  ~(
§c
); \

150 
MWMODE_ORINVERTED
: \

151  ~(
§c
Ë| (
d°
); \

152 
MWMODE_ANDINVERTED
: \

153  ~(
§c
Ë& (
d°
); \

154 
MWMODE_ORREVERSE
: \

155  (
§c
Ë| ~(
d°
); \

156 
MWMODE_ANDREVERSE
: \

157  (
§c
Ë& ~(
d°
); \

158 
MWMODE_SRC_OVER
: \

159 
MWMODE_SRC_IN
: \

160 
MWMODE_SRC_ATOP
: \

161 
MWMODE_COPY
: \

162  (
§c
); \

163 
MWMODE_XOR_FGBG
: \

164  (
§c
Ë^ (
d°
Ë^ 
gr_background
; \

165 
MWMODE_DST_OVER
: \

166 
MWMODE_DST_IN
: \

167 
MWMODE_DST_ATOP
: \

168 
MWMODE_NOOP
: \

170  (
d°
); \

172 }

	)

175 
gr_mode
;

176 
MWPIXELVAL
 
gr_background
;

180 
io˘l_gë∑Àâe
(
°¨t
, 
Àn
, *
ªd
, *
gªí
,*
blue
);

181 
io˘l_£çÆëã
(
°¨t
, 
Àn
, *
ªd
, *
gªí
,*
blue
);

184 
gí_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

185 
MWPIXELVAL
 
c
);

186 
MWBOOL
 
£t_subdrivî
(
PSD
 
psd
, 
PSUBDRIVER
 
subdrivî
, MWBOOL 
öô
);

187 
gë_subdrivî
(
PSD
 
psd
, 
PSUBDRIVER
 
subdrivî
);

190 
PSUBDRIVER
 
£À˘_fb_subdrivî
(
PSD
 
psd
);

	@drivers/fblin1.c

9 
	~<as£π.h
>

10 
	~<°rög.h
>

11 
	~"devi˚.h
"

12 
	~"fb.h
"

18 
	gnŸmask
[8] = {

23 
	$löór1_öô
(
PSD
 
psd
)

25 i‡(!
psd
->
size
)

26 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

29 
	}
}

33 
	$löór1_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

35 
ADDR8
 
addr
 = 
psd
->addr;

37 
	`as£π
 (
addr
 != 0);

38 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

39 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

40 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

42 
DRAWON
;

43 
addr
 +(
x
>>3Ë+ 
y
 * 
psd
->
löñí
;

44 if(
gr_mode
 =
MWMODE_XOR
)

45 *
addr
 ^
c
 << (7-(
x
&7));

47 *
addr
 = (*add∏& 
nŸmask
[
x
&7]Ë| (
c
 << (7-(x&7)));

48 
DRAWOFF
;

49 
	}
}

52 
MWPIXELVAL


53 
	$löór1_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

55 
ADDR8
 
addr
 = 
psd
->addr;

57 
	`as£π
 (
addr
 != 0);

58 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

59 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

61  (
addr
[(
x
>>3Ë+ 
y
 * 
psd
->
löñí
] >> (7-(x&7)) ) & 0x01;

62 
	}
}

66 
	$löór1_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

68 
ADDR8
 
addr
 = 
psd
->addr;

70 
	`as£π
 (
addr
 != 0);

71 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

72 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

73 
	`as£π
 (
x2
 >
x1
);

74 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

75 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

77 
DRAWON
;

78 
addr
 +(
x1
>>3Ë+ 
y
 * 
psd
->
löñí
;

79 if(
gr_mode
 =
MWMODE_XOR
) {

80 
x1
 <
x2
) {

81 *
addr
 ^
c
 << (7-(
x1
&7));

82 if((++
x1
 & 7) == 0)

83 ++
addr
;

86 
x1
 <
x2
) {

87 *
addr
 = (*add∏& 
nŸmask
[
x1
&7]Ë| (
c
 << (7-(x1&7)));

88 if((++
x1
 & 7) == 0)

89 ++
addr
;

92 
DRAWOFF
;

93 
	}
}

97 
	$löór1_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

99 
ADDR8
 
addr
 = 
psd
->addr;

100 
löñí
 = 
psd
->linelen;

102 
	`as£π
 (
addr
 != 0);

103 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

104 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

105 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

106 
	`as£π
 (
y2
 >
y1
);

107 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

109 
DRAWON
;

110 
addr
 +(
x
>>3Ë+ 
y1
 * 
löñí
;

111 if(
gr_mode
 =
MWMODE_XOR
)

112 
y1
++ <
y2
) {

113 *
addr
 ^
c
 << (7-(
x
&7));

114 
addr
 +
löñí
;

117 
y1
++ <
y2
) {

118 *
addr
 = (*add∏& 
nŸmask
[
x
&7]Ë| (
c
 << (7-(x&7)));

119 
addr
 +
löñí
;

121 
DRAWOFF
;

122 
	}
}

126 
	$löór1_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

127 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

129 
ADDR8
 
d°
;

130 
ADDR8
 
§c
;

131 
i
;

132 
dlöñí
 = 
d°psd
->
löñí
;

133 
¶öñí
 = 
§˝sd
->
löñí
;

135 
	`as£π
 (
d°psd
->
addr
 != 0);

136 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

137 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

138 
	`as£π
 (
w
 > 0);

139 
	`as£π
 (
h
 > 0);

140 
	`as£π
 (
§˝sd
->
addr
 != 0);

141 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

142 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

143 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

144 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

145 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

146 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

148 
DRAWON
;

149 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ (
d°x
>>3Ë+ 
d°y
 * 
dlöñí
;

150 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ (
§cx
>>3Ë+ 
§cy
 * 
¶öñí
;

151 --
h
 >= 0) {

152 
ADDR8
 
d
 = 
d°
;

153 
ADDR8
 
s
 = 
§c
;

154 
MWCOORD
 
dx
 = 
d°x
;

155 
MWCOORD
 
sx
 = 
§cx
;

156 
i
=0; i<
w
; ++i) {

157 *
d
 = (*d & 
nŸmask
[
dx
&7]) |

158 ((*
s
 >> (7-(
sx
&7)Ë& 0x01Ë<< (7-(
dx
&7)));

159 if((++
dx
 & 7) == 0)

160 ++
d
;

161 if((++
sx
 & 7) == 0)

162 ++
s
;

164 
d°
 +
dlöñí
;

165 
§c
 +
¶öñí
;

167 
DRAWOFF
;

168 
	}
}

170 
SUBDRIVER
 
	gfblöór1
 = {

171 
löór1_öô
,

172 
löór1_døwpixñ
,

173 
löór1_ªadpixñ
,

174 
löór1_døwh‹zlöe
,

175 
löór1_døwvîéöe
,

176 
gí_fûÃe˘
,

177 
löór1_blô


	@drivers/fblin12.c

11 
	~<as£π.h
>

12 
	~<°rög.h
>

13 
	~"devi˚.h
"

14 
	~"fb.h
"

16 
	ggr_mode
=
MWMODE_XOR
;

20 
	$löór12_öô
(
PSD
 
psd
)

22 i‡(!
psd
->
size
) {

23 
psd
->
size
 = 960*240/2;

25 
psd
->
löñí
 *= 2;

26 
psd
->
löñí
 /= 3;

29 
	}
}

31 
ölöe
 
	$£çix
(*
˝å
,
x
, 
y
, 
c
)

33 
adr
;

35 
adr
=(
x
>>1Ë+ (
y
*480);

37 if(
gr_mode
 =
MWMODE_XOR
)

39 if(
x
 & 0x01Ë
˝å
[
adr
]^=((
c
 << 4) & 0xf0);

40 
˝å
[
adr
]^=(
c
 & 0x0f);

44 if(
x
 & 0x01)

46 
˝å
[
adr
]&=0x0f;

47 
˝å
[
adr
]|=((
c
 << 4) & 0xf0);

51 
˝å
[
adr
]&=0xf0;

52 
˝å
[
adr
]|=(
c
 & 0x0f);

55 
	}
}

57 
ölöe
 
	$gëpix
(*
˝å
,
x
, 
y
)

59 
adr
;

60 
adr
=(
x
>>1Ë+ (
y
*480);

62 if(
x
 & 0x01Ë (
˝å
[
adr
] >> 4) & 0x0f;

63  
˝å
[
adr
] & 0x0f;

64 
	}
}

69 
	$löór12_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

71 
ADDR8
 
addr
 = 
psd
->addr;

72 
MWUCHAR
 
r
, 
g
, 
b
;

74 
	`as£π
 (
addr
 != 0);

75 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

76 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

77 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

79 
r
 = 
	`PIXEL444RED
(
c
);

80 
g
 = 
	`PIXEL444GREEN
(
c
);

81 
b
 = 
	`PIXEL444BLUE
(
c
);

82 
x
=x+(x<<1);

83 
DRAWON
;

84 
	`£çix
(
addr
,
x
,
y
,
r
);

85 
	`£çix
(
addr
,
x
+1,
y
,
g
);

86 
	`£çix
(
addr
,
x
+2,
y
,
b
);

87 
DRAWOFF
;

88 
	}
}

91 
MWPIXELVAL


92 
	$löór12_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

94 
ADDR8
 
addr
 = 
psd
->addr;

96 
	`as£π
 (
addr
 != 0);

97 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

98 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

99 
x
=x+(x<<1);

100  
	`RGB2PIXEL444
(
	`gëpix
(
addr
,
x
,
y
),getpix(addr,x+1,y),getpix(addr,x+2,y));

101 
	}
}

105 
	$löór12_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

107 
ADDR8
 
addr
 = 
psd
->addr;

108 
MWUCHAR
 
r
, 
g
, 
b
;

110 
	`as£π
 (
addr
 != 0);

111 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

112 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

113 
	`as£π
 (
x2
 >
x1
);

114 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

115 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

117 
r
 = 
	`PIXEL444RED
(
c
);

118 
g
 = 
	`PIXEL444GREEN
(
c
);

119 
b
 = 
	`PIXEL444BLUE
(
c
);

120 
DRAWON
;

121 
x1
*=3;

122 
x2
*=3;

123 (
x1
+=3Ë<
x2
) {

124 
	`£çix
(
addr
,
x1
,
y
,
r
);

125 
	`£çix
(
addr
,
x1
+1,
y
,
g
);

126 
	`£çix
(
addr
,
x1
+2,
y
,
b
);

128 
DRAWOFF
;

129 
	}
}

133 
	$löór12_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

135 
ADDR8
 
addr
 = 
psd
->addr;

136 
löñí
 = 
psd
->linelen * 3;

137 
MWUCHAR
 
r
, 
g
, 
b
;

138 
löñí
/=2;

139 
	`as£π
 (
addr
 != 0);

140 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

141 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

142 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

143 
	`as£π
 (
y2
 >
y1
);

144 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

145 
x
=x+(x<<1);

146 
r
 = 
	`PIXEL444RED
(
c
);

147 
g
 = 
	`PIXEL444GREEN
(
c
);

148 
b
 = 
	`PIXEL444BLUE
(
c
);

150 
DRAWON
;

151 
y1
++ <
y2
)

153 
	`£çix
(
addr
,
x
,
y1
,
r
);

154 
	`£çix
(
addr
,
x
+1,
y1
,
g
);

155 
	`£çix
(
addr
,
x
+2,
y1
,
b
);

157 
DRAWOFF
;

158 
	}
}

163 
	$xlöór12_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

164 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

166 
ADDR8
 
d°
 = 
d°psd
->
addr
;

167 
ADDR8
 
§c
 = 
§˝sd
->
addr
;

168 
i
;

169 
dlöñí
 = 
d°psd
->
löñí
 * 3;

170 
¶öñí
 = 
§˝sd
->
löñí
 * 3;

171 
dlöñí_möus_w
 = (
d°psd
->
löñí
 - 
w
) * 3;

172 
¶öñí_möus_w
 = (
§˝sd
->
löñí
 - 
w
) * 3;

173 #i‡
ALPHABLEND


174 
Æpha
;

177 
	`as£π
 (
d°
 != 0);

178 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

179 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

180 
	`as£π
 (
w
 > 0);

181 
	`as£π
 (
h
 > 0);

182 
	`as£π
 (
§c
 != 0);

183 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

184 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

185 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

186 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

187 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

188 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

190 
DRAWON
;

191 
d°
 +(
d°x
 + 
d°y
 * 
d°psd
->
löñí
) * 3;

192 
§c
 +(
§cx
 + 
§cy
 * 
§˝sd
->
löñí
) * 3;

194 #i‡
ALPHABLEND


195 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

196 
°dblô
;

197 
Æpha
 = 
›
 & 0xff;

199 --
h
 >= 0) {

200 
i
=0; i<
w
; ++i) {

201 
s
 = *
§c
++;

202 
d
 = *
d°
;

203 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

204 
s
 = *
§c
++;

205 
d
 = *
d°
;

206 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

207 
s
 = *
§c
++;

208 
d
 = *
d°
;

209 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

211 
d°
 +
dlöñí_möus_w
;

212 
§c
 +
¶öñí_möus_w
;

214 
DRAWOFF
;

216 
°dblô
:

218 --
h
 >= 0) {

221 
	`mem˝y
(
d°
, 
§c
, 
w
*3);

222 
d°
 +
dlöñí
;

223 
§c
 +
¶öñí
;

225 
i
=0; i<
w
; ++i) {

226 *
d°
++ = *
§c
++;

227 *
d°
++ = *
§c
++;

228 *
d°
++ = *
§c
++;

230 
d°
 +
dlöñí_möus_w
;

231 
§c
 +
¶öñí_möus_w
;

234 
DRAWOFF
;

235 
	}
}

240 
	$löór12_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

241 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

243 
ADDR8
 
d°
 = 
d°psd
->
addr
;

244 
ADDR8
 
§c
 = 
§˝sd
->
addr
;

249 
DRAWON
;

250 
d°
+=((
d°x
*3+1)/2)+480*
d°y
;

251 
§c
+=((
§cx
*3+1)/2)+480*srcx;

253 
	`as£π
 (
d°
 != 0);

254 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

255 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

256 
	`as£π
 (
w
 > 0);

257 
	`as£π
 (
h
 > 0);

258 
	`as£π
 (
§c
 != 0);

259 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

260 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

261 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

262 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

263 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

264 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

267 if((
§cx
 & 0x01Ë&& !(
d°x
 & 0x01))

269 
§c
+=1;

273 if(!(
§cx
 & 0x01Ë&& (
d°x
 & 0x01))

275 
d°
+=1;

279 if((
§cx
 & 0x01Ë&& (
d°x
 & 0x01))

285 --
h
 >= 0) {

287 
	`mem˝y
(
d°
, 
§c
, (
w
*3+1)/2);

288 
d°
 += 480;

289 
§c
 += 480;

291 
DRAWOFF
;

292 
	}
}

295 
SUBDRIVER
 
	gfblöór12
 = {

296 
löór12_öô
,

297 
löór12_døwpixñ
,

298 
löór12_ªadpixñ
,

299 
löór12_døwh‹zlöe
,

300 
löór12_døwvîéöe
,

301 
gí_fûÃe˘
,

302 
löór12_blô


	@drivers/fblin16.c

10 
	~<as£π.h
>

11 
	~<°dlib.h
>

14 #i‚de‡
__OPTIMIZE__


15 
	#__OPTIMIZE__


	)

17 
	~<°rög.h
>

19 
	~"devi˚.h
"

20 
	~"fb.h
"

22 #i‡
PSP


23 
	~<p•kî√l.h
>

24 
	~<p•debug.h
>

28 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

30 
	#¥ötf
(...)

	)

33 
	#EPRINTF
 
¥ötf


	)

36 
	#USE_16BIT_ACCESS
 0

	)

38 #i‡
USE_16BIT_ACCESS


39 
	#mem˝y
(
d
,
s
,
nbyãs
Ë
	`mem˝y16
(d,s,“byãs)>>1)

	)

40 
	#memmove
(
d
,
s
,
nbyãs
Ë
	`mem˝y16
(d,s,“byãs)>>1)

	)

42 
	$mem˝y16
(*
d°
, *
§c
, 
nw‹ds
)

44 --
nw‹ds
 >= 0)

45 *
d°
++ = *
§c
++;

46 
	}
}

51 
	$löór16_öô
(
PSD
 
psd
)

53 i‡(!
psd
->
size
) {

54 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

56 
psd
->
löñí
 /= 2;

59 
	}
}

63 
	$löór16_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

65 
ADDR16
 
addr
 = 
psd
->addr;

67 
	`as£π
 (
addr
 != 0);

68 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

69 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

70 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

72 
DRAWON
;

73 if(
gr_mode
 =
MWMODE_COPY
)

74 
addr
[
x
 + 
y
 * 
psd
->
löñí
] = 
c
;

76 
	`≠∂yOp
(
gr_mode
, 
c
, &
addr
[
x
 + 
y
 * 
psd
->
löñí
], 
ADDR16
);

77 
DRAWOFF
;

78 
	}
}

81 
MWPIXELVAL


82 
	$löór16_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

84 
ADDR16
 
addr
 = 
psd
->addr;

86 
	`as£π
 (
addr
 != 0);

87 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

88 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

90  
addr
[
x
 + 
y
 * 
psd
->
löñí
];

91 
	}
}

95 
	$löór16_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

98 #i‡
PSP


99 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

100 
	`¥ötf
("%x %x\n",
psd
,psd->
addr
);

103 
ADDR16
 
addr
 = 
psd
->addr;

105 
	`as£π
 (
addr
 != 0);

106 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

107 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

108 
	`as£π
 (
x2
 >
x1
);

109 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

110 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

112 
DRAWON
;

113 
addr
 +
x1
 + 
y
 * 
psd
->
löñí
;

114 if(
gr_mode
 =
MWMODE_COPY
) {

116 
x1
++ <
x2
)

117 *
addr
++ = 
c
;

119 
x1
++ <
x2
) {

120 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR16
);

121 ++
addr
;

124 
DRAWOFF
;

126 #i‡
PSP


127 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

130 
	}
}

134 
	$löór16_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

136 
ADDR16
 
addr
 = 
psd
->addr;

137 
löñí
 = 
psd
->linelen;

139 
	`as£π
 (
addr
 != 0);

140 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

141 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

142 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

143 
	`as£π
 (
y2
 >
y1
);

144 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

146 
DRAWON
;

147 
addr
 +
x
 + 
y1
 * 
löñí
;

148 if(
gr_mode
 =
MWMODE_COPY
) {

149 
y1
++ <
y2
) {

150 *
addr
 = 
c
;

151 
addr
 +
löñí
;

154 
y1
++ <
y2
) {

155 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR16
);

156 
addr
 +
löñí
;

159 
DRAWOFF
;

160 
	}
}

164 
	$löór16_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

165 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

167 
ADDR16
 
d°
 = 
d°psd
->
addr
;

168 
ADDR16
 
§c
 = 
§˝sd
->
addr
;

169 
i
;

170 
dlöñí
 = 
d°psd
->
löñí
;

171 
¶öñí
 = 
§˝sd
->
löñí
;

172 #i‡
ALPHABLEND


173 
Æpha
;

176 
	`as£π
 (
d°
 != 0);

177 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

178 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

179 
	`as£π
 (
w
 > 0);

180 
	`as£π
 (
h
 > 0);

181 
	`as£π
 (
§c
 != 0);

182 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

183 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

184 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

185 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

186 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

187 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

189 
DRAWON
;

190 
d°
 +
d°x
 + 
d°y
 * 
dlöñí
;

191 
§c
 +
§cx
 + 
§cy
 * 
¶öñí
;

193 #i‡
ALPHABLEND


194 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

195 
°dblô
;

196 
Æpha
 = 
›
 & 0xff;

198 i‡(
d°psd
->
pixty≥
 =
MWPF_TRUECOLOR565
) {

199 --
h
 >= 0) {

200 
i
=0; i<
w
; ++i) {

201 
s
 = *
§c
++;

202 
d
 = *
d°
;

203 
t
 = 
d
 & 0xf800;

204 
m1
, 
m2
, 
m3
;

205 
m1
 = (((((
s
 & 0xf800Ë- 
t
)*
Æpha
)>>8) & 0xf800) +Å;

206 
t
 = 
d
 & 0x07e0;

207 
m2
 = (((((
s
 & 0x07e0Ë- 
t
)*
Æpha
)>>8) & 0x07e0) +Å;

208 
t
 = 
d
 & 0x001f;

209 
m3
 = (((((
s
 & 0x001fË- 
t
)*
Æpha
)>>8) & 0x001f) +Å;

210 *
d°
++ = 
m1
 | 
m2
 | 
m3
;

212 
d°
 +
dlöñí
 - 
w
;

213 
§c
 +
¶öñí
 - 
w
;

217 --
h
 >= 0) {

218 
i
=0; i<
w
; ++i) {

219 
s
 = *
§c
++;

220 
d
 = *
d°
;

221 
t
 = 
d
 & 0x7c00;

222 
m1
, 
m2
, 
m3
;

223 
m1
 = (((((
s
 & 0x7c00Ë- 
t
)*
Æpha
)>>8) & 0x7c00) +Å;

224 
t
 = 
d
 & 0x03e0;

225 
m2
 = (((((
s
 & 0x03e0Ë- 
t
)*
Æpha
)>>8) & 0x03e0) +Å;

226 
t
 = 
d
 & 0x001f;

227 
m3
 = (((((
s
 & 0x001fË- 
t
)*
Æpha
)>>8) & 0x001f) +Å;

228 *
d°
++ = 
m1
 | 
m2
 | 
m3
;

230 
d°
 +
dlöñí
 - 
w
;

231 
§c
 +
¶öñí
 - 
w
;

234 
DRAWOFF
;

236 
°dblô
:

239 i‡(
›
 =
MWROP_COPY
) {

242 i‡(
§cy
 < 
d°y
) {

243 
§c
 +(
h
-1Ë* 
¶öñí
;

244 
d°
 +(
h
-1Ë* 
dlöñí
;

245 
¶öñí
 *= -1;

246 
dlöñí
 *= -1;

248 --
h
 >= 0) {

250 
	`memmove
(
d°
, 
§c
, 
w
<<1);

251 
d°
 +
dlöñí
;

252 
§c
 +
¶öñí
;

255 --
h
 >= 0) {

256 
i
=0; i<
w
; i++) {

257 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c
, 
d°
, 
ADDR16
);

258 ++
§c
;

259 ++
d°
;

261 
d°
 +
dlöñí
 - 
w
;

262 
§c
 +
¶öñí
 - 
w
;

265 
DRAWOFF
;

266 
	}
}

269 
g_row_öc
, 
g_cﬁ_öc
;

273 
	$löór16_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

274 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

275 
MWCOORD
 
§ch
, 
›
)

277 
ADDR16
 
d°
;

278 
ADDR16
 
§c
;

279 
dlöñí
 = 
d°psd
->
löñí
;

280 
¶öñí
 = 
§˝sd
->
löñí
;

281 
i
, 
ymax
;

282 
row_pos
, 
row_öc
;

283 
cﬁ_pos
, 
cﬁ_öc
;

284 
pixñ
 = 0;

286 
	`as£π
 (
d°psd
->
addr
 != 0);

287 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

288 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

289 
	`as£π
 (
d°w
 > 0);

290 
	`as£π
 (
d°h
 > 0);

291 
	`as£π
 (
§˝sd
->
addr
 != 0);

292 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

293 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

294 
	`as£π
 (
§cw
 > 0);

295 
	`as£π
 (
§ch
 > 0);

296 
	`as£π
 (
d°x
+
d°w
 <
d°psd
->
xªs
);

297 
	`as£π
 (
d°y
+
d°h
 <
d°psd
->
yªs
);

298 
	`as£π
 (
§cx
+
§cw
 <
§˝sd
->
xªs
);

299 
	`as£π
 (
§cy
+
§ch
 <
§˝sd
->
yªs
);

301 
DRAWON
;

302 
row_pos
 = 0x10000;

303 i‡(
g_row_öc
Ë
row_öc
 = g_row_inc; 

304 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

307 
ymax
 = 
d°y
+
d°h
; dsty<ymax; ++dsty) {

310 
row_pos
 >= 0x10000L) {

311 ++
§cy
;

312 
row_pos
 -= 0x10000L;

315 
d°
 = (
ADDR16
)
d°psd
->
addr
 + 
d°x
 + 
d°y
*
dlöñí
;

316 
§c
 = (
ADDR16
)
§˝sd
->
addr
 + 
§cx
 + (
§cy
-1)*
¶öñí
;

319 
cﬁ_pos
 = 0x10000;

320 i‡(
g_cﬁ_öc
Ë
cﬁ_öc
 = g_col_inc; 

321 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

322 
i
=0; i<
d°w
; ++i) {

324 
cﬁ_pos
 >= 0x10000L) {

325 
pixñ
 = *
§c
++;

326 
cﬁ_pos
 -= 0x10000L;

328 *
d°
++ = 
pixñ
;

329 
cﬁ_pos
 +
cﬁ_öc
;

332 
row_pos
 +
row_öc
;

334 
DRAWOFF
;

335 
	}
}

348 #i‚de‡
RESTRICT


349 
	#RESTRICT


	)

351 #i‚de‡
SIGN


352 
	#SIGN
(
x
Ë(((xË> 0Ë? 1 : (((xË=0Ë? 0 : -1))

	)

354 #i‚de‡
ABS


355 
	#ABS
(
x
Ë(((xË>0Ë? (xË: -(x))

	)

391 
	$löór16_°ªtchblôex
(
PSD
 
d°psd
,

392 
PSD
 
§˝sd
,

393 
MWCOORD
 
de°_x_°¨t
,

394 
MWCOORD
 
de°_y_°¨t
,

395 
MWCOORD
 
width
,

396 
MWCOORD
 
height
,

397 
x_díomö©‹
,

398 
y_díomö©‹
,

399 
§c_x_‰a˘i⁄
,

400 
§c_y_‰a˘i⁄
,

401 
x_°ï_‰a˘i⁄
,

402 
y_°ï_‰a˘i⁄
,

403 
›
)

406 *
RESTRICT
 
§c_±r
;

409 *
RESTRICT
 
√xt_§c_±r
;

412 *
RESTRICT
 
de°_±r
;

415 *
√xt_de°_±r
;

418 
x_îr‹
;

419 
y_îr‹
;

424 
§c_x_°ï_⁄e
;

425 
§c_y_°ï_⁄e
;

430 
§c_x_°ï_n‹mÆ
;

431 
§c_y_°ï_n‹mÆ
;

436 
x_îr‹_°ï_n‹mÆ
;

437 
y_îr‹_°ï_n‹mÆ
;

440 
x_cou¡
;

441 
y_cou¡
;

444 
§c_x_°¨t
;

445 
§c_y_°¨t
;

448 
x_îr‹_°¨t
;

451 
de°_y_°ï
;

459 
§c_x_‰a˘i⁄
 +(
x_°ï_‰a˘i⁄
 >> 1);

460 
§c_y_‰a˘i⁄
 +(
y_°ï_‰a˘i⁄
 >> 1);

468 
§c_x_°¨t
 = 
§c_x_‰a˘i⁄
 / 
x_díomö©‹
;

469 
§c_y_°¨t
 = 
§c_y_‰a˘i⁄
 / 
y_díomö©‹
;

470 
x_îr‹_°¨t
 = 
§c_x_‰a˘i⁄
 - (
§c_x_°¨t
 + 1Ë* 
x_díomö©‹
;

471 
y_îr‹
 = 
§c_y_‰a˘i⁄
 - (
§c_y_°¨t
 + 1Ë* 
y_díomö©‹
;

475 
§c_x_°ï_n‹mÆ
 = 
x_°ï_‰a˘i⁄
 / 
x_díomö©‹
;

476 
§c_x_°ï_⁄e
 = 
	`SIGN
(
x_°ï_‰a˘i⁄
);

477 
x_îr‹_°ï_n‹mÆ
 =

478 
	`ABS
(
x_°ï_‰a˘i⁄
Ë- ABS(
§c_x_°ï_n‹mÆ
Ë* 
x_díomö©‹
;

480 
§c_y_°ï_n‹mÆ
 = 
y_°ï_‰a˘i⁄
 / 
y_díomö©‹
;

481 
§c_y_°ï_⁄e
 = 
	`SIGN
(
y_°ï_‰a˘i⁄
Ë* 
§˝sd
->
löñí
;

482 
y_îr‹_°ï_n‹mÆ
 =

483 
	`ABS
(
y_°ï_‰a˘i⁄
Ë- ABS(
§c_y_°ï_n‹mÆ
Ë* 
y_díomö©‹
;

484 
§c_y_°ï_n‹mÆ
 *
§˝sd
->
löñí
;

492 
√xt_§c_±r
 =

493 ((*Ë
§˝sd
->
addr
) +

494 
§c_y_°¨t
 * 
§˝sd
->
löñí
 + 
§c_x_°¨t
;

497 
de°_y_°ï
 = 
d°psd
->
löñí
;

500 
√xt_de°_±r
 =

501 ((*Ë
d°psd
->
addr
) +

502 (
de°_y_°¨t
 * 
de°_y_°ï
Ë+ 
de°_x_°¨t
;

512 
›
 & 
MWROP_EXTENSION
) {

513 
MWROP_SRC
:

517 
y_cou¡
 = 
height
;

518 
y_cou¡
-- > 0) {

519 
§c_±r
 = 
√xt_§c_±r
;

520 
de°_±r
 = 
√xt_de°_±r
;

522 
x_îr‹
 = 
x_îr‹_°¨t
;

524 
x_cou¡
 = 
width
;

525 
x_cou¡
-- > 0) {

526 *
de°_±r
++ = *
§c_±r
;

528 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

529 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

531 i‡(
x_îr‹
 >= 0) {

532 
§c_±r
 +
§c_x_°ï_⁄e
;

533 
x_îr‹
 -
x_díomö©‹
;

537 
√xt_de°_±r
 +
de°_y_°ï
;

539 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

540 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

542 i‡(
y_îr‹
 >= 0) {

543 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

544 
y_îr‹
 -
y_díomö©‹
;

549 
MWROP_CLEAR
:

550 
y_cou¡
 = 
height
;

551 
y_cou¡
-- > 0) {

552 
de°_±r
 = 
√xt_de°_±r
;

553 
x_cou¡
 = 
width
;

554 
x_cou¡
-- > 0) {

555 *
de°_±r
++ = 0;

557 
√xt_de°_±r
 +
de°_y_°ï
;

562 
y_cou¡
 = 
height
;

563 
y_cou¡
-- > 0) {

564 
§c_±r
 = 
√xt_§c_±r
;

565 
de°_±r
 = 
√xt_de°_±r
;

567 
x_îr‹
 = 
x_îr‹_°¨t
;

569 
x_cou¡
 = 
width
;

570 
x_cou¡
-- > 0) {

571 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c_±r
, 
de°_±r
, 
ADDR16
);

572 
de°_±r
++;

574 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

575 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

577 i‡(
x_îr‹
 >= 0) {

578 
§c_±r
 +
§c_x_°ï_⁄e
;

579 
x_îr‹
 -
x_díomö©‹
;

583 
√xt_de°_±r
 +
de°_y_°ï
;

585 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

586 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

588 i‡(
y_îr‹
 >= 0) {

589 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

590 
y_îr‹
 -
y_díomö©‹
;

596 
	}
}

598 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


602 
	$öô_w‹dmask_lookup
(**
byã2w‹dmask
)

604 *
maskp
, *
b2wm
;

605 
t
, 
x
, 
u
;

607 
b2wm
 = *
byã2w‹dmask
 = 
	`mÆloc
(256*8*2);

608 i‡–
b2wm
 == 0 )

609 
	`exô
(17);

610  
t
=0;Å < 256;Å++ ) {

611 
maskp
 = 
b2wm
 + 8 * 
t
;

612 
x
 = 
t
;

613  
u
=1; u < 256; u <<= 1 )

614 i‡–
x
 & 
u
 )

615 *
maskp
++ = 0xffff;

617 *
maskp
++ = 0x0000;

619 
	}
}

643 
	$löór16_døw¨ó_bôm≠_byãs_lsb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

645 
fú°_byã
, 
œ°_byã
;

646 
h¨d_¥efix
, 
h¨d_po°fix
;

647 
¥efixbôs
, 
po°fixbôs
, *
maskp
;

648 
x‹_cﬁ‹
, 
m
;

649 
¥efix_mask
 = 0, 
¥efix_œ°
 = 0;

650 
po°fix_mask
 = 0, 
po°fix_œ°
 = 0;

651 
fg_cﬁ‹
 = 
gc
->fg_color;

652 
bg_cﬁ‹
 = 
gc
->bg_color;

653 
size_maö
, 
t
, 
y
;

654 
adv™˚_§c
, 
adv™˚_d°
;

655 
bôm≠_byã
;

656 
ADDR8
 
§c
;

657 
ADDR16
 
d°
;

659 *
byã2w‹dmask
 = 0;

661 
¥efixbôs
 = 
gc
->
§cx
 & 7;

662 
po°fixbôs
 = (
gc
->
§cx
 + gc->
d°w
 - 1) & 7;

663 
fú°_byã
 = 
gc
->
§cx
 >> 3;

664 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

666 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

667 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

668 
x‹_cﬁ‹
 = 
fg_cﬁ‹
 ^ 
bg_cﬁ‹
;

670 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1;

671 
h¨d_¥efix
 = 0;

672 
h¨d_po°fix
 = 0;

674 i‡(
fú°_byã
 !
œ°_byã
) {

675 i‡(
¥efixbôs
 != 0) {

677 
h¨d_¥efix
 = 1;

678 
size_maö
--;

679 
¥efix_mask
 = 1 << 
¥efixbôs
;

680 
¥efix_œ°
 = 0x100;

682 i‡–
po°fixbôs
 != 7 ) {

684 
h¨d_po°fix
 = 1;

685 
po°fix_mask
 = 1;

686 
po°fix_œ°
 = 2 << 
po°fixbôs
;

687 
size_maö
--;

691 
h¨d_¥efix
 = 1;

692 
h¨d_po°fix
 = 0;

693 
size_maö
 = 0;

694 
¥efix_mask
 = 1 << 
¥efixbôs
;

695 
¥efix_œ°
 = 1 << (
¥efixbôs
 + 
gc
->
d°w
);

698 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

699 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

701 i‡–
byã2w‹dmask
 == 0 )

702 
	`öô_w‹dmask_lookup
(&
byã2w‹dmask
);

704 
DRAWON
;

705 i‡(
gc
->
gr_u£bg
) {

706 
y
 = 0; y < 
gc
->
d°h
; y++) {

709 i‡(
h¨d_¥efix
) {

710 
m
 = 
¥efix_mask
; m < 
¥efix_œ°
;

711 
m
 <<= 1) {

712 *
d°
++ = (
m
 & *
§c
Ë? 
fg_cﬁ‹
 :

713 
bg_cﬁ‹
;

715 
§c
++;

719 
t
 = 0;Å < 
size_maö
;Å++) {

720 
maskp
 = 
byã2w‹dmask
 + 8 * (*
§c
++);

722 *
d°
++ = 
gc
->

723 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

724 *
d°
++ = 
gc
->

725 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

726 *
d°
++ = 
gc
->

727 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

728 *
d°
++ = 
gc
->

729 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

730 *
d°
++ = 
gc
->

731 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

732 *
d°
++ = 
gc
->

733 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

734 *
d°
++ = 
gc
->

735 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

736 *
d°
++ = 
gc
->

737 
bg_cﬁ‹
 ^ (*
maskp
++ & 
x‹_cﬁ‹
);

741 i‡(
h¨d_po°fix
) {

742 
m
 = 
po°fix_mask
; m < 
po°fix_œ°
;

743 
m
 <<= 1) {

744 *
d°
++ = (
m
 & *
§c
Ë? 
fg_cﬁ‹
 :

745 
bg_cﬁ‹
;

747 
§c
++;

750 
§c
 +
adv™˚_§c
;

751 
d°
 +
adv™˚_d°
;

754 
y
 = 0; y < 
gc
->
d°h
; y++) {

757 i‡(
h¨d_¥efix
) {

758 
bôm≠_byã
 = *
§c
++;

759 
m
 = 
¥efix_mask
; m < 
¥efix_œ°
;

760 
m
 <<= 1) {

761 i‡(
m
 & 
bôm≠_byã
)

762 *
d°
 = 
fg_cﬁ‹
;

763 
d°
++;

768 
t
 = 0;Å < 
size_maö
;Å++) {

769 
bôm≠_byã
 = *
§c
++;

771 i‡(0x01 & 
bôm≠_byã
)

772 
d°
[0] = 
fg_cﬁ‹
;

773 i‡(0x02 & 
bôm≠_byã
)

774 
d°
[1] = 
fg_cﬁ‹
;

775 i‡(0x04 & 
bôm≠_byã
)

776 
d°
[2] = 
fg_cﬁ‹
;

777 i‡(0x08 & 
bôm≠_byã
)

778 
d°
[3] = 
fg_cﬁ‹
;

779 i‡(0x10 & 
bôm≠_byã
)

780 
d°
[4] = 
fg_cﬁ‹
;

781 i‡(0x20 & 
bôm≠_byã
)

782 
d°
[5] = 
fg_cﬁ‹
;

783 i‡(0x40 & 
bôm≠_byã
)

784 
d°
[6] = 
fg_cﬁ‹
;

785 i‡(0x80 & 
bôm≠_byã
)

786 
d°
[7] = 
fg_cﬁ‹
;

788 
d°
 += 8;

792 i‡(
h¨d_po°fix
) {

793 
bôm≠_byã
 = *
§c
++;

794 
m
 = 
po°fix_mask
; m < 
po°fix_œ°
;

795 
m
 <<= 1) {

796 i‡(
m
 & 
bôm≠_byã
)

797 *
d°
 = 
fg_cﬁ‹
;

798 
d°
++;

802 
§c
 +
adv™˚_§c
;

803 
d°
 +
adv™˚_d°
;

806 
DRAWOFF
;

807 
	}
}

811 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


831 
	$löór16_døw¨ó_bôm≠_byãs_msb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

845 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë>(b))

	)

846 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË>>1)

	)

847 
	#MWI_BIT_NO
(
n
Ë(0x80 >> (n))

	)

853 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

854 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

856 
¥efix_fú°_bô
;

857 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

858 
po°fix_œ°_bô
;

859 
bôm≠_byã
;

860 
mask
;

861 
fg
, 
bg
;

862 
fú°_byã
, 
œ°_byã
;

863 
size_maö
;

864 
t
, 
y
;

865 
adv™˚_§c
, 
adv™˚_d°
;

866 
ADDR8
 
§c
;

867 
ADDR16
 
d°
;

870 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

873 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

876 
fú°_byã
 = 
gc
->
§cx
 >> 3;

879 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

881 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

882 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

883 
fg
 = 
gc
->
fg_cﬁ‹
;

884 
bg
 = 
gc
->
bg_cﬁ‹
;

886 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

887 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

889 i‡(
fú°_byã
 !
œ°_byã
) {

893 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

895 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

897 
¥efix_fú°_bô
 = 0;

898 
size_maö
++;

900 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

902 
po°fix_œ°_bô
 = 0;

903 
size_maö
++;

905 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

906 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

908 
¥efix_fú°_bô
 = 0;

909 
po°fix_œ°_bô
 = 0;

910 
size_maö
 = 1;

914 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

915 
¥efix_fú°_bô
 = 0;

916 
size_maö
 = 0;

919 
DRAWON
;

921 i‡(
gc
->
gr_u£bg
) {

922 
y
 = 0; y < 
gc
->
d°h
; y++) {

925 i‡(
¥efix_fú°_bô
) {

926 
bôm≠_byã
 = *
§c
++;

927 
mask
 = 
¥efix_fú°_bô
; mask;

928 
	`MWI_ADVANCE_BIT
(
mask
)) {

929 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

930 
bg
;

935 
t
 = 
size_maö
;Å != 0;Å--) {

936 
bôm≠_byã
 = *
§c
++;

938 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

939 
bg
;

940 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

941 
bg
;

942 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

943 
bg
;

944 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

945 
bg
;

946 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

947 
bg
;

948 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

949 
bg
;

950 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

951 
bg
;

952 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

953 
bg
;

957 i‡(
po°fix_œ°_bô
) {

958 
bôm≠_byã
 = *
§c
++;

959 
mask
 = 
po°fix_fú°_bô
;

960 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

961 
po°fix_œ°_bô
);

962 
	`MWI_ADVANCE_BIT
(
mask
)) {

963 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

964 
bg
;

968 
§c
 +
adv™˚_§c
;

969 
d°
 +
adv™˚_d°
;

972 
y
 = 0; y < 
gc
->
d°h
; y++) {

975 i‡(
¥efix_fú°_bô
) {

976 
bôm≠_byã
 = *
§c
++;

977 
mask
 = 
¥efix_fú°_bô
; mask;

978 
	`MWI_ADVANCE_BIT
(
mask
)) {

979 i‡(
mask
 & 
bôm≠_byã
)

980 *
d°
 = 
fg
;

981 
d°
++;

986 
t
 = 
size_maö
;Å != 0;Å--) {

987 
bôm≠_byã
 = *
§c
++;

989 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

990 
d°
[0] = 
fg
;

991 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

992 
d°
[1] = 
fg
;

993 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

994 
d°
[2] = 
fg
;

995 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

996 
d°
[3] = 
fg
;

997 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

998 
d°
[4] = 
fg
;

999 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

1000 
d°
[5] = 
fg
;

1001 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

1002 
d°
[6] = 
fg
;

1003 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

1004 
d°
[7] = 
fg
;

1006 
d°
 += 8;

1010 i‡(
po°fix_œ°_bô
) {

1011 
bôm≠_byã
 = *
§c
++;

1012 
mask
 = 
po°fix_fú°_bô
;

1013 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1014 
po°fix_œ°_bô
);

1015 
	`MWI_ADVANCE_BIT
(
mask
)) {

1016 i‡(
mask
 & 
bôm≠_byã
)

1017 *
d°
 = 
fg
;

1018 
d°
++;

1022 
§c
 +
adv™˚_§c
;

1023 
d°
 +
adv™˚_d°
;

1027 
DRAWOFF
;

1029 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


1030 #unde‡
MWI_ADVANCE_BIT


1031 #unde‡
MWI_BIT_NO


1032 #unde‡
MWI_FIRST_BIT


1033 #unde‡
MWI_LAST_BIT


1034 
	}
}

1038 #i‡
MW_FEATURE_PSDOP_ALPHAMAP


1043 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


1044 #îr‹ 
PSDOP_ALPHAMAP
 
d€s
 
nŸ
 
w‹k
 
ö
 5/5/5 
mode
!!

1047 *
	glow2sˇÀ
 = 0, *
	ghigh2sˇÀ
 = 0;

1050 
	$öô_Æpha_lookup
()

1052 
a
, 
x
;

1053 
r
, 
g
, 
b
;

1054 
idx
;

1056 
low2sˇÀ
 = 
	`mÆloc
(32 * 256 * (low2scale[0]));

1057 
high2sˇÀ
 = 
	`mÆloc
(32 * 256 * (high2scale[0]));

1059 i‡(
high2sˇÀ
 =0 || 
low2sˇÀ
 == 0)

1060 
	`exô
(17);

1062  
a
=0;á < 32;á++ )

1063  
x
=0; x < 256; x++ ) {

1064 
idx
 = (
a
 << 8Ë| 
x
;

1066 
r
 = (
x
 >> 3Ë* 
a
 / 31;

1067 
g
 = ((
x
 << 3Ë& 0x38Ë* 
a
 / 31;

1068 
high2sˇÀ
[
idx
] = (
r
 << 11Ë| (
g
 << 5);

1070 
b
 = (
x
 & 0x1fË* 
a
 / 31;

1071 
g
 = ((
x
 >> 5Ë& 0x7Ë* 
a
 / 31;

1072 
low2sˇÀ
[
idx
] = (
g
 << 5Ë| 
b
;

1074 
	}
}

1077 
	$löór16_døw¨ó_Æpham≠
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1079 
ADDR16
 
§c
, 
d°
;

1080 
ADDR8
 
Æpha
;

1081 
ps
, 
pd
;

1082 
as
, 
ad
;

1083 
x
, 
y
;

1084 
§c_row_°ï
, 
d°_row_°ï
;

1086 i‡–
low2sˇÀ
 == 0 )

1087 
	`öô_Æpha_lookup
();

1089 
§c
 = ((
ADDR16
Ë
gc
->
pixñs
Ë+ gc->
§cx
 + gc->
§c_löñí
 * gc->
§cy
;

1090 
Æpha
 = ((
ADDR8
Ë
gc
->
misc
Ë+ gc->
§c_löñí
 * gc->
§cy
 + gc->
§cx
;

1091 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1093 
§c_row_°ï
 = 
gc
->
§c_löñí
 - gc->
d°w
;

1094 
d°_row_°ï
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1096 
DRAWON
;

1097 
y
 = 0; y < 
gc
->
d°h
; y++) {

1098 
x
 = 0; x < 
gc
->
d°w
; x++) {

1099 
as
 = (((Ë((*
Æpha
++) >> 3)) << 8);

1100 
ad
 = (31 << 8Ë- 
as
;

1101 
ps
 = *
§c
++;

1102 
pd
 = *
d°
++;

1103 *
d°
++ = ((
as
 =0Ë? 
pd
 :

1104 ((
ad
 =0Ë? 
ps
 :

1105 
low2sˇÀ
[
as
 | (
ps
 >> 8)] +

1106 
high2sˇÀ
[
as
 | (
ps
 & 0xFF)] +

1107 
low2sˇÀ
[
ad
 | (
pd
 >> 8)] +

1108 
high2sˇÀ
[
ad
 | (
pd
 & 0xFF)]));

1110 
Æpha
 +
§c_row_°ï
;

1111 
§c
 +
§c_row_°ï
;

1112 
d°
 +
d°_row_°ï
;

1114 
DRAWOFF
;

1115 
	}
}

1119 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1121 
	$löór16_døw¨ó_Æphacﬁ
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1123 
ADDR16
 
d°
;

1124 
ADDR8
 
Æpha
;

1125 
ps
, 
pd
;

1126 
as
;

1127 
p§
, 
psg
, 
psb
;

1128 
x
, 
y
;

1129 
§c_row_°ï
, 
d°_row_°ï
;

1131 
Æpha
 = ((
ADDR8
Ë
gc
->
misc
Ë+ gc->
§c_löñí
 * gc->
§cy
 + gc->
§cx
;

1132 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1133 
ps
 = 
gc
->
fg_cﬁ‹
;

1135 
§c_row_°ï
 = 
gc
->
§c_löñí
 - gc->
d°w
;

1136 
d°_row_°ï
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1138 
	#COLOR_MASK_R_565
 0xF800U

	)

1139 
	#COLOR_MASK_G_565
 0x07E0U

	)

1140 
	#COLOR_MASK_B_565
 0x001FU

	)

1142 
	#COLOR_MASK_R_555
 0x7C00U

	)

1143 
	#COLOR_MASK_G_555
 0x03E0U

	)

1144 
	#COLOR_MASK_B_555
 0x001FU

	)

1146 
DRAWON
;

1147 i‡(
psd
->
pixty≥
 =
MWPF_TRUECOLOR565
) {

1148 
p§
 = (Ë(
ps
 & 
COLOR_MASK_R_565
);

1149 
psg
 = (Ë(
ps
 & 
COLOR_MASK_G_565
);

1150 
psb
 = (Ë(
ps
 & 
COLOR_MASK_B_565
);

1152 
y
 = 0; y < 
gc
->
d°h
; y++) {

1153 
x
 = 0; x < 
gc
->
d°w
; x++) {

1154 
as
 = *
Æpha
++;

1155 i‡(
as
 == 255) {

1156 *
d°
++ = 
ps
;

1157 } i‡(
as
 != 0) {

1169 
as
 = 256 - (as + (as >> 7));

1170 
pd
 = *
d°
;

1172 *
d°
++ = (()

1174 (
pd
 & 
COLOR_MASK_R_565
)

1175 - 
p§
Ë* 
as
) >> 8) +

1176 
p§
Ë& 
COLOR_MASK_R_565
)

1180 (
pd
 & 
COLOR_MASK_G_565
) -

1181 
psg
Ë* 
as
) >> 8) +

1182 
psg
Ë& 
COLOR_MASK_G_565
)

1186 (
pd
 & 
COLOR_MASK_B_565
) -

1187 
psb
Ë* 
as
) >> 8) +

1188 
psb
Ë& 
COLOR_MASK_B_565
);

1190 
d°
++;

1193 
Æpha
 +
§c_row_°ï
;

1194 
d°
 +
d°_row_°ï
;

1197 
p§
 = (Ë(
ps
 & 
COLOR_MASK_R_555
);

1198 
psg
 = (Ë(
ps
 & 
COLOR_MASK_G_555
);

1199 
psb
 = (Ë(
ps
 & 
COLOR_MASK_B_555
);

1201 
y
 = 0; y < 
gc
->
d°h
; y++) {

1202 
x
 = 0; x < 
gc
->
d°w
; x++) {

1203 
as
 = *
Æpha
++;

1204 i‡(
as
 == 255) {

1205 *
d°
++ = 
ps
;

1206 } i‡(
as
 != 0) {

1218 
as
 = 256 - (as + (as >> 7));

1219 
pd
 = *
d°
;

1221 *
d°
++ = (()

1223 (
pd
 & 
COLOR_MASK_R_555
)

1224 - 
p§
Ë* 
as
) >> 8) +

1225 
p§
Ë& 
COLOR_MASK_R_555
)

1229 (
pd
 & 
COLOR_MASK_G_555
) -

1230 
psg
Ë* 
as
) >> 8) +

1231 
psg
Ë& 
COLOR_MASK_G_555
)

1235 (
pd
 & 
COLOR_MASK_B_555
) -

1236 
psb
Ë* 
as
) >> 8) +

1237 
psb
Ë& 
COLOR_MASK_B_555
);

1239 
d°
++;

1242 
Æpha
 +
§c_row_°ï
;

1243 
d°
 +
d°_row_°ï
;

1246 
DRAWOFF
;

1247 
	}
}

1250 #i‡
MW_FEATURE_PSDOP_COPY


1252 
	$löór16_døw¨ó_c›yÆl
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1254 
ADDR16
 
§c16
, 
d°
;

1255 
löesize
, 
x
, 
y
;

1256 
pcﬁ
;

1258 
löesize
 = 2 * 
gc
->
d°w
;

1259 
§c16
 = ((
ADDR16
Ë
gc
->
pixñs
Ë+ gc->
§cx
 + gc->
§c_löñí
 * gc->
§cy
;

1260 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+ 
gc
->
d°x
 +Ösd->
löñí
 * gc->
d°y
;

1262 
DRAWON
;

1263 
y
 = 1; y < 
gc
->
d°h
; y++) {

1264 
	`mem˝y
(
d°
, 
§c16
, 
löesize
);

1265 
§c16
 +
gc
->
§c_löñí
;

1266 
d°
 +
psd
->
löñí
;

1268 
	`mem˝y
(
d°
, 
§c16
, 
löesize
);

1269 
DRAWOFF
;

1270 
	}
}

1273 
	$löór16_døw¨ó_c›yå™s
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1275 
ADDR16
 
§c16
, 
d°
, 
r§c
, 
rd°
;

1276 
löesize
, 
x
, 
y
;

1277 
pcﬁ
;

1279 
§c16
 = ((
ADDR16
Ë
gc
->
pixñs
Ë+ gc->
§cx
 + gc->
§c_löñí
 * gc->
§cy
;

1280 
d°
 = ((
ADDR16
Ë
psd
->
addr
Ë+ 
gc
->
d°x
 +Ösd->
löñí
 * gc->
d°y
;

1282 
DRAWON
;

1283 
y
 = 0; y < 
gc
->
d°h
; y++) {

1284 
rd°
 = 
d°
;

1285 
r§c
 = 
§c16
;

1286 
x
 = 0; x < 
gc
->
d°w
; x++) {

1287 
pcﬁ
 = *
r§c
++;

1288 i‡(
pcﬁ
 =
gc
->
bg_cﬁ‹
)

1289 
rd°
++;

1291 *
rd°
++ = 
pcﬁ
;

1293 
d°
 +
psd
->
löñí
;

1294 
§c16
 +
gc
->
§c_löñí
;

1296 
DRAWOFF
;

1297 
	}
}

1301 
	$löór16_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1303 
	`as£π
(
psd
->
addr
 != 0);

1305 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x+gc->
d°w
 <
psd
->
xªs
);

1308 
	`as£π
(
gc
->
§cy
 >= 0);

1311 
›
) {

1313 #i‡
MW_FEATURE_PSDOP_COPY


1314 
PSDOP_COPY
:

1315 i‡(
gc
->
gr_u£bg
) {

1316 
	`löór16_døw¨ó_c›yÆl
(
psd
, 
gc
);

1318 
	`löór16_døw¨ó_c›yå™s
(
psd
, 
gc
);

1322 
PSDOP_COPYALL
:

1323 
	`löór16_døw¨ó_c›yÆl
(
psd
, 
gc
);

1326 
PSDOP_COPYTRANS
:

1327 
	`löór16_døw¨ó_c›yå™s
(
psd
, 
gc
);

1331 #i‡
MW_FEATURE_PSDOP_ALPHAMAP


1332 
PSDOP_ALPHAMAP
:

1333 
	`löór16_døw¨ó_Æpham≠
(
psd
, 
gc
);

1337 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1338 
PSDOP_ALPHACOL
:

1339 
	`löór16_døw¨ó_Æphacﬁ
(
psd
, 
gc
);

1343 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


1344 
PSDOP_BITMAP_BYTES_LSB_FIRST
:

1345 
	`löór16_døw¨ó_bôm≠_byãs_lsb_fú°
(
psd
, 
gc
);

1349 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


1350 
PSDOP_BITMAP_BYTES_MSB_FIRST
:

1351 
	`löór16_døw¨ó_bôm≠_byãs_msb_fú°
(
psd
, 
gc
);

1356 
	}
}

1358 
SUBDRIVER
 
	gfblöór16
 = {

1359 
löór16_öô
,

1360 
löór16_døwpixñ
,

1361 
löór16_ªadpixñ
,

1362 
löór16_døwh‹zlöe
,

1363 
löór16_døwvîéöe
,

1364 
gí_fûÃe˘
,

1365 
löór16_blô
,

1366 
löór16_døw¨ó
,

1367 
löór16_°ªtchblô
,

1368 
löór16_°ªtchblôex
,

	@drivers/fblin1rev.c

10 
	~<as£π.h
>

11 
	~<°rög.h
>

12 
	~"devi˚.h
"

13 
	~"fb.h
"

15 
	gnŸmask
[8] = {

20 
	$löór1_öô
(
PSD
 
psd
)

22 i‡(!
psd
->
size
)

23 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

26 
	}
}

30 
	$löór1_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

32 
ADDR8
 
addr
 = 
psd
->addr;

34 
	`as£π
 (
addr
 != 0);

35 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

36 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

37 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

39 
DRAWON
;

40 
addr
 +(
x
>>3Ë+ 
y
 * 
psd
->
löñí
;

41 if(
gr_mode
 =
MWMODE_XOR
)

42 *
addr
 ^
c
 << (
x
&7);

44 *
addr
 = (*add∏& 
nŸmask
[
x
&7]Ë| (
c
 << (x&7));

45 
DRAWOFF
;

46 
	}
}

49 
MWPIXELVAL


50 
	$löór1_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

52 
ADDR8
 
addr
 = 
psd
->addr;

54 
	`as£π
 (
addr
 != 0);

55 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

56 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

58  (
addr
[(
x
>>3Ë+ 
y
 * 
psd
->
löñí
] >> (x&7) ) & 0x01;

59 
	}
}

63 
	$löór1_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

65 
ADDR8
 
addr
 = 
psd
->addr;

67 
	`as£π
 (
addr
 != 0);

68 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

69 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

70 
	`as£π
 (
x2
 >
x1
);

71 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

72 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

74 
DRAWON
;

75 
addr
 +(
x1
>>3Ë+ 
y
 * 
psd
->
löñí
;

76 if(
gr_mode
 =
MWMODE_XOR
) {

77 
x1
 <
x2
) {

78 *
addr
 ^
c
 << (
x1
&7);

79 if((++
x1
 & 7) == 0)

80 ++
addr
;

83 
x1
 <
x2
) {

84 *
addr
 = (*add∏& 
nŸmask
[
x1
&7]Ë| (
c
 << (x1&7));

85 if((++
x1
 & 7) == 0)

86 ++
addr
;

89 
DRAWOFF
;

90 
	}
}

94 
	$löór1_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

96 
ADDR8
 
addr
 = 
psd
->addr;

97 
löñí
 = 
psd
->linelen;

99 
	`as£π
 (
addr
 != 0);

100 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

101 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

102 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

103 
	`as£π
 (
y2
 >
y1
);

104 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

106 
DRAWON
;

107 
addr
 +(
x
>>3Ë+ 
y1
 * 
löñí
;

108 if(
gr_mode
 =
MWMODE_XOR
)

109 
y1
++ <
y2
) {

110 *
addr
 ^
c
 << (
x
&7);

111 
addr
 +
löñí
;

114 
y1
++ <
y2
) {

115 *
addr
 = (*add∏& 
nŸmask
[
x
&7]Ë| (
c
 << (x&7));

116 
addr
 +
löñí
;

118 
DRAWOFF
;

119 
	}
}

123 
	$löór1_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

124 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

126 
ADDR8
 
d°
;

127 
ADDR8
 
§c
;

128 
i
;

129 
dlöñí
 = 
d°psd
->
löñí
;

130 
¶öñí
 = 
§˝sd
->
löñí
;

132 
	`as£π
 (
d°psd
->
addr
 != 0);

133 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

134 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

135 
	`as£π
 (
w
 > 0);

136 
	`as£π
 (
h
 > 0);

137 
	`as£π
 (
§˝sd
->
addr
 != 0);

138 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

139 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

140 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

141 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

142 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

143 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

145 
DRAWON
;

146 
d°
 = 
d°psd
->
addr
 + (
d°x
>>3Ë+ 
d°y
 * 
dlöñí
;

147 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>3Ë+ 
§cy
 * 
¶öñí
;

148 --
h
 >= 0) {

149 
ADDR8
 
d
 = 
d°
;

150 
ADDR8
 
s
 = 
§c
;

151 
MWCOORD
 
dx
 = 
d°x
;

152 
MWCOORD
 
sx
 = 
§cx
;

153 
i
=0; i<
w
; ++i) {

154 *
d
 = (*d & 
nŸmask
[
dx
&7]) |

155 ((*
s
 >> (
sx
&7Ë& 0x01Ë<< (
dx
&7));

156 if((++
dx
 & 7) == 0)

157 ++
d
;

158 if((++
sx
 & 7) == 0)

159 ++
s
;

161 
d°
 +
dlöñí
;

162 
§c
 +
¶öñí
;

164 
DRAWOFF
;

165 
	}
}

167 
SUBDRIVER
 
	gfblöór1
 = {

168 
löór1_öô
,

169 
löór1_døwpixñ
,

170 
löór1_ªadpixñ
,

171 
löór1_døwh‹zlöe
,

172 
löór1_døwvîéöe
,

173 
gí_fûÃe˘
,

174 
löór1_blô


	@drivers/fblin2.c

11 
	~<as£π.h
>

12 
	~<°rög.h
>

13 
	~"devi˚.h
"

14 
	~"fb.h
"

16 
	gnŸmask
[4] = { 0x3f, 0xcf, 0xf3, 0xfc};

20 
	$löór2_öô
(
PSD
 
psd
)

22 i‡(!
psd
->
size
)

23 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

26 
	}
}

30 
	$löór2_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

32 
ADDR8
 
addr
 = 
psd
->addr;

34 
	`as£π
 (
addr
 != 0);

35 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

36 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

37 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

39 
DRAWON
;

40 
addr
 +(
x
>>2Ë+ 
y
 * 
psd
->
löñí
;

41 if(
gr_mode
 =
MWMODE_XOR
)

42 *
addr
 ^
c
 << ((3-(
x
&3))<<1);

44 *
addr
 = (*add∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((3-(x&3))<<1));

45 
DRAWOFF
;

46 
	}
}

49 
MWPIXELVAL


50 
	$löór2_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

52 
ADDR8
 
addr
 = 
psd
->addr;

54 
	`as£π
 (
addr
 != 0);

55 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

56 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

58  (
addr
[(
x
>>2Ë+ 
y
 * 
psd
->
löñí
] >> ((3-(x&3))<<1) ) & 0x03;

59 
	}
}

63 
	$löór2_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

65 
ADDR8
 
addr
 = 
psd
->addr;

67 
	`as£π
 (
addr
 != 0);

68 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

69 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

70 
	`as£π
 (
x2
 >
x1
);

71 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

72 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

74 
DRAWON
;

75 
addr
 +(
x1
>>2Ë+ 
y
 * 
psd
->
löñí
;

76 if(
gr_mode
 =
MWMODE_XOR
) {

77 
x1
 <
x2
) {

78 *
addr
 ^
c
 << ((3-(
x1
&3))<<1);

79 if((++
x1
 & 3) == 0)

80 ++
addr
;

83 
x1
 <
x2
) {

84 *
addr
 = (*add∏& 
nŸmask
[
x1
&3]Ë| (
c
 << ((3-(x1&3))<<1));

85 if((++
x1
 & 3) == 0)

86 ++
addr
;

89 
DRAWOFF
;

90 
	}
}

94 
	$löór2_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

96 
ADDR8
 
addr
 = 
psd
->addr;

97 
löñí
 = 
psd
->linelen;

99 
	`as£π
 (
addr
 != 0);

100 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

101 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

102 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

103 
	`as£π
 (
y2
 >
y1
);

104 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

106 
DRAWON
;

107 
addr
 +(
x
>>2Ë+ 
y1
 * 
löñí
;

108 if(
gr_mode
 =
MWMODE_XOR
)

109 
y1
++ <
y2
) {

110 *
addr
 ^
c
 << ((3-(
x
&3))<<1);

111 
addr
 +
löñí
;

114 
y1
++ <
y2
) {

115 *
addr
 = (*add∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((3-(x&3))<<1));

116 
addr
 +
löñí
;

118 
DRAWOFF
;

119 
	}
}

123 
	$löór2_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

124 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

126 
ADDR8
 
d°
;

127 
ADDR8
 
§c
;

128 
i
;

129 
dlöñí
 = 
d°psd
->
löñí
;

130 
¶öñí
 = 
§˝sd
->
löñí
;

132 
	`as£π
 (
d°psd
->
addr
 != 0);

133 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

134 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

135 
	`as£π
 (
w
 > 0);

136 
	`as£π
 (
h
 > 0);

137 
	`as£π
 (
§˝sd
->
addr
 != 0);

138 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

139 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

140 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

141 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

142 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

143 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

145 
DRAWON
;

146 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ (
d°x
>>2Ë+ 
d°y
 * 
dlöñí
;

147 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ (
§cx
>>2Ë+ 
§cy
 * 
¶öñí
;

148 --
h
 >= 0) {

149 
ADDR8
 
d
 = 
d°
;

150 
ADDR8
 
s
 = 
§c
;

151 
MWCOORD
 
dx
 = 
d°x
;

152 
MWCOORD
 
sx
 = 
§cx
;

153 
i
=0; i<
w
; ++i) {

154 *
d
 = (*d & 
nŸmask
[
dx
&3]) |

155 ((*
s
 >> ((3-(
sx
&3))<<1Ë& 0x03Ë<< ((3-(
dx
&3))<<1));

156 if((++
dx
 & 3) == 0)

157 ++
d
;

158 if((++
sx
 & 3) == 0)

159 ++
s
;

161 
d°
 +
dlöñí
;

162 
§c
 +
¶öñí
;

164 
DRAWOFF
;

165 
	}
}

167 
SUBDRIVER
 
	gfblöór2
 = {

168 
löór2_öô
,

169 
löór2_døwpixñ
,

170 
löór2_ªadpixñ
,

171 
löór2_døwh‹zlöe
,

172 
löór2_døwvîéöe
,

173 
gí_fûÃe˘
,

174 
löór2_blô


	@drivers/fblin24.c

8 
	~<as£π.h
>

9 
	~<°rög.h
>

10 
	~"devi˚.h
"

11 
	~"fb.h
"

15 
	$löór24_öô
(
PSD
 
psd
)

17 i‡(!
psd
->
size
) {

18 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

20 
psd
->
löñí
 /= 3;

23 
	}
}

27 
	$löór24_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

29 
ADDR8
 
addr
 = 
psd
->addr;

30 
MWUCHAR
 
r
, 
g
, 
b
;

32 
	`as£π
 (
addr
 != 0);

33 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

34 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

35 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

37 
r
 = 
	`PIXEL888RED
(
c
);

38 
g
 = 
	`PIXEL888GREEN
(
c
);

39 
b
 = 
	`PIXEL888BLUE
(
c
);

40 
addr
 +(
x
 + 
y
 * 
psd
->
löñí
) * 3;

41 
DRAWON
;

42 if(
gr_mode
 =
MWMODE_COPY
) {

43 *
addr
++ = 
b
;

44 *
addr
++ = 
g
;

45 *
addr
 = 
r
;

47 
	`≠∂yOp
(
gr_mode
, 
b
, 
addr
, 
ADDR8
); ++addr;

48 
	`≠∂yOp
(
gr_mode
, 
g
, 
addr
, 
ADDR8
); ++addr;

49 
	`≠∂yOp
(
gr_mode
, 
r
, 
addr
, 
ADDR8
);

51 
DRAWOFF
;

52 
	}
}

55 
MWPIXELVAL


56 
	$löór24_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

58 
ADDR8
 
addr
 = 
psd
->addr;

60 
	`as£π
 (
addr
 != 0);

61 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

62 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

64 
addr
 +(
x
 + 
y
 * 
psd
->
löñí
) * 3;

65  
	`RGB2PIXEL888
(
addr
[2],áddr[1],áddr[0]);

66 
	}
}

70 
	$löór24_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

72 
ADDR8
 
addr
 = 
psd
->addr;

73 
MWUCHAR
 
r
, 
g
, 
b
;

75 
	`as£π
 (
addr
 != 0);

76 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

77 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

78 
	`as£π
 (
x2
 >
x1
);

79 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

80 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

82 
r
 = 
	`PIXEL888RED
(
c
);

83 
g
 = 
	`PIXEL888GREEN
(
c
);

84 
b
 = 
	`PIXEL888BLUE
(
c
);

85 
addr
 +(
x1
 + 
y
 * 
psd
->
löñí
) * 3;

86 
DRAWON
;

87 if(
gr_mode
 =
MWMODE_COPY
) {

88 
x1
++ <
x2
) {

89 *
addr
++ = 
b
;

90 *
addr
++ = 
g
;

91 *
addr
++ = 
r
;

94 
x1
++ <
x2
) {

95 
	`≠∂yOp
(
gr_mode
, 
b
, 
addr
, 
ADDR8
); ++addr;

96 
	`≠∂yOp
(
gr_mode
, 
g
, 
addr
, 
ADDR8
); ++addr;

97 
	`≠∂yOp
(
gr_mode
, 
r
, 
addr
, 
ADDR8
); ++addr;

100 
DRAWOFF
;

101 
	}
}

105 
	$löór24_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

107 
ADDR8
 
addr
 = 
psd
->addr;

108 
löñí
 = 
psd
->linelen * 3;

109 
MWUCHAR
 
r
, 
g
, 
b
;

111 
	`as£π
 (
addr
 != 0);

112 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

113 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

114 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

115 
	`as£π
 (
y2
 >
y1
);

116 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

118 
r
 = 
	`PIXEL888RED
(
c
);

119 
g
 = 
	`PIXEL888GREEN
(
c
);

120 
b
 = 
	`PIXEL888BLUE
(
c
);

121 
addr
 +(
x
 + 
y1
 * 
psd
->
löñí
) * 3;

122 
DRAWON
;

123 if(
gr_mode
 =
MWMODE_COPY
) {

124 
y1
++ <
y2
) {

125 
addr
[0] = 
b
;

126 
addr
[1] = 
g
;

127 
addr
[2] = 
r
;

128 
addr
 +
löñí
;

131 
y1
++ <
y2
) {

132 
	`≠∂yOp
(
gr_mode
, 
b
, &
addr
[0], 
ADDR8
);

133 
	`≠∂yOp
(
gr_mode
, 
g
, &
addr
[1], 
ADDR8
);

134 
	`≠∂yOp
(
gr_mode
, 
r
, &
addr
[2], 
ADDR8
);

135 
addr
 +
löñí
;

138 
DRAWOFF
;

139 
	}
}

143 
	$löór24_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

144 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

146 
ADDR8
 
d°
 = 
d°psd
->
addr
;

147 
ADDR8
 
§c
 = 
§˝sd
->
addr
;

148 
i
;

149 
dlöñí
 = 
d°psd
->
löñí
 * 3;

150 
¶öñí
 = 
§˝sd
->
löñí
 * 3;

151 
dlöñí_möus_w
 = (
d°psd
->
löñí
 - 
w
) * 3;

152 
¶öñí_möus_w
 = (
§˝sd
->
löñí
 - 
w
) * 3;

153 #i‡
ALPHABLEND


154 
Æpha
;

157 
	`as£π
 (
d°
 != 0);

158 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

159 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

160 
	`as£π
 (
w
 > 0);

161 
	`as£π
 (
h
 > 0);

162 
	`as£π
 (
§c
 != 0);

163 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

164 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

165 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

166 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

167 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

168 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

170 
DRAWON
;

171 
d°
 +(
d°x
 + 
d°y
 * 
d°psd
->
löñí
) * 3;

172 
§c
 +(
§cx
 + 
§cy
 * 
§˝sd
->
löñí
) * 3;

174 #i‡
ALPHABLEND


175 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

176 
°dblô
;

177 
Æpha
 = 
›
 & 0xff;

179 --
h
 >= 0) {

180 
i
=0; i<
w
; ++i) {

181 
s
 = *
§c
++;

182 
d
 = *
d°
;

183 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

184 
s
 = *
§c
++;

185 
d
 = *
d°
;

186 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

187 
s
 = *
§c
++;

188 
d
 = *
d°
;

189 *
d°
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

191 
d°
 +
dlöñí_möus_w
;

192 
§c
 +
¶öñí_möus_w
;

194 
DRAWOFF
;

196 
°dblô
:

199 i‡(
›
 =
MWROP_COPY
) {

202 i‡(
§cy
 < 
d°y
) {

203 
§c
 +(
h
-1Ë* 
¶öñí
;

204 
d°
 +(
h
-1Ë* 
dlöñí
;

205 
¶öñí
 *= -1;

206 
dlöñí
 *= -1;

208 --
h
 >= 0) {

210 
	`memmove
(
d°
, 
§c
, 
w
*3);

211 
d°
 +
dlöñí
;

212 
§c
 +
¶öñí
;

215 
i
=
w
*3; i>=0; --i) {

216 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c
, 
d°
, 
ADDR8
);

217 ++
§c
;

218 ++
d°
;

220 
d°
 +
dlöñí_möus_w
;

221 
§c
 +
¶öñí_möus_w
;

223 
DRAWOFF
;

224 
	}
}

228 
	$löór24_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

229 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

230 
MWCOORD
 
§ch
, 
›
)

232 
ADDR8
 
d°
;

233 
ADDR8
 
§c
;

234 
dlöñí
 = 
d°psd
->
löñí
;

235 
¶öñí
 = 
§˝sd
->
löñí
;

236 
i
, 
ymax
;

237 
row_pos
, 
row_öc
;

238 
cﬁ_pos
, 
cﬁ_öc
;

239 
r
 = 0;

240 
g
 = 0;

241 
b
 = 0;

243 
	`as£π
 (
d°psd
->
addr
 != 0);

244 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

245 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

246 
	`as£π
 (
d°w
 > 0);

247 
	`as£π
 (
d°h
 > 0);

248 
	`as£π
 (
§˝sd
->
addr
 != 0);

249 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

250 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

251 
	`as£π
 (
§cw
 > 0);

252 
	`as£π
 (
§ch
 > 0);

253 
	`as£π
 (
d°x
+
d°w
 <
d°psd
->
xªs
);

254 
	`as£π
 (
d°y
+
d°h
 <
d°psd
->
yªs
);

255 
	`as£π
 (
§cx
+
§cw
 <
§˝sd
->
xªs
);

256 
	`as£π
 (
§cy
+
§ch
 <
§˝sd
->
yªs
);

258 
DRAWON
;

259 
row_pos
 = 0x10000;

260 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

263 
ymax
 = 
d°y
+
d°h
; dsty<ymax; ++dsty) {

266 
row_pos
 >= 0x10000L) {

267 ++
§cy
;

268 
row_pos
 -= 0x10000L;

271 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ (
d°x
 + 
d°y
*
dlöñí
) * 3;

272 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ (
§cx
 + (
§cy
-1)*
¶öñí
) * 3;

275 
cﬁ_pos
 = 0x10000;

276 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

277 
i
=0; i<
d°w
; ++i) {

279 
cﬁ_pos
 >= 0x10000L) {

280 
b
 = *
§c
++;

281 
g
 = *
§c
++;

282 
r
 = *
§c
++;

283 
cﬁ_pos
 -= 0x10000L;

285 *
d°
++ = 
b
;

286 *
d°
++ = 
g
;

287 *
d°
++ = 
r
;

288 
cﬁ_pos
 +
cﬁ_öc
;

291 
row_pos
 +
row_öc
;

293 
DRAWOFF
;

294 
	}
}

307 #i‚de‡
RESTRICT


308 
	#RESTRICT


	)

310 #i‚de‡
SIGN


311 
	#SIGN
(
x
Ë(((xË> 0Ë? 1 : (((xË=0Ë? 0 : -1))

	)

313 #i‚de‡
ABS


314 
	#ABS
(
x
Ë(((xË>0Ë? (xË: -(x))

	)

350 
	$löór24_°ªtchblôex
(
PSD
 
d°psd
,

351 
PSD
 
§˝sd
,

352 
MWCOORD
 
de°_x_°¨t
,

353 
MWCOORD
 
de°_y_°¨t
,

354 
MWCOORD
 
width
,

355 
MWCOORD
 
height
,

356 
x_díomö©‹
,

357 
y_díomö©‹
,

358 
§c_x_‰a˘i⁄
,

359 
§c_y_‰a˘i⁄
,

360 
x_°ï_‰a˘i⁄
,

361 
y_°ï_‰a˘i⁄
,

362 
›
)

365 *
RESTRICT
 
§c_±r
;

368 *
RESTRICT
 
√xt_§c_±r
;

371 *
RESTRICT
 
de°_±r
;

374 *
√xt_de°_±r
;

377 
x_îr‹
;

378 
y_îr‹
;

383 
§c_x_°ï_⁄e
;

384 
§c_y_°ï_⁄e
;

389 
§c_x_°ï_n‹mÆ
;

390 
§c_y_°ï_n‹mÆ
;

395 
x_îr‹_°ï_n‹mÆ
;

396 
y_îr‹_°ï_n‹mÆ
;

399 
x_cou¡
;

400 
y_cou¡
;

403 
§c_x_°¨t
;

404 
§c_y_°¨t
;

407 
x_îr‹_°¨t
;

410 
de°_y_°ï
;

418 
§c_x_‰a˘i⁄
 +(
x_°ï_‰a˘i⁄
 >> 1);

419 
§c_y_‰a˘i⁄
 +(
y_°ï_‰a˘i⁄
 >> 1);

427 
§c_x_°¨t
 = 
§c_x_‰a˘i⁄
 / 
x_díomö©‹
;

428 
§c_y_°¨t
 = 
§c_y_‰a˘i⁄
 / 
y_díomö©‹
;

429 
x_îr‹_°¨t
 = 
§c_x_‰a˘i⁄
 - (
§c_x_°¨t
 + 1Ë* 
x_díomö©‹
;

430 
y_îr‹
 = 
§c_y_‰a˘i⁄
 - (
§c_y_°¨t
 + 1Ë* 
y_díomö©‹
;

434 
§c_x_°ï_n‹mÆ
 = 
x_°ï_‰a˘i⁄
 / 
x_díomö©‹
;

435 
§c_x_°ï_⁄e
 = 
	`SIGN
(
x_°ï_‰a˘i⁄
);

436 
x_îr‹_°ï_n‹mÆ
 =

437 
	`ABS
(
x_°ï_‰a˘i⁄
Ë- ABS(
§c_x_°ï_n‹mÆ
Ë* 
x_díomö©‹
;

439 
§c_y_°ï_n‹mÆ
 = 
y_°ï_‰a˘i⁄
 / 
y_díomö©‹
;

440 
§c_y_°ï_⁄e
 = 
	`SIGN
(
y_°ï_‰a˘i⁄
Ë* 
§˝sd
->
löñí
;

441 
y_îr‹_°ï_n‹mÆ
 =

442 
	`ABS
(
y_°ï_‰a˘i⁄
Ë- ABS(
§c_y_°ï_n‹mÆ
Ë* 
y_díomö©‹
;

443 
§c_y_°ï_n‹mÆ
 *
§˝sd
->
löñí
;

451 
√xt_§c_±r
 =

452 ((*Ë
§˝sd
->
addr
) +

453 3 * (
§c_y_°¨t
 * 
§˝sd
->
löñí
 + 
§c_x_°¨t
);

456 
de°_y_°ï
 = 
d°psd
->
löñí
;

459 
√xt_de°_±r
 =

460 ((*Ë
d°psd
->
addr
) +

461 3 * (
de°_y_°¨t
 * 
de°_y_°ï
 + 
de°_x_°¨t
);

464 
§c_x_°ï_n‹mÆ
 *= 3;

465 
§c_x_°ï_⁄e
 *= 3;

466 
§c_y_°ï_n‹mÆ
 *= 3;

467 
§c_y_°ï_⁄e
 *= 3;

477 
›
 & 
MWROP_EXTENSION
) {

478 
MWROP_SRC
:

482 
y_cou¡
 = 
height
;

483 
y_cou¡
-- > 0) {

484 
§c_±r
 = 
√xt_§c_±r
;

485 
de°_±r
 = 
√xt_de°_±r
;

487 
x_îr‹
 = 
x_îr‹_°¨t
;

489 
x_cou¡
 = 
width
;

490 
x_cou¡
-- > 0) {

491 *
de°_±r
++ = 
§c_±r
[0];

492 *
de°_±r
++ = 
§c_±r
[1];

493 *
de°_±r
++ = 
§c_±r
[2];

495 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

496 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

498 i‡(
x_îr‹
 >= 0) {

499 
§c_±r
 +
§c_x_°ï_⁄e
;

500 
x_îr‹
 -
x_díomö©‹
;

504 
√xt_de°_±r
 +
de°_y_°ï
;

506 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

507 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

509 i‡(
y_îr‹
 >= 0) {

510 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

511 
y_îr‹
 -
y_díomö©‹
;

516 
MWROP_CLEAR
:

517 
y_cou¡
 = 
height
;

518 
y_cou¡
-- > 0) {

519 
de°_±r
 = 
√xt_de°_±r
;

520 
x_cou¡
 = 
width
 * 3;

521 
x_cou¡
-- > 0) {

522 *
de°_±r
++ = 0;

524 
√xt_de°_±r
 +
de°_y_°ï
;

529 
y_cou¡
 = 
height
;

530 
y_cou¡
-- > 0) {

531 
§c_±r
 = 
√xt_§c_±r
;

532 
de°_±r
 = 
√xt_de°_±r
;

534 
x_îr‹
 = 
x_îr‹_°¨t
;

536 
x_cou¡
 = 
width
;

537 
x_cou¡
-- > 0) {

538 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), 
§c_±r
[0], 
de°_±r
, 
ADDR8
);

539 
de°_±r
++;

540 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), 
§c_±r
[1], 
de°_±r
, 
ADDR8
);

541 
de°_±r
++;

542 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), 
§c_±r
[2], 
de°_±r
, 
ADDR8
);

543 
de°_±r
++;

545 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

546 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

548 i‡(
x_îr‹
 >= 0) {

549 
§c_±r
 +
§c_x_°ï_⁄e
;

550 
x_îr‹
 -
x_díomö©‹
;

554 
√xt_de°_±r
 +
de°_y_°ï
;

556 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

557 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

559 i‡(
y_îr‹
 >= 0) {

560 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

561 
y_îr‹
 -
y_díomö©‹
;

567 
	}
}

569 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


592 
	$löór24_døw¨ó_bôm≠_byãs_lsb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

606 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë<(b))

	)

607 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË<<1)

	)

608 
	#MWI_BIT_NO
(
n
Ë(0x01 << (n))

	)

614 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

615 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

617 
¥efix_fú°_bô
;

618 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

619 
po°fix_œ°_bô
;

620 
bôm≠_byã
;

621 
mask
;

622 
fg
, 
bg
;

623 
fg_r
, 
fg_g
, 
fg_b
, 
bg_r
, 
bg_g
, 
bg_b
;

624 
fú°_byã
, 
œ°_byã
;

625 
size_maö
;

626 
t
, 
y
;

627 
adv™˚_§c
, 
adv™˚_d°
;

628 
ADDR8
 
§c
;

629 
ADDR8
 
d°
;

632 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

635 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

638 
fú°_byã
 = 
gc
->
§cx
 >> 3;

641 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

643 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

644 
d°
 = ((
ADDR8
Ë
psd
->
addr
Ë+ (psd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
) * 3;

645 
fg
 = 
gc
->
fg_cﬁ‹
;

646 
fg_r
 = 
	`PIXEL888RED
(
fg
);

647 
fg_g
 = 
	`PIXEL888GREEN
(
fg
);

648 
fg_b
 = 
	`PIXEL888BLUE
(
fg
);

649 
bg
 = 
gc
->
bg_cﬁ‹
;

650 
bg_r
 = 
	`PIXEL888RED
(
bg
);

651 
bg_g
 = 
	`PIXEL888GREEN
(
bg
);

652 
bg_b
 = 
	`PIXEL888BLUE
(
bg
);

654 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

655 
adv™˚_d°
 = (
psd
->
löñí
 - 
gc
->
d°w
) * 3;

657 i‡(
fú°_byã
 !
œ°_byã
) {

661 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

663 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

665 
¥efix_fú°_bô
 = 0;

666 
size_maö
++;

668 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

670 
po°fix_œ°_bô
 = 0;

671 
size_maö
++;

673 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

674 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

676 
¥efix_fú°_bô
 = 0;

677 
po°fix_œ°_bô
 = 0;

678 
size_maö
 = 1;

682 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

683 
¥efix_fú°_bô
 = 0;

684 
size_maö
 = 0;

687 
DRAWON
;

689 i‡(
gc
->
gr_u£bg
) {

690 
y
 = 0; y < 
gc
->
d°h
; y++) {

693 i‡(
¥efix_fú°_bô
) {

694 
bôm≠_byã
 = *
§c
++;

695 
mask
 = 
¥efix_fú°_bô
; mask;

696 
	`MWI_ADVANCE_BIT
(
mask
)) {

697 i‡(
mask
 & 
bôm≠_byã
) {

698 *
d°
++ = 
fg_b
;

699 *
d°
++ = 
fg_g
;

700 *
d°
++ = 
fg_r
;

702 *
d°
++ = 
bg_b
;

703 *
d°
++ = 
bg_g
;

704 *
d°
++ = 
bg_r
;

710 
t
 = 
size_maö
;Å != 0;Å--) {

711 
bôm≠_byã
 = *
§c
++;

713 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
) {

714 *
d°
++ = 
fg_b
;

715 *
d°
++ = 
fg_g
;

716 *
d°
++ = 
fg_r
;

718 *
d°
++ = 
bg_b
;

719 *
d°
++ = 
bg_g
;

720 *
d°
++ = 
bg_r
;

722 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
) {

723 *
d°
++ = 
fg_b
;

724 *
d°
++ = 
fg_g
;

725 *
d°
++ = 
fg_r
;

727 *
d°
++ = 
bg_b
;

728 *
d°
++ = 
bg_g
;

729 *
d°
++ = 
bg_r
;

731 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
) {

732 *
d°
++ = 
fg_b
;

733 *
d°
++ = 
fg_g
;

734 *
d°
++ = 
fg_r
;

736 *
d°
++ = 
bg_b
;

737 *
d°
++ = 
bg_g
;

738 *
d°
++ = 
bg_r
;

740 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
) {

741 *
d°
++ = 
fg_b
;

742 *
d°
++ = 
fg_g
;

743 *
d°
++ = 
fg_r
;

745 *
d°
++ = 
bg_b
;

746 *
d°
++ = 
bg_g
;

747 *
d°
++ = 
bg_r
;

749 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
) {

750 *
d°
++ = 
fg_b
;

751 *
d°
++ = 
fg_g
;

752 *
d°
++ = 
fg_r
;

754 *
d°
++ = 
bg_b
;

755 *
d°
++ = 
bg_g
;

756 *
d°
++ = 
bg_r
;

758 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
) {

759 *
d°
++ = 
fg_b
;

760 *
d°
++ = 
fg_g
;

761 *
d°
++ = 
fg_r
;

763 *
d°
++ = 
bg_b
;

764 *
d°
++ = 
bg_g
;

765 *
d°
++ = 
bg_r
;

767 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
) {

768 *
d°
++ = 
fg_b
;

769 *
d°
++ = 
fg_g
;

770 *
d°
++ = 
fg_r
;

772 *
d°
++ = 
bg_b
;

773 *
d°
++ = 
bg_g
;

774 *
d°
++ = 
bg_r
;

776 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
) {

777 *
d°
++ = 
fg_b
;

778 *
d°
++ = 
fg_g
;

779 *
d°
++ = 
fg_r
;

781 *
d°
++ = 
bg_b
;

782 *
d°
++ = 
bg_g
;

783 *
d°
++ = 
bg_r
;

788 i‡(
po°fix_œ°_bô
) {

789 
bôm≠_byã
 = *
§c
++;

790 
mask
 = 
po°fix_fú°_bô
;

791 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

792 
po°fix_œ°_bô
);

793 
	`MWI_ADVANCE_BIT
(
mask
)) {

794 i‡(
mask
 & 
bôm≠_byã
) {

795 *
d°
++ = 
fg_b
;

796 *
d°
++ = 
fg_g
;

797 *
d°
++ = 
fg_r
;

799 *
d°
++ = 
bg_b
;

800 *
d°
++ = 
bg_g
;

801 *
d°
++ = 
bg_r
;

806 
§c
 +
adv™˚_§c
;

807 
d°
 +
adv™˚_d°
;

810 
y
 = 0; y < 
gc
->
d°h
; y++) {

813 i‡(
¥efix_fú°_bô
) {

814 
bôm≠_byã
 = *
§c
++;

815 
mask
 = 
¥efix_fú°_bô
; mask;

816 
	`MWI_ADVANCE_BIT
(
mask
)) {

817 i‡(
mask
 & 
bôm≠_byã
) {

818 
d°
[0] = 
fg_b
;

819 
d°
[1] = 
fg_g
;

820 
d°
[2] = 
fg_r
;

822 
d°
 += 3;

827 
t
 = 
size_maö
;Å != 0;Å--) {

828 
bôm≠_byã
 = *
§c
++;

830 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
) {

831 
d°
[0 * 3 + 0] = 
fg_b
;

832 
d°
[0 * 3 + 1] = 
fg_g
;

833 
d°
[0 * 3 + 2] = 
fg_r
;

835 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
) {

836 
d°
[1 * 3 + 0] = 
fg_b
;

837 
d°
[1 * 3 + 1] = 
fg_g
;

838 
d°
[1 * 3 + 2] = 
fg_r
;

840 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
) {

841 
d°
[2 * 3 + 0] = 
fg_b
;

842 
d°
[2 * 3 + 1] = 
fg_g
;

843 
d°
[2 * 3 + 2] = 
fg_r
;

845 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
) {

846 
d°
[3 * 3 + 0] = 
fg_b
;

847 
d°
[3 * 3 + 1] = 
fg_g
;

848 
d°
[3 * 3 + 2] = 
fg_r
;

850 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
) {

851 
d°
[4 * 3 + 0] = 
fg_b
;

852 
d°
[4 * 3 + 1] = 
fg_g
;

853 
d°
[4 * 3 + 2] = 
fg_r
;

855 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
) {

856 
d°
[5 * 3 + 0] = 
fg_b
;

857 
d°
[5 * 3 + 1] = 
fg_g
;

858 
d°
[5 * 3 + 2] = 
fg_r
;

860 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
) {

861 
d°
[6 * 3 + 0] = 
fg_b
;

862 
d°
[6 * 3 + 1] = 
fg_g
;

863 
d°
[6 * 3 + 2] = 
fg_r
;

865 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
) {

866 
d°
[7 * 3 + 0] = 
fg_b
;

867 
d°
[7 * 3 + 1] = 
fg_g
;

868 
d°
[7 * 3 + 2] = 
fg_r
;

870 
d°
 += 8 * 3;

874 i‡(
po°fix_œ°_bô
) {

875 
bôm≠_byã
 = *
§c
++;

876 
mask
 = 
po°fix_fú°_bô
;

877 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

878 
po°fix_œ°_bô
);

879 
	`MWI_ADVANCE_BIT
(
mask
)) {

880 i‡(
mask
 & 
bôm≠_byã
) {

881 
d°
[0] = 
fg_b
;

882 
d°
[1] = 
fg_g
;

883 
d°
[2] = 
fg_r
;

885 
d°
 += 3;

889 
§c
 +
adv™˚_§c
;

890 
d°
 +
adv™˚_d°
;

894 
DRAWOFF
;

896 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


897 #unde‡
MWI_ADVANCE_BIT


898 #unde‡
MWI_BIT_NO


899 #unde‡
MWI_FIRST_BIT


900 #unde‡
MWI_LAST_BIT


901 
	}
}

904 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


924 
	$löór24_døw¨ó_bôm≠_byãs_msb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

938 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë>(b))

	)

939 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË>>1)

	)

940 
	#MWI_BIT_NO
(
n
Ë(0x80 >> (n))

	)

946 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

947 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

949 
¥efix_fú°_bô
;

950 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

951 
po°fix_œ°_bô
;

952 
bôm≠_byã
;

953 
mask
;

954 
fg
, 
bg
;

955 
fg_r
, 
fg_g
, 
fg_b
, 
bg_r
, 
bg_g
, 
bg_b
;

956 
fú°_byã
, 
œ°_byã
;

957 
size_maö
;

958 
t
, 
y
;

959 
adv™˚_§c
, 
adv™˚_d°
;

960 
ADDR8
 
§c
;

961 
ADDR8
 
d°
;

964 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

967 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

970 
fú°_byã
 = 
gc
->
§cx
 >> 3;

973 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

975 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

976 
d°
 = ((
ADDR8
Ë
psd
->
addr
Ë+ (psd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
) * 3;

977 
fg
 = 
gc
->
fg_cﬁ‹
;

978 
fg_r
 = 
	`PIXEL888RED
(
fg
);

979 
fg_g
 = 
	`PIXEL888GREEN
(
fg
);

980 
fg_b
 = 
	`PIXEL888BLUE
(
fg
);

981 
bg
 = 
gc
->
bg_cﬁ‹
;

982 
bg_r
 = 
	`PIXEL888RED
(
bg
);

983 
bg_g
 = 
	`PIXEL888GREEN
(
bg
);

984 
bg_b
 = 
	`PIXEL888BLUE
(
bg
);

986 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

987 
adv™˚_d°
 = (
psd
->
löñí
 - 
gc
->
d°w
) * 3;

989 i‡(
fú°_byã
 !
œ°_byã
) {

993 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

995 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

997 
¥efix_fú°_bô
 = 0;

998 
size_maö
++;

1000 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

1002 
po°fix_œ°_bô
 = 0;

1003 
size_maö
++;

1005 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

1006 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

1008 
¥efix_fú°_bô
 = 0;

1009 
po°fix_œ°_bô
 = 0;

1010 
size_maö
 = 1;

1014 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

1015 
¥efix_fú°_bô
 = 0;

1016 
size_maö
 = 0;

1019 
DRAWON
;

1021 i‡(
gc
->
gr_u£bg
) {

1022 
y
 = 0; y < 
gc
->
d°h
; y++) {

1025 i‡(
¥efix_fú°_bô
) {

1026 
bôm≠_byã
 = *
§c
++;

1027 
mask
 = 
¥efix_fú°_bô
; mask;

1028 
	`MWI_ADVANCE_BIT
(
mask
)) {

1029 i‡(
mask
 & 
bôm≠_byã
) {

1030 *
d°
++ = 
fg_b
;

1031 *
d°
++ = 
fg_g
;

1032 *
d°
++ = 
fg_r
;

1034 *
d°
++ = 
bg_b
;

1035 *
d°
++ = 
bg_g
;

1036 *
d°
++ = 
bg_r
;

1042 
t
 = 
size_maö
;Å != 0;Å--) {

1043 
bôm≠_byã
 = *
§c
++;

1045 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
) {

1046 *
d°
++ = 
fg_b
;

1047 *
d°
++ = 
fg_g
;

1048 *
d°
++ = 
fg_r
;

1050 *
d°
++ = 
bg_b
;

1051 *
d°
++ = 
bg_g
;

1052 *
d°
++ = 
bg_r
;

1054 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
) {

1055 *
d°
++ = 
fg_b
;

1056 *
d°
++ = 
fg_g
;

1057 *
d°
++ = 
fg_r
;

1059 *
d°
++ = 
bg_b
;

1060 *
d°
++ = 
bg_g
;

1061 *
d°
++ = 
bg_r
;

1063 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
) {

1064 *
d°
++ = 
fg_b
;

1065 *
d°
++ = 
fg_g
;

1066 *
d°
++ = 
fg_r
;

1068 *
d°
++ = 
bg_b
;

1069 *
d°
++ = 
bg_g
;

1070 *
d°
++ = 
bg_r
;

1072 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
) {

1073 *
d°
++ = 
fg_b
;

1074 *
d°
++ = 
fg_g
;

1075 *
d°
++ = 
fg_r
;

1077 *
d°
++ = 
bg_b
;

1078 *
d°
++ = 
bg_g
;

1079 *
d°
++ = 
bg_r
;

1081 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
) {

1082 *
d°
++ = 
fg_b
;

1083 *
d°
++ = 
fg_g
;

1084 *
d°
++ = 
fg_r
;

1086 *
d°
++ = 
bg_b
;

1087 *
d°
++ = 
bg_g
;

1088 *
d°
++ = 
bg_r
;

1090 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
) {

1091 *
d°
++ = 
fg_b
;

1092 *
d°
++ = 
fg_g
;

1093 *
d°
++ = 
fg_r
;

1095 *
d°
++ = 
bg_b
;

1096 *
d°
++ = 
bg_g
;

1097 *
d°
++ = 
bg_r
;

1099 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
) {

1100 *
d°
++ = 
fg_b
;

1101 *
d°
++ = 
fg_g
;

1102 *
d°
++ = 
fg_r
;

1104 *
d°
++ = 
bg_b
;

1105 *
d°
++ = 
bg_g
;

1106 *
d°
++ = 
bg_r
;

1108 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
) {

1109 *
d°
++ = 
fg_b
;

1110 *
d°
++ = 
fg_g
;

1111 *
d°
++ = 
fg_r
;

1113 *
d°
++ = 
bg_b
;

1114 *
d°
++ = 
bg_g
;

1115 *
d°
++ = 
bg_r
;

1120 i‡(
po°fix_œ°_bô
) {

1121 
bôm≠_byã
 = *
§c
++;

1122 
mask
 = 
po°fix_fú°_bô
;

1123 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1124 
po°fix_œ°_bô
);

1125 
	`MWI_ADVANCE_BIT
(
mask
)) {

1126 i‡(
mask
 & 
bôm≠_byã
) {

1127 *
d°
++ = 
fg_b
;

1128 *
d°
++ = 
fg_g
;

1129 *
d°
++ = 
fg_r
;

1131 *
d°
++ = 
bg_b
;

1132 *
d°
++ = 
bg_g
;

1133 *
d°
++ = 
bg_r
;

1138 
§c
 +
adv™˚_§c
;

1139 
d°
 +
adv™˚_d°
;

1142 
y
 = 0; y < 
gc
->
d°h
; y++) {

1145 i‡(
¥efix_fú°_bô
) {

1146 
bôm≠_byã
 = *
§c
++;

1147 
mask
 = 
¥efix_fú°_bô
; mask;

1148 
	`MWI_ADVANCE_BIT
(
mask
)) {

1149 i‡(
mask
 & 
bôm≠_byã
) {

1150 
d°
[0] = 
fg_b
;

1151 
d°
[1] = 
fg_g
;

1152 
d°
[2] = 
fg_r
;

1154 
d°
 += 3;

1159 
t
 = 
size_maö
;Å != 0;Å--) {

1160 
bôm≠_byã
 = *
§c
++;

1162 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
) {

1163 
d°
[0 * 3 + 0] = 
fg_b
;

1164 
d°
[0 * 3 + 1] = 
fg_g
;

1165 
d°
[0 * 3 + 2] = 
fg_r
;

1167 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
) {

1168 
d°
[1 * 3 + 0] = 
fg_b
;

1169 
d°
[1 * 3 + 1] = 
fg_g
;

1170 
d°
[1 * 3 + 2] = 
fg_r
;

1172 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
) {

1173 
d°
[2 * 3 + 0] = 
fg_b
;

1174 
d°
[2 * 3 + 1] = 
fg_g
;

1175 
d°
[2 * 3 + 2] = 
fg_r
;

1177 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
) {

1178 
d°
[3 * 3 + 0] = 
fg_b
;

1179 
d°
[3 * 3 + 1] = 
fg_g
;

1180 
d°
[3 * 3 + 2] = 
fg_r
;

1182 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
) {

1183 
d°
[4 * 3 + 0] = 
fg_b
;

1184 
d°
[4 * 3 + 1] = 
fg_g
;

1185 
d°
[4 * 3 + 2] = 
fg_r
;

1187 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
) {

1188 
d°
[5 * 3 + 0] = 
fg_b
;

1189 
d°
[5 * 3 + 1] = 
fg_g
;

1190 
d°
[5 * 3 + 2] = 
fg_r
;

1192 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
) {

1193 
d°
[6 * 3 + 0] = 
fg_b
;

1194 
d°
[6 * 3 + 1] = 
fg_g
;

1195 
d°
[6 * 3 + 2] = 
fg_r
;

1197 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
) {

1198 
d°
[7 * 3 + 0] = 
fg_b
;

1199 
d°
[7 * 3 + 1] = 
fg_g
;

1200 
d°
[7 * 3 + 2] = 
fg_r
;

1202 
d°
 += 8 * 3;

1206 i‡(
po°fix_œ°_bô
) {

1207 
bôm≠_byã
 = *
§c
++;

1208 
mask
 = 
po°fix_fú°_bô
;

1209 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1210 
po°fix_œ°_bô
);

1211 
	`MWI_ADVANCE_BIT
(
mask
)) {

1212 i‡(
mask
 & 
bôm≠_byã
) {

1213 
d°
[0] = 
fg_b
;

1214 
d°
[1] = 
fg_g
;

1215 
d°
[2] = 
fg_r
;

1217 
d°
 += 3;

1221 
§c
 +
adv™˚_§c
;

1222 
d°
 +
adv™˚_d°
;

1226 
DRAWOFF
;

1228 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


1229 #unde‡
MWI_ADVANCE_BIT


1230 #unde‡
MWI_BIT_NO


1231 #unde‡
MWI_FIRST_BIT


1232 #unde‡
MWI_LAST_BIT


1233 
	}
}

1236 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1238 
	$löór24_døw¨ó_Æphacﬁ
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1240 
ADDR8
 
d°
;

1241 
ADDR8
 
Æpha
;

1242 
ps
, 
pd
;

1243 
as
;

1244 
p§
, 
psg
, 
psb
;

1245 
x
, 
y
;

1246 
§c_row_°ï
, 
d°_row_°ï
;

1248 
Æpha
 = ((
ADDR8
Ë
gc
->
misc
Ë+ gc->
§c_löñí
 * gc->
§cy
 + gc->
§cx
;

1249 
d°
 = ((
ADDR8
Ë
psd
->
addr
Ë+ (psd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
) * 3;

1250 
ps
 = 
gc
->
fg_cﬁ‹
;

1251 
p§
 = 
	`PIXEL888RED
(
ps
);

1252 
psg
 = 
	`PIXEL888GREEN
(
ps
);

1253 
psb
 = 
	`PIXEL888BLUE
(
ps
);

1255 
§c_row_°ï
 = 
gc
->
§c_löñí
 - gc->
d°w
;

1256 
d°_row_°ï
 = (
psd
->
löñí
 - 
gc
->
d°w
) * 3;

1258 
DRAWON
;

1259 
y
 = 0; y < 
gc
->
d°h
; y++) {

1260 
x
 = 0; x < 
gc
->
d°w
; x++) {

1261 
as
 = *
Æpha
++;

1262 i‡(
as
 == 255) {

1263 *
d°
++ = 
psb
;

1264 *
d°
++ = 
psg
;

1265 *
d°
++ = 
p§
;

1266 } i‡(
as
 != 0) {

1271 
as
 += (as >> 7);

1273 
pd
 = *
d°
;

1274 *
d°
++ = (

1275 Ë((((
psb
 - 
pd
Ë* 
as
) >> 8) +

1276 
pd
);

1277 
pd
 = *
d°
;

1278 *
d°
++ = (

1279 Ë((((
psg
 - 
pd
Ë* 
as
) >> 8) +

1280 
pd
);

1281 
pd
 = *
d°
;

1282 *
d°
++ = (

1283 Ë((((
p§
 - 
pd
Ë* 
as
) >> 8) +

1284 
pd
);

1286 
d°
 += 3;

1289 
Æpha
 +
§c_row_°ï
;

1290 
d°
 +
d°_row_°ï
;

1292 
DRAWOFF
;

1293 
	}
}

1297 
	$löór24_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1299 
	`as£π
(
psd
->
addr
 != 0);

1301 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x + gc->
d°w
 <
psd
->
xªs
);

1304 
	`as£π
(
gc
->
§cy
 >= 0);

1307 
›
) {

1309 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1310 
PSDOP_ALPHACOL
:

1311 
	`löór24_døw¨ó_Æphacﬁ
(
psd
, 
gc
);

1315 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


1316 
PSDOP_BITMAP_BYTES_LSB_FIRST
:

1317 
	`löór24_døw¨ó_bôm≠_byãs_lsb_fú°
(
psd
, 
gc
);

1321 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


1322 
PSDOP_BITMAP_BYTES_MSB_FIRST
:

1323 
	`löór24_døw¨ó_bôm≠_byãs_msb_fú°
(
psd
, 
gc
);

1328 
	}
}

1330 
SUBDRIVER
 
	gfblöór24
 = {

1331 
löór24_öô
,

1332 
löór24_døwpixñ
,

1333 
löór24_ªadpixñ
,

1334 
löór24_døwh‹zlöe
,

1335 
löór24_døwvîéöe
,

1336 
gí_fûÃe˘
,

1337 
löór24_blô
,

1338 
löór24_døw¨ó
,

1339 
löór24_°ªtchblô
,

1340 
löór24_°ªtchblôex
,

	@drivers/fblin2rev.c

10 
	~<as£π.h
>

11 
	~<°rög.h
>

12 
	~"devi˚.h
"

13 
	~"fb.h
"

15 
	gnŸmask
[4] = { 0xfc, 0xf3, 0xcf, 0x3f };

19 
	$löór2_öô
(
PSD
 
psd
)

21 i‡(!
psd
->
size
)

22 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

25 
	}
}

29 
	$löór2_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

31 
ADDR8
 
addr
 = 
psd
->addr;

33 
	`as£π
 (
addr
 != 0);

34 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

35 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

36 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

38 
DRAWON
;

39 
addr
 +(
x
>>2Ë+ 
y
 * 
psd
->
löñí
;

40 if(
gr_mode
 =
MWMODE_XOR
)

41 *
addr
 ^
c
 << ((
x
&3)<<1);

43 *
addr
 = (*add∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((x&3)<<1));

44 
DRAWOFF
;

45 
	}
}

48 
MWPIXELVAL


49 
	$löór2_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

51 
ADDR8
 
addr
 = 
psd
->addr;

53 
	`as£π
 (
addr
 != 0);

54 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

55 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

57  (
addr
[(
x
>>2Ë+ 
y
 * 
psd
->
löñí
] >> ((x&3)<<1) ) & 0x03;

58 
	}
}

62 
	$löór2_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

64 
ADDR8
 
addr
 = 
psd
->addr;

66 
	`as£π
 (
addr
 != 0);

67 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

68 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

69 
	`as£π
 (
x2
 >
x1
);

70 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

71 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

73 
DRAWON
;

74 
addr
 +(
x1
>>2Ë+ 
y
 * 
psd
->
löñí
;

75 if(
gr_mode
 =
MWMODE_XOR
) {

76 
x1
 <
x2
) {

77 *
addr
 ^
c
 << ((
x1
&3)<<1);

78 if((++
x1
 & 3) == 0)

79 ++
addr
;

82 
x1
 <
x2
) {

83 *
addr
 = (*add∏& 
nŸmask
[
x1
&3]Ë| (
c
 << ((x1&3)<<1));

84 if((++
x1
 & 3) == 0)

85 ++
addr
;

88 
DRAWOFF
;

89 
	}
}

93 
	$löór2_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

95 
ADDR8
 
addr
 = 
psd
->addr;

96 
löñí
 = 
psd
->linelen;

98 
	`as£π
 (
addr
 != 0);

99 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

100 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

101 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

102 
	`as£π
 (
y2
 >
y1
);

103 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

105 
DRAWON
;

106 
addr
 +(
x
>>2Ë+ 
y1
 * 
löñí
;

107 if(
gr_mode
 =
MWMODE_XOR
)

108 
y1
++ <
y2
) {

109 *
addr
 ^
c
 << ((
x
&3)<<1);

110 
addr
 +
löñí
;

113 
y1
++ <
y2
) {

114 *
addr
 = (*add∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((x&3)<<1));

115 
addr
 +
löñí
;

117 
DRAWOFF
;

118 
	}
}

122 
	$löór2_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

123 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

125 
ADDR8
 
d°
;

126 
ADDR8
 
§c
;

127 
i
;

128 
dlöñí
 = 
d°psd
->
löñí
;

129 
¶öñí
 = 
§˝sd
->
löñí
;

131 
	`as£π
 (
d°psd
->
addr
 != 0);

132 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

133 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

134 
	`as£π
 (
w
 > 0);

135 
	`as£π
 (
h
 > 0);

136 
	`as£π
 (
§˝sd
->
addr
 != 0);

137 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

138 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

139 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

140 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

141 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

142 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

144 
DRAWON
;

145 
d°
 = 
d°psd
->
addr
 + (
d°x
>>2Ë+ 
d°y
 * 
dlöñí
;

146 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>2Ë+ 
§cy
 * 
¶öñí
;

147 --
h
 >= 0) {

148 
ADDR8
 
d
 = 
d°
;

149 
ADDR8
 
s
 = 
§c
;

150 
MWCOORD
 
dx
 = 
d°x
;

151 
MWCOORD
 
sx
 = 
§cx
;

152 
i
=0; i<
w
; ++i) {

153 *
d
 = (*d & 
nŸmask
[
dx
&3]) |

154 ((*
s
 >> ((
sx
&3)<<1Ë& 0x03Ë<< ((
dx
&3)<<1));

155 if((++
dx
 & 3) == 0)

156 ++
d
;

157 if((++
sx
 & 3) == 0)

158 ++
s
;

160 
d°
 +
dlöñí
;

161 
§c
 +
¶öñí
;

163 
DRAWOFF
;

164 
	}
}

166 
SUBDRIVER
 
	gfblöór2
 = {

167 
löór2_öô
,

168 
löór2_døwpixñ
,

169 
löór2_ªadpixñ
,

170 
löór2_døwh‹zlöe
,

171 
löór2_døwvîéöe
,

172 
gí_fûÃe˘
,

173 
löór2_blô


	@drivers/fblin32.c

10 
	~<as£π.h
>

11 
	~<°rög.h
>

12 
	~"devi˚.h
"

13 
	~"fb.h
"

17 
	$löór32_öô
(
PSD
 
psd
)

19 i‡(!
psd
->
size
) {

20 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

22 
psd
->
löñí
 /= 4;

25 
	}
}

29 
	$löór32_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

31 
ADDR32
 
addr
 = 
psd
->addr;

33 
	`as£π
 (
addr
 != 0);

34 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

35 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

36 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

38 
DRAWON
;

39 i‡(
gr_mode
 =
MWMODE_COPY
)

40 
addr
[
x
 + 
y
 * 
psd
->
löñí
] = 
c
;

42 
	`≠∂yOp
(
gr_mode
, 
c
, &
addr
[
x
 + 
y
 * 
psd
->
löñí
], 
ADDR32
);

43 
DRAWOFF
;

44 
	}
}

47 
MWPIXELVAL


48 
	$löór32_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

50 
ADDR32
 
addr
 = 
psd
->addr;

52 
	`as£π
 (
addr
 != 0);

53 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

54 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

56  
addr
[
x
 + 
y
 * 
psd
->
löñí
];

57 
	}
}

61 
	$löór32_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

63 
ADDR32
 
addr
 = 
psd
->addr;

65 
	`as£π
 (
addr
 != 0);

66 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

67 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

68 
	`as£π
 (
x2
 >
x1
);

69 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

70 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

72 
DRAWON
;

73 
addr
 +
x1
 + 
y
 * 
psd
->
löñí
;

74 if(
gr_mode
 =
MWMODE_COPY
) {

76 
x1
++ <
x2
)

77 *
addr
++ = 
c
;

79 
x1
++ <
x2
) {

80 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR32
);

81 ++
addr
;

84 
DRAWOFF
;

85 
	}
}

89 
	$löór32_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

91 
ADDR32
 
addr
 = 
psd
->addr;

92 
löñí
 = 
psd
->linelen;

94 
	`as£π
 (
addr
 != 0);

95 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

96 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

97 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

98 
	`as£π
 (
y2
 >
y1
);

99 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

101 
DRAWON
;

102 
addr
 +
x
 + 
y1
 * 
löñí
;

103 if(
gr_mode
 =
MWMODE_COPY
) {

104 
y1
++ <
y2
) {

105 *
addr
 = 
c
;

106 
addr
 +
löñí
;

109 
y1
++ <
y2
) {

110 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR32
);

111 
addr
 +
löñí
;

114 
DRAWOFF
;

115 
	}
}

119 
	$löór32_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

120 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

122 
ADDR8
 
d°8
, 
§c8
;

123 
ADDR32
 
d°
 = 
d°psd
->
addr
;

124 
ADDR32
 
§c
 = 
§˝sd
->
addr
;

125 
i
;

126 
dlöñí
 = 
d°psd
->
löñí
;

127 
¶öñí
 = 
§˝sd
->
löñí
;

128 
dlöñí_möus_w4
;

129 
¶öñí_möus_w4
;

130 #i‡
ALPHABLEND


131 
Æpha
;

134 
	`as£π
 (
d°
 != 0);

135 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

136 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

137 
	`as£π
 (
w
 > 0);

138 
	`as£π
 (
h
 > 0);

139 
	`as£π
 (
§c
 != 0);

140 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

141 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

142 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

143 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

144 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

145 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

147 
DRAWON
;

148 
d°
 +
d°x
 + 
d°y
 * 
dlöñí
;

149 
§c
 +
§cx
 + 
§cy
 * 
¶öñí
;

151 #i‡
ALPHABLEND


152 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

153 
°dblô
;

154 
Æpha
 = 
›
 & 0xff;

156 
§c8
 = (
ADDR8
)
§c
;

157 
d°8
 = (
ADDR8
)
d°
;

158 
dlöñí_möus_w4
 = (
dlöñí
 - 
w
) * 4;

159 
¶öñí_möus_w4
 = (
¶öñí
 - 
w
) * 4;

160 --
h
 >= 0) {

161 
i
=0; i<
w
; ++i) {

166 
s
 = *
§c8
++;

167 
d
 = *
d°8
;

168 *
d°8
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

169 
s
 = *
§c8
++;

170 
d
 = *
d°8
;

171 *
d°8
++ = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

172 
s
 = *
§c8
;

173 
d
 = *
d°8
;

174 *
d°8
 = ()(((
s
 - 
d
)*
Æpha
)>>8) + d;

175 
d°8
 += 2;

176 
§c8
 += 2;

178 
d°8
 +
dlöñí_möus_w4
;

179 
§c8
 +
¶öñí_möus_w4
;

181 
DRAWOFF
;

183 
°dblô
:

186 i‡(
›
 =
MWROP_COPY
) {

189 i‡(
§cy
 < 
d°y
) {

190 
§c
 +(
h
-1Ë* 
¶öñí
;

191 
d°
 +(
h
-1Ë* 
dlöñí
;

192 
¶öñí
 *= -1;

193 
dlöñí
 *= -1;

195 --
h
 >= 0) {

197 
	`memmove
(
d°
, 
§c
, 
w
<<2);

198 
d°
 +
dlöñí
;

199 
§c
 +
¶öñí
;

202 
i
=0; i < 
w
; ++i) {

203 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c
, 
d°
, 
ADDR32
);

204 ++
§c
;

205 ++
d°
;

207 
d°
 +
dlöñí
 - 
w
;

208 
§c
 +
¶öñí
 - 
w
;

210 
DRAWOFF
;

211 
	}
}

215 
	$löór32_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

216 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

217 
MWCOORD
 
§ch
, 
›
)

219 
ADDR32
 
d°
;

220 
ADDR32
 
§c
;

221 
dlöñí
 = 
d°psd
->
löñí
;

222 
¶öñí
 = 
§˝sd
->
löñí
;

223 
i
, 
ymax
;

224 
row_pos
, 
row_öc
;

225 
cﬁ_pos
, 
cﬁ_öc
;

226 
pixñ
 = 0;

228 
	`as£π
 (
d°psd
->
addr
 != 0);

229 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

230 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

231 
	`as£π
 (
d°w
 > 0);

232 
	`as£π
 (
d°h
 > 0);

233 
	`as£π
 (
§˝sd
->
addr
 != 0);

234 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

235 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

236 
	`as£π
 (
§cw
 > 0);

237 
	`as£π
 (
§ch
 > 0);

238 
	`as£π
 (
d°x
+
d°w
 <
d°psd
->
xªs
);

239 
	`as£π
 (
d°y
+
d°h
 <
d°psd
->
yªs
);

240 
	`as£π
 (
§cx
+
§cw
 <
§˝sd
->
xªs
);

241 
	`as£π
 (
§cy
+
§ch
 <
§˝sd
->
yªs
);

243 
DRAWON
;

244 
row_pos
 = 0x10000;

245 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

248 
ymax
 = 
d°y
+
d°h
; dsty<ymax; ++dsty) {

251 
row_pos
 >= 0x10000L) {

252 ++
§cy
;

253 
row_pos
 -= 0x10000L;

256 
d°
 = (
ADDR32
)
d°psd
->
addr
 + 
d°x
 + 
d°y
*
dlöñí
;

257 
§c
 = (
ADDR32
)
§˝sd
->
addr
 + 
§cx
 + (
§cy
-1)*
¶öñí
;

260 
cﬁ_pos
 = 0x10000;

261 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

262 
i
=0; i<
d°w
; ++i) {

264 
cﬁ_pos
 >= 0x10000L) {

265 
pixñ
 = *
§c
++;

266 
cﬁ_pos
 -= 0x10000L;

268 *
d°
++ = 
pixñ
;

269 
cﬁ_pos
 +
cﬁ_öc
;

272 
row_pos
 +
row_öc
;

274 
DRAWOFF
;

275 
	}
}

289 #i‚de‡
RESTRICT


290 
	#RESTRICT


	)

292 #i‚de‡
SIGN


293 
	#SIGN
(
x
Ë(((xË> 0Ë? 1 : (((xË=0Ë? 0 : -1))

	)

295 #i‚de‡
ABS


296 
	#ABS
(
x
Ë(((xË>0Ë? (xË: -(x))

	)

332 
	$löór32_°ªtchblôex
(
PSD
 
d°psd
,

333 
PSD
 
§˝sd
,

334 
MWCOORD
 
de°_x_°¨t
,

335 
MWCOORD
 
de°_y_°¨t
,

336 
MWCOORD
 
width
,

337 
MWCOORD
 
height
,

338 
x_díomö©‹
,

339 
y_díomö©‹
,

340 
§c_x_‰a˘i⁄
,

341 
§c_y_‰a˘i⁄
,

342 
x_°ï_‰a˘i⁄
,

343 
y_°ï_‰a˘i⁄
,

344 
›
)

347 *
RESTRICT
 
§c_±r
;

350 *
RESTRICT
 
√xt_§c_±r
;

353 *
RESTRICT
 
de°_±r
;

356 *
√xt_de°_±r
;

359 
x_îr‹
;

360 
y_îr‹
;

365 
§c_x_°ï_⁄e
;

366 
§c_y_°ï_⁄e
;

371 
§c_x_°ï_n‹mÆ
;

372 
§c_y_°ï_n‹mÆ
;

377 
x_îr‹_°ï_n‹mÆ
;

378 
y_îr‹_°ï_n‹mÆ
;

381 
x_cou¡
;

382 
y_cou¡
;

385 
§c_x_°¨t
;

386 
§c_y_°¨t
;

389 
x_îr‹_°¨t
;

392 
de°_y_°ï
;

400 
§c_x_‰a˘i⁄
 +(
x_°ï_‰a˘i⁄
 >> 1);

401 
§c_y_‰a˘i⁄
 +(
y_°ï_‰a˘i⁄
 >> 1);

409 
§c_x_°¨t
 = 
§c_x_‰a˘i⁄
 / 
x_díomö©‹
;

410 
§c_y_°¨t
 = 
§c_y_‰a˘i⁄
 / 
y_díomö©‹
;

411 
x_îr‹_°¨t
 = 
§c_x_‰a˘i⁄
 - (
§c_x_°¨t
 + 1Ë* 
x_díomö©‹
;

412 
y_îr‹
 = 
§c_y_‰a˘i⁄
 - (
§c_y_°¨t
 + 1Ë* 
y_díomö©‹
;

416 
§c_x_°ï_n‹mÆ
 = 
x_°ï_‰a˘i⁄
 / 
x_díomö©‹
;

417 
§c_x_°ï_⁄e
 = 
	`SIGN
(
x_°ï_‰a˘i⁄
);

418 
x_îr‹_°ï_n‹mÆ
 =

419 
	`ABS
(
x_°ï_‰a˘i⁄
Ë- ABS(
§c_x_°ï_n‹mÆ
Ë* 
x_díomö©‹
;

421 
§c_y_°ï_n‹mÆ
 = 
y_°ï_‰a˘i⁄
 / 
y_díomö©‹
;

422 
§c_y_°ï_⁄e
 = 
	`SIGN
(
y_°ï_‰a˘i⁄
Ë* 
§˝sd
->
löñí
;

423 
y_îr‹_°ï_n‹mÆ
 =

424 
	`ABS
(
y_°ï_‰a˘i⁄
Ë- ABS(
§c_y_°ï_n‹mÆ
Ë* 
y_díomö©‹
;

425 
§c_y_°ï_n‹mÆ
 *
§˝sd
->
löñí
;

433 
√xt_§c_±r
 =

434 ((*Ë
§˝sd
->
addr
) +

435 
§c_y_°¨t
 * 
§˝sd
->
löñí
 + 
§c_x_°¨t
;

438 
de°_y_°ï
 = 
d°psd
->
löñí
;

441 
√xt_de°_±r
 =

442 ((*Ë
d°psd
->
addr
) +

443 (
de°_y_°¨t
 * 
de°_y_°ï
Ë+ 
de°_x_°¨t
;

453 
›
 & 
MWROP_EXTENSION
) {

454 
MWROP_SRC
:

458 
y_cou¡
 = 
height
;

459 
y_cou¡
-- > 0) {

460 
§c_±r
 = 
√xt_§c_±r
;

461 
de°_±r
 = 
√xt_de°_±r
;

463 
x_îr‹
 = 
x_îr‹_°¨t
;

465 
x_cou¡
 = 
width
;

466 
x_cou¡
-- > 0) {

467 *
de°_±r
++ = *
§c_±r
;

469 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

470 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

472 i‡(
x_îr‹
 >= 0) {

473 
§c_±r
 +
§c_x_°ï_⁄e
;

474 
x_îr‹
 -
x_díomö©‹
;

478 
√xt_de°_±r
 +
de°_y_°ï
;

480 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

481 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

483 i‡(
y_îr‹
 >= 0) {

484 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

485 
y_îr‹
 -
y_díomö©‹
;

490 
MWROP_CLEAR
:

491 
y_cou¡
 = 
height
;

492 
y_cou¡
-- > 0) {

493 
de°_±r
 = 
√xt_de°_±r
;

494 
x_cou¡
 = 
width
;

495 
x_cou¡
-- > 0) {

496 *
de°_±r
++ = 0;

498 
√xt_de°_±r
 +
de°_y_°ï
;

503 
y_cou¡
 = 
height
;

504 
y_cou¡
-- > 0) {

505 
§c_±r
 = 
√xt_§c_±r
;

506 
de°_±r
 = 
√xt_de°_±r
;

508 
x_îr‹
 = 
x_îr‹_°¨t
;

510 
x_cou¡
 = 
width
;

511 
x_cou¡
-- > 0) {

512 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c_±r
, 
de°_±r
, 
ADDR32
);

513 
de°_±r
++;

515 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

516 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

518 i‡(
x_îr‹
 >= 0) {

519 
§c_±r
 +
§c_x_°ï_⁄e
;

520 
x_îr‹
 -
x_díomö©‹
;

524 
√xt_de°_±r
 +
de°_y_°ï
;

526 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

527 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

529 i‡(
y_îr‹
 >= 0) {

530 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

531 
y_îr‹
 -
y_díomö©‹
;

537 
	}
}

539 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


562 
	$löór32_døw¨ó_bôm≠_byãs_lsb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

576 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë<(b))

	)

577 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË<<1)

	)

578 
	#MWI_BIT_NO
(
n
Ë(0x01 << (n))

	)

584 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

585 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

587 
¥efix_fú°_bô
;

588 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

589 
po°fix_œ°_bô
;

590 
bôm≠_byã
;

591 
mask
;

592 
fg
, 
bg
;

593 
fú°_byã
, 
œ°_byã
;

594 
size_maö
;

595 
t
, 
y
;

596 
adv™˚_§c
, 
adv™˚_d°
;

597 
ADDR8
 
§c
;

598 
ADDR32
 
d°
;

601 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

604 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

607 
fú°_byã
 = 
gc
->
§cx
 >> 3;

610 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

612 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

613 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

614 
fg
 = 
gc
->
fg_cﬁ‹
;

615 
bg
 = 
gc
->
bg_cﬁ‹
;

617 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

618 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

620 i‡(
fú°_byã
 !
œ°_byã
) {

624 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

626 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

628 
¥efix_fú°_bô
 = 0;

629 
size_maö
++;

631 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

633 
po°fix_œ°_bô
 = 0;

634 
size_maö
++;

636 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

637 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

639 
¥efix_fú°_bô
 = 0;

640 
po°fix_œ°_bô
 = 0;

641 
size_maö
 = 1;

645 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

646 
¥efix_fú°_bô
 = 0;

647 
size_maö
 = 0;

650 
DRAWON
;

652 i‡(
gc
->
gr_u£bg
) {

653 
y
 = 0; y < 
gc
->
d°h
; y++) {

656 i‡(
¥efix_fú°_bô
) {

657 
bôm≠_byã
 = *
§c
++;

658 
mask
 = 
¥efix_fú°_bô
; mask;

659 
	`MWI_ADVANCE_BIT
(
mask
)) {

660 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

661 
bg
;

666 
t
 = 
size_maö
;Å != 0;Å--) {

667 
bôm≠_byã
 = *
§c
++;

669 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

670 
bg
;

671 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

672 
bg
;

673 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

674 
bg
;

675 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

676 
bg
;

677 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

678 
bg
;

679 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

680 
bg
;

681 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

682 
bg
;

683 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

684 
bg
;

688 i‡(
po°fix_œ°_bô
) {

689 
bôm≠_byã
 = *
§c
++;

690 
mask
 = 
po°fix_fú°_bô
;

691 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

692 
po°fix_œ°_bô
);

693 
	`MWI_ADVANCE_BIT
(
mask
)) {

694 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

695 
bg
;

699 
§c
 +
adv™˚_§c
;

700 
d°
 +
adv™˚_d°
;

703 
y
 = 0; y < 
gc
->
d°h
; y++) {

706 i‡(
¥efix_fú°_bô
) {

707 
bôm≠_byã
 = *
§c
++;

708 
mask
 = 
¥efix_fú°_bô
; mask;

709 
	`MWI_ADVANCE_BIT
(
mask
)) {

710 i‡(
mask
 & 
bôm≠_byã
)

711 *
d°
 = 
fg
;

712 
d°
++;

717 
t
 = 
size_maö
;Å != 0;Å--) {

718 
bôm≠_byã
 = *
§c
++;

720 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

721 
d°
[0] = 
fg
;

722 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

723 
d°
[1] = 
fg
;

724 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

725 
d°
[2] = 
fg
;

726 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

727 
d°
[3] = 
fg
;

728 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

729 
d°
[4] = 
fg
;

730 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

731 
d°
[5] = 
fg
;

732 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

733 
d°
[6] = 
fg
;

734 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

735 
d°
[7] = 
fg
;

737 
d°
 += 8;

741 i‡(
po°fix_œ°_bô
) {

742 
bôm≠_byã
 = *
§c
++;

743 
mask
 = 
po°fix_fú°_bô
;

744 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

745 
po°fix_œ°_bô
);

746 
	`MWI_ADVANCE_BIT
(
mask
)) {

747 i‡(
mask
 & 
bôm≠_byã
)

748 *
d°
 = 
fg
;

749 
d°
++;

753 
§c
 +
adv™˚_§c
;

754 
d°
 +
adv™˚_d°
;

758 
DRAWOFF
;

760 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


761 #unde‡
MWI_ADVANCE_BIT


762 #unde‡
MWI_BIT_NO


763 #unde‡
MWI_FIRST_BIT


764 #unde‡
MWI_LAST_BIT


765 
	}
}

769 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


789 
	$löór32_døw¨ó_bôm≠_byãs_msb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

803 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë>(b))

	)

804 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË>>1)

	)

805 
	#MWI_BIT_NO
(
n
Ë(0x80 >> (n))

	)

811 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

812 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

814 
¥efix_fú°_bô
;

815 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

816 
po°fix_œ°_bô
;

817 
bôm≠_byã
;

818 
mask
;

819 
fg
, 
bg
;

820 
fú°_byã
, 
œ°_byã
;

821 
size_maö
;

822 
t
, 
y
;

823 
adv™˚_§c
, 
adv™˚_d°
;

824 
ADDR8
 
§c
;

825 
ADDR32
 
d°
;

828 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

831 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

834 
fú°_byã
 = 
gc
->
§cx
 >> 3;

837 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

839 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

840 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

841 
fg
 = 
gc
->
fg_cﬁ‹
;

842 
bg
 = 
gc
->
bg_cﬁ‹
;

844 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

845 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

847 i‡(
fú°_byã
 !
œ°_byã
) {

851 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

853 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

855 
¥efix_fú°_bô
 = 0;

856 
size_maö
++;

858 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

860 
po°fix_œ°_bô
 = 0;

861 
size_maö
++;

863 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

864 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

866 
¥efix_fú°_bô
 = 0;

867 
po°fix_œ°_bô
 = 0;

868 
size_maö
 = 1;

872 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

873 
¥efix_fú°_bô
 = 0;

874 
size_maö
 = 0;

877 
DRAWON
;

879 i‡(
gc
->
gr_u£bg
) {

880 
y
 = 0; y < 
gc
->
d°h
; y++) {

883 i‡(
¥efix_fú°_bô
) {

884 
bôm≠_byã
 = *
§c
++;

885 
mask
 = 
¥efix_fú°_bô
; mask;

886 
	`MWI_ADVANCE_BIT
(
mask
)) {

887 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

888 
bg
;

893 
t
 = 
size_maö
;Å != 0;Å--) {

894 
bôm≠_byã
 = *
§c
++;

896 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

897 
bg
;

898 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

899 
bg
;

900 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

901 
bg
;

902 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

903 
bg
;

904 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

905 
bg
;

906 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

907 
bg
;

908 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

909 
bg
;

910 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

911 
bg
;

915 i‡(
po°fix_œ°_bô
) {

916 
bôm≠_byã
 = *
§c
++;

917 
mask
 = 
po°fix_fú°_bô
;

918 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

919 
po°fix_œ°_bô
);

920 
	`MWI_ADVANCE_BIT
(
mask
)) {

921 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

922 
bg
;

926 
§c
 +
adv™˚_§c
;

927 
d°
 +
adv™˚_d°
;

930 
y
 = 0; y < 
gc
->
d°h
; y++) {

933 i‡(
¥efix_fú°_bô
) {

934 
bôm≠_byã
 = *
§c
++;

935 
mask
 = 
¥efix_fú°_bô
; mask;

936 
	`MWI_ADVANCE_BIT
(
mask
)) {

937 i‡(
mask
 & 
bôm≠_byã
)

938 *
d°
 = 
fg
;

939 
d°
++;

944 
t
 = 
size_maö
;Å != 0;Å--) {

945 
bôm≠_byã
 = *
§c
++;

947 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

948 
d°
[0] = 
fg
;

949 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

950 
d°
[1] = 
fg
;

951 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

952 
d°
[2] = 
fg
;

953 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

954 
d°
[3] = 
fg
;

955 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

956 
d°
[4] = 
fg
;

957 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

958 
d°
[5] = 
fg
;

959 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

960 
d°
[6] = 
fg
;

961 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

962 
d°
[7] = 
fg
;

964 
d°
 += 8;

968 i‡(
po°fix_œ°_bô
) {

969 
bôm≠_byã
 = *
§c
++;

970 
mask
 = 
po°fix_fú°_bô
;

971 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

972 
po°fix_œ°_bô
);

973 
	`MWI_ADVANCE_BIT
(
mask
)) {

974 i‡(
mask
 & 
bôm≠_byã
)

975 *
d°
 = 
fg
;

976 
d°
++;

980 
§c
 +
adv™˚_§c
;

981 
d°
 +
adv™˚_d°
;

985 
DRAWOFF
;

987 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


988 #unde‡
MWI_ADVANCE_BIT


989 #unde‡
MWI_BIT_NO


990 #unde‡
MWI_FIRST_BIT


991 #unde‡
MWI_LAST_BIT


992 
	}
}

996 #i‡
MW_FEATURE_PSDOP_ALPHACOL


998 
	$löór32_døw¨ó_Æphacﬁ
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1000 
ADDR32
 
d°
;

1001 
ADDR8
 
Æpha
;

1002 
ps
, 
pd
;

1003 
as
;

1004 
p§
, 
psg
, 
psb
;

1005 
x
, 
y
;

1006 
§c_row_°ï
, 
d°_row_°ï
;

1008 
Æpha
 = ((
ADDR8
Ë
gc
->
misc
Ë+ gc->
§c_löñí
 * gc->
§cy
 + gc->
§cx
;

1009 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1010 
ps
 = 
gc
->
fg_cﬁ‹
;

1011 
p§
 = (Ë(
ps
 & 0x00FF0000UL);

1012 
psg
 = (Ë(
ps
 & 0x0000FF00UL);

1013 
psb
 = (Ë(
ps
 & 0x000000FFUL);

1015 
§c_row_°ï
 = 
gc
->
§c_löñí
 - gc->
d°w
;

1016 
d°_row_°ï
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1018 
DRAWON
;

1019 
y
 = 0; y < 
gc
->
d°h
; y++) {

1020 
x
 = 0; x < 
gc
->
d°w
; x++) {

1021 
as
 = *
Æpha
++;

1022 i‡(
as
 == 255) {

1023 *
d°
++ = 
ps
;

1024 } i‡(
as
 != 0) {

1036 
as
 = 256 - (as + (as >> 7));

1037 
pd
 = *
d°
;

1039 *
d°
++ = ((

1041 (
pd
 & 0x00FF0000UL) -

1042 
p§
Ë* 
as
) >> 8) +

1043 
p§
) & 0x00FF0000UL)

1046 Ë(((((Ë(
pd
 & 0x0000FF00UL)

1047 - 
psg
Ë* 
as
) >> 8) +

1048 
psg
) & 0x0000FF00UL)

1051 Ë(((((Ë(
pd
 & 0x000000FFUL)

1052 - 
psb
Ë* 
as
) >> 8) +

1053 
psb
) & 0x000000FFUL);

1055 
d°
++;

1058 
Æpha
 +
§c_row_°ï
;

1059 
d°
 +
d°_row_°ï
;

1061 
DRAWOFF
;

1062 
	}
}

1066 
	$löór32_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1068 
	`as£π
(
psd
->
addr
 != 0);

1070 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x + gc->
d°w
 <
psd
->
xªs
);

1073 
	`as£π
(
gc
->
§cy
 >= 0);

1076 
›
) {

1078 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1079 
PSDOP_ALPHACOL
:

1080 
	`löór32_døw¨ó_Æphacﬁ
(
psd
, 
gc
);

1084 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


1085 
PSDOP_BITMAP_BYTES_LSB_FIRST
:

1086 
	`löór32_døw¨ó_bôm≠_byãs_lsb_fú°
(
psd
, 
gc
);

1090 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


1091 
PSDOP_BITMAP_BYTES_MSB_FIRST
:

1092 
	`löór32_døw¨ó_bôm≠_byãs_msb_fú°
(
psd
, 
gc
);

1097 
	}
}

1099 
SUBDRIVER
 
	gfblöór32
 = {

1100 
löór32_öô
,

1101 
löór32_døwpixñ
,

1102 
löór32_ªadpixñ
,

1103 
löór32_døwh‹zlöe
,

1104 
löór32_døwvîéöe
,

1105 
gí_fûÃe˘
,

1106 
löór32_blô
,

1107 
löór32_døw¨ó
,

1108 
löór32_°ªtchblô
,

1109 
löór32_°ªtchblôex
,

	@drivers/fblin32alpha.c

18 
	~<as£π.h
>

19 
	~<°rög.h
>

20 
	~"devi˚.h
"

21 
	~"fb.h
"

23 
	tMW_U32
;

24 
	tMW_S32
;

34 #i‡
MW_CPU_BIG_ENDIAN


35 
	#MWI_BYTE_OFFSET_ALPHA
 0

	)

36 
	#MWI_BYTE_OFFSET_R
 1

	)

37 
	#MWI_BYTE_OFFSET_G
 2

	)

38 
	#MWI_BYTE_OFFSET_B
 3

	)

40 
	#MWI_BYTE_OFFSET_ALPHA
 3

	)

41 
	#MWI_BYTE_OFFSET_R
 2

	)

42 
	#MWI_BYTE_OFFSET_G
 1

	)

43 
	#MWI_BYTE_OFFSET_B
 0

	)

48 
	$löór32a_öô
(
PSD
 
psd
)

50 #i‚de‡
NDEBUG


58 
ídün_check
 = 
	`COLOR2PIXEL8888
(
	`MWARGB
(1, 2, 3, 4));

59 
	`as£π
(((*Ë(&
ídün_check
))[
MWI_BYTE_OFFSET_ALPHA
] == 1);

60 
	`as£π
(((*Ë(&
ídün_check
))[
MWI_BYTE_OFFSET_R
] == 2);

61 
	`as£π
(((*Ë(&
ídün_check
))[
MWI_BYTE_OFFSET_G
] == 3);

62 
	`as£π
(((*Ë(&
ídün_check
))[
MWI_BYTE_OFFSET_B
] == 4);

65 i‡(!
psd
->
size
) {

66 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

68 
psd
->
löñí
 /= 4;

71 
	}
}

91 
	$löór32a_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

93 
ADDR32
 
addr
 = 
psd
->addr;

95 
	`as£π
(
addr
 != 0);

96 
	`as£π
(
x
 >0 && x < 
psd
->
xªs
);

97 
	`as£π
(
y
 >0 && y < 
psd
->
yªs
);

99 
addr
 +
x
 + 
y
 * 
psd
->
löñí
;

101 
DRAWON
;

102 i‡(
gr_mode
 =
MWMODE_COPY
) {

103 *
addr
 = 
c
;

104 } i‡(
gr_mode
 <
MWMODE_SIMPLE_MAX
) {

105 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR32
);

107 
MW_S32
 
p§
, 
psg
, 
psb
;

108 
MW_S32
 
pß
, 
pß_öv
;

109 
MW_U32
 
pd
;

111 
pß
 = (((
MW_U32
Ë
c
) >> 24);

113 
gr_mode
) {

114 
MWMODE_SRC_OVER
:

115 i‡(
pß
 == 255) {

116 *
addr
 = 
c
;

117 } i‡(
pß
 != 0) {

118 
pß_öv
 = 256 - 
pß
;

119 
p§
 = (
MW_S32
Ë(
c
 & 0x00FF0000UL);

120 
psg
 = (
MW_S32
Ë(
c
 & 0x0000FF00UL);

121 
psb
 = (
MW_S32
Ë(
c
 & 0x000000FFUL);

123 
pd
 = *
addr
;

124 *
addr
 = ((
MW_U32
)

125 (((((
MW_S32
Ë(
pd
 & 0x00FF0000UL) -

126 
p§
Ë* 
pß_öv
) >> 8) +

127 
p§
) & 0x00FF0000UL)

128 | ((
MW_U32
)

129 (((((
MW_S32
Ë(
pd
 & 0x0000FF00UL) -

130 
psg
Ë* 
pß_öv
) >> 8) +

131 
psg
) & 0x0000FF00UL)

132 | ((
MW_U32
)

133 (((((
MW_S32
Ë(
pd
 & 0x000000FFUL) -

134 
psb
Ë* 
pß_öv
) >> 8) +

135 
psb
) & 0x000000FFUL)

137 (((
pß
 << 24) +

138 ((
pd
 & 0xFF000000UL) >> 8) *

139 (
MW_U32
Ë
pß_öv
) & 0xFF000000UL);

142 
MWMODE_SRC_IN
:

143 
MWMODE_SRC_ATOP
:

144 
MWMODE_DST_OVER
:

145 
MWMODE_DST_IN
:

146 
MWMODE_DST_ATOP
:

147 
MWMODE_SRC_OUT
:

148 
MWMODE_DST_OUT
:

149 
MWMODE_PORTERDUFF_XOR
:

153 
	`as£π
(0);

157 
DRAWOFF
;

158 
	}
}

161 
MWPIXELVAL


162 
	$löór32a_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

164 
ADDR32
 
addr
 = 
psd
->addr;

166 
	`as£π
(
addr
 != 0);

167 
	`as£π
(
x
 >0 && x < 
psd
->
xªs
);

168 
	`as£π
(
y
 >0 && y < 
psd
->
yªs
);

170  
addr
[
x
 + 
y
 * 
psd
->
löñí
];

171 
	}
}

175 
	$löór32a_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
,

176 
MWPIXELVAL
 
c
)

178 
ADDR32
 
addr
 = 
psd
->addr;

180 
	`as£π
(
addr
 != 0);

181 
	`as£π
(
x1
 >0 && x1 < 
psd
->
xªs
);

182 
	`as£π
(
x2
 >0 && x2 < 
psd
->
xªs
);

183 
	`as£π
(
x2
 >
x1
);

184 
	`as£π
(
y
 >0 && y < 
psd
->
yªs
);

186 
addr
 +
x1
 + 
y
 * 
psd
->
löñí
;

188 
DRAWON
;

189 i‡(
gr_mode
 =
MWMODE_COPY
) {

191 
x1
++ <
x2
)

192 *
addr
++ = 
c
;

193 } i‡(
gr_mode
 <
MWMODE_SIMPLE_MAX
) {

194 
x1
++ <
x2
) {

195 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR32
);

196 ++
addr
;

199 
MW_S32
 
p§
, 
psg
, 
psb
;

200 
MW_S32
 
pß
, 
pß_öv
;

201 
MW_U32
 
pd
;

202 
MW_U32
 
ˇche_öput
, 
ˇche_ouçut
;

204 
pß
 = (((
MW_U32
Ë
c
) >> 24);

206 
gr_mode
) {

207 
MWMODE_SRC_OVER
:

208 i‡(
pß
 == 255) {

209 
x1
++ <
x2
)

210 *
addr
++ = 
c
;

211 } i‡(
pß
 != 0) {

212 
pß_öv
 = 256 - 
pß
;

213 
p§
 = (
MW_S32
Ë(
c
 & 0x00FF0000UL);

214 
psg
 = (
MW_S32
Ë(
c
 & 0x0000FF00UL);

215 
psb
 = (
MW_S32
Ë(
c
 & 0x000000FFUL);

217 
pd
 = *
addr
;

218 
ˇche_öput
 = 
pd
;

219 
ˇche_ouçut
 = ((
MW_U32
)

220 (((((
MW_S32
)

221 (
pd
 & 0x00FF0000UL) -

222 
p§
Ë* 
pß_öv
) >> 8) +

223 
p§
) & 0x00FF0000UL)

224 | ((
MW_U32
)

225 (((((
MW_S32
Ë(
pd
 & 0x0000FF00UL) -

226 
psg
Ë* 
pß_öv
) >> 8) +

227 
psg
) & 0x0000FF00UL)

228 | ((
MW_U32
)

229 (((((
MW_S32
Ë(
pd
 & 0x000000FFUL) -

230 
psb
Ë* 
pß_öv
) >> 8) +

231 
psb
) & 0x000000FFUL)

233 (((
pß
 << 24) +

234 ((
pd
 & 0xFF000000UL) >> 8) *

235 ((
MW_U32
Ë
pß_öv
)) & 0xFF000000UL);

236 *
addr
++ = 
ˇche_ouçut
;

238 ++
x1
 <
x2
) {

239 
pd
 = *
addr
;

240 i‡(
ˇche_öput
 !
pd
) {

241 
ˇche_öput
 = 
pd
;

242 
ˇche_ouçut
 = ((
MW_U32
)

243 (((((
MW_S32
)

244 (
pd
 &

247 
p§
) *

248 
pß_öv
) >>

250 
p§
) &

252 | ((
MW_U32
)

253 (((((
MW_S32
)

254 (
pd
 &

257 
psg
) *

258 
pß_öv
) >> 8) +

259 
psg
) &

261 | ((
MW_U32
)

262 (((((
MW_S32
)

263 (
pd
 &

266 
psb
) *

267 
pß_öv
) >> 8) +

268 
psb
) &

271 (((
pß
 << 24) +

272 ((
pd
 & 0xFF000000UL)

274 ((
MW_U32
Ë
pß_öv
))

277 *
addr
++ = 
ˇche_ouçut
;

281 
MWMODE_SRC_IN
:

282 
MWMODE_SRC_ATOP
:

283 
MWMODE_DST_OVER
:

284 
MWMODE_DST_IN
:

285 
MWMODE_DST_ATOP
:

286 
MWMODE_SRC_OUT
:

287 
MWMODE_DST_OUT
:

288 
MWMODE_PORTERDUFF_XOR
:

292 
	`as£π
(0);

295 
DRAWOFF
;

296 
	}
}

300 
	$löór32a_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
,

301 
MWPIXELVAL
 
c
)

303 
ADDR32
 
addr
 = 
psd
->addr;

304 
löñí
 = 
psd
->linelen;

306 
	`as£π
(
addr
 != 0);

307 
	`as£π
(
x
 >0 && x < 
psd
->
xªs
);

308 
	`as£π
(
y1
 >0 && y1 < 
psd
->
yªs
);

309 
	`as£π
(
y2
 >0 && y2 < 
psd
->
yªs
);

310 
	`as£π
(
y2
 >
y1
);

312 
DRAWON
;

313 
addr
 +
x
 + 
y1
 * 
löñí
;

314 i‡(
gr_mode
 =
MWMODE_COPY
) {

315 
y1
++ <
y2
) {

316 *
addr
 = 
c
;

317 
addr
 +
löñí
;

319 } i‡(
gr_mode
 <
MWMODE_SIMPLE_MAX
) {

320 
y1
++ <
y2
) {

321 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR32
);

322 
addr
 +
löñí
;

325 
MW_S32
 
p§
, 
psg
, 
psb
;

326 
MW_S32
 
pß
, 
pß_öv
;

327 
MW_U32
 
pd
;

328 
MW_U32
 
ˇche_öput
, 
ˇche_ouçut
;

330 
pß
 = (((
MW_U32
Ë
c
) >> 24);

332 
gr_mode
) {

333 
MWMODE_SRC_OVER
:

334 i‡(
pß
 == 255) {

335 
y1
++ <
y2
) {

336 *
addr
 = 
c
;

337 
addr
 +
löñí
;

339 } i‡(
pß
 != 0) {

340 
pß_öv
 = 256 - 
pß
;

341 
p§
 = (
MW_S32
Ë(
c
 & 0x00FF0000UL);

342 
psg
 = (
MW_S32
Ë(
c
 & 0x0000FF00UL);

343 
psb
 = (
MW_S32
Ë(
c
 & 0x000000FFUL);

345 
pd
 = *
addr
;

346 
ˇche_öput
 = 
pd
;

347 
ˇche_ouçut
 = ((
MW_U32
)

348 (((((
MW_S32
)

349 (
pd
 & 0x00FF0000UL) -

350 
p§
Ë* 
pß_öv
) >> 8) +

351 
p§
) & 0x00FF0000UL)

352 | ((
MW_U32
)

353 (((((
MW_S32
Ë(
pd
 & 0x0000FF00UL) -

354 
psg
Ë* 
pß_öv
) >> 8) +

355 
psg
) & 0x0000FF00UL)

356 | ((
MW_U32
)

357 (((((
MW_S32
Ë(
pd
 & 0x000000FFUL) -

358 
psb
Ë* 
pß_öv
) >> 8) +

359 
psb
) & 0x000000FFUL)

361 (((
pß
 << 24) +

362 ((
pd
 & 0xFF000000UL) >> 8) *

363 ((
MW_U32
Ë
pß_öv
)) & 0xFF000000UL);

364 *
addr
 = 
ˇche_ouçut
;

365 
addr
 +
löñí
;

367 ++
y1
 <
y2
) {

368 
pd
 = *
addr
;

369 i‡(
ˇche_öput
 !
pd
) {

370 
ˇche_öput
 = 
pd
;

371 
ˇche_ouçut
 = ((
MW_U32
)

372 (((((
MW_S32
)

373 (
pd
 &

376 
p§
) *

377 
pß_öv
) >>

379 
p§
) &

381 | ((
MW_U32
)

382 (((((
MW_S32
)

383 (
pd
 &

386 
psg
) *

387 
pß_öv
) >> 8) +

388 
psg
) &

390 | ((
MW_U32
)

391 (((((
MW_S32
)

392 (
pd
 &

395 
psb
) *

396 
pß_öv
) >> 8) +

397 
psb
) &

400 (((
pß
 << 24) +

401 ((
pd
 & 0xFF000000UL)

403 ((
MW_U32
Ë
pß_öv
))

406 *
addr
 = 
ˇche_ouçut
;

407 
addr
 +
löñí
;

411 
MWMODE_SRC_IN
:

412 
MWMODE_SRC_ATOP
:

413 
MWMODE_DST_OVER
:

414 
MWMODE_DST_IN
:

415 
MWMODE_DST_ATOP
:

416 
MWMODE_SRC_OUT
:

417 
MWMODE_DST_OUT
:

418 
MWMODE_PORTERDUFF_XOR
:

422 
	`as£π
(0);

425 
DRAWOFF
;

426 
	}
}

430 
	$löór32a_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

431 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

433 
ADDR8
 
d°8
, 
§c8
;

434 
ADDR32
 
d°
 = 
d°psd
->
addr
;

435 
ADDR32
 
§c
 = 
§˝sd
->
addr
;

436 
i
;

437 
dlöñí
 = 
d°psd
->
löñí
;

438 
¶öñí
 = 
§˝sd
->
löñí
;

439 
dlöñí_möus_w4
;

440 
¶öñí_möus_w4
;

441 #i‡
ALPHABLEND


442 
Æpha
;

445 
	`as£π
(
d°
 != 0);

446 
	`as£π
(
d°x
 >0 && d°x < 
d°psd
->
xªs
);

447 
	`as£π
(
d°y
 >0 && d°y < 
d°psd
->
yªs
);

448 
	`as£π
(
w
 > 0);

449 
	`as£π
(
h
 > 0);

450 
	`as£π
(
§c
 != 0);

451 
	`as£π
(
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

452 
	`as£π
(
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

453 
	`as£π
(
d°x
 + 
w
 <
d°psd
->
xªs
);

454 
	`as£π
(
d°y
 + 
h
 <
d°psd
->
yªs
);

455 
	`as£π
(
§cx
 + 
w
 <
§˝sd
->
xªs
);

456 
	`as£π
(
§cy
 + 
h
 <
§˝sd
->
yªs
);

458 
DRAWON
;

459 
d°
 +
d°x
 + 
d°y
 * 
dlöñí
;

460 
§c
 +
§cx
 + 
§cy
 * 
¶öñí
;

462 #i‡
ALPHABLEND


463 i‡((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

464 
°dblô
;

465 
Æpha
 = 
›
 & 0xff;

467 
§c8
 = (
ADDR8
Ë
§c
;

468 
d°8
 = (
ADDR8
Ë
d°
;

469 
dlöñí_möus_w4
 = (
dlöñí
 - 
w
) * 4;

470 
¶öñí_möus_w4
 = (
¶öñí
 - 
w
) * 4;

471 --
h
 >= 0) {

472 
i
 = 0; i < 
w
; ++i) {

473 
s
;

474 
d
;

475 
s
 = 
§c8
[
MWI_BYTE_OFFSET_R
];

476 
d
 = 
d°8
[
MWI_BYTE_OFFSET_R
];

477 
d°8
[
MWI_BYTE_OFFSET_R
] =

478 (Ë(((
s
 - 
d
Ë* 
Æpha
) >> 8) + d;

479 
s
 = 
§c8
[
MWI_BYTE_OFFSET_G
];

480 
d
 = 
d°8
[
MWI_BYTE_OFFSET_G
];

481 
d°8
[
MWI_BYTE_OFFSET_G
] =

482 (Ë(((
s
 - 
d
Ë* 
Æpha
) >> 8) + d;

483 
s
 = 
§c8
[
MWI_BYTE_OFFSET_B
];

484 
d
 = 
d°8
[
MWI_BYTE_OFFSET_B
];

485 
d°8
[
MWI_BYTE_OFFSET_B
] =

486 (Ë(((
s
 - 
d
Ë* 
Æpha
) >> 8) + d;

487 
s
 = 
§c8
[
MWI_BYTE_OFFSET_ALPHA
];

488 
d
 = 
d°8
[
MWI_BYTE_OFFSET_ALPHA
];

489 
d°8
[
MWI_BYTE_OFFSET_ALPHA
] =

490 (Ë(((
s
 - 
d
Ë* 
Æpha
) >> 8) + d;

491 
d°8
 += 4;

492 
§c8
 += 4;

494 
d°8
 +
dlöñí_möus_w4
;

495 
§c8
 +
¶öñí_möus_w4
;

497 
DRAWOFF
;

499 
°dblô
:

502 i‡(
›
 =
MWROP_COPY
) {

505 i‡(
§cy
 < 
d°y
) {

506 
§c
 +(
h
 - 1Ë* 
¶öñí
;

507 
d°
 +(
h
 - 1Ë* 
dlöñí
;

508 
¶öñí
 *= -1;

509 
dlöñí
 *= -1;

511 --
h
 >= 0) {

513 
	`memmove
(
d°
, 
§c
, 
w
 << 2);

514 
d°
 +
dlöñí
;

515 
§c
 +
¶öñí
;

517 } i‡(
	`MWROP_TO_MODE
(
›
Ë<
MWMODE_SIMPLE_MAX
) {

518 
i
 = 0; i < 
w
; ++i) {

519 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c
, 
d°
, 
ADDR32
);

520 ++
§c
;

521 ++
d°
;

523 
d°
 +
dlöñí
 - 
w
;

524 
§c
 +
¶öñí
 - 
w
;

525 } i‡(
	`MWROP_TO_MODE
(
›
Ë=
MWMODE_SRC_OVER
) {

527 
§c8
 = (
ADDR8
Ë
§c
;

528 
d°8
 = (
ADDR8
Ë
d°
;

529 
h
--) {

530 
i
 = 
w
; --i >= 0;) {

531 
a
;

532 
s
;

533 
d
;

534 
a
 = () ()

535 
§c8
[
MWI_BYTE_OFFSET_ALPHA
];

536 i‡(
a
 == 255) {

537 
d°8
[0] = 
§c8
[0];

538 
d°8
[1] = 
§c8
[1];

539 
d°8
[2] = 
§c8
[2];

540 
d°8
[
MWI_BYTE_OFFSET_ALPHA
] = 
a
;

541 } i‡(
a
 != 0) {

542 
s
 = () ()

543 
§c8
[
MWI_BYTE_OFFSET_R
];

544 
d
 = () ()

545 
d°8
[
MWI_BYTE_OFFSET_R
];

546 
d°8
[
MWI_BYTE_OFFSET_R
] =

548 Ë((((
s
 - 
d
Ë* 
a
) >> 8) +

549 
d
);

551 
s
 = () ()

552 
§c8
[
MWI_BYTE_OFFSET_G
];

553 
d
 = () ()

554 
d°8
[
MWI_BYTE_OFFSET_G
];

555 
d°8
[
MWI_BYTE_OFFSET_G
] =

557 Ë((((
s
 - 
d
Ë* 
a
) >> 8) +

558 
d
);

560 
s
 = () ()

561 
§c8
[
MWI_BYTE_OFFSET_B
];

562 
d
 = () ()

563 
d°8
[
MWI_BYTE_OFFSET_B
];

564 
d°8
[
MWI_BYTE_OFFSET_B
] =

566 Ë((((
s
 - 
d
Ë* 
a
) >> 8) +

567 
d
);

569 
d
 = () ()

570 
d°8
[
MWI_BYTE_OFFSET_ALPHA
];

571 
d°8
[
MWI_BYTE_OFFSET_ALPHA
] =

572 (
a
 + ((
d
 * (256 -á)) >> 8));

574 
§c8
 += 4;

575 
d°8
 += 4;

577 
d°8
 +(
dlöñí
 - 
w
) * 4;

578 
§c8
 +(
¶öñí
 - 
w
) * 4;

583 
DRAWOFF
;

584 
	}
}

588 
	$löór32a_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

589 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
,

590 
MWCOORD
 
§cw
, MWCOORD 
§ch
, 
›
)

592 
ADDR32
 
d°
;

593 
ADDR32
 
§c
;

594 
dlöñí
 = 
d°psd
->
löñí
;

595 
¶öñí
 = 
§˝sd
->
löñí
;

596 
i
, 
ymax
;

597 
row_pos
, 
row_öc
;

598 
cﬁ_pos
, 
cﬁ_öc
;

599 
pixñ
 = 0;

601 
	`as£π
(
d°psd
->
addr
 != 0);

602 
	`as£π
(
d°x
 >0 && d°x < 
d°psd
->
xªs
);

603 
	`as£π
(
d°y
 >0 && d°y < 
d°psd
->
yªs
);

604 
	`as£π
(
d°w
 > 0);

605 
	`as£π
(
d°h
 > 0);

606 
	`as£π
(
§˝sd
->
addr
 != 0);

607 
	`as£π
(
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

608 
	`as£π
(
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

609 
	`as£π
(
§cw
 > 0);

610 
	`as£π
(
§ch
 > 0);

611 
	`as£π
(
d°x
 + 
d°w
 <
d°psd
->
xªs
);

612 
	`as£π
(
d°y
 + 
d°h
 <
d°psd
->
yªs
);

613 
	`as£π
(
§cx
 + 
§cw
 <
§˝sd
->
xªs
);

614 
	`as£π
(
§cy
 + 
§ch
 <
§˝sd
->
yªs
);

616 
DRAWON
;

617 
row_pos
 = 0x10000;

618 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

621 
ymax
 = 
d°y
 + 
d°h
; dsty < ymax; ++dsty) {

624 
row_pos
 >= 0x10000L) {

625 ++
§cy
;

626 
row_pos
 -= 0x10000L;

629 
d°
 = (
ADDR32
Ë
d°psd
->
addr
 + 
d°x
 + 
d°y
 * 
dlöñí
;

630 
§c
 = (
ADDR32
Ë
§˝sd
->
addr
 + 
§cx
 + (
§cy
 - 1Ë* 
¶öñí
;

633 
cﬁ_pos
 = 0x10000;

634 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

635 
i
 = 0; i < 
d°w
; ++i) {

637 
cﬁ_pos
 >= 0x10000L) {

638 
pixñ
 = *
§c
++;

639 
cﬁ_pos
 -= 0x10000L;

641 *
d°
++ = 
pixñ
;

642 
cﬁ_pos
 +
cﬁ_öc
;

645 
row_pos
 +
row_öc
;

647 
DRAWOFF
;

648 
	}
}

661 #i‚de‡
RESTRICT


662 
	#RESTRICT


	)

664 #i‚de‡
SIGN


665 
	#SIGN
(
x
Ë(((xË> 0Ë? 1 : (((xË=0Ë? 0 : -1))

	)

667 #i‚de‡
ABS


668 
	#ABS
(
x
Ë(((xË>0Ë? (xË: -(x))

	)

704 
	$löór32a_°ªtchblôex
(
PSD
 
d°psd
,

705 
PSD
 
§˝sd
,

706 
MWCOORD
 
de°_x_°¨t
,

707 
MWCOORD
 
de°_y_°¨t
,

708 
MWCOORD
 
width
,

709 
MWCOORD
 
height
,

710 
x_díomö©‹
,

711 
y_díomö©‹
,

712 
§c_x_‰a˘i⁄
,

713 
§c_y_‰a˘i⁄
,

714 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
)

717 *
RESTRICT
 
§c_±r
;

720 *
RESTRICT
 
√xt_§c_±r
;

723 *
RESTRICT
 
de°_±r
;

726 *
√xt_de°_±r
;

729 
x_îr‹
;

730 
y_îr‹
;

735 
§c_x_°ï_⁄e
;

736 
§c_y_°ï_⁄e
;

741 
§c_x_°ï_n‹mÆ
;

742 
§c_y_°ï_n‹mÆ
;

747 
x_îr‹_°ï_n‹mÆ
;

748 
y_îr‹_°ï_n‹mÆ
;

751 
x_cou¡
;

752 
y_cou¡
;

755 
§c_x_°¨t
;

756 
§c_y_°¨t
;

759 
x_îr‹_°¨t
;

762 
de°_y_°ï
;

770 
§c_x_‰a˘i⁄
 +(
x_°ï_‰a˘i⁄
 >> 1);

771 
§c_y_‰a˘i⁄
 +(
y_°ï_‰a˘i⁄
 >> 1);

779 
§c_x_°¨t
 = 
§c_x_‰a˘i⁄
 / 
x_díomö©‹
;

780 
§c_y_°¨t
 = 
§c_y_‰a˘i⁄
 / 
y_díomö©‹
;

781 
x_îr‹_°¨t
 = 
§c_x_‰a˘i⁄
 - (
§c_x_°¨t
 + 1Ë* 
x_díomö©‹
;

782 
y_îr‹
 = 
§c_y_‰a˘i⁄
 - (
§c_y_°¨t
 + 1Ë* 
y_díomö©‹
;

786 
§c_x_°ï_n‹mÆ
 = 
x_°ï_‰a˘i⁄
 / 
x_díomö©‹
;

787 
§c_x_°ï_⁄e
 = 
	`SIGN
(
x_°ï_‰a˘i⁄
);

788 
x_îr‹_°ï_n‹mÆ
 =

789 
	`ABS
(
x_°ï_‰a˘i⁄
Ë- ABS(
§c_x_°ï_n‹mÆ
Ë* 
x_díomö©‹
;

791 
§c_y_°ï_n‹mÆ
 = 
y_°ï_‰a˘i⁄
 / 
y_díomö©‹
;

792 
§c_y_°ï_⁄e
 = 
	`SIGN
(
y_°ï_‰a˘i⁄
Ë* 
§˝sd
->
löñí
;

793 
y_îr‹_°ï_n‹mÆ
 =

794 
	`ABS
(
y_°ï_‰a˘i⁄
Ë- ABS(
§c_y_°ï_n‹mÆ
Ë* 
y_díomö©‹
;

795 
§c_y_°ï_n‹mÆ
 *
§˝sd
->
löñí
;

803 
√xt_§c_±r
 =

804 ((*Ë
§˝sd
->
addr
) +

805 
§c_y_°¨t
 * 
§˝sd
->
löñí
 + 
§c_x_°¨t
;

808 
de°_y_°ï
 = 
d°psd
->
löñí
;

811 
√xt_de°_±r
 =

812 ((*Ë
d°psd
->
addr
) +

813 (
de°_y_°¨t
 * 
de°_y_°ï
Ë+ 
de°_x_°¨t
;

828 
›
 & 
MWROP_EXTENSION
) {

829 
MWROP_SRC
:

833 
y_cou¡
 = 
height
;

834 
y_cou¡
-- > 0) {

835 
§c_±r
 = 
√xt_§c_±r
;

836 
de°_±r
 = 
√xt_de°_±r
;

838 
x_îr‹
 = 
x_îr‹_°¨t
;

840 
x_cou¡
 = 
width
;

841 
x_cou¡
-- > 0) {

842 *
de°_±r
++ = *
§c_±r
;

844 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

845 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

847 i‡(
x_îr‹
 >= 0) {

848 
§c_±r
 +
§c_x_°ï_⁄e
;

849 
x_îr‹
 -
x_díomö©‹
;

853 
√xt_de°_±r
 +
de°_y_°ï
;

855 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

856 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

858 i‡(
y_îr‹
 >= 0) {

859 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

860 
y_îr‹
 -
y_díomö©‹
;

865 
MWROP_SRC_OVER
:

869 
y_cou¡
 = 
height
;

870 
y_cou¡
-- > 0) {

871 
§c_±r
 = 
√xt_§c_±r
;

872 
de°_±r
 = 
√xt_de°_±r
;

874 
x_îr‹
 = 
x_îr‹_°¨t
;

876 
x_cou¡
 = 
width
;

877 
x_cou¡
-- > 0) {

878 
c
;

879 
‹ig
;

880 
a
;

881 
c
 = *
§c_±r
;

882 
a
 = (
c
 >> 24) & 0xFF;

883 i‡(
a
 == 255) {

884 *
de°_±r
 = 
c
;

885 } i‡(
a
 != 0) {

886 
s
;

887 
d
;

888 
ªsu…
;

890 
‹ig
 = *
de°_±r
;

892 
s
 = ()(
c
 >> 16) & 0xFF;

893 
d
 = ()(
‹ig
 >> 16) & 0xFF;

894 
ªsu…
 = (()((((
s
 - 
d
Ë* 
a
) >> 8) + d) << 16);

896 
s
 = ()(
c
 >> 8) & 0xFF;

897 
d
 = ()(
‹ig
 >> 8) & 0xFF;

898 
ªsu…
 |(()((((
s
 - 
d
Ë* 
a
) >> 8) + d) << 8);

900 
s
 = ()
c
 & 0xFF;

901 
d
 = ()
‹ig
 & 0xFF;

902 
ªsu…
 |(()(((
s
 - 
d
Ë* 
a
) >> 8) + d);

904 
d
 = ()(
‹ig
 >> 24) & 0xFF;

905 
ªsu…
 |(()(
a
 + ((
d
 * (256 -á)) >> 8)) << 24);

906 *
de°_±r
 = 
ªsu…
;

909 
de°_±r
++;

911 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

912 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

914 i‡(
x_îr‹
 >= 0) {

915 
§c_±r
 +
§c_x_°ï_⁄e
;

916 
x_îr‹
 -
x_díomö©‹
;

920 
√xt_de°_±r
 +
de°_y_°ï
;

922 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

923 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

925 i‡(
y_îr‹
 >= 0) {

926 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

927 
y_îr‹
 -
y_díomö©‹
;

932 
MWROP_XOR_FGBG
:

933 
y_cou¡
 = 
height
;

934 
y_cou¡
-- > 0) {

935 
§c_±r
 = 
√xt_§c_±r
;

936 
de°_±r
 = 
√xt_de°_±r
;

938 
x_îr‹
 = 
x_îr‹_°¨t
;

940 
x_cou¡
 = 
width
;

941 
x_cou¡
-- > 0) {

942 *
de°_±r
++ ^*
§c_±r
 ^ 
gr_background
;

944 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

945 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

947 i‡(
x_îr‹
 >= 0) {

948 
§c_±r
 +
§c_x_°ï_⁄e
;

949 
x_îr‹
 -
x_díomö©‹
;

953 
√xt_de°_±r
 +
de°_y_°ï
;

955 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

956 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

958 i‡(
y_îr‹
 >= 0) {

959 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

960 
y_îr‹
 -
y_díomö©‹
;

965 
MWROP_CLEAR
:

966 
y_cou¡
 = 
height
;

967 
y_cou¡
-- > 0) {

968 
de°_±r
 = 
√xt_de°_±r
;

969 
x_cou¡
 = 
width
;

970 
x_cou¡
-- > 0) {

971 *
de°_±r
++ = 0;

973 
√xt_de°_±r
 +
de°_y_°ï
;

978 
y_cou¡
 = 
height
;

979 
y_cou¡
-- > 0) {

980 
§c_±r
 = 
√xt_§c_±r
;

981 
de°_±r
 = 
√xt_de°_±r
;

983 
x_îr‹
 = 
x_îr‹_°¨t
;

985 
x_cou¡
 = 
width
;

986 
x_cou¡
-- > 0) {

987 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c_±r
, 
de°_±r
,

988 
ADDR32
);

989 
de°_±r
++;

991 
§c_±r
 +
§c_x_°ï_n‹mÆ
;

992 
x_îr‹
 +
x_îr‹_°ï_n‹mÆ
;

994 i‡(
x_îr‹
 >= 0) {

995 
§c_±r
 +
§c_x_°ï_⁄e
;

996 
x_îr‹
 -
x_díomö©‹
;

1000 
√xt_de°_±r
 +
de°_y_°ï
;

1002 
√xt_§c_±r
 +
§c_y_°ï_n‹mÆ
;

1003 
y_îr‹
 +
y_îr‹_°ï_n‹mÆ
;

1005 i‡(
y_îr‹
 >= 0) {

1006 
√xt_§c_±r
 +
§c_y_°ï_⁄e
;

1007 
y_îr‹
 -
y_díomö©‹
;

1013 
	}
}

1015 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


1038 
	$löór32a_døw¨ó_bôm≠_byãs_lsb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1052 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë<(b))

	)

1053 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË<<1)

	)

1054 
	#MWI_BIT_NO
(
n
Ë(0x01 << (n))

	)

1060 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

1061 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

1063 
¥efix_fú°_bô
;

1064 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

1065 
po°fix_œ°_bô
;

1066 
bôm≠_byã
;

1067 
mask
;

1068 
fg
, 
bg
;

1069 
fú°_byã
, 
œ°_byã
;

1070 
size_maö
;

1071 
t
, 
y
;

1072 
adv™˚_§c
, 
adv™˚_d°
;

1073 
ADDR8
 
§c
;

1074 
ADDR32
 
d°
;

1077 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

1080 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

1083 
fú°_byã
 = 
gc
->
§cx
 >> 3;

1086 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

1088 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

1089 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1090 
fg
 = 
gc
->
fg_cﬁ‹
;

1091 
bg
 = 
gc
->
bg_cﬁ‹
;

1093 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

1094 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1096 i‡(
fú°_byã
 !
œ°_byã
) {

1100 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

1102 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

1104 
¥efix_fú°_bô
 = 0;

1105 
size_maö
++;

1107 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

1109 
po°fix_œ°_bô
 = 0;

1110 
size_maö
++;

1112 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

1113 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

1115 
¥efix_fú°_bô
 = 0;

1116 
po°fix_œ°_bô
 = 0;

1117 
size_maö
 = 1;

1121 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

1122 
¥efix_fú°_bô
 = 0;

1123 
size_maö
 = 0;

1126 
DRAWON
;

1128 i‡(
gc
->
gr_u£bg
) {

1129 
y
 = 0; y < 
gc
->
d°h
; y++) {

1132 i‡(
¥efix_fú°_bô
) {

1133 
bôm≠_byã
 = *
§c
++;

1134 
mask
 = 
¥efix_fú°_bô
; mask;

1135 
	`MWI_ADVANCE_BIT
(
mask
)) {

1136 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

1137 
bg
;

1142 
t
 = 
size_maö
;Å != 0;Å--) {

1143 
bôm≠_byã
 = *
§c
++;

1145 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

1146 
bg
;

1147 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

1148 
bg
;

1149 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

1150 
bg
;

1151 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

1152 
bg
;

1153 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

1154 
bg
;

1155 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

1156 
bg
;

1157 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

1158 
bg
;

1159 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

1160 
bg
;

1164 i‡(
po°fix_œ°_bô
) {

1165 
bôm≠_byã
 = *
§c
++;

1166 
mask
 = 
po°fix_fú°_bô
;

1167 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1168 
po°fix_œ°_bô
);

1169 
	`MWI_ADVANCE_BIT
(
mask
)) {

1170 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

1171 
bg
;

1175 
§c
 +
adv™˚_§c
;

1176 
d°
 +
adv™˚_d°
;

1179 
y
 = 0; y < 
gc
->
d°h
; y++) {

1182 i‡(
¥efix_fú°_bô
) {

1183 
bôm≠_byã
 = *
§c
++;

1184 
mask
 = 
¥efix_fú°_bô
; mask;

1185 
	`MWI_ADVANCE_BIT
(
mask
)) {

1186 i‡(
mask
 & 
bôm≠_byã
)

1187 *
d°
 = 
fg
;

1188 
d°
++;

1193 
t
 = 
size_maö
;Å != 0;Å--) {

1194 
bôm≠_byã
 = *
§c
++;

1196 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

1197 
d°
[0] = 
fg
;

1198 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

1199 
d°
[1] = 
fg
;

1200 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

1201 
d°
[2] = 
fg
;

1202 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

1203 
d°
[3] = 
fg
;

1204 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

1205 
d°
[4] = 
fg
;

1206 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

1207 
d°
[5] = 
fg
;

1208 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

1209 
d°
[6] = 
fg
;

1210 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

1211 
d°
[7] = 
fg
;

1213 
d°
 += 8;

1217 i‡(
po°fix_œ°_bô
) {

1218 
bôm≠_byã
 = *
§c
++;

1219 
mask
 = 
po°fix_fú°_bô
;

1220 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1221 
po°fix_œ°_bô
);

1222 
	`MWI_ADVANCE_BIT
(
mask
)) {

1223 i‡(
mask
 & 
bôm≠_byã
)

1224 *
d°
 = 
fg
;

1225 
d°
++;

1229 
§c
 +
adv™˚_§c
;

1230 
d°
 +
adv™˚_d°
;

1234 
DRAWOFF
;

1236 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


1237 #unde‡
MWI_ADVANCE_BIT


1238 #unde‡
MWI_BIT_NO


1239 #unde‡
MWI_FIRST_BIT


1240 #unde‡
MWI_LAST_BIT


1241 
	}
}

1245 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


1265 
	$löór32a_døw¨ó_bôm≠_byãs_msb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1279 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë>(b))

	)

1280 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË>>1)

	)

1281 
	#MWI_BIT_NO
(
n
Ë(0x80 >> (n))

	)

1287 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

1288 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

1290 
¥efix_fú°_bô
;

1291 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

1292 
po°fix_œ°_bô
;

1293 
bôm≠_byã
;

1294 
mask
;

1295 
fg
, 
bg
;

1296 
fú°_byã
, 
œ°_byã
;

1297 
size_maö
;

1298 
t
, 
y
;

1299 
adv™˚_§c
, 
adv™˚_d°
;

1300 
ADDR8
 
§c
;

1301 
ADDR32
 
d°
;

1304 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

1307 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

1310 
fú°_byã
 = 
gc
->
§cx
 >> 3;

1313 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

1315 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

1316 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1317 
fg
 = 
gc
->
fg_cﬁ‹
;

1318 
bg
 = 
gc
->
bg_cﬁ‹
;

1320 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

1321 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1323 i‡(
fú°_byã
 !
œ°_byã
) {

1327 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

1329 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

1331 
¥efix_fú°_bô
 = 0;

1332 
size_maö
++;

1334 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

1336 
po°fix_œ°_bô
 = 0;

1337 
size_maö
++;

1339 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

1340 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

1342 
¥efix_fú°_bô
 = 0;

1343 
po°fix_œ°_bô
 = 0;

1344 
size_maö
 = 1;

1348 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

1349 
¥efix_fú°_bô
 = 0;

1350 
size_maö
 = 0;

1353 
DRAWON
;

1355 i‡(
gc
->
gr_u£bg
) {

1356 
y
 = 0; y < 
gc
->
d°h
; y++) {

1359 i‡(
¥efix_fú°_bô
) {

1360 
bôm≠_byã
 = *
§c
++;

1361 
mask
 = 
¥efix_fú°_bô
; mask;

1362 
	`MWI_ADVANCE_BIT
(
mask
)) {

1363 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

1364 
bg
;

1369 
t
 = 
size_maö
;Å != 0;Å--) {

1370 
bôm≠_byã
 = *
§c
++;

1372 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

1373 
bg
;

1374 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

1375 
bg
;

1376 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

1377 
bg
;

1378 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

1379 
bg
;

1380 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

1381 
bg
;

1382 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

1383 
bg
;

1384 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

1385 
bg
;

1386 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

1387 
bg
;

1391 i‡(
po°fix_œ°_bô
) {

1392 
bôm≠_byã
 = *
§c
++;

1393 
mask
 = 
po°fix_fú°_bô
;

1394 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1395 
po°fix_œ°_bô
);

1396 
	`MWI_ADVANCE_BIT
(
mask
)) {

1397 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

1398 
bg
;

1402 
§c
 +
adv™˚_§c
;

1403 
d°
 +
adv™˚_d°
;

1406 
y
 = 0; y < 
gc
->
d°h
; y++) {

1409 i‡(
¥efix_fú°_bô
) {

1410 
bôm≠_byã
 = *
§c
++;

1411 
mask
 = 
¥efix_fú°_bô
; mask;

1412 
	`MWI_ADVANCE_BIT
(
mask
)) {

1413 i‡(
mask
 & 
bôm≠_byã
)

1414 *
d°
 = 
fg
;

1415 
d°
++;

1420 
t
 = 
size_maö
;Å != 0;Å--) {

1421 
bôm≠_byã
 = *
§c
++;

1423 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

1424 
d°
[0] = 
fg
;

1425 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

1426 
d°
[1] = 
fg
;

1427 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

1428 
d°
[2] = 
fg
;

1429 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

1430 
d°
[3] = 
fg
;

1431 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

1432 
d°
[4] = 
fg
;

1433 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

1434 
d°
[5] = 
fg
;

1435 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

1436 
d°
[6] = 
fg
;

1437 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

1438 
d°
[7] = 
fg
;

1440 
d°
 += 8;

1444 i‡(
po°fix_œ°_bô
) {

1445 
bôm≠_byã
 = *
§c
++;

1446 
mask
 = 
po°fix_fú°_bô
;

1447 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

1448 
po°fix_œ°_bô
);

1449 
	`MWI_ADVANCE_BIT
(
mask
)) {

1450 i‡(
mask
 & 
bôm≠_byã
)

1451 *
d°
 = 
fg
;

1452 
d°
++;

1456 
§c
 +
adv™˚_§c
;

1457 
d°
 +
adv™˚_d°
;

1461 
DRAWOFF
;

1463 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


1464 #unde‡
MWI_ADVANCE_BIT


1465 #unde‡
MWI_BIT_NO


1466 #unde‡
MWI_FIRST_BIT


1467 #unde‡
MWI_LAST_BIT


1468 
	}
}

1472 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1474 
	$löór32a_døw¨ó_Æphacﬁ
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

1476 
ADDR32
 
d°
;

1477 
ADDR8
 
Æpha
;

1478 
ps
, 
pd
;

1479 
as
;

1480 
p§
, 
psg
, 
psb
, 
pß
;

1481 
x
, 
y
;

1482 
§c_row_°ï
, 
d°_row_°ï
;

1484 
Æpha
 = ((
ADDR8
Ë
gc
->
misc
Ë+ gc->
§c_löñí
 * gc->
§cy
 + gc->
§cx
;

1485 
d°
 = ((
ADDR32
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

1486 
ps
 = 
gc
->
fg_cﬁ‹
;

1487 
p§
 = (Ë(
ps
 & 0x00FF0000UL);

1488 
psg
 = (Ë(
ps
 & 0x0000FF00UL);

1489 
psb
 = (Ë(
ps
 & 0x000000FFUL);

1490 
pß
 = (Ë((
ps
 >> 8) & 0x00FF0000UL);

1492 
§c_row_°ï
 = 
gc
->
§c_löñí
 - gc->
d°w
;

1493 
d°_row_°ï
 = 
psd
->
löñí
 - 
gc
->
d°w
;

1495 
DRAWON
;

1496 
y
 = 0; y < 
gc
->
d°h
; y++) {

1497 
x
 = 0; x < 
gc
->
d°w
; x++) {

1498 
as
 = *
Æpha
++;

1499 i‡(
as
 == 255) {

1500 *
d°
++ = 
ps
;

1501 } i‡(
as
 != 0) {

1513 
as
 = 256 - (as + (as >> 7));

1514 
pd
 = *
d°
;

1516 *
d°
++ = (() ((((()

1517 (
pd
 &

1519 
p§
) *

1520 
as
) >> 8) +

1521 
p§
) &

1525 Ë(((((Ë(
pd
 & 0x0000FF00UL)

1526 - 
psg
Ë* 
as
) >> 8) +

1527 
psg
) & 0x0000FF00UL)

1530 Ë(((((Ë(
pd
 & 0x000000FFUL)

1531 - 
psb
Ë* 
as
) >> 8) +

1532 
psb
) & 0x000000FFUL)

1534 ((
pd
 >> 8) &

1536 - 
pß
Ë* 
as
) +

1537 (
pß
 << 8)) &

1540 
d°
++;

1543 
Æpha
 +
§c_row_°ï
;

1544 
d°
 +
d°_row_°ï
;

1546 
DRAWOFF
;

1547 
	}
}

1551 
	$löór32a_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1553 
	`as£π
(
psd
->
addr
 != 0);

1555 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x + gc->
d°w
 <
psd
->
xªs
);

1558 
	`as£π
(
gc
->
§cy
 >= 0);

1561 
›
) {

1563 #i‡
MW_FEATURE_PSDOP_ALPHACOL


1564 
PSDOP_ALPHACOL
:

1565 
	`löór32a_døw¨ó_Æphacﬁ
(
psd
, 
gc
);

1569 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


1570 
PSDOP_BITMAP_BYTES_LSB_FIRST
:

1571 
	`löór32a_døw¨ó_bôm≠_byãs_lsb_fú°
(
psd
, 
gc
);

1575 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


1576 
PSDOP_BITMAP_BYTES_MSB_FIRST
:

1577 
	`löór32a_døw¨ó_bôm≠_byãs_msb_fú°
(
psd
, 
gc
);

1582 
	}
}

1584 
SUBDRIVER
 
	gfblöór32Æpha
 = {

1585 
löór32a_öô
,

1586 
löór32a_døwpixñ
,

1587 
löór32a_ªadpixñ
,

1588 
löór32a_døwh‹zlöe
,

1589 
löór32a_døwvîéöe
,

1590 
gí_fûÃe˘
,

1591 
löór32a_blô
,

1592 
löór32a_døw¨ó
,

1593 
löór32a_°ªtchblô
,

1594 
löór32a_°ªtchblôex
,

	@drivers/fblin4.c

14 
	~<as£π.h
>

15 
	~<°rög.h
>

16 
	~"devi˚.h
"

17 
	~"fb.h
"

19 #i‡
INVERT4BPP


20 
	#INVERT
(
c
Ë((cË(~¯& 0x0f))

	)

22 
	#INVERT
(
c
)

	)

25 
	gnŸmask
[2] = { 0x0f, 0xf0};

29 
	$löór4_öô
(
PSD
 
psd
)

31 i‡(!
psd
->
size
)

32 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

35 
	}
}

39 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

41 
ADDR8
 
addr
 = 
psd
->addr;

43 
	`as£π
 (
addr
 != 0);

44 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

45 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

46 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

48 
	`INVERT
(
c
);

49 
DRAWON
;

50 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

51 if(
gr_mode
 =
MWMODE_XOR
)

52 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

54 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

55 
DRAWOFF
;

56 
	}
}

59 
MWPIXELVAL


60 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

62 
ADDR8
 
addr
 = 
psd
->addr;

63 
MWPIXELVAL
 
c
;

65 
	`as£π
 (
addr
 != 0);

66 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

67 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

69 
c
 = (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> ((1-(x&1))<<2) ) & 0x0f;

70 
	`INVERT
(
c
);

71  
c
;

73 
	}
}

77 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

79 
ADDR8
 
addr
 = 
psd
->addr;

81 
	`as£π
 (
addr
 != 0);

82 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

83 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

84 
	`as£π
 (
x2
 >
x1
);

85 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

86 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

88 
	`INVERT
(
c
);

89 
DRAWON
;

90 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

91 if(
gr_mode
 =
MWMODE_XOR
) {

92 
x1
 <
x2
) {

93 *
addr
 ^
c
 << ((1-(
x1
&1))<<2);

94 if((++
x1
 & 1) == 0)

95 ++
addr
;

98 
x1
 <
x2
) {

99 *
addr
 = (*add∏& 
nŸmask
[
x1
&1]Ë| (
c
 << ((1-(x1&1))<<2));

100 if((++
x1
 & 1) == 0)

101 ++
addr
;

104 
DRAWOFF
;

105 
	}
}

109 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

111 
ADDR8
 
addr
 = 
psd
->addr;

112 
löñí
 = 
psd
->linelen;

114 
	`as£π
 (
addr
 != 0);

115 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

116 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

117 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

118 
	`as£π
 (
y2
 >
y1
);

119 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

121 
	`INVERT
(
c
);

122 
DRAWON
;

123 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

124 if(
gr_mode
 =
MWMODE_XOR
)

125 
y1
++ <
y2
) {

126 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

127 
addr
 +
löñí
;

130 
y1
++ <
y2
) {

131 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

132 
addr
 +
löñí
;

134 
DRAWOFF
;

135 
	}
}

139 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

140 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

142 
ADDR8
 
d°
;

143 
ADDR8
 
§c
;

144 
i
;

145 
dlöñí
 = 
d°psd
->
löñí
;

146 
¶öñí
 = 
§˝sd
->
löñí
;

148 
	`as£π
 (
d°psd
->
addr
 != 0);

149 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

150 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

151 
	`as£π
 (
w
 > 0);

152 
	`as£π
 (
h
 > 0);

153 
	`as£π
 (
§˝sd
->
addr
 != 0);

154 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

155 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

156 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

157 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

158 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

159 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

161 
DRAWON
;

162 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

163 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

164 --
h
 >= 0) {

165 
ADDR8
 
d
 = 
d°
;

166 
ADDR8
 
s
 = 
§c
;

167 
MWCOORD
 
dx
 = 
d°x
;

168 
MWCOORD
 
sx
 = 
§cx
;

169 
i
=0; i<
w
; ++i) {

170 #i‡
INVERT4BPP


171 
c
 = *
s
;

172 
	`INVERT
(
c
);

173 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

174 ((
c
 >> ((1-(
sx
&1))<<2Ë& 0x0fË<< ((1-(
dx
&1))<<2));

176 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

177 ((*
s
 >> ((1-(
sx
&1))<<2Ë& 0x0fË<< ((1-(
dx
&1))<<2));

179 if((++
dx
 & 1) == 0)

180 ++
d
;

181 if((++
sx
 & 1) == 0)

182 ++
s
;

184 
d°
 +
dlöñí
;

185 
§c
 +
¶öñí
;

187 
DRAWOFF
;

188 
	}
}

190 
SUBDRIVER
 
	gfblöór4
 = {

191 
löór4_öô
,

192 
löór4_døwpixñ
,

193 
löór4_ªadpixñ
,

194 
löór4_døwh‹zlöe
,

195 
löór4_døwvîéöe
,

196 
gí_fûÃe˘
,

197 
löór4_blô


	@drivers/fblin4hp.c

11 
	~<as£π.h
>

12 
	~<°rög.h
>

13 
	~"devi˚.h
"

14 
	~"fb.h
"

17 
	gnŸmask
[2] = { 0xf0, 0x0f };

18 
	gªvnŸmask
[2] = { 0xf0, 0x0f};

22 
	$löór4_öô
(
PSD
 
psd
)

24 i‡(!
psd
->
size
)

25 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

28 
	}
}

32 
MWPIXELVAL


33 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

35 
ADDR8
 
addr
 = 
psd
->addr;

37 
	`as£π
 (
addr
 != 0);

38 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

39 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

41  (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> (((x&1))<<2) ) & 0x0f;

42 
	}
}

46 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

48 
ADDR8
 
addr
 = 
psd
->addr;

49 
löñí
 = 
psd
->linelen;

51 
	`as£π
 (
addr
 != 0);

52 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

53 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

54 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

55 
	`as£π
 (
y2
 >
y1
);

56 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

58 
DRAWON
;

59 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

60 
y1
++ <
y2
) {

61 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << (((x&1))<<2));

62 
addr
 +
löñí
;

64 
DRAWOFF
;

65 
	}
}

71 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

73 
ADDR8
 
addr
 = 
psd
->addr;

75 
	`as£π
 (
addr
 != 0);

76 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

77 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

78 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

80 
DRAWON
;

81 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

85 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << (((x&1))<<2) );

86 
DRAWOFF
;

87 
	}
}

90 
MWPIXELVAL


91 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

93 
ADDR8
 
addr
 = 
psd
->addr;

95 
	`as£π
 (
addr
 != 0);

96 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

97 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

99  (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> (((x&1))<<2) ) & 0x0f;

100 
	}
}

104 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

106 
ADDR8
 
addr
 = 
psd
->addr;

108 
	`as£π
 (
addr
 != 0);

109 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

110 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

111 
	`as£π
 (
x2
 >
x1
);

112 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

113 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

115 
DRAWON
;

116 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

125 
x1
 <
x2
) {

126 *
addr
 = (*add∏& 
nŸmask
[
x1
&1]Ë| (
c
 << (((x1&1))<<2));

127 if((++
x1
 & 1) == 0)

128 ++
addr
;

131 
DRAWOFF
;

132 
	}
}

136 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

138 
ADDR8
 
addr
 = 
psd
->addr;

139 
löñí
 = 
psd
->linelen;

141 
	`as£π
 (
addr
 != 0);

142 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

143 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

144 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

145 
	`as£π
 (
y2
 >
y1
);

146 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

148 
DRAWON
;

149 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

150 
y1
++ <
y2
) {

151 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << (((x&1))<<2));

152 
addr
 +
löñí
;

154 
DRAWOFF
;

155 
	}
}

159 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

160 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

162 
ADDR8
 
d°
;

163 
ADDR8
 
§c
;

164 
i
;

165 
dlöñí
 = 
d°psd
->
löñí
;

166 
¶öñí
 = 
§˝sd
->
löñí
;

168 
	`as£π
 (
d°psd
->
addr
 != 0);

169 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

170 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

171 
	`as£π
 (
w
 > 0);

172 
	`as£π
 (
h
 > 0);

173 
	`as£π
 (
§˝sd
->
addr
 != 0);

174 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

175 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

176 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

177 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

178 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

179 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

181 
DRAWON
;

182 
d°
 = 
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

183 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

184 --
h
 >= 0) {

185 
ADDR8
 
d
 = 
d°
;

186 
ADDR8
 
s
 = 
§c
;

187 
MWCOORD
 
dx
 = 
d°x
;

188 
MWCOORD
 
sx
 = 
§cx
;

189 
i
=0; i<
w
; ++i) {

190 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

191 ((*
s
 >> (((
sx
&1))<<2Ë& 0x0fË<< (((
dx
&1))<<2));

192 if((++
dx
 & 1) == 0)

193 ++
d
;

194 if((++
sx
 & 1) == 0)

195 ++
s
;

197 
d°
 +
dlöñí
;

198 
§c
 +
¶öñí
;

200 
DRAWOFF
;

201 
	}
}

213 
	tT8p
;

214 * 
	tP8p
;

217 c⁄° 
T8p
 
	gMasks
[]=

223 c⁄° 
T8p
 
	gMasks2
[]=

228 
ölöe
 
T8p
 
	$ECﬁ‹
(
T8p
 
c
)

230 
c
|= c<<4; c|= c<<8; c|= c<<16;

231 (
c
);

232 
	}
}

237 
ölöe
 
P8p
 
	$PPoöãr
(
P8p
 
m
, 
LöeSize
, 
x
, 
y
)

239 –(
P8p
Ë((()
m
+((
x
>>1)+
y
*
LöeSize
))&~3) );

240 
	}
}

243 
öt£t
(*
d
, 
vÆue
, 
nbI¡s
);

245 
	#sw≠
(
t
, 
a
, 
b
Ë{Å 
ãmp
a;áb; bãmp; }

	)

248 
	$löór41_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

250 
P8p
 
p

	`PPoöãr
(
psd
->
addr
,Ösd->
löñí
, 
x
, 
y
);

251 
DRAWON
;

252 
x
= (x&0x7)<<2;

253 *
p
((*p)&~(0xf<<
x
))|(
c
<<x);

254 
DRAWOFF
;

255 
	}
}

289 
	$öt£t2
(*
p
, 
v
, 
c
Ë{ c>0Ë{ c--; *p++v; } 
	}
}

292 
	$löór41_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

294 
T8p
 
Mask1
, 
Mask2
;

295 
P8p
 
p
;

296 
DRAWON
;

297 i‡(
x1
>
x2
Ë
	`sw≠
(, x1, x2);

299 
x2
x2-
x1
+1;

300 
p

	`PPoöãr
(
psd
->
addr
,Ösd->
löñí
, 
x1
, 
y
);

301 
x1
&= 7;

302 
Mask1

Masks
[
x1
];

303 
Mask2

Masks2
[(
x1
+
x2
)&7];

304 
x2
(
x1
+x2+7)>>3;

305 
c

	`ECﬁ‹
(c);

306 
x2
)

309 1: 
Mask1
Mask1|~
Mask2
; *
p
(*p&Mask1)|(
c
&~Mask1); ;

310 2: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p(*p&~
Mask2
)|(c&Mask2); ;

311 3: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

312 4: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

313 5: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

314 6: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

315 7: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

316 8: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

317 9: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

318 10: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

319 11: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

320 12: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

321 13: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

322 14: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

323 15: *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2); ;

325 
x2
-= 2;

326 *
p
++(*p&
Mask1
)|(
c
&~Mask1);

327 
	`öt£t
(
p
, 
c
, 
x2
);

328 *(
p
+
x2
)(*’+x2)&~
Mask2
)|(
c
&Mask2);

331 
DRAWOFF
;

332 
	}
}

335 
	$löór41_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

337 
P8p
 
p
; 
T8p
 
m
; 
d
;

338 
DRAWON
;

339 i‡(
y1
>
y2
Ë
	`sw≠
(, y1, y2);

340 
y2
y2-
y1
+1;

341 
p

	`PPoöãr
(
psd
->
addr
,Ösd->
löñí
, 
x
, 
y1
);

342 
c
<<(
x
&7)<<2;

343 
m
(0xf<<((
x
&7)<<2));

344 
d

psd
->
löñí
 >> 2;

345 ;
y2
!=0; y2--Ë{ *
p
(*p&~
m
)|
c
;Ö+
d
; }

346 
DRAWOFF
;

347 
	}
}

350 
	$löór41_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

352 
d
;

353 
T8p
 
Mask1
, 
Mask2
;

354 
P8p
 
p
;

355 i‡(
x1
>
x2
Ë
	`sw≠
(, x1, x2);

356 i‡(
y1
>
y2
Ë
	`sw≠
(, y1, y2);

357 
DRAWON
;

358 
x2
x2-
x1
+1;

359 
p

	`PPoöãr
(
psd
->
addr
,Ösd->
löñí
, 
x1
, 
y1
);

360 
d
(
psd
->
löñí
)>>2;

361 
x1
&= 7;

362 
Mask1

Masks
[
x1
];

363 
Mask2

Masks2
[(
x1
+
x2
)&7];

364 
x2
(
x1
+x2+7)>>3;

365 
c

	`ECﬁ‹
(c);

366 
y2
-
y1
-1;

368 
x2
)

371 1: 
Mask1
Mask1|~
Mask2
; ; 
y2
!=0; y2--Ë{ *
p
(*p&Mask1)|(
c
&~Mask1);Ö+=
d
; } ;

372 2: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

373 3: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

374 4: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

375 5: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

376 6: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

377 7: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

378 8: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

379 9: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

380 10: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

381 11: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

382 12: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

383 13: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

384 14: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

385 15: 
d
d-
x2
+1; ; 
y2
!=0; y2--Ë{ *
p
++(*p&
Mask1
)|(
c
&~Mask1); *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p++c; *p(*p&~
Mask2
)|(c&Mask2);Ö+=d; } ;

387 
d
--; 
x2
-= 2;

388 ; 
y2
!=0; y2--)

390 *
p
++(*p&
Mask1
)|(
c
&~Mask1);

391 
	`öt£t
(
p
, 
c
, 
x2
);

392 *(
p
+
x2
)(*’+x2)&~
Mask2
)|(
c
&Mask2);

393 
p
+
d
;

397 
DRAWOFF
;

398 
	}
}

400 
	~"SubRïl.h
"

403 
	$löór41_blô
(
PSD
 
d°psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
w
, MWCOORD 
h
, PSD 
§˝sd
, MWCOORD 
sx
, MWCOORD 
sy
, 
›
)

405 
ds
, 
ss
, 
shi·
;

406 
T8p
 
Mask1
, 
Mask2
;

408 
P8p
 
dD©a

	`PPoöãr
(
d°psd
->
addr
, d°psd->
löñí
, 
x
, 
y
);

409 
P8p
 
sD©a

	`PPoöãr
(
§˝sd
->
addr
, sr˝sd->
löñí
, 
sx
, 
sy
);

411 
x
&=7; 
sx
&=7;

412 
shi·
(
x
-
sx
)<<2;

413 
Mask1

Masks
[
x
];

414 
Mask2

Masks2
[(
x
+
w
)&7];

416 
w
-1+((w+
x
+7)>>3);

418 
ds
(
d°psd
->
löñí
>>2)-
w
;

419 
ss
(
§˝sd
->
löñí
>>2)-
w
;

423 i‡(
shi·
!=0)

425 (4&(
shi·
>>28))|(
w
>2?3:w))

427 0: 
	`B…_Shi·_Posôif_w0
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

428 1: 
	`B…_Shi·_Posôif_w1
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

429 2: 
	`B…_Shi·_Posôif_w2
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

430 3: 
	`B…_Shi·_Posôif
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

431 4: 
	`B…_Shi·_Neg©if_w0
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

432 5: 
	`B…_Shi·_Neg©if_w1
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

433 6: 
	`B…_Shi·_Neg©if_w2
(
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

434 7: 
	`B…_Shi·_Neg©if
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

438 
w
)

440 0: 
	`B…_Shi·_NuŒ_w0
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

441 1: 
	`B…_Shi·_NuŒ_w1
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

442 2: 
	`B…_Shi·_NuŒ_w2
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

443 3: 
	`B…_Shi·_NuŒ_w3
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

444 : 
	`B…_Shi·_NuŒ
 (
sD©a
, 
dD©a
, 
ss
, 
ds
, 
shi·
, 
Mask1
, 
Mask2
, 
w
-1, 
h
); ;

447 
	}
}

451 
	$löór4_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

452 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

453 
MWCOORD
 
§ch
, 
›
)

455 
ADDR8
 
d°
;

456 
ADDR8
 
§c
;

457 
dlöñí
 = 
d°psd
->
löñí
;

458 
¶öñí
 = 
§˝sd
->
löñí
;

459 
i
, 
ymax
;

460 
row_pos
, 
row_öc
;

461 
cﬁ_pos
, 
cﬁ_öc
;

462 
pixñ
 = 0;

464 
	`as£π
 (
d°psd
->
addr
 != 0);

465 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

466 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

467 
	`as£π
 (
d°w
 > 0);

468 
	`as£π
 (
d°h
 > 0);

469 
	`as£π
 (
§˝sd
->
addr
 != 0);

470 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

471 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

472 
	`as£π
 (
§cw
 > 0);

473 
	`as£π
 (
§ch
 > 0);

474 
	`as£π
 (
d°x
+
d°w
 <
d°psd
->
xªs
);

475 
	`as£π
 (
d°y
+
d°h
 <
d°psd
->
yªs
);

476 
	`as£π
 (
§cx
+
§cw
 <
§˝sd
->
xªs
);

477 
	`as£π
 (
§cy
+
§ch
 <
§˝sd
->
yªs
);

479 
DRAWON
;

480 
row_pos
 = 0x10000;

481 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

484 
ymax
 = 
d°y
+
d°h
; dsty<ymax; ++dsty) {

485 
MWCOORD
 
dx
;

486 
MWCOORD
 
sx
;

489 
row_pos
 >= 0x10000L) {

490 ++
§cy
;

491 
row_pos
 -= 0x10000L;

494 
d°
 = 
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
*
dlöñí
;

495 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>1Ë+ (
§cy
-1)*
¶öñí
;

498 
cﬁ_pos
 = 0x10000;

499 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

500 
sx
 = 
§cx
;

501 
dx
 = 
d°x
;

502 
i
=0; i<
d°w
; ++i) {

504 
cﬁ_pos
 >= 0x10000L) {

506 
pixñ
 = (*
§c
 >> ((1-(
sx
&1))<<2) ) & 0x0f;

507 i‡(++
sx
 & 1)

508 ++
§c
;

509 
cﬁ_pos
 -= 0x10000L;

511 *
d°
 = (*d° & 
nŸmask
[
dx
&1]Ë| (
pixñ
 << (((dx&1))<<2) );

513 i‡(++
dx
 & 1)

514 ++
d°
;

515 
cﬁ_pos
 +
cﬁ_öc
;

518 
row_pos
 +
row_öc
;

520 
DRAWOFF
;

521 
	}
}

524 
SUBDRIVER
 
	gfblöór4
 = {

525 
löór4_öô
,

526 
löór41_døwpixñ
,

527 
löór4_ªadpixñ
,

528 
löór41_døwh‹zlöe
,

529 
löór4_døwvîéöe
,

530 
löór41_fûÃe˘
,

531 
löór41_blô
,

532 
NULL
,

533 
löór4_°ªtchblô


536 
SUBDRIVER
 
	gfblöór4
 = {

537 
löór4_öô
,

538 
löór4_døwpixñ
,

539 
löór4_ªadpixñ
,

540 
löór4_døwh‹zlöe
,

541 
löór4_døwvîéöe
,

542 
gí_fûÃe˘
,

543 
löór4_blô
,

544 
NULL
,

545 
löór4_°ªtchblô


	@drivers/fblin4orion.c

17 
	~<°dio.h
>

18 
	~<as£π.h
>

19 
	~<°rög.h
>

20 
	~"devi˚.h
"

21 
	~"fb.h
"

24 
	#REMAP
(
c
Ë((cË(~¯& 0x0f))

	)

25 
	gªm≠
[16] = { 15,13,11,9,7,5,3,1,14,12,10,8,6,4,2,0 };

28 
	#REMAP_BACK
(
c
Ë((cË(~¯& 0x0f))

	)

29 
	gªm≠_back
[16] = { 15,7,14,6,13,5,12,4,11,3,10,2,9,1,8,0 };

31 
	gnŸmask
[2] = { 0x0f, 0xf0};

35 
	$löór4_öô
(
PSD
 
psd
)

37 i‡(!
psd
->
size
)

38 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

41 
	}
}

45 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

47 
ADDR8
 
addr
 = 
psd
->addr;

49 
	`as£π
 (
addr
 != 0);

50 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

51 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

52 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

54 
	`REMAP
(
c
);

55 
DRAWON
;

56 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

57 if(
gr_mode
 =
MWMODE_XOR
)

58 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

60 *
addr
 = (*add∏& 
nŸmask
[!(
x
&1)]Ë| (
c
 << ((1-(!(x&1)))<<2));

61 
DRAWOFF
;

62 
	}
}

65 
MWPIXELVAL


66 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

68 
ADDR8
 
addr
 = 
psd
->addr;

69 
MWPIXELVAL
 
c
;

71 
	`as£π
 (
addr
 != 0);

72 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

73 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

75 
c
 = (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> ((1-(!(x&1)))<<2) ) & 0x0f;

76 
	`REMAP_BACK
(
c
);

77  
c
;

79 
	}
}

83 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

85 
ADDR8
 
addr
 = 
psd
->addr;

87 
	`as£π
 (
addr
 != 0);

88 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

89 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

90 
	`as£π
 (
x2
 >
x1
);

91 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

92 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

95 
	`REMAP
(
c
);

96 
DRAWON
;

97 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

98 if(
gr_mode
 =
MWMODE_XOR
) {

99 
x1
 <
x2
) {

100 *
addr
 ^
c
 << ((1-(
x1
&1))<<2);

101 if((++
x1
 & 1) == 0)

102 ++
addr
;

105 
x1
 <
x2
) {

106 *
addr
 = (*add∏& 
nŸmask
[!(
x1
&1)]Ë| (
c
 << ((1-(!(x1&1)))<<2));

107 if((++
x1
 & 1) == 0)

108 ++
addr
;

111 
DRAWOFF
;

112 
	}
}

116 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

118 
ADDR8
 
addr
 = 
psd
->addr;

119 
löñí
 = 
psd
->linelen;

121 
	`as£π
 (
addr
 != 0);

122 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

123 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

124 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

125 
	`as£π
 (
y2
 >
y1
);

126 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

128 
	`REMAP
(
c
);

129 
DRAWON
;

130 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

131 if(
gr_mode
 =
MWMODE_XOR
)

132 
y1
++ <
y2
) {

133 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

134 
addr
 +
löñí
;

137 
y1
++ <
y2
) {

138 *
addr
 = (*add∏& 
nŸmask
[!(
x
&1)]Ë| (
c
 << ((1-(!(x&1)))<<2));

139 
addr
 +
löñí
;

141 
DRAWOFF
;

142 
	}
}

146 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

147 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

149 
ADDR8
 
d°
;

150 
ADDR8
 
§c
;

151 
i
;

152 
dlöñí
 = 
d°psd
->
löñí
;

153 
¶öñí
 = 
§˝sd
->
löñí
;

155 
	`as£π
 (
d°psd
->
addr
 != 0);

156 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

157 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

158 
	`as£π
 (
w
 > 0);

159 
	`as£π
 (
h
 > 0);

160 
	`as£π
 (
§˝sd
->
addr
 != 0);

161 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

162 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

163 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

164 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

165 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

166 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

168 
DRAWON
;

169 
d°
 = 
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

170 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

171 --
h
 >= 0) {

172 
ADDR8
 
d
 = 
d°
;

173 
ADDR8
 
s
 = 
§c
;

174 
MWCOORD
 
dx
 = 
d°x
;

175 
MWCOORD
 
sx
 = 
§cx
;

176 
i
=0; i<
w
; ++i) {

177 
c
 = *
s
;

178 
	`REMAP
(
c
);

179 *
d
 = (*d & 
nŸmask
[!(
dx
&1)]) |

180 ((
c
 >> ((1-(!(
sx
&1)))<<2Ë& 0x0fË<< ((1-(!(
dx
&1)))<<2));

181 if((++
dx
 & 1) == 0)

182 ++
d
;

183 if((++
sx
 & 1) == 0)

184 ++
s
;

186 
d°
 +
dlöñí
;

187 
§c
 +
¶öñí
;

189 
DRAWOFF
;

190 
	}
}

192 
SUBDRIVER
 
	gfblöór4
 = {

193 
löór4_öô
,

194 
löór4_døwpixñ
,

195 
löór4_ªadpixñ
,

196 
löór4_døwh‹zlöe
,

197 
löór4_døwvîéöe
,

198 
gí_fûÃe˘
,

199 
löór4_blô


	@drivers/fblin4rev.c

12 
	~<as£π.h
>

13 
	~<°rög.h
>

14 
	~"devi˚.h
"

15 
	~"fb.h
"

17 #i‡
INVERT4BPP


18 
	#INVERT
(
c
Ë((cË(~¯& 0x0f))

	)

20 
	#INVERT
(
c
)

	)

23 
	gnŸmask
[2] = { 0xf0, 0x0f};

27 
	$löór4_öô
(
PSD
 
psd
)

29 i‡(!
psd
->
size
)

30 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

33 
	}
}

37 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

39 
ADDR8
 
addr
 = 
psd
->addr;

41 
	`as£π
 (
addr
 != 0);

42 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

43 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

44 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

46 
	`INVERT
(
c
);

47 
DRAWON
;

48 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

49 if(
gr_mode
 =
MWMODE_XOR
)

50 *
addr
 ^
c
 << ((
x
&1)<<2);

52 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((x&1)<<2));

53 
DRAWOFF
;

54 
	}
}

57 
MWPIXELVAL


58 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

60 
ADDR8
 
addr
 = 
psd
->addr;

61 
MWPIXELVAL
 
c
;

63 
	`as£π
 (
addr
 != 0);

64 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

65 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

67 
c
 = (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> ((x&1)<<2) ) & 0x0f;

68 
	`INVERT
(
c
);

69  
c
;

71 
	}
}

75 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

77 
ADDR8
 
addr
 = 
psd
->addr;

79 
	`as£π
 (
addr
 != 0);

80 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

81 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

82 
	`as£π
 (
x2
 >
x1
);

83 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

84 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

86 
	`INVERT
(
c
);

87 
DRAWON
;

88 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

89 if(
gr_mode
 =
MWMODE_XOR
) {

90 
x1
 <
x2
) {

91 *
addr
 ^
c
 << ((
x1
&1)<<2);

92 if((++
x1
 & 1) == 0)

93 ++
addr
;

96 
x1
 <
x2
) {

97 *
addr
 = (*add∏& 
nŸmask
[
x1
&1]Ë| (
c
 << ((x1&1)<<2));

98 if((++
x1
 & 1) == 0)

99 ++
addr
;

102 
DRAWOFF
;

103 
	}
}

107 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

109 
ADDR8
 
addr
 = 
psd
->addr;

110 
löñí
 = 
psd
->linelen;

112 
	`as£π
 (
addr
 != 0);

113 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

114 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

115 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

116 
	`as£π
 (
y2
 >
y1
);

117 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

119 
	`INVERT
(
c
);

120 
DRAWON
;

121 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

122 if(
gr_mode
 =
MWMODE_XOR
)

123 
y1
++ <
y2
) {

124 *
addr
 ^
c
 << ((
x
&1)<<2);

125 
addr
 +
löñí
;

128 
y1
++ <
y2
) {

129 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((x&1)<<2));

130 
addr
 +
löñí
;

132 
DRAWOFF
;

133 
	}
}

137 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

138 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

140 
ADDR8
 
d°
;

141 
ADDR8
 
§c
;

142 
i
;

143 
dlöñí
 = 
d°psd
->
löñí
;

144 
¶öñí
 = 
§˝sd
->
löñí
;

146 
	`as£π
 (
d°psd
->
addr
 != 0);

147 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

148 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

149 
	`as£π
 (
w
 > 0);

150 
	`as£π
 (
h
 > 0);

151 
	`as£π
 (
§˝sd
->
addr
 != 0);

152 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

153 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

154 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

155 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

156 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

157 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

159 
DRAWON
;

160 
d°
 = 
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

161 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

162 --
h
 >= 0) {

163 
ADDR8
 
d
 = 
d°
;

164 
ADDR8
 
s
 = 
§c
;

165 
MWCOORD
 
dx
 = 
d°x
;

166 
MWCOORD
 
sx
 = 
§cx
;

167 
i
=0; i<
w
; ++i) {

168 #i‡
INVERT4BPP


169 
c
 = *
s
;

170 
	`INVERT
(
c
);

171 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

172 ((
c
 >> ((
sx
&1)<<2Ë& 0x0fË<< ((
dx
&1)<<2));

174 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

175 ((*
s
 >> ((
sx
&1)<<2Ë& 0x0fË<< ((
dx
&1)<<2));

177 if((++
dx
 & 1) == 0)

178 ++
d
;

179 if((++
sx
 & 1) == 0)

180 ++
s
;

182 
d°
 +
dlöñí
;

183 
§c
 +
¶öñí
;

185 
DRAWOFF
;

186 
	}
}

188 
SUBDRIVER
 
	gfblöór4
 = {

189 
löór4_öô
,

190 
löór4_døwpixñ
,

191 
löór4_ªadpixñ
,

192 
löór4_døwh‹zlöe
,

193 
löór4_døwvîéöe
,

194 
gí_fûÃe˘
,

195 
löór4_blô


	@drivers/fblin4sa1100.c

11 
	~<as£π.h
>

12 
	~<°rög.h
>

13 
	~"devi˚.h
"

14 
	~"fb.h
"

16 
	gnŸmask
[4] = { 0x0fff, 0xf0ff, 0xff0f, 0xfff0};

20 
	$löór4_öô
(
PSD
 
psd
)

22 i‡(!
psd
->
size
)

23 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

26 
	}
}

31 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

33 
ADDR8
 
addr
 = 
psd
->addr;

35 
	`as£π
 (
addr
 != 0);

36 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

37 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

38 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

40 
DRAWON
;

41 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

42 if(
gr_mode
 =
MWMODE_XOR
)

43 *(
ADDR16
)
addr
 ^
c
 << ((3-(
x
&3))<<2);

45 *(
ADDR16
)
addr
 = (*(ADDR16Ôdd∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((3-(x&3))<<2));

46 
DRAWOFF
;

47 
	}
}

50 
MWPIXELVAL


51 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

53 
ADDR8
 
addr
 = 
psd
->addr;

55 
	`as£π
 (
addr
 != 0);

56 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

57 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

59  (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> ((1-(x&1))<<2) ) & 0x0f;

60 
	}
}

64 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

66 
ADDR8
 
addr
 = 
psd
->addr;

68 
	`as£π
 (
addr
 != 0);

69 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

70 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

71 
	`as£π
 (
x2
 >
x1
);

72 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

73 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

75 
DRAWON
;

76 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

77 if(
gr_mode
 =
MWMODE_XOR
) {

78 
x1
 <
x2
) {

79 *(
ADDR16
)
addr
 ^
c
 << ((3-(
x1
&3))<<2);

80 if((++
x1
 & 1) == 0)

81 ++
addr
;

84 
x1
 <
x2
) {

85 *(
ADDR16
)
addr
 = (*(ADDR16Ôdd∏& 
nŸmask
[
x1
&3]Ë| (
c
 << ((3-(x1&3))<<2));

86 if((++
x1
 & 1) == 0)

87 ++
addr
;

90 
DRAWOFF
;

91 
	}
}

95 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

97 
ADDR8
 
addr
 = 
psd
->addr;

98 
löñí
 = 
psd
->linelen;

100 
	`as£π
 (
addr
 != 0);

101 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

102 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

103 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

104 
	`as£π
 (
y2
 >
y1
);

105 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

107 
DRAWON
;

108 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

109 if(
gr_mode
 =
MWMODE_XOR
)

110 
y1
++ <
y2
) {

111 *(
ADDR16
)
addr
 ^
c
 << ((3-(
x
&3))<<2);

112 
addr
 +
löñí
;

115 
y1
++ <
y2
) {

116 *(
ADDR16
)
addr
 = (*(ADDR16Ôdd∏& 
nŸmask
[
x
&3]Ë| (
c
 << ((3-(x&3))<<2));

117 
addr
 +
löñí
;

119 
DRAWOFF
;

120 
	}
}

124 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

125 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

127 
ADDR8
 
d°
;

128 
ADDR8
 
§c
;

129 
i
;

130 
dlöñí
 = 
d°psd
->
löñí
;

131 
¶öñí
 = 
§˝sd
->
löñí
;

133 
	`as£π
 (
d°psd
->
addr
 != 0);

134 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

135 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

136 
	`as£π
 (
w
 > 0);

137 
	`as£π
 (
h
 > 0);

138 
	`as£π
 (
§˝sd
->
addr
 != 0);

139 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

140 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

141 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

142 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

143 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

144 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

146 
DRAWON
;

147 
d°
 = 
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

148 
§c
 = 
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

149 --
h
 >= 0) {

150 
ADDR8
 
d
 = 
d°
;

151 
ADDR8
 
s
 = 
§c
;

152 
MWCOORD
 
dx
 = 
d°x
;

153 
MWCOORD
 
sx
 = 
§cx
;

154 
i
=0; i<
w
; ++i) {

155 *(
ADDR16
)
d
 = (*(ADDR16)d & 
nŸmask
[
dx
&3]) |

156 ((*(
ADDR16
)
s
 >> ((3-(
sx
&3))<<2Ë& 0x000fË<< ((3-(
dx
&3))<<2));

157 if((++
dx
 & 1) == 0)

158 ++
d
;

159 if((++
sx
 & 1) == 0)

160 ++
s
;

162 
d°
 +
dlöñí
;

163 
§c
 +
¶öñí
;

165 
DRAWOFF
;

166 
	}
}

168 
SUBDRIVER
 
	gfblöór4
 = {

169 
löór4_öô
,

170 
löór4_døwpixñ
,

171 
löór4_ªadpixñ
,

172 
löór4_døwh‹zlöe
,

173 
löór4_døwvîéöe
,

174 
gí_fûÃe˘
,

175 
löór4_blô


	@drivers/fblin4sh3.c

21 
	~<as£π.h
>

22 
	~<°rög.h
>

23 
	~"devi˚.h
"

24 
	~"fb.h
"

26 
	gnŸmask
[2] = { 0x0f, 0xf0};

30 
	$löór4_öô
(
PSD
 
psd
)

32 i‡(!
psd
->
size
)

33 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

36 
	}
}

40 
	$löór4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

42 
ADDR8
 
addr
 = 
psd
->addr;

44 
	`as£π
 (
addr
 != 0);

45 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

46 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

47 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

49 
DRAWON
;

50 
addr
 +((
x
>>1)^3Ë+ 
y
 * 
psd
->
löñí
;

51 if(
gr_mode
 =
MWMODE_XOR
)

52 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

54 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

55 
DRAWOFF
;

56 
	}
}

59 
MWPIXELVAL


60 
	$löór4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

62 
ADDR8
 
addr
 = 
psd
->addr;

64 
	`as£π
 (
addr
 != 0);

65 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

66 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

68  (
addr
[((
x
>>1)^3Ë+ 
y
 * 
psd
->
löñí
] >> ((1-(x&1))<<2) ) & 0x0f;

69 
	}
}

73 
	$löór4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

75 
ADDR8
 
addr
 = 
psd
->addr;

77 
	`as£π
 (
addr
 != 0);

78 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

79 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

80 
	`as£π
 (
x2
 >
x1
);

81 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

82 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

84 
DRAWON
;

85 
addr
 +–(
x1
>>1)^3 ) + 
y
 * 
psd
->
löñí
;

86 if(
gr_mode
 =
MWMODE_XOR
) {

87 
x1
 <
x2
) {

88 *
addr
 ^
c
 << ((1-(
x1
&1))<<2);

89 if((++
x1
 & 1) == 0) {

91 
addr
 = 
psd
->add∏+ ( (
x1
>>1)^3 ) + 
y
 *Ösd->
löñí
;

95 
x1
 <
x2
) {

96 *
addr
 = (*add∏& 
nŸmask
[
x1
&1]Ë| (
c
 << ((1-(x1&1))<<2));

97 if((++
x1
 & 1) == 0) {

99 
addr
 = 
psd
->add∏+ ( (
x1
>>1)^3 ) + 
y
 *Ösd->
löñí
;

103 
DRAWOFF
;

104 
	}
}

108 
	$löór4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

110 
ADDR8
 
addr
 = 
psd
->addr;

111 
löñí
 = 
psd
->linelen;

113 
	`as£π
 (
addr
 != 0);

114 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

115 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

116 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

117 
	`as£π
 (
y2
 >
y1
);

118 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

120 
DRAWON
;

121 
addr
 +–(
x
>>1)^3 ) + 
y1
 * 
löñí
;

122 if(
gr_mode
 =
MWMODE_XOR
)

123 
y1
++ <
y2
) {

124 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

125 
addr
 +
löñí
;

128 
y1
++ <
y2
) {

129 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

130 
addr
 +
löñí
;

132 
DRAWOFF
;

133 
	}
}

137 
	$löór4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

138 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

140 
ADDR8
 
d°
;

141 
ADDR8
 
§c
;

142 
i
;

143 
dlöñí
 = 
d°psd
->
löñí
;

144 
¶öñí
 = 
§˝sd
->
löñí
;

146 
	`as£π
 (
d°psd
->
addr
 != 0);

147 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

148 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

149 
	`as£π
 (
w
 > 0);

150 
	`as£π
 (
h
 > 0);

151 
	`as£π
 (
§˝sd
->
addr
 != 0);

152 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

153 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

154 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

155 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

156 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

157 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

159 
DRAWON
;

160 #ifde‡
SH3_LITTLE_ENDIAN


161 
d°
 = 
d°psd
->
addr
 + ( (
d°x
>>1)^3 ) + 
d°y
 * 
dlöñí
;

162 
§c
 = 
§˝sd
->
addr
 + ( (
§cx
>>1)^3 ) + 
§cy
 * 
¶öñí
;

163 --
h
 >= 0) {

164 
ADDR8
 
d
 = 
d°
;

165 
ADDR8
 
s
 = 
§c
;

166 
MWCOORD
 
dx
 = 
d°x
;

167 
MWCOORD
 
sx
 = 
§cx
;

168 
i
=0; i<
w
; ++i) {

169 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

170 ((*
s
 >> ((1-(
sx
&1))<<2Ë& 0x0fË<< ((1-(
dx
&1))<<2));

171 if((++
dx
 & 1) == 0)

172 ++
d
;

173 if((++
sx
 & 1) == 0)

174 ++
s
;

176 
d°
 +
dlöñí
;

177 
§c
 +
¶öñí
;

180 
d°
 = 
d°psd
->
addr
 + 
d°y
 * 
dlöñí
;

181 
§c
 = 
§˝sd
->
addr
 + 
§cy
 * 
¶öñí
;

182 --
h
 >= 0) {

183 
ADDR8
 
d
 = 
d°
 + ( (
d°x
>>1)^3 );

184 
ADDR8
 
s
 = 
§c
 + ( (
§cx
>>1)^3 );

185 
MWCOORD
 
dx
 = 
d°x
;

186 
MWCOORD
 
sx
 = 
§cx
;

187 
i
=0; i<
w
; ++i) {

188 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

189 ((*
s
 >> ((1-(
sx
&1))<<2Ë& 0x0fË<< ((1-(
dx
&1))<<2));

190 if((++
dx
 & 1) == 0)

191 
d
 = 
d°
 + ( (
dx
 >> 1)^3 );

192 if((++
sx
 & 1) == 0)

193 
s
 = 
§c
 + ( (
sx
 >> 1)^3 );

195 
d°
 +
dlöñí
;

196 
§c
 +
¶öñí
;

199 
DRAWOFF
;

200 
	}
}

202 
SUBDRIVER
 
	gfblöór4
 = {

203 
löór4_öô
,

204 
löór4_døwpixñ
,

205 
löór4_ªadpixñ
,

206 
löór4_døwh‹zlöe
,

207 
löór4_døwvîéöe
,

208 
gí_fûÃe˘
,

209 
löór4_blô


	@drivers/fblin8.c

11 
	~<as£π.h
>

14 #i‚de‡
__OPTIMIZE__


15 
	#__OPTIMIZE__


	)

17 
	~<°rög.h
>

19 
	~"devi˚.h
"

20 
	~"fb.h
"

22 #i‡
ALPHABLEND


33 *
	gÆpha_to_rgb
 = 
NULL
;

34 *
	grgb_to_∑lödex
 = 
NULL
;

35 
öô_Æpha_lookup
();

40 
	$löór8_öô
(
PSD
 
psd
)

42 i‡(!
psd
->
size
)

43 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

46 
	}
}

50 
	$löór8_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

52 
ADDR8
 
addr
 = 
psd
->addr;

54 
	`as£π
 (
addr
 != 0);

55 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

56 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

57 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

59 
DRAWON
;

60 if(
gr_mode
 =
MWMODE_COPY
)

61 
addr
[
x
 + 
y
 * 
psd
->
löñí
] = 
c
;

63 
	`≠∂yOp
(
gr_mode
, 
c
, &
addr
[ 
x
 + 
y
 * 
psd
->
löñí
], 
ADDR8
);

64 
DRAWOFF
;

65 
	}
}

68 
MWPIXELVAL


69 
	$löór8_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

71 
ADDR8
 
addr
 = 
psd
->addr;

73 
	`as£π
 (
addr
 != 0);

74 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

75 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

77  
addr
[
x
 + 
y
 * 
psd
->
löñí
];

78 
	}
}

82 
	$löór8_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

84 
ADDR8
 
addr
 = 
psd
->addr;

86 
	`as£π
 (
addr
 != 0);

87 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

88 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

89 
	`as£π
 (
x2
 >
x1
);

90 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

91 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

93 
DRAWON
;

94 
addr
 +
x1
 + 
y
 * 
psd
->
löñí
;

95 if(
gr_mode
 =
MWMODE_COPY
)

96 
	`mem£t
(
addr
, 
c
, 
x2
 - 
x1
 + 1);

98 
x1
++ <
x2
) {

99 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR8
);

100 ++
addr
;

103 
DRAWOFF
;

104 
	}
}

108 
	$löór8_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

110 
ADDR8
 
addr
 = 
psd
->addr;

111 
löñí
 = 
psd
->linelen;

113 
	`as£π
 (
addr
 != 0);

114 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

115 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

116 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

117 
	`as£π
 (
y2
 >
y1
);

118 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

120 
DRAWON
;

121 
addr
 +
x
 + 
y1
 * 
löñí
;

122 if(
gr_mode
 =
MWMODE_COPY
) {

123 
y1
++ <
y2
) {

124 *
addr
 = 
c
;

125 
addr
 +
löñí
;

128 
y1
++ <
y2
) {

129 
	`≠∂yOp
(
gr_mode
, 
c
, 
addr
, 
ADDR8
);

130 
addr
 +
löñí
;

133 
DRAWOFF
;

134 
	}
}

138 
	$löór8_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

139 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

141 
ADDR8
 
d°
;

142 
ADDR8
 
§c
;

143 
dlöñí
 = 
d°psd
->
löñí
;

144 
¶öñí
 = 
§˝sd
->
löñí
;

145 #i‡
ALPHABLEND


146 
§ˇÕha
, 
d°Æpha
;

149 
	`as£π
 (
d°psd
->
addr
 != 0);

150 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

151 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

152 
	`as£π
 (
w
 > 0);

153 
	`as£π
 (
h
 > 0);

154 
	`as£π
 (
§˝sd
->
addr
 != 0);

155 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

156 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

157 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

158 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

159 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

160 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

162 
DRAWON
;

163 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ 
d°x
 + 
d°y
 * 
dlöñí
;

164 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ 
§cx
 + 
§cy
 * 
¶öñí
;

166 #i‡
ALPHABLEND


167 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

168 
°dblô
;

169 
§ˇÕha
 = 
›
 & 0xff;

172 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
) {

173 
	`öô_Æpha_lookup
();

174 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
)

175 
°dblô
;

181 
d°Æpha
 = ((
§ˇÕha
>>3) ^ 31) << 8;

182 
§ˇÕha
 = (srcalpha>>3) << 8;

184 --
h
 >= 0) {

185 
i
;

186 
i
=0; i<
w
; ++i) {

188 
s
 = 
Æpha_to_rgb
[
§ˇÕha
 + *
§c
++];

191 
d
 = 
Æpha_to_rgb
[
d°Æpha
 + *
d°
];

194 *
d°
++ = 
rgb_to_∑lödex
[
s
 + 
d
];

196 
d°
 +
dlöñí
 - 
w
;

197 
§c
 +
¶öñí
 - 
w
;

199 
DRAWOFF
;

201 
°dblô
:

203 i‡(
›
 =
MWROP_COPY
) {

206 i‡(
§cy
 < 
d°y
) {

207 
§c
 +(
h
-1Ë* 
¶öñí
;

208 
d°
 +(
h
-1Ë* 
dlöñí
;

209 
¶öñí
 *= -1;

210 
dlöñí
 *= -1;

213 --
h
 >= 0) {

215 
	`memmove
(
d°
, 
§c
, 
w
);

216 
d°
 +
dlöñí
;

217 
§c
 +
¶öñí
;

220 --
h
 >= 0) {

221 
i
;

222 
i
=0; i<
w
; i++) {

223 
	`≠∂yOp
(
	`MWROP_TO_MODE
(
›
), *
§c
, 
d°
, 
ADDR8
);

224 ++
§c
;

225 ++
d°
;

227 
d°
 +
dlöñí
 - 
w
;

228 
§c
 +
¶öñí
 - 
w
;

231 
DRAWOFF
;

232 
	}
}

236 
	$löór8_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

237 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

238 
MWCOORD
 
§ch
, 
›
)

240 
ADDR8
 
d°
;

241 
ADDR8
 
§c
;

242 
dlöñí
 = 
d°psd
->
löñí
;

243 
¶öñí
 = 
§˝sd
->
löñí
;

244 
i
, 
ymax
;

245 
row_pos
, 
row_öc
;

246 
cﬁ_pos
, 
cﬁ_öc
;

247 
pixñ
 = 0;

249 
	`as£π
 (
d°psd
->
addr
 != 0);

250 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

251 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

252 
	`as£π
 (
d°w
 > 0);

253 
	`as£π
 (
d°h
 > 0);

254 
	`as£π
 (
§˝sd
->
addr
 != 0);

255 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

256 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

257 
	`as£π
 (
§cw
 > 0);

258 
	`as£π
 (
§ch
 > 0);

259 
	`as£π
 (
d°x
+
d°w
 <
d°psd
->
xªs
);

260 
	`as£π
 (
d°y
+
d°h
 <
d°psd
->
yªs
);

261 
	`as£π
 (
§cx
+
§cw
 <
§˝sd
->
xªs
);

262 
	`as£π
 (
§cy
+
§ch
 <
§˝sd
->
yªs
);

264 
DRAWON
;

265 
row_pos
 = 0x10000;

266 
row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

269 
ymax
 = 
d°y
+
d°h
; dsty<ymax; ++dsty) {

272 
row_pos
 >= 0x10000L) {

273 ++
§cy
;

274 
row_pos
 -= 0x10000L;

277 
d°
 = ((
ADDR8
)
d°psd
->
addr
Ë+ 
d°x
 + 
d°y
*
dlöñí
;

278 
§c
 = ((
ADDR8
)
§˝sd
->
addr
Ë+ 
§cx
 + (
§cy
-1)*
¶öñí
;

281 
cﬁ_pos
 = 0x10000;

282 
cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

283 
i
=0; i<
d°w
; ++i) {

285 
cﬁ_pos
 >= 0x10000L) {

286 
pixñ
 = *
§c
++;

287 
cﬁ_pos
 -= 0x10000L;

289 *
d°
++ = 
pixñ
;

290 
cﬁ_pos
 +
cﬁ_öc
;

293 
row_pos
 +
row_öc
;

295 
DRAWOFF
;

296 
	}
}

298 #i‡
ALPHABLEND


300 
	$öô_Æpha_lookup
()

302 
i
, 
a
;

303 
r
, 
g
, 
b
;

304 
MWPALENTRY
 
gr_∑Àâe
[256];

306 if(!
Æpha_to_rgb
)

307 
Æpha_to_rgb
 = (*)
	`mÆloc
(

309 if(!
rgb_to_∑lödex
)

310 
rgb_to_∑lödex
 = (*)
	`mÆloc
(

312 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
)

320 
i
=0; i<256; ++i) {

321 
MWPALENTRY
 *
p
 = &
gr_∑Àâe
[
i
];

322 
a
=0;á<32; ++a) {

323 
Æpha_to_rgb
[(
a
<<8)+
i
] =

324 (((
p
->
r
 * 
a
 / 31)>>3) << 10) |

325 (((
p
->
g
 * 
a
 / 31)>>3) << 5) |

326 ((
p
->
b
 * 
a
 / 31)>>3);

334 
r
=0;Ñ<32; ++r) {

335 
g
=0; g<32; ++g)

336 
b
=0; b<32; ++b)

337 
rgb_to_∑lödex
[ (
r
<<10)|(
g
<<5)|
b
] =

338 
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
, 256,

339 
	`MWRGB
(
r
<<3, 
g
<<3, 
b
<<3));

341 
	}
}

344 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


367 
	$löór8_døw¨ó_bôm≠_byãs_lsb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

381 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë<(b))

	)

382 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË<<1)

	)

383 
	#MWI_BIT_NO
(
n
Ë(0x01 << (n))

	)

389 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

390 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

392 
¥efix_fú°_bô
;

393 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

394 
po°fix_œ°_bô
;

395 
bôm≠_byã
;

396 
mask
;

397 
fg
, 
bg
;

398 
fú°_byã
, 
œ°_byã
;

399 
size_maö
;

400 
t
, 
y
;

401 
adv™˚_§c
, 
adv™˚_d°
;

402 
ADDR8
 
§c
;

403 
ADDR8
 
d°
;

406 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

409 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

412 
fú°_byã
 = 
gc
->
§cx
 >> 3;

415 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

417 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

418 
d°
 = ((
ADDR8
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

419 
fg
 = 
gc
->
fg_cﬁ‹
;

420 
bg
 = 
gc
->
bg_cﬁ‹
;

422 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

423 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

425 i‡(
fú°_byã
 !
œ°_byã
) {

429 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

431 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

433 
¥efix_fú°_bô
 = 0;

434 
size_maö
++;

436 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

438 
po°fix_œ°_bô
 = 0;

439 
size_maö
++;

441 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

442 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

444 
¥efix_fú°_bô
 = 0;

445 
po°fix_œ°_bô
 = 0;

446 
size_maö
 = 1;

450 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

451 
¥efix_fú°_bô
 = 0;

452 
size_maö
 = 0;

455 
DRAWON
;

457 i‡(
gc
->
gr_u£bg
) {

458 
y
 = 0; y < 
gc
->
d°h
; y++) {

461 i‡(
¥efix_fú°_bô
) {

462 
bôm≠_byã
 = *
§c
++;

463 
mask
 = 
¥efix_fú°_bô
; mask;

464 
	`MWI_ADVANCE_BIT
(
mask
)) {

465 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

466 
bg
;

471 
t
 = 
size_maö
;Å != 0;Å--) {

472 
bôm≠_byã
 = *
§c
++;

474 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

475 
bg
;

476 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

477 
bg
;

478 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

479 
bg
;

480 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

481 
bg
;

482 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

483 
bg
;

484 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

485 
bg
;

486 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

487 
bg
;

488 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

489 
bg
;

493 i‡(
po°fix_œ°_bô
) {

494 
bôm≠_byã
 = *
§c
++;

495 
mask
 = 
po°fix_fú°_bô
;

496 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

497 
po°fix_œ°_bô
);

498 
	`MWI_ADVANCE_BIT
(
mask
)) {

499 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

500 
bg
;

504 
§c
 +
adv™˚_§c
;

505 
d°
 +
adv™˚_d°
;

508 
y
 = 0; y < 
gc
->
d°h
; y++) {

511 i‡(
¥efix_fú°_bô
) {

512 
bôm≠_byã
 = *
§c
++;

513 
mask
 = 
¥efix_fú°_bô
; mask;

514 
	`MWI_ADVANCE_BIT
(
mask
)) {

515 i‡(
mask
 & 
bôm≠_byã
)

516 *
d°
 = 
fg
;

517 
d°
++;

522 
t
 = 
size_maö
;Å != 0;Å--) {

523 
bôm≠_byã
 = *
§c
++;

525 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

526 
d°
[0] = 
fg
;

527 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

528 
d°
[1] = 
fg
;

529 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

530 
d°
[2] = 
fg
;

531 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

532 
d°
[3] = 
fg
;

533 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

534 
d°
[4] = 
fg
;

535 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

536 
d°
[5] = 
fg
;

537 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

538 
d°
[6] = 
fg
;

539 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

540 
d°
[7] = 
fg
;

542 
d°
 += 8;

546 i‡(
po°fix_œ°_bô
) {

547 
bôm≠_byã
 = *
§c
++;

548 
mask
 = 
po°fix_fú°_bô
;

549 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

550 
po°fix_œ°_bô
);

551 
	`MWI_ADVANCE_BIT
(
mask
)) {

552 i‡(
mask
 & 
bôm≠_byã
)

553 *
d°
 = 
fg
;

554 
d°
++;

558 
§c
 +
adv™˚_§c
;

559 
d°
 +
adv™˚_d°
;

563 
DRAWOFF
;

565 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


566 #unde‡
MWI_ADVANCE_BIT


567 #unde‡
MWI_BIT_NO


568 #unde‡
MWI_FIRST_BIT


569 #unde‡
MWI_LAST_BIT


570 
	}
}

574 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


594 
	$löór8_døw¨ó_bôm≠_byãs_msb_fú°
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
)

608 
	#MWI_IS_BIT_BEFORE_OR_EQUAL
(
a
,
b
Ë(◊Ë>(b))

	)

609 
	#MWI_ADVANCE_BIT
(
èrgë
Ë(—¨gëË>>1)

	)

610 
	#MWI_BIT_NO
(
n
Ë(0x80 >> (n))

	)

616 
	#MWI_FIRST_BIT
 
	`MWI_BIT_NO
(0)

	)

617 
	#MWI_LAST_BIT
 
	`MWI_BIT_NO
(7)

	)

619 
¥efix_fú°_bô
;

620 
po°fix_fú°_bô
 = 
MWI_FIRST_BIT
;

621 
po°fix_œ°_bô
;

622 
bôm≠_byã
;

623 
mask
;

624 
fg
, 
bg
;

625 
fú°_byã
, 
œ°_byã
;

626 
size_maö
;

627 
t
, 
y
;

628 
adv™˚_§c
, 
adv™˚_d°
;

629 
ADDR8
 
§c
;

630 
ADDR8
 
d°
;

633 
¥efix_fú°_bô
 = 
	`MWI_BIT_NO
(
gc
->
§cx
 & 7);

636 
po°fix_œ°_bô
 = 
	`MWI_BIT_NO
((
gc
->
§cx
 + gc->
d°w
 - 1) & 7);

639 
fú°_byã
 = 
gc
->
§cx
 >> 3;

642 
œ°_byã
 = (
gc
->
§cx
 + gc->
d°w
 - 1) >> 3;

644 
§c
 = ((
ADDR8
Ë
gc
->
pixñs
Ë+ gc->
§c_löñí
 * gc->
§cy
 + 
fú°_byã
;

645 
d°
 = ((
ADDR8
Ë
psd
->
addr
Ë+Ösd->
löñí
 * 
gc
->
d°y
 + gc->
d°x
;

646 
fg
 = 
gc
->
fg_cﬁ‹
;

647 
bg
 = 
gc
->
bg_cﬁ‹
;

649 
adv™˚_§c
 = 
gc
->
§c_löñí
 - 
œ°_byã
 + 
fú°_byã
 - 1;

650 
adv™˚_d°
 = 
psd
->
löñí
 - 
gc
->
d°w
;

652 i‡(
fú°_byã
 !
œ°_byã
) {

656 
size_maö
 = 
œ°_byã
 - 
fú°_byã
 + 1 - 2;

658 i‡(
¥efix_fú°_bô
 =
MWI_FIRST_BIT
) {

660 
¥efix_fú°_bô
 = 0;

661 
size_maö
++;

663 i‡(
po°fix_œ°_bô
 =
MWI_LAST_BIT
) {

665 
po°fix_œ°_bô
 = 0;

666 
size_maö
++;

668 } i‡((
¥efix_fú°_bô
 =
MWI_FIRST_BIT
)

669 && (
po°fix_œ°_bô
 =
MWI_LAST_BIT
)) {

671 
¥efix_fú°_bô
 = 0;

672 
po°fix_œ°_bô
 = 0;

673 
size_maö
 = 1;

677 
po°fix_fú°_bô
 = 
¥efix_fú°_bô
;

678 
¥efix_fú°_bô
 = 0;

679 
size_maö
 = 0;

682 
DRAWON
;

684 i‡(
gc
->
gr_u£bg
) {

685 
y
 = 0; y < 
gc
->
d°h
; y++) {

688 i‡(
¥efix_fú°_bô
) {

689 
bôm≠_byã
 = *
§c
++;

690 
mask
 = 
¥efix_fú°_bô
; mask;

691 
	`MWI_ADVANCE_BIT
(
mask
)) {

692 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

693 
bg
;

698 
t
 = 
size_maö
;Å != 0;Å--) {

699 
bôm≠_byã
 = *
§c
++;

701 *
d°
++ = (
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
Ë? 
fg
 :

702 
bg
;

703 *
d°
++ = (
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
Ë? 
fg
 :

704 
bg
;

705 *
d°
++ = (
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
Ë? 
fg
 :

706 
bg
;

707 *
d°
++ = (
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
Ë? 
fg
 :

708 
bg
;

709 *
d°
++ = (
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
Ë? 
fg
 :

710 
bg
;

711 *
d°
++ = (
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
Ë? 
fg
 :

712 
bg
;

713 *
d°
++ = (
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
Ë? 
fg
 :

714 
bg
;

715 *
d°
++ = (
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
Ë? 
fg
 :

716 
bg
;

720 i‡(
po°fix_œ°_bô
) {

721 
bôm≠_byã
 = *
§c
++;

722 
mask
 = 
po°fix_fú°_bô
;

723 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

724 
po°fix_œ°_bô
);

725 
	`MWI_ADVANCE_BIT
(
mask
)) {

726 *
d°
++ = (
mask
 & 
bôm≠_byã
Ë? 
fg
 :

727 
bg
;

731 
§c
 +
adv™˚_§c
;

732 
d°
 +
adv™˚_d°
;

735 
y
 = 0; y < 
gc
->
d°h
; y++) {

738 i‡(
¥efix_fú°_bô
) {

739 
bôm≠_byã
 = *
§c
++;

740 
mask
 = 
¥efix_fú°_bô
; mask;

741 
	`MWI_ADVANCE_BIT
(
mask
)) {

742 i‡(
mask
 & 
bôm≠_byã
)

743 *
d°
 = 
fg
;

744 
d°
++;

749 
t
 = 
size_maö
;Å != 0;Å--) {

750 
bôm≠_byã
 = *
§c
++;

752 i‡(
	`MWI_BIT_NO
(0Ë& 
bôm≠_byã
)

753 
d°
[0] = 
fg
;

754 i‡(
	`MWI_BIT_NO
(1Ë& 
bôm≠_byã
)

755 
d°
[1] = 
fg
;

756 i‡(
	`MWI_BIT_NO
(2Ë& 
bôm≠_byã
)

757 
d°
[2] = 
fg
;

758 i‡(
	`MWI_BIT_NO
(3Ë& 
bôm≠_byã
)

759 
d°
[3] = 
fg
;

760 i‡(
	`MWI_BIT_NO
(4Ë& 
bôm≠_byã
)

761 
d°
[4] = 
fg
;

762 i‡(
	`MWI_BIT_NO
(5Ë& 
bôm≠_byã
)

763 
d°
[5] = 
fg
;

764 i‡(
	`MWI_BIT_NO
(6Ë& 
bôm≠_byã
)

765 
d°
[6] = 
fg
;

766 i‡(
	`MWI_BIT_NO
(7Ë& 
bôm≠_byã
)

767 
d°
[7] = 
fg
;

769 
d°
 += 8;

773 i‡(
po°fix_œ°_bô
) {

774 
bôm≠_byã
 = *
§c
++;

775 
mask
 = 
po°fix_fú°_bô
;

776 
	`MWI_IS_BIT_BEFORE_OR_EQUAL
(
mask
,

777 
po°fix_œ°_bô
);

778 
	`MWI_ADVANCE_BIT
(
mask
)) {

779 i‡(
mask
 & 
bôm≠_byã
)

780 *
d°
 = 
fg
;

781 
d°
++;

785 
§c
 +
adv™˚_§c
;

786 
d°
 +
adv™˚_d°
;

790 
DRAWOFF
;

792 #unde‡
MWI_IS_BIT_BEFORE_OR_EQUAL


793 #unde‡
MWI_ADVANCE_BIT


794 #unde‡
MWI_BIT_NO


795 #unde‡
MWI_FIRST_BIT


796 #unde‡
MWI_LAST_BIT


797 
	}
}

802 
	$löór8_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

804 
	`as£π
(
psd
->
addr
 != 0);

806 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x + gc->
d°w
 <
psd
->
xªs
);

809 
	`as£π
(
gc
->
§cy
 >= 0);

812 
	`¥ötf
("löór32_døw¨ó op=%d d°x=%d d°y=%d\n", 
›
, 
gc
->
d°x
,

813 
gc
->
d°y
);

816 
›
) {

819 #i‡
MW_FEATURE_PSDOP_ALPHACOL


820 
PSDOP_ALPHACOL
:

821 
	`löór8_døw¨ó_Æphacﬁ
(
psd
, 
gc
);

826 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


827 
PSDOP_BITMAP_BYTES_LSB_FIRST
:

828 
	`löór8_døw¨ó_bôm≠_byãs_lsb_fú°
(
psd
, 
gc
);

832 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


833 
PSDOP_BITMAP_BYTES_MSB_FIRST
:

834 
	`löór8_døw¨ó_bôm≠_byãs_msb_fú°
(
psd
, 
gc
);

839 
	}
}

842 
SUBDRIVER
 
	gfblöór8
 = {

843 
löór8_öô
,

844 
löór8_døwpixñ
,

845 
löór8_ªadpixñ
,

846 
löór8_døwh‹zlöe
,

847 
löór8_døwvîéöe
,

848 
gí_fûÃe˘
,

849 
löór8_blô
,

850 
löór8_døw¨ó
,

851 
löór8_°ªtchblô


	@drivers/fbportrait_down.c

6 
	~<as£π.h
>

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~"devi˚.h
"

10 
	~"fb.h
"

13 
	$fbp‹åaô_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

15 
x
 = 
psd
->
xvúåes
-x-1;

16 
psd
->
‹gsubdrivî
->
	`DøwPixñ
’sd, 
x
,Ösd->
yvúåes
-
y
-1, 
c
);

17 
	}
}

19 
MWPIXELVAL


20 
	$fbp‹åaô_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

22 
x
 = 
psd
->
xvúåes
-x-1;

23  
psd
->
‹gsubdrivî
->
	`RódPixñ
’sd, 
x
,Ösd->
yvúåes
-
y
-1);

24 
	}
}

27 
	$fbp‹åaô_døwh‹zlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

29 
x1
 = 
psd
->
xvúåes
-x1-1;

30 
x2
 = 
psd
->
xvúåes
-x2-1;

31 
psd
->
‹gsubdrivî
->
	`DøwH‹zLöe
’sd, 
x2
, 
x1
,Ösd->
yvúåes
-
y
-1, 
c
);

32 
	}
}

35 
	$fbp‹åaô_døwvîéöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

37 
x
 = 
psd
->
xvúåes
-x-1;

38 
psd
->
‹gsubdrivî
->
	`DøwVîtLöe
’sd, 
x
,Ösd->
yvúåes
-
y2
-1,

39 
psd
->
yvúåes
-
y1
-1, 
c
);

40 
	}
}

43 
	$fbp‹åaô_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

44 
MWPIXELVAL
 
c
)

46 
y2
 = 
psd
->
yvúåes
-y2-1;

47 
y1
 = 
psd
->
yvúåes
-y1-1;

48 
x1
 = 
psd
->
xvúåes
-
x2
-1;

49 
x2
 = 
psd
->
xvúåes
-
x1
-1;

50 
y2
 <
y1
)

51 
psd
->
	`DøwH‹zLöe
’sd, 
x1
, 
x2
, 
y2
++, 
c
);

52 
	}
}

55 
	$fbp‹åaô_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

56 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

58 
d°psd
->
‹gsubdrivî
->
	`Blô
(d°psd, d°psd->
xvúåes
-
de°x
-
w
, d°psd->
yvúåes
-
de°y
-
h
,

59 
w
, 
h
, 
§˝sd
, sr˝sd->
xvúåes
-
§cx
-w, sr˝sd->
yvúåes
-
§cy
-h, 
›
);

61 
	}
}

64 
	$fbp‹åaô_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
de°x
, MWCOORD 
de°y
, MWCOORD 
d°w
,

65 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

66 
MWCOORD
 
§ch
, 
›
)

71 
	}
}

73 
SUBDRIVER
 
	gfbp‹åaô_down
 = {

74 
NULL
,

75 
fbp‹åaô_døwpixñ
,

76 
fbp‹åaô_ªadpixñ
,

77 
fbp‹åaô_døwh‹zlöe
,

78 
fbp‹åaô_døwvîéöe
,

79 
gí_fûÃe˘
,

80 
fbp‹åaô_blô
,

81 
NULL
,

82 
fbp‹åaô_°ªtchblô


	@drivers/fbportrait_left.c

6 
	~<as£π.h
>

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~"devi˚.h
"

10 
	~"fb.h
"

13 
	$fbp‹åaô_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

15 
psd
->
‹gsubdrivî
->
	`DøwPixñ
’sd, 
y
,Ösd->
xvúåes
-
x
-1, 
c
);

16 
	}
}

18 
MWPIXELVAL


19 
	$fbp‹åaô_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

21  
psd
->
‹gsubdrivî
->
	`RódPixñ
’sd, 
y
,Ösd->
xvúåes
-
x
-1);

22 
	}
}

25 
	$fbp‹åaô_døwh‹zlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

27 
psd
->
‹gsubdrivî
->
	`DøwVîtLöe
’sd, 
y
,Ösd->
xvúåes
-
x2
-1,

28 
psd
->
xvúåes
-
x1
-1, 
c
);

36 
	}
}

39 
	$fbp‹åaô_døwvîéöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

41 
psd
->
‹gsubdrivî
->
	`DøwH‹zLöe
’sd, 
y1
, 
y2
,Ösd->
xvúåes
-
x
-1, 
c
);

48 
	}
}

51 
	$fbp‹åaô_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

52 
MWPIXELVAL
 
c
)

54 
x1
 = 
psd
->
xvúåes
-x1-1;

55 
x2
 = 
psd
->
xvúåes
-x2-1;

56 
x2
 <
x1
)

57 
psd
->
‹gsubdrivî
->
	`DøwH‹zLöe
’sd, 
y1
, 
y2
, 
x2
++, 
c
);

58 
	}
}

61 
	$fbp‹åaô_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

62 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

64 
d°psd
->
‹gsubdrivî
->
	`Blô
(d°psd, 
de°y
, d°psd->
xvúåes
-
de°x
-
w
,

65 
h
, 
w
, 
§˝sd
, 
§cy
, sr˝sd->
xvúåes
-
§cx
-w, 
›
);

66 
	}
}

69 
	$fbp‹åaô_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
de°x
, MWCOORD 
de°y
, MWCOORD 
d°w
,

70 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

71 
MWCOORD
 
§ch
, 
›
)

76 
	}
}

78 
SUBDRIVER
 
	gfbp‹åaô_À·
 = {

79 
NULL
,

80 
fbp‹åaô_døwpixñ
,

81 
fbp‹åaô_ªadpixñ
,

82 
fbp‹åaô_døwh‹zlöe
,

83 
fbp‹åaô_døwvîéöe
,

84 
gí_fûÃe˘
,

85 
fbp‹åaô_blô
,

86 
NULL
,

87 
fbp‹åaô_°ªtchblô


	@drivers/fbportrait_right.c

6 
	~<as£π.h
>

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~"devi˚.h
"

10 
	~"fb.h
"

13 
	$fbp‹åaô_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

15 
psd
->
‹gsubdrivî
->
	`DøwPixñ
’sd,Ösd->
yvúåes
-
y
-1, 
x
, 
c
);

16 
	}
}

18 
MWPIXELVAL


19 
	$fbp‹åaô_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

21  
psd
->
‹gsubdrivî
->
	`RódPixñ
’sd,Ösd->
yvúåes
-
y
-1, 
x
);

22 
	}
}

25 
	$fbp‹åaô_døwh‹zlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

27 
psd
->
‹gsubdrivî
->
	`DøwVîtLöe
’sd,Ösd->
yvúåes
-
y
-1, 
x1
,

28 
x2
, 
c
);

36 
	}
}

39 
	$fbp‹åaô_døwvîéöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

41 
psd
->
‹gsubdrivî
->
	`DøwH‹zLöe
’sd,Ösd->
yvúåes
-
y2
-1,Ösd->yvúåes-
y1
-1,

42 
x
, 
c
);

49 
	}
}

52 
	$fbp‹åaô_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

53 
MWPIXELVAL
 
c
)

55 
x2
 <
x1
)

56 
psd
->
‹gsubdrivî
->
	`DøwH‹zLöe
’sd,Ösd->
yvúåes
-
y2
-1,

57 
psd
->
yvúåes
-
y1
-1, 
x2
++, 
c
);

58 
	}
}

61 
	$fbp‹åaô_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

62 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

64 
d°psd
->
‹gsubdrivî
->
	`Blô
(d°psd, d°psd->
yvúåes
-
de°y
-
h
, 
de°x
,

65 
h
, 
w
, 
§˝sd
, sr˝sd->
yvúåes
-
§cy
-h, 
§cx
, 
›
);

66 
	}
}

69 
	$fbp‹åaô_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
de°x
, MWCOORD 
de°y
, MWCOORD 
d°w
,

70 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

71 
MWCOORD
 
§ch
, 
›
)

76 
	}
}

78 
SUBDRIVER
 
	gfbp‹åaô_right
 = {

79 
NULL
,

80 
fbp‹åaô_døwpixñ
,

81 
fbp‹åaô_ªadpixñ
,

82 
fbp‹åaô_døwh‹zlöe
,

83 
fbp‹åaô_døwvîéöe
,

84 
gí_fûÃe˘
,

85 
fbp‹åaô_blô
,

86 
NULL
,

87 
fbp‹åaô_°ªtchblô


	@drivers/genfont.c

15 
	~<°dio.h
>

16 
	~"devi˚.h
"

17 
	~"gíf⁄t.h
"

20 
MWCFONT
 
f⁄t_wöFªeS™sSîif11x13
;

21 
MWCFONT
 
f⁄t_X6x13
;

27 
MWFONTPROCS
 
	gf⁄çrocs
 = {

28 
MWTF_ASCII
,

29 
gí_gëf⁄töfo
,

30 
gí_gëãxtsize
,

31 
gí_gëãxtbôs
,

32 
gí_u∆ﬂdf⁄t
,

33 
c‹ef⁄t_døwãxt
,

34 
NULL
,

35 
NULL
,

36 
NULL
,

58 
MWCOREFONT
 
	ggí_f⁄ts
[
NUMBER_FONTS
] = {

59 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_VAR
, &
f⁄t_wöFªeS™sSîif11x13
},

60 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_FIXED
, &
f⁄t_X6x13
},

62 {&
f⁄çrocs
, 0, 0, 0, "Hñvëiˇ", &
f⁄t_wöFªeS™sSîif11x13
},

63 {&
f⁄çrocs
, 0, 0, 0, "TîmöÆ", &
f⁄t_X6x13
}

70 
MWBOOL


71 
	$gí_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

73 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
)
pf⁄t
)->
cf⁄t
;

74 
i
;

76 
pf⁄töfo
->
maxwidth
 = 
pf
->maxwidth;

77 
pf⁄töfo
->
height
 = 
pf
->height;

78 
pf⁄töfo
->
ba£löe
 = 
pf
->
as˚¡
;

79 
pf⁄töfo
->
fú°ch¨
 = 
pf
->firstchar;

80 
pf⁄töfo
->
œ°ch¨
 = 
pf
->
fú°ch¨
 +Öf->
size
 - 1;

81 
pf⁄töfo
->
fixed
 = 
pf
->
width
 =
NULL
? 
TRUE
: 
FALSE
;

82 
i
=0; i<256; ++i) {

83 if(
pf
->
width
 =
NULL
)

84 
pf⁄töfo
->
widths
[
i
] = 
pf
->
maxwidth
;

86 if(
i
<
pf
->
fú°ch¨
 || i >pf->fú°ch¨+pf->
size
)

87 
pf⁄töfo
->
widths
[
i
] = 0;

88 
pf⁄töfo
->
widths
[
i
] = 
pf
->
width
[i-pf->
fú°ch¨
];

91  
TRUE
;

92 
	}
}

99 
	$gí_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

100 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

102 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
)
pf⁄t
)->
cf⁄t
;

103 c⁄° * 
°r
 = 
ãxt
;

104 
c
;

105 
width
;

107 if(
pf
->
width
 =
NULL
)

108 
width
 = 
cc
 * 
pf
->
maxwidth
;

110 
width
 = 0;

111 --
cc
 >= 0) {

112 
c
 = *
°r
++;

113 if(
c
 >
pf
->
fú°ch¨
 && c <Öf->fú°ch¨+pf->
size
)

114 
width
 +
pf
->width[
c
 -Öf->
fú°ch¨
];

117 *
pwidth
 = 
width
;

118 *
pheight
 = 
pf
->
height
;

119 *
pba£
 = 
pf
->
as˚¡
;

120 
	}
}

122 #i‡
HAVE_FNT_SUPPORT
 | 
HAVE_PCF_SUPPORT


128 
	$gí16_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

129 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

131 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
Ë
pf⁄t
)->
cf⁄t
;

132 c⁄° * 
°r
 = 
ãxt
;

133 
c
;

134 
width
;

136 i‡(
pf
->
width
 =
NULL
)

137 
width
 = 
cc
 * 
pf
->
maxwidth
;

139 
width
 = 0;

140 --
cc
 >= 0) {

141 
c
 = *
°r
++;

142 i‡(
c
 >
pf
->
fú°ch¨
 && c <Öf->fú°ch¨ +Öf->
size
)

143 
width
 +
pf
->width[
c
 -Öf->
fú°ch¨
];

146 *
pwidth
 = 
width
;

147 *
pheight
 = 
pf
->
height
;

148 *
pba£
 = 
pf
->
as˚¡
;

149 
	}
}

157 
	$gí_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

158 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

160 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
)
pf⁄t
)->
cf⁄t
;

161 
cou¡
, 
width
;

162 c⁄° 
MWIMAGEBITS
 * 
bôs
;

165 if(
ch
 < 
pf
->
fú°ch¨
 || ch >pf->fú°ch¨+pf->
size
)

166 
ch
 = 
pf
->
fú°ch¨
;

168 
ch
 -
pf
->
fú°ch¨
;

171 
bôs
 = 
pf
->bô†+ (pf->
off£t
?Öf->off£t[
ch
]: (pf->
height
 * ch));

172 
width
 = 
pf
->width ?Öf->width[
ch
] :Öf->
maxwidth
;

173 
cou¡
 = 
	`MWIMAGE_WORDS
(
width
Ë* 
pf
->
height
;

175 *
ªtm≠
 = 
bôs
;

178 *
pwidth
 = 
width
;

179 *
pheight
 = 
pf
->
height
;

180 *
pba£
 = 
pf
->
as˚¡
;

181 
	}
}

184 
	$gí_u∆ﬂdf⁄t
(
PMWFONT
 
pf⁄t
)

187 
	}
}

189 #i‡
NOTUSED


195 
	$gí_døwãxt
(
PMWFONT
 
pf⁄t
,
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,c⁄° *
ãxt
,

196 
n
,
MWPIXELVAL
 
fg
)

198 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
)
pf⁄t
)->
cf⁄t
;

199 c⁄° * 
°r
 = 
ãxt
;

200 
MWCOORD
 
width
;

201 
MWCOORD
 
height
;

202 c⁄° 
MWIMAGEBITS
 * 
bôm≠
;

205 
y
 -
pf
->
height
 - 1;

206 
n
-- > 0) {

207 
pf⁄t
->
	`GëTextBôs
’f⁄t, *
s
++, &
bôm≠
, &
width
, &
height
);

208 
	`gí_døwbôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
, 
fg
);

209 
x
 +
width
;

211 
	}
}

219 
	$gí_døwbôm≠
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

220 
MWIMAGEBITS
 *
èbÀ
, 
PIXELVAL
 
fgcﬁ‹
)

222 
MWCOORD
 
möx
;

223 
MWCOORD
 
maxx
;

224 
MWIMAGEBITS
 
bôvÆue
;

225 
bôcou¡
;

227 
möx
 = 
x
;

228 
maxx
 = 
x
 + 
width
 - 1;

229 
bôcou¡
 = 0;

230 
height
 > 0) {

231 i‡(
bôcou¡
 <= 0) {

232 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

233 
bôvÆue
 = *
èbÀ
++;

235 i‡(
	`MWIMAGE_TESTBIT
(
bôvÆue
))

236 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
fgcﬁ‹
);

237 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT
(bitvalue);

238 --
bôcou¡
;

239 i‡(
x
++ =
maxx
) {

240 
x
 = 
möx
;

241 ++
y
;

242 --
height
;

243 
bôcou¡
 = 0;

246 
	}
}

	@drivers/genfont.h

11 
	#NUMBER_FONTS
 4

	)

14 
MWBOOL
 
gí_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

15 
gí_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

16 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

17 
MWCOORD
 *
pba£
);

18 
gí_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

19 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

20 
gí_u∆ﬂdf⁄t
(
PMWFONT
 
pf⁄t
);

22 
gí16_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

23 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

24 
gí16_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

25 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

26 
MWCOORD
 *
pba£
);

28 
c‹ef⁄t_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

29 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

32 
MWCOREFONT
 
gí_f⁄ts
[
NUMBER_FONTS
];

35 
gí_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

36 c⁄° *
ãxt
, 
n
, 
MWPIXELVAL
 
fg
);

37 
gí_døwbôm≠
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,MWCOORD 
height
,

38 
MWIMAGEBITS
 *
èbÀ
, 
MWPIXELVAL
 
fgcﬁ‹
);

	@drivers/genmem.c

9 
	~<as£π.h
>

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~"devi˚.h
"

13 
	~"fb.h
"

14 
	~"gímem.h
"

16 #i‡
PSP


17 
	~<p•kî√l.h
>

18 
	~<p•debug.h
>

21 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

23 
	#¥ötf
(...)

	)

26 
	#EPRINTF
 
¥ötf


	)

32 
PSD


33 
	$gí_Æloˇãmemgc
(
PSD
 
psd
)

35 
PSD
 
mempsd
;

38 if((
psd
->
Êags
 & 
PSF_HAVEBLIT
) == 0)

39  
NULL
;

41 
mempsd
 = 
	`mÆloc
((
SCREENDEVICE
));

42 i‡(!
mempsd
)

43  
NULL
;

46 *
mempsd
 = *
psd
;

49 
mempsd
->
Êags
 |
PSF_MEMORY
;

50 
mempsd
->
Êags
 &~
PSF_SCREEN
;

51 
mempsd
->
addr
 = 
NULL
;

53  
mempsd
;

54 
	}
}

58 
	$öômemgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,
löñí
,

59 
size
,*
addr
)

61 
	`as£π
(
mempsd
->
Êags
 & 
PSF_MEMORY
);

64 i‡(
mempsd
->
p‹åaô
 & (
MWPORTRAIT_LEFT
|
MWPORTRAIT_RIGHT
)) {

65 
mempsd
->
yªs
 = 
w
;

66 
mempsd
->
xªs
 = 
h
;

68 
mempsd
->
xªs
 = 
w
;

69 
mempsd
->
yªs
 = 
h
;

71 
mempsd
->
xvúåes
 = 
w
;

72 
mempsd
->
yvúåes
 = 
h
;

73 
mempsd
->
∂™es
 =Ölanes;

74 
mempsd
->
bµ
 = bpp;

75 
mempsd
->
löñí
 =Üinelen;

76 
mempsd
->
size
 = size;

77 
mempsd
->
addr
 =áddr;

78 
	}
}

81 
	$gí_‰ìmemgc
(
PSD
 
mempsd
)

83 
	`as£π
(
mempsd
->
Êags
 & 
PSF_MEMORY
);

87 
	`‰ì
(
mempsd
);

88 
	}
}

91 
	$gí_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

92 
MWPIXELVAL
 
c
)

96 #i‡
PSP


97 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

100 
y1
 <
y2
)

101 
psd
->
	`DøwH‹zLöe
’sd, 
x1
, 
x2
, 
y1
++, 
c
);

103 #i‡
PSP


104 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

107 
	}
}

114 
MWBOOL


115 
	$£t_subdrivî
(
PSD
 
psd
, 
PSUBDRIVER
 
subdrivî
, 
MWBOOL
 
öô
)

118 
psd
->
DøwPixñ
 = 
subdrivî
->DrawPixel;

119 
psd
->
RódPixñ
 = 
subdrivî
->ReadPixel;

120 
psd
->
DøwH‹zLöe
 = 
subdrivî
->DrawHorzLine;

121 
psd
->
DøwVîtLöe
 = 
subdrivî
->DrawVertLine;

122 
psd
->
FûlRe˘
 = 
subdrivî
->FillRect;

123 
psd
->
Blô
 = 
subdrivî
->Blit;

124 
psd
->
DøwAªa
 = 
subdrivî
->DrawArea;

125 
psd
->
SåëchBlô
 = 
subdrivî
->StretchBlit;

126 
psd
->
SåëchBlôEx
 = 
subdrivî
->StretchBlitEx;

129 i‡(
öô
 && !
subdrivî
->
	`Inô
(
psd
))

132 
	}
}

136 
	$gë_subdrivî
(
PSD
 
psd
, 
PSUBDRIVER
 
subdrivî
)

139 
subdrivî
->
DøwPixñ
 = 
psd
->DrawPixel;

140 
subdrivî
->
RódPixñ
 = 
psd
->ReadPixel;

141 
subdrivî
->
DøwH‹zLöe
 = 
psd
->DrawHorzLine;

142 
subdrivî
->
DøwVîtLöe
 = 
psd
->DrawVertLine;

143 
subdrivî
->
FûlRe˘
 = 
psd
->FillRect;

144 
subdrivî
->
Blô
 = 
psd
->Blit;

145 
subdrivî
->
DøwAªa
 = 
psd
->DrawArea;

146 
subdrivî
->
SåëchBlô
 = 
psd
->StretchBlit;

147 
subdrivî
->
SåëchBlôEx
 = 
psd
->StretchBlitEx;

148 
	}
}

	@drivers/genmem.h

12 
PSD
 
gí_Æloˇãmemgc
(PSD 
psd
);

13 
gí_‰ìmemgc
(
PSD
 
mempsd
);

14 
öômemgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

15 
löñí
,
size
,*
addr
);

18 
MWBOOL
 
fb_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

19 
löñí
,
size
,*
addr
);

	@drivers/int10_pc.c

7 
	~"devi˚.h
"

8 
	~"vg≠œn4.h
"

14 
FARADDR


15 
	$öt10
(
ax
, 
bx
)

17 
REGPACK
 
ªg
;

19 
ªg
.
x
.
ax
 =áx;

20 
ªg
.
x
.
bx
 = bx;

21 
	`öå
(0x10, &
ªg
);

23  ((
FARADDR
Ë
	`MK_FP
(
ªg
.
x
.
es
,Ñeg.x.
bp
));

24 
	}
}

	@drivers/kbd_bios.c

6 
	~"devi˚.h
"

8 
KBD_O≥n
(
KBDDEVICE
 *
pkd
);

9 
KBD_Clo£
();

10 
KBD_GëModifõrInfo
(*
modifõrs
);

11 
KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
);

12 
KBD_Pﬁl
();

15 
kbpﬁl
();

16 
kbªad
();

17 
kbÊags
();

19 
KBDDEVICE
 
	gkbddev
 = {

20 
KBD_O≥n
,

21 
KBD_Clo£
,

22 
KBD_GëModifõrInfo
,

23 
KBD_Ród
,

24 
KBD_Pﬁl


31 
	$KBD_O≥n
(
KBDDEVICE
 *
pkd
)

35 
	}
}

41 
	$KBD_Clo£
()

43 
	}
}

49 
	$KBD_GëModifõrInfo
(*
modifõrs
)

51 *
modifõrs
 = 0;

52 
	}
}

60 
	$KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
)

63 if(!
	`kbpﬁl
())

67 *
modifõrs
 = 
	`kbÊags
();

70 *
buf
 = 
	`kbªad
();

72 if(*
buf
 == 0x1b)

75 
	}
}

78 
	$KBD_Pﬁl
()

80  
	`kbpﬁl
();

81 
	}
}

	@drivers/kbd_djgr.c

9 
	~"devi˚.h
"

11 
	~<bios.h
>

14 
KBD_O≥n
(
KBDDEVICE
 *
pkd
);

15 
KBD_Clo£
();

16 
KBD_GëModifõrInfo
(*
modifõrs
);

17 
KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
);

18 
KBD_Pﬁl
();

21 
KBDDEVICE
 
	gkbddev
 = {

22 
KBD_O≥n
,

23 
KBD_Clo£
,

24 
KBD_GëModifõrInfo
,

25 
KBD_Ród
,

26 
KBD_Pﬁl


34 
	$KBD_O≥n
(
KBDDEVICE
 *
pkd
)

38 
	}
}

44 
	$KBD_Clo£
()

46 
	}
}

52 
	$KBD_GëModifõrInfo
(*
modifõrs
)

54 *
modifõrs
 = 
	`bioskey
(2);

55 
	}
}

63 
	$KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
)

66 if(!
	`bioskey
(1))

70 *
modifõrs
 = 
	`bioskey
(2);

73 *
buf
 = 
	`bioskey
(0);

75 if(*
buf
 == 0x1b)

78 
	}
}

84 
	$KBD_Pﬁl
()

86 i‡(
	`bioskey
(1)==0)

90 
	}
}

	@drivers/kbd_fbsd.c

1 
	~<sys/time.h
>

2 
	~<machöe/c⁄sﬁe.h
>

3 
	~<vgl.h
>

5 
	~"devi˚.h
"

7 
	#KBLEN
 30

	)

8 
	gkbuf„r
[
KBLEN
];

9 
	gkÀn
=0;

10 
	g°©es
[256];

12 c⁄° 
	gquîtycodes
[48+1]={41, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,\

16 c⁄° 
	gch¨s
[48] = {'`','1','2','3','4','5','6','7','8','9','0','-','=',\

22 
öôkeyb
(
KBDDEVICE
 *
pkd
);

23 
ª°‹ekeyb
();

24 
TTY_GëModifõrInfo
(*
modifõrs
);

25 
gëkey
(
MWUCHAR
 *
buf
, *
modifõrs
);

26 
kbhô
();

28 
KBDDEVICE
 
	gkbddev
 = {

29 
öôkeyb
,

30 
ª°‹ekeyb
,

31 
TTY_GëModifõrInfo
,

32 
gëkey
,

33 
kbhô


40 
	$TTY_GëModifõrInfo
(*
modifõrs
)

42 *
modifõrs
 = 0;

43 
	}
}

45 
	$öôkeyb
(
KBDDEVICE
 *
pkd
)

47 
	`VGLKeybﬂrdInô
(
VGL_CODEKEYS
);

48 
	`mem£t
(
°©es
, 
FALSE
, ( states));

51 
	}
}

53 
	$ª°‹ekeyb
()

55 
	`VGLKeybﬂrdEnd
();

56 
	}
}

58 
	$Pro˚ssKbd
()

60 
ªsu…
, 
i
;

61 
ißsymbﬁ
;

62 
°©e
;

64 (
ªsu…
 = 
	`VGLKeybﬂrdGëCh
()) != 0) {

66 if(
ªsu…
 < 128)

67 
°©e
 = 
TRUE
;

69 
°©e
 = 
FALSE
;

70 
ªsu…
 -= 128;

73 
ißsymbﬁ
 = 
FALSE
;

74 
i
=0;
quîtycodes
[i]!=0;i++)

75 if(
ªsu…
 =
quîtycodes
[
i
]) {

76 
ªsu…
 = 
ch¨s
[
i
];

77 
ißsymbﬁ
 = 
TRUE
;

81 i‡(
ißsymbﬁ
 =
FALSE
)

82 
ªsu…
+=128;

84 
°©es
[
ªsu…
] = 
°©e
;

86 if(
°©e
 =
TRUE
)

89 if(
kÀn
 =
KBLEN
)

90 
	`mem˝y
(
kbuf„r
, kbuf„∏+ 1, --
kÀn
);

91 
kbuf„r
[
kÀn
++] = 
ªsu…
;

93 
	}
}

95 
	$GëAsyncKeySèã
(
key
)

97 
	`Pro˚ssKbd
();

98 (
°©es
[
key
]);

99 
	}
}

101 
	$gëkey
(
MWUCHAR
 *
buf
, *
modifõrs
)

103 
MWUCHAR
 
ªsu…
;

105 
	`kbhô
(Ë!
TRUE
);

106 
ªsu…
 = 
kbuf„r
[0];

107 
	`mem˝y
(
kbuf„r
, kbuf„∏+ 1, --
kÀn
);

109 *
buf
=
ªsu…
;

111 
	}
}

113 
	$kbhô
()

115 
	`Pro˚ssKbd
();

117 i‡(
kÀn
 > 0)

121 
	}
}

	@drivers/kbd_ipaq.c

7 
	~<°dio.h
>

8 
	~<sys/ty≥s.h
>

9 
	~<f˙é.h
>

10 
	~<uni°d.h
>

11 
	~<î∫o.h
>

12 
	~"devi˚.h
"

14 
	#IPAQ_SCANCODE_RECORD
 129

	)

15 
	#IPAQ_SCANCODE_CALENDAR
 130

	)

16 
	#IPAQ_SCANCODE_CONTACTS
 131

	)

17 
	#IPAQ_SCANCODE_Q
 132

	)

18 
	#IPAQ_SCANCODE_START
 133

	)

19 
	#IPAQ_SCANCODE_UP
 134

	)

20 
	#IPAQ_SCANCODE_RIGHT
 135

	)

21 
	#IPAQ_SCANCODE_LEFT
 136

	)

22 
	#IPAQ_SCANCODE_DOWN
 137

	)

23 
	#IPAQ_SCANCODE_ACTION
 138

	)

24 
	#IPAQ_SCANCODE_SUSPEND
 139

	)

26 #ifde‡
__ECOS


27 
	#KEYBOARD
 "/dev/kbd"

	)

29 
	#KEYBOARD
 "/dev/h3600_key"

	)

32 
IPAQ_O≥n
(
KBDDEVICE
 *
pkd
);

33 
IPAQ_Clo£
();

34 
IPAQ_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

35 
IPAQ_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

37 
KBDDEVICE
 
	gkbddev
 = {

38 
IPAQ_O≥n
,

39 
IPAQ_Clo£
,

40 
IPAQ_GëModifõrInfo
,

41 
IPAQ_Ród
,

42 
NULL


45 
	gfd
;

49 
	gsˇncodes
[] = {

51 
IPAQ_SCANCODE_RECORD
,

52 
IPAQ_SCANCODE_CALENDAR
,

53 
IPAQ_SCANCODE_CONTACTS
,

54 
IPAQ_SCANCODE_Q
,

55 
IPAQ_SCANCODE_START
,

56 
IPAQ_SCANCODE_UP
,

57 
IPAQ_SCANCODE_RIGHT
,

58 
IPAQ_SCANCODE_LEFT
,

59 
IPAQ_SCANCODE_DOWN
,

60 
IPAQ_SCANCODE_ACTION
,

61 
IPAQ_SCANCODE_SUSPEND


65 
	$IPAQ_O≥n
(
KBDDEVICE
 * 
pkd
)

68 
fd
 = 
	`›í
(
KEYBOARD
, 
O_RDONLY
 | 
O_NONBLOCK
);

70 i‡(
fd
 < 0) {

71 
	`DPRINTF
("%†- C™'à›í keybﬂrd!\n", 
__FUNCTION__
);

75  
fd
;

76 
	}
}

79 
	$IPAQ_Clo£
()

81 
	`˛o£
(
fd
);

82 
fd
 = -1;

83 
	}
}

86 
	$IPAQ_GëModifõrInfo
(
MWKEYMOD
 * 
modifõrs
, MWKEYMOD * 
curmodifõrs
)

88 i‡(
modifõrs
)

89 *
modifõrs
 = 0;

90 i‡(
curmodifõrs
)

91 *
curmodifõrs
 = 0;

92 
	}
}

96 
	$IPAQ_Ród
(
MWKEY
 * 
kbuf
, 
MWKEYMOD
 * 
modifõrs
, 
MWSCANCODE
 * 
sˇncode
)

98 
keydown
 = 0;

99 
cc
 = 0;

100 
buf
[1];

102 
cc
 = 
	`ªad
(
fd
, &
buf
, 1);

104 i‡(
cc
 < 0) {

105 i‡((
î∫o
 !
EINTR
Ë&& (î∫ÿ!
EAGAIN
)

106 && (
î∫o
 !
EINVAL
)) {

107 
	`≥º‹
("IPAQ KEY");

113 i‡(
cc
 == 0)

119 *
modifõrs
 = 0;

121 i‡(*
buf
 < 127) {

122 
keydown
 = 1;

124 i‡(*
buf
 > 9)

127 *
sˇncode
 = 
sˇncodes
[(Ë*
buf
];

129 
keydown
 = 2;

130 *
sˇncode
 = *
buf
;

133 *
sˇncode
) {

134 
IPAQ_SCANCODE_RECORD
:

135 *
kbuf
 = 
MWKEY_RECORD
;

138 
IPAQ_SCANCODE_CALENDAR
:

139 *
kbuf
 = 
MWKEY_APP1
;

142 
IPAQ_SCANCODE_CONTACTS
:

143 *
kbuf
 = 
MWKEY_APP2
;

146 
IPAQ_SCANCODE_Q
:

147 *
kbuf
 = 
MWKEY_MENU
;

150 
IPAQ_SCANCODE_START
:

152 *
kbuf
 = 
MWKEY_CANCEL
;

155 
IPAQ_SCANCODE_UP
:

156 *
kbuf
 = 
MWKEY_UP
;

159 
IPAQ_SCANCODE_DOWN
:

160 *
kbuf
 = 
MWKEY_DOWN
;

163 
IPAQ_SCANCODE_LEFT
:

164 *
kbuf
 = 
MWKEY_LEFT
;

167 
IPAQ_SCANCODE_RIGHT
:

168 *
kbuf
 = 
MWKEY_RIGHT
;

171 
IPAQ_SCANCODE_ACTION
:

172 *
kbuf
 = 
MWKEY_ENTER
;

175 
IPAQ_SCANCODE_SUSPEND
:

176 *
kbuf
 = 
MWKEY_SUSPEND
;

180 
	`DPRINTF
("I∑q - Unknow¿sˇncodê%d\n", *
sˇncode
);

184  
keydown
;

185 
	}
}

	@drivers/kbd_lirc.c

27 
	~<°dio.h
>

28 
	~<°dlib.h
>

29 
	~<uni°d.h
>

30 
	~<sys/ty≥s.h
>

31 
	~<f˙é.h
>

32 
	~<î∫o.h
>

33 
	~<°rög.h
>

34 
	~<sys/io˘l.h
>

35 
	~"mwty≥s.h
"

36 
	~"devi˚.h
"

37 
	~"mwlúc.h
"

39 
LIRC_O≥n
(
KBDDEVICE
 * 
pkd
);

40 
LIRC_Clo£
();

41 
LIRC_GëModifõrInfo
(
MWKEYMOD
 * 
modifõrs
,

42 
MWKEYMOD
 * 
curmodifõrs
);

43 
LIRC_Ród
(
MWKEY
 * 
kbuf
, 
MWKEYMOD
 * 
modifõrs
,

44 
MWSCANCODE
 * 
sˇncode
);

46 #ifde‡
MW_LIRC_MOUSE


47 
LIRC_Mou£O≥n
(
MOUSEDEVICE
 * 
pkd
);

48 
LIRC_Mou£Clo£
();

49 
LIRC_Mou£GëBuâ⁄Info
();

50 
LIRC_Mou£Ród
(
MWCOORD
 * 
dx
, MWCOORD * 
dy
, MWCOORD * 
dz
,

51 *
b±r
);

52 
LIRC_Mou£GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
);

55 
LIRC_mou£MovedPﬁ¨
(
•ìd
, 
dúe˘i⁄
);

56 
LIRC_mou£MovedC¨ãsün
(
xdñè
, 
ydñè
);

57 
LIRC_mou£Buâ⁄
(
buâ⁄
, 
MWBOOL
 
isDown
);

59 
LIRC_Upd©eKeySèã
(
MWBOOL
 
isDown
, 
MWKEY
 
mwkey
);

61 
ªmŸeMou£H™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

62 
MWSCANCODE
 * 
psˇncode
);

63 
ªmŸeKeybﬂrdH™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

64 
MWSCANCODE
 * 
psˇncode
);

65 
ªmŸeC⁄åﬁH™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

66 
MWSCANCODE
 * 
psˇncode
);

69 
	gKBDDEVICE


70 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


71 
	gkbddev2


73 
	gkbddev


76 
LIRC_O≥n
,

77 
LIRC_Clo£
,

78 
LIRC_GëModifõrInfo
,

79 
LIRC_Ród
,

80 
NULL


84 #ifde‡
MW_LIRC_MOUSE


85 
MOUSEDEVICE
 
	gmou£dev
 = {

86 
LIRC_Mou£O≥n
,

87 
LIRC_Mou£Clo£
,

88 
LIRC_Mou£GëBuâ⁄Info
,

89 
LIRC_Mou£GëDeÁu…Ac˚l
,

90 
LIRC_Mou£Ród
,

91 
NULL
,

92 
MOUSE_NORMAL


99 
MWKEY
 
	gLIRC_≥ndög_keyªÀa£_ch
 = 0;

100 
MWSCANCODE
 
	gLIRC_≥ndög_keyªÀa£_sˇn
 = 0;

103 
MWKEYMOD
 
	gLIRC_keymod
 = 0;

106 (*
	tªmŸeH™dÀr_t
Ë(
	tmwlúc_key°roke
 * 
	tevít
, 
	tMWKEY
 * 
	tkbuf
,

107 
	tMWSCANCODE
 * 
	tpsˇncode
);

109 
	sªmŸeDrivî_t_


111 c⁄° *
«me
;

112 
ªmŸeH™dÀr_t
 
h™dÀr
;

114 
	tªmŸeDrivî_t
;

119 
ªmŸeDrivî_t
 
ªmŸeDrivîs
[] = {

120 {"mhp_rc", 
ªmŸeC⁄åﬁH™dÀr
},

121 {"rcmm_kb", 
ªmŸeKeybﬂrdH™dÀr
},

122 {"rcmm_mou£", 
ªmŸeMou£H™dÀr
},

123 {
NULL
, NULL}

124 
	}
};

126 
	gLIRC_fd
 = -1;

128 #ifde‡
MW_LIRC_MOUSE


135 sig√d 
	gpﬁ¨_to_ˇπesün_èbÀ
[256] = {

157 
	#POLAR_TO_CARTESIAN_X
(
•ìd
,
™gÀ
Ë
pﬁ¨_to_ˇπesün_èbÀ
[◊ngÀË| ((•ìdË<< 4)]

	)

158 
	#POLAR_TO_CARTESIAN_Y
(
•ìd
,
™gÀ
Ë
	`POLAR_TO_CARTESIAN_X
((•ìd), (◊ngÀË+ 4Ë& 15)

	)

160 
	#SCALE
 3

	)

161 
	#THRESH
 5

	)

163 
	gLIRC_mou£DñèX
 = 0;

164 
	gLIRC_mou£DñèY
 = 0;

165 
	gLIRC_mou£Buâ⁄sRï‹ãd
 = 0;

166 
	gLIRC_mou£Buâ⁄s
 = 0;

169 
	$LIRC_Mou£GëBuâ⁄Info
()

171  
MWBUTTON_L
 | 
MWBUTTON_R
;

172 
	}
}

175 
	$LIRC_Mou£Ród
(
MWCOORD
 * 
dx
, MWCOORD * 
dy
, MWCOORD * 
dz
, *
b±r
)

177 
buâ⁄ch™ge
 = 
LIRC_mou£Buâ⁄s
 ^ 
LIRC_mou£Buâ⁄sRï‹ãd
;

178 
LIRC_mou£Buâ⁄sRï‹ãd
 = 
LIRC_mou£Buâ⁄s
;

179 *
b±r
 = 
LIRC_mou£Buâ⁄s
;

181 *
dx
 = 
LIRC_mou£DñèX
 / 8;

182 
LIRC_mou£DñèX
 -*
dx
 * 8;

184 *
dy
 = 
LIRC_mou£DñèY
 / 8;

185 
LIRC_mou£DñèY
 -*
dy
 * 8;

187 *
dz
 = 0;

189  ((*
dx
 =0Ë&& (*
dy
 =0Ë&& (
buâ⁄ch™ge
 == 0)) ? 0 : 1;

190 
	}
}

193 
	$LIRC_Mou£GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
)

195 *
psˇÀ
 = 
SCALE
;

196 *
±hªsh
 = 
THRESH
;

197 
	}
}

200 
	$LIRC_Mou£O≥n
(
MOUSEDEVICE
 * 
pkd
)

202  
LIRC_fd
;

203 
	}
}

206 
	$LIRC_Mou£Clo£
()

208 
	}
}

213 
	$LIRC_mou£MovedPﬁ¨
(
•ìd
, 
dúe˘i⁄
)

215 #ifde‡
MW_LIRC_MOUSE


216 
xdñè
 = 
	`POLAR_TO_CARTESIAN_X
(
•ìd
, 
dúe˘i⁄
);

217 
ydñè
 = 
	`POLAR_TO_CARTESIAN_Y
(
•ìd
, 
dúe˘i⁄
);

221  
	`LIRC_mou£MovedC¨ãsün
(
xdñè
, 
ydñè
);

225 
	}
}

229 
	$LIRC_mou£MovedC¨ãsün
(
xdñè
, 
ydñè
)

232 #ifde‡
MW_LIRC_MOUSE


233 
LIRC_mou£DñèX
 +
xdñè
;

234 
LIRC_mou£DñèY
 +
ydñè
;

236 i‡(
LIRC_mou£DñèX
 >= 8

237 || 
LIRC_mou£DñèX
 <= -8

238 || 
LIRC_mou£DñèY
 >= 8 || LIRC_mouseDeltaY <= -8) {

243 
	}
}

248 
	$LIRC_mou£Buâ⁄
(
buâ⁄
, 
MWBOOL
 
isDown
)

251 #ifde‡
MW_LIRC_MOUSE


252 i‡(
isDown
) {

253 i‡(!(
LIRC_mou£Buâ⁄s
 & 
buâ⁄
)) {

254 
LIRC_mou£Buâ⁄s
 |
buâ⁄
;

258 i‡(
LIRC_mou£Buâ⁄s
 & 
buâ⁄
) {

259 
LIRC_mou£Buâ⁄s
 &~
buâ⁄
;

265 
	}
}

272 
	$LIRC_O≥n
(
KBDDEVICE
 * 
pkd
)

274 
fd
 = 
	`mwlúc_öô
(
MWLIRC_NONBLOCK
);

276 
LIRC_≥ndög_keyªÀa£_ch
 = 0;

277 
LIRC_≥ndög_keyªÀa£_sˇn
 = 0;

278 
LIRC_keymod
 = 0;

280 #ifde‡
MW_LIRC_MOUSE


281 
LIRC_mou£DñèX
 = 0;

282 
LIRC_mou£DñèY
 = 0;

283 
LIRC_mou£Buâ⁄sRï‹ãd
 = 0;

284 
LIRC_mou£Buâ⁄s
 = 0;

287 
LIRC_fd
 = 
fd
;

288  
fd
;

289 
	}
}

297 
	$LIRC_Clo£
()

299 
LIRC_fd
 = -1;

300 
	`mwlúc_˛o£
();

301 
	}
}

306 
	$LIRC_Upd©eKeySèã
(
MWBOOL
 
isDown
, 
MWKEY
 
mwkey
)

308 
MWKEYMOD
 
ch™gebô
 = 0;

310 
mwkey
) {

311 
MWKEY_NUMLOCK
:

312 i‡(!
isDown
)

313 
LIRC_keymod
 ^
MWKMOD_NUM
;

315 
MWKEY_CAPSLOCK
:

316 i‡(!
isDown
)

317 
LIRC_keymod
 ^
MWKMOD_CAPS
;

319 
MWKEY_LCTRL
:

320 
ch™gebô
 = 
MWKMOD_LCTRL
;

322 
MWKEY_RCTRL
:

323 
ch™gebô
 = 
MWKMOD_RCTRL
;

325 
MWKEY_LSHIFT
:

326 
ch™gebô
 = 
MWKMOD_LSHIFT
;

328 
MWKEY_RSHIFT
:

329 
ch™gebô
 = 
MWKMOD_RSHIFT
;

331 
MWKEY_LALT
:

332 
ch™gebô
 = 
MWKMOD_LALT
;

334 
MWKEY_RALT
:

335 
ch™gebô
 = 
MWKMOD_RALT
;

337 
MWKEY_LMETA
:

338 
ch™gebô
 = 
MWKMOD_LMETA
;

340 
MWKEY_RMETA
:

341 
ch™gebô
 = 
MWKMOD_RMETA
;

343 
MWKEY_ALTGR
:

344 
ch™gebô
 = 
MWKMOD_ALTGR
;

350 i‡(
isDown
)

351 
LIRC_keymod
 |
ch™gebô
;

353 
LIRC_keymod
 &~
ch™gebô
;

354 
	}
}

361 
	$LIRC_GëModifõrInfo
(
MWKEYMOD
 * 
modifõrs
, MWKEYMOD * 
curmodifõrs
)

363 i‡(
modifõrs
)

364 *
modifõrs
 = 
MWKMOD_NUM
 | 
MWKMOD_CAPS


365 | 
MWKMOD_LCTRL


366 | 
MWKMOD_LSHIFT
 | 
MWKMOD_RSHIFT


367 | 
MWKMOD_LALT
 | 
MWKMOD_RALT


368 | 
MWKMOD_LMETA
 | 
MWKMOD_RMETA
;

369 i‡(
curmodifõrs
)

370 *
curmodifõrs
 = 
LIRC_keymod
;

371 
	}
}

381 
	$LIRC_Ród
(
MWKEY
 * 
kbuf
, 
MWKEYMOD
 * 
modifõrs
, 
MWSCANCODE
 * 
psˇncode
)

383 
mwlúc_key°roke
 
evít
[1];

384 
îr
;

385 c⁄° 
ªmŸeDrivî_t
 *
drivî
;

386 
ªsu…
 = 0;

388 i‡(
LIRC_≥ndög_keyªÀa£_ch
 != 0) {

389 *
kbuf
 = 
LIRC_≥ndög_keyªÀa£_ch
;

390 *
modifõrs
 = 
LIRC_keymod
;

391 *
psˇncode
 = 
LIRC_≥ndög_keyªÀa£_sˇn
;

392 
LIRC_≥ndög_keyªÀa£_ch
 = 0;

393 
LIRC_≥ndög_keyªÀa£_sˇn
 = 0;

399 
îr
 = 
	`mwlúc_ªad_key°roke_n‹ïót
(
evít
);

401 i‡(
îr
 != 0) {

402 i‡(
îr
 =
MWLIRC_ERROR_AGAIN
) {

405 
	`EPRINTF
("Eº‹Ñëu∫ed by mwlúc_ªad_key°roke(Ë- %d\n", 
îr
);

410 
drivî
 = 
ªmŸeDrivîs
;

411 (
drivî
->
«me
)

412 && (0 !
	`°rcmp
(
drivî
->
«me
, 
evít
->
rc
))) {

413 
drivî
++;

415 i‡(
drivî
->
«me
) {

417 
ªsu…
 = 
drivî
->
	`h™dÀr
(
evít
, 
kbuf
, 
psˇncode
);

419 
	`EPRINTF
("LIRC_Ród(Ë- UƒecognizedÑemŸêc⁄åﬁ '%s'. (Key '%s')\n", 
evít
->
rc
,Évít->
«me
);

422 
ªsu…
 == 0);

424 *
modifõrs
 = 
LIRC_keymod
;

425  (
ªsu…
 == 3 ? 0 :Ñesult);

426 
	}
}

453 
	$ªmŸeMou£H™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

454 
MWSCANCODE
 * 
psˇncode
)

456 
•ìd
;

457 
dú
;

458 
Àn
 = 0;

460 i‡((
	`ssˇnf
(
evít
->
«me
, "m_%u_%u%n", &
•ìd
, &
dú
, &
Àn
) < 2)

461 || (
Àn
 !
	`°æí
(
evít
->
«me
))

462 || (
dú
 > 15)

463 || (
•ìd
 > 15)) {

464 
	`EPRINTF
("LIRC_Read() - Invalid mouseÉvent '%s'\n",

465 
evít
->
«me
);

469  
	`LIRC_mou£MovedPﬁ¨
(
•ìd
, 
dú
);

470 
	}
}

497 
	skeybﬂrdKey_t_


499 
MWBOOL
 
	misDown
;

500 c⁄° *
	m«me
;

501 c⁄° 
MWKEY
 
	mn‹mÆ
;

502 c⁄° 
MWKEY
 
	mshi·
;

503 c⁄° 
MWKEY
 
	mnum
;

504 c⁄° 
MWKEY
 
	m‚
;

506 
	tkeybﬂrdKey_t
;

508 
keybﬂrdKey_t
 
	gkeybﬂrdKeys
[] = {

511 {0, "ESCAPE", 
MWKEY_ESCAPE
, MWKEY_ESCAPE, MWKEY_ESCAPE, 0},

512 {0, "F1", 
MWKEY_F1
, MWKEY_F1, MWKEY_F1, 
MWKEY_F11
},

513 {0, "F2", 
MWKEY_F2
, MWKEY_F2, MWKEY_F2, 
MWKEY_F12
},

514 {0, "F3", 
MWKEY_F3
, MWKEY_F3, MWKEY_F3, 0},

515 {0, "F4", 
MWKEY_F4
, MWKEY_F4, MWKEY_F4, 0},

516 {0, "F5", 
MWKEY_F5
, MWKEY_F5, MWKEY_F5, 0},

517 {0, "F6", 
MWKEY_F6
, MWKEY_F6, MWKEY_F6, 0},

518 {0, "F7", 
MWKEY_F7
, MWKEY_F7, MWKEY_F7, 0},

519 {0, "F8", 
MWKEY_F8
, MWKEY_F8, MWKEY_F8, 0},

520 {0, "F9", 
MWKEY_F9
, MWKEY_F9, MWKEY_F9, 0},

521 {0, "F10", 
MWKEY_F10
, MWKEY_F10, MWKEY_F10, 0},

522 {0, "NUMLOCK", 
MWKEY_NUMLOCK
, MWKEY_NUMLOCK, MWKEY_NUMLOCK,

523 
MWKEY_NUMLOCK
},

524 {0, "PRINT", 
MWKEY_PRINT
, MWKEY_PRINT, MWKEY_PRINT, 0},

525 {0, "SCROLLOCK", 
MWKEY_SCROLLOCK
, MWKEY_SCROLLOCK, MWKEY_SCROLLOCK,

527 {0, "PAUSE", 
MWKEY_PAUSE
, MWKEY_PAUSE, MWKEY_PAUSE, 0},

528 {0, "INSERT", 
MWKEY_INSERT
, MWKEY_INSERT, MWKEY_INSERT, 0},

544 {0, "BACKSPACE", 
MWKEY_BACKSPACE
, MWKEY_BACKSPACE, MWKEY_BACKSPACE,

548 {0, "TAB", 
MWKEY_TAB
, MWKEY_TAB, MWKEY_TAB, 0},

564 {0, "CAPSLOCK", 
MWKEY_CAPSLOCK
, MWKEY_CAPSLOCK, MWKEY_CAPSLOCK,

565 
MWKEY_CAPSLOCK
},

577 {0, "ENTER", 
MWKEY_ENTER
, MWKEY_ENTER, MWKEY_ENTER, 0},

580 {0, "LSHIFT", 
MWKEY_LSHIFT
, MWKEY_LSHIFT, MWKEY_LSHIFT, MWKEY_LSHIFT},

590 {0, "RSHIFT", 
MWKEY_RSHIFT
, MWKEY_RSHIFT, MWKEY_RSHIFT, MWKEY_RSHIFT},

591 {0, "UP", 
MWKEY_UP
, MWKEY_UP, MWKEY_UP, 
MWKEY_PAGEUP
},

595 {0, "LCTRL", 
MWKEY_LCTRL
, MWKEY_LCTRL, MWKEY_LCTRL, MWKEY_LCTRL},

596 {0, "LMETA", 
MWKEY_LMETA
, MWKEY_LMETA, MWKEY_LMETA, MWKEY_LMETA},

597 {0, "LALT", 
MWKEY_LALT
, MWKEY_LALT, MWKEY_LALT, MWKEY_LALT},

600 {0, "RALT", 
MWKEY_RALT
, MWKEY_RALT, MWKEY_RALT, MWKEY_RALT},

601 {0, "RMETA", 
MWKEY_RMETA
, MWKEY_RMETA, MWKEY_RMETA, MWKEY_RMETA},

602 {0, "LEFT", 
MWKEY_LEFT
, MWKEY_LEFT, MWKEY_LEFT, 
MWKEY_HOME
},

603 {0, "DOWN", 
MWKEY_DOWN
, MWKEY_DOWN, MWKEY_DOWN, 
MWKEY_PAGEDOWN
},

604 {0, "RIGHT", 
MWKEY_RIGHT
, MWKEY_RIGHT, MWKEY_RIGHT, 
MWKEY_END
},

607 {0, 
NULL
, 0, 0, 0, 0}

610 
	gLIRC_‚
 = 0;

613 
	$ªmŸeKeybﬂrdH™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

614 
MWSCANCODE
 * 
psˇncode
)

616 
MWKEY
 
ch
;

617 
MWSCANCODE
 
sˇn
;

618 
keybﬂrdKey_t
 *
k
;

619 
MWBOOL
 
isDown
;

621 
Àn
 = 
	`°æí
(
evít
->
«me
);

622 i‡(
Àn
 < 2) {

623 
	`EPRINTF
("LIRC_Ród(Ë- InvÆid key '%s' -Åoÿsh‹t. (Mu° bê©Üó° 2 ch¨a˘îs!)\n", 
evít
->
«me
);

626 
Àn
--;

627 
evít
->
«me
[
Àn
]) {

629 
isDown
 = 1;

632 
isDown
 = 0;

635 
	`EPRINTF
("LIRC_Ród(Ë- InvÆid key '%s' -Çÿup/dow¿(^ o∏\\Ëödiˇt‹\n", 
evít
->
«me
);

638 
evít
->
«me
[
Àn
] = '\0';

640 i‡(0 =
	`°rcmp
(
evít
->
«me
, "fn")) {

641 
LIRC_‚
 = 
isDown
;

643 } i‡(0 =
	`°rcmp
(
evít
->
«me
, "lmb")) {

644  
	`LIRC_mou£Buâ⁄
(
MWBUTTON_L
, 
isDown
);

645 } i‡(0 =
	`°rcmp
(
evít
->
«me
, "rmb")) {

646  
	`LIRC_mou£Buâ⁄
(
MWBUTTON_R
, 
isDown
);

649 
k
 = 
keybﬂrdKeys
;

651 0 !
	`°rcmp
(
k
->
«me
, 
evít
->name)) {

652 
k
++;

653 i‡(
NULL
 =
k
->
«me
) {

654 
	`EPRINTF
("LIRC_Read() - Unrecognized key '%s'\n",

655 
evít
->
«me
);

660 i‡(
isDown
 =
k
->isDown)

663 
k
->
isDown
 = isDown;

665 
sˇn
 = 
k
->
n‹mÆ
;

666 
ch
 = ((
LIRC_‚
Ë? 
k
->
‚
 :

667 ((
LIRC_keymod
 & 
MWKMOD_NUM
Ë? 
k
->
num
 :

668 ((
LIRC_keymod
 & 
MWKMOD_SHIFT
Ë? 
k
->
shi·
 : (k->
n‹mÆ
))));

670 i‡(
ch
 == 0)

673 i‡(
LIRC_keymod
 & 
MWKMOD_CAPS
) {

675 i‡((
ch
 >= 'a') && (ch <= 'z')) {

676 
ch
 -= 'a' - 'A';

677 } i‡((
ch
 >= 'A') && (ch <= 'Z')) {

678 
ch
 += 'a' - 'A';

682 
	`LIRC_Upd©eKeySèã
(
isDown
, 
ch
);

685 *
kbuf
 = 
ch
;

686 *
psˇncode
 = 
sˇn
;

688  (
isDown
 ? 1 : 2 );

689 
	}
}

711 
	sªmŸeKey_t_


713 
	mcode
;

714 c⁄° *
	m«me
;

716 
	tªmŸeKey_t
;

718 c⁄° 
ªmŸeKey_t
 
	gªmŸeKeys
[] = {

719 {
MWKEY_ACCEPT
, "ACCEPT"},

720 {
MWKEY_BACKSPACE
, "BACKSPACE"},

721 {
MWKEY_BALANCE_LEFT
, "BALANCE_LEFT"},

722 {
MWKEY_BALANCE_RIGHT
, "BALANCE_RIGHT"},

723 {
MWKEY_BASS_BOOST_DOWN
, "BASS_BOOST_DOWN"},

724 {
MWKEY_BASS_BOOST_UP
, "BASS_BOOST_UP"},

725 {
MWKEY_CANCEL
, "CANCEL"},

726 {
MWKEY_CHANNEL_DOWN
, "CHANNEL_DOWN"},

727 {
MWKEY_CHANNEL_UP
, "CHANNEL_UP"},

728 {
MWKEY_CLEAR_FAVORITE_0
, "CLEAR_FAVORITE_0"},

729 {
MWKEY_CLEAR_FAVORITE_1
, "CLEAR_FAVORITE_1"},

730 {
MWKEY_CLEAR_FAVORITE_2
, "CLEAR_FAVORITE_2"},

731 {
MWKEY_CLEAR_FAVORITE_3
, "CLEAR_FAVORITE_3"},

732 {
MWKEY_COLORED_KEY_0
, "COLORED_KEY_0"},

733 {
MWKEY_COLORED_KEY_1
, "COLORED_KEY_1"},

734 {
MWKEY_COLORED_KEY_2
, "COLORED_KEY_2"},

735 {
MWKEY_COLORED_KEY_3
, "COLORED_KEY_3"},

736 {
MWKEY_COLORED_KEY_4
, "COLORED_KEY_4"},

737 {
MWKEY_COLORED_KEY_5
, "COLORED_KEY_5"},

738 {
MWKEY_DELETE
, "DELETE"},

739 {
MWKEY_DOWN
, "DOWN"},

740 {
MWKEY_DIMMER
, "DIMMER"},

741 {
MWKEY_DISPLAY_SWAP
, "DISPLAY_SWAP"},

742 {
MWKEY_EJECT_TOGGLE
, "EJECT_TOGGLE"},

743 {
MWKEY_END
, "END"},

744 {
MWKEY_ENTER
, "ENTER"},

745 {
MWKEY_ESCAPE
, "ESCAPE"},

746 {
MWKEY_F1
, "F1"},

747 {
MWKEY_F2
, "F2"},

748 {
MWKEY_F3
, "F3"},

749 {
MWKEY_F4
, "F4"},

750 {
MWKEY_F5
, "F5"},

751 {
MWKEY_F6
, "F6"},

752 {
MWKEY_F7
, "F7"},

753 {
MWKEY_F8
, "F8"},

754 {
MWKEY_F9
, "F9"},

755 {
MWKEY_F10
, "F10"},

756 {
MWKEY_F11
, "F11"},

757 {
MWKEY_F12
, "F12"},

758 {
MWKEY_FADER_FRONT
, "FADER_FRONT"},

759 {
MWKEY_FADER_REAR
, "FADER_REAR"},

760 {
MWKEY_FAST_FWD
, "FAST_FWD"},

761 {
MWKEY_GO_TO_END
, "GO_TO_END"},

762 {
MWKEY_GO_TO_START
, "GO_TO_START"},

763 {
MWKEY_GUIDE
, "GUIDE"},

764 {
MWKEY_HOME
, "HOME"},

765 {
MWKEY_INFO
, "INFO"},

767 {
MWKEY_LEFT
, "LEFT"},

768 {
MWKEY_MUTE
, "MUTE"},

769 {
MWKEY_PAGEDOWN
, "PAGEDOWN"},

770 {
MWKEY_PAGEUP
, "PAGEUP"},

771 {
MWKEY_PAUSE
, "PAUSE"},

772 {
MWKEY_PINP_TOGGLE
, "PINP_TOGGLE"},

773 {
MWKEY_PLAY
, "PLAY"},

774 {
MWKEY_PLAY_SPEED_DOWN
, "PLAY_SPEED_DOWN"},

775 {
MWKEY_PLAY_SPEED_RESET
, "PLAY_SPEED_RESET"},

776 {
MWKEY_PLAY_SPEED_UP
, "PLAY_SPEED_UP"},

777 {
MWKEY_POWER
, "POWER"},

778 {
MWKEY_PRINT
, "PRINT"},

779 {
MWKEY_RANDOM_TOGGLE
, "RANDOM_TOGGLE"},

780 {
MWKEY_RECALL_FAVORITE_0
, "RECALL_FAVORITE_0"},

781 {
MWKEY_RECALL_FAVORITE_1
, "RECALL_FAVORITE_1"},

782 {
MWKEY_RECALL_FAVORITE_2
, "RECALL_FAVORITE_2"},

783 {
MWKEY_RECALL_FAVORITE_3
, "RECALL_FAVORITE_3"},

784 {
MWKEY_RECORD
, "RECORD"},

785 {
MWKEY_RECORD_SPEED_NEXT
, "RECORD_SPEED_NEXT"},

786 {
MWKEY_REWIND
, "REWIND"},

787 {
MWKEY_RIGHT
, "RIGHT"},

788 {
MWKEY_SCAN_CHANNELS_TOGGLE
,"SCAN_CHANNELS_TOGGLE"},

789 {
MWKEY_SCREEN_MODE_NEXT
, "SCREEN_MODE_NEXT"},

792 {
MWKEY_SPLIT_SCREEN_TOGGLE
, "SPLIT_SCREEN_TOGGLE"},

793 {
MWKEY_STOP
, "STOP"},

794 {
MWKEY_STORE_FAVORITE_0
, "STORE_FAVORITE_0"},

795 {
MWKEY_STORE_FAVORITE_1
, "STORE_FAVORITE_1"},

796 {
MWKEY_STORE_FAVORITE_2
, "STORE_FAVORITE_2"},

797 {
MWKEY_STORE_FAVORITE_3
, "STORE_FAVORITE_3"},

798 {
MWKEY_SUBTITLE
, "SUBTITLE"},

799 {
MWKEY_SURROUND_MODE_NEXT
, "SURROUND_MODE_NEXT"},

800 {
MWKEY_TAB
, "TAB"},

801 {
MWKEY_TELETEXT
, "TELETEXT"},

802 {
MWKEY_TRACK_NEXT
, "TRACK_NEXT"},

803 {
MWKEY_TRACK_PREV
, "TRACK_PREV"},

804 {
MWKEY_UP
, "UP"},

805 {
MWKEY_VIDEO_MODE_NEXT
, "VIDEO_MODE_NEXT"},

806 {
MWKEY_VOLUME_DOWN
, "VOLUME_DOWN"},

807 {
MWKEY_VOLUME_UP
, "VOLUME_UP"},

808 {
MWKEY_WINK
, "WINK"},

809 {0, 
NULL
}

813 
	$ªmŸeC⁄åﬁH™dÀr
(
mwlúc_key°roke
 * 
evít
, 
MWKEY
 * 
kbuf
,

814 
MWSCANCODE
 * 
psˇncode
)

816 
MWKEY
 
ch
;

817 
Àn
 = 
	`°æí
(
evít
->
«me
);

819 i‡(
Àn
 == 1) {

821 
ch
 = 
evít
->
«me
[0];

825 c⁄° 
ªmŸeKey_t
 *
k
 = 
ªmŸeKeys
;

826 0 !
	`°rcmp
(
k
->
«me
, 
evít
->name)) {

827 
k
++;

828 i‡(
NULL
 =
k
->
«me
) {

829 
	`EPRINTF
("LIRC_Ród(Ë- Uƒecognized key '%s'\n", 
evít
->
«me
);

833 
ch
 = 
k
->
code
;

837 *
kbuf
 = 
ch
;

838 *
psˇncode
 = 
ch
;

841 
LIRC_≥ndög_keyªÀa£_ch
 = 
ch
;

842 
LIRC_≥ndög_keyªÀa£_sˇn
 = 
ch
;

844 
	}
}

	@drivers/kbd_null.c

6 
	~<°dio.h
>

7 
	~"devi˚.h
"

9 
NUL_O≥n
(
KBDDEVICE
 *
pkd
);

10 
NUL_Clo£
();

11 
NUL_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

12 
NUL_Ród
(
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

13 
NUL_Pﬁl
();

15 
KBDDEVICE
 
	gkbddev
 = {

16 
NUL_O≥n
,

17 
NUL_Clo£
,

18 
NUL_GëModifõrInfo
,

19 
NUL_Ród
,

20 
NUL_Pﬁl


27 
	$NUL_Pﬁl
()

30 
	}
}

36 
	$NUL_O≥n
(
KBDDEVICE
 *
pkd
)

39 
	}
}

45 
	$NUL_Clo£
()

47 
	}
}

53 
	$NUL_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

55 i‡(
modifõrs
)

56 *
modifõrs
 = 0;

57 i‡(
curmodifõrs
)

58 *
curmodifõrs
 = 0;

59 
	}
}

68 
	$NUL_Ród
(
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
)

71 
	}
}

	@drivers/kbd_pac.c

9 
	~"devi˚.h
"

10 
	~<dos.h
>

11 
	~<c⁄io.h
>

14 
KBD_O≥n
(
KBDDEVICE
 *
pkd
);

15 
KBD_Clo£
();

16 
KBD_GëModifõrInfo
(*
modifõrs
);

17 
KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
);

18 
KBD_Pﬁl
();

21 
KBDDEVICE
 
	gkbddev
 = {

22 
KBD_O≥n
,

23 
KBD_Clo£
,

24 
KBD_GëModifõrInfo
,

25 
KBD_Ród
,

26 
KBD_Pﬁl


34 
	$KBD_O≥n
(
KBDDEVICE
 *
pkd
)

37 
	}
}

43 
	$KBD_Clo£
()

45 
	}
}

51 
	$KBD_GëModifõrInfo
(*
modifõrs
)

53 *
modifõrs
 = 0;

54 
	}
}

62 
	$KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
)

64 
REGS
 
ªg
;

67 i‡(!
	`kbhô
())

71 
ªg
.
x
.
ax
 = 0x0200;

72 
	`öt86
(0x16, &
ªg
, &reg);

73 *
modifõrs
 = 
ªg
.
x
.
ax
;

76 
ªg
.
x
.
ax
 = 0x1000;

77 
	`öt86
(0x16, &
ªg
, &reg);

78 *
buf
 = (
ªg
.
x
.
ax
 & 0x00ff);

80 if(*
buf
 == 0x1b)

83 
	}
}

89 
	$KBD_Pﬁl
()

91 i‡(
	`kbhô
())

95 
	}
}

	@drivers/kbd_pipe.c

11 
	~<°dio.h
>

12 
	~<°ddef.h
>

13 
	~<°dlib.h
>

14 
	~<uni°d.h
>

15 
	~<î∫o.h
>

16 
	~<°rög.h
>

17 
	~<f˙é.h
>

18 
	~<sys/°©.h
>

19 
	~<sys/ty≥s.h
>

20 
	~"devi˚.h
"

22 
	gkbdName
[] = "/tmp/.nano-X-softkbd";

23 
	#KBD_NAMED_PIPE
 
kbdName


	)

25 
	#_SOFT_DEBUG
 0

	)

27 
	gkbd_fd
 = -1;

29 
so·_O≥n
(
KBDDEVICE
* 
pkd
);

30 
so·_Clo£
();

31 
so·_GëModifõrInfo
(
MWKEYMOD
* 
modifõrs
, MWKEYMOD* 
curmodifõrs
);

32 
so·_Ród
(
MWKEY
* 
buf
, 
MWKEYMOD
* 
modifõrs
, 
MWSCANCODE
* 
sˇncode
);

34 
KBDDEVICE
 
	gkbddev
 = {

35 
so·_O≥n
,

36 
so·_Clo£
,

37 
so·_GëModifõrInfo
,

38 
so·_Ród
,

39 
NULL


46 
	$so·_O≥n
(
KBDDEVICE
* 
pkd
)

48 
°©
 
s
;

51 i‡(!
	`°©
(
KBD_NAMED_PIPE
, &
s
)) {

52 i‡(
	`u∆ök
(
KBD_NAMED_PIPE
) < 0)

55 i‡(
	`mkfifo
(
KBD_NAMED_PIPE
, 0600) < 0) {

56 
	`EPRINTF
("mkfifo()Érror %d ('%s')\n", \

57 
î∫o
, 
sys_îæi°
[errno]);

62 i‡((
kbd_fd
 = 
	`›í
(
KBD_NAMED_PIPE
, 
O_RDONLY
 | 
O_NONBLOCK
)) < 0) {

63 
	`EPRINTF
("open()Érror %d ('%s')\n", \

64 
î∫o
, 
sys_îæi°
[errno]);

68  
kbd_fd
;

69 
	}
}

75 
	$so·_Clo£
()

77 #i‡
_SOFT_DEBUG


78 
	`EPRINTF
("kbd_so·.c: so·_Clo£(): closögÇamedÖùê%d\n", 
kbd_fd
);

80 i‡(
kbd_fd
 >= 0)

81 
	`˛o£
(
kbd_fd
);

82 
kbd_fd
 = -1;

84 
	`u∆ök
(
KBD_NAMED_PIPE
);

85 
	}
}

91 
	$so·_GëModifõrInfo
(
MWKEYMOD
* 
modifõrs
, MWKEYMOD* 
curmodifõrs
)

93 #i‡
_SOFT_DEBUG


94 
	`EPRINTF
("kbd_soft.c: soft_GetModifierInfo(): beingáskedábout modifiers\n");

96 i‡(
modifõrs
)

97 *
modifõrs
 = 0;

98 i‡(
curmodifõrs
)

99 *
curmodifõrs
 = 0;

100 
	}
}

109 
	$so·_Ród
(
MWKEY
* 
buf
, 
MWKEYMOD
* 
modifõrs
, 
MWSCANCODE
* 
sˇncode
)

111 
cc
;

112 *
modifõrs
 = 0;

113 *
sˇncode
 = 0;

115 
cc
 = 
	`ªad
(
kbd_fd
, 
buf
, 1);

117 i‡(
cc
 > 0) {

118 if(*
buf
 == 0x1b)

120 #i‡
_SOFT_DEBUG


121 
	`EPRINTF
("kbd_soft.c: soft_Read():Ñead '%c', cc = %d\n",

122 
buf
[0], 
cc
);

123 
	`fÊush
(
NULL
);

129 
	}
}

	@drivers/kbd_rtems.c

25 
	~<°dio.h
>

26 
	~<°dlib.h
>

27 
	~<f˙é.h
>

28 
	~<sys/io˘l.h
>

29 
	~<î∫o.h
>

31 
	~<πems/mw_uid.h
>

32 
	~"devi˚.h
"

34 
˛o£
 (
fd
);

36 
	#SCALE
 3

	)

37 
	#THRESH
 5

	)

40 
MWKbd_O≥n
 (
KBDDEVICE
 *
pkd
);

41 
MWKbd_Clo£
 ();

42 
MWKbd_GëModifõrInfo
 (
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

43 
MWKbd_Ród
 (
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

45 
KBDDEVICE
 
	gkbddev
 = {

46 
MWKbd_O≥n
,

47 
MWKbd_Clo£
,

48 
MWKbd_GëModifõrInfo
,

49 
MWKbd_Ród
,

50 
NULL


53 
MW_UID_MESSAGE
 
	gm_kbd
 = { 0 };

54 
	gkbd_fd
 = -1;

55 c⁄° *
	gQ_NAME
 = "MWQ";

56 
	#Q_MAX_MSGS
 20

	)

63 
	$MWKbd_O≥n
 (
KBDDEVICE
 *
pkd
)

65 
rc
;

66 
m_kbd
.
ty≥
 = 
MV_UID_INVALID
;

67 
kbd_fd
 = 
	`fûío
 (
°dö
);

68 
rc
 = 
	`uid_›í_queue
 (
Q_NAME
, 
O_CREAT
 | 
O_RDWR
, 
Q_MAX_MSGS
);

69 
	`uid_ªgi°î_devi˚
 (
kbd_fd
, 
Q_NAME
);

71 
	}
}

77 
	$MWKbd_Clo£
 ()

79 
	`uid_uƒegi°î_devi˚
 (
kbd_fd
);

80 
	`uid_˛o£_queue
 ();

81 
	`˛o£
 (
kbd_fd
);

82 
	}
}

88 
	$MWKbd_GëModifõrInfo
 (
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

90 *
modifõrs
 = 0;

91 
	}
}

99 
	$MWKbd_Ród
 (
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
)

102 if–
m_kbd
.
ty≥
 !
MV_UID_INVALID
 )

104 *
buf
 = 
m_kbd
.
m
.
kbd
.
code
;

106 *
modifõrs
 = 0;

109 
m_kbd
.
ty≥
 = 
MV_UID_INVALID
;

113 
	}
}

	@drivers/kbd_tc.c

9 
	~"devi˚.h
"

10 
	~<bios.h
>

12 
KBD_O≥n
(
KBDDEVICE
 *
pkd
);

13 
KBD_Clo£
();

14 
KBD_GëModifõrInfo
(*
modifõrs
);

15 
KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
);

16 
KBD_Pﬁl
();

18 
KBDDEVICE
 
	gkbddev
 = {

19 
KBD_O≥n
,

20 
KBD_Clo£
,

21 
KBD_GëModifõrInfo
,

22 
KBD_Ród
,

23 
KBD_Pﬁl


30 
	$KBD_O≥n
(
KBDDEVICE
 *
pkd
)

33 
	}
}

39 
	$KBD_Clo£
()

41 
	}
}

47 
	$KBD_GëModifõrInfo
(*
modifõrs
)

49 *
modifõrs
 = 
	`bioskey
(2);

50 
	}
}

58 
	$KBD_Ród
(
MWUCHAR
 *
buf
, *
modifõrs
)

61 if(!
	`bioskey
(1))

65 *
modifõrs
 = 
	`bioskey
(2);

68 *
buf
 = 
	`bioskey
(0);

70 if(*
buf
 == 0x1b)

73 
	}
}

76 
	$KBD_Pﬁl
()

78 i‡(
	`bioskey
(1)!=0)

82 
	}
}

	@drivers/kbd_tty.c

12 
	~<°dlib.h
>

13 
	~<sys/ty≥s.h
>

14 
	~<f˙é.h
>

15 
	~<uni°d.h
>

16 
	~<î∫o.h
>

17 
	~<ãrmios.h
>

18 
	~"devi˚.h
"

22 #i‡
ELKS


23 
	#KEYBOARD
 "/dev/ây1"

	)

25 
	#KEYBOARD
 "/dev/ây"

	)

28 
	#CTRL
(
x
Ë((xË& 0x1f)

	)

30 
esˇ≥_quôs
;

32 
TTY_O≥n
(
KBDDEVICE
 *
pkd
);

33 
TTY_Clo£
();

34 
TTY_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

35 
TTY_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

36 
TTY_Pﬁl
();

38 
KBDDEVICE
 
	gkbddev
 = {

39 
TTY_O≥n
,

40 
TTY_Clo£
,

41 
TTY_GëModifõrInfo
,

42 
TTY_Ród
,

43 #i‡
_MINIX


44 
TTY_Pﬁl


46 
NULL


50 
	gfd
;

51 
ãrmios
 
	gﬁd
;

60 
	$TTY_O≥n
(
KBDDEVICE
 *
pkd
)

62 * 
kbd
;

63 
ãrmios
 
√w
;

66 i‡(!(
kbd
 = 
	`gëív
("CONSOLE")))

67 
kbd
 = 
KEYBOARD
;

68 
fd
 = 
	`›í
(
kbd
, 
O_NONBLOCK
);

69 i‡(
fd
 < 0)

72 i‡(
	`tcgë©å
(
fd
, &
ﬁd
) < 0)

73 
îr
;

75 
√w
 = 
ﬁd
;

77 
√w
.
c_lÊag
 &~(
ECHO
 | 
ICANON
 | 
IEXTEN
 );

78 
√w
.
c_iÊag
 &~(
ICRNL
 | 
INPCK
 | 
ISTRIP
 | 
IXON
 );

79 
√w
.
c_cÊag
 &~(
CSIZE
 | 
PARENB
);

80 
√w
.
c_cÊag
 |
CS8
;

81 
√w
.
c_cc
[
VMIN
] = 0;

82 
√w
.
c_cc
[
VTIME
] = 0;

84 if(
	`tc£èâr
(
fd
, 
TCSAFLUSH
, &
√w
) < 0)

85 
îr
;

86  
fd
;

88 
îr
:

89 
	`˛o£
(
fd
);

90 
fd
 = 0;

92 
	}
}

99 
	$TTY_Clo£
()

101 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ﬁd
);

102 
	`˛o£
(
fd
);

103 
fd
 = 0;

104 
	}
}

110 
	$TTY_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

112 i‡(
modifõrs
)

113 *
modifõrs
 = 0;

114 i‡(
curmodifõrs
)

115 *
curmodifõrs
 = 0;

116 
	}
}

125 
	$TTY_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
)

127 #i‡
TRANSLATE_ESCAPE_SEQUENCES


128 
buf
[5];

129 
buÊí
 = 0;

131 
buf
[1];

132 c⁄° 
buÊí
 = 0;

134 
cc
;

135 
MWKEY
 
mwkey
;

137 
cc
 = 
	`ªad
(
fd
, 
buf
 + 
buÊí
, 1);

138 i‡((
cc
 < 0Ë&& (
î∫o
 !
EINTR
Ë&& (î∫ÿ!
EAGAIN
)) {

141 i‡(
cc
 <= 0) {

145 
mwkey
 = 
buf
[0];

146 #i‡
TRANSLATE_ESCAPE_SEQUENCES


147 i‡(
mwkey
 == 27) {

148 
mwkey
 = 0;

149 
buÊí
 +
cc
;

150 i‡(
buÊí
 < 3) {

153 
cc
 = 
	`ªad
(
fd
, 
buf
 + 
buÊí
, 3 - buflen);

154 } (
cc
 < 0Ë&& ((
î∫o
 =
EINTR
Ë|| (î∫ÿ=
EAGAIN
)));

155 i‡(
cc
 < 0) {

158 
buÊí
 +
cc
;

159 i‡(
buÊí
 < 3) {

165 
buf
[1]) {

167 
buf
[2]) {

168 'P': 
mwkey
 = 
MWKEY_F1
; ;

169 'Q': 
mwkey
 = 
MWKEY_F2
; ;

170 'R': 
mwkey
 = 
MWKEY_F3
; ;

171 'S': 
mwkey
 = 
MWKEY_F4
; ;

175 
buf
[2]) {

176 '5': i‡(
buÊí
 < 4)  0;

177 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F5
;

179 '7': i‡(
buÊí
 < 4)  0;

180 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F6
;

182 '8': i‡(
buÊí
 < 4)  0;

183 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F7
;

185 '9': i‡(
buÊí
 < 4)  0;

186 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F8
;

191 
buf
[2]) {

192 '0': i‡(
buÊí
 < 4)  0;

193 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F9
;

195 '1': i‡(
buÊí
 < 4)  0;

196 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F10
;

198 '3': i‡(
buÊí
 < 4)  0;

199 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F11
;

201 '4': i‡(
buÊí
 < 4)  0;

202 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_F12
;

207 
buf
[2]) {

209 i‡(
buÊí
 < 4)

211 
buf
[3]) {

212 '~': 
mwkey
 = 
MWKEY_HOME
;

214 '5': i‡(
buÊí
 < 5)  0;

215 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F5
;

217 '7': i‡(
buÊí
 < 5)  0;

218 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F6
;

220 '8': i‡(
buÊí
 < 5)  0;

221 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F7
;

223 '9': i‡(
buÊí
 < 5)  0;

224 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F8
;

229 i‡(
buÊí
 < 4)

231 
buf
[3]) {

232 '~': 
mwkey
 = 
MWKEY_INSERT
; ;

233 '0': i‡(
buÊí
 < 5)  0;

234 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F9
;

236 '1': i‡(
buÊí
 < 5)  0;

237 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F10
;

239 '3': i‡(
buÊí
 < 5)  0;

240 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F11
;

242 '4': i‡(
buÊí
 < 5)  0;

243 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F12
;

247 '3': i‡(
buÊí
 < 4)  0;

248 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_DELETE
;

250 '4': i‡(
buÊí
 < 4)  0;

251 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_END
;

253 '5': i‡(
buÊí
 < 4)  0;

254 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_PAGEUP
;

256 '6': i‡(
buÊí
 < 4)  0;

257 i‡(
buf
[3] ='~'Ë
mwkey
 = 
MWKEY_PAGEDOWN
;

259 'A': 
mwkey
 = 
MWKEY_UP
; ;

260 'B': 
mwkey
 = 
MWKEY_DOWN
; ;

261 'C': 
mwkey
 = 
MWKEY_RIGHT
; ;

262 'D': 
mwkey
 = 
MWKEY_LEFT
; ;

263 'F': 
mwkey
 = 
MWKEY_END
; ;

264 'H': 
mwkey
 = 
MWKEY_HOME
; ;

266 i‡(
buÊí
 < 4)

268 
buf
[3]) {

269 '7': i‡(
buÊí
 < 5)  0;

270 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F6
;

272 '8': i‡(
buÊí
 < 5)  0;

273 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F7
;

275 '9': i‡(
buÊí
 < 5)  0;

276 i‡(
buf
[4] ='~'Ë
mwkey
 = 
MWKEY_F8
;

278 'A': 
mwkey
 = 
MWKEY_F1
; ;

279 'B': 
mwkey
 = 
MWKEY_F2
; ;

280 'C': 
mwkey
 = 
MWKEY_F3
; ;

281 'D': 
mwkey
 = 
MWKEY_F4
; ;

282 'E': 
mwkey
 = 
MWKEY_F5
; ;

288 i‡(
buf
[2] =27Ë
mwkey
 = 
MWKEY_ESCAPE
;

291 i‡(
mwkey
 == 0) {

292 i‡(
buÊí
 >= 5) {

293 
	`EPRINTF
("WARNING: UnknownÉscape sequence ESC '%c' '%c' '%c' '%c'.\n"

295 
buf
[1], buf[2], buf[3], buf[4]);

296 } i‡(
buÊí
 == 4) {

297 
	`EPRINTF
("WARNING: UnknownÉscape sequence ESC '%c' '%c' '%c'.\n"

299 
buf
[1], buf[2], buf[3]);

301 
	`EPRINTF
("WARNING: UnknownÉscape sequence ESC '%c' '%c'.\n"

303 
buf
[1], buf[2]);

305 
buÊí
 = 0;

308 #ifde‡
DEBUG_ESCAPE_SEQUENCES


309 i‡(
buÊí
 >= 5) {

310 
	`EPRINTF
("Got chars: ESC '%c' '%c' '%c' '%c'.\n",

311 
buf
[1], buf[2], buf[3], buf[4]);

312 } i‡(
buÊí
 == 4) {

313 
	`EPRINTF
("Got chars: ESC '%c' '%c' '%c'.\n",

314 
buf
[1], buf[2], buf[3]);

316 
	`EPRINTF
("Got chars: ESC '%c' '%c'.\n",

317 
buf
[1], buf[2]);

321 
buÊí
 = 0;

325 i‡(
mwkey
 =
	`CTRL
('P'))

326 
mwkey
 = 
MWKEY_PRINT
;

330 i‡((
mwkey
 =
MWKEY_ESCAPE
Ë&& 
esˇ≥_quôs
)

331 
mwkey
 = 
MWKEY_QUIT
;

333 #ifde‡
DEBUG_ESCAPE_SEQUENCES


334 i‡(
buf
[0] != 27) {

335 
	`EPRINTF
("GŸ ch¨: '%c'.\n", 
buf
[0]);

337 
	`EPRINTF
("GŸ key: %d\n", 
mwkey
);

340 *
kbuf
 = 
mwkey
;

341 *
modifõrs
 = 0;

342 *
sˇncode
 = 0;

344 
	}
}

347 
	$TTY_Pﬁl
()

350 
	}
}

	@drivers/kbd_ttyscan.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<uni°d.h
>

10 
	~<sys/ty≥s.h
>

11 
	~<f˙é.h
>

12 
	~<î∫o.h
>

13 
	~<ãrmios.h
>

14 
	~<sys/io˘l.h
>

15 
	~<löux/keybﬂrd.h
>

16 
	~<löux/kd.h
>

17 
	~<löux/vt.h
>

18 
	~"devi˚.h
"

19 
	~"fb.h
"

21 
	#KEYBOARD
 "/dev/ây"

	)

23 
TTY_O≥n
(
KBDDEVICE
 *
pkd
);

24 
TTY_Clo£
();

25 
TTY_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

26 
TTY_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

28 
KBDDEVICE
 
	gkbddev
 = {

29 
TTY_O≥n
,

30 
TTY_Clo£
,

31 
TTY_GëModifõrInfo
,

32 
TTY_Ród
,

33 
NULL


36 
	#RELEASED
 0

	)

37 
	#PRESSED
 1

	)

39 
	gfd
;

40 
ãrmios
 
	gﬁd
;

41 
	gﬁd_kbd_mode
;

42 
	gkey_°©e
[
MWKEY_LAST
];

43 
MWKEYMOD
 
	gkey_mod°©e
;

46 
	#NUM_VGAKEYMAPS
 (1<<
KG_CAPSSHIFT
Ë

	)

47 
	gos_keym≠
[
NUM_VGAKEYMAPS
][
NR_KEYS
];

51 #i‡
KBD_ZAURUS


52 
	~"keym≠_zaurus.h
"

54 
	~"keym≠_°™d¨d.h
"

57 
MWBOOL
 
Upd©eKeySèã
(
¥es£d
, 
MWKEY
 
mwkey
);

58 
Upd©eLEDSèã
(
MWKEYMOD
 
mod°©e
);

59 
MWKEY
 
Tøn¶©eSˇncode
(
sˇncode
, 
MWKEYMOD
 
mod°©e
);

60 
LﬂdKî√lKeym≠s
(
fd
);

61 
MWBOOL
 
swôch_vt
(
which
);

70 
	$TTY_O≥n
(
KBDDEVICE
 *
pkd
)

72 
i
;

73 
Àd°©e
 = 0;

74 * 
kbd
;

75 
ãrmios
 
√w
;

78 if(!(
kbd
 = 
	`gëív
("CONSOLE")))

79 
kbd
 = 
KEYBOARD
;

80 
fd
 = 
	`›í
(
kbd
, 
O_NONBLOCK
);

81 i‡(
fd
 < 0)

85 i‡(
	`io˘l
(
fd
, 
KDGKBMODE
, &
ﬁd_kbd_mode
) < 0) {

86 
	`≥º‹
("KDGKMODE");

87 
îr
;

89 i‡(
	`tcgë©å
(
fd
, &
ﬁd
) < 0)

90 
îr
;

93 
√w
 = 
ﬁd
;

95 
√w
.
c_lÊag
 &~(
ICANON
 | 
ECHO
 | 
ISIG
);

96 
√w
.
c_iÊag
 &~(
ISTRIP
 | 
IGNCR
 | 
ICRNL
 | 
INLCR
 | 
IXOFF
 | 
IXON


97 | 
BRKINT
);

98 
√w
.
c_cc
[
VMIN
] = 0;

99 
√w
.
c_cc
[
VTIME
] = 0;

101 i‡(
	`tc£èâr
(
fd
, 
TCSAFLUSH
, &
√w
) < 0) {

102 
	`TTY_Clo£
();

105 i‡(
	`io˘l
(
fd
, 
KDSKBMODE
, 
K_MEDIUMRAW
) < 0) {

106 
	`TTY_Clo£
();

111 
	`LﬂdKî√lKeym≠s
(
fd
);

114 
key_mod°©e
 = 
MWKMOD_NONE
;

115 
i
=0; i<
MWKEY_LAST
; ++i)

116 
key_°©e
[
i
] = 
RELEASED
;

119 i‡(
	`io˘l
(
fd
, 
KDGETLED
, &
Àd°©e
) == 0) {

120 i‡(
Àd°©e
 & 
LED_CAP
) {

121 
key_mod°©e
 |
MWKMOD_CAPS
;

122 
key_°©e
[
MWKEY_CAPSLOCK
] = 
PRESSED
;

124 i‡(
Àd°©e
 & 
LED_NUM
) {

125 
key_mod°©e
 |
MWKMOD_NUM
;

126 
key_°©e
[
MWKEY_NUMLOCK
] = 
PRESSED
;

129 
	`Upd©eLEDSèã
(
key_mod°©e
);

131  
fd
;

133 
îr
:

134 
	`˛o£
(
fd
);

135 
fd
 = -1;

137 
	}
}

144 
	$TTY_Clo£
()

146 
Àd°©e
 = 0x80000000L;

148 i‡(
fd
 >= 0) {

150 i‡(
	`io˘l
(
fd
, 
KDSETLED
, 
Àd°©e
) < 0)

151 
	`≥º‹
("KDSETLED");

154 i‡(
	`io˘l
(
fd
, 
KDSKBMODE
, 
ﬁd_kbd_mode
) < 0)

155 
	`≥º‹
("KDSKBMODE");

156 
	`tc£èâr
(
fd
, 
TCSAFLUSH
, &
ﬁd
);

158 
	`˛o£
(
fd
);

160 
fd
 = -1;

161 
	}
}

167 
	$TTY_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

169 i‡(
modifõrs
)

170 *
modifõrs
 = 
MWKMOD_CTRL
 | 
MWKMOD_SHIFT
 | 
MWKMOD_ALT
 |

171 
MWKMOD_META
 | 
MWKMOD_ALTGR
 | 
MWKMOD_CAPS
 | 
MWKMOD_NUM
;

172 i‡(
curmodifõrs
)

173 *
curmodifõrs
 = 
key_mod°©e
;

174 
	}
}

183 
	$TTY_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
psˇncode
)

185 
cc
;

186 
¥es£d
;

187 
sˇncode
;

188 
MWKEY
 
mwkey
;

189 
buf
[128];

191 
cc
 = 
	`ªad
(
fd
, 
buf
, 1);

192 i‡(
cc
 > 0) {

193 
¥es£d
 = (*
buf
 & 0x80Ë? 
RELEASED
: 
PRESSED
;

194 
sˇncode
 = *
buf
 & 0x7f;

195 
mwkey
 = 
keym≠
[
sˇncode
];

203 
mwkey
) {

204 
MWKEY_F1
:

205 
MWKEY_F2
:

206 
MWKEY_F3
:

207 
MWKEY_F4
:

208 
MWKEY_F5
:

209 
MWKEY_F6
:

210 
MWKEY_F7
:

211 
MWKEY_F8
:

212 
MWKEY_F9
:

213 
MWKEY_F10
:

214 
MWKEY_F11
:

215 
MWKEY_F12
:

216 i‡(
key_mod°©e
 & 
MWKMOD_ALT
) {

217 i‡(
	`swôch_vt
(
mwkey
-
MWKEY_F1
+1)) {

218 
mwkey
 = 
MWKEY_REDRAW
;

225 i‡(!
	`Upd©eKeySèã
(
¥es£d
, 
mwkey
))

229 if(
mwkey
 !
MWKEY_LCTRL
 &&

230 
mwkey
 !
MWKEY_RCTRL
 &&

231 
mwkey
 !
MWKEY_LALT
 &&

232 
mwkey
 !
MWKEY_RALT
 &&

233 
mwkey
 !
MWKEY_RSHIFT
 &&

234 
mwkey
 !
MWKEY_LSHIFT
) {

236 
mwkey
 = 
	`Tøn¶©eSˇncode
(
sˇncode
, 
key_mod°©e
);

245 
sˇncode
) {

276 
sˇncode
 += 8;

280 
sˇncode
 -= 0x4;

284 
sˇncode
 -= 0x5;

290 
sˇncode
 -= 0x4;

295 
sˇncode
 -= 0x5;

300 
sˇncode
 -= 0x4;

309 *
kbuf
 = 
mwkey
;

310 *
modifõrs
 = 
key_mod°©e
;

311 *
psˇncode
 = 
sˇncode
;

317  
¥es£d
 ? 1 : 2;

320 i‡((
cc
 < 0Ë&& (
î∫o
 !
EINTR
Ë&& (î∫ÿ!
EAGAIN
))

323 
	}
}

326 
MWBOOL


327 
	$Upd©eKeySèã
(
¥es£d
, 
MWKEY
 
mwkey
)

329 
MWKEYMOD
 
mod°©e
 = 
key_mod°©e
;

332 i‡(
¥es£d
 =
PRESSED
) {

333 
mwkey
) {

334 
MWKEY_NUMLOCK
:

335 
MWKEY_CAPSLOCK
:

337  
FALSE
;

338 
MWKEY_LCTRL
:

339 
mod°©e
 |
MWKMOD_LCTRL
;

341 
MWKEY_RCTRL
:

342 
mod°©e
 |
MWKMOD_RCTRL
;

344 
MWKEY_LSHIFT
:

345 
mod°©e
 |
MWKMOD_LSHIFT
;

347 
MWKEY_RSHIFT
:

348 
mod°©e
 |
MWKMOD_RSHIFT
;

350 
MWKEY_LALT
:

351 
mod°©e
 |
MWKMOD_LALT
;

353 
MWKEY_RALT
:

354 
mod°©e
 |
MWKMOD_RALT
;

356 
MWKEY_LMETA
:

357 
mod°©e
 |
MWKMOD_LMETA
;

359 
MWKEY_RMETA
:

360 
mod°©e
 |
MWKMOD_RMETA
;

362 
MWKEY_ALTGR
:

363 
mod°©e
 |
MWKMOD_ALTGR
;

369 
mwkey
) {

370 
MWKEY_NUMLOCK
:

371 
key_mod°©e
 ^
MWKMOD_NUM
;

372 
key_°©e
[
MWKEY_NUMLOCK
] ^
PRESSED
;

373 
	`Upd©eLEDSèã
(
key_mod°©e
);

374  
TRUE
;

375 
MWKEY_CAPSLOCK
:

376 
key_mod°©e
 ^
MWKMOD_CAPS
;

377 
key_°©e
[
MWKEY_CAPSLOCK
] ^
PRESSED
;

378 
	`Upd©eLEDSèã
(
key_mod°©e
);

379  
TRUE
;

380 
MWKEY_LCTRL
:

381 
mod°©e
 &~
MWKMOD_LCTRL
;

383 
MWKEY_RCTRL
:

384 
mod°©e
 &~
MWKMOD_RCTRL
;

386 
MWKEY_LSHIFT
:

387 
mod°©e
 &~
MWKMOD_LSHIFT
;

389 
MWKEY_RSHIFT
:

390 
mod°©e
 &~
MWKMOD_RSHIFT
;

392 
MWKEY_LALT
:

393 
mod°©e
 &~
MWKMOD_LALT
;

395 
MWKEY_RALT
:

396 
mod°©e
 &~
MWKMOD_RALT
;

398 
MWKEY_LMETA
:

399 
mod°©e
 &~
MWKMOD_LMETA
;

401 
MWKEY_RMETA
:

402 
mod°©e
 &~
MWKMOD_RMETA
;

404 
MWKEY_ALTGR
:

405 
mod°©e
 &~
MWKMOD_ALTGR
;

414 i‡(
key_°©e
[
mwkey
] =
¥es£d
)

415  
FALSE
;

418 
key_°©e
[
mwkey
] = ()
¥es£d
;

419 
key_mod°©e
 = 
mod°©e
;

420  
TRUE
;

421 
	}
}

424 
	$Upd©eLEDSèã
(
MWKEYMOD
 
mod°©e
)

426 
Àd°©e
 = 0;

428 i‡(
mod°©e
 & 
MWKMOD_CAPS
)

429 
Àd°©e
 |
LED_CAP
;

430 i‡(
mod°©e
 & 
MWKMOD_NUM
)

431 
Àd°©e
 |
LED_NUM
;

432 
	`io˘l
(
fd
, 
KDSETLED
, 
Àd°©e
);

433 
	}
}

436 
MWKEY


437 
	$Tøn¶©eSˇncode
(
sˇncode
, 
MWKEYMOD
 
mod°©e
)

439 
mwkey
 = 0;

440 
m≠
 = 0;

445 i‡(
mod°©e
 & 
MWKMOD_SHIFT
)

446 
m≠
 |(1<<
KG_SHIFT
);

447 i‡(
mod°©e
 & 
MWKMOD_CTRL
)

448 
m≠
 |(1<<
KG_CTRL
);

449 i‡(
mod°©e
 & 
MWKMOD_ALT
)

450 
m≠
 |(1<<
KG_ALT
);

451 i‡(
mod°©e
 & 
MWKMOD_ALTGR
)

452 
m≠
 |(1<<
KG_ALTGR
);

453 i‡(
	`KTYP
(
os_keym≠
[
m≠
][
sˇncode
]Ë=
KT_LETTER
) {

454 i‡(
mod°©e
 & 
MWKMOD_CAPS
)

455 
m≠
 |(1<<
KG_SHIFT
);

457 i‡(
	`KTYP
(
os_keym≠
[
m≠
][
sˇncode
]Ë=
KT_PAD
) {

458 i‡(
mod°©e
 & 
MWKMOD_NUM
) {

459 
keym≠
[
sˇncode
]) {

460 
MWKEY_KP0
:

461 
MWKEY_KP1
:

462 
MWKEY_KP2
:

463 
MWKEY_KP3
:

464 
MWKEY_KP4
:

465 
MWKEY_KP5
:

466 
MWKEY_KP6
:

467 
MWKEY_KP7
:

468 
MWKEY_KP8
:

469 
MWKEY_KP9
:

470 
mwkey
 = 
keym≠
[
sˇncode
] - 
MWKEY_KP0
 + '0';

472 
MWKEY_KP_PERIOD
:

473 
mwkey
 = '.';

475 
MWKEY_KP_DIVIDE
:

476 
mwkey
 = '/';

478 
MWKEY_KP_MULTIPLY
:

479 
mwkey
 = '*';

481 
MWKEY_KP_MINUS
:

482 
mwkey
 = '-';

484 
MWKEY_KP_PLUS
:

485 
mwkey
 = '+';

487 
MWKEY_KP_ENTER
:

488 
mwkey
 = 
MWKEY_ENTER
;

490 
MWKEY_KP_EQUALS
:

491 
mwkey
 = '-';

496 
mwkey
 = 
	`KVAL
(
os_keym≠
[
m≠
][
sˇncode
]);

498 i‡(!
mwkey
)

499 
mwkey
 = 
keym≠
[
sˇncode
];

502 
mwkey
) {

504 
mwkey
 = 
MWKEY_BACKSPACE
;

506 
MWKEY_BREAK
:

507 
MWKEY_PAUSE
:

508 
mwkey
 = 
MWKEY_QUIT
;

511 
MWKEY_SYSREQ
:

512 
mwkey
 = 
MWKEY_PRINT
;

517  
mwkey
;

518 
	}
}

522 
	$LﬂdKî√lKeym≠s
(
fd
)

524 
m≠
, 
i
;

525 
kbíåy
 
íåy
;

528 
m≠
=0; m≠<
NUM_VGAKEYMAPS
; ++map) {

529 
	`mem£t
(
os_keym≠
[
m≠
], 0, 
NR_KEYS
*());

530 
i
=0; i<
NR_KEYS
; ++i) {

531 
íåy
.
kb_èbÀ
 = 
m≠
;

532 
íåy
.
kb_ödex
 = 
i
;

533 i‡(
	`io˘l
(
fd
, 
KDGKBENT
, &
íåy
) == 0) {

535 i‡(
íåy
.
kb_vÆue
 =
K_ENTER
)

536 
íåy
.
kb_vÆue
 = 
	`K
(
KT_ASCII
,13);

538 i‡((
	`KTYP
(
íåy
.
kb_vÆue
Ë=
KT_LATIN
) ||

539 (
	`KTYP
(
íåy
.
kb_vÆue
Ë=
KT_ASCII
) ||

540 (
	`KTYP
(
íåy
.
kb_vÆue
Ë=
KT_PAD
) ||

541 (
	`KTYP
(
íåy
.
kb_vÆue
Ë=
KT_LETTER
)

543 
os_keym≠
[
m≠
][
i
] = 
íåy
.
kb_vÆue
;

548 
	}
}

550 
MWBOOL


551 
	$swôch_vt
(
which
)

553 
vt_°©
 
vt°©e
;

554 
cuºít
;

555 
r
[16], 
g
[16], 
b
[16];

558 i‡((
	`io˘l
(
fd
, 
VT_GETSTATE
, &
vt°©e
) < 0) ||

559 (
which
 =
vt°©e
.
v_a˘ive
)) {

560  
FALSE
;

562 
cuºít
 = 
vt°©e
.
v_a˘ive
;

565 
	`io˘l_gë∑Àâe
(0, 16, 
r
, 
g
, 
b
);

566 
	`io˘l
(
fd
, 
KDSETMODE
, 
KD_TEXT
);

569 i‡(
	`io˘l
(
fd
, 
VT_ACTIVATE
, 
which
) == 0) {

571 
	`io˘l
(
fd
, 
VT_WAITACTIVE
, 
which
);

572 
	`io˘l
(
fd
, 
VT_WAITACTIVE
, 
cuºít
) < 0) {

573 i‡((
î∫o
 !
EINTR
Ë&& (î∫ÿ!
EAGAIN
)) {

577 
	`u¶ìp
(100000);

582 
	`io˘l
(
fd
, 
KDSETMODE
, 
KD_GRAPHICS
);

583 
	`io˘l_£çÆëã
(0, 16, 
r
, 
g
, 
b
);

584  
TRUE
;

585 
	}
}

	@drivers/kbd_x11.c

10 
	~<°dio.h
>

11 
	~<uni°d.h
>

12 
	~<î∫o.h
>

13 
	~<X11/Xlib.h
>

14 
	~<X11/Xutû.h
>

15 
	~<X11/keysym.h
>

16 
	~<X11/XKBlib.h
>

17 
	~"devi˚.h
"

19 
X11_O≥n
(
KBDDEVICE
 *
pkd
);

20 
X11_Clo£
();

21 
X11_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

22 
X11_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

24 
öô_mod°©e
();

26 
MWKEYMOD
 
	gkey_mod°©e
;

27 
esˇ≥_quôs
;

29 
Di•œy
* 
x11_dpy
;

30 
x11_s¸
;

31 
VisuÆ
* 
x11_vis
;

32 
Wödow
 
x11_wö
;

33 
GC
 
x11_gc
;

34 
x11_£tup_di•œy
();

36 
	#X_SCR_MASK
 0x80

	)

37 
	#X_CAP_MASK
 0x2

	)

38 
	#X_NUM_MASK
 0x10

	)

40 
KBDDEVICE
 
	gkbddev
 = {

41 
X11_O≥n
,

42 
X11_Clo£
,

43 
X11_GëModifõrInfo
,

44 
X11_Ród
,

45 
NULL


55 
	$X11_O≥n
(
KBDDEVICE
 *
pkd
)

57 i‡(
	`x11_£tup_di•œy
() < 0) {

58 
	`Ârötf
(
°dîr
, "nano-X: Can't connectÅo X11 server\n");

62 if(
	`öô_mod°©e
() < 0)

66  
	`C⁄√˘i⁄Numbî
(
x11_dpy
);

67 
	}
}

74 
	$X11_Clo£
()

77 
	}
}

83 
	$X11_GëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

85 i‡(
modifõrs
)

86 *
modifõrs
 = 
MWKMOD_SHIFT
 | 
MWKMOD_CTRL
 | 
MWKMOD_ALT
;

87 i‡(
curmodifõrs
)

88 *
curmodifõrs
 = 
key_mod°©e
;

89 
	}
}

98 
	$X11_Ród
(
MWKEY
 *
kbuf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
)

100 
XEvít
 
ev
;

101 
MWKEY
 
mwkey
;

102 
ign‹ed_ch¨
;

104 
gøbbed
 = 0;

105 
x11_ac˚l_num
;

106 
x11_ac˚l_dí
;

107 
x11_thªs
;

110 i‡(
	`XCheckMaskEvít
(
x11_dpy
, 
KeyPªssMask
|
KeyRñó£Mask
, &
ev
)) {

111 
KeySym
 
sym
 = 
	`XKeycodeToKeysym
(
x11_dpy
, 
ev
.
xkey
.
keycode
, 0);

113 i‡(
sym
 =
NoSymbﬁ
)

117 
key_mod°©e
 &(
MWKMOD_NUM
|
MWKMOD_CAPS
|
MWKMOD_SCR
);

118 i‡(
ev
.
xkey
.
°©e
 & 
C⁄åﬁMask
)

119 
key_mod°©e
 |
MWKMOD_CTRL
;

120 i‡(
ev
.
xkey
.
°©e
 & 
Shi·Mask
)

121 
key_mod°©e
 |
MWKMOD_SHIFT
;

122 i‡(
ev
.
xkey
.
°©e
 & 
Mod1Mask
)

123 
key_mod°©e
 |
MWKMOD_ALT
;

124 i‡(
ev
.
xkey
.
°©e
 & 
X_CAP_MASK
)

125 
key_mod°©e
 |
MWKMOD_CAPS
;

126 i‡(
ev
.
xkey
.
°©e
 & 
X_SCR_MASK
)

127 
key_mod°©e
 |
MWKMOD_SCR
;

128 i‡(
ev
.
xkey
.
°©e
 & 
X_NUM_MASK
)

129 
key_mod°©e
 |
MWKMOD_NUM
;

131 i‡(
sym
 =
XK_Esˇ≥
) {

132 
mwkey
 = 
MWKEY_ESCAPE
;

134 i‡(
ev
.
xkey
.
°©e
 & 
C⁄åﬁMask
) {

136 i‡(
gøbbed
) {

137 
	`XUngøbPoöãr
(
x11_dpy
, 
CuºítTime
);

138 
	`XUngøbKeybﬂrd
(
x11_dpy
, 
CuºítTime
);

139 
	`XCh™gePoöãrC⁄åﬁ
(
x11_dpy
, 
True
, 
FÆ£
, 
x11_ac˚l_num
,

140 
x11_ac˚l_dí
, 0);

141 
gøbbed
 = 0;

145 
	`XGëPoöãrC⁄åﬁ
(
x11_dpy
, &
x11_ac˚l_num
, &
x11_ac˚l_dí
,

146 &
x11_thªs
);

147 
	`XCh™gePoöãrC⁄åﬁ
(
x11_dpy
, 
True
, 
FÆ£
, 1, 1, 0);

148 
	`XGøbKeybﬂrd
(
x11_dpy
, 
x11_wö
,

149 
True
,

150 
GøbModeAsync
, GøbModeAsync, 
CuºítTime
);

151 
	`XGøbPoöãr
(
x11_dpy
, 
x11_wö
, 
FÆ£
,

152 
PoöãrMŸi⁄Mask
 | 
Buâ⁄PªssMask
,

153 
GøbModeAsync
, GøbModeAsync, 
N⁄e
, None,

154 
CuºítTime
);

155 
gøbbed
 = 1;

158 } i‡(
gøbbed
)

159 
	`XCh™gePoöãrC⁄åﬁ
(
x11_dpy
, 
True
, 
FÆ£
, 
x11_ac˚l_num
,

160 
x11_ac˚l_dí
, 0);

161 *
kbuf
 = 
mwkey
;

162 *
modifõrs
 = 
key_mod°©e
;

163 *
sˇncode
 = 
ev
.
xkey
.
keycode
;

164  (
ev
.
xkey
.
ty≥
 =
KeyPªss
)? 1: 2;

166 
sym
) {

167 
XK_Dñëe
:

168 
mwkey
 = 
MWKEY_DELETE
;

170 
XK_Home
:

171 
mwkey
 = 
MWKEY_HOME
;

173 
XK_Le·
:

174 
mwkey
 = 
MWKEY_LEFT
;

176 
XK_Up
:

177 
mwkey
 = 
MWKEY_UP
;

179 
XK_Right
:

180 
mwkey
 = 
MWKEY_RIGHT
;

182 
XK_Down
:

183 
mwkey
 = 
MWKEY_DOWN
;

185 
XK_Page_Up
:

186 
mwkey
 = 
MWKEY_PAGEUP
;

188 
XK_Page_Down
:

189 
mwkey
 = 
MWKEY_PAGEDOWN
;

191 
XK_End
:

192 
mwkey
 = 
MWKEY_END
;

194 
XK_In£π
:

195 
mwkey
 = 
MWKEY_INSERT
;

197 
XK_Pau£
:

198 
XK_Bªak
:

199 
mwkey
 = 
MWKEY_QUIT
;

201 
XK_Pröt
:

202 
XK_Sys_Req
:

203 
mwkey
 = 
MWKEY_PRINT
;

205 
XK_Míu
:

206 
mwkey
 = 
MWKEY_MENU
;

208 
XK_C™˚l
:

209 
mwkey
 = 
MWKEY_CANCEL
;

211 
XK_KP_E¡î
:

212 
mwkey
 = 
MWKEY_KP_ENTER
;

214 
XK_KP_Home
:

215 
mwkey
 = 
MWKEY_KP7
;

217 
XK_KP_Le·
:

218 
mwkey
 = 
MWKEY_KP4
;

220 
XK_KP_Up
:

221 
mwkey
 = 
MWKEY_KP8
;

223 
XK_KP_Right
:

224 
mwkey
 = 
MWKEY_KP6
;

226 
XK_KP_Down
:

227 
mwkey
 = 
MWKEY_KP2
;

229 
XK_KP_Page_Up
:

230 
mwkey
 = 
MWKEY_KP9
;

232 
XK_KP_Page_Down
:

233 
mwkey
 = 
MWKEY_KP3
;

235 
XK_KP_End
:

236 
mwkey
 = 
MWKEY_KP1
;

238 
XK_KP_In£π
:

239 
mwkey
 = 
MWKEY_KP0
;

241 
XK_KP_Dñëe
:

242 
mwkey
 = 
MWKEY_KP_PERIOD
;

244 
XK_KP_EquÆ
:

245 
mwkey
 = 
MWKEY_KP_EQUALS
;

247 
XK_KP_Mu…ùly
:

248 
mwkey
 = 
MWKEY_KP_MULTIPLY
;

250 
XK_KP_Add
:

251 
mwkey
 = 
MWKEY_KP_PLUS
;

253 
XK_KP_Subåa˘
:

254 
mwkey
 = 
MWKEY_KP_MINUS
;

256 
XK_KP_DecimÆ
:

257 
mwkey
 = 
MWKEY_KP_PERIOD
;

259 
XK_KP_Divide
:

260 
mwkey
 = 
MWKEY_KP_DIVIDE
;

262 
XK_KP_5
:

263 
XK_KP_Begö
:

264 
mwkey
 = 
MWKEY_KP5
;

266 
XK_F1
:

267 
mwkey
 = 
MWKEY_F1
;

269 
XK_F2
:

270 
mwkey
 = 
MWKEY_F2
;

272 
XK_F3
:

273 
mwkey
 = 
MWKEY_F3
;

275 
XK_F4
:

276 
mwkey
 = 
MWKEY_F4
;

278 
XK_F5
:

279 
mwkey
 = 
MWKEY_F5
;

281 
XK_F6
:

282 
mwkey
 = 
MWKEY_F6
;

284 
XK_F7
:

285 
mwkey
 = 
MWKEY_F7
;

287 
XK_F8
:

288 
mwkey
 = 
MWKEY_F8
;

290 
XK_F9
:

291 
mwkey
 = 
MWKEY_F9
;

293 
XK_F10
:

294 
mwkey
 = 
MWKEY_F10
;

296 
XK_F11
:

297 
mwkey
 = 
MWKEY_F11
;

299 
XK_F12
:

300 
mwkey
 = 
MWKEY_F12
;

304 
XK_Num_Lock
:

306 i‡(
ev
.
xkey
.
ty≥
 =
KeyRñó£
)

307 
key_mod°©e
 ^
MWKMOD_NUM
;

309 
XK_Shi·_Lock
:

310 
XK_C≠s_Lock
:

312 i‡(
ev
.
xkey
.
ty≥
 =
KeyRñó£
)

313 
key_mod°©e
 ^
MWKMOD_CAPS
;

315 
XK_S¸ﬁl_Lock
:

317 i‡(
ev
.
xkey
.
ty≥
 =
KeyRñó£
)

318 
key_mod°©e
 ^
MWKMOD_SCR
;

321 
XK_Shi·_L
:

322 
mwkey
 = 
MWKEY_LSHIFT
;

324 
XK_Shi·_R
:

325 
mwkey
 = 
MWKEY_RSHIFT
;

327 
XK_C⁄åﬁ_L
:

328 
mwkey
 = 
MWKEY_LCTRL
;

330 
XK_C⁄åﬁ_R
:

331 
mwkey
 = 
MWKEY_RCTRL
;

333 
XK_A…_L
:

334 
mwkey
 = 
MWKEY_LALT
;

336 
XK_A…_R
:

337 
mwkey
 = 
MWKEY_RALT
;

339 
XK_Mëa_L
:

340 
XK_Su≥r_L
:

341 
XK_Hy≥r_L
:

342 
mwkey
 = 
MWKEY_LMETA
;

344 
XK_Mëa_R
:

345 
XK_Su≥r_R
:

346 
XK_Hy≥r_R
:

347 
mwkey
 = 
MWKEY_RMETA
;

350 
sym
) {

351 
XK_BackS∑˚
:

352 
XK_Tab
:

353 
XK_Rëu∫
:

356 i‡(
sym
 & 0xFF00)

357 
	`Ârötf
(
°dîr
, "Unh™dÀd X11 keysym: %04x\n", ()
sym
);

360 
	`XLookupSåög
(&
ev
.
xkey
, &
ign‹ed_ch¨
, 1, &
sym
, 
NULL
 );

362 i‡(
key_mod°©e
 & 
MWKMOD_CTRL
)

363 
mwkey
 = 
sym
 & 0x1f;

365 
mwkey
 = 
sym
 & 0xff;

370 i‡(
key_mod°©e
 & 
MWKMOD_NUM
) {

371 
mwkey
) {

372 
MWKEY_KP0
:

373 
MWKEY_KP1
:

374 
MWKEY_KP2
:

375 
MWKEY_KP3
:

376 
MWKEY_KP4
:

377 
MWKEY_KP5
:

378 
MWKEY_KP6
:

379 
MWKEY_KP7
:

380 
MWKEY_KP8
:

381 
MWKEY_KP9
:

382 
mwkey
 = mwkey - 
MWKEY_KP0
 + '0';

384 
MWKEY_KP_PERIOD
:

385 
mwkey
 = '.';

387 
MWKEY_KP_DIVIDE
:

388 
mwkey
 = '/';

390 
MWKEY_KP_MULTIPLY
:

391 
mwkey
 = '*';

393 
MWKEY_KP_MINUS
:

394 
mwkey
 = '-';

396 
MWKEY_KP_PLUS
:

397 
mwkey
 = '+';

399 
MWKEY_KP_ENTER
:

400 
mwkey
 = 
MWKEY_ENTER
;

402 
MWKEY_KP_EQUALS
:

403 
mwkey
 = '-';

407 *
modifõrs
 = 
key_mod°©e
;

408 *
sˇncode
 = 
ev
.
xkey
.
keycode
;

409 *
kbuf
 = 
mwkey
;

412  (
ev
.
xkey
.
ty≥
 =
KeyPªss
)? 1 : 2;

416 
	}
}

418 
	#NUM_LOCK_MASK
 0x00000002

	)

419 
	#CAPS_LOCK_MASK
 0x00000001

	)

420 
	#SCROLL_LOCK_MASK
 0x00000004

	)

423 
	$öô_mod°©e
 ()

425 
°©e
;

426 
ˇp¶
, 
numl
, 
s¸ﬁŒ
;

428 if(
	`XkbGëIndiˇt‹Sèã
 (
x11_dpy
, 
XkbU£C‹eKbd
, &
°©e
Ë!
Suc˚ss
) {

429 
	`Ârötf
(
°dîr
, "nano-X: ErrorÑeading kbd indicator status\n");

432 
ˇp¶
 = 
°©e
 & 
CAPS_LOCK_MASK
;

433 
numl
 = 
°©e
 & 
NUM_LOCK_MASK
;

434 
s¸ﬁŒ
 = 
°©e
 & 
SCROLL_LOCK_MASK
;

436 if(
numl
 != 0)

437 
key_mod°©e
 |
MWKMOD_NUM
;

439 if(
ˇp¶
 != 0)

440 
key_mod°©e
 |
MWKMOD_CAPS
;

442 if(
s¸ﬁŒ
 != 0)

443 
key_mod°©e
 |
MWKMOD_SCR
;

446 
	}
}

	@drivers/keymap_standard.h

3 
MWKEY
 
	gkeym≠
[128] = {

4 
MWKEY_UNKNOWN
, 
MWKEY_ESCAPE
, '1', '2', '3',

6 '9', '0', '-', '=', 
MWKEY_BACKSPACE
,

7 
MWKEY_TAB
, 'q', 'w', 'e', 'r',

9 'o', '[', ']', 
MWKEY_ENTER
, 
MWKEY_LCTRL
,

12 '\'', '`', 
MWKEY_LSHIFT
, '\\', 'z',

14 'm', ',', '.', '/', 
MWKEY_RSHIFT
,

15 
MWKEY_KP_MULTIPLY
, 
MWKEY_LALT
, ' ', 
MWKEY_CAPSLOCK
, 
MWKEY_F1
,

16 
MWKEY_F2
, 
MWKEY_F3
, 
MWKEY_F4
, 
MWKEY_F5
, 
MWKEY_F6
,

17 
MWKEY_F7
, 
MWKEY_F8
, 
MWKEY_F9
, 
MWKEY_F10
, 
MWKEY_NUMLOCK
,

18 
MWKEY_SCROLLOCK
, 
MWKEY_KP7
, 
MWKEY_KP8
, 
MWKEY_KP9
, 
MWKEY_KP_MINUS
,

19 
MWKEY_KP4
, 
MWKEY_KP5
, 
MWKEY_KP6
, 
MWKEY_KP_PLUS
, 
MWKEY_KP1
,

20 
MWKEY_KP2
, 
MWKEY_KP3
, 
MWKEY_KP0
, 
MWKEY_KP_PERIOD
, 
MWKEY_UNKNOWN
,

21 
MWKEY_UNKNOWN
, MWKEY_UNKNOWN, 
MWKEY_F11
, 
MWKEY_F12
, MWKEY_UNKNOWN,

22 
MWKEY_UNKNOWN
,MWKEY_UNKNOWN,MWKEY_UNKNOWN,MWKEY_UNKNOWN,MWKEY_UNKNOWN,

23 
MWKEY_UNKNOWN
, 
MWKEY_KP_ENTER
, 
MWKEY_RCTRL
, 
MWKEY_KP_DIVIDE
,
MWKEY_PRINT
,

24 
MWKEY_RALT
, 
MWKEY_BREAK
, 
MWKEY_HOME
, 
MWKEY_UP
, 
MWKEY_PAGEUP
,

25 
MWKEY_LEFT
, 
MWKEY_RIGHT
, 
MWKEY_END
, 
MWKEY_DOWN
, 
MWKEY_PAGEDOWN
,

26 
MWKEY_INSERT
, 
MWKEY_DELETE
, 
MWKEY_UNKNOWN
,MWKEY_UNKNOWN,MWKEY_UNKNOWN,

27 
MWKEY_UNKNOWN
,MWKEY_UNKNOWN,MWKEY_UNKNOWN,MWKEY_UNKNOWN,
MWKEY_PAUSE
,

28 
MWKEY_UNKNOWN
,MWKEY_UNKNOWN,MWKEY_UNKNOWN,MWKEY_UNKNOWN,MWKEY_UNKNOWN,

29 
MWKEY_LMETA
, 
MWKEY_RMETA
, 
MWKEY_MENU


	@drivers/keymap_zaurus.h

22 
MWKEY
 
	gkeym≠
[128] = {

26 'x', 'y', 'z', 
MWKEY_LSHIFT
, 
MWKEY_ENTER
, 
MWKEY_MENU
, 0x0, 
MWKEY_BACKSPACE
,

27 0x0, 0x0, 
MWKEY_ESCAPE
, 
MWKEY_LEFT
, 
MWKEY_UP
, 
MWKEY_DOWN
, 
MWKEY_RIGHT
, 
MWKEY_ENTER
,

30 0x0, 0x0, '-', '+', 
MWKEY_CAPSLOCK
, '@', '?', ',',

31 '.', 
MWKEY_TAB
, 
MWKEY_F5
, 
MWKEY_F6
, 
MWKEY_F7
, '/', '\'', ';',

33 '(', 
MWKEY_BACKSPACE
, 
MWKEY_F10
, '=', ')', '~', '<', '>',

34 
MWKEY_APP1
, 
MWKEY_APP2
, 
MWKEY_APP4
, 
MWKEY_ACCEPT
, ' ', 0x0, '!', 0x0,

35 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 
MWKEY_RSHIFT
,

36 
MWKEY_LCTRL
, 
MWKEY_RCTRL
, 
MWKEY_LALT
, 
MWKEY_RALT
, 
MWKEY_ALTGR
, 0x0, 0x0, 0x0,

	@drivers/memplan4.c

13 
	~<as£π.h
>

14 
	~<°dio.h
>

15 
	~<°rög.h
>

16 
	~"devi˚.h
"

17 
	~"vg≠œn4.h
"

18 
	~"fb.h
"

20 #i‡
HAVEBLIT


22 #i‡
MSDOS
 | 
ELKS
 | 
__πems__


24 
	#SCREENBASE
(
psd
Ë
EGA_BASE


	)

25 
	#BYTESPERLINE
(
psd
Ë80

	)

28 
	#SCREENBASE
(
psd
Ë((*)(’sd)->
addr
))

	)

29 
	#BYTESPERLINE
(
psd
Ë(’sd)->
löñí
)

	)

33 
gr_mode
;

35 
	gnŸmask
[2] = { 0x0f, 0xf0};

36 
	gmask
[8] = {

42 
	$mem∂4_öô
(
PSD
 
psd
)

44 i‡(!
psd
->
size
)

45 
psd
->
size
 =Ösd->
yªs
 *Ösd->
löñí
;

48 
	}
}

52 
	$mem∂4_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

54 
ADDR8
 
addr
 = 
psd
->addr;

56 
	`as£π
 (
addr
 != 0);

57 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

58 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

59 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

61 
addr
 +(
x
>>1Ë+ 
y
 * 
psd
->
löñí
;

62 if(
gr_mode
 =
MWMODE_XOR
)

63 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

65 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

66 
	}
}

69 
MWPIXELVAL


70 
	$mem∂4_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

72 
ADDR8
 
addr
 = 
psd
->addr;

74 
	`as£π
 (
addr
 != 0);

75 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

76 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

78  (
addr
[(
x
>>1Ë+ 
y
 * 
psd
->
löñí
] >> ((1-(x&1))<<2) ) & 0x0f;

79 
	}
}

83 
	$mem∂4_døwh‹zlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

85 
ADDR8
 
addr
 = 
psd
->addr;

87 
	`as£π
 (
addr
 != 0);

88 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

89 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

90 
	`as£π
 (
x2
 >
x1
);

91 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

92 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

94 
addr
 +(
x1
>>1Ë+ 
y
 * 
psd
->
löñí
;

95 if(
gr_mode
 =
MWMODE_XOR
) {

96 
x1
 <
x2
) {

97 *
addr
 ^
c
 << ((1-(
x1
&1))<<2);

98 if((++
x1
 & 1) == 0)

99 ++
addr
;

102 
x1
 <
x2
) {

103 *
addr
 = (*add∏& 
nŸmask
[
x1
&1]Ë| (
c
 << ((1-(x1&1))<<2));

104 if((++
x1
 & 1) == 0)

105 ++
addr
;

108 
	}
}

112 
	$mem∂4_døwvîéöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

114 
ADDR8
 
addr
 = 
psd
->addr;

115 
löñí
 = 
psd
->linelen;

117 
	`as£π
 (
addr
 != 0);

118 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

119 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

120 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

121 
	`as£π
 (
y2
 >
y1
);

122 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

124 
addr
 +(
x
>>1Ë+ 
y1
 * 
löñí
;

125 if(
gr_mode
 =
MWMODE_XOR
)

126 
y1
++ <
y2
) {

127 *
addr
 ^
c
 << ((1-(
x
&1))<<2);

128 
addr
 +
löñí
;

131 
y1
++ <
y2
) {

132 *
addr
 = (*add∏& 
nŸmask
[
x
&1]Ë| (
c
 << ((1-(x&1))<<2));

133 
addr
 +
löñí
;

135 
	}
}

140 
	$mem∂4_to_mem∂4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

141 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

143 
ADDR8
 
d°
;

144 
ADDR8
 
§c
;

145 
i
;

146 
dlöñí
 = 
d°psd
->
löñí
;

147 
¶öñí
 = 
§˝sd
->
löñí
;

149 
	`as£π
 (
d°psd
->
addr
 != 0);

150 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

151 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

152 
	`as£π
 (
w
 > 0);

153 
	`as£π
 (
h
 > 0);

154 
	`as£π
 (
§˝sd
->
addr
 != 0);

155 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

156 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

157 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

158 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

159 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

160 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

162 
d°
 = (*)
d°psd
->
addr
 + (
d°x
>>1Ë+ 
d°y
 * 
dlöñí
;

163 
§c
 = (*)
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

164 --
h
 >= 0) {

165 
ADDR8
 
d
 = 
d°
;

166 
ADDR8
 
s
 = 
§c
;

167 
MWCOORD
 
dx
 = 
d°x
;

168 
MWCOORD
 
sx
 = 
§cx
;

169 
i
=0; i<
w
; ++i) {

170 *
d
 = (*d & 
nŸmask
[
dx
&1]) |

171 ((*
s
 >> ((1-(
sx
&1))<<2Ë& 0x0fË<< ((1-(
dx
&1))<<2));

172 if((++
dx
 & 1) == 0)

173 ++
d
;

174 if((++
sx
 & 1) == 0)

175 ++
s
;

177 
d°
 +
dlöñí
;

178 
§c
 +
¶öñí
;

180 
	}
}

185 
	$vga_to_vga_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

186 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

188 
FARADDR
 
d°
;

189 
FARADDR
 
§c
;

190 
i
, 
∂™e
;

191 
x1
, 
x2
;

193 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

194 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

195 
	`as£π
 (
w
 > 0);

196 
	`as£π
 (
h
 > 0);

197 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

198 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

199 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

200 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

201 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

202 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

204 
DRAWON
;

205 
	`£t_íabÀ_§
(0);

206 
d°
 = 
	`SCREENBASE
(
d°psd
Ë+ (
d°x
>>3Ë+ 
d°y
 * 
	`BYTESPERLINE
(dstpsd);

207 
§c
 = 
	`SCREENBASE
(
§˝sd
Ë+ (
§cx
>>3Ë+ 
§cy
 * 
	`BYTESPERLINE
(srcpsd);

208 
x1
 = 
d°x
>>3;

209 
x2
 = (
d°x
 + 
w
 - 1) >> 3;

210 --
h
 >= 0) {

211 
∂™e
=0;Ölane<4; ++plane) {

212 
FARADDR
 
d
 = 
d°
;

213 
FARADDR
 
s
 = 
§c
;

215 
	`£t_ªad_∂™e
(
∂™e
);

216 
	`£t_wrôe_∂™es
(1 << 
∂™e
);

219 if(
x1
 =
x2
) {

220 
	`£À˘_™d_£t_mask
((0xf‡>> (
x1
 & 7)Ë& (0xf‡<< (7 - (
x2
 & 7))));

221 
	`PUTBYTE_FP
(
d
, 
	`GETBYTE_FP
(
s
));

223 
	`£À˘_™d_£t_mask
(0xf‡>> (
x1
 & 7));

224 
	`PUTBYTE_FP
(
d
++, 
	`GETBYTE_FP
(
s
++));

226 
	`£t_mask
(0xff);

227 
i
=
x1
+1; i<
x2
; ++i)

228 
	`PUTBYTE_FP
(
d
++, 
	`GETBYTE_FP
(
s
++));

230 
	`£t_mask
(0xf‡<< (7 - (
x2
 & 7)));

231 
	`PUTBYTE_FP
(
d
, 
	`GETBYTE_FP
(
s
));

234 
d°
 +
	`BYTESPERLINE
(
d°psd
);

235 
§c
 +
	`BYTESPERLINE
(
§˝sd
);

237 
	`£t_wrôe_∂™es
(0x0f);

238 
	`£t_íabÀ_§
(0x0f);

239 
DRAWOFF
;

240 
	}
}

245 
	$mem∂4_to_vga_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

246 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

248 
FARADDR
 
d°
;

249 
ADDR8
 
§c
;

250 
i
;

251 
¶öñí
 = 
§˝sd
->
löñí
;

252 
cﬁ‹
, 
œ°cﬁ‹
 = -1;

254 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

255 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

256 
	`as£π
 (
w
 > 0);

257 
	`as£π
 (
h
 > 0);

258 
	`as£π
 (
§˝sd
->
addr
 != 0);

259 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

260 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

261 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

262 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

263 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

264 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

266 
DRAWON
;

267 
	`£t_›
(0);

268 
d°
 = 
	`SCREENBASE
(
d°psd
Ë+ (
d°x
>>3Ë+ 
d°y
 * 
	`BYTESPERLINE
(dstpsd);

269 
§c
 = (*)
§˝sd
->
addr
 + (
§cx
>>1Ë+ 
§cy
 * 
¶öñí
;

270 --
h
 >= 0) {

271 
FARADDR
 
d
 = 
d°
;

272 
ADDR8
 
s
 = 
§c
;

273 
MWCOORD
 
dx
 = 
d°x
;

274 
MWCOORD
 
sx
 = 
§cx
;

275 
i
=0; i<
w
; ++i) {

276 
cﬁ‹
 = *
s
 >> ((1-(
sx
&1))<<2) & 0x0f;

277 if(
cﬁ‹
 !
œ°cﬁ‹
)

278 
	`£t_cﬁ‹
(
œ°cﬁ‹
 = 
cﬁ‹
);

279 
	`£À˘_™d_£t_mask
 (
mask
[
dx
&7]);

280 
	`RMW_FP
(
d
);

282 if((++
dx
 & 7) == 0)

283 ++
d
;

284 if((++
sx
 & 1) == 0)

285 ++
s
;

287 
d°
 +
	`BYTESPERLINE
(
d°psd
);

288 
§c
 +
¶öñí
;

290 
DRAWOFF
;

291 
	}
}

296 
	$vga_to_mem∂4_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

297 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

299 
x
, 
y
;

300 
∂™e
;

301 
ADDR8
 
d
, 
d°
;

302 
FARADDR
 
s
, 
§c
;

303 
MWCOORD
 
sx
, 
dx
;

304 
cﬁ‹
;

305 
dlöñí
 = 
d°psd
->
löñí
;

307 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

308 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

309 
	`as£π
 (
d°psd
->
addr
 != 0);

310 
	`as£π
 (
w
 > 0);

311 
	`as£π
 (
h
 > 0);

312 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

313 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

314 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

315 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

316 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

317 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

319 
DRAWON
;

320 
§c
 = 
	`SCREENBASE
(
§˝sd
Ë+ (
§cx
 >> 3Ë+ 
§cy
 * 
	`BYTESPERLINE
(srcpsd);

321 
d°
 = (*)
d°psd
->
addr
 + (
d°x
 >> 1Ë+ 
d°y
 * 
dlöñí
;

323 
y
 = 0; y < 
h
; y++) {

324 
s
 = 
§c
;

325 
d
 = 
d°
;

326 
dx
 = 
d°x
;

327 
sx
 = 
§cx
;

328 
cﬁ‹
 = 0;

329 
x
 = 0; x < 
w
; x++) {

330 
∂™e
 = 0;Ölane < 4; ++plane) {

331 
	`£t_ªad_∂™e
(
∂™e
);

332 if(
	`GETBYTE_FP
(
s
Ë& 
mask
[
sx
 & 7])

333 
cﬁ‹
 |= 1 <<

334 (
∂™e
 + ((
dx
 & 1) ? 0 : 4));

336 if((++
sx
 & 7Ë=0Ë++
s
;

337 if((++
dx
 & 1) == 0) {

338 *
d
++ = 
cﬁ‹
;

339 
cﬁ‹
 = 0;

342 
d°
 +
dlöñí
;

343 
§c
 +
	`BYTESPERLINE
(
§˝sd
);

345 
DRAWOFF
;

346 
	}
}

349 
	$ega_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

350 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

352 
MWBOOL
 
§cvga
, 
d°vga
;

355 
§cvga
 = 
§˝sd
->
Êags
 & 
PSF_SCREEN
;

356 
d°vga
 = 
d°psd
->
Êags
 & 
PSF_SCREEN
;

358 if(
§cvga
) {

359 if(
d°vga
)

360 
	`vga_to_vga_blô
(
d°psd
, 
d°x
, 
d°y
, 
w
, 
h
,

361 
§˝sd
, 
§cx
, 
§cy
, 
›
);

363 
	`vga_to_mem∂4_blô
(
d°psd
, 
d°x
, 
d°y
, 
w
, 
h
,

364 
§˝sd
, 
§cx
, 
§cy
, 
›
);

366 if(
d°vga
)

367 
	`mem∂4_to_vga_blô
(
d°psd
, 
d°x
, 
d°y
, 
w
, 
h
,

368 
§˝sd
, 
§cx
, 
§cy
, 
›
);

370 
	`mem∂4_to_mem∂4_blô
(
d°psd
, 
d°x
, 
d°y
, 
w
, 
h
,

371 
§˝sd
, 
§cx
, 
§cy
, 
›
);

373 
	}
}

375 
SUBDRIVER
 
	gmem∂™4
 = {

376 
mem∂4_öô
,

377 
mem∂4_døwpixñ
,

378 
mem∂4_ªadpixñ
,

379 
mem∂4_døwh‹zlöe
,

380 
mem∂4_døwvîéöe
,

381 
gí_fûÃe˘
,

382 
ega_blô


	@drivers/mou_dos.c

7 
	~<dos.h
>

9 #i‚de‡
__PACIFIC__


10 
	~<bios.h
>

13 
	~"devi˚.h
"

15 
	#SCALE
 1

	)

16 
	#THRESH
 10

	)

18 
MOU_O≥n
(
MOUSEDEVICE
 *
pmd
);

19 
MOU_Clo£
();

20 
MOU_GëBuâ⁄Info
();

21 
MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

22 
MOU_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
,*
bp
);

23 
MOU_Pﬁl
();

25 
MOUSEDEVICE
 
	gmou£dev
 = {

26 
MOU_O≥n
,

27 
MOU_Clo£
,

28 
MOU_GëBuâ⁄Info
,

29 
MOU_GëDeÁu…Ac˚l
,

30 
MOU_Ród
,

31 
MOU_Pﬁl


34 
	gmou£_fd
;

40 
	$MOU_O≥n
(
MOUSEDEVICE
 *
pmd
)

42 
REGS
 
ªg£t
;

45 
ªg£t
.
x
.
ax
 = 0;

46 
	`öt86
(0x33, &
ªg£t
, &regset);

49 
ªg£t
.
x
.
ax
 = 0x0f;

50 
ªg£t
.
x
.
cx
 = 16;

51 
ªg£t
.
x
.
dx
 = 32;

52 
	`öt86
(0x33, &
ªg£t
, &regset);

55 
ªg£t
.
x
.
ax
 = 0x0b;

56 
	`öt86
(0x33, &
ªg£t
, &regset);

59 
	}
}

65 
	$MOU_Clo£
()

67 
	}
}

73 
	$MOU_GëBuâ⁄Info
()

75  
MWBUTTON_L
 | 
MWBUTTON_M
 | 
MWBUTTON_R
;

76 
	}
}

82 
	$MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

84 *
psˇÀ
 = 
SCALE
;

85 *
±hªsh
 = 
THRESH
;

86 
	}
}

96 
	$MOU_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

98 
REGS
 
ªg£t
;

99 
buâ⁄s
;

102 
ªg£t
.
x
.
ax
 = 0x0b;

103 
	`öt86
(0x33, &
ªg£t
, &regset);

105 *
dx
 = ()
ªg£t
.
x
.
cx
;

106 *
dy
 = ()
ªg£t
.
x
.
dx
;

107 *
dz
 = 0;

110 
ªg£t
.
x
.
ax
 = 3;

111 
	`öt86
(0x33, &
ªg£t
, &regset);

113 
buâ⁄s
 = 0;

114 if(
ªg£t
.
x
.
bx
 & 01)

115 
buâ⁄s
 |
MWBUTTON_L
;

116 if(
ªg£t
.
x
.
bx
 & 02)

117 
buâ⁄s
 |
MWBUTTON_R
;

118 if(
ªg£t
.
x
.
bx
 & 04)

119 
buâ⁄s
 |
MWBUTTON_M
;

120 *
bp
 = 
buâ⁄s
;

123 
	}
}

126 
	$MOU_Pﬁl
()

129 
	}
}

	@drivers/mou_dynapro.c

11 
	~<°dio.h
>

12 
	~<°dlib.h
>

13 
	~<uni°d.h
>

14 
	~<î∫o.h
>

15 
	~<f˙é.h
>

16 
	~<m©h.h
>

17 
	~<sys/io˘l.h
>

18 
	~<sys/ãrmios.h
>

19 
	~"devi˚.h
"

22 
ãrmios
 
	gios_ßved
, 
	gios_cuºít
;

25 
	gmouFd
 = 0;

31 
	gˇlD©a
[4] = { 73, 956, 883, 167 };

36 
	gövX
 = 0, 
	gövY
 = 0;

38 
SCREENDEVICE
 
s¸dev
;

40 
	$öôSîül
(*
dev
) {

43 
fd
 = 
	`›í
(
dev
, 
O_NONBLOCK
);

45 i‡(
fd
 <= 0) {

46 
	`EPRINTF
("Eº‹ o≥nög %s\n", 
dev
);

52 
	`tcgë©å
(
fd
, &
ios_ßved
);

53 
ios_cuºít
 = 
ios_ßved
;

55 
	`cfmakîaw
(&
ios_cuºít
);

59 
	`cf£ti•ìd
(&
ios_cuºít
, 
B2400
);

60 
	`cf£to•ìd
(&
ios_cuºít
, 
B2400
);

64 
ios_cuºít
.
c_cÊag
 &~(
CSIZE
 | 
PARENB
);

65 
ios_cuºít
.
c_cÊag
 |
CS8
;

67 
ios_cuºít
.
c_cc
[
VMIN
] = 3;

68 
ios_cuºít
.
c_cc
[
VTIME
] = 1;

70 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ios_cuºít
);

71 
	`tcÊush
(
fd
, 
TCIOFLUSH
);

73 (
fd
);

74 
	}
}

76 
	$˛o£Sîül
(
fd
) {

80 
	`tc£èâr
(
fd
, 
TCSANOW
, &
ios_ßved
);

81 
	`tcÊush
(
fd
, 
TCIOFLUSH
);

83 
	`˛o£
(
fd
);

84 
	}
}

88 
	$ªadSîül
(
fd
) {

90 
f
;

91 
vÆ
 = 
	`ªad
(
fd
, &
f
, (f));

93 i‡(
vÆ
 <= 0) (val);

95 ((Ë
f
);

96 
	}
}

100 
	$gëI≈ut
(
fd
, *
d©a
) {

102 
cou¡
 = 0;

103 
°©e
 = 0;

108 
c
;

110 
c
 = 
	`ªadSîül
(
fd
);

112 i‡(
c
 < 0) {

113 i‡(
î∫o
 =
EAGAIN
 ||Éºnÿ=
EINTR
) (0);

117 i‡(
cou¡
++ > 150) (0);

120 
°©e
) {

123 i‡(
c
 & 0x80) {

124 
d©a
[0] = (Ë
c
;

125 
°©e
 = 1;

130 #ifde‡
NOTUSED


132 
	`Ârötf
(
°dîr
, "N⁄ sèπ byãÑecõved (%2.2x)\n", 
c
);

138 i‡(!(
c
 & 0x80)) {

139 
d©a
[1] = (Ë
c
;

140 
°©e
 = 2;

143 #ifde‡
NOTUSED


144 
	`Ârötf
(
°dîr
, "Gotá start byte inÅhe middle ofÅheÖacket\n");

147 
d©a
[0] = (Ë
c
;

149 
°©e
 = 0;

156 i‡(!(
c
 & 0x80)) {

157 
d©a
[2] = (Ë
c
;

161 #ifde‡
NOTUSED


162 
	`Ârötf
(
°dîr
, "Gotá start byte inÅhe middle ofÅheÖacket\n");

164 
d©a
[0] = (Ë
c
;

166 
°©e
 = 0;

174 
	}
}

178 
	$ªadCÆibøti⁄
(*
fûíame
) {

180 
buf„r
[128];

182 
ˇlfd
 = 
	`›í
(
fûíame
, 
O_RDONLY
);

185 i‡(
ˇlfd
 < 0) (0);

191 i‡(
	`ªad
(
ˇlfd
, 
buf„r
, (buffer)) <= 0) {

192 
	`˛o£
(
ˇlfd
);

196 
	`ssˇnf
(
buf„r
, "%d %d %d %d\n", &
ˇlD©a
[0], &calData[1], &calData[2], &calData[3]);

198 
	`˛o£
(
ˇlfd
);

202 i‡(
ˇlD©a
[1] < calData[0]) {

203 
tmp
 = 
ˇlD©a
[1];

205 
ˇlD©a
[1] = calData[0];

206 
ˇlD©a
[0] = 
tmp
;

208 
övX
 = 1;

211 i‡(
ˇlD©a
[3] < calData[2]) {

212 
tmp
 = 
ˇlD©a
[3];

213 
ˇlD©a
[3] = calData[2];

214 
ˇlD©a
[2] = 
tmp
;

216 
övY
 = 1;

220 
	}
}

222 
	$doSˇÀ
(
x
, 
y
, *
dx
, *
dy
) {

226 *
dx
 = ((
x
 - 
ˇlD©a
[0]Ë* 
s¸dev
.
xªs
) / (calData[1] - calData[0]);

227 *
dy
 = ((
y
 - 
ˇlD©a
[2]Ë* 
s¸dev
.
yªs
) / (calData[3] - calData[2]);

228 
	}
}

230 
	$MOU_O≥n
(
MOUSEDEVICE
 *
pmd
) {

232 
ˇlfd
;

234 
mouFd
 = 
	`öôSîül
("/dev/ttyS1");

236 i‡(
mouFd
 == -1) {

237 
	`EPRINTF
("UnableÅo open /dev/ttyS1 forÑeading\n");

241 i‡(
	`ªadCÆibøti⁄
("/etc/caldata") == -1) {

242 
	`˛o£Sîül
(
mouFd
);

243 
	`EPRINTF
("UnableÅo getÅhe calibration data\n");

249 
	`GdHideCurs‹
(&
s¸dev
);

250 (
mouFd
);

251 
	}
}

253 
	$MOU_GëBuâ⁄Info
() {

254 (
MWBUTTON_L
);

255 
	}
}

257 
	$MOU_GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
) {

258 *
psˇÀ
 = 3;

259 *
±hªsh
 = 5;

260 
	}
}

262 
	$MOU_Clo£
() {

264 i‡(
mouFd
 >= 0)

265 
	`˛o£Sîül
(
mouFd
);

267 
mouFd
 = -1;

268 
	}
}

270 
	$MOU_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
) {

272 
i
;

274 
tŸÆx
 = 0, 
tŸÆy
 = 0;

275 
d©a
[4];

280 
i
 = 0; i < 1; i++) {

281 
x
, 
y
, 
sx
, 
sy
;

282 
vÆ
;

284 
vÆ
 = 
	`gëI≈ut
(
mouFd
, 
d©a
);

286 i‡(
vÆ
 == -1) (0);

287 i‡(
vÆ
 == 0) ;

289 
x
 = 
d©a
[1] | ((data[0] & 0x38) << 4);

290 
y
 = 
d©a
[2] | ((data[0] & 0x07) << 7);

293 
	`doSˇÀ
(
x
, 
y
, &
sx
, &
sy
);

297 i‡(
övX
)

298 
sx
 = 
s¸dev
.
xªs
 - sx;

299 i‡(
övY
)

300 
sy
 = 
s¸dev
.
yªs
 - sy;

302 
tŸÆx
 +
sx
;

303 
tŸÆy
 +
sy
;

306 i‡(
i
 == 0) (0);

308 *
px
 = 
tŸÆx
 / (
i
);

309 *
py
 = 
tŸÆy
 / (
i
);

313 *
pb
 = ( (
d©a
[0] & 0x40Ë? 
MWBUTTON_L
 : 0 );

314 *
pz
 = 0;

316 i‡(!*
pb
) (3); (2);

317 
	}
}

319 
MOUSEDEVICE
 
	gmou£dev
 = {

320 
MOU_O≥n
,

321 
MOU_Clo£
,

322 
MOU_GëBuâ⁄Info
,

323 
MOU_GëDeÁu…Ac˚l
,

324 
MOU_Ród
,

325 
NULL


	@drivers/mou_fbsd.c

2 
	~<sys/ty≥s.h
>

3 
	~<sys/uio.h
>

4 
	~<uni°d.h
>

5 
	~<f˙é.h
>

6 
	~<î∫o.h
>

8 
	~<machöe/mou£.h
>

9 
	~<machöe/c⁄sﬁe.h
>

13 
	~"devi˚.h
"

15 
	#SCALE
 3

	)

16 
	#THRESH
 5

	)

19 
FBSD_O≥n
(
MOUSEDEVICE
 *
pmd
);

20 
FBSD_Clo£
();

21 
FBSD_GëBuâ⁄Info
();

22 
FBSD_GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
);

23 
FBSD_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
,*
bp
);

24 
MOUSEDEVICE
 
	gmou£dev
 = {

25 
FBSD_O≥n
,

26 
FBSD_Clo£
,

27 
FBSD_GëBuâ⁄Info
,

28 
FBSD_GëDeÁu…Ac˚l
,

29 
FBSD_Ród
,

30 
NULL


33 
	gmou£_fd
=0;

35 
	$FBSD_O≥n
(
MOUSEDEVICE
 *
pmd
)

38 
mou£mode_t
 
theMou£Mode
;

40 
mou£_fd
=
	`›í
("/dev/sysmou£",
O_RDONLY
);

41 if(
mou£_fd
 < 0)

45 
	`io˘l
(
mou£_fd
, 
MOUSE_GETMODE
, &
theMou£Mode
);

46 
theMou£Mode
.
Àvñ
=1;

47 
	`io˘l
(
mou£_fd
, 
MOUSE_SETMODE
, &
theMou£Mode
);

48  
mou£_fd
;

50 
	}
}

52 
	$FBSD_Clo£
()

54 i‡(
mou£_fd
 > 0)

56 
	`˛o£
(
mou£_fd
);

58 
mou£_fd
=0;

60 
	}
}

62 
	$FBSD_GëBuâ⁄Info
()

64  
MWBUTTON_L
 | 
MWBUTTON_M
 | 
MWBUTTON_R
;

65 
	}
}

67 
	$FBSD_GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
)

69 *
psˇÀ
 = 
SCALE
;

70 *
±hªsh
 = 
THRESH
;

71 
	}
}

73 
FBSD_h™dÀ_evít
();

75 
	$FBSD_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
,

76 *
bp
)

79 
mou£°©us_t
 
theSètus
;

80 
butSèt
=0;

81 
ªtVÆ
=0;

83 
	`FBSD_h™dÀ_evít
();

85 
	`io˘l
(
mou£_fd
,
MOUSE_GETSTATUS
, &
theSètus
);

87 if(
theSètus
.
Êags
 | 
MOUSE_POSCHANGED
)

89 *
dx
=
theSètus
.dx;

90 *
dy
=
theSètus
.dy;

91 *
dz
=
theSètus
.dz;

92 
ªtVÆ
|=1;

95 if(
theSètus
.
buâ⁄
 & 0x1)

97 
butSèt
|=
MWBUTTON_L
;

98 
ªtVÆ
|=1;

100 if(
theSètus
.
buâ⁄
 & 0x2)

102 
butSèt
|=
MWBUTTON_M
;

103 
ªtVÆ
|=1;

105 if(
theSètus
.
buâ⁄
 & 0x4)

107 
butSèt
|=
MWBUTTON_R
;

108 
ªtVÆ
|=1;

111 *
bp
=
butSèt
;

112  
ªtVÆ
;

113 
	}
}

	@drivers/mou_gpm.c

15 
	~<°dio.h
>

16 
	~<î∫o.h
>

17 
	~<uni°d.h
>

18 
	~<f˙é.h
>

19 
	~"devi˚.h
"

21 
	#SCALE
 2

	)

22 
	#THRESH
 5

	)

24 
	#GPM_DEV_FILE
 "/dev/gpmd©a"

	)

26 
GPM_O≥n
(
MOUSEDEVICE
 *
pmd
);

27 
GPM_Clo£
();

28 
GPM_GëBuâ⁄Info
();

29 
MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

30 
GPM_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

32 
MOUSEDEVICE
 
	gmou£dev
 = {

33 
GPM_O≥n
,

34 
GPM_Clo£
,

35 
GPM_GëBuâ⁄Info
,

36 
MOU_GëDeÁu…Ac˚l
,

37 
GPM_Ród
,

38 
NULL
,

39 
MOUSE_NORMAL


42 
	gmou£_fd
;

49 
	$GPM_O≥n
(
MOUSEDEVICE
 *
pmd
)

51 
mou£_fd
 = 
	`›í
(
GPM_DEV_FILE
, 
O_NONBLOCK
);

52 i‡(
mou£_fd
 < 0)

54  
mou£_fd
;

55 
	}
}

61 
	$GPM_Clo£
()

63 i‡(
mou£_fd
 > 0)

64 
	`˛o£
(
mou£_fd
);

65 
mou£_fd
 = -1;

66 
	}
}

72 
	$GPM_GëBuâ⁄Info
()

74  
MWBUTTON_L
 | 
MWBUTTON_M
 | 
MWBUTTON_R
;

75 
	}
}

81 
	$MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

83 *
psˇÀ
 = 
SCALE
;

84 *
±hªsh
 = 
THRESH
;

85 
	}
}

95 
	$GPM_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

97 
buf
[5];

98 
nbyãs
;

99 
n
;

101 (
n
 = 
	`ªad
(
mou£_fd
, &
buf
[
nbyãs
], 5 -Çbytes))) {

102 if(
n
 < 0) {

103 i‡((
î∫o
 =
EINTR
Ë|| (î∫ÿ=
EAGAIN
))

108 
nbyãs
 +
n
;

110 if(
nbyãs
 == 5) {

112 *
bp
 = (~
buf
[0]) & 0x07;

113 *
dx
 = (sig√d )(
buf
[1]) + (signed )(buf[3]);

114 *
dy
 = -((sig√d )(
buf
[2]) + (signed )(buf[4]));

115 *
dz
 = 0;

116 
nbyãs
 = 0;

121 
	}
}

	@drivers/mou_harrier.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

11 
	~<î∫o.h
>

12 
	~<f˙é.h
>

13 
	~<m©h.h
>

14 
	~<sys/io˘l.h
>

15 
	~<löux/ç™ñ.h
>

16 
	~"devi˚.h
"

17 
	~"mou_ç.h
"

27 
	#TP_STATUS_HARDDATALOST
 0x1000

	)

28 
	#TP_STATUS_SOFTDATALOST
 0x2000

	)

29 
	#TP_STATUS_PENCONTACT
 0x4000

	)

30 
	#TP_STATUS_DATAVALID
 0x8000

	)

34 
	#TP_MIN_X_SIZE
 291

	)

35 
	#TP_MIN_Y_SIZE
 355

	)

37 
	#TP_MAX_X_SIZE
 3839

	)

38 
	#TP_MAX_Y_SIZE
 3711

	)

40 
	#DATA_STATUS
 0

	)

41 
	#DATA_YPLUS
 1

	)

42 
	#DATA_YMINUS
 2

	)

43 
	#DATA_XPLUS
 3

	)

44 
	#DATA_XMINUS
 4

	)

45 
	#DATA_Z
 5

	)

48 #ifde‡
USE_FILTER


49 
	#MOU_SAMPLE_RATE
 1

	)

51 
	#MOU_SAMPLE_RATE
 10

	)

54 
	#MOU_READ_INTERVAL
 5000

	)

64 
	gpd_fd
 = -1;

65 
	gíabÀ_poötög_co‹dö©e_å™sf‹m
 = 1;

67 
TRANSFORMATION_COEFFICIENTS
 
	gtc
;

69 #i‚de‡
TEST


70 
SCREENDEVICE
 
s¸dev
;

73 #ifde‡
TEST


74 #unde‡
EPRINTF


75 #unde‡
DPRINTF


77 
	#EPRINTF
 
¥ötf


	)

78 
	#DPRINTF
 
¥ötf


	)

81 
	$GëPoöãrCÆibøti⁄D©a
()

89 c⁄° 
ˇl_fûíame
[] = "/etc/pointercal";

91 
ôems
;

93 
FILE
* 
f
 = 
	`f›í
(
ˇl_fûíame
, "r");

94 i‡–
f
 =
NULL
 )

96 
	`EPRINTF
("Error %d openingÖointer calibration file %s.\n",

97 
î∫o
, 
ˇl_fûíame
);

98 
	`EPRINTF
("PleaseÅype \"/usr/bin/tpcal > %s\"Åo calibrate\n",

99 
ˇl_fûíame
);

103 
ôems
 = 
	`fsˇnf
(
f
, "%d %d %d %d %d %d %d",

104 &
tc
.
a
, &tc.
b
, &tc.
c
, &tc.
d
, &tc.
e
, &tc.
f
, &tc.
s
);

105 i‡–
ôems
 != 7 )

107 
	`EPRINTF
("Improperly formattedÖointer calibration file %s.\n",

108 
ˇl_fûíame
);

112 #i‡
TEST


113 
	`EPRINTF
("a=%d b=%d c=%d d=%dÉ=%d f=%d s=%d\n",

114 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

118 
	}
}

120 
ölöe
 
MWPOINT
 
	$Devi˚ToS¸ìn
(
MWPOINT
 
p
)

131 
MWPOINT
 
¥ev
;

133 c⁄° 
¶›
 = 
TRANSFORMATION_UNITS_PER_PIXEL
 * 3 / 4;

134 
MWPOINT
 
√w
, 
out
;

137 
√w
.
x
 = (
tc
.
a
 * 
p
.x +Åc.
b
 *Ö.
y
 +Åc.
c
Ë/Åc.
s
;

138 
√w
.
y
 = (
tc
.
d
 * 
p
.
x
 +Åc.
e
 *Ö.y +Åc.
f
Ë/Åc.
s
;

141 i‡–
	`abs
(
√w
.
x
 - 
¥ev
.xË>
¶›
 )

142 
out
.
x
 = (
√w
.x | 0x3) ^ 0x3;

144 
out
.
x
 = 
¥ev
.x;

146 i‡–
	`abs
(
√w
.
y
 - 
¥ev
.yË>
¶›
 )

147 
out
.
y
 = (
√w
.y | 0x3) ^ 0x3;

149 
out
.
y
 = 
¥ev
.y;

151 
¥ev
 = 
out
;

153  
out
;

154 
	}
}

156 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

158 
sˇ≈¨am
 
s
;

159 
£âÀ_uµî_limô
;

160 
ªsu…
;

163 
pd_fd
 = 
	`›í
("/dev/ç™ñ", 
O_NONBLOCK
);

165 i‡(
pd_fd
 < 0)

167 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

171 
s
.
öãrvÆ
 = 
MOU_READ_INTERVAL
;

180 
£âÀ_uµî_limô
 = (
s
.
öãrvÆ
 / 5) - 60;

181 
s
.
£âÀtime
 = 
£âÀ_uµî_limô
 * 50 / 100;

182 
ªsu…
 = 
	`io˘l
(
pd_fd
, 
TPSETSCANPARM
, &
s
);

184 i‡–
ªsu…
 < 0 )

185 
	`EPRINTF
("Error %d,Ñesult %d setting scanÖarameters.\n",

186 
ªsu…
, 
î∫o
);

188 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

190 i‡(
	`GëPoöãrCÆibøti⁄D©a
() < 0)

192 
	`˛o£
(
pd_fd
);

199 #ifde‡
NOTUSED


200 #i‚de‡
TEST


202 
	`GdHideCurs‹
(&
s¸dev
);

206 (
pd_fd
);

207 
	}
}

209 
	$PD_Clo£
()

212 i‡(
pd_fd
 >= 0)

213 
	`˛o£
(
pd_fd
);

214 
pd_fd
 = -1;

215 
	}
}

217 
	$PD_GëBuâ⁄Info
()

220  
MWBUTTON_L
;

221 
	}
}

223 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

230 *
psˇÀ
 = 3;

231 *
±hªsh
 = 5;

232 
	}
}

234 
	#MAX_DEVICE_READS
 10

	)

235 
	$ªad_ç
(*
x
, *
y
,

236 *
z
, *
b
, *
°©us
, 
block
)

238 
ªad_cou¡
 = 0;

239 
ãmpx
, 
ãmpy
;

240 
byãs_ªad
;

241 
d©a
[6];

246 
ªad_cou¡
 < 
MAX_DEVICE_READS
)

248 
byãs_ªad
 = 
	`ªad
(
pd_fd
, 
d©a
, (data));

250 i‡(
byãs_ªad
 !(
d©a
))

252 i‡(
î∫o
 !
EAGAIN
)

254 
	`EPRINTF
("Eº‹ÑódögÅouchÖ™ñ.Éºnÿ%d\n", 
î∫o
);

255 (
î∫o
);

258 i‡(
block
)

260 i‡(
ªad_cou¡
++ =
MAX_DEVICE_READS
)

261 (
EAGAIN
);

263 
	`u¶ìp
(
MOU_READ_INTERVAL
 / 
MAX_DEVICE_READS
);

266 (
EAGAIN
);

272 
ãmpx
 = 
d©a
[
DATA_XPLUS
];

273 
ãmpy
 = 
d©a
[
DATA_YPLUS
];

279 i‡((
d©a
[
DATA_STATUS
] & 
TP_STATUS_DATAVALID
) == TP_STATUS_DATAVALID)

281 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

283 i‡(
ãmpx
 < 
TP_MIN_X_SIZE
 ||Åempx > 
TP_MAX_X_SIZE
)

285 #ifde‡
TEST


286 
	`EPRINTF
("Gotán out ofÑange X value. X=%d,Y=%d,B=%d\n",

287 
ãmpx
, 
ãmpy
,

288 ((
d©a
[
DATA_STATUS
] & 
TP_STATUS_PENCONTACT
Ë? 
MWBUTTON_L
 : 0));

290 (
EAGAIN
);

293 i‡(
ãmpy
 < 
TP_MIN_Y_SIZE
 ||Åempy > 
TP_MAX_Y_SIZE
)

295 #ifde‡
TEST


296 
	`EPRINTF
("Gotán out ofÑange Y value. X=%d,Y=%d,B=%d\n",

297 
ãmpx
, 
ãmpy
,

298 ((
d©a
[
DATA_STATUS
] & 
TP_STATUS_PENCONTACT
Ë? 
MWBUTTON_L
 : 0));

300 (
EAGAIN
);

304 *
x
 = 
ãmpx
;

305 *
y
 = 
ãmpy
;

306 *
z
 = 
d©a
[
DATA_Z
];

310 *
x
 = 0;

311 *
y
 = 0;

312 *
z
 = 0;

315 *
b
 = ((
d©a
[
DATA_STATUS
] & 
TP_STATUS_PENCONTACT
Ë? 
MWBUTTON_L
 : 0);

316 *
°©us
 = 
d©a
[
DATA_STATUS
];

319 
	}
}

322 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

324 #ifde‡
USE_FILTER


326 c⁄° 
iú_shi·_bôs
 = 3;

327 c⁄° 
iú_ßm∂e_dïth
 = (1 << 
iú_shi·_bôs
);

329 
iú_accum_x
 = 0;

330 
iú_accum_y
 = 0;

331 
iú_accum_z
 = 0;

332 
iú_cou¡
 = 0;

334 
cx
, 
cy
, 
cz
;

338 
MWPOINT
 
å™sf‹med
;

339 
îr
 = 0;

340 
ßm∂es
 = 0;

341 
xpos
 = 0;

342 
ypos
 = 0;

343 
zpos
 = 0;

344 
°©us
 = 0;

346 *
pb
 = 0;

347 *
px
 = 0;

348 *
py
 = 0;

349 *
pz
 = 0;

351 #i‚de‡
USE_FILTER


352 
cx
 = 0;

353 
cy
 = 0;

354 
cz
 = 0;

357 i‡((
îr
 = 
	`ªad_ç
(&
xpos
, &
ypos
, &
zpos
, 
pb
, &
°©us
, 0)))

359 i‡(
îr
 =
EAGAIN
)

367 i‡–(
°©us
 & 
TP_STATUS_DATAVALID
) != TP_STATUS_DATAVALID)

369 i‡(*
pb
)

372 
buâ⁄_up
;

375 (
°©us
 & 
TP_STATUS_DATAVALID
) == TP_STATUS_DATAVALID)

377 
ãmpb
 = 0;

379 
îr
 = 
	`ªad_ç
(&
xpos
, &
ypos
, &
zpos
, &
ãmpb
, &
°©us
, 1);

381 i‡(
îr
 =
EAGAIN
)

383 i‡(!
ßm∂es
)

388 i‡(
îr
)

394 i‡–(
°©us
 & 
TP_STATUS_DATAVALID
) != TP_STATUS_DATAVALID)

396 i‡(
ãmpb
)

400 *
pb
 = 
ãmpb
;

401 
buâ⁄_up
;

405 #ifde‡
USE_FILTER


409 i‡–
iú_cou¡
 =
iú_ßm∂e_dïth
 )

412 
iú_accum_x
 -iú_accum_x >> 
iú_shi·_bôs
;

413 
iú_accum_y
 -iú_accum_y >> 
iú_shi·_bôs
;

414 
iú_accum_z
 -iú_accum_z >> 
iú_shi·_bôs
;

417 
iú_accum_x
 +
xpos
;

418 
iú_accum_y
 +
ypos
;

419 
iú_accum_z
 +
zpos
;

423 
iú_accum_x
 +
xpos
;

424 
iú_accum_y
 +
ypos
;

425 
iú_accum_z
 +
zpos
;

426 
iú_cou¡
 += 1;

430 
cx
 +
xpos
;

431 
cy
 +
ypos
;

432 
cz
 +
zpos
;

435 
ßm∂es
++;

438 i‡(
ßm∂es
 >
MOU_SAMPLE_RATE
)

442 i‡(!
ßm∂es
)

445 #ifde‡
USE_FILTER


447 i‡(
iú_cou¡
 < 
iú_ßm∂e_dïth
)

450 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

453 
å™sf‹med
.
x
 = 
iú_accum_x
;

454 
å™sf‹med
.
y
 = 
iú_accum_y
;

455 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

457 *
px
 = 
å™sf‹med
.
x
 >> 2;

458 *
py
 = 
å™sf‹med
.
y
 >> 2;

462 *
px
 = (
MWCOORD
Ë
	`abs
(
iú_accum_x
);

463 *
py
 = (
MWCOORD
Ë
	`abs
(
iú_accum_y
);

467 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

469 
å™sf‹med
.
x
 = (
cx
 / 
ßm∂es
);

470 
å™sf‹med
.
y
 = (
cy
 / 
ßm∂es
);

472 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

474 *
px
 = (
MWCOORD
Ë
å™sf‹med
.
x
 >> 2;

475 *
py
 = (
MWCOORD
Ë
å™sf‹med
.
y
 >> 2;

479 *
px
 = (
MWCOORD
Ë
	`abs
(
cx
 / 
ßm∂es
);

480 *
py
 = (
MWCOORD
Ë
	`abs
(
cy
 / 
ßm∂es
);

484 
buâ⁄_up
:

485 i‡(! *
pb
)

487 #ifde‡
USE_FILTER


489 
iú_cou¡
 = 0;

490 
iú_accum_x
 = 0;

491 
iú_accum_y
 = 0;

492 
iú_accum_z
 = 0;

499 
	}
}

501 #i‚de‡
TEST


502 
MOUSEDEVICE
 
	gmou£dev
 = {

503 
PD_O≥n
,

504 
PD_Clo£
,

505 
PD_GëBuâ⁄Info
,

506 
PD_GëDeÁu…Ac˚l
,

507 
PD_Ród
,

508 
NULL


512 #ifde‡
TEST


513 
	$maö
(
¨gc
, ** 
v
)

515 
x
, 
y
, 
z
;

517 
b
;

518 
ªsu…
;

520 
	`DPRINTF
("OpeningÅouchÖanel...\n");

522 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

525 
	`DPRINTF
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

526 
	`exô
(0);

529 
	`DPRINTF
("ReadingÅouchÖanel...\n");

533 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

535 if–
ªsu…
 > 0)

537 
	`DPRINTF
("(%d,%d,%dËb = %d\n",
x
, 
y
, 
z
, 
b
);

540 
	}
}

	@drivers/mou_mt.c

11 
	~<°dio.h
>

12 
	~<°dlib.h
>

13 
	~<uni°d.h
>

14 
	~<f˙é.h
>

15 
	~<ãrmios.h
>

16 
	~"devi˚.h
"

18 
MT_O≥n
(
MOUSEDEVICE
 *
pmd
);

19 
MT_Clo£
();

20 
MT_GëBuâ⁄Info
();

21 
MT_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

22 
MT_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

24 
MOUSEDEVICE
 
	gmou£dev
 = {

25 
MT_O≥n
,

26 
MT_Clo£
,

27 
MT_GëBuâ⁄Info
,

28 
MT_GëDeÁu…Ac˚l
,

29 
MT_Ród
,

30 
NULL


33 
	gmt_fd
;

36 
	#CMD
(
fd
,
x
) \

38 
	`wrôe
 (
fd
, "\001" 
x
 "\r", 
	`°æí
(x) + 2); \

39 
	`tcdøö
(
fd
); \

40 } 0)

	)

48 
	$MT_O≥n
(
MOUSEDEVICE
 *
pmd
)

50 *
dev«me
 = "/dev/ttyS0";

51 
ãrmios
Åermios;

53 i‡((
mt_fd
 = 
	`›í
 (
dev«me
, 
O_RDWR
 | 
O_NONBLOCK
)) < 0) {

54 
	`Ârötf
 (
°dîr
, "îr‹ o≥nög '%s'\n", 
dev«me
);

55 
	`exô
 (-1);

58 
	`tcgë©å
 (
mt_fd
, &
ãrmios
);

60 
	`cf£ti•ìd
 (&
ãrmios
, 
B9600
);

61 
	`cf£to•ìd
 (&
ãrmios
, 
B9600
);

63 
	`cfmakîaw
 (&
ãrmios
);

64 
ãrmios
.
c_cÊag
 &~
CBAUD
;

65 
ãrmios
.
c_cÊag
 = 
B9600
;

66 
ãrmios
.
c_cÊag
 |
CS8
 | 
CREAD
;

67 
ãrmios
.
c_oÊag
 = 0;

68 
ãrmios
.
c_oÊag
 &~(
OCRNL
 | 
ONLRET
);

70 
	`tc£èâr
 (
mt_fd
, 
TCSAFLUSH
, &
ãrmios
);

72 
	`CMD
(
mt_fd
,"R");

73 
	`CMD
(
mt_fd
,"AD");

74 
	`CMD
(
mt_fd
,"PN812");

75 
	`CMD
(
mt_fd
,"FT");

76 
	`CMD
(
mt_fd
,"MS");

77 
	`CMD
(
mt_fd
,"PL");

84 
	`u¶ìp
 (250000);

85 
	`tcÊush
 (
mt_fd
, 
TCIOFLUSH
);

88 
	}
}

94 
	$MT_Clo£
()

96 i‡(
mt_fd
 > 0)

97 
	`˛o£
 (
mt_fd
);

99 
mt_fd
 = 0;

100 
	}
}

106 
	$MT_GëBuâ⁄Info
()

108  
MWBUTTON_L
;

109 
	}
}

116 
	$MT_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

118 *
psˇÀ
 = 3;

119 *
±hªsh
 = 5;

120 
	}
}

124 
	gbuf
 [5];

125 
	gbyãs_ö_buf
 = 0;

136 
	$MT_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

138 i‡(
byãs_ö_buf
 == 5) {

139 
byãs_ö_buf
 = 0;

141 *
dx
 = ((
buf
[1] & 0x7f) | ((buf[2] & 0x7f) << 7));

142 *
dy
 = ((
buf
[3] & 0x7f) | ((buf[4] & 0x7f) << 7));

143 *
dx
 = (*dx * 
s¸dev
.
xvúåes
) >> 14;

144 *
dy
 = 
s¸dev
.
yvúåes
 - ((*dy * scrdev.yvirtres) >> 14);

145 *
dz
 = 1;

147 i‡(!(
buf
[0] & (1 << 6)))

148 *
bp
 = 0;

150 *
bp
 = 
MWBUTTON_L
;

155 i‡(
	`ªad
 (
mt_fd
, 
buf
 + 
byãs_ö_buf
, 1) == 1)

156 
byãs_ö_buf
++;

158 i‡((
buf
[
byãs_ö_buf
-1] & 0x80) != 0) {

159 
buf
 [0] = bu‡[
byãs_ö_buf
-1];

160 
byãs_ö_buf
 = 1;

164 
	}
}

	@drivers/mou_null.c

6 
	~<°dio.h
>

7 
	~"devi˚.h
"

9 
	#SCALE
 3

	)

10 
	#THRESH
 5

	)

12 
NUL_O≥n
(
MOUSEDEVICE
 *
pmd
);

13 
NUL_Clo£
();

14 
NUL_GëBuâ⁄Info
();

15 
NUL_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

16 
NUL_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

17 
NUL_Pﬁl
();

19 
MOUSEDEVICE
 
	gmou£dev
 = {

20 
NUL_O≥n
,

21 
NUL_Clo£
,

22 
NUL_GëBuâ⁄Info
,

23 
NUL_GëDeÁu…Ac˚l
,

24 
NUL_Ród
,

25 
NUL_Pﬁl


33 
	$NUL_Pﬁl
()

36 
	}
}

42 
	$NUL_O≥n
(
MOUSEDEVICE
 *
pmd
)

45 
	}
}

51 
	$NUL_Clo£
()

53 
	}
}

59 
	$NUL_GëBuâ⁄Info
()

62 
	}
}

68 
	$NUL_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

70 *
psˇÀ
 = 
SCALE
;

71 *
±hªsh
 = 
THRESH
;

72 
	}
}

82 
	$NUL_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

85 
	}
}

	@drivers/mou_ps5.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<uni°d.h
>

7 
	~<î∫o.h
>

8 
	~<f˙é.h
>

9 
	~<m©h.h
>

10 
	~<sys/io˘l.h
>

11 
	#_LINUX_TYPES_H


	)

12 
	~<löux/fb.h
>

13 
	~</löux/ö˛ude/asm-¨m/¨ch/touch_psi⁄.h
>

15 
	~"devi˚.h
"

18 
	gpd_fd
;

23 
SCREENDEVICE
 
s¸dev
;

25 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

32 
pd_fd
 = 
	`›í
("/dev/touch_psi⁄", 
O_NONBLOCK
);

33 i‡(
pd_fd
 < 0) {

34 
	`Ârötf
(
°dîr
, "Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

38 
	`GdHideCurs‹
(&
s¸dev
);

39  
pd_fd
;

40 
	}
}

42 
	$PD_Clo£
()

45 
	`Ârötf
(
°dîr
,"PD_Close called\n");

46 i‡(
pd_fd
 > 0)

47 
	`˛o£
(
pd_fd
);

48 
pd_fd
 = 0;

49 
	}
}

51 
	$PD_GëBuâ⁄Info
()

54  
MWBUTTON_L
;

55 
	}
}

57 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

64 *
psˇÀ
 = 3;

65 *
±hªsh
 = 5;

66 
	}
}

68 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

71 
touch_psi⁄_evít
 
d©a
;

72 
byãs_ªad
;

74 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
d©a
, (data));

76 i‡(
byãs_ªad
 !(
d©a
)) {

77 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)

82 *
px
 = (
MWCOORD
)
d©a
.
x_c
;

83 *
py
 = (
MWCOORD
)
d©a
.
y_c
;

85 *
pb
 = (
d©a
.
down
>0?
MWBUTTON_L
:0);

86 *
pz
 = 0;

88 if((*
px
 =-1 || *
py
 =-1Ë&& *
pb
 >= 0)

90 if((*
px
 =-1 || *
py
 =-1Ë&& *
pb
 < 0)

93 
	}
}

95 
MOUSEDEVICE
 
	gmou£dev
 = {

96 
PD_O≥n
,

97 
PD_Clo£
,

98 
PD_GëBuâ⁄Info
,

99 
PD_GëDeÁu…Ac˚l
,

100 
PD_Ród
,

101 
NULL


104 #ifde‡
TEST


105 
	$maö
(
¨gc
, ** 
v
)

107 
MWCOORD
 
x
, 
y
, 
z
;

108 
MWBUTTON
 
b
;

109 
ªsu…
;

110 
mou£
 = -1;

111 
	`¥ötf
("OpeningÅouchÖanel...\n");

113 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

114 
	`¥ötf
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

121 if(
¨gc
 > 1) {

122 
	`io˘l
(
ªsu…
,1,
	`©oi
(
v
[1]));

123 
	`Ârötf
(
°dîr
,"SëtögÖªssuªÅÿ%d\n",
	`©oi
(
v
[1]));

125 if(
¨gc
 > 2) {

126 
	`io˘l
(
ªsu…
,2,
	`©oi
(
v
[2]));

127 
	`Ârötf
(
°dîr
,"Sëtög updñayÅÿ%d\n",
	`©oi
(
v
[2]));

129 if(
¨gc
 > 3) {

130 
	`io˘l
(
ªsu…
,3,
	`©oi
(
v
[3]));

131 
	`Ârötf
(
°dîr
,"SëtögÑaw xÅÿ%d\n",
	`©oi
(
v
[3]));

133 if(
¨gc
 > 4) {

134 
	`io˘l
(
ªsu…
,4,
	`©oi
(
v
[4]));

135 
	`Ârötf
(
°dîr
,"SëtögÑaw yÅÿ%d\n",
	`©oi
(
v
[4]));

137 if(
¨gc
 > 5) {

138 
	`io˘l
(
ªsu…
,5,
	`©oi
(
v
[5]));

139 
	`Ârötf
(
°dîr
,"SëtögÑe†xÅÿ%d\n",
	`©oi
(
v
[5]));

141 if(
¨gc
 > 6) {

142 
	`io˘l
(
ªsu…
,6,
	`©oi
(
v
[6]));

143 
	`Ârötf
(
°dîr
,"SëtögÑe†yÅÿ%d\n",
	`©oi
(
v
[6]));

145 if(
¨gc
 > 7) {

146 
	`io˘l
(
ªsu…
,7,
	`©oi
(
v
[7]));

147 
	`Ârötf
(
°dîr
,"Sëtög fudgêxÅÿ%d\n",
	`©oi
(
v
[7]));

149 if(
¨gc
 > 8) {

150 
	`io˘l
(
ªsu…
,8,
	`©oi
(
v
[8]));

151 
	`Ârötf
(
°dîr
,"Sëtög fudgêyÅÿ%d\n",
	`©oi
(
v
[8]));

153 if(
¨gc
 > 9) {

154 
	`io˘l
(
ªsu…
,9,
	`©oi
(
v
[9]));

155 
	`Ârötf
(
°dîr
,"Sëtögávîagêßm∂êtÿ%d\n",
	`©oi
(
v
[9]));

157 if(
¨gc
 > 10) {

158 
	`io˘l
(
ªsu…
,10,
	`©oi
(
v
[10]));

159 
	`Ârötf
(
°dîr
,"SëtögÑaw mö xÅÿ%d\n",
	`©oi
(
v
[10]));

161 if(
¨gc
 > 11) {

162 
	`io˘l
(
ªsu…
,11,
	`©oi
(
v
[11]));

163 
	`Ârötf
(
°dîr
,"SëtögÑaw mö yÅÿ%d\n",
	`©oi
(
v
[11]));

166 
	`¥ötf
("ReadingÅouchÖanel...\n");

169 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

170 if–
ªsu…
 > 0) {

171 if(
mou£
 !
b
) {

172 
mou£
 = 
b
;

173 if(
mou£
)

174 
	`¥ötf
("Pen Down\n");

176 
	`¥ötf
("Pen Up\n");

179 
	`¥ötf
("%d,%d,%d,%d,%d\n", 
ªsu…
, 
x
, 
y
, 
z
, 
b
);

183 
	}
}

	@drivers/mou_rtems.c

26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<f˙é.h
>

29 
	~<sys/io˘l.h
>

30 
	~<î∫o.h
>

32 
	~<πems/mw_uid.h
>

33 
	~"devi˚.h
"

35 
˛o£
 (
fd
);

37 
	#SCALE
 3

	)

38 
	#THRESH
 5

	)

41 
MWMou_O≥n
 (
MOUSEDEVICE
 *
pmd
);

42 
MWMou_Clo£
 ();

43 
MWMou_GëBuâ⁄Info
 ();

44 
MWMou_GëDeÁu…Ac˚l
 (*
psˇÀ
,*
±hªsh
);

45 
MWMou_Ród
 (
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

47 
MOUSEDEVICE
 
	gmou£dev
 =

49 
MWMou_O≥n
,

50 
MWMou_Clo£
,

51 
MWMou_GëBuâ⁄Info
,

52 
MWMou_GëDeÁu…Ac˚l
,

53 
MWMou_Ród
,

54 
NULL
,

55 
MOUSE_NORMAL


59 
	gmou_fd
 = -1;

60 
MW_UID_MESSAGE
 
	gm_mou
 = { 0 };

61 c⁄° *
	gQ_NAME
 = "MWQ";

62 
	#Q_MAX_MSGS
 20

	)

63 
	#MOUSE_DEVICE
 "/dev/mou£"

	)

70 
	$MWMou_O≥n
 (
MOUSEDEVICE
 *
pmd
)

72 
rc
;

73 
m_mou
.
ty≥
 = 
MV_UID_INVALID
;

74 
rc
 = 
	`uid_›í_queue
 (
Q_NAME
, 
O_CREAT
 | 
O_RDWR
, 
Q_MAX_MSGS
);

75 
mou_fd
 = 
	`›í
 (
MOUSE_DEVICE
, 
O_NONBLOCK
);

76 
	`uid_ªgi°î_devi˚
 (
mou_fd
, 
Q_NAME
);

78 
	}
}

84 
	$MWMou_Clo£
 ()

86 
	`uid_uƒegi°î_devi˚
 (
mou_fd
);

87 
	`uid_˛o£_queue
 ();

88 
	`˛o£
 (
mou_fd
);

89 
	}
}

95 
	$MWMou_GëBuâ⁄Info
 ()

98 
	}
}

104 
	$MWMou_GëDeÁu…Ac˚l
 (*
psˇÀ
,*
±hªsh
)

106 *
psˇÀ
 = 
SCALE
;

107 *
±hªsh
 = 
THRESH
;

108 
	}
}

118 
	$MWMou_Ród
 (
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

121 i‡(
m_mou
.
ty≥
 !
MV_UID_INVALID
)

124 
rc
 = (
m_mou
.
ty≥
 =
MV_UID_REL_POS
) ? 1 : 2;

126 *
bp
 = 
m_mou
.
m
.
pos
.
bäs
;

127 *
dx
 = 
m_mou
.
m
.
pos
.
x
;

128 *
dy
 = 
m_mou
.
m
.
pos
.
y
;

129 *
dz
 = 
m_mou
.
m
.
pos
.
z
;

131 
m_mou
.
ty≥
 = 
MV_UID_INVALID
;

132  
rc
;

135 
	}
}

	@drivers/mou_ser.c

20 
	~<°dio.h
>

21 
	~<°dlib.h
>

22 
	~<uni°d.h
>

23 
	~<î∫o.h
>

24 
	~<f˙é.h
>

25 
	~<°rög.h
>

26 
	~"devi˚.h
"

28 
	#TERMIOS
 1

	)

29 
	#SGTTY
 0

	)

31 
	#SCALE
 3

	)

32 
	#THRESH
 5

	)

34 #i‡
TERMIOS


35 
	~<ãrmios.h
>

37 #i‡
SGTTY


38 
	~<sgây.h
>

42 #i‡
_MINIX


43 
	#MOUSE_PORT
 "/dev/mou£"

	)

44 
	#MOUSE_TYPE
 "ms"

	)

46 #i‡
ELKS


47 
	#MOUSE_PORT
 "/dev/âys0"

	)

50 
	#MOUSE_PORT
 "/dev/pßux"

	)

54 
	#MOUSE_TYPE
 "ps2"

	)

58 
	#MAX_BYTES
 128

	)

61 
	#IDLE
 0

	)

62 
	#XSET
 1

	)

63 
	#YSET
 2

	)

64 
	#XADD
 3

	)

65 
	#YADD
 4

	)

68 
	#PC_LEFT_BUTTON
 4

	)

69 
	#PC_MIDDLE_BUTTON
 2

	)

70 
	#PC_RIGHT_BUTTON
 1

	)

72 
	#MS_LEFT_BUTTON
 2

	)

73 
	#MS_RIGHT_BUTTON
 1

	)

75 
	#PS2_CTRL_BYTE
 0x08

	)

76 
	#PS2_LEFT_BUTTON
 1

	)

77 
	#PS2_RIGHT_BUTTON
 2

	)

80 
	#TOP_FIVE_BITS
 0xf8

	)

81 
	#BOTTOM_THREE_BITS
 0x07

	)

82 
	#TOP_BIT
 0x80

	)

83 
	#SIXTH_BIT
 0x40

	)

84 
	#BOTTOM_TWO_BITS
 0x03

	)

85 
	#THIRD_FOURTH_BITS
 0x0c

	)

86 
	#BOTTOM_SIX_BITS
 0x3f

	)

89 
	gmou£_fd
;

90 
	g°©e
;

91 
	gbuâ⁄s
;

92 
	gavaûbuâ⁄s
;

93 
MWCOORD
 
	gxd
;

94 
MWCOORD
 
	gyd
;

96 
	gÀ·
;

97 
	gmiddÀ
;

98 
	gright
;

100 *
	gbp
;

101 
	gnbyãs
;

102 
	gbuf„r
[
MAX_BYTES
];

103 (*
	g∑r£
)();

106 
MOU_O≥n
(
MOUSEDEVICE
 *
pmd
);

107 
MOU_Clo£
();

108 
MOU_GëBuâ⁄Info
();

109 
MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

110 
MOU_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
b±r
);

111 
MOU_Pﬁl
();

112 
P¨£PC
();

113 
P¨£MS
();

114 
P¨£PS2
();

116 
MOUSEDEVICE
 
	gmou£dev
 = {

117 
MOU_O≥n
,

118 
MOU_Clo£
,

119 
MOU_GëBuâ⁄Info
,

120 
MOU_GëDeÁu…Ac˚l
,

121 
MOU_Ród
,

122 #i‡
_MINIX


123 
MOU_Pﬁl
,

125 
NULL
,

127 
MOUSE_NORMAL


135 
	$MOU_O≥n
(
MOUSEDEVICE
 *
pmd
)

137 *
ty≥
;

138 *
p‹t
;

139 
ãrmios
Åermios;

142 if–!(
ty≥
 = 
	`gëív
("MOUSE_TYPE")))

143 
ty≥
 = 
MOUSE_TYPE
;

145 if–!(
p‹t
 = 
	`gëív
("MOUSE_PORT")))

146 
p‹t
 = 
MOUSE_PORT
;

149 if(!
	`°rcmp
(
ty≥
, "pc") || !strcmp(type, "logi")) {

151 
À·
 = 
PC_LEFT_BUTTON
;

152 
middÀ
 = 
PC_MIDDLE_BUTTON
;

153 
right
 = 
PC_RIGHT_BUTTON
;

154 
∑r£
 = 
P¨£PC
;

155 } i‡(
	`°rcmp
(
ty≥
, "ms") == 0) {

157 
À·
 = 
MS_LEFT_BUTTON
;

158 
right
 = 
MS_RIGHT_BUTTON
;

159 
middÀ
 = 0;

160 
∑r£
 = 
P¨£MS
;

161 } i‡(
	`°rcmp
(
ty≥
, "ps2") == 0) {

163 
À·
 = 
PS2_LEFT_BUTTON
;

164 
right
 = 
PS2_RIGHT_BUTTON
;

165 
middÀ
 = 0;

166 
∑r£
 = 
P¨£PS2
;

171 
mou£_fd
 = 
	`›í
(
p‹t
, 
O_NONBLOCK
);

172 i‡(
mou£_fd
 < 0) {

173 
	`EPRINTF
("Error %d opening serial mouseÅype %s onÖort %s.\n",

174 
î∫o
, 
ty≥
, 
p‹t
);

178 #i‡
SGTTY


180 
sgâyb
 sgttyb;

182 i‡(
	`io˘l
(
fd
, 
TIOCGETP
, &
sgâyb
) == -1)

183 
îr
;

184 
sgâyb
.
sg_Êags
 |
RAW
;

185 
sgâyb
.
sg_Êags
 &~(
EVENP
 | 
ODDP
 | 
ECHO
 | 
XTABS
 | 
CRMOD
);

187 i‡(
	`io˘l
(
fd
, 
TIOCSETP
, &
sgâyb
) == -1)

188 
îr
;

189 i‡(
	`io˘l
(
fd
, 
TIOCFLUSH
, 0) < 0)

190 
îr
;

193 #i‡
TERMIOS


201 
	`tcgë©å
(
mou£_fd
, &
ãrmios
);

204 if(
	`cfgëi•ìd
(&
ãrmios
Ë!
B1200
)

205 
	`cf£ti•ìd
(&
ãrmios
, 
B1200
);

206 #i‡
_MINIX


207 if(
	`cfgëo•ìd
(&
ãrmios
Ë!
B1200
)

208 
	`cf£to•ìd
(&
ãrmios
, 
B1200
);

211 #i‡!
_MINIX


212 
ãrmios
.
c_cÊag
 &~
CBAUD
;

213 
ãrmios
.
c_cÊag
 |
B1200
;

215 
ãrmios
.
c_lÊag
 &~(
ECHO
 | 
ECHONL
 | 
ICANON
 | 
IEXTEN
 | 
ISIG
);

216 
ãrmios
.
c_iÊag
 &~(
ICRNL
 | 
INPCK
 | 
ISTRIP
 | 
IXON
 | 
BRKINT
 | 
IGNBRK
);

217 
ãrmios
.
c_cÊag
 &~(
CSIZE
 | 
PARENB
);

219 i‡(!
	`°rcmp
(
ty≥
, "ps2") || !strcmp(type, "pc"))

220 
ãrmios
.
c_cÊag
 |
CS8
;

222 
ãrmios
.
c_cÊag
 |
CS7
;

223 
ãrmios
.
c_cc
[
VMIN
] = 0;

224 
ãrmios
.
c_cc
[
VTIME
] = 0;

226 
	`tc£èâr
(
mou£_fd
, 
TCSAFLUSH
, &
ãrmios
);

230 
avaûbuâ⁄s
 = 
À·
 | 
middÀ
 | 
right
;

231 
°©e
 = 
IDLE
;

232 
nbyãs
 = 0;

233 
buâ⁄s
 = 0;

234 
xd
 = 0;

235 
yd
 = 0;

236  
mou£_fd
;

237 
îr
:

238 
	`˛o£
(
mou£_fd
);

239 
mou£_fd
 = 0;

241 
	}
}

247 
	$MOU_Clo£
()

249 i‡(
mou£_fd
 > 0)

250 
	`˛o£
(
mou£_fd
);

251 
mou£_fd
 = -1;

252 
	}
}

258 
	$MOU_GëBuâ⁄Info
()

260  
avaûbuâ⁄s
;

261 
	}
}

267 
	$MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

269 *
psˇÀ
 = 
SCALE
;

270 *
±hªsh
 = 
THRESH
;

271 
	}
}

281 
	$MOU_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
b±r
)

283 
b
;

290 i‡(
nbyãs
 <= 0) {

291 
bp
 = 
buf„r
;

292 
nbyãs
 = 
	`ªad
(
mou£_fd
, 
bp
, 
MAX_BYTES
);

293 i‡(
nbyãs
 < 0) {

294 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)

296 #i‡
_MINIX


309 
nbyãs
-- > 0) {

310 i‡((*
∑r£
)((Ë*
bp
++)) {

311 *
dx
 = 
xd
;

312 *
dy
 = 
yd
;

313 *
dz
 = 0;

314 
b
 = 0;

315 if(
buâ⁄s
 & 
À·
)

316 
b
 |
MWBUTTON_L
;

317 if(
buâ⁄s
 & 
right
)

318 
b
 |
MWBUTTON_R
;

319 if(
buâ⁄s
 & 
middÀ
)

320 
b
 |
MWBUTTON_M
;

321 *
b±r
 = 
b
;

326 
	}
}

333 
	$P¨£PC
(
byã
)

335 
sign
;

337 
°©e
) {

338 
IDLE
:

339 i‡((
byã
 & 
TOP_FIVE_BITS
Ë=
TOP_BIT
) {

340 
buâ⁄s
 = ~
byã
 & 
BOTTOM_THREE_BITS
;

341 
°©e
 = 
XSET
;

345 
XSET
:

346 
sign
 = 1;

347 i‡(
byã
 > 127) {

348 
byã
 = 256 - byte;

349 
sign
 = -1;

351 
xd
 = 
byã
 * 
sign
;

352 
°©e
 = 
YSET
;

355 
YSET
:

356 
sign
 = 1;

357 i‡(
byã
 > 127) {

358 
byã
 = 256 - byte;

359 
sign
 = -1;

361 
yd
 = -
byã
 * 
sign
;

362 
°©e
 = 
XADD
;

365 
XADD
:

366 
sign
 = 1;

367 i‡(
byã
 > 127) {

368 
byã
 = 256 - byte;

369 
sign
 = -1;

371 
xd
 +
byã
 * 
sign
;

372 
°©e
 = 
YADD
;

375 
YADD
:

376 
sign
 = 1;

377 i‡(
byã
 > 127) {

378 
byã
 = 256 - byte;

379 
sign
 = -1;

381 
yd
 -
byã
 * 
sign
;

382 
°©e
 = 
IDLE
;

386 
	}
}

394 
	$P¨£MS
(
byã
)

396 
°©e
) {

397 
IDLE
:

398 i‡(
byã
 & 
SIXTH_BIT
) {

399 
buâ⁄s
 = (
byã
 >> 4Ë& 
BOTTOM_TWO_BITS
;

400 
yd
 = ((
byã
 & 
THIRD_FOURTH_BITS
) << 4);

401 
xd
 = ((
byã
 & 
BOTTOM_TWO_BITS
) << 6);

402 
°©e
 = 
XADD
;

406 
XADD
:

407 
xd
 |(
byã
 & 
BOTTOM_SIX_BITS
);

408 
°©e
 = 
YADD
;

411 
YADD
:

412 
yd
 |(
byã
 & 
BOTTOM_SIX_BITS
);

413 
°©e
 = 
IDLE
;

414 i‡(
xd
 > 127)

415 
xd
 -= 256;

416 i‡(
yd
 > 127)

417 
yd
 -= 256;

421 
	}
}

428 
	$P¨£PS2
(
byã
)

430 
°©e
) {

431 
IDLE
:

432 i‡(
byã
 & 
PS2_CTRL_BYTE
) {

433 
buâ⁄s
 = 
byã
 &

434 (
PS2_LEFT_BUTTON
|
PS2_RIGHT_BUTTON
);

435 
°©e
 = 
XSET
;

439 
XSET
:

440 if(
byã
 > 127)

441 
byã
 -= 256;

442 
xd
 = 
byã
;

443 
°©e
 = 
YSET
;

446 
YSET
:

447 if(
byã
 > 127)

448 
byã
 -= 256;

449 
yd
 = -
byã
;

450 
°©e
 = 
IDLE
;

454 
	}
}

457 
	$MOU_Pﬁl
()

460 
	}
}

463 #i‡
TEST


464 
	$maö
()

466 
MWCOORD
 
x
, 
y
, 
z
;

467 
b
;

469 
	`DPRINTF
("Open Mouse\n");

470 if–
	`MOU_O≥n
(0) < 0)

471 
	`DPRINTF
("open failed mouse\n" );

475 if(
	`MOU_Ród
(&
x
, &
y
, &
z
, &
b
) == 1)

477 
	`DPRINTF
("%d,%d,%d\n", 
x
, 
y
, 
b
);

480 
	}
}

	@drivers/mou_sun.c

9 
	~<°dio.h
>

10 
	~<î∫o.h
>

11 
	~<uni°d.h
>

12 
	~<ãrmios.h
>

13 
	~<f˙é.h
>

14 
	~"devi˚.h
"

16 
	#SCALE
 3

	)

17 
	#THRESH
 5

	)

19 
	#SUN_DEV_FILE
 "/dev/sunmou£"

	)

21 
SUN_O≥n
(
MOUSEDEVICE
 *
pmd
);

22 
SUN_Clo£
();

23 
SUN_GëBuâ⁄Info
();

24 
MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

25 
SUN_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

27 
MOUSEDEVICE
 
	gmou£dev
 = {

28 
SUN_O≥n
,

29 
SUN_Clo£
,

30 
SUN_GëBuâ⁄Info
,

31 
MOU_GëDeÁu…Ac˚l
,

32 
SUN_Ród
,

33 
NULL


36 
	gmou£_fd
;

43 
	$SUN_O≥n
(
MOUSEDEVICE
 *
pmd
)

45 
ãrmios
Åermios;

47 
mou£_fd
 = 
	`›í
(
SUN_DEV_FILE
, 
O_NONBLOCK
);

48 i‡(
mou£_fd
 < 0)

51 
	`tcgë©å
(
mou£_fd
, &
ãrmios
);

53 if(
	`cfgëi•ìd
(&
ãrmios
Ë!
B1200
)

54 
	`cf£ti•ìd
(&
ãrmios
, 
B1200
);

56 
ãrmios
.
c_iÊag
 = 
IGNBRK
 | 
IGNPAR
;

57 
ãrmios
.
c_oÊag
 = 0;

58 
ãrmios
.
c_lÊag
 = 0;

59 
ãrmios
.
c_löe
 = 0;

60 
ãrmios
.
c_cc
[
VTIME
] = 0;

61 
ãrmios
.
c_cc
[
VMIN
] = 1;

62 
ãrmios
.
c_cÊag
 = 
CS8
 | 
CSTOPB
 | 
CREAD
 | 
CLOCAL
 | 
HUPCL
 | 
B1200
;

64 
	`tc£èâr
(
mou£_fd
, 
TCSAFLUSH
, &
ãrmios
);

66  
mou£_fd
;

67 
	}
}

73 
	$SUN_Clo£
()

75 i‡(
mou£_fd
 > 0)

76 
	`˛o£
(
mou£_fd
);

77 
mou£_fd
 = -1;

78 
	}
}

84 
	$SUN_GëBuâ⁄Info
()

86  
MWBUTTON_L
 | 
MWBUTTON_M
 | 
MWBUTTON_R
;

87 
	}
}

93 
	$MOU_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

95 *
psˇÀ
 = 
SCALE
;

96 *
±hªsh
 = 
THRESH
;

97 
	}
}

107 
	$SUN_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

109 
buf
[3];

110 
nbyãs
;

111 
n
;

113 (
n
 = 
	`ªad
(
mou£_fd
, &
buf
[0], 1))) {

114 if(
n
 < 0) {

115 i‡((
î∫o
 =
EINTR
Ë|| (î∫ÿ=
EAGAIN
))

121 if((
buf
[0]&0xf8) != 0x80)

123 
nbyãs
 = 1;

124 (
n
 = 
	`ªad
(
mou£_fd
, &
buf
[
nbyãs
], 3 -Çbytes))) {

125 if(
n
 < 0) {

126 i‡((
î∫o
 =
EINTR
Ë|| (î∫ÿ=
EAGAIN
))

131 
nbyãs
 +
n
;

133 if(
nbyãs
 == 3) {

135 *
bp
 = (~
buf
[0]) & 0x07;

136 *
dx
 = (sig√d )(
buf
[1]);

137 *
dy
 = -(sig√d )(
buf
[2]);

138 *
dz
 = 0;

139 
nbyãs
 = 0;

144 
	}
}

	@drivers/mou_touchscreen.c

22 
	~<°dio.h
>

23 
	~<î∫o.h
>

24 
	~<uni°d.h
>

25 
	~<f˙é.h
>

26 
	~"devi˚.h
"

28 #ifde‡
TOUCHSCREEN_ZAURUS


29 
	~"touchs¸ìn_zaurus.h
"

32 #ifde‡
TOUCHSCREEN_IPAQ


33 
	~"touchs¸ìn_ùaq.h
"

36 #ifde‡
TOUCHSCREEN_ADS


37 
	~"touchs¸ìn_ads.h
"

40 #ifde‡
TOUCHSCREEN_ADS7846


41 
	~"touchs¸ìn_ads7846.h
"

45 #ifde‡
TOUCHSCREEN_TUXSCREEN


46 
	~"touchs¸ìn_ucb1x00.h
"

49 #i‚de‡
TS_DEVICE


53 
	gpd_fd
 = -1;

54 
SCREENDEVICE
 
s¸dev
;

56 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

58 if((
pd_fd
 = 
	`›í
(
TS_DEVICE_FILE
, 
O_NONBLOCK
)) < 0) {

59 
	`EPRINTF
("Error %d opening %sÅouchscreen device [%s]\n",

60 
î∫o
, 
TS_DEVICE
, 
TS_DEVICE_FILE
);

64 
	`GdHideCurs‹
(&
s¸dev
);

65  
pd_fd
;

66 
	}
}

68 
	$PD_Clo£
()

72 if(
pd_fd
 < 0) ;

74 
	`˛o£
(
pd_fd
);

75 
pd_fd
 = -1;

76 
	}
}

78 
	$PD_GëBuâ⁄Info
()

81  
MWBUTTON_L
;

82 
	}
}

84 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

86 *
psˇÀ
 = 3;

87 *
±hªsh
 = 5;

88 
	}
}

90 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
, 
mode
)

92 
ts_evít
 
evít
;

93 
byãs_ªad
;

96 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
evít
, (event));

98 if(
byãs_ªad
 !(
evít
)) {

99 if(
byãs_ªad
 == -1) {

100 if(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)  0;

101 
	`EPRINTF
("[%s] Eº‹ %dÑódög fromÅouchÖ™ñ\n", 
TS_DEVICE
, 
î∫o
);

105 
	`EPRINTF
("[%s] WrongÇumber of bytes %dÑead fromÅouchÖanel "

106 "”x≥˘ed %d)\n", 
TS_DEVICE
, 
byãs_ªad
, (
evít
));

110 *
px
 = 
evít
.
x
;

111 *
py
 = 
evít
.
y
;

113 #i‡
	`deföed
(
TOUCHSCREEN_IPAQ
Ë|| deföed(
TOUCHSCREEN_ADS7846
)

114 *
pb
 = (
evít
.
¥essuª
Ë? 
MWBUTTON_L
 : 0;

116 *
pb
 = (
evít
.
¥essuª
 > 50Ë? 
MWBUTTON_L
 : 0;

119 *
pz
 = 
evít
.
¥essuª
;

121 if(!*
pb
)

124 
	}
}

126 
MOUSEDEVICE
 
	gmou£dev
 = {

127 
PD_O≥n
,

128 
PD_Clo£
,

129 
PD_GëBuâ⁄Info
,

130 
PD_GëDeÁu…Ac˚l
,

131 
PD_Ród
,

132 
NULL
,

133 
MOUSE_TRANSFORM


	@drivers/mou_vrlinux.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<uni°d.h
>

13 
	~<î∫o.h
>

14 
	~<f˙é.h
>

15 
	~<m©h.h
>

16 
	~<sys/io˘l.h
>

17 
	~"devi˚.h
"

24 #ifde‡
TOUCHSCREEN_HELIO


25 
	#TS_DEVICE
 "Hñio"

	)

26 
	#TS_DEVICE_FILE
 "/dev/ç™ñ"

	)

29 #ifde‡
TOUCHSCREEN_EPLANET


30 
	#TS_DEVICE
 "Embedded Pœ√t"

	)

31 
	#TS_DEVICE_FILE
 "/dev/ç™ñ"

	)

32 
	~<löux/ç™ñ.h
>

35 #i‚de‡
TS_DEVICE


39 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

41 #ifde‡
TOUCHSCREEN_EPLANET


42 
sˇ≈¨am
 
s
;

43 
£âÀ_uµî_limô
;

44 
ªsu…
;

47 if((
pd_fd
 = 
	`›í
(
TS_DEVICE_FILE
, 
O_NONBLOCK
)) < 0) {

48 
	`EPRINTF
("[%s} Error %d openingÅouchscreen device [%s]\n",

49 
TS_DEVICE
, 
î∫o
, 
TS_DEVICE_FILE
);

53 #ifde‡
TOUCHSCREEN_EPLANET


55 
s
.
öãrvÆ
 = 5000;

63 
£âÀ_uµî_limô
 = (
s
.
öãrvÆ
 / 5) - 60;

64 
s
.
£âÀtime
 = 
£âÀ_uµî_limô
 * 50 / 100;

65 
ªsu…
 = 
	`io˘l
(
pd_fd
, 
TPSETSCANPARM
, &
s
);

66 i‡–
ªsu…
 < 0 )

67 
	`EPRINTF
("Error %d,Ñesult %d setting scanÖarameters.\n",

68 
ªsu…
, 
î∫o
);

71 
	`GdHideCurs‹
(&
s¸dev
);

72  
pd_fd
;

73 
	}
}

75 
	$PD_Clo£
()

78 i‡(
pd_fd
 > 0)

79 
	`˛o£
(
pd_fd
);

80 
pd_fd
 = 0;

81 
	}
}

83 
	$PD_GëBuâ⁄Info
()

86  
MWBUTTON_L
;

87 
	}
}

89 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

96 *
psˇÀ
 = 3;

97 *
±hªsh
 = 5;

98 
	}
}

100 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
) {

102 #ifde‡
TOUCHSCREEN_HELIO


103 
d©a
[3];

105 
d©a
[6];

107 
byãs_ªad
;

109 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
evít
, (event));

111 if(
byãs_ªad
 !(
evít
)) {

112 if(
byãs_ªad
 == -1) {

113 if(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)  0;

114 
	`EPRINTF
("[%s] Eº‹ %dÑódög fromÅouchÖ™ñ\n", 
TS_DEVICE
, 
î∫o
);

118 
	`EPRINTF
("[%s] WrongÇumber of bytes %dÑead fromÅouchÖanel "

119 "”x≥˘ed %d)\n", 
TS_DEVICE
, 
byãs_ªad
, (
evít
));

123 #i‚de‡
TOUCHSCREEN_HELIO


125 i‡(
d©a
[0] & 0x2000)  0;

127 i‡((
d©a
[0] & 0x8000) == 0) {

128 i‡((
d©a
[0] & 0x4000) == 0) {

129 *
pb
 = 0;

136 *
px
 = 
d©a
[2] - data[1];

137 *
py
 = 
d©a
[4] - data[3];

138 *
pz
 = 
d©a
[5];

140 *
pb
 = 
MWBUTTON_L
;

142 *
px
 = 
d©a
[1];

143 *
py
 = 
d©a
[2];

144 *
pz
 = 
d©a
[0] ? 2000 : 0;

148 
	}
}

150 
MOUSEDEVICE
 
	gmou£dev
 = {

151 
PD_O≥n
,

152 
PD_Clo£
,

153 
PD_GëBuâ⁄Info
,

154 
PD_GëDeÁu…Ac˚l
,

155 
PD_Ród
,

156 
NULL


157 
MOUSE_TRANSFORM


	@drivers/mou_x11.c

5 
	~<°dio.h
>

6 
	~<î∫o.h
>

7 
	~<uni°d.h
>

8 
	~<X11/Xlib.h
>

9 
	~"devi˚.h
"

11 
	#SCALE
 3

	)

12 
	#THRESH
 5

	)

14 
X11_O≥n
(
MOUSEDEVICE
 *
pmd
);

15 
X11_Clo£
();

16 
X11_GëBuâ⁄Info
();

17 
X11_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
);

18 
X11_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
);

20 
Di•œy
* 
x11_dpy
;

21 
x11_s¸
;

22 
VisuÆ
* 
x11_vis
;

23 
Wödow
 
x11_wö
;

24 
GC
 
x11_gc
;

25 
x11_evít_mask
;

26 
x11_£tup_di•œy
();

27 
x11_h™dÀ_evít
(
XEvít
*);

29 
MOUSEDEVICE
 
	gmou£dev
 = {

30 
X11_O≥n
,

31 
X11_Clo£
,

32 
X11_GëBuâ⁄Info
,

33 
X11_GëDeÁu…Ac˚l
,

34 
X11_Ród
,

35 
NULL
,

36 
MOUSE_NORMAL


43 
	$X11_O≥n
(
MOUSEDEVICE
 *
pmd
)

45 i‡(
	`x11_£tup_di•œy
() < 0)

48  
	`C⁄√˘i⁄Numbî
(
x11_dpy
);

49 
	}
}

55 
	$X11_Clo£
()

58 
	}
}

64 
	$X11_GëBuâ⁄Info
()

66  
MWBUTTON_L
 | 
MWBUTTON_M
 | 
MWBUTTON_R
;

67 
	}
}

73 
	$X11_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

75 *
psˇÀ
 = 
SCALE
;

76 *
±hªsh
 = 
THRESH
;

77 
	}
}

87 
	$X11_Ród
(
MWCOORD
 *
dx
, MWCOORD *
dy
, MWCOORD *
dz
, *
bp
)

89 
n€vít_cou¡
 = 0;

90 
XEvít
 
ev
;

91 
evíts
 = 0;

92 
mask
 =

93 #ifde‡
USE_EXPOSURE


94 
Buâ⁄PªssMask
 | 
Buâ⁄Rñó£Mask
 | 
PoöãrMŸi⁄Mask
 | 
ExposuªMask
;

96 
Buâ⁄PªssMask
 | 
Buâ⁄Rñó£Mask
 | 
PoöãrMŸi⁄Mask
;

99 
	`XCheckMaskEvít
(
x11_dpy
, 
mask
, &
ev
)) {

100 i‡(
ev
.
ty≥
 =
MŸi⁄NŸify
) {

101 i‡(
ev
.
xmŸi⁄
.
wödow
 =
x11_wö
) {

102 
buâ⁄
 = 0;

103 *
dx
 = 
ev
.
xmŸi⁄
.
x
;

104 *
dy
 = 
ev
.
xmŸi⁄
.
y
;

105 *
dz
 = 0;

106 i‡(
ev
.
xmŸi⁄
.
°©e
 & 
Buâ⁄1Mask
)

107 
buâ⁄
 |
MWBUTTON_L
;

108 i‡(
ev
.
xmŸi⁄
.
°©e
 & 
Buâ⁄2Mask
)

109 
buâ⁄
 |
MWBUTTON_M
;

110 i‡(
ev
.
xmŸi⁄
.
°©e
 & 
Buâ⁄3Mask
)

111 
buâ⁄
 |
MWBUTTON_R
;

112 *
bp
 = 
buâ⁄
;

113 
evíts
++;

116 i‡(
ev
.
ty≥
 =
Buâ⁄Pªss
) {

117 i‡(
ev
.
xbuâ⁄
.
wödow
 =
x11_wö
) {

118 
buâ⁄
 = 0;

121 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 1)

122 
buâ⁄
 = 
MWBUTTON_L
;

123 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 2)

124 
buâ⁄
 = 
MWBUTTON_M
;

125 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 3)

126 
buâ⁄
 = 
MWBUTTON_R
;

129 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄1Mask
)

130 
buâ⁄
 |
MWBUTTON_L
;

131 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄2Mask
)

132 
buâ⁄
 |
MWBUTTON_M
;

133 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄3Mask
)

134 
buâ⁄
 |
MWBUTTON_R
;

138 *
bp
 = 
buâ⁄
;

139 *
dx
 = 
ev
.
xbuâ⁄
.
x
;

140 *
dy
 = 
ev
.
xbuâ⁄
.
y
;

141 *
dz
 = 0;

142 
evíts
++;

145 i‡(
ev
.
ty≥
 =
Buâ⁄Rñó£
) {

146 i‡(
ev
.
xbuâ⁄
.
wödow
 =
x11_wö
) {

147 
buâ⁄
 = 0;

148 
ªÀa£d
 = 0;

151 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 1)

152 
ªÀa£d
 = 
MWBUTTON_L
;

153 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 2)

154 
ªÀa£d
 = 
MWBUTTON_M
;

155 if(
ev
.
xbuâ⁄
.
buâ⁄
 == 3)

156 
ªÀa£d
 = 
MWBUTTON_R
;

159 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄1Mask
)

160 
buâ⁄
 |
MWBUTTON_L
;

161 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄2Mask
)

162 
buâ⁄
 |
MWBUTTON_M
;

163 i‡(
ev
.
xbuâ⁄
.
°©e
 & 
Buâ⁄3Mask
)

164 
buâ⁄
 |
MWBUTTON_R
;

167 
buâ⁄
 &~
ªÀa£d
;

169 *
bp
 = 
buâ⁄
;

170 *
dx
 = 
ev
.
xbuâ⁄
.
x
;

171 *
dy
 = 
ev
.
xbuâ⁄
.
y
;

172 *
dz
 = 0;

173 
evíts
++;

177 
	`x11_h™dÀ_evít
(&
ev
);

180 i‡(
evíts
 == 0) {

185 i‡(++
n€vít_cou¡
 >= 50) {

186 
	`XNextEvít
(
x11_dpy
, &
ev
)) {

189 
	`XPutBackEvít
(
x11_dpy
, &
ev
);

191 
n€vít_cou¡
 = 0;

195 
n€vít_cou¡
 = 0;

197 
	}
}

	@drivers/mou_yopy.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

11 
	~<î∫o.h
>

12 
	~<f˙é.h
>

13 
	~<m©h.h
>

14 
	~<sys/io˘l.h
>

15 
	~"devi˚.h
"

18 
	gpd_fd
 = -1;

23 
SCREENDEVICE
 
s¸dev
;

25 
	gˇl
[7];

28 
	mx
, 
	my
;

29 } 
	tXYPOINT
;

31 
	#TRANSFORMATION_UNITS_PER_PIXEL
 4

	)

32 
	$GëPoöãrCÆibøti⁄D©a
()

40 c⁄° 
ˇl_fûíame
[] = "/etc/ts.conf";

42 
ôems
;

44 
FILE
* 
f
 = 
	`f›í
(
ˇl_fûíame
, "r");

45 i‡–
f
 =
NULL
 )

47 
	`EPRINTF
("Error %d openingÖointer calibration file %s.\n",

48 
î∫o
, 
ˇl_fûíame
);

52 
ôems
 = 
	`fsˇnf
(
f
, "%d %d %d %d %d %d %d",

53 &
ˇl
[0], &cal[1], &cal[2], &cal[3], &cal[4], &cal[5], &cal[6]);

54 i‡–
ôems
 != 7 )

56 
	`EPRINTF
("Improperly formattedÖointer calibration file %s.\n",

57 
ˇl_fûíame
);

61 #ifde‡
TEST


62 
	`EPRINTF
("a=%d b=%d c=%d d=%dÉ=%d f=%d s=%d\n",

63 
ˇl
[0], cal[1], cal[2], cal[3], cal[4], cal[5], cal[6]);

67 
	}
}

69 
XYPOINT
 
	$Devi˚ToS¸ìn
(
XYPOINT
 
p
)

79 
XYPOINT
 
¥ev
;

81 c⁄° 
¶›
 = 
TRANSFORMATION_UNITS_PER_PIXEL
 * 3 / 4;

82 
XYPOINT
 
√w
, 
out
;

85 
√w
.
x
 = (
ˇl
[0] * 
p
.x + cÆ[1] *Ö.
y
 + cal[2]) / cal[6];

86 
√w
.
y
 = (
ˇl
[3] * 
p
.
x
 + cal[4] *Ö.y + cal[5]) / cal[6];

89 i‡–
	`abs
(
√w
.
x
 - 
¥ev
.xË>
¶›
 )

90 
out
.
x
 = (
√w
.x | 0x3) ^ 0x3;

92 
out
.
x
 = 
¥ev
.x;

94 i‡–
	`abs
(
√w
.
y
 - 
¥ev
.yË>
¶›
 )

95 
out
.
y
 = (
√w
.y | 0x3) ^ 0x3;

97 
out
.
y
 = 
¥ev
.y;

99 
¥ev
 = 
out
;

101  
out
;

102 
	}
}

104 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

111 
pd_fd
 = 
	`›í
("/dev/y›y-ts", 
O_NONBLOCK
);

112 i‡(
pd_fd
 < 0) {

113 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

117 
	`GëPoöãrCÆibøti⁄D©a
();

118 
	`GdHideCurs‹
(&
s¸dev
);

120  
pd_fd
;

121 
	}
}

123 
	$PD_Clo£
()

126 i‡(
pd_fd
 >= 0)

127 
	`˛o£
(
pd_fd
);

128 
pd_fd
 = -1;

129 
	}
}

131 
	$PD_GëBuâ⁄Info
()

134  
MWBUTTON_L
;

135 
	}
}

137 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

144 *
psˇÀ
 = 3;

145 *
±hªsh
 = 5;

146 
	}
}

149 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

153 
d©a
;

154 
byãs_ªad
;

156 
XYPOINT
 
å™sf‹med
;

158 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
d©a
, (data));

160 i‡(
byãs_ªad
 !(
d©a
)) {

161 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
) {

167 
å™sf‹med
.
x
 = (
d©a
 & 0x3ff);

168 
å™sf‹med
.
y
 = (
d©a
 >> 10) & 0x3ff;

170 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

172 
å™sf‹med
.
x
 >>= 2;

173 
å™sf‹med
.
y
 >>= 2;

175 *
px
 = 
å™sf‹med
.
x
;

176 *
py
 = 
å™sf‹med
.
y
;

178 *
pb
 = (((
d©a
 >> 31Ë& 0x1Ë? 
MWBUTTON_L
 : 0);

180 *
pz
 = 0;

182 if(! *
pb
 )

186 
	}
}

188 
MOUSEDEVICE
 
	gmou£dev
 = {

189 
PD_O≥n
,

190 
PD_Clo£
,

191 
PD_GëBuâ⁄Info
,

192 
PD_GëDeÁu…Ac˚l
,

193 
PD_Ród
,

194 
NULL


197 #ifde‡
TEST


198 
	$maö
(
¨gc
, ** 
v
)

200 
MWCOORD
 
x
, 
y
, 
z
;

201 
b
;

202 
ªsu…
;

203 
mou£
 = -1;

204 
	`DPRINTF
("OpeningÅouchÖanel...\n");

206 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

207 
	`DPRINTF
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

210 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

211 if–
ªsu…
 > 0) {

212 if(
mou£
 !
b
) {

213 
mou£
 = 
b
;

214 if(
mou£
)

215 
	`DPRINTF
("Pen Down\n");

217 
	`DPRINTF
("Pen Up\n");

219 
	`DPRINTF
("%d,%d,%d,%d,%d\n", 
ªsu…
, 
x
, 
y
, 
z
, 
b
);

222 
	}
}

	@drivers/mwlirc.c

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<as£π.h
>

22 
	~<°rög.h
>

23 
	~<sys/ty≥s.h
>

24 
	~<sys/°©.h
>

25 
	~<f˙é.h
>

26 
	~<î∫o.h
>

27 
	~<sys/sockë.h
>

28 
	~<sys/un.h
>

29 
	~<uni°d.h
>

31 
	~"mwlúc.h
"

32 
	~"mwsy°em.h
"

37 
	gmwlúc_fd
 = -1;

40 
	#MWLIRC_BUF_SIZE_MIN
 100

	)

42 *
	gmwlúc_buf
 = 
NULL
;

43 
	gmwlúc_buf_size
 = 0;

44 
	gmwlúc_buf_u£d
 = 0;

45 
	gmwlúc_buf_löe_Àn
 = 0;

47 
	#MWLIRC_EXPECT_BEGIN
 -1

	)

48 
	#MWLIRC_EXPECT_COMMAND
 -2

	)

49 
	#MWLIRC_EXPECT_SUCCESS_ERROR
 -3

	)

50 
	#MWLIRC_EXPECT_DATA
 -4

	)

51 
	#MWLIRC_EXPECT_DATACOUNT
 -5

	)

52 
	#MWLIRC_EXPECT_END
 0

	)

54 
	gmwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

57 #ifde‡
TRIMEDIA


58 * 
	$my_°rchr
(* 
buf
, 
ch
)

60 (*
buf
 !'\0'Ë& (*bu‡!
ch
)) buf++;

61  (*
buf
 ? bu‡: 
NULL
);

62 
	}
}

63 #unde‡
°rchr


64 
	#°rchr
 
my_°rchr


	)

73 
	$mwlúc_öô
(
n⁄blockög
)

75 
fd
;

77 i‡(
mwlúc_fd
 != -1) {

82 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

83 
mwlúc_buf_u£d
 = 0;

84 
mwlúc_buf_löe_Àn
 = 0;

86 
mwlúc_buf
 = 
	`mÆloc
(
MWLIRC_BUF_SIZE_MIN
);

87 i‡(
mwlúc_buf
 =
NULL
) {

88 
mwlúc_buf_size
 = 0;

92 
mwlúc_buf_size
 = 
MWLIRC_BUF_SIZE_MIN
;

93 
mwlúc_buf
[0] = '\0';

96 
sockaddr_un
 
addr
;

98 
fd
 = 
	`sockë
(
PF_UNIX
, 
SOCK_STREAM
, 0);

99 i‡(
fd
 == -1) {

100 
	`‰ì
(
mwlúc_buf
);

101 
mwlúc_buf
 = 
NULL
;

102 
mwlúc_buf_size
 = 0;

106 
addr
.
sun_Ámûy
 = 
AF_UNIX
;

107 
	`°r˝y
(
addr
.
sun_∑th
, "/dev/lircd");

109 i‡(0 !
	`c⁄√˘
(
fd
, (
sockaddr
 *Ë&
addr
, (addr))) {

110 
	`‰ì
(
mwlúc_buf
);

111 
mwlúc_buf
 = 
NULL
;

112 
mwlúc_buf_size
 = 0;

113 
	`˛o£
(
fd
);

117 i‡(
n⁄blockög
) {

118 
	`f˙é
(
fd
, 
F_SETFL
, 
O_NONBLOCK
);

122 
mwlúc_fd
 = 
fd
;

123  
fd
;

124 
	}
}

131 
	$mwlúc_˛o£
()

133 i‡(
mwlúc_fd
 != -1) {

134 
	`˛o£
(
mwlúc_fd
);

135 
mwlúc_fd
 = -1;

138 i‡(
mwlúc_buf
 !
NULL
) {

139 
	`‰ì
(
mwlúc_buf
);

140 
mwlúc_buf
 = 
NULL
;

143 
mwlúc_buf_size
 = 0;

144 
mwlúc_buf_u£d
 = 0;

145 
mwlúc_buf_löe_Àn
 = 0;

146 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

147 
	}
}

158 
	$mwlúc_ªad_löe
()

160 *
eﬁ
;

161 
n
;

163 i‡(
mwlúc_buf_löe_Àn
 != 0) {

164 
mwlúc_buf_u£d
 -
mwlúc_buf_löe_Àn
;

165 
	`memmove
(
mwlúc_buf
, mwlúc_bu‡+ 
mwlúc_buf_löe_Àn
,

166 
mwlúc_buf_u£d
 + 1);

167 
mwlúc_buf_löe_Àn
 = 0;

170 
NULL
 =(
eﬁ
 = 
	`°rchr
(
mwlúc_buf
, '\n'))) {

171 
•a˚
 = 
mwlúc_buf_size
 - 
mwlúc_buf_u£d
 - 1;

176 i‡(
•a˚
 < 30) {

177 *
p
 =

178 
	`GdRóŒoc
(
mwlúc_buf
, 
mwlúc_buf_size
, mwlirc_buf_size * 2);

179 i‡(
p
 =
NULL
) {

180  
MWLIRC_ERROR_MEMORY
;

182 
mwlúc_buf
 = 
p
;

183 
mwlúc_buf_size
 = mwlirc_buf_size * 2;

187 
n
 = 
	`ªad
(
mwlúc_fd
,

188 
mwlúc_buf
 + 
mwlúc_buf_u£d
, 
•a˚
);

189 } (
n
 < 0Ë&& (
î∫o
 =
EINTR
));

190 i‡(
n
 < 0) {

191 i‡(
î∫o
 =
EAGAIN
) {

193  
MWLIRC_ERROR_AGAIN
;

195 
	`EPRINTF
("mwlirc_read_line(): Error inÑead\n");

196  
MWLIRC_ERROR_SOCKET
;

198 i‡(
n
 == 0) {

199 
	`EPRINTF
("mwlirc_read_line(): EOF\n");

200  
MWLIRC_ERROR_SOCKET
;

202 
mwlúc_buf_u£d
 +
n
;

203 
mwlúc_buf
[
mwlúc_buf_u£d
] = '\0';

204 
mwlúc_buf_u£d
 !(
n
 = 
	`°æí
(
mwlúc_buf
))) {

205 
	`EPRINTF
("mwlirc_read_line(): Error: Embedded NUL in input string! SkippingÖast it. (Context: '%s' NUL '%s') (buf_used=%d != strlen()=%d)\n",

206 
mwlúc_buf
, mwlúc_bu‡+ 
n
 + 1, 
mwlúc_buf_u£d
,Ç);

207 
mwlúc_buf_u£d
 -(
n
 + 1);

208 
	`memmove
(
mwlúc_buf
, mwlúc_bu‡+ 
n
 + 1,

209 
mwlúc_buf_u£d
 + 1);

213 *
eﬁ
 = '\0';

214 
mwlúc_buf_löe_Àn
 = 
eﬁ
 - 
mwlúc_buf
 + 1;

219 
	}
}

230 
	$mwlúc_ªad_key
()

232 
îr
;

236 
îr
 = 
	`mwlúc_ªad_löe
();

238 i‡(
îr
) {

239  
îr
;

241 
mwlúc_∑ckë_°©e
) {

242 
MWLIRC_EXPECT_BEGIN
:

243 i‡(0 =
	`°rcmp
(
mwlúc_buf
, "BEGIN")) {

244 
mwlúc_∑ckë_°©e
 =

245 
MWLIRC_EXPECT_COMMAND
;

251 
MWLIRC_EXPECT_COMMAND
:

254 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_SUCCESS_ERROR
;

257 
MWLIRC_EXPECT_SUCCESS_ERROR
:

258 i‡((0 =
	`°rcmp
(
mwlúc_buf
, "SUCCESS"))

259 || (0 =
	`°rcmp
(
mwlúc_buf
, "ERROR"))) {

260 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_DATA
;

264 
MWLIRC_EXPECT_DATA
:

265 i‡(0 =
	`°rcmp
(
mwlúc_buf
, "DATA")) {

266 
mwlúc_∑ckë_°©e
 =

267 
MWLIRC_EXPECT_DATACOUNT
;

271 
MWLIRC_EXPECT_END
:

272 i‡(0 =
	`°rcmp
(
mwlúc_buf
, "END")) {

273 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

276 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

277  
MWLIRC_ERROR_PROTOCOL
;

279 
MWLIRC_EXPECT_DATACOUNT
:

280 
mwlúc_∑ckë_°©e
 = 
	`©oi
(
mwlúc_buf
);

281 i‡(
mwlúc_∑ckë_°©e
 <= 0) {

282 
mwlúc_∑ckë_°©e
 = 
MWLIRC_EXPECT_BEGIN
;

283  
MWLIRC_ERROR_PROTOCOL
;

287 
	`as£π
(
mwlúc_∑ckë_°©e
 > 0);

288 
	`as£π
(
MWLIRC_EXPECT_END
 == 0);

290 
mwlúc_∑ckë_°©e
--;

294 
	}
}

303 
	$mwlúc_ªad_key°roke
(
mwlúc_key°roke
 * 
key
)

305 *
ª≥©cou¡°r
;

306 *
key«me
;

307 *
ªmŸe
;

308 *
p
;

309 
ª≥©cou¡
;

311 
îr
 = 
	`mwlúc_ªad_key
();

313 i‡(
îr
) {

314  
îr
;

317 
ª≥©cou¡°r
 = 
	`°rchr
(
mwlúc_buf
, ' ');

318 i‡(
NULL
 =
ª≥©cou¡°r
) {

319  
MWLIRC_ERROR_PROTOCOL
;

321 *
ª≥©cou¡°r
++ = '\0';

323 
key«me
 = 
	`°rchr
(
ª≥©cou¡°r
, ' ');

324 i‡(
NULL
 =
key«me
) {

325  
MWLIRC_ERROR_PROTOCOL
;

327 *
key«me
++ = '\0';

329 
ªmŸe
 = 
	`°rchr
(
key«me
, ' ');

330 i‡(
NULL
 =
ªmŸe
) {

331  
MWLIRC_ERROR_PROTOCOL
;

333 *
ªmŸe
++ = '\0';

335 i‡((*
key«me
 == '\0')

336 || (*
ª≥©cou¡°r
 == '\0')) {

337  
MWLIRC_ERROR_PROTOCOL
;

340 
p
 = 
ª≥©cou¡°r
;

341 
ª≥©cou¡
 = 
	`°πﬁ
(
ª≥©cou¡°r
, &
p
, 16);

342 i‡(*
p
 != '\0') {

344  
MWLIRC_ERROR_PROTOCOL
;

346 i‡(
ª≥©cou¡
 < 0) {

347  
MWLIRC_ERROR_PROTOCOL
;

350 
key
->
ª≥©cou¡
 =Ñepeatcount;

351 
	`°∫˝y
(
key
->
«me
, 
key«me
, 
MWLIRC_KEY_NAME_LENGTH
 - 1);

352 
	`°∫˝y
(
key
->
rc
, 
ªmŸe
, 
MWLIRC_RC_NAME_LENGTH
 - 1);

353 
key
->
«me
[
MWLIRC_KEY_NAME_LENGTH
 - 1] = '\0';

354 
key
->
rc
[
MWLIRC_RC_NAME_LENGTH
 - 1] = '\0';

359 
	}
}

369 
	$mwlúc_ªad_key°roke_n‹ïót
(
mwlúc_key°roke
 * 
key
)

372 
îr
 = 
	`mwlúc_ªad_key°roke
(
key
);

373 i‡(
îr
) {

374  
îr
;

377 
key
->
ª≥©cou¡
 != 0);

380 
	}
}

	@drivers/mwlirc.h

19 #i‚de‡
MWLIRC_H_INCLUDED


20 
	#MWLIRC_H_INCLUDED


	)

22 #ifde‡
__˝lu•lus


27 
	#MWLIRC_ERROR_AGAIN
 1

	)

28 
	#MWLIRC_ERROR_SOCKET
 2

	)

29 
	#MWLIRC_ERROR_PROTOCOL
 3

	)

30 
	#MWLIRC_ERROR_MEMORY
 4

	)

32 
	#MWLIRC_BLOCK
 0

	)

33 
	#MWLIRC_NONBLOCK
 1

	)

35 
	#MWLIRC_KEY_NAME_LENGTH
 28

	)

36 
	#MWLIRC_RC_NAME_LENGTH
 16

	)

38 
	smwlúc_key°roke_


40 
ª≥©cou¡
;

41 
«me
[
MWLIRC_KEY_NAME_LENGTH
];

42 
rc
[
MWLIRC_RC_NAME_LENGTH
];

44 
	tmwlúc_key°roke
;

47 
mwlúc_fd
;

49 
mwlúc_öô
(
n⁄blockög
);

50 
mwlúc_˛o£
();

51 
mwlúc_ªad_key°roke
(
mwlúc_key°roke
 * 
key
);

52 
mwlúc_ªad_key°roke_n‹ïót
(
mwlúc_key°roke
 * 
key
);

54 #ifde‡
__˝lu•lus


	@drivers/nofont.c

8 
	~<°dio.h
>

9 
	~"devi˚.h
"

10 
	~"gíf⁄t.h
"

14 
MWCFONT
 
	gnuŒf⁄t
 = {

15 "", 0, 0, 0, 0, 0, 
NULL
, NULL, NULL

19 
MWFONTPROCS
 
	gf⁄çrocs
 = {

20 
MWTF_ASCII
,

21 
NULL
,

22 
NULL
,

23 
NULL
,

24 
NULL
,

25 
NULL
,

26 
NULL
,

27 
NULL
,

28 
NULL
,

32 
MWCOREFONT
 
	ggí_f⁄ts
[
NUMBER_FONTS
] = {

33 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_VAR
, &
nuŒf⁄t
},

34 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_VAR
, &
nuŒf⁄t
},

35 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_VAR
, &
nuŒf⁄t
},

36 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_SYSTEM_VAR
, &
nuŒf⁄t
},

	@drivers/obsolete.c

26 
	ggr_w¨nög_libmwdrivîs_is_obsﬁëe
[] =

	@drivers/old/mou_ads.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<uni°d.h
>

11 
	~<î∫o.h
>

12 
	~<f˙é.h
>

13 
	~<m©h.h
>

14 
	~<sys/io˘l.h
>

15 
	~"devi˚.h
"

18 
	gpd_fd
 = -1;

23 
SCREENDEVICE
 
s¸dev
;

25 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

32 
pd_fd
 = 
	`›í
("/dev/ts", 
O_NONBLOCK
);

33 i‡(
pd_fd
 < 0) {

34 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

38 
	`GdHideCurs‹
(&
s¸dev
);

39  
pd_fd
;

40 
	}
}

42 
	$PD_Clo£
()

45 
	`EPRINTF
("PD_Close called\n");

46 i‡(
pd_fd
 >= 0)

47 
	`˛o£
(
pd_fd
);

48 
pd_fd
 = -1;

49 
	}
}

51 
	$PD_GëBuâ⁄Info
()

54  
MWBUTTON_L
;

55 
	}
}

57 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

64 *
psˇÀ
 = 3;

65 *
±hªsh
 = 5;

66 
	}
}

68 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

71 
d©a
[3];

72 
byãs_ªad
;

74 
byãs_ªad
 = 
	`ªad
(
pd_fd
, 
d©a
, (data));

76 i‡(
byãs_ªad
 !(
d©a
)) {

77 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)

88 *
px
 = (
MWCOORD
)
d©a
[0];

89 *
py
 = (
MWCOORD
)
d©a
[1];

91 *
pb
 = (
d©a
[2]>0?
MWBUTTON_L
:0);

92 *
pz
 = 0;

94 if((*
px
 =-1 || *
py
 =-1Ë&& *
pb
 >= 0)

96 if((*
px
 =-1 || *
py
 =-1Ë&& *
pb
 < 0)

100 
	}
}

102 
MOUSEDEVICE
 
	gmou£dev
 = {

103 
PD_O≥n
,

104 
PD_Clo£
,

105 
PD_GëBuâ⁄Info
,

106 
PD_GëDeÁu…Ac˚l
,

107 
PD_Ród
,

108 
NULL


111 #ifde‡
TEST


112 
	$maö
(
¨gc
, ** 
v
)

114 
MWCOORD
 
x
, 
y
, 
z
;

115 
b
;

116 
ªsu…
;

117 
mou£
 = -1;

118 
	`DPRINTF
("OpeningÅouchÖanel...\n");

120 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

121 
	`DPRINTF
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

128 if(
¨gc
 > 1) {

129 
	`io˘l
(
ªsu…
,1,
	`©oi
(
v
[1]));

130 
	`DPRINTF
("SëtögÖªssuªÅÿ%d\n",
	`©oi
(
v
[1]));

132 if(
¨gc
 > 2) {

133 
	`io˘l
(
ªsu…
,2,
	`©oi
(
v
[2]));

134 
	`DPRINTF
("Sëtög updñayÅÿ%d\n",
	`©oi
(
v
[2]));

136 if(
¨gc
 > 3) {

137 
	`io˘l
(
ªsu…
,3,
	`©oi
(
v
[3]));

138 
	`DPRINTF
("SëtögÑaw xÅÿ%d\n",
	`©oi
(
v
[3]));

140 if(
¨gc
 > 4) {

141 
	`io˘l
(
ªsu…
,4,
	`©oi
(
v
[4]));

142 
	`DPRINTF
("SëtögÑaw yÅÿ%d\n",
	`©oi
(
v
[4]));

144 if(
¨gc
 > 5) {

145 
	`io˘l
(
ªsu…
,5,
	`©oi
(
v
[5]));

146 
	`DPRINTF
("SëtögÑe†xÅÿ%d\n",
	`©oi
(
v
[5]));

148 if(
¨gc
 > 6) {

149 
	`io˘l
(
ªsu…
,6,
	`©oi
(
v
[6]));

150 
	`DPRINTF
("SëtögÑe†yÅÿ%d\n",
	`©oi
(
v
[6]));

152 if(
¨gc
 > 7) {

153 
	`io˘l
(
ªsu…
,7,
	`©oi
(
v
[7]));

154 
	`DPRINTF
("Sëtög fudgêxÅÿ%d\n",
	`©oi
(
v
[7]));

156 if(
¨gc
 > 8) {

157 
	`io˘l
(
ªsu…
,8,
	`©oi
(
v
[8]));

158 
	`DPRINTF
("Sëtög fudgêyÅÿ%d\n",
	`©oi
(
v
[8]));

160 if(
¨gc
 > 9) {

161 
	`io˘l
(
ªsu…
,9,
	`©oi
(
v
[9]));

162 
	`DPRINTF
("Sëtögávîagêßm∂êtÿ%d\n",
	`©oi
(
v
[9]));

164 if(
¨gc
 > 10) {

165 
	`io˘l
(
ªsu…
,10,
	`©oi
(
v
[10]));

166 
	`DPRINTF
("SëtögÑaw mö xÅÿ%d\n",
	`©oi
(
v
[10]));

168 if(
¨gc
 > 11) {

169 
	`io˘l
(
ªsu…
,11,
	`©oi
(
v
[11]));

170 
	`DPRINTF
("SëtögÑaw mö yÅÿ%d\n",
	`©oi
(
v
[11]));

173 
	`DPRINTF
("ReadingÅouchÖanel...\n");

176 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

177 if–
ªsu…
 > 0) {

178 if(
mou£
 !
b
) {

179 
mou£
 = 
b
;

180 if(
mou£
)

181 
	`DPRINTF
("Pen Down\n");

183 
	`DPRINTF
("Pen Up\n");

186 
	`DPRINTF
("%d,%d,%d,%d,%d\n", 
ªsu…
, 
x
, 
y
, 
z
, 
b
);

190 
	}
}

	@drivers/old/mou_ipaq.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<uni°d.h
>

13 
	~<î∫o.h
>

14 
	~<f˙é.h
>

15 
	~<m©h.h
>

16 
	~<sys/io˘l.h
>

17 
	~"devi˚.h
"

19 #ifde‡
__ECOS


20 
	#TOUCHDEVICE
 "/dev/ts"

	)

22 
	#TOUCHDEVICE
 "/dev/h3600_t§aw"

	)

27 
	gpd_fd
 = -1;

33 
SCREENDEVICE
 
s¸dev
;

35 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

41 
pd_fd
 = 
	`›í
(
TOUCHDEVICE
, 
O_RDONLY
 | 
O_NONBLOCK
);

42 i‡(
pd_fd
 < 0) {

43 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

46 
	`GdHideCurs‹
(&
s¸dev
);

47  
pd_fd
;

48 
	}
}

50 
	$PD_Clo£
()

53 i‡(
pd_fd
 < 0)

56 
	`˛o£
(
pd_fd
);

57 
pd_fd
 = -1;

58 
	}
}

60 
	$PD_GëBuâ⁄Info
()

63  
MWBUTTON_L
;

64 
	}
}

66 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

73 *
psˇÀ
 = 3;

74 *
±hªsh
 = 5;

75 
	}
}

77 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

80 
d©a
[4];

81 
byãs_ªad
;

83 
byãs_ªad
 = 
	`ªad
(
pd_fd
, 
d©a
, (data));

85 i‡(
byãs_ªad
 !(
d©a
)) {

86 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)

97 *
px
 = (
MWCOORD
)
d©a
[1];

98 *
py
 = (
MWCOORD
)
d©a
[2];

99 *
pz
 = 0;

100 *
pb
 = (
d©a
[0] ? 
MWBUTTON_L
 : 0);

102 #ifde‡
NOTUSED


103 *
px
 = ((
ˇlibøã
[0] * *px) >> 8) + calibrate[2];

104 *
py
 = ((
ˇlibøã
[1] * *py) >> 8) + calibrate[3];

107 if–!*
pb
)

111 
	}
}

113 
MOUSEDEVICE
 
	gmou£dev
 = {

114 
PD_O≥n
,

115 
PD_Clo£
,

116 
PD_GëBuâ⁄Info
,

117 
PD_GëDeÁu…Ac˚l
,

118 
PD_Ród
,

119 
NULL
,

120 
MOUSE_TRANSFORM


123 #ifde‡
TEST


124 
	$maö
(
¨gc
, ** 
v
)

126 
MWCOORD
 
x
, 
y
, 
z
;

127 
b
;

128 
ªsu…
;

129 
mou£
 = -1;

130 
	`DPRINTF
("OpeningÅouchÖanel...\n");

132 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

133 
	`DPRINTF
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

140 if(
¨gc
 > 1) {

141 
	`io˘l
(
ªsu…
,1,
	`©oi
(
v
[1]));

142 
	`DPRINTF
("SëtögÖªssuªÅÿ%d\n",
	`©oi
(
v
[1]));

144 if(
¨gc
 > 2) {

145 
	`io˘l
(
ªsu…
,2,
	`©oi
(
v
[2]));

146 
	`DPRINTF
("Sëtög updñayÅÿ%d\n",
	`©oi
(
v
[2]));

148 if(
¨gc
 > 3) {

149 
	`io˘l
(
ªsu…
,3,
	`©oi
(
v
[3]));

150 
	`DPRINTF
("SëtögÑaw xÅÿ%d\n",
	`©oi
(
v
[3]));

152 if(
¨gc
 > 4) {

153 
	`io˘l
(
ªsu…
,4,
	`©oi
(
v
[4]));

154 
	`DPRINTF
("SëtögÑaw yÅÿ%d\n",
	`©oi
(
v
[4]));

156 if(
¨gc
 > 5) {

157 
	`io˘l
(
ªsu…
,5,
	`©oi
(
v
[5]));

158 
	`DPRINTF
("SëtögÑe†xÅÿ%d\n",
	`©oi
(
v
[5]));

160 if(
¨gc
 > 6) {

161 
	`io˘l
(
ªsu…
,6,
	`©oi
(
v
[6]));

162 
	`DPRINTF
("SëtögÑe†yÅÿ%d\n",
	`©oi
(
v
[6]));

164 if(
¨gc
 > 7) {

165 
	`io˘l
(
ªsu…
,7,
	`©oi
(
v
[7]));

166 
	`DPRINTF
("Sëtög fudgêxÅÿ%d\n",
	`©oi
(
v
[7]));

168 if(
¨gc
 > 8) {

169 
	`io˘l
(
ªsu…
,8,
	`©oi
(
v
[8]));

170 
	`DPRINTF
("Sëtög fudgêyÅÿ%d\n",
	`©oi
(
v
[8]));

172 if(
¨gc
 > 9) {

173 
	`io˘l
(
ªsu…
,9,
	`©oi
(
v
[9]));

174 
	`DPRINTF
("Sëtögávîagêßm∂êtÿ%d\n",
	`©oi
(
v
[9]));

176 if(
¨gc
 > 10) {

177 
	`io˘l
(
ªsu…
,10,
	`©oi
(
v
[10]));

178 
	`DPRINTF
("SëtögÑaw mö xÅÿ%d\n",
	`©oi
(
v
[10]));

180 if(
¨gc
 > 11) {

181 
	`io˘l
(
ªsu…
,11,
	`©oi
(
v
[11]));

182 
	`DPRINTF
("SëtögÑaw mö yÅÿ%d\n",
	`©oi
(
v
[11]));

185 
	`DPRINTF
("ReadingÅouchÖanel...\n");

188 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

189 if–
ªsu…
 > 0) {

190 if(
mou£
 !
b
) {

191 
mou£
 = 
b
;

192 if(
mou£
)

193 
	`DPRINTF
("Pen Down\n");

195 
	`DPRINTF
("Pen Up\n");

198 
	`DPRINTF
("%d,%d,%d,%d,%d\n", 
ªsu…
, 
x
, 
y
, 
z
, 
b
);

202 
	}
}

	@drivers/old/mou_tp.c

36 
	~<°dio.h
>

37 
	~<°dlib.h
>

38 
	~<uni°d.h
>

39 
	~<î∫o.h
>

40 
	~<f˙é.h
>

41 
	~<m©h.h
>

42 
	~<sys/io˘l.h
>

43 #i‡!
deföed
(
TPHELIO
Ë&& !deföed(
YOPY
)

44 
	~<löux/ç™ñ.h
>

46 
	~"devi˚.h
"

47 
	~"mou_ç.h
"

49 
	#EMBEDDEDPLANET
 0

	)

50 #i‡
EMBEDDEDPLANET


51 
	#DATACHANGELIMIT
 50

	)

53 
	#DATACHANGELIMIT
 100

	)

63 
	gíabÀ_poötög_co‹dö©e_å™sf‹m
 = 1;

65 
TRANSFORMATION_COEFFICIENTS
 
	gtc
;

68 
	gpd_fd
;

70 
	$GëPoöãrCÆibøti⁄D©a
()

78 c⁄° 
ˇl_fûíame
[] = "/etc/pointercal";

80 
ôems
;

82 
FILE
* 
f
 = 
	`f›í
(
ˇl_fûíame
, "r");

83 i‡–
f
 =
NULL
 )

85 
	`EPRINTF
("Error %d openingÖointer calibration file %s.\n",

86 
î∫o
, 
ˇl_fûíame
);

90 
ôems
 = 
	`fsˇnf
(
f
, "%d %d %d %d %d %d %d",

91 &
tc
.
a
, &tc.
b
, &tc.
c
, &tc.
d
, &tc.
e
, &tc.
f
, &tc.
s
);

92 i‡–
ôems
 != 7 )

94 
	`EPRINTF
("Improperly formattedÖointer calibration file %s.\n",

95 
ˇl_fûíame
);

99 #i‡
TEST


100 
	`EPRINTF
("a=%d b=%d c=%d d=%dÉ=%d f=%d s=%d\n",

101 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

105 
	}
}

107 
ölöe
 
MWPOINT
 
	$Devi˚ToS¸ìn
(
MWPOINT
 
p
)

118 
MWPOINT
 
¥ev
;

120 c⁄° 
¶›
 = 
TRANSFORMATION_UNITS_PER_PIXEL
 * 3 / 4;

121 
MWPOINT
 
√w
, 
out
;

124 
√w
.
x
 = (
tc
.
a
 * 
p
.x +Åc.
b
 *Ö.
y
 +Åc.
c
Ë/Åc.
s
;

125 
√w
.
y
 = (
tc
.
d
 * 
p
.
x
 +Åc.
e
 *Ö.y +Åc.
f
Ë/Åc.
s
;

128 i‡–
	`abs
(
√w
.
x
 - 
¥ev
.xË>
¶›
 )

129 
out
.
x
 = (
√w
.x | 0x3) ^ 0x3;

131 
out
.
x
 = 
¥ev
.x;

133 i‡–
	`abs
(
√w
.
y
 - 
¥ev
.yË>
¶›
 )

134 
out
.
y
 = (
√w
.y | 0x3) ^ 0x3;

136 
out
.
y
 = 
¥ev
.y;

138 
¥ev
 = 
out
;

140  
out
;

141 
	}
}

143 #i‚def 
YOPY


144 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

150 #i‚de‡
TPHELIO


151 
sˇ≈¨am
 
s
;

152 
£âÀ_uµî_limô
;

153 
ªsu…
;

156 
pd_fd
 = 
	`›í
("/dev/ç™ñ", 
O_NONBLOCK
);

157 i‡(
pd_fd
 < 0) {

158 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

162 #i‚de‡
TPHELIO


164 
s
.
öãrvÆ
 = 5000;

172 
£âÀ_uµî_limô
 = (
s
.
öãrvÆ
 / 5) - 60;

173 
s
.
£âÀtime
 = 
£âÀ_uµî_limô
 * 50 / 100;

174 
ªsu…
 = 
	`io˘l
(
pd_fd
, 
TPSETSCANPARM
, &
s
);

175 i‡–
ªsu…
 < 0 )

176 
	`EPRINTF
("Error %d,Ñesult %d setting scanÖarameters.\n",

177 
ªsu…
, 
î∫o
);

180 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

182 i‡(
	`GëPoöãrCÆibøti⁄D©a
() < 0)

184 
	`˛o£
(
pd_fd
);

189  
pd_fd
;

190 
	}
}

193 
TRANSFORMATION_COEFFICIENTS
 
	gdeÁu…_tc
 = {

197 
	$PD_O≥n
(
MOUSEDEVICE
 *
pmd
)

205 
pd_fd
 = 
	`›í
("/dev/y›y-ts", 
O_NONBLOCK
);

206 i‡(
pd_fd
 < 0) {

207 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

211 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

213 i‡(
	`GëPoöãrCÆibøti⁄D©a
() < 0)

217 
	`mem˝y
–&
tc
, &
deÁu…_tc
, (
TRANSFORMATION_COEFFICIENTS
) );

222 
	`EPRINTF
("a=%d b=%d c=%d d=%dÉ=%d f=%d s=%d\n",

223 
tc
.
a
,Åc.
b
,Åc.
c
,Åc.
d
,Åc.
e
,Åc.
f
,Åc.
s
);

226  
pd_fd
;

227 
	}
}

230 
	$PD_Clo£
()

233 i‡(
pd_fd
 > 0)

234 
	`˛o£
(
pd_fd
);

235 
pd_fd
 = 0;

236 
	}
}

238 
	$PD_GëBuâ⁄Info
()

241  
MWBUTTON_L
;

242 
	}
}

244 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
,*
±hªsh
)

251 *
psˇÀ
 = 3;

252 *
±hªsh
 = 5;

253 
	}
}

255 #i‚def 
YOPY


256 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

273 #i‚de‡
TPHELIO


274 c⁄° 
low_z_limô
 = 815;

283 #i‚de‡
TPHELIO


284 c⁄° 
d©a_ch™ge_limô
 = 
DATACHANGELIMIT
;

286 
have_œ°_d©a
 = 0;

287 
œ°_d©a_x
 = 0;

288 
œ°_d©a_y
 = 0;

308 c⁄° 
iú_shi·_bôs
 = 3;

309 c⁄° 
iú_ßm∂e_dïth
 = (1 << 
iú_shi·_bôs
);

310 
iú_accum_x
 = 0;

311 
iú_accum_y
 = 0;

312 
iú_accum_z
 = 0;

313 
iú_cou¡
 = 0;

314 
d©a_x
, 
d©a_y
, 
d©a_z
;

317 #i‡
TPHELIO


318 
d©a
[3];

320 
d©a
[6];

322 
byãs_ªad
;

323 
byãs_ªad
 = 
	`ªad
(
pd_fd
, 
d©a
, (data));

324 i‡(
byãs_ªad
 !(
d©a
)) {

325 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
) {

330 #i‚de‡
TPHELIO


332 i‡–(
d©a
[0] & 0x2000) )

333 
	`EPRINTF
("LostÅouchÖanel data\n");

336 i‡–(
d©a
[0] & 0x8000) == 0 )

339 i‡–(
d©a
[0] & 0x4000) == 0 )

342 
have_œ°_d©a
 = 0;

345 
iú_cou¡
 = 0;

346 
iú_accum_x
 = 0;

347 
iú_accum_y
 = 0;

348 
iú_accum_z
 = 0;

352 *
pb
 = 0;

361 #i‡
TPHELIO


362 
d©a_x
 = 
d©a
[1];

363 
d©a_y
 = 
d©a
[2];

364 
d©a_z
 = 
d©a
[0] ? 2000 : 0;

374 
d©a_x
 = 
d©a
[2] - data[1];

375 
d©a_y
 = 
d©a
[4] - data[3];

376 
d©a_z
 = 
d©a
[5];

379 i‡–
d©a_z
 <
low_z_limô
 ) {

384 i‡–
have_œ°_d©a
 )

385 i‡–(
	`abs
(
d©a_x
 - 
œ°_d©a_x
Ë> 
d©a_ch™ge_limô
)

386 || ( 
	`abs
(
d©a_y
 - 
œ°_d©a_y
Ë> 
d©a_ch™ge_limô
 ) ) {

392 
œ°_d©a_x
 = 
d©a_x
;

393 
œ°_d©a_y
 = 
d©a_y
;

394 
have_œ°_d©a
 = 1;

397 i‡–
iú_cou¡
 =
iú_ßm∂e_dïth
 )

399 #i‡
TPHELIO


400 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
) {

401 
MWPOINT
 
å™sf‹med
 = {
d©a_x
, 
d©a_y
};

402 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

404 *
px
 = 
å™sf‹med
.
x
 >> 2;

405 *
py
 = 
å™sf‹med
.
y
 >> 2;

407 *
px
 = 
d©a_x
;

408 *
py
 = 
d©a_y
;

410 *
pb
 = 
d©a
[0] ? 
MWBUTTON_L
 : 0;

413 
iú_accum_x
 -iú_accum_x >> 
iú_shi·_bôs
;

414 
iú_accum_y
 -iú_accum_y >> 
iú_shi·_bôs
;

415 
iú_accum_z
 -iú_accum_z >> 
iú_shi·_bôs
;

418 
iú_accum_x
 +
d©a_x
;

419 
iú_accum_y
 +
d©a_y
;

420 
iú_accum_z
 +
d©a_z
;

423 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

426 
MWPOINT
 
å™sf‹med
 = {
iú_accum_x
, 
iú_accum_y
};

427 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

434 *
px
 = 
å™sf‹med
.
x
 >> 2;

435 *
py
 = 
å™sf‹med
.
y
 >> 2;

440 *
px
 = 
iú_accum_x
;

441 *
py
 = 
iú_accum_y
;

443 *
pb
 = 
MWBUTTON_L
;

446 *
pz
 = 
iú_accum_z
;

448 #ifde‡
TEST


449 
	`EPRINTF
("In: %hd, %hd, %hd Filtered: %d %d %d Out: %d, %d, %d\n",

450 
d©a_x
, 
d©a_y
, 
d©a_z
, 
iú_accum_x
, 
iú_accum_y
,

451 
iú_accum_z
, *
px
, *
py
, *
pz
);

457 
iú_accum_x
 +
d©a_x
;

458 
iú_accum_y
 +
d©a_y
;

459 
iú_accum_z
 +
d©a_z
;

460 
iú_cou¡
 += 1;

463 
	}
}

465 
	$PD_Ród
(
MWCOORD
 *
px
, MWCOORD *
py
, MWCOORD *
pz
, *
pb
)

491 
d©a_x
, 
d©a_y
;

494 
byãs_ªad
;

495 
mou_d©a
;

497 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
mou_d©a
, (mou_data));

498 i‡(
byãs_ªad
 !(
mou_d©a
)) {

499 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
) {

505 
d©a_x
 = ((
MWCOORD
)(
mou_d©a
 & 0x3ff));

506 
d©a_y
 = (
MWCOORD
)(–
mou_d©a
>>10 ) & 0x3ff );

509 i‡(
íabÀ_poötög_co‹dö©e_å™sf‹m
)

512 
MWPOINT
 
å™sf‹med
 = {
d©a_x
, 
d©a_y
};

513 
å™sf‹med
 = 
	`Devi˚ToS¸ìn
(transformed);

520 *
px
 = 
å™sf‹med
.
x
 >> 2;

521 *
py
 = 
å™sf‹med
.
y
 >> 2;

526 *
px
 = 
d©a_x
;

527 *
py
 = 
d©a_y
;

530 *
pz
 = 0;

531 *
pb
 = ( 
mou_d©a
 & (1<<31Ë)? 
MWBUTTON_L
: 0;

533 i‡–! *
pb
 )

537 
	}
}

540 
MOUSEDEVICE
 
	gmou£dev
 = {

541 
PD_O≥n
,

542 
PD_Clo£
,

543 
PD_GëBuâ⁄Info
,

544 
PD_GëDeÁu…Ac˚l
,

545 
PD_Ród
,

546 
NULL


549 #ifde‡
TEST


550 
	$maö
()

552 
MWCOORD
 
x
, 
y
, 
z
;

553 
b
;

554 
ªsu…
;

556 
íabÀ_poötög_co‹dö©e_å™sf‹m
 = 1;

558 
	`DPRINTF
("OpeningÅouchÖanel...\n");

560 if((
ªsu…
=
	`PD_O≥n
(0)) < 0)

561 
	`DPRINTF
("Eº‹ %d,Ñesu… %d o≥nögÅouch-∑√l\n", 
î∫o
, 
ªsu…
);

563 
	`DPRINTF
("ReadingÅouchÖanel...\n");

566 
ªsu…
 = 
	`PD_Ród
(&
x
, &
y
, &
z
, &
b
);

567 if–
ªsu…
 > 0) {

571 
	}
}

	@drivers/old/mou_tp.h

3 
	#TRANSFORMATION_UNITS_PER_PIXEL
 4

	)

18 
	ma
, 
	mb
, 
	mc
, 
	md
, 
	me
, 
	mf
, 
	ms
;

19 } 
	tTRANSFORMATION_COEFFICIENTS
;

	@drivers/old/mou_ucb1x00.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<uni°d.h
>

12 
	~<î∫o.h
>

13 
	~<f˙é.h
>

14 
	~<m©h.h
>

15 
	~<sig«l.h
>

16 
	~<sys/time.h
>

17 
	~<sys/io˘l.h
>

18 
	~"devi˚.h
"

21 
	gpd_fd
 = -1;

24 
	#DEVICE
 "/dev/ucb1x00-ts"

	)

29 
MWTRANSFORM
 
	gdeÁu…_å™sf‹m
 = {

33 
SCREENDEVICE
 
s¸dev
;

35 
	sts_evít
 {

36 
	m¥essuª
;

37 
	mx
;

38 
	my
;

39 
	m∑d
;

40 
timevÆ
 
	m°amp
;

44 
	$PD_O≥n
(
MOUSEDEVICE
 * 
pmd
)

50 i‡((
pd_fd
 = 
	`›í
(
DEVICE
, 
O_NONBLOCK
)) < 0) {

51 
	`EPRINTF
("Eº‹ %d o≥nögÅouchÖ™ñ\n", 
î∫o
);

57 
	`GdSëTønsf‹m
(&
deÁu…_å™sf‹m
);

62  
pd_fd
;

63 
	}
}

66 
	$PD_Clo£
()

69 i‡(
pd_fd
 < 0)

72 
	`˛o£
(
pd_fd
);

73 
pd_fd
 = -1;

74 
	}
}

77 
	$PD_GëBuâ⁄Info
()

80  
MWBUTTON_L
;

81 
	}
}

84 
	$PD_GëDeÁu…Ac˚l
(*
psˇÀ
, *
±hªsh
)

86 *
psˇÀ
 = 3;

87 *
±hªsh
 = 5;

88 
	}
}

91 
	$PD_Ród
(
MWCOORD
 * 
px
, MWCOORD * 
py
, MWCOORD * 
pz
, *
pb
, 
mode
)

94 
ts_evít
 
evít
;

95 
byãs_ªad
;

97 
byãs_ªad
 = 
	`ªad
(
pd_fd
, &
evít
, (event));

99 i‡(
byãs_ªad
 !(
evít
)) {

100 i‡(
byãs_ªad
 == -1) {

101 i‡(
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
)

103 
	`EPRINTF
("Eº‹ %dÑódög fromÅouchÖ™ñ\n", 
î∫o
);

107 
	`EPRINTF
("WrongÇumber of bytes %dÑead fromÅouchÖanel "

108 "”x≥˘ed %d)\n", 
byãs_ªad
, (
evít
));

112 *
px
 = 
evít
.
x
;

113 *
py
 = 
evít
.
y
;

114 *
pz
 = 
evít
.
¥essuª
;

115 *
pb
 = (
evít
.
¥essuª
 > 50Ë? 
MWBUTTON_L
 : 0;

117 i‡(!*
pb
)

120 
	}
}

122 
MOUSEDEVICE
 
	gmou£dev
 = {

123 
PD_O≥n
,

124 
PD_Clo£
,

125 
PD_GëBuâ⁄Info
,

126 
PD_GëDeÁu…Ac˚l
,

127 
PD_Ród
,

128 
NULL
,

129 
MOUSE_TRANSFORM


	@drivers/romfont.c

15 
	~<°dlib.h
>

16 
	~"devi˚.h
"

17 
	~"vg≠œn4.h
"

18 
	~"romf⁄t.h
"

21 
	gROM_CHAR_HEIGHT
 = 14;

22 
FARADDR
 
	grom_ch¨_addr
;

25 
MWFONTPROCS
 
	gf⁄çrocs
 = {

26 
MWTF_ASCII
,

27 
p¸om_gëf⁄töfo
,

28 
p¸om_gëãxtsize
,

29 
p¸om_gëãxtbôs
,

30 
p¸om_u∆ﬂdf⁄t
,

31 
c‹ef⁄t_døwãxt
,

32 
NULL
,

33 
NULL
,

34 
NULL
,

38 
MWCOREFONT
 
	gp¸om_f⁄ts
[
NUMBER_FONTS
] = {

39 {&
f⁄çrocs
, 0, 0, 0, 
MWFONT_OEM_FIXED
, 
NULL
}

44 
	$p¸om_öô
(
PSD
 
psd
)

46 * 
p
;

49 
rom_ch¨_addr
 = 
	`öt10
(
FNGETROMADDR
, 
GETROM8x14
);

54 
ROM_CHAR_HEIGHT
 = 
	`GETBYTE_FP
(
	`MK_FP
(0x0040, 0x0085));

55 if(
ROM_CHAR_HEIGHT
 > 
MAX_ROM_HEIGHT
)

56 
ROM_CHAR_HEIGHT
 = 
MAX_ROM_HEIGHT
;

58 
p
 = 
	`gëív
("CHARHEIGHT");

59 if(
p
)

60 
ROM_CHAR_HEIGHT
 = 
	`©oi
(
p
);

61 
	}
}

67 
MWBOOL


68 
	$p¸om_gëf⁄töfo
(
PMWFONT
 
pf⁄t
,
PMWFONTINFO
 
pf⁄töfo
)

70 
i
;

72 
pf⁄töfo
->
maxwidth
 = 
ROM_CHAR_WIDTH
;

73 
pf⁄töfo
->
height
 = 
ROM_CHAR_HEIGHT
;

74 
pf⁄töfo
->
ba£löe
 = 
ROM_CHAR_HEIGHT
;

75 
pf⁄töfo
->
fú°ch¨
 = 0;

76 
pf⁄töfo
->
œ°ch¨
 = 255;

77 
pf⁄töfo
->
fixed
 = 
TRUE
;

78 
i
 = 0; i < 256; i++)

79 
pf⁄töfo
->
widths
[
i
] = 
ROM_CHAR_WIDTH
;

80  
TRUE
;

81 
	}
}

88 
	$p¸om_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

89 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

91 *
pwidth
 = 
ROM_CHAR_WIDTH
 * 
cc
;

92 *
pheight
 = 
ROM_CHAR_HEIGHT
;

93 *
pba£
 = 
ROM_CHAR_HEIGHT
;

94 
	}
}

101 
	$p¸om_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

102 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

104 
FARADDR
 
bôs
;

105 
n
;

106 
MWIMAGEBITS
 
m≠
[
MAX_ROM_HEIGHT
 * 
ROM_CHAR_WIDTH
 / 
MWIMAGE_BITSPERIMAGE
];

107 
MWIMAGEBITS
 *
bôm≠
 = 
m≠
;

110 
bôs
 = 
rom_ch¨_addr
 + 
ch
 * 
ROM_CHAR_HEIGHT
;

111 
n
=0;Ç<
ROM_CHAR_HEIGHT
; ++n)

112 *
bôm≠
++ = 
	`GETBYTE_FP
(
bôs
++) << 8;

114 *
ªtm≠
 = 
m≠
;

115 *
pwidth
 = 
ROM_CHAR_WIDTH
;

116 *
pheight
 = 
ROM_CHAR_HEIGHT
;

117 *
pba£
 = 
ROM_CHAR_HEIGHT
;

118 
	}
}

121 
	$p¸om_u∆ﬂdf⁄t
(
PMWFONT
 
pf⁄t
)

124 
	}
}

126 #i‡
NOTUSED


132 
	$p¸om_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
COORD
 
x
, COORD 
y
,

133 c⁄° *
ãxt
, 
n
, 
PIXELVAL
 
fg
)

135 c⁄° * 
°r
 = 
ãxt
;

136 
COORD
 
width
;

137 
COORD
 
height
;

138 c⁄° 
MWIMAGEBITS
 * 
bôm≠
;

141 
y
 -(
ROM_CHAR_HEIGHT
 - 1);

142 
n
-- > 0) {

143 
pf⁄t
->
	`GëTextBôs
’f⁄t, *
s
++, &
bôm≠
, &
width
, &
height
);

144 
	`gí_døwbôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
, 
fg
);

145 
x
 +
width
;

147 
	}
}

155 
	$gí_døwbôm≠
(
PSD
 
psd
,
COORD
 
x
, COORD 
y
, COORD 
width
, COORD 
height
,

156 c⁄° 
IMAGEBITS
 *
èbÀ
, 
PIXELVAL
 
fgcﬁ‹
)

158 
COORD
 
möx
;

159 
COORD
 
maxx
;

160 
IMAGEBITS
 
bôvÆue
;

161 
bôcou¡
;

163 
möx
 = 
x
;

164 
maxx
 = 
x
 + 
width
 - 1;

165 
bôcou¡
 = 0;

166 
height
 > 0) {

167 i‡(
bôcou¡
 <= 0) {

168 
bôcou¡
 = 
IMAGE_BITSPERIMAGE
;

169 
bôvÆue
 = *
èbÀ
++;

171 i‡(
	`IMAGE_TESTBIT
(
bôvÆue
))

172 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
fgcﬁ‹
);

173 
bôvÆue
 = 
	`IMAGE_SHIFTBIT
(bitvalue);

174 --
bôcou¡
;

175 i‡(
x
++ =
maxx
) {

176 
x
 = 
möx
;

177 ++
y
;

178 --
height
;

179 
bôcou¡
 = 0;

182 
	}
}

	@drivers/romfont.h

12 
	#NUMBER_FONTS
 1

	)

14 
	#ROM_CHAR_WIDTH
 8

	)

15 
	#MAX_ROM_HEIGHT
 16

	)

16 
	#FONT_CHARS
 256

	)

19 
	#FNGETROMADDR
 0x1130

	)

20 
	#GETROM8x14
 0x0200

	)

23 
p¸om_öô
(
PSD
 
psd
);

24 
MWBOOL
 
p¸om_gëf⁄töfo
(
PMWFONT
 
pf⁄t
,
PMWFONTINFO
 
pf⁄töfo
);

25 
p¸om_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

26 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

27 
p¸om_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

28 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

29 
p¸om_u∆ﬂdf⁄t
(
PMWFONT
 
pf⁄t
);

31 
c‹ef⁄t_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

32 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

35 
ROM_CHAR_HEIGHT
;

36 
FARADDR
 
rom_ch¨_addr
;

37 
MWCOREFONT
 
p¸om_f⁄ts
[
NUMBER_FONTS
];

40 
p¸om_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

41 c⁄° *
ãxt
, 
n
, 
MWPIXELVAL
 
fg
);

42 
gí_døwbôm≠
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,MWCOORD 
height
,

43 
MWIMAGEBITS
 *
èbÀ
, 
MWPIXELVAL
 
fgcﬁ‹
);

	@drivers/scr_bios.c

40 #i‡
_MINIX


41 
	~<f˙é.h
>

42 
	~<uni°d.h
>

43 
	~<°rög.h
>

44 
	~<ibm/öt86.h
>

45 
	~<sys/io˘l.h
>

46 
	#HWINIT
 0

	)

47 
	#ROMFONT
 0

	)

49 #ifde‡
__πems__


50 
	#HWINIT
 1

	)

51 
	#ROMFONT
 0

	)

53 
	#HWINIT
 0

	)

54 
	#ROMFONT
 1

	)

58 #i‡
ELKS


59 
	~<löuxmt/¡ty.h
>

61 
	~<°dio.h
>

62 
	~<°dlib.h
>

63 
	~"devi˚.h
"

64 
	~"vg≠œn4.h
"

65 #i‡
ROMFONT


66 
	~"romf⁄t.h
"

68 
	~"gíf⁄t.h
"

70 
	~"gímem.h
"

71 
	~"fb.h
"

74 
PSD
 
VGA_›í
(PSD 
psd
);

75 
VGA_˛o£
(
PSD
 
psd
);

76 #i‡
_MINIX


77 
VGA_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

79 
VGA_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);;

81 
VGA_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

82 
MWBOOL
 
VGA_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

83 
löñí
,
size
,*
addr
);

84 
	$NULL_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
,

85 
MWCOORD
 
h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, 
›
Ë{
	}
}

86 
PSD
 
	$NULL_Æloˇãmemgc
(
PSD
 
psd
Ë{  
NULL
; 
	}
}

87 
MWBOOL
 
	$NULL_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

88 
löñí
,
size
,*
addr
Ë{  0; 
	}
}

89 
	$NULL_‰ìmemgc
(
PSD
 
mempsd
Ë{
	}
}

91 
SCREENDEVICE
 
	gs¸dev
 = {

92 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

93 
VGA_›í
,

94 
VGA_˛o£
,

95 
VGA_gës¸ìnöfo
,

96 
VGA_£çÆëã
,

97 
ega_døwpixñ
,

98 
ega_ªadpixñ
,

99 
ega_døwh‹zlöe
,

100 
ega_døwvîéöe
,

101 
gí_fûÃe˘
,

102 #i‡
ROMFONT


103 
p¸om_f⁄ts
,

105 
gí_f⁄ts
,

107 #i‡
HAVEBLIT


108 
ega_blô
,

110 
NULL_blô
,

112 
NULL
,

113 
NULL
,

114 
NULL
,

115 
gí_Æloˇãmemgc
,

116 
VGA_m≠memgc
,

117 
gí_‰ìmemgc


121 
MWBOOL
 
	gVGAMODE
 = 
TRUE
;

124 
	#FNGR640x480
 0x0012

	)

125 
	#FNGR640x350
 0x0010

	)

126 
	#FNTEXT
 0x0003

	)

128 #i‡
_MINIX


129 
FARADDR
 
	$öt10
(
mode
, 
z
)

131 
fd
;

132 
mio_öt86
 
möt86
;

134 
fd
 = 
	`›í
("/dev/mem", 
O_RDONLY
);

135 
	`mem£t
(&
möt86
, 0, (mint86));

136 
	`io˘l
(
fd
, 
MIOCINT86
, &
möt86
);

137 
möt86
.
ªg86
.
b
.
öäo
 = 0x10;

138 
möt86
.
ªg86
.
b
.
Æ
 = 
mode
 & 0xFF;

139 
	`io˘l
(
fd
, 
MIOCINT86
, &
möt86
);

140 
	`˛o£
(
fd
);

141 
	}
}

144 
PSD


145 
	$VGA_›í
(
PSD
 
psd
)

147 #i‡
_MINIX


148 
s
;

149 
mio_ldt86
 
mldt86
;

150 
	s£gdesc_s
 {

151 
u16_t
 
limô_low
;

152 
u16_t
 
ba£_low
;

153 
u8_t
 
ba£_middÀ
;

154 
u8_t
 
ac˚ss
;

155 
u8_t
 
gønuœrôy
;

156 
u8_t
 
ba£_high
;

157 } *
dp
;

158 
fd
;

159 
vidmem
 = 0xA0000;

161 
fd
 = 
	`›í
("/dev/mem", 
O_RDONLY
);

162 
dp
 = (
£gdesc_s
 *Ë
mldt86
.
íåy
;

163 
mldt86
.
idx
 = 1;

164 
s
 = 
	`io˘l
(
fd
, 
MIOCGLDT86
, &
mldt86
);

165 
dp
->
limô_low
 = 0xFFFF;

166 
dp
->
ba£_low
 = (
vidmem
 >> 0) & 0xFFFF;

167 
dp
->
ba£_middÀ
 = (
vidmem
 >> 16) & 0xFF;

168 
dp
->
ba£_high
 = (
vidmem
 >> 24) & 0xFF;

169 
dp
->
gønuœrôy
 |= 0x80;

170 
mldt86
.
idx
 = 2;

171 
s
 = 
	`io˘l
(
fd
, 
MIOCSLDT86
, &
mldt86
);

172 
	`˛o£
(
fd
);

175 if(
	`gëív
("EGAMODE"))

176 
VGAMODE
 = 
FALSE
;

177 
VGAMODE
 = 
TRUE
;

179 #i‡
ELKS


181 if(
	`io˘l
(0, 
DCGET_GRAPH
) != 0)

182  
NULL
;

185 #i‡
HWINIT


187 
	`ega_hwöô
();

190 
	`öt10
(
VGAMODE
? 
FNGR640x480
: 
FNGR640x350
, 0);

194 
psd
->
xªs
 =Ösd->
xvúåes
 = 640;

195 
psd
->
yªs
 =Ösd->
yvúåes
 = 
VGAMODE
? 480: 350;

196 
psd
->
∂™es
 = 4;

197 
psd
->
bµ
 = 4;

198 
psd
->
ncﬁ‹s
 = 16;

199 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

200 #i‡
HAVEBLIT


201 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

203 
psd
->
Êags
 = 
PSF_SCREEN
;

207 
	`ega_öô
(
psd
);

209 #i‡
ROMFONT


211 
	`p¸om_öô
(
psd
);

214 
ROM_CHAR_HEIGHT
 = 
VGAMODE
? 16: 14;

217  
psd
;

218 
	}
}

221 
	$VGA_˛o£
(
PSD
 
psd
)

223 #i‡
ELKS


225 
	`io˘l
(0, 
DCREL_GRAPH
);

227 #i‡
HWINIT


228 
	`ega_hwãrm
();

231 
	`öt10
(
FNTEXT
, 0);

233 
	}
}

236 
	$VGA_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

238 
psi
->
rows
 = 
psd
->
yvúåes
;

239 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

240 
psi
->
∂™es
 = 
psd
->planes;

241 
psi
->
bµ
 = 
psd
->bpp;

242 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

243 
psi
->
pixty≥
 = 
psd
->pixtype;

244 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

246 if(
VGAMODE
) {

248 
psi
->
xdpcm
 = 27;

249 
psi
->
ydpcm
 = 27;

252 
psi
->
xdpcm
 = 27;

253 
psi
->
ydpcm
 = 19;

256 #i‡
ETA4000


258 
psi
->
xdpcm
 = 33;

259 
psi
->
ydpcm
 = 33;

261 
	}
}

264 
	$VGA_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

267 
	}
}

269 #i‡
HAVEBLIT


271 
MWBOOL


272 
	$VGA_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,
löñí
,

273 
size
,*
addr
)

275 
SUBDRIVER
 
mem∂™4
;

278 
	`öômemgc
(
mempsd
, 
w
, 
h
, 
∂™es
, 
bµ
, 
löñí
, 
size
, 
addr
);

281 i‡(!
	`£t_subdrivî
(
mempsd
, &
mem∂™4
, 
TRUE
))

285 
	}
}

	@drivers/scr_debug.c

12 
	~<°dio.h
>

13 
	~<°dlib.h
>

14 
	~"devi˚.h
"

15 
	~"gíf⁄t.h
"

16 
	~"gímem.h
"

19 
PSD
 
DBG_›í
(PSD 
psd
);

20 
DBG_˛o£
(
PSD
 
psd
);

21 
DBG_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);;

22 
DBG_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

23 
DBG_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

24 
MWPIXELVAL
 
DBG_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

25 
DBG_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

26 
DBG_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

27 
DBG_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

28 
MWPIXELVAL
 
c
);

29 
DBG_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

30 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
);

32 
SCREENDEVICE
 
	gs¸dev
 = {

33 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

34 
DBG_›í
,

35 
DBG_˛o£
,

36 
DBG_gës¸ìnöfo
,

37 
DBG_£çÆëã
,

38 
DBG_døwpixñ
,

39 
DBG_ªadpixñ
,

40 
DBG_døwhlöe
,

41 
DBG_døwvlöe
,

42 
DBG_fûÃe˘
,

43 
gí_f⁄ts
,

44 
DBG_blô
,

45 
NULL
,

46 
NULL
,

47 
NULL
,

48 
gí_Æloˇãmemgc
,

49 
NULL
,

50 
NULL


53 
	#¥ötd
(
_a
)

	)

55 
PSD


56 
	$DBG_›í
(
PSD
 
psd
)

59 
psd
->
xªs
 =Ösd->
xvúåes
 = 640;

60 
psd
->
yªs
 =Ösd->
yvúåes
 = 480;

61 
psd
->
∂™es
 = 4;

62 
psd
->
bµ
 = 4;

63 
psd
->
ncﬁ‹s
 = 16;

64 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

65 
psd
->
Êags
 = 
PSF_SCREEN
;

67  
psd
;

68 
	}
}

71 
	$DBG_˛o£
(
PSD
 
psd
)

73 
	`¥ötd
("DBG_close()\n");

74 
	}
}

77 
	$DBG_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

79 
psi
->
rows
 = 
psd
->
yvúåes
;

80 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

81 
psi
->
∂™es
 = 
psd
->planes;

82 
psi
->
bµ
 = 
psd
->bpp;

83 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

84 
psi
->
pixty≥
 = 
psd
->pixtype;

85 
psi
->
f⁄ts
 = 1;

88 
psi
->
xdpcm
 = 27;

89 
psi
->
ydpcm
 = 27;

90 
	`¥ötd
("DBG_getscreeninfo()\n");

91 
	}
}

94 
	$DBG_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

96 
	`¥ötd
("DBG_setpalette()\n");

97 
	}
}

100 
	$DBG_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

102 
	`¥ötd
("DBG_drawpixel()\n");

103 
	}
}

105 
MWPIXELVAL


106 
	$DBG_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

108 
	`¥ötd
("DBG_readpixel()\n");

109 
	}
}

113 
	$DBG_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

115 
	`¥ötd
("DBG_drawhline()\n");

116 
	}
}

120 
	$DBG_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

122 
	`¥ötd
("DBG_drawvline()\n");

123 
	}
}

126 
	$DBG_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

127 
MWPIXELVAL
 
c
)

129 
	`¥ötd
("DBG_fillrect()\n");

130 
	}
}

132 
	$DBG_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

133 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

135 
	`¥ötd
("DBG_blit()\n");

136 
	}
}

	@drivers/scr_djgr.c

17 
	~<°dio.h
>

18 
	~"devi˚.h
"

19 
	~"gíf⁄t.h
"

21 
	~<grx20.h
>

24 
PSD
 
DJGR_›í
(PSD 
psd
);

25 
DJGR_˛o£
(
PSD
 
psd
);

26 
DJGR_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

27 
DJGR_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

28 
DJGR_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

29 
MWPIXELVAL
 
DJGR_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

30 
DJGR_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

31 
DJGR_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
);

32 
DJGR_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

33 
DJGR_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,

34 
MWCOORD
 
h
,
PSD
 
§˝sd
,MWCOORD 
§cx
,MWCOORD 
§cy
,
›
);

35 
PSD
 
DJGR_Æloˇãmemgc
(PSD 
psd
);

37 
SCREENDEVICE
 
	gs¸dev
 = {

38 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

39 
DJGR_›í
,

40 
DJGR_˛o£
,

41 
DJGR_gës¸ìnöfo
,

42 
DJGR_£çÆëã
,

43 
DJGR_døwpixñ
,

44 
DJGR_ªadpixñ
,

45 
DJGR_døwhlöe
,

46 
DJGR_døwvlöe
,

47 
DJGR_fûÃe˘
,

48 
gí_f⁄ts
,

49 
DJGR_blô
,

50 
NULL
,

51 
NULL
,

52 
NULL
,

53 
DJGR_Æloˇãmemgc
,

54 
NULL
,

55 
NULL


58 
gr_mode
;

64 
PSD


65 
	$DJGR_›í
(
PSD
 
psd
)

67 
x
;

68 
y
;

69 
c
;

70 
GrVideoMode
 *
md_öfo
;

72 
x
 = 640;

73 
y
 = 480;

74 
c
 = 256;

76 
	`GrSëMode
(
GR_width_height_cﬁ‹_gøphics
,
x
,
y
,
c
);

78 
md_öfo
 = (
GrVideoMode
 *Ë
	`GrCuºítVideoMode
();

80 
psd
->
xªs
 =Ösd->
xvúåes
 = 
	`GrS¸ìnX
();

81 
psd
->
yªs
 =Ösd->
yvúåes
 = 
	`GrS¸ìnY
();

82 
psd
->
löñí
 = 
md_öfo
->
löeoff£t
;

83 
psd
->
∂™es
 = 1;

84 
psd
->
bµ
 = 
md_öfo
->bpp;

85 
psd
->
ncﬁ‹s
 = 
	`GrNumCﬁ‹s
();

86 
psd
->
Êags
 = 
PSF_SCREEN
;

87 
psd
->
addr
 = 0;

90 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

92  
psd
;

93 
	}
}

99 
	$DJGR_˛o£
(
PSD
 
psd
)

101 
	`GrSëMode
(
GR_deÁu…_ãxt
);

102 
	}
}

108 
	$DJGR_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

110 
psi
->
rows
 = 
psd
->
yvúåes
;

111 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

112 
psi
->
∂™es
 = 
psd
->planes;

113 
psi
->
bµ
 = 
psd
->bpp;

114 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

115 
psi
->
pixty≥
 = 
psd
->pixtype;

116 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

118 if(
s¸dev
.
yvúåes
 > 480) {

120 
psi
->
xdpcm
 = 33;

121 
psi
->
ydpcm
 = 33;

122 } if(
s¸dev
.
yvúåes
 > 350) {

124 
psi
->
xdpcm
 = 27;

125 
psi
->
ydpcm
 = 27;

128 
psi
->
xdpcm
 = 27;

129 
psi
->
ydpcm
 = 19;

131 
	}
}

137 
	$DJGR_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

139 
fú°
 < 256 && 
cou¡
-- > 0) {

140 
	`GrSëCﬁ‹
(
fú°
++, 
∑l
->
r
,ÖÆ->
g
,ÖÆ->
b
);

141 ++
∑l
;

143 
	}
}

149 
	$DJGR_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

151 
	`GrPlŸ
(
x
, 
y
, 
c
);

152 
	}
}

157 
MWPIXELVAL


158 
	$DJGR_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

160  
	`GrPixñ
(
x
, 
y
);

161 
	}
}

167 
	$DJGR_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

169 
	`GrHLöe
(
x1
, 
x2
, 
y
, 
c
);

170 
	}
}

176 
	$DJGR_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

178 
	`GrVLöe
(
x
, 
y1
, 
y2
, 
c
);

179 
	}
}

185 
	$DJGR_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

187 
	`GrFûÀdBox
(
x1
, 
y1
, 
x2
, 
y2
, 
c
);

188 
	}
}

194 
	$DJGR_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

195 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

198 
	}
}

201 
PSD


202 
	$DJGR_Æloˇãmemgc
(
PSD
 
psd
)

205  
NULL
;

206 
	}
}

	@drivers/scr_ecos.c

14 
	#_GNU_SOURCE
 1

	)

15 
	~<as£π.h
>

16 
	~<f˙é.h
>

17 
	~<limôs.h
>

18 
	~<cyg/hÆ/drv_≠i.h
>

19 
	~<cyg/io/io.h
>

20 
	~<°d¨g.h
>

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<sys/°©.h
>

24 
	~<sys/ty≥s.h
>

25 
	~<uni°d.h
>

26 
	~"devi˚.h
"

27 
	~"gíf⁄t.h
"

28 
	~"gímem.h
"

29 
	~"fb.h
"

30 
	~<cyg/hÆ/lcd_suµ‹t.h
>

31 
	~<cyg/ö‰a/düg.h
>

33 
PSD
 
fb_›í
(PSD 
psd
);

34 
fb_˛o£
(
PSD
 
psd
);

35 
fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
);

36 
gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

38 
SCREENDEVICE
 
	gs¸dev
 = {

39 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

40 
fb_›í
,

41 
fb_˛o£
,

42 
gí_gës¸ìnöfo
,

43 
fb_£çÆëã
,

44 
NULL
,

45 
NULL
,

46 
NULL
,

47 
NULL
,

48 
NULL
,

49 
gí_f⁄ts
,

50 
NULL
,

51 
NULL
,

52 
NULL
,

53 
NULL
,

54 
gí_Æloˇãmemgc
,

55 
fb_m≠memgc
,

56 
gí_‰ìmemgc


60 
	g°©us
;

62 
	gßved_ªd
[256];

63 
	gßved_gªí
[256];

64 
	gßved_blue
[256];

66 #i‡
PORTRAIT


67 
	ggr_p‹åaômode
 = 
PORTRAIT
;

71 
£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
);

74 
PSD


75 
	$fb_›í
(
PSD
 
psd
)

77 
PSUBDRIVER
 
subdrivî
;

78 
lcd_öfo
 
li
;

80 
	`as£π
(
°©us
 < 2);

83 
	`lcd_öô
(16);

84 
	`lcd_gëöfo
(&
li
);

86 
psd
->
xªs
 =Ösd->
xvúåes
 = 
li
.
width
;

87 
psd
->
yªs
 =Ösd->
yvúåes
 = 
li
.
height
;

88 #i‡
PORTRAIT


96 
psd
->
∂™es
 = 1;

97 
psd
->
∂™es
 = 0;

99 
psd
->
bµ
 = 
li
.bpp;

100 
psd
->
ncﬁ‹s
 = (psd->
bµ
 >= 24)? (1 << 24): (1 <<Ösd->bpp);

103 
psd
->
löñí
 = 
li
.
æí
;

104 
psd
->
size
 = 0;

106 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

107 i‡(
psd
->
bµ
 == 16)

108 
psd
->
Êags
 |
PSF_HAVEOP_COPY
;

110 #i‡
PORTRAIT


113 
psd
->
Êags
 |
PSF_PORTRAIT
;

116 
psd
->
xvúåes
 =Ösd->
yªs
;

117 
psd
->
yvúåes
 =Ösd->
xªs
;

122 
li
.
ty≥
) {

123 
FB_TRUE_RGB565
:

124 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR565
;

127 
	`EPRINTF
("Unsuµ‹ãd di•œyÅy≥: %d\n", 
li
.
ty≥
);

128 
Áû
;

132 
psd
->
bµ
) {

134 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR332
;

137 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR565
;

140 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR888
;

143 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR0888
;

146 
	`EPRINTF
(

148 
psd
->
ncﬁ‹s
,Ösd->
bµ
);

149 
Áû
;

151 } 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

154 
	`düg_¥ötf
("%dx%dx%dÜöñí %dÅy≥ %d bµ %d\n", 
psd
->
xªs
,

155 
psd
->
yªs
,Ösd->
ncﬁ‹s
,Ösd->
löñí
, 
li
.
ty≥
,Ösd->
bµ
);

158 
subdrivî
 = 
	`£À˘_fb_subdrivî
(
psd
);

159 i‡(!
subdrivî
) {

160 
	`EPRINTF
("Nÿdrivî f‹ s¸ìn\n", 
psd
->
bµ
);

161 
Áû
;

168 if(!
	`£t_subdrivî
(
psd
, 
subdrivî
, 
TRUE
)) {

169 
	`EPRINTF
("Drivî inôülizêÁûed\n", 
psd
->
bµ
);

170 
Áû
;

173 #i‡
PORTRAIT


174 if(
psd
->
Êags
 & 
PSF_PORTRAIT
) {

176 
_subdrivî
 = 
subdrivî
;

179 
	`£t_subdrivî
(
psd
, &
fbp‹åaô
, 
FALSE
);

183 
psd
->
addr
 = 
li
.
fb
;

184 if(
psd
->
addr
 =
NULL
 ||Ösd->addr == (*)-1) {

186 
Áû
;

191 
	`io˘l_gë∑Àâe
(0, 16, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

194 if(
visuÆ
 =
FB_VISUAL_DIRECTCOLOR
)

195 
	`£t_dúe˘cﬁ‹_∑Àâe
(
psd
);

198 
°©us
 = 2;

199  
psd
;

201 
Áû
:

202  
NULL
;

203 
	}
}

207 
	$fb_˛o£
(
PSD
 
psd
)

209 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
);

211 
ây
;

214 if(
°©us
 != 2)

216 
°©us
 = 1;

219 
	`io˘l_£çÆëã
(0, 256, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

225 
	`˛o£
(
fb
);

227 
	}
}

231 
	$£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
)

233 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
); 1) ;

235 
i
;

236 
r
[256], 
g
[256], 
b
[256];

239 if(
psd
->
bµ
 == 16) {

241 
i
=0; i<32; ++i) {

246 
r
[
i
] = 
g
[i] = 
b
[i] = (i<<11);

251 
	`io˘l_£çÆëã
(0, 32, 
r
, 
g
, 
b
);

254 
i
=0; i<256; ++i)

255 
r
[
i
] = i<<8;

256 
	`io˘l_£çÆëã
(0, 256, 
r
,Ñ,Ñ);

259 
	}
}

261 
	gÁde
 = 100;

265 
	$fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
)

267 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
); 1) ;

269 
i
;

270 
ªd
[
cou¡
];

271 
gªí
[
cou¡
];

272 
blue
[
cou¡
];

275 
i
=0; i < 
cou¡
; i++) {

276 
MWPALENTRY
 *
p
 = &
∑Àâe
[
i
];

282 
ªd
[
i
] = (
p
->
r
 * 
Áde
 / 100) << 8;

283 
gªí
[
i
] = (
p
->
g
 * 
Áde
 / 100) << 8;

284 
blue
[
i
] = (
p
->
b
 * 
Áde
 / 100) << 8;

286 
	`io˘l_£çÆëã
(
fú°
, 
cou¡
, 
ªd
, 
gªí
, 
blue
);

288 
	}
}

292 
	$io˘l_gë∑Àâe
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

294 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
); 1) ;

296 
fb_cm≠
 
cm≠
;

297 
cyg_uöt32
 
sz
 = (
cm≠
);

299 
cm≠
.
°¨t
 = start;

300 
cm≠
.
Àn
 =Üen;

301 
cm≠
.
ªd
 =Ñed;

302 
cm≠
.
gªí
 = green;

303 
cm≠
.
blue
 = blue;

304 
cm≠
.
å™•
 = 
NULL
;

306 
	`cyg_io_gë_c⁄fig
–
fb_h™dÀ
, 
CYG_IO_GET_CONFIG_FB_PALETTE
, &
cm≠
, &
sz
 );

309 
	}
}

313 
	$io˘l_£çÆëã
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

315 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
); 1) ;

317 
fb_cm≠
 
cm≠
;

318 
cyg_uöt32
 
sz
 = (
cm≠
);

320 
cm≠
.
°¨t
 = start;

321 
cm≠
.
Àn
 =Üen;

322 
cm≠
.
ªd
 =Ñed;

323 
cm≠
.
gªí
 = green;

324 
cm≠
.
blue
 = blue;

325 
cm≠
.
å™•
 = 
NULL
;

327 
	`cyg_io_£t_c⁄fig
–
fb_h™dÀ
, 
CYG_IO_SET_CONFIG_FB_PALETTE
, &
cm≠
, &
sz
 );

330 
	}
}

334 
	$£tÁdñevñ
(
PSD
 
psd
, 
f
)

336 
	`¥ötf
("%†- NOT IMPLEMENTED\n", 
__FUNCTION__
); 1) ;

338 
i
;

339 
r
[256], 
g
[256], 
b
[256];

340 
MWPALENTRY
 
gr_∑Àâe
[256];

342 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

345 
Áde
 = 
f
;

346 if(
Áde
 > 100)

347 
Áde
 = 100;

348 
i
=0; i<256; ++i) {

349 
r
[
i
] = (
gr_∑Àâe
[i].∏* 
Áde
 / 100) << 8;

350 
g
[
i
] = (
gr_∑Àâe
[i].g * 
Áde
 / 100) << 8;

351 
b
[
i
] = (
gr_∑Àâe
[i].b * 
Áde
 / 100) << 8;

353 
	`io˘l_£çÆëã
(0, 256, 
r
, 
g
, 
b
);

355 
	}
}

358 
	$gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

360 
psi
->
rows
 = 
psd
->
yvúåes
;

361 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

362 
psi
->
∂™es
 = 
psd
->planes;

363 
psi
->
bµ
 = 
psd
->bpp;

364 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

365 
psi
->
pixty≥
 = 
psd
->pixtype;

366 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

369 if(
psd
->
yvúåes
 > 480) {

371 
psi
->
xdpcm
 = 33;

372 
psi
->
ydpcm
 = 33;

373 } if(
psd
->
yvúåes
 > 350) {

375 
psi
->
xdpcm
 = 27;

376 
psi
->
ydpcm
 = 27;

379 
psi
->
xdpcm
 = 27;

380 
psi
->
ydpcm
 = 19;

383 
psi
->
ydpcm
 = 42;

384 
psi
->
xdpcm
 = 38;

386 
	}
}

	@drivers/scr_em84xx.c

21 
	~<°dio.h
>

22 
	~<°dlib.h
>

23 
	~<°rög.h
>

24 
	~<±hªad.h
>

25 
	~<uni°d.h
>

27 
	~"devi˚.h
"

28 
	~"gíf⁄t.h
"

29 
	~"gímem.h
"

31 
	#_DEFINE_FMP_TYPES_


	)

32 
	~"fmp.h
"

34 
	#WIDTH
 720

	)

35 
	#HEIGHT
 480

	)

36 
	tLONG
;

37 
	tULONG
;

38 * 
	tPBYTE
;

40 
	#IID_IOSD
 0x00000000

	)

42 
	sègOSD_WND


44 
LONG
 
	mx
;

45 
LONG
 
	my
;

46 
LONG
 
	mw
;

47 
LONG
 
	mh
;

48 } 
	tOSD_WND
;

50 
	sègIOsd


52 
ègIOsdVtbl
 *
	mÕVtbl
;

53 } 
	tIOsd
;

55 
	sègIOsdVtbl


57 
ULONG
 (*
On
)(
IOsd
 *
	mThis
);

58 
ULONG
 (*
Off
)(
IOsd
 *
	mThis
);

59 
ULONG
 (*
Flush
)(
IOsd
 *
	mThis
);

60 
ULONG
 (*
Wrôe
)(
IOsd
 *
	mThis
, 
BYTE
 *
	mpBuf
, ULONG 
	mBufLí
);

61 
ULONG
 (*
SëDe°
)(
IOsd
 *
	mThis
, 
OSD_WND
 *
	mpWnd
);

62 
ULONG
 (*
SëHli
)(
IOsd
 *
	mThis
, 
OSD_WND
 *
	mpWnd
);

63 
ULONG
 (*
ShowS∂ash
)(
IOsd
 *
	mThis
, 
PBYTE
 
	mbuf
, 
DWORD
 
	mwidth
, DWORD 
	mheight
);

64 
ULONG
 (*
SëFømeBuf„r
)(
IOsd
 *
	mThis
, 
DWORD
 
	mPhysiˇlAddªss
, DWORD 
	mLígth
);

65 
ULONG
 (*
ShowS∂ashEx
)(
IOsd
 *
	mThis
, 
PBYTE
 
	mbuf
, 
DWORD
 
	mwidth
, DWORD 
	mheight
, 
	mx
, 
	my
);

66 } 
	tIOsdVtbl
;

68 * 
	tADDR8
;

70 
IOsd
 *
	gpIOsd
 = 
NULL
;

71 
	gyuv_d©a
[
WIDTH
*
HEIGHT
*3/2];

72 
	grgb_d©a
[
WIDTH
*
HEIGHT
*3];

75 
PSD
 
EM8400_›í
(PSD 
psd
);

76 
EM8400_˛o£
(
PSD
 
psd
);

77 
EM8400_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);;

78 
EM8400_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

79 
EM8400_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

80 
MWPIXELVAL
 
EM8400_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

81 
EM8400_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

82 
EM8400_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

83 
EM8400_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

84 
MWPIXELVAL
 
c
);

85 
EM8400_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

86 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
);

87 
MWBOOL
 
EM8400_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

88 
löñí
,
size
,*
addr
);

90 
SCREENDEVICE
 
	gs¸dev
 = {

91 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

92 
EM8400_›í
,

93 
EM8400_˛o£
,

94 
EM8400_gës¸ìnöfo
,

95 
EM8400_£çÆëã
,

96 
EM8400_døwpixñ
,

97 
EM8400_ªadpixñ
,

98 
EM8400_døwhlöe
,

99 
EM8400_døwvlöe
,

100 
EM8400_fûÃe˘
,

101 
gí_f⁄ts
,

102 
EM8400_blô
,

103 
NULL
,

104 
NULL
,

105 
NULL
,

106 
gí_Æloˇãmemgc
,

107 
EM8400_m≠memgc
,

108 
gí_‰ìmemgc


111 
	#¥ötd
(
_a
)

	)

113 
	#DRAWON
 
døw_lock
++;if(
debug
)
	`Ârötf
(
°dîr
, "ENTER %s\n", 
__PRETTY_FUNCTION__
);

	)

114 
	#DRAWOFF
 
døw_lock
--;if(
debug
)
	`Ârötf
(
°dîr
, "LEAVE %s\n", 
__PRETTY_FUNCTION__
);

	)

116 #i‚de‡
USE_FAST_UPDATE


117 
±hªad_t
 
	gdi•œy_thªad
;

118 
±hªad_c⁄d_t
 
	gdi•œy_upd©e_c⁄d
 = 
PTHREAD_COND_INITIALIZER
;

119 
±hªad_muãx_t
 
	gdi•œy_upd©e_muãx
 = 
PTHREAD_MUTEX_INITIALIZER
;

121 
	gquô
 = 0;

122 
	gdebug
 = 0;

123 
	gdøw_lock
 = 0;

125 
	$show_•œsh
(
ux
, 
uy
, 
uw
, 
uh
)

127 
x
, 
y
;

128 *
ùå
, *
›åy
, *
›åuv
;

129 
r1
, 
g1
, 
b1
, 
y1
, 
y2
=0, 
u
=0, 
v
=0, 
u0
=0, 
u1
, 
u2
, 
v0
=0, 
v1
, 
v2
;

130 
r2
, 
g2
, 
b2
;

132 i‡(
pIOsd
 =
NULL
) ;

134 #ifde‡
USE_FAST_UPDATE


135 i‡(
døw_lock
 != 1) ;

138 
uw
+=1; 
uh
+=1;

139 i‡(
uw
 + 
ux
 > 
WIDTH
) uw = WIDTH-ux;

140 i‡(
uh
 + 
uy
 > 
HEIGHT
) uh = HEIGHT-uy;

141 
›åy
 = 
yuv_d©a
;

142 
›åuv
 = 
yuv_d©a
 + 
uw
*
uh
;

143 
ùå
 = 
rgb_d©a
 + (
ux
+
uy
*
WIDTH
)*3;

145 
y
 = 
uy
; y < uy+
uh
; y++) {

146 
x
 = 
ux
; x < ux+
uw
; x+=2) {

147 
r1
 = *
ùå
++;

148 
g1
 = *
ùå
++;

149 
b1
 = *
ùå
++;

150 
r2
 = *
ùå
++;

151 
g2
 = *
ùå
++;

152 
b2
 = *
ùå
++;

154 
y1
 = 16829 * 
r1
 + 33039 * 
g1
 + 6416 * 
b1
 + (0xfff‡& 
y2
);

155 
y2
 = 16829 * 
r2
 + 33039 * 
g2
 + 6416 * 
b2
 + (0xfff‡& 
y1
);

157 *
›åy
++ = (
y1
 >> 16) + 16;

158 *
›åy
++ = (
y2
 >> 16) + 16;

160 i‡(!(
y
 % 2)) {

161 
u1
 = -4853 * 
r1
 - 9530 * 
g1
 + 14383 * 
b1
;

162 
v1
 = 14386 * 
r1
 - 12046 * 
g1
 - 2340 * 
b1
;

163 
u2
 = -2426 * 
r2
 - 4765 * 
g2
 + 7191 * 
b2
;

164 
v2
 = 7193 * 
r2
 - 6023 * 
g2
 - 1170 * 
b2
;

165 
u
 = 
u0
 + 
u1
 + 
u2
 + (0xffff & u);

166 
v
 = 
v0
 + 
v1
 + 
v2
 + (0xffff & v);

167 
u0
 = 
u2
;

168 
v0
 = 
v2
;

171 *
›åuv
++ = (
u
 >> 16) + 128;

172 *
›åuv
++ = (
v
 >> 16) + 128;

175 
ùå
 +(
WIDTH
-
uw
)*6;

177 
pIOsd
->
ÕVtbl
->
	`ShowS∂ashEx
’IOsd, 
yuv_d©a
, 
uw
, 
uh
, 
ux
, 
uy
);

178 
	}
}

180 *
	$thªad_lo›
(*
d©a
)

182 !
quô
) {

183 
	`±hªad_c⁄d_waô
(&
di•œy_upd©e_c⁄d
, &
di•œy_upd©e_muãx
);

184 
	`show_•œsh
(0,0,
WIDTH
-1,
HEIGHT
-1);

185 
	`u¶ìp
(10);

188 
	}
}

190 
PSD


191 
	$EM8400_›í
(
PSD
 
psd
)

193 
DWORD
 
tv_£âög
, 
ﬁd_£âög
;

196 
psd
->
xªs
 =Ösd->
xvúåes
 = 
WIDTH
;

197 
psd
->
yªs
 =Ösd->
yvúåes
 = 
HEIGHT
;

198 
psd
->
∂™es
 = 1;

199 
psd
->
bµ
 = 24;

200 
psd
->
ncﬁ‹s
 = 1<<24;

201 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR888
;

202 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

203 
psd
->
löñí
 = 
WIDTH
;

204 
psd
->
addr
 = 
rgb_d©a
;

206 
	`mem£t
(
rgb_d©a
, 0x00, 
WIDTH
*
HEIGHT
*3);

207 
	`mem£t
(
yuv_d©a
, 0x00, 
WIDTH
*
HEIGHT
*3/2);

208 
	`MPEGDrivîE¡ry
(
NO_DRIVE
);

213 
	`FMPO≥n
(
FMPF_SYSTEM
, 32767, 8, 
NULL
, 0);

215 
ﬁd_£âög
 = 
	`FMPGë
(
FMPI_VIDEOOUT
);

216 
tv_£âög
 = 
ﬁd_£âög
&(~
FMPV_VIDEOOUT_STANDARDTV_MASK
);

217 
tv_£âög
 |
FMPV_VIDEOOUT_PAL
;

218 
	`FMPSë
(
FMPI_VIDEOOUT
,
tv_£âög
);

219 
	`FMPClo£
();

221 i‡(
	`FMPQuîyI¡îÁ˚
(
IID_IOSD
, (**)&
pIOsd
)) {

222 
	`Ârötf
(
°dîr
, "not open\n");

223 
pIOsd
 = 
NULL
;

226 #ifde‡
USE_FAST_UPDATE


227 
	`show_•œsh
(0,0,
WIDTH
,
HEIGHT
);

229 
	`±hªad_¸óã
(&
di•œy_thªad
, 
NULL
, 
thªad_lo›
, NULL);

230 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

232  
psd
;

233 
	}
}

236 
	$EM8400_˛o£
(
PSD
 
psd
)

238 
quô
 = 1;

239 #i‚de‡
USE_FAST_UPDATE


240 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

241 
	`±hªad_joö
(
di•œy_thªad
, 
NULL
);

243 
	`MPEGDrivîU∆ﬂd
();

244 
	`¥ötd
("EM8400_close()\n");

245 
	}
}

248 
	$EM8400_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

250 
psi
->
rows
 = 
psd
->
yvúåes
;

251 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

252 
psi
->
∂™es
 = 
psd
->planes;

253 
psi
->
bµ
 = 
psd
->bpp;

254 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

255 
psi
->
pixty≥
 = 
psd
->pixtype;

256 
psi
->
f⁄ts
 = 1;

259 
psi
->
xdpcm
 = 27;

260 
psi
->
ydpcm
 = 27;

261 
	`¥ötd
("EM8400_getscreeninfo()\n");

262 
	}
}

265 
	$EM8400_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

267 
	`¥ötd
("EM8400_setpalette()\n");

268 
	}
}

271 
	$EM8400_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

273 
ADDR8
 
addr
 = 
psd
->addr;

274 
MWUCHAR
 
r
, 
g
, 
b
;

276 
DRAWON
;

277 
r
 = 
	`PIXEL888RED
(
c
);

278 
g
 = 
	`PIXEL888GREEN
(
c
);

279 
b
 = 
	`PIXEL888BLUE
(
c
);

281 
addr
 +(
x
+
y
*
psd
->
löñí
) * 3;

283 *
addr
++ = 
r
;

284 *
addr
++ = 
g
;

285 *
addr
++ = 
b
;

286 #ifde‡
USE_FAST_UPDATE


287 
	`show_•œsh
(
x
, 
y
, 1, 1);

289 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

291 
DRAWOFF
;

292 
	}
}

294 
MWPIXELVAL


295 
	$EM8400_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

297 
ADDR8
 
addr
 = 
psd
->addr;

299 
addr
 +(
x
+
y
*
psd
->
löñí
) * 3;

300  
	`RGB2PIXEL
(
addr
[0],áddr[1],áddr[2]);

301 
	}
}

305 
	$EM8400_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

307 
ADDR8
 
addr
 = 
psd
->addr;

308 
MWUCHAR
 
r
, 
g
, 
b
;

309 #ifde‡
USE_FAST_UPDATE


310 
x
 = 
x1
;

313 
DRAWON
;

314 
r
 = 
	`PIXEL888RED
(
c
);

315 
g
 = 
	`PIXEL888GREEN
(
c
);

316 
b
 = 
	`PIXEL888BLUE
(
c
);

318 
addr
 +(
x1
+
y
*
psd
->
löñí
)*3;

320 
x1
++ <
x2
) {

321 *
addr
++ = 
r
;

322 *
addr
++ = 
g
;

323 *
addr
++ = 
b
;

325 #ifde‡
USE_FAST_UPDATE


326 
	`show_•œsh
(
x
, 
y
, 
x2
 - x, 1);

328 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

330 
DRAWOFF
;

331 
	}
}

336 
	$EM8400_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

338 
ADDR8
 
addr
 = 
psd
->addr;

339 
löñí
 = 
psd
->linelen * 3;

340 
MWUCHAR
 
r
, 
g
, 
b
;

341 #ifde‡
USE_FAST_UPDATE


342 
y
 = 
y1
;

345 
DRAWON
;

346 
r
 = 
	`PIXEL888RED
(
c
);

347 
g
 = 
	`PIXEL888GREEN
(
c
);

348 
b
 = 
	`PIXEL888BLUE
(
c
);

350 
addr
 +(
x
+
y1
*
psd
->
löñí
)*3;

352 
y1
++ <
y2
) {

353 
addr
[0] = 
r
;

354 
addr
[1] = 
g
;

355 
addr
[2] = 
b
;

356 
addr
 +
löñí
;

358 #ifde‡
USE_FAST_UPDATE


359 
	`show_•œsh
(
x
, 
y
, 1, 
y2
 - y);

361 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

363 
DRAWOFF
;

364 
	}
}

367 
	$EM8400_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

368 
MWPIXELVAL
 
c
)

370 #ifde‡
USE_FAST_UPDATE


371 
y
 = 
y1
;

373 
DRAWON
;

374 
y1
 <
y2
)

375 
psd
->
	`DøwH‹zLöe
’sd, 
x1
, 
x2
, 
y1
++, 
c
);

376 #ifde‡
USE_FAST_UPDATE


377 
	`show_•œsh
(
x1
, 
y
, 
x2
-x1, 
y2
-y);

379 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

381 
DRAWOFF
;

383 
	}
}

386 
	$EM8400_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

387 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

389 
ADDR8
 
d°
 = 
d°psd
->
addr
;

390 
ADDR8
 
§c
 = 
§˝sd
->
addr
;

391 
dlöñí
 = 
d°psd
->
löñí
 * 3;

392 
¶öñí
 = 
§˝sd
->
löñí
 * 3;

394 
DRAWON
;

395 
d°
 +(
d°x
+
d°y
*
d°psd
->
löñí
)*3;

396 
§c
 +(
§cx
+
§cy
*
§˝sd
->
löñí
)*3;

398 i‡(
§cy
 < 
d°y
) {

399 
§c
 +(
h
 - 1Ë* 
¶öñí
;

400 
d°
 +(
h
 - 1Ë* 
dlöñí
;

401 
¶öñí
 *= -1;

402 
dlöñí
 *= -1;

405 --
h
 >=0) {

406 
	`memmove
(
d°
, 
§c
, 
w
*3);

407 
d°
 +
dlöñí
;

408 
§c
 +
¶öñí
;

410 #ifde‡
USE_FAST_UPDATE


411 
	`show_•œsh
(
d°x
, 
d°y
, 
w
, 
h
);

413 
	`±hªad_c⁄d_sig«l
(&
di•œy_upd©e_c⁄d
);

415 
DRAWOFF
;

416 
	}
}

418 
MWBOOL


419 
	$EM8400_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

420 
löñí
,
size
,*
addr
)

422 
SUBDRIVER
 
fblöór24
;

424 
	`öômemgc
(
mempsd
, 
w
, 
h
, 
∂™es
, 
bµ
, 
löñí
, 
size
, 
addr
);

427 i‡(!
	`£t_subdrivî
(
mempsd
, &
fblöór24
, 
TRUE
))

431 
	}
}

	@drivers/scr_fb.c

11 
	#_GNU_SOURCE
 1

	)

12 
	~<as£π.h
>

13 
	~<f˙é.h
>

14 
	~<limôs.h
>

15 
	~<löux/fb.h
>

16 
	~<löux/kd.h
>

17 
	~<löux/vt.h
>

18 
	~<°d¨g.h
>

19 
	~<°dio.h
>

20 
	~<°dlib.h
>

21 
	~<sys/io˘l.h
>

22 
	~<sys/mm™.h
>

23 
	~<sys/°©.h
>

24 
	~<sys/time.h
>

25 
	~<sys/ty≥s.h
>

26 
	~<uni°d.h
>

27 
	~"devi˚.h
"

28 
	~"gíf⁄t.h
"

29 
	~"gímem.h
"

30 
	~"fb.h
"

32 #ifde‡
ARCH_LINUX_SPARC


35 
	#EMBEDDEDPLANET
 0

	)

37 #i‚de‡
FB_TYPE_VGA_PLANES


38 
	#FB_TYPE_VGA_PLANES
 4

	)

41 
PSD
 
fb_›í
(PSD 
psd
);

42 
fb_˛o£
(
PSD
 
psd
);

43 
fb_£ç‹åaô
(
PSD
 
psd
, 
p‹åaômode
);

44 
fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
);

45 
gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

48 
SCREENDEVICE
 
	gs¸dev
 = {

49 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

50 
fb_›í
,

51 
fb_˛o£
,

52 
gí_gës¸ìnöfo
,

53 
fb_£çÆëã
,

54 
NULL
,

55 
NULL
,

56 
NULL
,

57 
NULL
,

58 
NULL
,

59 
gí_f⁄ts
,

60 
NULL
,

61 
NULL
,

62 
NULL
,

63 
NULL
,

64 
gí_Æloˇãmemgc
,

65 
fb_m≠memgc
,

66 
gí_‰ìmemgc
,

67 
NULL
,

68 
fb_£ç‹åaô


72 
	gfb
;

73 
	g°©us
;

74 
	gßved_ªd
[16];

75 
	gßved_gªí
[16];

76 
	gßved_blue
[16];

78 
SUBDRIVER
 
fbp‹åaô_À·
, 
fbp‹åaô_right
, 
fbp‹åaô_down
;

79 
PSUBDRIVER
 
	gpdrivîs
[4] = {

80 
NULL
, &
fbp‹åaô_À·
, &
fbp‹åaô_right
, &
fbp‹åaô_down


84 
£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
);

87 
PSD


88 
	$fb_›í
(
PSD
 
psd
)

90 * 
ív
;

91 
ty≥
, 
visuÆ
;

92 
PSUBDRIVER
 
subdrivî
;

93 #i‡
HAVETEXTMODE


94 
ây
;

96 #i‡
EMBEDDEDPLANET


97 
ív
 = "/dev/lcd";

98 
fb
 = 
	`›í
(
ív
, 
O_RDWR
);

99 if(
fb
 < 0) {

100 
	`EPRINTF
("Eº‹ o≥nög %s: %m", 
ív
);

101  
NULL
;

104 
ty≥
 = 
FB_TYPE_PACKED_PIXELS
;

105 
visuÆ
 = 
FB_VISUAL_PSEUDOCOLOR
;

106 
psd
->
xªs
 =Ösd->
xvúåes
 = 640;

107 
psd
->
yªs
 =Ösd->
yvúåes
 = 480;

108 
psd
->
∂™es
 = 1;

109 
psd
->
bµ
 = 8;

111 
psd
->
löñí
 =Ösd->
xvúåes
;

112 
psd
->
ncﬁ‹s
 = (psd->
bµ
 >= 24)? (1 << 24): (1 <<Ösd->bpp);

113 
psd
->
size
 = 0;

115 i‡(
	`io˘l
(
fb
, 1, 0) < 0) {

116 
	`EPRINTF
("Error: can'tÉnable LCD");

117 
Áû
;

120 
fb_fix_s¸ìnöfo
 
fb_fix
;

121 
fb_v¨_s¸ìnöfo
 
fb_v¨
;

123 
	`as£π
(
°©us
 < 2);

126 if(!(
ív
 = 
	`gëív
("FRAMEBUFFER")))

127 
ív
 = "/dev/fb0";

128 
fb
 = 
	`›í
(
ív
, 
O_RDWR
);

129 if(
fb
 < 0) {

130 
	`EPRINTF
("Eº‹ o≥nög %s: %m. Check kî√»c⁄fig\n", 
ív
);

131  
NULL
;

133 if(
	`io˘l
(
fb
, 
FBIOGET_FSCREENINFO
, &
fb_fix
) == -1 ||

134 
	`io˘l
(
fb
, 
FBIOGET_VSCREENINFO
, &
fb_v¨
) == -1) {

135 
	`EPRINTF
("ErrorÑeading screen info: %m\n");

136 
Áû
;

139 
ty≥
 = 
fb_fix
.type;

140 
visuÆ
 = 
fb_fix
.visual;

142 
psd
->
p‹åaô
 = 
MWPORTRAIT_NONE
;

143 #ifde‡
ARCH_LINUX_SPARC


144 
psd
->
xªs
 =Ösd->
xvúåes
 = 
fb_v¨
.
xªs_vútuÆ
;

145 
psd
->
yªs
 =Ösd->
yvúåes
 = 
fb_v¨
.
yªs_vútuÆ
;

147 
psd
->
xªs
 =Ösd->
xvúåes
 = 
fb_v¨
.xres;

148 
psd
->
yªs
 =Ösd->
yvúåes
 = 
fb_v¨
.yres;

152 i‡(
ty≥
 =
FB_TYPE_VGA_PLANES
)

153 
psd
->
∂™es
 = 4;

154 i‡(
ty≥
 =
FB_TYPE_PACKED_PIXELS
)

155 
psd
->
∂™es
 = 1;

156 
psd
->
∂™es
 = 0;

158 
psd
->
bµ
 = 
fb_v¨
.
bôs_≥r_pixñ
;

159 
psd
->
ncﬁ‹s
 = (psd->
bµ
 >= 24)? (1 << 24): (1 <<Ösd->bpp);

162 
psd
->
löñí
 = 
fb_fix
.
löe_Àngth
;

163 
psd
->
size
 = 0;

166 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

167 i‡(
psd
->
bµ
 == 16)

168 
psd
->
Êags
 |
PSF_HAVEOP_COPY
;

171 #i‚de‡
TPHELIO


172 if(
visuÆ
 =
FB_VISUAL_TRUECOLOR
 || visuÆ =
FB_VISUAL_DIRECTCOLOR
) {

173 
psd
->
bµ
) {

175 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR332
;

178 i‡(
fb_v¨
.
gªí
.
Àngth
 == 5)

179 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR555
;

181 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR565
;

184 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR888
;

187 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR0888
;

188 #i‡!
EMBEDDEDPLANET


190 i‡(
fb_v¨
.
å™•
.
Àngth
 == 8)

191 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR8888
;

195 
	`EPRINTF
(

197 
psd
->
ncﬁ‹s
,Ösd->
bµ
);

198 
Áû
;

202 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

209 
subdrivî
 = 
	`£À˘_fb_subdrivî
(
psd
);

210 i‡(!
subdrivî
) {

211 
	`EPRINTF
("No driver for screenÅype %d visual %d bpp %d\n",

212 
ty≥
, 
visuÆ
, 
psd
->
bµ
);

213 
Áû
;

220 if(!
	`£t_subdrivî
(
psd
, 
subdrivî
, 
TRUE
)) {

221 
	`EPRINTF
("Driver initialize failedÅype %d visual %d bpp %d\n",

222 
ty≥
, 
visuÆ
, 
psd
->
bµ
);

223 
Áû
;

227 
pdrivîs
[0] = 
psd
->
‹gsubdrivî
 = 
subdrivî
;

229 #i‡
HAVETEXTMODE


231 
ây
 = 
	`›í
 ("/dev/ây0", 
O_RDWR
);

232 if(
ây
 < 0) {

233 
	`EPRINTF
("Error can't open /dev/tty0: %m\n");

234 
Áû
;

236 if(
	`io˘l
 (
ây
, 
KDSETMODE
, 
KD_GRAPHICS
) == -1) {

237 
	`EPRINTF
("Error setting graphics mode: %m\n");

238 
	`˛o£
(
ây
);

239 
Áû
;

241 
	`˛o£
(
ây
);

244 
psd
->
size
 = (psd->sizê+ 
	`gë∑gesize
 () - 1)

245 / 
	`gë∑gesize
 () * getpagesize ();

246 #ifde‡
ARCH_LINUX_SPARC


247 
	#CG3_MMAP_OFFSET
 0x4000000

	)

248 
	#CG6_RAM
 0x70016000

	)

249 
	#TCX_RAM8BIT
 0x00000000

	)

250 
	#TCX_RAM24BIT
 0x01000000

	)

251 
fb_fix
.
ac˚l
) {

252 
FB_ACCEL_SUN_CGTHREE
:

253 
psd
->
addr
 = 
	`mm≠
(
NULL
,Ösd->
size
, 
PROT_READ
|
PROT_WRITE
,
MAP_SHARED
,
fb
,
CG3_MMAP_OFFSET
);

255 
FB_ACCEL_SUN_CGSIX
:

256 
psd
->
addr
 = 
	`mm≠
(
NULL
,Ösd->
size
, 
PROT_READ
|
PROT_WRITE
,
MAP_SHARED
,
fb
,
CG6_RAM
);

258 
FB_ACCEL_SUN_TCX
:

259 
psd
->
addr
 = 
	`mm≠
(
NULL
,Ösd->
size
, 
PROT_READ
|
PROT_WRITE
,
MAP_SHARED
,
fb
,
TCX_RAM24BIT
);

262 
	`EPRINTF
("D⁄;àknow howÅÿmm≠ %†wôhác˚»%d\n", 
ív
, 
fb_fix
.
ac˚l
);

263 
Áû
;

266 
psd
->
addr
 = 
	`mm≠
(
NULL
,Ösd->
size
, 
PROT_READ
|
PROT_WRITE
,
MAP_SHARED
,
fb
,0);

268 if(
psd
->
addr
 =
NULL
 ||Ösd->addr == (*)-1) {

269 
	`EPRINTF
("Eº‹ mm≠ög %s: %m\n", 
ív
);

270 
Áû
;

274 
	`io˘l_gë∑Àâe
(0, 16, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

277 if(
visuÆ
 =
FB_VISUAL_DIRECTCOLOR
)

278 
	`£t_dúe˘cﬁ‹_∑Àâe
(
psd
);

280 
°©us
 = 2;

281  
psd
;

283 
Áû
:

284 
	`˛o£
(
fb
);

285  
NULL
;

286 
	}
}

290 
	$fb_˛o£
(
PSD
 
psd
)

292 #i‡
HAVETEXTMODE


293 
ây
;

297 if(
°©us
 != 2)

299 
°©us
 = 1;

302 
	`io˘l_£çÆëã
(0, 16, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

305 
	`munm≠
(
psd
->
addr
,Ösd->
size
);

307 #i‡
HAVETEXTMODE


309 
ây
 = 
	`›í
 ("/dev/ây0", 
O_RDWR
);

310 
	`io˘l
(
ây
, 
KDSETMODE
, 
KD_TEXT
);

311 
	`˛o£
(
ây
);

314 
	`˛o£
(
fb
);

315 
	}
}

318 
	$fb_£ç‹åaô
(
PSD
 
psd
, 
p‹åaômode
)

320 
psd
->
p‹åaô
 = 
p‹åaômode
;

323 i‡(
p‹åaômode
 & (
MWPORTRAIT_LEFT
|
MWPORTRAIT_RIGHT
)) {

325 
psd
->
xvúåes
 =Ösd->
yªs
;

326 
psd
->
yvúåes
 =Ösd->
xªs
;

329 
psd
->
xvúåes
 =Ösd->
xªs
;

330 
psd
->
yvúåes
 =Ösd->
yªs
;

333 i‡(
p‹åaômode
 =
MWPORTRAIT_DOWN
)

334 
p‹åaômode
 = 3;

335 
	`£t_subdrivî
(
psd
, 
pdrivîs
[
p‹åaômode
], 
FALSE
);

336 
	}
}

340 
	$£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
)

342 
i
;

343 
r
[256];

346 if(
psd
->
bµ
 == 16) {

347 
i
=0; i<32; ++i)

348 
r
[
i
] = i<<11;

349 
	`io˘l_£çÆëã
(0, 32, 
r
,Ñ,Ñ);

352 
i
=0; i<256; ++i)

353 
r
[
i
] = i<<8;

354 
	`io˘l_£çÆëã
(0, 256, 
r
,Ñ,Ñ);

356 
	}
}

358 
	gÁde
 = 100;

362 
	$fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
)

364 
i
;

365 
ªd
[256];

366 
gªí
[256];

367 
blue
[256];

369 i‡(
cou¡
 > 256)

370 
cou¡
 = 256;

373 
i
=0; i < 
cou¡
; i++) {

374 
MWPALENTRY
 *
p
 = &
∑Àâe
[
i
];

380 
ªd
[
i
] = (
p
->
r
 * 
Áde
 / 100) << 8;

381 
gªí
[
i
] = (
p
->
g
 * 
Áde
 / 100) << 8;

382 
blue
[
i
] = (
p
->
b
 * 
Áde
 / 100) << 8;

384 
	`io˘l_£çÆëã
(
fú°
, 
cou¡
, 
ªd
, 
gªí
, 
blue
);

385 
	}
}

389 
	$io˘l_gë∑Àâe
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

391 #i‡
EMBEDDEDPLANET


392 
i
;

393 
cﬁ‹s
[256];

395 
	`io˘l
(
fb
, 4, 
cﬁ‹s
);

396 
i
 = 
°¨t
; ((ò- sèπË< 
Àn
) && (i < 256); i++) {

397 
ªd
[
i
 - 
°¨t
] = (
cﬁ‹s
[i] & 0xf00) << 4;

398 
gªí
[
i
 - 
°¨t
] = (
cﬁ‹s
[i] & 0x0f0) << 8;

399 
blue
[
i
 - 
°¨t
] = (
cﬁ‹s
[i] & 0x00f) << 12;

402 
fb_cm≠
 
cm≠
;

404 
cm≠
.
°¨t
 = start;

405 
cm≠
.
Àn
 =Üen;

406 
cm≠
.
ªd
 =Ñed;

407 
cm≠
.
gªí
 = green;

408 
cm≠
.
blue
 = blue;

409 
cm≠
.
å™•
 = 
NULL
;

411 
	`io˘l
(
fb
, 
FBIOGETCMAP
, &
cm≠
);

413 
	}
}

417 
	$io˘l_£çÆëã
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

419 #i‡
EMBEDDEDPLANET


420 
i
;

421 
cﬁ‹s
[256];

423 
	`io˘l
(
fb
, 4, 
cﬁ‹s
);

424 
i
 = 
°¨t
; ((ò- sèπË< 
Àn
) && (i < 256); i++) {

425 
cﬁ‹s
[
i
] = ((
ªd
[ò- 
°¨t
] & 0xf000) >> 4)

426 | ((
gªí
[
i
 - 
°¨t
] & 0xf000) >> 8)

427 | ((
blue
[
i
 - 
°¨t
] & 0xf000) >> 12);

429 
	`io˘l
(
fb
, 3, 
cﬁ‹s
);

431 
fb_cm≠
 
cm≠
;

433 
cm≠
.
°¨t
 = start;

434 
cm≠
.
Àn
 =Üen;

435 
cm≠
.
ªd
 =Ñed;

436 
cm≠
.
gªí
 = green;

437 
cm≠
.
blue
 = blue;

438 
cm≠
.
å™•
 = 
NULL
;

440 
	`io˘l
(
fb
, 
FBIOPUTCMAP
, &
cm≠
);

442 
	}
}

446 
	$£tÁdñevñ
(
PSD
 
psd
, 
f
)

448 
i
;

449 
r
[256], 
g
[256], 
b
[256];

450 
MWPALENTRY
 
gr_∑Àâe
[256];

452 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

455 
Áde
 = 
f
;

456 if(
Áde
 > 100)

457 
Áde
 = 100;

458 
i
=0; i<256; ++i) {

459 
r
[
i
] = (
gr_∑Àâe
[i].∏* 
Áde
 / 100) << 8;

460 
g
[
i
] = (
gr_∑Àâe
[i].g * 
Áde
 / 100) << 8;

461 
b
[
i
] = (
gr_∑Àâe
[i].b * 
Áde
 / 100) << 8;

463 
	`io˘l_£çÆëã
(0, 256, 
r
, 
g
, 
b
);

464 
	}
}

467 
	$gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

469 
psi
->
rows
 = 
psd
->
yvúåes
;

470 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

471 
psi
->
∂™es
 = 
psd
->planes;

472 
psi
->
bµ
 = 
psd
->bpp;

473 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

474 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

475 
psi
->
p‹åaô
 = 
psd
->portrait;

476 
psi
->
fbdrivî
 = 
TRUE
;

478 
psi
->
pixty≥
 = 
psd
->pixtype;

479 
psd
->
pixty≥
) {

480 
MWPF_TRUECOLOR8888
:

481 
MWPF_TRUECOLOR0888
:

482 
MWPF_TRUECOLOR888
:

483 
psi
->
rmask
 = 0xff0000;

484 
psi
->
gmask
 = 0x00ff00;

485 
psi
->
bmask
 = 0x0000ff;

487 
MWPF_TRUECOLOR565
:

488 
psi
->
rmask
 = 0xf800;

489 
psi
->
gmask
 = 0x07e0;

490 
psi
->
bmask
 = 0x001f;

492 
MWPF_TRUECOLOR555
:

493 
psi
->
rmask
 = 0x7c00;

494 
psi
->
gmask
 = 0x03e0;

495 
psi
->
bmask
 = 0x001f;

497 
MWPF_TRUECOLOR332
:

498 
psi
->
rmask
 = 0xe0;

499 
psi
->
gmask
 = 0x1c;

500 
psi
->
bmask
 = 0x03;

502 
MWPF_PALETTE
:

504 
psi
->
rmask
 = 0xff;

505 
psi
->
gmask
 = 0xff;

506 
psi
->
bmask
 = 0xff;

510 if(
psd
->
yvúåes
 > 480) {

512 
psi
->
xdpcm
 = 33;

513 
psi
->
ydpcm
 = 33;

514 } if(
psd
->
yvúåes
 > 350) {

516 
psi
->
xdpcm
 = 27;

517 
psi
->
ydpcm
 = 27;

518 } if(
psd
->
yvúåes
 <= 240) {

520 
psi
->
xdpcm
 = 14;

521 
psi
->
ydpcm
 = 5;

524 
psi
->
xdpcm
 = 27;

525 
psi
->
ydpcm
 = 19;

527 
	}
}

	@drivers/scr_fbsd.c

10 
	~<°dio.h
>

11 
	~<machöe/c⁄sﬁe.h
>

12 
	~<vgl.h
>

13 
	~<sig«l.h
>

14 
	~<o§ñd©e.h
>

20 
	~"devi˚.h
"

21 
	~"fb.h
"

22 
	~"gímem.h
"

23 
	~"gíf⁄t.h
"

25 #i‚de‡
SCREEN_WIDTH


26 
	#SCREEN_WIDTH
 800

	)

29 #i‚de‡
SCREEN_HEIGHT


30 
	#SCREEN_HEIGHT
 600

	)

33 #i‚de‡
SCREEN_DEPTH


34 
	#SCREEN_DEPTH
 8

	)

38 #i‚de‡
MWPIXEL_FORMAT


39 
	#MWPIXEL_FORMAT
 
MWPF_PALETTE


	)

42 #i‡
ALPHABLEND


53 *
	gÆpha_to_rgb
 = 
NULL
;

54 *
	grgb_to_∑lödex
 = 
NULL
;

55 
öô_Æpha_lookup
();

58 
SCREENDEVICE
 
	gßvebôs
;

60 
PSD
 
FBSD_›í
(PSD 
psd
);

61 
FBSD_˛o£
(
PSD
 
psd
);

62 
FBSD_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

63 
FBSD_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

64 
FBSD_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

65 
MWPIXELVAL
 
FBSD_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

66 
FBSD_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

67 
FBSD_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
);

68 
FBSD_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

70 
FBSD_¥e£À˘
(
PSD
 
psd
);

71 
FBSD_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,

72 
MWCOORD
 
w
,MWCOORD 
h
,

73 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
, 
›
);

75 
FBSD_blô2
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,

76 
MWCOORD
 
w
,MWCOORD 
h
,

77 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
, 
›
);

80 
SCREENDEVICE
 
	gs¸dev
 = {

81 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

82 
FBSD_›í
,

83 
FBSD_˛o£
,

84 
FBSD_gës¸ìnöfo
,

85 
FBSD_£çÆëã
,

86 
FBSD_døwpixñ
,

87 
FBSD_ªadpixñ
,

88 
FBSD_døwhlöe
,

89 
FBSD_døwvlöe
,

90 
FBSD_fûÃe˘
,

91 
gí_f⁄ts
,

92 
FBSD_blô2
,

93 
FBSD_¥e£À˘
,

94 
NULL
,

95 
NULL
,

96 
gí_Æloˇãmemgc
,

97 
fb_m≠memgc
,

98 
gí_‰ìmemgc


101 
	$FBSD_h™dÀ_evít
()

103 
	`VGLCheckSwôch
();

104 
	}
}

106 
	$FBSD_˛o£
(
PSD
 
psd
)

108 
	`VGLEnd
();

109 
	}
}

111 
PSD
 
	$FBSD_›í
(
PSD
 
psd
)

113 
PSUBDRIVER
 
subdrivî
;

114 
size
, 
löñí
;

116 i‡(
	`gëeuid
() != 0)

118 
	`Ârötf
(
°dîr
, "The current graphics consoleárchitecture ");

119 
	`Ârötf
(
°dîr
, "onlyÖermits super-userÅoáccess it, ");

120 
	`Ârötf
(
°dîr
, "therefore youÉither haveÅo obtain such ");

121 
	`Ârötf
(
°dîr
, "permissions orásk your sysadminÅoÖut ");

122 
	`Ârötf
(
°dîr
, "set-user-id on");

123 
	`exô
(1);

128 i‡(
	`VGLInô
(
SW_VESA_CG800x600
) != 0)

130 
	`Ârötf
(
°dîr
, "WARNING! CouldÇot initialise VESA mode. ");

131 
	`Ârötf
(
°dîr
, "TryingÅo fallbackÅoÅhe VGA 640x480 mode\n");

132 
	`≥º‹
("microwin");

134 i‡(
	`VGLInô
(
SW_CG640x480
) != 0)

136 
	`Ârötf
(
°dîr
, "WARNING! CouldÇot initialise VGA mode ");

137 
	`Ârötf
(
°dîr
, "either. Please check your kernel.\n");

138 
	`≥º‹
("microwin");

139  
NULL
;

144 
psd
 -> 
xªs
 =Ösd->
xvúåes
 = 
VGLDi•œy
->
Xsize
;

145 
psd
 -> 
yªs
 =Ösd->
yvúåes
 = 
VGLDi•œy
->
Ysize
;

146 
psd
 -> 
löñí
 = 
VGLDi•œy
->
Xsize
;

147 
psd
 -> 
∂™es
 = 1;

148 
psd
 -> 
pixty≥
 = 
MWPIXEL_FORMAT
;

149 
psd
 -> 
bµ
 = 8;

172 
psd
->
ncﬁ‹s
 = 256;

173 
psd
->
size
 = 0;

174 
psd
->
addr
 = 
NULL
;

175 
psd
->
Êags
 = 
PSF_SCREEN
|
PSF_HAVEBLIT
;

177 
ßvebôs
=*
psd
;

178 
ßvebôs
.
Êags
=
PSF_MEMORY
 | 
PSF_HAVEBLIT
;

180 
subdrivî
 = 
	`£À˘_fb_subdrivî
(&
ßvebôs
);

181 i‡(!
subdrivî
)

183 
	`Ârötf
(
°dîr
,"Subdriverállocation failed!\n");

184  
NULL
;

187 
	`GdCÆcMemGCAŒoc
(&
ßvebôs
, savebôs.
xvúåes
, savebôs.
yvúåes
,

188 0, 0, &
size
, &
löñí
);

190 
ßvebôs
.
löñí
 =Üinelen;

191 
ßvebôs
.
size
 = size;

192 i‡((
ßvebôs
.
addr
 = 
	`mÆloc
(
size
)Ë=
NULL
)

194 
	`Ârötf
(
°dîr
,"MÆlo¯f‹ %d Faûed!\n",
size
);

195  
NULL
;

198 
	`£t_subdrivî
(&
ßvebôs
, 
subdrivî
, 
TRUE
);

199  
psd
;

200 
	}
}

202 
	$FBSD_gës¸ìnöfo
(
PSD
 
psd
, 
PMWSCREENINFO
 
psi
)

204 
psi
->
rows
 = 
psd
->
yvúåes
;

205 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

206 
psi
->
∂™es
 = 
psd
->planes;

207 
psi
->
bµ
 = 
psd
->bpp;

208 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

209 
psi
->
pixty≥
 = 
psd
->pixtype;

210 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

211 if(
psd
->
yvúåes
 > 480)

214 
psi
->
xdpcm
 = 33;

215 
psi
->
ydpcm
 = 33;

217 if(
psd
->
yvúåes
 > 350)

220 
psi
->
xdpcm
 = 27;

221 
psi
->
ydpcm
 = 27;

226 
psi
->
xdpcm
 = 27;

227 
psi
->
ydpcm
 = 19;

229 
	}
}

231 
	$FBSD_£çÆëã
(
PSD
 
psd
, 
fú°
, 
cou¡
,

232 
MWPALENTRY
 *
∑l
)

234 
fú°
 < 256 && 
cou¡
-- > 0)

236 
	`VGLSëPÆëãIndex
(
fú°
++, 
∑l
->
r
>>2,ÖÆ->
g
>>2,ÖÆ->
b
>>2);

237 ++
∑l
;

240 
	}
}

242 
	$FBSD_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

244 
	`VGLSëXY
(
VGLDi•œy
, 
x
, 
y
, ()
c
);

245 
ßvebôs
.
	`DøwPixñ
(&ßvebôs, 
x
, 
y
, 
c
);

246 
	}
}

248 
MWPIXELVAL
 
	$FBSD_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

250  
ßvebôs
.
	`RódPixñ
(&ßvebôs,
x
,
y
);

252 
	}
}

254 
	$FBSD_døwhlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
,

255 
MWCOORD
 
y
, 
MWPIXELVAL
 
c
)

257 
	`VGLLöe
(
VGLDi•œy
, 
x1
, 
y
, 
x2
, y, 
c
);

258 
ßvebôs
.
	`DøwH‹zLöe
(&ßvebôs,
x1
,
x2
,
y
,
c
);

259 
	}
}

261 
	$FBSD_døwvlöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
,

262 
MWCOORD
 
y2
, 
MWPIXELVAL
 
c
)

264 
	`VGLLöe
(
VGLDi•œy
, 
x
, 
y1
, x, 
y2
, ()
c
);

265 
ßvebôs
.
	`DøwVîtLöe
(&ßvebôs,
x
, 
y1
, 
y2
, 
c
);

266 
	}
}

268 
	$FBSD_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

270 
	`VGLFûÀdBox
(
VGLDi•œy
,
x1
, 
y1
, 
x2
, 
y2
, ()
c
);

271 
ßvebôs
.
	`FûlRe˘
(&ßvebôs,
x1
, 
y1
, 
x2
, 
y2
, 
c
);

272 
	}
}

274 
	$FBSD_¥e£À˘
(
PSD
 
psd
)

276 
	`VGLCheckSwôch
();

277 
	}
}

282 
	$FBSD_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,

283 
MWCOORD
 
w
,MWCOORD 
h
,

284 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
, 
›
)

287 
x
, 
y
;

289 i‡(
d°psd
 =
§˝sd
)

291 if(
d°psd
->
Êags
 & 
PSF_SCREEN
)

293 
	`VGLBôm≠C›y
(
VGLDi•œy
, 
§cx
, 
§cy
, VGLDisplay,

294 
de°x
, 
de°y
, 
w
, 
h
);

295 
ßvebôs
.
	`Blô
(&ßvebôs, 
de°x
, 
de°y
, 
w
, 
h
,

296 &
ßvebôs
, 
§cx
, 
§cy
, 
›
);

301 
d°psd
->
	`Blô
(d°psd, 
de°x
, 
de°y
, 
w
, 
h
, 
§˝sd
, 
§cx
, 
§cy
, 
›
);

304 i‡(
d°psd
->
Êags
 & 
PSF_SCREEN
)

306 
VGLBôm≠
 *
bôm≠
;

308 
bôm≠
=
	`VGLBôm≠Cª©e
(
MEMBUF
 , 
w
, 
h
, 
NULL
);

309 
	`VGLBôm≠AŒoˇãBôs
(
bôm≠
);

310 
y
 = 0; y < 
h
; y++)

312 
x
 = 0; x < 
w
; x++)

314 
MWPIXELVAL
 
c
 = 
§˝sd
->
	`RódPixñ
(§˝sd,
§cx
+
x
,
§cy
+
y
);

315 
	`VGLSëXY
(
bôm≠
, 
x
, 
y
, 
c
);

317 
ßvebôs
.
	`DøwPixñ
(&ßvebôs, 
de°x
+
x
, 
de°y
+
y
, 
c
);

320 
	`VGLBôm≠C›y
(
bôm≠
, 
§cx
, 
§cy
, 
VGLDi•œy
,

321 
de°x
, 
de°y
, 
w
, 
h
);

322 
	`VGLBôm≠De°roy
(
bôm≠
);

324 i‡(
§˝sd
->
Êags
 & 
PSF_SCREEN
)

326 
y
 = 0; y < 
h
; y++)

328 
x
 = 0; x < 
w
; x++)

330 
MWPIXELVAL
 
c
 = 
§˝sd
->
	`RódPixñ
(§˝sd,
§cx
+
x
,
§cy
+
y
);

331 
d°psd
->
	`DøwPixñ
(d°psd, 
de°x
+
x
, 
de°y
+
y
, 
c
);

335 
	}
}

339 
	$FBSD_blô2
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

340 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

342 #i‡
ALPHABLEND


344 
§ˇÕha
, 
d°Æpha
;

346 if((
›
 & 
MWROP_EXTENSION
Ë!
MWROP_BLENDCONSTANT
)

347 
°dblô
;

348 
§ˇÕha
 = 
›
 & 0xff;

351 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
)

353 
	`öô_Æpha_lookup
();

354 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
)

355 
°dblô
;

361 
d°Æpha
 = ((
§ˇÕha
>>3) ^ 31) << 8;

362 
§ˇÕha
 = (srcalpha>>3) << 8;

364 --
h
 >= 0)

366 
i
;

367 
i
=0; i<
w
; ++i)

369 
c
;

371 
s
 = 
Æpha_to_rgb
[
§ˇÕha
 +

372 
§˝sd
->
	`RódPixñ
(

373 
§˝sd
,
§cx
+
i
,
§cy
+
h
)];

376 
d
 = 
Æpha_to_rgb
[
d°Æpha
 +

377 
d°psd
->
	`RódPixñ
(

378 
§˝sd
,
d°x
+
i
,
d°y
+
h
)];

381 
	`VGLSëXY
(
VGLDi•œy
, 
d°x
+
i
, 
d°y
+
h
,

382 
c
=
rgb_to_∑lödex
[
s
 + 
d
]);

383 
ßvebôs
.
	`DøwPixñ
(&ßvebôs, 
d°x
+
i
, 
d°y
+
h
, 
c
);

387 
°dblô
:

389 
	`FBSD_blô
(
d°psd
, 
d°x
, 
d°y
, 
w
, 
h
, 
§˝sd
, 
§cx
, 
§cy
, 
›
);

390 
	}
}

393 #i‡
ALPHABLEND


394 
	$öô_Æpha_lookup
()

396 
i
, 
a
;

397 
r
, 
g
, 
b
;

398 
MWPALENTRY
 
gr_∑Àâe
[256];

400 if(!
Æpha_to_rgb
)

401 
Æpha_to_rgb
 = (*)
	`mÆloc
(

403 if(!
rgb_to_∑lödex
)

404 
rgb_to_∑lödex
 = (*)
	`mÆloc
(

406 if(!
rgb_to_∑lödex
 || !
Æpha_to_rgb
)

414 
i
=0; i<256; ++i) {

415 
MWPALENTRY
 *
p
 = &
gr_∑Àâe
[
i
];

416 
a
=0;á<32; ++a) {

417 
Æpha_to_rgb
[(
a
<<8)+
i
] =

418 (((
p
->
r
 * 
a
 / 31)>>3) << 10) |

419 (((
p
->
g
 * 
a
 / 31)>>3) << 5) |

420 ((
p
->
b
 * 
a
 / 31)>>3);

428 
r
=0;Ñ<32; ++r) {

429 
g
=0; g<32; ++g)

430 
b
=0; b<32; ++b)

431 
rgb_to_∑lödex
[ (
r
<<10)|(
g
<<5)|
b
] =

432 
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
, 256,

433 
	`MWRGB
(
r
<<3, 
g
<<3, 
b
<<3));

435 
	}
}

	@drivers/scr_herc.c

17 #i‡
ELKS


18 
	~<löuxmt/¡ty.h
>

20 
	~<°dio.h
>

21 
	~"devi˚.h
"

22 
	~"vg≠œn4.h
"

23 
	~"romf⁄t.h
"

26 
	#SCREENADDR
(
off£t
Ë
	`MK_FP
(0xb000, (off£t))

	)

28 
	#SCREEN_ON
 8

	)

29 
	#BLINKER_ON
 0x20

	)

32 
PSD
 
HERC_›í
(PSD 
psd
);

33 
HERC_˛o£
(
PSD
 
psd
);

34 
HERC_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);;

35 
HERC_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

36 
HERC_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

37 
MWPIXELVAL
 
HERC_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

38 
HERC_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

39 
HERC_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
);

40 
HERC_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

41 
MWPIXELVAL
 
c
);

42 
HERC_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

43 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
);

44 
PSD
 
HERC_Æloˇãmemgc
(PSD 
psd
);

46 
SCREENDEVICE
 
	gs¸dev
 = {

47 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

48 
HERC_›í
,

49 
HERC_˛o£
,

50 
HERC_gës¸ìnöfo
,

51 
HERC_£çÆëã
,

52 
HERC_døwpixñ
,

53 
HERC_ªadpixñ
,

54 
HERC_døwhlöe
,

55 
HERC_døwvlöe
,

56 
HERC_fûÃe˘
,

57 
p¸om_f⁄ts
,

58 
HERC_blô
,

59 
NULL
,

60 
NULL
,

61 
NULL
,

62 
HERC_Æloˇãmemgc
,

63 
NULL
,

64 
NULL


67 
PSD


68 
	$HERC_›í
(
PSD
 
psd
)

70 #i‡
HAVEIOPERM


72 if(
	`i›îm
(0x3b4, 0x0d, 1))

73  
NULL
;

75 #i‡
ELKS


77 if(
	`io˘l
(0, 
DCGET_GRAPH
) != 0)

78  
NULL
;

82 
	`ouç‹tb
(0x3bf, 1+2);

83 
	`ouç‹tb
(0x3b8, 0);

84 
	`ouç‹t
(0x3b4, 0x3500);

85 
	`ouç‹t
(0x3b4, 0x2d01);

86 
	`ouç‹t
(0x3b4, 0x2e02);

87 
	`ouç‹t
(0x3b4, 0x0703);

88 
	`ouç‹t
(0x3b4, 0x5b04);

89 
	`ouç‹t
(0x3b4, 0x0205);

90 
	`ouç‹t
(0x3b4, 0x5706);

91 
	`ouç‹t
(0x3b4, 0x5707);

92 
	`ouç‹t
(0x3b4, 0x0309);

93 
	`ouç‹tb
(0x3b8, 2+8);

96 
psd
->
xªs
 =Ösd->
xvúåes
 = 720;

97 
psd
->
yªs
 =Ösd->
yvúåes
 = 350;

98 
psd
->
∂™es
 = 1;

99 
psd
->
bµ
 = 1;

100 
psd
->
ncﬁ‹s
 = 2;

101 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

102 
psd
->
Êags
 = 
PSF_SCREEN
;

103 
psd
->
addr
 = 
	`SCREENADDR
(0);

104 
psd
->
löñí
 = 90;

107 
	`p¸om_öô
(
psd
);

109  
psd
;

110 
	}
}

113 
	$HERC_˛o£
(
PSD
 
psd
)

115 
i
;

116 vﬁ©ûê
FARADDR
 
d°
;

117 
hîc_txt_tbl
[12]= {

121 #i‡
ELKS


123 
	`io˘l
(0, 
DCREL_GRAPH
);

127 
	`ouç‹tb
(0x3bf, 0);

128 
	`ouç‹tb
(0x3b8, 0);

130 
i
 = 0; i < 12; ++i) {

131 
	`ouç‹tb
(0x3b4, 
i
);

132 
	`ouç‹tb
(0x3b5, 
hîc_txt_tbl
[
i
]);

136 
d°
 = 
	`SCREENADDR
(0);

137 
i
 = 0; i <= 0x3fff; ++i) {

138 
	`PUTBYTE_FP
(
d°
++, 0x00);

139 
	`PUTBYTE_FP
(
d°
++, 0x07);

141 
	`ouç‹tb
(0x3b8, 
BLINKER_ON
 | 
SCREEN_ON
);

142 
	}
}

145 
	$HERC_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

147 
psi
->
rows
 = 
psd
->
yvúåes
;

148 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

149 
psi
->
∂™es
 = 
psd
->planes;

150 
psi
->
bµ
 = 
psd
->bpp;

151 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

152 
psi
->
pixty≥
 = 
psd
->pixtype;

153 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

154 
psi
->
xdpcm
 = 30;

155 
psi
->
ydpcm
 = 19;

156 
	}
}

159 
	$HERC_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

162 
	}
}

165 
	$HERC_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

167 
off£t
;

168 
mask
 = 128;

169 vﬁ©ûê
FARADDR
 
d°
;

171 
off£t
 = 0x2000 * (
y
&3);

172 
off£t
 +90*(
y
/4Ë+ 
x
/8;

173 
d°
 = 
	`SCREENADDR
(
off£t
);

174 
mask
 >>
x
 & 7;

175 if(
c
)

176 
	`ORBYTE_FP
(
d°
, 
mask
);

177 
	`ANDBYTE_FP
(
d°
, ~
mask
);

178 
	}
}

180 
MWPIXELVAL


181 
	$HERC_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

183 
off£t
;

184 
mask
 = 128;

185 vﬁ©ûê
FARADDR
 
d°
;

187 
off£t
 = 0x2000 * (
y
&3);

188 
off£t
 +90*(
y
/4Ë+ 
x
/8;

189 
d°
 = 
	`SCREENADDR
(
off£t
);

190 
mask
 >>
x
 & 7;

191  
	`GETBYTE_FP
(
d°
Ë& 
mask
? 1: 0;

192 
	}
}

195 
	$HERC_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

198 
rowoff£t
, 
x1yoff£t
, 
x2yoff£t
;

199 
°¨tbyã
, 
ídbyã
;

200 vﬁ©ûê
FARADDR
 
d°
;

203 
rowoff£t
 = 8192 * (
y
 % 4) + (y / 4) * 90;

206 
x1yoff£t
 = 
rowoff£t
 + (
x1
 / 8);

209 
x2yoff£t
 = 
rowoff£t
 + (
x2
 / 8);

213 
°¨tbyã
 = 0xf‡>> (
x1
 % 8);

218 
d°
 = 
	`SCREENADDR
(
x1yoff£t
);

220 if(
c
)

221 
	`ORBYTE_FP
(
d°
, 
°¨tbyã
);

222 
	`ANDBYTE_FP
(
d°
, ~
°¨tbyã
);

224 
x1yoff£t
++;

225 
x1yoff£t
 < 
x2yoff£t
) {

226 
d°
 = 
	`SCREENADDR
(
x1yoff£t
);

227 if(
c
)

228 
	`ORBYTE_FP
(
d°
, 0xff);

229 
	`ANDBYTE_FP
(
d°
, ~0xff);

230 
x1yoff£t
++;

233 
d°
 = 
	`SCREENADDR
(
x2yoff£t
);

234 if(
c
)

235 
	`ORBYTE_FP
(
d°
, 
ídbyã
);

236 
	`ANDBYTE_FP
(
d°
, ~
ídbyã
);

243 
	}
}

246 
	$HERC_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

252 
y1
 <
y2
)

253 
	`HERC_døwpixñ
(
x
, 
y1
++, 
c
);

254 
	}
}

257 
	$HERC_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

259 
y1
 <
y2
)

260 
	`HERC_døwhlöe
(
x1
, 
x2
, 
y1
++, 
c
);

261 
	}
}

264 
	$HERC_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

265 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

268 
	}
}

271 
PSD


272 
	$HERC_Æloˇãmemgc
(
PSD
 
psd
)

275  
NULL
;

276 
	}
}

	@drivers/scr_prsm.c

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~"devi˚.h
"

27 #ifde‡
_MINIX


28 
	~<sys/ty≥s.h
>

30 
	~"gíf⁄t.h
"

31 
	~"gímem.h
"

33 
	#MY_PSD_ADDR
 0x01000000

	)

36 
PSD
 
VB_›í
(PSD 
psd
);

37 
VB_˛o£
(
PSD
 
psd
);

38 
VB_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);;

39 
VB_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

40 
VB_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

41 
MWPIXELVAL
 
VB_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

42 
VB_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
,

43 
MWPIXELVAL
 
c
);

44 
VB_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

45 
VB_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

46 
MWPIXELVAL
 
c
);

47 
VB_blô
(
PSD
 
de°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

48 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
);

51 
öô_s¸
();

52 
c_pcm≠
(
˙t
, *
m≠
);

53 
c_ldøw4
(
x1
, 
y1
, 
x2
, 
y2
, 
öãn
, 
£l
);

55 
c_ldøw5y
(
x1
, 
y1
, 
x2
, 
y2
, 
öãn
);

56 
c_ldøw5x
(
x1
, 
y1
, 
x2
, 
y2
, 
öãn
);

57 
r1pix3
(
x
, 
y
, 
£lmask
);

58 
rd_ª˘2
(
x1
, 
x2
, 
y1
, 
y2
, *
buf
);

59 
w1pix3
(
x
, 
y
, 
£lmask
, 
pixd©a
);

60 
wr_ª˘2
(
x1
, 
x2
, 
y1
, 
y2
, *
buf
);

63 
MWBOOL
 
VB_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,

64 
löñí
,
size
,*
addr
);

67 
SCREENDEVICE
 
	gs¸dev
 = {

68 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

69 
VB_›í
,

70 
VB_˛o£
,

71 
VB_gës¸ìnöfo
,

72 
VB_£çÆëã
,

73 
VB_døwpixñ
,

74 
VB_ªadpixñ
,

75 
VB_døwhlöe
,

76 
VB_døwvlöe
,

77 
VB_fûÃe˘
,

78 
gí_f⁄ts
,

79 
VB_blô
,

80 
NULL
,

81 
NULL
,

82 
NULL
,

83 
gí_Æloˇãmemgc
,

84 
VB_m≠memgc
,

85 
gí_‰ìmemgc


88 *
	g¥_cm≠
;

90 
PSD


91 
	$VB_›í
(
PSD
 
psd
)

94 i‡((
¥_cm≠
 = (*)
	`mÆloc
((
size_t
)(256 * ()))Ë=
NULL
) {

95 
	`≥º‹
("malloc cmap");

98 
	`mem£t
(
¥_cm≠
, 0, (256 * ()));

101 
psd
->
xªs
 =Ösd->
xvúåes
 = 1280;

102 
psd
->
yªs
 =Ösd->
yvúåes
 = 1024;

103 
psd
->
∂™es
 = 1;

104 
psd
->
bµ
 = 8;

105 
psd
->
ncﬁ‹s
 = 256;

106 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

107 #i‡
HAVEBLIT


108 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

110 
psd
->
Êags
 = 
PSF_SCREEN
;

112 
psd
->
addr
 = (*)
MY_PSD_ADDR
;

113 
psd
->
löñí
 = 1280;

114 
	`öô_s¸
();

115 
	`¥ötf
("VB_open: finished open\n");

116  
psd
;

117 
	}
}

120 
	$VB_˛o£
(
PSD
 
psd
)

124 
	}
}

127 
	$VB_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

129 
psi
->
rows
 = 
psd
->
yvúåes
;

130 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

131 
psi
->
∂™es
 = 
psd
->planes;

132 
psi
->
bµ
 = 
psd
->bpp;

133 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

134 
psi
->
pixty≥
 = 
psd
->pixtype;

135 
psi
->
f⁄ts
 = 1;

138 
psi
->
xdpcm
 = 40;

139 
psi
->
ydpcm
 = 43;

140 
	}
}

143 
	$VB_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

145 
i
, 
öd
;

146 
MWPALENTRY
 *
p
;

148 
öd
 = 
fú°
;

149 
i
 = 0; i < 
cou¡
; i++) {

150 
p
 = &
∑l
[
i
];

151 i‡(
öd
 > 255) {

152 
	`Ârötf
(
°dîr
, "VB_£çÆëã: index ouào‡ønge: %d\n", 
öd
);

155 *(
¥_cm≠
 + 
öd
Ë(öd << 24Ë| (
p
->
r
 << 16Ë| (p->
g
 << 8) |

156 (
p
->
b
);

157 
öd
++;

168 
öd
 = 
fú°
;

169 
cou¡
) {

170 i‡(
cou¡
 >= 16) {

171 
	`c_pcm≠
(16, (
¥_cm≠
 + 
öd
));

172 
cou¡
 -= 16;

173 
öd
 += 16;

175 
	`c_pcm≠
(
cou¡
, (
¥_cm≠
 + 
öd
));

176 
cou¡
 = 0;

180 
	}
}

183 
	$VB_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

185 
	`w1pix3
(
x
, 
y
, 255, ()
c
);

186 
	}
}

188 
MWPIXELVAL


189 
	$VB_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

191 ((
MWPIXELVAL
)
	`r1pix3
(
x
, 
y
, 255));

192 
	}
}

196 
	$VB_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

199 
y
 = 1023 - y;

200 
	`c_ldøw4
(
x1
, 
y
, 
x2
, y, ()
c
, 255);

201 
	}
}

205 
	$VB_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

208 
y1
 = 1023 - y1;

209 
y2
 = 1023 - y2;

210 
	`c_ldøw4
(
x
, 
y1
, x, 
y2
, ()
c
, 255);

211 
	}
}

214 
	$VB_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

216 
w
, 
h
;

218 
w
 = ((
x2
 - 
x1
) >= 0) ? (x2 - x1) : (x1 - x2);

219 
h
 = ((
y2
 - 
y1
) >= 0) ? (y2 - y1) : (y1 - y2);

221 i‡((
w
 > 1279Ë|| (
h
 > 1023))

223 
y1
 = 1023 - y1;

224 
y2
 = 1023 - y2;

225 i‡(
w
 >
h
) {

228 
y2
 <
y1
) {

229 
	`c_ldøw4
(
x1
, 
y2
, 
x2
, y2, ()
c
, 255);

230 
y2
++;

233 
	`c_ldøw5y
(
x1
, 
y2
, 
x2
, 
y1
, ()
c
);

237 
x1
 <
x2
) {

238 
	`c_ldøw4
(
x1
, 
y2
, x1, 
y1
, ()
c
, 255);

239 
x1
++;

242 
	`c_ldøw5x
(
x1
, 
y2
, 
x2
, 
y1
, ()
c
);

244 
	}
}

250 
	$VB_blô
(
PSD
 
de°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

251 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

253 
x1s
, 
x1e
, 
x2s
, 
x2e
, 
y1s
, 
y1e
, 
y2s
, 
y2e
;

254 *
ª˘
;

257 i‡((
ª˘
 = (*)
	`mÆloc
((
size_t
)(
w
 * 
h
 * ())))

258 =
NULL
) {

259 
	`≥º‹
("mallocÑect");

263 
x1s
 = (
w
 >0Ë? 
§cx
 : (srcx + w);

264 
x2s
 = (
w
 >0Ë? 
de°x
 : (destx + w);

265 
x1e
 = (
w
 >0Ë? (
§cx
 + w) : srcx;

266 
x2e
 = (
w
 >0Ë? (
de°x
 + w) : destx;

267 
y1s
 = (
h
 >0Ë? 
§cy
 : (srcy + h);

268 
y2s
 = (
h
 >0Ë? 
de°y
 : (desty + h);

269 
y1e
 = (
h
 >0Ë? (
§cy
 + h) : srcy;

270 
y2e
 = (
h
 >0Ë? (
de°y
 + h) : desty;

273 i‡((
§˝sd
->
addr
 =
MY_PSD_ADDR
Ë&& (
de°psd
->addr == MY_PSD_ADDR)) {

276 
	`rd_ª˘2
(
x1s
, 
y1s
, 
x1e
, 
y1e
, 
ª˘
);

278 
	`wr_ª˘2
(
x2s
, 
y2s
, 
x2e
, 
y2e
, 
ª˘
);

279 } i‡(
§˝sd
->
addr
 =
MY_PSD_ADDR
) {

281 } i‡(
de°psd
->
addr
 =
MY_PSD_ADDR
) {

285 
	`¥ötf
("VB_blit withÇo screen!\n");

287 
	`‰ì
(
ª˘
);

288 
	}
}

290 
MWBOOL


291 
	$VB_m≠memgc
(
PSD
 
mempsd
,
MWCOORD
 
w
,MWCOORD 
h
,
∂™es
,
bµ
,
löñí
,

292 
size
,*
addr
)

295 
	}
}

	@drivers/scr_pspfb.c

1 
	~<p•ty≥s.h
>

2 
	~<p•di•œy.h
>

3 
	~<p•ge.h
>

4 
	~<as£π.h
>

5 
	~"devi˚.h
"

6 
	~"fb.h
"

7 
	~"gíf⁄t.h
"

8 
	~"gímem.h
"

10 
PSD
 
fb_›í
(PSD 
psd
);

11 
fb_˛o£
(
PSD
 
psd
);

12 
fb_£ç‹åaô
(
PSD
 
psd
, 
p‹åaômode
);

14 
gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

17 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


19 
	#PIXELMODE
 1

	)

20 
	#LINESIZE
 512

	)

21 
	#FRAMESIZE
 0x44000

	)

23 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR8888


25 
	#PIXELMODE
 3

	)

26 
	#LINESIZE
 512

	)

27 
	#FRAMESIZE
 0x88000

	)

31 
	#PSP_XRES
 480

	)

32 
	#PSP_YRES
 272

	)

36 
	g°©us
;

38 
SUBDRIVER
 
fbp‹åaô_À·
, 
fbp‹åaô_right
, 
fbp‹åaô_down
;

39 
PSUBDRIVER
 
	gpdrivîs
[4] = {

40 
NULL
, &
fbp‹åaô_À·
, &
fbp‹åaô_right
, &
fbp‹åaô_down


43 
SCREENDEVICE
 
	gs¸dev
 = {

44 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

45 
fb_›í
,

46 
fb_˛o£
,

47 
gí_gës¸ìnöfo
,

48 
NULL
,

49 
NULL
,

50 
NULL
,

51 
NULL
,

52 
NULL
,

53 
NULL
,

54 
gí_f⁄ts
,

55 
NULL
,

56 
NULL
,

57 
NULL
,

58 
NULL
,

59 
gí_Æloˇãmemgc
,

60 
NULL
,

61 
gí_‰ìmemgc
,

62 
NULL
,

63 
fb_£ç‹åaô


66 
PSD


67 
	$fb_›í
(
PSD
 
psd
)

73 
PSUBDRIVER
 
subdrivî
=
	`£À˘_fb_subdrivî
(
psd
);

75 
	`as£π
(
°©us
 < 2);

77 
psd
->
xªs
 =Ösd->
xvúåes
 = 
PSP_XRES
;

78 
psd
->
yªs
 =Ösd->
yvúåes
 = 
PSP_YRES
;

79 
psd
->
∂™es
 = 1;

81 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


82 
psd
->
bµ
 = 16;

83 
psd
->
ncﬁ‹s
 = 1<<15;

84 
psd
->
pixty≥
=
MWPF_TRUECOLOR555
;

85 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR8888


86 
psd
->
bµ
 = 32;

87 
psd
->
ncﬁ‹s
 = 1<<31;

88 
psd
->
pixty≥
=
MWPF_TRUECOLOR8888
;

90 
Áû
;

93 
psd
->
löñí
 = 
LINESIZE
;

94 
psd
->
size
 = 
FRAMESIZE
;

95 
psd
->
addr
 = (*Ë(0x40000000 | 
	`s˚GeEdømGëAddr
());

97 
psd
->
p‹åaô
 = 
MWPORTRAIT_NONE
;

99 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

100 i‡(
psd
->
bµ
 == 16)

101 
psd
->
Êags
 |
PSF_HAVEOP_COPY
;

103 if(!
	`£t_subdrivî
(
psd
, 
subdrivî
, 
TRUE
)) {

106 
Áû
;

109 
pdrivîs
[0] = 
psd
->
‹gsubdrivî
 = 
subdrivî
;

111 
	`s˚Di•œySëMode
(0,
PSP_XRES
,
PSP_YRES
);

112 
	`s˚Di•œySëFømeBuf
(
psd
->
addr
,
LINESIZE
,
PIXELMODE
,1);

114 
°©us
 = 2;

115  
psd
;

117 
Áû
:

118  
NULL
;

119 
	}
}

123 
	$fb_˛o£
(
PSD
 
psd
)

126 if(
°©us
 != 2)

128 
°©us
 = 1;

130 
	`s˚Di•œySëFømeBuf
(0,0,0,1);

131 
	}
}

135 
	$fb_£ç‹åaô
(
PSD
 
psd
, 
p‹åaômode
)

137 
psd
->
p‹åaô
 = 
p‹åaômode
;

140 i‡(
p‹åaômode
 & (
MWPORTRAIT_LEFT
|
MWPORTRAIT_RIGHT
)) {

142 
psd
->
xvúåes
 =Ösd->
yªs
;

143 
psd
->
yvúåes
 =Ösd->
xªs
;

146 
psd
->
xvúåes
 =Ösd->
xªs
;

147 
psd
->
yvúåes
 =Ösd->
yªs
;

150 i‡(
p‹åaômode
 =
MWPORTRAIT_DOWN
)

151 
p‹åaômode
 = 3;

152 
	`£t_subdrivî
(
psd
, 
pdrivîs
[
p‹åaômode
], 
FALSE
);

153 
	}
}

156 
	$gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

158 
psi
->
rows
 = 
psd
->
yvúåes
;

159 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

160 
psi
->
∂™es
 = 
psd
->planes;

161 
psi
->
bµ
 = 
psd
->bpp;

162 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

163 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

164 
psi
->
p‹åaô
 = 
psd
->portrait;

165 
psi
->
fbdrivî
 = 
TRUE
;

167 
psi
->
pixty≥
 = 
psd
->pixtype;

168 
psd
->
pixty≥
) {

169 
MWPF_TRUECOLOR8888
:

170 
MWPF_TRUECOLOR0888
:

171 
MWPF_TRUECOLOR888
:

172 
psi
->
rmask
 = 0xff0000;

173 
psi
->
gmask
 = 0x00ff00;

174 
psi
->
bmask
 = 0x0000ff;

176 
MWPF_TRUECOLOR565
:

177 
psi
->
rmask
 = 0xf800;

178 
psi
->
gmask
 = 0x07e0;

179 
psi
->
bmask
 = 0x001f;

181 
MWPF_TRUECOLOR555
:

182 
psi
->
rmask
 = 0x7c00;

183 
psi
->
gmask
 = 0x03e0;

184 
psi
->
bmask
 = 0x001f;

186 
MWPF_TRUECOLOR332
:

187 
psi
->
rmask
 = 0xe0;

188 
psi
->
gmask
 = 0x1c;

189 
psi
->
bmask
 = 0x03;

191 
MWPF_PALETTE
:

193 
psi
->
rmask
 = 0xff;

194 
psi
->
gmask
 = 0xff;

195 
psi
->
bmask
 = 0xff;

199 
psi
->
xdpcm
=39;

200 
psi
->
ydpcm
=39;

201 
	}
}

203 
PSUBDRIVER


204 
	$£À˘_fb_subdrivî
(
PSD
 
psd
)

207 
SUBDRIVER
 
fblöór16
;

208 
SUBDRIVER
 
fblöór32Æpha
;

210 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


211  &
fblöór16
;

212 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR8888


213  &
fblöór32Æpha
;

215  
NULL
;

217 
	}
}

	@drivers/scr_rtems.c

10 
	#_GNU_SOURCE
 1

	)

11 
	~<as£π.h
>

12 
	~<sys/time.h
>

13 
	~<sys/ty≥s.h
>

14 
	~<uni°d.h
>

15 
	~<°dio.h
>

16 
	~<f˙é.h
>

17 
	~<limôs.h
>

18 
	~<°d¨g.h
>

19 
	~<°dlib.h
>

20 
	~"devi˚.h
"

21 
	~"gíf⁄t.h
"

22 
	~"gímem.h
"

23 
	~"fb.h
"

24 
	~<πems/mw_fb.h
>

26 #i‚de‡
FB_TYPE_VGA_PLANES


27 
	#FB_TYPE_VGA_PLANES
 4

	)

30 
PSD
 
fb_›í
(PSD 
psd
);

31 
fb_˛o£
(
PSD
 
psd
);

32 
fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
);

33 
gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

35 
SCREENDEVICE
 
	gs¸dev
 = {

36 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

37 
fb_›í
,

38 
fb_˛o£
,

39 
gí_gës¸ìnöfo
,

40 
fb_£çÆëã
,

41 
NULL
,

42 
NULL
,

43 
NULL
,

44 
NULL
,

45 
NULL
,

46 
gí_f⁄ts
,

47 
NULL
,

48 
NULL
,

49 
NULL
,

50 
NULL
,

51 
gí_Æloˇãmemgc
,

52 
fb_m≠memgc
,

53 
gí_‰ìmemgc


57 
	gfb
;

58 
	g°©us
;

59 
	gßved_ªd
[16];

60 
	gßved_gªí
[16];

61 
	gßved_blue
[16];

64 
£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
);

66 
io˘l_gë∑Àâe
(
°¨t
, 
Àn
, *
ªd
, *
gªí
,

67 *
blue
);

68 
io˘l_£çÆëã
(
°¨t
, 
Àn
, *
ªd
, *
gªí
,

69 *
blue
);

73 
PSD


74 
	$fb_›í
(
PSD
 
psd
)

76 * 
ív
;

77 
ty≥
, 
visuÆ
;

78 
ây
;

79 
PSUBDRIVER
 
subdrivî
;

80 
fb_s¸ìnöfo
 
fb_öfo
;

82 
	`as£π
(
°©us
 < 2);

85 if(!(
ív
 = 
	`gëív
("FRAMEBUFFER")))

86 
ív
 = "/dev/fb0";

87 
fb
 = 
	`›í
–
ív
, 
O_RDWR
);

88 if(
fb
 < 0) {

89 
	`EPRINTF
("Eº‹ o≥nög %s: %m\n", 
ív
);

90  
NULL
;

93 if–
	`ufb_gë_s¸ìn_öfo
–
fb
, &
fb_öfo
 ) )

95 
	`EPRINTF
("Error getting screen info\n" );

96  
NULL
;

99 
ty≥
 = 
fb_öfo
.type;

100 
visuÆ
 = 
fb_öfo
.visual;

102 
psd
->
xªs
 =Ösd->
xvúåes
 = 
fb_öfo
.xres;

103 
psd
->
yªs
 =Ösd->
yvúåes
 = 
fb_öfo
.yres;

106 i‡(
ty≥
 =
FB_TYPE_VGA_PLANES
)

107 
psd
->
∂™es
 = 4;

108 i‡(
ty≥
 =
FB_TYPE_PACKED_PIXELS
)

109 
psd
->
∂™es
 = 1;

110 
psd
->
∂™es
 = 0;

112 
psd
->
bµ
 = 
fb_öfo
.
bôs_≥r_pixñ
;

113 
psd
->
ncﬁ‹s
 = (psd->
bµ
 >= 24)? (1 << 24): (1 <<Ösd->bpp);

116 
psd
->
löñí
 = 
fb_öfo
.
löe_Àngth
;

117 
psd
->
size
 = 0;

119 #i‡
HAVEBLIT


120 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

122 
psd
->
Êags
 = 
PSF_SCREEN
;

124 i‡(
psd
->
bµ
 == 16)

125 
psd
->
Êags
 |
PSF_HAVEOP_COPY
;

128 if(
visuÆ
 =
FB_VISUAL_TRUECOLOR
 || visuÆ =
FB_VISUAL_DIRECTCOLOR
) {

129 
psd
->
bµ
) {

131 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR332
;

134 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR565
;

137 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR888
;

140 
psd
->
pixty≥
 = 
MWPF_TRUECOLOR0888
;

143 
	`EPRINTF
(

145 
psd
->
ncﬁ‹s
,Ösd->
bµ
);

146 
Áû
;

148 } 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

150 
psd
->
size
 = 
fb_öfo
.
smem_Àn
;

153 if–
	`ufb_mm≠_to_u£r_•a˚
–
fb
, &
psd
->
addr
,

154 –*)
fb_öfo
.
smem_°¨t
, fb_öfo.
smem_Àn
 ) )

156 
	`EPRINTF
("Error mapping FB memoryÅo user space\n" );

157 
Áû
;

165 
subdrivî
 = 
	`£À˘_fb_subdrivî
(
psd
);

166 i‡(!
subdrivî
) {

167 
	`EPRINTF
("No driver for screenÅype %d visual %d bpp %d\n",

168 
ty≥
, 
visuÆ
, 
psd
->
bµ
);

169 
Áû
;

172 if–
	`ufb_íãr_gøphics
–
fb
, 0 ) )

174 
	`EPRINTF
("ErrorÉntering graphics\n");

175  
NULL
;

182 if(!
	`£t_subdrivî
(
psd
, 
subdrivî
, 
TRUE
 ))

184 
	`EPRINTF
("Driver initialize failedÅype %d visual %d bpp %d\n",

185 
ty≥
, 
visuÆ
, 
psd
->
bµ
);

186 
Áû
;

190 
	`io˘l_gë∑Àâe
(0, 16, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

193 if(
visuÆ
 =
FB_VISUAL_DIRECTCOLOR
)

194 
	`£t_dúe˘cﬁ‹_∑Àâe
(
psd
);

196 
°©us
 = 2;

197  
psd
;

199 
Áû
:

200 
	`˛o£
–
fb
 );

201  
NULL
;

202 
	}
}

206 
	$fb_˛o£
(
PSD
 
psd
)

209 if(
°©us
 != 2)

211 
°©us
 = 1;

214 
	`io˘l_£çÆëã
(0, 16, 
ßved_ªd
, 
ßved_gªí
, 
ßved_blue
);

217 
	`ufb_unmm≠_‰om_u£r_•a˚
–
fb
, 
psd
->
addr
 );

220 
	`ufb_exô_gøphics
–
fb
 );

223 
	`˛o£
–
fb
 );

224 
	}
}

228 
	$£t_dúe˘cﬁ‹_∑Àâe
(
PSD
 
psd
)

230 
i
;

231 
r
[256], 
g
[256], 
b
[256];

234 if(
psd
->
bµ
 == 16) {

236 
i
=0; i<32; ++i) {

238 
r
[
i
] = 
g
[i] = 
b
[i] = ((i<<11)|(i<<6)|i)<<8;

239 
r
[
i
] = 
g
[i] = 
b
[i] = ((i<<5)|i)<<10;

240 
r
[
i
] = 
g
[i] = 
b
[i] = i<<11;

242 
r
[
i
] = 
g
[i] = 
b
[i] = (i<<11) | (i<<3);

244 
	`io˘l_£çÆëã
(0, 32, 
r
, 
g
, 
b
);

247 
i
=0; i<256; ++i)

248 
r
[
i
] = i<<8;

249 
	`io˘l_£çÆëã
(0, 256, 
r
,Ñ,Ñ);

251 
	}
}

253 
	gÁde
 = 100;

257 
	$fb_£çÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
)

259 
i
;

260 
ªd
[
cou¡
];

261 
gªí
[
cou¡
];

262 
blue
[
cou¡
];

265 
i
=0; i < 
cou¡
; i++) {

266 
MWPALENTRY
 *
p
 = &
∑Àâe
[
i
];

272 
ªd
[
i
] = (
p
->
r
 * 
Áde
 / 100) << 8;

273 
gªí
[
i
] = (
p
->
g
 * 
Áde
 / 100) << 8;

274 
blue
[
i
] = (
p
->
b
 * 
Áde
 / 100) << 8;

276 
	`io˘l_£çÆëã
(
fú°
, 
cou¡
, 
ªd
, 
gªí
, 
blue
);

277 
	}
}

281 
	$io˘l_gë∑Àâe
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

283 
fb_cm≠
 
cm≠
;

285 
cm≠
.
°¨t
 = start;

286 
cm≠
.
Àn
 =Üen;

287 
cm≠
.
ªd
 =Ñed;

288 
cm≠
.
gªí
 = green;

289 
cm≠
.
blue
 = blue;

290 
cm≠
.
å™•
 = 
NULL
;

292 
	`ufb_gë_∑Àâe
–
fb
, &
cm≠
 );

293 
	}
}

297 
	$io˘l_£çÆëã
(
°¨t
, 
Àn
, *
ªd
, *
gªí
, *
blue
)

299 
fb_cm≠
 
cm≠
;

301 
cm≠
.
°¨t
 = start;

302 
cm≠
.
Àn
 =Üen;

303 
cm≠
.
ªd
 =Ñed;

304 
cm≠
.
gªí
 = green;

305 
cm≠
.
blue
 = blue;

306 
cm≠
.
å™•
 = 
NULL
;

308 
	`ufb_£t_∑Àâe
–
fb
, &
cm≠
 );

309 
	}
}

312 
	$gí_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

314 
psi
->
rows
 = 
psd
->
yvúåes
;

315 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

316 
psi
->
∂™es
 = 
psd
->planes;

317 
psi
->
bµ
 = 
psd
->bpp;

318 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

319 
psi
->
pixty≥
 = 
psd
->pixtype;

320 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

322 if(
psd
->
yvúåes
 > 480) {

324 
psi
->
xdpcm
 = 33;

325 
psi
->
ydpcm
 = 33;

326 } if(
psd
->
yvúåes
 > 350) {

328 
psi
->
xdpcm
 = 27;

329 
psi
->
ydpcm
 = 27;

332 
psi
->
xdpcm
 = 27;

333 
psi
->
ydpcm
 = 19;

335 
	}
}

339 
	$£tÁdñevñ
(
PSD
 
psd
, 
f
)

341 
i
;

342 
r
[256], 
g
[256], 
b
[256];

343 
MWPALENTRY
 
gr_∑Àâe
[256];

345 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

348 
Áde
 = 
f
;

349 if(
Áde
 > 100)

350 
Áde
 = 100;

351 
i
=0; i<256; ++i) {

352 
r
[
i
] = (
gr_∑Àâe
[i].∏* 
Áde
 / 100) << 8;

353 
g
[
i
] = (
gr_∑Àâe
[i].g * 
Áde
 / 100) << 8;

354 
b
[
i
] = (
gr_∑Àâe
[i].b * 
Áde
 / 100) << 8;

356 
	`io˘l_£çÆëã
(0, 256, 
r
, 
g
, 
b
);

357 
	}
}

	@drivers/scr_svga.c

15 
	~<as£π.h
>

16 
	~<°dio.h
>

17 
	~<vga.h
>

18 
	~"devi˚.h
"

19 
	~"gíf⁄t.h
"

20 
	~"gímem.h
"

22 
	#MAXLINELEN
 800

	)

25 
PSD
 
SVGA_›í
(PSD 
psd
);

26 
SVGA_˛o£
(
PSD
 
psd
);

27 
SVGA_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

28 
SVGA_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

29 
SVGA_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

30 
MWPIXELVAL
 
SVGA_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

31 
SVGA_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

32 
SVGA_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
);

33 
SVGA_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
,

34 
MWCOORD
 
y2
, 
MWPIXELVAL
 
c
);

35 
SVGA_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
,

36 
MWCOORD
 
h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, 
›
);

38 
SCREENDEVICE
 
	gs¸dev
 = {

39 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

40 
SVGA_›í
,

41 
SVGA_˛o£
,

42 
SVGA_gës¸ìnöfo
,

43 
SVGA_£çÆëã
,

44 
SVGA_døwpixñ
,

45 
SVGA_ªadpixñ
,

46 
SVGA_døwhlöe
,

47 
SVGA_døwvlöe
,

48 
SVGA_fûÃe˘
,

49 
gí_f⁄ts
,

50 
SVGA_blô
,

51 
NULL
,

52 
NULL
,

53 
NULL
,

54 
gí_Æloˇãmemgc
,

55 
NULL
,

56 
NULL
,

57 
NULL
,

58 
NULL


61 
gr_mode
;

63 
PSD


64 
	$SVGA_›í
(
PSD
 
psd
)

66 
mode
;

67 
vga_modeöfo
 * 
modeöfo
;

69 
	`vga_öô
();

71 
mode
 = 
G800x600x256
;

72 if(!
	`vga_hasmode
(
mode
))

73 
mode
 = 
G640x480x256
;

74 if(!
	`vga_hasmode
(
mode
))

75 
mode
 = 
G640x480x16
;

76 if(
	`vga_£tmode
(
mode
) == -1)

77  
NULL
;

78 
modeöfo
 = 
	`vga_gëmodeöfo
(
mode
);

80 
psd
->
xªs
 =Ösd->
xvúåes
 = 
modeöfo
->
width
;

81 
psd
->
yªs
 =Ösd->
yvúåes
 = 
modeöfo
->
height
;

82 
psd
->
löñí
 = 
modeöfo
->
löewidth
;

83 
psd
->
ncﬁ‹s
 = 
modeöfo
->
cﬁ‹s
;

84 if(
psd
->
ncﬁ‹s
 == 256) {

85 
psd
->
∂™es
 = 1;

86 
psd
->
bµ
 = 8;

88 
psd
->
∂™es
 = 4;

89 
psd
->
bµ
 = 4;

92 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

93 
psd
->
Êags
 = 
PSF_SCREEN
;

94 
psd
->
size
 = 0;

95 
psd
->
addr
 = 
NULL
;

100  
psd
;

101 
	}
}

104 
	$SVGA_˛o£
(
PSD
 
psd
)

106 
	`vga_£tmode
(
TEXT
);

107 
	}
}

110 
	$SVGA_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

112 
psi
->
rows
 = 
psd
->
yvúåes
;

113 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

114 
psi
->
∂™es
 = 
psd
->planes;

115 
psi
->
bµ
 = 
psd
->bpp;

116 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

117 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

118 
psi
->
p‹åaô
 = 
MWPORTRAIT_NONE
;

119 
psi
->
fbdrivî
 = 
FALSE
;

120 
psi
->
pixty≥
 = 
psd
->pixtype;

121 
psi
->
rmask
 = 0xff;

122 
psi
->
gmask
 = 0xff;

123 
psi
->
bmask
 = 0xff;

125 if(
psd
->
yvúåes
 > 480) {

127 
psi
->
xdpcm
 = 33;

128 
psi
->
ydpcm
 = 33;

129 } if(
psd
->
yvúåes
 > 350) {

131 
psi
->
xdpcm
 = 27;

132 
psi
->
ydpcm
 = 27;

135 
psi
->
xdpcm
 = 27;

136 
psi
->
ydpcm
 = 19;

138 
	}
}

141 
	$SVGA_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

143 
fú°
 < 256 && 
cou¡
-- > 0) {

144 
	`vga_£çÆëã
(
fú°
++, 
∑l
->
r
>>2,ÖÆ->
g
>>2,ÖÆ->
b
>>2);

145 ++
∑l
;

147 
	}
}

150 
	$SVGA_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

152 
glöe
, 
löe
 = 
c
;

154 if(
gr_mode
 =
MWMODE_COPY
) {

159 
	`vga_døwsˇn£gmít
(&
löe
, 
x
, 
y
, 1);

166 
	`vga_gësˇn£gmít
(&
glöe
, 
x
, 
y
, 1);

167 
löe
 ^
glöe
;

168 
	`vga_døwsˇn£gmít
(&
löe
, 
x
, 
y
, 1);

169 
	}
}

171 
MWPIXELVAL


172 
	$SVGA_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

174  
	`vga_gëpixñ
(
x
, 
y
);

175 
	}
}

178 
	$SVGA_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

180 
i
, 
width
;

181 
gëlöe
[
MAXLINELEN
];

182 
œ°cﬁ‹
 = -1;

183 
œ°width
 = -1;

184 
löe
[
MAXLINELEN
];

194 
width
 = 
x2
-
x1
+1;

197 if(
width
 !
œ°width
 || 
c
 !
œ°cﬁ‹
) {

198 
œ°width
 = 
width
;

199 
œ°cﬁ‹
 = 
c
;

200 
i
=0; i<
width
; ++i)

201 
löe
[
i
] = 
c
;

203 if(
gr_mode
 =
MWMODE_XOR
) {

204 
	`vga_gësˇn£gmít
(
gëlöe
, 
x1
, 
y
, 
width
);

205 
i
=0; i<
width
; ++i)

206 
löe
[
i
] ^
gëlöe
[i];

207 
œ°width
 = -1;

209 
	`vga_døwsˇn£gmít
(
löe
, 
x1
, 
y
, 
width
);

216 
	}
}

219 
	$SVGA_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

221 if(
gr_mode
 =
MWMODE_COPY
) {

222 
	`vga_£ãgacﬁ‹
(
c
);

223 
	`vga_døwlöe
(
x
, 
y1
, x, 
y2
);

227 
y1
 <
y2
)

228 
	`SVGA_døwpixñ
(
psd
, 
x
, 
y1
++, 
c
);

229 
	}
}

232 
	$SVGA_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

234 
y1
 <
y2
)

235 
	`SVGA_døwhlöe
(
psd
, 
x1
, 
x2
, 
y1
++, 
c
);

236 
	}
}

241 
	$SVGA_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
, MWCOORD 
h
,

242 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

244 
löe
[
MAXLINELEN
];

246 
	`as£π
 (
d°x
 >0 && d°x < 
d°psd
->
xªs
);

247 
	`as£π
 (
d°y
 >0 && d°y < 
d°psd
->
yªs
);

248 
	`as£π
 (
w
 > 0);

249 
	`as£π
 (
h
 > 0);

250 
	`as£π
 (
§cx
 >0 && srcx < 
§˝sd
->
xªs
);

251 
	`as£π
 (
§cy
 >0 && srcy < 
§˝sd
->
yªs
);

252 
	`as£π
 (
d°x
+
w
 <
d°psd
->
xªs
);

253 
	`as£π
 (
d°y
+
h
 <
d°psd
->
yªs
);

254 
	`as£π
 (
§cx
+
w
 <
§˝sd
->
xªs
);

255 
	`as£π
 (
§cy
+
h
 <
§˝sd
->
yªs
);

257 if(!(
§˝sd
->
Êags
 & 
PSF_SCREEN
Ë|| !(
d°psd
->flags & PSF_SCREEN))

260 --
h
 >= 0) {

261 
	`vga_gësˇn£gmít
(
löe
, 
§cx
, 
§cy
, 
w
);

262 
	`vga_døwsˇn£gmít
(
löe
, 
d°x
, 
d°y
, 
w
);

263 ++
d°y
;

264 ++
§cy
;

266 
	}
}

268 
	gÁde
 = 100;

271 
	$£tÁdñevñ
(
PSD
 
psd
, 
f
)

273 
i
;

274 
MWPALENTRY
 
gr_∑Àâe
[256];

275 
MWPALENTRY
 
loˇl_∑Àâe
[256];

277 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

280 
Áde
 = 
f
;

281 if(
Áde
 > 100)

282 
Áde
 = 100;

283 
i
=0; i<256; ++i) {

285 
loˇl_∑Àâe
[
i
].
r
 = (
gr_∑Àâe
[i].∏* 
Áde
 / 100);

286 
loˇl_∑Àâe
[
i
].
g
 = (
gr_∑Àâe
[i].g * 
Áde
 / 100);

287 
loˇl_∑Àâe
[
i
].
b
 = (
gr_∑Àâe
[i].b * 
Áde
 / 100);

289 
	`SVGA_£çÆëã
–
psd
, 0,256,
loˇl_∑Àâe
 );

290 
	}
}

	@drivers/scr_tc.c

21 
	~<°dio.h
>

22 
	~<gøphics.h
>

23 
	~"devi˚.h
"

24 
	~"gíf⁄t.h
"

27 
PSD
 
BGI_›í
(PSD 
psd
);

28 
BGI_˛o£
(
PSD
 
psd
);

29 
BGI_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

30 
BGI_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
);

31 
BGI_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

32 
MWPIXELVAL
 
BGI_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

33 
BGI_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

34 
BGI_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
);

35 
BGI_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,
MWPIXELVAL
 
c
);

36 
BGI_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

37 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
);

38 
PSD
 
BGI_Æloˇãmemgc
(PSD 
psd
);

40 
SCREENDEVICE
 
	gs¸dev
 = {

41 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

42 
BGI_›í
,

43 
BGI_˛o£
,

44 
BGI_gës¸ìnöfo
,

45 
BGI_£çÆëã
,

46 
BGI_døwpixñ
,

47 
BGI_ªadpixñ
,

48 
BGI_døwhlöe
,

49 
BGI_døwvlöe
,

50 
BGI_fûÃe˘
,

51 
gí_f⁄ts
,

52 
BGI_blô
,

53 
NULL
,

54 
NULL
,

55 
NULL
,

56 
BGI_Æloˇãmemgc
,

57 
NULL
,

58 
NULL


62 
gr_mode
;

63 
löe£âög°y≥
 
	glöeöfo
;

64 
∑Àâëy≥
 
	gbgi_∑l
;

66 
PSD


67 
	$BGI_›í
(
PSD
 
psd
)

69 
gd
=
VGA
;

70 
gm
=
VGAHI
;

72 
	`ªgi°îbgidrivî
(
EGAVGA_drivî
);

73 
	`öôgøph
(&
gd
,&
gm
,"");

75 
	`gëlöe£âögs
(&
löeöfo
);

77 
psd
->
xªs
 =Ösd->
xvúåes
 = 
	`gëmaxx
()+1;

78 
psd
->
yªs
 =Ösd->
yvúåes
 = 
	`gëmaxy
()+1;

79 
psd
->
löñí
 = 
löeöfo
.
thick√ss
;

80 
psd
->
∂™es
 = 1;

81 
psd
->
bµ
 = 4;

82 
psd
->
ncﬁ‹s
 = 
	`gëmaxcﬁ‹
() + 1;

83 
psd
->
Êags
 = 
PSF_SCREEN
;

84 
psd
->
addr
 = 0;

87 
psd
->
pixty≥
 = 
MWPF_PALETTE
;

88  
psd
;

89 
	}
}

92 
	$BGI_˛o£
(
PSD
 
psd
)

94 
	`˛o£gøph
();

95 
	}
}

98 
	$BGI_gës¸ìnöfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
)

100 
psi
->
rows
 = 
psd
->
yvúåes
;

101 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

102 
psi
->
∂™es
 = 
psd
->planes;

103 
psi
->
bµ
 = 
psd
->bpp;

104 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

105 
psi
->
pixty≥
 = 
psd
->pixtype;

106 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

108 if(
s¸dev
.
yvúåes
 > 480) {

110 
psi
->
xdpcm
 = 33;

111 
psi
->
ydpcm
 = 33;

112 } if(
s¸dev
.
yvúåes
 > 350) {

114 
psi
->
xdpcm
 = 27;

115 
psi
->
ydpcm
 = 27;

118 
psi
->
xdpcm
 = 27;

119 
psi
->
ydpcm
 = 19;

121 
	}
}

124 
	$BGI_£çÆëã
(
PSD
 
psd
,
fú°
,
cou¡
,
MWPALENTRY
 *
∑l
)

127 
	}
}

130 
	$BGI_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

132 
gr_mode
) {

133 
MWMODE_COPY
: ;

134 
MWMODE_XOR
: 
c
 ^
	`gëpixñ
(
x
, 
y
); ;

135 
MWMODE_OR
: 
c
 |
	`gëpixñ
(
x
, 
y
); ;

136 
MWMODE_AND
: 
c
 &
	`gëpixñ
(
x
, 
y
); ;

138 
	`puçixñ
(
x
, 
y
, 
c
);

139 
	}
}

141 
MWPIXELVAL


142 
	$BGI_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
)

144  
	`gëpixñ
(
x
, 
y
);

145 
	}
}

148 
	$BGI_døwhlöe
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

150 
MWCOORD
 
x
;

152 i‡(
x1
 > 
x2
) {

153 
x
 = 
x1
;

154 
x1
 = 
x2
;

155 
x2
 = 
x
;

158 
	`£tcﬁ‹
(
c
);

159 
gr_mode
) {

160 
MWMODE_COPY
:

161 
	`£twrôemode
(
COPY_PUT
);

163 
MWMODE_XOR
:

164 
	`£twrôemode
(
XOR_PUT
);

166 
MWMODE_OR
:

167 
x
 = 
x1
; x <
x2
; x++)

168 
	`puçixñ
(
x
, 
y
, 
c
 | 
	`gëpixñ
(x, y));

170 
MWMODE_AND
:

171 
x
 = 
x1
; x <
x2
; x++)

172 
	`puçixñ
(
x
, 
y
, 
c
 & 
	`gëpixñ
(x, y));

175 
	`löe
(
x1
, 
y
, 
x2
, y);

176 
	}
}

179 
	$BGI_døwvlöe
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

181 
MWCOORD
 
y
;

183 i‡(
y1
 > 
y2
) {

184 
y
 = 
y1
;

185 
y1
 = 
y2
;

186 
y2
 = 
y
;

189 
	`£tcﬁ‹
(
c
);

190 
gr_mode
) {

191 
MWMODE_COPY
:

192 
	`£twrôemode
(
COPY_PUT
);

194 
MWMODE_XOR
:

195 
	`£twrôemode
(
XOR_PUT
);

197 
MWMODE_OR
:

198 
y
 = 
y1
; y <
y2
; y++)

199 
	`puçixñ
(
x
, 
y
, 
c
 | 
	`gëpixñ
(x, y));

201 
MWMODE_AND
:

202 
y
 = 
y1
; y <
y2
; y++)

203 
	`puçixñ
(
x
, 
y
, 
c
 & 
	`gëpixñ
(x, y));

206 
	`löe
(
x
, 
y1
, x, 
y2
);

207 
	}
}

210 
	$BGI_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

211 
MWPIXELVAL
 
c
)

213 
MWCOORD
 
x
, 
y
;

215 i‡(
x1
 > 
x2
) {

216 
x
 = 
x1
;

217 
x1
 = 
x2
;

218 
x2
 = 
x
;

220 i‡(
y1
 > 
y2
) {

221 
y
 = 
y1
;

222 
y1
 = 
y2
;

223 
y2
 = 
y
;

226 
gr_mode
) {

227 
MWMODE_COPY
:

228 
	`£tfûl°yÀ
(1,
c
);

229 
	`b¨
(
x1
, 
y1
, 
x2
, 
y2
);

232 
MWMODE_XOR
:

233 
x
 = 
x1
; x <
x2
; x++)

234 
y
 = 
y1
; y <
y2
; y++)

235 
	`puçixñ
(
x
, 
y
, 
c
 ^ 
	`gëpixñ
(x, y));

238 
MWMODE_OR
:

239 
x
 = 
x1
; x <
x2
; x++)

240 
y
 = 
y1
; y <
y2
; y++)

241 
	`puçixñ
(
x
, 
y
, 
c
 | 
	`gëpixñ
(x, y));

244 
MWMODE_AND
:

245 
x
 = 
x1
; x <
x2
; x++)

246 
y
 = 
y1
; y <
y2
; y++)

247 
	`puçixñ
(
x
, 
y
, 
c
 & 
	`gëpixñ
(x, y));

253 
	}
}

256 
	$BGI_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,MWCOORD 
h
,

257 
PSD
 
§˝sd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,
›
)

260 
	}
}

263 
PSD


264 
	$BGI_Æloˇãmemgc
(
PSD
 
psd
)

267  
NULL
;

268 
	}
}

	@drivers/scr_x11.c

12 
	~<°dio.h
>

13 
	~<°rög.h
>

14 
	~<°dlib.h
>

15 
	~<X11/Xlib.h
>

16 
	~<X11/Xutû.h
>

17 
	~<as£π.h
>

18 
	~"devi˚.h
"

19 
	~"fb.h
"

20 
	~"gímem.h
"

21 
	~"gíf⁄t.h
"

24 #i‚de‡
SCREEN_WIDTH


25 #îr‹ 
SCREEN_WIDTH
 
nŸ
 
deföed


28 #i‚de‡
SCREEN_HEIGHT


29 #îr‹ 
SCREEN_HEIGHT
 
nŸ
 
deföed


32 #i‚de‡
MWPIXEL_FORMAT


33 #îr‹ 
MWPIXEL_FORMAT
 
nŸ
 
deföed


37 #i‡!
deföed
(
SCREEN_DEPTH
Ë&& (
MWPIXEL_FORMAT
 =
MWPF_PALETTE
)

38 #îr‹ 
SCREEN_DEPTH
 
nŸ
 
deföed
 - 
mu°
 
be
 
£t
 
∑Àâe
 
modes


42 
MWCOORD
 
	gnxªs
;

43 
MWCOORD
 
	gnyªs
;

46 
PSD
 
X11_›í
(PSD 
psd
);

47 
X11_˛o£
(
PSD
 
psd
);

48 
X11_gës¸ìnöfo
(
PSD
 
psd
, 
PMWSCREENINFO
 
psi
);

49 
X11_£çÆëã
(
PSD
 
psd
, 
fú°
, 
cou¡
, 
MWPALENTRY
 * 
∑l
);

50 
X11_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
);

51 
MWPIXELVAL
 
X11_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
);

52 
X11_døwhlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
,

53 
MWPIXELVAL
 
c
);

54 
X11_døwvlöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
,

55 
MWPIXELVAL
 
c
);

56 
X11_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
,

57 
MWCOORD
 
y2
, 
MWPIXELVAL
 
c
);

58 
X11_blô
(
PSD
 
d°psd
, 
MWCOORD
 
de°x
, MWCOORD 
de°y
, MWCOORD 
w
,

59 
MWCOORD
 
h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, 
›
);

60 
X11_¥e£À˘
(
PSD
 
psd
);

61 
X11_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
);

62 
X11_°ªtchblôex
(
PSD
 
d°psd
, PSD 
§˝sd
, 
MWCOORD
 
de°_x_°¨t
,

63 
MWCOORD
 
de°_y_°¨t
, MWCOORD 
width
, MWCOORD 
height
, 
x_díomö©‹
,

64 
y_díomö©‹
, 
§c_x_‰a˘i⁄
, 
§c_y_‰a˘i⁄
,

65 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
);

67 
SCREENDEVICE
 
	gs¸dev
 = {

68 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
NULL
,

69 
X11_›í
,

70 
X11_˛o£
,

71 
X11_gës¸ìnöfo
,

72 
X11_£çÆëã
,

73 
X11_døwpixñ
,

74 
X11_ªadpixñ
,

75 
X11_døwhlöe
,

76 
X11_døwvlöe
,

77 
X11_fûÃe˘
,

78 
gí_f⁄ts
,

79 
X11_blô
,

80 
X11_¥e£À˘
,

81 
X11_døw¨ó
,

82 
NULL
,

83 
gí_Æloˇãmemgc
,

84 
fb_m≠memgc
,

85 
gí_‰ìmemgc
,

86 
NULL
,

87 
NULL
,

89 
NULL
,

90 
X11_°ªtchblôex
,

94 
Di•œy
 *
	gx11_dpy
;

95 
	gx11_s¸
;

96 
VisuÆ
 *
	gx11_vis
;

97 
Cﬁ‹m≠
 
	gx11_cﬁ‹m≠
;

98 
Wödow
 
	gx11_wö
;

99 
GC
 
	gx11_gc
;

100 
	gx11_evít_mask
;

102 
	gx11_width
, 
	gx11_height
;

103 
	gx11_dïth
;

105 
	gx11_is_∑Àâe
;

108 
	gx11_r_shi·
;

109 
	gx11_r_mask
;

110 
	gx11_g_shi·
;

111 
	gx11_g_mask
;

112 
	gx11_b_shi·
;

113 
	gx11_b_mask
;

115 
	gx11_cﬁ‹m≠_ö°ÆÀd
 = 0;

116 
SCREENDEVICE
 
	gßvebôs
;

119 
XCﬁ‹
 
	gx11_∑Àâe
[256];

120 
	gx11_∑l_max
 = 0;

122 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


124 
	#COLOR_CACHE_SIZE
 1001

	)

125 
	scﬁ‹_ˇche
 {

126 
	möô
;

127 
	mr
;

128 
	mg
;

129 
	mb
;

130 
XCﬁ‹
 
	mc
;

132 
cﬁ‹_ˇche
 
	gcˇche
[
COLOR_CACHE_SIZE
];

135 
	$lookup_cﬁ‹
(
r
, 
g
, 
b
)

137 
ix
 = ((
r
 << 16Ë+ (
g
 << 8Ë+ 
b
Ë% 
COLOR_CACHE_SIZE
;

139 i‡(
cˇche
[
ix
].
öô
 || (cˇche[ix].
r
 !rË|| (cˇche[ix].
g
 != g)

140 || (
cˇche
[
ix
].
b
 != b)) {

141 
•ec
[20];

142 
XCﬁ‹
 
exa˘
;

143 
XCﬁ‹
 
def
;

145 
cˇche
[
ix
].
öô
 = 0;

146 
cˇche
[
ix
].
r
 =Ñ;

147 
cˇche
[
ix
].
g
 = g;

148 
cˇche
[
ix
].
b
 = b;

149 
	`•rötf
(
•ec
, "#%02x%02x%02x", 
r
, 
g
, 
b
);

150 
	`XLookupCﬁ‹
(
x11_dpy
, 
x11_cﬁ‹m≠
, 
•ec
, &
exa˘
, &
def
);

151 
	`XAŒocCﬁ‹
(
x11_dpy
, 
x11_cﬁ‹m≠
, &
def
);

152 
cˇche
[
ix
].
c
 = 
def
;

158  (Ë
cˇche
[
ix
].
c
.
pixñ
;

159 
	}
}

163 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


165 #i‡(
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR888
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR0888
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR8888
)

166 
	#PIXEL2RED8
(
p
Ë
	`PIXEL888RED8
’)

	)

167 
	#PIXEL2GREEN8
(
p
Ë
	`PIXEL888GREEN8
’)

	)

168 
	#PIXEL2BLUE8
(
p
Ë
	`PIXEL888BLUE8
’)

	)

169 
	#PIXEL2RED32
(
p
Ë
	`PIXEL888RED32
’)

	)

170 
	#PIXEL2GREEN32
(
p
Ë
	`PIXEL888GREEN32
’)

	)

171 
	#PIXEL2BLUE32
(
p
Ë
	`PIXEL888BLUE32
’)

	)

172 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR565


173 
	#PIXEL2RED8
(
p
Ë
	`PIXEL565RED8
’)

	)

174 
	#PIXEL2GREEN8
(
p
Ë
	`PIXEL565GREEN8
’)

	)

175 
	#PIXEL2BLUE8
(
p
Ë
	`PIXEL565BLUE8
’)

	)

176 
	#PIXEL2RED32
(
p
Ë
	`PIXEL565RED32
’)

	)

177 
	#PIXEL2GREEN32
(
p
Ë
	`PIXEL565GREEN32
’)

	)

178 
	#PIXEL2BLUE32
(
p
Ë
	`PIXEL565BLUE32
’)

	)

179 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


180 
	#PIXEL2RED8
(
p
Ë
	`PIXEL555RED8
’)

	)

181 
	#PIXEL2GREEN8
(
p
Ë
	`PIXEL555GREEN8
’)

	)

182 
	#PIXEL2BLUE8
(
p
Ë
	`PIXEL555BLUE8
’)

	)

183 
	#PIXEL2RED32
(
p
Ë
	`PIXEL555RED32
’)

	)

184 
	#PIXEL2GREEN32
(
p
Ë
	`PIXEL555GREEN32
’)

	)

185 
	#PIXEL2BLUE32
(
p
Ë
	`PIXEL555BLUE32
’)

	)

186 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR332


187 
	#PIXEL2RED8
(
p
Ë
	`PIXEL332RED8
’)

	)

188 
	#PIXEL2GREEN8
(
p
Ë
	`PIXEL332GREEN8
’)

	)

189 
	#PIXEL2BLUE8
(
p
Ë
	`PIXEL332BLUE8
’)

	)

190 
	#PIXEL2RED32
(
p
Ë
	`PIXEL332RED32
’)

	)

191 
	#PIXEL2GREEN32
(
p
Ë
	`PIXEL332GREEN32
’)

	)

192 
	#PIXEL2BLUE32
(
p
Ë
	`PIXEL332BLUE32
’)

	)

196 
	#PIXELVAL_to_pixñ
(
c
Ë(
x11_is_∑Àâe
 \

197 ? 
	`lookup_cﬁ‹
(
	`PIXEL2RED8
(
c
), 
	`PIXEL2GREEN8
(c), 
	`PIXEL2BLUE8
(c)) \

198 : ( ((
	`PIXEL2RED32
(
c
Ë>> 
x11_r_shi·
Ë& 
x11_r_mask
) \

199 | ((
	`PIXEL2GREEN32
(
c
Ë>> 
x11_g_shi·
Ë& 
x11_g_mask
) \

200 | ((
	`PIXEL2BLUE32
(
c
Ë>> 
x11_b_shi·
Ë& 
x11_b_mask
ËË)

	)

203 
	#PIXELVAL_to_pixñ
(
c
Ë(()(cË> ()
x11_∑l_max
 ? 0 : 
x11_∑Àâe
[c].
pixñ
)

	)

208 
	$£t_cﬁ‹
(
MWPIXELVAL
 
c
)

210 
ﬁdc
 = 0x80000001;

212 i‡(
c
 !
ﬁdc
) {

213 
ﬁdc
 = 
c
;

214 
	`XSëF‹eground
(
x11_dpy
, 
x11_gc
, 
	`PIXELVAL_to_pixñ
(
c
));

216 
	}
}

219 
	gx11_ﬁd_mode
 = -1;

221 
	#£t_mode
(
√w_mode
) do { \

222 i‡(
√w_mode
 !
x11_ﬁd_mode
) { \

223 
	`£t_mode_2
(
√w_mode
); \

225 } 0)

	)

228 
	$£t_mode_2
(
√w_mode
)

230 
func
 = 
GXc›y
;

231 
√w_mode
) {

232 
MWMODE_COPY
:

233 
func
 = 
GXc›y
;

235 
MWMODE_XOR
:

236 
func
 = 
GXx‹
;

238 
MWMODE_OR
:

239 
func
 = 
GX‹
;

241 
MWMODE_AND
:

242 
func
 = 
GX™d
;

244 
MWMODE_CLEAR
:

245 
func
 = 
GX˛ór
;

247 
MWMODE_SETTO1
:

248 
func
 = 
GX£t
;

250 
MWMODE_EQUIV
:

251 
func
 = 
GXequiv
;

253 
MWMODE_NOR
:

254 
func
 = 
GXn‹
;

256 
MWMODE_NAND
:

257 
func
 = 
GX«nd
;

259 
MWMODE_INVERT
:

260 
func
 = 
GXövît
;

262 
MWMODE_COPYINVERTED
:

263 
func
 = 
GXc›yInvîãd
;

265 
MWMODE_ORINVERTED
:

266 
func
 = 
GX‹Invîãd
;

268 
MWMODE_ANDINVERTED
:

269 
func
 = 
GX™dInvîãd
;

271 
MWMODE_ORREVERSE
:

272 
func
 = 
GX‹Revî£
;

274 
MWMODE_ANDREVERSE
:

275 
func
 = 
GX™dRevî£
;

277 
MWMODE_NOOP
:

278 
func
 = 
GXno›
;

283 
	`XSëFun˘i⁄
(
x11_dpy
, 
x11_gc
, 
func
);

284 
x11_ﬁd_mode
 = 
√w_mode
;

285 
	}
}

288 
	$upd©e_‰om_ßvebôs
(
de°x
, 
de°y
, 
w
, 
h
)

290 
XImage
 *
img
;

291 
x
, 
y
;

292 *
d©a
;

295 i‡(
x11_dïth
 >= 24)

296 
d©a
 = 
	`mÆloc
(
w
 * 4 * 
h
);

297 i‡(
x11_dïth
 > 8)

298 
d©a
 = 
	`mÆloc
(
w
 * 2 * 
h
);

300 
d©a
 = 
	`mÆloc
((
w
 * 
x11_dïth
 + 7Ë/ 8 * 
h
);

303 
img
 = 
	`XCª©eImage
(
x11_dpy
, 
x11_vis
, 
x11_dïth
, 
ZPixm≠
,

304 0, 
d©a
, 
w
, 
h
, 8, 0);

308 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR332


310 
ADDR8
 
dbuf
 = ((ADDR8Ë
ßvebôs
.
addr
)

311 + 
de°x
 + 
de°y
 * 
ßvebôs
.
löñí
;

312 
löedñè
 = 
ßvebôs
.
löñí
 - 
w
;

313 
y
 = 0; y < 
h
; y++) {

314 
x
 = 0; x < 
w
; x++) {

315 
MWPIXELVAL
 
c
 = *
dbuf
++;

316 
pixñ
 = 
	`PIXELVAL_to_pixñ
(
c
);

317 
	`XPutPixñ
(
img
, 
x
, 
y
, 
pixñ
);

319 
dbuf
 +
löedñè
;

322 #ñi‡(
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR565
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR555
)

324 
ADDR16
 
dbuf
 = ((ADDR16Ë
ßvebôs
.
addr
)

325 + 
de°x
 + 
de°y
 * 
ßvebôs
.
löñí
;

326 
löedñè
 = 
ßvebôs
.
löñí
 - 
w
;

327 
y
 = 0; y < 
h
; y++) {

328 
x
 = 0; x < 
w
; x++) {

329 
MWPIXELVAL
 
c
 = *
dbuf
++;

330 
pixñ
 = 
	`PIXELVAL_to_pixñ
(
c
);

331 
	`XPutPixñ
(
img
, 
x
, 
y
, 
pixñ
);

333 
dbuf
 +
löedñè
;

336 #ñi‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR888


338 
ADDR8
 
dbuf
 = ((ADDR8Ë
ßvebôs
.
addr
)

339 + 3 * (
de°x
 + 
de°y
 * 
ßvebôs
.
löñí
);

340 
löedñè
 = 3 * (
ßvebôs
.
löñí
 - 
w
);

341 
y
 = 0; y < 
h
; y++) {

342 
x
 = 0; x < 
w
; x++) {

343 
MWPIXELVAL
 
c
 = 
	`RGB2PIXEL888
(
dbuf
[2], dbuf[1],

344 
dbuf
[0]);

345 
pixñ
 = 
	`PIXELVAL_to_pixñ
(
c
);

346 
	`XPutPixñ
(
img
, 
x
, 
y
, 
pixñ
);

347 
dbuf
 += 3;

349 
dbuf
 +
löedñè
;

352 #ñi‡(
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR0888
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR8888
)

354 
ADDR32
 
dbuf
 = ((ADDR32Ë
ßvebôs
.
addr
)

355 + 
de°x
 + 
de°y
 * 
ßvebôs
.
löñí
;

356 
löedñè
 = 
ßvebôs
.
löñí
 - 
w
;

357 
y
 = 0; y < 
h
; y++) {

358 
x
 = 0; x < 
w
; x++) {

359 
MWPIXELVAL
 
c
 = *
dbuf
++;

360 
pixñ
 = 
	`PIXELVAL_to_pixñ
(
c
);

361 
	`XPutPixñ
(
img
, 
x
, 
y
, 
pixñ
);

363 
dbuf
 +
löedñè
;

368 
y
 = 0; y < 
h
; y++) {

369 
x
 = 0; x < 
w
; x++) {

370 
MWPIXELVAL
 
c
 = 
ßvebôs
.
	`RódPixñ
(&savebits,

371 
de°x
 + 
x
,

372 
de°y
 + 
y
);

373 
pixñ
 = 
	`PIXELVAL_to_pixñ
(
c
);

374 
	`XPutPixñ
(
img
, 
x
, 
y
, 
pixñ
);

380 
	`£t_mode
(
MWMODE_COPY
);

381 
	`XPutImage
(
x11_dpy
, 
x11_wö
, 
x11_gc
, 
img
, 0, 0, 
de°x
, 
de°y
, 
w
, 
h
);

383 
	`XDe°royImage
(
img
);

384 
	}
}

388 
	$x11_h™dÀ_evít
(
XEvít
 * 
ev
)

390 
öôed
 = 0;

392 i‡(
ev
->
ty≥
 =
Cﬁ‹m≠NŸify
) {

393 i‡(
ev
->
xcﬁ‹m≠
.
wödow
 =
x11_wö
) {

394 i‡(
ev
->
xcﬁ‹m≠
.
°©e
 =
Cﬁ‹m≠In°ÆÀd
) {

395 
	`DPRINTF
("colormap uninstalled\n");

396 
x11_cﬁ‹m≠_ö°ÆÀd
 = 0;

397 } i‡(
ev
->
xcﬁ‹m≠
.
°©e
 =
Cﬁ‹m≠In°ÆÀd
) {

398 
x11_cﬁ‹m≠_ö°ÆÀd
 = 1;

399 
	`DPRINTF
("colormap installed\n");

402 } i‡(
ev
->
ty≥
 =
FocusIn
) {

403 i‡(!
x11_cﬁ‹m≠_ö°ÆÀd
) {

404 
	`DPRINTF
("setting colormap\n");

405 
	`XIn°ÆlCﬁ‹m≠
(
x11_dpy
, 
x11_cﬁ‹m≠
);

406 
öôed
 = 1;

408 } i‡(
ev
->
ty≥
 =
M≠pögNŸify
) {

409 
	`DPRINTF
("Refreshing keyboard mapping\n");

410 
	`XRe‰eshKeybﬂrdM≠pög
(&
ev
->
xm≠pög
);

413 i‡(
ev
->
ty≥
 =
E¡îNŸify
) {

414 i‡(
öôed
)

415 
	`GdShowCurs‹
(&
s¸dev
);

416 } i‡(
ev
->
ty≥
 =
LóveNŸify
) {

417 i‡(
öôed
)

418 
	`GdHideCurs‹
(&
s¸dev
);

422 #ifde‡
USE_EXPOSURE


423 i‡(
ev
->
ty≥
 =
Expo£
) {

424 
	`upd©e_‰om_ßvebôs
(
ev
->
xexpo£
.
x
,Év->xexpo£.
y
,

425 
ev
->
xexpo£
.
width
,Év->xexpo£.
height
);

428 
	}
}

432 
	$x11_îr‹
(
Di•œy
 * 
dpy
, 
XEº‹Evít
 * 
ev
)

434 
îr_°rög
[256];

436 
	`XGëEº‹Text
(
dpy
, 
ev
->
îr‹_code
, 
îr_°rög
, 256);

437 
	`EPRINTF
("X11Éº‹: %s\n", 
îr_°rög
);

439 
	}
}

441 *
	g˛as¢m
[] = { "StaticGray", "GrayScale", "StaticColor",

446 
	$show_visuÆ
(
VisuÆ
 * 
v
)

448 *
«me
 = ((
v
->
˛ass
 < 0) || (v->class > 5)) ? "???" :

449 
˛as¢m
[
v
->
˛ass
];

450  
	`¥ötf
(" VisuÆ cœss: %†(%d)\n", 
«me
, 
v
->
˛ass
);

451  
	`¥ötf
(" id: %ld\n", 
v
->
visuÆid
);

452  
	`¥ötf
(" bôs_≥r_rgb: %d\n", 
v
->
bôs_≥r_rgb
);

453  
	`¥ötf
(" m≠_íåõs: %d\n", 
v
->
m≠_íåõs
);

454  
	`¥ötf
("Ñed_mask: 0x%08lx\n", 
v
->
ªd_mask
);

455  
	`¥ötf
(" gªí_mask: 0x%08lx\n", 
v
->
gªí_mask
);

456  
	`¥ötf
(" blue_mask: 0x%08lx\n", 
v
->
blue_mask
);

457 
	}
}

459 
VisuÆ
 *

460 
	$£À˘_visuÆ
(
Di•œy
 * 
dpy
, 
s¸
)

462 
VisuÆ
 *
vis
 = 
	`XDeÁu…VisuÆ
(
dpy
, 
s¸
);

463 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


464 
VisuÆ
 *
vis2
 = 
NULL
;

466 
S¸ìn
 *
s¸ìn
 = 
	`XS¸ìnOfDi•œy
(
dpy
, 
s¸
);

467 
d
;

469  
	`¥ötf
("XDefaultVisual:\n");

470 
	`show_visuÆ
(
vis
);

472  
	`¥ötf
("S¸ì¿RoŸDïth: %d\n", 
s¸ìn
->
roŸ_dïth
);

474  
	`¥ötf
("Screen RootVisual\n");

475 
	`show_visuÆ
(
s¸ìn
->
roŸ_visuÆ
);

479 
d
 = 0; d < 
s¸ìn
->
ndïths
; d++) {

480 
Dïth
 *
dp
 = 
s¸ìn
->
dïths
 + 
d
;

481 
v
;

482 
VisuÆ
 *
cur_vis
;

483  
	`¥ötf
("Dïth: %d\n", 
dp
->
dïth
);

484 
v
 = 0; v < 
dp
->
nvisuÆs
; v++) {

485  
	`¥ötf
("VisuÆ: %d\n", 
v
);

486 
cur_vis
 = 
dp
->
visuÆs
 + 
v
;

487 
	`show_visuÆ
(
cur_vis
);

488 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


489 i‡((
vis
->
˛ass
 !
TrueCﬁ‹
)

490 && (
dp
->
dïth
 =
s¸ìn
->
roŸ_dïth
)

491 && (
cur_vis
->
˛ass
 =
TrueCﬁ‹
)) {

493 i‡((
vis2
 =
NULL
)

494 || (
vis2
->
bôs_≥r_rgb
 <

495 
cur_vis
->
bôs_≥r_rgb
)) {

497 
vis2
 = 
cur_vis
;

503 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


504 i‡((
vis
->
˛ass
 !
TrueCﬁ‹
Ë&& (
vis2
 !
NULL
)) {

505 
vis
 = 
vis2
;

509 
	`¥ötf
("Selected Visual:\n");

510 
	`show_visuÆ
(
vis
);

513  
vis
;

514 
	}
}

518 
	$x11_£tup_di•œy
()

520 
£tup_√eded
 = 1;

522 i‡(
£tup_√eded
) {

523 *
«me
;

524 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


525 
i
;

528 i‡((
«me
 = 
	`gëív
("DISPLAY")Ë=
NULL
)

529 
«me
 = ":0";

530 i‡((
x11_dpy
 = 
	`XO≥nDi•œy
(
«me
)Ë=
NULL
)

533 
	`XSëEº‹H™dÀr
(
x11_îr‹
);

535 
x11_width
 = 
nxªs
?Çxªs: 
SCREEN_WIDTH
;

536 
x11_height
 = 
nyªs
?Çyªs: 
SCREEN_HEIGHT
;

537 
x11_s¸
 = 
	`XDeÁu…S¸ìn
(
x11_dpy
);

538 
x11_vis
 = 
	`£À˘_visuÆ
(
x11_dpy
, 
x11_s¸
);

540 i‡((
x11_vis
->
˛ass
 =
SèticGøy
)

541 || (
x11_vis
->
˛ass
 =
GøySˇÀ
)) {

542 
	`EPRINTF
("Nano-X Error: Your X serveráppearsÅo be grayscale only.\nThis isÇot supported.\n");

544 } i‡(
x11_vis
->
˛ass
 =
Dúe˘Cﬁ‹
) {

545 
	`EPRINTF
("Nano-X Error: Your X serveráppearsÅo useÅhe 'DirectColor' format.\nThis isÇot supported.\n");

547 } i‡((
x11_vis
->
˛ass
 =
P£udoCﬁ‹
)

548 || (
x11_vis
->
˛ass
 =
SèticCﬁ‹
)) {

551 
x11_is_∑Àâe
 = 1;

552 } i‡(
x11_vis
->
˛ass
 =
TrueCﬁ‹
) {

555 
mask
;

556 
shi·
;

558 
x11_is_∑Àâe
 = 0;

588 
x11_r_mask
 = 
x11_vis
->
ªd_mask
;

589 
x11_g_mask
 = 
x11_vis
->
gªí_mask
;

590 
x11_b_mask
 = 
x11_vis
->
blue_mask
;

593 
mask
 = 
x11_r_mask
;

594 
shi·
 = 0;

595 
	`as£π
(
mask
);

596 i‡(
mask
) {

597 (
mask
 & 0x80000000UL) == 0) {

598 
mask
 <<= 1;

599 
shi·
++;

602 
x11_r_shi·
 = 
shi·
;

605 
mask
 = 
x11_g_mask
;

606 
shi·
 = 0;

607 
	`as£π
(
mask
);

608 i‡(
mask
) {

609 (
mask
 & 0x80000000UL) == 0) {

610 
mask
 <<= 1;

611 
shi·
++;

614 
x11_g_shi·
 = 
shi·
;

617 
mask
 = 
x11_b_mask
;

618 
shi·
 = 0;

619 
	`as£π
(
mask
);

620 i‡(
mask
) {

621 (
mask
 & 0x80000000UL) == 0) {

622 
mask
 <<= 1;

623 
shi·
++;

626 
x11_b_shi·
 = 
shi·
;

628 
	`as£π
(0);

632 
x11_gc
 = 
	`XDeÁu…GC
(
x11_dpy
, 
x11_s¸
);

634 #i‡
MWPIXEL_FORMAT
 !
MWPF_PALETTE


635 
i
 = 0; i < 
COLOR_CACHE_SIZE
; i++)

636 
cˇche
[
i
].
öô
 = 1;

639 
	`£t_mode
(
gr_mode
);

643 
	`XSynchr⁄ize
(
x11_dpy
, 
True
);

645 
£tup_√eded
 = 0;

648 
	}
}

651 
PSD


652 
	$X11_›í
(
PSD
 
psd
)

654 
XSëWödowAâribuãs
 
©å
;

655 
Pixm≠
 
cur_em±y
;

656 
vÆuemask
;

657 
evít_mask
;

658 
XCﬁ‹
 
cﬁ‹
;

659 
Curs‹
 
curs‹
;

661 
PSUBDRIVER
 
subdrivî
;

662 
size
, 
löñí
;

663 
XSizeHöts
 *
sizehöts
;

665 i‡(
	`x11_£tup_di•œy
() < 0)

666  
NULL
;

668 
x11_evít_mask
 = 
Cﬁ‹m≠Ch™geMask
 | 
FocusCh™geMask
;

671 
evít_mask
 = 
x11_evít_mask
 | 
ExposuªMask
 | 
KeyPªssMask
 |

672 
KeyRñó£Mask
 |

673 
Buâ⁄PªssMask
 |

674 
Buâ⁄Rñó£Mask
 |

675 
PoöãrMŸi⁄Mask
;

678 #ifde‡
USE_EXPOSURE


679 
vÆuemask
 = 
CWSaveUndî
 | 
CWEvítMask
;

681 
vÆuemask
 = 
CWSaveUndî
 | 
CWEvítMask
 | 
CWBackögSt‹e
;

684 
©å
.
backög_°‹e
 = 
Always
;

685 
©å
.
ßve_undî
 = 
True
;

686 
©å
.
evít_mask
 =Évent_mask;

689 
x11_cﬁ‹m≠
 = 
	`XCª©eCﬁ‹m≠
(
x11_dpy
, 
	`XDeÁu…RoŸWödow
(x11_dpy),

690 
x11_vis
, 
AŒocN⁄e
);

691 
©å
.
cﬁ‹m≠
 = 
x11_cﬁ‹m≠
;

692 
vÆuemask
 |
CWCﬁ‹m≠
;

695 
x11_wö
 = 
	`XCª©eWödow
(
x11_dpy
, 
	`XDeÁu…RoŸWödow
(x11_dpy), 100,

697 
x11_width
,

698 
x11_height
,

700 
C›yFromP¨ít
,

701 
I≈utOuçut
,

702 
x11_vis
,

703 
vÆuemask
,

704 &
©å


707 
sizehöts
 = 
	`XAŒocSizeHöts
();

708 i‡(
sizehöts
 !
NULL
) {

709 
sizehöts
->
Êags
 = 
PMöSize
 | 
PMaxSize
;

710 
sizehöts
->
mö_width
 = 
x11_width
;

711 
sizehöts
->
mö_height
 = 
x11_height
;

712 
sizehöts
->
max_width
 = 
x11_width
;

713 
sizehöts
->
max_height
 = 
x11_height
;

714 
	`XSëWMN‹mÆHöts
(
x11_dpy
, 
x11_wö
, 
sizehöts
);

715 
	`XFªe
(
sizehöts
);

718 
x11_dïth
 = 
	`XDeÁu…Dïth
(
x11_dpy
, 
x11_s¸
);

728 
x11_cﬁ‹m≠
 = 
	`XDeÁu…Cﬁ‹m≠
(
x11_dpy
, 
x11_s¸
);

729 i‡(
x11_vis
->
˛ass
 & 1)

730 
x11_cﬁ‹m≠
 = 
	`XC›yCﬁ‹m≠AndFªe
(
x11_dpy
, x11_colormap);

745 
cur_em±y
 = 
	`XCª©eBôm≠FromD©a
(
x11_dpy
, 
x11_wö
, "\0", 1, 1);

746 
curs‹
 = 
	`XCª©ePixm≠Curs‹
(
x11_dpy
, 
cur_em±y
, cur_empty,

747 &
cﬁ‹
, &color, 0, 0);

748 
	`XDeföeCurs‹
(
x11_dpy
, 
x11_wö
, 
curs‹
);

749 
	`XSt‹eName
(
x11_dpy
, 
x11_wö
, "Microwindows");

751 
	`XM≠Wödow
(
x11_dpy
, 
x11_wö
);

752 
	`XFlush
(
x11_dpy
);

759 
	`XMaskEvít
(
x11_dpy
, 
x11_evít_mask
, &
ev
);

760 
	`XPutBackEvít
(
x11_dpy
, &
ev
);

762 
	`XIn°ÆlCﬁ‹m≠
(
x11_dpy
, 
x11_cﬁ‹m≠
);

764 
psd
->
xªs
 =Ösd->
xvúåes
 = 
x11_width
;

765 
psd
->
yªs
 =Ösd->
yvúåes
 = 
x11_height
;

766 
psd
->
löñí
 = 
x11_width
;

767 
psd
->
∂™es
 = 1;

768 
psd
->
pixty≥
 = 
MWPIXEL_FORMAT
;

769 
psd
->
pixty≥
) {

770 #i‡
MWPIXEL_FORMAT
 =
MWPF_PALETTE


771 
MWPF_PALETTE
:

772 
psd
->
bµ
 = 
SCREEN_DEPTH
;

775 
MWPF_TRUECOLOR0888
:

776 
MWPF_TRUECOLOR8888
:

778 
psd
->
bµ
 = 32;

780 
MWPF_TRUECOLOR888
:

781 
psd
->
bµ
 = 24;

783 
MWPF_TRUECOLOR565
:

784 
MWPF_TRUECOLOR555
:

785 
psd
->
bµ
 = 16;

787 
MWPF_TRUECOLOR332
:

788 
psd
->
bµ
 = 8;

794 
	`GdCÆcMemGCAŒoc
(
psd
,Ösd->
xªs
,Ösd->
yªs
,Ösd->
∂™es
,

795 
psd
->
bµ
, &
size
, &psd->
löñí
);

797 
psd
->
ncﬁ‹s
 =Ösd->
bµ
 >= 24 ? (1 << 24) : (1 <<Ösd->bpp);

798 
psd
->
Êags
 = 
PSF_SCREEN
 | 
PSF_HAVEBLIT
;

799 
psd
->
size
 = 0;

800 
psd
->
addr
 = 
NULL
;

801 
psd
->
p‹åaô
 = 
MWPORTRAIT_NONE
;

804 
ßvebôs
 = *
psd
;

805 
ßvebôs
.
Êags
 = 
PSF_MEMORY
 | 
PSF_HAVEBLIT
;

808 
subdrivî
 = 
	`£À˘_fb_subdrivî
(&
ßvebôs
);

809 i‡(!
subdrivî
)

810  
NULL
;

814 
	`GdCÆcMemGCAŒoc
(&
ßvebôs
, savebôs.
xvúåes
, savebôs.
yvúåes
, 0,

815 0, &
size
, &
löñí
);

816 
ßvebôs
.
löñí
 =Üinelen;

817 
ßvebôs
.
size
 = size;

818 i‡((
ßvebôs
.
addr
 = 
	`mÆloc
(
size
)Ë=
NULL
)

819  
NULL
;

821 
	`£t_subdrivî
(&
ßvebôs
, 
subdrivî
, 
TRUE
);

825 
psd
->
addr
 = 
ßvebôs
.addr;

827  
psd
;

828 
	}
}

831 
	$X11_˛o£
(
PSD
 
psd
)

834 
	`‰ì
(
ßvebôs
.
addr
);

836 
	`XClo£Di•œy
(
x11_dpy
);

837 
	}
}

841 
	$X11_gës¸ìnöfo
(
PSD
 
psd
, 
PMWSCREENINFO
 
psi
)

843 
psi
->
rows
 = 
psd
->
yvúåes
;

844 
psi
->
cﬁs
 = 
psd
->
xvúåes
;

845 
psi
->
∂™es
 = 
psd
->planes;

846 
psi
->
bµ
 = 
psd
->bpp;

847 
psi
->
ncﬁ‹s
 = 
psd
->ncolors;

848 
psi
->
p‹åaô
 = 
psd
->portrait;

849 
psi
->
f⁄ts
 = 
NUMBER_FONTS
;

850 
psi
->
xdpcm
 = (
	`Di•œyWidth
(
x11_dpy
, 
x11_s¸
) * 10) /

851 
	`Di•œyWidthMM
(
x11_dpy
, 
x11_s¸
);

852 
psi
->
ydpcm
 = (
	`Di•œyHeight
(
x11_dpy
, 
x11_s¸
) * 10) /

853 
	`Di•œyHeightMM
(
x11_dpy
, 
x11_s¸
);

855 
psi
->
fbdrivî
 = 
FALSE
;

856 
psi
->
pixty≥
 = 
psd
->pixtype;

857 
psd
->
pixty≥
) {

858 
MWPF_TRUECOLOR0888
:

859 
MWPF_TRUECOLOR8888
:

860 
MWPF_TRUECOLOR888
:

861 
psi
->
rmask
 = 0xff0000;

862 
psi
->
gmask
 = 0x00ff00;

863 
psi
->
bmask
 = 0x0000ff;

865 
MWPF_TRUECOLOR565
:

866 
psi
->
rmask
 = 0xf800;

867 
psi
->
gmask
 = 0x07e0;

868 
psi
->
bmask
 = 0x001f;

870 
MWPF_TRUECOLOR555
:

871 
psi
->
rmask
 = 0x7c00;

872 
psi
->
gmask
 = 0x03e0;

873 
psi
->
bmask
 = 0x001f;

875 
MWPF_TRUECOLOR332
:

876 
psi
->
rmask
 = 0xe0;

877 
psi
->
gmask
 = 0x1c;

878 
psi
->
bmask
 = 0x03;

880 
MWPF_PALETTE
:

882 
psi
->
rmask
 = 0xff;

883 
psi
->
gmask
 = 0xff;

884 
psi
->
bmask
 = 0xff;

887 
	}
}

890 
	$X11_£çÆëã
(
PSD
 
psd
, 
fú°
, 
cou¡
, 
MWPALENTRY
 * 
∑l
)

892 
i
;

893 
n
;

895 
i
 = 0; i < 
cou¡
; i++) {

896 
•ec
[20];

897 
r
, 
g
, 
b
;

898 
XCﬁ‹
 
exa˘
;

899 
XCﬁ‹
 
def
;

901 
r
 = 
∑l
[
i
].r;

902 
g
 = 
∑l
[
i
].g;

903 
b
 = 
∑l
[
i
].b;

904 
	`•rötf
(
•ec
, "#%02x%02x%02x", 
r
, 
g
, 
b
);

905 
	`XLookupCﬁ‹
(
x11_dpy
, 
x11_cﬁ‹m≠
, 
•ec
, &
exa˘
, &
def
);

906 
	`XAŒocCﬁ‹
(
x11_dpy
, 
x11_cﬁ‹m≠
, &
def
);

910 
x11_∑Àâe
[
fú°
 + 
i
] = 
def
;

912 
n
 = 
fú°
 + 
cou¡
 - 1;

913 i‡(
n
 > 
x11_∑l_max
)

914 
x11_∑l_max
 = 
n
;

915 
	}
}

919 
	$X11_døwpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

922 
ßvebôs
.
	`DøwPixñ
(&ßvebôs, 
x
, 
y
, 
c
);

924 i‡(
gr_mode
 =
MWMODE_COPY
) {

925 
	`£t_cﬁ‹
(
c
);

926 
	`£t_mode
(
gr_mode
);

927 
	`XDøwPoöt
(
x11_dpy
, 
x11_wö
, 
x11_gc
, 
x
, 
y
);

929 
	`upd©e_‰om_ßvebôs
(
x
, 
y
, 1, 1);

931 
	}
}

933 
MWPIXELVAL


934 
	$X11_ªadpixñ
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

937  
ßvebôs
.
	`RódPixñ
(&ßvebôs, 
x
, 
y
);

938 
	}
}

941 
	$X11_døwhlöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
, 
MWPIXELVAL
 
c
)

944 
ßvebôs
.
	`DøwH‹zLöe
(&ßvebôs, 
x1
, 
x2
, 
y
, 
c
);

946 i‡(
gr_mode
 =
MWMODE_COPY
) {

947 
	`£t_cﬁ‹
(
c
);

948 
	`£t_mode
(
gr_mode
);

949 
	`XDøwLöe
(
x11_dpy
, 
x11_wö
, 
x11_gc
, 
x1
, 
y
, 
x2
, y);

951 
	`upd©e_‰om_ßvebôs
((
x1
 < 
x2
 ? x1 : x2), 
y
,

952 (
x1
 < 
x2
 ? x2 - x1 + 1 : x1 - x2 + 1),

955 
	}
}

958 
	$X11_døwvlöe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y1
, MWCOORD 
y2
, 
MWPIXELVAL
 
c
)

960 
ßvebôs
.
	`DøwVîtLöe
(&ßvebôs, 
x
, 
y1
, 
y2
, 
c
);

962 i‡(
gr_mode
 =
MWMODE_COPY
) {

963 
	`£t_cﬁ‹
(
c
);

964 
	`£t_mode
(
gr_mode
);

965 
	`XDøwLöe
(
x11_dpy
, 
x11_wö
, 
x11_gc
, 
x
, 
y1
, x, 
y2
);

967 
	`upd©e_‰om_ßvebôs
(
x
, (
y1
 < 
y2
 ? y1 : y2),

969 (
y1
 < 
y2
 ? y2 - y1 + 1 : y1 - y2 + 1));

971 
	}
}

974 
	$X11_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

975 
MWPIXELVAL
 
c
)

978 
ßvebôs
.
	`FûlRe˘
(&ßvebôs, 
x1
, 
y1
, 
x2
, 
y2
, 
c
);

980 i‡(
gr_mode
 =
MWMODE_COPY
) {

981 
	`£t_cﬁ‹
(
c
);

982 
	`£t_mode
(
gr_mode
);

983 
	`XFûlRe˘™gÀ
(
x11_dpy
, 
x11_wö
, 
x11_gc
, 
x1
, 
y1
,

984 (
x2
 - 
x1
Ë+ 1, (
y2
 - 
y1
) + 1);

986 
	`upd©e_‰om_ßvebôs
(
x1
, 
y1
, (
x2
-x1)+1, (
y2
-y1)+1);

988 
	}
}

991 
	$X11_blô
(
PSD
 
d°psd
, 
MWCOORD
 
de°x
, MWCOORD 
de°y
, MWCOORD 
w
, MWCOORD 
h
,

992 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
›
)

994 i‡(
›
 =
MWMODE_NOOP
) {

998 i‡(
§˝sd
->
Êags
 & 
PSF_SCREEN
) {

1000 
§˝sd
 = &
ßvebôs
;

1003 i‡(!(
d°psd
->
Êags
 & 
PSF_SCREEN
)) {

1005 
d°psd
->
	`Blô
(d°psd, 
de°x
, 
de°y
, 
w
, 
h
, 
§˝sd
, 
§cx
, 
§cy
,

1006 
›
);

1011 
ßvebôs
.
	`Blô
(&ßvebôs, 
de°x
, 
de°y
, 
w
, 
h
, 
§˝sd
, 
§cx
, 
§cy
, 
›
);

1018 i‡((
§˝sd
 =&
ßvebôs
Ë&& (
›
 =
MWMODE_COPY
))

1021 i‡((
§˝sd
 =&
ßvebôs
Ë&& (
›
 >0Ë&& (› <
MWMODE_MAX
))

1031 
	`£t_mode
(
›
);

1032 
	`XC›yAªa
(
x11_dpy
, 
x11_wö
, x11_wö, 
x11_gc
,

1033 
§cx
, 
§cy
, 
w
, 
h
, 
de°x
, 
de°y
);

1047 
	`upd©e_‰om_ßvebôs
(
de°x
, 
de°y
, 
w
, 
h
);

1049 
	}
}

1052 
	$X11_°ªtchblôex
(
PSD
 
d°psd
, PSD 
§˝sd
,

1053 
MWCOORD
 
de°_x_°¨t
, MWCOORD 
de°_y_°¨t
,

1054 
MWCOORD
 
width
, MWCOORD 
height
,

1055 
x_díomö©‹
, 
y_díomö©‹
,

1056 
§c_x_‰a˘i⁄
, 
§c_y_‰a˘i⁄
,

1057 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
)

1059 i‡(
›
 =
MWMODE_NOOP
) {

1066 i‡(
§˝sd
->
Êags
 & 
PSF_SCREEN
) {

1068 
§˝sd
 = &
ßvebôs
;

1071 i‡(!(
d°psd
->
Êags
 & 
PSF_SCREEN
)) {

1073 
d°psd
->
	`SåëchBlôEx
(d°psd, 
§˝sd
,

1074 
de°_x_°¨t
, 
de°_y_°¨t
,

1075 
width
, 
height
,

1076 
x_díomö©‹
, 
y_díomö©‹
,

1077 
§c_x_‰a˘i⁄
, 
§c_y_‰a˘i⁄
,

1078 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
);

1083 
ßvebôs
.
	`SåëchBlôEx
(&ßvebôs, 
§˝sd
,

1084 
de°_x_°¨t
, 
de°_y_°¨t
,

1085 
width
, 
height
,

1086 
x_díomö©‹
, 
y_díomö©‹
,

1087 
§c_x_‰a˘i⁄
, 
§c_y_‰a˘i⁄
,

1088 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
);

1094 
	`upd©e_‰om_ßvebôs
(
de°_x_°¨t
, 
de°_y_°¨t
, 
width
, 
height
);

1095 
	}
}

1098 
	$X11_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1100 
	`as£π
(
psd
->
addr
 != 0);

1102 
	`as£π
(
gc
->
d°x
 >0 && gc->d°x + gc->
d°w
 <
psd
->
xªs
);

1105 
	`as£π
(
gc
->
§cy
 >= 0);

1107 
ßvebôs
.
	`DøwAªa
(&ßvebôs, 
gc
, 
›
);

1109 
	`upd©e_‰om_ßvebôs
(
gc
->
d°x
, gc->
d°y
, gc->
d°w
, gc->
d°h
);

1110 
	}
}

1115 
	$X11_¥e£À˘
(
PSD
 
psd
)

1117 
	`XFlush
(
x11_dpy
);

1118 
	}
}

	@drivers/touchscreen_ads.h

1 #i‚de‡
TS_DEVICE


2 
	#TS_DEVICE
 "ADS"

	)

4 
	#TS_DEVICE_FILE
 "/dev/ts"

	)

6 
	sts_evít
 {

7 
	mx
;

8 
	my
;

9 
	m¥essuª
;

	@drivers/touchscreen_ads7846.h

1 #i‚de‡
TS_DEVICE


2 
	#TS_DEVICE
 "ADS7846"

	)

4 
	#TS_DEVICE_FILE
 "/dev/önov©‹_ts"

	)

6 
	sts_evít
 {

7 
	m¥essuª
;

8 
	mx
;

9 
	my
;

10 
	m∑d
;

11 
timevÆ
 
	m°amp
;

	@drivers/touchscreen_ipaq.h

1 #i‚de‡
TS_DEVICE


2 
	#TS_DEVICE
 "I∑q"

	)

4 
	#TS_DEVICE_FILE
 "/dev/h3600_t§aw"

	)

6 
	sts_evít
 {

7 
	m¥essuª
;

8 
	mx
;

9 
	my
;

10 
	m∑d
;

	@drivers/touchscreen_ucb1x00.h

1 #i‚de‡
TS_DEVICE


2 
	#TS_DEVICE
 "UCB1X00"

	)

4 
	#TS_DEVICE_FILE
 "/dev/ucb1x00-ts"

	)

6 
	~<sys/time.h
>

8 
	sts_evít
 {

9 
	m¥essuª
;

10 
	mx
;

11 
	my
;

12 
	m∑d
;

13 
timevÆ
 
	m°amp
;

	@drivers/touchscreen_zaurus.h

1 #i‚de‡
TS_DEVICE


2 
	#TS_DEVICE
 "Zaurus"

	)

4 
	#TS_DEVICE_FILE
 "/dev/sh¨p_ts"

	)

6 
	sts_evít
 {

7 
	mx
;

8 
	my
;

9 
	m¥essuª
;

10 
	mtime°amp
;

	@drivers/vgainit.c

9 
	~"devi˚.h
"

10 
	~"vg≠œn4.h
"

12 #ifde‡
__πems__


13 
	#ROMFONT
 0

	)

15 
	#ROMFONT
 1

	)

19 
	#VGA_ET4000
 0

	)

20 
	#VGA_STANDARD
 1

	)

21 
	#EGA_STANDARD
 0

	)

23 
	#DONE
 0

	)

24 
	#IN
 1

	)

25 
	#OUT
 2

	)

27 
	#RAM_SCAN_LINES
 32

	)

28 
	#FONT_CHARS
 256

	)

29 
	#CHAR_WIDTH
 8

	)

31 
	#PALREG
 0x3c0

	)

32 
	#SEQREG
 0x3c4

	)

33 
	#SEQVAL
 0x3c5

	)

34 
	#GRREG
 0x3˚

	)

35 
	#GRVAL
 0x3cf

	)

36 
	#ATTRREG
 0x3da

	)

37 
	#CRTCREG
 0x3d4

	)

38 
	#CRTCVAL
 0x3d5

	)

40 
	#GENREG1
 0x3c2

	)

41 
	#GENREG2
 0x3cc

	)

42 
	#GENREG3
 0x3ˇ

	)

44 
	#DATA_ROTATE
 3

	)

47 
	ma˘i⁄
;

48 
	mp‹t1
;

49 
	md©a1
;

50 
	mp‹t2
;

51 
	md©a2
;

52 } 
	tREGIO
;

55 #i‡
ROMFONT


56 
FARADDR
 
rom_ch¨_addr
;

57 
ROM_CHAR_HEIGHT
;

61 
REGIO
 
gøphics_⁄
[];

62 
REGIO
 
gøph_off
[];

65 
ega_hwöô
();

66 
ega_hwãrm
();

69 
wrôîegs
(
REGIO
 *
Ω
);

70 
out_w‹d
(
p
,
d
);

71 
£tmode
(
mode
);

74 
	$ega_hwöô
()

76 
	`wrôîegs
(
gøphics_⁄
);

77 
	}
}

80 
	$ega_hwãrm
()

82 
	`£tmode
(
MWMODE_COPY
);

87 
	`out_w‹d
(
SEQREG
, 0x0100);

88 
	`out_w‹d
(
SEQREG
, 0x0402);

89 
	`out_w‹d
(
SEQREG
, 0x0704);

90 
	`out_w‹d
(
SEQREG
, 0x0300);

92 
	`out_w‹d
(
GRREG
, 0x0204);

93 
	`out_w‹d
(
GRREG
, 0x0005);

95 #i‡
ROMFONT


97 
FARADDR
 
§coff£t
;

98 
FARADDR
 
de°off£t
;

99 
d©a
;

100 
ch
;

101 
row
;

103 
§coff£t
 = 
rom_ch¨_addr
;

104 
de°off£t
 = 
EGA_BASE
;

105 
ch
 = 0; ch < 
FONT_CHARS
; ch++) {

106 
row
 = 0;Ñow < 
ROM_CHAR_HEIGHT
;Ñow++) {

107 
d©a
 = 
	`GETBYTE_FP
(
§coff£t
++);

108 
	`PUTBYTE_FP
(
de°off£t
++, 
d©a
);

110 
de°off£t
 +(
RAM_SCAN_LINES
 - 
ROM_CHAR_HEIGHT
);

116 
	`wrôîegs
(
gøph_off
);

117 
	}
}

121 
	$wrôîegs
(
REGIO
 *
Ω
)

123 ; 
Ω
->
a˘i⁄
 !
DONE
;Ñp++) {

124 
Ω
->
a˘i⁄
) {

125 
IN
:

126 
	`öp
(
Ω
->
p‹t1
);

128 
OUT
:

129 
	`ouç
(
Ω
->
p‹t1
,Ñp->
d©a1
);

130 i‡(
Ω
->
p‹t2
)

131 
	`ouç
(
Ω
->
p‹t2
,Ñp->
d©a2
);

135 
	}
}

139 
	$out_w‹d
(
p
,
d
)

141 
	`ouç
(
p
, 
d
 & 0xff);

142 
	`ouç
(
p
 + 1, (
d
 >> 8) & 0xff);

143 
	}
}

147 
	gmode_èbÀ
[
MWMODE_MAX
 + 1] = {

158 
	$£tmode
(
mode
)

160 i‡(
mode
 > 
MWMODE_MAX
)

162 
	`ouç
(
GRREG
, 
DATA_ROTATE
);

163 
	`ouç
(
GRVAL
, 
mode_èbÀ
[
mode
]);

164 
	}
}

167 #i‡
VGA_ET4000


171 
REGIO
 
	ggøphics_⁄
[] = {

173 
IN
, 
ATTRREG
, 0, 0, 0,

176 
OUT
, 
PALREG
, 0, 0, 0,

179 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0,

180 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

181 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 0x0f,

182 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

183 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 6,

186 
OUT
, 
GENREG1
, 0xe3, 0, 0,

189 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0x03,

192 
OUT
, 
CRTCREG
, 0x11, 
CRTCVAL
, 0,

195 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x7a,

196 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x63,

197 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x64,

198 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x1d,

199 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x68,

200 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x9a,

201 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0x78,

202 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0xf0,

203 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

204 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x60,

205 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

206 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x00,

207 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x00,

208 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0x00,

209 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x00,

210 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x00,

211 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0x5c,

212 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x8e,

213 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0x57,

214 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x32,

215 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x00,

216 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0x5b,

217 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0x75,

218 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xc3,

219 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

222 
OUT
, 
GENREG2
, 0x00, 0, 0,

223 
OUT
, 
GENREG3
, 0x01, 0, 0,

224 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

225 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

226 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

227 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

228 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

229 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x00,

230 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x05,

231 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x0f,

232 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

235 
IN
, 
ATTRREG
, 0, 0, 0,

238 
OUT
, 
PALREG
, 0, PALREG, 0x00,

239 
OUT
, 
PALREG
, 1, PALREG, 0x01,

240 
OUT
, 
PALREG
, 2, PALREG, 0x02,

241 
OUT
, 
PALREG
, 3, PALREG, 0x03,

242 
OUT
, 
PALREG
, 4, PALREG, 0x04,

243 
OUT
, 
PALREG
, 5, PALREG, 0x05,

244 
OUT
, 
PALREG
, 6, PALREG, 0x06,

245 
OUT
, 
PALREG
, 7, PALREG, 0x07,

246 
OUT
, 
PALREG
, 8, PALREG, 0x38,

247 
OUT
, 
PALREG
, 9, PALREG, 0x39,

248 
OUT
, 
PALREG
, 10, PALREG, 0x3a,

249 
OUT
, 
PALREG
, 11, PALREG, 0x3b,

250 
OUT
, 
PALREG
, 12, PALREG, 0x3c,

251 
OUT
, 
PALREG
, 13, PALREG, 0x3d,

252 
OUT
, 
PALREG
, 14, PALREG, 0x3e,

253 
OUT
, 
PALREG
, 15, PALREG, 0x3f,

254 
OUT
, 
PALREG
, 16, PALREG, 0x01,

255 
OUT
, 
PALREG
, 17, PALREG, 0x00,

256 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

257 
OUT
, 
PALREG
, 19, PALREG, 0x00,

260 
OUT
, 
PALREG
, 0x20, 0, 0,

263 
DONE
, 0, 0, 0, 0

269 
REGIO
 
	ggøph_off
[] = {

271 
IN
, 
ATTRREG
, 0, 0, 0,

274 
OUT
, 
PALREG
, 0, 0, 0,

277 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 1,

278 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

279 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 3,

280 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

281 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 2,

284 
OUT
, 
GENREG1
, 0x63, 0, 0,

287 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 3,

290 
OUT
, 
CRTCREG
, 0x11, 
CRTCVAL
, 0,

293 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x5f,

294 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x4f,

295 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x50,

296 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x82,

297 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x55,

298 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x81,

299 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0xbf,

300 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0x1f,

301 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

302 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x4f,

303 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

304 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x0f,

305 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x0e,

306 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0xb0,

307 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x16,

308 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x30,

309 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0x9c,

310 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x8e,

311 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0x8f,

312 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x28,

313 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x1f,

314 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0x96,

315 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0xb9,

316 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xa3,

317 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

320 
OUT
, 
GENREG2
, 0x00, 0, 0,

321 
OUT
, 
GENREG3
, 0x01, 0, 0,

322 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

323 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

324 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

325 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

326 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

327 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x10,

328 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x0e,

329 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x00,

330 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

333 
IN
, 
ATTRREG
, 0, 0, 0,

336 
OUT
, 
PALREG
, 0, PALREG, 0x00,

337 
OUT
, 
PALREG
, 1, PALREG, 0x01,

338 
OUT
, 
PALREG
, 2, PALREG, 0x02,

339 
OUT
, 
PALREG
, 3, PALREG, 0x03,

340 
OUT
, 
PALREG
, 4, PALREG, 0x04,

341 
OUT
, 
PALREG
, 5, PALREG, 0x05,

342 
OUT
, 
PALREG
, 6, PALREG, 0x06,

343 
OUT
, 
PALREG
, 7, PALREG, 0x07,

344 
OUT
, 
PALREG
, 8, PALREG, 0x10,

345 
OUT
, 
PALREG
, 9, PALREG, 0x11,

346 
OUT
, 
PALREG
, 10, PALREG, 0x12,

347 
OUT
, 
PALREG
, 11, PALREG, 0x13,

348 
OUT
, 
PALREG
, 12, PALREG, 0x14,

349 
OUT
, 
PALREG
, 13, PALREG, 0x15,

350 
OUT
, 
PALREG
, 14, PALREG, 0x16,

351 
OUT
, 
PALREG
, 15, PALREG, 0x17,

352 
OUT
, 
PALREG
, 16, PALREG, 0x08,

353 
OUT
, 
PALREG
, 17, PALREG, 0x00,

354 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

355 
OUT
, 
PALREG
, 19, PALREG, 0x00,

358 
OUT
, 
PALREG
, 0x20, 0, 0,

361 
DONE
, 0, 0, 0, 0

367 #i‡
VGA_STANDARD


371 
REGIO
 
	ggøphics_⁄
[] = {

373 
IN
, 
ATTRREG
, 0, 0, 0,

376 
OUT
, 
PALREG
, 0, 0, 0,

379 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0,

380 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

381 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 0x0f,

382 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

383 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 6,

386 
OUT
, 
GENREG1
, 0xe3, 0, 0,

389 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0x03,

392 
OUT
, 
CRTCREG
, 0x11, 
CRTCVAL
, 0,

395 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x5f,

396 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x4f,

397 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x50,

398 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x82,

399 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x54,

400 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x80,

401 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0x0b,

402 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0x3e,

403 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

404 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x40,

405 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

406 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x00,

407 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x00,

408 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0x00,

409 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x00,

410 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x59,

411 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0xea,

412 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x8c,

413 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0xdf,

414 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x28,

415 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x00,

416 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0xe7,

417 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0x04,

418 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xe3,

419 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

422 
OUT
, 
GENREG2
, 0x00, 0, 0,

423 
OUT
, 
GENREG3
, 0x01, 0, 0,

424 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

425 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

426 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

427 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

428 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

429 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x00,

430 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x05,

431 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x0f,

432 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

435 
IN
, 
ATTRREG
, 0, 0, 0,

438 
OUT
, 
PALREG
, 0, PALREG, 0x00,

439 
OUT
, 
PALREG
, 1, PALREG, 0x01,

440 
OUT
, 
PALREG
, 2, PALREG, 0x02,

441 
OUT
, 
PALREG
, 3, PALREG, 0x03,

442 
OUT
, 
PALREG
, 4, PALREG, 0x04,

443 
OUT
, 
PALREG
, 5, PALREG, 0x05,

444 
OUT
, 
PALREG
, 6, PALREG, 0x06,

445 
OUT
, 
PALREG
, 7, PALREG, 0x07,

446 
OUT
, 
PALREG
, 8, PALREG, 0x38,

447 
OUT
, 
PALREG
, 9, PALREG, 0x39,

448 
OUT
, 
PALREG
, 10, PALREG, 0x3a,

449 
OUT
, 
PALREG
, 11, PALREG, 0x3b,

450 
OUT
, 
PALREG
, 12, PALREG, 0x3c,

451 
OUT
, 
PALREG
, 13, PALREG, 0x3d,

452 
OUT
, 
PALREG
, 14, PALREG, 0x3e,

453 
OUT
, 
PALREG
, 15, PALREG, 0x3f,

454 
OUT
, 
PALREG
, 16, PALREG, 0x01,

455 
OUT
, 
PALREG
, 17, PALREG, 0x00,

456 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

457 
OUT
, 
PALREG
, 19, PALREG, 0x00,

460 
OUT
, 
PALREG
, 0x20, 0, 0,

463 
DONE
, 0, 0, 0, 0

469 
REGIO
 
	ggøph_off
[] = {

471 
IN
, 
ATTRREG
, 0, 0, 0,

474 
OUT
, 
PALREG
, 0, 0, 0,

477 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 1,

478 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

479 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 3,

480 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

481 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 2,

484 
OUT
, 
GENREG1
, 0x63, 0, 0,

487 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 3,

490 
OUT
, 
CRTCREG
, 0x11, 
CRTCVAL
, 0,

493 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x5f,

494 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x4f,

495 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x50,

496 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x82,

497 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x55,

498 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x81,

499 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0xbf,

500 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0x1f,

501 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

502 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x4f,

503 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

504 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x0f,

505 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x0e,

506 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0xb0,

507 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x16,

508 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x30,

509 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0x9c,

510 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x8e,

511 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0x8f,

512 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x28,

513 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x1f,

514 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0x96,

515 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0xb9,

516 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xa3,

517 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

520 
OUT
, 
GENREG2
, 0x00, 0, 0,

521 
OUT
, 
GENREG3
, 0x01, 0, 0,

522 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

523 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

524 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

525 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

526 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

527 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x10,

528 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x0e,

529 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x00,

530 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

533 
IN
, 
ATTRREG
, 0, 0, 0,

536 
OUT
, 
PALREG
, 0, PALREG, 0x00,

537 
OUT
, 
PALREG
, 1, PALREG, 0x01,

538 
OUT
, 
PALREG
, 2, PALREG, 0x02,

539 
OUT
, 
PALREG
, 3, PALREG, 0x03,

540 
OUT
, 
PALREG
, 4, PALREG, 0x04,

541 
OUT
, 
PALREG
, 5, PALREG, 0x05,

542 
OUT
, 
PALREG
, 6, PALREG, 0x06,

543 
OUT
, 
PALREG
, 7, PALREG, 0x07,

544 
OUT
, 
PALREG
, 8, PALREG, 0x10,

545 
OUT
, 
PALREG
, 9, PALREG, 0x11,

546 
OUT
, 
PALREG
, 10, PALREG, 0x12,

547 
OUT
, 
PALREG
, 11, PALREG, 0x13,

548 
OUT
, 
PALREG
, 12, PALREG, 0x14,

549 
OUT
, 
PALREG
, 13, PALREG, 0x15,

550 
OUT
, 
PALREG
, 14, PALREG, 0x16,

551 
OUT
, 
PALREG
, 15, PALREG, 0x17,

552 
OUT
, 
PALREG
, 16, PALREG, 0x08,

553 
OUT
, 
PALREG
, 17, PALREG, 0x00,

554 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

555 
OUT
, 
PALREG
, 19, PALREG, 0x00,

558 
OUT
, 
PALREG
, 0x20, 0, 0,

561 
DONE
, 0, 0, 0, 0

567 #i‡
EGA_STANDARD


571 
REGIO
 
	ggøphics_⁄
[] = {

573 
IN
, 
ATTRREG
, 0, 0, 0,

576 
OUT
, 
PALREG
, 0, 0, 0,

579 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0,

580 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

581 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 0x0f,

582 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

583 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 6,

586 
OUT
, 
GENREG1
, 0xa7, 0, 0,

589 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 0x03,

592 
OUT
, 
CRTCREG
, 0x11, 
CRTCVAL
, 0,

595 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x5b,

596 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x4f,

597 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x53,

598 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x37,

599 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x52,

600 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x00,

601 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0x6c,

602 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0x1f,

603 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

604 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x00,

605 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

606 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x00,

607 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x00,

608 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0x00,

609 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x00,

610 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x00,

611 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0x5e,

612 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x2b,

613 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0x5d,

614 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x28,

615 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x0f,

616 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0x5f,

617 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0x0a,

618 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xe3,

619 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

622 
OUT
, 
GENREG2
, 0x00, 0, 0,

623 
OUT
, 
GENREG3
, 0x01, 0, 0,

624 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

625 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

626 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

627 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

628 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

629 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x00,

630 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x05,

631 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x0f,

632 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

635 
IN
, 
ATTRREG
, 0, 0, 0,

638 
OUT
, 
PALREG
, 0, PALREG, 0x00,

639 
OUT
, 
PALREG
, 1, PALREG, 0x01,

640 
OUT
, 
PALREG
, 2, PALREG, 0x02,

641 
OUT
, 
PALREG
, 3, PALREG, 0x03,

642 
OUT
, 
PALREG
, 4, PALREG, 0x04,

643 
OUT
, 
PALREG
, 5, PALREG, 0x05,

644 
OUT
, 
PALREG
, 6, PALREG, 0x06,

645 
OUT
, 
PALREG
, 7, PALREG, 0x07,

646 
OUT
, 
PALREG
, 8, PALREG, 0x38,

647 
OUT
, 
PALREG
, 9, PALREG, 0x39,

648 
OUT
, 
PALREG
, 10, PALREG, 0x3a,

649 
OUT
, 
PALREG
, 11, PALREG, 0x3b,

650 
OUT
, 
PALREG
, 12, PALREG, 0x3c,

651 
OUT
, 
PALREG
, 13, PALREG, 0x3d,

652 
OUT
, 
PALREG
, 14, PALREG, 0x3e,

653 
OUT
, 
PALREG
, 15, PALREG, 0x3f,

654 
OUT
, 
PALREG
, 16, PALREG, 0x01,

655 
OUT
, 
PALREG
, 17, PALREG, 0x00,

656 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

657 
OUT
, 
PALREG
, 19, PALREG, 0x00,

660 
OUT
, 
PALREG
, 0x20, 0, 0,

663 
DONE
, 0, 0, 0, 0

669 
REGIO
 
	ggøph_off
[] = {

671 
IN
, 
ATTRREG
, 0, 0, 0,

674 
OUT
, 
PALREG
, 0, 0, 0,

677 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 1,

678 
OUT
, 
SEQREG
, 1, 
SEQVAL
, 1,

679 
OUT
, 
SEQREG
, 2, 
SEQVAL
, 3,

680 
OUT
, 
SEQREG
, 3, 
SEQVAL
, 0,

681 
OUT
, 
SEQREG
, 4, 
SEQVAL
, 3,

684 
OUT
, 
GENREG1
, 0xa7, 0, 0,

687 
OUT
, 
SEQREG
, 0, 
SEQVAL
, 3,

690 
OUT
, 
CRTCREG
, 0, 
CRTCVAL
, 0x5b,

691 
OUT
, 
CRTCREG
, 1, 
CRTCVAL
, 0x4f,

692 
OUT
, 
CRTCREG
, 2, 
CRTCVAL
, 0x53,

693 
OUT
, 
CRTCREG
, 3, 
CRTCVAL
, 0x37,

694 
OUT
, 
CRTCREG
, 4, 
CRTCVAL
, 0x51,

695 
OUT
, 
CRTCREG
, 5, 
CRTCVAL
, 0x5b,

696 
OUT
, 
CRTCREG
, 6, 
CRTCVAL
, 0x6c,

697 
OUT
, 
CRTCREG
, 7, 
CRTCVAL
, 0x1f,

698 
OUT
, 
CRTCREG
, 8, 
CRTCVAL
, 0x00,

699 
OUT
, 
CRTCREG
, 9, 
CRTCVAL
, 0x0d,

700 
OUT
, 
CRTCREG
, 10, 
CRTCVAL
, 0x00,

701 
OUT
, 
CRTCREG
, 11, 
CRTCVAL
, 0x0f,

702 
OUT
, 
CRTCREG
, 12, 
CRTCVAL
, 0x00,

703 
OUT
, 
CRTCREG
, 13, 
CRTCVAL
, 0x00,

704 
OUT
, 
CRTCREG
, 14, 
CRTCVAL
, 0x00,

705 
OUT
, 
CRTCREG
, 15, 
CRTCVAL
, 0x00,

706 
OUT
, 
CRTCREG
, 16, 
CRTCVAL
, 0x5e,

707 
OUT
, 
CRTCREG
, 17, 
CRTCVAL
, 0x2b,

708 
OUT
, 
CRTCREG
, 18, 
CRTCVAL
, 0x5d,

709 
OUT
, 
CRTCREG
, 19, 
CRTCVAL
, 0x28,

710 
OUT
, 
CRTCREG
, 20, 
CRTCVAL
, 0x0f,

711 
OUT
, 
CRTCREG
, 21, 
CRTCVAL
, 0x5e,

712 
OUT
, 
CRTCREG
, 22, 
CRTCVAL
, 0x0a,

713 
OUT
, 
CRTCREG
, 23, 
CRTCVAL
, 0xa3,

714 
OUT
, 
CRTCREG
, 24, 
CRTCVAL
, 0xff,

717 
OUT
, 
GENREG2
, 0x00, 0, 0,

718 
OUT
, 
GENREG3
, 0x01, 0, 0,

719 
OUT
, 
GRREG
, 0, 
GRVAL
, 0x00,

720 
OUT
, 
GRREG
, 1, 
GRVAL
, 0x00,

721 
OUT
, 
GRREG
, 2, 
GRVAL
, 0x00,

722 
OUT
, 
GRREG
, 3, 
GRVAL
, 0x00,

723 
OUT
, 
GRREG
, 4, 
GRVAL
, 0x00,

724 
OUT
, 
GRREG
, 5, 
GRVAL
, 0x10,

725 
OUT
, 
GRREG
, 6, 
GRVAL
, 0x0e,

726 
OUT
, 
GRREG
, 7, 
GRVAL
, 0x00,

727 
OUT
, 
GRREG
, 8, 
GRVAL
, 0xff,

730 
IN
, 
ATTRREG
, 0, 0, 0,

733 
OUT
, 
PALREG
, 0, PALREG, 0x00,

734 
OUT
, 
PALREG
, 1, PALREG, 0x01,

735 
OUT
, 
PALREG
, 2, PALREG, 0x02,

736 
OUT
, 
PALREG
, 3, PALREG, 0x03,

737 
OUT
, 
PALREG
, 4, PALREG, 0x04,

738 
OUT
, 
PALREG
, 5, PALREG, 0x05,

739 
OUT
, 
PALREG
, 6, PALREG, 0x14,

740 
OUT
, 
PALREG
, 7, PALREG, 0x07,

741 
OUT
, 
PALREG
, 8, PALREG, 0x38,

742 
OUT
, 
PALREG
, 9, PALREG, 0x39,

743 
OUT
, 
PALREG
, 10, PALREG, 0x3a,

744 
OUT
, 
PALREG
, 11, PALREG, 0x3b,

745 
OUT
, 
PALREG
, 12, PALREG, 0x3c,

746 
OUT
, 
PALREG
, 13, PALREG, 0x3d,

747 
OUT
, 
PALREG
, 14, PALREG, 0x3e,

748 
OUT
, 
PALREG
, 15, PALREG, 0x3f,

749 
OUT
, 
PALREG
, 16, PALREG, 0x08,

750 
OUT
, 
PALREG
, 17, PALREG, 0x00,

751 
OUT
, 
PALREG
, 18, PALREG, 0x0f,

752 
OUT
, 
PALREG
, 19, PALREG, 0x00,

755 
OUT
, 
PALREG
, 0x20, 0, 0,

758 
DONE
, 0, 0, 0, 0

	@drivers/vgaplan4.c

18 #i‡
_MINIX


19 
	~<ibm/p‹tio.h
>

21 
	~<as£π.h
>

22 
	~"devi˚.h
"

23 
	~"vg≠œn4.h
"

24 
	~"fb.h
"

26 #i‡
MSDOS
 | 
ELKS
 | 
__πems__


28 
	#SCREENBASE
 
EGA_BASE


	)

29 
	#BYTESPERLINE
 80

	)

32 
	#SCREENBASE
 ((*)
psd
->
addr
)

	)

33 
	#BYTESPERLINE
 (
psd
->
löñí
)

	)

37 
	gmode_èbÀ
[
MWMODE_MAX
 + 1] = {

45 
	gmask
[8] = {

49 #i‡
HAVEIOPERM


51 
	$fbvga_£ti›îmissi⁄s
(
PSD
 
psd
)

54  
	`i›îm
(0x3c0, 0x20, 1);

55 
	}
}

60 
	$ega_öô
(
PSD
 
psd
)

62 #i‡
HAVEIOPERM


63 if(
	`fbvga_£ti›îmissi⁄s
(
psd
) == -1) {

64 
	`EPRINTF
("Can't set i/oÖermissions: %m\n");

76 
psd
->
SëIOPîmissi⁄s
 = 
fbvga_£ti›îmissi⁄s
;

79 #i‡
MSDOS
 | 
ELKS
 | 
__πems__


81 
psd
->
addr
 = 
SCREENBASE
;

82 
psd
->
löñí
 = 
BYTESPERLINE
;

84 #i‡
_MINIX


85 
psd
->
addr
 = 0;

86 
psd
->
löñí
 = 80;

89 
psd
->
size
 = 0x10000;

91 
	`£t_íabÀ_§
 (0x0f);

92 
	`£t_›
 (0);

93 
	`£t_mode
 (0);

95 
	}
}

99 
	$ega_døwpixñ
(
PSD
 
psd
,
x
, 
y
, 
MWPIXELVAL
 
c
)

101 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

102 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

103 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

105 
DRAWON
;

106 
	`£t_›
(
mode_èbÀ
[
gr_mode
]);

107 
	`£t_cﬁ‹
 (
c
);

108 
	`£À˘_™d_£t_mask
 (
mask
[
x
&7]);

109 
	`RMW_FP
 ((
FARADDR
)
SCREENBASE
 + (
x
>>3Ë+ 
y
 * 
BYTESPERLINE
);

110 
DRAWOFF
;

111 
	}
}

114 
MWPIXELVAL


115 
	$ega_ªadpixñ
(
PSD
 
psd
,
x
,
y
)

117 
FARADDR
 
§c
;

118 
∂™e
;

119 
MWPIXELVAL
 
c
 = 0;

121 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

122 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

124 
DRAWON
;

125 #i‡
_MINIX


126 
§c
 = (*)(
SCREENBASE
 + (
x
>>3Ë+ 
y
 * 
BYTESPERLINE
);

128 
§c
 = 
SCREENBASE
 + (
x
>>3Ë+ 
y
 * 
BYTESPERLINE
;

130 
∂™e
=0;Ölane<4; ++plane) {

131 
	`£t_ªad_∂™e
(
∂™e
);

132 if(
	`GETBYTE_FP
(
§c
Ë& 
mask
[
x
&7])

133 
c
 |1 << 
∂™e
;

135 
DRAWOFF
;

136  
c
;

137 
	}
}

141 
	$ega_døwh‹zlöe
(
PSD
 
psd
, 
x1
, 
x2
, 
y
,

142 
MWPIXELVAL
 
c
)

144 
FARADDR
 
d°
, 
œ°
;

146 
	`as£π
 (
x1
 >0 && x1 < 
psd
->
xªs
);

147 
	`as£π
 (
x2
 >0 && x2 < 
psd
->
xªs
);

148 
	`as£π
 (
x2
 >
x1
);

149 
	`as£π
 (
y
 >0 && y < 
psd
->
yªs
);

150 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

152 
DRAWON
;

153 
	`£t_cﬁ‹
 (
c
);

154 
	`£t_›
(
mode_èbÀ
[
gr_mode
]);

160 if(
gr_mode
 =
MWMODE_COPY
) {

161 #i‡
_MINIX


162 
d°
 = (*)(
SCREENBASE
 + (
x1
>>3Ë+ 
y
*
BYTESPERLINE
);

164 
d°
 = 
SCREENBASE
 + (
x1
>>3Ë+ 
y
 * 
BYTESPERLINE
;

166 i‡((
x1
>>3Ë=(
x2
>>3)) {

167 
	`£À˘_™d_£t_mask
 ((0xf‡>> (
x1
 & 7)Ë& (0xf‡<< (7 - (
x2
 & 7))));

168 
	`RMW_FP
 (
d°
);

170 
	`£À˘_™d_£t_mask
 (0xf‡>> (
x1
 & 7));

171 
	`RMW_FP
 (
d°
++);

173 
	`£t_mask
 (0xff);

174 #i‡
_MINIX


175 
œ°
 = (*)(
SCREENBASE
 + (
x2
>>3Ë+ 
y
 * 
BYTESPERLINE
);

177 
œ°
 = 
SCREENBASE
 + (
x2
>>3Ë+ 
y
 * 
BYTESPERLINE
;

179 
d°
 < 
œ°
)

180 
	`PUTBYTE_FP
(
d°
++, 1);

182 
	`£t_mask
 (0xf‡<< (7 - (
x2
 & 7)));

183 
	`RMW_FP
 (
d°
);

187 
	`£À˘_mask
 ();

188 
x1
 <
x2
) {

189 
	`£t_mask
 (
mask
[
x1
&7]);

190 
	`RMW_FP
 ((
FARADDR
)
SCREENBASE
 + (
x1
++>>3Ë+ 
y
 * 
BYTESPERLINE
);

193 
DRAWOFF
;

194 
	}
}

198 
	$ega_døwvîéöe
(
PSD
 
psd
,
x
, 
y1
, 
y2
,

199 
MWPIXELVAL
 
c
)

201 
FARADDR
 
d°
, 
œ°
;

203 
	`as£π
 (
x
 >0 && x < 
psd
->
xªs
);

204 
	`as£π
 (
y1
 >0 && y1 < 
psd
->
yªs
);

205 
	`as£π
 (
y2
 >0 && y2 < 
psd
->
yªs
);

206 
	`as£π
 (
y2
 >
y1
);

207 
	`as£π
 (
c
 < 
psd
->
ncﬁ‹s
);

209 
DRAWON
;

210 
	`£t_›
(
mode_èbÀ
[
gr_mode
]);

211 
	`£t_cﬁ‹
 (
c
);

212 
	`£À˘_™d_£t_mask
 (
mask
[
x
&7]);

213 #i‡
_MINIX


214 
d°
 = (*)(
SCREENBASE
 + (
x
>>3Ë+ 
y1
 * 
BYTESPERLINE
);

215 
œ°
 = (*)(
SCREENBASE
 + (
x
>>3Ë+ 
y2
 * 
BYTESPERLINE
);

217 
d°
 = 
SCREENBASE
 + (
x
>>3Ë+ 
y1
 * 
BYTESPERLINE
;

218 
œ°
 = 
SCREENBASE
 + (
x
>>3Ë+ 
y2
 * 
BYTESPERLINE
;

220 
d°
 <
œ°
) {

221 
	`RMW_FP
 (
d°
);

222 
d°
 +
BYTESPERLINE
;

224 
DRAWOFF
;

225 
	}
}

227 #i‡
FBVGA


228 
SUBDRIVER
 
	gvg≠œn4
 = {

229 (*)
ega_öô
,

230 (*)
ega_døwpixñ
,

231 (*)
ega_ªadpixñ
,

232 (*)
ega_døwh‹zlöe
,

233 (*)
ega_døwvîéöe
,

234 (*)
gí_fûÃe˘
,

235 (*)
ega_blô


	@drivers/vgaplan4.h

8 
	#SLOWVGA
 0

	)

10 #ifde‡
__PACIFIC__


11 
	#HAVEBLIT
 0

	)

13 
	#HAVEBLIT
 1

	)

16 #i‡
UNIX
 & !
ELKS


17 
	#HAVEFARPTR
 1

	)

18 
	#FAR


	)

21 #i‡
LINUX


22 #i‡!(
deföed
(
ARCH_LINUX_POWERPPC
Ë|| deföed(
ARCH_LINUX_SPARC
))

23 #ifde‡
__GLIBC__


24 
	~<sys/io.h
>

26 
	~<asm/io.h
>

29 
	~<uni°d.h
>

30 
	#HAVEFARPTR
 1

	)

31 
	#FAR


	)

32 
	#HAVEIOPERM
 1

	)

35 #i‡
MSDOS


36 
	#HAVEFARPTR
 1

	)

37 #ifde‡
__PACIFIC__


38 
	~<dos.h
>

39 
	#FAR
 
Ár


	)

41 
	#FAR
 
_Ár


	)

45 #i‡
__πems__


46 
	#HAVEFARPTR
 1

	)

47 
	#FAR


	)

48 
	~<i386_io.h
>

51 #i‡
MSDOS
 | 
ELKS


53 
	#MK_FP
(
£g
,
ofs
Ë((
FARADDR
)((()(£gË<< 16Ë| ()(ofs)))

	)

54 
	#EGA_BASE
 
	`MK_FP
(0xa000, 0)

	)

56 
	#EGA_BASE
 ((*)0xa0000)

	)

59 #i‡
HAVEFARPTR


61 vﬁ©ûê
	tFAR
 * 
	tFARADDR
;

63 #i‡
_MINIX


65 
GETBYTE_FP
(
FARADDR
);

68 
PUTBYTE_FP
(
FARADDR
,);

71 
RMW_FP
(
FARADDR
);

74 
	#GETBYTE_FP
(
addr
Ë(*(
FARADDR
)◊ddr))

	)

77 
	#PUTBYTE_FP
(
addr
,
vÆ
Ë((*(
FARADDR
)◊ddr)Ë(vÆ))

	)

80 
	#RMW_FP
(
addr
Ë((*(
FARADDR
)◊ddr)Ë|1)

	)

83 
	#ORBYTE_FP
(
addr
,
vÆ
Ë((*(
FARADDR
)◊ddr)Ë|(vÆ))

	)

86 
	#ANDBYTE_FP
(
addr
,
vÆ
Ë((*(
FARADDR
)◊ddr)Ë&(vÆ))

	)

91 
	tFARADDR
;

94 
GETBYTE_FP
(
FARADDR
);

97 
PUTBYTE_FP
(
FARADDR
,);

100 
RMW_FP
(
FARADDR
);

103 
ORBYTE_FP
(
FARADDR
,);

106 
ANDBYTE_FP
(
FARADDR
,);

110 #i‡
MSDOS


111 
	#outb
(
vÆ
,
p‹t
Ë
	`ouç
’‹t,vÆ)

	)

114 #i‡
ELKS


115 
	#outb
(
vÆ
,
p‹t
Ë
	`ouç‹tb
’‹t,vÆ)

	)

116 
	#outw
(
vÆ
,
p‹t
Ë
	`ouç‹t
’‹t,vÆ)

	)

118 
öp‹tb
(
p‹t
);

119 
ouç‹tb
(
p‹t
,
d©a
);

120 
ouç‹t
(
p‹t
,
d©a
);

124 
FARADDR
 
öt10
(
ax
,
bx
);

129 
ega_öô
(
PSD
 
psd
);

130 
ega_døwpixñ
(
PSD
 
psd
,
x
,
y
,

131 
MWPIXELVAL
 
c
);

132 
MWPIXELVAL
 
ega_ªadpixñ
(
PSD
 
psd
,
x
,
y
);

133 
ega_døwh‹zlöe
(
PSD
 
psd
,
x1
,
x2
,

134 
y
,
MWPIXELVAL
 
c
);

135 
ega_døwvîéöe
(
PSD
 
psd
,
x
,
y1
,

136 
y2
, 
MWPIXELVAL
 
c
);

137 #i‡
HAVEBLIT


139 
ega_blô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
w
,

140 
MWCOORD
 
h
,
PSD
 
§˝sd
,MWCOORD 
§cx
,MWCOORD 
§cy
,
›
);

144 
ega_hwöô
();

145 
ega_hwãrm
();

147 #i‡
_MINIX


148 
	#outb
(
v
, 
p
Ë
	`outb
’, v)

	)

149 
	#outw
(
v
, 
p
Ë
	`outw
’, v)

	)

152 #i‡
SLOWVGA


157 
	#£t_cﬁ‹
(
c
Ë{ 
	`outb
 (0, 0x3˚); outb (c, 0x3cf); }

	)

160 
	#£t_íabÀ_§
(
mask
Ë{ 
	`outb
 (1, 0x3˚); outb (mask, 0x3cf); }

	)

163 
	#£À˘_mask
(Ë{ 
	`outb
 (8, 0x3˚); }

	)

168 
	#£t_mask
(
mask
Ë{ 
	`outb
 (mask, 0x3cf); }

	)

170 
	#£À˘_™d_£t_mask
(
mask
Ë{ 
	`outb
 (8, 0x3˚); outb (mask, 0x3cf); }

	)

174 
	#£t_›
(
›
Ë{ 
	`outb
 (3, 0x3˚); outb (›, 0x3cf); }

	)

177 
	#£t_wrôe_∂™es
(
mask
Ë{ 
	`outb
 (2, 0x3c4); outb (mask, 0x3c5); }

	)

180 
	#£t_ªad_∂™e
(
∂™e
Ë{ 
	`outb
 (4, 0x3˚); outb (∂™e, 0x3cf); }

	)

184 
	#£t_mode
(
mode
Ë{ 
	`outb
 (5, 0x3˚); outb (mode, 0x3cf); }

	)

191 
	#£t_cﬁ‹
(
c
Ë{ 
	`outw
 ((c)<<8, 0x3˚); }

	)

194 
	#£t_íabÀ_§
(
mask
Ë{ 
	`outw
 (1|((mask)<<8), 0x3˚); }

	)

197 
	#£À˘_mask
(Ë{ 
	`outb
 (8, 0x3˚); }

	)

202 
	#£t_mask
(
mask
Ë{ 
	`outb
 (mask, 0x3cf); }

	)

204 
	#£À˘_™d_£t_mask
(
mask
Ë{ 
	`outw
 (8|((mask)<<8), 0x3˚); }

	)

208 
	#£t_›
(
›
Ë{ 
	`outw
 (3|((›)<<8), 0x3˚); }

	)

211 
	#£t_wrôe_∂™es
(
mask
Ë{ 
	`outw
 (2|((mask)<<8), 0x3c4); }

	)

214 
	#£t_ªad_∂™e
(
∂™e
Ë{ 
	`outw
 (4|(’œ√)<<8), 0x3˚); }

	)

218 
	#£t_mode
(
mode
Ë{ 
	`outw
 (5|((mode)<<8), 0x3˚); }

	)

	@drivers/vtswitch.c

1 
	~<uni°d.h
>

2 
	~<f˙é.h
>

3 
	~<sig«l.h
>

4 
	~<sys/io˘l.h
>

5 
	~<sys/time.h
>

6 
	~<löux/vt.h
>

7 
	~"devi˚.h
"

8 
	~"fb.h
"

14 #i‚de‡
SIGUNUSED


15 
	#SIGUNUSED
 
SIGUSR1


	)

18 
	#SIGVTSWITCH
 
SIGUNUSED


	)

20 
	gmwvãrm
;

21 vﬁ©ûê
	gmwdøwög
;

22 
	gmwcvt
, 
	gmwocvt
;

23 
	gâyfd
 = -1;

24 
	gvisibÀ
 = 1;

25 
vt_mode
 
	gmode
;

26 
SUBDRIVER
 
	gßve
;

28 
SCREENDEVICE
 
s¸dev
;

31 
MwInôVt
();

32 
MwCuºítVt
();

33 
MwCheckVtCh™ge
();

34 
MwRedøwVt
(
t
);

37 
døw_íabÀ
();

38 
døw_dißbÀ
();

39 
vt_swôch
(
sig
);

42 
	$nuŒ_døwpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
MWPIXELVAL
 
c
Ë{
	}
}

43 
MWPIXELVAL
 
	$nuŒ_ªadpixñ
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
Ë{  0;
	}
}

44 
	$nuŒ_døwh‹zlöe
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
x2
,MWCOORD 
y
,

45 
MWPIXELVAL
 
c
Ë{
	}
}

46 
	$nuŒ_døwvîéöe
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
,

47 
MWPIXELVAL
 
c
Ë{
	}
}

48 
	$nuŒ_fûÃe˘
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,

49 
MWCOORD
 
y2
,
MWPIXELVAL
 
c
Ë{
	}
}

50 
	$nuŒ_blô
(
PSD
 
d°psd
,
MWCOORD
 
de°x
,MWCOORD 
de°y
,MWCOORD 
w
,

51 
MWCOORD
 
h
,
PSD
 
§˝sd
,MWCOORD 
§cx
,MWCOORD 
§cy
,

52 
›
Ë{
	}
}

53 
	$nuŒ_døw¨ó
(
PSD
 
psd
, 
drivî_gc_t
 *
gc
, 
›
Ë{
	}
}

54 
	$nuŒ_°ªtchblô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
,

55 
MWCOORD
 
d°w
, MWCOORD 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
,

56 
MWCOORD
 
§cy
, MWCOORD 
§cw
, MWCOORD 
§ch
, 
›
Ë{
	}
}

57 
	$nuŒ_°ªtchblôex
(
PSD
 
d°psd
, PSD 
§˝sd
, 
MWCOORD
 
de°_x_°¨t
,

58 
MWCOORD
 
de°_y_°¨t
, MWCOORD 
width
, MWCOORD 
height
,

59 
x_díomö©‹
, 
y_díomö©‹
,

60 
§c_x_‰a˘i⁄
, 
§c_y_‰a˘i⁄
,

61 
x_°ï_‰a˘i⁄
, 
y_°ï_‰a˘i⁄
, 
›
Ë{
	}
}

63 
SUBDRIVER
 
	gnuŒdrivî
 = {

64 
NULL
,

65 
nuŒ_døwpixñ
,

66 
nuŒ_ªadpixñ
,

67 
nuŒ_døwh‹zlöe
,

68 
nuŒ_døwvîéöe
,

69 
nuŒ_fûÃe˘
,

70 
nuŒ_blô
,

71 
nuŒ_døw¨ó
,

72 
nuŒ_°ªtchblô
,

73 
nuŒ_°ªtchblôex


77 
	$døw_íabÀ
()

79 if(
visibÀ
)

81 
visibÀ
 = 1;

84 
	`£t_subdrivî
(&
s¸dev
, &
ßve
, 
FALSE
);

85 
	}
}

88 
	$døw_dißbÀ
()

90 if(!
visibÀ
)

92 
visibÀ
 = 0;

95 
	`gë_subdrivî
(&
s¸dev
, &
ßve
);

98 
	`£t_subdrivî
(&
s¸dev
, &
nuŒdrivî
, 
FALSE
);

99 
	}
}

103 
	$vt_do_swôch
(*
¨g
)

105 
r
[16], 
g
[16], 
b
[16];

113 if(
mwdøwög
) {

114 
	`døw_dißbÀ
 ();

115 
	`GdAddTimî
(100, 
vt_do_swôch
, 
NULL
);

119 if(
visibÀ
) {

120 
	`døw_dißbÀ
 ();

121 
	`io˘l_gë∑Àâe
(0, 16, 
r
, 
g
, 
b
);

123 if(
	`io˘l
 (
âyfd
, 
VT_RELDISP
, 1) == -1)

124 
	`EPRINTF
("Error can't switcháway from VT: %m\n");

126 
	`io˘l_£çÆëã
(0, 16, 
r
, 
g
, 
b
);

127 
	`døw_íabÀ
 ();

129 if(
	`io˘l
 (
âyfd
, 
VT_RELDISP
, 
VT_ACKACQ
) == -1)

130 
	`EPRINTF
("Error can'tácknowledge VT switch: %m\n");

132 
	}
}

136 
	$vt_swôch
(
sig
)

138 
	`sig«l
(
SIGVTSWITCH
, 
vt_swôch
);

139 
	`vt_do_swôch
(
NULL
);

140 
	}
}

147 
	$MwInôVt
()

149 
âyfd
 = 
	`›í
("/dev/ây0", 
O_RDONLY
);

150 if(
âyfd
 == -1)

151  
	`EPRINTF
("Error can't openÅty0: %m\n");

154 if(
	`io˘l
 (
âyfd
, 
VT_GETMODE
, &
mode
) == -1)

155  
	`EPRINTF
("Error can't get VT mode: %m\n");

157 
mode
.modê
VT_PROCESS
;

158 
mode
.
ªlsig
 = 
SIGVTSWITCH
;

159 
mode
.
acqsig
 = 
SIGVTSWITCH
;

160 
	`sig«l
 (
SIGVTSWITCH
, 
vt_swôch
);

161 if(
	`io˘l
 (
âyfd
, 
VT_SETMODE
, &
mode
) == -1)

162  
	`EPRINTF
("Error can't set VT mode: %m\n");

164 
mwcvt
 = 
mwocvt
 = 
mwvãrm
 = 
	`MwCuºítVt
();

170 
	`MwRedøwVt
(
mwvãrm
);

173 
	}
}

179 
	$MwCuºítVt
()

181 
vt_°©
 
°©
;

183 
	`io˘l
(
âyfd
, 
VT_GETSTATE
, &
°©
);

184  
°©
.
v_a˘ive
;

185 
	}
}

191 
	$MwCheckVtCh™ge
()

193 
mwcvt
 = 
	`MwCuºítVt
();

194 if(
mwcvt
 !
mwocvt
 && mwcvà=
mwvãrm
) {

195 
mwocvt
 = 
mwcvt
;

198 
mwocvt
 = 
mwcvt
;

200 
	}
}

208 
	$MwRedøwVt
(
t
)

210 if(
	`MwCuºítVt
(Ë=
mwvãrm
) {

211 
	`io˘l
(
âyfd
, 
VT_ACTIVATE
, 
t
 == 1 ? 2 : 1);

212 
	`io˘l
(
âyfd
, 
VT_ACTIVATE
, 
t
);

214 
	}
}

217 
	$MwExôVt
()

219 
	`sig«l
(
SIGVTSWITCH
, 
SIG_DFL
);

220 
mode
.modê
VT_AUTO
;

221 
mode
.
ªlsig
 = 0;

222 
mode
.
acqsig
 = 0;

223 
	`io˘l
(
âyfd
, 
VT_SETMODE
, &
mode
);

225 if(
âyfd
 != -1)

226 
	`˛o£
(
âyfd
);

227 
	}
}

	@ecos/ecos_app.c

9 
	~<pkgc⁄f/sy°em.h
>

10 #ifde‡
CYGPKG_KERNEL


11 
	~<pkgc⁄f/kî√l.h
>

13 #ifde‡
CYGPKG_LIBC


14 
	~<pkgc⁄f/libc.h
>

16 #ifde‡
CYGPKG_IO_SERIAL


17 
	~<pkgc⁄f/io_£rül.h
>

20 #i‚de‡
CYGFUN_KERNEL_API_C


21 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


24 #i‚de‡
CYGPKG_LIBC_STDIO


25 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


28 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


29 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<°rög.h
>

37 
	~<cyg/kî√l/k≠i.h
>

38 
	~<cyg/hÆ/hÆ_¨ch.h
>

39 
	~<sys/time.h
>

40 
	~<˘y≥.h
>

41 
	~<√tw‹k.h
>

42 #ifde‡
USE_ROMDISK


43 
	~<cyg/fûeio/fûeio.h
>

46 
	#STACKSIZE
 ( 65536 )

	)

48 
ecos_nx_£tup
(
CYG_ADDRWORD
 
d©a
);

49 
«nowm_thªad
(
CYG_ADDRWORD
 
d©a
);

50 
«nox_thªad
(
CYG_ADDRWORD
 
d©a
);

51 
nxkbd_thªad
(
CYG_ADDRWORD
 
d©a
);

52 #ifde‡
USE_NXSCRIBBLE


53 
nxs¸ibbÀ_thªad
(
CYG_ADDRWORD
 
d©a
);

55 #ifde‡
USE_LANDMINE


56 
œndmöe_thªad
(
CYG_ADDRWORD
 
d©a
);

58 #ifde‡
USE_NTETRIS


59 
¡ëris_thªad
(
CYG_ADDRWORD
 
d©a
);

61 #ifde‡
USE_WORLD


62 
w‹ld_thªad
(
CYG_ADDRWORD
 
d©a
);

64 
°¨tup_thªad
(
CYG_ADDRWORD
 
d©a
);

66 
	tfun
(
	tCYG_ADDRWORD
);

67 
	snx_thªad
 {

68 *
	m«me
;

69 
fun
 *
	míåy
;

70 
	m¥io
;

71 
cyg_h™dÀ_t
 
	mt
;

72 
cyg_thªad
 
	mt_obj
;

73 
	m°ack
[
STACKSIZE
];

76 
nx_thªad
 
	g_thªads
[] = {

77 { "Sy°em sèπup", 
°¨tup_thªad
, 11 },

78 { "N™o-X sîvî", 
«nox_thªad
, 12 },

79 { "N™o-WM", 
«nowm_thªad
, 14 },

80 { "N™o-KBD", 
nxkbd_thªad
, 13 },

81 #ifde‡
USE_NXSCRIBBLE


82 { "S¸ibbÀ", 
nxs¸ibbÀ_thªad
, 20 },

84 #ifde‡
USE_LANDMINE


85 { "L™dmöe", 
œndmöe_thªad
, 19 },

87 #ifde‡
USE_NTETRIS


88 { "N™o-Tëris", 
¡ëris_thªad
, 18 },

90 #ifde‡
USE_WORLD


91 { "W‹ld M≠", 
w‹ld_thªad
, 21 },

94 
	#NUM
(
x
Ë((x)/(x[0]))

	)

98 
	$°rdup
(*
°rög
) {

99 *
√wbô
 = 
	`mÆloc
(
	`°æí
(
°rög
)+1);

100 
	`°r˝y
(
√wbô
,
°rög
);

101  
√wbô
;

102 
	}
}

105 
	$gëtimeofday
(
timevÆ
 *
tv
,

106 
timez⁄e
 *
tz
)

108 
tv
->
tv_u£c
 = 0;

109 
tv
->
tv_£c
 = 
	`time
(
NULL
);

111 
	}
}

114 
	$°rˇ£cmp
(c⁄° *
s1
, c⁄° *
s2
)

116 
c1
, 
c2
;

118 (
c1
 = 
	`tﬁowî
(*
s1
++)Ë=(
c2
 =Åﬁowî(*
s2
++)))

119 i‡(
c1
 == 0)

121  (()
c1
 - ()
c2
);

122 
	}
}

125 
	$°¨tup_thªad
(
CYG_ADDRESS
 
d©a
)

127 
cyg_ucou¡32
 
«nox_d©a_ödex
;

128 
i
;

129 
nx_thªad
 *
nx
;

131 
	`¥ötf
("SYSTEM INITIALIZATION inÖrogress\n");

132 
	`¥ötf
("NETWORK:\n");

133 
	`öô_Æl_√tw‹k_öãrÁ˚s
();

135 #ifde‡
USE_ROMDISK


137 
ROM_fs
[32];

138 
ªs
;

140 
	`¥ötf
("Mount ROM file system\n");

141 #ifde‡
CYGPKG_HAL_ARM_SA11X0_IPAQ


144 *
hﬁd_rom_fs
;

145 i‡((
hﬁd_rom_fs
 = 
	`mÆloc
(0x80080)) != 0) {

147 
hﬁd_rom_fs
 = (*)((()hold_rom_fs + 31) & ~31);

148 
	`mem˝y
(
hﬁd_rom_fs
, 0x50F00000, 0x80000);

149 
	`•rötf
(
ROM_fs
, "0x%08x", 
hﬁd_rom_fs
);

151 
	`¥ötf
("Can'tállocate memoryÅo hold ROM fs!\n");

155 
	`•rötf
(
ROM_fs
, "0x%08x", 0x50F00000);

157 
	`¥ötf
("ROM f†© %s\n", 
ROM_fs
);

158 i‡((
ªs
 = 
	`mou¡
(
ROM_fs
, "/", "romfs")) < 0) {

159 
	`¥ötf
("... failed\n");

167 
«nox_d©a_ödex
 = 
	`cyg_thªad_√w_d©a_ödex
();

168 
	`¥ötf
("d©®ödex = %d\n", 
«nox_d©a_ödex
);

170 
	`¥ötf
("Creating systemÅhreads\n");

171 
nx
 = &
_thªads
[1];

172 
i
 = 1; i < 
	`NUM
(
_thªads
); i++, 
nx
++) {

173 
	`cyg_thªad_¸óã
(
nx
->
¥io
,

174 
nx
->
íåy
,

175 (
cyg_addrw‹d_t
Ë
«nox_d©a_ödex
,

176 
nx
->
«me
,

177 (*)
nx
->
°ack
, 
STACKSIZE
,

178 &
nx
->
t
,

179 &
nx
->
t_obj
);

182 
	`¥ötf
("StartingÅhreads\n");

183 
nx
 = &
_thªads
[1];

184 
i
 = 1; i < 
	`NUM
(
_thªads
); i++, 
nx
++) {

185 
	`¥ötf
("Sèπög %s\n", 
nx
->
«me
);

186 
	`cyg_thªad_ªsume
(
nx
->
t
);

189 i‡(
i
 == 2) {

190 
	`ecos_nx_öô
(
«nox_d©a_ödex
);

194 
	`¥ötf
("SYSTEM THREADS STARTED!\n");

195 
	}
}

197 
	$cyg_u£r_°¨t
()

199 
nx_thªad
 *
nx
;

201 
nx
 = &
_thªads
[0];

202 
	`cyg_thªad_¸óã
(
nx
->
¥io
,

203 
nx
->
íåy
,

204 (
cyg_addrw‹d_t
) 0,

205 
nx
->
«me
,

206 (*)
nx
->
°ack
, 
STACKSIZE
,

207 &
nx
->
t
,

208 &
nx
->
t_obj
);

209 
	`cyg_thªad_ªsume
(
nx
->
t
);

210 
	}
}

	@ecos/ecos_init.c

5 
	~<pkgc⁄f/kî√l.h
>

6 
	~<pkgc⁄f/hÆ.h
>

7 
	~<cyg/kî√l/k≠i.h
>

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<f˙é.h
>

12 
	~<uni°d.h
>

13 
	~<time.h
>

14 
	~<˘y≥.h
>

15 
	~<î∫o.h
>

16 
	~<sys/time.h
>

18 
	#MWINCLUDECOLORS


	)

19 
	~"«no-X.h
"

21 
boﬁ
 
	g˛o£d
 = 
Ál£
;

26 
	$show_ns
(
ns
)

28 
	`düg_¥ötf
("%5d.%02d", ()(
ns
/1000), ()((ns%1000)/10));

29 
	}
}

31 
	gπc_ªsﬁuti⁄
[] = 
CYGNUM_KERNEL_COUNTERS_RTC_RESOLUTION
;

32 
	gns_≥r_sy°em_˛ock
;

35 
	$ns_time
()

37 
off
;

38 
ns
, 
˛ocks
;

40 
ns_≥r_sy°em_˛ock
 = 1000000/
πc_ªsﬁuti⁄
[1];

41 
	`HAL_CLOCK_READ
(&
off
);

42 
ns
 = (
ns_≥r_sy°em_˛ock
 * ()
off
Ë/ 
CYGNUM_KERNEL_COUNTERS_RTC_PERIOD
;

43 
ns
 += 5;

44 
˛ocks
 = (
	`cyg_cuºít_time
(Ë* 10000000Ë+ 
ns
;

45  
˛ocks
;

46 
	}
}

49 
	$ã°_fûe_io
()

51 
°¨t_time
, 
íd_time
;

52 
FILE
 *
Â
;

53 
buf
[256];

54 
Àn
, 
n
, 
fd
;

56 
°¨t_time
 = 
	`ns_time
();

57 i‡((
Â
 = 
	`f›í
("/bö/Àâîs.˛", "r")Ë!(
FILE
 *)
NULL
) {

58 
Àn
 = 0;

59 
	`fgës
(
buf
, (buf), 
Â
)) {

60 
Àn
 +
	`°æí
(
buf
);

62 
	`f˛o£
(
Â
);

64 
íd_time
 = 
	`ns_time
();

65 
	`düg_¥ötf
("'fgës': %d byã†ö ", 
Àn
); 
	`show_ns
(
íd_time
-
°¨t_time
); diag_printf("ns\n");

67 
°¨t_time
 = 
	`ns_time
();

68 i‡((
Â
 = 
	`f›í
("/bö/Àâîs.˛", "r")Ë!(
FILE
 *)
NULL
) {

69 
Àn
 = 0;

70 
n
 = 
	`‰ód
(
buf
, 1, (buf), 
Â
)) {

71 
Àn
 +
n
;

73 
	`f˛o£
(
Â
);

75 
íd_time
 = 
	`ns_time
();

76 
	`düg_¥ötf
("'‰ód': %d byã†ö ", 
Àn
); 
	`show_ns
(
íd_time
-
°¨t_time
); diag_printf("ns\n");

78 
°¨t_time
 = 
	`ns_time
();

79 i‡((
fd
 = 
	`›í
("/bö/Àâîs.˛", 
O_RDONLY
)) >= 0) {

80 
Àn
 = 0;

81 
n
 = 
	`ªad
(
fd
, 
buf
, (buf))) {

82 
Àn
 +
n
;

84 
	`˛o£
(
fd
);

86 
íd_time
 = 
	`ns_time
();

87 
	`düg_¥ötf
("'ªad': %d byã†ö ", 
Àn
); 
	`show_ns
(
íd_time
-
°¨t_time
); diag_printf("ns\n");

88 
	}
}

90 #i‡
NWIDGETS


92 
	$do_˛o£
(
NBUTTON
 * 
w
, 
b
)

94 
	`¥ötf
("Buâ⁄ %d wa†˛icked i¿widgë %p\n",
b
,
w
);

95 
˛o£d
 = 
åue
;

96 
	}
}

100 
	$ecos_nx_öô
(
CYG_ADDRWORD
 
d©a
)

102 
GR_SCREEN_INFO
 
si
;

103 
GR_FONT_INFO
 
fi
;

104 
GR_WINDOW_ID
 
maöwid
;

105 
GR_WM_PROPERTIES
 
¥›s
;

106 
GR_GC_ID
 
g˘
 = 0;

107 
NWIDGET
 *
w
;

108 
NBUTTON
 *
b
;

109 
NTEXTFIELD
 *
t
;

111 
	`cyg_thªad_dñay
(50);

112 
	`INIT_PER_THREAD_DATA
();

114 
	`ã°_fûe_io
();

116 if(
	`GrO≥n
() < 0) {

117 
	`Ârötf
(
°dîr
, "Couldn't connectÅo Nano-X server\n");

118 
	`exô
(1);

121 
	`GrGëS¸ìnInfo
(&
si
);

122 
	`GrGëF⁄tInfo
(0, &
fi
);

124 #i‚de‡
NWIDGETS


125 
maöwid
 = 
	`GrNewWödow
(
GR_ROOT_WINDOW_ID
, 0, 0, 
si
.
cﬁs
, si.
rows
,

126 0, 
RED
, 
WHITE
);

128 
¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
;

129 
¥›s
.¥›†
GR_WM_PROPS_BORDER
;

130 
	`GrSëWMPr›îtõs
(
maöwid
, &
¥›s
);

132 
	`GrM≠Wödow
(
maöwid
);

133 
	`GrFlush
();

134 
	`cyg_thªad_dñay
(50);

136 
g˘
 = 
	`GrNewGC
();

137 
	`GrSëGCF‹eground
(
g˘
, 
WHITE
);

139 
	`GrDøwImageFromFûe
(
maöwid
, 
g˘
, 0, 0, 
si
.
cﬁs
, si.
rows
, "/redhat.logo", 0);

140 
	`GrText
(
maöwid
, 
g˘
, 80, 350, "T≠áŒ 4 c‹√rs", 17, 
GR_TFTOP
);

141 
	`GrFlush
();

142 
	`¥ötf
("Tapáll four corners\n");

143 
	`cyg_thªad_dñay
(10*100);

146 
	`n_öô_buâ⁄_˛ass
();

147 
	`n_öô_ãxtfõld_˛ass
();

149 
w
 = 
	`NEW_NOBJECT
(
widgë
);

150 
	`n_widgë_öô
(
w
, 0);

151 
	`n_widgë_ªsize
(
w
, 
si
.
cﬁs
 - 10, si.
rows
 - 30);

152 
	`n_widgë_background
(
w
, "/redhat.logo");

153 
	`n_widgë_show
(
w
);

155 
b
 = 
	`NEW_NOBJECT
(
buâ⁄
);

156 
	`n_buâ⁄_öô
(
b
, 
w
, "Close");

157 
	`n_buâ⁄_⁄˛ick
(
b
, 
do_˛o£
);

158 
	`n_widgë_ªsize
(
b
, 40, 20);

159 
	`n_widgë_move
(
b
,180,260);

160 
	`n_widgë_show
(
b
);

162 
t
 = 
	`NEW_NOBJECT
(
ãxtfõld
);

163 
	`n_ãxtfõld_öô
(
t
,
w
,"Tapáll 4 corners");

164 
	`n_widgë_move
(
t
,45,220);

165 
	`n_widgë_ªsize
(
t
,120,20);

166 
	`n_widgë_show
(
t
);

168 
t
 = 
	`NEW_NOBJECT
(
ãxtfõld
);

169 
	`n_ãxtfõld_öô
(
t
,
w
,"ThenÖress close");

170 
	`n_widgë_move
(
t
,45,250);

171 
	`n_widgë_ªsize
(
t
,120,20);

172 
	`n_widgë_show
(
t
);

174 !
˛o£d
) {

175 
	`n_h™dÀ_evít
();

178 
	`n_widgë_hide
(
w
);

179 
	`n_obje˘_˛ónup
(
w
);

182 
	`GrClo£
();

183 
	}
}

	@ecos/landmine_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
œndmöe_maö
(
¨gc
, *
¨gv
[]);

43 
	$œndmöe_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 5;

46 *
¨gv
[] = {"landmine",

50 
	`INIT_PER_THREAD_DATA
();

51 
	`œndmöe_maö
(
¨gc
, 
¨gv
);

52 
	}
}

	@ecos/nanowm_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
«nowm_maö
(
¨gc
, *
¨gv
[]);

43 
	$«nowm_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 0;

46 **
¨gv
;

48 
	`INIT_PER_THREAD_DATA
();

49 
	`«nowm_maö
(
¨gc
, 
¨gv
);

50 
	}
}

	@ecos/nanox_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
«nox_maö
(
¨gc
, *
¨gv
[]);

43 
	$«nox_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 0;

46 **
¨gv
;

48 
	`«nox_maö
(
¨gc
, 
¨gv
);

49 
	}
}

	@ecos/ntetris_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
¡ëris_maö
(
¨gc
, *
¨gv
[]);

43 
	$¡ëris_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 1;

46 *
¨gv
[] = {"ntetris" };

48 
	`INIT_PER_THREAD_DATA
();

49 
	`¡ëris_maö
(
¨gc
, 
¨gv
);

50 
	}
}

	@ecos/nxkbd_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
nxkbd_maö
(
¨gc
, *
¨gv
[]);

43 
	$nxkbd_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 0;

46 **
¨gv
;

48 
	`INIT_PER_THREAD_DATA
();

49 
	`nxkbd_maö
(
¨gc
, 
¨gv
);

50 
	}
}

	@ecos/nxscribble_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
nxs¸ibbÀ_maö
(
¨gc
, *
¨gv
[]);

43 
	$nxs¸ibbÀ_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 2;

46 *
¨gv
[] = {"nxscribble", "-t"};

48 
	`INIT_PER_THREAD_DATA
();

49 
	`nxs¸ibbÀ_maö
(
¨gc
, 
¨gv
);

50 
	}
}

	@ecos/world_thread.c

1 
	~<pkgc⁄f/sy°em.h
>

2 #ifde‡
CYGPKG_KERNEL


3 
	~<pkgc⁄f/kî√l.h
>

5 #ifde‡
CYGPKG_LIBC


6 
	~<pkgc⁄f/libc.h
>

8 #ifde‡
CYGPKG_IO_SERIAL


9 
	~<pkgc⁄f/io_£rül.h
>

12 #i‚de‡
CYGFUN_KERNEL_API_C


13 #îr‹ 
Kî√l
 
API
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


16 #i‚de‡
CYGPKG_LIBC_STDIO


17 #îr‹ 
C
 
libøry
 
°™d¨d
 
I
/
O
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


20 #i‚de‡
CYGPKG_IO_SERIAL_HALDIAG


21 #îr‹ 
I
/
O
 
HALDIAG
 
p£udo
-
devi˚
 
drivî
 
mu°
 
be
 
íabÀd
 
to
 
buûd
 
this
 
≠∂iˇti⁄


26 
	~<°dio.h
>

27 
	~<°dlib.h
>

28 
	~<°rög.h
>

29 
	~<cyg/kî√l/k≠i.h
>

30 
	~<cyg/ö‰a/düg.h
>

32 
	#MWINCLUDECOLORS


	)

33 
	~"«no-X.h
"

40 
exã∫C
 
w‹ld_maö
(
¨gc
, *
¨gv
[]);

43 
	$w‹ld_thªad
(
CYG_ADDRWORD
 
d©a
)

45 
¨gc
 = 1;

46 *
¨gv
[] = {"world" };

48 
	`cyg_thªad_dñay
(10*100);

49 
	`INIT_PER_THREAD_DATA
();

50 
	`w‹ld_maö
(
¨gc
, 
¨gv
);

51 
	}
}

	@engine/devarc.c

20 
	~<°dio.h
>

21 
	~"devi˚.h
"

23 
gr_fûlmode
;

25 #i‡
HAVEFLOAT


26 
	#HIGHPRECISION
 0

	)

28 #i‡!
HIGHPRECISION


29 
	tFLOAT
;

39 
	gcosöe
[91][2] = {

134 
	$qcos
(
FLOAT
 
™gÀ
)

136 
a
, 
b
, 
c
;

138 
a
 = 
™gÀ
;

139 i‡(
a
 < 0) {

140 
™gÀ
 = 
a
 -ángle;

141 
a
 = -a;

143 
™gÀ
 =ángÀ - 
a
;

145 
b
 = 
a
 / 90;

146 
c
 = 
a
 - 
b
 * 90;

149 
b
&3) {

151 
c
 = 90 - c;

152  
cosöe
[
c
][0] - cosöe[c-1][1] * 
™gÀ
;

154  -(
cosöe
[
c
][0] + cosöe[c][1] * 
™gÀ
);

156 
c
 = 90 - c;

157  
cosöe
[
c
-1][1] * 
™gÀ
 - cosine[c][0];

159  
cosöe
[
c
][0] + cosöe[c][1] * 
™gÀ
;

161 
	}
}

164 
	$qsö
(
FLOAT
 
™gÀ
)

166 
a
, 
b
, 
c
;

169 
a
 = ()
™gÀ
 - 90;

170 i‡(
a
 < 0) {

171 
™gÀ
 = (
a
 + 90) -ángle;

172 
a
 = -a;

174 
™gÀ
 =ángÀ - (
a
 + 90);

176 
b
 = 
a
 / 90;

177 
c
 = 
a
 - 
b
 * 90;

180 
b
&3) {

182 
c
 = 90 - c;

183  
cosöe
[
c
][0] - cosöe[c-1][1] * 
™gÀ
;

185  -(
cosöe
[
c
][0] + cosöe[c][1] * 
™gÀ
);

187 
c
 = 90 - c;

188  
cosöe
[
c
-1][1] * 
™gÀ
 - cosine[c][0];

190  
cosöe
[
c
][0] + cosöe[c][1] * 
™gÀ
;

192 
	}
}

195 
	~<m©h.h
>

196 
	#qcos
 
QCOS


	)

197 
	#qsö
 
QSIN


	)

198 
	tFLOAT
;

200 
FLOAT
 
	$QCOS
(
FLOAT
 
a
)

202  
	`cos
(
a
 * 
M_PI
 / 180.);

203 
	}
}

205 
FLOAT
 
	$QSIN
(
FLOAT
 
a
)

207  
	`sö
(
a
 * 
M_PI
 / 180.);

208 
	}
}

232 
	$GdArcAngÀ
(
PSD
 
psd
, 
MWCOORD
 
x0
, MWCOORD 
y0
, MWCOORD 
rx
, MWCOORD 
ry
,

233 
MWCOORD
 
™gÀ1
, MWCOORD 
™gÀ2
, 
ty≥
)

235 #i‡
HAVEFLOAT


236 
MWCOORD
 
ax
, 
ay
, 
bx
, 
by
;

237 
FLOAT
 
a
, 
b
;

240 
ax
 = 
	`qcos
(
™gÀ1
/64.Ë* 
rx
;

241 
bx
 = 
	`qcos
(
™gÀ2
/64.Ë* 
rx
;

243 
a
 = -
	`qsö
(
™gÀ1
/64.);

244 
b
 = -
	`qsö
(
™gÀ2
/64.);

245 
ay
 = 
a
 * 
ry
;

246 
by
 = 
b
 * 
ry
;

249 i‡(
ax
 =
bx
 && 
ay
 =
by
 && 
™gÀ1
 !
™gÀ2
)

253 
	`GdArc
(
psd
, 
x0
, 
y0
, 
rx
, 
ry
, 
ax
, 
ay
, 
bx
, 
by
, 
ty≥
);

255 
	}
}

259 
PSD
 
	mpsd
;

260 
MWCOORD
 
	mx0
, 
	my0
;

261 
MWCOORD
 
	mrx
, 
	mry
;

262 
MWCOORD
 
	max
, 
	may
;

263 
MWCOORD
 
	mbx
, 
	mby
;

264 
	madú
, 
	mbdú
;

265 
	mty≥
;

266 } 
	tSLICE
;

274 
	$˛ù_löe
(
SLICE
 *
¶i˚
, 
MWCOORD
 
xe
, MWCOORD 
ye
, 
dú
, MWCOORD 
y
, MWCOORD *
x0
,

275 
MWCOORD
 *
x1
)

281 i‡(
y
 >0 && 
ye
 == 0) {

285 i‡(
¶i˚
->
adú
 < 0) {

286 i‡(
¶i˚
->
ay
 || sli˚->
by
)

288 i‡(
¶i˚
->
ax
 =-¶i˚->
bx
)

295 i‡((
y
 >0 && 
ye
 >= 0) || (y < 0 && ye < 0)) {

296 
MWCOORD
 
x
;

298 i‡(
ye
 =0Ë
x
 = 
xe
; 

299 
x
 = (
MWCOORD
)()
xe
 * 
y
 / 
ye
;

301 i‡(
x
 >*
x0
 && x <*
x1
) {

302 i‡(
dú
 > 0)

303 *
x0
 = 
x
;

305 *
x1
 = 
x
;

308 i‡(
dú
 > 0) {

309 i‡(
x
 <*
x0
)

312 i‡(
x
 >*
x1
)

319 
	}
}

325 
	$døw_löe
(
SLICE
 *
¶i˚
, 
MWCOORD
 
x0
, MWCOORD 
y
, MWCOORD 
x1
, 
mode
)

327 
dbl
 = (
¶i˚
->
adú
 > 0 && sli˚->
bdú
 < 0);

328 
disˇrd
, 
ªt
;

329 
MWCOORD
 
x2
 = 
x0
, 
x3
 = 
x1
;

331 i‡(
y
 == 0) {

332 i‡(
¶i˚
->
ty≥
 !
MWPIE
)

335 i‡((
¶i˚
->
ay
 <0 && sli˚->
by
 >= 0) ||

336 (
¶i˚
->
ay
 >0 && sli˚->
by
 <= 0)) {

337 i‡(
¶i˚
->
adú
 < 0) {

338 i‡(
x1
 > 0)

339 
x1
 = 0;

341 i‡(
¶i˚
->
bdú
 > 0) {

342 i‡(
x0
 < 0)

343 
x0
 = 0;

346 i‡(!
dbl
) {

349 i‡(
gr_fûlmode
 !
MWFILL_SOLID
 && 
mode
)

350 
	`ts_døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
, sli˚->
y0
);

352 
	`døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
, sli˚->
y0
);

356 i‡(
gr_fûlmode
 !
MWFILL_SOLID
 && 
mode
)

357 
	`ts_døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
, sli˚->
y0
);

359 
	`døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
, sli˚->
y0
);

364 
ªt
 = 
	`˛ù_löe
(
¶i˚
, sli˚->
ax
, sli˚->
ay
, sli˚->
adú
, 
y
, &
x0
, &
x1
);

366 i‡(
dbl
) {

367 i‡(!
ªt
) {

369 i‡(
gr_fûlmode
 !
MWFILL_SOLID
 && 
mode
)

370 
	`ts_døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
,

371 
¶i˚
->
y0
 + 
y
);

373 
	`døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
,

374 
¶i˚
->
y0
 + 
y
);

376 
x0
 = 
x2
;

377 
x1
 = 
x3
;

380 i‡(
ªt
 > 1) {

385 
disˇrd
 = 
ªt
;

386 
ªt
 = 
	`˛ù_löe
(
¶i˚
, sli˚->
bx
, sli˚->
by
, sli˚->
bdú
, 
y
, &
x0
, &
x1
);

388 
disˇrd
 +
ªt
;

389 i‡(
disˇrd
 > 2 && !(
dbl
 && 
ªt
 == 0 && discard == 3)) {

392 i‡(
disˇrd
 == 2) {

394 i‡(
¶i˚
->
adú
 < 0 || sli˚->
bdú
 > 0) {

398 i‡(
gr_fûlmode
 !
MWFILL_SOLID
 && 
mode
)

399 
	`ts_døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
, sli˚->
y0
 + 
y
);

401 
	`døwrow
(
¶i˚
->
psd
, sli˚->
x0
 + x0, sli˚->x0 + 
x1
, sli˚->
y0
 + 
y
);

402 
	}
}

415 
	$døw¨c£gmít
(
SLICE
 *
¶i˚
, 
MWCOORD
 
xp
, MWCOORD 
yp
, 
døw⁄
)

417 
dm
 = 0;

418 
dc
 = 0;

420 
¶i˚
->
ty≥
) {

421 
MWELLIPSEFILL
:

425 i‡(
gr_fûlmode
 !
MWFILL_SOLID
) {

426 
	`ts_døwrow
(
¶i˚
->
psd
, sli˚->
x0
-
xp
, sli˚->x0+xp, sli˚->
y0
-
yp
);

427 
	`ts_døwrow
(
¶i˚
->
psd
, sli˚->
x0
-
xp
, sli˚->x0+xp, sli˚->
y0
+
yp
);

430 
	`GdSëDash
(&
dm
, &
dc
);

431 
	`døwrow
(
¶i˚
->
psd
, sli˚->
x0
-
xp
, sli˚->x0+xp, sli˚->
y0
-
yp
);

432 
	`døwrow
(
¶i˚
->
psd
, sli˚->
x0
-
xp
, sli˚->x0+xp, sli˚->
y0
+
yp
);

433 
	`GdSëDash
(&
dm
, &
dc
);

438 
MWELLIPSE
:

439 i‡(!
døw⁄
) ;

441 
	`døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
 + 
xp
, sli˚->
y0
 + 
yp
);

442 
	`døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
 - 
xp
, sli˚->
y0
 + 
yp
);

443 
	`døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
 + 
xp
, sli˚->
y0
 - 
yp
);

444 
	`døwpoöt
(
¶i˚
->
psd
, sli˚->
x0
 - 
xp
, sli˚->
y0
 - 
yp
);

447 
MWPIE
:

449 i‡(
gr_fûlmode
 =
MWFILL_SOLID
Ë
	`GdSëDash
(&
dm
, &
dc
);

450 
	`døw_löe
(
¶i˚
, -
xp
, -
yp
, +xp, 1);

451 
	`døw_löe
(
¶i˚
, -
xp
, +
yp
, +xp, 1);

452 i‡(
gr_fûlmode
 =
MWFILL_SOLID
Ë
	`GdSëDash
(&
dm
, &
dc
);

458 
	`døw_löe
(
¶i˚
, +
xp
, +
yp
, +xp, 0);

459 
	`døw_löe
(
¶i˚
, -
xp
, +
yp
, -xp, 0);

460 
	`døw_löe
(
¶i˚
, +
xp
, -
yp
, +xp, 0);

461 
	`døw_löe
(
¶i˚
, -
xp
, -
yp
, -xp, 0);

464 
	}
}

468 
	$døw¨c
(
SLICE
 *
¶i˚
)

470 
gr_dashmask
;

471 
gr_dashcou¡
;

473 
MWCOORD
 
xp
, 
yp
;

474 
MWCOORD
 
rx
, 
ry
;

475 
Asqu¨ed
;

476 
TwoAsqu¨ed
;

477 
Bsqu¨ed
;

478 
TwoBsqu¨ed
;

479 
d
;

480 
dx
, 
dy
;

482 
bô
 = 0;

483 
døw⁄
 = 1;

485 
rx
 = 
¶i˚
->rx;

486 
ry
 = 
¶i˚
->ry;

488 
xp
 = 0;

489 
yp
 = 
ry
;

490 
Asqu¨ed
 = 
rx
 *Ñx;

491 
TwoAsqu¨ed
 = 2 * 
Asqu¨ed
;

492 
Bsqu¨ed
 = 
ry
 *Ñy;

493 
TwoBsqu¨ed
 = 2 * 
Bsqu¨ed
;

494 
d
 = 
Bsqu¨ed
 - 
Asqu¨ed
 * 
ry
 + (Asquared >> 2);

495 
dx
 = 0;

496 
dy
 = 
TwoAsqu¨ed
 * 
ry
;

498 i‡(
gr_fûlmode
 !
MWFILL_SOLID
)

499 
	`£t_ts_‹igö
(
¶i˚
->
x0
 - 
rx
, sli˚->
y0
 - 
ry
);

501 
dx
 < 
dy
) {

514 i‡((
d
 > 0Ë|| ((
¶i˚
->
ty≥
 !
MWPIE
Ë&& (¶i˚->ty≥ !
MWELLIPSEFILL
))) {

515 i‡(
gr_dashcou¡
) {

516 
døw⁄
 = (
gr_dashmask
 & (1 << 
bô
)) ? 1 : 0;

517 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

519 
døw⁄
 = 1;

521 
	`døw¨c£gmít
(
¶i˚
, 
xp
, 
yp
, 
døw⁄
);

524 i‡(
d
 > 0) {

525 
yp
--;

526 
dy
 -
TwoAsqu¨ed
;

527 
d
 -
dy
;

529 
xp
++;

530 
dx
 +
TwoBsqu¨ed
;

531 
d
 +(
Bsqu¨ed
 + 
dx
);

534 
d
 +((3L * (
Asqu¨ed
 - 
Bsqu¨ed
Ë/ 2L - (
dx
 + 
dy
)) >> 1);

536 
yp
 >= 0) {

537 i‡(
gr_dashcou¡
) {

538 
døw⁄
 = (
gr_dashmask
 & (1 << 
bô
)) ? 1 : 0;

539 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

541 
døw⁄
 = 1;

543 
	`døw¨c£gmít
(
¶i˚
, 
xp
, 
yp
, 
døw⁄
);

544 i‡(
d
 < 0) {

545 
xp
++;

546 
dx
 +
TwoBsqu¨ed
;

547 
d
 +
dx
;

549 
yp
--;

550 
dy
 -
TwoAsqu¨ed
;

551 
d
 +(
Asqu¨ed
 - 
dy
);

554 
	}
}

577 
	$GdArc
(
PSD
 
psd
, 
MWCOORD
 
x0
, MWCOORD 
y0
, MWCOORD 
rx
, MWCOORD 
ry
,

578 
MWCOORD
 
ax
, MWCOORD 
ay
, MWCOORD 
bx
, MWCOORD 
by
, 
ty≥
)

580 
MWCOORD
 
adú
, 
bdú
;

581 
SLICE
 
¶i˚
;

583 i‡(
rx
 <0 || 
ry
 <= 0)

593 i‡(
ay
 >= 0)

594 
adú
 = 1;

596 
adú
 = -1;

598 i‡(
by
 >= 0)

599 
bdú
 = -1;

601 
bdú
 = 1;

612 i‡(
ay
 == 0) ++ay;

613 i‡(
by
 == 0) ++by;

616 i‡(
bx
 > 
ax
) {

617 
MWCOORD
 
sw≠
;

619 
sw≠
 = 
ax
;

620 
ax
 = 
bx
;

621 
bx
 = 
sw≠
;

623 
sw≠
 = 
ay
;

624 
ay
 = 
by
;

625 
by
 = 
sw≠
;

627 
sw≠
 = 
adú
;

628 
adú
 = 
bdú
;

629 
bdú
 = 
sw≠
;

633 i‡(
	`GdClùAªa
(
psd
, 
x0
-
rx
, 
y0
-
ry
, x0+rx, y0+ryË=
CLIP_INVISIBLE
)

636 
¶i˚
.
psd
 =Ösd;

637 
¶i˚
.
x0
 = x0;

638 
¶i˚
.
y0
 = y0;

639 
¶i˚
.
rx
 =Ñx;

640 
¶i˚
.
ry
 =Ñy;

641 
¶i˚
.
ax
 =áx;

642 
¶i˚
.
ay
 =áy;

643 
¶i˚
.
bx
 = bx;

644 
¶i˚
.
by
 = by;

645 
¶i˚
.
adú
 =ádir;

646 
¶i˚
.
bdú
 = bdir;

647 
¶i˚
.
ty≥
 =Åype;

649 
	`døw¨c
(&
¶i˚
);

651 i‡(
ty≥
 & 
MWOUTLINE
) {

653 
	`GdLöe
(
psd
, 
x0
, 
y0
, x0+
ax
, y0+
ay
, 
TRUE
);

654 
	`GdLöe
(
psd
, 
x0
, 
y0
, x0+
bx
, y0+
by
, 
TRUE
);

657 
	`GdFixCurs‹
(
psd
);

658 
	}
}

673 
	$GdEŒù£
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
rx
, MWCOORD 
ry
, 
MWBOOL
 
fûl
)

675 
SLICE
 
¶i˚
;

677 i‡(
rx
 < 0 || 
ry
 < 0)

683 
	`GdClùAªa
(
psd
, 
x
 - 
rx
, 
y
 - 
ry
, x +Ñx, y +Ñy)) {

684 
CLIP_VISIBLE
:

695 
CLIP_INVISIBLE
:

699 
¶i˚
.
psd
 =Ösd;

700 
¶i˚
.
x0
 = 
x
;

701 
¶i˚
.
y0
 = 
y
;

702 
¶i˚
.
rx
 =Ñx;

703 
¶i˚
.
ry
 =Ñy;

704 
¶i˚
.
ty≥
 = 
fûl
? 
MWELLIPSEFILL
: 
MWELLIPSE
;

707 
	`døw¨c
(&
¶i˚
);

709 
	`GdFixCurs‹
(
psd
);

710 
	}
}

	@engine/devclip.c

1 
	~"devi˚.h
"

3 #i‡
DYNAMICREGIONS


4 
	~"dev˛ù2.c
"

6 
	~"dev˛ù1.c
"

	@engine/devclip1.c

9 
	~"devi˚.h
"

16 
MWCOORD
 
	g˛ùmöx
;

17 
MWCOORD
 
	g˛ùmöy
;

18 
MWCOORD
 
	g˛ùmaxx
;

19 
MWCOORD
 
	g˛ùmaxy
;

21 
MWBOOL
 
	g˛ùªsu…
;

22 
	g˛ùcou¡
;

23 
MWCLIPRECT
 
	g˛ùª˘s
[
MAX_CLIPRECTS
];

38 
	$GdSëClùRe˘s
(
PSD
 
psd
,
cou¡
, 
MWCLIPRECT
 *
èbÀ
)

40 
MWCLIPRECT
 *
Ω
;

43 i‡(
cou¡
 <= 0) {

44 
˛ùmöx
 = 0;

45 
˛ùmöy
 = 0;

46 
˛ùmaxx
 = 
psd
->
xvúåes
 - 1;

47 
˛ùmaxy
 = 
psd
->
yvúåes
 - 1;

48 
˛ùcou¡
 = 0;

49 
˛ùªsu…
 = 
TRUE
;

57 
Ω
 = 
˛ùª˘s
;

58 
˛ùcou¡
 = 0;

59 i‡(
cou¡
 > 
MAX_CLIPRECTS
) count = MAX_CLIPRECTS;

60 
cou¡
-- > 0) {

61 *
Ω
 = *
èbÀ
++;

62 i‡(
Ω
->
x
 < 0) {

63 
Ω
->
width
 +Ω->
x
;

64 
Ω
->
x
 = 0;

66 i‡(
Ω
->
y
 < 0) {

67 
Ω
->
height
 +Ω->
y
;

68 
Ω
->
y
 = 0;

70 i‡((
Ω
->
x
 >
psd
->
xvúåes
Ë|| (Ω->
width
 <= 0) ||

71 (
Ω
->
y
 >
psd
->
yvúåes
Ë|| (Ω->
height
 <= 0))

73 i‡(
Ω
->
x
 +Ñp->
width
 > 
psd
->
xvúåes
)

74 
Ω
->
width
 = 
psd
->
xvúåes
 -Ñp->
x
;

75 i‡(
Ω
->
y
 +Ñp->
height
 > 
psd
->
yvúåes
)

76 
Ω
->
height
 = 
psd
->
yvúåes
 -Ñp->
y
;

77 
Ω
++;

78 
˛ùcou¡
++;

84 i‡(
˛ùcou¡
 == 0) {

85 
˛ùmöx
 = 
MIN_MWCOORD
;

86 
˛ùmöy
 = 
MIN_MWCOORD
;

87 
˛ùmaxx
 = 
MAX_MWCOORD
;

88 
˛ùmaxy
 = 
MAX_MWCOORD
;

89 
˛ùªsu…
 = 
FALSE
;

96 
˛ùmöx
 = 
˛ùª˘s
[0].
x
;

97 
˛ùmöy
 = 
˛ùª˘s
[0].
y
;

98 
˛ùmaxx
 = 
˛ùmöx
 + 
˛ùª˘s
[0].
width
 - 1;

99 
˛ùmaxy
 = 
˛ùmöy
 + 
˛ùª˘s
[0].
height
 - 1;

100 
˛ùªsu…
 = 
TRUE
;

101 
	}
}

120 
MWBOOL


121 
	$GdClùPoöt
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
)

123 
cou¡
;

124 
MWCLIPRECT
 *
Ω
;

125 
MWCOORD
 
ãmp
;

130 i‡((
x
 >
˛ùmöx
Ë&& (x <
˛ùmaxx
) &&

131 (
y
 >
˛ùmöy
Ë&& (y <
˛ùmaxy
)) {

132 i‡(
˛ùªsu…
Ë
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

133  
˛ùªsu…
;

140 i‡(
x
 < 0) {

141 
˛ùmöx
 = 
MIN_MWCOORD
;

142 
˛ùmaxx
 = -1;

143 
˛ùmöy
 = 
MIN_MWCOORD
;

144 
˛ùmaxy
 = 
MAX_MWCOORD
;

145 
˛ùªsu…
 = 
FALSE
;

146  
FALSE
;

148 i‡(
y
 < 0) {

149 
˛ùmöx
 = 
MIN_MWCOORD
;

150 
˛ùmaxx
 = 
MAX_MWCOORD
;

151 
˛ùmöy
 = 
MIN_MWCOORD
;

152 
˛ùmaxy
 = -1;

153 
˛ùªsu…
 = 
FALSE
;

154  
FALSE
;

156 i‡(
x
 >
psd
->
xvúåes
) {

157 
˛ùmöx
 = 
psd
->
xvúåes
;

158 
˛ùmaxx
 = 
MAX_MWCOORD
;

159 
˛ùmöy
 = 
MIN_MWCOORD
;

160 
˛ùmaxy
 = 
MAX_MWCOORD
;

161 
˛ùªsu…
 = 
FALSE
;

162  
FALSE
;

164 i‡(
y
 >
psd
->
yvúåes
) {

165 
˛ùmöx
 = 
MIN_MWCOORD
;

166 
˛ùmaxx
 = 
MAX_MWCOORD
;

167 
˛ùmöy
 = 
psd
->
yvúåes
;

168 
˛ùmaxy
 = 
MAX_MWCOORD
;

169 
˛ùªsu…
 = 
FALSE
;

170  
FALSE
;

177 
cou¡
 = 
˛ùcou¡
;

178 i‡(
cou¡
 <= 0) {

179 
˛ùmöx
 = 0;

180 
˛ùmaxx
 = 
psd
->
xvúåes
 - 1;

181 
˛ùmöy
 = 0;

182 
˛ùmaxy
 = 
psd
->
yvúåes
 - 1;

183 
˛ùªsu…
 = 
TRUE
;

184 
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

185  
TRUE
;

195 
Ω
 = 
˛ùª˘s
; 
cou¡
-- > 0;Ñp++) {

196 i‡((
x
 >
Ω
->xË&& (
y
 >Ω->yË&& (x <Ñp->x +Ñp->
width
)

197 && (
y
 < 
Ω
->y +Ñp->
height
)) {

198 
˛ùmöx
 = 
Ω
->
x
;

199 
˛ùmöy
 = 
Ω
->
y
;

200 
˛ùmaxx
 = 
Ω
->
x
 +Ñp->
width
 - 1;

201 
˛ùmaxy
 = 
Ω
->
y
 +Ñp->
height
 - 1;

202 
˛ùªsu…
 = 
TRUE
;

203 
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

204  
TRUE
;

215 
˛ùmöx
 = 
MIN_MWCOORD
;

216 
˛ùmöy
 = 
MIN_MWCOORD
;

217 
˛ùmaxx
 = 
MAX_MWCOORD
;

218 
˛ùmaxy
 = 
MAX_MWCOORD
;

219 
cou¡
 = 
˛ùcou¡
;

220 
Ω
 = 
˛ùª˘s
; 
cou¡
-- > 0;Ñp++) {

221 i‡((
x
 < 
Ω
->xË&& (Ω->x <
˛ùmaxx
)) clipmaxx =Ñp->x - 1;

222 
ãmp
 = 
Ω
->
x
 +Ñp->
width
 - 1;

223 i‡((
x
 > 
ãmp
Ë&& (ãm∞>
˛ùmöx
)) clipminx =Åemp + 1;

224 i‡((
y
 < 
Ω
->yË&& (Ω->y <
˛ùmaxy
)) clipmaxy =Ñp->y - 1;

225 
ãmp
 = 
Ω
->
y
 +Ñp->
height
 - 1;

226 i‡((
y
 > 
ãmp
Ë&& (ãm∞>
˛ùmöy
)) clipminy =Åemp + 1;

228 
˛ùªsu…
 = 
FALSE
;

229  
FALSE
;

230 
	}
}

252 
	$GdClùAªa
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
)

254 i‡((
x1
 < 
˛ùmöx
Ë|| (x1 > 
˛ùmaxx
) ||

255 (
y1
 < 
˛ùmöy
Ë|| (y1 > 
˛ùmaxy
))

256 
	`GdClùPoöt
(
psd
, 
x1
, 
y1
);

258 i‡((
x2
 >
˛ùmöx
Ë&& (x2 <
˛ùmaxx
) &&

259 (
y2
 >
˛ùmöy
Ë&& (y2 <
˛ùmaxy
)) {

260 i‡(!
˛ùªsu…
Ë 
CLIP_INVISIBLE
;

261 
	`GdCheckCurs‹
(
psd
, 
x1
, 
y1
, 
x2
, 
y2
);

262  
CLIP_VISIBLE
;

264  
CLIP_PARTIAL
;

265 
	}
}

	@engine/devclip2.c

9 
	~<°dio.h
>

10 
	~"devi˚.h
"

17 
MWCOORD
 
	g˛ùmöx
;

18 
MWCOORD
 
	g˛ùmöy
;

19 
MWCOORD
 
	g˛ùmaxx
;

20 
MWCOORD
 
	g˛ùmaxy
;

22 
MWBOOL
 
	g˛ùªsu…
;

23 
MWCLIPREGION
 *
	g˛ùªgi⁄
 = 
NULL
;

36 
	$GdSëClùRegi⁄
(
PSD
 
psd
, 
MWCLIPREGION
 *
ªg
)

38 if(
˛ùªgi⁄
)

39 
	`GdDe°royRegi⁄
(
˛ùªgi⁄
);

41 if(!
ªg
)

42 
ªg
 = 
	`GdAŒocRegi⁄
();

44 
˛ùªgi⁄
 = 
ªg
;

48 
MWRECT
 
rc
;

53 
cou¡
-- > 0) {

54 
MWCLIPRECT
 
¸
;

55 
MWCLIPRECT
 *
Ω
 = &
¸
;

57 *
Ω
 = *
èbÀ
++;

58 i‡(
Ω
->
x
 < 0) {

59 
Ω
->
width
 +Ω->
x
;

60 
Ω
->
x
 = 0;

62 i‡(
Ω
->
y
 < 0) {

63 
Ω
->
height
 +Ω->
y
;

64 
Ω
->
y
 = 0;

66 i‡((
Ω
->
x
 >
psd
->
xvúåes
Ë|| (Ω->
width
 <= 0) ||

67 (
Ω
->
y
 >
psd
->
yvúåes
Ë|| (Ω->
height
 <= 0))

69 i‡(
Ω
->
x
 +Ñp->
width
 > 
psd
->
xvúåes
)

70 
Ω
->
width
 = 
psd
->
xvúåes
 -Ñp->
x
;

71 i‡(
Ω
->
y
 +Ñp->
height
 > 
psd
->
yvúåes
)

72 
Ω
->
height
 = 
psd
->
yvúåes
 -Ñp->
y
;

73 
rc
.
À·
 = 
Ω
->
x
;

74 
rc
.
t›
 = 
Ω
->
y
;

75 
rc
.
right
 = 
Ω
->
x
+Ω->
width
;

76 
rc
.
bŸtom
 = 
Ω
->
y
+Ω->
height
;

77 
	`GdUni⁄Re˘WôhRegi⁄
(&
rc
, 
˛ùªgi⁄
);

84 i‡(
˛ùªgi⁄
->
numRe˘s
 == 0) {

85 
˛ùmöx
 = 
MIN_MWCOORD
;

86 
˛ùmöy
 = 
MIN_MWCOORD
;

87 
˛ùmaxx
 = 
MAX_MWCOORD
;

88 
˛ùmaxy
 = 
MAX_MWCOORD
;

89 
˛ùªsu…
 = 
FALSE
;

96 
˛ùmöx
 = 
˛ùªgi⁄
->
ª˘s
[0].
À·
;

97 
˛ùmöy
 = 
˛ùªgi⁄
->
ª˘s
[0].
t›
;

98 
˛ùmaxx
 = 
˛ùªgi⁄
->
ª˘s
[0].
right
 - 1;

99 
˛ùmaxy
 = 
˛ùªgi⁄
->
ª˘s
[0].
bŸtom
 - 1;

100 
˛ùªsu…
 = 
TRUE
;

101 
	}
}

120 
MWBOOL


121 
	$GdClùPoöt
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
)

123 
cou¡
;

124 
MWRECT
 *
Ω
;

125 
MWCOORD
 
ãmp
;

130 i‡((
x
 >
˛ùmöx
Ë&& (x <
˛ùmaxx
) &&

131 (
y
 >
˛ùmöy
Ë&& (y <
˛ùmaxy
)) {

132 i‡(
˛ùªsu…
Ë
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

133  
˛ùªsu…
;

140 i‡(
x
 < 0) {

141 
˛ùmöx
 = 
MIN_MWCOORD
;

142 
˛ùmaxx
 = -1;

143 
˛ùmöy
 = 
MIN_MWCOORD
;

144 
˛ùmaxy
 = 
MAX_MWCOORD
;

145 
˛ùªsu…
 = 
FALSE
;

146  
FALSE
;

148 i‡(
y
 < 0) {

149 
˛ùmöx
 = 
MIN_MWCOORD
;

150 
˛ùmaxx
 = 
MAX_MWCOORD
;

151 
˛ùmöy
 = 
MIN_MWCOORD
;

152 
˛ùmaxy
 = -1;

153 
˛ùªsu…
 = 
FALSE
;

154  
FALSE
;

156 i‡(
x
 >
psd
->
xvúåes
) {

157 
˛ùmöx
 = 
psd
->
xvúåes
;

158 
˛ùmaxx
 = 
MAX_MWCOORD
;

159 
˛ùmöy
 = 
MIN_MWCOORD
;

160 
˛ùmaxy
 = 
MAX_MWCOORD
;

161 
˛ùªsu…
 = 
FALSE
;

162  
FALSE
;

164 i‡(
y
 >
psd
->
yvúåes
) {

165 
˛ùmöx
 = 
MIN_MWCOORD
;

166 
˛ùmaxx
 = 
MAX_MWCOORD
;

167 
˛ùmöy
 = 
psd
->
yvúåes
;

168 
˛ùmaxy
 = 
MAX_MWCOORD
;

169 
˛ùªsu…
 = 
FALSE
;

170  
FALSE
;

177 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

178 i‡(
cou¡
 <= 0) {

179 
˛ùmöx
 = 0;

180 
˛ùmaxx
 = 
psd
->
xvúåes
 - 1;

181 
˛ùmöy
 = 0;

182 
˛ùmaxy
 = 
psd
->
yvúåes
 - 1;

183 
˛ùªsu…
 = 
TRUE
;

184 
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

185  
TRUE
;

195 
Ω
 = 
˛ùªgi⁄
->
ª˘s
; 
cou¡
-- > 0;Ñp++) {

196 i‡((
x
 >
Ω
->
À·
Ë&& (
y
 >Ω->
t›
Ë&& (x <Ñp->
right
)

197 && (
y
 < 
Ω
->
bŸtom
)) {

198 
˛ùmöx
 = 
Ω
->
À·
;

199 
˛ùmöy
 = 
Ω
->
t›
;

200 
˛ùmaxx
 = 
Ω
->
right
 - 1;

201 
˛ùmaxy
 = 
Ω
->
bŸtom
 - 1;

202 
˛ùªsu…
 = 
TRUE
;

203 
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x, y);

204  
TRUE
;

215 
˛ùmöx
 = 
MIN_MWCOORD
;

216 
˛ùmöy
 = 
MIN_MWCOORD
;

217 
˛ùmaxx
 = 
MAX_MWCOORD
;

218 
˛ùmaxy
 = 
MAX_MWCOORD
;

219 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

220 
Ω
 = 
˛ùªgi⁄
->
ª˘s
; 
cou¡
-- > 0;Ñp++) {

221 i‡((
x
 < 
Ω
->
À·
Ë&& (Ω->À· <
˛ùmaxx
)) clipmaxx =Ñp->left - 1;

222 
ãmp
 = 
Ω
->
right
 - 1;

223 i‡((
x
 > 
ãmp
Ë&& (ãm∞>
˛ùmöx
)) clipminx =Åemp + 1;

224 i‡((
y
 < 
Ω
->
t›
Ë&& (Ω->t› <
˛ùmaxy
)) clipmaxy =Ñp->top - 1;

225 
ãmp
 = 
Ω
->
bŸtom
 - 1;

226 i‡((
y
 > 
ãmp
Ë&& (ãm∞>
˛ùmöy
)) clipminy =Åemp + 1;

228 
˛ùªsu…
 = 
FALSE
;

229  
FALSE
;

230 
	}
}

252 
	$GdClùAªa
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
)

254 i‡((
x1
 < 
˛ùmöx
Ë|| (x1 > 
˛ùmaxx
) ||

255 (
y1
 < 
˛ùmöy
Ë|| (y1 > 
˛ùmaxy
))

256 
	`GdClùPoöt
(
psd
, 
x1
, 
y1
);

258 i‡((
x2
 >
˛ùmöx
Ë&& (x2 <
˛ùmaxx
) &&

259 (
y2
 >
˛ùmöy
Ë&& (y2 <
˛ùmaxy
)) {

260 i‡(!
˛ùªsu…
Ë 
CLIP_INVISIBLE
;

261 
	`GdCheckCurs‹
(
psd
, 
x1
, 
y1
, 
x2
, 
y2
);

262  
CLIP_VISIBLE
;

264  
CLIP_PARTIAL
;

265 
	}
}

	@engine/devdraw.c

17 
	~<°dio.h
>

18 
	~<°dlib.h
>

19 
	~<°rög.h
>

20 
	~<as£π.h
>

21 
	~"devi˚.h
"

23 #i‡
PSP


24 
	#as£π
(
x
)

	)

27 
MWPIXELVAL
 
gr_f‹eground
;

28 
MWPIXELVAL
 
gr_background
;

29 
MWBOOL
 
gr_u£bg
;

30 
gr_mode
;

31 
MWPALENTRY
 
gr_∑Àâe
[256];

32 
gr_fú°u£ΩÆíåy
;

33 
gr_√xçÆíåy
;

36 
gr_dashmask
;

37 
gr_dashcou¡
;

39 
gr_fûlmode
;

41  
døwpoöt
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

43  
døwrow
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
x2
,MWCOORD 
y
);

44 
døwcﬁ
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
);

53 
	$GdSëMode
(
mode
)

55 
ﬁdmode
 = 
gr_mode
;

57 
gr_mode
 = 
mode
;

58  
ﬁdmode
;

59 
	}
}

68 
	$GdSëFûlMode
(
mode
)

70 
ﬁdmode
 = 
gr_fûlmode
;

72 
gr_fûlmode
 = 
mode
;

73  
ﬁdmode
;

74 
	}
}

82 
MWBOOL


83 
	$GdSëU£Background
(
MWBOOL
 
Êag
)

85 
MWBOOL
 
ﬁdu£bg
 = 
gr_u£bg
;

87 
gr_u£bg
 = 
Êag
;

88  
ﬁdu£bg
;

89 
	}
}

97 
MWPIXELVAL


98 
	$GdSëF‹egroundPixñVÆ
(
PSD
 
psd
, 
MWPIXELVAL
 
fg
)

100 
MWPIXELVAL
 
ﬁdfg
 = 
gr_f‹eground
;

102 
gr_f‹eground
 = 
fg
;

103  
ﬁdfg
;

104 
	}
}

113 
MWPIXELVAL


114 
	$GdSëBackgroundPixñVÆ
(
PSD
 
psd
, 
MWPIXELVAL
 
bg
)

116 
MWPIXELVAL
 
ﬁdbg
 = 
gr_background
;

118 
gr_background
 = 
bg
;

119  
ﬁdbg
;

120 
	}
}

129 
MWPIXELVAL


130 
	$GdSëF‹egroundCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
fg
)

132 
MWPIXELVAL
 
ﬁdfg
 = 
gr_f‹eground
;

134 
gr_f‹eground
 = 
	`GdFödCﬁ‹
(
psd
, 
fg
);

135  
ﬁdfg
;

136 
	}
}

146 
MWPIXELVAL


147 
	$GdSëBackgroundCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
bg
)

149 
MWPIXELVAL
 
ﬁdbg
 = 
gr_background
;

151 
gr_background
 = 
	`GdFödCﬁ‹
(
psd
, 
bg
);

152  
ﬁdbg
;

153 
	}
}

159 
	$GdSëDash
(*
mask
, *
cou¡
)

161 
ﬁdm
 = 
gr_dashmask
;

162 
ﬁdc
 = 
gr_dashcou¡
;

164 i‡(!
mask
 || !
cou¡
)

167 
gr_dashmask
 = *
mask
;

168 
gr_dashcou¡
 = *
cou¡
;

170 *
mask
 = 
ﬁdm
;

171 *
cou¡
 = 
ﬁdc
;

172 
	}
}

182 
	$GdPoöt
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

184 i‡(
	`GdClùPoöt
(
psd
, 
x
, 
y
)) {

185 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

186 
	`GdFixCurs‹
(
psd
);

188 
	}
}

208 
	$GdLöe
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
,

209 
MWBOOL
 
bDøwLa°Poöt
)

211 
xdñè
;

212 
ydñè
;

213 
xöc
;

214 
yöc
;

215 
ªm
;

216 
bô
 = 0;

217 
MWCOORD
 
ãmp
;

222 i‡(
y1
 =
y2
) {

226 i‡(!
bDøwLa°Poöt
) {

227 i‡(
x1
 > 
x2
) {

228 
ãmp
 = 
x1
;

229 
x1
 = 
x2
 + 1;

230 
x2
 = 
ãmp
;

232 --
x2
;

236 
	`døwrow
(
psd
, 
x1
, 
x2
, 
y1
);

237 
	`GdFixCurs‹
(
psd
);

240 i‡(
x1
 =
x2
) {

244 i‡(!
bDøwLa°Poöt
) {

245 i‡(
y1
 > 
y2
) {

246 
ãmp
 = 
y1
;

247 
y1
 = 
y2
 + 1;

248 
y2
 = 
ãmp
;

250 --
y2
;

254 
	`døwcﬁ
(
psd
, 
x1
, 
y1
, 
y2
);

255 
	`GdFixCurs‹
(
psd
);

262 
	`GdClùAªa
(
psd
, 
x1
, 
y1
, 
x2
, 
y2
)) {

263 
CLIP_VISIBLE
:

274 
CLIP_INVISIBLE
:

281 
xdñè
 = 
x2
 - 
x1
;

282 
ydñè
 = 
y2
 - 
y1
;

283 i‡(
xdñè
 < 0)

284 
xdñè
 = -xdelta;

285 i‡(
ydñè
 < 0)

286 
ydñè
 = -ydelta;

287 
xöc
 = (
x2
 > 
x1
)? 1 : -1;

288 
yöc
 = (
y2
 > 
y1
)? 1 : -1;

291 i‡(
	`GdClùPoöt
(
psd
, 
x1
, 
y1
))

292 
psd
->
	`DøwPixñ
’sd, 
x1
, 
y1
, 
gr_f‹eground
);

294 i‡(
xdñè
 >
ydñè
) {

295 
ªm
 = 
xdñè
 / 2;

297 i‡(!
bDøwLa°Poöt
 && 
x1
 =
x2
)

299 
x1
 +
xöc
;

300 
ªm
 +
ydñè
;

301 i‡(
ªm
 >
xdñè
) {

302 
ªm
 -
xdñè
;

303 
y1
 +
yöc
;

306 i‡(
gr_dashcou¡
) {

307 i‡((
gr_dashmask
 & (1 << 
bô
)Ë&& 
	`GdClùPoöt
(
psd
, 
x1
, 
y1
))

308 
psd
->
	`DøwPixñ
’sd, 
x1
, 
y1
, 
gr_f‹eground
);

310 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

312 i‡(
	`GdClùPoöt
(
psd
, 
x1
, 
y1
))

313 
psd
->
	`DøwPixñ
’sd, 
x1
, 
y1
, 
gr_f‹eground
);

316 i‡(
bDøwLa°Poöt
 && 
x1
 =
x2
)

321 
ªm
 = 
ydñè
 / 2;

323 i‡(!
bDøwLa°Poöt
 && 
y1
 =
y2
)

325 
y1
 +
yöc
;

326 
ªm
 +
xdñè
;

327 i‡(
ªm
 >
ydñè
) {

328 
ªm
 -
ydñè
;

329 
x1
 +
xöc
;

333 i‡(
gr_dashcou¡
) {

334 i‡((
gr_dashmask
 & (1 << 
bô
)Ë&& 
	`GdClùPoöt
(
psd
, 
x1
, 
y1
))

335 
psd
->
	`DøwPixñ
’sd, 
x1
, 
y1
, 
gr_f‹eground
);

337 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

339 i‡(
	`GdClùPoöt
(
psd
, 
x1
, 
y1
))

340 
psd
->
	`DøwPixñ
’sd, 
x1
, 
y1
, 
gr_f‹eground
);

343 i‡(
bDøwLa°Poöt
 && 
y1
 =
y2
)

347 
	`GdFixCurs‹
(
psd
);

348 
	}
}

352 
	$døwpoöt
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

354 i‡(
	`GdClùPoöt
(
psd
, 
x
, 
y
))

355 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

356 
	}
}

362 
	$døwrow
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
)

364 
MWCOORD
 
ãmp
;

367 i‡(
x1
 > 
x2
) {

368 
ãmp
 = 
x1
;

369 
x1
 = 
x2
;

370 
x2
 = 
ãmp
;

374 i‡(
x1
 < 0)

375 
x1
 = 0;

376 i‡(
x2
 >
psd
->
xvúåes
)

377 
x2
 = 
psd
->
xvúåes
 - 1;

380 
	`GdCheckCurs‹
(
psd
, 
x1
, 
y
, 
x2
, y);

384 i‡(!
gr_dashcou¡
) {

385 
x1
 <
x2
) {

386 i‡(
	`GdClùPoöt
(
psd
, 
x1
, 
y
)) {

387 
ãmp
 = 
	`MWMIN
(
˛ùmaxx
, 
x2
);

388 
psd
->
	`DøwH‹zLöe
’sd, 
x1
, 
ãmp
, 
y
, 
gr_f‹eground
);

390 
ãmp
 = 
	`MWMIN
(
˛ùmaxx
, 
x2
);

391 
x1
 = 
ãmp
 + 1;

394 
p
, 
bô
 = 0;

397 
p
 = 
x1
;Ö <
x2
;Ö++) {

398 i‡((
gr_dashmask
 & (1 << 
bô
)Ë&& 
	`GdClùPoöt
(
psd
, 
p
, 
y
))

399 
psd
->
	`DøwPixñ
’sd, 
p
, 
y
, 
gr_f‹eground
);

401 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

404 
	}
}

410 
	$døwcﬁ
(
PSD
 
psd
, 
MWCOORD
 
x
,MWCOORD 
y1
,MWCOORD 
y2
)

412 
MWCOORD
 
ãmp
;

415 i‡(
y1
 > 
y2
) {

416 
ãmp
 = 
y1
;

417 
y1
 = 
y2
;

418 
y2
 = 
ãmp
;

422 i‡(
y1
 < 0)

423 
y1
 = 0;

424 i‡(
y2
 >
psd
->
yvúåes
)

425 
y2
 = 
psd
->
yvúåes
 - 1;

428 
	`GdCheckCurs‹
(
psd
, 
x
, 
y1
, x, 
y2
);

430 i‡(!
gr_dashcou¡
) {

431 
y1
 <
y2
) {

432 i‡(
	`GdClùPoöt
(
psd
, 
x
, 
y1
)) {

433 
ãmp
 = 
	`MWMIN
(
˛ùmaxy
, 
y2
);

434 
psd
->
	`DøwVîtLöe
’sd, 
x
, 
y1
, 
ãmp
, 
gr_f‹eground
);

436 
ãmp
 = 
	`MWMIN
(
˛ùmaxy
, 
y2
);

437 
y1
 = 
ãmp
 + 1;

440 
p
, 
bô
 = 0;

443 
p
 = 
y1
;Ö <
y2
;Ö++) {

444 i‡((
gr_dashmask
 & (1<<
bô
)Ë&& 
	`GdClùPoöt
(
psd
, 
x
, 
p
))

445 
psd
->
	`DøwPixñ
’sd, 
x
, 
p
, 
gr_f‹eground
);

447 
bô
 = (bô + 1Ë% 
gr_dashcou¡
;

450 
	}
}

464 
	$GdRe˘
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
)

466 
MWCOORD
 
maxx
;

467 
MWCOORD
 
maxy
;

469 i‡(
width
 <0 || 
height
 <= 0)

471 
maxx
 = 
x
 + 
width
 - 1;

472 
maxy
 = 
y
 + 
height
 - 1;

473 
	`døwrow
(
psd
, 
x
, 
maxx
, 
y
);

474 i‡(
height
 > 1)

475 
	`døwrow
(
psd
, 
x
, 
maxx
, 
maxy
);

476 i‡(
height
 < 3)

478 ++
y
;

479 --
maxy
;

480 
	`døwcﬁ
(
psd
, 
x
, 
y
, 
maxy
);

481 i‡(
width
 > 1)

482 
	`døwcﬁ
(
psd
, 
maxx
, 
y
, 
maxy
);

483 
	`GdFixCurs‹
(
psd
);

484 
	}
}

497 
	$GdFûlRe˘
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
width
, MWCOORD 
height
)

499 
dm
 = 0;

500 
dc
 = 0;

502 
MWCOORD
 
x2
 = 
x1
 + 
width
 - 1;

503 
MWCOORD
 
y2
 = 
y1
 + 
height
 - 1;

505 i‡(
width
 <0 || 
height
 <= 0)

509 i‡(
gr_fûlmode
 !
MWFILL_SOLID
) {

510 
	`£t_ts_‹igö
(
x1
, 
y1
);

512 
	`ts_fûÃe˘
(
psd
, 
x1
, 
y1
, 
width
, 
height
);

513 
	`GdFixCurs‹
(
psd
);

520 
	`GdClùAªa
(
psd
, 
x1
, 
y1
, 
x2
, 
y2
)) {

521 
CLIP_VISIBLE
:

522 
psd
->
	`FûlRe˘
’sd, 
x1
, 
y1
, 
x2
, 
y2
, 
gr_f‹eground
);

523 
	`GdFixCurs‹
(
psd
);

526 
CLIP_INVISIBLE
:

532 
	`GdSëDash
(&
dm
, &
dc
);

535 
y1
 <
y2
)

536 
	`døwrow
(
psd
, 
x1
, 
x2
, 
y1
++);

539 
	`GdSëDash
(&
dm
, &
dc
);

541 
	`GdFixCurs‹
(
psd
);

542 
	}
}

563 
	$døwbôm≠
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

564 c⁄° 
MWIMAGEBITS
 *
imagebôs
)

566 
MWCOORD
 
möx
;

567 
MWCOORD
 
maxx
;

568 
MWIMAGEBITS
 
bôvÆue
 = 0;

569 
bôcou¡
;

571 i‡(
width
 <0 || 
height
 <= 0)

574 i‡(
gr_u£bg
)

575 
psd
->
	`FûlRe˘
’sd, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1,

576 
gr_background
);

583 
möx
 = 
x
;

584 
maxx
 = 
x
 + 
width
 - 1;

585 
bôcou¡
 = 0;

586 
height
 > 0) {

587 i‡(
bôcou¡
 <= 0) {

588 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

589 
bôvÆue
 = *
imagebôs
++;

592 i‡(
	`MWIMAGE_TESTBIT
(
bôvÆue
))

593 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

594 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT
(bitvalue);

595 
bôcou¡
--;

596 i‡(
x
++ =
maxx
) {

597 
x
 = 
möx
;

598 
y
++;

599 --
height
;

600 
bôcou¡
 = 0;

603 
	}
}

606 
	$GdBôm≠
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

607 c⁄° 
MWIMAGEBITS
 *
imagebôs
)

609 
MWCOORD
 
möx
;

610 
MWCOORD
 
maxx
;

611 
MWPIXELVAL
 
ßvecﬁ‹
;

612 
MWIMAGEBITS
 
bôvÆue
 = 0;

613 
bôcou¡
;

615 i‡(
width
 <0 || 
height
 <= 0)

618 
	`GdClùAªa
(
psd
, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1)) {

619 
CLIP_VISIBLE
:

620 
	`døwbôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
imagebôs
);

621 
	`GdFixCurs‹
(
psd
);

624 
CLIP_INVISIBLE
:

631 i‡(
gr_u£bg
) {

632 
ßvecﬁ‹
 = 
gr_f‹eground
;

633 
gr_f‹eground
 = 
gr_background
;

635 
	`GdFûlRe˘
(
psd
, 
x
, 
y
, 
width
, 
height
);

636 
gr_f‹eground
 = 
ßvecﬁ‹
;

638 
möx
 = 
x
;

639 
maxx
 = 
x
 + 
width
 - 1;

640 
bôcou¡
 = 0;

641 
height
 > 0) {

642 i‡(
bôcou¡
 <= 0) {

643 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

644 
bôvÆue
 = *
imagebôs
++;

646 i‡(
	`MWIMAGE_TESTBIT
(
bôvÆue
Ë&& 
	`GdClùPoöt
(
psd
, 
x
, 
y
))

647 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

648 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT
(bitvalue);

649 
bôcou¡
--;

650 i‡(
x
++ =
maxx
) {

651 
x
 = 
möx
;

652 
y
++;

653 --
height
;

654 
bôcou¡
 = 0;

657 
	`GdFixCurs‹
(
psd
);

658 
	}
}

668 
MWBOOL


669 
	$GdCﬁ‹InPÆëã
(
MWCOLORVAL
 
¸
,
MWPALENTRY
 *
∑Àâe
,
∑lsize
)

671 
i
;

673 
i
=0; i<
∑lsize
; ++i)

674 if(
	`GETPALENTRY
(
∑Àâe
, 
i
Ë=
¸
)

675  
TRUE
;

676  
FALSE
;

677 
	}
}

696 
	$GdMakePÆëãC⁄vîsi⁄TabÀ
(
PSD
 
psd
,
MWPALENTRY
 *
∑Àâe
,
∑lsize
,

697 
MWPIXELVAL
 *
c⁄vèbÀ
,
fLﬂdTy≥
)

699 
i
;

700 
MWCOLORVAL
 
¸
;

701 
√wsize
, 
√xã¡ry
;

702 
MWPALENTRY
 
√w∑l
[256];

708 if(
psd
->
pixty≥
 =
MWPF_PALETTE
) {

709 
fLﬂdTy≥
) {

710 
LOADPALETTE
:

715 
	`GdSëPÆëã
(
psd
, 
gr_fú°u£ΩÆíåy
, 
∑lsize
, 
∑Àâe
);

718 
MERGEPALETTE
:

720 
i
=0; i<()
psd
->
ncﬁ‹s
; ++i)

721 
√w∑l
[
i
] = 
gr_∑Àâe
[i];

724 
√wsize
 = 0;

725 
√xã¡ry
 = 
gr_√xçÆíåy
;

728 
i
=0; i<
∑lsize
 && 
√xã¡ry
 < ()
psd
->
ncﬁ‹s
; ++i) {

729 
¸
 = 
	`GETPALENTRY
(
∑Àâe
, 
i
);

730 if(!
	`GdCﬁ‹InPÆëã
(
¸
, 
√w∑l
, 
√xã¡ry
)) {

731 
√w∑l
[
√xã¡ry
++] = 
∑Àâe
[
i
];

732 ++
√wsize
;

737 if(
√wsize
) {

738 
	`GdSëPÆëã
(
psd
, 
gr_√xçÆíåy
, 
√wsize
,

739 &
√w∑l
[
gr_√xçÆíåy
]);

740 
gr_√xçÆíåy
 +
√wsize
;

753 
i
=0; i<
∑lsize
; ++i) {

754 
¸
 = 
	`GETPALENTRY
(
∑Àâe
, 
i
);

755 
c⁄vèbÀ
[
i
] = 
	`GdFödCﬁ‹
(
psd
, 
¸
);

757 
	}
}

774 
	$GdDøwImage
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, 
PMWIMAGEHDR
 
pimage
)

776 
MWCOORD
 
möx
;

777 
MWCOORD
 
maxx
;

778 
MWUCHAR
 
bôvÆue
 = 0;

779 
bôcou¡
;

780 
MWUCHAR
 *
imagebôs
;

781 
MWCOORD
 
height
, 
width
;

782 
bµ
;

783 
MWPIXELVAL
 
pixñ
;

784 
˛ù
;

785 
exåa
, 
löesize
;

786 
rgb‹dî
;

787 
MWCOLORVAL
 
¸
;

788 
MWCOORD
 
yoff
;

789 
å™scﬁ‹
;

790 
MWPIXELVAL
 
c⁄vèbÀ
[256];

792 
	`as£π
(
pimage
);

794 
height
 = 
pimage
->height;

795 
width
 = 
pimage
->width;

798 
˛ù
 = 
	`GdClùAªa
(
psd
, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1);

799 if(
˛ù
 =
CLIP_INVISIBLE
)

802 
å™scﬁ‹
 = 
pimage
->transcolor;

803 
bµ
 = 
pimage
->bpp;

808 i‡(
pimage
->
bµ
 <= 8) {

809 if(!
pimage
->
∑Àâe
) {

811 
yoff
=0; yoff<
pimage
->
∑lsize
; ++yoff)

812 
c⁄vèbÀ
[
yoff
] = yoff;

813 } 
	`GdMakePÆëãC⁄vîsi⁄TabÀ
(
psd
, 
pimage
->
∑Àâe
,

814 
pimage
->
∑lsize
, 
c⁄vèbÀ
, 
MERGEPALETTE
);

824 
möx
 = 
x
;

825 
maxx
 = 
x
 + 
width
 - 1;

826 
imagebôs
 = 
pimage
->imagebits;

829 if(
pimage
->
com¥essi⁄
 & 
MWIMAGE_UPSIDEDOWN
) {

830 
y
 +
height
 - 1;

831 
yoff
 = -1;

833 
yoff
 = 1;

835 
	#PIX2BYTES
(
n
Ë((“)+7)/8)

	)

837 
pimage
->
bµ
) {

840 
löesize
 = 
width
;

843 
löesize
 = 
width
*4;

846 
löesize
 = 
width
*3;

849 
löesize
 = 
	`PIX2BYTES
(
width
<<2);

852 
löesize
 = 
	`PIX2BYTES
(
width
);

855 
exåa
 = 
pimage
->
pôch
 - 
löesize
;

858 
rgb‹dî
 = 
pimage
->
com¥essi⁄
 & 
MWIMAGE_RGB
;

860 i‡((
bµ
 == 32)

861 && ((
pimage
->
com¥essi⁄
 & 
MWIMAGE_ALPHA_CHANNEL
) != 0)) {

862 *
d©a
 = (*Ë
imagebôs
;

867 
height
 > 0) {

869 
¸
 = *
d©a
++;

870 #i‡
MW_CPU_BIG_ENDIAN


871 i‡(
rgb‹dî
)

874 
¸
 = ((cr & 0xFFFFFF00UL) >> 8)

875 | ((
¸
 & 0x000000FFUL) << 24);

880 
¸
 = ((cr & 0xFF000000UL) >> 24)

881 | ((
¸
 & 0x00FF0000UL) >> 8)

882 | ((
¸
 & 0x0000FF00UL) << 8)

883 | ((
¸
 & 0x000000FFUL) << 24);

886 i‡(
rgb‹dî
) {

888 
¸
 = (cr & 0xFF00FF00UL)

889 | ((
¸
 & 0x00FF0000UL) >> 16)

890 | ((
¸
 & 0x000000FFUL) << 16);

894 
psd
->
pixty≥
) {

895 
MWPF_PALETTE
:

897 
pixñ
 = 
	`GdFödCﬁ‹
(
psd
, 
¸
);

899 
MWPF_TRUECOLOR8888
:

900 
pixñ
 = 
	`COLOR2PIXEL8888
(
¸
);

902 
MWPF_TRUECOLOR0888
:

903 
MWPF_TRUECOLOR888
:

904 
pixñ
 = 
	`COLOR2PIXEL888
(
¸
);

906 
MWPF_TRUECOLOR565
:

907 
pixñ
 = 
	`COLOR2PIXEL565
(
¸
);

909 
MWPF_TRUECOLOR555
:

910 
pixñ
 = 
	`COLOR2PIXEL555
(
¸
);

912 
MWPF_TRUECOLOR332
:

913 
pixñ
 = 
	`COLOR2PIXEL332
(
¸
);

917 i‡(
˛ù
 =
CLIP_VISIBLE
 || 
	`GdClùPoöt
(
psd
, 
x
, 
y
))

918 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
pixñ
);

920 i‡(
x
++ =
maxx
) {

922 
x
 = 
möx
;

923 
y
 +
yoff
;

924 
height
--;

925 
d©a
 = (*Ë(((*Ëd©aË+ 
exåa
);

929 } i‡((
bµ
 == 24) || (bpp == 32)) {

930 
å™s
;

932 
height
 > 0) {

934 
å™s
 = 
¸
 = 
rgb‹dî


935 ? 
	`MWRGB
(
imagebôs
[0], imagebits[1],

936 
imagebôs
[2])

937 : 
	`MWRGB
(
imagebôs
[2], imagebits[1],

938 
imagebôs
[0]);

940 
imagebôs
 += 3;

942 i‡(
bµ
 == 32) {

950 i‡(*
imagebôs
++ == 0x01)

951 
å™s
 = 0x01000000;

955 i‡(
å™scﬁ‹
 !
å™s
) {

957 
psd
->
pixty≥
) {

958 
MWPF_PALETTE
:

960 
pixñ
 = 
	`GdFödCﬁ‹
(
psd
, 
¸
);

962 
MWPF_TRUECOLOR8888
:

963 
pixñ
 = 
	`COLOR2PIXEL8888
(
¸
);

965 
MWPF_TRUECOLOR0888
:

966 
MWPF_TRUECOLOR888
:

967 
pixñ
 = 
	`COLOR2PIXEL888
(
¸
);

969 
MWPF_TRUECOLOR565
:

970 
pixñ
 = 
	`COLOR2PIXEL565
(
¸
);

972 
MWPF_TRUECOLOR555
:

973 
pixñ
 = 
	`COLOR2PIXEL555
(
¸
);

975 
MWPF_TRUECOLOR332
:

976 
pixñ
 = 
	`COLOR2PIXEL332
(
¸
);

980 i‡(
˛ù
 =
CLIP_VISIBLE


981 || 
	`GdClùPoöt
(
psd
, 
x
, 
y
))

982 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
pixñ
);

985 i‡(
˛ù
 !
CLIP_VISIBLE
 && !
˛ùªsu…


986 && 
x
 > 
˛ùmaxx
) {

987 
x
 = 
maxx
;

992 i‡(
x
++ =
maxx
) {

993 
x
 = 
möx
;

994 
y
 +
yoff
;

995 
height
--;

996 
imagebôs
 +
exåa
;

1001 
bôcou¡
 = 0;

1002 
height
 > 0) {

1003 i‡(
bôcou¡
 <= 0) {

1004 
bôcou¡
 = (
MWUCHAR
) * 8;

1005 
bôvÆue
 = *
imagebôs
++;

1007 
bµ
) {

1010 
bôcou¡
 = 0;

1011 i‡(
bôvÆue
 =
å™scﬁ‹
)

1012 
√xt
;

1014 
pixñ
 = 
c⁄vèbÀ
[
bôvÆue
];

1017 i‡(((
bôvÆue
 & 0xf0Ë>> 4Ë=
å™scﬁ‹
) {

1018 
bôvÆue
 <<= 4;

1019 
bôcou¡
 -= 4;

1020 
√xt
;

1023 
pixñ
 = 
c⁄vèbÀ
[(
bôvÆue
 & 0xf0) >> 4];

1024 
bôvÆue
 <<= 4;

1025 
bôcou¡
 -= 4;

1028 --
bôcou¡
;

1029 i‡(((
bôvÆue
 & 0x80Ë? 1 : 0Ë=
å™scﬁ‹
) {

1030 
bôvÆue
 <<= 1;

1031 
√xt
;

1034 
pixñ
 = 
c⁄vèbÀ
[(
bôvÆue
 & 0x80) ? 1 : 0];

1035 
bôvÆue
 <<= 1;

1039 i‡(
˛ù
 =
CLIP_VISIBLE
 || 
	`GdClùPoöt
(
psd
, 
x
, 
y
))

1040 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
pixñ
);

1043 i‡(
˛ù
 !
CLIP_VISIBLE
 && !
˛ùªsu…


1044 && 
x
 > 
˛ùmaxx
) {

1045 
x
 = 
maxx
;

1048 
√xt
:

1049 i‡(
x
++ =
maxx
) {

1050 
x
 = 
möx
;

1051 
y
 +
yoff
;

1052 
height
--;

1053 
bôcou¡
 = 0;

1054 
imagebôs
 +
exåa
;

1058 
	`GdFixCurs‹
(
psd
);

1059 
	}
}

1073 
	$GdRódAªa
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

1074 
MWPIXELVAL
 *
pixñs
)

1076 
MWCOORD
 
row
;

1077 
MWCOORD
 
cﬁ
;

1079 i‡(
width
 <0 || 
height
 <= 0)

1082 
	`GdCheckCurs‹
(
psd
, 
x
, 
y
, x+
width
-1, y+
height
-1);

1083 
row
 = 
y
;Ñow < 
height
+y;Ñow++)

1084 
cﬁ
 = 
x
; cﬁ < 
width
+x; col++)

1085 i‡(
row
 < 0 ||Ñow >
psd
->
yvúåes
 ||

1086 
cﬁ
 < 0 || cﬁ >
psd
->
xvúåes
)

1087 *
pixñs
++ = 0;

1088 *
pixñs
++ = 
psd
->
	`RódPixñ
’sd, 
cﬁ
, 
row
);

1090 
	`GdFixCurs‹
(
psd
);

1091 
	}
}

1106 
	$GdDøwAªaI¡î«l
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
)

1108 
MWCOORD
 
x
 = 
gc
->
d°x
;

1109 
MWCOORD
 
y
 = 
gc
->
d°y
;

1110 
MWCOORD
 
width
 = 
gc
->
d°w
;

1111 
MWCOORD
 
height
 = 
gc
->
d°h
;

1112 
MWCOORD
 
§cx
;

1113 
MWCOORD
 
§cy
;

1114 
˛ù≥d
;

1115 
rx1
, 
rx2
, 
ry1
, 
ry2
, 
rw
, 
rh
;

1116 
cou¡
;

1117 #i‡
DYNAMICREGIONS


1118 
MWRECT
 *
¥c
;

1119 
MWCLIPREGION
 *
˛ùªgi⁄
;

1121 
MWCLIPRECT
 *
¥c
;

1122 
MWCLIPRECT
 
˛ùª˘s
[];

1123 
˛ùcou¡
;

1126 i‡(!
psd
->
DøwAªa
)

1130 
˛ù≥d
 = 
	`GdClùAªa
(
psd
, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1);

1131 i‡(
˛ù≥d
 =
CLIP_INVISIBLE
) {

1133 } i‡(
˛ù≥d
 =
CLIP_VISIBLE
) {

1134 
psd
->
	`DøwAªa
’sd, 
gc
, 
›
);

1140 
§cx
 = 
gc
->srcx;

1141 
§cy
 = 
gc
->srcy;

1143 #i‡
DYNAMICREGIONS


1144 
¥c
 = 
˛ùªgi⁄
->
ª˘s
;

1145 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

1147 
¥c
 = 
˛ùª˘s
;

1148 
cou¡
 = 
˛ùcou¡
;

1151 
cou¡
-- > 0) {

1152 #i‡
DYNAMICREGIONS


1153 
rx1
 = 
¥c
->
À·
;

1154 
ry1
 = 
¥c
->
t›
;

1155 
rx2
 = 
¥c
->
right
;

1156 
ry2
 = 
¥c
->
bŸtom
;

1159 
rx1
 = 
¥c
->
x
;

1160 
ry1
 = 
¥c
->
y
;

1161 
rx2
 = 
¥c
->
x
 +Örc->
width
;

1162 
ry2
 = 
¥c
->
y
 +Örc->
height
;

1166 i‡(
rx1
 < 
x
)

1167 
rx1
 = 
x
;

1168 i‡(
ry1
 < 
y
)

1169 
ry1
 = 
y
;

1170 i‡(
rx2
 > 
x
 + 
width
)

1171 
rx2
 = 
x
 + 
width
;

1172 i‡(
ry2
 > 
y
 + 
height
)

1173 
ry2
 = 
y
 + 
height
;

1175 
rw
 = 
rx2
 - 
rx1
;

1176 
rh
 = 
ry2
 - 
ry1
;

1178 i‡(
rw
 > 0 && 
rh
 > 0) {

1179 
gc
->
d°x
 = 
rx1
;

1180 
gc
->
d°y
 = 
ry1
;

1181 
gc
->
d°w
 = 
rw
;

1182 
gc
->
d°h
 = 
rh
;

1183 
gc
->
§cx
 = srcx + 
rx1
 - 
x
;

1184 
gc
->
§cy
 = srcy + 
ry1
 - 
y
;

1185 
	`GdCheckCurs‹
(
psd
, 
rx1
, 
ry1
, 
rx2
 - 1, 
ry2
 - 1);

1186 
psd
->
	`DøwAªa
’sd, 
gc
, 
›
);

1188 
¥c
++;

1192 
gc
->
d°x
 = 
x
;

1193 
gc
->
d°y
 = 
y
;

1194 
gc
->
d°w
 = 
width
;

1195 
gc
->
d°h
 = 
height
;

1196 
gc
->
§cx
 = srcx;

1197 
gc
->
§cy
 = srcy;

1199 
	}
}

1239 
	$GdAªa
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
, *
pixñs
,

1240 
pixty≥
)

1242 *
PIXELS
 = 
pixñs
;

1243 
˚Œ°odo
;

1244 
cou¡
;

1245 
cc
;

1246 
rows
;

1247 
MWCOORD
 
möx
;

1248 
MWCOORD
 
maxx
;

1249 
MWPIXELVAL
 
ßvecﬁ‹
;

1250 
MWBOOL
 
dodøw
;

1251 
MWCOLORVAL
 
rgbcﬁ‹
 = 0L;

1252 
pixsize
;

1253 
r
, 
g
, 
b
;

1255 
möx
 = 
x
;

1256 
maxx
 = 
x
 + 
width
 - 1;

1259 i‡–
	`GdClùAªa
(
psd
, 
möx
, 
y
, 
maxx
, y + 
height
 - 1Ë=
CLIP_INVISIBLE
 )

1264 i‡(
pixty≥
 =
MWPF_PIXELVAL
) {

1265 
drivî_gc_t
 
hwgc
;

1267 i‡(!(
psd
->
Êags
 & 
PSF_HAVEOP_COPY
))

1268 
ÁŒback
;

1270 
hwgc
.
pixñs
 = 
PIXELS
;

1271 
hwgc
.
§c_löñí
 = 
width
;

1272 
hwgc
.
gr_u£bg
 = gr_usebg;

1273 
hwgc
.
bg_cﬁ‹
 = 
gr_background
;

1274 
hwgc
.
d°x
 = 
x
;

1275 
hwgc
.
d°y
 = 
y
;

1276 
hwgc
.
d°w
 = 
width
;

1277 
hwgc
.
d°h
 = 
height
;

1278 
hwgc
.
§cx
 = 0;

1279 
hwgc
.
§cy
 = 0;

1280 
	`GdDøwAªaI¡î«l
(
psd
, &
hwgc
, 
PSDOP_COPY
);

1281 
	`GdFixCurs‹
(
psd
);

1283 
ÁŒback
:

1285 
	`GdFixCurs‹
(
psd
);

1287 
ÁŒback
:

1291 
pixty≥
) {

1292 
MWPF_RGB
:

1293 
pixsize
 = (
MWCOLORVAL
);

1295 
MWPF_PIXELVAL
:

1296 
pixsize
 = (
MWPIXELVAL
);

1298 
MWPF_PALETTE
:

1299 
MWPF_TRUECOLOR332
:

1300 
pixsize
 = ();

1302 
MWPF_TRUECOLOR8888
:

1303 
MWPF_TRUECOLOR0888
:

1304 
pixsize
 = ();

1306 
MWPF_TRUECOLOR888
:

1307 
pixsize
 = 3;

1309 
MWPF_TRUECOLOR565
:

1310 
MWPF_TRUECOLOR555
:

1311 
pixsize
 = ();

1317 
ßvecﬁ‹
 = 
gr_f‹eground
;

1318 
˚Œ°odo
 = ()
width
 * 
height
;

1319 
˚Œ°odo
 > 0) {

1321 
pixty≥
) {

1322 
MWPF_RGB
:

1323 
rgbcﬁ‹
 = *(
MWCOLORVAL
 *)
PIXELS
;

1324 
PIXELS
 +(
MWCOLORVAL
);

1325 
gr_f‹eground
 = 
	`GdFödCﬁ‹
(
psd
, 
rgbcﬁ‹
);

1327 
MWPF_PIXELVAL
:

1328 
gr_f‹eground
 = *(
MWPIXELVAL
 *)
PIXELS
;

1329 
PIXELS
 +(
MWPIXELVAL
);

1331 
MWPF_PALETTE
:

1332 
MWPF_TRUECOLOR332
:

1333 
gr_f‹eground
 = *
PIXELS
++;

1335 
MWPF_TRUECOLOR8888
:

1336 
MWPF_TRUECOLOR0888
:

1337 
gr_f‹eground
 = *(*)
PIXELS
;

1338 
PIXELS
 += ();

1340 
MWPF_TRUECOLOR888
:

1341 
r
 = *
PIXELS
++;

1342 
g
 = *
PIXELS
++;

1343 
b
 = *
PIXELS
++;

1344 
gr_f‹eground
 = 
	`RGB2PIXEL888
(
r
, 
g
, 
b
);

1346 
MWPF_TRUECOLOR565
:

1347 
MWPF_TRUECOLOR555
:

1348 
gr_f‹eground
 = *(*)
PIXELS
;

1349 
PIXELS
 += ();

1352 
dodøw
 = (
gr_u£bg
 || (
gr_f‹eground
 !
gr_background
));

1353 
cou¡
 = 1;

1354 --
˚Œ°odo
;

1363 
˚Œ°odo
 > 0) {

1364 
pixty≥
) {

1365 
MWPF_RGB
:

1366 if(
rgbcﬁ‹
 !*(
MWCOLORVAL
 *)
PIXELS
)

1367 
bªakwhûe
;

1368 
PIXELS
 +(
MWCOLORVAL
);

1370 
MWPF_PIXELVAL
:

1371 if(
gr_f‹eground
 !*(
MWPIXELVAL
 *)
PIXELS
)

1372 
bªakwhûe
;

1373 
PIXELS
 +(
MWPIXELVAL
);

1375 
MWPF_PALETTE
:

1376 
MWPF_TRUECOLOR332
:

1377 if(
gr_f‹eground
 !*(*)
PIXELS
)

1378 
bªakwhûe
;

1379 ++
PIXELS
;

1381 
MWPF_TRUECOLOR8888
:

1382 
MWPF_TRUECOLOR0888
:

1383 if(
gr_f‹eground
 !*(*)
PIXELS
)

1384 
bªakwhûe
;

1385 
PIXELS
 += ();

1387 
MWPF_TRUECOLOR888
:

1388 
r
 = *(*)
PIXELS
;

1389 
g
 = *(*)(
PIXELS
 + 1);

1390 
b
 = *(*)(
PIXELS
 + 2);

1391 if(
gr_f‹eground
 !
	`RGB2PIXEL888
(
r
, 
g
, 
b
))

1392 
bªakwhûe
;

1393 
PIXELS
 += 3;

1395 
MWPF_TRUECOLOR565
:

1396 
MWPF_TRUECOLOR555
:

1397 if(
gr_f‹eground
 !*(*)
PIXELS
)

1398 
bªakwhûe
;

1399 
PIXELS
 += ();

1402 ++
cou¡
;

1403 --
˚Œ°odo
;

1405 
bªakwhûe
:

1410 i‡(
cou¡
 == 1) {

1411 i‡(
dodøw
)

1412 
	`døwpoöt
(
psd
, 
x
, 
y
);

1413 i‡(++
x
 > 
maxx
) {

1414 
x
 = 
möx
;

1415 
y
++;

1424 i‡(
x
 !
möx
) {

1425 
cc
 = 
cou¡
;

1426 i‡(
x
 + 
cc
 - 1 > 
maxx
)

1427 
cc
 = 
maxx
 - 
x
 + 1;

1428 i‡(
dodøw
)

1429 
	`døwrow
(
psd
, 
x
, x + 
cc
 - 1, 
y
);

1430 
cou¡
 -
cc
;

1431 
x
 +
cc
;

1432 i‡(
x
 > 
maxx
) {

1433 
x
 = 
möx
;

1434 
y
++;

1442 
rows
 = 
cou¡
 / 
width
;

1443 i‡(
rows
 > 0) {

1444 i‡(
dodøw
) {

1447 
	`GdFûlRe˘
(
psd
, 
x
, 
y
, 
maxx
 - x + 1, 
rows
);

1449 
cou¡
 %
width
;

1450 
y
 +
rows
;

1456 i‡(
cou¡
 > 0) {

1457 i‡(
dodøw
)

1458 
	`døwrow
(
psd
, 
x
, x + 
cou¡
 - 1, 
y
);

1459 
x
 +
cou¡
;

1462 
gr_f‹eground
 = 
ßvecﬁ‹
;

1463 
	`GdFixCurs‹
(
psd
);

1464 
	}
}

1466 #i‡
NOTYET


1471 
	$GdC›yAªa
(
PSD
 
psd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, MWCOORD 
width
, MWCOORD 
height
,

1472 
MWCOORD
 
de°x
, MWCOORD 
de°y
)

1474 i‡(
width
 <0 || 
height
 <= 0)

1477 i‡(
§cx
 =
de°x
 && 
§cy
 =
de°y
)

1479 
	`GdCheckCurs‹
(
psd
, 
§cx
, 
§cy
, srcx + 
width
 - 1, srcy + 
height
 - 1);

1480 
	`GdCheckCurs‹
(
psd
, 
de°x
, 
de°y
, de°x + 
width
 - 1, de°y + 
height
 - 1);

1481 
psd
->
	`C›yAªa
’sd, 
§cx
, 
§cy
, 
width
, 
height
, 
de°x
, 
de°y
);

1482 
	`GdFixCurs‹
(
psd
);

1483 
	}
}

1486 
MWCLIPREGION
 *
˛ùªgi⁄
;

1502 
	$GdBlô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
width
, MWCOORD 
height
,

1503 
PSD
 
§˝sd
, 
MWCOORD
 
§cx
, MWCOORD 
§cy
, 
r›
)

1505 
rx1
, 
rx2
, 
ry1
, 
ry2
;

1506 
px1
, 
px2
, 
py1
, 
py2
;

1507 
pw
, 
ph
;

1508 
cou¡
;

1509 #i‡
DYNAMICREGIONS


1510 
MWRECT
 * 
¥c
;

1512 
MWCLIPRECT
 * 
¥c
;

1513 
MWCLIPRECT
 
˛ùª˘s
[];

1514 
˛ùcou¡
;

1518 
	`as£π
(
d°psd
->
∂™es
 =
§˝sd
->planes);

1519 
	`as£π
(
d°psd
->
bµ
 =
§˝sd
->bpp);

1522 
	`as£π
(
d°psd
->
p‹åaô
 =
§˝sd
->portrait);

1526 if(
§cx
 < 0) {

1527 
width
 +
§cx
;

1528 
d°x
 -
§cx
;

1529 
§cx
 = 0;

1531 if(
§cy
 < 0) {

1532 
height
 +
§cy
;

1533 
d°y
 -
§cy
;

1534 
§cy
 = 0;

1536 if(
§cx
+
width
 > 
§˝sd
->
xvúåes
)

1537 
width
 = 
§˝sd
->
xvúåes
 - 
§cx
;

1538 if(
§cy
+
height
 > 
§˝sd
->
yvúåes
)

1539 
height
 = 
§˝sd
->
yvúåes
 - 
§cy
;

1541 
	`GdClùAªa
(
d°psd
, 
d°x
, 
d°y
, d°x+
width
-1, d°y+
height
-1)) {

1542 
CLIP_VISIBLE
:

1544 
	`GdCheckCurs‹
(
d°psd
, 
§cx
, 
§cy
, srcx+
width
-1, srcy+
height
-1);

1545 i‡(
d°psd
 !
§˝sd
)

1546 
	`GdCheckCurs‹
(
§˝sd
, 
§cx
, 
§cy
, srcx+
width
-1,

1547 
§cy
+
height
-1);

1548 
d°psd
->
	`Blô
(d°psd, 
d°x
, 
d°y
, 
width
, 
height
,

1549 
§˝sd
, 
§cx
, 
§cy
, 
r›
);

1550 
	`GdFixCurs‹
(
d°psd
);

1551 i‡(
d°psd
 !
§˝sd
)

1552 
	`GdFixCurs‹
(
§˝sd
);

1555 
CLIP_INVISIBLE
:

1564 #i‡
DYNAMICREGIONS


1565 
¥c
 = 
˛ùªgi⁄
->
ª˘s
;

1566 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

1568 
¥c
 = 
˛ùª˘s
;

1569 
cou¡
 = 
˛ùcou¡
;

1571 --
cou¡
 >= 0) {

1572 #i‡
DYNAMICREGIONS


1573 
rx1
 = 
¥c
->
À·
;

1574 
ry1
 = 
¥c
->
t›
;

1575 
rx2
 = 
¥c
->
right
;

1576 
ry2
 = 
¥c
->
bŸtom
;

1578 
rx1
 = 
¥c
->
x
;

1579 
ry1
 = 
¥c
->
y
;

1580 
rx2
 = 
¥c
->
x
 +Örc->
width
;

1581 
ry2
 = 
¥c
->
y
 +Örc->
height
;

1584 
px1
 = 
d°x
;

1585 
py1
 = 
d°y
;

1586 
px2
 = 
d°x
 + 
width
;

1587 
py2
 = 
d°y
 + 
height
;

1588 i‡(
px1
 < 
rx1
)Öx1 =Ñx1;

1589 i‡(
py1
 < 
ry1
)Öy1 =Ñy1;

1590 i‡(
px2
 > 
rx2
)Öx2 =Ñx2;

1591 i‡(
py2
 > 
ry2
)Öy2 =Ñy2;

1593 
pw
 = 
px2
 - 
px1
;

1594 
ph
 = 
py2
 - 
py1
;

1595 if(
pw
 > 0 && 
ph
 > 0) {

1597 
	`GdCheckCurs‹
(
d°psd
, 
px1
, 
py1
, 
px2
-1, 
py2
-1);

1598 
	`GdCheckCurs‹
(
d°psd
, 
§cx
, 
§cy
,

1599 
§cx
+
width
, 
§cy
+
height
);

1600 
d°psd
->
	`Blô
(d°psd, 
px1
, 
py1
, 
pw
, 
ph
, 
§˝sd
,

1601 
§cx
 + (
px1
-
d°x
), 
§cy
 + (
py1
-
d°y
), 
r›
);

1603 ++
¥c
;

1605 
	`GdFixCurs‹
(
d°psd
);

1606 
	}
}

1610 
	gg_row_öc
, 
	gg_cﬁ_öc
;

1628 
	$GdSåëchBlô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

1629 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
, MWCOORD 
§cw
,

1630 
MWCOORD
 
§ch
, 
r›
)

1632 
cou¡
;

1633 #i‡
DYNAMICREGIONS


1634 
MWRECT
 * 
¥c
;

1635 
MWCLIPREGION
 *
˛ùªgi⁄
;

1637 
MWCLIPRECT
 * 
¥c
;

1638 
MWCLIPRECT
 
˛ùª˘s
[];

1639 
˛ùcou¡
;

1644 i‡(
d°psd
->
SåëchBlôEx
) {

1645 
	`GdSåëchBlôEx
(
d°psd
, 
d°x
, 
d°y
,

1646 
d°x
 + 
d°w
, 
d°y
 + 
d°h
,

1647 
§˝sd
, 
§cx
, 
§cy
,

1648 
§cx
 + 
§cw
, 
§cy
 + 
§ch
,

1649 
r›
);

1654 
g_row_öc
 = 
g_cﬁ_öc
 = 0;

1657 i‡(!
d°psd
->
SåëchBlô
)

1661 
	`as£π
(
d°psd
->
∂™es
 =
§˝sd
->planes);

1662 
	`as£π
(
d°psd
->
bµ
 =
§˝sd
->bpp);

1666 if(
§cx
 < 0) {

1667 
§cw
 +
§cx
;

1669 
§cx
 = 0;

1671 if(
§cy
 < 0) {

1672 
§ch
 +
§cy
;

1674 
§cy
 = 0;

1676 if(
§cx
+
§cw
 > 
§˝sd
->
xvúåes
)

1677 
§cw
 = 
§˝sd
->
xvúåes
 - 
§cx
;

1678 if(
§cy
+
§ch
 > 
§˝sd
->
yvúåes
)

1679 
§ch
 = 
§˝sd
->
yvúåes
 - 
§cy
;

1682 if(
d°x
+
d°w
 > 
d°psd
->
xvúåes
)

1683 
d°w
 = 
d°psd
->
xvúåes
 - 
d°x
;

1684 if(
d°y
+
d°h
 > 
d°psd
->
yvúåes
)

1685 
d°h
 = 
d°psd
->
yvúåes
 - 
d°y
;

1687 
	`GdClùAªa
(
d°psd
, 
d°x
, 
d°y
, d°x+
d°w
-1, d°y+
d°h
-1)) {

1688 
CLIP_VISIBLE
:

1690 
	`GdCheckCurs‹
(
d°psd
, 
§cx
, 
§cy
, srcx+
§cw
-1, srcy+
§ch
-1);

1691 
d°psd
->
	`SåëchBlô
(d°psd, 
d°x
, 
d°y
, 
d°w
, 
d°h
,

1692 
§˝sd
, 
§cx
, 
§cy
, 
§cw
, 
§ch
, 
r›
);

1693 
	`GdFixCurs‹
(
d°psd
);

1696 
CLIP_INVISIBLE
:

1705 #i‡
DYNAMICREGIONS


1706 
¥c
 = 
˛ùªgi⁄
->
ª˘s
;

1707 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

1709 
¥c
 = 
˛ùª˘s
;

1710 
cou¡
 = 
˛ùcou¡
;

1712 --
cou¡
 >= 0) {

1713 
rx1
, 
rx2
, 
ry1
, 
ry2
;

1714 
px1
, 
px2
, 
py1
, 
py2
;

1715 
pw
, 
ph
;

1716 
sx
, 
sy
, 
sw
, 
sh
;

1717 #i‡
DYNAMICREGIONS


1718 
rx1
 = 
¥c
->
À·
;

1719 
ry1
 = 
¥c
->
t›
;

1720 
rx2
 = 
¥c
->
right
;

1721 
ry2
 = 
¥c
->
bŸtom
;

1723 
rx1
 = 
¥c
->
x
;

1724 
ry1
 = 
¥c
->
y
;

1725 
rx2
 = 
¥c
->
x
 +Örc->
width
;

1726 
ry2
 = 
¥c
->
y
 +Örc->
height
;

1729 
px1
 = 
d°x
;

1730 
py1
 = 
d°y
;

1731 
px2
 = 
d°x
 + 
d°w
;

1732 
py2
 = 
d°y
 + 
d°h
;

1733 i‡(
px1
 < 
rx1
)Öx1 =Ñx1;

1734 i‡(
py1
 < 
ry1
)Öy1 =Ñy1;

1735 i‡(
px2
 > 
rx2
)Öx2 =Ñx2;

1736 i‡(
py2
 > 
ry2
)Öy2 =Ñy2;

1738 
pw
 = 
px2
 - 
px1
;

1739 
ph
 = 
py2
 - 
py1
;

1740 if(
pw
 > 0 && 
ph
 > 0) {

1742 
g_row_öc
 = (
§ch
 << 16Ë/ 
d°h
;

1743 
g_cﬁ_öc
 = (
§cw
 << 16Ë/ 
d°w
;

1744 
sw
 = 
pw
 * 
§cw
 / 
d°w
;

1745 
sh
 = 
ph
 * 
§ch
 / 
d°h
;

1747 i‡(
sw
 > 0 && 
sh
 > 0) {

1748 
sx
 = 
§cx
 + (
px1
-
d°x
Ë* 
§cw
 / 
d°w
;

1749 
sy
 = 
§cy
 + (
py1
-
d°y
Ë* 
§ch
 / 
d°h
;

1753 
	`GdCheckCurs‹
(
d°psd
, 
px1
, 
py1
, 
px2
-1, 
py2
-1);

1754 
	`GdCheckCurs‹
(
d°psd
, 
§cx
, 
§cy
, srcx+
§cw
, srcy+
§ch
);

1755 
d°psd
->
	`SåëchBlô
(d°psd, 
px1
, 
py1
, 
pw
, 
ph
, 
§˝sd
,

1756 
sx
, 
sy
, 
sw
, 
sh
, 
r›
);

1759 ++
¥c
;

1761 
	`GdFixCurs‹
(
d°psd
);

1762 
	}
}

1792 
	$GdSåëchBlôEx
(
PSD
 
d°psd
, 
MWCOORD
 
d1_x
, MWCOORD 
d1_y
, MWCOORD 
d2_x
,

1793 
MWCOORD
 
d2_y
, 
PSD
 
§˝sd
, MWCOORD 
s1_x
, MWCOORD 
s1_y
, MWCOORD 
s2_x
,

1794 
MWCOORD
 
s2_y
, 
r›
)

1797 
§c_x_°ï_numî©‹
;

1798 
§c_x_°ï_díomö©‹
;

1799 
§c_y_°ï_numî©‹
;

1800 
§c_y_°ï_díomö©‹
;

1803 
MWCOORD
 
c1_x
;

1804 
MWCOORD
 
c1_y
;

1805 
MWCOORD
 
c2_x
;

1806 
MWCOORD
 
c2_y
;

1809 
§c_x_°¨t_exa˘
;

1810 
§c_y_°¨t_exa˘
;

1813 #i‡
DYNAMICREGIONS


1814 
cou¡
;

1815 
MWRECT
 *
¥c
;

1817 
MWCLIPREGION
 *
˛ùªgi⁄
;

1819 
cou¡
;

1820 
MWCLIPRECT
 *
¥c
;

1822 
MWCLIPRECT
 
˛ùª˘s
[];

1823 
˛ùcou¡
;

1826 
	`as£π
(
§˝sd
);

1827 
	`as£π
(
d°psd
);

1834 i‡(
d1_x
 > 
d2_x
) {

1835 
MWCOORD
 
tmp
;

1836 
tmp
 = 
d2_x
;

1837 
d2_x
 = 
d1_x
;

1838 
d1_x
 = 
tmp
;

1839 
tmp
 = 
s2_x
;

1840 
s2_x
 = 
s1_x
;

1841 
s1_x
 = 
tmp
;

1844 i‡(
d1_y
 > 
d2_y
) {

1845 
MWCOORD
 
tmp
;

1846 
tmp
 = 
d2_y
;

1847 
d2_y
 = 
d1_y
;

1848 
d1_y
 = 
tmp
;

1849 
tmp
 = 
s2_y
;

1850 
s2_y
 = 
s1_y
;

1851 
s1_y
 = 
tmp
;

1854 i‡((
d2_x
 < 0)

1855 || (
d2_y
 < 0)

1856 || (
d1_x
 > 
d°psd
->
xvúåes
)

1857 || (
d1_y
 > 
d°psd
->
yvúåes
)

1858 || (
d1_x
 =
d2_x
)

1859 || (
d1_y
 =
d2_y
)) {

1870 i‡((
d2_x
 - 
d1_x
 =
s2_x
 - 
s1_x
Ë&& (
d2_y
 - 
d1_y
 =
s2_y
 - 
s1_y
)) {

1871 
	`GdBlô
(
d°psd
, 
d1_x
, 
d1_y
, 
d2_x
 - d1_x, 
d2_y
 - d1_y,

1872 
§˝sd
, 
s1_x
, 
s1_y
, 
r›
);

1876 i‡(!
d°psd
->
SåëchBlôEx
) {

1877 
	`EPRINTF
("GdStretchBlitEx NOT SUPPORTED onÅhisÅarget\n");

1882 
c1_x
 = 
d1_x
;

1883 
c1_y
 = 
d1_y
;

1884 
c2_x
 = 
d2_x
;

1885 
c2_y
 = 
d2_y
;

1900 
§c_x_°ï_numî©‹
 = (
s2_x
 - 
s1_x
 + 1) << 1;

1901 
§c_x_°ï_díomö©‹
 = (
d2_x
 - 
d1_x
 + 1) << 1;

1902 
§c_y_°ï_numî©‹
 = (
s2_y
 - 
s1_y
 + 1) << 1;

1903 
§c_y_°ï_díomö©‹
 = (
d2_y
 - 
d1_y
 + 1) << 1;

1908 i‡((
s1_x
 < 0Ë|| (s1_x > 
§˝sd
->
xvúåes
)

1909 || (
s2_x
 < 0Ë|| (s2_x > 
§˝sd
->
xvúåes
)) {

1913 
i1_x
 = 
d1_x
 - (
s1_x
 * 
§c_x_°ï_díomö©‹
Ë/ 
§c_x_°ï_numî©‹
;

1918 
i2_x
 = 
d1_x
 + ((
§˝sd
->
xvúåes
 - 
s1_x
Ë* 
§c_x_°ï_díomö©‹
 + src_x_°ï_díomö©‹ - 1Ë/ 
§c_x_°ï_numî©‹
;

1925 i‡(
i1_x
 > 
i2_x
) {

1926 
ãmp
;

1927 
ãmp
 = 
i1_x
;

1928 
i1_x
 = 
i2_x
;

1929 
i2_x
 = 
ãmp
;

1933 i‡((
c2_x
 < 
i1_x
Ë|| (
c1_x
 > 
i2_x
)) {

1939 i‡(
c1_x
 < 
i1_x
)

1940 
c1_x
 = 
i1_x
;

1941 i‡(
c2_x
 > 
i2_x
)

1942 
c2_x
 = 
i2_x
;

1948 i‡((
s1_y
 < 0Ë|| (s1_y > 
§˝sd
->
yvúåes
)

1949 || (
s2_y
 < 0Ë|| (s2_y > 
§˝sd
->
yvúåes
)) {

1953 
i1_y
 = 
d1_y
 - (
s1_y
 * 
§c_y_°ï_díomö©‹
Ë/ 
§c_y_°ï_numî©‹
;

1958 
i2_y
 = 
d1_y
 + ((
§˝sd
->
yvúåes
 - 
s1_y
Ë* 
§c_y_°ï_díomö©‹
 + src_y_°ï_díomö©‹ - 1Ë/ 
§c_y_°ï_numî©‹
;

1965 i‡(
i1_y
 > 
i2_y
) {

1966 
ãmp
;

1967 
ãmp
 = 
i1_y
;

1968 
i1_y
 = 
i2_y
;

1969 
i2_y
 = 
ãmp
;

1973 i‡((
c2_y
 < 
i1_y
Ë|| (
c1_y
 > 
i2_y
)) {

1979 i‡(
c1_y
 < 
i1_y
)

1980 
c1_y
 = 
i1_y
;

1981 i‡(
c2_y
 > 
i2_y
)

1982 
c2_y
 = 
i2_y
;

1986 i‡(
c1_x
 < 0)

1987 
c1_x
 = 0;

1988 i‡(
c1_y
 < 0)

1989 
c1_y
 = 0;

1990 i‡(
c2_x
 > 
d°psd
->
xvúåes
)

1991 
c2_x
 = 
d°psd
->
xvúåes
;

1992 i‡(
c2_y
 > 
d°psd
->
yvúåes
)

1993 
c2_y
 = 
d°psd
->
yvúåes
;

1996 i‡((
c1_x
 >
c2_x
)

1997 || (
c1_y
 >
c2_y
)) {

2012 
§c_x_°¨t_exa˘
 = 
s1_x
 * 
§c_x_°ï_díomö©‹


2013 + (
c1_x
 - 
d1_x
Ë* 
§c_x_°ï_numî©‹
;

2014 
§c_y_°¨t_exa˘
 = 
s1_y
 * 
§c_y_°ï_díomö©‹


2015 + (
c1_y
 - 
d1_y
Ë* 
§c_y_°ï_numî©‹
;

2020 
	`GdClùAªa
(
d°psd
, 
c1_x
, 
c1_y
, 
c2_x
 - 1, 
c2_y
 - 1)) {

2021 
CLIP_INVISIBLE
:

2024 
CLIP_VISIBLE
:

2028 
d°psd
->
	`SåëchBlôEx
(dstpsd,

2029 
§˝sd
,

2030 
c1_x
,

2031 
c1_y
,

2032 
c2_x
 - 
c1_x
,

2033 
c2_y
 - 
c1_y
,

2034 
§c_x_°ï_díomö©‹
,

2035 
§c_y_°ï_díomö©‹
,

2036 
§c_x_°¨t_exa˘
,

2037 
§c_y_°¨t_exa˘
,

2038 
§c_x_°ï_numî©‹
,

2039 
§c_y_°ï_numî©‹
, 
r›
);

2041 
	`GdFixCurs‹
(
d°psd
);

2056 #i‡
DYNAMICREGIONS


2057 
¥c
 = 
˛ùªgi⁄
->
ª˘s
;

2058 
cou¡
 = 
˛ùªgi⁄
->
numRe˘s
;

2060 
¥c
 = 
˛ùª˘s
;

2061 
cou¡
 = 
˛ùcou¡
;

2063 --
cou¡
 >= 0) {

2064 
r1_x
, 
r2_x
, 
r1_y
, 
r2_y
;

2066 #i‡
DYNAMICREGIONS


2067 
r1_x
 = 
¥c
->
À·
;

2068 
r1_y
 = 
¥c
->
t›
;

2069 
r2_x
 = 
¥c
->
right
;

2070 
r2_y
 = 
¥c
->
bŸtom
;

2072 
r1_x
 = 
¥c
->
x
;

2073 
r1_y
 = 
¥c
->
y
;

2074 
r2_x
 = 
¥c
->
x
 +Örc->
width
;

2075 
r2_y
 = 
¥c
->
y
 +Örc->
height
;

2080 i‡(
r1_x
 < 
c1_x
)

2081 
r1_x
 = 
c1_x
;

2082 i‡(
r1_y
 < 
c1_y
)

2083 
r1_y
 = 
c1_y
;

2084 i‡(
r2_x
 > 
c2_x
)

2085 
r2_x
 = 
c2_x
;

2086 i‡(
r2_y
 > 
c2_y
)

2087 
r2_y
 = 
c2_y
;

2089 i‡((
r1_x
 < 
r2_x
Ë&& (
r1_y
 < 
r2_y
)) {

2098 
	`GdCheckCurs‹
(
d°psd
, 
r1_x
, 
r1_y
, 
r2_x
 - 1,

2099 
r2_y
 - 1);

2100 
d°psd
->
	`SåëchBlôEx
(dstpsd,

2101 
§˝sd
,

2102 
r1_x
,

2103 
r1_y
,

2104 
r2_x
 - 
r1_x
,

2105 
r2_y
 - 
r1_y
,

2106 
§c_x_°ï_díomö©‹
,

2107 
§c_y_°ï_díomö©‹
,

2108 
§c_x_°¨t_exa˘
 + (
r1_x
 - 
c1_x
Ë* 
§c_x_°ï_numî©‹
,

2109 
§c_y_°¨t_exa˘
 + (
r1_y
 - 
c1_y
Ë* 
§c_y_°ï_numî©‹
,

2110 
§c_x_°ï_numî©‹
,

2111 
§c_y_°ï_numî©‹
,

2112 
r›
);

2114 ++
¥c
;

2116 
	`GdFixCurs‹
(
d°psd
);

2118 
	}
}

2127 
	$GdCÆcMemGCAŒoc
(
PSD
 
psd
, 
width
, 
height
, 
∂™es
,

2128 
bµ
, *
psize
, *
∂öñí
)

2130 
byãÀn
, 
löñí
, 
tmp
;

2132 if(!
∂™es
)

2133 
∂™es
 = 
psd
->planes;

2134 if(!
bµ
)

2135 
bµ
 = 
psd
->bpp;

2140 if(
psd
->
p‹åaô
 & (
MWPORTRAIT_LEFT
|
MWPORTRAIT_RIGHT
)) {

2141 
tmp
 = 
width
;

2142 
width
 = 
height
;

2143 
height
 = 
tmp
;

2150 if(
∂™es
 == 1) {

2151 
bµ
) {

2153 
löñí
 = (
width
+7)/8;

2154 
byãÀn
 = 
löñí
 = (linelen+3) & ~3;

2157 
löñí
 = (
width
+3)/4;

2158 
byãÀn
 = 
löñí
 = (linelen+3) & ~3;

2161 
löñí
 = (
width
+1)/2;

2162 
byãÀn
 = 
löñí
 = (linelen+3) & ~3;

2165 
byãÀn
 = 
löñí
 = (
width
+3) & ~3;

2168 
löñí
 = 
width
;

2169 
byãÀn
 = 
width
 * 2;

2172 
löñí
 = 
width
;

2173 
byãÀn
 = 
width
 * 3;

2176 
löñí
 = 
width
;

2177 
byãÀn
 = 
width
 * 4;

2182 } if(
∂™es
 == 4) {

2185 
löñí
 = (
width
+1)/2;

2186 
löñí
 = (linelen+3) & ~3;

2187 
byãÀn
 = 
löñí
;

2189 *
psize
 = *
∂öñí
 = 0;

2193 *
∂öñí
 = 
löñí
;

2194 *
psize
 = 
byãÀn
 * 
height
;

2196 
	}
}

2224 
	$GdTøn¶©eAªa
(
MWCOORD
 
width
, MWCOORD 
height
, *
ö
, 
öpixty≥
,

2225 
MWCOORD
 
öpôch
, *
out
, 
ouçixty≥
, 
ouçôch
)

2227 * 
öbuf
 = 
ö
;

2228 * 
outbuf
 = 
out
;

2229 
pixñvÆ
;

2230 
MWCOLORVAL
 
cﬁ‹vÆ
;

2231 
MWCOORD
 
x
, 
y
;

2232 
r
, 
g
, 
b
;

2233 
MWPALENTRY
 
gr_∑Àâe
[256];

2234 
gr_∑lsize
 = 256;

2236 
y
=0; y<
height
; ++y) {

2237 
x
=0; x<
width
; ++x) {

2239 
öpixty≥
) {

2240 
MWPF_RGB
:

2241 
cﬁ‹vÆ
 = *(
MWCOLORVAL
 *)
öbuf
;

2242 
öbuf
 +(
MWCOLORVAL
);

2244 
MWPF_PIXELVAL
:

2245 
pixñvÆ
 = *(
MWPIXELVAL
 *)
öbuf
;

2246 
öbuf
 +(
MWPIXELVAL
);

2248 #i‡
MWPIXEL_FORMAT
 =
MWPF_PALETTE


2249 
cﬁ‹vÆ
 = 
	`GETPALENTRY
(
gr_∑Àâe
, 
pixñvÆ
);

2251 
cﬁ‹vÆ
 = 
	`PIXELVALTOCOLORVAL
(
pixñvÆ
);

2254 
MWPF_PALETTE
:

2255 
pixñvÆ
 = *
öbuf
++;

2256 
cﬁ‹vÆ
 = 
	`GETPALENTRY
(
gr_∑Àâe
, 
pixñvÆ
);

2258 
MWPF_TRUECOLOR332
:

2259 
pixñvÆ
 = *
öbuf
++;

2260 
cﬁ‹vÆ
 = 
	`PIXEL332TOCOLORVAL
(
pixñvÆ
);

2262 
MWPF_TRUECOLOR0888
:

2263 
pixñvÆ
 = *(*)
öbuf
;

2264 
cﬁ‹vÆ
 = 
	`PIXEL888TOCOLORVAL
(
pixñvÆ
);

2265 
öbuf
 += ();

2267 
MWPF_TRUECOLOR8888
:

2268 
pixñvÆ
 = *(*Ë
öbuf
;

2269 
cﬁ‹vÆ
 = 
	`PIXEL8888TOCOLORVAL
(
pixñvÆ
);

2270 
öbuf
 += ();

2272 
MWPF_TRUECOLOR888
:

2273 
r
 = *
öbuf
++;

2274 
g
 = *
öbuf
++;

2275 
b
 = *
öbuf
++;

2276 
cﬁ‹vÆ
 = (
MWPIXELVAL
)
	`MWRGB
(
r
, 
g
, 
b
);

2278 
MWPF_TRUECOLOR565
:

2279 
pixñvÆ
 = *(*)
öbuf
;

2280 
cﬁ‹vÆ
 = 
	`PIXEL565TOCOLORVAL
(
pixñvÆ
);

2281 
öbuf
 += ();

2283 
MWPF_TRUECOLOR555
:

2284 
pixñvÆ
 = *(*)
öbuf
;

2285 
cﬁ‹vÆ
 = 
	`PIXEL555TOCOLORVAL
(
pixñvÆ
);

2286 
öbuf
 += ();

2293 
ouçixty≥
) {

2294 
MWPF_RGB
:

2295 *(
MWCOLORVAL
 *)
outbuf
 = 
cﬁ‹vÆ
;

2296 
outbuf
 +(
MWCOLORVAL
);

2298 
MWPF_PIXELVAL
:

2300 #i‡
MWPIXEL_FORMAT
 =
MWPF_PALETTE


2301 *(
MWPIXELVAL
 *)
outbuf
 = 
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
,

2302 
gr_∑lsize
, 
cﬁ‹vÆ
);

2304 *(
MWPIXELVAL
 *)
outbuf
 = 
	`COLORVALTOPIXELVAL
(
cﬁ‹vÆ
);

2306 
outbuf
 +(
MWPIXELVAL
);

2308 
MWPF_PALETTE
:

2309 *
outbuf
++ = 
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
, 
gr_∑lsize
,

2310 
cﬁ‹vÆ
);

2312 
MWPF_TRUECOLOR332
:

2313 *
outbuf
++ = 
	`COLOR2PIXEL332
(
cﬁ‹vÆ
);

2315 
MWPF_TRUECOLOR0888
:

2316 *(*)
outbuf
 = 
	`COLOR2PIXEL888
(
cﬁ‹vÆ
);

2317 
outbuf
 += ();

2319 
MWPF_TRUECOLOR8888
:

2320 *(*Ë
outbuf
 =

2321 
	`COLOR2PIXEL8888
(
cﬁ‹vÆ
);

2322 
outbuf
 += ();

2324 
MWPF_TRUECOLOR888
:

2325 *
outbuf
++ = 
	`REDVALUE
(
cﬁ‹vÆ
);

2326 *
outbuf
++ = 
	`GREENVALUE
(
cﬁ‹vÆ
);

2327 *
outbuf
++ = 
	`BLUEVALUE
(
cﬁ‹vÆ
);

2329 
MWPF_TRUECOLOR565
:

2330 *(*)
outbuf
 = 
	`COLOR2PIXEL565
(
cﬁ‹vÆ
);

2331 
outbuf
 += ();

2333 
MWPF_TRUECOLOR555
:

2334 *(*)
outbuf
 = 
	`COLOR2PIXEL555
(
cﬁ‹vÆ
);

2335 
outbuf
 += ();

2341 if(
öpôch
 > 
width
)

2342 
öbuf
 +
öpôch
 - 
width
;

2343 if(
ouçôch
 > 
width
)

2344 
outbuf
 +
ouçôch
 - 
width
;

2346 
	}
}

	@engine/devfont.c

16 
	~<°dio.h
>

17 
	~<°dlib.h
>

18 
	~<°rög.h
>

19 
	~"devi˚.h
"

20 
	~"devf⁄t.h
"

21 
	~"../drivîs/gíf⁄t.h
"

26 
PMWFONT
 
	ggr_pf⁄t
;

29 
MWPIXELVAL
 
gr_f‹eground
;

30 
MWPIXELVAL
 
gr_background
;

31 
MWBOOL
 
gr_u£bg
;

33 
c‹ef⁄t_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

34 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

35 
utf8_to_utf16
(c⁄° *
utf8
, 
cc
,

36 *
unicode16
);

44 
PMWFONT


45 
	$GdSëF⁄t
(
PMWFONT
 
pf⁄t
)

47 
PMWFONT
 
ﬁdf⁄t
 = 
gr_pf⁄t
;

49 i‡(
pf⁄t
)

50 
gr_pf⁄t
 = 
pf⁄t
;

51  
ﬁdf⁄t
;

52 
	}
}

77 
PMWFONT


78 
	$GdCª©eF⁄t
(
PSD
 
psd
, c⁄° *
«me
, 
MWCOORD
 
height
,

79 c⁄° 
PMWLOGFONT
 
∂ogf⁄t
)

81 
i
;

82 
f⁄tht
;

83 
f⁄äo
;

84 
f⁄t˛ass
;

85 
f⁄èâr
 = 0;

86 
PMWFONT
 
pf⁄t
;

87 
PMWCOREFONT
 
pf
 = 
psd
->
buûtö_f⁄ts
;

88 
MWFONTINFO
 
f⁄töfo
;

89 
MWSCREENINFO
 
s¸öfo
;

90 c⁄° * 
f⁄äame
;

91 #i‡!
FONTMAPPER


92 
f⁄tm≠≥r_f⁄äame
[
MWLF_FACESIZE
 + 1];

95 
	`GdGëS¸ìnInfo
(
psd
, &
s¸öfo
);

98 i‡(!
∂ogf⁄t
) {

100 i‡(!
«me
 || !name[0])

101 
«me
 = 
pf
->name;

102 
f⁄äame
 = 
«me
;

103 
f⁄t˛ass
 = 
MWLF_CLASS_ANY
;

106 #i‡
FONTMAPPER


107 
f⁄äame
 = 
NULL
;

108 
f⁄t˛ass
 = 
	`£À˘_f⁄t
(
∂ogf⁄t
, &
f⁄äame
);

114 
	`°∫˝y
(
f⁄tm≠≥r_f⁄äame
, 
∂ogf⁄t
->
lfFa˚Name
, 
MWLF_FACESIZE
);

115 
f⁄tm≠≥r_f⁄äame
[
MWLF_FACESIZE
] = '\0';

116 
f⁄äame
 = 
f⁄tm≠≥r_f⁄äame
;

117 i‡(!
f⁄äame
[0])

118 
f⁄äame
 = 
pf
->
«me
;

119 
f⁄t˛ass
 = 
∂ogf⁄t
->
lfCœss
;

121 
height
 = 
∂ogf⁄t
->
lfHeight
;

122 i‡(
∂ogf⁄t
->
lfUndîlöe
)

123 
f⁄èâr
 = 
MWTF_UNDERLINE
;

125 
height
 = 
	`abs
(height);

128 i‡(!
height
 && (
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_BUILTIN
)) {

129 
i
 = 0; i < 
s¸öfo
.
f⁄ts
; ++i) {

130 if(!
	`°rcmpi
(
pf
[
i
].
«me
, 
f⁄äame
)) {

131 
pf
[
i
].
f⁄tsize
 =Öf[i].
cf⁄t
->
height
;

132 
pf
[
i
].
f⁄èâr
 = fontattr;

133 
	`DPRINTF
("¸óãf⁄t: (heighà=0Ëfound buûtö f⁄à%†(%d)\n", 
f⁄äame
, 
i
);

134  (
PMWFONT
)&
pf
[
i
];

151 #ifde‡
HAVE_FNT_SUPPORT


152 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_FNT
) {

153 
pf⁄t
 = (
PMWFONT
Ë
	`‚t_¸óãf⁄t
(
f⁄äame
, 
height
, 
f⁄èâr
);

154 i‡(
pf⁄t
) {

155 
	`DPRINTF
("‚t_¸óãf⁄t: usög f⁄à%s\n", 
f⁄äame
);

156 (
pf⁄t
);

158 
	`EPRINTF
("‚t_¸óãf⁄t: %s,%dÇŸ found\n", 
f⁄äame
, 
height
);

162 #ifde‡
HAVE_PCF_SUPPORT


163 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_PCF
) {

164 
pf⁄t
 = (
PMWFONT
Ë
	`pcf_¸óãf⁄t
(
f⁄äame
, 
height
, 
f⁄èâr
);

165 i‡(
pf⁄t
) {

166 
	`DPRINTF
("pcf_¸óãf⁄t: usög f⁄à%s\n", 
f⁄äame
);

167 (
pf⁄t
);

169 
	`EPRINTF
("pcf_¸óãf⁄t: %s,%dÇŸ found\n", 
f⁄äame
, 
height
);

173 #i‡
HAVE_FREETYPE_SUPPORT


174 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_FREETYPE
) {

175 i‡(
	`‰ìty≥_öô
(
psd
)) {

177 i‡(
∂ogf⁄t
 &&Ölogf⁄t->
lfHeight
 > 14 &&

178 
∂ogf⁄t
->
lfQuÆôy
)

179 
f⁄èâr
 |
MWTF_ANTIALIAS
;

181 
pf⁄t
 = (
PMWFONT
)
	`‰ìty≥_¸óãf⁄t
(
f⁄äame
, 
height
,

182 
f⁄èâr
);

183 if(
pf⁄t
) {

185 
pf⁄t
->
f⁄èâr
 |
MWTF_FREETYPE
;

186  
pf⁄t
;

188 
	`EPRINTF
("freetype_createfont: %s,%dÇot found\n",

189 
f⁄äame
, 
height
);

194 #i‡
HAVE_FREETYPE_2_SUPPORT


195 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_FREETYPE
) {

196 i‡(
	`‰ìty≥2_öô
(
psd
)) {

198 i‡(
∂ogf⁄t
 &&Ölogf⁄t->
lfHeight
 > 14 &&

199 
∂ogf⁄t
->
lfQuÆôy
)

200 
f⁄èâr
 |
MWTF_ANTIALIAS
;

202 
pf⁄t
 = (
PMWFONT
)
	`‰ìty≥2_¸óãf⁄t
(
f⁄äame
, 
height
,

203 
f⁄èâr
);

204 if(
pf⁄t
) {

206 
pf⁄t
->
f⁄èâr
 |
MWTF_FREETYPE
;

207  
pf⁄t
;

209 
	`EPRINTF
("freetype2_createfont: %s,%dÇot found\n",

210 
f⁄äame
, 
height
);

215 #i‡
HAVE_T1LIB_SUPPORT


216 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_T1LIB
) {

217 i‡(
	`t1lib_öô
(
psd
)) {

218 
pf⁄t
 = (
PMWFONT
)
	`t1lib_¸óãf⁄t
(
f⁄äame
, 
height
,

219 
f⁄èâr
);

220 if(
pf⁄t
)

221  
pf⁄t
;

222 
	`EPRINTF
("t1lib_createfont: %s,%dÇot found\n",

223 
f⁄äame
, 
height
);

228 #i‡
HAVE_HZK_SUPPORT


229 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_HZK
) {

231 i‡(
	`hzk_öô
(
psd
)) {

232 
pf⁄t
 = (
PMWFONT
)
	`hzk_¸óãf⁄t
(
f⁄äame
, 
height
, 
f⁄èâr
);

233 if(
pf⁄t
)

234  
pf⁄t
;

235 
	`EPRINTF
("hzk_¸óãf⁄t: %s,%dÇŸ found\n", 
f⁄äame
, 
height
);

240 #i‡
HAVE_EUCJP_SUPPORT


241 i‡(
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_MGL
) {

242 
pf⁄t
 = (
PMWFONT
)
	`eucjp_¸óãf⁄t
(
f⁄äame
, 
height
, 
f⁄èâr
);

243 i‡(
pf⁄t
) {

244 
	`DPRINTF
("euj˝_¸óãf⁄t: usög f⁄à%s\n", 
f⁄äame
);

245  
pf⁄t
;

247 
	`EPRINTF
("eucjp_¸óãf⁄t: %s,%dÇŸ found\n", 
f⁄äame
, 
height
);

255 i‡(
height
 !0 && (
f⁄t˛ass
 =
MWLF_CLASS_ANY
 || f⁄t˛as†=
MWLF_CLASS_BUILTIN
)) {

257 
f⁄äo
 = 0;

258 
height
 = 
	`abs
(height);

259 
f⁄tht
 = 
MAX_MWCOORD
;

260 
i
 = 0; i < 
s¸öfo
.
f⁄ts
; ++i) {

261 
pf⁄t
 = (
PMWFONT
)&
pf
[
i
];

262 
	`GdGëF⁄tInfo
(
pf⁄t
, &
f⁄töfo
);

263 if(
f⁄tht
 > 
	`abs
(
height
-
f⁄töfo
.height)) {

264 
f⁄äo
 = 
i
;

265 
f⁄tht
 = 
	`abs
(
height
-
f⁄töfo
.height);

268 
pf
[
f⁄äo
].
f⁄tsize
 =Öf[f⁄äo].
cf⁄t
->
height
;

269 
pf
[
f⁄äo
].
f⁄èâr
 = fontattr;

270 
	`DPRINTF
("¸óãf⁄t: (heighà!0Ëusög buûtö f⁄à%†(%d)\n", 
pf
[
f⁄äo
].
«me
, fontno);

271  (
PMWFONT
)&
pf
[
f⁄äo
];

275 
	`DPRINTF
("createfont:Ço font found,Ñeturning NULL\n");

277 
	}
}

286 
MWCOORD


287 
	$GdSëF⁄tSize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
)

289 
MWCOORD
 
ﬁdf⁄tsize
 = 
pf⁄t
->
f⁄tsize
;

290 
pf⁄t
->
f⁄tsize
 = fontsize;

292 i‡(
pf⁄t
->
f⁄çrocs
->
SëF⁄tSize
)

293 
pf⁄t
->
f⁄çrocs
->
	`SëF⁄tSize
’f⁄t, 
f⁄tsize
);

295  
ﬁdf⁄tsize
;

296 
	}
}

306 
	$GdSëF⁄tRŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
)

308 
MWCOORD
 
ﬁdrŸ©i⁄
 = 
pf⁄t
->
f⁄åŸ©i⁄
;

309 
pf⁄t
->
f⁄åŸ©i⁄
 = 
ã¡hdegªes
;

311 i‡(
pf⁄t
->
f⁄çrocs
->
SëF⁄tRŸ©i⁄
)

312 
pf⁄t
->
f⁄çrocs
->
	`SëF⁄tRŸ©i⁄
’f⁄t, 
ã¡hdegªes
);

314  
ﬁdrŸ©i⁄
;

315 
	}
}

327 
	$GdSëF⁄tAâr
(
PMWFONT
 
pf⁄t
, 
£tÊags
, 
˛rÊags
)

329 
MWCOORD
 
ﬁd©å
 = 
pf⁄t
->
f⁄èâr
;

331 
pf⁄t
->
f⁄èâr
 &~
˛rÊags
;

332 
pf⁄t
->
f⁄èâr
 |
£tÊags
;

334 i‡(
pf⁄t
->
f⁄çrocs
->
SëF⁄tAâr
)

335 
pf⁄t
->
f⁄çrocs
->
	`SëF⁄tAâr
’f⁄t, 
£tÊags
, 
˛rÊags
);

337  
ﬁd©å
;

338 
	}
}

347 
	$GdDe°royF⁄t
(
PMWFONT
 
pf⁄t
)

349 i‡(
pf⁄t
->
f⁄çrocs
->
De°royF⁄t
)

350 
pf⁄t
->
f⁄çrocs
->
	`De°royF⁄t
(pfont);

351 
	}
}

360 
MWBOOL


361 
	$GdGëF⁄tInfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

363 if(!
pf⁄t
 || !pf⁄t->
f⁄çrocs
->
GëF⁄tInfo
)

364  
FALSE
;

366  
pf⁄t
->
f⁄çrocs
->
	`GëF⁄tInfo
’f⁄t, 
pf⁄töfo
);

367 
	}
}

391 
	$GdText
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, c⁄° *
°r
, 
cc
,
MWTEXTFLAGS
 
Êags
)

393 c⁄° * 
ãxt
;

394 
de„ncodög
 = 
gr_pf⁄t
->
f⁄çrocs
->
ícodög
;

395 
f‹˚_uc16
 = 0;

396 
buf
[256];

409 i‡(
Êags
 & 
MWTF_DBCSMASK
) {

411 i‡(
gr_pf⁄t
->
f⁄çrocs
->
GëTextBôs
 =
gí_gëãxtbôs
 &&

412 
gr_pf⁄t
->
f⁄çrocs
->
DøwText
 =
c‹ef⁄t_døwãxt
) {

413 
de„ncodög
 = 
MWTF_UC16
;

414 
f‹˚_uc16
 = 1;

419 if((
Êags
 & (
MWTF_PACKMASK
|
MWTF_DBCSMASK
)Ë!
de„ncodög
) {

420 
cc
 = 
	`GdC⁄vîtEncodög
(
°r
, 
Êags
, cc, 
buf
, 
de„ncodög
);

421 
Êags
 &~
MWTF_PACKMASK
;

422 
Êags
 |
de„ncodög
;

423 
ãxt
 = 
buf
;

424 } 
ãxt
 = 
°r
;

427 if(
cc
 =-1 && (
Êags
 & 
MWTF_PACKMASK
Ë=
MWTF_ASCII
)

428 
cc
 = 
	`°æí
((*)
°r
);

430 if(
cc
 <0 || !
gr_pf⁄t
->
f⁄çrocs
->
DøwText
)

434 i‡(!
f‹˚_uc16
)

435 
Êags
 &~
MWTF_DBCSMASK
;

436 
gr_pf⁄t
->
f⁄çrocs
->
	`DøwText
(gr_pf⁄t, 
psd
, 
x
, 
y
, 
ãxt
, 
cc
, 
Êags
);

437 
	}
}

443 
	$c‹ef⁄t_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

444 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

446 c⁄° *
°r
 = 
ãxt
;

447 c⁄° *
i°r
 = 
ãxt
;

448 
MWCOORD
 
width
;

449 
MWCOORD
 
height
;

450 
MWCOORD
 
ba£
;

451 
MWCOORD
 
°¨tx
, 
°¨ty
;

452 c⁄° 
MWIMAGEBITS
 *
bôm≠
;

453 
MWBOOL
 
bg°©e
;

454 
˛ù
;

456 i‡(
Êags
 & 
MWTF_DBCSMASK
)

457 
	`dbcs_gëãxtsize
(
pf⁄t
, 
i°r
, 
cc
, 
Êags
, &
width
, &
height
, &
ba£
);

458 
pf⁄t
->
f⁄çrocs
->
	`GëTextSize
’f⁄t, 
°r
, 
cc
, 
Êags
, &
width
, &
height
, &
ba£
);

460 i‡(
Êags
 & 
MWTF_BASELINE
)

461 
y
 -
ba£
;

462 i‡(
Êags
 & 
MWTF_BOTTOM
)

463 
y
 -(
height
 - 1);

464 
°¨tx
 = 
x
;

465 
°¨ty
 = 
y
 + 
ba£
;

466 
bg°©e
 = 
gr_u£bg
;

468 
˛ù
 = 
	`GdClùAªa
(
psd
, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1)) {

469 
CLIP_VISIBLE
:

471 i‡(
gr_u£bg
)

472 
psd
->
	`FûlRe˘
’sd, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1,

473 
gr_background
);

482 
bg°©e
 = 
gr_u£bg
;

483 
gr_u£bg
 = 
FALSE
;

486 
CLIP_INVISIBLE
:

500 --
cc
 >0 && 
x
 < 
psd
->
xvúåes
) {

501 i‡(
Êags
 & 
MWTF_DBCSMASK
)

502 
	`dbcs_gëãxtbôs
(
pf⁄t
, *
i°r
++, 
Êags
, &
bôm≠
, &
width
,

503 &
height
, &
ba£
);

505 
ch
;

507 i‡(
pf⁄t
->
f⁄çrocs
->
ícodög
 =
MWTF_UC16
)

508 
ch
 = *
i°r
++;

509 
ch
 = *
°r
++;

510 
pf⁄t
->
f⁄çrocs
->
	`GëTextBôs
’f⁄t, 
ch
, &
bôm≠
, &
width
,

511 &
height
, &
ba£
);

514 i‡(
˛ù
 =
CLIP_VISIBLE
)

515 
	`døwbôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
);

517 
	`GdBôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
);

518 
x
 +
width
;

521 i‡(
pf⁄t
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

522 
	`GdLöe
(
psd
, 
°¨tx
, 
°¨ty
, 
x
, sèπy, 
FALSE
);

525 
gr_u£bg
 = 
bg°©e
;

527 
	`GdFixCurs‹
(
psd
);

528 
	}
}

530 #i‡
HAVE_FNT_SUPPORT
 | 
HAVE_PCF_SUPPORT


535 
	$gí16_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

536 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

538 c⁄° *
°r
 = 
ãxt
;

539 
MWCOORD
 
width
;

540 
MWCOORD
 
height
;

541 
MWCOORD
 
ba£
;

542 
MWCOORD
 
°¨tx
, 
°¨ty
;

543 c⁄° 
MWIMAGEBITS
 *
bôm≠
;

544 
MWBOOL
 
bg°©e
;

545 
˛ù
;

547 
pf⁄t
->
f⁄çrocs
->
	`GëTextSize
’f⁄t, 
°r
, 
cc
, 
Êags
, &
width
, &
height
, &
ba£
);

549 i‡(
Êags
 & 
MWTF_BASELINE
)

550 
y
 -
ba£
;

551 i‡(
Êags
 & 
MWTF_BOTTOM
)

552 
y
 -(
height
 - 1);

553 
°¨tx
 = 
x
;

554 
°¨ty
 = 
y
 + 
ba£
;

555 
bg°©e
 = 
gr_u£bg
;

557 
˛ù
 = 
	`GdClùAªa
(
psd
, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1)) {

558 
CLIP_VISIBLE
:

560 i‡(
gr_u£bg
)

561 
psd
->
	`FûlRe˘
’sd, 
x
, 
y
, x + 
width
 - 1, y + 
height
 - 1,

562 
gr_background
);

571 
bg°©e
 = 
gr_u£bg
;

572 
gr_u£bg
 = 
FALSE
;

575 
CLIP_INVISIBLE
:

582 --
cc
 >0 && 
x
 < 
psd
->
xvúåes
) {

583 
ch
 = *
°r
++;

584 
pf⁄t
->
f⁄çrocs
->
	`GëTextBôs
’f⁄t, 
ch
, &
bôm≠
, &
width
,

585 &
height
, &
ba£
);

587 i‡(
˛ù
 =
CLIP_VISIBLE
)

588 
	`døwbôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
);

590 
	`GdBôm≠
(
psd
, 
x
, 
y
, 
width
, 
height
, 
bôm≠
);

591 
x
 +
width
;

594 i‡(
pf⁄t
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

595 
	`GdLöe
(
psd
, 
°¨tx
, 
°¨ty
, 
x
, sèπy, 
FALSE
);

598 
gr_u£bg
 = 
bg°©e
;

600 
	`GdFixCurs‹
(
psd
);

601 
	}
}

604 #i‡
HAVE_T1LIB_SUPPORT
 | 
HAVE_FREETYPE_SUPPORT


611 
	$ÆphabÀnd
(
PSD
 
psd
, 
OUTPIXELVAL
 *
out
, 
MWPIXELVAL
 
§c
, MWPIXELVAL 
d°
,

612 *
Æpha
, 
cou¡
)

614 
a
, 
d
;

615 
r
, 
g
, 
b
;

616 
MWCOLORVAL
 
∑l§c
, 
∑ld°
;

617 
MWPALENTRY
 
gr_∑Àâe
[256];

619 --
cou¡
 >= 0) {

620 
a
 = *
Æpha
++;

622 
	#BITS
(
pixñ
,
shi·
,
mask
Ë((’ixñ)>>shi·)&(mask))

	)

623 if(
a
 == 0)

624 *
out
++ = 
d°
;

625 if(
a
 == 255)

626 *
out
++ = 
§c
;

628 
psd
->
pixty≥
) {

629 
MWPF_TRUECOLOR0888
:

630 
MWPF_TRUECOLOR888
:

631 
d
 = 
	`BITS
(
d°
, 16, 0xff);

632 
r
 = ()(((
	`BITS
(
§c
, 16, 0xffË- 
d
)*
a
)>>8) + d;

633 
d
 = 
	`BITS
(
d°
, 8, 0xff);

634 
g
 = ()(((
	`BITS
(
§c
, 8, 0xffË- 
d
)*
a
)>>8) + d;

635 
d
 = 
	`BITS
(
d°
, 0, 0xff);

636 
b
 = ()(((
	`BITS
(
§c
, 0, 0xffË- 
d
)*
a
)>>8) + d;

637 *
out
++ = (
r
 << 16Ë| (
g
 << 8Ë| 
b
;

640 
MWPF_TRUECOLOR565
:

641 
d
 = 
	`BITS
(
d°
, 11, 0x1f);

642 
r
 = ()(((
	`BITS
(
§c
, 11, 0x1fË- 
d
)*
a
)>>8) + d;

643 
d
 = 
	`BITS
(
d°
, 5, 0x3f);

644 
g
 = ()(((
	`BITS
(
§c
, 5, 0x3fË- 
d
)*
a
)>>8) + d;

645 
d
 = 
	`BITS
(
d°
, 0, 0x1f);

646 
b
 = ()(((
	`BITS
(
§c
, 0, 0x1fË- 
d
)*
a
)>>8) + d;

647 *
out
++ = (
r
 << 11Ë| (
g
 << 5Ë| 
b
;

650 
MWPF_TRUECOLOR555
:

651 
d
 = 
	`BITS
(
d°
, 10, 0x1f);

652 
r
 = ()(((
	`BITS
(
§c
, 10, 0x1fË- 
d
)*
a
)>>8) + d;

653 
d
 = 
	`BITS
(
d°
, 5, 0x1f);

654 
g
 = ()(((
	`BITS
(
§c
, 5, 0x1fË- 
d
)*
a
)>>8) + d;

655 
d
 = 
	`BITS
(
d°
, 0, 0x1f);

656 
b
 = ()(((
	`BITS
(
§c
, 0, 0x1fË- 
d
)*
a
)>>8) + d;

657 *
out
++ = (
r
 << 10Ë| (
g
 << 5Ë| 
b
;

660 
MWPF_TRUECOLOR332
:

661 
d
 = 
	`BITS
(
d°
, 5, 0x07);

662 
r
 = ()(((
	`BITS
(
§c
, 5, 0x07Ë- 
d
)*
a
)>>8) + d;

663 
d
 = 
	`BITS
(
d°
, 2, 0x07);

664 
g
 = ()(((
	`BITS
(
§c
, 2, 0x07Ë- 
d
)*
a
)>>8) + d;

665 
d
 = 
	`BITS
(
d°
, 0, 0x03);

666 
b
 = ()(((
	`BITS
(
§c
, 0, 0x03Ë- 
d
)*
a
)>>8) + d;

667 *
out
++ = (
r
 << 5Ë| (
g
 << 2Ë| 
b
;

670 
MWPF_PALETTE
:

672 
∑l§c
 = 
	`GETPALENTRY
(
gr_∑Àâe
, 
§c
);

673 
∑ld°
 = 
	`GETPALENTRY
(
gr_∑Àâe
, 
d°
);

674 
d
 = 
	`REDVALUE
(
∑ld°
);

675 
r
 = ()(((
	`REDVALUE
(
∑l§c
Ë- 
d
)*
a
)>>8) + d;

676 
d
 = 
	`GREENVALUE
(
∑ld°
);

677 
g
 = ()(((
	`GREENVALUE
(
∑l§c
Ë- 
d
)*
a
)>>8) + d;

678 
d
 = 
	`BLUEVALUE
(
∑ld°
);

679 
b
 = ()(((
	`BLUEVALUE
(
∑l§c
Ë- 
d
)*
a
)>>8) + d;

680 *
out
++ = 
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
, ()
psd
->
ncﬁ‹s
,

681 
	`MWRGB
(
r
, 
g
, 
b
));

685 
	}
}

688 #i‡!
HAVE_FREETYPE_SUPPORT


690 
	$GdGëTextSizeEx
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
,
nMaxExã¡
,

691 * 
ÕnFô
, * 
ÆpDx
,
MWCOORD
 *
pwidth
,MWCOORD *
pheight
,

692 
MWCOORD
 *
pba£
, 
MWTEXTFLAGS
 
Êags
)

694 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

696 
	}
}

699 
	$GdFªeF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, 
n
)

701 
	}
}

704 
	$GdGëF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, *
numf⁄ts
)

706 *
numf⁄ts
 = -1;

707 
	}
}

727 
	$GdC⁄vîtEncodög
(c⁄° *
i°r
, 
MWTEXTFLAGS
 
iÊags
, 
cc
, *
o°r
,

728 
MWTEXTFLAGS
 
oÊags
)

730 c⁄° *
i°r8
;

731 c⁄° *
i°r16
;

732 c⁄° *
i°r32
;

733 *
o°r8
;

734 *
o°r16
;

735 *
o°r32
;

736 
ch
;

737 
icc
;

738 
buf16
[512];

740 
iÊags
 &
MWTF_PACKMASK
|
MWTF_DBCSMASK
;

741 
oÊags
 &
MWTF_PACKMASK
|
MWTF_DBCSMASK
;

744 if(
cc
 =-1 && (
iÊags
 =
MWTF_ASCII
))

745 
cc
 = 
	`°æí
((*)
i°r
);

748 if(
iÊags
 =
MWTF_UTF8
) {

750 
cc
 = 
	`utf8_to_utf16
((*)
i°r
, cc,

751 
oÊags
==
MWTF_UC16
?(*Ë
o°r
: 
buf16
);

753 if(
oÊags
 =
MWTF_UC16
 || 
cc
 < 0)

754  
cc
;

757 
iÊags
 = 
MWTF_UC16
;

758 
i°r
 = 
buf16
;

761 #i‡
HAVE_HZK_SUPPORT


762 if(
iÊags
 =
MWTF_UC16
 && 
oÊags
 =
MWTF_ASCII
) {

764 
cc
 = 
	`UC16_to_GB
–
i°r
, cc, 
o°r
);

765  
cc
;

769 
icc
 = 
cc
;

770 
cc
 = 0;

771 
i°r8
 = 
i°r
;

772 
i°r16
 = 
i°r
;

773 
i°r32
 = 
i°r
;

774 
o°r8
 = 
o°r
;

775 
o°r16
 = 
o°r
;

776 
o°r32
 = 
o°r
;

781 --
icc
 >= 0) {

782 
iÊags
) {

784 
ch
 = *
i°r8
++;

786 
MWTF_UC16
:

787 
ch
 = *
i°r16
++;

789 
MWTF_XCHAR2B
:

790 
ch
 = *
i°r8
++ << 8;

791 
ch
 |*
i°r8
++;

793 
MWTF_UC32
:

794 
ch
 = *
i°r32
++;

796 
MWTF_DBCS_BIG5
:

797 
ch
 = *
i°r8
++;

798 i‡(
ch
 >0xA1 && ch <0xF9 && 
icc
 &&

799 ((*
i°r8
 >= 0x40 && *istr8 <= 0x7E) ||

800 (*
i°r8
 >= 0xA1 && *istr8 <= 0xFE))) {

801 
ch
 = (ch << 8Ë| *
i°r8
++;

802 --
icc
;

805 
MWTF_DBCS_EUCCN
:

806 
ch
 = *
i°r8
++;

807 i‡(
ch
 >0xA1 && ch <0xF7 && 
icc
 &&

808 *
i°r8
 >= 0xA1 && *istr8 <= 0xFE) {

809 
ch
 = (ch << 8Ë| *
i°r8
++;

810 --
icc
;

813 
MWTF_DBCS_EUCKR
:

814 
ch
 = *
i°r8
++;

815 i‡(
ch
 >0xA1 && ch <0xFE && 
icc
 &&

816 *
i°r8
 >= 0xA1 && *istr8 <= 0xFE) {

817 
ch
 = (ch << 8Ë| *
i°r8
++;

818 --
icc
;

821 
MWTF_DBCS_EUCJP
:

822 
ch
 = *
i°r8
++;

823 i‡(
ch
 >0xA1 && ch <0xFE && 
icc
 &&

824 *
i°r8
 >= 0xA1 && *istr8 <= 0xFE) {

825 
ch
 = (ch << 8Ë| *
i°r8
++;

826 --
icc
;

829 
MWTF_DBCS_JIS
:

830 
ch
 = *
i°r8
++;

831 i‡(
icc
 && (

832 (
ch
 >0xA1 && ch <0xFE && *
i°r8
 >= 0xA1 && *istr8 <= 0xFE)

834 (((
ch
 >= 0x81 && ch <= 0x9F) || (ch >= 0xE0 && ch <= 0xEF)) &&

835 (*
i°r8
 >= 0x40 && *istr8 <= 0xFC && *istr8 != 0x7F))

837 
ch
 = (ch << 8Ë| *
i°r8
++;

838 --
icc
;

843 
oÊags
) {

845 *
o°r8
++ = ()
ch
;

847 
MWTF_UC16
:

848 *
o°r16
++ = ()
ch
;

850 
MWTF_XCHAR2B
:

851 *
o°r8
++ = ()(
ch
 >> 8);

852 *
o°r8
++ = ()
ch
;

854 
MWTF_UC32
:

855 *
o°r32
++ = 
ch
;

858 ++
cc
;

860  
cc
;

861 
	}
}

881 
	$GdGëTextSize
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
, 
MWCOORD
 *
pwidth
,

882 
MWCOORD
 *
pheight
, MWCOORD *
pba£
, 
MWTEXTFLAGS
 
Êags
)

884 c⁄° * 
ãxt
;

885 
MWTEXTFLAGS
 
de„ncodög
 = 
pf⁄t
->
f⁄çrocs
->
ícodög
;

886 
f‹˚_uc16
 = 0;

887 
buf
[256];

890 i‡(
Êags
 & 
MWTF_DBCSMASK
) {

892 i‡(
pf⁄t
->
f⁄çrocs
->
GëTextBôs
 =
gí_gëãxtbôs
 &&

893 
pf⁄t
->
f⁄çrocs
->
DøwText
 =
c‹ef⁄t_døwãxt
) {

894 
de„ncodög
 = 
MWTF_UC16
;

895 
f‹˚_uc16
 = 1;

900 if((
Êags
 & (
MWTF_PACKMASK
|
MWTF_DBCSMASK
)Ë!
de„ncodög
) {

901 
cc
 = 
	`GdC⁄vîtEncodög
(
°r
, 
Êags
, cc, 
buf
, 
de„ncodög
);

902 
Êags
 &~
MWTF_PACKMASK
;

903 
Êags
 |
de„ncodög
;

904 
ãxt
 = 
buf
;

905 } 
ãxt
 = 
°r
;

908 if(
cc
 =-1 && (
Êags
 & 
MWTF_PACKMASK
Ë=
MWTF_ASCII
)

909 
cc
 = 
	`°æí
((*)
°r
);

911 if(
cc
 <0 || !
pf⁄t
->
f⁄çrocs
->
GëTextSize
) {

912 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

917 i‡(
f‹˚_uc16
)

918 
	`dbcs_gëãxtsize
(
pf⁄t
, 
ãxt
, 
cc
, 
Êags
, 
pwidth
, 
pheight
, 
pba£
);

919 
pf⁄t
->
f⁄çrocs
->
	`GëTextSize
’f⁄t, 
ãxt
, 
cc
, 
Êags
, 
pwidth
, 
pheight
, 
pba£
);

920 
	}
}

922 #i‡
HAVE_FREETYPE_2_SUPPORT


937 
PMWFONT


938 
	$GdCª©eF⁄tFromBuf„r
(
PSD
 
psd
, c⁄° *
buf„r
,

939 
Àngth
, c⁄° *
f‹m©
, 
MWCOORD
 
height
)

941 
PMWFONT
 
pf⁄t
 = 
NULL
;

955 i‡(
	`‰ìty≥2_öô
(
psd
)) {

956 
pf⁄t
 = (
PMWFONT
)
	`‰ìty≥2_¸óãf⁄t‰ombuf„r
(
buf„r
, 
Àngth
, 
height
);

958 i‡(!
pf⁄t
)

959 
	`EPRINTF
("GdCreateFontFromBuffer: create failed.\n");

961  
pf⁄t
;

962 
	}
}

972 
PMWFONT


973 
	$GdDu∂iˇãF⁄t
(
PSD
 
psd
, 
PMWFONT
 
p§cf⁄t
, 
MWCOORD
 
f⁄tsize
)

978 i‡(
p§cf⁄t
->
f⁄çrocs
->
Du∂iˇã
)

979  
p§cf⁄t
->
f⁄çrocs
->
	`Du∂iˇã
’§cf⁄t, 
f⁄tsize
);

981  
p§cf⁄t
;

982 
	}
}

1008 
	$utf8_to_utf16
(c⁄° *
utf8
, 
cc
, *
unicode16
)

1010 
cou¡
 = 0;

1011 
c0
, 
c1
;

1012 
sˇœr
;

1014 --
cc
 >= 0) {

1015 
c0
 = *
utf8
++;

1018 i‡–
c0
 < 0x80 ) {

1020 *
unicode16
++ = 
c0
;

1021 
cou¡
++;

1025 i‡–(
c0
 & 0xc0) == 0x80 )

1030 
sˇœr
 = 
c0
;

1031 if(--
cc
 < 0)

1033 
c1
 = *
utf8
++;

1035 i‡–(
c1
 & 0xc0) != 0x80 )

1038 
sˇœr
 <<= 6;

1039 
sˇœr
 |(
c1
 & 0x3f);

1041 i‡–!(
c0
 & 0x20) ) {

1043 i‡–(
sˇœr
 != 0) && (scalar < 0x80) )

1045 *
unicode16
++ = 
sˇœr
 & 0x7ff;

1046 
cou¡
++;

1051 if(--
cc
 < 0)

1053 
c1
 = *
utf8
++;

1055 i‡–(
c1
 & 0xc0) != 0x80 )

1058 
sˇœr
 <<= 6;

1059 
sˇœr
 |(
c1
 & 0x3f);

1061 i‡–!(
c0
 & 0x10) ) {

1064 i‡–
sˇœr
 < 0x800 )

1066 i‡–
sˇœr
 >= 0xd800 && scalar < 0xe000 )

1068 *
unicode16
++ = 
sˇœr
 & 0xffff;

1069 
cou¡
++;

1074 
c1
 = *
utf8
++;

1075 if(--
cc
 < 0)

1078 i‡–(
c1
 & 0xc0) != 0x80 )

1081 
sˇœr
 <<= 6;

1082 
sˇœr
 |(
c1
 & 0x3f);

1084 i‡–!(
c0
 & 0x08) ) {

1086 i‡–
sˇœr
 < 0x10000 )

1088 
sˇœr
 -= 0x10000;

1089 *
unicode16
++ = ((
sˇœr
 >> 10) & 0x3ff) + 0xd800;

1090 *
unicode16
++ = (
sˇœr
 & 0x3ff) + 0xdc00;

1091 
cou¡
 += 2;

1097  
cou¡
;

1098 
	}
}

	@engine/devfont.h

1 #i‚de‡
_DEVFONT_H


2 
	#_DEVFONT_H


	)

11 
	#T1LIB_USE_AA_HIGH


	)

13 #ifde‡
T1LIB_USE_AA_HIGH


14 
	tOUTPIXELVAL
;

16 
MWPIXELVAL
 
	tOUTPIXELVAL
;

19 #i‡(
UNIX
 | 
DOS_DJGPP
)

20 
	#°rcmpi
 
°rˇ£cmp


	)

24 
ÆphabÀnd
(
PSD
 
psd
, 
OUTPIXELVAL
 *
out
, 
MWPIXELVAL
 
§c
, MWPIXELVAL 
d°
,

25 *
Æpha
, 
cou¡
);

28 
PMWCOREFONT
 
‚t_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

30 #i‡
HAVE_T1LIB_SUPPORT


31 
MWT1LIBFONT
 *
	tPMWT1LIBFONT
;

32 
t1lib_öô
(
PSD
 
psd
);

33 
PMWT1LIBFONT
 
t1lib_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
,
©å
);

36 #i‡
HAVE_FREETYPE_SUPPORT


37 
MWFREETYPEFONT
 *
	tPMWFREETYPEFONT
;

38 
‰ìty≥_öô
(
PSD
 
psd
);

39 
PMWFREETYPEFONT
 
‰ìty≥_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

42 #i‡
HAVE_FREETYPE_2_SUPPORT


43 
MWFREETYPE2FONT_STRUCT
 
	tMWFREETYPE2FONT
;

44 
MWFREETYPE2FONT
 *
	tPMWFREETYPE2FONT
;

45 
‰ìty≥2_öô
(
PSD
 
psd
);

46 
PMWFREETYPE2FONT
 
‰ìty≥2_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
,

47 
©å
);

48 
PMWFREETYPE2FONT
 
‰ìty≥2_¸óãf⁄t‰ombuf„r
(c⁄° *
buf„r
,

49 
Àngth
,

50 
MWCOORD
 
height
);

53 #i‡
HAVE_PCF_SUPPORT


54 
PMWCOREFONT
 
pcf_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

57 #i‡
HAVE_HZK_SUPPORT


58 
MWHZKFONT
 *
	tPMWHZKFONT
;

59 
hzk_öô
(
PSD
 
psd
);

60 
PMWHZKFONT
 
hzk_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
f⁄èâr
);

61 
UC16_to_GB
(c⁄° *
uc16
, 
cc
, *
ascii
);

64 #i‡
HAVE_EUCJP_SUPPORT


65 
MWEUCJPFONT
 *
	tPMWEUCJPFONT
;

66 
PMWEUCJPFONT
 
eucjp_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

69 #i‡
FONTMAPPER


71 
£À˘_f⁄t
(c⁄° 
PMWLOGFONT
 
∂ogf⁄t
, c⁄° **
phy¢ame
);

75 
dbcs_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, 
MWTEXTFLAGS
 
Êags
,

76 c⁄° 
MWIMAGEBITS
 **
ªtm≠
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

77 
MWCOORD
 *
pba£
);

78 
dbcs_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

79 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

	@engine/devimage.c

17 
	~<°dio.h
>

18 
	~<°dlib.h
>

19 
	~<°rög.h
>

20 
	~<uni°d.h
>

21 
	~<f˙é.h
>

22 
	~<˘y≥.h
>

23 
	~<sys/ty≥s.h
>

24 
	~<sys/°©.h
>

25 
	~"devi˚.h
"

26 
	~"sw≠.h
"

27 #i‡
HAVE_MMAP


28 
	~<sys/mm™.h
>

31 #i‡
MW_FEATURE_IMAGES


35 
MWLIST
 
	mlök
;

36 
	mid
;

37 
PMWIMAGEHDR
 
	mpimage
;

38 
PSD
 
	mpsd
;

39 } 
	tIMAGEITEM
, *
	tPIMAGEITEM
;

41 
MWLISTHEAD
 
	gimagehód
;

42 
	g√xtimageid
 = 1;

54 
GdDecodeImage
(
PSD
 
psd
, 
buf„r_t
 *
§c
, *
∑th
, 
Êags
);

60 
	$GdImageBuf„rInô
(
buf„r_t
 *
buf„r
, *
°¨td©a
, 
size
)

62 
buf„r
->
°¨t
 = 
°¨td©a
;

63 
buf„r
->
size
 = size;

64 
buf„r
->
off£t
 = 0;

65 
	}
}

68 
	$GdImageBuf„rSìkTo
(
buf„r_t
 *
buf„r
, 
off£t
)

70 i‡(
off£t
 < 
buf„r
->
size
)

71 
buf„r
->
off£t
 = offset;

72 
	}
}

75 
	$GdImageBuf„rRód
(
buf„r_t
 *
buf„r
, *
de°
, 
size
)

77 
c›ysize
;

79 i‡(
buf„r
->
off£t
 =buf„r->
size
)

82 i‡(
buf„r
->
off£t
 + 
size
 > buffer->size)

83 
c›ysize
 = 
buf„r
->
size
 - buf„r->
off£t
;

84 
c›ysize
 = 
size
;

86 
	`mem˝y
(
de°
, 
buf„r
->
°¨t
 + buf„r->
off£t
, 
c›ysize
);

88 
buf„r
->
off£t
 +
c›ysize
;

89  
c›ysize
;

90 
	}
}

93 
	$GdImageBuf„rGëCh¨
(
buf„r_t
 *
buf„r
)

95 i‡(
buf„r
->
off£t
 =buf„r->
size
)

96  
EOF
;

97  
buf„r
->
°¨t
[buf„r->
off£t
++];

98 
	}
}

101 
	$GdImageBuf„rGëSåög
(
buf„r_t
 *
buf„r
, *
de°
, 
size
)

103 
i
,
o
;

104 
c›ysize
 = 
size
 - 1;

106 i‡(
buf„r
->
off£t
 =buf„r->
size
)

109 i‡(
buf„r
->
off£t
 + 
c›ysize
 > buf„r->
size
)

110 
c›ysize
 = 
buf„r
->
size
 - buf„r->
off£t
;

112 
o
=0, 
i
=
buf„r
->
off£t
; i < buf„r->off£à+ 
c›ysize
; i++, o++) {

113 i‡((
de°
[
o
] = 
buf„r
->
°¨t
[
i
]) == '\n')

117 
buf„r
->
off£t
 = 
i
 + 1;

118 
de°
[
o
 + 1] = 0;

120  
de°
;

121 
	}
}

124 
	$GdImageBuf„rEOF
(
buf„r_t
 *
buf„r
)

126  (
buf„r
->
off£t
 =buf„r->
size
);

127 
	}
}

139 
	$GdLﬂdImageFromBuf„r
(
PSD
 
psd
, *
buf„r
, 
size
, 
Êags
)

141 
buf„r_t
 
§c
;

143 
	`GdImageBuf„rInô
(&
§c
, 
buf„r
, 
size
);

144  
	`GdDecodeImage
(
psd
, &
§c
, 
NULL
, 
Êags
);

145 
	}
}

162 
	$GdDøwImageFromBuf„r
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

163 
MWCOORD
 
height
, *
buf„r
, 
size
, 
Êags
)

165 
id
;

166 
buf„r_t
 
§c
;

168 
	`GdImageBuf„rInô
(&
§c
, 
buf„r
, 
size
);

169 
id
 = 
	`GdDecodeImage
(
psd
, &
§c
, 
NULL
, 
Êags
);

171 i‡(
id
) {

172 
	`GdDøwImageToFô
(
psd
, 
x
, 
y
, 
width
, 
height
, 
id
);

173 
	`GdFªeImage
(
id
);

175 
	}
}

177 #i‡
deföed
(
HAVE_FILEIO
)

192 
	$GdDøwImageFromFûe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

193 
MWCOORD
 
height
, *
∑th
, 
Êags
)

195 
id
;

197 
id
 = 
	`GdLﬂdImageFromFûe
(
psd
, 
∑th
, 
Êags
);

198 i‡(
id
) {

199 
	`GdDøwImageToFô
(
psd
, 
x
, 
y
, 
width
, 
height
, 
id
);

200 
	`GdFªeImage
(
id
);

202 
	}
}

212 
	$GdLﬂdImageFromFûe
(
PSD
 
psd
, *
∑th
, 
Êags
)

214 
fd
, 
id
;

215 
°©
 
s
;

216 *
buf„r
 = 0;

217 
buf„r_t
 
§c
;

219 
fd
 = 
	`›í
(
∑th
, 
O_RDONLY
);

220 i‡(
fd
 < 0 || 
	`f°©
(fd, &
s
) < 0) {

221 
	`EPRINTF
("GdLﬂdImageFromFûe: c™'à›í image: %s\n", 
∑th
);

225 #i‡
HAVE_MMAP


226 
buf„r
 = 
	`mm≠
(0, 
s
.
°_size
, 
PROT_READ
, 
MAP_PRIVATE
, 
fd
, 0);

227 i‡(!
buf„r
) {

228 
	`EPRINTF
("GdLﬂdImageFromFûe: Couldn'àm≠ imagê%s\n", 
∑th
);

229 
	`˛o£
(
fd
);

233 
buf„r
 = 
	`mÆloc
(
s
.
°_size
);

234 i‡(!
buf„r
) {

235 
	`EPRINTF
("GdLﬂdImageFromFûe: Couldn'àmÆlo¯imagê%s\n", 
∑th
);

236 
	`˛o£
(
fd
);

240 i‡(
	`ªad
(
fd
, 
buf„r
, 
s
.
°_size
) != s.st_size) {

241 
	`EPRINTF
("GdLﬂdImageFromFûe: Couldn'àlﬂd imagê%s\n", 
∑th
);

242 
	`˛o£
(
fd
);

247 
	`GdImageBuf„rInô
(&
§c
, 
buf„r
, 
s
.
°_size
);

248 
id
 = 
	`GdDecodeImage
(
psd
, &
§c
, 
∑th
, 
Êags
);

250 #i‡
HAVE_MMAP


251 
	`munm≠
(
buf„r
, 
s
.
°_size
);

253 
	`‰ì
(
buf„r
);

255 
	`˛o£
(
fd
);

256  
id
;

257 
	}
}

269 
	$GdDecodeImage
(
PSD
 
psd
, 
buf„r_t
 * 
§c
, *
∑th
, 
Êags
)

271 
lﬂdOK
 = 0;

272 
PMWIMAGEHDR
 
pimage
;

273 
PIMAGEITEM
 
pIãm
;

276 
pimage
 = (
PMWIMAGEHDR
)
	`mÆloc
((
MWIMAGEHDR
));

277 if(!
pimage
) {

280 
pimage
->
imagebôs
 = 
NULL
;

281 
pimage
->
∑Àâe
 = 
NULL
;

282 
pimage
->
å™scﬁ‹
 = -1L;

284 #i‡
	`deföed
(
HAVE_TIFF_SUPPORT
)

286 i‡(
∑th
)

287 
lﬂdOK
 = 
	`GdDecodeTIFF
(
∑th
, 
pimage
);

289 #i‡
	`deföed
(
HAVE_BMP_SUPPORT
)

290 i‡(
lﬂdOK
 == 0)

291 
lﬂdOK
 = 
	`GdDecodeBMP
(
§c
, 
pimage
);

293 #i‡
	`deföed
(
HAVE_GIF_SUPPORT
)

294 i‡(
lﬂdOK
 == 0)

295 
lﬂdOK
 = 
	`GdDecodeGIF
(
§c
, 
pimage
);

297 #i‡
	`deföed
(
HAVE_JPEG_SUPPORT
)

298 i‡(
lﬂdOK
 == 0)

299 
lﬂdOK
 = 
	`GdDecodeJPEG
(
§c
, 
pimage
, 
psd
, 
Êags
);

301 #i‡
	`deföed
(
HAVE_PNG_SUPPORT
)

302 i‡(
lﬂdOK
 == 0)

303 
lﬂdOK
 = 
	`GdDecodePNG
(
§c
, 
pimage
);

305 #i‡
	`deföed
(
HAVE_PNM_SUPPORT
)

306 if(
lﬂdOK
 == 0)

307 
lﬂdOK
 = 
	`GdDecodePNM
(
§c
, 
pimage
);

309 #i‡
	`deföed
(
HAVE_XPM_SUPPORT
)

310 i‡(
lﬂdOK
 == 0)

311 
lﬂdOK
 = 
	`GdDecodeXPM
(
§c
, 
pimage
, 
psd
);

314 i‡(
lﬂdOK
 == 0) {

315 
	`EPRINTF
("GdLoadImageFromFile: unknown imageÅype\n");

316 
îr
;

318 i‡(
lﬂdOK
 != 1)

319 
îr
;

322 
pIãm
 = 
	`GdIãmNew
(
IMAGEITEM
);

323 i‡(!
pIãm
)

324 
îr
;

325 
pIãm
->
id
 = 
√xtimageid
++;

326 
pIãm
->
pimage
 =Öimage;

327 
pIãm
->
psd
 =Ösd;

328 
	`GdLi°Add
(&
imagehód
, &
pIãm
->
lök
);

330  
pIãm
->
id
;

332 
îr
:

333 
	`‰ì
(
pimage
);

335 
	}
}

337 
PIMAGEITEM


338 
	$födimage
(
id
)

340 
PMWLIST
 
p
;

341 
PIMAGEITEM
 
pimagñi°
;

343 
p
=
imagehód
.
hód
;Ö;Öı->
√xt
) {

344 
pimagñi°
 = 
	`GdIãmAddr
(
p
, 
IMAGEITEM
, 
lök
);

345 i‡(
pimagñi°
->
id
 == id)

346  
pimagñi°
;

348  
NULL
;

349 
	}
}

364 
	$GdDøwImageToFô
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

365 
id
)

367 
PIMAGEITEM
 
pIãm
;

368 
PMWIMAGEHDR
 
pimage
;

370 
pIãm
 = 
	`födimage
(
id
);

371 i‡(!
pIãm
)

373 
pimage
 = 
pIãm
->pimage;

378 i‡(
height
 < 0)

379 
height
 = 
pimage
->height;

380 i‡(
width
 < 0)

381 
width
 = 
pimage
->width;

383 i‡(
height
 !
pimage
->heighà|| 
width
 !=Öimage->width) {

384 
MWCLIPRECT
 
rcD°
;

385 
MWIMAGEHDR
 
image2
;

389 
image2
.
width
 = width;

390 
image2
.
height
 = height;

391 
image2
.
∂™es
 = 
pimage
->planes;

392 
image2
.
bµ
 = 
pimage
->bpp;

393 
	`GdCompuãImagePôch
(
pimage
->
bµ
, 
width
, &
image2
.
pôch
,

394 &
image2
.
byã•îpixñ
);

395 
image2
.
com¥essi⁄
 = 
pimage
->compression;

396 
image2
.
∑lsize
 = 
pimage
->palsize;

397 
image2
.
∑Àâe
 = 
pimage
->palette;

398 
image2
.
å™scﬁ‹
 = 
pimage
->transcolor;

399 if–(
image2
.
imagebôs
 = 
	`mÆloc
(image2.
pôch
*
height
)Ë=
NULL
) {

400 
	`EPRINTF
("GdDrawImageToFit:Ço memory\n");

404 
rcD°
.
x
 = 0;

405 
rcD°
.
y
 = 0;

406 
rcD°
.
width
 = width;

407 
rcD°
.
height
 = height;

410 
	`GdSåëchImage
(
pimage
, 
NULL
, &
image2
, &
rcD°
);

411 
	`GdDøwImage
(
psd
, 
x
, 
y
, &
image2
);

412 
	`‰ì
(
image2
.
imagebôs
);

414 
	`GdDøwImage
(
psd
, 
x
, 
y
, 
pimage
);

415 
	}
}

423 
	$GdFªeImage
(
id
)

425 
PIMAGEITEM
 
pIãm
;

426 
PMWIMAGEHDR
 
pimage
;

428 
pIãm
 = 
	`födimage
(
id
);

429 i‡(
pIãm
) {

430 
	`GdLi°Remove
(&
imagehód
, &
pIãm
->
lök
);

431 
pimage
 = 
pIãm
->pimage;

434 if(
pimage
->
imagebôs
)

435 
	`‰ì
(
pimage
->
imagebôs
);

436 if(
pimage
->
∑Àâe
)

437 
	`‰ì
(
pimage
->
∑Àâe
);

439 
	`‰ì
(
pimage
);

440 
	`GdIãmFªe
(
pIãm
);

442 
	}
}

451 
MWBOOL


452 
	$GdGëImageInfo
(
id
, 
PMWIMAGEINFO
 
pii
)

454 
PMWIMAGEHDR
 
pimage
;

455 
PIMAGEITEM
 
pIãm
;

456 
i
;

458 
pIãm
 = 
	`födimage
(
id
);

459 i‡(!
pIãm
) {

460 
	`mem£t
(
pii
, 0, (*pii));

461  
FALSE
;

463 
pimage
 = 
pIãm
->pimage;

464 
pii
->
id
 = id;

465 
pii
->
width
 = 
pimage
->width;

466 
pii
->
height
 = 
pimage
->height;

467 
pii
->
∂™es
 = 
pimage
->planes;

468 
pii
->
bµ
 = 
pimage
->bpp;

469 
pii
->
pôch
 = 
pimage
->pitch;

470 
pii
->
byã•îpixñ
 = 
pimage
->bytesperpixel;

471 
pii
->
com¥essi⁄
 = 
pimage
->compression;

472 
pii
->
∑lsize
 = 
pimage
->palsize;

473 i‡(
pimage
->
∑lsize
) {

474 i‡(
pimage
->
∑Àâe
) {

475 
i
=0; i<
pimage
->
∑lsize
; ++i)

476 
pii
->
∑Àâe
[
i
] = 
pimage
->palette[i];

479 
	`GdGëPÆëã
(
pIãm
->
psd
, 0, 
pimage
->
∑lsize
,

480 
pii
->
∑Àâe
);

483  
TRUE
;

484 
	}
}

486 
	#PIX2BYTES
(
n
Ë((“)+7)/8)

	)

492 
	$GdCompuãImagePôch
(
bµ
, 
width
, *
pôch
, *
byã•îpixñ
)

494 
löesize
;

495 
byã•p
 = 1;

497 if(
bµ
 == 1)

498 
löesize
 = 
	`PIX2BYTES
(
width
);

499 if(
bµ
 <= 4)

500 
löesize
 = 
	`PIX2BYTES
(
width
<<2);

501 if(
bµ
 <= 8)

502 
löesize
 = 
width
;

503 if(
bµ
 <= 16) {

504 
löesize
 = 
width
 * 2;

505 
byã•p
 = 2;

506 } if(
bµ
 <= 24) {

507 
löesize
 = 
width
 * 3;

508 
byã•p
 = 3;

510 
löesize
 = 
width
 * 4;

511 
byã•p
 = 4;

515 *
pôch
 = (
löesize
 + 3) & ~3;

516 *
byã•îpixñ
 = 
byã•p
;

517 
	}
}

520 
	$¥öt_image
(
PMWIMAGEHDR
 
image
)

522 
i
;

524 
	`DPRINTF
("Image:\n\n");

525 
	`DPRINTF
("height: %d\n", 
image
->
height
);

526 
	`DPRINTF
("width: %d\n", 
image
->
width
);

527 
	`DPRINTF
("∂™es: %d\n", 
image
->
∂™es
);

528 
	`DPRINTF
("bµ: %d\n", 
image
->
bµ
);

529 
	`DPRINTF
("com¥essi⁄: %d\n", 
image
->
com¥essi⁄
);

530 
	`DPRINTF
("∑lsize: %d\n", 
image
->
∑lsize
);

532 
i
=0;i<
image
->
∑lsize
;i++)

533 
	`DPRINTF
("∑Àâe: %d, %d, %d\n", 
image
->
∑Àâe
[
i
].
r
,

534 
image
->
∑Àâe
[
i
].
g
, image->∑Àâe[i].
b
);

536 
i
=0;i<(
image
->
width
*image->
height
);i++)

537 
	`DPRINTF
("imagebôs: %d\n", 
image
->
imagebôs
[
i
]);

538 
	}
}

	@engine/devimage_stretch.c

29 
	~<°dio.h
>

30 
	~<°dlib.h
>

31 
	~<°rög.h
>

32 
	~<uni°d.h
>

33 
	~<f˙é.h
>

34 
	~<˘y≥.h
>

35 
	~<sys/ty≥s.h
>

36 
	~<sys/°©.h
>

37 
	~"devi˚.h
"

38 
	~"sw≠.h
"

40 #i‡
MW_FEATURE_IMAGES


42 
	#DEFINE_COPY_ROW
(
«me
, 
ty≥
) \

43 
	`«me
(
ty≥
 *
§c
, 
§c_w
,Åy≥ *
d°
, 
d°_w
) \

45 
i
; \

46 
pos
, 
öc
; \

47 
ty≥
 
pixñ
 = 0; \

49 
pos
 = 0x10000; \

50 
öc
 = (
§c_w
 << 16Ë/ 
d°_w
; \

51  
i
=
d°_w
; i>0; --i ) { \

52  
pos
 >= 0x10000L ) { \

53 
pixñ
 = *
§c
++; \

54 
pos
 -= 0x10000L; \

56 *
d°
++ = 
pixñ
; \

57 
pos
 +
öc
; \

59 }

	)

61 
	$DEFINE_COPY_ROW
(
c›y_row1
, )

62 
	$DEFINE_COPY_ROW
(
c›y_row2
, )

63 
	$DEFINE_COPY_ROW
(
c›y_row4
, )

65 
	$c›y_row3
(*
§c
, 
§c_w
, *
d°
,

66 
d°_w
)

68 
i
;

69 
pos
, 
öc
;

70 
r
 = 0;

71 
g
 = 0;

72 
b
 = 0;

74 
pos
 = 0x10000;

75 
öc
 = (
§c_w
 << 16Ë/ 
d°_w
;

76  
i
=
d°_w
; i>0; --i ) {

77  
pos
 >= 0x10000L ) {

78 
b
 = *
§c
++;

79 
g
 = *
§c
++;

80 
r
 = *
§c
++;

81 
pos
 -= 0x10000L;

83 *
d°
++ = 
b
;

84 *
d°
++ = 
g
;

85 *
d°
++ = 
r
;

86 
pos
 +
öc
;

88 
	}
}

99 
	$GdSåëchImage
(
PMWIMAGEHDR
 
§c
, 
MWCLIPRECT
 *
§¸e˘
, PMWIMAGEHDR 
d°
,

100 
MWCLIPRECT
 *
d°ª˘
)

102 
pos
, 
öc
;

103 
byã•îpixñ
;

104 
d°_maxrow
;

105 
§c_row
, 
d°_row
;

106 
MWUCHAR
 *
§˝
 = 0;

107 
MWUCHAR
 *
d°p
;

108 
MWCLIPRECT
 
fuŒ_§c
;

109 
MWCLIPRECT
 
fuŒ_d°
;

111 i‡–
§c
->
byã•îpixñ
 !
d°
->bytesperpixel ) {

112 
	`EPRINTF
("GdStretchImage: bytesperpixel mismatch\n");

117 i‡–
§¸e˘
 ) {

118 i‡–(
§¸e˘
->
x
 < 0Ë|| (§¸e˘->
y
 < 0) ||

119 ((
§¸e˘
->
x
+§¸e˘->
width
Ë> 
§c
->width) ||

120 ((
§¸e˘
->
y
+§¸e˘->
height
Ë> 
§c
->height) ) {

121 
	`EPRINTF
("GdStretchImage: invalid sourceÑect\n");

125 
fuŒ_§c
.
x
 = 0;

126 
fuŒ_§c
.
y
 = 0;

127 
fuŒ_§c
.
width
 = 
§c
->width;

128 
fuŒ_§c
.
height
 = 
§c
->height;

129 
§¸e˘
 = &
fuŒ_§c
;

131 i‡–
d°ª˘
 ) {

133 i‡(!
d°ª˘
->
width
 || !d°ª˘->
height
)

135 i‡–(
d°ª˘
->
x
 < 0Ë|| (d°ª˘->
y
 < 0) ||

136 ((
d°ª˘
->
x
+d°ª˘->
width
Ë> 
d°
->width) ||

137 ((
d°ª˘
->
y
+d°ª˘->
height
Ë> 
d°
->height) ) {

138 
	`EPRINTF
("GdStretchImage: invalid destÑect\n");

142 
fuŒ_d°
.
x
 = 0;

143 
fuŒ_d°
.
y
 = 0;

144 
fuŒ_d°
.
width
 = 
d°
->width;

145 
fuŒ_d°
.
height
 = 
d°
->height;

146 
d°ª˘
 = &
fuŒ_d°
;

150 
pos
 = 0x10000;

151 
öc
 = (
§¸e˘
->
height
 << 16Ë/ 
d°ª˘
->height;

152 
§c_row
 = 
§¸e˘
->
y
;

153 
d°_row
 = 
d°ª˘
->
y
;

154 
byã•îpixñ
 = 
d°
->bytesperpixel;

157  
d°_maxrow
 = 
d°_row
+
d°ª˘
->
height
; dst_row<dst_maxrow;

158 ++
d°_row
 ) {

159 
d°p
 = (
MWUCHAR
 *)
d°
->
imagebôs
 + (
d°_row
*d°->
pôch
)

160 + (
d°ª˘
->
x
*
byã•îpixñ
);

161  
pos
 >= 0x10000L ) {

162 
§˝
 = (
MWUCHAR
 *)
§c
->
imagebôs
 + (
§c_row
*§c->
pôch
)

163 + (
§¸e˘
->
x
*
byã•îpixñ
);

164 ++
§c_row
;

165 
pos
 -= 0x10000L;

168 
byã•îpixñ
) {

170 
	`c›y_row1
(
§˝
, 
§¸e˘
->
width
, 
d°p
, 
d°ª˘
->width);

173 
	`c›y_row2
((*)
§˝
, 
§¸e˘
->
width
,

174 (*)
d°p
, 
d°ª˘
->
width
);

177 
	`c›y_row3
(
§˝
, 
§¸e˘
->
width
, 
d°p
, 
d°ª˘
->width);

180 
	`c›y_row4
((*)
§˝
, 
§¸e˘
->
width
,

181 (*)
d°p
, 
d°ª˘
->
width
);

185 
pos
 +
öc
;

187 
	}
}

	@engine/devkbd.c

6 
	~"devi˚.h
"

14 
	$GdO≥nKeybﬂrd
()

16 
fd
;

18 i‡((
fd
 = 
kbddev
.
	`O≥n
(&kbddev)) == -1)

22  
fd
;

23 
	}
}

25 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


32 
	$GdO≥nKeybﬂrd2
()

34  
kbddev2
.
	`O≥n
(&kbddev2);

35 
	}
}

42 
	$GdClo£Keybﬂrd
()

44 
kbddev
.
	`Clo£
();

45 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


46 
kbddev2
.
	`Clo£
();

48 
	}
}

57 
	$GdGëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
)

59 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


60 
MWKEYMOD
 
modifõrs2
;

61 
MWKEYMOD
 
curmodifõrs2
;

63 
kbddev
.
	`GëModifõrInfo
(
modifõrs
, 
curmodifõrs
);

64 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


65 
kbddev2
.
	`GëModifõrInfo
(&
modifõrs2
, &
curmodifõrs2
);

66 i‡(
modifõrs
)

67 *
modifõrs
 |
modifõrs2
;

68 i‡(
curmodifõrs
)

69 *
curmodifõrs
 |
curmodifõrs2
;

71 
	}
}

86 
	$GdRódKeybﬂrd
(
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
)

88 
ªsu…
 = 
kbddev
.
	`Ród
(
buf
, 
modifõrs
, 
sˇncode
);

89 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


90 i‡(
ªsu…
 == 0)

91 
ªsu…
 = 
kbddev2
.
	`Ród
(
buf
, 
modifõrs
, 
sˇncode
);

93  
ªsu…
;

94 
	}
}

	@engine/devlist.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"devi˚.h
"

12 
	$GdIãmAŒoc
(
size
)

14  (*)
	`ˇŒoc
(
size
, 1);

15 
	}
}

19 
	$GdLi°Add
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
)

21 if–
pHód
->
èû
) {

22 
pIãm
->
¥ev
 = 
pHód
->
èû
;

23 
pHód
->
èû
->
√xt
 = 
pIãm
;

25 
pIãm
->
¥ev
 = 
NULL
;

26 
pIãm
->
√xt
 = 
NULL
;

27 
pHód
->
èû
 = 
pIãm
;

28 if–!
pHód
->
hód
)

29 
pHód
->
hód
 = 
pIãm
;

30 
	}
}

34 
	$GdLi°In£π
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
)

36 if–
pHód
->
hód
) {

37 
pIãm
->
√xt
 = 
pHód
->
hód
;

38 
pHód
->
hód
->
¥ev
 = 
pIãm
;

40 
pIãm
->
√xt
 = 
NULL
;

41 
pIãm
->
¥ev
 = 
NULL
;

42 
pHód
->
hód
 = 
pIãm
;

43 if–!
pHód
->
hód
)

44 
pHód
->
hód
 = 
pIãm
;

45 
	}
}

48 
	$GdLi°Remove
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
)

50 if–
pIãm
->
√xt
)

51 
pIãm
->
√xt
->
¥ev
 =ÖItem->prev;

52 if–
pIãm
->
¥ev
)

53 
pIãm
->
¥ev
->
√xt
 =ÖItem->next;

54 if–
pHód
->
hód
 =
pIãm
)

55 
pHód
->
hód
 = 
pIãm
->
√xt
;

56 if–
pHód
->
èû
 =
pIãm
)

57 
pHód
->
èû
 = 
pIãm
->
¥ev
;

58 
pIãm
->
√xt
 =ÖIãm->
¥ev
 = 
NULL
;

59 
	}
}

	@engine/devmouse.c

16 
	~<°rög.h
>

17 
	~"devi˚.h
"

26 #i‚de‡
FLIP_MOUSE_IN_PORTRAIT_MODE


27 
	#FLIP_MOUSE_IN_PORTRAIT_MODE
 1

	)

30 
MWCOORD
 
	gxpos
;

31 
MWCOORD
 
	gypos
;

32 
MWCOORD
 
	gmöx
;

33 
MWCOORD
 
	gmaxx
;

34 
MWCOORD
 
	gmöy
;

35 
MWCOORD
 
	gmaxy
;

36 
	gsˇÀ
;

37 
	gthªsh
;

38 
	gbuâ⁄s
;

39 
MWBOOL
 
	gch™ged
;

41 
MWCOORD
 
	gcurmöx
;

42 
MWCOORD
 
	gcurmöy
;

43 
MWCOORD
 
	gcurmaxx
;

44 
MWCOORD
 
	gcurmaxy
;

45 
	gcurvisibÀ
;

46 
MWBOOL
 
	gcu∫ìd§e°‹e
;

47 
MWCOORD
 
	gcurßvx
;

48 
MWCOORD
 
	gcurßvy
;

49 
MWCOORD
 
	gcurßvx2
;

50 
MWCOORD
 
	gcurßvy2
;

51 
MWPIXELVAL
 
	gcurfg
;

52 
MWPIXELVAL
 
	gcurbg
;

53 
MWPIXELVAL
 
	gcurßvbôs
[
MWMAX_CURSOR_SIZE
 * MWMAX_CURSOR_SIZE];

54 
MWIMAGEBITS
 
	gcurs‹mask
[
MWMAX_CURSOR_BUFLEN
];

55 
MWIMAGEBITS
 
	gcurs‹cﬁ‹
[
MWMAX_CURSOR_BUFLEN
];

57 
gr_mode
;

60 
fûãr_ªœtive
(, , , *, *, , );

61 
fûãr_å™sf‹m
(, *, *);

62 #i‡
FLIP_MOUSE_IN_PORTRAIT_MODE


63 
fûãr_ªÃŸ©e
(, *
xpos
, *
ypos
, 
x
, 
y
);

64 
fûãr_ab§Ÿ©e
(, *
xpos
, *
ypos
);

74 
	$GdO≥nMou£
()

76 
fd
;

79 
buâ⁄s
 = 0;

80 
xpos
 = 0;

81 
ypos
 = 0;

82 
möx
 = 
MIN_MWCOORD
;

83 
möy
 = 
MIN_MWCOORD
;

84 
maxx
 = 
MAX_MWCOORD
;

85 
maxy
 = 
MAX_MWCOORD
;

86 
ch™ged
 = 
TRUE
;

89 
curvisibÀ
 = 0;

90 
cu∫ìd§e°‹e
 = 
FALSE
;

91 
curmöx
 = 
möx
;

92 
curmöy
 = 
möy
;

93 
curmaxx
 = 
curmöx
 + 
MWMAX_CURSOR_SIZE
 - 1;

94 
curmaxy
 = 
curmöy
 + 
MWMAX_CURSOR_SIZE
 - 1;

96 i‡((
fd
 = 
mou£dev
.
	`O≥n
(&mousedev)) == -1)

100 
mou£dev
.
	`GëDeÁu…Ac˚l
(&
sˇÀ
, &
thªsh
);

103 
mou£dev
.
Êags
 &~
MOUSE_RAW
;

106 if(
fd
 == -2)

107 
	`GdHideCurs‹
(&
s¸dev
);

109  
fd
;

110 
	}
}

117 
	$GdClo£Mou£
()

119 
mou£dev
.
	`Clo£
();

120 
	}
}

129 
	$GdGëBuâ⁄Info
(*
buâ⁄s
)

131 *
buâ⁄s
 = 
mou£dev
.
	`GëBuâ⁄Info
();

132 
	}
}

143 
	$GdRe°ri˘Mou£
(
MWCOORD
 
√wmöx
, MWCOORD 
√wmöy
, MWCOORD 
√wmaxx
,

144 
MWCOORD
 
√wmaxy
)

146 
möx
 = 
√wmöx
;

147 
möy
 = 
√wmöy
;

148 
maxx
 = 
√wmaxx
;

149 
maxy
 = 
√wmaxy
;

151 
	`GdMoveMou£
(
xpos
, 
ypos
);

152 
	}
}

168 
	$GdSëAc˚lMou£
(
√wthªsh
, 
√wsˇÀ
)

170 i‡(
√wthªsh
 < 0)

171 
√wthªsh
 = 0;

172 i‡(
√wsˇÀ
 < 0)

173 
√wsˇÀ
 = 0;

174 
thªsh
 = 
√wthªsh
;

175 
sˇÀ
 = 
√wsˇÀ
;

176 
	}
}

186 
	$GdMoveMou£
(
MWCOORD
 
√wx
, MWCOORD 
√wy
)

188 i‡(!(
mou£dev
.
Êags
 & 
MOUSE_RAW
)) {

189 i‡(
√wx
 < 
möx
)

190 
√wx
 = 
möx
;

191 i‡(
√wx
 > 
maxx
)

192 
√wx
 = 
maxx
;

193 i‡(
√wy
 < 
möy
)

194 
√wy
 = 
möy
;

195 i‡(
√wy
 > 
maxy
)

196 
√wy
 = 
maxy
;

199 i‡(
√wx
 =
xpos
 && 
√wy
 =
ypos
)

202 
ch™ged
 = 
TRUE
;

204 
xpos
 = 
√wx
;

205 
ypos
 = 
√wy
;

206 
	}
}

224 
	$GdRódMou£
(
MWCOORD
 *
px
, MWCOORD *
py
, *
pb
)

226 
MWCOORD
 
x
, 
y
, 
z
;

227 
√wbuâ⁄s
;

228 
°©us
;

229 
MWCOORD
 
dx
, 
dy
;

231 *
px
 = 
xpos
;

232 *
py
 = 
ypos
;

233 *
pb
 = 
buâ⁄s
;

235 i‡(
ch™ged
) {

236 
ch™ged
 = 
FALSE
;

241 
°©us
 = 
mou£dev
.
	`Ród
(&
x
, &
y
, &
z
, &
√wbuâ⁄s
);

242 i‡(
°©us
 < 0)

246 i‡(
°©us
 == 0)

250 i‡(
°©us
 == 1) {

251 
rx
, 
ry
;

252 
	`fûãr_ªœtive
(
°©us
, 
thªsh
, 
sˇÀ
, &
rx
, &
ry
, 
x
, 
y
);

253 #i‡
FLIP_MOUSE_IN_PORTRAIT_MODE


254 
dx
 = 
xpos
;

255 
dy
 = 
ypos
;

256 
	`fûãr_ªÃŸ©e
(
°©us
, &
dx
, &
dy
, 
x
, 
y
);

258 
dx
 = 
xpos
 + 
rx
;

259 
dy
 = 
ypos
 + 
ry
;

262 
dx
 = 
x
;

263 
dy
 = 
y
;

266 i‡(
mou£dev
.
Êags
 & 
MOUSE_TRANSFORM
) {

267 i‡(!
	`fûãr_å™sf‹m
(
°©us
, &
dx
, &
dy
))

270 #i‡
FLIP_MOUSE_IN_PORTRAIT_MODE


271 i‡(!(
mou£dev
.
Êags
 & 
MOUSE_RAW
))

272 
	`fûãr_ab§Ÿ©e
(
°©us
, &
dx
, &
dy
);

282 i‡(
buâ⁄s
 !
√wbuâ⁄s
) {

283 
ch™ged
 = 
TRUE
;

284 
buâ⁄s
 = 
√wbuâ⁄s
;

288 i‡(
°©us
 != 3)

289 
	`GdMoveMou£
(
dx
, 
dy
);

292 i‡(!
ch™ged
)

296 
ch™ged
 = 
FALSE
;

297 *
px
 = 
xpos
;

298 *
py
 = 
ypos
;

299 *
pb
 = 
buâ⁄s
;

302 
	}
}

311 
	$GdMoveCurs‹
(
MWCOORD
 
√wx
, MWCOORD 
√wy
)

313 
MWCOORD
 
shi·x
;

314 
MWCOORD
 
shi·y
;

316 
shi·x
 = 
√wx
 - 
curmöx
;

317 
shi·y
 = 
√wy
 - 
curmöy
;

318 if(
shi·x
 =0 && 
shi·y
 == 0)

320 
curmöx
 +
shi·x
;

321 
curmaxx
 +
shi·x
;

322 
curmöy
 +
shi·y
;

323 
curmaxy
 +
shi·y
;

326 
	`GdHideCurs‹
(&
s¸dev
);

329 
	`GdShowCurs‹
(&
s¸dev
);

330 
	}
}

339 
MWBOOL


340 
	$GdGëCurs‹Pos
(
MWCOORD
 *
px
, MWCOORD *
py
)

342 *
px
 = 
xpos
;

343 *
py
 = 
ypos
;

344  
curvisibÀ
 > 0;

345 
	}
}

353 
	$GdSëCurs‹
(
PMWCURSOR
 
pcurs‹
)

355 
byãs
;

357 
	`GdHideCurs‹
(&
s¸dev
);

358 
curmaxx
 = 
curmöx
 + 
pcurs‹
->
width
 - 1;

359 
curmaxy
 = 
curmöy
 + 
pcurs‹
->
height
 - 1;

361 
curfg
 = 
	`GdFödCﬁ‹
(&
s¸dev
, 
pcurs‹
->
fgcﬁ‹
);

362 
curbg
 = 
	`GdFödCﬁ‹
(&
s¸dev
, 
pcurs‹
->
bgcﬁ‹
);

364 
byãs
 = 
	`MWIMAGE_SIZE
(
pcurs‹
->
width
,Öcurs‹->
height
Ë* (
MWIMAGEBITS
);

366 
	`mem˝y
(
curs‹cﬁ‹
, 
pcurs‹
->
image
, 
byãs
);

367 
	`mem˝y
(
curs‹mask
, 
pcurs‹
->
mask
, 
byãs
);

369 
	`GdShowCurs‹
(&
s¸dev
);

370 
	}
}

381 
	$GdShowCurs‹
(
PSD
 
psd
)

383 
MWCOORD
 
x
;

384 
MWCOORD
 
y
;

385 
MWPIXELVAL
 * 
ßvïå
;

386 
MWIMAGEBITS
 * 
curs‹±r
;

387 
MWIMAGEBITS
 * 
mask±r
;

388 
MWIMAGEBITS
 
curbô
, 
cbôs
 = 0, 
mbôs
 = 0;

389 
MWPIXELVAL
 
ﬁdcﬁ‹
;

390 
MWPIXELVAL
 
√wcﬁ‹
;

391 
ﬁdmode
;

392 
¥evcurs‹
 = 
curvisibÀ
;

394 if(++
curvisibÀ
 != 1)

395  
¥evcurs‹
;

396 
ﬁdmode
 = 
gr_mode
;

397 
gr_mode
 = 
MWMODE_COPY
;

399 
ßvïå
 = 
curßvbôs
;

400 
curßvx
 = 
curmöx
;

401 
curßvy
 = 
curmöy
;

402 
curßvx2
 = 
curmaxx
;

403 
curßvy2
 = 
curmaxy
;

404 
curs‹±r
 = 
curs‹cﬁ‹
;

405 
mask±r
 = 
curs‹mask
;

410 
curbô
 = 0;

411 
y
 = 
curmöy
; y <
curmaxy
; y++) {

412 i‡(
curbô
 !
MWIMAGE_FIRSTBIT
) {

413 
cbôs
 = *
curs‹±r
++;

414 
mbôs
 = *
mask±r
++;

415 
curbô
 = 
MWIMAGE_FIRSTBIT
;

417 
x
 = 
curmöx
; x <
curmaxx
; x++) {

418 if(
x
 >0 && x < 
psd
->
xvúåes
 &&

419 
y
 >0 && y < 
psd
->
yvúåes
) {

420 
ﬁdcﬁ‹
 = 
psd
->
	`RódPixñ
’sd, 
x
, 
y
);

421 i‡(
curbô
 & 
mbôs
) {

422 
√wcﬁ‹
 = (
curbô
&
cbôs
)? 
curbg
: 
curfg
;

423 i‡(
ﬁdcﬁ‹
 !
√wcﬁ‹
)

424 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
√wcﬁ‹
);

426 *
ßvïå
++ = 
ﬁdcﬁ‹
;

428 
curbô
 = 
	`MWIMAGE_NEXTBIT
(curbit);

429 i‡(!
curbô
) {

430 
cbôs
 = *
curs‹±r
++;

431 
mbôs
 = *
mask±r
++;

432 
curbô
 = 
MWIMAGE_FIRSTBIT
;

437 
gr_mode
 = 
ﬁdmode
;

438  
¥evcurs‹
;

439 
	}
}

448 
	$GdHideCurs‹
(
PSD
 
psd
)

450 
MWPIXELVAL
 * 
ßvïå
;

451 
MWCOORD
 
x
, 
y
;

452 
ﬁdmode
;

453 
¥evcurs‹
 = 
curvisibÀ
;

455 if(
curvisibÀ
-- <= 0)

456  
¥evcurs‹
;

457 
ﬁdmode
 = 
gr_mode
;

458 
gr_mode
 = 
MWMODE_COPY
;

460 
ßvïå
 = 
curßvbôs
;

461 
y
 = 
curßvy
; y <
curßvy2
; y++) {

462 
x
 = 
curßvx
; x <
curßvx2
; x++) {

463 if(
x
 >0 && x < 
psd
->
xvúåes
 &&

464 
y
 >0 && y < 
psd
->
yvúåes
) {

465 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, *
ßvïå
++);

469 
gr_mode
 = 
ﬁdmode
;

470  
¥evcurs‹
;

471 
	}
}

487 
	$GdCheckCurs‹
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
)

489 
MWCOORD
 
ãmp
;

491 i‡(
curvisibÀ
 <0 || (
psd
->
Êags
 & 
PSF_SCREEN
) == 0)

494 i‡(
x1
 > 
x2
) {

495 
ãmp
 = 
x1
;

496 
x1
 = 
x2
;

497 
x2
 = 
ãmp
;

499 i‡(
y1
 > 
y2
) {

500 
ãmp
 = 
y1
;

501 
y1
 = 
y2
;

502 
y2
 = 
ãmp
;

504 i‡(
x1
 > 
curmaxx
 || 
x2
 < 
curmöx
 || 
y1
 > 
curmaxy
 || 
y2
 < 
curmöy
)

507 
	`GdHideCurs‹
(
psd
);

508 
cu∫ìd§e°‹e
 = 
TRUE
;

509 
	}
}

519 
	$GdFixCurs‹
(
PSD
 
psd
)

521 i‡(
cu∫ìd§e°‹e
 && (
psd
->
Êags
 & 
PSF_SCREEN
)) {

522 
	`GdShowCurs‹
(
psd
);

523 
cu∫ìd§e°‹e
 = 
FALSE
;

525 
	}
}

528 
	#JITTER_SHIFT_BITS
 2

	)

529 
	#JITTER_DEPTH
 (1 << (
JITTER_SHIFT_BITS
))

	)

531 
MWTRANSFORM
 
	gg_å™s
;

534 
	mx
;

535 
	my
;

536 
	mcou¡
;

537 } 
	gjôãr
 = { 0, 0, 0};

541 
	$GdSëTønsf‹m
(
MWTRANSFORM
 *
å™s
)

543 i‡(!(
mou£dev
.
Êags
 & 
MOUSE_TRANSFORM
))

546 i‡(
å™s
) {

547 
g_å™s
 = *
å™s
;

549 
mou£dev
.
Êags
 &~
MOUSE_RAW
;

551 
mou£dev
.
Êags
 |
MOUSE_RAW
;

552 
	}
}

556 
	$fûãr_ªœtive
(
°©e
, 
thªsh
, 
sˇÀ
, *
xpos
, *
ypos
, 
x
,

557 
y
)

559 
sign
 = 1;

561 i‡(
°©e
 != 1)

564 i‡(
x
 < 0) {

565 
sign
 = -1;

566 
x
 = -x;

569 i‡(
x
 > 
thªsh
)

570 
x
 = 
thªsh
 + (x -ÅhªshË* 
sˇÀ
;

571 
x
 *
sign
;

573 
sign
 = 1;

575 i‡(
y
 < 0) {

576 
sign
 = -1;

577 
y
 = -y;

580 i‡(
y
 > 
thªsh
)

581 
y
 = 
thªsh
 + (y -ÅhªshË* 
sˇÀ
;

582 
y
 *
sign
;

584 *
xpos
 = 
x
;

585 *
ypos
 = 
y
;

587 
	}
}

589 #i‡
FLIP_MOUSE_IN_PORTRAIT_MODE


591 
	$fûãr_ªÃŸ©e
(
°©e
, *
xpos
, *
ypos
, 
x
, 
y
)

593 i‡(
°©e
 == 3)

596 
s¸dev
.
p‹åaô
) {

597 
MWPORTRAIT_RIGHT
:

598 *
xpos
 +
y
;

599 *
ypos
 -
x
;

602 
MWPORTRAIT_LEFT
:

603 *
xpos
 -
y
;

604 *
ypos
 +
x
;

607 
MWPORTRAIT_DOWN
:

608 *
xpos
 -
x
;

609 *
ypos
 -
y
;

613 *
xpos
 +
x
;

614 *
ypos
 +
y
;

618 
	}
}

621 
	$fûãr_ab§Ÿ©e
(
°©e
, *
xpos
, *
ypos
)

623 
x
 = *
xpos
;

624 
y
 = *
ypos
;

626 i‡(
°©e
 == 3)

629 
s¸dev
.
p‹åaô
) {

630 
MWPORTRAIT_RIGHT
:

631 *
xpos
 = 
y
;

632 *
ypos
 = 
s¸dev
.
xªs
 - 
x
 - 1;

635 
MWPORTRAIT_LEFT
:

636 *
xpos
 = 
s¸dev
.
yªs
 - 
y
 - 1;

637 *
ypos
 = 
x
;

640 
MWPORTRAIT_DOWN
:

641 *
xpos
 = 
x
;

642 *
ypos
 = 
s¸dev
.
yªs
 - 
y
 - 1;

646 *
xpos
 = 
x
;

647 *
ypos
 = 
y
;

651 
	}
}

655 
	$fûãr_å™sf‹m
(
°©e
, *
xpos
, *
ypos
)

658 i‡(
°©e
 == 3) {

659 
jôãr
.
cou¡
 = jôãr.
x
 = jôãr.
y
 = 0;

661 } i‡(
°©e
 == 1)

664 i‡(
jôãr
.
cou¡
 =
JITTER_DEPTH
) {

665 
jôãr
.
x
 = jôãr.x >> 
JITTER_SHIFT_BITS
;

666 
jôãr
.
y
 = jôãr.y >> 
JITTER_SHIFT_BITS
;

669 i‡(
g_å™s
.
s
 && !(
mou£dev
.
Êags
 & 
MOUSE_RAW
)) {

670 *
xpos
 = ((
g_å™s
.
a
 * 
jôãr
.
x
 +

671 
g_å™s
.
b
 * 
jôãr
.
y
 +

672 
g_å™s
.
c
Ë/ g_å™s.
s
);

673 *
ypos
 = ((
g_å™s
.
d
 * 
jôãr
.
x
 +

674 
g_å™s
.
e
 * 
jôãr
.
y
 +

675 
g_å™s
.
f
Ë/ g_å™s.
s
);

677 
jôãr
.
cou¡
 = jôãr.
x
 = jôãr.
y
 = 0;

680 *
xpos
 = 
jôãr
.
x
;

681 *
ypos
 = 
jôãr
.
y
;

683 
jôãr
.
cou¡
 = jôãr.
x
 = jôãr.
y
 = 0;

688 
jôãr
.
x
 +*
xpos
;

689 
jôãr
.
y
 +*
ypos
;

690 ++
jôãr
.
cou¡
;

692 
	}
}

	@engine/devopen.c

16 
	~<°dio.h
>

17 
	~<°dlib.h
>

18 
	~<°rög.h
>

19 
	~<as£π.h
>

20 
	~"devi˚.h
"

21 
	~"sw≠.h
"

23 #i‡
MSDOS
 | 
ELKS


24 
	#NOSTDPAL8


	)

27 #i‡
PSP


28 
	~<p•kî√l.h
>

29 
	~<p•debug.h
>

33 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

35 
	#¥ötf
(...)

	)

38 
	#EPRINTF
 
¥ötf


	)

48 
	#FIRSTUSERPALENTRY
 24

	)

50 
MWPIXELVAL
 
	ggr_f‹eground
;

51 
MWPIXELVAL
 
	ggr_background
;

52 
MWBOOL
 
	ggr_u£bg
;

53 
	ggr_mode
 = 
MWMODE_COPY
;

54  
MWPALENTRY
 
	ggr_∑Àâe
[256];

55  
	ggr_fú°u£ΩÆíåy
;

56  
	ggr_√xçÆíåy
;

58 
	ggr_dashmask
;

59 
	ggr_dashcou¡
;

61 
	ggr_fûlmode
;

62 
MWSTIPPLE
 
	ggr_°ù∂e
;

63 
MWTILE
 
	ggr_tûe
;

65 
MWPOINT
 
	ggr_ts_off£t
;

67 
	ggr_pixty≥
;

68 
	ggr_ncﬁ‹s
;

75 
PSD


76 
	$GdO≥nS¸ìn
()

78 
PSD
 
psd
;

79 
MWPALENTRY
 * 
°d∑l
;

80 
MWSCREENINFO
 
söfo
;

82 #i‡
PSP


83 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

86 
psd
 = 
s¸dev
.
	`O≥n
(&scrdev);

88 #i‡
PSP


89 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

92 i‡(!
psd
)

93  
NULL
;

94 
	`GdGëS¸ìnInfo
(
psd
, &
söfo
);

95 
gr_pixty≥
 = 
söfo
.
pixty≥
;

96 
gr_ncﬁ‹s
 = 
söfo
.
ncﬁ‹s
;

99 
gr_fú°u£ΩÆíåy
 = ()
psd
->
ncﬁ‹s
;

101 #i‡
PSP


102 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

103 
	`¥ötf
("ncﬁ‹s=%d\n",
gr_fú°u£ΩÆíåy
);

107 ()
psd
->
ncﬁ‹s
) {

109 #i‡!
	`deföed
(
NOSTDPAL1
)

112 
MWPALENTRY
 
mw°d∑l1
[2];

113 
°d∑l
 = 
mw°d∑l1
;

118 #i‡!
	`deföed
(
NOSTDPAL2
)

121 
MWPALENTRY
 
mw°d∑l2
[4];

122 
°d∑l
 = 
mw°d∑l2
;

127 #i‡!
	`deföed
(
NOSTDPAL4
)

132 
MWPALENTRY
 
mw°d∑l4
[16];

133 
°d∑l
 = 
mw°d∑l4
;

138 #i‡!
	`deföed
(
NOSTDPAL8
)

141 
MWPALENTRY
 
mw°d∑l8
[256];

142 #i‡
xxxALPHABLEND


144 
gr_fú°u£ΩÆíåy
 = 256;

147 
gr_fú°u£ΩÆíåy
 = 
FIRSTUSERPALENTRY
;

149 
°d∑l
 = 
mw°d∑l8
;

156 
gr_fú°u£ΩÆíåy
 = 0;

157 
°d∑l
 = 
NULL
;

161 #i‡
PSP


162 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

166 
	`GdRe£tPÆëã
();

167 
	`GdSëPÆëã
(
psd
, 0, (Ìsd->
ncﬁ‹s
, 
°d∑l
);

168 #i‡
xxxALPHABLEND


170 if(
psd
->
ncﬁ‹s
 == 256)

171 
	`öô_Æpha_lookup
();

174 #i‡
PSP


175 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

178 #i‡!
NOFONTSORCLIPPING


180 
	`GdSëMode
(
MWMODE_COPY
);

181 
	`GdSëFûlMode
(
MWFILL_SOLID
);

183 
	`GdSëF‹egroundCﬁ‹
(
psd
, 
	`MWRGB
(255, 255, 255));

184 
	`GdSëBackgroundCﬁ‹
(
psd
, 
	`MWRGB
(0, 0, 0));

185 
	`GdSëU£Background
(
TRUE
);

187 
	`GdSëF⁄t
(
	`GdCª©eF⁄t
(
psd
, 
NULL
, 0, NULL));

189 
	`GdSëDash
(0, 0);

190 
	`GdSëStù∂eBôm≠
(0,0,0);

192 #i‡
DYNAMICREGIONS


193 
	`GdSëClùRegi⁄
(
psd
,

194 
	`GdAŒocRe˘Regi⁄
(0, 0, 
psd
->
xvúåes
,Ösd->
yvúåes
));

196 
	`GdSëClùRe˘s
(
psd
, 0, 
NULL
);

201 #i‡
PSP


202 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

205 
psd
->
	`FûlRe˘
’sd, 0, 0,Ösd->
xvúåes
-1,Ösd->
yvúåes
-1, 0);

207 #i‡
PSP


208 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

211  
psd
;

212 
	}
}

220 
	$GdClo£S¸ìn
(
PSD
 
psd
)

222 
psd
->
	`Clo£
(psd);

223 
	}
}

233 
	$GdSëP‹åaôMode
(
PSD
 
psd
, 
p‹åaômode
)

236 i‡(
psd
->
SëP‹åaô
)

237 
psd
->
	`SëP‹åaô
’sd, 
p‹åaômode
);

238  
psd
->
p‹åaô
;

239 
	}
}

248 
	$GdGëS¸ìnInfo
(
PSD
 
psd
, 
PMWSCREENINFO
 
psi
)

250 
psd
->
	`GëS¸ìnInfo
’sd, 
psi
);

251 
	`GdGëBuâ⁄Info
(&
psi
->
buâ⁄s
);

252 
	`GdGëModifõrInfo
(&
psi
->
modifõrs
, 
NULL
);

253 
	`GdGëCurs‹Pos
(&
psi
->
xpos
, &psi->
ypos
);

254 
	}
}

261 
	$GdRe£tPÆëã
()

266 
gr_√xçÆíåy
 = 
gr_fú°u£ΩÆíåy
;

267 
	}
}

278 
	$GdSëPÆëã
(
PSD
 
psd
, 
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
)

280 
i
;

283 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

287 if(
fú°
 + 
cou¡
 > ()
psd
->
ncﬁ‹s
)

288 
cou¡
 = ()
psd
->
ncﬁ‹s
 - 
fú°
;

289 if(
cou¡
 >0 && 
fú°
 < ()
psd
->
ncﬁ‹s
) {

290 
psd
->
	`SëPÆëã
’sd, 
fú°
, 
cou¡
, 
∑Àâe
);

293 
i
=0; i<
cou¡
; ++i)

294 
gr_∑Àâe
[
i
+
fú°
] = 
∑Àâe
[i];

296 
	}
}

307 
	$GdGëPÆëã
(
PSD
 
psd
, 
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
)

309 
i
;

312 if(
psd
->
pixty≥
 !
MWPF_PALETTE
)

316 if(
fú°
 + 
cou¡
 > ()
psd
->
ncﬁ‹s
)

317 if–(
cou¡
 = ()
psd
->
ncﬁ‹s
 - 
fú°
) <= 0)

320 
i
=0; i<
cou¡
; ++i)

321 *
∑Àâe
++ = 
gr_∑Àâe
[
i
+
fú°
];

323  
cou¡
;

324 
	}
}

333 
MWPIXELVAL


334 
	$GdFödCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
c
)

339 
psd
->
pixty≥
) {

340 
MWPF_TRUECOLOR8888
:

341  
	`COLOR2PIXEL8888
(
c
);

343 
MWPF_TRUECOLOR0888
:

344 
MWPF_TRUECOLOR888
:

347  
	`COLOR2PIXEL888
(
c
);

349 
MWPF_TRUECOLOR565
:

352  
	`COLOR2PIXEL565
(
c
);

354 
MWPF_TRUECOLOR555
:

357  
	`COLOR2PIXEL555
(
c
);

359 
MWPF_TRUECOLOR332
:

362  
	`COLOR2PIXEL332
(
c
);

368  
	`GdFödNóª°Cﬁ‹
(
gr_∑Àâe
, ()
gr_ncﬁ‹s
, 
c
);

369 
	}
}

379 
MWPIXELVAL


380 
	$GdFödNóª°Cﬁ‹
(
MWPALENTRY
 *
∑l
, 
size
, 
MWCOLORVAL
 
¸
)

382 
MWPALENTRY
 * 
rgb
;

383 
r
, 
g
, 
b
;

384 
R
, 
G
, 
B
;

385 
diff
 = 0x7fffffffL;

386 
sq
;

387 
be°
 = 0;

389 
r
 = 
	`REDVALUE
(
¸
);

390 
g
 = 
	`GREENVALUE
(
¸
);

391 
b
 = 
	`BLUEVALUE
(
¸
);

392 
rgb
=
∑l
; 
diff
 &&Ñgb < &∑l[
size
]; ++rgb) {

393 
R
 = 
rgb
->
r
 -Ñ;

394 
G
 = 
rgb
->
g
 - g;

395 
B
 = 
rgb
->
b
 - b;

398 
sq
 = 
	`abs
(
R
Ë+ábs(
G
Ë+ábs(
B
);

403 
sq
 = ()
R
*R*30*30 + ()
G
*G*59*59 + ()
B
*B*11*11;

406 if(
sq
 < 
diff
) {

407 
be°
 = 
rgb
 - 
∑l
;

408 if((
diff
 = 
sq
) == 0)

409  
be°
;

412  
be°
;

413 
	}
}

422 
MWCOLORVAL


423 
	$GdGëCﬁ‹RGB
(
PSD
 
psd
, 
MWPIXELVAL
 
pixñ
)

425 
psd
->
pixty≥
) {

426 
MWPF_TRUECOLOR8888
:

427  
	`PIXEL8888TOCOLORVAL
(
pixñ
);

429 
MWPF_TRUECOLOR0888
:

430  
	`PIXEL888TOCOLORVAL
(
pixñ
);

432 
MWPF_TRUECOLOR888
:

433  
	`PIXEL888TOCOLORVAL
(
pixñ
);

435 
MWPF_TRUECOLOR565
:

436  
	`PIXEL565TOCOLORVAL
(
pixñ
);

438 
MWPF_TRUECOLOR555
:

439  
	`PIXEL555TOCOLORVAL
(
pixñ
);

441 
MWPF_TRUECOLOR332
:

442  
	`PIXEL332TOCOLORVAL
(
pixñ
);

444 
MWPF_PALETTE
:

445  
	`GETPALENTRY
(
gr_∑Àâe
, 
pixñ
);

448 #i‡! 
PSP


449 
	`as£π
(
FALSE
);

453 
	}
}

455 #i‡!
VXWORKS


456 #i‡
deföed
(
HAVE_FILEIO
)

457 
	~<uni°d.h
>

458 
	~<f˙é.h
>

464 
	#BI_RGB
 0L

	)

465 
	#BI_RLE8
 1L

	)

466 
	#BI_RLE4
 2L

	)

467 
	#BI_BITFIELDS
 3L

	)

469 
	tBYTE
;

470 
	tWORD
;

471 
	tDWORD
;

472 
	tLONG
;

474 #¥agm®
∑ck
(1)

478 
BYTE
 
	mbfTy≥
[2];

479 
DWORD
 
	mbfSize
;

480 
WORD
 
	mbfRe£rved1
;

481 
WORD
 
	mbfRe£rved2
;

482 
DWORD
 
	mbfOffBôs
;

484 
DWORD
 
	mBiSize
;

485 
LONG
 
	mBiWidth
;

486 
LONG
 
	mBiHeight
;

487 
WORD
 
	mBiPœ√s
;

488 
WORD
 
	mBiBôCou¡
;

489 
DWORD
 
	mBiCom¥essi⁄
;

490 
DWORD
 
	mBiSizeImage
;

491 
LONG
 
	mBiX≥lsPîMëî
;

492 
LONG
 
	mBiY≥lsPîMëî
;

493 
DWORD
 
	mBiCÃU£d
;

494 
DWORD
 
	mBiCÃImp‹è¡
;

495 } 
	tBMPHEAD
;

496 #¥agm®
∑ck
()

499 
	#RMASK332
 0xe0

	)

500 
	#GMASK332
 0x1c

	)

501 
	#BMASK332
 0x03

	)

502 
	#RMASK555
 0x7c00

	)

503 
	#GMASK555
 0x03e0

	)

504 
	#BMASK555
 0x001f

	)

505 
	#RMASK565
 0xf800

	)

506 
	#GMASK565
 0x07e0

	)

507 
	#BMASK565
 0x001f

	)

508 
	#RMASK888
 0xff0000

	)

509 
	#GMASK888
 0x00ff00

	)

510 
	#BMASK888
 0x0000ff

	)

513 
	$putsw
(
dw
, 
FILE
 *
oÂ
)

516 
	`putc
(()
dw
, 
oÂ
);

517 
dw
 >>= 8;

518 
	`putc
(()
dw
, 
oÂ
);

519 
	}
}

522 
	$putdw
(
dw
, 
FILE
 *
oÂ
)

525 
	`putc
(()
dw
, 
oÂ
);

526 
dw
 >>= 8;

527 
	`putc
(()
dw
, 
oÂ
);

528 
dw
 >>= 8;

529 
	`putc
(()
dw
, 
oÂ
);

530 
dw
 >>= 8;

531 
	`putc
(()
dw
, 
oÂ
);

532 
	}
}

542 
	$GdC≠tuªS¸ìn
(*
∑th
)

544 #i‡
	`deföed
(
HAVE_FILEIO
)

545 
ifd
, 
i
, 
j
;

546 
FILE
 * 
oÂ
;

547 
cx
, 
cy
, 
exåa
, 
bµ
, 
byã•p
, 
ncﬁ‹s
, 
sizecﬁ‹èbÀ
;

548 
rmask
, 
gmask
, 
bmask
;

549 *
˝å
;

550 *
•å
;

551 *
Õå
;

552 
BMPHEAD
 
bmp
;

553 
buf
[2048*4];

555 
oÂ
 = 
	`f›í
(
∑th
, "wb");

556 i‡(!
oÂ
)

558 
ifd
 = 
	`›í
("/dev/fb0", 0);

560 
cx
 = 
s¸dev
.
xvúåes
;

561 
cy
 = 
s¸dev
.
yvúåes
;

562 
bµ
 = 
s¸dev
.bpp;

563 
byã•p
 = (
bµ
+7)/8;

566 
exåa
 = (
cx
*
byã•p
) & 3;

567 i‡(
exåa
)

568 
exåa
 = 4 -Éxtra;

569 
ncﬁ‹s
 = (
bµ
 <= 8)? (1<<bpp): 0;

571 
sizecﬁ‹èbÀ
 = 
ncﬁ‹s
?Çcolors*4: 3*4;

572 i‡(
bµ
 == 24)

573 
sizecﬁ‹èbÀ
 = 0;

576 
	`mem£t
(&
bmp
, 0, (bmp));

577 
bmp
.
bfTy≥
[0] = 'B';

578 
bmp
.
bfTy≥
[1] = 'M';

579 
bmp
.
bfSize
 = 
	`dwsw≠
((bmpË+ 
sizecﬁ‹èbÀ
 + ()(
cx
+
exåa
)*
cy
*
byã•p
);

580 
bmp
.
bfOffBôs
 = 
	`dwsw≠
((bmpË+ 
sizecﬁ‹èbÀ
);

581 
bmp
.
BiSize
 = 
	`dwsw≠
(40);

582 
bmp
.
BiWidth
 = 
	`dwsw≠
(
cx
);

583 
bmp
.
BiHeight
 = 
	`dwsw≠
(
cy
);

584 
bmp
.
BiPœ√s
 = 
	`wsw≠
(1);

585 
bmp
.
BiBôCou¡
 = 
	`wsw≠
(
bµ
);

586 
bmp
.
BiCom¥essi⁄
 = 
	`dwsw≠
((
bµ
==16 || bµ==32)? 
BI_BITFIELDS
: 
BI_RGB
);

587 
bmp
.
BiSizeImage
 = 
	`dwsw≠
(()(
cx
+
exåa
)*
cy
*
byã•p
);

588 
bmp
.
BiCÃU£d
 = 
	`dwsw≠
((
bµ
 <8)? 
ncﬁ‹s
: 0);

592 
	`fwrôe
(&
bmp
, (bmp), 1, 
oÂ
);

595 i‡(
sizecﬁ‹èbÀ
) {

596 if(
bµ
 <= 8) {

598 
i
=0; i<
ncﬁ‹s
; i++) {

599 
	`putc
(
gr_∑Àâe
[
i
].
b
, 
oÂ
);

600 
	`putc
(
gr_∑Àâe
[
i
].
g
, 
oÂ
);

601 
	`putc
(
gr_∑Àâe
[
i
].
r
, 
oÂ
);

602 
	`putc
(0, 
oÂ
);

606 
gr_pixty≥
) {

607 
MWPF_TRUECOLOR8888
:

608 
MWPF_TRUECOLOR0888
:

610 
rmask
 = 
RMASK888
;

611 
gmask
 = 
GMASK888
;

612 
bmask
 = 
BMASK888
;

614 
MWPF_TRUECOLOR565
:

615 
rmask
 = 
RMASK565
;

616 
gmask
 = 
GMASK565
;

617 
bmask
 = 
BMASK565
;

619 
MWPF_TRUECOLOR555
:

620 
rmask
 = 
RMASK555
;

621 
gmask
 = 
GMASK555
;

622 
bmask
 = 
BMASK555
;

624 
MWPF_TRUECOLOR332
:

625 
rmask
 = 
RMASK332
;

626 
gmask
 = 
GMASK332
;

627 
bmask
 = 
BMASK332
;

630 
	`putdw
(
rmask
, 
oÂ
);

631 
	`putdw
(
gmask
, 
oÂ
);

632 
	`putdw
(
bmask
, 
oÂ
);

637 
i
=
cy
-1; i>=0; --i) {

638 
ba£
 = (
bmp
Ë+ 
sizecﬁ‹èbÀ
 + ()
i
*
cx
*
byã•p
;

639 
	`f£ek
(
oÂ
, 
ba£
, 
SEEK_SET
);

640 
	`ªad
(
ifd
, 
buf
, 
cx
*
byã•p
);

641 
bµ
) {

643 
Õå
 = (*)
buf
;

644 
j
=0; j<
cx
; ++j)

645 
	`putdw
(*
Õå
++, 
oÂ
);

648 
˝å
 = (*)
buf
;

649 
j
=0; j<
cx
; ++j) {

650 
	`putc
(*
˝å
++, 
oÂ
);

651 
	`putc
(*
˝å
++, 
oÂ
);

652 
	`putc
(*
˝å
++, 
oÂ
);

656 
•å
 = (*)
buf
;

657 
j
=0; j<
cx
; ++j)

658 
	`putsw
(*
•å
++, 
oÂ
);

661 
˝å
 = (*)
buf
;

662 
j
=0; j<
cx
; ++j)

663 
	`putc
(*
˝å
++, 
oÂ
);

666 
j
=0; j<
exåa
; ++j)

667 
	`putc
(0, 
oÂ
);

670 
	`f˛o£
(
oÂ
);

671 
	`˛o£
(
ifd
);

674 
	}
}

	@engine/devpal1.c

6 
	~"devi˚.h
"

11 
MWPALENTRY
 
	gmw°d∑l1
[2] = {

12 
RGBDEF
( 0 , 0 , 0 ),

13 
RGBDEF
( 255, 255, 255 )

	@engine/devpal2.c

6 
	~"devi˚.h
"

13 
MWPALENTRY
 
	gmw°d∑l2
[4] = {

14 
RGBDEF
( 255, 255, 255 ),

15 
RGBDEF
( 192, 192, 192 ),

16 
RGBDEF
( 128, 128, 128 ),

17 
RGBDEF
( 0 , 0 , 0 )

	@engine/devpal4.c

6 
	~"devi˚.h
"

11 
MWPALENTRY
 
	gmw°d∑l4
[16] = {

13 
RGBDEF
( 0 , 0 , 0 ),

14 
RGBDEF
( 0 , 0 , 128 ),

15 
RGBDEF
( 0 , 128, 0 ),

16 
RGBDEF
( 0 , 128, 128 ),

17 
RGBDEF
( 128, 0 , 0 ),

18 
RGBDEF
( 128, 0 , 128 ),

19 
RGBDEF
( 128, 64 , 0 ),

20 
RGBDEF
( 192, 192, 192 ),

21 
RGBDEF
( 128, 128, 128 ),

22 
RGBDEF
( 0 , 0 , 255 ),

23 
RGBDEF
( 0 , 255, 0 ),

24 
RGBDEF
( 0 , 255, 255 ),

25 
RGBDEF
( 255, 0 , 0 ),

26 
RGBDEF
( 255, 0 , 255 ),

27 
RGBDEF
( 255, 255, 0 ),

28 
RGBDEF
( 255, 255, 255 ),

	@engine/devpal8.c

6 
	~"devi˚.h
"

13 
MWPALENTRY
 
	gmw°d∑l8
[256] = {

15 
RGBDEF
( 0 , 0 , 0 ),

16 
RGBDEF
( 0 , 0 , 128 ),

17 
RGBDEF
( 0 , 128, 0 ),

18 
RGBDEF
( 0 , 128, 128 ),

19 
RGBDEF
( 128, 0 , 0 ),

20 
RGBDEF
( 128, 0 , 128 ),

21 
RGBDEF
( 128, 64 , 0 ),

22 
RGBDEF
( 192, 192, 192 ),

23 
RGBDEF
( 128, 128, 128 ),

24 
RGBDEF
( 0 , 0 , 255 ),

25 
RGBDEF
( 0 , 255, 0 ),

26 
RGBDEF
( 0 , 255, 255 ),

27 
RGBDEF
( 255, 0 , 0 ),

28 
RGBDEF
( 255, 0 , 255 ),

29 
RGBDEF
( 255, 255, 0 ),

30 
RGBDEF
( 255, 255, 255 ),

33 
RGBDEF
( 32 , 32 , 32 ),

34 
RGBDEF
( 128, 128, 0 ),

35 
RGBDEF
( 223, 223, 223 ),

36 
RGBDEF
( 160, 160, 160 ),

38 
RGBDEF
( 234, 230, 221 ),

39 
RGBDEF
( 213, 204, 187 ),

40 
RGBDEF
( 162, 141, 104 ),

41 
RGBDEF
( 0 , 64 , 128 ),

46 
RGBDEF
( 0 , 128, 255 ),

47 
RGBDEF
( 0 , 255, 128 ),

48 
RGBDEF
( 64 , 0 , 0 ),

49 
RGBDEF
( 64 , 0 , 64 ),

50 
RGBDEF
( 64 , 0 , 128 ),

51 
RGBDEF
( 64 , 128, 128 ),

52 
RGBDEF
( 128, 0 , 64 ),

53 
RGBDEF
( 128, 0 , 255 ),

54 
RGBDEF
( 128, 64 , 64 ),

55 
RGBDEF
( 128, 128, 64 ),

56 
RGBDEF
( 128, 128, 192 ),

57 
RGBDEF
( 128, 128, 255 ),

58 
RGBDEF
( 128, 255, 0 ),

59 
RGBDEF
( 128, 255, 255 ),

60 
RGBDEF
( 164, 200, 240 ),

61 
RGBDEF
( 192, 220, 192 ),

62 
RGBDEF
( 255, 0 , 128 ),

63 
RGBDEF
( 255, 128, 0 ),

64 
RGBDEF
( 255, 128, 192 ),

65 
RGBDEF
( 255, 128, 255 ),

66 
RGBDEF
( 255, 128, 128 ),

67 
RGBDEF
( 255, 255, 128 ),

68 
RGBDEF
( 255, 251, 240 ),

69 
RGBDEF
( 255, 255, 232 ),

74 
RGBDEF
( 0x00, 0x00, 0x33 ),

75 
RGBDEF
( 0x00, 0x00, 0x66 ),

76 
RGBDEF
( 0x00, 0x00, 0x99 ),

77 
RGBDEF
( 0x00, 0x00, 0xcc ),

79 
RGBDEF
( 0x33, 0x00, 0x00 ),

80 
RGBDEF
( 0x33, 0x00, 0x33 ),

81 
RGBDEF
( 0x33, 0x00, 0x66 ),

82 
RGBDEF
( 0x33, 0x00, 0x99 ),

83 
RGBDEF
( 0x33, 0x00, 0xcc ),

84 
RGBDEF
( 0x33, 0x00, 0xff ),

85 
RGBDEF
( 0x66, 0x00, 0x00 ),

86 
RGBDEF
( 0x66, 0x00, 0x33 ),

87 
RGBDEF
( 0x66, 0x00, 0x66 ),

88 
RGBDEF
( 0x66, 0x00, 0x99 ),

89 
RGBDEF
( 0x66, 0x00, 0xcc ),

90 
RGBDEF
( 0x66, 0x00, 0xff ),

91 
RGBDEF
( 0x99, 0x00, 0x00 ),

92 
RGBDEF
( 0x99, 0x00, 0x33 ),

93 
RGBDEF
( 0x99, 0x00, 0x66 ),

94 
RGBDEF
( 0x99, 0x00, 0x99 ),

95 
RGBDEF
( 0x99, 0x00, 0xcc ),

96 
RGBDEF
( 0x99, 0x00, 0xff ),

97 
RGBDEF
( 0xcc, 0x00, 0x00 ),

98 
RGBDEF
( 0xcc, 0x00, 0x33 ),

99 
RGBDEF
( 0xcc, 0x00, 0x66 ),

100 
RGBDEF
( 0xcc, 0x00, 0x99 ),

101 
RGBDEF
( 0xcc, 0x00, 0xcc ),

102 
RGBDEF
( 0xcc, 0x00, 0xff ),

104 
RGBDEF
( 0xff, 0x00, 0x33 ),

105 
RGBDEF
( 0xff, 0x00, 0x66 ),

106 
RGBDEF
( 0xff, 0x00, 0x99 ),

107 
RGBDEF
( 0xff, 0x00, 0xcc ),

109 
RGBDEF
( 0x00, 0x33, 0x00 ),

110 
RGBDEF
( 0x00, 0x33, 0x33 ),

111 
RGBDEF
( 0x00, 0x33, 0x66 ),

112 
RGBDEF
( 0x00, 0x33, 0x99 ),

113 
RGBDEF
( 0x00, 0x33, 0xcc ),

114 
RGBDEF
( 0x00, 0x33, 0xff ),

115 
RGBDEF
( 0x33, 0x33, 0x00 ),

116 
RGBDEF
( 0x33, 0x33, 0x33 ),

117 
RGBDEF
( 0x33, 0x33, 0x66 ),

118 
RGBDEF
( 0x33, 0x33, 0x99 ),

119 
RGBDEF
( 0x33, 0x33, 0xcc ),

120 
RGBDEF
( 0x33, 0x33, 0xff ),

121 
RGBDEF
( 0x66, 0x33, 0x00 ),

122 
RGBDEF
( 0x66, 0x33, 0x33 ),

123 
RGBDEF
( 0x66, 0x33, 0x66 ),

124 
RGBDEF
( 0x66, 0x33, 0x99 ),

125 
RGBDEF
( 0x66, 0x33, 0xcc ),

126 
RGBDEF
( 0x66, 0x33, 0xff ),

127 
RGBDEF
( 0x99, 0x33, 0x00 ),

128 
RGBDEF
( 0x99, 0x33, 0x33 ),

129 
RGBDEF
( 0x99, 0x33, 0x66 ),

130 
RGBDEF
( 0x99, 0x33, 0x99 ),

131 
RGBDEF
( 0x99, 0x33, 0xcc ),

132 
RGBDEF
( 0x99, 0x33, 0xff ),

133 
RGBDEF
( 0xcc, 0x33, 0x00 ),

134 
RGBDEF
( 0xcc, 0x33, 0x33 ),

135 
RGBDEF
( 0xcc, 0x33, 0x66 ),

136 
RGBDEF
( 0xcc, 0x33, 0x99 ),

137 
RGBDEF
( 0xcc, 0x33, 0xcc ),

138 
RGBDEF
( 0xcc, 0x33, 0xff ),

139 
RGBDEF
( 0xff, 0x33, 0x00 ),

140 
RGBDEF
( 0xff, 0x33, 0x33 ),

141 
RGBDEF
( 0xff, 0x33, 0x66 ),

142 
RGBDEF
( 0xff, 0x33, 0x99 ),

143 
RGBDEF
( 0xff, 0x33, 0xcc ),

144 
RGBDEF
( 0xff, 0x33, 0xff ),

145 
RGBDEF
( 0x00, 0x66, 0x00 ),

146 
RGBDEF
( 0x00, 0x66, 0x33 ),

147 
RGBDEF
( 0x00, 0x66, 0x66 ),

148 
RGBDEF
( 0x00, 0x66, 0x99 ),

149 
RGBDEF
( 0x00, 0x66, 0xcc ),

150 
RGBDEF
( 0x00, 0x66, 0xff ),

151 
RGBDEF
( 0x33, 0x66, 0x00 ),

152 
RGBDEF
( 0x33, 0x66, 0x33 ),

153 
RGBDEF
( 0x33, 0x66, 0x66 ),

154 
RGBDEF
( 0x33, 0x66, 0x99 ),

155 
RGBDEF
( 0x33, 0x66, 0xcc ),

156 
RGBDEF
( 0x33, 0x66, 0xff ),

157 
RGBDEF
( 0x66, 0x66, 0x00 ),

158 
RGBDEF
( 0x66, 0x66, 0x33 ),

159 
RGBDEF
( 0x66, 0x66, 0x66 ),

160 
RGBDEF
( 0x66, 0x66, 0x99 ),

161 
RGBDEF
( 0x66, 0x66, 0xcc ),

162 
RGBDEF
( 0x66, 0x66, 0xff ),

163 
RGBDEF
( 0x99, 0x66, 0x00 ),

164 
RGBDEF
( 0x99, 0x66, 0x33 ),

165 
RGBDEF
( 0x99, 0x66, 0x66 ),

166 
RGBDEF
( 0x99, 0x66, 0x99 ),

167 
RGBDEF
( 0x99, 0x66, 0xcc ),

168 
RGBDEF
( 0x99, 0x66, 0xff ),

169 
RGBDEF
( 0xcc, 0x66, 0x00 ),

170 
RGBDEF
( 0xcc, 0x66, 0x33 ),

171 
RGBDEF
( 0xcc, 0x66, 0x66 ),

172 
RGBDEF
( 0xcc, 0x66, 0x99 ),

173 
RGBDEF
( 0xcc, 0x66, 0xcc ),

174 
RGBDEF
( 0xcc, 0x66, 0xff ),

175 
RGBDEF
( 0xff, 0x66, 0x00 ),

176 
RGBDEF
( 0xff, 0x66, 0x33 ),

177 
RGBDEF
( 0xff, 0x66, 0x66 ),

178 
RGBDEF
( 0xff, 0x66, 0x99 ),

179 
RGBDEF
( 0xff, 0x66, 0xcc ),

180 
RGBDEF
( 0xff, 0x66, 0xff ),

181 
RGBDEF
( 0x00, 0x99, 0x00 ),

182 
RGBDEF
( 0x00, 0x99, 0x33 ),

183 
RGBDEF
( 0x00, 0x99, 0x66 ),

184 
RGBDEF
( 0x00, 0x99, 0x99 ),

185 
RGBDEF
( 0x00, 0x99, 0xcc ),

186 
RGBDEF
( 0x00, 0x99, 0xff ),

187 
RGBDEF
( 0x33, 0x99, 0x00 ),

188 
RGBDEF
( 0x33, 0x99, 0x33 ),

189 
RGBDEF
( 0x33, 0x99, 0x66 ),

190 
RGBDEF
( 0x33, 0x99, 0x99 ),

191 
RGBDEF
( 0x33, 0x99, 0xcc ),

192 
RGBDEF
( 0x33, 0x99, 0xff ),

193 
RGBDEF
( 0x66, 0x99, 0x00 ),

194 
RGBDEF
( 0x66, 0x99, 0x33 ),

195 
RGBDEF
( 0x66, 0x99, 0x66 ),

196 
RGBDEF
( 0x66, 0x99, 0x99 ),

197 
RGBDEF
( 0x66, 0x99, 0xcc ),

198 
RGBDEF
( 0x66, 0x99, 0xff ),

199 
RGBDEF
( 0x99, 0x99, 0x00 ),

200 
RGBDEF
( 0x99, 0x99, 0x33 ),

201 
RGBDEF
( 0x99, 0x99, 0x66 ),

202 
RGBDEF
( 0x99, 0x99, 0x99 ),

203 
RGBDEF
( 0x99, 0x99, 0xcc ),

204 
RGBDEF
( 0x99, 0x99, 0xff ),

205 
RGBDEF
( 0xcc, 0x99, 0x00 ),

206 
RGBDEF
( 0xcc, 0x99, 0x33 ),

207 
RGBDEF
( 0xcc, 0x99, 0x66 ),

208 
RGBDEF
( 0xcc, 0x99, 0x99 ),

209 
RGBDEF
( 0xcc, 0x99, 0xcc ),

210 
RGBDEF
( 0xcc, 0x99, 0xff ),

211 
RGBDEF
( 0xff, 0x99, 0x00 ),

212 
RGBDEF
( 0xff, 0x99, 0x33 ),

213 
RGBDEF
( 0xff, 0x99, 0x66 ),

214 
RGBDEF
( 0xff, 0x99, 0x99 ),

215 
RGBDEF
( 0xff, 0x99, 0xcc ),

216 
RGBDEF
( 0xff, 0x99, 0xff ),

217 
RGBDEF
( 0x00, 0xcc, 0x00 ),

218 
RGBDEF
( 0x00, 0xcc, 0x33 ),

219 
RGBDEF
( 0x00, 0xcc, 0x66 ),

220 
RGBDEF
( 0x00, 0xcc, 0x99 ),

221 
RGBDEF
( 0x00, 0xcc, 0xcc ),

222 
RGBDEF
( 0x00, 0xcc, 0xff ),

223 
RGBDEF
( 0x33, 0xcc, 0x00 ),

224 
RGBDEF
( 0x33, 0xcc, 0x33 ),

225 
RGBDEF
( 0x33, 0xcc, 0x66 ),

226 
RGBDEF
( 0x33, 0xcc, 0x99 ),

227 
RGBDEF
( 0x33, 0xcc, 0xcc ),

228 
RGBDEF
( 0x33, 0xcc, 0xff ),

229 
RGBDEF
( 0x66, 0xcc, 0x00 ),

230 
RGBDEF
( 0x66, 0xcc, 0x33 ),

231 
RGBDEF
( 0x66, 0xcc, 0x66 ),

232 
RGBDEF
( 0x66, 0xcc, 0x99 ),

233 
RGBDEF
( 0x66, 0xcc, 0xcc ),

234 
RGBDEF
( 0x66, 0xcc, 0xff ),

235 
RGBDEF
( 0x99, 0xcc, 0x00 ),

236 
RGBDEF
( 0x99, 0xcc, 0x33 ),

237 
RGBDEF
( 0x99, 0xcc, 0x66 ),

238 
RGBDEF
( 0x99, 0xcc, 0x99 ),

239 
RGBDEF
( 0x99, 0xcc, 0xcc ),

240 
RGBDEF
( 0x99, 0xcc, 0xff ),

241 
RGBDEF
( 0xcc, 0xcc, 0x00 ),

242 
RGBDEF
( 0xcc, 0xcc, 0x33 ),

243 
RGBDEF
( 0xcc, 0xcc, 0x66 ),

244 
RGBDEF
( 0xcc, 0xcc, 0x99 ),

245 
RGBDEF
( 0xcc, 0xcc, 0xcc ),

246 
RGBDEF
( 0xcc, 0xcc, 0xff ),

247 
RGBDEF
( 0xff, 0xcc, 0x00 ),

248 
RGBDEF
( 0xff, 0xcc, 0x33 ),

249 
RGBDEF
( 0xff, 0xcc, 0x66 ),

250 
RGBDEF
( 0xff, 0xcc, 0x99 ),

251 
RGBDEF
( 0xff, 0xcc, 0xcc ),

252 
RGBDEF
( 0xff, 0xcc, 0xff ),

254 
RGBDEF
( 0x00, 0xff, 0x33 ),

255 
RGBDEF
( 0x00, 0xff, 0x66 ),

256 
RGBDEF
( 0x00, 0xff, 0x99 ),

257 
RGBDEF
( 0x00, 0xff, 0xcc ),

259 
RGBDEF
( 0x33, 0xff, 0x00 ),

260 
RGBDEF
( 0x33, 0xff, 0x33 ),

261 
RGBDEF
( 0x33, 0xff, 0x66 ),

262 
RGBDEF
( 0x33, 0xff, 0x99 ),

263 
RGBDEF
( 0x33, 0xff, 0xcc ),

264 
RGBDEF
( 0x33, 0xff, 0xff ),

265 
RGBDEF
( 0x66, 0xff, 0x00 ),

266 
RGBDEF
( 0x66, 0xff, 0x33 ),

267 
RGBDEF
( 0x66, 0xff, 0x66 ),

268 
RGBDEF
( 0x66, 0xff, 0x99 ),

269 
RGBDEF
( 0x66, 0xff, 0xcc ),

270 
RGBDEF
( 0x66, 0xff, 0xff ),

271 
RGBDEF
( 0x99, 0xff, 0x00 ),

272 
RGBDEF
( 0x99, 0xff, 0x33 ),

273 
RGBDEF
( 0x99, 0xff, 0x66 ),

274 
RGBDEF
( 0x99, 0xff, 0x99 ),

275 
RGBDEF
( 0x99, 0xff, 0xcc ),

276 
RGBDEF
( 0x99, 0xff, 0xff ),

277 
RGBDEF
( 0xcc, 0xff, 0x00 ),

278 
RGBDEF
( 0xcc, 0xff, 0x33 ),

279 
RGBDEF
( 0xcc, 0xff, 0x66 ),

280 
RGBDEF
( 0xcc, 0xff, 0x99 ),

281 
RGBDEF
( 0xcc, 0xff, 0xcc ),

282 
RGBDEF
( 0xcc, 0xff, 0xff ),

284 
RGBDEF
( 0xff, 0xff, 0x33 ),

285 
RGBDEF
( 0xff, 0xff, 0x66 ),

286 
RGBDEF
( 0xff, 0xff, 0x99 ),

287 
RGBDEF
( 0xff, 0xff, 0xcc ),

291 #i‡
TEST


292 
	$maö
()

294 
c
;

296 
	`DPRINTF
("%d\n", (()&
°d∑Àâe
[1]) - ()&stdpalette[0]);

298 
c
 = 
	`FödNóª°Cﬁ‹
(
°d∑Àâe
, 224, 224, 224);

299 
	`DPRINTF
("%d = %02x %02x %02x\n", 
c
, 
°d∑Àâe
[c].
r
, std∑Àâe[c].
g
,

300 
°d∑Àâe
[
c
].
b
);

301 
	}
}

	@engine/devpalgray4.c

4 
	~"devi˚.h
"

6 
MWPALENTRY
 
	gmw°d∑l4
[16] = {

7 
RGBDEF
( 0, 0, 0 ),

8 
RGBDEF
( 17, 17, 17 ),

9 
RGBDEF
( 34, 34, 34 ),

10 
RGBDEF
( 51, 51, 51 ),

11 
RGBDEF
( 68, 68, 68 ),

12 
RGBDEF
( 85, 85, 85 ),

13 
RGBDEF
( 102, 102, 102 ),

14 
RGBDEF
( 119, 119, 119 ),

15 
RGBDEF
( 136, 136, 136 ),

16 
RGBDEF
( 153, 153, 153 ),

17 
RGBDEF
( 170, 170, 170 ),

18 
RGBDEF
( 187, 187, 187 ),

19 
RGBDEF
( 204, 204, 204 ),

20 
RGBDEF
( 221, 221, 221 ),

21 
RGBDEF
( 238, 238, 238 ),

22 
RGBDEF
( 255, 255, 255 )

	@engine/devpoly.c

1 
	~<°dio.h
>

2 
	~<°dlib.h
>

3 
	~"devi˚.h
"

27 
	#EDGEPOLYFILL
 1

	)

28 
	#X11POLYFILL
 0

	)

29 
	#BASICPOLYFILL
 0

	)

32 
døwpoöt
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

33 
døwrow
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
x2
,MWCOORD 
y
);

34 
gr_mode
;

35 
gr_fûlmode
;

49 
	$GdPﬁy
(
PSD
 
psd
, 
cou¡
, 
MWPOINT
 *
poöts
)

51 
MWCOORD
 
fú°x
;

52 
MWCOORD
 
fú°y
;

53 
MWBOOL
 
didlöe
;

55 i‡(
cou¡
 < 2)

57 
fú°x
 = 
poöts
->
x
;

58 
fú°y
 = 
poöts
->
y
;

59 
didlöe
 = 
FALSE
;

61 
cou¡
-- > 1) {

62 i‡(
didlöe
 && (
gr_mode
 =
MWMODE_XOR
))

63 
	`døwpoöt
(
psd
, 
poöts
->
x
,Öoöts->
y
);

65 
	`GdLöe
(
psd
, 
poöts
[0].
x
,Öoöts[0].
y
,Öoöts[1].x,Öoöts[1].y, 
TRUE
);

66 
poöts
++;

67 
didlöe
 = 
TRUE
;

69 i‡(
gr_mode
 =
MWMODE_XOR
) {

70 
poöts
--;

71 i‡(
poöts
->
x
 =
fú°x
 &&Öoöts->
y
 =
fú°y
)

72 
	`døwpoöt
(
psd
, 
poöts
->
x
,Öoöts->
y
);

74 
	`GdFixCurs‹
(
psd
);

75 
	}
}

77 #i‡
X11POLYFILL


162 
	#BRESINITPGON
(
dy
, 
x1
, 
x2
, 
xSèπ
, 
d
, 
m
, 
m1
, 
ö¸1
, 
ö¸2
) { \

163 
dx
; \

169 i‡((
dy
) != 0) { \

170 
xSèπ
 = (
x1
); \

171 
dx
 = (
x2
Ë- 
xSèπ
; \

172 i‡(
dx
 < 0) { \

173 
m
 = 
dx
 / (
dy
); \

174 
m1
 = 
m
 - 1; \

175 
ö¸1
 = -2 * 
dx
 + 2 * (
dy
Ë* 
m1
; \

176 
ö¸2
 = -2 * 
dx
 + 2 * (
dy
Ë* 
m
; \

177 
d
 = 2 * 
m
 * (
dy
Ë- 2 * 
dx
 - 2 * (dy); \

179 
m
 = 
dx
 / (
dy
); \

180 
m1
 = 
m
 + 1; \

181 
ö¸1
 = 2 * 
dx
 - 2 * (
dy
Ë* 
m1
; \

182 
ö¸2
 = 2 * 
dx
 - 2 * (
dy
Ë* 
m
; \

183 
d
 = -2 * 
m
 * (
dy
Ë+ 2 * 
dx
; \

186 }

	)

188 
	#BRESINCRPGON
(
d
, 
mövÆ
, 
m
, 
m1
, 
ö¸1
, 
ö¸2
) { \

189 i‡(
m1
 > 0) { \

190 i‡(
d
 > 0) { \

191 
mövÆ
 +
m1
; \

192 
d
 +
ö¸1
; \

195 
mövÆ
 +
m
; \

196 
d
 +
ö¸2
; \

199 i‡(
d
 >= 0) { \

200 
mövÆ
 +
m1
; \

201 
d
 +
ö¸1
; \

204 
mövÆ
 +
m
; \

205 
d
 +
ö¸2
; \

208 }

	)

214 
	$gëPﬁyYBounds
(
MWPOINT
 *
±s
, 
n
, *
by
, *
ty
)

216 
MWPOINT
 *
±Mö
;

217 
ymö
, 
ymax
;

218 
MWPOINT
 *
±sSèπ
 = 
±s
;

220 
±Mö
 = 
±s
;

221 
ymö
 = 
ymax
 = (
±s
++)->
y
;

223 --
n
 > 0) {

224 i‡(
±s
->
y
 < 
ymö
)

226 
±Mö
 = 
±s
;

227 
ymö
 = 
±s
->
y
;

229 if(
±s
->
y
 > 
ymax
)

230 
ymax
 = 
±s
->
y
;

232 
±s
++;

235 *
by
 = 
ymö
;

236 *
ty
 = 
ymax
;

237 (
±Mö
-
±sSèπ
);

238 
	}
}

241 
	$gëPﬁyXBounds
(
MWPOINT
 *
±s
, 
n
, *
bx
, *
tx
)

243 
MWPOINT
 *
±Mö
;

244 
xmö
, 
xmax
;

245 
MWPOINT
 *
±sSèπ
 = 
±s
;

247 
±Mö
 = 
±s
;

248 
xmö
 = 
xmax
 = (
±s
++)->
x
;

250 --
n
 > 0) {

251 i‡(
±s
->
x
 < 
xmö
)

253 
±Mö
 = 
±s
;

254 
xmö
 = 
±s
->
x
;

256 if(
±s
->
x
 > 
xmax
)

257 
xmax
 = 
±s
->
x
;

259 
±s
++;

262 *
bx
 = 
xmö
;

263 *
tx
 = 
xmax
;

264 (
±Mö
-
±sSèπ
);

265 
	}
}

268 
	$GdFûlPﬁy
(
PSD
 
psd
, 
cou¡
, 
MWPOINT
 *
poöâabÀ
)

270 
MWCOORD
 
xl
 = 0, 
xr
 = 0;

271 
dl
 = 0, 
dr
 = 0;

272 
ml
 = 0, 
m1l
 = 0;

273 
mr
 = 0, 
m1r
 = 0;

274 
ö¸1l
 = 0, 
ö¸2l
 = 0;

275 
ö¸1r
 = 0, 
ö¸2r
 = 0;

276 
dy
;

277 
MWCOORD
 
y
;

278 
À·
, 
right
;

279 
i
;

280 
√xée·
, 
√xåight
;

281 
MWPOINT
 *
±sOut
, *
Fú°Poöt
;

282 
MWCOORD
 *
width
, *
Fú°Width
;

283 
imö
;

284 
ymö
;

285 
ymax
;

292 
imö
 = 
	`gëPﬁyYBounds
(
poöâabÀ
, 
cou¡
, &
ymö
, &
ymax
);

294 i‡(
gr_fûlmode
 !
MWFILL_SOLID
) {

295 
xmö
, 
xmax
;

296 
	`gëPﬁyXBounds
(
poöâabÀ
, 
cou¡
, &
xmö
, &
xmax
);

297 
	`£t_ts_‹igö
(
xmö
, 
ymö
);

300 
dy
 = 
ymax
 - 
ymö
 + 1;

301 i‡((
cou¡
 < 3Ë|| (
dy
 < 0))

303 
±sOut
 = 
Fú°Poöt
 = (
MWPOINT
 *)
	`ALLOCA
((MWPOINTË* 
dy
);

304 
width
 = 
Fú°Width
 = (
MWCOORD
 *)
	`ALLOCA
((MWCOORDË* 
dy
);

305 if(!
Fú°Poöt
 || !
Fú°Width
)

307 i‡(
Fú°Width
Ë
	`FREEA
(FirstWidth);

308 i‡(
Fú°Poöt
Ë
	`FREEA
(FirstPoint);

312 
√xée·
 = 
√xåight
 = 
imö
;

313 
y
 = 
poöâabÀ
[
√xée·
].y;

322 i‡(
poöâabÀ
[
√xée·
].
y
 == y) {

323 
À·
 = 
√xée·
;

329 
√xée·
++;

330 i‡(
√xée·
 >
cou¡
)

331 
√xée·
 = 0;

337 
	`BRESINITPGON
(
poöâabÀ
[
√xée·
].
y
-poöâabÀ[
À·
].y,

338 
poöâabÀ
[
À·
].
x
,poöâabÀ[
√xée·
].x,

339 
xl
, 
dl
, 
ml
, 
m1l
, 
ö¸1l
, 
ö¸2l
);

345 i‡(
poöâabÀ
[
√xåight
].
y
 == y) {

346 
right
 = 
√xåight
;

352 
√xåight
--;

353 i‡(
√xåight
 < 0)

354 
√xåight
 = 
cou¡
-1;

360 
	`BRESINITPGON
(
poöâabÀ
[
√xåight
].
y
-poöâabÀ[
right
].y,

361 
poöâabÀ
[
right
].
x
,poöâabÀ[
√xåight
].x,

362 
xr
, 
dr
, 
mr
, 
m1r
, 
ö¸1r
, 
ö¸2r
);

369 
i
 = 
	`MWMIN
(
poöâabÀ
[
√xée·
].
y
,ÖoöâabÀ[
√xåight
].y) - y;

371 if(
i
 < 0)

373 
	`FREEA
(
Fú°Width
);

374 
	`FREEA
(
Fú°Poöt
);

377 
i
-- > 0)

379 
±sOut
->
y
 = y;

384 i‡(
xl
 < 
xr
)

386 *(
width
++Ë
xr
 - 
xl
;

387 (
±sOut
++)->
x
 = 
xl
;

391 *(
width
++Ë
xl
 - 
xr
;

392 (
±sOut
++)->
x
 = 
xr
;

394 
y
++;

397 
	`BRESINCRPGON
(
dl
, 
xl
, 
ml
, 
m1l
, 
ö¸1l
, 
ö¸2l
);

398 
	`BRESINCRPGON
(
dr
, 
xr
, 
mr
, 
m1r
, 
ö¸1r
, 
ö¸2r
);

400 } 
y
 !
ymax
);

405 
i
 = 
±sOut
-
Fú°Poöt
;

406 
±sOut
 = 
Fú°Poöt
;

407 
width
 = 
Fú°Width
;

408 --
i
 >= 0) {

410 
e
 = *
width
++ - 1;

411 i‡(
e
 >= 0) {

412 i‡(
gr_fûlmode
 !
MWFILL_SOLID
)

413 
	`ts_døwrow
(
psd
, 
±sOut
->
x
,ÖtsOut->x + 
e
,ÖtsOut->
y
);

415 
	`døwrow
(
psd
, 
±sOut
->
x
,ÖtsOut->x + 
e
,ÖtsOut->
y
);

417 ++
±sOut
;

420 
	`FREEA
(
Fú°Width
);

421 
	`FREEA
(
Fú°Poöt
);

422 
	`GdFixCurs‹
(
psd
);

423 
	}
}

426 #i‡
BASICPOLYFILL


445 
	$exãndrow
(
MWCOORD
 
y
,MWCOORD 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

446 
MWCOORD
 *
möx±r
,MWCOORD *
maxx±r
)

448 
MWCOORD
 
x
;

449 
	tNUM
;

450 
NUM
 
num
;

455 i‡(((
y
 < 
y1
Ë|| (y > 
y2
)) && ((y < y2) || (y > y1)))

459 i‡(
y1
 =
y2
) {

460 i‡(*
möx±r
 > 
x1
) *minxptr = x1;

461 i‡(*
möx±r
 > 
x2
) *minxptr = x2;

462 i‡(*
maxx±r
 < 
x1
) *maxxptr = x1;

463 i‡(*
maxx±r
 < 
x2
) *maxxptr = x2;

468 i‡(
x1
 =
x2
) {

469 i‡(*
möx±r
 > 
x1
) *minxptr = x1;

470 i‡(*
maxx±r
 < 
x1
) *maxxptr = x1;

477 
num
 = ((
NUM
Ë(
y
 - 
y1
)Ë* (
x2
 - 
x1
);

478 
x
 = 
x1
 + 
num
 / (
y2
 - 
y1
);

479 i‡(*
möx±r
 > 
x
) *minxptr = x;

480 i‡(*
maxx±r
 < 
x
) *maxxptr = x;

481 
	}
}

484 
	$GdFûlPﬁy
(
PSD
 
psd
, 
cou¡
, 
MWPOINT
 *
poöts
)

486 
MWPOINT
 *
µ
;

487 
MWCOORD
 
möy
;

488 
MWCOORD
 
maxy
;

489 
MWCOORD
 
möx
;

490 
MWCOORD
 
maxx
;

491 
i
;

493 i‡(
cou¡
 <= 0)

497 
µ
 = 
poöts
;

498 
möy
 = 
µ
->
y
;

499 
maxy
 = 
µ
->
y
;

500 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

501 i‡(
möy
 > 
µ
->
y
) miny =Öp->y;

502 i‡(
maxy
 < 
µ
->
y
) maxy =Öp->y;

504 i‡(
möy
 < 0)

505 
möy
 = 0;

506 i‡(
maxy
 >
psd
->
yvúåes
)

507 
maxy
 = 
psd
->
yvúåes
 - 1;

508 i‡(
möy
 > 
maxy
)

515 ; 
möy
 <
maxy
; miny++) {

516 
möx
 = 
MAX_MWCOORD
;

517 
maxx
 = 
MIN_MWCOORD
;

518 
µ
 = 
poöts
;

519 
i
 = 
cou¡
; --ò> 0; 
µ
++)

520 
	`exãndrow
(
möy
, 
µ
[0].
x
,Öp[0].
y
,Öp[1].x,Öp[1].y,

521 &
möx
, &
maxx
);

522 
	`exãndrow
(
möy
, 
µ
[0].
x
,Öp[0].
y
, 
poöts
[0].x,Öoints[0].y,

523 &
möx
, &
maxx
);

525 i‡(
möx
 <
maxx
)

526 
	`døwrow
(
psd
, 
möx
, 
maxx
, 
möy
);

528 
	`GdFixCurs‹
(
psd
);

529 
	}
}

532 #i‡
EDGEPOLYFILL


540 
	#USE_FLOAT
 
HAVEFLOAT


	)

542 
	#sw≠
(
a
,
b
Ëdÿ{á ^b; b ^a;á ^b; } 0)

	)

545 
	mx1
, 
	my1
, 
	mx2
, 
	my2
;

546 #i‡
USE_FLOAT


547 
	mx
, 
	mm
;

549 
	mcx
, 
	m‚
, 
	mmn
, 
	md
;

551 } 
	tedge_t
;

554 
	$edge_cmp
(c⁄° *
lvp
, c⁄° *
rvp
)

557 c⁄° 
edge_t
 *
Õ
 = (c⁄°Édge_à*)
lvp
;

558 c⁄° 
edge_t
 *
Ω
 = (c⁄°Édge_à*)
rvp
;

561 i‡(
Õ
->
y1
 !
Ω
->y1)

562  
Õ
->
y1
 - 
Ω
->y1;

565 #i‡
USE_FLOAT


566 i‡(
Õ
->
x
 < 
Ω
->x)

568 i‡(
Õ
->
x
 > 
Ω
->x)

571 i‡(
Õ
->
cx
 !
Ω
->cx)

572  
Õ
->
cx
 - 
Ω
->cx;

577 
	}
}

587 
	$GdFûlPﬁy
(
PSD
 
psd
, 
cou¡
, 
MWPOINT
 * 
poöâabÀ
)

589 
edge_t
 *
gë
;

590 
nge
 = 0;

591 
cge
 = 0;

593 
edge_t
 *
´t
;

594 
«e
 = 0;

596 
i
, 
y
;

598 i‡(
cou¡
 < 3) {

602 
gë
 = (
edge_t
 *Ë
	`ˇŒoc
(
cou¡
, (edge_t));

603 
´t
 = (
edge_t
 *Ë
	`ˇŒoc
(
cou¡
, (edge_t));

605 i‡((
gë
 =0Ë|| (
´t
 == 0)) {

607 i‡(
gë
)

608 
	`‰ì
(
gë
);

609 i‡(
´t
)

610 
	`‰ì
(
´t
);

614 
i
 = 0; i < 
cou¡
; ++i) {

615 
gë
[
nge
].
x1
 = 
poöâabÀ
[
i
].
x
;

616 
gë
[
nge
].
y1
 = 
poöâabÀ
[
i
].
y
;

617 
gë
[
nge
].
x2
 = 
poöâabÀ
[(
i
 + 1Ë% 
cou¡
].
x
;

618 
gë
[
nge
].
y2
 = 
poöâabÀ
[(
i
 + 1Ë% 
cou¡
].
y
;

619 i‡(
gë
[
nge
].
y1
 !gë[nge].
y2
) {

620 i‡(
gë
[
nge
].
y1
 > gë[nge].
y2
) {

621 
	`sw≠
(
gë
[
nge
].
x1
, gë[nge].
x2
);

622 
	`sw≠
(
gë
[
nge
].
y1
, gë[nge].
y2
);

624 #i‡
USE_FLOAT


625 
gë
[
nge
].
x
 = gë[nge].
x1
;

626 
gë
[
nge
].
m
 = gë[nge].
x2
 - gë[nge].
x1
;

627 
gë
[
nge
].
m
 /gë[nge].
y2
 - gë[nge].
y1
;

629 
gë
[
nge
].
cx
 = gë[nge].
x1
;

630 
gë
[
nge
].
mn
 = gë[nge].
x2
 - gë[nge].
x1
;

631 
gë
[
nge
].
d
 = gë[nge].
y2
 - gë[nge].
y1
;

632 
gë
[
nge
].
‚
 = gë[nge].
mn
 / 2;

634 ++
nge
;

638 
	`qs‹t
(
gë
, 
nge
, (gë[0]), 
edge_cmp
);

641 
y
 = 
gë
[0].
y1
;

646 (
nge
 > 0Ë&& (
gë
[
cge
].
y1
 =
y
)) {

647 
´t
[
«e
] = 
gë
[
cge
++];

648 --
nge
;

649 
´t
[
«e
++].
y1
 = 0;

652 
	`qs‹t
(
´t
, 
«e
, ◊ë[0]), 
edge_cmp
);

655 
i
 = 1; i < 
«e
; i += 2) {

656 #i‡
USE_FLOAT


657 
l
 = ()
´t
[
i
 - 1].
x
;

658 
r
 = ()
´t
[
i
].
x
;

660 
l
 = ()
´t
[
i
 - 1].
cx
;

661 
r
 = ()
´t
[
i
].
cx
;

663 i‡(
r
 > 
l
)

664 
	`døwrow
(
psd
, 
l
, 
r
 - 1, 
y
);

668 ++
y
;

672 
i
 = 0; i < 
«e
; ++i) {

673 i‡(
´t
[
i
].
y2
 =
y
)

674 
´t
[
i
--] =áë[--
«e
];

676 #i‡
USE_FLOAT


677 
´t
[
i
].
x
 +´t[i].
m
;

679 
´t
[
i
].
‚
 +´t[i].
mn
;

680 i‡(
´t
[
i
].
‚
 < 0) {

681 
´t
[
i
].
cx
 +´t[i].
‚
 /áë[i].
d
 - 1;

682 
´t
[
i
].
‚
 %´t[i].
d
;

683 
´t
[
i
].
‚
 +´t[i].
d
;

685 i‡(
´t
[
i
].
‚
 >´t[i].
d
) {

686 
´t
[
i
].
cx
 +´t[i].
‚
 /áë[i].
d
;

687 
´t
[
i
].
‚
 %´t[i].
d
;

694 } (
«e
 > 0Ë|| (
nge
 > 0));

697 
	`‰ì
(
gë
);

698 
	`‰ì
(
´t
);

700 
	`GdFixCurs‹
(
psd
);

701 
	}
}

	@engine/devrgn.c

85 
	~<°dio.h
>

86 
	~<°dlib.h
>

87 
	~<°rög.h
>

88 
	~"devi˚.h
"

90 (*
	tREGION_OvîœpB™dFun˘i⁄På
Ë(
	tMWCLIPREGION
 * 
	tpReg
, 
	tMWRECT
 * 
	tr1
,

91 
	tMWRECT
 * 
	tr1End
, MWRECT * 
	tr2
, MWRECT * 
	tr2End
, 
	tMWCOORD
 
	tt›
, MWCOORD 
	tbŸtom
);

92 (*
	tREGION_N⁄OvîœpB™dFun˘i⁄På
Ë(
	tMWCLIPREGION
 * 
	tpReg
, 
	tMWRECT
 * 
	tr
,

93 
	tMWRECT
 * 
	tíd
, 
	tMWCOORD
 
	tt›
, MWCOORD 
	tbŸtom
);

98 
	#EXTENTCHECK
(
r1
, 
r2
) \

99 ((
r1
)->
right
 > (
r2
)->
À·
 && \

100 (
r1
)->
À·
 < (
r2
)->
right
 && \

101 (
r1
)->
bŸtom
 > (
r2
)->
t›
 && \

102 (
r1
)->
t›
 < (
r2
)->
bŸtom
)

	)

107 
	#MEMCHECK
(
ªg
, 
ª˘
, 
fú°ª˘
){\

108 i‡((
ªg
)->
numRe˘s
 >(‘eg)->
size
 - 1)){\

109 (
fú°ª˘
Ë
	`GdRóŒoc
(\

110 (
fú°ª˘
), (((
MWRECT
)Ë* ((
ªg
)->
size
)), \

111 (2 * ((
MWRECT
)Ë* ((
ªg
)->
size
)));\

112 i‡((
fú°ª˘
) == 0)\

114 (
ªg
)->
size
 *= 2;\

115 (
ª˘
Ë&(
fú°ª˘
)[(
ªg
)->
numRe˘s
];\

117 
	}

	)
}

119 
	#REGION_NOT_EMPTY
(
pReg
ËpReg->
numRe˘s


	)

121 
	#EMPTY_REGION
(
pReg
) { \

122 (
pReg
)->
numRe˘s
 = 0; \

123 (
pReg
)->
exã¡s
.
À·
 = (pReg)->exã¡s.
t›
 = 0; \

124 (
pReg
)->
exã¡s
.
right
 = (pReg)->exã¡s.
bŸtom
 = 0; \

125 (
pReg
)->
ty≥
 = 
MWREGION_NULL
; \

126 }

	)

128 
	#INRECT
(
r
, 
x
, 
y
) \

129 ––((
r
).
right
 > 
x
)) && \

130 –((
r
).
À·
 <
x
)) && \

131 –((
r
).
bŸtom
 > 
y
)) && \

132 –((
r
).
t›
 <
y
)Ë)

	)

142 
MWBOOL


143 
	$GdPtInRegi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
x
, MWCOORD 
y
)

145 
i
;

147 i‡(
rgn
->
numRe˘s
 > 0 && 
	`INRECT
‘gn->
exã¡s
, 
x
, 
y
))

148 
i
 = 0; i < 
rgn
->
numRe˘s
; i++)

149 i‡(
	`INRECT
 (
rgn
->
ª˘s
[
i
], 
x
, 
y
))

150  
TRUE
;

151  
FALSE
;

152 
	}
}

162 
	$GdRe˘InRegi⁄
(
MWCLIPREGION
 *
rgn
, c⁄° 
MWRECT
 *
ª˘
)

164 
MWRECT
 * 
pCurRe˘
;

165 
MWRECT
 * 
pRe˘End
;

166 
MWCOORD
 
rx
, 
ry
;

167 
MWBOOL
 
∑πIn
, 
∑πOut
;

170 i‡(!
rgn
->
numRe˘s
 || !
	`EXTENTCHECK
(&rgn->
exã¡s
, 
ª˘
))

171  
MWRECT_OUT
;

173 
∑πOut
 = 
FALSE
;

174 
∑πIn
 = 
FALSE
;

175 
rx
 = 
ª˘
->
À·
;

176 
ry
 = 
ª˘
->
t›
;

182 
pCurRe˘
 = 
rgn
->
ª˘s
, 
pRe˘End
 =ÖCurRe˘ +Ñgn->
numRe˘s
;

183 
pCurRe˘
 < 
pRe˘End
;ÖCurRect++) {

185 i‡(
pCurRe˘
->
bŸtom
 <
ry
)

188 i‡(
pCurRe˘
->
t›
 > 
ry
) {

189 
∑πOut
 = 
TRUE
;

190 i‡(
∑πIn
 || (
pCurRe˘
->
t›
 >
ª˘
->
bŸtom
))

192 
ry
 = 
pCurRe˘
->
t›
;

195 i‡(
pCurRe˘
->
right
 <
rx
)

198 i‡(
pCurRe˘
->
À·
 > 
rx
) {

199 
∑πOut
 = 
TRUE
;

200 i‡(
∑πIn
)

204 i‡(
pCurRe˘
->
À·
 < 
ª˘
->
right
) {

205 
∑πIn
 = 
TRUE
;

206 i‡(
∑πOut
)

210 i‡(
pCurRe˘
->
right
 >
ª˘
->right) {

211 
ry
 = 
pCurRe˘
->
bŸtom
;

212 i‡(
ry
 >
ª˘
->
bŸtom
)

214 
rx
 = 
ª˘
->
À·
;

227 (
∑πIn
 ? ((
ry
 < 
ª˘
->
bŸtom
Ë? 
MWRECT_PARTIN
 : 
MWRECT_ALLIN
) :

228 
MWRECT_OUT
);

229 
	}
}

233 
MWBOOL


234 
	$GdRe˘InRegi⁄
(
MWCLIPREGION
 *
rgn
, c⁄° 
MWRECT
 *
ª˘
)

236 
MWRECT
 *
pCurRe˘
, *
pRe˘End
;

237 
MWBOOL
 
ªt
 = 
FALSE
;

240 i‡((
rgn
->
numRe˘s
 > 0Ë&& 
	`EXTENTCHECK
(&rgn->
exã¡s
, 
ª˘
))

242 
pCurRe˘
 = 
rgn
->
ª˘s
, 
pRe˘End
 =ÖCurRect +

243 
rgn
->
numRe˘s
; 
pCurRe˘
 < 
pRe˘End
;ÖCurRect++)

245 i‡(
pCurRe˘
->
bŸtom
 <
ª˘
->
t›
)

248 i‡(
pCurRe˘
->
t›
 >
ª˘
->
bŸtom
) {

249 
ªt
 = 
FALSE
;

253 i‡(
pCurRe˘
->
right
 <
ª˘
->
À·
)

256 i‡(
pCurRe˘
->
À·
 >
ª˘
->
right
) {

260 
ªt
 = 
TRUE
;

264  
ªt
;

265 
	}
}

268 
MWBOOL


269 
	$EQUALRECT
(
MWRECT
 *
r1
, MWRECT *
r2
)

271  ((
r1
->
À·
 =
r2
->À·Ë&& (r1->
right
 ==Ñ2->right) &&

272 (
r1
->
t›
 =
r2
->t›Ë&& (r1->
bŸtom
 ==Ñ2->bottom));

273 
	}
}

282 
MWBOOL


283 
	$GdEquÆRegi⁄
(
MWCLIPREGION
 *
r1
, MWCLIPREGION *
r2
)

285 
i
;

287 i‡(
r1
->
numRe˘s
 !
r2
->numRects)

288  
FALSE
;

289 i‡(
r1
->
numRe˘s
 == 0)

290  
TRUE
;

291 i‡(!
	`EQUALRECT
(&
r1
->
exã¡s
, &
r2
->extents))

292  
FALSE
;

293 
i
 = 0; i < 
r1
->
numRe˘s
; i++) {

294 i‡(!
	`EQUALRECT
(
r1
->
ª˘s
 + 
i
, 
r2
->rects + i))

295  
FALSE
;

297  
TRUE
;

298 
	}
}

306 
MWBOOL


307 
	$GdEm±yRegi⁄
(
MWCLIPREGION
 *
rgn
)

309  
rgn
->
numRe˘s
 == 0;

310 
	}
}

317 
MWCLIPREGION
 *

318 
	$GdAŒocRegi⁄
()

320 
MWCLIPREGION
 *
rgn
;

322 i‡((
rgn
 = 
	`mÆloc
(–
MWCLIPREGION
 ))))

324 i‡((
rgn
->
ª˘s
 = 
	`mÆloc
(–
MWRECT
 ))))

326 
rgn
->
size
 = 1;

327 
	`EMPTY_REGION
(
rgn
);

328  
rgn
;

330 
	`‰ì
(
rgn
);

332  
NULL
;

333 
	}
}

344 
MWCLIPREGION
 *

345 
	$GdAŒocRe˘Regi⁄
(
MWCOORD
 
À·
, MWCOORD 
t›
, MWCOORD 
right
, MWCOORD 
bŸtom
)

347 
MWCLIPREGION
 *
rgn
;

349 
rgn
 = 
	`GdAŒocRegi⁄
();

350 i‡(
rgn
)

351 
	`GdSëRe˘Regi⁄
(
rgn
, 
À·
, 
t›
, 
right
, 
bŸtom
);

352  
rgn
;

353 
	}
}

361 
MWCLIPREGION
 *

362 
	$GdAŒocRe˘Regi⁄Indúe˘
(
MWRECT
 *
¥c
)

364  
	`GdAŒocRe˘Regi⁄
(
¥c
->
À·
,Örc->
t›
,Örc->
right
,Örc->
bŸtom
);

365 
	}
}

378 
	$GdSëRe˘Regi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
À·
, MWCOORD 
t›
, MWCOORD 
right
,

379 
MWCOORD
 
bŸtom
)

381 i‡(
À·
 !
right
 && 
t›
 !
bŸtom
) {

382 
rgn
->
ª˘s
->
À·
 =Ñgn->
exã¡s
.left =Üeft;

383 
rgn
->
ª˘s
->
t›
 =Ñgn->
exã¡s
.top =Åop;

384 
rgn
->
ª˘s
->
right
 =Ñgn->
exã¡s
.right =Ñight;

385 
rgn
->
ª˘s
->
bŸtom
 =Ñgn->
exã¡s
.bottom = bottom;

386 
rgn
->
numRe˘s
 = 1;

387 
rgn
->
ty≥
 = 
MWREGION_SIMPLE
;

389 
	`EMPTY_REGION
(
rgn
);

390 
	}
}

400 
	$GdSëRe˘Regi⁄Indúe˘
(
MWCLIPREGION
 *
rgn
, 
MWRECT
 *
¥c
)

402 
	`GdSëRe˘Regi⁄
(
rgn
, 
¥c
->
À·
,Örc->
t›
,Örc->
right
,Örc->
bŸtom
);

403 
	}
}

411 
	$GdDe°royRegi⁄
(
MWCLIPREGION
 *
rgn
)

413 if(
rgn
) {

414 
	`‰ì
(
rgn
->
ª˘s
);

415 
	`‰ì
(
rgn
);

417 
	}
}

427 
	$GdOff£tRegi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
x
, MWCOORD 
y
)

429 
nbox
 = 
rgn
->
numRe˘s
;

430 
MWRECT
 *
pbox
 = 
rgn
->
ª˘s
;

432 if(
nbox
 && (
x
 || 
y
)) {

433 
nbox
--) {

434 
pbox
->
À·
 +
x
;

435 
pbox
->
right
 +
x
;

436 
pbox
->
t›
 +
y
;

437 
pbox
->
bŸtom
 +
y
;

438 
pbox
++;

440 
rgn
->
exã¡s
.
À·
 +
x
;

441 
rgn
->
exã¡s
.
right
 +
x
;

442 
rgn
->
exã¡s
.
t›
 +
y
;

443 
rgn
->
exã¡s
.
bŸtom
 +
y
;

445 
	}
}

457 
	$GdGëRegi⁄Box
(
MWCLIPREGION
 *
rgn
, 
MWRECT
 *
¥c
)

459 *
¥c
 = 
rgn
->
exã¡s
;

460  
rgn
->
ty≥
;

461 
	}
}

470 
	$GdUni⁄Re˘WôhRegi⁄
(c⁄° 
MWRECT
 *
ª˘
, 
MWCLIPREGION
 *
rgn
)

472 
MWCLIPREGION
 
ªgi⁄
;

474 
ªgi⁄
.
ª˘s
 = &ªgi⁄.
exã¡s
;

475 
ªgi⁄
.
numRe˘s
 = 1;

476 
ªgi⁄
.
size
 = 1;

477 
ªgi⁄
.
ty≥
 = 
MWREGION_SIMPLE
;

478 
ªgi⁄
.
exã¡s
 = *
ª˘
;

479 
	`GdUni⁄Regi⁄
(
rgn
,Ñgn, &
ªgi⁄
);

480 
	}
}

489 
	$GdSubåa˘Re˘FromRegi⁄
(c⁄° 
MWRECT
 *
ª˘
, 
MWCLIPREGION
 *
rgn
)

491 
MWCLIPREGION
 
ªgi⁄
;

493 
ªgi⁄
.
ª˘s
 = &ªgi⁄.
exã¡s
;

494 
ªgi⁄
.
numRe˘s
 = 1;

495 
ªgi⁄
.
size
 = 1;

496 
ªgi⁄
.
ty≥
 = 
MWREGION_SIMPLE
;

497 
ªgi⁄
.
exã¡s
 = *
ª˘
;

498 
	`GdSubåa˘Regi⁄
(
rgn
,Ñgn, &
ªgi⁄
);

499 
	}
}

509 
	$GdC›yRegi⁄
(
MWCLIPREGION
 *
d°
, MWCLIPREGION *
§c
)

511 i‡(
d°
 !
§c
)

513 i‡(
d°
->
size
 < 
§c
->
numRe˘s
)

515 i‡(! (
d°
->
ª˘s
 = 
	`GdRóŒoc
–d°->ª˘s, d°->
numRe˘s
 * (
MWRECT
), 
§c
->numRects * (MWRECT))))

517 
d°
->
size
 = 
§c
->
numRe˘s
;

519 
d°
->
numRe˘s
 = 
§c
->numRects;

520 
d°
->
exã¡s
.
À·
 = 
§c
->extents.left;

521 
d°
->
exã¡s
.
t›
 = 
§c
->extents.top;

522 
d°
->
exã¡s
.
right
 = 
§c
->extents.right;

523 
d°
->
exã¡s
.
bŸtom
 = 
§c
->extents.bottom;

524 
d°
->
ty≥
 = 
§c
->type;

526 
	`mem˝y
((*Ë
d°
->
ª˘s
, (*Ë
§c
->rects,

527 (Ë(
§c
->
numRe˘s
 * (
MWRECT
)));

529 
	}
}

537 
	$REGION_SëExã¡s
 (
MWCLIPREGION
 *
pReg
)

539 
MWRECT
 *
pRe˘
, *
pRe˘End
, *
pExã¡s
;

541 i‡(
pReg
->
numRe˘s
 == 0)

543 
pReg
->
exã¡s
.
À·
 = 0;

544 
pReg
->
exã¡s
.
t›
 = 0;

545 
pReg
->
exã¡s
.
right
 = 0;

546 
pReg
->
exã¡s
.
bŸtom
 = 0;

550 
pExã¡s
 = &
pReg
->
exã¡s
;

551 
pRe˘
 = 
pReg
->
ª˘s
;

552 
pRe˘End
 = &
pRe˘
[
pReg
->
numRe˘s
 - 1];

561 
pExã¡s
->
À·
 = 
pRe˘
->left;

562 
pExã¡s
->
t›
 = 
pRe˘
->top;

563 
pExã¡s
->
right
 = 
pRe˘End
->right;

564 
pExã¡s
->
bŸtom
 = 
pRe˘End
->bottom;

566 
pRe˘
 <
pRe˘End
)

568 i‡(
pRe˘
->
À·
 < 
pExã¡s
->left)

569 
pExã¡s
->
À·
 = 
pRe˘
->left;

570 i‡(
pRe˘
->
right
 > 
pExã¡s
->right)

571 
pExã¡s
->
right
 = 
pRe˘
->right;

572 
pRe˘
++;

574 
	}
}

593 
MWCOORD


594 
	$REGION_CﬂÀs˚
 (

595 
MWCLIPREGION
 *
pReg
,

596 
MWCOORD
 
¥evSèπ
,

597 
MWCOORD
 
curSèπ


599 
MWRECT
 *
pPªvRe˘
;

600 
MWRECT
 *
pCurRe˘
;

601 
MWRECT
 *
pRegEnd
;

602 
MWCOORD
 
curNumRe˘s
;

603 
MWCOORD
 
¥evNumRe˘s
;

604 
MWCOORD
 
b™dt›
;

606 
pRegEnd
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

608 
pPªvRe˘
 = &
pReg
->
ª˘s
[
¥evSèπ
];

609 
¥evNumRe˘s
 = 
curSèπ
 - 
¥evSèπ
;

616 
pCurRe˘
 = &
pReg
->
ª˘s
[
curSèπ
];

617 
b™dt›
 = 
pCurRe˘
->
t›
;

618 
curNumRe˘s
 = 0;

619 (
pCurRe˘
 !
pRegEnd
Ë&& (pCurRe˘->
t›
 =
b™dt›
);

620 
curNumRe˘s
++)

622 
pCurRe˘
++;

625 i‡(
pCurRe˘
 !
pRegEnd
)

633 
pRegEnd
--;

634 
pRegEnd
[-1].
t›
 ==ÖRegEnd->top)

636 
pRegEnd
--;

638 
curSèπ
 = 
pRegEnd
 - 
pReg
->
ª˘s
;

639 
pRegEnd
 = 
pReg
->
ª˘s
 +ÖReg->
numRe˘s
;

642 i‡((
curNumRe˘s
 =
¥evNumRe˘s
) && (curNumRects != 0)) {

643 
pCurRe˘
 -
curNumRe˘s
;

648 i‡(
pPªvRe˘
->
bŸtom
 =
pCurRe˘
->
t›
)

658 i‡((
pPªvRe˘
->
À·
 !
pCurRe˘
->left) ||

659 (
pPªvRe˘
->
right
 !
pCurRe˘
->right))

664  (
curSèπ
);

666 
pPªvRe˘
++;

667 
pCurRe˘
++;

668 
¥evNumRe˘s
 -= 1;

669 } 
¥evNumRe˘s
 != 0);

671 
pReg
->
numRe˘s
 -
curNumRe˘s
;

672 
pCurRe˘
 -
curNumRe˘s
;

673 
pPªvRe˘
 -
curNumRe˘s
;

682 
pPªvRe˘
->
bŸtom
 = 
pCurRe˘
->bottom;

683 
pPªvRe˘
++;

684 
pCurRe˘
++;

685 
curNumRe˘s
 -= 1;

686 } 
curNumRe˘s
 != 0);

698 i‡(
pCurRe˘
 =
pRegEnd
)

700 
curSèπ
 = 
¥evSèπ
;

706 *
pPªvRe˘
++ = *
pCurRe˘
++;

707 } 
pCurRe˘
 !
pRegEnd
);

712  (
curSèπ
);

713 
	}
}

741 
	$REGION_Regi⁄Op
(

742 
MWCLIPREGION
 *
√wReg
,

743 
MWCLIPREGION
 *
ªg1
,

744 
MWCLIPREGION
 *
ªg2
,

745 
REGION_OvîœpB™dFun˘i⁄På
 
ovîœpFunc
,

746 
REGION_N⁄OvîœpB™dFun˘i⁄På
 
n⁄Ovîœp1Func
,

747 
REGION_N⁄OvîœpB™dFun˘i⁄På
 
n⁄Ovîœp2Func


749 
MWRECT
 *
r1
;

750 
MWRECT
 *
r2
;

751 
MWRECT
 *
r1End
;

752 
MWRECT
 *
r2End
;

753 
MWCOORD
 
ybŸ
;

754 
MWCOORD
 
yt›
;

755 
MWRECT
 *
ﬁdRe˘s
;

756 
MWCOORD
 
¥evB™d
;

758 
MWCOORD
 
curB™d
;

760 
MWRECT
 *
r1B™dEnd
;

761 
MWRECT
 *
r2B™dEnd
;

762 
MWCOORD
 
t›
;

763 
MWCOORD
 
bŸ
;

772 
r1
 = 
ªg1
->
ª˘s
;

773 
r2
 = 
ªg2
->
ª˘s
;

774 
r1End
 = 
r1
 + 
ªg1
->
numRe˘s
;

775 
r2End
 = 
r2
 + 
ªg2
->
numRe˘s
;

784 
ﬁdRe˘s
 = 
√wReg
->
ª˘s
;

785 
√wReg
->
numRe˘s
 = 0;

794 
√wReg
->
size
 = 
	`MWMAX
(
ªg1
->
numRe˘s
,
ªg2
->numRects) * 2;

796 i‡(! (
√wReg
->
ª˘s
 = 
	`mÆloc
–(
MWRECT
Ë*ÇewReg->
size
 )))

798 
√wReg
->
size
 = 0;

815 i‡(
ªg1
->
exã¡s
.
t›
 < 
ªg2
->extents.top)

816 
ybŸ
 = 
ªg1
->
exã¡s
.
t›
;

818 
ybŸ
 = 
ªg2
->
exã¡s
.
t›
;

829 
¥evB™d
 = 0;

833 
curB™d
 = 
√wReg
->
numRe˘s
;

842 
r1B™dEnd
 = 
r1
;

843 (
r1B™dEnd
 !
r1End
Ë&& (r1B™dEnd->
t›
 =
r1
->top))

845 
r1B™dEnd
++;

848 
r2B™dEnd
 = 
r2
;

849 (
r2B™dEnd
 !
r2End
Ë&& (r2B™dEnd->
t›
 =
r2
->top))

851 
r2B™dEnd
++;

862 i‡(
r1
->
t›
 < 
r2
->top)

864 
t›
 = 
	`MWMAX
(
r1
->t›,
ybŸ
);

865 
bŸ
 = 
	`MWMIN
(
r1
->
bŸtom
,
r2
->
t›
);

867 i‡((
t›
 !
bŸ
Ë&& (
n⁄Ovîœp1Func
 !((*)())
NULL
))

869 (* 
n⁄Ovîœp1Func
Ë(
√wReg
, 
r1
, 
r1B™dEnd
, 
t›
, 
bŸ
);

872 
yt›
 = 
r2
->
t›
;

874 i‡(
r2
->
t›
 < 
r1
->top)

876 
t›
 = 
	`MWMAX
(
r2
->t›,
ybŸ
);

877 
bŸ
 = 
	`MWMIN
(
r2
->
bŸtom
,
r1
->
t›
);

879 i‡((
t›
 !
bŸ
Ë&& (
n⁄Ovîœp2Func
 !((*)())
NULL
))

881 (* 
n⁄Ovîœp2Func
Ë(
√wReg
, 
r2
, 
r2B™dEnd
, 
t›
, 
bŸ
);

884 
yt›
 = 
r1
->
t›
;

888 
yt›
 = 
r1
->
t›
;

897 i‡(
√wReg
->
numRe˘s
 !
curB™d
)

899 
¥evB™d
 = 
	`REGION_CﬂÀs˚
 (
√wReg
,ÖªvB™d, 
curB™d
);

906 
ybŸ
 = 
	`MWMIN
(
r1
->
bŸtom
, 
r2
->bottom);

907 
curB™d
 = 
√wReg
->
numRe˘s
;

908 i‡(
ybŸ
 > 
yt›
)

910 (* 
ovîœpFunc
Ë(
√wReg
, 
r1
, 
r1B™dEnd
, 
r2
, 
r2B™dEnd
, 
yt›
, 
ybŸ
);

914 i‡(
√wReg
->
numRe˘s
 !
curB™d
)

916 
¥evB™d
 = 
	`REGION_CﬂÀs˚
 (
√wReg
,ÖªvB™d, 
curB™d
);

923 i‡(
r1
->
bŸtom
 =
ybŸ
)

925 
r1
 = 
r1B™dEnd
;

927 i‡(
r2
->
bŸtom
 =
ybŸ
)

929 
r2
 = 
r2B™dEnd
;

931 } (
r1
 !
r1End
Ë&& (
r2
 !
r2End
));

936 
curB™d
 = 
√wReg
->
numRe˘s
;

937 i‡(
r1
 !
r1End
)

939 i‡(
n⁄Ovîœp1Func
 !((*)())
NULL
)

943 
r1B™dEnd
 = 
r1
;

944 (
r1B™dEnd
 < 
r1End
Ë&& (r1B™dEnd->
t›
 =
r1
->top))

946 
r1B™dEnd
++;

948 (* 
n⁄Ovîœp1Func
Ë(
√wReg
, 
r1
, 
r1B™dEnd
,

949 
	`MWMAX
(
r1
->
t›
,
ybŸ
),Ñ1->
bŸtom
);

950 
r1
 = 
r1B™dEnd
;

951 } 
r1
 !
r1End
);

954 i‡((
r2
 !
r2End
Ë&& (
n⁄Ovîœp2Func
 !((*)())
NULL
))

958 
r2B™dEnd
 = 
r2
;

959 (
r2B™dEnd
 < 
r2End
Ë&& (r2B™dEnd->
t›
 =
r2
->top))

961 
r2B™dEnd
++;

963 (* 
n⁄Ovîœp2Func
Ë(
√wReg
, 
r2
, 
r2B™dEnd
,

964 
	`MWMAX
(
r2
->
t›
,
ybŸ
),Ñ2->
bŸtom
);

965 
r2
 = 
r2B™dEnd
;

966 } 
r2
 !
r2End
);

969 i‡(
√wReg
->
numRe˘s
 !
curB™d
)

971 (Ë
	`REGION_CﬂÀs˚
 (
√wReg
, 
¥evB™d
, 
curB™d
);

982 i‡(
√wReg
->
numRe˘s
 < (√wReg->
size
 >> 1))

984 i‡(
	`REGION_NOT_EMPTY
(
√wReg
))

986 
MWRECT
 *
¥ev_ª˘s
 = 
√wReg
->
ª˘s
;

987 
√wReg
->
ª˘s
 = 
	`GdRóŒoc
–√wReg->ª˘s, (
MWRECT
Ë*ÇewReg->
size
, (MWRECTË*ÇewReg->
numRe˘s
 );

988 
√wReg
->
size
 =ÇewReg->
numRe˘s
;

989 i‡(! 
√wReg
->
ª˘s
)

990 
√wReg
->
ª˘s
 = 
¥ev_ª˘s
;

998 
√wReg
->
size
 = 1;

999 
	`‰ì
–
√wReg
->
ª˘s
 );

1000 
√wReg
->
ª˘s
 = 
	`mÆloc
–(
MWRECT
) );

1003 
	`‰ì
–
ﬁdRe˘s
 );

1004 
	}
}

1024 
	$REGION_I¡î£˘O
(
MWCLIPREGION
 *
pReg
, 
MWRECT
 *
r1
, MWRECT *
r1End
,

1025 
MWRECT
 *
r2
, MWRECT *
r2End
, 
MWCOORD
 
t›
, MWCOORD 
bŸtom
)

1028 
MWCOORD
 
À·
, 
right
;

1029 
MWRECT
 *
pNextRe˘
;

1031 
pNextRe˘
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

1033 (
r1
 !
r1End
Ë&& (
r2
 !
r2End
))

1035 
À·
 = 
	`MWMAX
(
r1
->À·, 
r2
->left);

1036 
right
 = 
	`MWMIN
(
r1
->right, 
r2
->right);

1045 i‡(
À·
 < 
right
)

1047 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1048 
pNextRe˘
->
À·
 =Üeft;

1049 
pNextRe˘
->
t›
 =Åop;

1050 
pNextRe˘
->
right
 =Ñight;

1051 
pNextRe˘
->
bŸtom
 = bottom;

1052 
pReg
->
numRe˘s
 += 1;

1053 
pNextRe˘
++;

1061 i‡(
r1
->
right
 < 
r2
->right)

1063 
r1
++;

1065 i‡(
r2
->
right
 < 
r1
->right)

1067 
r2
++;

1071 
r1
++;

1072 
r2
++;

1075 
	}
}

1086 
	$GdI¡î£˘Regi⁄
(
MWCLIPREGION
 *
√wReg
, MWCLIPREGION *
ªg1
, MWCLIPREGION *
ªg2
)

1089 i‡–(!(
ªg1
->
numRe˘s
)Ë|| (!(
ªg2
->numRects)) ||

1090 (!
	`EXTENTCHECK
(&
ªg1
->
exã¡s
, &
ªg2
->extents)))

1091 
√wReg
->
numRe˘s
 = 0;

1093 
	`REGION_Regi⁄Op
 (
√wReg
, 
ªg1
, 
ªg2
, 
REGION_I¡î£˘O
, 
NULL
, NULL);

1102 
	`REGION_SëExã¡s
(
√wReg
);

1103 
√wReg
->
ty≥
 = (√wReg->
numRe˘s
Ë? 
MWREGION_COMPLEX
 : 
MWREGION_NULL
 ;

1104 
	}
}

1126 
	$REGION_Uni⁄N⁄O
(
MWCLIPREGION
 *
pReg
,
MWRECT
 *
r
,MWRECT *
rEnd
,
MWCOORD
 
t›
,

1127 
MWCOORD
 
bŸtom
)

1129 
MWRECT
 *
pNextRe˘
;

1131 
pNextRe˘
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

1133 
r
 !
rEnd
)

1135 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1136 
pNextRe˘
->
À·
 = 
r
->left;

1137 
pNextRe˘
->
t›
 =Åop;

1138 
pNextRe˘
->
right
 = 
r
->right;

1139 
pNextRe˘
->
bŸtom
 = bottom;

1140 
pReg
->
numRe˘s
 += 1;

1141 
pNextRe˘
++;

1142 
r
++;

1144 
	}
}

1161 
	$REGION_Uni⁄O
(
MWCLIPREGION
 *
pReg
, 
MWRECT
 *
r1
, MWRECT *
r1End
,

1162 
MWRECT
 *
r2
, MWRECT *
r2End
, 
MWCOORD
 
t›
, MWCOORD 
bŸtom
)

1164 
MWRECT
 *
pNextRe˘
;

1166 
pNextRe˘
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

1168 
	#MERGERECT
(
r
) \

1169 i‡((
pReg
->
numRe˘s
 != 0) && \

1170 (
pNextRe˘
[-1].
t›
 ==Åop) && \

1171 (
pNextRe˘
[-1].
bŸtom
 == bottom) && \

1172 (
pNextRe˘
[-1].
right
 >
r
->
À·
)) \

1174 i‡(
pNextRe˘
[-1].
right
 < 
r
->right) \

1176 
pNextRe˘
[-1].
right
 = 
r
->right; \

1181 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
); \

1182 
pNextRe˘
->
t›
 =Åop; \

1183 
pNextRe˘
->
bŸtom
 = bottom; \

1184 
pNextRe˘
->
À·
 = 
r
->left; \

1185 
pNextRe˘
->
right
 = 
r
->right; \

1186 
pReg
->
numRe˘s
 += 1; \

1187 
pNextRe˘
 += 1; \

1189 
r
++;

	)

1191 (
r1
 !
r1End
Ë&& (
r2
 !
r2End
))

1193 i‡(
r1
->
À·
 < 
r2
->left)

1195 
	`MERGERECT
(
r1
);

1199 
	`MERGERECT
(
r2
);

1203 i‡(
r1
 !
r1End
)

1207 
	`MERGERECT
(
r1
);

1208 } 
r1
 !
r1End
);

1210 
r2
 !
r2End
)

1212 
	`MERGERECT
(
r2
);

1214 
	}
}

1225 
	$GdUni⁄Regi⁄
(
MWCLIPREGION
 *
√wReg
, MWCLIPREGION *
ªg1
, MWCLIPREGION *
ªg2
)

1232 i‡–(
ªg1
 =
ªg2
Ë|| (!‘eg1->
numRe˘s
)) )

1234 i‡(
√wReg
 !
ªg2
)

1235 
	`GdC›yRegi⁄
(
√wReg
, 
ªg2
);

1242 i‡(!(
ªg2
->
numRe˘s
))

1244 i‡(
√wReg
 !
ªg1
)

1245 
	`GdC›yRegi⁄
(
√wReg
, 
ªg1
);

1252 i‡((
ªg1
->
numRe˘s
 == 1) &&

1253 (
ªg1
->
exã¡s
.
À·
 <
ªg2
->extents.left) &&

1254 (
ªg1
->
exã¡s
.
t›
 <
ªg2
->extents.top) &&

1255 (
ªg1
->
exã¡s
.
right
 >
ªg2
->extents.right) &&

1256 (
ªg1
->
exã¡s
.
bŸtom
 >
ªg2
->extents.bottom))

1258 i‡(
√wReg
 !
ªg1
)

1259 
	`GdC›yRegi⁄
(
√wReg
, 
ªg1
);

1266 i‡((
ªg2
->
numRe˘s
 == 1) &&

1267 (
ªg2
->
exã¡s
.
À·
 <
ªg1
->extents.left) &&

1268 (
ªg2
->
exã¡s
.
t›
 <
ªg1
->extents.top) &&

1269 (
ªg2
->
exã¡s
.
right
 >
ªg1
->extents.right) &&

1270 (
ªg2
->
exã¡s
.
bŸtom
 >
ªg1
->extents.bottom))

1272 i‡(
√wReg
 !
ªg2
)

1273 
	`GdC›yRegi⁄
(
√wReg
, 
ªg2
);

1277 
	`REGION_Regi⁄Op
 (
√wReg
, 
ªg1
, 
ªg2
, 
REGION_Uni⁄O
,

1278 
REGION_Uni⁄N⁄O
, REGION_UnionNonO);

1280 
√wReg
->
exã¡s
.
À·
 = 
	`MWMIN
(
ªg1
->exã¡s.À·, 
ªg2
->extents.left);

1281 
√wReg
->
exã¡s
.
t›
 = 
	`MWMIN
(
ªg1
->exã¡s.t›, 
ªg2
->extents.top);

1282 
√wReg
->
exã¡s
.
right
 = 
	`MWMAX
(
ªg1
->exã¡s.right, 
ªg2
->extents.right);

1283 
√wReg
->
exã¡s
.
bŸtom
 = 
	`MWMAX
(
ªg1
->exã¡s.bŸtom, 
ªg2
->extents.bottom);

1284 
√wReg
->
ty≥
 = (√wReg->
numRe˘s
Ë? 
MWREGION_COMPLEX
 : 
MWREGION_NULL
 ;

1285 
	}
}

1305 
	$REGION_Subåa˘N⁄O1
(
MWCLIPREGION
 *
pReg
, 
MWRECT
 *
r
, MWRECT *
rEnd
,

1306 
MWCOORD
 
t›
, MWCOORD 
bŸtom
)

1308 
MWRECT
 *
pNextRe˘
;

1310 
pNextRe˘
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

1312 
r
 !
rEnd
)

1314 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1315 
pNextRe˘
->
À·
 = 
r
->left;

1316 
pNextRe˘
->
t›
 =Åop;

1317 
pNextRe˘
->
right
 = 
r
->right;

1318 
pNextRe˘
->
bŸtom
 = bottom;

1319 
pReg
->
numRe˘s
 += 1;

1320 
pNextRe˘
++;

1321 
r
++;

1323 
	}
}

1340 
	$REGION_Subåa˘O
(
MWCLIPREGION
 *
pReg
, 
MWRECT
 *
r1
, MWRECT *
r1End
,

1341 
MWRECT
 *
r2
, MWRECT *
r2End
, 
MWCOORD
 
t›
, MWCOORD 
bŸtom
)

1343 
MWRECT
 *
pNextRe˘
;

1344 
MWCOORD
 
À·
;

1346 
À·
 = 
r1
->left;

1347 
pNextRe˘
 = &
pReg
->
ª˘s
[pReg->
numRe˘s
];

1349 (
r1
 !
r1End
Ë&& (
r2
 !
r2End
))

1351 i‡(
r2
->
right
 <
À·
)

1356 
r2
++;

1358 i‡(
r2
->
À·
 <=Üeft)

1363 
À·
 = 
r2
->
right
;

1364 i‡(
À·
 >
r1
->
right
)

1370 
r1
++;

1371 i‡(
r1
 !
r1End
)

1372 
À·
 = 
r1
->left;

1380 
r2
++;

1383 i‡(
r2
->
À·
 < 
r1
->
right
)

1389 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1390 
pNextRe˘
->
À·
 =Üeft;

1391 
pNextRe˘
->
t›
 =Åop;

1392 
pNextRe˘
->
right
 = 
r2
->
À·
;

1393 
pNextRe˘
->
bŸtom
 = bottom;

1394 
pReg
->
numRe˘s
 += 1;

1395 
pNextRe˘
++;

1396 
À·
 = 
r2
->
right
;

1397 i‡(
À·
 >
r1
->
right
)

1402 
r1
++;

1403 i‡(
r1
 !
r1End
)

1404 
À·
 = 
r1
->left;

1411 
r2
++;

1419 i‡(
r1
->
right
 > 
À·
)

1421 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1422 
pNextRe˘
->
À·
 =Üeft;

1423 
pNextRe˘
->
t›
 =Åop;

1424 
pNextRe˘
->
right
 = 
r1
->right;

1425 
pNextRe˘
->
bŸtom
 = bottom;

1426 
pReg
->
numRe˘s
 += 1;

1427 
pNextRe˘
++;

1429 
r1
++;

1430 
À·
 = 
r1
->left;

1437 
r1
 !
r1End
)

1439 
	`MEMCHECK
(
pReg
, 
pNextRe˘
,ÖReg->
ª˘s
);

1440 
pNextRe˘
->
À·
 =Üeft;

1441 
pNextRe˘
->
t›
 =Åop;

1442 
pNextRe˘
->
right
 = 
r1
->right;

1443 
pNextRe˘
->
bŸtom
 = bottom;

1444 
pReg
->
numRe˘s
 += 1;

1445 
pNextRe˘
++;

1446 
r1
++;

1447 i‡(
r1
 !
r1End
)

1449 
À·
 = 
r1
->left;

1452 
	}
}

1463 
	$GdSubåa˘Regi⁄
(
MWCLIPREGION
 *
ªgD
, MWCLIPREGION *
ªgM
, MWCLIPREGION *
ªgS
 )

1466 i‡–(!(
ªgM
->
numRe˘s
)Ë|| (!(
ªgS
->numRects)) ||

1467 (!
	`EXTENTCHECK
(&
ªgM
->
exã¡s
, &
ªgS
->extents)) )

1469 
	`GdC›yRegi⁄
(
ªgD
, 
ªgM
);

1473 
	`REGION_Regi⁄Op
 (
ªgD
, 
ªgM
, 
ªgS
, 
REGION_Subåa˘O
,

1474 
REGION_Subåa˘N⁄O1
, 
NULL
);

1483 
	`REGION_SëExã¡s
 (
ªgD
);

1484 
ªgD
->
ty≥
 = (ªgD->
numRe˘s
Ë? 
MWREGION_COMPLEX
 : 
MWREGION_NULL
 ;

1485 
	}
}

1496 
	$GdX‹Regi⁄
(
MWCLIPREGION
 *
dr
, MWCLIPREGION *
§a
, MWCLIPREGION *
§b
)

1498 
MWCLIPREGION
 *
åa
, *
åb
;

1500 i‡((! (
åa
 = 
	`GdAŒocRegi⁄
())Ë|| (! (
åb
 = GdAllocRegion())))

1502 
	`GdSubåa˘Regi⁄
(
åa
,
§a
,
§b
);

1503 
	`GdSubåa˘Regi⁄
(
åb
,
§b
,
§a
);

1504 
	`GdUni⁄Regi⁄
(
dr
,
åa
,
åb
);

1505 
	`GdDe°royRegi⁄
(
åa
);

1506 
	`GdDe°royRegi⁄
(
åb
);

1507 
	}
}

1509 
MWCLIPREGION
 *

1510 
	$GdAŒocBôm≠Regi⁄
(
MWIMAGEBITS
 *
bôm≠
, 
MWCOORD
 
width
, MWCOORD 
height
)

1512 
MWRECT
 
ª˘
;

1513 
MWIMAGEBITS
 
bôs
 = 
bôm≠
[0];

1514 
MWCLIPREGION
 * 
rgn
;

1515 
x
, 
y
, 
öª˘
 = 0, 
bônum
 = 0, 
i
 = 0;

1517 if(!(
rgn
 = 
	`GdAŒocRegi⁄
()))

1518  
NULL
;

1521 if(!
bôm≠
 || !
width
 || !
height
)

1522  
rgn
;

1524 
y
 = 0; y < 
height
; y++) {

1525 
ª˘
.
t›
 = 
y
;

1526 
ª˘
.
bŸtom
 = 
y
 + 1;

1527 
x
 = 0; x < 
width
; x++) {

1528 if(!
bônum
--) {

1529 
bônum
 = 15;

1530 
bôs
 = 
bôm≠
[
i
++];

1532 if(
bôs
 & 0x8000) {

1533 if(!
öª˘
) {

1534 
öª˘
 = 1;

1535 
ª˘
.
À·
 = 
x
;

1538 if(
öª˘
) {

1539 
öª˘
 = 0;

1540 
ª˘
.
right
 = 
x
;

1541 
	`GdUni⁄Re˘WôhRegi⁄
(&
ª˘
, 
rgn
);

1544 
bôs
 <<= 1;

1546 if(
öª˘
) {

1547 
ª˘
.
right
 = 
x
;

1548 
	`GdUni⁄Re˘WôhRegi⁄
(&
ª˘
, 
rgn
);

1550 
öª˘
 = 0;

1551 
bônum
 = 0;

1554  
rgn
;

1555 
	}
}

1563 
	$DumpRegi⁄
(
MWCLIPREGION
 *
pReg
)

1565 
MWRECT
 *
pRe˘
, *
pRe˘End
 = 
pReg
->
ª˘s
 +ÖReg->
numRe˘s
;

1567 
	`DPRINTF
("Regi⁄ %p: %d,%d - %d,%d %dÑe˘s\n", 
pReg
,

1568 
pReg
->
exã¡s
.
À·
,ÖReg->exã¡s.
t›
,

1569 
pReg
->
exã¡s
.
right
,ÖReg->exã¡s.
bŸtom
,ÖReg->
numRe˘s
);

1570 
pRe˘
 = 
pReg
->
ª˘s
;ÖRe˘ < 
pRe˘End
;ÖRect++)

1571 
	`DPRINTF
("\t%d,%d - %d,%d\n", 
pRe˘
->
À·
,ÖRe˘->
t›
,

1572 
pRe˘
->
right
,ÖRe˘->
bŸtom
);

1573 
	}
}

	@engine/devrgn2.c

64 
	~<°dio.h
>

65 
	~<°dlib.h
>

66 
	~"devi˚.h
"

68 #i‡
POLYREGIONS


74 
	#NUMPTSTOBUFFER
 200

	)

81 
	s_POINTBLOCK
 {

82 
MWPOINT
 
	m±s
[
NUMPTSTOBUFFER
];

83 
_POINTBLOCK
 *
	m√xt
;

84 } 
	tPOINTBLOCK
;

121 
	#BRESINITPGON
(
dy
, 
x1
, 
x2
, 
xSèπ
, 
d
, 
m
, 
m1
, 
ö¸1
, 
ö¸2
) { \

122 
dx
; \

128 i‡((
dy
) != 0) { \

129 
xSèπ
 = (
x1
); \

130 
dx
 = (
x2
Ë- 
xSèπ
; \

131 i‡(
dx
 < 0) { \

132 
m
 = 
dx
 / (
dy
); \

133 
m1
 = 
m
 - 1; \

134 
ö¸1
 = (-2Ë* (
dx
Ë+ 2 * (
dy
Ë* (
m1
); \

135 
ö¸2
 = (-2Ë* (
dx
Ë+ 2 * (
dy
Ë* (
m
); \

136 
d
 = 2 * (
m
Ë* (
dy
Ë- 2 * (
dx
) - 2 * (dy); \

138 
m
 = 
dx
 / (
dy
); \

139 
m1
 = 
m
 + 1; \

140 
ö¸1
 = (2 * 
dx
Ë- 2 * (
dy
Ë* 
m1
; \

141 
ö¸2
 = (2 * 
dx
Ë- 2 * (
dy
Ë* 
m
; \

142 
d
 = (-2Ë* 
m
 * (
dy
Ë+ 2 * 
dx
; \

145 }

	)

147 
	#BRESINCRPGON
(
d
, 
mövÆ
, 
m
, 
m1
, 
ö¸1
, 
ö¸2
) { \

148 i‡(
m1
 > 0) { \

149 i‡(
d
 > 0) { \

150 
mövÆ
 +
m1
; \

151 
d
 +
ö¸1
; \

154 
mövÆ
 +
m
; \

155 
d
 +
ö¸2
; \

158 i‡(
d
 >= 0) { \

159 
mövÆ
 +
m1
; \

160 
d
 +
ö¸1
; \

163 
mövÆ
 +
m
; \

164 
d
 +
ö¸2
; \

167 }

	)

178 
MWCOORD
 
	mmö‹_axis
;

179 
	md
;

180 
	mm
, 
	mm1
;

181 
	mö¸1
, 
	mö¸2
;

182 } 
	tBRESINFO
;

184 
	#BRESINITPGONSTRUCT
(
dmaj
, 
mö1
, 
mö2
, 
bªs
) \

185 
	`BRESINITPGON
(
dmaj
, 
mö1
, 
mö2
, 
bªs
.
mö‹_axis
, bªs.
d
, \

186 
bªs
.
m
, bªs.
m1
, bªs.
ö¸1
, bªs.
ö¸2
)

	)

188 
	#BRESINCRPGONSTRUCT
(
bªs
) \

189 
	`BRESINCRPGON
(
bªs
.
d
, bªs.
mö‹_axis
, bªs.
m
, bªs.
m1
, bªs.
ö¸1
, bªs.
ö¸2
)

	)

241 
	#CLOCKWISE
 1

	)

242 
	#COUNTERCLOCKWISE
 -1

	)

244 
	s_EdgeTabÀE¡ry
 {

245 
MWCOORD
 
	mymax
;

246 
BRESINFO
 
	mbªs
;

247 
_EdgeTabÀE¡ry
 *
	m√xt
;

248 
_EdgeTabÀE¡ry
 *
	mback
;

249 
_EdgeTabÀE¡ry
 *
	m√xtWETE
;

250 
	mClockWi£
;

251 } 
	tEdgeTabÀE¡ry
;

254 
	s_SˇnLöeLi°
{

255 
	msˇ∆öe
;

256 
EdgeTabÀE¡ry
 *
	medgñi°
;

257 
_SˇnLöeLi°
 *
	m√xt
;

258 } 
	tSˇnLöeLi°
;

262 
MWCOORD
 
	mymax
;

263 
MWCOORD
 
	mymö
;

264 
SˇnLöeLi°
 
	msˇ∆öes
;

265 } 
	tEdgeTabÀ
;

273 
	#SLLSPERBLOCK
 25

	)

275 
	s_SˇnLöeLi°Block
 {

276 
SˇnLöeLi°
 
	mSLLs
[
SLLSPERBLOCK
];

277 
_SˇnLöeLi°Block
 *
	m√xt
;

278 } 
	tSˇnLöeLi°Block
;

293 
	#EVALUATEEDGEWINDING
(
pAET
, 
pPªvAET
, 
y
, 
fixWAET
) { \

294 i‡(
pAET
->
ymax
 =
y
) { \

295 
pPªvAET
->
√xt
 = 
pAET
->next; \

296 
pAET
 = 
pPªvAET
->
√xt
; \

297 
fixWAET
 = 1; \

298 i‡(
pAET
) \

299 
pAET
->
back
 = 
pPªvAET
; \

302 
	`BRESINCRPGONSTRUCT
(
pAET
->
bªs
); \

303 
pPªvAET
 = 
pAET
; \

304 
pAET
 =ÖAET->
√xt
; \

306 }

	)

316 
	#EVALUATEEDGEEVENODD
(
pAET
, 
pPªvAET
, 
y
) { \

317 i‡(
pAET
->
ymax
 =
y
) { \

318 
pPªvAET
->
√xt
 = 
pAET
->next; \

319 
pAET
 = 
pPªvAET
->
√xt
; \

320 i‡(
pAET
) \

321 
pAET
->
back
 = 
pPªvAET
; \

324 
	`BRESINCRPGONSTRUCT
(
pAET
->
bªs
); \

325 
pPªvAET
 = 
pAET
; \

326 
pAET
 =ÖAET->
√xt
; \

328 }

	)

332 
	#LARGE_COORDINATE
 
MWCOORD_MAX


	)

333 
	#SMALL_COORDINATE
 
MWCOORD_MIN


	)

344 
	$REGION_In£πEdgeInET
(
EdgeTabÀ
 *
ET
, 
EdgeTabÀE¡ry
 *
ETE
,

345 
sˇ∆öe
, 
SˇnLöeLi°Block
 **
SLLBlock
, *
iSLLBlock
)

348 
EdgeTabÀE¡ry
 *
°¨t
, *
¥ev
;

349 
SˇnLöeLi°
 *
pSLL
, *
pPªvSLL
;

350 
SˇnLöeLi°Block
 *
tmpSLLBlock
;

355 
pPªvSLL
 = &
ET
->
sˇ∆öes
;

356 
pSLL
 = 
pPªvSLL
->
√xt
;

357 
pSLL
 && (pSLL->
sˇ∆öe
 < scanline))

359 
pPªvSLL
 = 
pSLL
;

360 
pSLL
 =ÖSLL->
√xt
;

366 i‡((!
pSLL
Ë|| (pSLL->
sˇ∆öe
 > scanline))

368 i‡(*
iSLLBlock
 > 
SLLSPERBLOCK
-1)

370 
tmpSLLBlock
 = 
	`mÆloc
–(
SˇnLöeLi°Block
));

371 if(!
tmpSLLBlock
)

375 (*
SLLBlock
)->
√xt
 = 
tmpSLLBlock
;

376 
tmpSLLBlock
->
√xt
 = (
SˇnLöeLi°Block
 *)
NULL
;

377 *
SLLBlock
 = 
tmpSLLBlock
;

378 *
iSLLBlock
 = 0;

380 
pSLL
 = &((*
SLLBlock
)->
SLLs
[(*
iSLLBlock
)++]);

382 
pSLL
->
√xt
 = 
pPªvSLL
->next;

383 
pSLL
->
edgñi°
 = (
EdgeTabÀE¡ry
 *)
NULL
;

384 
pPªvSLL
->
√xt
 = 
pSLL
;

386 
pSLL
->
sˇ∆öe
 = scanline;

391 
¥ev
 = (
EdgeTabÀE¡ry
 *)
NULL
;

392 
°¨t
 = 
pSLL
->
edgñi°
;

393 
°¨t
 && (°¨t->
bªs
.
mö‹_axis
 < 
ETE
->bres.minor_axis))

395 
¥ev
 = 
°¨t
;

396 
°¨t
 = sèπ->
√xt
;

398 
ETE
->
√xt
 = 
°¨t
;

400 i‡(
¥ev
)

401 
¥ev
->
√xt
 = 
ETE
;

403 
pSLL
->
edgñi°
 = 
ETE
;

404 
	}
}

431 
	$REGION_Cª©eET™dAET
(*
Cou¡
, 
nbpﬁyg⁄s
,

432 
MWPOINT
 *
±s
, 
EdgeTabÀ
 *
ET
, 
EdgeTabÀE¡ry
 *
AET
,

433 
EdgeTabÀE¡ry
 *
pETEs
, 
SˇnLöeLi°Block
 *
pSLLBlock
)

435 
MWPOINT
 *
t›
, *
bŸtom
;

436 
MWPOINT
 *
PªvPt
, *
CuºPt
, *
EndPt
;

437 
pﬁy
, 
cou¡
;

438 
iSLLBlock
 = 0;

439 
dy
;

445 
AET
->
√xt
 = (
EdgeTabÀE¡ry
 *)
NULL
;

446 
AET
->
back
 = (
EdgeTabÀE¡ry
 *)
NULL
;

447 
AET
->
√xtWETE
 = (
EdgeTabÀE¡ry
 *)
NULL
;

448 
AET
->
bªs
.
mö‹_axis
 = 
SMALL_COORDINATE
;

453 
ET
->
sˇ∆öes
.
√xt
 = (
SˇnLöeLi°
 *)
NULL
;

454 
ET
->
ymax
 = 
SMALL_COORDINATE
;

455 
ET
->
ymö
 = 
LARGE_COORDINATE
;

456 
pSLLBlock
->
√xt
 = (
SˇnLöeLi°Block
 *)
NULL
;

458 
EndPt
 = 
±s
 - 1;

459 
pﬁy
 = 0;Öﬁy < 
nbpﬁyg⁄s
;Öoly++)

461 
cou¡
 = 
Cou¡
[
pﬁy
];

462 
EndPt
 +
cou¡
;

463 if(
cou¡
 < 2)

466 
PªvPt
 = 
EndPt
;

473 
cou¡
--)

475 
CuºPt
 = 
±s
++;

479 i‡(
PªvPt
->
y
 > 
CuºPt
->y)

481 
bŸtom
 = 
PªvPt
, 
t›
 = 
CuºPt
;

482 
pETEs
->
ClockWi£
 = 0;

486 
bŸtom
 = 
CuºPt
, 
t›
 = 
PªvPt
;

487 
pETEs
->
ClockWi£
 = 1;

493 i‡(
bŸtom
->
y
 !
t›
->y)

495 
pETEs
->
ymax
 = 
bŸtom
->
y
-1;

501 
dy
 = 
bŸtom
->
y
 - 
t›
->y;

503 
	`BRESINITPGONSTRUCT
(
dy
, 
t›
->
x
, 
bŸtom
->x, 
pETEs
->
bªs
);

505 
	`REGION_In£πEdgeInET
(
ET
, 
pETEs
, 
t›
->
y
, &
pSLLBlock
,

506 &
iSLLBlock
);

508 i‡(
PªvPt
->
y
 > 
ET
->
ymax
)

509 
ET
->
ymax
 = 
PªvPt
->
y
;

510 i‡(
PªvPt
->
y
 < 
ET
->
ymö
)

511 
ET
->
ymö
 = 
PªvPt
->
y
;

512 
pETEs
++;

515 
PªvPt
 = 
CuºPt
;

518 
	}
}

528 
	$REGION_lﬂdAET
(
EdgeTabÀE¡ry
 *
AET
, EdgeTabÀE¡ry *
ETEs
)

530 
EdgeTabÀE¡ry
 *
pPªvAET
;

531 
EdgeTabÀE¡ry
 *
tmp
;

533 
pPªvAET
 = 
AET
;

534 
AET
 = AET->
√xt
;

535 
ETEs
)

537 
AET
 && (AET->
bªs
.
mö‹_axis
 < 
ETEs
->bres.minor_axis))

539 
pPªvAET
 = 
AET
;

540 
AET
 = AET->
√xt
;

542 
tmp
 = 
ETEs
->
√xt
;

543 
ETEs
->
√xt
 = 
AET
;

544 i‡(
AET
)

545 
AET
->
back
 = 
ETEs
;

546 
ETEs
->
back
 = 
pPªvAET
;

547 
pPªvAET
->
√xt
 = 
ETEs
;

548 
pPªvAET
 = 
ETEs
;

550 
ETEs
 = 
tmp
;

552 
	}
}

574 
	$REGION_compuãWAET
(
EdgeTabÀE¡ry
 *
AET
)

576 
EdgeTabÀE¡ry
 *
pWETE
;

577 
öside
 = 1;

578 
isInside
 = 0;

580 
AET
->
√xtWETE
 = (
EdgeTabÀE¡ry
 *)
NULL
;

581 
pWETE
 = 
AET
;

582 
AET
 = AET->
√xt
;

583 
AET
)

585 i‡(
AET
->
ClockWi£
)

586 
isInside
++;

588 
isInside
--;

590 i‡((!
öside
 && !
isInside
) ||

591 –
öside
 && 
isInside
))

593 
pWETE
->
√xtWETE
 = 
AET
;

594 
pWETE
 = 
AET
;

595 
öside
 = !inside;

597 
AET
 = AET->
√xt
;

599 
pWETE
->
√xtWETE
 = (
EdgeTabÀE¡ry
 *)
NULL
;

600 
	}
}

610 
MWBOOL
 
	$REGION_In£πi⁄S‹t
(
EdgeTabÀE¡ry
 *
AET
)

612 
EdgeTabÀE¡ry
 *
pETEcha£
;

613 
EdgeTabÀE¡ry
 *
pETEö£π
;

614 
EdgeTabÀE¡ry
 *
pETEcha£BackTMP
;

615 
MWBOOL
 
ch™ged
 = 
FALSE
;

617 
AET
 = AET->
√xt
;

618 
AET
)

620 
pETEö£π
 = 
AET
;

621 
pETEcha£
 = 
AET
;

622 
pETEcha£
->
back
->
bªs
.
mö‹_axis
 > 
AET
->bres.minor_axis)

623 
pETEcha£
 =ÖETEcha£->
back
;

625 
AET
 = AET->
√xt
;

626 i‡(
pETEcha£
 !
pETEö£π
)

628 
pETEcha£BackTMP
 = 
pETEcha£
->
back
;

629 
pETEö£π
->
back
->
√xt
 = 
AET
;

630 i‡(
AET
)

631 
AET
->
back
 = 
pETEö£π
->back;

632 
pETEö£π
->
√xt
 = 
pETEcha£
;

633 
pETEcha£
->
back
->
√xt
 = 
pETEö£π
;

634 
pETEcha£
->
back
 = 
pETEö£π
;

635 
pETEö£π
->
back
 = 
pETEcha£BackTMP
;

636 
ch™ged
 = 
TRUE
;

639  
ch™ged
;

640 
	}
}

647 
	$REGION_FªeSt‹age
(
SˇnLöeLi°Block
 *
pSLLBlock
)

649 
SˇnLöeLi°Block
 *
tmpSLLBlock
;

651 
pSLLBlock
)

653 
tmpSLLBlock
 = 
pSLLBlock
->
√xt
;

654 
	`‰ì
–
pSLLBlock
 );

655 
pSLLBlock
 = 
tmpSLLBlock
;

657 
	}
}

665 
	$REGION_PtsToRegi⁄
(
numFuŒPtBlocks
, 
iCurPtBlock
,

666 
POINTBLOCK
 *
Fú°PtBlock
, 
MWCLIPREGION
 *
ªg
)

668 
MWRECT
 *
ª˘s
;

669 
MWPOINT
 *
±s
;

670 
POINTBLOCK
 *
CurPtBlock
;

671 
i
;

672 
MWRECT
 *
exã¡s
;

673 
numRe˘s
;

675 
exã¡s
 = &
ªg
->extents;

677 
numRe˘s
 = ((
numFuŒPtBlocks
 * 
NUMPTSTOBUFFER
Ë+ 
iCurPtBlock
) >> 1;

679 i‡(!(
ªg
->
ª˘s
 = 
	`GdRóŒoc
–ªg->ª˘s, (
MWRECT
Ë*Ñeg->
size
, (MWRECTË* 
numRe˘s
 )))

682 
ªg
->
size
 = 
numRe˘s
;

683 
CurPtBlock
 = 
Fú°PtBlock
;

684 
ª˘s
 = 
ªg
->rects - 1;

685 
numRe˘s
 = 0;

686 
exã¡s
->
À·
 = 
LARGE_COORDINATE
,Éxã¡s->
right
 = 
SMALL_COORDINATE
;

688  ; 
numFuŒPtBlocks
 >= 0;ÇumFullPtBlocks--) {

690 
i
 = 
NUMPTSTOBUFFER
 >> 1;

691 i‡(!
numFuŒPtBlocks
)

692 
i
 = 
iCurPtBlock
 >> 1;

693 
±s
 = 
CurPtBlock
->±s; 
i
--;Öts += 2) {

694 i‡(
±s
->
x
 ==Öts[1].x)

696 i‡(
numRe˘s
 && 
±s
->
x
 =
ª˘s
->
À·
 &&Öts->
y
 =ª˘s->
bŸtom
 &&

697 
±s
[1].
x
 =
ª˘s
->
right
 &&

698 (
numRe˘s
 =1 || 
ª˘s
[-1].
t›
 !=Ñects->top) &&

699 (
i
 && 
±s
[2].
y
 >Öts[1].y)) {

700 
ª˘s
->
bŸtom
 = 
±s
[1].
y
 + 1;

703 
numRe˘s
++;

704 
ª˘s
++;

705 
ª˘s
->
À·
 = 
±s
->
x
;Ñe˘s->
t›
 =Öts->
y
;

706 
ª˘s
->
right
 = 
±s
[1].
x
;Ñe˘s->
bŸtom
 =Öts[1].
y
 + 1;

707 i‡(
ª˘s
->
À·
 < 
exã¡s
->left)

708 
exã¡s
->
À·
 = 
ª˘s
->left;

709 i‡(
ª˘s
->
right
 > 
exã¡s
->right)

710 
exã¡s
->
right
 = 
ª˘s
->right;

712 
CurPtBlock
 = CurPtBlock->
√xt
;

715 i‡(
numRe˘s
) {

716 
exã¡s
->
t›
 = 
ªg
->
ª˘s
->top;

717 
exã¡s
->
bŸtom
 = 
ª˘s
->bottom;

719 
exã¡s
->
À·
 = 0;

720 
exã¡s
->
t›
 = 0;

721 
exã¡s
->
right
 = 0;

722 
exã¡s
->
bŸtom
 = 0;

724 
ªg
->
numRe˘s
 =ÇumRects;

726 (
TRUE
);

727 
	}
}

732 
MWCLIPREGION
 *

733 
	$GdAŒocPﬁyg⁄Regi⁄
(
MWPOINT
 *
poöts
, 
cou¡
, 
mode
)

735  
	`GdAŒocPﬁyPﬁyg⁄Regi⁄
(
poöts
, &
cou¡
, 1, 
mode
 );

736 
	}
}

741 
MWCLIPREGION
 *

742 
	$GdAŒocPﬁyPﬁyg⁄Regi⁄
(
MWPOINT
 *
poöts
, *
cou¡
, 
nbpﬁyg⁄s
, 
mode
)

744 
MWCLIPREGION
 *
rgn
;

745 
EdgeTabÀE¡ry
 *
pAET
;

746 
y
;

747 
iPts
 = 0;

748 
EdgeTabÀE¡ry
 *
pWETE
;

749 
SˇnLöeLi°
 *
pSLL
;

750 
MWPOINT
 *
±s
;

751 
EdgeTabÀE¡ry
 *
pPªvAET
;

752 
EdgeTabÀ
 
ET
;

753 
EdgeTabÀE¡ry
 
AET
;

754 
EdgeTabÀE¡ry
 *
pETEs
;

755 
SˇnLöeLi°Block
 
SLLBlock
;

756 
fixWAET
 = 
FALSE
;

757 
POINTBLOCK
 
Fú°PtBlock
, *
curPtBlock
;

758 
POINTBLOCK
 *
tmpPtBlock
;

759 
numFuŒPtBlocks
 = 0;

760 
pﬁy
, 
tŸÆ
;

762 if(!(
rgn
 = 
	`GdAŒocRegi⁄
()))

763  
NULL
;

767 i‡(((
nbpﬁyg⁄s
 =1Ë&& ((*
cou¡
 == 4) ||

768 ((*
cou¡
 =5Ë&& (
poöts
[4].
x
 ==Öoints[0].x)

769 && (
poöts
[4].
y
 ==Öoints[0].y)))) &&

770 (((
poöts
[0].
y
 ==Öoints[1].y) &&

771 (
poöts
[1].
x
 ==Öoints[2].x) &&

772 (
poöts
[2].
y
 ==Öoints[3].y) &&

773 (
poöts
[3].
x
 ==Öoints[0].x)) ||

774 ((
poöts
[0].
x
 ==Öoints[1].x) &&

775 (
poöts
[1].
y
 ==Öoints[2].y) &&

776 (
poöts
[2].
x
 ==Öoints[3].x) &&

777 (
poöts
[3].
y
 ==Öoints[0].y))))

779 
	`GdSëRe˘Regi⁄
–
rgn
,

780 
	`MWMIN
(
poöts
[0].
x
,Öoöts[2].x), MWMIN’oöts[0].
y
,Öoints[2].y),

781 
	`MWMAX
(
poöts
[0].
x
,Öoöts[2].x), MWMAX’oöts[0].
y
,Öoints[2].y) );

782  
rgn
;

785 
pﬁy
 = 
tŸÆ
 = 0;Öﬁy < 
nbpﬁyg⁄s
;Öoly++)

786 
tŸÆ
 +
cou¡
[
pﬁy
];

787 i‡(! (
pETEs
 = 
	`mÆloc
–(
EdgeTabÀE¡ry
Ë* 
tŸÆ
 )))

789 
	`GdDe°royRegi⁄
–
rgn
 );

792 
±s
 = 
Fú°PtBlock
.pts;

793 
	`REGION_Cª©eET™dAET
(
cou¡
, 
nbpﬁyg⁄s
, 
poöts
, &
ET
, &
AET
,

794 
pETEs
, &
SLLBlock
);

795 
pSLL
 = 
ET
.
sˇ∆öes
.
√xt
;

796 
curPtBlock
 = &
Fú°PtBlock
;

798 i‡(
mode
 !
MWPOLY_WINDING
) {

802 
y
 = 
ET
.
ymö
; y < ET.
ymax
; y++) {

807 i‡(
pSLL
 !
NULL
 && 
y
 =pSLL->
sˇ∆öe
) {

808 
	`REGION_lﬂdAET
(&
AET
, 
pSLL
->
edgñi°
);

809 
pSLL
 =ÖSLL->
√xt
;

811 
pPªvAET
 = &
AET
;

812 
pAET
 = 
AET
.
√xt
;

817 
pAET
) {

818 
±s
->
x
 = 
pAET
->
bªs
.
mö‹_axis
,Öts->
y
 = y;

819 
±s
++, 
iPts
++;

824 i‡(
iPts
 =
NUMPTSTOBUFFER
) {

825 
tmpPtBlock
 = 
	`mÆloc
–(
POINTBLOCK
));

826 if(!
tmpPtBlock
) {

829 
curPtBlock
->
√xt
 = 
tmpPtBlock
;

830 
curPtBlock
 = 
tmpPtBlock
;

831 
±s
 = 
curPtBlock
->pts;

832 
numFuŒPtBlocks
++;

833 
iPts
 = 0;

835 
	`EVALUATEEDGEEVENODD
(
pAET
, 
pPªvAET
, 
y
);

838 
	`REGION_In£πi⁄S‹t
(&
AET
);

845 
y
 = 
ET
.
ymö
; y < ET.
ymax
; y++) {

850 i‡(
pSLL
 !
NULL
 && 
y
 =pSLL->
sˇ∆öe
) {

851 
	`REGION_lﬂdAET
(&
AET
, 
pSLL
->
edgñi°
);

852 
	`REGION_compuãWAET
(&
AET
);

853 
pSLL
 =ÖSLL->
√xt
;

855 
pPªvAET
 = &
AET
;

856 
pAET
 = 
AET
.
√xt
;

857 
pWETE
 = 
pAET
;

862 
pAET
) {

867 i‡(
pWETE
 =
pAET
) {

868 
±s
->
x
 = 
pAET
->
bªs
.
mö‹_axis
,Öts->
y
 = y;

869 
±s
++, 
iPts
++;

874 i‡(
iPts
 =
NUMPTSTOBUFFER
) {

875 
tmpPtBlock
 = 
	`mÆloc
–(
POINTBLOCK
) );

876 if(!
tmpPtBlock
) {

879 
curPtBlock
->
√xt
 = 
tmpPtBlock
;

880 
curPtBlock
 = 
tmpPtBlock
;

881 
±s
 = 
curPtBlock
->pts;

882 
numFuŒPtBlocks
++; 
iPts
 = 0;

884 
pWETE
 =ÖWETE->
√xtWETE
;

886 
	`EVALUATEEDGEWINDING
(
pAET
, 
pPªvAET
, 
y
, 
fixWAET
);

893 i‡(
	`REGION_In£πi⁄S‹t
(&
AET
Ë|| 
fixWAET
) {

894 
	`REGION_compuãWAET
(&
AET
);

895 
fixWAET
 = 
FALSE
;

899 
	`REGION_FªeSt‹age
(
SLLBlock
.
√xt
);

900 
	`REGION_PtsToRegi⁄
(
numFuŒPtBlocks
, 
iPts
, &
Fú°PtBlock
, 
rgn
);

901 
curPtBlock
 = 
Fú°PtBlock
.
√xt
; --
numFuŒPtBlocks
 >= 0;) {

902 
tmpPtBlock
 = 
curPtBlock
->
√xt
;

903 
	`‰ì
–
curPtBlock
 );

904 
curPtBlock
 = 
tmpPtBlock
;

906 
	`‰ì
–
pETEs
 );

907  
rgn
;

908 
	}
}

	@engine/devstipple.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~"devi˚.h
"

13 
MWPIXELVAL
 
gr_f‹eground
;

14 
MWPIXELVAL
 
gr_background
;

15 
gr_fûlmode
;

16 
MWSTIPPLE
 
gr_°ù∂e
;

17 
MWTILE
 
gr_tûe
;

18 
MWPOINT
 
gr_ts_off£t
;

20 
	gts_‹igö_x
 = 0;

21 
	gts_‹igö_y
 = 0;

24 
	#SPITCH
 ((
gr_°ù∂e
.
width
 + (
MWIMAGE_BITSPERIMAGE
 - 1)Ë/ MWIMAGE_BITSPERIMAGE)

	)

31 
	#BIT_SET
(
d©a
, 
w
, 
h
) \

32 (
d©a
[(
h
 * 
SPITCH
Ë+ (
w
 / 
MWIMAGE_BITSPERIMAGE
)] & (1 << ((MWIMAGE_BITSPERIMAGE - 1Ë- (w % MWIMAGE_BITSPERIMAGE))))

	)

35 
	$GdSëStù∂eBôm≠
(
MWIMAGEBITS
 *
°ù∂e
, 
MWCOORD
 
width
, MWCOORD 
height
)

37 
x
, 
y
;

38 
size
;

40 i‡(
gr_°ù∂e
.
bôm≠
)

41 
	`‰ì
(
gr_°ù∂e
.
bôm≠
);

43 
gr_°ù∂e
.
width
 = 0;

44 
gr_°ù∂e
.
height
 = 0;

46 i‡(!
°ù∂e
) {

47 
gr_°ù∂e
.
bôm≠
 = 0;

51 
size
 = 
	`MWIMAGE_SIZE
(
width
, 
height
Ë* (
MWIMAGEBITS
);

52 
gr_°ù∂e
.
bôm≠
 = 
	`mÆloc
(
size
);

53 i‡(!
gr_°ù∂e
.
bôm≠
)

55 
gr_°ù∂e
.
width
 = width;

56 
gr_°ù∂e
.
height
 = height;

57 
	`mem˝y
(
gr_°ù∂e
.
bôm≠
, 
°ù∂e
, 
size
);

60 
y
 = 0; y < 
height
; y++) {

61 
x
 = 0; x < 
width
; x++) {

62 i‡(
	`BIT_SET
(
gr_°ù∂e
.
bôm≠
, 
x
, 
y
))

63 
	`DPRINTF
("X");

65 
	`DPRINTF
("_");

67 
	`DPRINTF
("\n");

70 
	}
}

73 
	$GdSëTûePixm≠
(
PSD
 
§c
, 
MWCOORD
 
width
, MWCOORD 
height
)

75 
gr_tûe
.
psd
 = 
§c
;

76 i‡(!
§c
) {

77 
gr_tûe
.
width
 = 0;

78 
gr_tûe
.
height
 = 0;

80 
gr_tûe
.
width
 = width;

81 
gr_tûe
.
height
 = height;

83 
	}
}

87 
	$GdSëTSOff£t
(
x
, 
y
)

89 
gr_ts_off£t
.
x
 = x;

90 
gr_ts_off£t
.
y
 = y;

91 
	}
}

98 
	$tûe_døwª˘
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
w
, MWCOORD 
h
)

100 
sx
 = 
x
, 
sy
 = 
y
;

101 
px
 = 0, 
py
 = 0;

102 
dw
 = 
w
;

103 
dh
 = 
h
;

106 
tûex
 = 
x
 - 
ts_‹igö_x
;

107 
tûey
 = 
y
 - 
ts_‹igö_y
;

110 i‡(!
gr_tûe
.
psd
 || !gr_tûe.
width
 || !gr_tûe.
height
)

114 i‡(
tûex
 < 0) {

115 
sx
 +-
tûex
;

116 
dw
 --
tûex
;

118 i‡(
sx
 > (
x
 + 
w
 - 1))

120 
tûex
 = 
sx
 - 
ts_‹igö_x
;

123 i‡(
tûey
 < 0) {

124 
sy
 +-
tûey
;

125 
dh
 --
tûey
;

127 i‡(
sy
 > (
y
 + 
h
 - 1))

129 
tûey
 = 
sy
 - 
ts_‹igö_y
;

132 
dh
) {

133 
ch
 = (
gr_tûe
.
height
 - ((
tûey
 + 
py
) % gr_tile.height));

134 i‡(
ch
 > 
dh
)

135 
ch
 = 
dh
;

137 
dw
 = 
w
;

138 
px
 = 0;

140 
dw
) {

141 
cw
 = (
gr_tûe
.
width
 -

142 ((
tûex
 + 
px
Ë% 
gr_tûe
.
width
));

143 i‡(
cw
 > 
dw
)

144 
cw
 = 
dw
;

146 
	`GdBlô
(
psd
, 
sx
 + 
px
, 
sy
 + 
py
, 
cw
, 
ch
, 
gr_tûe
.psd,

147 ((
tûex
 + 
px
Ë% 
gr_tûe
.
width
),

148 ((
tûey
 + 
py
Ë% 
gr_tûe
.
height
), 
MWROP_SRCCOPY
);

149 
dw
 -
cw
;

150 
px
 +
cw
;

152 
dh
 -
ch
;

153 
py
 +
ch
;

155 
	}
}

160 
	$£t_ts_‹igö
(
x
, 
y
)

162 
ts_‹igö_x
 = 
x
 + 
gr_ts_off£t
.x;

163 
ts_‹igö_y
 = 
y
 + 
gr_ts_off£t
.y;

164 
	}
}

168 
	$ts_døwpoöt
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
)

170 
bx
 = 
x
 - 
ts_‹igö_x
;

171 
by
 = 
y
 - 
ts_‹igö_y
;

175 i‡(
gr_fûlmode
 =
MWFILL_STIPPLE


176 || 
gr_fûlmode
 =
MWFILL_OPAQUE_STIPPLE
) {

177 i‡(!
gr_°ù∂e
.
bôm≠
 || !gr_°ù∂e.
width


178 || !
gr_°ù∂e
.
height
)

181 i‡(!
gr_tûe
.
psd
 || !gr_tûe.
width
 || !gr_tûe.
height
)

186 i‡(!
	`GdClùPoöt
(
psd
, 
x
, 
y
))

194 i‡(
bx
 < 0 || 
by
 < 0) {

195 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

199 
gr_fûlmode
) {

200 
MWFILL_OPAQUE_STIPPLE
:

202 i‡(!
	`BIT_SET
(
gr_°ù∂e
.
bôm≠
, (
bx
 % gr_°ù∂e.
width
), (
by
 % gr_°ù∂e.
height
)))

203 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_background
);

206 
MWFILL_STIPPLE
:

207 i‡(
	`BIT_SET
(
gr_°ù∂e
.
bôm≠
, (
bx
 % gr_°ù∂e.
width
), (
by
 % gr_°ù∂e.
height
)))

208 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
, 
gr_f‹eground
);

211 
MWFILL_TILE
:

214 
psd
->
	`DøwPixñ
’sd, 
x
, 
y
,

215 
gr_tûe
.
psd
->
	`RódPixñ
(gr_tile.psd,

216 (
bx
 % 
gr_tûe
.
width
), (
by
 % gr_tûe.
height
)));

219 
	}
}

223 
	$ts_døwrow
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
)

225 
x
;

226 
d°width
 = 
x2
 - 
x1
 + 1;

228 
gr_fûlmode
) {

229 
MWFILL_STIPPLE
:

230 
MWFILL_OPAQUE_STIPPLE
:

231 
x
 = 
x1
; x <
x2
; x++)

232 
	`ts_døwpoöt
(
psd
, 
x
, 
y
);

234 
MWFILL_TILE
:

235 
	`tûe_døwª˘
(
psd
, 
x1
, 
y
, 
d°width
, 1);

237 
	}
}

240 
	$ts_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
w
, MWCOORD 
h
)

242 
x1
 = 
x
;

243 
x2
 = 
x
 + 
w
 - 1;

244 
y1
 = 
y
;

245 
y2
 = 
y
 + 
h
 - 1;

247 i‡(
	`GdClùAªa
(
psd
, 
x1
, 
y1
, 
x2
, 
y2
Ë=
CLIP_INVISIBLE
)

250 i‡(
gr_fûlmode
 =
MWFILL_TILE
)

251 
	`tûe_døwª˘
(
psd
, 
x
, 
y
, 
w
, 
h
);

253 ; 
y1
 <
y2
; y1++)

254 
	`ts_døwrow
(
psd
, 
x1
, 
x2
, 
y1
);

255 
	}
}

	@engine/devtimer.c

54 
	~<°dio.h
>

55 
	~<uni°d.h
>

56 
	~<°dlib.h
>

57 
	~"devi˚.h
"

59 #i‡
MW_FEATURE_TIMERS


61 
MWTIMER
 *
	gtimîli°
 = 
NULL
;

62 
timevÆ
 
	gmaölo›_timeout
;

63 
timevÆ
 
	gcuºít_time
;

65 
ˇlcuœã_timevÆ
(
timevÆ
 *
tv
, 
MWTIMEOUT
 
to
);

66 sig√d 
time_to_expúy
(
timevÆ
 *
t
);

77 
MWTIMER
 *
	$GdAddTimî
(
MWTIMEOUT
 
timeout
, 
MWTIMERCB
 
ˇŒback
, *
¨g
)

79 
MWTIMER
 *
√wtimî
;

81 if(!(
√wtimî
 = 
	`mÆloc
((
MWTIMER
)))Ë 
NULL
;

83 
	`gëtimeofday
(&
cuºít_time
, 
NULL
);

85 if(
timîli°
Ëtimîli°->
¥ev
 = 
√wtimî
;

87 
	`ˇlcuœã_timevÆ
(&
√wtimî
->
timeout
,Åimeout);

88 
√wtimî
->
ˇŒback
 = callback;

89 
√wtimî
->
¨g
 =árg;

90 
√wtimî
->
√xt
 = 
timîli°
;

91 
√wtimî
->
¥ev
 = 
NULL
;

92 
√wtimî
->
ty≥
 = 
MWTIMER_ONESHOT
;

93 
√wtimî
->
≥riod
 = 
timeout
;

94 
timîli°
 = 
√wtimî
;

96  
√wtimî
;

97 
	}
}

107 
MWTIMER
 *
	$GdAddPîiodicTimî
(
MWTIMEOUT
 
timeout
, 
MWTIMERCB
 
ˇŒback
, *
¨g
)

109 
MWTIMER
 *
√wtimî
;

111 if(!(
√wtimî
 = 
	`mÆloc
((
MWTIMER
)))Ë 
NULL
;

113 
	`gëtimeofday
 (&
cuºít_time
, 
NULL
);

115 i‡(
timîli°
Ëtimîli°->
¥ev
 = 
√wtimî
;

117 
	`ˇlcuœã_timevÆ
 (&
√wtimî
->
timeout
,Åimeout);

118 
√wtimî
->
ˇŒback
 = callback;

119 
√wtimî
->
¨g
 =árg;

120 
√wtimî
->
√xt
 = 
timîli°
;

121 
√wtimî
->
¥ev
 = 
NULL
;

122 
√wtimî
->
ty≥
 = 
MWTIMER_PERIODIC
;

123 
√wtimî
->
≥riod
 = 
timeout
;

124 
timîli°
 = 
√wtimî
;

126  
√wtimî
;

127 
	}
}

134 
	$GdDe°royTimî
(
MWTIMER
 *
timî
)

136 if(
timî
->
√xt
Ëtimî->√xt->
¥ev
 =Åimer->prev;

137 if(
timî
->
¥ev
Ëtimî->¥ev->
√xt
 =Åimer->next;

138 if(
timî
 =
timîli°
) {

139 if(
timî
->
√xt
Ë
timîli°
 =Åimer->next;

140 
timîli°
 = 
timî
->
¥ev
;

142 
	`‰ì
(
timî
);

143 
	}
}

151 
MWTIMER
 *
	$GdFödTimî
(*
¨g
)

153 
MWTIMER
 *
t
 = 
timîli°
;

155 
t
) {

156 if(
t
->
¨g
 ==árg) ;

157 
t
 =Å->
√xt
;

160  
t
;

161 
	}
}

170 
MWBOOL
 
	$GdGëNextTimeout
(
timevÆ
 *
tv
, 
MWTIMEOUT
 
timeout
)

172 sig√d 
i
, 
lowe°_timeout
;

173 
MWTIMER
 *
t
 = 
timîli°
;

175 if(!
timeout
 && !
timîli°
Ë 
FALSE
;

177 
	`gëtimeofday
(&
cuºít_time
, 
NULL
);

179 if(
timeout
) {

180 
	`ˇlcuœã_timevÆ
(&
maölo›_timeout
, 
timeout
);

181 
lowe°_timeout
 = 
	`time_to_expúy
(&
maölo›_timeout
);

183 
lowe°_timeout
 = 
	`time_to_expúy
(&
t
->
timeout
);

184 
maölo›_timeout
.
tv_£c
 = -1;

185 
t
 =Å->
√xt
;

188 
t
) {

189 
i
 = 
	`time_to_expúy
(&
t
->
timeout
);

190 if(
i
 < 
lowe°_timeout
)Üowest_timeout = i;

191 
t
 =Å->
√xt
;

194 if(
lowe°_timeout
 <= 0) {

195 
tv
->
tv_£c
 = 0;

196 
tv
->
tv_u£c
 = 0;

198 
tv
->
tv_£c
 = 
lowe°_timeout
 / 1000;

199 
tv
->
tv_u£c
 = (
lowe°_timeout
 % 1000) * 1000;

202  
TRUE
;

203 
	}
}

210 
MWBOOL
 
	$GdTimeout
()

212 
MWTIMER
 *
n
, *
t
 = 
timîli°
;

214 
	`gëtimeofday
(&
cuºít_time
, 
NULL
);

216 
t
) {

217 
n
 = 
t
->
√xt
;

218 if(
	`time_to_expúy
(&
t
->
timeout
) <= 0) {

219 
t
->
	`ˇŒback
—->
¨g
);

220 i‡(
t
->
ty≥
 =
MWTIMER_ONESHOT
)

223 
	`GdDe°royTimî
(
t
);

228 
	`ˇlcuœã_timevÆ
 (&
t
->
timeout
,Å->
≥riod
);

231 
t
 = 
n
;

234 if(
maölo›_timeout
.
tv_£c
 > 0 || maölo›_timeout.
tv_u£c
 > 0)

235 if(
	`time_to_expúy
(&
maölo›_timeout
) <= 0)

236  
TRUE
;

238  
FALSE
;

239 
	}
}

241 
	$ˇlcuœã_timevÆ
(
timevÆ
 *
tv
, 
MWTIMEOUT
 
to
)

243 
tv
->
tv_£c
 = 
cuºít_time
.tv_£¯+ (
to
 / 1000);

244 
tv
->
tv_u£c
 = 
cuºít_time
.tv_u£¯+ ((
to
 % 1000) * 1000);

245 if(
tv
->
tv_u£c
 > 1000000) {

246 
tv
->
tv_£c
++;

247 
tv
->
tv_u£c
 -= 1000000;

249 
	}
}

251 sig√d 
	$time_to_expúy
(
timevÆ
 *
t
)

253 
MWTIMEOUT
 
ªt
 = (((
t
->
tv_£c
 - 
cuºít_time
.tv_sec) * 1000) +

254 ((
t
->
tv_u£c
 - 
cuºít_time
.tv_usec) / 1000));

256  
ªt
;

257 
	}
}

	@engine/error.c

11 
	~<°dio.h
>

12 
	~<°d¨g.h
>

13 
	~<°rög.h
>

14 #i‡(
UNIX
 | 
DOS_DJGPP
)

15 
	~<uni°d.h
>

17 
	~"devi˚.h
"

19 #i‡
MW_FEATURE_GDERROR


24 
	$GdEº‹
(c⁄° *
f‹m©
, ...)

26 
va_li°
 
¨gs
;

27 
buf
[1024];

29 
	`va_°¨t
(
¨gs
, 
f‹m©
);

31 
	`v•rötf
(
buf
, 
f‹m©
, 
¨gs
);

32 #i‡!
PSP


33 
	`wrôe
(2, 
buf
, 
	`°æí
(buf));

35 
	`va_íd
(
¨gs
);

37 
	}
}

43 
	$GdEº‹NuŒ
(c⁄° *
f‹m©
, ...)

46 
	}
}

	@engine/font_dbcs.c

11 
	~<°dio.h
>

12 
	~<°dlib.h
>

13 
	~"devi˚.h
"

14 
	~"devf⁄t.h
"

15 
	~"../drivîs/gíf⁄t.h
"

17 #i‡
HAVE_BIG5_SUPPORT


19 
	$big5_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

20 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

22 
CH
 = 
ch
 >> 8;

23 
CL
 = 
ch
 & 0xFF;

24 
pos
;

25 
i
;

26 
£q
 = 0;

27 
MWIMAGEBITS
 
m≠
[12];

28 
JMT_BIG5_12X12_FONT_BITMAP
[];

33 
CL
 -= (CL < 127)? 64 : 98;

35 i‡(
CH
 >= 0xa4) {

36 
£q
 = ((
CH
 - 164Ë* 157Ë+ 
CL
;

37 i‡(
£q
 >= 5809)

38 
£q
 -= 408;

40 i‡(
CH
 <= 0xa3)

41 
£q
 = (((
CH
 - 161Ë* 157Ë+ 
CL
) + 13094;

42 
pos
 = 
£q
 * 18;

44 
i
 = 0; i < 6; i++) {

45 *
d°
 = ((*)
m≠
Ë+ 
i
 * 4;

46 *
§c
 = 
JMT_BIG5_12X12_FONT_BITMAP
 +

47 
pos
 + 
i
 * 3;

48 
d°
[0] = 
§c
[1];

49 
d°
[1] = 
§c
[0];

50 
d°
[2] = 
§c
[1] << 4;

51 
d°
[3] = 
§c
[2];

54 *
pwidth
 = 12;

55 *
pheight
 = 12;

56 *
pba£
 = 0;

57 *
ªtm≠
 = 
m≠
;

58 
	}
}

61 #i‡
HAVE_GB2312_SUPPORT


63 
	$euc˙_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

64 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

66 
CH
 = 
ch
 >> 8;

67 
CL
 = 
ch
 & 0xFF;

68 
pos
 = ((
CH
 - 0xA1Ë* 94 + (
CL
 - 0xA1)) * 18;

69 
i
;

70 
MWIMAGEBITS
 
m≠
[12];

71 
GUO_GB2312_12X12_FONT_BITMAP
[];

74 
i
 = 0; i < 6; i++) {

75 *
d°
 = ((*)
m≠
Ë+ 
i
 * 4;

76 *
§c
 = 
GUO_GB2312_12X12_FONT_BITMAP
 +

77 
pos
 + 
i
 * 3;

78 
d°
[0] = 
§c
[1];

79 
d°
[1] = 
§c
[0];

80 
d°
[2] = 
§c
[1] << 4;

81 
d°
[3] = 
§c
[2];

83 *
pwidth
 = 12;

84 *
pheight
 = 12;

85 *
pba£
 = 0;

86 *
ªtm≠
 = 
m≠
;

87 
	}
}

90 #i‡
HAVE_JISX0213_SUPPORT


92 
	$jis_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

93 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

95 
CH
 = 
ch
 >> 8;

96 
CL
 = 
ch
 & 0xFF;

97 
pos
 = 0;

98 *
m≠
;

99 
JP_JISX0213_12X12_FONT_BITMAP
[];

102 i‡(
CH
 >0xA1 && CH <0xFE && 
CL
 >= 0xA1 && CL <= 0xFE) {

103 
pos
 = (
CH
 - 0xA1Ë* 94 + (
CL
 - 0xA1);

106 i‡((
CH
 >= 0x81 && CH <= 0x9F) || (CH >= 0xE0 && CH <= 0xEF)) {

107 
EH
 = 0;

108 
EL
 = 0;

110 i‡(
CH
 >= 0x81 && CH <= 0x9F &&

111 
CL
 >= 0x40 && CL <= 0xFC && CL != 0x7F) {

112 
EH
 = 
CH
 - 0x81;

113 i‡(
CL
 >= 0x40 && CL <= 0x7E)

114 
EL
 = 
CL
 - 0x40;

115 i‡(
CL
 >= 0x80 && CL <= 0xFC)

116 
EL
 = 
CL
 - 0x40 - 1;

117 
pos
 = 
EH
 * 188 + 
EL
;

119 i‡(
CH
 >= 0xE0 && CH <= 0xEF &&

120 
CL
 >= 0x40 && CL <= 0xFC && CL != 0x7F) {

121 
EH
 = 
CH
 - 0xE0 + (0x9F - 0x81);

122 i‡(
CL
 >= 0x40 && CL <= 0x7E)

123 
EL
 = 
CL
 - 0x40;

124 i‡(
CL
 >= 0x80 && CL <= 0xFC)

125 
EL
 = 
CL
 - 0x40 - 1;

126 
pos
 = 
EH
 * 188 + 
EL
;

129 
m≠
 = 
JP_JISX0213_12X12_FONT_BITMAP
 + 
pos
 * 12;

131 *
pwidth
 = 12;

132 *
pheight
 = 12;

133 *
pba£
 = 0;

134 *
ªtm≠
 = (
MWIMAGEBITS
 *)
m≠
;

135 
	}
}

138 #i‡
HAVE_KSC5601_SUPPORT


140 
	$euckr_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

141 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

143 
CH
 = 
ch
 >> 8;

144 
CL
 = 
ch
 & 0xFF;

145 
mc
;

146 
MWIMAGEBITS
 
m≠
[16];

147 
	`c⁄vît_ksc_to_johab
(
CH
,

148 
CL
);

149 
	`gë_h™_image
(
mc
, *
ªtm≠
);

152 
mc
 = 
	`c⁄vît_ksc_to_johab
(
CH
, 
CL
);

153 i‡(
mc
)

154 
	`gë_h™_image
(
mc
, (*Ë
m≠
);

156 *
pwidth
 = 16;

157 *
pheight
 = 16;

158 *
pba£
 = 0;

159 *
ªtm≠
 = 
m≠
;

160 
	}
}

164 
	$dbcs_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, 
MWTEXTFLAGS
 
Êags
,

165 c⁄° 
MWIMAGEBITS
 **
ªtm≠
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

166 
MWCOORD
 *
pba£
)

169 (*
func
)(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

170 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

172 i‡(
ch
 >= 0x0100) {

173 
Êags
 & 
MWTF_DBCSMASK
) {

174 #i‡
HAVE_BIG5_SUPPORT


175 
MWTF_DBCS_BIG5
:

176 
func
 = 
big5_gëãxtbôs
;

179 #i‡
HAVE_GB2312_SUPPORT


180 
MWTF_DBCS_EUCCN
:

181 
func
 = 
euc˙_gëãxtbôs
;

184 #i‡
HAVE_KSC5601_SUPPORT


185 
MWTF_DBCS_EUCKR
:

186 
func
 = 
euckr_gëãxtbôs
;

189 #i‡
HAVE_JISX0213_SUPPORT


190 
MWTF_DBCS_JIS
:

191 
func
 = 
jis_gëãxtbôs
;

196 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

200 
func
 = 
gí_gëãxtbôs
;

203 
	`func
(
pf⁄t
, 
ch
, 
ªtm≠
, 
pwidth
, 
pheight
, 
pba£
);

204 
	}
}

211 
	$dbcs_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
,

212 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

214 
PMWCFONT
 
pf
 = ((
PMWCOREFONT
)
pf⁄t
)->
cf⁄t
;

215 
c
;

216 
width
 = 0;

218 
Êags
 &
MWTF_DBCSMASK
;

219 --
cc
 >= 0) {

220 
c
 = *
°r
++;

221 i‡(
c
 >= 0x0100) {

222 
Êags
) {

223 
MWTF_DBCS_BIG5
:

224 
MWTF_DBCS_EUCCN
:

225 
MWTF_DBCS_JIS
:

227 
width
 += 12;

229 
MWTF_DBCS_EUCKR
:

230 
width
 += 12;

233 } if(
c
 >
pf
->
fú°ch¨
 && c <Öf->fú°ch¨+pf->
size
)

234 
width
 +
pf
->width?Öf->width[
c
 -Öf->
fú°ch¨
]:

235 
pf
->
maxwidth
;

237 *
pwidth
 = 
width
;

238 *
pheight
 = 
pf
->
height
;

239 *
pba£
 = 
pf
->
as˚¡
;

240 
	}
}

	@engine/font_eucjp.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<°rög.h
>

13 
	~<uni°d.h
>

14 
	~<sys/ty≥s.h
>

15 
	~<sys/mm™.h
>

16 
	~<f˙é.h
>

17 #i‚de‡
MAP_FAILED


18 
	#MAP_FAILED
 ((*)-1)

	)

20 
	~"devi˚.h
"

21 
	~"devf⁄t.h
"

22 
	~"../drivîs/gíf⁄t.h
"

24 
	sMWEUCJPFONT
 {

25 
PMWFONTPROCS
 
	mf⁄çrocs
;

26 
	mf⁄tsize
;

27 
	mf⁄åŸ©i⁄
;

28 
	mf⁄èâr
;

30 
	mwidth
;

31 
	mheight
;

32 
	mkoff£t
;

33 
	mkwidth
;

34 
	mkbyãs
;

35 
	maoff£t
;

36 
	mawidth
;

37 
	mabyãs
;

38 
	mfd
;

39 *
	mf⁄t_ba£
;

40 } 
	tMWEUCJPFONT
;

42 
PMWEUCJPFONT
 
eucjp_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

43 
MWBOOL
 
eucjp_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

44 
eucjp_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

45 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

46 
eucjp_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

47 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

48 
MWCOORD
 *
pba£
);

49 
eucjp_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

52 
MWFONTPROCS
 
	geucjp_¥ocs
 = {

53 
MWTF_UC16
,

54 
eucjp_gëf⁄töfo
,

55 
eucjp_gëãxtsize
,

56 
eucjp_gëãxtbôs
,

57 
eucjp_de°royf⁄t
,

58 
c‹ef⁄t_døwãxt
,

59 
NULL
,

60 
NULL
,

61 
NULL
,

62 
NULL
,

70 
PMWEUCJPFONT


71 
	$eucjp_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

73 
PMWEUCJPFONT
 
pf
;

74 
fd
, 
r
;

75 
fsize
;

76 
vî
, 
mfw
, 
mfh
;

77 
buf
[256];

78 
‚ame
[256];

81 
pf
 = (
PMWEUCJPFONT
Ë
	`ˇŒoc
((
MWEUCJPFONT
), 1);

82 i‡(!
pf
)

83  
NULL
;

85 
fd
 = 
	`›í
(
«me
, 
O_RDONLY
);

86 i‡(
fd
 < 0) {

87 
	`°r˝y
(
‚ame
, 
EUCJP_FONT_DIR
 "/");

88 
	`°r˝y
(
‚ame
 + (
EUCJP_FONT_DIR
), 
«me
);

89 
fd
 = 
	`›í
(
‚ame
, 
O_RDONLY
);

91 i‡(
fd
 < 0)

92 
EUCJP_FAIL
;

94 
r
 = 
	`ªad
(
fd
, 
buf
, 256);

95 i‡(
r
 != 256) {

96 
	`¥ötf
("FONT_EUCJP: c™'àªad %s\n", 
«me
);

97 
EUCJP_FAIL
;

100 
fsize
 = 
	`l£ek
(
fd
, 0L, 
SEEK_END
);

101 
	`l£ek
(
fd
, 0L, 
SEEK_SET
);

103 i‡(
	`ssˇnf
(
buf
, "#MGLFONT%02d%02d%02d", &
vî
, &
mfw
, &
mfh
) == 3) {

105 
	`¥ötf
("FONT_EUCJP: magic is missing.\n");

106 
EUCJP_FAIL
;

109 
pf
->
f⁄çrocs
 = &
eucjp_¥ocs
;

110 
pf
->
f⁄tsize
 = 
height
;

111 
pf
->
f⁄åŸ©i⁄
 = 0;

112 
pf
->
f⁄èâr
 = 
©å
;

114 
pf
->
height
 = 
mfh
;

115 
pf
->
width
 = 
mfw
;

116 
pf
->
aoff£t
 = 32;

117 
pf
->
awidth
 = (
mfw
 / 2 + 7) / 8;

118 
pf
->
abyãs
 =Öf->
awidth
 * 
mfh
;

119 
pf
->
koff£t
 =Öf->
aoff£t
 +Öf->
abyãs
 * 256;

120 
pf
->
kwidth
 = (
mfw
 + 7) / 8;

121 
pf
->
kbyãs
 =Öf->
kwidth
 * 
mfh
;

122 
pf
->
fd
 = fd;

123 i‡(
fsize
 !
pf
->
koff£t
 +Öf->
kbyãs
 * 8064) {

124 
	`¥ötf
("FONT_EUCJP: Not MGL font file(filesize doesn't match).\n");

125 
EUCJP_FAIL
;

127 
pf
->
f⁄t_ba£
 =

128 (*Ë
	`mm≠
((
ˇddr_t
Ë0, 
pf
->
koff£t
 +Öf->
kbyãs
 * 8064,

129 
PROT_READ
, 
MAP_SHARED
 | 
MAP_FILE
, 
fd
, 0);

130 i‡(
pf
->
f⁄t_ba£
 =
MAP_FAILED
) {

131 
	`¥ötf
("FONT_EUCJP: Can't mmap font data.\n");

132 
EUCJP_FAIL
;

135  
pf
;

137 
EUCJP_FAIL
:

138 
	`‰ì
(
pf
);

139 
	`˛o£
(
fd
);

140  
NULL
;

141 
	}
}

144 
MWBOOL


145 
	$eucjp_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

147 
PMWEUCJPFONT
 
pf
 = (PMWEUCJPFONTË
pf⁄t
;

148 
i
;

150 
pf⁄töfo
->
height
 = 
pf
->height;

151 
pf⁄töfo
->
maxwidth
 = 
pf
->
width
;

152 
pf⁄töfo
->
ba£löe
 = 
pf
->
height
 - 2;

155 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
;

156 
pf⁄töfo
->
des˚¡
 =Öf⁄töfo->
height
 -Öf⁄töfo->
ba£löe
;

157 
pf⁄töfo
->
maxas˚¡
 =Öf⁄töfo->
ba£löe
;

158 
pf⁄töfo
->
maxdes˚¡
 =Öf⁄töfo->
des˚¡
;

160 
pf⁄töfo
->
fú°ch¨
 = 0;

161 
pf⁄töfo
->
œ°ch¨
 = 0;

162 
pf⁄töfo
->
fixed
 = 
TRUE
;

164 
i
 = 0; i < 256; i++)

165 
pf⁄töfo
->
widths
[
i
] = 
pf
->
width
 / 2;

167  
TRUE
;

169 
	}
}

173 
	$eucjp_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

174 
MWCOORD
 * 
pwidth
, MWCOORD * 
pheight
, MWCOORD * 
pba£
)

176 
PMWEUCJPFONT
 
pf
 = (PMWEUCJPFONTË
pf⁄t
;

178 *
pwidth
 = 
	`°æí
(
ãxt
Ë* 
pf
->
width
 / 2;

179 *
pheight
 = 
pf
->
height
;

180 *
pba£
 = 
pf
->
height
 - 2;

181 
	}
}

185 
	$eucjp_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
MWIMAGEBITS
 **
ªtm≠
,

186 
MWCOORD
 * 
pwidth
, MWCOORD * 
pheight
, MWCOORD * 
pba£
)

188 
PMWEUCJPFONT
 
pf
 = (PMWEUCJPFONTË
pf⁄t
;

189 *
Âä
;

190 
i
, 
byãwidth
;

191 
MWIMAGEBITS
 
m≠
[
MAX_CHAR_HEIGHT
 * 
MAX_CHAR_WIDTH
 / 
MWIMAGE_BITSPERIMAGE
];

192 
MWIMAGEBITS
 *
bôm≠
 = 
m≠
;

194 *
ªtm≠
 = 
m≠
;

195 *
pheight
 = 
pf
->
height
;

196 *
pba£
 = 
pf
->
height
 - 2;

197 i‡(
ch
 < 256) {

198 *
pwidth
 = 
pf
->
width
 / 2;

199 
Âä
 = &(
pf
->
f⁄t_ba£
[pf->
aoff£t
 +Öf->
abyãs
 * 
ch
]);

200 
byãwidth
 = 
pf
->
awidth
;

202 
kix
 = (((
ch
 >> 8) & 0xff) - 0xA1) * 96 + ((ch & 0xff) - 0xA0);

203 i‡(
kix
 < 0 || 8000 <= kix)

204 
kix
 = 0;

206 *
pwidth
 = 
pf
->
width
;

207 
Âä
 = &(
pf
->
f⁄t_ba£
[pf->
koff£t
 +Öf->
kbyãs
 * 
kix
]);

208 
byãwidth
 = 
pf
->
kwidth
;

211 
i
 = 0; i < 
pf
->
height
; i++) {

212 
MWIMAGEBITS
 
±n0
, 
±n1
, 
±n2
, 
±n3
;

213 
byãwidth
) {

215 
±n0
 = *(
Âä
) & 0xFF;

216 *
bôm≠
++ = *(
Âä
) << 8;

219 
±n0
 = *(
Âä
) & 0xFF;

220 
±n1
 = *(
Âä
 + 1) & 0xFF;

221 *
bôm≠
++ = 
±n0
 << 8 | 
±n1
;

224 
±n0
 = *(
Âä
) & 0xFF;

225 
±n1
 = *(
Âä
 + 1) & 0xFF;

226 
±n2
 = *(
Âä
 + 2) & 0xFF;

227 *
bôm≠
++ = 
±n0
 << 8 | 
±n1
;

228 *
bôm≠
++ = 
±n2
 << 8;

231 
±n0
 = *(
Âä
) & 0xFF;

232 
±n1
 = *(
Âä
 + 1) & 0xFF;

233 
±n2
 = *(
Âä
 + 2) & 0xFF;

234 
±n3
 = *(
Âä
 + 3) & 0xFF;

235 *
bôm≠
++ = 
±n0
 << 8 | 
±n1
;

236 *
bôm≠
++ = 
±n2
 << 8 | 
±n3
;

245 
Âä
 +
byãwidth
;

247 
	}
}

251 
	$eucjp_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

253 
PMWEUCJPFONT
 
pf
 = (PMWEUCJPFONTË
pf⁄t
;

255 
	`munm≠
(
pf
->
f⁄t_ba£
,Öf->
koff£t
 +Öf->
kbyãs
 * 8064);

256 
	`˛o£
(
pf
->
fd
);

257 
	}
}

	@engine/font_fnt.c

7 
	~<°dio.h
>

8 
	~<°rög.h
>

9 
	~"sw≠.h
"

10 
	~"devi˚.h
"

11 
	~"devf⁄t.h
"

12 
	~"../drivîs/gíf⁄t.h
"

39 
	#VERSION
 "RB11"

	)

44 #ifde‡
HAVE_FNTGZ_SUPPORT


45 
	~<zlib.h
>

46 
	#FILEP
 
gzFûe


	)

47 
	#FOPEN
(
∑th
, 
mode
Ë
	`gz›í
’©h, mode)

	)

48 
	#FREAD
(
fûe
, 
buf„r
, 
size
Ë
	`gzªad
(fûe, buf„r, size)

	)

49 
	#FSEEK
(
fûe
, 
off£t
, 
whí˚
Ë
	`gz£ek
(fûe, off£t, whí˚)

	)

50 
	#FCLOSE
(
fûe
Ë
	`gz˛o£
(fûe)

	)

52 
	#FILEP
 
FILE
 *

	)

53 
	#FOPEN
(
∑th
, 
mode
Ë
	`f›í
’©h, mode)

	)

54 
	#FREAD
(
fûe
, 
buf„r
, 
size
Ë
	`‰ód
(buf„r, 1, size, fûe)

	)

55 
	#FSEEK
(
fûe
, 
off£t
, 
whí˚
Ë
	`f£ek
(fûe, off£t, whí˚)

	)

56 
	#FCLOSE
(
fûe
Ë
	`f˛o£
(fûe)

	)

60 
‚t_u∆ﬂdf⁄t
(
PMWFONT
 
f⁄t
);

61 
PMWCFONT
 
‚t_lﬂd_f⁄t
(c⁄° *
∑th
);

64 
MWFONTPROCS
 
	g‚t_f⁄çrocs
 = {

65 
MWTF_ASCII
,

66 
gí_gëf⁄töfo
,

67 
gí_gëãxtsize
,

68 
gí_gëãxtbôs
,

69 
‚t_u∆ﬂdf⁄t
,

70 
c‹ef⁄t_døwãxt
,

71 
NULL
,

72 
NULL
,

73 
NULL
,

74 
NULL
,

78 
MWFONTPROCS
 
	g‚t_f⁄çrocs16
 = {

79 
MWTF_UC16
,

80 
gí_gëf⁄töfo
,

81 
gí16_gëãxtsize
,

82 
gí_gëãxtbôs
,

83 
‚t_u∆ﬂdf⁄t
,

84 
gí16_døwãxt
,

85 
NULL
,

86 
NULL
,

87 
NULL
,

88 
NULL
,

91 
PMWCOREFONT


92 
	$‚t_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

94 
PMWCOREFONT
 
pf
;

95 
PMWCFONT
 
cf⁄t
;

96 
uc16
;

99 
cf⁄t
 = 
	`‚t_lﬂd_f⁄t
(
«me
);

100 i‡(!
cf⁄t
)

101  
NULL
;

103 i‡(!(
pf
 = (
MWCOREFONT
 *Ë
	`mÆloc
((MWCOREFONT)))) {

104 
	`‰ì
(
cf⁄t
);

105  
NULL
;

109 
uc16
 = 
cf⁄t
->
fú°ch¨
 > 255 ||

110 (
cf⁄t
->
fú°ch¨
 + cf⁄t->
size
) > 255;

111 
pf
->
f⁄çrocs
 = 
uc16
? &
‚t_f⁄çrocs16
: &
‚t_f⁄çrocs
;

113 
pf
->
f⁄tsize
 =Öf->
f⁄åŸ©i⁄
 =Öf->
f⁄èâr
 = 0;

114 
pf
->
«me
 = "FNT";

115 
pf
->
cf⁄t
 = cfont;

116  
pf
;

117 
	}
}

120 
	$‚t_u∆ﬂdf⁄t
(
PMWFONT
 
f⁄t
)

122 
PMWCOREFONT
 
pf
 = (PMWCOREFONT)
f⁄t
;

123 
PMWCFONT
 
pfc
 = 
pf
->
cf⁄t
;

125 i‡(
pfc
) {

126 i‡(
pfc
->
width
)

127 
	`‰ì
(
pf
->
cf⁄t
->
width
);

128 i‡(
pfc
->
off£t
)

129 
	`‰ì
(
pf
->
cf⁄t
->
off£t
);

130 i‡(
pfc
->
bôs
)

131 
	`‰ì
(
pf
->
cf⁄t
->
bôs
);

132 i‡(
pfc
->
«me
)

133 
	`‰ì
(
pf
->
cf⁄t
->
«me
);

135 
	`‰ì
(
pfc
);

138 
	`‰ì
(
f⁄t
);

139 
	}
}

142 
	$READBYTE
(
FILEP
 
Â
, *
˝
)

144 #ifde‡
HAVE_FNTGZ_SUPPORT


145 
buf
[1];

147 i‡(
	`FREAD
(
Â
, 
buf
, 1) != 1)

149 *
˝
 = 
buf
[0];

151 
c
;

153 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

155 *
˝
 = ()
c
;

158 
	}
}

161 
	$READSHORT
(
FILEP
 
Â
, *
•
)

163 #ifde‡
HAVE_FNTGZ_SUPPORT


164 
buf
[2];

166 i‡(
	`FREAD
(
Â
, 
buf
, 2) != 2)

168 *
•
 = 
buf
[0] | (buf[1] << 8);

170 
c
;

171 
s
;

173 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

175 
s
 = 
c
 & 0xff;

176 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

178 *
•
 = (
c
 << 8Ë| 
s
;

181 
	}
}

184 
	$READLONG
(
FILEP
 
Â
, *
Õ
)

186 #ifde‡
HAVE_FNTGZ_SUPPORT


187 
buf
[4];

189 i‡(
	`FREAD
(
Â
, 
buf
, 4) != 4)

191 *
Õ
 = 
buf
[0] | (buf[1] << 8) | (buf[2] << 16) | (buf[3] << 24);

193 
c
;

194 
l
;

196 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

198 
l
 = 
c
 & 0xff;

199 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

201 
l
 |(
c
 << 8);

202 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

204 
l
 |(
c
 << 16);

205 i‡((
c
 = 
	`gëc
(
Â
)Ë=
EOF
)

207 *
Õ
 = (
c
 << 24Ë| 
l
;

210 
	}
}

214 
	$READSTR
(
FILEP
 
Â
, *
buf
, 
cou¡
)

216  
	`FREAD
(
Â
, 
buf
, 
cou¡
);

217 
	}
}

222 
	$READSTRPAD
(
FILEP
 
Â
, *
buf
, 
tŸÀn
)

224 *
p
;

226 i‡(
	`FREAD
(
Â
, 
buf
, 
tŸÀn
) !=Åotlen)

228 
p
 = &
buf
[
tŸÀn
];

229 *
p
-- = 0;

230 *
p
 =' ' &&Ö >
buf
)

231 *
p
-- = '\0';

232  
tŸÀn
;

233 
	}
}

236 
PMWCFONT


237 
	$‚t_lﬂd_f⁄t
(c⁄° *
∑th
)

239 
FILEP
 
iÂ
;

240 
PMWCFONT
 
pf
 = 
NULL
;

241 
i
;

242 
maxwidth
, 
height
, 
as˚¡
, 
∑d
;

243 
fú°ch¨
, 
deÁu…ch¨
, 
size
;

244 
nbôs
, 
noff£t
, 
nwidth
;

245 
vîsi⁄
[4+1];

246 
«me
[64+1];

247 
c›yright
[256+1];

248 
‚ame
[256];

250 
iÂ
 = 
	`FOPEN
(
∑th
, "rb");

252 i‡(!
iÂ
) {

253 
	`°r˝y
(
‚ame
, 
FNT_FONT_DIR
 "/");

254 
	`°r˝y
(
‚ame
 + (
FNT_FONT_DIR
), 
∑th
);

255 
iÂ
 = 
	`FOPEN
(
‚ame
, "rb");

258 i‡(!
iÂ
) {

259 *
ív
 = 
	`gëív
("MWFONTDIR");

260 i‡(
ív
) {

261 
	`•rötf
(
‚ame
, "%s/%s", 
ív
, 
∑th
);

263 
	`¥ötf
("TryögÅÿgë f⁄à‰om %s\n", 
‚ame
);

264 
iÂ
 = 
	`FOPEN
(
‚ame
, "rb");

269 i‡(!
iÂ
)

270  
NULL
;

273 
	`mem£t
(
vîsi⁄
, 0, (version));

274 i‡(
	`READSTR
(
iÂ
, 
vîsi⁄
, 4) != 4)

275 
îrout
;

276 i‡(
	`°rcmp
(
vîsi⁄
, 
VERSION
) != 0)

277 
îrout
;

279 
pf
 = (
PMWCFONT
)
	`ˇŒoc
(1, (
MWCFONT
));

280 i‡(!
pf
)

281 
îrout
;

284 i‡(
	`READSTRPAD
(
iÂ
, 
«me
, 64) != 64)

285 
îrout
;

286 
pf
->
«me
 = (*)
	`mÆloc
(
	`°æí
(name)+1);

287 i‡(!
pf
->
«me
)

288 
îrout
;

289 
	`°r˝y
(
pf
->
«me
,Çame);

292 i‡(
	`READSTRPAD
(
iÂ
, 
c›yright
, 256) != 256)

293 
îrout
;

296 i‡(!
	`READSHORT
(
iÂ
, &
maxwidth
))

297 
îrout
;

298 
pf
->
maxwidth
 = maxwidth;

299 i‡(!
	`READSHORT
(
iÂ
, &
height
))

300 
îrout
;

301 
pf
->
height
 = height;

302 i‡(!
	`READSHORT
(
iÂ
, &
as˚¡
))

303 
îrout
;

304 
pf
->
as˚¡
 =áscent;

305 i‡(!
	`READSHORT
(
iÂ
, &
∑d
))

306 
îrout
;

307 i‡(!
	`READLONG
(
iÂ
, &
fú°ch¨
))

308 
îrout
;

309 
pf
->
fú°ch¨
 = firstchar;

310 i‡(!
	`READLONG
(
iÂ
, &
deÁu…ch¨
))

311 
îrout
;

312 
pf
->
deÁu…ch¨
 = defaultchar;

313 i‡(!
	`READLONG
(
iÂ
, &
size
))

314 
îrout
;

315 
pf
->
size
 = size;

319 i‡(!
	`READLONG
(
iÂ
, &
nbôs
))

320 
îrout
;

321 
pf
->
bôs
 = (
MWIMAGEBITS
 *)
	`mÆloc
(
nbôs
 * (MWIMAGEBITS));

322 i‡(!
pf
->
bôs
)

323 
îrout
;

324 
pf
->
bôs_size
 = 
nbôs
;

327 i‡(!
	`READLONG
(
iÂ
, &
noff£t
))

328 
îrout
;

329 i‡(
noff£t
) {

330 
pf
->
off£t
 = (*)
	`mÆloc
(
noff£t
 * ());

331 i‡(!
pf
->
off£t
)

332 
îrout
;

336 i‡(!
	`READLONG
(
iÂ
, &
nwidth
))

337 
îrout
;

338 i‡(
nwidth
) {

339 
pf
->
width
 = (*)
	`mÆloc
(
nwidth
 * ());

340 i‡(!
pf
->
width
)

341 
îrout
;

345 
i
=0; i<
nbôs
; ++i)

346 i‡(!
	`READSHORT
(
iÂ
, &
pf
->
bôs
[
i
]))

347 
îrout
;

349 i‡(
	`·ñl
(
iÂ
) & 02)

350 i‡(!
	`READSHORT
(
iÂ
, &
pf
->
bôs
[
i
]))

351 
îrout
;

352 i‡(
noff£t
)

353 
i
=0; i<
pf
->
size
; ++i)

354 i‡(!
	`READLONG
(
iÂ
, &
pf
->
off£t
[
i
]))

355 
îrout
;

356 i‡(
nwidth
)

357 
i
=0; i<
pf
->
size
; ++i)

358 i‡(!
	`READBYTE
(
iÂ
, &
pf
->
width
[
i
]))

359 
îrout
;

361 
	`FCLOSE
(
iÂ
);

362  
pf
;

364 
îrout
:

365 
	`FCLOSE
(
iÂ
);

366 i‡(!
pf
)

367  
NULL
;

368 i‡(
pf
->
«me
)

369 
	`‰ì
(
pf
->
«me
);

370 i‡(
pf
->
bôs
)

371 
	`‰ì
(
pf
->
bôs
);

372 i‡(
pf
->
off£t
)

373 
	`‰ì
(
pf
->
off£t
);

374 i‡(
pf
->
width
)

375 
	`‰ì
(
pf
->
width
);

376 
	`‰ì
(
pf
);

377  
NULL
;

378 
	}
}

	@engine/font_freetype.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	~<m©h.h
>

13 
	~<dúít.h
>

14 
	~<‰ìty≥/‰ìty≥.h
>

15 
	~<‰ìty≥/·xkîn.h
>

16 
	~<‰ìty≥/·«meid.h
>

17 
	~<‰ìty≥/·xcm≠.h
>

18 
	~<‰ìty≥/·xwidth.h
>

19 
	~"devi˚.h
"

20 
	~"devf⁄t.h
"

22 #i‡
TT_FREETYPE_MAJOR
 !1 || 
TT_FREETYPE_MINOR
 < 3

26 
	sMWFREETYPEFONT
 {

27 
PMWFONTPROCS
 
	mf⁄çrocs
;

28 
MWCOORD
 
	mf⁄tsize
;

29 
	mf⁄åŸ©i⁄
;

30 
	mf⁄èâr
;

32 
TT_Fa˚
 
	mÁ˚
;

33 
TT_In°™˚
 
	mö°™˚
;

34 
TT_Ch¨M≠
 
	mch¨_m≠
;

35 
TT_Kînög
 
	mdúe˘‹y
;

36 
TT_M©rix
 
	mm©rix
;

37 
TT_Glyph
 
	mglyph
;

38 
MWBOOL
 
	mˇn_kîn
;

39 
	mœ°_glyph_code
;

40 
	mœ°_≥n_pos
;

41 } 
	tMWFREETYPEFONT
;

43 
‰ìty≥_öô
(
PSD
 
psd
);

44 
PMWFREETYPEFONT
 
‰ìty≥_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

46 
MWBOOL
 
‰ìty≥_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

47 
‰ìty≥_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

48 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

49 
MWCOORD
 *
pba£
);

50 
‰ìty≥_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

51 
‰ìty≥_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

52 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

53 
‰ìty≥_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
);

54 
‰ìty≥_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
);

57 
MWFONTPROCS
 
	g‰ìty≥_¥ocs
 = {

58 
MWTF_UC16
,

59 
‰ìty≥_gëf⁄töfo
,

60 
‰ìty≥_gëãxtsize
,

61 
NULL
,

62 
‰ìty≥_de°royf⁄t
,

63 
‰ìty≥_døwãxt
,

64 
‰ìty≥_£tf⁄tsize
,

65 
‰ìty≥_£tf⁄åŸ©i⁄
,

66 
NULL
,

67 
NULL
,

70 
TT_Engöe
 
	gígöe
;

71 
OUTPIXELVAL
 
	ggøy_∑Àâe
[5];

74 
MWPIXELVAL
 
gr_f‹eground
;

75 
MWPIXELVAL
 
gr_background
;

76 
MWBOOL
 
gr_u£bg
;

79 
	$‰ìty≥_öô
(
PSD
 
psd
)

81 
öôed
 = 0;

83 i‡(
öôed
)

87 i‡(
	`TT_Inô_FªeTy≥
 (&
ígöe
Ë!
TT_Eº_Ok
) {

92 i‡(
	`TT_Inô_Kînög_Exãnsi⁄
 (
ígöe
Ë!
TT_Eº_Ok
)

95 
öôed
 = 1;

97 
	}
}

99 
PMWFREETYPEFONT


100 
	$‰ìty≥_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

102 
PMWFREETYPEFONT
 
pf
;

103 
i
, 
n
;

104 
∂©f‹m
, 
ícodög
;

105 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

106 * 
p
;

107 
f⁄äame
[128];

110 i‡(
	`°rchr
(
«me
, '/'Ë!
NULL
)

111 
	`°r˝y
(
f⁄äame
, 
«me
);

113 
	`°r˝y
(
f⁄äame
, 
FREETYPE_FONT_DIR
);

114 
	`°rˇt
(
f⁄äame
, "/");

115 
	`°rˇt
(
f⁄äame
, 
«me
);

119 i‡((
p
 = 
	`°ºchr
(
f⁄äame
, '.')Ë=
NULL
 ||

120 
	`°rcmp
(
p
, ".ttf") != 0) {

121 
	`°rˇt
(
f⁄äame
, ".ttf");

125 
pf
 = (
PMWFREETYPEFONT
)
	`ˇŒoc
((
MWFREETYPEFONT
), 1);

126 i‡(!
pf
)

127  
NULL
;

128 
pf
->
f⁄çrocs
 = &
‰ìty≥_¥ocs
;

131 i‡(
	`TT_O≥n_Fa˚
 (
ígöe
, 
f⁄äame
, &
pf
->
Á˚
Ë!
TT_Eº_Ok
)

132 
out
;

135 
pf
->
ˇn_kîn
 = 
TRUE
;

136 i‡(
	`TT_Lﬂd_Kînög_TabÀ
 (
pf
->
Á˚
, 0Ë!
TT_Eº_Ok
)

137 
pf
->
ˇn_kîn
 = 
FALSE
;

139 i‡(
	`TT_Gë_Kînög_Dúe˘‹y
 (
pf
->
Á˚
, &pf->
dúe˘‹y
)

140 !
TT_Eº_Ok
)

141 
pf
->
ˇn_kîn
 = 
FALSE
;

144 i‡((
pf
->
dúe˘‹y
.
vîsi⁄
 != 0) ||

145 (
pf
->
dúe˘‹y
.
nTabÀs
 <= 0) ||

146 (
pf
->
dúe˘‹y
.
èbÀs
->
lﬂded
 != 1) ||

147 (
pf
->
dúe˘‹y
.
èbÀs
->
vîsi⁄
 != 0) ||

148 (
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.
nPaús
 <= 0))

149 
pf
->
ˇn_kîn
 = 
FALSE
;

154 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

161 
h
 = 
¥›îtõs
.
os2
->
sTypoAs˚ndî
 -Ör›îtõs.os2->
sTypoDes˚ndî


162 + 
¥›îtõs
.
os2
->
sTypoLöeG≠
;

163 
as˚¡
 = 
¥›îtõs
.
os2
->
sTypoAs˚ndî


164 + 
¥›îtõs
.
os2
->
sTypoLöeG≠
/2;

165 
pf
->
as˚¡
 = (as˚¡ * 
height
 + 
h
/2) / h;

166 
pf
->
des˚¡
 = 
height
 -Öf->
as˚¡
;

169 i‡(
	`TT_New_Glyph
 (
pf
->
Á˚
, &pf->
glyph
Ë!
TT_Eº_Ok
)

170 
out
;

173 i‡(
	`TT_New_In°™˚
 (
pf
->
Á˚
, &pf->
ö°™˚
Ë!
TT_Eº_Ok
)

174 
out
;

177 i‡(
	`TT_Së_In°™˚_Resﬁuti⁄s
 (
pf
->
ö°™˚
, 96, 96Ë!
TT_Eº_Ok
)

178 
out
;

181 
n
 = 
¥›îtõs
.
num_Ch¨M≠s
;

183 
i
 = 0; i < 
n
; i++) {

184 
	`TT_Gë_Ch¨M≠_ID
 (
pf
->
Á˚
, 
i
, &
∂©f‹m
, &
ícodög
);

185 i‡(((
∂©f‹m
 =
TT_PLATFORM_MICROSOFT
) &&

186 (
ícodög
 =
TT_MS_ID_UNICODE_CS
)) ||

187 ((
∂©f‹m
 =
TT_PLATFORM_APPLE_UNICODE
) &&

188 (
ícodög
 =
TT_APPLE_ID_DEFAULT
)))

190 
	`TT_Gë_Ch¨M≠
 (
pf
->
Á˚
, 
i
, &pf->
ch¨_m≠
);

191 
i
 = 
n
 + 1;

194 i‡(
i
 =
n
) {

195 
	`DPRINTF
("freetype_createfont:Ço unicode mapÅable\n");

196 
out
;

199 
	`GdSëF⁄tSize
((
PMWFONT
)
pf
, 
height
);

200 
	`GdSëF⁄tRŸ©i⁄
((
PMWFONT
)
pf
, 0);

201 
	`GdSëF⁄tAâr
((
PMWFONT
)
pf
, 
©å
, 0);

203  
pf
;

205 
out
:

206 
	`‰ì
(
pf
);

207  
NULL
;

208 
	}
}

211 
	$compuã_kînvÆ
(
PMWFREETYPEFONT
 
pf
, 
cuºít_glyph_code
)

213 
i
 = 0;

214 
kînvÆ
;

215 
nPaús
 = 
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.nPairs;

216 
TT_Kîn_0_Paú
 *
∑ú
 = 
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.
∑ús
;

218 i‡(
pf
->
œ°_glyph_code
 != -1) {

219 (
∑ú
->
À·
 !
pf
->
œ°_glyph_code
)

220 && (
∑ú
->
right
 !
cuºít_glyph_code
))

222 
∑ú
++;

223 
i
++;

224 i‡(
i
 =
nPaús
)

228 i‡(
i
 =
nPaús
)

229 
kînvÆ
 = 0;

232 
kînvÆ
 = (
∑ú
->
vÆue
 + 32) & -64;

234 
kînvÆ
 = 0;

236  
kînvÆ
;

237 
	}
}

239 
TT_USh‹t


240 
	$Gë_Glyph_Width
(
PMWFREETYPEFONT
 
pf
, 
TT_USh‹t
 
glyph_ödex
)

242 
TT_Glyph_Mërics
 
mërics
;

244 i‡(
	`TT_Lﬂd_Glyph
 ( 
pf
->
ö°™˚
,Öf->
glyph
,

245 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
,
glyph_ödex
),

246 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

249 i‡(
	`TT_Lﬂd_Glyph
 ( 
pf
->
ö°™˚
,Öf->
glyph
, 0,

250 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

254 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

255 ((
mërics
.
adv™˚
 & 0xFFFFFFC0) >> 6);

256 
	}
}

260 
	$døwch¨
(
PMWFREETYPEFONT
 
pf
, 
PSD
 
psd
, 
TT_Glyph
 
glyph
, 
x_off£t
,

261 
y_off£t
)

263 
TT_F26DŸ6
 
xmö
, 
ymö
, 
xmax
, 
ymax
, 
x
, 
y
, 
z
;

264 *
§c
, *
§˝å
;

265 
MWPIXELVAL
 *
d°
, *
d°±r
;

266 
MWPIXELVAL
 *
bôm≠
;

267 
size
, 
width
, 
height
;

268 
TT_Ouéöe
 
ouéöe
;

269 
TT_BBox
 
bbox
;

270 
TT_Ra°î_M≠
 
Ra°î
;

271 
TT_Eº‹
 
îr‹
;

275 
	`TT_Gë_Glyph_Ouéöe
 (
pf
->
glyph
, &
ouéöe
);

276 
	`TT_Gë_Ouéöe_BBox
 (&
ouéöe
, &
bbox
);

278 
xmö
 = (
bbox
.
xMö
 & -64) >> 6;

279 
ymö
 = (
bbox
.
yMö
 & -64) >> 6;

280 
xmax
 = ((
bbox
.
xMax
 + 63) & -64) >> 6;

281 
ymax
 = ((
bbox
.
yMax
 + 63) & -64) >> 6;

282 
width
 = 
xmax
 - 
xmö
;

283 
height
 = 
ymax
 - 
ymö
;

284 
size
 = 
width
 * 
height
;

287 
Ra°î
.
rows
 = 
height
;

288 
Ra°î
.
width
 = width;

290 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
)

291 
Ra°î
.
cﬁs
 = (Ra°î.
width
 + 3) & -4;

293 
Ra°î
.
cﬁs
 = (Ra°î.
width
 + 7) & -8;

295 
Ra°î
.
Êow
 = 
TT_Flow_Up
;

296 
Ra°î
.
size
 = Ra°î.
rows
 * Ra°î.
cﬁs
;

297 
Ra°î
.
bôm≠
 = 
	`mÆloc
 (Ra°î.
size
);

299 
	`mem£t
 (
Ra°î
.
bôm≠
, 0, Ra°î.
size
);

309 i‡(!(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
))

310 
îr‹
 = 
	`TT_Gë_Glyph_Bôm≠
 (
pf
->
glyph
, &
Ra°î
,

311 -
xmö
 * 64, -
ymö
 * 64);

313 
îr‹
 = 
	`TT_Gë_Glyph_Pixm≠
 (
pf
->
glyph
, &
Ra°î
,

314 -
xmö
 * 64, -
ymö
 * 64);

316 i‡(
îr‹
) {

317 
	`‰ì
 (
Ra°î
.
bôm≠
);

321 
bôm≠
 = 
	`mÆloc
 (
size
 *  (
MWPIXELVAL
));

322 
	`mem£t
 (
bôm≠
, 0, 
size
 *  (
MWPIXELVAL
));

324 
§c
 = (*Ë
Ra°î
.
bôm≠
;

325 
d°
 = 
bôm≠
 + (
size
 - 
width
);

327 
y
 = 
ymö
; y < 
ymax
; y++) {

328 
§˝å
 = 
§c
;

329 
d°±r
 = 
d°
;

331 
x
 = 
xmö
; x < 
xmax
; x++) {

332 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
)

333 *
d°±r
++ = 
gøy_∑Àâe
[(Ë*
§˝å
];

335 
z
=0;

336 
z
 <((
xmax
-
x
-1) < 7 ? (xmax-x-1) : 7);

337 
z
++) {

338 *
d°±r
++ = ((*
§˝å
 << 
z
) & 0x80)?

339 
gr_f‹eground
: 
gr_background
;

341 
x
 += 7;

344 
§˝å
++;

347 
§c
 +
Ra°î
.
cﬁs
;

348 
d°
 -
width
;

357 
	`GdAªa
(
psd
, 
x_off£t
 + 
xmö
, 
y_off£t
 - (
ymö
 + 
height
), 
width
, height,

358 
bôm≠
, 
MWPF_PIXELVAL
);

362 
	`‰ì
 (
bôm≠
);

363 
	`‰ì
 (
Ra°î
.
bôm≠
);

364 
	}
}

370 
	$‰ìty≥_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
ax
, MWCOORD 
ay
,

371 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

373 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

374 c⁄° * 
°r
 = 
ãxt
;

375 
TT_F26DŸ6
 
x
 = 
ax
, 
y
 = 
ay
;

376 
TT_Pos
 
vec_x
, 
vec_y
;

377 
i
;

378 
TT_F26DŸ6
 
°¨tx
, 
°¨ty
;

379 
TT_Ouéöe
 
ouéöe
;

380 
TT_USh‹t
 
curch¨
;

381 
TT_Glyph_Mërics
 
mërics
;

382 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

383 
TT_In°™˚_Mërics
 
imërics
;

384 
TT_F26DŸ6
 
as˚¡
, 
des˚¡
;

385 
bÀnd
[5] = { 0x00, 0x44, 0x88, 0xcc, 0xff };

386 
vútuÆ_∑Àâe
[5] = { 0, 1, 2, 3, 4 };

388 
pf
->
œ°_glyph_code
 = -1;

389 
pf
->
œ°_≥n_pos
 = -32767;

395 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

396 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

398 
as˚¡
 = ((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * 
imërics
.
y_sˇÀ
)/0x10000);

399 
des˚¡
 = ((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
*
imërics
.
y_sˇÀ
)/0x10000);

405 i‡(
Êags
&
MWTF_BOTTOM
) {

406 
vec_x
 = 0;

407 
vec_y
 = 
des˚¡
;

408 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

409 
x
 -
vec_x
 / 64;

410 
y
 +
vec_y
 / 64;

411 } i‡(
Êags
&
MWTF_TOP
) {

412 
vec_x
 = 0;

413 
vec_y
 = 
as˚¡
;

414 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

415 
x
 -
vec_x
 / 64;

416 
y
 +
vec_y
 / 64;

420 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
) {

421 
	`TT_Së_Ra°î_Gøy_PÆëã
 (
ígöe
, 
vútuÆ_∑Àâe
);

423 
	`ÆphabÀnd
(
psd
, 
gøy_∑Àâe
, 
gr_f‹eground
, 
gr_background
,

424 
bÀnd
, 5);

427 
°¨tx
 = 
x
;

428 
°¨ty
 = 
y
;

429 
i
 = 0; i < 
cc
; i++) {

430 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
, 
°r
[
i
]);

432 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

433 
TTLOAD_DEFAULT
Ë!
TT_Eº_Ok
)

436 i‡(
pf
->
f⁄åŸ©i⁄
) {

437 
	`TT_Gë_Glyph_Ouéöe
 (
pf
->
glyph
, &
ouéöe
);

438 
	`TT_Tønsf‹m_Ouéöe
 (&
ouéöe
, &
pf
->
m©rix
);

441 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

443 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
) {

444 i‡(
pf
->
f⁄åŸ©i⁄
) {

445 
vec_x
 = 
	`compuã_kînvÆ
(
pf
, 
curch¨
);

446 
vec_y
 = 0;

447 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

449 
x
 +
vec_x
 / 64;

450 
y
 -
vec_y
 / 64;

452 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

455 
	`døwch¨
(
pf
, 
psd
,Öf->
glyph
, 
x
, 
y
);

457 i‡(
pf
->
f⁄åŸ©i⁄
) {

458 
vec_x
 = 
mërics
.
adv™˚
;

459 
vec_y
 = 0;

460 
	`TT_Tønsf‹m_Ve˘‹
 (&
vec_x
, &
vec_y
, &
pf
->
m©rix
);

462 
x
 +
vec_x
 / 64;

463 
y
 -
vec_y
 / 64;

465 
x
 +
mërics
.
adv™˚
 / 64;

468 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

469 
x
 = 
pf
->
œ°_≥n_pos
;

470 
pf
->
œ°_≥n_pos
 = 
x
;

473 
pf
->
œ°_glyph_code
 = 
curch¨
;

476 i‡(
pf
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

477 
	`GdLöe
(
psd
, 
°¨tx
, 
°¨ty
, 
x
, 
y
, 
FALSE
);

478 
	}
}

483 
MWBOOL


484 
	$‰ìty≥_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

486 
i
;

487 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

488 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

489 
TT_In°™˚_Mërics
 
imërics
;

490 
TT_USh‹t
 
œ°_glyph_ödex
;

492 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

493 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

496 
pf⁄töfo
->
height
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * \

497 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

498 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 * \

499 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

500 
pf⁄töfo
->
maxwidth
 = ((
¥›îtõs
.
h‹iz⁄èl
->
xMax_Exã¡
 * \

501 
imërics
.
x_sˇÀ
)/ 0x10000) >> 6;

502 
pf⁄töfo
->
ba£löe
 = ((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * \

503 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

504 
pf⁄töfo
->
fú°ch¨
 = 
	`TT_Ch¨M≠_Fú°
(
pf
->
ch¨_m≠
, 
NULL
);

505 
pf⁄töfo
->
œ°ch¨
 = 
	`TT_Ch¨M≠_La°
(
pf
->
ch¨_m≠
, 
NULL
);

506 
pf⁄töfo
->
fixed
 = 
¥›îtõs
.
po°s¸ùt
->
isFixedPôch
;

510 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
 + 2;

511 
pf⁄töfo
->
des˚¡
 =Öf⁄töfo->
height
 -Öf⁄töfo->
ba£löe
;

512 
pf⁄töfo
->
maxas˚¡
 =Öf⁄töfo->
ba£löe
;

513 
pf⁄töfo
->
maxdes˚¡
 =Öf⁄töfo->
des˚¡
;

515 
œ°_glyph_ödex
 = 
¥›îtõs
.
num_Glyphs
 > 255 ? 255:Öroperties.num_Glyphs-1;

519 i‡(
	`TT_Gë_Fa˚_Widths
–
pf
->
Á˚
, 0,

520 
œ°_glyph_ödex
, 
widths
, 
NULL
 ) !
TT_Eº_Ok
) {

521  
TRUE
;

524 
i
=0; i<=
œ°_glyph_ödex
; i++)

525 
	`DPRINTF
("widths[%d]: %d\n", 
i
, 
widths
[i]);

529 
i
=0; i<=
œ°_glyph_ödex
; i++)

530 
pf⁄töfo
->
widths
[
i
] = 
	`Gë_Glyph_Width
(
pf
, i);

533 
	`DPRINTF
("x_ppem: %d\ny_ppem: %d\nx_scale: %d\ny_scale: %d\n\
_resolution: %d\ny_resolution: %d\n",

535 
imërics
.
x_µem
, imërics.
y_µem
, imërics.
x_sˇÀ
, \

536 
imërics
.
y_sˇÀ
, imërics.
x_ªsﬁuti⁄
, imërics.
y_ªsﬁuti⁄
);

538 
	`DPRINTF
("Ascender: %d\nDescender: %d\nxMax_Extent: %d\n\
 Style Say Italic?: %d\nMac Style Say Bold?: %d\n\
: %d\nsTypoDescender: %d\nusWinAscent: %d\n\
: %d\nusFirstCharIndex: %d\nusLastCharIndex: %d\n\
2 Say Italic?: %d\nOS2 Say Bold?: %d\nOS2 Say monospaced?: %d\n\
 Say monospaced?: %d\n",\

544 
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
,

545 
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
,

546 
¥›îtõs
.
h‹iz⁄èl
->
xMax_Exã¡
,

547 (
¥›îtõs
.
hódî
->
Mac_StyÀ
 & 0x2)?1:0,

548 (
¥›îtõs
.
hódî
->
Mac_StyÀ
 & 0x1)?1:0,

549 
¥›îtõs
.
os2
->
sTypoAs˚ndî
,

550 
¥›îtõs
.
os2
->
sTypoDes˚ndî
,

551 
¥›îtõs
.
os2
->
usWöAs˚¡
,

552 
¥›îtõs
.
os2
->
usWöDes˚¡
,

553 
¥›îtõs
.
os2
->
usFú°Ch¨Index
,

554 
¥›îtõs
.
os2
->
usLa°Ch¨Index
,

555 (
¥›îtõs
.
os2
->
fsSñe˘i⁄
 & 0x1)?1:0,

556 (
¥›îtõs
.
os2
->
fsSñe˘i⁄
 & 0x20)?1:0,

557 
¥›îtõs
.
po°s¸ùt
->
isFixedPôch
,

558 (
¥›îtõs
.
os2
->
∑no£
[3] == 9)?1:0);

561  
TRUE
;

562 
	}
}

565 
	$‰ìty≥_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

566 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

568 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

569 c⁄° * 
°r
 = 
ãxt
;

570 
TT_F26DŸ6
 
x
 = 0;

571 
i
;

572 
TT_USh‹t
 
curch¨
;

573 
TT_Glyph_Mërics
 
mërics
;

574 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

575 
TT_In°™˚_Mërics
 
imërics
;

577 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

578 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

580 
pf
->
œ°_glyph_code
 = -1;

581 
pf
->
œ°_≥n_pos
 = -32767;

583 
i
 = 0; i < 
cc
; i++) {

584 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
, 
°r
[
i
]);

586 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

587 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

590 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

592 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
) {

593 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

596 
x
 +
mërics
.
adv™˚
 / 64;

599 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

600 
x
 = 
pf
->
œ°_≥n_pos
;

601 
pf
->
œ°_≥n_pos
 = 
x
;

603 
pf
->
œ°_glyph_code
 = 
curch¨
;

606 *
pwidth
 = 
x
;

607 *
pheight
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 *

608 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

609 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 *

610 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

612 *
pba£
 = (((-
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
) *

613 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

614 
	}
}

617 
	$‰ìty≥_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

619 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

621 
	`TT_Clo£_Fa˚
(
pf
->
Á˚
);

622 
	`‰ì
(
pf
);

623 
	}
}

626 
	$‰ìty≥_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
)

628 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

630 
pf
->
f⁄tsize
 = fontsize;

633 i‡(!
f⁄tsize
)

637 
	`TT_Së_In°™˚_PixñSizes
–
pf
->
ö°™˚
,Öf->
f⁄tsize
,

638 
pf
->
f⁄tsize
,Öf->fontsize * 64 );

641 
	`TT_Së_In°™˚_Ch¨Size
 (
pf
->
ö°™˚
,

642 ((
pf
->
f⁄tsize
 * 72 + 96/2) / 96) * 64);

644 
	}
}

647 
	$‰ìty≥_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
)

649 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

650 
™gÀ
;

652 
pf
->
f⁄åŸ©i⁄
 = 
ã¡hdegªes
;

655 
	`TT_Së_In°™˚_Tønsf‹m_Fœgs
 (
pf
->
ö°™˚
, 
TRUE
, 
FALSE
);

657 
™gÀ
 = 
pf
->
f⁄åŸ©i⁄
 * 
M_PI
 / 1800;

658 
pf
->
m©rix
.
yy
 = (
TT_Fixed
Ë(
	`cos
 (
™gÀ
) * (1 << 16));

659 
pf
->
m©rix
.
yx
 = (
TT_Fixed
Ë(
	`sö
 (
™gÀ
) * (1 << 16));

660 
pf
->
m©rix
.
xx
 =Öf->m©rix.
yy
;

661 
pf
->
m©rix
.
xy
 = -pf->m©rix.
yx
;

662 
	}
}

666 
	$GdGëTextSizeEx
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
,
nMaxExã¡
,

667 * 
ÕnFô
, * 
ÆpDx
,
MWCOORD
 *
pwidth
,MWCOORD *
pheight
,

668 
MWCOORD
 *
pba£
, 
MWTEXTFLAGS
 
Êags
)

670 
buf
[256];

671 * 
ãxt
;

672 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

673 
MWTEXTFLAGS
 
de„ncodög
 = 
pf
->
f⁄çrocs
->
ícodög
;

674 
x
 = 0;

675 
i
;

676 
TT_USh‹t
 
curch¨
;

677 
TT_Glyph_Mërics
 
mërics
;

678 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

679 
TT_In°™˚_Mërics
 
imërics
;

681 i‡((
cc
<0)||(!
°r
))

683 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

687 if((
Êags
 & (
MWTF_PACKMASK
|
MWTF_DBCSMASK
)Ë!
de„ncodög
)

689 
cc
 = 
	`GdC⁄vîtEncodög
(
°r
, 
Êags
, cc, 
buf
, 
de„ncodög
);

690 
Êags
 &~(
MWTF_PACKMASK
|
MWTF_DBCSMASK
);

691 
Êags
 |
de„ncodög
;

692 
ãxt
=
buf
;

693 } 
ãxt
 =(*)
°r
;

694 if(
cc
 <= 0)

696 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

700 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

701 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

703 
pf
->
œ°_glyph_code
 = -1;

704 
pf
->
œ°_≥n_pos
 = -32767;

705 i‡(
ÕnFô
)

706 *
ÕnFô
=-1;

707 
i
 = 0; i < 
cc
; i++)

709 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
,
ãxt
[
i
]);

711 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

712 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

714 
	`¥ötf
("U«bÀÅÿlﬂd glyph wôh index=%d\n",
curch¨
);

717 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

718 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
)

720 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

722 
x
 +
mërics
.
adv™˚
 / 64;

723 if((
ÕnFô
)&&(
ÆpDx
))

725 i‡(
x
<=
nMaxExã¡
)

726 
ÆpDx
[
i
]=
x
;

728 i‡(*
ÕnFô
==-1)

729 (*
ÕnFô
)=
i
;

732 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

733 
x
 = 
pf
->
œ°_≥n_pos
;

734 
pf
->
œ°_≥n_pos
 = 
x
;

735 
pf
->
œ°_glyph_code
 = 
curch¨
;

737 i‡((
ÕnFô
)&&(*lpnFit==-1))

738 *
ÕnFô
=
cc
;

739 *
pwidth
 = 
x
;

740 *
pheight
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 *

741 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

742 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 *

743 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

745 i‡(
pba£
)

746 *
pba£
 = (((-
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
) *

747 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

749 
	}
}

756 
	$â_lookup_«me
(
TT_Fa˚
 
Á˚
)

758 
TT_Fa˚_Pr›îtõs
 
¥›
;

759 
i
, 
n
;

760 
∂©f‹m
, 
ícodög
, 
œnguage
, 
id
;

761 *
°rög
;

762 *
«me_buf„r
;

763 
°rög_Àn
;

764 
j
, 
found
;

765 
ödex
 = 4;

766 
«me_Àn
;

769 
	`TT_Gë_Fa˚_Pr›îtõs
(
Á˚
, &
¥›
);

770 
n
 = 
¥›
.
num_Names
;

772  
i
 = 0; i < 
n
; i++ ) {

773 
	`TT_Gë_Name_ID
–
Á˚
, 
i
, &
∂©f‹m
, &
ícodög
, &
œnguage
, &
id
 );

774 
	`TT_Gë_Name_Såög
–
Á˚
, 
i
, &
°rög
, &
°rög_Àn
 );

776 i‡(
id
 =
ödex
 ) {

779 
found
 = 0;

782 i‡–
∂©f‹m
 == 3 )

783  
j
 = 1; j >= 0; j-- )

784 i‡–
ícodög
 =
j
 )

785 i‡–(
œnguage
 & 0x3FF) == 0x009 ) {

787 
found
 = 1;

791 i‡–!
found
 && 
∂©f‹m
 =0 && 
œnguage
 == 0 )

792 
found
 = 1;

795 i‡–
found
 ) {

796 i‡–
°rög_Àn
 > 512 )

797 
°rög_Àn
 = 512;

799 
«me_Àn
 = 0;

800 
«me_buf„r
 = (*)
	`mÆloc
((
°rög_Àn
 / 2) + 1);

802  
i
 = 1; i < 
°rög_Àn
; i += 2 )

803 
«me_buf„r
[
«me_Àn
++] = 
°rög
[
i
];

805 
«me_buf„r
[
«me_Àn
] = '\0';

807  
«me_buf„r
;

813  
NULL
;

814 
	}
}

817 
	$gë_â_«me
(*
p
)

819 
TT_Fa˚
 
Á˚
;

820 *
ªt
;

824 i‡(
	`TT_O≥n_Fa˚
(
ígöe
, 
p
, &
Á˚
Ë!
TT_Eº_Ok
) {

825 
	`¥ötf
("Eº‹ o≥nög f⁄t: %s\n", 
p
);

826  
NULL
;

829 
ªt
 = 
	`â_lookup_«me
(
Á˚
);

831 
	`TT_Clo£_Fa˚
(
Á˚
);

833  
ªt
;

834 
	}
}

837 
	$GdFªeF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, 
n
)

839 
i
;

840 
MWFONTLIST
 *
g
, **
li°
 = *
f⁄ts
;

842 
i
 = 0; i < 
n
; i++) {

843 
g
 = 
li°
[
i
];

844 if(
g
) {

845 if(
g
->
mw«me
)

846 
	`‰ì
(
g
->
mw«me
);

847 if(
g
->
â«me
)

848 
	`‰ì
(
g
->
â«me
);

849 
	`‰ì
(
g
);

852 
	`‰ì
(
li°
);

853 *
f⁄ts
 = 0;

854 
	}
}

857 
	$GdGëF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, *
numf⁄ts
)

859 
DIR
 *
dú
;

860 
dúít
 *
dít
;

861 *
p
, *
·mp
;

862 
∂
, 
idx
 = 0;

863 
MWFONTLIST
 **
li°
;

866 i‡(
TT_Eº_Ok
 !
	`TT_Inô_FªeTy≥
(&
ígöe
)) {

867 
	`¥ötf
("UnableÅo initialize freetype\n");

868 *
numf⁄ts
 = -1;

872 
dú
 = 
	`›ídú
(
FREETYPE_FONT_DIR
);

874 i‡(
dú
 <= 0) {

875 
	`¥ötf
("Error opening font directory\n");

876 *
numf⁄ts
 = -1;

881 (
dít
 = 
	`ªaddú
(
dú
)Ë!
NULL
) {

882 
p
 = 
	`°ºchr
(
dít
->
d_«me
, '.');

883 i‡(
	`°rˇ£cmp
(
p
, ".ttf") == 0)

884 
idx
++;

887 *
numf⁄ts
 = 
idx
;

888 
	`ªwöddú
(
dú
);

891 
li°
 = (
MWFONTLIST
**)
	`mÆloc
(
idx
 * (MWFONTLIST*));

892 
∂
 = 0;Ö»< 
idx
;Öl++)

893 
li°
[
∂
] = (
MWFONTLIST
*)
	`mÆloc
((MWFONTLIST));

895 *
f⁄ts
 = 
li°
;

897 
idx
 = 0;

899 (
dít
 = 
	`ªaddú
(
dú
)Ë!
NULL
) {

901 
p
 = 
	`°ºchr
(
dít
->
d_«me
, '.');

903 i‡(
	`°rˇ£cmp
(
p
, ".ttf") == 0) {

906 
p
 = 0;

907 
∂
 = 
	`°æí
(
FREETYPE_FONT_DIR
Ë+ såÀn(
dít
->
d_«me
) *

909 
p
 = (*)
	`mÆloc
(
∂
);

910 
p
 = (*)
	`mem£t
’, '\0', 
∂
);

911 
p
 = (*)
	`°rˇt
’, 
FREETYPE_FONT_DIR
);

912 
p
 = (*)
	`°rˇt
(p, "/");

913 
p
 = (*)
	`°rˇt
’, 
dít
->
d_«me
);

916 if((
·mp
 = 
	`gë_â_«me
(
p
)Ë!
NULL
) {

917 
li°
[
idx
]->
â«me
 = 
·mp
;

918 
li°
[
idx
]->
mw«me
 = 
	`mÆloc
(
	`°æí
(
dít
->
d_«me
) + 1);

919 
li°
[
idx
]->
mw«me
 = 
	`°r˝y
÷i°[idx]->mw«me, 
dít
->
d_«me
);

921 
idx
++;

924 
	`‰ì
(
p
);

928 
	`˛o£dú
(
dú
);

929 
	}
}

	@engine/font_freetype.cache.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	~<‰ìty≥/‰ìty≥.h
>

13 
	~<‰ìty≥/·xkîn.h
>

14 
	~<‰ìty≥/·«meid.h
>

15 
	~<‰ìty≥/·xcm≠.h
>

16 
	~<‰ìty≥/·xwidth.h
>

17 
	~<m©h.h
>

18 
	~<dúít.h
>

19 
	~"devi˚.h
"

20 
	~"devf⁄t.h
"

22 
	#MWFREETYPEFONT_CACHE
 1

	)

23 
	#MWFREETYPEFONT_CACHEBITMAP
 1

	)

24 
	#xTT_ALIAS
 1

	)

26 #i‡
TT_FREETYPE_MAJOR
 !1 | 
TT_FREETYPE_MINOR
 < 3

30 
	sxTT_Glyph_Cache_
 {

31 
TT_Eº‹
 
	mîr‹
;

32 
TT_Glyph
 
	mglyph
;

33 
TT_USh‹t
 
	mödex
;

34 
TT_USh‹t
 
	mÊags
;

35 
xTT_Glyph_Cache_
 *
	ml
;

36 
xTT_Glyph_Cache_
 *
	mr
;

37 } 
	txTT_Glyph_Cache
;

39 
	sxTT_In°™˚_Obje˘_
 {

40 
TT_Fa˚
 
	mÁ˚
;

41 
TT_In°™˚
 
	mö°™˚
;

42 
xTT_Glyph_Cache
 *
	mhód
;

43 } 
	txTT_In°™˚_Obje˘
;

45 
	sxTT_In°™˚_
 {

46 
xTT_In°™˚_Obje˘
 *
	mö°™˚
;

47 } 
	txTT_In°™˚
;

49 
	sxTT_Ouéöe_Obje˘_
 {

50 
TT_Ouéöe
 
	mouéöe
;

51 
TT_BBox
 
	mbbox
;

52 } 
	txTT_Ouéöe_Obje˘
;

54 
	sxTT_Ouéöe_
 {

55 
xTT_Ouéöe_Obje˘
 *
	mouéöe
;

56 } 
	txTT_Ouéöe
;

58 
	sxTT_Glyph_Obje˘_
 {

59 
TT_Glyph
 *
	mglyph
;

60 
xTT_Ouéöe_Obje˘
 
	mouéöe
;

61 } 
	txTT_Glyph_Obje˘
;

63 
	sxTT_Glyph_
 {

64 
xTT_Glyph_Obje˘
 *
	mglyph
;

65 } 
	txTT_Glyph
;

67 
TT_Eº‹


68 
	$xTT_Glyph_Cache_Föd
(
xTT_In°™˚
 
ö°™˚
,

69 
xTT_Glyph
 
glyph
, 
TT_USh‹t
 
glyphIndex
, TT_USh‹à
lﬂdFœgs
)

71 
xTT_Glyph_Cache
 *
node
;

72 
xTT_Glyph_Cache
 **
öode
 = &
ö°™˚
.ö°™˚->
hód
;

74 
miss
 = 0;

77 i‡(*
öode
 == 0) {

78 
miss
 = 1;

80 
node
 = *
öode
 = 
	`ˇŒoc
(1, (**inode));

82 i‡(
node
 == 0)

83  
TT_Eº_Out_Of_Mem‹y
;

85 
node
->
îr‹
 =

86 
	`TT_New_Glyph
(
ö°™˚
.ö°™˚->
Á˚
,

87 &(
node
->
glyph
));

89 i‡(
node
->
îr‹
 == 0)

90 
node
->
îr‹
 =

91 
	`TT_Lﬂd_Glyph
(
ö°™˚
.instance->

92 
ö°™˚
, 
node
->
glyph
,

93 (
node
->
ödex
 =

94 
glyphIndex
),

95 (
node
->
Êags
 =

96 
lﬂdFœgs
));

98 i‡(
node
->
îr‹
 != 0)

99 
	`TT_D⁄e_Glyph
(
node
->
glyph
);

101 
node
 = *
öode
;

104 i‡(
glyphIndex
 < 
node
->
ödex
)

105 
öode
 = &
node
->
l
;

106 i‡(
glyphIndex
 > 
node
->
ödex
)

107 
öode
 = &
node
->
r
;

108 i‡(
lﬂdFœgs
 < 
node
->
Êags
)

109 
öode
 = &
node
->
l
;

110 i‡(
lﬂdFœgs
 > 
node
->
Êags
)

111 
öode
 = &
node
->
r
;

113 
cou¡
[] = { 0, 0 };

114 ++
cou¡
[
miss
];

115 
	`¥ötf
("\r(%†| hô %d | mis†%d)", 
__TIME__
,

116 
cou¡
[0], count[1]);

117 
glyph
.glyph->glyph = &
node
->glyph;

118  
node
->
îr‹
;

121 
	}
}

124 
	$xTT_Glyph_Cache_Fªe
(
xTT_Glyph_Cache
 ** 
≤ode
)

126 
xTT_Glyph_Cache
 *
node
;

128 i‡(
≤ode
 == 0)

131 
node
 = *
≤ode
;

133 i‡(
node
 == 0)

136 i‡(
node
->
l
)

137 
	`xTT_Glyph_Cache_Fªe
(&
node
->
l
);

139 i‡(
node
->
r
)

140 
	`xTT_Glyph_Cache_Fªe
(&
node
->
r
);

142 
	`TT_D⁄e_Glyph
(
node
->
glyph
);

143 
	`‰ì
(
node
);

145 *
≤ode
 = 0;

146 
	}
}

148 
TT_Eº‹
 
	$xTT_New_In°™˚
(
TT_Fa˚
 
Á˚
, 
xTT_In°™˚
 * 
ö°™˚
)

150 
ö°™˚
->ö°™˚ = 
	`ˇŒoc
(1, (*instance->instance));

151 i‡(
ö°™˚
->instance == 0)

152  
TT_Eº_Out_Of_Mem‹y
;

154 
ö°™˚
->ö°™˚->
Á˚
 = face;

155 
ö°™˚
->ö°™˚->
hód
 = 0;

157  
	`TT_New_In°™˚
(
Á˚
, &
ö°™˚
->instance->instance);

158 
	}
}

160 
TT_Eº‹
 
	$xTT_D⁄e_In°™˚
(
xTT_In°™˚
 
ö°™˚
)

162 
TT_Eº‹
 
îr‹
;

164 
	`xTT_Glyph_Cache_Fªe
(&
ö°™˚
.ö°™˚->
hód
);

165 
îr‹
 = 
	`TT_D⁄e_In°™˚
(
ö°™˚
.instance->instance);

167 
	`‰ì
(
ö°™˚
.instance);

169  
îr‹
;

170 
	}
}

172 
TT_Eº‹


173 
	$xTT_Gë_In°™˚_Mërics
(
xTT_In°™˚
 
ö°™˚
,

174 
TT_In°™˚_Mërics
 * 
imërics
)

176  
	`TT_Gë_In°™˚_Mërics
(
ö°™˚
.ö°™˚->ö°™˚, 
imërics
);

177 
	}
}

179 
TT_Eº‹
 
	$xTT_Së_In°™˚_Ch¨Size
(
xTT_In°™˚
 
ö°™˚
, 
TT_F26DŸ6
 
ch¨size
)

181 
	`xTT_Glyph_Cache_Fªe
(&
ö°™˚
.ö°™˚->
hód
);

182  
	`TT_Së_In°™˚_Ch¨Size
(
ö°™˚
.instance->instance,

183 
ch¨size
);

184 
	}
}

186 
TT_Eº‹


187 
	$xTT_Së_In°™˚_PixñSizes
(
xTT_In°™˚
 
ö°™˚
,

188 
TT_USh‹t
 
pixñWidth
,

189 
TT_USh‹t
 
pixñHeight
, 
TT_F26DŸ6
 
poötSize
)

191 
	`xTT_Glyph_Cache_Fªe
(&
ö°™˚
.ö°™˚->
hód
);

192  
	`TT_Së_In°™˚_PixñSizes
(
ö°™˚
.instance->instance,

193 
pixñWidth
, 
pixñHeight
, 
poötSize
);

194 
	}
}

196 
TT_Eº‹


197 
	$xTT_Së_In°™˚_Tønsf‹m_Fœgs
(
xTT_In°™˚
 
ö°™˚
,

198 
TT_Boﬁ
 
rŸ©ed
, TT_Boﬁ 
°ªtched
)

200 
	`xTT_Glyph_Cache_Fªe
(&
ö°™˚
.ö°™˚->
hód
);

201  
	`TT_Së_In°™˚_Resﬁuti⁄s
(
ö°™˚
.instance->instance,

202 
rŸ©ed
, 
°ªtched
);

203 
	}
}

205 
TT_Eº‹


206 
	$xTT_Së_In°™˚_Resﬁuti⁄s
(
xTT_In°™˚
 
ö°™˚
,

207 
TT_USh‹t
 
xResﬁuti⁄
, TT_USh‹à
yResﬁuti⁄
)

209 
	`xTT_Glyph_Cache_Fªe
(&
ö°™˚
.ö°™˚->
hód
);

210  
	`TT_Së_In°™˚_Resﬁuti⁄s
(
ö°™˚
.instance->instance,

211 
xResﬁuti⁄
, 
yResﬁuti⁄
);

212 
	}
}

214 
TT_Eº‹
 
	$xTT_New_Glyph
(
TT_Fa˚
 
Á˚
, 
xTT_Glyph
 * 
glyph
)

216 
glyph
->glyph = 
	`ˇŒoc
(1, (*glyph->glyph));

217 i‡(
glyph
->glyph == 0)

218  
TT_Eº_Out_Of_Mem‹y
;

220 
	}
}

222 
TT_Eº‹
 
	$xTT_D⁄e_Glyph
(
xTT_Glyph
 
glyph
)

224 
	`‰ì
(
glyph
.glyph);

226 
	}
}

228 
TT_Eº‹


229 
	$xTT_Lﬂd_Glyph
(
xTT_In°™˚
 
ö°™˚
,

230 
xTT_Glyph
 
glyph
, 
TT_USh‹t
 
glyphIndex
, TT_USh‹à
lﬂdFœgs
)

232 
TT_Eº‹
 
îr‹
;

233 
îr‹
 = 
	`xTT_Glyph_Cache_Föd
(
ö°™˚
, 
glyph
, 
glyphIndex
, 
lﬂdFœgs
);

234 
	`TT_Gë_Glyph_Ouéöe
(*
glyph
.glyph->glyph,

235 &
glyph
.glyph->
ouéöe
.outline);

236 
	`TT_Gë_Ouéöe_BBox
(&
glyph
.glyph->
ouéöe
.outline,

237 &
glyph
.glyph->
ouéöe
.
bbox
);

238  
îr‹
;

239 
	}
}

241 
TT_Eº‹
 
	$xTT_Gë_Glyph_Mërics
(
xTT_Glyph
 
glyph
, 
TT_Glyph_Mërics
 * 
mërics
)

243  
	`TT_Gë_Glyph_Mërics
(*
glyph
.glyph->glyph, 
mërics
);

244 
	}
}

246 
TT_Eº‹
 
	$xTT_Gë_Glyph_Ouéöe
(
xTT_Glyph
 
glyph
, 
xTT_Ouéöe
 * 
ouéöe
)

248 
ouéöe
->ouéöê&
glyph
.glyph->outline;

250 
	}
}

252 
TT_Eº‹
 
	$xTT_Gë_Ouéöe_BBox
(
xTT_Ouéöe
 * 
ouéöe
, 
TT_BBox
 * 
bbox
)

254 *
bbox
 = 
ouéöe
->outline->bbox;

256 
	}
}

259 
	$xTT_Tønsf‹m_Ouéöe
(
xTT_Ouéöe
 * 
ouéöe
, 
TT_M©rix
 * 
m©rix
)

261 
	`TT_Tønsf‹m_Ouéöe
(&
ouéöe
->ouéöe->ouéöe, 
m©rix
);

262 
	`TT_Gë_Ouéöe_BBox
(&
ouéöe
->outline->outline,

263 &
ouéöe
->ouéöe->
bbox
);

264 
	}
}

266 
TT_Eº‹


267 
	$xTT_Gë_Glyph_Bôm≠
(
xTT_Glyph
 
glyph
,

268 
TT_Ra°î_M≠
 * 
bôm≠
, 
TT_F26DŸ6
 
xOff£t
, TT_F26DŸ6 
yOff£t
)

270  
	`TT_Gë_Glyph_Bôm≠
(*
glyph
.glyph->glyph,

271 
bôm≠
, 
xOff£t
, 
yOff£t
);

272 
	}
}

274 
TT_Eº‹


275 
	$xTT_Gë_Glyph_Pixm≠
(
xTT_Glyph
 
glyph
,

276 
TT_Ra°î_M≠
 * 
pixm≠
, 
TT_F26DŸ6
 
xOff£t
, TT_F26DŸ6 
yOff£t
)

278  
	`TT_Gë_Glyph_Pixm≠
(*
glyph
.glyph->glyph,

279 
pixm≠
, 
xOff£t
, 
yOff£t
);

280 
	}
}

282 #i‡
xTT_ALIAS


283 
	#TT_In°™˚
 
xTT_In°™˚


	)

284 
	#TT_Ouéöe
 
xTT_Ouéöe


	)

285 
	#TT_Glyph
 
xTT_Glyph


	)

286 
	#TT_New_In°™˚
 
xTT_New_In°™˚


	)

287 
	#TT_D⁄e_In°™˚
 
xTT_D⁄e_In°™˚


	)

288 
	#TT_Gë_In°™˚_Mërics
 
xTT_Gë_In°™˚_Mërics


	)

289 
	#TT_Së_In°™˚_Ch¨Size
 
xTT_Së_In°™˚_Ch¨Size


	)

290 
	#TT_Së_In°™˚_PixñSizes
 
xTT_Së_In°™˚_PixñSizes


	)

291 
	#TT_Së_In°™˚_Tønsf‹m_Fœgs
 
xTT_Së_In°™˚_Tønsf‹m_Fœgs


	)

292 
	#TT_Së_In°™˚_Resﬁuti⁄s
 
xTT_Së_In°™˚_Resﬁuti⁄s


	)

293 
	#TT_New_Glyph
 
xTT_New_Glyph


	)

294 
	#TT_D⁄e_Glyph
 
xTT_D⁄e_Glyph


	)

295 
	#TT_Lﬂd_Glyph
 
xTT_Lﬂd_Glyph


	)

296 
	#TT_Gë_Glyph_Mërics
 
xTT_Gë_Glyph_Mërics


	)

297 
	#TT_Gë_Glyph_Ouéöe
 
xTT_Gë_Glyph_Ouéöe


	)

298 
	#TT_Gë_Glyph_Bôm≠
 
xTT_Gë_Glyph_Bôm≠


	)

299 
	#TT_Gë_Glyph_Pixm≠
 
xTT_Gë_Glyph_Pixm≠


	)

300 
	#TT_Gë_Ouéöe_BBox
 
xTT_Gë_Ouéöe_BBox


	)

301 
	#TT_Tønsf‹m_Ouéöe
 
xTT_Tønsf‹m_Ouéöe


	)

304 #i‡
MWFREETYPEFONT_CACHE


305 
	smw‰ìty≥f⁄tˇche
 {

306 
	mcurch¨
;

307 *
	mbuf„r
;

308 #i‡
MWFREETYPEFONT_CACHEBITMAP


309 
MWPIXELVAL
 
	mfg
;

310 
MWPIXELVAL
 
	mbg
;

311 
MWBOOL
 
	mu£bg
;

312 *
	mbôm≠
;

314 
mw‰ìty≥f⁄tˇche
 *
	ml
;

315 
mw‰ìty≥f⁄tˇche
 *
	mr
;

316 } 
	tMWFREETYPEFONTCACHE
;

319 
	sMWFREETYPEFONT
 {

320 
PMWFONTPROCS
 
	mf⁄çrocs
;

321 
MWCOORD
 
	mf⁄tsize
;

322 
	mf⁄åŸ©i⁄
;

323 
	mf⁄èâr
;

325 
TT_Fa˚
 
	mÁ˚
;

326 
TT_In°™˚
 
	mö°™˚
;

327 
TT_Ch¨M≠
 
	mch¨_m≠
;

328 
TT_Kînög
 
	mdúe˘‹y
;

329 
TT_M©rix
 
	mm©rix
;

330 
TT_Glyph
 
	mglyph
;

331 
MWBOOL
 
	mˇn_kîn
;

332 
	mœ°_glyph_code
;

333 
	mœ°_≥n_pos
;

334 #i‡
MWFREETYPEFONT_CACHE


335 
MWFREETYPEFONTCACHE
 * 
	mglyph_ˇche
;

337 } 
	tMWFREETYPEFONT
;

339 
‰ìty≥_öô
(
PSD
 
psd
);

340 
PMWFREETYPEFONT
 
‰ìty≥_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
);

342 
MWBOOL
 
‰ìty≥_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

343 
‰ìty≥_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

344 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

345 
MWCOORD
 *
pba£
);

346 
‰ìty≥_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

347 
‰ìty≥_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

348 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

349 
‰ìty≥_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
);

350 
‰ìty≥_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
);

353 
MWFONTPROCS
 
	g‰ìty≥_¥ocs
 = {

354 
MWTF_UC16
,

355 
‰ìty≥_gëf⁄töfo
,

356 
‰ìty≥_gëãxtsize
,

357 
NULL
,

358 
‰ìty≥_de°royf⁄t
,

359 
‰ìty≥_døwãxt
,

360 
‰ìty≥_£tf⁄tsize
,

361 
‰ìty≥_£tf⁄åŸ©i⁄
,

362 
NULL
,

363 
NULL
,

366 
TT_Engöe
 
	gígöe
;

367 
OUTPIXELVAL
 
	ggøy_∑Àâe
[5];

370 
MWPIXELVAL
 
gr_f‹eground
;

371 
MWPIXELVAL
 
gr_background
;

372 
MWBOOL
 
gr_u£bg
;

375 
	$‰ìty≥_öô
(
PSD
 
psd
)

377 
öôed
 = 0;

379 i‡(
öôed
)

383 i‡(
	`TT_Inô_FªeTy≥
 (&
ígöe
Ë!
TT_Eº_Ok
) {

388 i‡(
	`TT_Inô_Kînög_Exãnsi⁄
 (
ígöe
Ë!
TT_Eº_Ok
)

391 
öôed
 = 1;

393 
	}
}

395 
PMWFREETYPEFONT


396 
	$‰ìty≥_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

398 
PMWFREETYPEFONT
 
pf
;

399 
i
, 
n
;

400 
∂©f‹m
, 
ícodög
;

401 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

402 * 
p
;

403 
f⁄äame
[128];

406 i‡(
	`°rchr
(
«me
, '/'Ë!
NULL
)

407 
	`°r˝y
(
f⁄äame
, 
«me
);

409 
	`°r˝y
(
f⁄äame
, 
FREETYPE_FONT_DIR
);

410 
	`°rˇt
(
f⁄äame
, "/");

411 
	`°rˇt
(
f⁄äame
, 
«me
);

415 i‡((
p
 = 
	`°ºchr
(
f⁄äame
, '.')Ë=
NULL
 ||

416 
	`°rcmp
(
p
, ".ttf") != 0) {

417 
	`°rˇt
(
f⁄äame
, ".ttf");

421 
pf
 = (
PMWFREETYPEFONT
)
	`ˇŒoc
((
MWFREETYPEFONT
), 1);

422 i‡(!
pf
)

423  
NULL
;

424 
pf
->
f⁄çrocs
 = &
‰ìty≥_¥ocs
;

427 i‡(
	`TT_O≥n_Fa˚
 (
ígöe
, 
f⁄äame
, &
pf
->
Á˚
Ë!
TT_Eº_Ok
)

428 
out
;

431 
pf
->
ˇn_kîn
 = 
TRUE
;

432 i‡(
	`TT_Lﬂd_Kînög_TabÀ
 (
pf
->
Á˚
, 0Ë!
TT_Eº_Ok
)

433 
pf
->
ˇn_kîn
 = 
FALSE
;

435 i‡(
	`TT_Gë_Kînög_Dúe˘‹y
 (
pf
->
Á˚
, &pf->
dúe˘‹y
)

436 !
TT_Eº_Ok
)

437 
pf
->
ˇn_kîn
 = 
FALSE
;

440 i‡((
pf
->
dúe˘‹y
.
vîsi⁄
 != 0) ||

441 (
pf
->
dúe˘‹y
.
nTabÀs
 <= 0) ||

442 (
pf
->
dúe˘‹y
.
èbÀs
->
lﬂded
 != 1) ||

443 (
pf
->
dúe˘‹y
.
èbÀs
->
vîsi⁄
 != 0) ||

444 (
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.
nPaús
 <= 0))

445 
pf
->
ˇn_kîn
 = 
FALSE
;

450 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

457 
h
 = 
¥›îtõs
.
os2
->
sTypoAs˚ndî
 -Ör›îtõs.os2->
sTypoDes˚ndî


458 + 
¥›îtõs
.
os2
->
sTypoLöeG≠
;

459 
as˚¡
 = 
¥›îtõs
.
os2
->
sTypoAs˚ndî


460 + 
¥›îtõs
.
os2
->
sTypoLöeG≠
/2;

461 
pf
->
as˚¡
 = (as˚¡ * 
height
 + 
h
/2) / h;

462 
pf
->
des˚¡
 = 
height
 -Öf->
as˚¡
;

465 i‡(
	`TT_New_Glyph
 (
pf
->
Á˚
, &pf->
glyph
Ë!
TT_Eº_Ok
)

466 
out
;

469 i‡(
	`TT_New_In°™˚
 (
pf
->
Á˚
, &pf->
ö°™˚
Ë!
TT_Eº_Ok
)

470 
out
;

473 i‡(
	`TT_Së_In°™˚_Resﬁuti⁄s
 (
pf
->
ö°™˚
, 96, 96Ë!
TT_Eº_Ok
)

474 
out
;

477 
n
 = 
¥›îtõs
.
num_Ch¨M≠s
;

479 
i
 = 0; i < 
n
; i++) {

480 
	`TT_Gë_Ch¨M≠_ID
 (
pf
->
Á˚
, 
i
, &
∂©f‹m
, &
ícodög
);

481 i‡(((
∂©f‹m
 =
TT_PLATFORM_MICROSOFT
) &&

482 (
ícodög
 =
TT_MS_ID_UNICODE_CS
)) ||

483 ((
∂©f‹m
 =
TT_PLATFORM_APPLE_UNICODE
) &&

484 (
ícodög
 =
TT_APPLE_ID_DEFAULT
)))

486 
	`TT_Gë_Ch¨M≠
 (
pf
->
Á˚
, 
i
, &pf->
ch¨_m≠
);

487 
i
 = 
n
 + 1;

490 i‡(
i
 =
n
) {

491 
	`DPRINTF
("freetype_createfont:Ço unicode mapÅable\n");

492 
out
;

495 
	`GdSëF⁄tSize
((
PMWFONT
)
pf
, 
height
);

496 
	`GdSëF⁄tRŸ©i⁄
((
PMWFONT
)
pf
, 0);

497 
	`GdSëF⁄tAâr
((
PMWFONT
)
pf
, 
©å
, 0);

499  
pf
;

501 
out
:

502 
	`‰ì
(
pf
);

503  
NULL
;

504 
	}
}

507 
	$compuã_kînvÆ
(
PMWFREETYPEFONT
 
pf
, 
cuºít_glyph_code
)

509 
i
 = 0;

510 
kînvÆ
;

511 
nPaús
 = 
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.nPairs;

512 
TT_Kîn_0_Paú
 *
∑ú
 = 
pf
->
dúe˘‹y
.
èbÀs
->
t
.
kîn0
.
∑ús
;

514 i‡(
pf
->
œ°_glyph_code
 != -1) {

515 (
∑ú
->
À·
 !
pf
->
œ°_glyph_code
)

516 && (
∑ú
->
right
 !
cuºít_glyph_code
))

518 
∑ú
++;

519 
i
++;

520 i‡(
i
 =
nPaús
)

524 i‡(
i
 =
nPaús
)

525 
kînvÆ
 = 0;

528 
kînvÆ
 = (
∑ú
->
vÆue
 + 32) & -64;

530 
kînvÆ
 = 0;

532  
kînvÆ
;

533 
	}
}

535 
TT_USh‹t


536 
	$Gë_Glyph_Width
(
PMWFREETYPEFONT
 
pf
, 
TT_USh‹t
 
glyph_ödex
)

538 
TT_Glyph_Mërics
 
mërics
;

540 i‡(
	`TT_Lﬂd_Glyph
 ( 
pf
->
ö°™˚
,Öf->
glyph
,

541 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
,
glyph_ödex
),

542 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

545 i‡(
	`TT_Lﬂd_Glyph
 ( 
pf
->
ö°™˚
,Öf->
glyph
, 0,

546 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

550 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

551 ((
mërics
.
adv™˚
 & 0xFFFFFFC0) >> 6);

552 
	}
}

554 #i‡
MWFREETYPEFONT_CACHE


555 
MWFREETYPEFONTCACHE
 *

556 
	$föd_ˇche_glyph
(
PMWFREETYPEFONT
 
pf
, 
curch¨
)

558 
MWFREETYPEFONTCACHE
 **
öode
 = &
pf
->
glyph_ˇche
;

561 i‡(*
öode
 == 0) {

562 *
öode
 = 
	`ˇŒoc
((
MWFREETYPEFONTCACHE
), 1);

563 (*
öode
)->
curch¨
 = curchar;

566 i‡(
curch¨
 < (*
öode
)->curchar)

567 
öode
 = &(*öode)->
l
;

568 i‡(
curch¨
 > (*
öode
)->curchar)

569 
öode
 = &(*öode)->
r
;

571  *
öode
;

573 
	}
}

576 
	$‰ì_ˇche_glyph
(
MWFREETYPEFONTCACHE
 * 
node
)

578 i‡(
node
->
l
 != 0)

579 
	`‰ì_ˇche_glyph
(
node
->
l
);

581 i‡(
node
->
r
 != 0)

582 
	`‰ì_ˇche_glyph
(
node
->
r
);

584 
	`‰ì
(
node
);

585 
	}
}

590 
	$døwch¨
(
PMWFREETYPEFONT
 
pf
, 
PSD
 
psd
, 
curch¨
, 
x_off£t
,

591 
y_off£t
)

593 
TT_F26DŸ6
 
xmö
, 
ymö
, 
xmax
, 
ymax
, 
x
, 
y
, 
z
;

594 *
§c
, *
§˝å
;

595 
MWPIXELVAL
 *
d°
, *
d°±r
;

596 
MWPIXELVAL
 *
bôm≠
;

597 
size
, 
width
, 
height
;

598 
TT_Ouéöe
 
ouéöe
;

599 
TT_BBox
 
bbox
;

600 
TT_Ra°î_M≠
 
Ra°î
;

601 
TT_Eº‹
 
îr‹
;

603 
MWFREETYPEFONTCACHE
 * 
ˇche
;

606 
	`TT_Gë_Glyph_Ouéöe
 (
pf
->
glyph
, &
ouéöe
);

607 
	`TT_Gë_Ouéöe_BBox
 (&
ouéöe
, &
bbox
);

609 
xmö
 = (
bbox
.
xMö
 & -64) >> 6;

610 
ymö
 = (
bbox
.
yMö
 & -64) >> 6;

611 
xmax
 = ((
bbox
.
xMax
 + 63) & -64) >> 6;

612 
ymax
 = ((
bbox
.
yMax
 + 63) & -64) >> 6;

613 
width
 = 
xmax
 - 
xmö
;

614 
height
 = 
ymax
 - 
ymö
;

615 
size
 = 
width
 * 
height
;

618 
Ra°î
.
rows
 = 
height
;

619 
Ra°î
.
width
 = width;

621 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
)

622 
Ra°î
.
cﬁs
 = (Ra°î.
width
 + 3) & -4;

624 
Ra°î
.
cﬁs
 = (Ra°î.
width
 + 7) & -8;

626 
ˇche
 = 
	`föd_ˇche_glyph
(
pf
,
curch¨
);

628 i‡(!
ˇche
Ë
	`¥ötf
("CACHE 0!\n");

630 
Ra°î
.
Êow
 = 
TT_Flow_Up
;

631 
Ra°î
.
size
 = Ra°î.
rows
 * Ra°î.
cﬁs
;

632 
Ra°î
.
bôm≠
 = 
ˇche
->
buf„r
;

634 i‡(
Ra°î
.
bôm≠
 == 0)

636 
Ra°î
.
bôm≠
 = 
	`mÆloc
 (Ra°î.
size
);

638 
	`mem£t
 (
Ra°î
.
bôm≠
, 0, Ra°î.
size
);

648 i‡(!(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
))

649 
îr‹
 = 
	`TT_Gë_Glyph_Bôm≠
 (
pf
->
glyph
, &
Ra°î
,

650 -
xmö
 * 64, -
ymö
 * 64);

652 
îr‹
 = 
	`TT_Gë_Glyph_Pixm≠
 (
pf
->
glyph
, &
Ra°î
,

653 -
xmö
 * 64, -
ymö
 * 64);

655 i‡(
îr‹
) {

656 
	`‰ì
 (
Ra°î
.
bôm≠
);

660 
ˇche
->
buf„r
 = 
Ra°î
.
bôm≠
;

663 #i‡
MWFREETYPEFONT_CACHEBITMAP


664 i‡((
	`memcmp
(&
gr_f‹eground
,&
ˇche
->
fg
,(gr_foreground)) != 0) ||

665 (
	`memcmp
(&
gr_background
,&
ˇche
->
bg
,(gr_background)) != 0) ||

666 (
gr_u£bg
 !
ˇche
->
u£bg
))

668 i‡(
ˇche
->
bôm≠
)

670 
	`‰ì
(
ˇche
->
bôm≠
);

671 
ˇche
->
bôm≠
 = 0;

675 
bôm≠
 = 
ˇche
->bitmap;

677 
bôm≠
 = 0;

680 i‡(
bôm≠
 == 0)

682 
bôm≠
 = 
	`mÆloc
 (
size
 *  (
MWPIXELVAL
));

683 
	`mem£t
 (
bôm≠
, 0, 
size
 *  (
MWPIXELVAL
));

685 
§c
 = (*Ë
Ra°î
.
bôm≠
;

686 
d°
 = 
bôm≠
 + (
size
 - 
width
);

688 
y
 = 
ymö
; y < 
ymax
; y++)

690 
§˝å
 = 
§c
;

691 
d°±r
 = 
d°
;

693 
x
 = 
xmö
; x < 
xmax
; x++)

695 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
)

696 *
d°±r
++ = 
gøy_∑Àâe
[(Ë*
§˝å
];

699  
z
=0;

700 
z
 <((
xmax
-
x
-1) < 7 ? (xmax-x-1) : 7);

701 
z
++ )

702 *
d°±r
++ = ((*
§˝å
 << 
z
Ë& 0x80Ë? 
gr_f‹eground
 : 
gr_background
;

703 
x
 += 7;

706 
§˝å
++;

709 
§c
 +
Ra°î
.
cﬁs
;

710 
d°
 -
width
;

712 #i‡
MWFREETYPEFONT_CACHEBITMAP


713 
ˇche
->
fg
 = 
gr_f‹eground
;

714 
ˇche
->
bg
 = 
gr_background
;

715 
ˇche
->
u£bg
 = 
gr_u£bg
;

716 
ˇche
->
bôm≠
 = bitmap;

721 
	`GdAªa
(
psd
, 
x_off£t
 + 
xmö
, 
y_off£t
 - (
ymö
 + 
height
), 
width
, height,

722 
bôm≠
, 
MWPF_PIXELVAL
);

724 #i‡!
MWFREETYPEFONT_CACHEBITMAP


725 
	`‰ì
(
bôm≠
);

727 
	}
}

733 
	$‰ìty≥_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
ax
, MWCOORD 
ay
,

734 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

736 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

737 c⁄° * 
°r
 = 
ãxt
;

738 
TT_F26DŸ6
 
x
 = 
ax
, 
y
 = 
ay
;

739 
TT_Pos
 
vec_x
, 
vec_y
;

740 
i
;

741 
TT_F26DŸ6
 
°¨tx
, 
°¨ty
;

742 
TT_Ouéöe
 
ouéöe
;

743 
TT_USh‹t
 
curch¨
;

744 
TT_Glyph_Mërics
 
mërics
;

745 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

746 
TT_In°™˚_Mërics
 
imërics
;

747 
TT_F26DŸ6
 
as˚¡
, 
des˚¡
;

748 
bÀnd
[5] = { 0x00, 0x44, 0x88, 0xcc, 0xff };

749 
vútuÆ_∑Àâe
[5] = { 0, 1, 2, 3, 4 };

751 
pf
->
œ°_glyph_code
 = -1;

752 
pf
->
œ°_≥n_pos
 = -32767;

758 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

759 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

761 
as˚¡
 = ((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * 
imërics
.
y_sˇÀ
)/0x10000);

762 
des˚¡
 = ((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
*
imërics
.
y_sˇÀ
)/0x10000);

768 i‡(
Êags
&
MWTF_BOTTOM
) {

769 
vec_x
 = 0;

770 
vec_y
 = 
des˚¡
;

771 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

772 
x
 -
vec_x
 / 64;

773 
y
 +
vec_y
 / 64;

774 } i‡(
Êags
&
MWTF_TOP
) {

775 
vec_x
 = 0;

776 
vec_y
 = 
as˚¡
;

777 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

778 
x
 -
vec_x
 / 64;

779 
y
 +
vec_y
 / 64;

783 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
) {

784 
	`TT_Së_Ra°î_Gøy_PÆëã
 (
ígöe
, 
vútuÆ_∑Àâe
);

786 
	`ÆphabÀnd
(
psd
, 
gøy_∑Àâe
, 
gr_f‹eground
, 
gr_background
,

787 
bÀnd
, 5);

790 
°¨tx
 = 
x
;

791 
°¨ty
 = 
y
;

792 
i
 = 0; i < 
cc
; i++) {

793 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
, 
°r
[
i
]);

795 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

796 
TTLOAD_DEFAULT
Ë!
TT_Eº_Ok
)

799 i‡(
pf
->
f⁄åŸ©i⁄
) {

800 
	`TT_Gë_Glyph_Ouéöe
 (
pf
->
glyph
, &
ouéöe
);

801 
	`TT_Tønsf‹m_Ouéöe
 (&
ouéöe
, &
pf
->
m©rix
);

804 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

806 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
) {

807 i‡(
pf
->
f⁄åŸ©i⁄
) {

808 
vec_x
 = 
	`compuã_kînvÆ
(
pf
, 
curch¨
);

809 
vec_y
 = 0;

810 
	`TT_Tønsf‹m_Ve˘‹
(&
vec_x
, &
vec_y
,&
pf
->
m©rix
);

812 
x
 +
vec_x
 / 64;

813 
y
 -
vec_y
 / 64;

815 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

818 
	`døwch¨
(
pf
, 
psd
, 
curch¨
, 
x
, 
y
);

820 i‡(
pf
->
f⁄åŸ©i⁄
) {

821 
vec_x
 = 
mërics
.
adv™˚
;

822 
vec_y
 = 0;

823 
	`TT_Tønsf‹m_Ve˘‹
 (&
vec_x
, &
vec_y
, &
pf
->
m©rix
);

825 
x
 +
vec_x
 / 64;

826 
y
 -
vec_y
 / 64;

828 
x
 +
mërics
.
adv™˚
 / 64;

831 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

832 
x
 = 
pf
->
œ°_≥n_pos
;

833 
pf
->
œ°_≥n_pos
 = 
x
;

836 
pf
->
œ°_glyph_code
 = 
curch¨
;

839 i‡(
pf
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

840 
	`GdLöe
(
psd
, 
°¨tx
, 
°¨ty
, 
x
, 
y
, 
FALSE
);

841 
	}
}

846 
MWBOOL


847 
	$‰ìty≥_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

849 
i
;

850 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

851 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

852 
TT_In°™˚_Mërics
 
imërics
;

853 
TT_USh‹t
 
œ°_glyph_ödex
;

855 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

856 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

859 
pf⁄töfo
->
height
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * \

860 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

861 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 * \

862 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

863 
pf⁄töfo
->
maxwidth
 = ((
¥›îtõs
.
h‹iz⁄èl
->
xMax_Exã¡
 * \

864 
imërics
.
x_sˇÀ
)/ 0x10000) >> 6;

865 
pf⁄töfo
->
ba£löe
 = ((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 * \

866 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

867 
pf⁄töfo
->
fú°ch¨
 = 
	`TT_Ch¨M≠_Fú°
(
pf
->
ch¨_m≠
, 
NULL
);

868 
pf⁄töfo
->
œ°ch¨
 = 
	`TT_Ch¨M≠_La°
(
pf
->
ch¨_m≠
, 
NULL
);

869 
pf⁄töfo
->
fixed
 = 
¥›îtõs
.
po°s¸ùt
->
isFixedPôch
;

873 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
 + 2;

874 
pf⁄töfo
->
des˚¡
 =Öf⁄töfo->
height
 -Öf⁄töfo->
ba£löe
;

875 
pf⁄töfo
->
maxas˚¡
 =Öf⁄töfo->
ba£löe
;

876 
pf⁄töfo
->
maxdes˚¡
 =Öf⁄töfo->
des˚¡
;

878 
œ°_glyph_ödex
 = 
¥›îtõs
.
num_Glyphs
 > 255 ? 255:Öroperties.num_Glyphs-1;

882 i‡(
	`TT_Gë_Fa˚_Widths
–
pf
->
Á˚
, 0,

883 
œ°_glyph_ödex
, 
widths
, 
NULL
 ) !
TT_Eº_Ok
) {

884  
TRUE
;

887 
i
=0; i<=
œ°_glyph_ödex
; i++)

888 
	`DPRINTF
("widths[%d]: %d\n", 
i
, 
widths
[i]);

892 
i
=0; i<=
œ°_glyph_ödex
; i++)

893 
pf⁄töfo
->
widths
[
i
] = 
	`Gë_Glyph_Width
(
pf
, i);

896 
	`DPRINTF
("x_ppem: %d\ny_ppem: %d\nx_scale: %d\ny_scale: %d\n\
_resolution: %d\ny_resolution: %d\n",

898 
imërics
.
x_µem
, imërics.
y_µem
, imërics.
x_sˇÀ
, \

899 
imërics
.
y_sˇÀ
, imërics.
x_ªsﬁuti⁄
, imërics.
y_ªsﬁuti⁄
);

901 
	`DPRINTF
("Ascender: %d\nDescender: %d\nxMax_Extent: %d\n\
 Style Say Italic?: %d\nMac Style Say Bold?: %d\n\
: %d\nsTypoDescender: %d\nusWinAscent: %d\n\
: %d\nusFirstCharIndex: %d\nusLastCharIndex: %d\n\
2 Say Italic?: %d\nOS2 Say Bold?: %d\nOS2 Say monospaced?: %d\n\
 Say monospaced?: %d\n",\

907 
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
,

908 
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
,

909 
¥›îtõs
.
h‹iz⁄èl
->
xMax_Exã¡
,

910 (
¥›îtõs
.
hódî
->
Mac_StyÀ
 & 0x2)?1:0,

911 (
¥›îtõs
.
hódî
->
Mac_StyÀ
 & 0x1)?1:0,

912 
¥›îtõs
.
os2
->
sTypoAs˚ndî
,

913 
¥›îtõs
.
os2
->
sTypoDes˚ndî
,

914 
¥›îtõs
.
os2
->
usWöAs˚¡
,

915 
¥›îtõs
.
os2
->
usWöDes˚¡
,

916 
¥›îtõs
.
os2
->
usFú°Ch¨Index
,

917 
¥›îtõs
.
os2
->
usLa°Ch¨Index
,

918 (
¥›îtõs
.
os2
->
fsSñe˘i⁄
 & 0x1)?1:0,

919 (
¥›îtõs
.
os2
->
fsSñe˘i⁄
 & 0x20)?1:0,

920 
¥›îtõs
.
po°s¸ùt
->
isFixedPôch
,

921 (
¥›îtõs
.
os2
->
∑no£
[3] == 9)?1:0);

924  
TRUE
;

925 
	}
}

928 
	$‰ìty≥_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

929 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

931 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

932 c⁄° * 
°r
 = 
ãxt
;

933 
TT_F26DŸ6
 
x
 = 0;

934 
i
;

935 
TT_USh‹t
 
curch¨
;

936 
TT_Glyph_Mërics
 
mërics
;

937 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

938 
TT_In°™˚_Mërics
 
imërics
;

940 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

941 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

943 
pf
->
œ°_glyph_code
 = -1;

944 
pf
->
œ°_≥n_pos
 = -32767;

946 
i
 = 0; i < 
cc
; i++) {

947 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
, 
°r
[
i
]);

949 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

950 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

953 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

955 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
) {

956 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

959 
x
 +
mërics
.
adv™˚
 / 64;

962 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

963 
x
 = 
pf
->
œ°_≥n_pos
;

964 
pf
->
œ°_≥n_pos
 = 
x
;

966 
pf
->
œ°_glyph_code
 = 
curch¨
;

969 *
pwidth
 = 
x
;

970 *
pheight
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 *

971 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

972 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 *

973 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

975 *
pba£
 = (((-
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
) *

976 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

977 
	}
}

980 
	$‰ìty≥_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

982 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

984 
	`TT_Clo£_Fa˚
(
pf
->
Á˚
);

988 i‡(
pf
->
glyph_ˇche
 != 0)

989 
	`‰ì_ˇche_glyph
(
pf
->
glyph_ˇche
);

993 
	`‰ì
(
pf
);

994 
	}
}

997 
	$‰ìty≥_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
)

999 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

1001 
pf
->
f⁄tsize
 = fontsize;

1004 i‡(!
f⁄tsize
)

1008 
	`TT_Së_In°™˚_PixñSizes
–
pf
->
ö°™˚
,Öf->
f⁄tsize
,

1009 
pf
->
f⁄tsize
,Öf->fontsize * 64 );

1012 
	`TT_Së_In°™˚_Ch¨Size
 (
pf
->
ö°™˚
,

1013 ((
pf
->
f⁄tsize
 * 72 + 96/2) / 96) * 64);

1015 
	}
}

1018 
	$‰ìty≥_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
)

1020 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

1021 
™gÀ
;

1023 
pf
->
f⁄åŸ©i⁄
 = 
ã¡hdegªes
;

1026 
	`TT_Së_In°™˚_Tønsf‹m_Fœgs
 (
pf
->
ö°™˚
, 
TRUE
, 
FALSE
);

1028 
™gÀ
 = 
pf
->
f⁄åŸ©i⁄
 * 
M_PI
 / 1800;

1029 
pf
->
m©rix
.
yy
 = (
TT_Fixed
Ë(
	`cos
 (
™gÀ
) * (1 << 16));

1030 
pf
->
m©rix
.
yx
 = (
TT_Fixed
Ë(
	`sö
 (
™gÀ
) * (1 << 16));

1031 
pf
->
m©rix
.
xx
 =Öf->m©rix.
yy
;

1032 
pf
->
m©rix
.
xy
 = -pf->m©rix.
yx
;

1033 
	}
}

1037 
	$GdGëTextSizeEx
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
,
nMaxExã¡
,

1038 * 
ÕnFô
, * 
ÆpDx
,
MWCOORD
 *
pwidth
,MWCOORD *
pheight
,

1039 
MWCOORD
 *
pba£
, 
MWTEXTFLAGS
 
Êags
)

1041 
buf
[256];

1042 * 
ãxt
;

1043 
PMWFREETYPEFONT
 
pf
 = (PMWFREETYPEFONT)
pf⁄t
;

1044 
MWTEXTFLAGS
 
de„ncodög
 = 
pf
->
f⁄çrocs
->
ícodög
;

1045 
x
 = 0;

1046 
i
;

1047 
TT_USh‹t
 
curch¨
;

1048 
TT_Glyph_Mërics
 
mërics
;

1049 
TT_Fa˚_Pr›îtõs
 
¥›îtõs
;

1050 
TT_In°™˚_Mërics
 
imërics
;

1052 i‡((
cc
<0)||(!
°r
))

1054 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

1058 if((
Êags
 & (
MWTF_PACKMASK
|
MWTF_DBCSMASK
)Ë!
de„ncodög
)

1060 
cc
 = 
	`GdC⁄vîtEncodög
(
°r
, 
Êags
, cc, 
buf
, 
de„ncodög
);

1061 
Êags
 &~(
MWTF_PACKMASK
|
MWTF_DBCSMASK
);

1062 
Êags
 |
de„ncodög
;

1063 
ãxt
=
buf
;

1064 } 
ãxt
 =(*)
°r
;

1065 if(
cc
 <= 0)

1067 *
pwidth
 = *
pheight
 = *
pba£
 = 0;

1071 
	`TT_Gë_Fa˚_Pr›îtõs
 (
pf
->
Á˚
, &
¥›îtõs
);

1072 
	`TT_Gë_In°™˚_Mërics
(
pf
->
ö°™˚
, &
imërics
);

1074 
pf
->
œ°_glyph_code
 = -1;

1075 
pf
->
œ°_≥n_pos
 = -32767;

1076 i‡(
ÕnFô
)

1077 *
ÕnFô
=-1;

1078 
i
 = 0; i < 
cc
; i++)

1080 
curch¨
 = 
	`TT_Ch¨_Index
 (
pf
->
ch¨_m≠
,
ãxt
[
i
]);

1082 i‡(
	`TT_Lﬂd_Glyph
 (
pf
->
ö°™˚
,Öf->
glyph
, 
curch¨
,

1083 
TTLOAD_SCALE_GLYPH
|
TTLOAD_HINT_GLYPH
Ë!
TT_Eº_Ok
)

1085 
	`¥ötf
("U«bÀÅÿlﬂd glyph wôh index=%d\n",
curch¨
);

1088 
	`TT_Gë_Glyph_Mërics
 (
pf
->
glyph
, &
mërics
);

1089 i‡((
pf
->
f⁄èâr
&
MWTF_KERNING
Ë&&Öf->
ˇn_kîn
)

1091 
x
 +
	`compuã_kînvÆ
(
pf
, 
curch¨
) / 64;

1093 
x
 +
mërics
.
adv™˚
 / 64;

1094 if((
ÕnFô
)&&(
ÆpDx
))

1096 i‡(
x
<=
nMaxExã¡
)

1097 
ÆpDx
[
i
]=
x
;

1099 i‡(*
ÕnFô
==-1)

1100 (*
ÕnFô
)=
i
;

1103 i‡(
pf
->
œ°_≥n_pos
 > 
x
)

1104 
x
 = 
pf
->
œ°_≥n_pos
;

1105 
pf
->
œ°_≥n_pos
 = 
x
;

1106 
pf
->
œ°_glyph_code
 = 
curch¨
;

1108 i‡((
ÕnFô
)&&(*lpnFit==-1))

1109 *
ÕnFô
=
cc
;

1110 *
pwidth
 = 
x
;

1111 *
pheight
 = (((
¥›îtõs
.
h‹iz⁄èl
->
As˚ndî
 *

1112 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6) -

1113 (((
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
 *

1114 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6);

1116 i‡(
pba£
)

1117 *
pba£
 = (((-
¥›îtõs
.
h‹iz⁄èl
->
Des˚ndî
) *

1118 
imërics
.
y_sˇÀ
)/ 0x10000) >> 6;

1120 
	}
}

1127 
	$â_lookup_«me
(
TT_Fa˚
 
Á˚
)

1129 
TT_Fa˚_Pr›îtõs
 
¥›
;

1130 
i
, 
n
;

1131 
∂©f‹m
, 
ícodög
, 
œnguage
, 
id
;

1132 *
°rög
;

1133 *
«me_buf„r
;

1134 
°rög_Àn
;

1135 
j
, 
found
;

1136 
ödex
 = 4;

1137 
«me_Àn
;

1140 
	`TT_Gë_Fa˚_Pr›îtõs
(
Á˚
, &
¥›
);

1141 
n
 = 
¥›
.
num_Names
;

1143  
i
 = 0; i < 
n
; i++ ) {

1144 
	`TT_Gë_Name_ID
–
Á˚
, 
i
, &
∂©f‹m
, &
ícodög
, &
œnguage
, &
id
 );

1145 
	`TT_Gë_Name_Såög
–
Á˚
, 
i
, &
°rög
, &
°rög_Àn
 );

1147 i‡(
id
 =
ödex
 ) {

1150 
found
 = 0;

1153 i‡–
∂©f‹m
 == 3 )

1154  
j
 = 1; j >= 0; j-- )

1155 i‡–
ícodög
 =
j
 )

1156 i‡–(
œnguage
 & 0x3FF) == 0x009 ) {

1158 
found
 = 1;

1162 i‡–!
found
 && 
∂©f‹m
 =0 && 
œnguage
 == 0 )

1163 
found
 = 1;

1166 i‡–
found
 ) {

1167 i‡–
°rög_Àn
 > 512 )

1168 
°rög_Àn
 = 512;

1170 
«me_Àn
 = 0;

1171 
«me_buf„r
 = (*)
	`mÆloc
((
°rög_Àn
 / 2) + 1);

1173  
i
 = 1; i < 
°rög_Àn
; i += 2 )

1174 
«me_buf„r
[
«me_Àn
++] = 
°rög
[
i
];

1176 
«me_buf„r
[
«me_Àn
] = '\0';

1178  
«me_buf„r
;

1184  
NULL
;

1185 
	}
}

1188 
	$gë_â_«me
(*
p
)

1190 
TT_Fa˚
 
Á˚
;

1191 *
ªt
;

1195 i‡(
	`TT_O≥n_Fa˚
(
ígöe
, 
p
, &
Á˚
Ë!
TT_Eº_Ok
) {

1196 
	`¥ötf
("Eº‹ o≥nög f⁄t: %s\n", 
p
);

1197  
NULL
;

1200 
ªt
 = 
	`â_lookup_«me
(
Á˚
);

1202 
	`TT_Clo£_Fa˚
(
Á˚
);

1204  
ªt
;

1205 
	}
}

1208 
	$GdFªeF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, 
n
)

1210 
i
;

1211 
MWFONTLIST
 *
g
, **
li°
 = *
f⁄ts
;

1213 
i
 = 0; i < 
n
; i++) {

1214 
g
 = 
li°
[
i
];

1215 if(
g
) {

1216 if(
g
->
mw«me
)

1217 
	`‰ì
(
g
->
mw«me
);

1218 if(
g
->
â«me
)

1219 
	`‰ì
(
g
->
â«me
);

1220 
	`‰ì
(
g
);

1223 
	`‰ì
(
li°
);

1224 *
f⁄ts
 = 0;

1225 
	}
}

1228 
	$GdGëF⁄tLi°
(
MWFONTLIST
 ***
f⁄ts
, *
numf⁄ts
)

1230 
DIR
 *
dú
;

1231 
dúít
 *
dít
;

1232 *
p
, *
·mp
;

1233 
∂
, 
idx
 = 0;

1234 
MWFONTLIST
 **
li°
;

1237 i‡(
TT_Eº_Ok
 !
	`TT_Inô_FªeTy≥
(&
ígöe
)) {

1238 
	`¥ötf
("UnableÅo initialize freetype\n");

1239 *
numf⁄ts
 = -1;

1243 
dú
 = 
	`›ídú
(
FREETYPE_FONT_DIR
);

1245 i‡(
dú
 <= 0) {

1246 
	`¥ötf
("Error opening font directory\n");

1247 *
numf⁄ts
 = -1;

1252 (
dít
 = 
	`ªaddú
(
dú
)Ë!
NULL
) {

1253 
p
 = 
	`°ºchr
(
dít
->
d_«me
, '.');

1254 i‡(
	`°rˇ£cmp
(
p
, ".ttf") == 0)

1255 
idx
++;

1258 *
numf⁄ts
 = 
idx
;

1259 
	`ªwöddú
(
dú
);

1262 
li°
 = (
MWFONTLIST
**)
	`mÆloc
(
idx
 * (MWFONTLIST*));

1263 
∂
 = 0;Ö»< 
idx
;Öl++)

1264 
li°
[
∂
] = (
MWFONTLIST
*)
	`mÆloc
((MWFONTLIST));

1266 *
f⁄ts
 = 
li°
;

1268 
idx
 = 0;

1270 (
dít
 = 
	`ªaddú
(
dú
)Ë!
NULL
) {

1272 
p
 = 
	`°ºchr
(
dít
->
d_«me
, '.');

1274 i‡(
	`°rˇ£cmp
(
p
, ".ttf") == 0) {

1277 
p
 = 0;

1278 
∂
 = 
	`°æí
(
FREETYPE_FONT_DIR
Ë+ såÀn(
dít
->
d_«me
) *

1280 
p
 = (*)
	`mÆloc
(
∂
);

1281 
p
 = (*)
	`mem£t
’, '\0', 
∂
);

1282 
p
 = (*)
	`°rˇt
’, 
FREETYPE_FONT_DIR
);

1283 
p
 = (*)
	`°rˇt
(p, "/");

1284 
p
 = (*)
	`°rˇt
’, 
dít
->
d_«me
);

1287 if((
·mp
 = 
	`gë_â_«me
(
p
)Ë!
NULL
) {

1288 
li°
[
idx
]->
â«me
 = 
·mp
;

1289 
li°
[
idx
]->
mw«me
 = 
	`mÆloc
(
	`°æí
(
dít
->
d_«me
) + 1);

1290 
li°
[
idx
]->
mw«me
 = 
	`°r˝y
÷i°[idx]->mw«me, 
dít
->
d_«me
);

1292 
idx
++;

1295 
	`‰ì
(
p
);

1299 
	`˛o£dú
(
dú
);

1300 
	}
}

	@engine/font_freetype2.c

30 
	~<°dio.h
>

31 
	~<°dlib.h
>

32 
	~<°rög.h
>

33 
	~<as£π.h
>

34 
	~<°rög.h
>

36 
	~<dúít.h
>

38 
	~"devi˚.h
"

40 
	~"devf⁄t.h
"

42 #i‡(
UNIX
 | 
DOS_DJGPP
)

43 
	#°rcmpi
 
°rˇ£cmp


	)

47 
MWPIXELVAL
 
gr_f‹eground
;

48 
MWPIXELVAL
 
gr_background
;

49 
MWBOOL
 
gr_u£bg
;

64 
	#HAVE_FREETYPE_2_CACHE
 1

	)

80 
	#HAVE_FREETYPE_2_CMAP_CACHE
 0

	)

87 
	~<·2buûd.h
>

88 #ö˛udê
FT_FREETYPE_H


89 #ö˛udê
FT_TRIGONOMETRY_H


90 #ö˛udê
FT_GLYPH_H


91 #i‡
HAVE_FREETYPE_2_CACHE


92 #ö˛udê
FT_CACHE_H


93 #ö˛udê
FT_CACHE_SMALL_BITMAPS_H


94 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


95 #ö˛udê
FT_CACHE_CHARMAP_H


113 
	#SIMPLIFY_VERSION_NUMBER
(
maj‹
,
mö‹
,
∑tch
) \

114 ((
maj‹
)*0x01000000UL + (
mö‹
)*0x01000UL + (
∑tch
)*0x01UL)

	)

119 
	#FREETYPE_VERSION_NUMBER_SIMPLE
 \

120 
	`SIMPLIFY_VERSION_NUMBER
(
FREETYPE_MAJOR
,
FREETYPE_MINOR
,
FREETYPE_PATCH
)

	)

134 
	#HAVE_FREETYPE_VERSION_AFTER_OR_EQUAL
(
maj‹
,
mö‹
,
∑tch
) \

135 (
FREETYPE_VERSION_NUMBER_SIMPLE
 >
	`SIMPLIFY_VERSION_NUMBER
(
maj‹
,
mö‹
,
∑tch
))

	)

138 #i‚de‡
FREETYPE_FONT_DIR


142 
	#FREETYPE_FONT_DIR
 "/u§/loˇl/mi¸owö/f⁄ts"

	)

148 *
	g‰ìty≥2_f⁄t_dú
;

151 
‰ìty≥2_f⁄td©a_
 
	t‰ìty≥2_f⁄td©a
;

153 
	s‰ìty≥2_f⁄td©a_


155 
	misBuf„r
;

158 *
	mfûíame
;

162 *
	md©a
;

163 
	mÀngth
;

165 
	mbuf„r
;

167 
	md©a
;

168 
	mªfcou¡
;

169 #i‡
HAVE_FREETYPE_2_CACHE


170 
‰ìty≥2_f⁄td©a
 *
	m√xt
;

174 
	sMWFREETYPE2FONT_STRUCT


176 
PMWFONTPROCS
 
	mf⁄çrocs
;

177 
MWCOORD
 
	mf⁄tsize
;

178 
	mf⁄åŸ©i⁄
;

179 
	mf⁄èâr
;

183 *
	mfûíame
;

184 
‰ìty≥2_f⁄td©a
 *
	mÁ˚id
;

185 #i‡
HAVE_FREETYPE_2_CACHE


186 #i‡
HAVE_FREETYPE_VERSION_AFTER_OR_EQUAL
(2,1,3)

187 
FTC_ImageTy≥Rec
 
	mimagedesc
;

189 
FTC_ImageDesc
 
	mimagedesc
;

191 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


192 
FTC_CM≠DescRec
 
	mcm≠desc
;

195 
FT_Fa˚
 
	mÁ˚
;

197 
FT_M©rix
 
	mm©rix
;

201 
MWBOOL
 
‰ìty≥2_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

202 
‰ìty≥2_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

203 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

204 
MWCOORD
 *
pba£
);

205 
‰ìty≥2_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

206 
‰ìty≥2_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

207 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

208 
‰ìty≥2_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
);

209 
‰ìty≥2_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
);

210 
‰ìty≥2_£tf⁄èâr
(
PMWFONT
 
pf⁄t
, 
£tÊags
, 
˛rÊags
);

211 
PMWFONT
 
‰ìty≥2_du∂iˇã
(PMWFONT 
p§cf⁄t
, 
MWCOORD
 
f⁄tsize
);

217 
MWFONTPROCS
 
	g‰ìty≥2_¥ocs
 = {

218 
MWTF_UC16
,

219 
‰ìty≥2_gëf⁄töfo
,

220 
‰ìty≥2_gëãxtsize
,

221 
NULL
,

222 
‰ìty≥2_de°royf⁄t
,

223 
‰ìty≥2_døwãxt
,

224 
‰ìty≥2_£tf⁄tsize
,

225 
‰ìty≥2_£tf⁄åŸ©i⁄
,

226 
‰ìty≥2_£tf⁄èâr
,

227 
‰ìty≥2_du∂iˇã
,

231 
PMWFREETYPE2FONT


232 
‰ìty≥2_¸óãf⁄t_öã∫Æ
(
‰ìty≥2_f⁄td©a
 * 
Á˚id
,

233 *
fûíame
, 
MWCOORD
 
height
);

239 
FT_Libøry
 
	g‰ìty≥2_libøry
 = 
NULL
;

241 #i‡
HAVE_FREETYPE_2_CACHE


250 
‰ìty≥2_f⁄td©a
 *
	g‰ìty≥2_f⁄ts
 = 
NULL
;

255 
FTC_M™agî
 
	g‰ìty≥2_ˇche_m™agî
;

260 
FTC_SBôCache
 
	g‰ìty≥2_ˇche_sbô
;

262 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


266 
FTC_CM≠Cache
 
	g‰ìty≥2_ˇche_cm≠
;

270 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


281 
	#LOOKUP_CHAR
(
pf_
,
Á˚_
,
ch_
) \

282 (
	`FTC_CM≠Cache_Lookup
(
‰ìty≥2_ˇche_cm≠
, \

283 &((
pf_
)->
cm≠desc
), \

284 (
ch_
)))

	)

287 
	#LOOKUP_CHAR
(
pf_
,
Á˚_
,
ch_
) \

288 (
	`FT_Gë_Ch¨_Index
((
Á˚_
), (
ch_
)))

	)

299 
	#FREETYPE2_CACHE_FONT_SIZE_LIMIT
 100

	)

308 
	#CAN_USE_FT2_CACHE
(
pf_
) \

309 (((
pf_
)->
f⁄åŸ©i⁄
 == 0) && \

310 ((
pf_
)->
f⁄tsize
 < 
FREETYPE2_CACHE_FONT_SIZE_LIMIT
))

	)

321 
FT_Eº‹


322 
	$‰ìty≥2_Á˚_ªque°î
(
FTC_Fa˚ID
 
Á˚_id
,

323 
FT_Libøry
 
libøry
,

324 
FT_Poöãr
 
ªque°_d©a
, 
FT_Fa˚
 * 
aÁ˚
)

326 
‰ìty≥2_f⁄td©a
 *
f⁄td©a
 = (‰ìty≥2_f⁄td©®*Ë
Á˚_id
;

328 
	`as£π
(
f⁄td©a
);

330 i‡(
f⁄td©a
->
isBuf„r
) {

331 * 
buf„r
 = 
f⁄td©a
->
d©a
.buffer.data;

332 
Àngth
 = 
f⁄td©a
->
d©a
.
buf„r
.length;

337 
	`as£π
(
buf„r
);

338  
	`FT_New_Mem‹y_Fa˚
(
libøry
, 
buf„r
, 
Àngth
, 0, 
aÁ˚
);

340 * 
fûíame
 = 
f⁄td©a
->
d©a
.filename;

343 
	`as£π
(
fûíame
);

344  
	`FT_New_Fa˚
(
libøry
, 
fûíame
, 0, 
aÁ˚
);

346 
	}
}

358 
	$‰ìty≥2_öô
(
PSD
 
psd
)

360 
FT_Eº‹
 
îr
;

362 i‡(
‰ìty≥2_libøry
 !
NULL
) {

366 i‡((
‰ìty≥2_f⁄t_dú
 = 
	`gëív
("MWFONTS")Ë=
NULL
) {

367 
‰ìty≥2_f⁄t_dú
 = 
FREETYPE_FONT_DIR
;

371 
îr
 = 
	`FT_Inô_FªeTy≥
(&
‰ìty≥2_libøry
);

373 i‡(
îr
 !
FT_Eº_Ok
) {

374 
‰ìty≥2_libøry
 = 
NULL
;

375 
	`EPRINTF
("Eº‹ 0x%x inôülizög FªeTy≥ 2\n", 
îr
);

378 #i‡
HAVE_FREETYPE_2_CACHE


380 
îr
 = 
	`FTC_M™agî_New
(
‰ìty≥2_libøry
, 3,

383 &
‰ìty≥2_Á˚_ªque°î
, 
NULL
,

384 &
‰ìty≥2_ˇche_m™agî
);

385 i‡(
îr
 !
FT_Eº_Ok
) {

386 
	`EPRINTF
("Error 0x%x initializing FreeType 2 cache system\n",

387 
îr
);

389 
‰ìty≥2_ˇche_m™agî
 = 
NULL
;

390 
	`FT_D⁄e_FªeTy≥
(
‰ìty≥2_libøry
);

391 
‰ìty≥2_libøry
 = 
NULL
;

395 
îr
 = 
	`FTC_SBôCache_New
(
‰ìty≥2_ˇche_m™agî
,

396 &
‰ìty≥2_ˇche_sbô
);

397 i‡(
îr
 !
FT_Eº_Ok
) {

398 
	`EPRINTF
("Eº‹ 0x%x inôülizög FªeTy≥ 2 sbô cachêsy°em\n", 
îr
);

400 
‰ìty≥2_ˇche_sbô
 = 
NULL
;

401 
	`FTC_M™agî_D⁄e
(
‰ìty≥2_ˇche_m™agî
);

402 
‰ìty≥2_ˇche_m™agî
 = 
NULL
;

403 
	`FT_D⁄e_FªeTy≥
(
‰ìty≥2_libøry
);

404 
‰ìty≥2_libøry
 = 
NULL
;

407 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


408 
îr
 = 
	`FTC_CM≠Cache_New
(
‰ìty≥2_ˇche_m™agî
,

409 &
‰ìty≥2_ˇche_cm≠
);

410 i‡(
îr
 !
FT_Eº_Ok
) {

411 
	`EPRINTF
("Eº‹ 0x%x inôülizög FªeTy≥ 2 cm≠ cachêsy°em\n", 
îr
);

413 
‰ìty≥2_ˇche_cm≠
 = 
NULL
;

415 
‰ìty≥2_ˇche_sbô
 = 
NULL
;

416 
	`FTC_M™agî_D⁄e
(
‰ìty≥2_ˇche_m™agî
);

417 
‰ìty≥2_ˇche_m™agî
 = 
NULL
;

418 
	`FT_D⁄e_FªeTy≥
(
‰ìty≥2_libøry
);

419 
‰ìty≥2_libøry
 = 
NULL
;

426 
	}
}

438 
PMWFREETYPE2FONT


439 
	$‰ìty≥2_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

441 
PMWFREETYPE2FONT
 
pf
;

442 *
p
;

443 *
f⁄äame
;

444 
‰ìty≥2_f⁄td©a
 *
Á˚id
 = 
NULL
;

445 #i‡
HAVE_FREETYPE_2_CACHE


446 
fú°_time
 = 0;

450 i‡(
‰ìty≥2_libøry
 =
NULL
) {

452 i‡(!
	`‰ìty≥2_öô
(
NULL
)) {

453  
NULL
;

457 
f⁄äame
 = 
	`mÆloc
(6 + 
	`°æí
(
«me
Ë+ såÀn(
‰ìty≥2_f⁄t_dú
));

458 i‡(
f⁄äame
 =
NULL
)

459  
NULL
;

462 i‡(
	`°rchr
(
«me
, '/'Ë!
NULL
) {

463 
	`°r˝y
(
f⁄äame
, 
«me
);

465 
	`°r˝y
(
f⁄äame
, 
‰ìty≥2_f⁄t_dú
);

466 
	`°rˇt
(
f⁄äame
, "/");

467 
	`°rˇt
(
f⁄äame
, 
«me
);

471 i‡((
p
 = 
	`°ºchr
(
f⁄äame
, '.')Ë=
NULL
 ||

472 ((
	`°rcmpi
(
p
, ".ttf") != 0) && (strcmpi(p, ".pfr") != 0))) {

473 
	`°rˇt
(
f⁄äame
, ".ttf");

475 #i‡
HAVE_FREETYPE_2_CACHE


476 
Á˚id
 = 
‰ìty≥2_f⁄ts
;

477  (
Á˚id
 !
NULL
Ë&& (0 !
	`°rcmpi
(Á˚id->
d©a
.
fûíame
, 
f⁄äame
)) )

479 
Á˚id
 = fa˚id->
√xt
;

481 i‡(
Á˚id
 =
NULL
) {

483 
	`DPRINTF
("N™o-X-Fªëy≥2: AddögÇew f⁄t: %s\n", 
f⁄äame
);

484 
Á˚id
 = (
‰ìty≥2_f⁄td©a
 *Ë
	`ˇŒoc
((*faceid), 1);

485 i‡(
Á˚id
 =
NULL
) {

486 
	`‰ì
(
f⁄äame
);

487  
NULL
;

490 
Á˚id
->
d©a
.
fûíame
 = 
f⁄äame
;

493 
Á˚id
->
√xt
 = 
‰ìty≥2_f⁄ts
;

494 
‰ìty≥2_f⁄ts
 = 
Á˚id
;

499 
fú°_time
 = 1;

501 
	`‰ì
(
f⁄äame
);

503 
f⁄äame
 = 
Á˚id
->
d©a
.
fûíame
;

505 
Á˚id
 = 
NULL
;

508 
pf
 = 
	`‰ìty≥2_¸óãf⁄t_öã∫Æ
(
Á˚id
, 
f⁄äame
, 
height
);

509 i‡(!
pf
) {

510 #i‡
HAVE_FREETYPE_2_CACHE


511 i‡(
fú°_time
) {

512 
	`as£π
(
‰ìty≥2_f⁄ts
 =
Á˚id
);

513 
‰ìty≥2_f⁄ts
 = 
Á˚id
->
√xt
;

514 
	`‰ì
(
f⁄äame
);

515 
	`‰ì
(
Á˚id
);

518 
	`‰ì
(
f⁄äame
);

520  
NULL
;

523 
	`GdSëF⁄tAâr
((
PMWFONT
Ë
pf
, 
©å
, 0);

525  
pf
;

526 
	}
}

536 
PMWFREETYPE2FONT


537 
	$‰ìty≥2_¸óãf⁄t‰ombuf„r
(c⁄° *
buf„r
,

538 
Àngth
, 
MWCOORD
 
height
)

540 
PMWFREETYPE2FONT
 
pf
;

541 
‰ìty≥2_f⁄td©a
 *
Á˚id
 = 
NULL
;

542 *
buf„rc›y
;

544 
	`as£π
(
buf„r
);

547 i‡(
‰ìty≥2_libøry
 =
NULL
) {

549 i‡(!
	`‰ìty≥2_öô
(
NULL
)) {

550  
NULL
;

554 
Á˚id
 = (
‰ìty≥2_f⁄td©a
 *Ë
	`ˇŒoc
((freetype2_fontdata), 1);

555 i‡(!
Á˚id
)

556  
NULL
;

558 
buf„rc›y
 = (*Ë
	`mÆloc
(
Àngth
);

559 i‡(!
buf„rc›y
) {

560 
	`‰ì
(
Á˚id
);

561  
NULL
;

563 
	`mem˝y
(
buf„rc›y
, 
buf„r
, 
Àngth
);

565 
Á˚id
->
isBuf„r
 = 
TRUE
;

566 
Á˚id
->
d©a
.
buf„r
.
Àngth
 =Üength;

567 
Á˚id
->
d©a
.
buf„r
.d©®
buf„rc›y
;

568 
Á˚id
->
ªfcou¡
 = 1;

575 
pf
 = 
	`‰ìty≥2_¸óãf⁄t_öã∫Æ
(
Á˚id
, 
NULL
, 
height
);

576 i‡(!
pf
) {

577 
	`‰ì
(
Á˚id
);

580  
pf
;

581 
	}
}

597 
PMWFREETYPE2FONT


598 
	$‰ìty≥2_¸óãf⁄t_öã∫Æ
(
‰ìty≥2_f⁄td©a
 * 
Á˚id
,

599 *
fûíame
, 
MWCOORD
 
height
)

601 
PMWFREETYPE2FONT
 
pf
;

602 #i‡
HAVE_FREETYPE_2_CACHE


603 
FT_Fa˚
 
Á˚
;

604 
FT_Size
 
size
;

606 
FT_Eº‹
 
îr‹
;

609 
pf
 = (
PMWFREETYPE2FONT
Ë
	`ˇŒoc
((
MWFREETYPE2FONT
), 1);

610 i‡(!
pf
) {

611  
NULL
;

613 
pf
->
f⁄çrocs
 = &
‰ìty≥2_¥ocs
;

615 
pf
->
Á˚id
 = faceid;

616 
pf
->
fûíame
 = filename;

617 #i‡
HAVE_FREETYPE_2_CACHE


618 
pf
->
imagedesc
.
f⁄t
.
Á˚_id
 = 
Á˚id
;

619 
pf
->
imagedesc
.
f⁄t
.
pix_width
 = 0;

620 
pf
->
imagedesc
.
f⁄t
.
pix_height
 = 0;

621 #i‡
	`HAVE_FREETYPE_VERSION_AFTER_OR_EQUAL
(2,1,3)

622 
pf
->
imagedesc
.
Êags
 = 0;

624 
pf
->
imagedesc
.
ty≥
 = 0;

626 #i‡
HAVE_FREETYPE_2_CMAP_CACHE


627 
pf
->
cm≠desc
.
Á˚_id
 = 
Á˚id
;

628 
pf
->
cm≠desc
.
ty≥
 = 
FTC_CMAP_BY_ENCODING
;

629 
pf
->
cm≠desc
.
u
.
ícodög
 = 
·_ícodög_unicode
;

633 i‡(
fûíame
) {

634 
îr‹
 = 
	`FT_New_Fa˚
(
‰ìty≥2_libøry
, 
fûíame
, 0, &
pf
->
Á˚
);

635 i‡(
îr‹
 !
FT_Eº_Ok
) {

636 
	`EPRINTF
("Nano-X-Freetype2: Can'tÜoad font from file \"%s\" - %lx\n",

637 
fûíame
, (Ë
îr‹
);

638 
out
;

642 
îr‹
 = 
	`FT_New_Mem‹y_Fa˚
(
‰ìty≥2_libøry
,

643 
buf„r
, 
Àngth
, 0, &
pf
->
Á˚
);

644 i‡(
îr‹
 !
FT_Eº_Ok
) {

645 
	`EPRINTF
("Nano-X-Freetype2: Can'tÜoad font from memory - %lx\n",

646 (Ë
îr‹
);

647 
out
;

652 
îr‹
 = 
	`FT_Sñe˘_Ch¨m≠
(
pf
->
Á˚
, 
·_ícodög_unicode
);

653 i‡(
îr‹
 !
FT_Eº_Ok
) {

654 
	`EPRINTF
("freetype2_createfont:Ço unicode mapÅable - %lx\n",

655 (Ë
îr‹
);

656 
out
;

660 
	`GdSëF⁄tSize
((
PMWFONT
Ë
pf
, 
height
);

661 
	`GdSëF⁄tRŸ©i⁄
((
PMWFONT
Ë
pf
, 0);

662 
	`GdSëF⁄tAâr
((
PMWFONT
Ë
pf
, 0, 0);

664 #i‡
HAVE_FREETYPE_2_CACHE


667 
îr‹
 = 
	`FTC_M™agî_Lookup_Size
(
‰ìty≥2_ˇche_m™agî
,

668 &(
pf
->
imagedesc
.
f⁄t
), &
Á˚
, &
size
);

669 i‡(
îr‹
 !
FT_Eº_Ok
) {

670 
	`EPRINTF
("Nano-X-Freetype2: Freetype 2Érror %lxÅryingÅoÜoad font.\n",

671 ()
îr‹
);

672 
	`‰ì
(
pf
);

673  
NULL
;

677  
pf
;

679 #i‡! 
HAVE_FREETYPE_2_CACHE


680 
out
:

681 i‡(
pf
->
Á˚
 !
NULL
) {

682 
	`FT_D⁄e_Fa˚
(
pf
->
Á˚
);

684 
	`‰ì
(
pf
);

685  
NULL
;

687 
	}
}

695 
	$‰ìty≥2_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

697 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

699 
	`as£π
(
pf
);

701 #i‡! 
HAVE_FREETYPE_2_CACHE


702 
	`FT_D⁄e_Fa˚
(
pf
->
Á˚
);

704 i‡(
pf
->
fûíame
)

705 
	`‰ì
(
pf
->
fûíame
);

708 i‡(
pf
->
Á˚id
 &&Öf->Á˚id->
isBuf„r
) {

709 i‡(--
pf
->
Á˚id
->
ªfcou¡
 <= 0) {

710 #i‡
HAVE_FREETYPE_2_CACHE


711 
	`FTC_M™agî_Re£t
(
‰ìty≥2_ˇche_m™agî
);

713 
	`‰ì
(
pf
->
Á˚id
->
d©a
.
buf„r
.data);

714 
	`‰ì
(
pf
->
Á˚id
);

718 
	`‰ì
(
pf
);

719 
	}
}

737 
PMWFONT


738 
	$‰ìty≥2_du∂iˇã
(
PMWFONT
 
p§cf⁄t
, 
MWCOORD
 
height
)

740 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
p§cf⁄t
;

741 
PMWFREETYPE2FONT
 
≤ewf
;

743 
	`as£π
(
pf
);

745 i‡(
height
 == 0) {

746 
height
 = 
pf
->
f⁄tsize
;

749 i‡(
pf
->
fûíame
) {

751 *
fûíame
;

752 #i‡
HAVE_FREETYPE_2_CACHE


755 
fûíame
 = 
pf
->filename;

758 
fûíame
 = 
	`mÆloc
(1 + 
	`°æí
(
pf
->filename));

759 i‡(!
fûíame
)

760  
NULL
;

761 
	`°r˝y
(
fûíame
, 
pf
->filename);

763 
≤ewf
 = 
	`‰ìty≥2_¸óãf⁄t_öã∫Æ
(
pf
->
Á˚id
, 
fûíame
,

764 
height
);

765 i‡(!
≤ewf
) {

766 
	`‰ì
(
fûíame
);

767  
NULL
;

770 
pf
->
Á˚id
->
ªfcou¡
++;

772 
≤ewf
 = 
	`‰ìty≥2_¸óãf⁄t_öã∫Æ
(
pf
->
Á˚id
, 
NULL
,

773 
height
);

774 i‡(!
≤ewf
) {

775 
pf
->
Á˚id
->
ªfcou¡
--;

776  
NULL
;

780 
	`GdSëF⁄tAâr
((
PMWFONT
Ë
≤ewf
, 
pf
->
f⁄èâr
, 0);

782 i‡(
pf
->
f⁄åŸ©i⁄
)

783 
	`GdSëF⁄tRŸ©i⁄
((
PMWFONT
Ë
≤ewf
, 
pf
->
f⁄åŸ©i⁄
);

785  (
PMWFONT
Ë
≤ewf
;

786 
	}
}

796 
	$‰ìty≥2_£tf⁄tsize
(
PMWFONT
 
pf⁄t
, 
MWCOORD
 
f⁄tsize
)

798 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

799 
MWCOORD
 
pixñ_height
;

800 
MWCOORD
 
pixñ_width
;

802 
	`as£π
(
pf
);

804 
pf
->
f⁄tsize
 = fontsize;

807 i‡(!
f⁄tsize
)

811 
pixñ_height
 = 
f⁄tsize
;

812 
pixñ_width
 = 
f⁄tsize
;

814 #i‡
HAVE_FREETYPE_2_CACHE


815 
pf
->
imagedesc
.
f⁄t
.
pix_width
 = 
pixñ_width
;

816 
pf
->
imagedesc
.
f⁄t
.
pix_height
 = 
pixñ_height
;

819 
	`FT_Së_Pixñ_Sizes
(
pf
->
Á˚
, 
pixñ_width
, 
pixñ_height
);

821 
	}
}

831 
	$‰ìty≥2_£tf⁄åŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
)

833 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

835 
	`as£π
(
pf
);

838 i‡((
ã¡hdegªes
 < 0) || (tenthdegrees >= 3600)) {

839 
ã¡hdegªes
 =Åenthdegrees % 3600;

840 i‡(
ã¡hdegªes
 < 0) {

841 
ã¡hdegªes
 += 3600;

845 
pf
->
f⁄åŸ©i⁄
 = 
ã¡hdegªes
;

847 i‡(
pf
->
f⁄åŸ©i⁄
 == 0) {

849 
pf
->
m©rix
.
yy
 = (
FT_Fixed
) (1 << 16);

850 
pf
->
m©rix
.
xx
 = (
FT_Fixed
) (1 << 16);

851 
pf
->
m©rix
.
yx
 = (
FT_Fixed
) 0;

852 
pf
->
m©rix
.
xy
 = (
FT_Fixed
) 0;

854 
FT_AngÀ
 
™gÀ
 = (
ã¡hdegªes
 << 16) / 10;

855 
FT_Ve˘‹
 
söcosvec
;

856 
	`FT_Ve˘‹_Unô
(&
söcosvec
, 
™gÀ
);

857 
pf
->
m©rix
.
yy
 = 
söcosvec
.
y
;

858 
pf
->
m©rix
.
xx
 = 
söcosvec
.
y
;

859 
pf
->
m©rix
.
yx
 = 
söcosvec
.
x
;

860 
pf
->
m©rix
.
xy
 = -
söcosvec
.
x
;

862 
	}
}

874 
	$‰ìty≥2_£tf⁄èâr
(
PMWFONT
 
pf⁄t
, 
£tÊags
, 
˛rÊags
)

876 #i‡
HAVE_FREETYPE_2_CACHE


877 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

879 
	`as£π
(
pf
);

881 #i‡
	`HAVE_FREETYPE_VERSION_AFTER_OR_EQUAL
(2,1,3)

882 
pf
->
imagedesc
.
Êags
 = 
FT_LOAD_DEFAULT
;

883 i‡(!(
pf
->
f⁄èâr
 & 
MWTF_ANTIALIAS
))

885 
pf
->
imagedesc
.
Êags
 |(
FT_LOAD_MONOCHROME
 | 
FT_LOAD_TARGET_MONO
);

888 
pf
->
imagedesc
.
ty≥
 = (’f->
f⁄èâr
 & 
MWTF_ANTIALIAS
)

889 ? 
·c_image_gøys
 : 
·c_image_m⁄o
);

893 
	`as£π
(
pf⁄t
);

895 
	}
}

898 
	#ROUND_26_6_TO_INT
(
vÆuë‹ound
Ë(((vÆuë‹oundË+ 63Ë>> 6)

	)

917 
FT_Eº‹


918 
	$‰ìty≥2_gë_glyph_size
(
PMWFREETYPE2FONT
 
pf
,

919 
FT_Fa˚
 
Á˚
,

920 
glyph_ödex
,

921 *
∑dv™˚
,

922 *
∑s˚¡
,

923 *
pdes˚¡
)

925 
FT_Eº‹
 
îr‹
;

927 
	`as£π
 (
pf
);

928 
	`as£π
 (
Á˚
);

930 #i‡
HAVE_FREETYPE_2_CACHE


931 i‡(
	`CAN_USE_FT2_CACHE
(
pf
))

933 
FTC_SBô
 
sbô
;

935 
îr‹
 = 
	`FTC_SBôCache_Lookup
(
‰ìty≥2_ˇche_sbô
,

936 &(
pf
->
imagedesc
),

937 
glyph_ödex
, &
sbô
, 
NULL
);

938 i‡(
îr‹
)

939  
îr‹
;

943 i‡(
∑dv™˚
)

944 *
∑dv™˚
 = 
sbô
->
xadv™˚
;

945 i‡(
∑s˚¡
)

946 *
∑s˚¡
 = 
sbô
->
t›
;

947 i‡(
pdes˚¡
)

948 *
pdes˚¡
 = 
sbô
->
height
 - sbô->
t›
;

954 
îr‹
 = 
	`FT_Lﬂd_Glyph
(
Á˚
, 
glyph_ödex
, 
FT_LOAD_DEFAULT
);

955 i‡(
îr‹
)

956  
îr‹
;

958 i‡(
∑dv™˚
)

959 *
∑dv™˚
 = 
	`ROUND_26_6_TO_INT
(
Á˚
->
glyph
->
adv™˚
.
x
);

960 i‡(
∑s˚¡
 || 
pdes˚¡
)

962 
FT_Glyph
 
glyph
;

963 
FT_BBox
 
bbox
;

965 
îr‹
 = 
	`FT_Gë_Glyph
(
Á˚
->
glyph
, &glyph);

966 i‡(
îr‹
)

967  
îr‹
;

969 
	`FT_Glyph_Gë_CBox
(
glyph
, 
·_glyph_bbox_pixñs
, &
bbox
);

971 
	`FT_D⁄e_Glyph
(
glyph
);

973 i‡(
∑s˚¡
)

974 *
∑s˚¡
 = 
bbox
.
yMax
;

975 i‡(
pdes˚¡
)

976 *
pdes˚¡
 = -
bbox
.
yMö
;

981 
	}
}

1001 
FT_Eº‹


1002 
	$‰ìty≥2_gë_ch¨_size
(
PMWFREETYPE2FONT
 
pf
,

1003 
FT_Fa˚
 
Á˚
,

1004 
ch
,

1005 *
∑dv™˚
,

1006 *
∑s˚¡
,

1007 *
pdes˚¡
)

1009 
glyph
 = 
	`LOOKUP_CHAR
(
pf
, 
Á˚
, 
ch
);

1010  
	`‰ìty≥2_gë_glyph_size
(
pf
, 
Á˚
, 
glyph
, 
∑dv™˚
, 
∑s˚¡
, 
pdes˚¡
);

1011 
	}
}

1021 
MWBOOL


1022 
	$‰ìty≥2_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

1024 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

1025 
FT_Fa˚
 
Á˚
;

1026 
FT_Size
 
size
;

1027 
FT_BBox
 *
bbox
;

1028 
FT_Size_Mërics
 *
mërics
;

1029 
ch
;

1030 
Àadög
;

1031 #i‡
HAVE_FREETYPE_2_CACHE


1032 
FT_Eº‹
 
îr‹
;

1034 #i‡
MW_FEATURE_DO_NOT_TRUST_FONT_ASCENT_AND_DESCENT


1035 
f⁄t_as˚¡
;

1036 
f⁄t_des˚¡
;

1039 
	`as£π
(
pf
);

1040 
	`as£π
(
pf⁄töfo
);

1042 #i‡
HAVE_FREETYPE_2_CACHE


1043 
îr‹
 = 
	`FTC_M™agî_Lookup_Size
(
‰ìty≥2_ˇche_m™agî
,

1044 &(
pf
->
imagedesc
.
f⁄t
), &
Á˚
, &
size
);

1045 i‡(
îr‹
) {

1046 
	`EPRINTF
("Fªëy≥ 2Éº‹ 0x%x gëtög f⁄àöfo.\n", 
îr‹
);

1047  
FALSE
;

1050 
Á˚
 = 
pf
->face;

1051 
size
 = 
Á˚
->size;

1054 
bbox
 = &(
Á˚
->bbox);

1055 
mërics
 = &(
size
->metrics);

1057 i‡(!
	`FT_IS_SCALABLE
(
Á˚
)) {

1059  
FALSE
;

1063 
pf⁄töfo
->
maxwidth
 = 
	`ROUND_26_6_TO_INT
(
mërics
->
max_adv™˚
);

1065 
pf⁄töfo
->
maxas˚¡
 =

1066 
	`ROUND_26_6_TO_INT
(
	`FT_MulFix
(
bbox
->
yMax
, 
mërics
->
y_sˇÀ
));

1067 
pf⁄töfo
->
maxdes˚¡
 =

1068 
	`ROUND_26_6_TO_INT
(
	`FT_MulFix
(-
bbox
->
yMö
, 
mërics
->
y_sˇÀ
));

1070 
pf⁄töfo
->
fixed
 =

1071 ((
Á˚
->
Á˚_Êags
 & 
FT_FACE_FLAG_FIXED_WIDTH
) != 0);

1073 
pf⁄töfo
->
ba£löe
 = 
	`ROUND_26_6_TO_INT
(
mërics
->
as˚ndî
);

1074 
pf⁄töfo
->
des˚¡
 = 
	`ROUND_26_6_TO_INT
(
	`abs
(
mërics
->
des˚ndî
));

1075 
pf⁄töfo
->
height
 =Öf⁄töfo->
ba£löe
 +Öf⁄töfo->
des˚¡
;

1076 
Àadög
 = 
	`ROUND_26_6_TO_INT
(
mërics
->
height
 - (mërics->
as˚ndî
 + 
	`abs
(mërics->
des˚ndî
)));

1077 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
 + 
Àadög
;

1092 
pf⁄töfo
->
fú°ch¨
 = 0;

1093 
pf⁄töfo
->
œ°ch¨
 = 0xFFFFU;

1095 
ch
 = 0; ch < 256; ch++) {

1096 
adv™˚
;

1097 i‡(
	`‰ìty≥2_gë_ch¨_size
(
pf
, 
Á˚
, 
ch
, &
adv™˚
, 
NULL
, NULL))

1100 
pf⁄töfo
->
widths
[
ch
] =Öf⁄töfo->
maxwidth
;

1105 
pf⁄töfo
->
widths
[
ch
] = 
adv™˚
;

1110  
TRUE
;

1111 
	}
}

1126 
	$‰ìty≥2_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
ax
, MWCOORD 
ay
,

1127 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

1129 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

1130 
FT_Fa˚
 
Á˚
;

1131 
FT_Size
 
size
;

1132 c⁄° *
°r
 = 
ãxt
;

1133 
FT_Ve˘‹
 
pos
;

1134 
i
;

1135 
FT_Glyph
 
glyph
;

1136 
FT_Eº‹
 
îr‹
;

1137 
FT_Ve˘‹
 
kînög_dñè
;

1138 
curch¨
;

1139 
u£_kînög
;

1140 
œ°_glyph_code
 = 0;

1141 
drivî_gc_t
 
blô_ö°ru˘i⁄s
;

1142 
blô_›
;

1144 
	`as£π
(
pf
);

1145 
	`as£π
(
psd
);

1146 
	`as£π
(
ãxt
);

1150 #i‡
HAVE_FREETYPE_2_CACHE


1151 
îr‹
 = 
	`FTC_M™agî_Lookup_Size
(
‰ìty≥2_ˇche_m™agî
,

1152 &(
pf
->
imagedesc
.
f⁄t
), &
Á˚
, &
size
);

1153 i‡(
îr‹
) {

1154 
	`EPRINTF
("Freetype 2Érror 0x%x getting font for drawtext.\n",

1155 
îr‹
);

1159 
Á˚
 = 
pf
->face;

1160 
size
 = 
Á˚
->size;

1163 
u£_kînög
 = ((
pf
->
f⁄èâr
 & 
MWTF_KERNING
Ë&& 
	`FT_HAS_KERNING
(
Á˚
));

1166 
blô_ö°ru˘i⁄s
.
fg_cﬁ‹
 = 
gr_f‹eground
;

1167 
blô_ö°ru˘i⁄s
.
bg_cﬁ‹
 = 
gr_background
;

1168 
blô_ö°ru˘i⁄s
.
gr_u£bg
 = gr_usebg;

1169 
blô_ö°ru˘i⁄s
.
§cx
 = 0;

1170 
blô_ö°ru˘i⁄s
.
§cy
 = 0;

1171 
blô_ö°ru˘i⁄s
.
d°_löñí
 = 0;

1173 i‡(
pf
->
f⁄èâr
 & 
MWTF_ANTIALIAS
) {

1174 
blô_›
 = 
PSDOP_ALPHACOL
;

1176 
blô_›
 = 
PSDOP_BITMAP_BYTES_MSB_FIRST
;

1183 i‡(
Êags
 & 
MWTF_BOTTOM
) {

1184 
pos
.
y
 = (
	`abs
(
size
->
mërics
.
des˚ndî
) + 63) & ~63;

1185 } i‡(
Êags
 & 
MWTF_TOP
) {

1186 
pos
.
y
 = -(
size
->
mërics
.
as˚ndî
 + 63) & ~63;

1188 
pos
.
y
 = 0;

1192 i‡((
pf
->
f⁄åŸ©i⁄
 != 0)

1193 #i‡
HAVE_FREETYPE_2_CACHE


1194 || (!
	`CAN_USE_FT2_CACHE
(
pf
))

1199 
FT_Bôm≠Glyph
 
bôm≠glyph
;

1200 
FT_Bôm≠
 *
bôm≠
;

1201 
FT_Rídî_Mode
 
ªndî_mode
 =

1202 (
pf
->

1203 
f⁄èâr
 & 
MWTF_ANTIALIAS
Ë? 
·_ªndî_mode_n‹mÆ
 :

1204 
·_ªndî_mode_m⁄o
;

1207 
pos
.
x
 = 0;

1208 
i
 = 0; i < 
cc
; i++) {

1209 
curch¨
 = 
	`LOOKUP_CHAR
(
pf
, 
Á˚
, 
°r
[
i
]);

1211 i‡(
u£_kînög
 && 
œ°_glyph_code
 && 
curch¨
) {

1212 
	`FT_Gë_Kînög
(
Á˚
, 
œ°_glyph_code
, 
curch¨
,

1213 
·_kînög_deÁu…
,

1214 &
kînög_dñè
);

1218 
pos
.
x
 +
kînög_dñè
.x & (~63);

1220 
œ°_glyph_code
 = 
curch¨
;

1226 
îr‹
 = 
	`FT_Lﬂd_Glyph
(
Á˚
, 
curch¨
, 
FT_LOAD_DEFAULT
);

1227 i‡(
îr‹
)

1230 
îr‹
 = 
	`FT_Gë_Glyph
(
Á˚
->
glyph
, &glyph);

1231 i‡(
îr‹
)

1235 
	`FT_Glyph_Tønsf‹m
(
glyph
, 0, &
pos
);

1239 
pos
.
x
 +(
glyph
->
adv™˚
.x >> 10) & (~63);

1241 i‡(
pf
->
f⁄åŸ©i⁄
) {

1243 
	`FT_Glyph_Tønsf‹m
(
glyph
, &
pf
->
m©rix
, 0);

1247 
îr‹
 = 
	`FT_Glyph_To_Bôm≠
(&
glyph
, 
ªndî_mode
, 0,

1249 i‡(!
îr‹
) {

1250 
bôm≠glyph
 = (
FT_Bôm≠Glyph
Ë
glyph
;

1251 
bôm≠
 = &(
bôm≠glyph
->bitmap);

1253 
blô_ö°ru˘i⁄s
.
d°x
 =

1254 
ax
 + 
bôm≠glyph
->
À·
;

1255 
blô_ö°ru˘i⁄s
.
d°y
 =

1256 
ay
 - 
bôm≠glyph
->
t›
;

1257 
blô_ö°ru˘i⁄s
.
d°w
 = 
bôm≠
->
width
;

1258 
blô_ö°ru˘i⁄s
.
d°h
 = 
bôm≠
->
rows
;

1259 
blô_ö°ru˘i⁄s
.
§c_löñí
 = 
bôm≠
->
pôch
;

1260 
blô_ö°ru˘i⁄s
.
pixñs
 = 
bôm≠
->
buf„r
;

1261 
blô_ö°ru˘i⁄s
.
misc
 = 
bôm≠
->
buf„r
;

1266 i‡((
blô_ö°ru˘i⁄s
.
d°w
 > 0)

1267 && (
blô_ö°ru˘i⁄s
.
d°h
 > 0)) {

1268 
	`GdDøwAªaI¡î«l
(
psd
, &
blô_ö°ru˘i⁄s
, 
blô_›
);

1271 
	`FT_D⁄e_Glyph
(
glyph
);

1277 #i‡
HAVE_FREETYPE_2_CACHE


1278 
FTC_SBô
 
sbô
;

1280 
FT_Bôm≠
 *
bôm≠
;

1283 
ay
 +(
pos
.
y
 >> 6);

1285 
i
 = 0; i < 
cc
; i++) {

1286 
curch¨
 = 
	`LOOKUP_CHAR
(
pf
, 
Á˚
, 
°r
[
i
]);

1288 i‡(
u£_kînög
 && 
œ°_glyph_code
 && 
curch¨
) {

1289 
	`FT_Gë_Kînög
(
Á˚
, 
œ°_glyph_code
, 
curch¨
,

1290 
·_kînög_deÁu…
,

1291 &
kînög_dñè
);

1293 
ax
 +(
kînög_dñè
.
x
 >> 6);

1295 
œ°_glyph_code
 = 
curch¨
;

1297 #i‡
HAVE_FREETYPE_2_CACHE


1298 
îr‹
 = 
	`FTC_SBôCache_Lookup
(
‰ìty≥2_ˇche_sbô
,

1299 &(
pf
->
imagedesc
),

1300 
curch¨
, &
sbô
, 
NULL
);

1301 i‡(
îr‹
)

1304 
blô_ö°ru˘i⁄s
.
d°x
 = 
ax
 + 
sbô
->
À·
;

1305 
blô_ö°ru˘i⁄s
.
d°y
 = 
ay
 - 
sbô
->
t›
;

1306 
blô_ö°ru˘i⁄s
.
d°w
 = 
sbô
->
width
;

1307 
blô_ö°ru˘i⁄s
.
d°h
 = 
sbô
->
height
;

1308 
blô_ö°ru˘i⁄s
.
§c_löñí
 = 
sbô
->
pôch
;

1309 
blô_ö°ru˘i⁄s
.
pixñs
 = 
sbô
->
buf„r
;

1310 
blô_ö°ru˘i⁄s
.
misc
 = 
sbô
->
buf„r
;

1312 
ax
 +
sbô
->
xadv™˚
;

1314 
îr‹
 = 
	`FT_Lﬂd_Glyph
(
Á˚
, 
curch¨
,

1315 (
pf
->
f⁄èâr
 & 
MWTF_ANTIALIAS
)

1316 ? (
FT_LOAD_RENDER
 |

1317 
FT_LOAD_MONOCHROME
) :

1318 
FT_LOAD_RENDER
);

1319 i‡(
îr‹
)

1322 
bôm≠
 = &(
Á˚
->
glyph
->bitmap);

1324 
blô_ö°ru˘i⁄s
.
d°x
 =

1325 
ax
 + 
Á˚
->
glyph
->
bôm≠_À·
;

1326 
blô_ö°ru˘i⁄s
.
d°y
 = 
ay
 - 
Á˚
->
glyph
->
bôm≠_t›
;

1327 
blô_ö°ru˘i⁄s
.
d°w
 = 
bôm≠
->
width
;

1328 
blô_ö°ru˘i⁄s
.
d°h
 = 
bôm≠
->
rows
;

1329 
blô_ö°ru˘i⁄s
.
§c_löñí
 = 
bôm≠
->
pôch
;

1330 
blô_ö°ru˘i⁄s
.
pixñs
 = 
bôm≠
->
buf„r
;

1331 
blô_ö°ru˘i⁄s
.
misc
 = 
bôm≠
->
buf„r
;

1337 
ax
 +(
Á˚
->
glyph
->
adv™˚
.
x
 >> 6);

1340 i‡((
blô_ö°ru˘i⁄s
.
d°w
 > 0)

1341 && (
blô_ö°ru˘i⁄s
.
d°h
 > 0)) {

1342 
	`GdDøwAªaI¡î«l
(
psd
, &
blô_ö°ru˘i⁄s
, 
blô_›
);

1349 
	`GdFixCurs‹
(
psd
);

1354 
	}
}

1370 
	$‰ìty≥2_gëãxtsize_rŸ©ed
(
PMWFREETYPE2FONT
 
pf
,

1371 c⁄° *
ãxt
, 
cc
,

1372 
MWCOORD
 * 
pwidth
, MWCOORD * 
pheight
,

1373 
MWCOORD
 * 
pba£
)

1375 
FT_Fa˚
 
Á˚
;

1376 
FT_Size
 
size
;

1377 c⁄° *
°r
 = 
ãxt
;

1378 
FT_Ve˘‹
 
pos
;

1379 
i
;

1380 
FT_Glyph
 
glyph
;

1381 
FT_Eº‹
 
îr‹
;

1382 
FT_Ve˘‹
 
kînög_dñè
;

1383 
curch¨
;

1385 
u£_kînög
;

1386 
œ°_glyph_code
 = 0;

1388 
FT_BBox
 
bbox
;

1389 
FT_BBox
 
glyph_bbox
;

1391 #i‡
HAVE_FREETYPE_2_CACHE


1392 
îr‹
 = 
	`FTC_M™agî_Lookup_Size
(
‰ìty≥2_ˇche_m™agî
,

1393 &(
pf
->
imagedesc
.
f⁄t
), &
Á˚
, &
size
);

1394 i‡(
îr‹
) {

1395 
	`EPRINTF
("Fªëy≥ 2Éº‹ 0x%x gëtög f⁄àöfo.\n", 
îr‹
);

1396 *
pwidth
 = 0;

1397 *
pheight
 = 0;

1398 *
pba£
 = 0;

1402 
Á˚
 = 
pf
->face;

1403 
size
 = 
Á˚
->size;

1406 
u£_kînög
 = ((
pf
->
f⁄èâr
 & 
MWTF_KERNING
Ë&& 
	`FT_HAS_KERNING
(
Á˚
));

1408 
bbox
.
xMö
 = 0;

1409 
bbox
.
yMö
 = 0;

1410 
bbox
.
xMax
 = 0;

1411 
bbox
.
yMax
 = 0;

1416 
pos
.
x
 = 0;

1417 
pos
.
y
 = 0;

1419 
i
 = 0; i < 
cc
; i++) {

1420 
curch¨
 = 
	`LOOKUP_CHAR
(
pf
, 
Á˚
, 
°r
[
i
]);

1422 i‡(
u£_kînög
 && 
œ°_glyph_code
 && 
curch¨
) {

1423 
	`FT_Gë_Kînög
(
Á˚
, 
œ°_glyph_code
, 
curch¨
,

1424 
·_kînög_deÁu…
, &
kînög_dñè
);

1426 
pos
.
x
 +
kînög_dñè
.x & (~63);

1428 
œ°_glyph_code
 = 
curch¨
;

1433 
îr‹
 = 
	`FT_Lﬂd_Glyph
(
Á˚
, 
curch¨
, 
FT_LOAD_DEFAULT
);

1434 i‡(
îr‹
)

1437 
îr‹
 = 
	`FT_Gë_Glyph
(
Á˚
->
glyph
, &glyph);

1438 i‡(
îr‹
)

1445 
	`FT_Glyph_Tønsf‹m
(
glyph
, 0, &
pos
);

1447 
pos
.
x
 +(
glyph
->
adv™˚
.x >> 10) & (~63);

1449 i‡(
pf
->
f⁄åŸ©i⁄
) {

1451 
	`FT_Glyph_Tønsf‹m
(
glyph
, &
pf
->
m©rix
, 0);

1454 i‡(
i
 == 0) {

1455 
	`FT_Glyph_Gë_CBox
(
glyph
, 
·_glyph_bbox_pixñs
, &
bbox
);

1457 
	`FT_Glyph_Gë_CBox
(
glyph
, 
·_glyph_bbox_pixñs
,

1458 &
glyph_bbox
);

1464 i‡(
glyph_bbox
.
xMö
 < 
bbox
.xMin)

1465 
bbox
.
xMö
 = 
glyph_bbox
.xMin;

1467 i‡(
glyph_bbox
.
yMö
 < 
bbox
.yMin)

1468 
bbox
.
yMö
 = 
glyph_bbox
.yMin;

1470 i‡(
glyph_bbox
.
xMax
 > 
bbox
.xMax)

1471 
bbox
.
xMax
 = 
glyph_bbox
.xMax;

1473 i‡(
glyph_bbox
.
yMax
 > 
bbox
.yMax)

1474 
bbox
.
yMax
 = 
glyph_bbox
.yMax;

1476 
	`FT_D⁄e_Glyph
(
glyph
);

1482 *
pwidth
 = 
bbox
.
xMax
 ;

1483 *
pheight
 = (
bbox
.
yMax
 - bbox.
yMö
) ;

1484 *
pba£
 = -(
bbox
.
yMö
 );

1488 
	}
}

1506 
	$‰ìty≥2_gëãxtsize_Á°
(
PMWFREETYPE2FONT
 
pf
,

1507 c⁄° *
ãxt
, 
ch¨_cou¡
,

1508 
MWCOORD
 * 
pwidth
, MWCOORD * 
pheight
,

1509 
MWCOORD
 * 
pba£
)

1511 
FT_Fa˚
 
Á˚
;

1512 
FT_Size
 
size
;

1513 c⁄° *
°r
 = 
ãxt
;

1514 
ch¨_ödex
;

1515 
tŸÆ_adv™˚
;

1516 
max_as˚¡
;

1517 
max_des˚¡
;

1518 
adv™˚
;

1519 
as˚¡
;

1520 
des˚¡
;

1521 
FT_Eº‹
 
îr‹
;

1522 
FT_Ve˘‹
 
kînög_dñè
;

1523 
u£_kînög
;

1524 
cur_glyph_code
;

1525 
œ°_glyph_code
 = 0;

1527 #i‡
HAVE_FREETYPE_2_CACHE


1528 
îr‹
 = 
	`FTC_M™agî_Lookup_Size
(
‰ìty≥2_ˇche_m™agî
,

1529 &(
pf
->
imagedesc
.
f⁄t
), &
Á˚
,

1530 &
size
);

1531 i‡(
îr‹
) {

1532 
	`EPRINTF
("Freetype 2Érror 0x%x getting font info.\n",

1533 
îr‹
);

1534 *
pwidth
 = 0;

1535 *
pheight
 = 0;

1536 *
pba£
 = 0;

1540 
Á˚
 = 
pf
->face;

1541 
size
 = 
Á˚
->size;

1544 
u£_kînög
 = ((
pf
->
f⁄èâr
 & 
MWTF_KERNING
)

1545 && 
	`FT_HAS_KERNING
(
Á˚
));

1551 
tŸÆ_adv™˚
 = 0;

1552 
max_as˚¡
 = 0;

1553 
max_des˚¡
 = 0;

1555 
ch¨_ödex
 = 0; ch¨_ödex < 
ch¨_cou¡
; char_index++) {

1556 
cur_glyph_code
 = 
	`LOOKUP_CHAR
(
pf
, 
Á˚
, 
°r
[
ch¨_ödex
]);

1558 i‡(
u£_kînög
 && 
œ°_glyph_code
 && 
cur_glyph_code
) {

1559 
	`FT_Gë_Kînög
(
Á˚
, 
œ°_glyph_code
, 
cur_glyph_code
,

1560 
·_kînög_deÁu…
,

1561 &
kînög_dñè
);

1565 
tŸÆ_adv™˚
 +(
kînög_dñè
.
x
 >> 6);

1567 
œ°_glyph_code
 = 
cur_glyph_code
;

1569 
îr‹
 = 
	`‰ìty≥2_gë_glyph_size
(
pf
, 
Á˚
, 
cur_glyph_code
, &
adv™˚
, &
as˚¡
, &
des˚¡
);

1570 i‡(
îr‹
)

1573 
tŸÆ_adv™˚
 +
adv™˚
;

1574 i‡(
max_as˚¡
 < 
as˚¡
)

1575 
max_as˚¡
 = 
as˚¡
;

1576 i‡(
max_des˚¡
 < 
des˚¡
)

1577 
max_des˚¡
 = 
des˚¡
;

1580 *
pwidth
 = 
tŸÆ_adv™˚
;

1581 *
pheight
 = 
max_as˚¡
 + 
max_des˚¡
;

1582 *
pba£
 = 
max_as˚¡
;

1586 
	}
}

1601 
	$‰ìty≥2_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,
MWTEXTFLAGS
 
Êags
,

1602 
MWCOORD
 * 
pwidth
, MWCOORD * 
pheight
, MWCOORD * 
pba£
)

1604 
PMWFREETYPE2FONT
 
pf
 = (PMWFREETYPE2FONTË
pf⁄t
;

1606 
	`as£π
(
pf
);

1607 
	`as£π
(
ãxt
);

1608 
	`as£π
(
pwidth
);

1609 
	`as£π
(
pheight
);

1610 
	`as£π
(
pba£
);

1612 i‡((
pf
->
f⁄åŸ©i⁄
 != 0)

1613 #i‡
HAVE_FREETYPE_2_CACHE


1614 || (!
	`CAN_USE_FT2_CACHE
(
pf
))

1619 
	`‰ìty≥2_gëãxtsize_rŸ©ed
(
pf
, 
ãxt
, 
cc
, 
pwidth
,

1620 
pheight
, 
pba£
);

1622 
	`‰ìty≥2_gëãxtsize_Á°
(
pf
, 
ãxt
, 
cc
, 
pwidth
,

1623 
pheight
, 
pba£
);

1625 
	}
}

1636 
	$‰ìty≥2_gë_«me
(c⁄° *
fûíame
)

1638 
FT_Fa˚
 
Á˚
;

1639 *
ªsu…
 = 
NULL
;

1641 
	`as£π
(
fûíame
);

1644 i‡(
	`FT_New_Fa˚
(
‰ìty≥2_libøry
, 
fûíame
, 0, &
Á˚
Ë=
FT_Eº_Ok
) {

1645 
ªsu…
 = 
	`mÆloc
(
	`°æí
(
Á˚
->
Ámûy_«me
) + 1);

1646 i‡(
ªsu…
 !
NULL
) {

1647 
	`°r˝y
(
ªsu…
, 
Á˚
->
Ámûy_«me
);

1650 
	`FT_D⁄e_Fa˚
(
Á˚
);

1653  
ªsu…
;

1654 
	}
}

	@engine/font_hzk.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~"devi˚.h
"

12 
	~"devf⁄t.h
"

18 
	#MAX_PATH
 256

	)

20 
	mwidth
;

21 
	mheight
;

22 
	msize
;

23 
	mu£_cou¡
;

24 * 
	mpF⁄t
;

25 
	mfûe
[
MAX_PATH
 + 1];

26 } 
	tHZKFONT
;

28 
	gu£_big5
=1;

29 
HZKFONT
 
	gCF⁄t
[2];

30 
HZKFONT
 
	gAF⁄t
[2];

33 
	gaf⁄t_width
 = 8;

34 
	gcf⁄t_width
 = 16;

35 
	gf⁄t_height
 = 16;

36 *
	gaf⁄t_addªss
;

37 *
	gcf⁄t_addªss
;

39 
	sMWHZKFONT
 {

40 
PMWFONTPROCS
 
	mf⁄çrocs
;

41 
MWCOORD
 
	mf⁄tsize
;

42 
	mf⁄åŸ©i⁄
;

43 
	mf⁄èâr
;

45 
HZKFONT
 
	mCF⁄t
;

46 
HZKFONT
 
	mAF⁄t
;

47 
	maf⁄t_width
;

48 
	mcf⁄t_width
;

49 
	mf⁄t_height
;

50 *
	maf⁄t_addªss
;

51 *
	mcf⁄t_addªss
;

52 } 
	tMWHZKFONT
;

54 
hzk_öô
(
PSD
 
psd
);

55 
PMWHZKFONT
 
hzk_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
,
f⁄èâr
);

57 
MWBOOL
 
hzk_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

58 
hzk_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

59 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

60 
MWCOORD
 *
pba£
);

62 
hzk_gëãxtbôs
(
PMWFONT
 
pf⁄t
, 
ch
, c⁄° 
IMAGEBITS
 **
ªtm≠
,

63 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
);

65 
hzk_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

66 
hzk_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

67 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

70 
MWFONTPROCS
 
	ghzk_¥ocs
 = {

71 
MWTF_ASCII
,

72 
hzk_gëf⁄töfo
,

73 
hzk_gëãxtsize
,

74 
NULL
,

75 
hzk_de°royf⁄t
,

76 
hzk_døwãxt
,

77 
NULL
,

78 
NULL
,

79 
NULL
,

80 
NULL
,

84 
MWPIXELVAL
 
gr_f‹eground
;

85 
MWPIXELVAL
 
gr_background
;

96 
	$UC16_to_GB
(c⁄° *
uc16
, 
cc
, *
ascii
)

98 
FILE
* 
Â
;

99 
buf„r
[256];

100 *
uc16p
;

101 
i
=0,
j
=0, 
k
;

102 *
fûebuf„r
;

103 *
uc16µ
,*
èbÀ
;

104 
uc16px
;

105 
Àngth
=31504;

107 i‡(
u£_big5
)

108 
Àngth
=54840;

110 
uc16p
=(*Ë
uc16
;

111 
uc16µ
=(*Ë
uc16
;

113 
	`°r˝y
(
buf„r
,
HZK_FONT_DIR
);

114 i‡(
u£_big5
)

115 
	`°rˇt
(
buf„r
,"/BG2UBG.KU");

117 
	`°rˇt
(
buf„r
,"/UGB2GB.KU");

118 if(!(
Â
 = 
	`f›í
(
buf„r
, "rb")))

120 
	`¥ötf
 ("Eº‹.\nThê%†fûêˇ¿nŸ bêfound!\n",
buf„r
);

124 
fûebuf„r
(*)
	`mÆloc
 ( 
Àngth
);

126 if(
	`‰ód
(
fûebuf„r
, (),
Àngth
, 
Â
) <Üength) {

127 
	`¥ötf
 ("Error inÑeading ugb2gb.ku file!\n");

128 
	`f˛o£
(
Â
);

131 
	`f˛o£
(
Â
);

133 i‡(
u£_big5
)

135 
èbÀ
=(*)
fûebuf„r
;

138 if(
j
>=
cc
)

140 
ascii
[
i
]=0;

143 
uc16px
=*
uc16µ
;

144 if((
uc16px
)<=0x00ff)

146 
ascii
[
i
]=()(*
uc16µ
);

147 
i
++;

151 
ascii
[
i
]=0xa1;áscii[i+1]=0x40;

152 
k
=0; k<13710; k++)

154 i‡(*(
èbÀ
+(
k
*2+1))==(
uc16px
))

156 
ascii
[
i
]=()((*(
èbÀ
+(
k
*2)) & 0xff00) >> 8);

157 
ascii
[
i
+1]=()(*(
èbÀ
+(
k
*2)) & 0x00ff);

161 
i
+=2;

163 
uc16µ
++; 
j
++;

170 if(
j
>=
cc
)

172 
ascii
[
i
]=0;

175 if((*((
uc16p
)+
j
)==0)&&(*((uc16p)+j+1)==0))

177 
ascii
[
i
]=0;

182 if(*((
uc16p
)+
j
+1)==0)

184 
ascii
[
i
]=*((
uc16p
)+
j
);

185 
i
++;

186 
j
+=2;

192 
p1
=0,
p2
=
Àngth
-4,
p
;

193 
c1
,
c2
,
c
,
d
;

194 
c1
=(()
fûebuf„r
[
p1
])*0x100+(filebuffer[p1+1]);

195 
c2
=(()
fûebuf„r
[
p2
])*0x100+(filebuffer[p2+1]);

196 
d
=(()*((
uc16p
)+
j
))*0x100+*((uc16p)+j+1);

197 if(
c1
==
d
)

199 
ascii
[
i
]=
fûebuf„r
[
p1
+2];

200 
ascii
[
i
+1]=
fûebuf„r
[
p1
+3];

201 
födô
;

203 if(
c2
==
d
)

205 
ascii
[
i
]=
fûebuf„r
[
p2
+2];

206 
ascii
[
i
+1]=
fûebuf„r
[
p2
+3];

207 
födô
;

211 
p
=(((
p2
-
p1
)/2+p1)>>2)<<2;

212 
c
=(()
fûebuf„r
[
p
])*0x100+(filebuffer[p+1]);

213 if(
d
==
c
)

215 
ascii
[
i
]=
fûebuf„r
[
p
+2];

216 
ascii
[
i
+1]=
fûebuf„r
[
p
+3];

219 if(
p2
<=
p1
+4)

221 
ascii
[
i
]='.';

222 
ascii
[
i
+1]='.';

225 if(
d
<
c
)

227 
p2
=
p
;

228 
c2
=
c
;

232 
p1
=
p
;

233 
c1
=
c
;

237 
födô
:

238 
i
+=2;

239 
j
+=2;

244 
	`‰ì
(
fûebuf„r
);

246  
i
;

247 
	}
}

251 
	$hzk_id
–
PMWHZKFONT
 
pf
 )

253 
pf
->
f⁄t_height
)

260 
	}
}

263 
MWBOOL
 
	$GëCF⁄tInfo
–
PMWHZKFONT
 
pf
 )

265 
ch¨£t
;

267 i‡(
u£_big5
)

268 
ch¨£t
=(13094+408);

270 
ch¨£t
=8178;

272 
CF⁄t
[
	`hzk_id
(
pf
)].
width
 =Öf->
cf⁄t_width
;

273 
pf
->
CF⁄t
.
width
 =Öf->
cf⁄t_width
;

275 
CF⁄t
[
	`hzk_id
(
pf
)].
height
 =Öf->
f⁄t_height
;

276 
pf
->
CF⁄t
.
height
 =Öf->
f⁄t_height
;

278 
CF⁄t
[
	`hzk_id
(
pf
)].
size
 = (’f->CF⁄t.
width
 + 7) / 8) *

279 
pf
->
CF⁄t
.
height
 * 
ch¨£t
;

280 
pf
->
CF⁄t
.
size
 = (’f->CF⁄t.
width
 + 7Ë/ 8Ë*Öf->CF⁄t.
height
 * 
ch¨£t
;

282 if(
pf
->
CF⁄t
.
size
 < 
ch¨£t
 * 8)

283  
FALSE
;

285 
	`°r˝y
(
CF⁄t
[
	`hzk_id
(
pf
)].
fûe
,
HZK_FONT_DIR
);

286 
	`°r˝y
(
pf
->
CF⁄t
.
fûe
,
HZK_FONT_DIR
);

288 if(
pf
->
f⁄t_height
==16)

290 
	`°rˇt
(
CF⁄t
[
	`hzk_id
(
pf
)].
fûe
,"/hzk16");

291 
	`°rˇt
(
pf
->
CF⁄t
.
fûe
,"/hzk16");

295 
	`°rˇt
(
CF⁄t
[
	`hzk_id
(
pf
)].
fûe
,"/hzk12");

296 
	`°rˇt
(
pf
->
CF⁄t
.
fûe
,"/hzk12");

299 i‡(
u£_big5
)

301 
CF⁄t
[
	`hzk_id
(
pf
)].
fûe
[
	`°æí
’f->CF⁄t.fûe)-3]+=
u£_big5
;

302 
pf
->
CF⁄t
.
fûe
[
	`°æí
’f->CF⁄t.fûe)-3]+=
u£_big5
;

305  
TRUE
;

306 
	}
}

309 
MWBOOL
 
	$GëAF⁄tInfo
–
PMWHZKFONT
 
pf
 )

311 
AF⁄t
[
	`hzk_id
(
pf
)].
width
 =Öf->
af⁄t_width
;

312 
pf
->
AF⁄t
.
width
 =Öf->
af⁄t_width
;

314 
AF⁄t
[
	`hzk_id
(
pf
)].
height
 =Öf->
f⁄t_height
;

315 
pf
->
AF⁄t
.
height
 =Öf->
f⁄t_height
;

317 
AF⁄t
[
	`hzk_id
(
pf
)].
size
 = (’f->AF⁄t.
width
 + 7) / 8) *

318 
pf
->
AF⁄t
.
height
 * 255;

319 
pf
->
AF⁄t
.
size
 = (’f->AF⁄t.
width
 + 7Ë/ 8Ë*Öf->AF⁄t.
height
 * 255;

321 if(
pf
->
AF⁄t
.
size
 < 255 * 8)

322  
FALSE
;

324 
	`°r˝y
(
AF⁄t
[
	`hzk_id
(
pf
)].
fûe
,
HZK_FONT_DIR
);

325 
	`°r˝y
(
pf
->
AF⁄t
.
fûe
,
HZK_FONT_DIR
);

327 if(
pf
->
f⁄t_height
==16)

329 
	`°rˇt
(
AF⁄t
[
	`hzk_id
(
pf
)].
fûe
,"/asc16");

330 
	`°rˇt
(
pf
->
AF⁄t
.
fûe
,"/asc16");

334 
	`°rˇt
(
AF⁄t
[
	`hzk_id
(
pf
)].
fûe
,"/asc12");

335 
	`°rˇt
(
pf
->
AF⁄t
.
fûe
,"/asc12");

337  
TRUE
;

338 
	}
}

341 
MWBOOL
 
	$LﬂdF⁄t
–
PMWHZKFONT
 
pf
 )

343 
FILE
* 
Â
;

345 if(!
	`GëCF⁄tInfo
(
pf
))

347 
	`¥ötf
 ("Get Chinese HZK font info failure!\n");

348  
FALSE
;

350 if(
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 =
NULL
)

355 if–!(
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 = (*)
	`mÆloc
’f->CF⁄t.
size
)) )

357 
	`¥ötf
 ("Allocate memory for Chinese HZK font failure.\n");

358  
FALSE
;

362 
	`¥ötf
 ("hzk_¸óãf⁄t:Üﬂdög '%s'\n", 
pf
->
CF⁄t
.
fûe
);

363 if(!(
Â
 = 
	`f›í
(
CF⁄t
[
	`hzk_id
(
pf
)].
fûe
, "rb")))

365 
	`¥ötf
 ("Error.\nThe Chinese HZK font file canÇot be found!\n");

366  
FALSE
;

368 if(
	`‰ód
(
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
, (),Öf->CF⁄t.
size
, 
Â
) <Öf->CFont.size)

370 
	`¥ötf
 ("Error inÑeading Chinese HZK font file!\n");

371 
	`f˛o£
(
Â
);

372  
FALSE
;

375 
	`f˛o£
(
Â
);

377 
CF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
=0;

380 
cf⁄t_addªss
 = 
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
;

381 
pf
->
cf⁄t_addªss
 = 
CF⁄t
[
	`hzk_id
’f)].
pF⁄t
;

382 
pf
->
CF⁄t
.
pF⁄t
 = CF⁄t[
	`hzk_id
(pf)].pFont;

384 
CF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
++;

386 if(!
	`GëAF⁄tInfo
(
pf
))

388 
	`¥ötf
 ("Get ASCII HZK font info failure!\n");

389  
FALSE
;

391 if(
AF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 =
NULL
)

396 if–!(
AF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 = (*)
	`mÆloc
’f->AF⁄t.
size
)) )

398 
	`¥ötf
 ("Allocate memory for ASCII HZK font failure.\n");

399 
	`‰ì
(
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
);

400 
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 = 
NULL
;

401  
FALSE
;

405 
	`¥ötf
 ("hzk_¸óãf⁄t:Üﬂdög '%s'\n", 
pf
->
AF⁄t
.
fûe
 );

406 if(!(
Â
 = 
	`f›í
(
AF⁄t
[
	`hzk_id
(
pf
)].
fûe
, "rb")))

408 
	`¥ötf
 ("Error.\nThe ASCII HZK font file canÇot be found!\n");

409  
FALSE
;

411 if(
	`‰ód
(
AF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
, (),Öf->AF⁄t.
size
, 
Â
) <Öf->AFont.size)

413 
	`¥ötf
 ("Error inÑeading ASCII HZK font file!\n");

414 
	`f˛o£
(
Â
);

415  
FALSE
;

418 
	`f˛o£
(
Â
);

420 
AF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
=0;

423 
af⁄t_addªss
 = 
AF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
;

424 
pf
->
af⁄t_addªss
 = 
AF⁄t
[
	`hzk_id
’f)].
pF⁄t
;

425 
pf
->
AF⁄t
.
pF⁄t
 = AF⁄t[
	`hzk_id
(pf)].pFont;

427 
AF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
++;

429  
TRUE
;

430 
	}
}

433 
	$U∆ﬂdF⁄t
–
PMWHZKFONT
 
pf
 )

435 
CF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
--;

436 
AF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
--;

438 i‡(!
CF⁄t
[
	`hzk_id
(
pf
)].
u£_cou¡
)

440 
	`‰ì
(
pf
->
CF⁄t
.
pF⁄t
);

441 
	`‰ì
(
pf
->
AF⁄t
.
pF⁄t
);

443 
CF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 = 
NULL
;

444 
AF⁄t
[
	`hzk_id
(
pf
)].
pF⁄t
 = 
NULL
;

446 
	}
}

449 
	$hzk_öô
(
PSD
 
psd
)

454 
	}
}

456 
PMWHZKFONT


457 
	$hzk_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

459 
PMWHZKFONT
 
pf
;

461 if(
	`°rcmp
(
«me
,"HZKFONT")!=0 && strcmp(name,"HZXFONT")!=0)

462  
FALSE
;

466 
u£_big5
=
«me
[2]-'K';

469 
pf
 = (
PMWHZKFONT
)
	`ˇŒoc
((
MWHZKFONT
), 1);

470 i‡(!
pf
)

471  
NULL
;

472 
pf
->
f⁄çrocs
 = &
hzk_¥ocs
;

474 
pf
->
f⁄tsize
 = 
height
;

475 
pf
->
f⁄åŸ©i⁄
 = 0;

476 
pf
->
f⁄èâr
 = 
©å
;

478 if(
height
==12)

480 
af⁄t_width
 = 6;

481 
cf⁄t_width
 = 12;

482 
f⁄t_height
 = 12;

484 
pf
->
af⁄t_width
 = 6;

485 
pf
->
cf⁄t_width
 = 12;

486 
pf
->
f⁄t_height
 = 12;

490 
af⁄t_width
 = 8;

491 
cf⁄t_width
 = 16;

492 
f⁄t_height
 = 16;

494 
pf
->
af⁄t_width
 = 8;

495 
pf
->
cf⁄t_width
 = 16;

496 
pf
->
f⁄t_height
 = 16;

500 if(!
	`LﬂdF⁄t
(
pf
))

501  
FALSE
;

503  
pf
;

504 
	}
}

506 
	$IsBig5
(
i
)

508 i‡((
i
>=0xa140 && i<=0xa3bf) ||

509 (
i
>=0xa440 && i<=0xc67e) ||

510 (
i
>=0xc6a1 && i<=0xc8d3) ||

511 (
i
>=0xc940 && i<=0xf9fe))

515 
	}
}

521 
	$gë√xtch¨
(* 
s
, * 
cc
)

523 if–
s
[0] == '\0')  0;

525 
cc
[0] = ()(*
s
);

526 
cc
[1] = ()(*(
s
 + 1));

528 i‡(
u£_big5
)

530 if–
	`IsBig5
–(Ë–(
cc
[0] << 8) + cc[1]) ) )

535 if–(()
cc
[0] > 0xa0) &&

536 (()
cc
[1] > 0xa0) )

540 
cc
[1] = '\0';

543 
	}
}

546 
	$ex∑ndcch¨
(
PMWHZKFONT
 
pf
, 
bg
, 
fg
, * 
c
, 
MWPIXELVAL
* 
bôm≠
)

548 
i
=0;

549 
c1
, 
c2
, 
£q
;

550 
x
,
y
;

551 *
f⁄t
;

552 
b
 = 0;

554 
pixñsize
;

555 
pixñsize
=(
MWPIXELVAL
);

557 
c1
 = 
c
[0];

558 
c2
 = 
c
[1];

559 i‡(
u£_big5
)

561 
£q
=0;

563 
c2
-=(c2<127?64:98);

566 i‡(
c1
>=0xa4)

568 
£q
=(((
c1
-164)*157)+
c2
);

569 i‡(
£q
>=5809) seq-=408;

573 i‡(
c1
<=0xa3)

574 
£q
=(((
c1
-161)*157)+
c2
)+13094;

577 
£q
=((
c1
 - 161)*94 + 
c2
 - 161);

579 
f⁄t
 = 
pf
->
cf⁄t_addªss
 + ((
£q
) *

580 (
pf
->
f⁄t_height
 * (’f->
cf⁄t_width
 + 7) / 8)));

582 
y
 = 0; y < 
pf
->
f⁄t_height
; y++)

583 
x
 = 0; x < 
pf
->
cf⁄t_width
; x++)

585 i‡(
x
 % 8 == 0)

586 
b
 = *
f⁄t
++;

588 i‡(
b
 & (128 >> (
x
 % 8)))

589 
bôm≠
[
i
++]=
fg
;

591 
bôm≠
[
i
++]=
bg
;

593 
	}
}

595 
	$ex∑ndch¨
(
PMWHZKFONT
 
pf
, 
bg
, 
fg
, 
c
, 
MWPIXELVAL
* 
bôm≠
)

597 
i
=0;

598 
x
,
y
;

599 *
f⁄t
;

600 
pixñsize
;

601 
b
 = 0;

603 
pixñsize
=(
MWPIXELVAL
);

605 
f⁄t
 = 
pf
->
af⁄t_addªss
 + 
c
 * (pf->
f⁄t_height
 *

606 ((
pf
->
af⁄t_width
 + 7) / 8));

608 
y
 = 0; y < 
pf
->
f⁄t_height
; y++)

609 
x
 = 0; x < 
pf
->
af⁄t_width
; x++)

611 i‡(
x
 % 8 == 0)

612 
b
 = *
f⁄t
++;

613 i‡(
b
 & (128 >> (
x
 % 8)))

614 
bôm≠
[
i
++]=
fg
;

616 
bôm≠
[
i
++]=
bg
;

618 
	}
}

624 
	$hzk_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
ax
, MWCOORD 
ay
,

625 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

627 
PMWHZKFONT
 
pf
=(PMWHZKFONT)
pf⁄t
;

629 
c
[2];

630 
MWPIXELVAL
 *
bôm≠
;

631 
s1
[3];

632 *
s
,*
sbegö
;

634 
s
=(*)
ãxt
;

636 if(
cc
==1)

638 
s1
[0]=*((*)
ãxt
);

639 
s1
[1]=0x0;

640 
s1
[2]=0x0;

641 
s
=
s1
;

644 
sbegö
=
s
;

645 
bôm≠
 = (
MWPIXELVAL
 *)
	`ALLOCA
(
pf
->
cf⁄t_width
 *Öf->
f⁄t_height
 *

646 (
MWPIXELVAL
));

648  
	`gë√xtch¨
(
s
, 
c
) )

650 if–
c
[1] != '\0')

652 
	`ex∑ndcch¨
(
pf
, 
gr_background
,
gr_f‹eground
,

653 
c
, 
bôm≠
);

656 i‡(
Êags
&
MWTF_TOP
)

657 
	`GdAªa
(
psd
,
ax
, 
ay
, 
pf
->
cf⁄t_width
,

658 
pf
->
f⁄t_height
, 
bôm≠
, 
MWPF_PIXELVAL
);

660 
	`GdAªa
(
psd
,
ax
, 
ay
-
pf
->
f⁄t_height
+2,

661 
pf
->
cf⁄t_width
,Öf->
f⁄t_height
,

662 
bôm≠
, 
MWPF_PIXELVAL
);

664 
s
 += 2;

665 
ax
 +
pf
->
cf⁄t_width
;

669 
	`ex∑ndch¨
(
pf
, 
gr_background
,
gr_f‹eground
,

670 
c
[0], 
bôm≠
);

673 i‡(
Êags
&
MWTF_TOP
)

674 
	`GdAªa
(
psd
,
ax
, 
ay
, 
pf
->
af⁄t_width
,

675 
pf
->
f⁄t_height
, 
bôm≠
, 
MWPF_PIXELVAL
);

677 
	`GdAªa
(
psd
,
ax
, 
ay
-
pf
->
f⁄t_height
+2,

678 
pf
->
af⁄t_width
,Öf->
f⁄t_height
,

679 
bôm≠
, 
MWPF_PIXELVAL
);

681 
s
 += 1;

682 
ax
 +
pf
->
af⁄t_width
;

685 if(
s
>=
sbegö
+
cc
);

688 
	`FREEA
(
bôm≠
);

689 
	}
}

694 
MWBOOL


695 
	$hzk_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

697 
PMWHZKFONT
 
pf
=(PMWHZKFONT)
pf⁄t
;

699 
i
;

701 
pf⁄töfo
->
height
 = 
pf
->
f⁄t_height
;

702 
pf⁄töfo
->
maxwidth
 = 
pf
->
cf⁄t_width
;

703 
pf⁄töfo
->
ba£löe
 = 
pf
->
f⁄t_height
 - 2;

706 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
;

707 
pf⁄töfo
->
des˚¡
 =Öf⁄töfo->
height
 -Öf⁄töfo->
ba£löe
;

708 
pf⁄töfo
->
maxas˚¡
 =Öf⁄töfo->
ba£löe
;

709 
pf⁄töfo
->
maxdes˚¡
 =Öf⁄töfo->
des˚¡
;

711 
pf⁄töfo
->
fú°ch¨
 = 0;

712 
pf⁄töfo
->
œ°ch¨
 = 0;

713 
pf⁄töfo
->
fixed
 = 
TRUE
;

715 
i
=0; i<=256; i++)

716 
pf⁄töfo
->
widths
[
i
] = 
pf
->
af⁄t_width
;

718  
TRUE
;

719 
	}
}

722 
	$hzk_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

723 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

725 
PMWHZKFONT
 
pf
=(PMWHZKFONT)
pf⁄t
;

727 
c
[2];

728 *
s
,*
sbegö
;

729 
s1
[3];

731 
ax
=0;

732 
s
=(*)
ãxt
;

733 if(
cc
==0)

735 *
pwidth
 = 0;

736 *
pheight
 = 
pf
->
f⁄t_height
;

737 *
pba£
 = 
pf
->
f⁄t_height
-2;

740 if(
cc
==1)

742 
s1
[0]=*((*)
ãxt
);

743 
s1
[1]=0x0;

744 
s1
[2]=0x0;

745 
s
=
s1
;

747 
sbegö
=
s
;

748  
	`gë√xtch¨
(
s
, 
c
) )

750 if–
c
[1] != '\0')

752 
s
 += 2;

753 
ax
 +
pf
->
cf⁄t_width
;

757 
s
 += 1;

758 
ax
 +
pf
->
af⁄t_width
;

760 if(
s
>=
sbegö
+
cc
) {

768 *
pwidth
 = 
ax
;

769 *
pheight
 = 
pf
->
f⁄t_height
;

770 *
pba£
 = 
pf
->
f⁄t_height
-2;

771 
	}
}

774 
	$hzk_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

776 
PMWHZKFONT
 
pf
=(PMWHZKFONT)
pf⁄t
;

777 
	`U∆ﬂdF⁄t
(
pf
);

778 
	`‰ì
(
pf
);

779 
	}
}

	@engine/font_pcf.c

14 
	~<°dio.h
>

15 
	~<°rög.h
>

16 
	~<î∫o.h
>

17 
	~<°dlib.h
>

18 
	~"sw≠.h
"

19 
	~"devi˚.h
"

20 
	~"devf⁄t.h
"

21 
	~"../drivîs/gíf⁄t.h
"

23 
MWPIXELVAL
 
gr_background
;

24 
MWBOOL
 
gr_u£bg
;

29 #ifde‡
HAVE_PCFGZ_SUPPORT


30 
	~<zlib.h
>

31 
	#FILEP
 
gzFûe


	)

32 
	#FOPEN
(
∑th
, 
mode
Ë
	`gz›í
’©h, mode)

	)

33 
	#FREAD
(
fûe
, 
buf„r
, 
size
Ë
	`gzªad
(fûe, buf„r, size)

	)

34 
	#FSEEK
(
fûe
, 
off£t
, 
whí˚
Ë
	`gz£ek
(fûe, off£t, whí˚)

	)

35 
	#FCLOSE
(
fûe
Ë
	`gz˛o£
(fûe)

	)

37 
	#FILEP
 
FILE
 *

	)

38 
	#FOPEN
(
∑th
, 
mode
Ë
	`f›í
’©h, mode)

	)

39 
	#FREAD
(
fûe
, 
buf„r
, 
size
Ë
	`‰ód
(buf„r, 1, size, fûe)

	)

40 
	#FSEEK
(
fûe
, 
off£t
, 
whí˚
Ë
	`f£ek
(fûe, off£t, whí˚)

	)

41 
	#FCLOSE
(
fûe
Ë
	`f˛o£
(fûe)

	)

45 
pcf_u∆ﬂdf⁄t
(
PMWFONT
 
f⁄t
);

48 
MWFONTPROCS
 
	gpcf_f⁄çrocs
 = {

49 
MWTF_ASCII
,

50 
gí_gëf⁄töfo
,

51 
gí_gëãxtsize
,

52 
gí_gëãxtbôs
,

53 
pcf_u∆ﬂdf⁄t
,

54 
c‹ef⁄t_døwãxt
,

55 
NULL
,

56 
NULL
,

57 
NULL
,

61 
MWFONTPROCS
 
	gpcf_f⁄çrocs16
 = {

62 
MWTF_UC16
,

63 
gí_gëf⁄töfo
,

64 
gí16_gëãxtsize
,

65 
gí_gëãxtbôs
,

66 
pcf_u∆ﬂdf⁄t
,

67 
gí16_døwãxt
,

68 
NULL
,

69 
NULL
,

70 
NULL
,

71 
NULL
,

75 
toc_íåy
 *
	gtoc
;

76 
	gtoc_size
;

79 
	#PCF_FILE_VERSION
 (('p'<<24)|('c'<<16)|('f'<<8)|1)

	)

80 
	#PCF_PROPERTIES
 (1 << 0)

	)

81 
	#PCF_ACCELERATORS
 (1 << 1)

	)

82 
	#PCF_METRICS
 (1 << 2)

	)

83 
	#PCF_BITMAPS
 (1 << 3)

	)

84 
	#PCF_INK_METRICS
 (1 << 4)

	)

85 
	#PCF_BDF_ENCODINGS
 (1 << 5)

	)

86 
	#PCF_SWIDTHS
 (1 << 6)

	)

87 
	#PCF_GLYPH_NAMES
 (1 << 7)

	)

88 
	#PCF_BDF_ACCELERATORS
 (1 << 8)

	)

89 
	#PCF_FORMAT_MASK
 0xFFFFFF00

	)

90 
	#PCF_DEFAULT_FORMAT
 0x00000000

	)

92 
	#PCF_GLYPH_PAD_MASK
 (3<<0)

	)

93 
	#PCF_BYTE_MASK
 (1<<2)

	)

94 
	#PCF_BIT_MASK
 (1<<3)

	)

95 
	#PCF_SCAN_UNIT_MASK
 (3<<4)

	)

96 
	#GLYPHPADOPTIONS
 4

	)

98 
	#PCF_LSB_FIRST
 0

	)

99 
	#PCF_MSB_FIRST
 1

	)

102 
	stoc_íåy
 {

103 
	mty≥
;

104 
	mf‹m©
;

105 
	msize
;

106 
	moff£t
;

109 
	s¥›_íåy
 {

110 
	m«me
;

111 
	mis_°rög
;

112 
	mvÆue
;

115 
	s°rög_èbÀ
 {

116 *
	m«me
;

117 *
	mvÆue
;

120 
	smëric_íåy
 {

121 
	mÀ·Bórög
;

122 
	mrightBórög
;

123 
	mwidth
;

124 
	mas˚¡
;

125 
	mdes˚¡
;

126 
	m©åibuãs
;

129 
	sícodög_íåy
 {

130 
	mmö_byã2
;

131 
	mmax_byã2
;

132 
	mmö_byã1
;

133 
	mmax_byã1
;

134 
	mdeÁu…ch¨
;

135 
	mcou¡
;

136 *
	mm≠
;

140 
	g_ªvî£_byã
[0x100] = {

179 
	$bô_‹dî_övît
(*
buf
, 
nbyãs
)

181 ; --
nbyãs
 >0; 
buf
++)

182 *
buf
 = 
_ªvî£_byã
[*buf];

183 
	}
}

189 
	$two_byã_sw≠
(*
buf
, 
nbyãs
)

191 
c
;

193 ; 
nbyãs
 > 0;Çbyã†-2, 
buf
 += 2) {

194 
c
 = 
buf
[0];

195 
buf
[0] = buf[1];

196 
buf
[1] = 
c
;

198 
	}
}

204 
	$four_byã_sw≠
(*
buf
, 
nbyãs
)

206 
c
;

208 ; 
nbyãs
 > 0;Çbyã†-4, 
buf
 += 4) {

209 
c
 = 
buf
[0];

210 
buf
[0] = buf[3];

211 
buf
[3] = 
c
;

212 
c
 = 
buf
[1];

213 
buf
[1] = buf[2];

214 
buf
[2] = 
c
;

216 
	}
}

220 
	$ªadINT8
(
FILEP
 
fûe
)

222 
b
;

224 
	`FREAD
(
fûe
, &
b
, (b));

225  
b
;

226 
	}
}

230 
	$ªadLSB16
(
FILEP
 
fûe
)

232 
s
;

234 
	`FREAD
(
fûe
, &
s
, (s));

235  
	`wsw≠
(
s
);

236 
	}
}

240 
	$ªadLSB32
(
FILEP
 
fûe
)

242 
n
;

244 
	`FREAD
(
fûe
, &
n
, (n));

245  
	`dwsw≠
(
n
);

246 
	}
}

250 
	$pcf_gë_off£t
(
ôem
)

252 
i
;

254 
i
 = 0; i < 
toc_size
; i++)

255 i‡(
ôem
 =
toc
[
i
].
ty≥
)

256  
toc
[
i
].
off£t
;

258 
	}
}

260 #i‡
LATER


263 
	$pcf_ªad¥›s
(
FILEP
 
fûe
, 
¥›_íåy
 **
¥›
,

264 
°rög_èbÀ
 **
°rögs
)

266 
off£t
;

267 
f‹m©
;

268 
num_¥›s
;

269 
ssize
;

270 
i
;

271 
°rög_èbÀ
 *
s
;

272 
¥›_íåy
 *
p
;

274 *
°rög_buf„r
, *
•os
;

276 i‡((
off£t
 = 
	`pcf_gë_off£t
(
PCF_PROPERTIES
)) == -1)

278 
	`FSEEK
(
fûe
, 
off£t
, 
SEEK_SET
);

280 
f‹m©
 = 
	`ªadLSB32
(
fûe
);

281 
num_¥›s
 = 
	`ªadLSB32
(
fûe
);

283 
p
 = *
¥›
 = (
¥›_íåy
 *Ë
	`mÆloc
(
num_¥›s
 *

284 (
¥›_íåy
));

286 
i
 = 0; i < 
num_¥›s
; i++) {

287 
p
[
i
].
«me
 = 
	`ªadLSB32
(
fûe
);

288 
p
[
i
].
is_°rög
 = 
	`ªadINT8
(
fûe
);

289 
p
[
i
].
vÆue
 = 
	`ªadLSB32
(
fûe
);

293 i‡(
num_¥›s
 & 3)

294 
	`FSEEK
(
fûe
, 4 - (
num_¥›s
 & 3), 
SEEK_CUR
);

298 
ssize
 = 
	`ªadLSB32
(
fûe
);

299 
•os
 = 
°rög_buf„r
 = (*Ë
	`ALLOCA
(
ssize
);

300 
	`FREAD
(
fûe
, 
°rög_buf„r
, 
ssize
);

303 
s
 = *
°rögs
 = (
°rög_èbÀ
 *Ë
	`ALLOCA
(
num_¥›s
 *

304 (
°rög_èbÀ
));

306 
i
 = 0; i < 
num_¥›s
; i++) {

307 
s
[
i
].
«me
 = (*Ë
	`°rdup
(
•os
);

308 
•os
 +
	`°æí
(
s
[
i
].
«me
) + 1;

310 i‡(
p
[
i
].
is_°rög
) {

311 
s
[
i
].
vÆue
 = (*Ë
	`°rdup
(
•os
);

312 
•os
 +
	`°æí
(
s
[
i
].
vÆue
) + 1;

314 
s
[
i
].
vÆue
 = 0;

317 
	`FREEA
(
°rög_buf„r
);

318  
num_¥›s
;

319 
	}
}

324 
	$pcf_ªadbôm≠s
(
FILEP
 
fûe
, **
bôs
, *
bôs_size
,

325 **
off£ts
)

327 
off£t
;

328 
f‹m©
;

329 
num_glyphs
;

330 
∑d
;

331 
i
;

332 
ídün
;

333 *
o
;

334 *
b
;

335 
bmsize
[
GLYPHPADOPTIONS
];

337 i‡((
off£t
 = 
	`pcf_gë_off£t
(
PCF_BITMAPS
)) == -1)

339 
	`FSEEK
(
fûe
, 
off£t
, 
SEEK_SET
);

341 
f‹m©
 = 
	`ªadLSB32
(
fûe
);

342 
ídün
 = (
f‹m©
 & 
PCF_BIT_MASK
)? 
PCF_LSB_FIRST
: 
PCF_MSB_FIRST
;

344 
num_glyphs
 = 
	`ªadLSB32
(
fûe
);

346 
o
 = *
off£ts
 = (*)
	`mÆloc
(
num_glyphs
 * ());

347 
i
=0; i < 
num_glyphs
; ++i)

348 
o
[
i
] = 
	`ªadLSB32
(
fûe
);

350 
i
=0; i < 
GLYPHPADOPTIONS
; ++i)

351 
bmsize
[
i
] = 
	`ªadLSB32
(
fûe
);

353 
∑d
 = 
f‹m©
 & 
PCF_GLYPH_PAD_MASK
;

354 *
bôs_size
 = 
bmsize
[
∑d
]? bmsize[pad] : 1;

357 
b
 = *
bôs
 = (*Ë
	`mÆloc
(*
bôs_size
);

358 
	`FREAD
(
fûe
, 
b
, *
bôs_size
);

361 
	`bô_‹dî_övît
(
b
, *
bôs_size
);

362 #i‡
MW_CPU_BIG_ENDIAN


363 i‡(
ídün
 =
PCF_LSB_FIRST
)

364 
	`two_byã_sw≠
(
b
, *
bôs_size
);

366 i‡(
ídün
 =
PCF_MSB_FIRST
)

367 
	`two_byã_sw≠
(
b
, *
bôs_size
);

369  
num_glyphs
;

370 
	}
}

374 
	$pcf_ªadmërics
(
FILE
 * 
fûe
, 
mëric_íåy
 **
mërics
)

376 
i
, 
size
, 
off£t
;

377 
f‹m©
;

378 
mëric_íåy
 *
m
;

380 i‡((
off£t
 = 
	`pcf_gë_off£t
(
PCF_METRICS
)) == -1)

382 
	`FSEEK
(
fûe
, 
off£t
, 
SEEK_SET
);

384 
f‹m©
 = 
	`ªadLSB32
(
fûe
);

386 i‡((
f‹m©
 & 
PCF_FORMAT_MASK
Ë=
PCF_DEFAULT_FORMAT
) {

387 
size
 = 
	`ªadLSB32
(
fûe
);

389 
m
 = *
mërics
 = (
mëric_íåy
 *Ë
	`mÆloc
(
size
 *

390 (
mëric_íåy
));

392 
i
=0; i < 
size
; i++) {

393 
m
[
i
].
À·Bórög
 = 
	`ªadLSB16
(
fûe
);

394 
m
[
i
].
rightBórög
 = 
	`ªadLSB16
(
fûe
);

395 
m
[
i
].
width
 = 
	`ªadLSB16
(
fûe
);

396 
m
[
i
].
as˚¡
 = 
	`ªadLSB16
(
fûe
);

397 
m
[
i
].
des˚¡
 = 
	`ªadLSB16
(
fûe
);

398 
m
[
i
].
©åibuãs
 = 
	`ªadLSB16
(
fûe
);

401 
size
 = 
	`ªadLSB16
(
fûe
);

403 
m
 = *
mërics
 = (
mëric_íåy
 *Ë
	`mÆloc
(
size
 *

404 (
mëric_íåy
));

406 
i
 = 0; i < 
size
; i++) {

407 
m
[
i
].
À·Bórög
 = 
	`ªadINT8
(
fûe
) - 0x80;

408 
m
[
i
].
rightBórög
 = 
	`ªadINT8
(
fûe
) - 0x80;

409 
m
[
i
].
width
 = 
	`ªadINT8
(
fûe
) - 0x80;

410 
m
[
i
].
as˚¡
 = 
	`ªadINT8
(
fûe
) - 0x80;

411 
m
[
i
].
des˚¡
 = 
	`ªadINT8
(
fûe
) - 0x80;

414  
size
;

415 
	}
}

419 
	$pcf_ªad_ícodög
(
FILE
 * 
fûe
, 
ícodög_íåy
 **
ícodög
)

421 
off£t
, 
n
;

422 
f‹m©
;

423 
ícodög_íåy
 *
e
;

425 i‡((
off£t
 = 
	`pcf_gë_off£t
(
PCF_BDF_ENCODINGS
)) == -1)

427 
	`FSEEK
(
fûe
, 
off£t
, 
SEEK_SET
);

429 
f‹m©
 = 
	`ªadLSB32
(
fûe
);

431 
e
 = *
ícodög
 = (
ícodög_íåy
 *)

432 
	`mÆloc
((
ícodög_íåy
));

433 
e
->
mö_byã2
 = 
	`ªadLSB16
(
fûe
);

434 
e
->
max_byã2
 = 
	`ªadLSB16
(
fûe
);

435 
e
->
mö_byã1
 = 
	`ªadLSB16
(
fûe
);

436 
e
->
max_byã1
 = 
	`ªadLSB16
(
fûe
);

437 
e
->
deÁu…ch¨
 = 
	`ªadLSB16
(
fûe
);

438 
e
->
cou¡
 = (e->
max_byã2
 -É->
mö_byã2
 + 1) *

439 (
e
->
max_byã1
 -É->
mö_byã1
 + 1);

440 
e
->
m≠
 = (*Ë
	`mÆloc
”->
cou¡
 * ());

441 
	`DPRINTF
("de‡ch¨ %d (%x)\n", 
e
->
deÁu…ch¨
,É->defaultchar);

443 
n
 = 0;Ç < 
e
->
cou¡
; ++n) {

444 
e
->
m≠
[
n
] = 
	`ªadLSB16
(
fûe
);

447 
	`DPRINTF
("sizê%d byã1 %d,%d byã2 %d,%d\n", 
e
->
cou¡
,

448 
e
->
mö_byã1
,É->
max_byã1
,É->
mö_byã2
,É->
max_byã2
);

449  
e
->
cou¡
;

450 
	}
}

453 
	$pcf_ªad_toc
(
FILE
 * 
fûe
, 
toc_íåy
 **
toc
, *
size
)

455 
i
;

456 
vîsi⁄
;

457 
toc_íåy
 *
t
;

459 
	`FSEEK
(
fûe
, 0, 
SEEK_SET
);

462 
vîsi⁄
 = 
	`ªadLSB32
(
fûe
);

463 i‡(
vîsi⁄
 !
PCF_FILE_VERSION
)

466 *
size
 = 
	`ªadLSB32
(
fûe
);

467 
t
 = *
toc
 = (
toc_íåy
 *Ë
	`ˇŒoc
((toc_íåy), *
size
);

468 i‡(!
t
)

472 
i
=0; i<*
size
; ++i) {

473 
t
[
i
].
ty≥
 = 
	`ªadLSB32
(
fûe
);

474 
t
[
i
].
f‹m©
 = 
	`ªadLSB32
(
fûe
);

475 
t
[
i
].
size
 = 
	`ªadLSB32
(
fûe
);

476 
t
[
i
].
off£t
 = 
	`ªadLSB32
(
fûe
);

480 
	}
}

482 
PMWCOREFONT


483 
	$pcf_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

485 
FILE
 *
fûe
 = 0;

486 
MWCOREFONT
 *
pf
 = 0;

487 
off£t
;

488 
i
;

489 
cou¡
;

490 
bsize
;

491 
bwidth
;

492 
îr
 = 0;

493 
mëric_íåy
 *
mërics
 = 0;

494 
ícodög_íåy
 *
ícodög
 = 0;

495 
MWIMAGEBITS
 *
ouçut
;

496 *
glyphs
 = 0;

497 *
glyphs_off£ts
 = 0;

498 
max_width
 = 0, 
max_des˚¡
 = 0, 
max_as˚¡
 = 0, 
max_height
 = 0;

499 
glyph_cou¡
;

500 *
goff£t
 = 
NULL
;

501 *
gwidth
 = 
NULL
;

502 
uc16
;

503 
‚ame
[256];

506 
fûe
 = 
	`FOPEN
(
«me
, "rb");

507 i‡(!
fûe
) {

508 
	`°r˝y
(
‚ame
, 
PCF_FONT_DIR
 "/");

509 
	`°r˝y
(
‚ame
 + (
PCF_FONT_DIR
), 
«me
);

510 
fûe
 = 
	`FOPEN
(
‚ame
, "rb");

512 i‡(!
fûe
)

513  
NULL
;

515 i‡(!(
pf
 = (
MWCOREFONT
 *Ë
	`mÆloc
((MWCOREFONT)))) {

516 
îr
 = -1;

517 
Àave_func
;

520 i‡(!(
pf
->
cf⁄t
 = (
PMWCFONT
Ë
	`ˇŒoc
((
MWCFONT
), 1))) {

521 
îr
 = -1;

522 
Àave_func
;

527 i‡(
	`pcf_ªad_toc
(
fûe
, &
toc
, &
toc_size
) == -1) {

528 
îr
 = -1;

529 
Àave_func
;

533 
glyph_cou¡
 = 
	`pcf_ªadbôm≠s
(
fûe
, &
glyphs
, &
bsize
, &
glyphs_off£ts
);

534 
	`DPRINTF
("glyph_cou¡ = %d (%x)\n", 
glyph_cou¡
, glyph_count);

536 i‡(
glyph_cou¡
 == -1) {

537 
îr
 = -1;

538 
Àave_func
;

541 i‡(
	`pcf_ªad_ícodög
(
fûe
, &
ícodög
) == -1) {

542 
îr
 = -1;

543 
Àave_func
;

546 
pf
->
cf⁄t
->
fú°ch¨
 = 
ícodög
->
mö_byã2
 * (ícodög->
mö_byã1
 + 1);

549 
cou¡
 = 
	`pcf_ªadmërics
(
fûe
, &
mërics
);

552 
i
 = 0; i < 
cou¡
; i++) {

553 i‡(
mërics
[
i
].
width
 > 
max_width
)

554 
max_width
 = 
mërics
[
i
].
width
;

555 i‡(
mërics
[
i
].
as˚¡
 > 
max_as˚¡
)

556 
max_as˚¡
 = 
mërics
[
i
].
as˚¡
;

557 i‡(
mërics
[
i
].
des˚¡
 > 
max_des˚¡
)

558 
max_des˚¡
 = 
mërics
[
i
].
des˚¡
;

560 
max_height
 = 
max_as˚¡
 + 
max_des˚¡
;

562 
pf
->
cf⁄t
->
maxwidth
 = 
max_width
;

563 
pf
->
cf⁄t
->
height
 = 
max_height
;

564 
pf
->
cf⁄t
->
as˚¡
 = 
max_as˚¡
;

567 
bwidth
 = (
max_width
 + 15) / 16;

569 
pf
->
cf⁄t
->
bôs
 = (
MWIMAGEBITS
 *Ë
	`ˇŒoc
((
max_height
 *

570 ((
MWIMAGEBITS
Ë* 
bwidth
)), 
glyph_cou¡
);

571 
goff£t
 = (*Ë
	`mÆloc
(
glyph_cou¡
 *

573 
gwidth
 = (*Ë
	`mÆloc
(
glyph_cou¡
 * ());

575 
ouçut
 = (
MWIMAGEBITS
 *Ë
pf
->
cf⁄t
->
bôs
;

576 
off£t
 = 0;

579 
i
 = 0; i < 
glyph_cou¡
; i++) {

580 
h
, 
w
;

581 
y
 = 
max_height
;

582 *
±r
 =

583 (*Ë(
glyphs
 + 
glyphs_off£ts
[
i
]);

586 
lwidth
 = (
mërics
[
i
].
width
 + 15) / 16;

589 
xwidth
 = (
mërics
[
i
].
rightBórög
 - mërics[i].
À·Bórög
 + 15) / 16;

591 
gwidth
[
i
] = (Ë
mërics
[i].
width
;

592 
goff£t
[
i
] = 
off£t
;

594 
off£t
 +(
lwidth
 * 
max_height
);

596 
h
 = 0; h < (
max_as˚¡
 - 
mërics
[
i
].
as˚¡
); h++) {

597 
w
 = 0; w < 
lwidth
; w++)

598 *
ouçut
++ = 0;

599 
y
--;

602 
h
 = 0; h < (
mërics
[
i
].
as˚¡
 + mërics[i].
des˚¡
); h++) {

603 *
vÆ
 = (*Ë
±r
;

605 
w
 = 0; w < 
lwidth
; w++)

606 *
ouçut
++ = 
vÆ
[
w
];

607 
±r
 +(
xwidth
 + 1) / 2;

608 
y
--;

611 ; 
y
 > 0; y--)

612 
w
 = 0; w < 
lwidth
; w++)

613 *
ouçut
++ = 0;

617 
pf
->
cf⁄t
->
off£t
 = (*Ë
	`mÆloc
(
ícodög
->
cou¡
 *

619 
pf
->
cf⁄t
->
width
 = (*Ë
	`mÆloc
(
ícodög
->
cou¡
 *

621 
i
 = 0; i < 
ícodög
->
cou¡
; ++i) {

622 
n
 = 
ícodög
->
m≠
[
i
];

623 i‡(
n
 == 0xffff)

624 
n
 = 
ícodög
->
m≠
[ícodög->
deÁu…ch¨
];

625 
pf
->
cf⁄t
->
off£t
[
i
] = 
goff£t
[
n
];

626 
pf
->
cf⁄t
->
width
[
i
] = 
gwidth
[
n
];

628 
pf
->
cf⁄t
->
size
 = 
ícodög
->
cou¡
;

630 
uc16
 = 
pf
->
cf⁄t
->
fú°ch¨
 > 255 ||

631 (
pf
->
cf⁄t
->
fú°ch¨
 +Öf->cf⁄t->
size
) > 255;

632 
pf
->
f⁄çrocs
 = 
uc16
? &
pcf_f⁄çrocs16
: &
pcf_f⁄çrocs
;

633 
pf
->
f⁄tsize
 =Öf->
f⁄åŸ©i⁄
 =Öf->
f⁄èâr
 = 0;

634 
pf
->
«me
 = "PCF";

636 
Àave_func
:

637 i‡(
goff£t
)

638 
	`‰ì
(
goff£t
);

639 i‡(
gwidth
)

640 
	`‰ì
(
gwidth
);

641 i‡(
ícodög
) {

642 i‡(
ícodög
->
m≠
)

643 
	`‰ì
(
ícodög
->
m≠
);

644 
	`‰ì
(
ícodög
);

646 i‡(
mërics
)

647 
	`‰ì
(
mërics
);

648 i‡(
glyphs
)

649 
	`‰ì
(
glyphs
);

650 i‡(
glyphs_off£ts
)

651 
	`‰ì
(
glyphs_off£ts
);

653 i‡(
toc
)

654 
	`‰ì
(
toc
);

655 
toc
 = 0;

656 
toc_size
 = 0;

658 i‡(
fûe
)

659 
	`FCLOSE
(
fûe
);

661 i‡(
îr
 =0 && 
pf
)

662  
pf
;

664 
	`pcf_u∆ﬂdf⁄t
((
PMWFONT
)
pf
);

666 
	}
}

669 
	$pcf_u∆ﬂdf⁄t
(
PMWFONT
 
f⁄t
)

671 
PMWCOREFONT
 
pf
 = (PMWCOREFONTË
f⁄t
;

672 
PMWCFONT
 
pfc
 = 
pf
->
cf⁄t
;

674 i‡(
pfc
) {

675 i‡(
pfc
->
width
)

676 
	`‰ì
(
pf
->
cf⁄t
->
width
);

677 i‡(
pfc
->
off£t
)

678 
	`‰ì
(
pf
->
cf⁄t
->
off£t
);

679 i‡(
pfc
->
bôs
)

680 
	`‰ì
(
pf
->
cf⁄t
->
bôs
);

682 
	`‰ì
(
pf
->
cf⁄t
);

685 
	`‰ì
(
f⁄t
);

686 
	}
}

	@engine/font_t1lib.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~<t1lib.h
>

12 
	~"devi˚.h
"

13 
	~"devf⁄t.h
"

15 
	sMWT1LIBFONT
 {

16 
PMWFONTPROCS
 
	mf⁄çrocs
;

17 
MWCOORD
 
	mf⁄tsize
;

18 
	mf⁄åŸ©i⁄
;

19 
	mf⁄èâr
;

21 
	mf⁄tid
;

22 } 
	tMWT1LIBFONT
;

24 
t1lib_öô
(
PSD
 
psd
);

25 
PMWT1LIBFONT
 
t1lib_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
,
©å
);

27 
t1lib_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

28 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
);

29 
MWBOOL
 
t1lib_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

30 
t1lib_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
,

31 
MWTEXTFLAGS
 
Êags
, 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
,

32 
MWCOORD
 *
pba£
);

33 
t1lib_de°royf⁄t
(
PMWFONT
 
pf⁄t
);

36 
MWFONTPROCS
 
	gt1lib_¥ocs
 = {

37 
MWTF_ASCII
,

38 
t1lib_gëf⁄töfo
,

39 
t1lib_gëãxtsize
,

40 
NULL
,

41 
t1lib_de°royf⁄t
,

42 
t1lib_døwãxt
,

43 
NULL
,

44 
NULL
,

45 
NULL
,

46 
NULL
,

50 
MWPIXELVAL
 
gr_f‹eground
;

51 
MWPIXELVAL
 
gr_background
;

52 
MWBOOL
 
gr_u£bg
;

55 
	$t1lib_öô
(
PSD
 
psd
)

57 **
ícodög
;

58 
öôed
 = 0;

60 i‡(
öôed
)

63 
	`T1_SëBôm≠Pad
(8);

64 i‡(!
	`T1_InôLib
(0))

68 
ícodög
 = 
	`T1_LﬂdEncodög
("IsoLatin1.enc");

69 
	`T1_SëDeÁu…Encodög
(
ícodög
);

71 #ifde‡
T1LIB_USE_AA_HIGH


72 
	`T1_AASëLevñ
(
T1_AA_HIGH
);

74 
	`T1_AASëLevñ
(
T1_AA_LOW
);

78 if(
psd
->
bµ
 == 16)

79 
	`T1_AASëBôsPîPixñ
(16);

82 
	`T1_AASëBôsPîPixñ
((
MWPIXELVAL
)*8);

84 
öôed
 = 1;

86 
	}
}

88 
PMWT1LIBFONT


89 
	$t1lib_¸óãf⁄t
(c⁄° *
«me
, 
MWCOORD
 
height
, 
©å
)

91 
PMWT1LIBFONT
 
pf
;

92 
id
;

93 * 
p
;

94 
buf
[256];

97 
id
=0; id<
	`T1_Gë_no_f⁄ts
(); ++id) {

98 
	`°∫˝y
(
buf
, 
	`T1_GëF⁄tFûeName
(
id
), (buf));

101 
p
=
buf
; *p; ++p) {

102 if(*
p
 == '.') {

103 *
p
 = 0;

108 if(!
	`°rcmpi
(
«me
, 
buf
)) {

110 
pf
 = (
PMWT1LIBFONT
)
	`ˇŒoc
((
MWT1LIBFONT
), 1);

111 i‡(!
pf
)

112  
NULL
;

113 
pf
->
f⁄çrocs
 = &
t1lib_¥ocs
;

114 
	`GdSëF⁄tSize
((
PMWFONT
)
pf
, 
height
);

115 
	`GdSëF⁄tRŸ©i⁄
((
PMWFONT
)
pf
, 0);

116 
	`GdSëF⁄tAâr
((
PMWFONT
)
pf
, 
©å
, 0);

117 
pf
->
f⁄tid
 = 
id
;

118  
pf
;

121  
NULL
;

122 
	}
}

128 
	$t1lib_døwãxt
(
PMWFONT
 
pf⁄t
, 
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
,

129 c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
)

131 
PMWT1LIBFONT
 
pf
 = (PMWT1LIBFONT)
pf⁄t
;

132 c⁄° *
°r
 = 
ãxt
;

133 
MWCOORD
 
width
;

134 
MWCOORD
 
height
;

135 
MWCOORD
 
undîlöey
;

136 
GLYPH
 * 
g
;

137 #ifde‡
T1LIB_USE_AA_HIGH


138 
OUTPIXELVAL
 
gvÆs
[17];

143 
bÀnd
[17] = {

148 
OUTPIXELVAL
 
gvÆs
[5];

149 
bÀnd
[5] = { 0x00, 0x44, 0x88, 0xcc, 0xff };

154 i‡(
pf
->
f⁄èâr
&
MWTF_ANTIALIAS
) {

155 #ifde‡
T1LIB_USE_AA_HIGH


156 
	`ÆphabÀnd
(
psd
, 
gvÆs
, 
gr_f‹eground
, 
gr_background
, 
bÀnd
, 17);

157 
	`T1_AAHSëGøyVÆues
(
gvÆs
);

159 
	`ÆphabÀnd
(
psd
, 
gvÆs
, 
gr_f‹eground
, 
gr_background
, 
bÀnd
, 5);

160 
	`T1_AASëGøyVÆues
(
gvÆs
[0],gvals[1],gvals[2],gvals[3],gvals[4]);

162 
g
 = 
	`T1_AASëSåög
(
pf
->
f⁄tid
,(*)
°r
,
cc
,0,

163 (
pf
->
f⁄èâr
&
MWTF_KERNING
)? 
T1_KERNING
: 0,

164 
pf
->
f⁄tsize
 * 1.0, 0);

166 i‡(
g
 && g->
bôs
) {

168 
width
 = 
g
->
mërics
.
rightSideBórög
 - g->mërics.
À·SideBórög
;

169 
height
 = 
g
->
mërics
.
as˚¡
 - g->mërics.
des˚¡
;

171 if(
Êags
 & 
MWTF_BASELINE
)

172 
y
 -
g
->
mërics
.
as˚¡
;

173 if(
Êags
 & 
MWTF_BOTTOM
)

174 
y
 -(
height
 - 1);

175 
undîlöey
 = 
y
 + 
g
->
mërics
.
as˚¡
;

184 
	`GdAªa
(
psd
,
x
,
y
, 
width
, 
height
, 
g
->
bôs
, 
MWPF_PIXELVAL
);

187 i‡(
pf
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

188 
	`GdLöe
(
psd
, 
x
, 
undîlöey
, x+
width
, undîlöey, 
FALSE
);

193 
g
 = 
	`T1_SëSåög
(
pf
->
f⁄tid
,(*)
°r
,
cc
,0,

194 (
pf
->
f⁄èâr
&
MWTF_KERNING
)? 
T1_KERNING
: 0,

195 
pf
->
f⁄tsize
 * 1.0, 0);

197 i‡(
g
 && g->
bôs
) {

198 * 
b
;

199 
xoff
;

200 
maxy
;

201 
xmod
;

206 
width
 = 
g
->
mërics
.
rightSideBórög
 - g->mërics.
À·SideBórög
;

207 
height
 = 
g
->
mërics
.
as˚¡
 - g->mërics.
des˚¡
;

209 if(
Êags
 & 
MWTF_BASELINE
)

210 
y
 -
g
->
mërics
.
as˚¡
;

211 if(
Êags
 & 
MWTF_BOTTOM
)

212 
y
 -(
height
 - 1);

213 
undîlöey
 = 
y
 + 
g
->
mërics
.
as˚¡
;

215 
b
 = 
g
->
bôs
;

216 
maxy
 = 
y
 + 
height
;

223 
xmod
 = 0;

224 
y
 < 
maxy
) {

225 
d©a
;

226 
xoff
 = 0;

227 
xoff
 < 
width
 ) {

228 i‡(!(
xoff
 % 8)) {

229 
d©a
 = *
b
;

230 
b
++;

233 i‡(
	`GdClùPoöt
(
psd
, 
x
+
xoff
,
y
)) {

234 i‡(
gr_u£bg
) {

235 
psd
->
	`DøwPixñ
’sd,
x
+
xoff
,
y
,

236 
d©a
 & (1 << (
xoff
 % 8)) ?

237 
gr_f‹eground
 : 
gr_background
);

238 } i‡(
d©a
 & (1 << (
xoff
 % 8))) {

239 
psd
->
	`DøwPixñ
’sd,
x
+
xoff
,
y
, 
gr_f‹eground
);

242 
xoff
++;

244 
b
 +
xmod
;

245 
y
++;

247 i‡(
pf
->
f⁄èâr
 & 
MWTF_UNDERLINE
)

248 
	`GdLöe
(
psd
, 
x
, 
undîlöey
, x+
xoff
, undîlöey, 
FALSE
);

252 i‡(
g
 && g->
bôs
) {

254 
	`‰ì
(
g
->
bôs
);

255 
g
->
bôs
 = 0;

258 
	`GdFixCurs‹
(
psd
);

259 
	}
}

261 
MWBOOL


262 
	$t1lib_gëf⁄töfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
)

264 
i
;

265 
MWCOORD
 
width
, 
height
, 
ba£löe
;

268 
	`GdGëTextSize
(
pf⁄t
, "A", 1, &
width
, &
height
, &
ba£löe
, 
MWTF_ASCII
);

269 
pf⁄töfo
->
height
 = height;

270 
pf⁄töfo
->
maxwidth
 = 
width
;

271 
pf⁄töfo
->
ba£löe
 = baseline;

274 
pf⁄töfo
->
löe•acög
 =Öf⁄töfo->
height
;

275 
pf⁄töfo
->
des˚¡
 =Öf⁄töfo->
height
 -Öf⁄töfo->
ba£löe
;

276 
pf⁄töfo
->
maxas˚¡
 =Öf⁄töfo->
ba£löe
;

277 
pf⁄töfo
->
maxdes˚¡
 =Öf⁄töfo->
des˚¡
;

279 
pf⁄töfo
->
fú°ch¨
 = 32;

280 
pf⁄töfo
->
œ°ch¨
 = 255;

281 
pf⁄töfo
->
fixed
 = 
TRUE
;

282 
i
=0; i<256; ++i)

283 
pf⁄töfo
->
widths
[
i
] = 
width
;

284  
TRUE
;

285 
	}
}

289 
	$t1lib_gëãxtsize
(
PMWFONT
 
pf⁄t
, c⁄° *
ãxt
, 
cc
, 
MWTEXTFLAGS
 
Êags
,

290 
MWCOORD
 *
pwidth
, MWCOORD *
pheight
, MWCOORD *
pba£
)

292 
PMWT1LIBFONT
 
pf
 = (PMWT1LIBFONT)
pf⁄t
;

293 c⁄° * 
°r
 = 
ãxt
;

294 
GLYPH
 * 
g
;

296 
g
 = 
	`T1_SëSåög
(
pf
->
f⁄tid
, (*)
°r
, 
cc
, 0,

297 (
pf
->
f⁄èâr
&
MWTF_KERNING
)? 
T1_KERNING
: 0,Öf->
f⁄tsize
 * 1.0, 0);

298 *
pwidth
 = 
g
->
mërics
.
rightSideBórög
 - g->mërics.
À·SideBórög
;

299 *
pheight
 = 
g
->
mërics
.
as˚¡
 - g->mërics.
des˚¡
;

300 *
pba£
 = 
g
->
mërics
.
as˚¡
;

301 if(
g
 && g->
bôs
) {

302 
	`‰ì
(
g
->
bôs
);

303 
g
->
bôs
 = 0;

306 
BBox
 
b
;

309 
b
 = 
	`T1_GëSåögBBox
(
pf
->
f⁄tid
, 
°r
, 
cc
, 0, (pf->
f⁄èâr
&
MWTF_KERNING
)?
T1_KERNING
:0);

311 
	`DPRINTF
("b.urx = %d, b.Œx = %d\n",
b
.
urx
, b.
Œx
);

312 
	`DPRINTF
("b.ury = %d, b.Œy = %d\n",
b
.
ury
, b.
Œy
);

313 *
pwidth
 = (
b
.
urx
 - b.
Œx
);

314 *
pheight
 = (
b
.
Œy
 - b.
ury
);

316 
	}
}

319 
	$t1lib_de°royf⁄t
(
PMWFONT
 
pf⁄t
)

321 
PMWT1LIBFONT
 
pf
 = (PMWT1LIBFONT)
pf⁄t
;

323 
	`T1_DñëeAŒSizes
(
pf
->
f⁄tid
);

324 
	`‰ì
(
pf
);

325 
	}
}

	@engine/image_bmp.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

10 
	~<uni°d.h
>

11 
	~<f˙é.h
>

12 
	~<˘y≥.h
>

13 
	~<sys/ty≥s.h
>

14 
	~<sys/°©.h
>

15 
	~"devi˚.h
"

16 
	~"sw≠.h
"

18 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_BMP_SUPPORT
)

21 
	#BI_RGB
 0L

	)

22 
	#BI_RLE8
 1L

	)

23 
	#BI_RLE4
 2L

	)

24 
	#BI_BITFIELDS
 3L

	)

26 
	tBYTE
;

27 
	tWORD
;

28 
	tDWORD
;

29 
	tLONG
;

33 
BYTE
 
	mbfTy≥
[2];

34 
DWORD
 
	mbfSize
;

35 
WORD
 
	mbfRe£rved1
;

36 
WORD
 
	mbfRe£rved2
;

37 
DWORD
 
	mbfOffBôs
;

38 } 
	tBMPFILEHEAD
;

40 
	#FILEHEADSIZE
 14

	)

45 
DWORD
 
	mBiSize
;

46 
DWORD
 
	mBiWidth
;

47 
DWORD
 
	mBiHeight
;

48 
WORD
 
	mBiPœ√s
;

49 
WORD
 
	mBiBôCou¡
;

50 
DWORD
 
	mBiCom¥essi⁄
;

51 
DWORD
 
	mBiSizeImage
;

52 
DWORD
 
	mBiX≥lsPîMëî
;

53 
DWORD
 
	mBiY≥lsPîMëî
;

54 
DWORD
 
	mBiCÃU£d
;

55 
DWORD
 
	mBiCÃImp‹è¡
;

56 } 
	tBMPINFOHEAD
;

58 
	#INFOHEADSIZE
 40

	)

63 
DWORD
 
	mbcSize
;

64 
WORD
 
	mbcWidth
;

65 
WORD
 
	mbcHeight
;

66 
WORD
 
	mbcPœ√s
;

67 
WORD
 
	mbcBôCou¡
;

68 } 
	tBMPCOREHEAD
;

70 
	#COREHEADSIZE
 12

	)

72 
DecodeRLE8
(
MWUCHAR
 *
buf
, 
buf„r_t
 *
§c
);

73 
DecodeRLE4
(
MWUCHAR
 *
buf
, 
buf„r_t
 *
§c
);

74 
put4
(
b
);

81 
	$GdDecodeBMP
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
)

83 
h
, 
i
, 
com¥essi⁄
;

84 
hódsize
;

85 
MWUCHAR
 *
imagebôs
;

86 
BMPFILEHEAD
 
bmpf
;

87 
BMPINFOHEAD
 
bmpi
;

88 
BMPCOREHEAD
 
bmpc
;

89 
MWUCHAR
 
hódbuf„r
[
INFOHEADSIZE
];

91 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

93 
pimage
->
imagebôs
 = 
NULL
;

94 
pimage
->
∑Àâe
 = 
NULL
;

97 i‡(
	`GdImageBuf„rRód
(
§c
, &
hódbuf„r
, 
FILEHEADSIZE
) != FILEHEADSIZE)

100 
bmpf
.
bfTy≥
[0] = 
hódbuf„r
[0];

101 
bmpf
.
bfTy≥
[1] = 
hódbuf„r
[1];

104 i‡(*(
WORD
*)&
bmpf
.
bfTy≥
[0] !
	`wsw≠
(0x4D42))

108 
bmpf
.
bfOffBôs
 = 
	`dwsw≠
(
	`dwªad
(&
hódbuf„r
[10]));

111 i‡(
	`GdImageBuf„rRód
(
§c
,&
hódsize
,(
DWORD
)) != (DWORD))

113 
hódsize
 = 
	`dwsw≠
(headsize);

116 if(
hódsize
 =
COREHEADSIZE
) {

119 if(
	`GdImageBuf„rRód
(
§c
, &
hódbuf„r
, 
COREHEADSIZE
-(
DWORD
)) !=

120 
COREHEADSIZE
-(
DWORD
))

124 
bmpc
.
bcWidth
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[0]);

125 
bmpc
.
bcHeight
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[2]);

126 
bmpc
.
bcPœ√s
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[4]);

127 
bmpc
.
bcBôCou¡
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[6]);

129 
pimage
->
width
 = ()
bmpc
.
bcWidth
;

130 
pimage
->
height
 = ()
bmpc
.
bcHeight
;

131 
pimage
->
bµ
 = 
bmpc
.
bcBôCou¡
;

132 i‡(
pimage
->
bµ
 <= 8)

133 
pimage
->
∑lsize
 = 1 <<Öimage->
bµ
;

134 
pimage
->
∑lsize
 = 0;

135 
com¥essi⁄
 = 
BI_RGB
;

138 if(
	`GdImageBuf„rRód
(
§c
, &
hódbuf„r
, 
INFOHEADSIZE
-(
DWORD
)) !=

139 
INFOHEADSIZE
-(
DWORD
))

143 
bmpi
.
BiWidth
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[0]);

144 
bmpi
.
BiHeight
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[4]);

145 
bmpi
.
BiPœ√s
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[8]);

146 
bmpi
.
BiBôCou¡
 = 
	`wsw≠
(*(
WORD
*)&
hódbuf„r
[10]);

147 
bmpi
.
BiCom¥essi⁄
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[12]);

148 
bmpi
.
BiSizeImage
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[16]);

149 
bmpi
.
BiX≥lsPîMëî
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[20]);

150 
bmpi
.
BiY≥lsPîMëî
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[24]);

151 
bmpi
.
BiCÃU£d
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[28]);

152 
bmpi
.
BiCÃImp‹è¡
 = 
	`dwsw≠
(*(
DWORD
*)&
hódbuf„r
[32]);

154 
pimage
->
width
 = ()
bmpi
.
BiWidth
;

155 
pimage
->
height
 = ()
bmpi
.
BiHeight
;

156 
pimage
->
bµ
 = 
bmpi
.
BiBôCou¡
;

157 
pimage
->
∑lsize
 = ()
bmpi
.
BiCÃU£d
;

158 i‡(
pimage
->
∑lsize
 > 256)

159 
pimage
->
∑lsize
 = 0;

160 if(
pimage
->
∑lsize
 =0 &&Öimage->
bµ
 <= 8)

161 
pimage
->
∑lsize
 = 1 <<Öimage->
bµ
;

162 
com¥essi⁄
 = 
bmpi
.
BiCom¥essi⁄
;

164 
pimage
->
com¥essi⁄
 = 
MWIMAGE_BGR
;

165 
pimage
->
∂™es
 = 1;

168 if(
pimage
->
bµ
 > 8 &&Öimage->bpp != 24) {

169 
	`EPRINTF
("GdDecodeBMP: image bppÇot 1, 4, 8 or 24\n");

174 
	`GdCompuãImagePôch
(
pimage
->
bµ
,Öimage->
width
, &pimage->
pôch
,

175 &
pimage
->
byã•îpixñ
);

178 if–(
pimage
->
imagebôs
 = 
	`mÆloc
’image->
pôch
*pimage->
height
)Ë=
NULL
)

179 
îr
;

180 if–(
pimage
->
∑Àâe
 = 
	`mÆloc
(256*(
MWPALENTRY
))Ë=
NULL
)

181 
îr
;

184 if(
pimage
->
bµ
 <= 8) {

185 
i
=0; i<
pimage
->
∑lsize
; i++) {

186 
pimage
->
∑Àâe
[
i
].
b
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

187 
pimage
->
∑Àâe
[
i
].
g
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

188 
pimage
->
∑Àâe
[
i
].
r
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

189 if(
hódsize
 !
COREHEADSIZE
)

190 
	`GdImageBuf„rGëCh¨
(
§c
);

195 
	`GdImageBuf„rSìkTo
(
§c
, 
bmpf
.
bfOffBôs
);

197 
h
 = 
pimage
->
height
;

199 --
h
 >= 0) {

201 
imagebôs
 = 
pimage
->imagebô†+ 
h
*pimage->
pôch
;

204 if(
com¥essi⁄
 =
BI_RLE8
) {

205 if(!
	`DecodeRLE8
(
imagebôs
, 
§c
))

207 } if(
com¥essi⁄
 =
BI_RLE4
) {

208 if(!
	`DecodeRLE4
(
imagebôs
, 
§c
))

211 if(
	`GdImageBuf„rRód
(
§c
, 
imagebôs
, 
pimage
->
pôch
) !=

212 
pimage
->
pôch
)

213 
îr
;

218 
îr
:

219 
	`EPRINTF
("GdDecodeBMP: imageÜoadingÉrror\n");

220 if(
pimage
->
imagebôs
)

221 
	`‰ì
(
pimage
->
imagebôs
);

222 if(
pimage
->
∑Àâe
)

223 
	`‰ì
(
pimage
->
∑Àâe
);

225 
	}
}

231 
	$DecodeRLE8
(
MWUCHAR
 * 
buf
, 
buf„r_t
 * 
§c
)

233 
c
, 
n
;

234 
MWUCHAR
 *
p
 = 
buf
;

237 
n
 = 
	`GdImageBuf„rGëCh¨
(
§c
)) {

238 
EOF
:

241 
n
 = 
	`GdImageBuf„rGëCh¨
(
§c
)) {

247 (Ë
	`GdImageBuf„rGëCh¨
(
§c
);

248 (Ë
	`GdImageBuf„rGëCh¨
(
§c
);

251 
c
 = 0; c < 
n
; c++)

252 *
p
++ = 
	`GdImageBuf„rGëCh¨
(
§c
);

253 i‡(
n
 & 1)

254 (Ë
	`GdImageBuf„rGëCh¨
(
§c
);

258 
c
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

259 
n
--)

260 *
p
++ = 
c
;

264 
	}
}

269 
MWUCHAR
 *
	gp
;

270 
	g⁄˚
;

273 
	$put4
(
b
)

275 
œ°
;

277 
œ°
 = (œ° << 4Ë| 
b
;

278 i‡(++
⁄˚
 == 2) {

279 *
p
++ = 
œ°
;

280 
⁄˚
 = 0;

282 
	}
}

285 
	$DecodeRLE4
(
MWUCHAR
 * 
buf
, 
buf„r_t
 * 
§c
)

287 
c
, 
n
, 
c1
, 
c2
;

289 
p
 = 
buf
;

290 
⁄˚
 = 0;

291 
c1
 = 0;

294 
n
 = 
	`GdImageBuf„rGëCh¨
(
§c
)) {

295 
EOF
:

298 
n
 = 
	`GdImageBuf„rGëCh¨
(
§c
)) {

300 i‡(
⁄˚
)

301 
	`put4
(0);

304 i‡(
⁄˚
)

305 
	`put4
(0);

308 (Ë
	`GdImageBuf„rGëCh¨
(
§c
);

309 (Ë
	`GdImageBuf„rGëCh¨
(
§c
);

312 
c2
 = (
n
 + 3) & ~3;

313 
c
 = 0; c < 
c2
; c++) {

314 i‡((
c
 & 1) == 0)

315 
c1
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

316 i‡(
c
 < 
n
)

317 
	`put4
((
c1
 >> 4) & 0x0f);

318 
c1
 <<= 4;

323 
c
 = 
	`GdImageBuf„rGëCh¨
(
§c
);

324 
c1
 = (
c
 >> 4) & 0x0f;

325 
c2
 = 
c
 & 0x0f;

326 
c
 = 0; c < 
n
; c++)

327 
	`put4
((
c
 & 1Ë? 
c2
 : 
c1
);

331 
	}
}

	@engine/image_gif.c

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

40 
	~<uni°d.h
>

41 
	~<f˙é.h
>

42 
	~<˘y≥.h
>

43 
	~<sys/ty≥s.h
>

44 
	~<sys/°©.h
>

45 
	~"devi˚.h
"

46 
	~"sw≠.h
"

48 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_GIF_SUPPORT
)

50 
	#MAXCOLORMAPSIZE
 256

	)

51 
	#MAX_LWZ_BITS
 12

	)

52 
	#INTERLACE
 0x40

	)

53 
	#LOCALCOLORMAP
 0x80

	)

55 
	#CM_RED
 0

	)

56 
	#CM_GREEN
 1

	)

57 
	#CM_BLUE
 2

	)

59 
	#BôSë
(
byã
, 
bô
Ë(((byãË& (bô)Ë=(bô))

	)

60 
	#RódOK
(
§c
,
buf„r
,
Àn
Ë
	`GdImageBuf„rRód
(§c, buf„r,Üí)

	)

61 
	#LM_to_uöt
(
a
,
b
Ë(((b)<<8)|◊))

	)

64 
	mWidth
;

65 
	mHeight
;

66 
	mCﬁ‹M≠
[3][
MAXCOLORMAPSIZE
];

67 
	mBôPixñ
;

68 
	mCﬁ‹Resﬁuti⁄
;

69 
	mBackground
;

70 
	mA•e˘R©io
;

71 
	mGøySˇÀ
;

72 } 
	gGifS¸ìn
;

75 
	må™•¨ít
;

76 
	mdñayTime
;

77 
	möputFœg
;

78 
	mdi•oßl
;

79 } 
	gGif89
;

81 
RódCﬁ‹M≠
(
buf„r_t
 *
§c
, 
numbî
,

82 
buf„r
[3][
MAXCOLORMAPSIZE
], *
Êag
);

83 
DoExãnsi⁄
(
buf„r_t
 *
§c
, 
œbñ
);

84 
GëD©aBlock
(
buf„r_t
 *
§c
, *
buf
);

85 
GëCode
(
buf„r_t
 *
§c
, 
code_size
, 
Êag
);

86 
LWZRódByã
(
buf„r_t
 *
§c
, 
Êag
, 
öput_code_size
);

87 
RódImage
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
, 
Àn
, 
height
, ,

88 
cm≠
[3][
MAXCOLORMAPSIZE
],

89 
gøy
, 
öãæa˚
, 
ign‹e
);

92 
	$GdDecodeGIF
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
)

94 
buf
[16];

95 
c
;

96 
loˇlCﬁ‹M≠
[3][
MAXCOLORMAPSIZE
];

97 
gøySˇÀ
;

98 
u£GlobÆCﬁ‹m≠
;

99 
bôPixñ
;

100 
imageCou¡
 = 0;

101 
vîsi⁄
[4];

102 
imageNumbî
 = 1;

103 
ok
 = 0;

105 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

107 
pimage
->
imagebôs
 = 
NULL
;

108 
pimage
->
∑Àâe
 = 
NULL
;

110 i‡(!
	`RódOK
(
§c
, 
buf
, 6))

112 i‡(
	`°∫cmp
((*Ë
buf
, "GIF", 3) != 0)

114 
	`°∫˝y
(
vîsi⁄
, (*Ë
buf
 + 3, 3);

115 
vîsi⁄
[3] = '\0';

117 i‡(
	`°rcmp
(
vîsi⁄
, "87a") != 0 && strcmp(version, "89a") != 0) {

118 
	`EPRINTF
("GdDecodeGIF: GIF versionÇumberÇot 87a or 89a\n");

121 
Gif89
.
å™•¨ít
 = -1;

122 
Gif89
.
dñayTime
 = -1;

123 
Gif89
.
öputFœg
 = -1;

124 
Gif89
.
di•oßl
 = 0;

126 i‡(!
	`RódOK
(
§c
, 
buf
, 7)) {

127 
	`EPRINTF
("GdDecodeGIF: bad screen descriptor\n");

130 
GifS¸ìn
.
Width
 = 
	`LM_to_uöt
(
buf
[0], buf[1]);

131 
GifS¸ìn
.
Height
 = 
	`LM_to_uöt
(
buf
[2], buf[3]);

132 
GifS¸ìn
.
BôPixñ
 = 2 << (
buf
[4] & 0x07);

133 
GifS¸ìn
.
Cﬁ‹Resﬁuti⁄
 = (((
buf
[4] & 0x70) >> 3) + 1);

134 
GifS¸ìn
.
Background
 = 
buf
[5];

135 
GifS¸ìn
.
A•e˘R©io
 = 
buf
[6];

137 i‡(
	`BôSë
(
buf
[4], 
LOCALCOLORMAP
)) {

138 i‡(
	`RódCﬁ‹M≠
(
§c
, 
GifS¸ìn
.
BôPixñ
, GifS¸ìn.
Cﬁ‹M≠
,

139 &
GifS¸ìn
.
GøySˇÀ
)) {

140 
	`EPRINTF
("GdDecodeGIF: bad global colormap\n");

146 i‡(!
	`RódOK
(
§c
, &
c
, 1)) {

147 
	`EPRINTF
("GdDecodeGIF: EOF on image data\n");

148 
d⁄e
;

150 i‡(
c
 == ';') {

151 i‡(
imageCou¡
 < 
imageNumbî
) {

152 
	`EPRINTF
("GdDecodeGIF:Çÿimagê%d o‡%d\n", 
imageNumbî
,
imageCou¡
);

153 
d⁄e
;

156 i‡(
c
 == '!') {

157 i‡(!
	`RódOK
(
§c
, &
c
, 1)) {

158 
	`EPRINTF
("GdDecodeGIF: EOF onÉxtension function code\n");

159 
d⁄e
;

161 
	`DoExãnsi⁄
(
§c
, 
c
);

164 i‡(
c
 != ',') {

167 ++
imageCou¡
;

169 i‡(!
	`RódOK
(
§c
, 
buf
, 9)) {

170 
	`EPRINTF
("GdDecodeGIF: bad image size\n");

171 
d⁄e
;

173 
u£GlobÆCﬁ‹m≠
 = !
	`BôSë
(
buf
[8], 
LOCALCOLORMAP
);

175 
bôPixñ
 = 1 << ((
buf
[8] & 0x07) + 1);

177 i‡(!
u£GlobÆCﬁ‹m≠
) {

178 i‡(
	`RódCﬁ‹M≠
(
§c
, 
bôPixñ
, 
loˇlCﬁ‹M≠
, &
gøySˇÀ
)) {

179 
	`EPRINTF
("GdDecodeGIF: badÜocal colormap\n");

180 
d⁄e
;

182 
ok
 = 
	`RódImage
(
§c
, 
pimage
, 
	`LM_to_uöt
(
buf
[4], buf[5]),

183 
	`LM_to_uöt
(
buf
[6], buf[7]),

184 
bôPixñ
, 
loˇlCﬁ‹M≠
, 
gøySˇÀ
,

185 
	`BôSë
(
buf
[8], 
INTERLACE
),

186 
imageCou¡
 !
imageNumbî
);

188 
ok
 = 
	`RódImage
(
§c
, 
pimage
, 
	`LM_to_uöt
(
buf
[4], buf[5]),

189 
	`LM_to_uöt
(
buf
[6], buf[7]),

190 
GifS¸ìn
.
BôPixñ
, GifS¸ìn.
Cﬁ‹M≠
,

191 
GifS¸ìn
.
GøySˇÀ
, 
	`BôSë
(
buf
[8], 
INTERLACE
),

192 
imageCou¡
 !
imageNumbî
);

194 } 
ok
 == 0);

197 
pimage
->
å™scﬁ‹
 = 
Gif89
.
å™•¨ít
;

199 i‡(
ok
)

202 
d⁄e
:

203 i‡(
pimage
->
imagebôs
)

204 
	`‰ì
(
pimage
->
imagebôs
);

205 i‡(
pimage
->
∑Àâe
)

206 
	`‰ì
(
pimage
->
∑Àâe
);

208 
	}
}

211 
RódCﬁ‹M≠
(
buf„r_t
 *
§c
, 
numbî
, 
buf„r
[3][
MAXCOLORMAPSIZE
],

212 *
gøy
)

214 
	gi
;

215 
	grgb
[3];

216 
	gÊag
;

218 
	gÊag
 = 
TRUE
;

220 
	gi
 = 0; i < 
	gnumbî
; ++i) {

221 i‡(!
RódOK
(
§c
, 
rgb
, (rgb)))

223 
	gbuf„r
[
CM_RED
][
i
] = 
rgb
[0];

224 
	gbuf„r
[
CM_GREEN
][
i
] = 
rgb
[1];

225 
	gbuf„r
[
CM_BLUE
][
i
] = 
rgb
[2];

226 
	gÊag
 &(
rgb
[0] ==Ñgb[1] &&Ñgb[1] ==Ñgb[2]);

230 i‡(
	gÊag
)

231 *
	ggøy
 = (
numbî
 =2Ë? 
PBM_TYPE
 : 
PGM_TYPE
;

233 *
	ggøy
 = 
PPM_TYPE
;

235 *
	ggøy
 = 0;

238  
	gFALSE
;

242 
	$DoExãnsi⁄
(
buf„r_t
 *
§c
, 
œbñ
)

244 
buf
[256];

246 
œbñ
) {

252 
	`GëD©aBlock
(
§c
, (*Ë
buf
) != 0);

253  
FALSE
;

255 
	`GëD©aBlock
(
§c
, (*Ë
buf
);

256 
Gif89
.
di•oßl
 = (
buf
[0] >> 2) & 0x7;

257 
Gif89
.
öputFœg
 = (
buf
[0] >> 1) & 0x1;

258 
Gif89
.
dñayTime
 = 
	`LM_to_uöt
(
buf
[1], buf[2]);

259 i‡((
buf
[0] & 0x1) != 0)

260 
Gif89
.
å™•¨ít
 = 
buf
[3];

262 
	`GëD©aBlock
(
§c
, (*Ë
buf
) != 0);

263  
FALSE
;

268 
	`GëD©aBlock
(
§c
, (*Ë
buf
) != 0);

270  
FALSE
;

271 
	}
}

273 
	gZîoD©aBlock
 = 
FALSE
;

276 
	$GëD©aBlock
(
buf„r_t
 *
§c
, *
buf
)

278 
cou¡
;

280 i‡(!
	`RódOK
(
§c
, &
cou¡
, 1))

282 
ZîoD©aBlock
 = 
cou¡
 == 0;

284 i‡((
cou¡
 !0Ë&& (!
	`RódOK
(
§c
, 
buf
, count)))

286  
cou¡
;

287 
	}
}

290 
	$GëCode
(
buf„r_t
 *
§c
, 
code_size
, 
Êag
)

292 
buf
[280];

293 
curbô
, 
œ°bô
, 
d⁄e
, 
œ°_byã
;

294 
i
, 
j
, 
ªt
;

295 
cou¡
;

297 i‡(
Êag
) {

298 
curbô
 = 0;

299 
œ°bô
 = 0;

300 
d⁄e
 = 
FALSE
;

303 i‡((
curbô
 + 
code_size
Ë>
œ°bô
) {

304 i‡(
d⁄e
) {

305 i‡(
curbô
 >
œ°bô
)

306 
	`EPRINTF
("GdDecodeGIF: bad decode\n");

309 
buf
[0] = buf[
œ°_byã
 - 2];

310 
buf
[1] = buf[
œ°_byã
 - 1];

312 i‡((
cou¡
 = 
	`GëD©aBlock
(
§c
, &
buf
[2])) == 0)

313 
d⁄e
 = 
TRUE
;

315 
œ°_byã
 = 2 + 
cou¡
;

316 
curbô
 = (curbô - 
œ°bô
) + 16;

317 
œ°bô
 = (2 + 
cou¡
) * 8;

319 
ªt
 = 0;

320 
i
 = 
curbô
, 
j
 = 0; j < 
code_size
; ++i, ++j)

321 
ªt
 |((
buf
[
i
 / 8] & (1 << (ò% 8))Ë!0Ë<< 
j
;

323 
curbô
 +
code_size
;

325  
ªt
;

326 
	}
}

329 
	$LWZRódByã
(
buf„r_t
 *
§c
, 
Êag
, 
öput_code_size
)

331 
code
, 
öcode
;

332 
i
;

333 
‰esh
 = 
FALSE
;

334 
code_size
, 
£t_code_size
;

335 
max_code
, 
max_code_size
;

336 
fú°code
, 
ﬁdcode
;

337 
˛ór_code
, 
íd_code
;

338 
èbÀ
[2][(1 << 
MAX_LWZ_BITS
)];

339 
°ack
[(1 << (
MAX_LWZ_BITS
)Ë* 2], *
•
;

341 i‡(
Êag
) {

342 
£t_code_size
 = 
öput_code_size
;

343 
code_size
 = 
£t_code_size
 + 1;

344 
˛ór_code
 = 1 << 
£t_code_size
;

345 
íd_code
 = 
˛ór_code
 + 1;

346 
max_code_size
 = 2 * 
˛ór_code
;

347 
max_code
 = 
˛ór_code
 + 2;

349 
	`GëCode
(
§c
, 0, 
TRUE
);

351 
‰esh
 = 
TRUE
;

353 
i
 = 0; i < 
˛ór_code
; ++i) {

354 
èbÀ
[0][
i
] = 0;

355 
èbÀ
[1][
i
] = i;

357 ; 
i
 < (1 << 
MAX_LWZ_BITS
); ++i)

358 
èbÀ
[0][
i
] =Åable[1][0] = 0;

360 
•
 = 
°ack
;

363 } i‡(
‰esh
) {

364 
‰esh
 = 
FALSE
;

366 
fú°code
 = 
ﬁdcode
 = 
	`GëCode
(
§c
, 
code_size
, 
FALSE
);

367 } 
fú°code
 =
˛ór_code
);

368  
fú°code
;

370 i‡(
•
 > 
°ack
)

371  *--
•
;

373 (
code
 = 
	`GëCode
(
§c
, 
code_size
, 
FALSE
)) >= 0) {

374 i‡(
code
 =
˛ór_code
) {

375 
i
 = 0; i < 
˛ór_code
; ++i) {

376 
èbÀ
[0][
i
] = 0;

377 
èbÀ
[1][
i
] = i;

379 ; 
i
 < (1 << 
MAX_LWZ_BITS
); ++i)

380 
èbÀ
[0][
i
] =Åable[1][i] = 0;

381 
code_size
 = 
£t_code_size
 + 1;

382 
max_code_size
 = 2 * 
˛ór_code
;

383 
max_code
 = 
˛ór_code
 + 2;

384 
•
 = 
°ack
;

385 
fú°code
 = 
ﬁdcode
 = 
	`GëCode
(
§c
, 
code_size
, 
FALSE
);

386  
fú°code
;

387 } i‡(
code
 =
íd_code
) {

388 
cou¡
;

389 
buf
[260];

391 i‡(
ZîoD©aBlock
)

394 (
cou¡
 = 
	`GëD©aBlock
(
§c
, 
buf
)) > 0);

396 i‡(
cou¡
 != 0) {

403 
öcode
 = 
code
;

405 i‡(
code
 >
max_code
) {

406 *
•
++ = 
fú°code
;

407 
code
 = 
ﬁdcode
;

409 
code
 >
˛ór_code
) {

410 *
•
++ = 
èbÀ
[1][
code
];

411 i‡(
code
 =
èbÀ
[0][code])

412 
	`EPRINTF
("GdDecodeGIF: circularÅableÉntry\n");

413 
code
 = 
èbÀ
[0][code];

416 *
•
++ = 
fú°code
 = 
èbÀ
[1][
code
];

418 i‡((
code
 = 
max_code
Ë< (1 << 
MAX_LWZ_BITS
)) {

419 
èbÀ
[0][
code
] = 
ﬁdcode
;

420 
èbÀ
[1][
code
] = 
fú°code
;

421 ++
max_code
;

422 i‡((
max_code
 >
max_code_size
) &&

423 (
max_code_size
 < (1 << 
MAX_LWZ_BITS
))) {

424 
max_code_size
 *= 2;

425 ++
code_size
;

428 
ﬁdcode
 = 
öcode
;

430 i‡(
•
 > 
°ack
)

431  *--
•
;

433  
code
;

434 
	}
}

437 
RódImage
(
buf„r_t
* 
§c
, 
PMWIMAGEHDR
 
pimage
, 
Àn
, 
height
, 
cm≠Size
,

438 
cm≠
[3][
MAXCOLORMAPSIZE
],

439 
gøy
, 
öãæa˚
, 
ign‹e
)

441 
	gc
;

442 
	gi
, 
	gv
;

443 
	gxpos
 = 0, 
	gypos
 = 0, 
	g∑ss
 = 0;

448 i‡(!
RódOK
(
§c
, &
c
, 1)) {

449 
EPRINTF
("GdDecodeGIF: EOF on image data\n");

452 i‡(
LWZRódByã
(
§c
, 
TRUE
, 
c
) < 0) {

453 
EPRINTF
("GdDecodeGIF:ÉrrorÑeading image\n");

460 i‡(
	gign‹e
) {

461 
LWZRódByã
(
§c
, 
FALSE
, 
c
) >= 0);

465 
	gpimage
->
	gwidth
 = 
Àn
;

466 
	gpimage
->
	gheight
 = 
height
;

467 
	gpimage
->
	g∂™es
 = 1;

468 
	gpimage
->
	gbµ
 = 8;

469 
GdCompuãImagePôch
(8, 
Àn
, &
pimage
->
pôch
, &pimage->
byã•îpixñ
);

470 
	gpimage
->
	gcom¥essi⁄
 = 0;

471 
	gpimage
->
	g∑lsize
 = 
cm≠Size
;

472 
	gpimage
->
	g∑Àâe
 = 
mÆloc
(256*(
MWPALENTRY
));

473 
	gpimage
->
	gimagebôs
 = 
mÆloc
(
height
*
pimage
->
pôch
);

474 if(!
	gpimage
->
	gimagebôs
 || !pimage->
	g∑Àâe
)

477 
	gi
 = 0; i < 
	gcm≠Size
; i++) {

480 
	gpimage
->
	g∑Àâe
[
i
].
	gr
 = 
cm≠
[
CM_RED
][i];

481 
	gpimage
->
	g∑Àâe
[
i
].
	gg
 = 
cm≠
[
CM_GREEN
][i];

482 
	gpimage
->
	g∑Àâe
[
i
].
	gb
 = 
cm≠
[
CM_BLUE
][i];

485 (
	gv
 = 
LWZRódByã
(
§c
, 
FALSE
, 
c
)) >= 0) {

486 
pimage
->
imagebôs
[
ypos
 *Öimage->
pôch
 + 
xpos
] = 
v
;

488 ++
	gxpos
;

489 i‡(
	gxpos
 =
Àn
) {

490 
xpos
 = 0;

491 i‡(
	göãæa˚
) {

492 
	g∑ss
) {

495 
ypos
 += 8;

498 
ypos
 += 4;

501 
ypos
 += 2;

505 i‡(
	gypos
 >
height
) {

506 ++
∑ss
;

507 
	g∑ss
) {

509 
ypos
 = 4;

512 
ypos
 = 2;

515 
ypos
 = 1;

518 
föi
;

522 ++
	gypos
;

525 i‡(
	gypos
 >
height
)

529 
	gföi
:

	@engine/image_jpeg.c

37 
	~<°dio.h
>

38 
	~<°dlib.h
>

39 
	~<°rög.h
>

40 
	~<uni°d.h
>

41 
	~<f˙é.h
>

42 
	~<˘y≥.h
>

43 
	~<sys/ty≥s.h
>

44 
	~<sys/°©.h
>

45 
	~"devi˚.h
"

46 
	~"sw≠.h
"

48 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_JPEG_SUPPORT
)

49 
	~"j≥glib.h
"

51 
buf„r_t
 *
	gö±r
;

54 
	$öô_sour˚
(
j_decom¥ess_±r
 
cöfo
)

56 
cöfo
->
§c
->
√xt_öput_byã
 = 
ö±r
->
°¨t
;

57 
cöfo
->
§c
->
byãs_ö_buf„r
 = 
ö±r
->
size
;

58 
	}
}

61 
	$fûl_öput_buf„r
(
j_decom¥ess_±r
 
cöfo
)

64 
	}
}

67 
	$skù_öput_d©a
(
j_decom¥ess_±r
 
cöfo
, 
num_byãs
)

69 i‡(
num_byãs
 >
ö±r
->
size
)

71 
cöfo
->
§c
->
√xt_öput_byã
 +
num_byãs
;

72 
cöfo
->
§c
->
byãs_ö_buf„r
 -
num_byãs
;

73 
	}
}

75 
boﬁón


76 
	$ªsync_to_ª°¨t
(
j_decom¥ess_±r
 
cöfo
, 
desúed
)

78  
	`j≥g_ªsync_to_ª°¨t
(
cöfo
, 
desúed
);

79 
	}
}

82 
	$ãrm_sour˚
(
j_decom¥ess_±r
 
cöfo
)

85 
	}
}

88 
	$GdDecodeJPEG
(
buf„r_t
 * 
§c
, 
PMWIMAGEHDR
 
pimage
, 
PSD
 
psd
, 
MWBOOL
 
Á°_gøysˇÀ
)

90 
i
;

91 
ªt
 = 2;

92 
magic
[8];

93 
j≥g_sour˚_mgr
 
smgr
;

94 
j≥g_decom¥ess_°ru˘
 
cöfo
;

95 
j≥g_îr‹_mgr
 
jîr
;

96 #i‡
FASTJPEG


97 
MWPALENTRY
 
mw°d∑l8
[256];

99 
MWPALENTRY
 
∑Àâe
[256];

103 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

104 i‡(
	`GdImageBuf„rRód
(
§c
, 
magic
, 2) != 2

105 || 
magic
[0] != 0xFF || magic[1] != 0xD8)

108 i‡(
	`GdImageBuf„rRód
(
§c
, 
magic
, 8) != 8

109 || (
	`°∫cmp
(
magic
+4, "JFIF", 4) != 0

110 && 
	`°∫cmp
(
magic
+4, "Exif", 4) != 0))

113 
	`GdImageBuf„rSìkTo
(
§c
, 0);

114 
pimage
->
imagebôs
 = 
NULL
;

115 
pimage
->
∑Àâe
 = 
NULL
;

119 
cöfo
.
îr
 = 
	`j≥g_°d_îr‹
(&
jîr
);

122 
	`j≥g_¸óã_decom¥ess
(&
cöfo
);

125 
smgr
.
öô_sour˚
 = (*) init_source;

126 
smgr
.
fûl_öput_buf„r
 = (*) fill_input_buffer;

127 
smgr
.
skù_öput_d©a
 = (*) skip_input_data;

128 
smgr
.
ªsync_to_ª°¨t
 = (*)Ñesync_to_restart;

129 
smgr
.
ãrm_sour˚
 = (*)Åerm_source;

130 
cöfo
.
§c
 = &
smgr
;

131 
ö±r
 = 
§c
;

137 
	`j≥g_ªad_hódî
(&
cöfo
, 
TRUE
);

139 
cöfo
.
out_cﬁ‹_•a˚
 = 
Á°_gøysˇÀ
? 
JCS_GRAYSCALE
: 
JCS_RGB
;

140 
cöfo
.
qu™tize_cﬁ‹s
 = 
FALSE
;

142 #i‡
FASTJPEG


143 
Á°j≥g
;

145 i‡(!
Á°_gøysˇÀ
) {

146 i‡(
psd
->
pixty≥
 =
MWPF_PALETTE
) {

147 
Á°j≥g
:

148 
cöfo
.
qu™tize_cﬁ‹s
 = 
TRUE
;

149 #i‡
FASTJPEG


150 
cöfo
.
a˘uÆ_numbî_of_cﬁ‹s
 = 256;

153 
cöfo
.
a˘uÆ_numbî_of_cﬁ‹s
 =

154 
	`GdGëPÆëã
(
psd
, 0,Ösd->
ncﬁ‹s
, 
∑Àâe
);

158 
cöfo
.
cﬁ‹m≠
 = (*cöfo.
mem
->
Æloc_ßºay
)

159 ((
j_comm⁄_±r
Ë&
cöfo
, 
JPOOL_IMAGE
,

160 (
JDIMENSION
)
cöfo
.
a˘uÆ_numbî_of_cﬁ‹s
,

161 (
JDIMENSION
)3);

164 
i
 = 0; i < 
cöfo
.
a˘uÆ_numbî_of_cﬁ‹s
; ++i) {

165 #i‡
FASTJPEG


166 
cöfo
.
cﬁ‹m≠
[0][
i
] = 
mw°d∑l8
[i].
r
;

167 
cöfo
.
cﬁ‹m≠
[1][
i
] = 
mw°d∑l8
[i].
g
;

168 
cöfo
.
cﬁ‹m≠
[2][
i
] = 
mw°d∑l8
[i].
b
;

170 
cöfo
.
cﬁ‹m≠
[0][
i
] = 
∑Àâe
[i].
r
;

171 
cöfo
.
cﬁ‹m≠
[1][
i
] = 
∑Àâe
[i].
g
;

172 
cöfo
.
cﬁ‹m≠
[2][
i
] = 
∑Àâe
[i].
b
;

178 
cöfo
.
qu™tize_cﬁ‹s
 = 
TRUE
;

179 
cöfo
.
out_cﬁ‹_•a˚
 = 
JCS_GRAYSCALE
;

180 
cöfo
.
desúed_numbî_of_cﬁ‹s
 = 256;

182 
	`j≥g_ˇlc_ouçut_dimísi⁄s
(&
cöfo
);

184 
pimage
->
width
 = 
cöfo
.
ouçut_width
;

185 
pimage
->
height
 = 
cöfo
.
ouçut_height
;

186 
pimage
->
∂™es
 = 1;

187 #i‡
FASTJPEG


188 
pimage
->
bµ
 = 8;

190 
pimage
->
bµ
 = (
Á°_gøysˇÀ
 || 
psd
->
pixty≥
 =
MWPF_PALETTE
)?

191 8: 
cöfo
.
ouçut_comp⁄íts
*8;

193 
	`GdCompuãImagePôch
(
pimage
->
bµ
,Öimage->
width
, &pimage->
pôch
,

194 &
pimage
->
byã•îpixñ
);

195 
pimage
->
com¥essi⁄
 = 
MWIMAGE_RGB
;

196 
pimage
->
∑lsize
 = (pimage->
bµ
 == 8)? 256: 0;

197 
pimage
->
imagebôs
 = 
	`mÆloc
’image->
pôch
 *Öimage->
height
);

198 if(!
pimage
->
imagebôs
)

199 
îr
;

200 
pimage
->
∑Àâe
 = 
NULL
;

202 if(
pimage
->
bµ
 <= 8) {

203 
pimage
->
∑Àâe
 = 
	`mÆloc
(256*(
MWPALENTRY
));

204 if(!
pimage
->
∑Àâe
)

205 
îr
;

206 i‡(
Á°_gøysˇÀ
) {

207 
i
=0; i<256; ++i) {

208 
MWPALENTRY
 
≥
;

210 
≥
.
r
 =Öe.
g
 =Öe.
b
 = 
i
;

211 
pimage
->
∑Àâe
[
i
] = 
≥
;

214 #i‡
FASTJPEG


216 
i
=0; i<256; ++i)

217 
pimage
->
∑Àâe
[
i
] = 
mw°d∑l8
[i];

223 
	`j≥g_°¨t_decom¥ess
 (&
cöfo
);

226 
cöfo
.
ouçut_sˇ∆öe
 < cöfo.
ouçut_height
) {

227 
JSAMPROW
 
row±r
[1];

228 
row±r
[0] = (
JSAMPROW
)(
pimage
->
imagebôs
 +

229 
cöfo
.
ouçut_sˇ∆öe
 * 
pimage
->
pôch
);

230 
	`j≥g_ªad_sˇ∆öes
 (&
cöfo
, 
row±r
, 1);

232 
ªt
 = 1;

234 
îr
:

236 
	`j≥g_föish_decom¥ess
 (&
cöfo
);

239 
	`j≥g_de°roy_decom¥ess
 (&
cöfo
);

244  
ªt
;

245 
	}
}

	@engine/image_png.c

13 
	~<°dio.h
>

14 
	~<°dlib.h
>

15 
	~<°rög.h
>

16 
	~<uni°d.h
>

17 
	~<f˙é.h
>

18 
	~<˘y≥.h
>

19 
	~<sys/ty≥s.h
>

20 
	~<sys/°©.h
>

21 
	~"devi˚.h
"

22 
	~"sw≠.h
"

24 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_PNG_SUPPORT
)

25 
	~<≤g.h
>

28 #i‚de‡
≤g_jmpbuf


29 
	#≤g_jmpbuf
(
≤g_±r
Ë(’ng_±r)->
jmpbuf
)

	)

34 
	$≤g_ªad_buf„r
(
≤g_°ru˘p
 
p°ru˘
, 
≤g_byãp
 
poöãr
, 
≤g_size_t
 
size
)

36 
	`GdImageBuf„rRód
(
p°ru˘
->
io_±r
, 
poöãr
, 
size
);

37 
	}
}

40 
	$GdDecodePNG
(
buf„r_t
 * 
§c
, 
PMWIMAGEHDR
 
pimage
)

42 
hdr
[8], **
rows
;

43 
≤g_°ru˘p
 
°©e
;

44 
≤g_öf›
 
≤göfo
;

45 
≤g_uöt_32
 
width
, 
height
;

46 
bô_dïth
, 
cﬁouπy≥
, 
i
;

48 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

50 if(
	`GdImageBuf„rRód
(
§c
, 
hdr
, 8) != 8)

53 if(
	`≤g_sig_cmp
(
hdr
, 0, 8))

56 if(!(
°©e
 = 
	`≤g_¸óã_ªad_°ru˘
(
PNG_LIBPNG_VER_STRING
, 
NULL
,

57 
NULL
, NULL))Ë
nomem
;

59 if(!(
≤göfo
 = 
	`≤g_¸óã_öfo_°ru˘
(
°©e
))) {

60 
	`≤g_de°roy_ªad_°ru˘
(&
°©e
, 
NULL
, NULL);

61 
nomem
;

64 if(
	`£tjmp
(
	`≤g_jmpbuf
(
°©e
))) {

65 
	`≤g_de°roy_ªad_°ru˘
(&
°©e
, &
≤göfo
, 
NULL
);

70 
	`≤g_£t_ªad_‚
(
°©e
, 
§c
, 
≤g_ªad_buf„r
);

73 
	`≤g_£t_sig_byãs
(
°©e
, 8);

74 
	`≤g_ªad_öfo
(
°©e
, 
≤göfo
);

75 
	`≤g_gë_IHDR
(
°©e
, 
≤göfo
, &
width
, &
height
, &
bô_dïth
, &
cﬁouπy≥
,

76 
NULL
, NULL, NULL);

78 
pimage
->
width
 = width;

79 
pimage
->
height
 = height;

80 
pimage
->
bµ
 = 24;

81 
pimage
->
∂™es
 = 1;

82 
	`GdCompuãImagePôch
(
pimage
->
bµ
,Öimage->
width
, &pimage->
pôch
,

83 &
pimage
->
byã•îpixñ
);

84 
pimage
->
com¥essi⁄
 = 
MWIMAGE_RGB
;

85 if(!(
pimage
->
imagebôs
 = 
	`mÆloc
’image->
pôch
 *Öimage->
height
))) {

86 
	`≤g_de°roy_ªad_°ru˘
(&
°©e
, &
≤göfo
, 
NULL
);

87 
nomem
;

89 if(!(
rows
 = 
	`mÆloc
(
pimage
->
height
 * (*)))) {

90 
	`≤g_de°roy_ªad_°ru˘
(&
°©e
, &
≤göfo
, 
NULL
);

91 
nomem
;

93 
i
 = 0; i < 
pimage
->
height
; i++)

94 
rows
[
i
] = 
pimage
->
imagebôs
 + (ò*Öimage->
pôch
);

96 
	`≤g_£t_ex∑nd
(
°©e
);

97 if(
bô_dïth
 == 16)

98 
	`≤g_£t_°rù_16
(
°©e
);

99 if(
cﬁouπy≥
 & 
PNG_COLOR_MASK_ALPHA
)

100 
	`≤g_£t_°rù_Æpha
(
°©e
);

101 if(
cﬁouπy≥
 =
PNG_COLOR_TYPE_GRAY
 ||

102 
cﬁouπy≥
 =
PNG_COLOR_TYPE_GRAY_ALPHA
)

103 
	`≤g_£t_gøy_to_rgb
(
°©e
);

105 
	`≤g_ªad_image
(
°©e
, 
rows
);

107 
	`≤g_ªad_íd
(
°©e
, 
NULL
);

108 
	`‰ì
(
rows
);

109 
	`≤g_de°roy_ªad_°ru˘
(&
°©e
, &
≤göfo
, 
NULL
);

113 
nomem
:

114 
	`EPRINTF
("GdDecodePNG: Out of memory\n");

116 
	}
}

	@engine/image_pnm.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~<°rög.h
>

10 
	~<uni°d.h
>

11 
	~<f˙é.h
>

12 
	~<˘y≥.h
>

13 
	~<sys/ty≥s.h
>

14 
	~<sys/°©.h
>

15 
	~"devi˚.h
"

16 
	~"sw≠.h
"

18 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_PNM_SUPPORT
)

21 
	mPNM_TYPE_NOTPNM
,

22 
	mPNM_TYPE_PBM
,

23 
	mPNM_TYPE_PGM
,

24 
	mPNM_TYPE_PPM


28 
	$GdDecodePNM
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
)

30 
buf
[256], *
p
;

31 
ty≥
 = 
PNM_TYPE_NOTPNM
, 
bö¨y
 = 0, 
gŸhdrs
 = 0, 
sˇÀ
 = 0;

32 
ch
, 
x
 = 0, 
y
 = 0, 
i
, 
n
, 
mask
, 
cﬁ1
, 
cﬁ2
, 
cﬁ3
;

34 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

36 if(!
	`GdImageBuf„rGëSåög
(
§c
,
buf
, 4))

39 if(!
	`°rcmp
("P1\n", 
buf
)Ë
ty≥
 = 
PNM_TYPE_PBM
;

40 if(!
	`°rcmp
("P2\n", 
buf
)Ë
ty≥
 = 
PNM_TYPE_PGM
;

41 if(!
	`°rcmp
("P3\n", 
buf
)Ë
ty≥
 = 
PNM_TYPE_PPM
;

42 if(!
	`°rcmp
("P4\n", 
buf
)) {

43 
ty≥
 = 
PNM_TYPE_PBM
;

44 
bö¨y
 = 1;

46 if(!
	`°rcmp
("P5\n", 
buf
)) {

47 
ty≥
 = 
PNM_TYPE_PGM
;

48 
bö¨y
 = 1;

50 if(!
	`°rcmp
("P6\n", 
buf
)) {

51 
ty≥
 = 
PNM_TYPE_PPM
;

52 
bö¨y
 = 1;

55 if(
ty≥
 =
PNM_TYPE_NOTPNM
)

58 
n
 = 0;

59 (
p
 = 
	`GdImageBuf„rGëSåög
(
§c
, 
buf
, 256))) {

60 if(*
buf
 == '#') ;

61 if(
ty≥
 =
PNM_TYPE_PBM
) {

62 if(
	`ssˇnf
(
buf
, "%ò%i", &
pimage
->
width
,

63 &
pimage
->
height
) == 2) {

64 
pimage
->
bµ
 = 1;

65 
gŸhdrs
 = 1;

66 if(!(
pimage
->
∑Àâe
 = 
	`mÆloc
(

67 (
MWPALENTRY
) * 2))) {

68 
	`EPRINTF
("Out of memory\n");

71 
pimage
->
∑lsize
 = 2;

72 
pimage
->
∑Àâe
[0].
r
 = 0xff;

73 
pimage
->
∑Àâe
[0].
g
 = 0xff;

74 
pimage
->
∑Àâe
[0].
b
 = 0xff;

75 
pimage
->
∑Àâe
[1].
r
 = 0;

76 
pimage
->
∑Àâe
[1].
g
 = 0;

77 
pimage
->
∑Àâe
[1].
b
 = 0;

81 if((
ty≥
 =
PNM_TYPE_PGM
Ë|| (ty≥ =
PNM_TYPE_PPM
)) {

82 if(!
n
++) {

83 if(
	`ssˇnf
(
buf
, "%ò%i", &
pimage
->
width
,

84 &
pimage
->
height
) != 2) ;

86 if(
	`ssˇnf
(
buf
, "%i", &
i
) != 1) ;

87 
pimage
->
bµ
 = 24;

88 if(
i
 > 255) {

89 
	`EPRINTF
("GdDecodePNM: PPM files must be "

93 
sˇÀ
 = 7, 
n
 = 2; scale; scale--,Ç *= 2)

94 if(
i
 < 
n
) ;

95 
gŸhdrs
 = 1;

101 if(!
gŸhdrs
) {

102 
	`EPRINTF
("GdDecodePNM: bad image headers\n");

103 if(
pimage
->
∑Àâe
)

104 
	`‰ì
(
pimage
->
∑Àâe
);

108 
pimage
->
∂™es
 = 1;

109 
	`GdCompuãImagePôch
(
pimage
->
bµ
,Öimage->
width
, &pimage->
pôch
,

110 &
pimage
->
byã•îpixñ
);

111 
pimage
->
com¥essi⁄
 = 
MWIMAGE_RGB
;

112 if(!(
pimage
->
imagebôs
 = 
	`mÆloc
’image->
pôch
 *Öimage->
height
))) {

113 
	`EPRINTF
("GdDecodePNM: couldn'tállocate memory for image\n");

114 if(
pimage
->
∑Àâe
)

115 
	`‰ì
(
pimage
->
∑Àâe
);

119 
p
 = 
pimage
->
imagebôs
;

121 if(
ty≥
 =
PNM_TYPE_PBM
) {

122 if(
bö¨y
) {

123 
x
 = 0;

124 
y
 = 0;

125 (
ch
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë!
EOF
) {

126 
i
 = 0; i < 8; i++) {

127 
mask
 = 0x80 >> 
i
;

128 if(
ch
 & 
mask
Ë*
p
 |= mask;

129 *
p
 &~
mask
;

130 if(++
x
 =
pimage
->
width
) {

131 if(++
y
 =
pimage
->
height
)

133 
p
 = 
pimage
->
imagebôs
 - 1 +

134 (
y
 * 
pimage
->
pôch
);

135 
x
 = 0;

139 
p
++;

142 
n
 = 0;

143 (
ch
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë!
EOF
) {

144 if(
	`is•a˚
(
ch
)) ;

145 
mask
 = 0x80 >> 
n
;

146 if(
ch
 ='1'Ë*
p
 |
mask
;

147 if(
ch
 ='0'Ë*
p
 &~
mask
;

148 
badd©a
;

149 if(++
n
 == 8) {

150 
n
 = 0;

151 
p
++;

153 if(++
x
 =
pimage
->
width
) {

154 if(++
y
 =
pimage
->
height
)

156 
p
 = 
pimage
->
imagebôs
 +

157 (
y
 * 
pimage
->
pôch
);

158 
n
 = 0;

159 
x
 = 0;

165 if(
ty≥
 =
PNM_TYPE_PGM
) {

166 if(
bö¨y
) {

167 if((
ch
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë=
EOF
)

168 
badd©a
;

171 
badd©a
;

173 *
p
++ = 
ch
 << 
sˇÀ
;

174 *
p
++ = 
ch
 << 
sˇÀ
;

175 *
p
++ = 
ch
 << 
sˇÀ
;

177 if(
bö¨y
) {

178 if(((
cﬁ1
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë=
EOF
) ||

179 ((
cﬁ2
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë=
EOF
) ||

180 ((
cﬁ3
 = 
	`GdImageBuf„rGëCh¨
(
§c
)Ë=
EOF
))

181 
badd©a
;

184 
badd©a
;

186 *
p
++ = 
cﬁ1
 << 
sˇÀ
;

187 *
p
++ = 
cﬁ2
 << 
sˇÀ
;

188 *
p
++ = 
cﬁ3
 << 
sˇÀ
;

190 if(++
x
 =
pimage
->
width
) {

191 if(++
y
 =
pimage
->
height
)  1;

192 
p
 = 
pimage
->
imagebôs
 + (
y
 *Öimage->
pôch
);

193 
x
 = 0;

198 
badd©a
:

199 
	`EPRINTF
("GdDecodePNM: bad image data\n");

200 
	`‰ì
(
pimage
->
imagebôs
);

201 if(
pimage
->
∑Àâe
)

202 
	`‰ì
(
pimage
->
∑Àâe
);

204 
	}
}

	@engine/image_tiff.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<uni°d.h
>

10 
	~<f˙é.h
>

11 
	~<˘y≥.h
>

12 
	~<sys/ty≥s.h
>

13 
	~<sys/°©.h
>

14 
	~"devi˚.h
"

15 
	~"sw≠.h
"

17 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_TIFF_SUPPORT
)

18 
	~<tiffio.h
>

21 
	$GdDecodeTIFF
(*
∑th
, 
PMWIMAGEHDR
 
pimage
)

23 
TIFF
 *
tif
;

24 
w
, 
h
;

25 
size
;

27 
tif
 = 
	`TIFFO≥n
(
∑th
, "r");

28 i‡(!
tif
)

31 
	`TIFFGëFõld
(
tif
, 
TIFFTAG_IMAGEWIDTH
, &
w
);

32 
	`TIFFGëFõld
(
tif
, 
TIFFTAG_IMAGELENGTH
, &
h
);

33 
size
 = 
w
 * 
h
;

34 
pimage
->
width
 = 
w
;

35 
pimage
->
height
 = 
h
;

36 
pimage
->
bµ
 = 32;

37 
pimage
->
pôch
 = 
w
 * (
uöt32
);

38 
pimage
->
byã•îpixñ
 = 4;

39 
pimage
->
∂™es
 = 1;

40 
pimage
->
∑lsize
 = 0;

41 
pimage
->
∑Àâe
 = 
NULL
;

44 
pimage
->
com¥essi⁄
 = 
MWIMAGE_RGB
 | 
MWIMAGE_ALPHA_CHANNEL
 |

45 
MWIMAGE_UPSIDEDOWN
;

48 i‡((
pimage
->
imagebôs
 = 
	`mÆloc
(
size
 * (
uöt32
))Ë=
NULL
)

49 
îr
;

51 
	`TIFFRódRGBAImage
(
tif
, 
pimage
->
width
,Öimage->
height
,

52 (
uöt32
 *)
pimage
->
imagebôs
, 0);

57 
i
;

58 
uöt32
 *
rgba
;

59 
uöt32
 
rgba_r
, 
rgba_g
, 
rgba_b
, 
rgba_a
;

60 
rgba
 = (
uöt32
 *)
pimage
->
imagebôs
;

61 
i
 = 0; i < 
size
; ++i, ++
rgba
) {

62 i‡((
rgba_a
 = 
	`TIFFGëA
(*
rgba
) + 1) == 256)

64 
rgba_r
 = (
	`TIFFGëR
(*
rgba
Ë* 
rgba_a
)>>8;

65 
rgba_g
 = (
	`TIFFGëG
(*
rgba
Ë* 
rgba_a
)>>8;

66 
rgba_b
 = (
	`TIFFGëB
(*
rgba
Ë* 
rgba_a
)>>8;

67 *
rgba
 = 0xff000000|(
rgba_b
<<16)|(
rgba_g
<<8)|(
rgba_r
);

71 
	`TIFFClo£
(
tif
);

74 
îr
:

75 
	`EPRINTF
("GdDecodeTIFF: imageÜoadingÉrror\n");

76 i‡(
tif
)

77 
	`TIFFClo£
(
tif
);

78 if(
pimage
->
imagebôs
)

79 
	`‰ì
(
pimage
->
imagebôs
);

80 if(
pimage
->
∑Àâe
)

81 
	`‰ì
(
pimage
->
∑Àâe
);

83 
	}
}

	@engine/image_xpm.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<uni°d.h
>

10 
	~<f˙é.h
>

11 
	~<˘y≥.h
>

12 
	~<sys/ty≥s.h
>

13 
	~<sys/°©.h
>

14 
	~"devi˚.h
"

15 
	~"sw≠.h
"

17 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_XPM_SUPPORT
)

19 
	sxpm_cm≠
 {

20 
	mm≠°r
[3];

21 
	m∑Àâe_íåy
;

22 
	mcﬁ‹
;

23 
xpm_cm≠
 *
	m√xt
;

29 
	$XPM_∑r£_cﬁ‹
(*
cﬁ‹
)

31 i‡(
cﬁ‹
[0] != '#') {

32 i‡(!
	`°rcmp
(
cﬁ‹
, "None"))

38 *
•å
 = 
cﬁ‹
 + 1;

39 
r°r
[5], 
g°r
[5], 
b°r
[5];

40 
r
, 
g
, 
b
;

42 
	`°æí
(
•å
)) {

44  
	`°πﬁ
(
•å
, 
NULL
, 16);

47 
	`°∫˝y
(
r°r
, 
•å
, 3);

48 
	`°∫˝y
(
g°r
, 
•å
 + 3, 3);

49 
	`°∫˝y
(
b°r
, 
•å
 + 6, 3);

51 
r°r
[3] = 0;

52 
g°r
[3] = 0;

53 
b°r
[3] = 0;

55 
r
 = 
	`°πﬁ
(
r°r
, 
NULL
, 16) >> 4;

56 
g
 = 
	`°πﬁ
(
g°r
, 
NULL
, 16) >> 4;

57 
b
 = 
	`°πﬁ
(
b°r
, 
NULL
, 16) >> 4;

58  (()(
r
 << 16 | 
g
 << 8 | 
b
));

61 
	`°∫˝y
(
r°r
, 
•å
, 4);

62 
	`°∫˝y
(
g°r
, 
•å
 + 4, 4);

63 
	`°∫˝y
(
b°r
, 
•å
 + 8, 4);

65 
r°r
[4] = 0;

66 
g°r
[4] = 0;

67 
b°r
[4] = 0;

69 
r
 = 
	`°πﬁ
(
r°r
, 
NULL
, 16) >> 8;

70 
g
 = 
	`°πﬁ
(
g°r
, 
NULL
, 16) >> 8;

71 
b
 = 
	`°πﬁ
(
b°r
, 
NULL
, 16) >> 8;

73  (()((
r
 & 0xFFË<< 16 | (
g
 & 0xFFË<< 8 | (
b
 & 0xFF)));

78 
	}
}

83 
	#LOAD_HEADER
 1

	)

84 
	#LOAD_COLORS
 2

	)

85 
	#LOAD_PALETTE
 3

	)

86 
	#LOAD_PIXELS
 4

	)

87 
	#LOAD_DONE
 5

	)

90 
	#XPM_MAGIC
 "/* XPM */"

	)

91 
	#XPM_TRANSCOLOR
 0x01000000

	)

94 
	$GdDecodeXPM
(
buf„r_t
 * 
§c
, 
PMWIMAGEHDR
 
pimage
, 
PSD
 
psd
)

96 
xpm_cm≠
 *
cﬁ‹hóp
 = 0;

97 
xpm_cm≠
 *
cﬁ‹m≠
[256];

98 *
imagïå
 = 0;

99 
MWSCREENINFO
 
söfo
;

100 
xlöe
[300];

101 
dlöe
[300];

102 *
c
;

103 
a
;

104 
cﬁ
, 
row
, 
cﬁ‹s
, 
˝p
;

105 
ö_cﬁ‹
 = 0;

106 
ªad_xlöe
 = 0;

107 
°©us
 = 
LOAD_HEADER
;

110 
	`GdGëS¸ìnInfo
(
psd
, &
söfo
);

112 
a
 = 0;á < 256;á++)

113 
cﬁ‹m≠
[
a
] = 0;

115 
pimage
->
imagebôs
 = 
NULL
;

116 
pimage
->
∑Àâe
 = 
NULL
;

119 
	`GdImageBuf„rSìkTo
(
§c
, 0UL);

120 
	`GdImageBuf„rGëSåög
(
§c
, 
xlöe
, 300);

123 
xlöe
[
	`°æí
(xline) - 1] = 0;

126 i‡(
	`°∫cmp
(
xlöe
, 
XPM_MAGIC
, (XPM_MAGIC)))

129 !
	`GdImageBuf„rEOF
(
§c
)) {

131 
	`GdImageBuf„rGëSåög
(
§c
, 
xlöe
, 300);

132 
xlöe
[
	`°æí
(xline) - 1] = 0;

135 i‡(
xlöe
[0] == '/' && xline[1] == '*')

138 i‡(
xlöe
[0] != '\"')

142 
c
 = 
xlöe
 + 1, 
a
 = 0; *c != '\"' && *c != 0; c++,á++)

143 
dlöe
[
a
] = *
c
;

145 
dlöe
[
a
] = 0;

148 i‡(
°©us
 =
LOAD_HEADER
) {

149 
	`ssˇnf
(
dlöe
, "%ò%ò%ò%i", &
cﬁ
, &
row
, &
cﬁ‹s
, &
˝p
);

151 
pimage
->
width
 = 
cﬁ
;

152 
pimage
->
height
 = 
row
;

153 
pimage
->
∂™es
 = 1;

155 i‡(
söfo
.
bµ
 <= 8) {

156 
pimage
->
bµ
 = 
söfo
.bpp;

157 
pimage
->
com¥essi⁄
 = 0;

158 
pimage
->
å™scﬁ‹
 = -1;

160 
pimage
->
bµ
 = 32;

161 
pimage
->
å™scﬁ‹
 = 
XPM_TRANSCOLOR
;

162 
pimage
->
com¥essi⁄
 = 
MWIMAGE_BGR
;

165 
pimage
->
∑lsize
 = 
cﬁ‹s
;

166 
	`GdCompuãImagePôch
(
pimage
->
bµ
, 
cﬁ
, &pimage->
pôch
,

167 &
pimage
->
byã•îpixñ
);

169 
pimage
->
imagebôs
 = 
	`mÆloc
’image->
pôch
 *Öimage->
height
);

170 
imagïå
 = (*Ë
pimage
->
imagebôs
;

173 
cﬁ‹hóp
 = (
xpm_cm≠
 *Ë
	`mÆloc
(
cﬁ‹s
 *

174 (
xpm_cm≠
));

177 i‡(
söfo
.
bµ
 <= 8)

178 
pimage
->
∑Àâe
 = 
	`mÆloc
(256 * (
MWPALENTRY
));

180 i‡(!
cﬁ‹hóp
) {

181 
	`EPRINTF
("Couldn'tállocateány memory forÅhe colors\n");

185 
°©us
 = 
LOAD_COLORS
;

186 
ö_cﬁ‹
 = 0;

191 i‡(
°©us
 =
LOAD_COLORS
) {

192 
xpm_cm≠
 *
n
;

193 
t°r
[5];

194 
c°r
[256];

195 
m
;

197 
c
 = 
dlöe
;

201 
	`°∫˝y
(
t°r
, 
c
, 
˝p
);

203 
c
 +
˝p
;

204 ; *
c
 == '\t' || *c == ' '; c++)

208 
c
 += 2;

210 
t°r
[
˝p
] = 0;

215 
m
 = 
t°r
[0];

217 i‡(
cﬁ‹m≠
[
m
]) {

218 
n
 = 
cﬁ‹m≠
[
m
];

220 
n
->
√xt
)

221 
n
 =Ç->
√xt
;

222 
n
->
√xt
 = &
cﬁ‹hóp
[
ö_cﬁ‹
];

223 
n
 =Ç->
√xt
;

225 
cﬁ‹m≠
[
m
] = &
cﬁ‹hóp
[
ö_cﬁ‹
];

226 
n
 = 
cﬁ‹m≠
[
m
];

229 
n
->
√xt
 = 0;

232 
	`°∫˝y
(
n
->
m≠°r
, 
t°r
, 
˝p
);

233 
n
->
m≠°r
[
˝p
] = 0;

236 
n
->
∑Àâe_íåy
 = (Ë
ö_cﬁ‹
;

239 
	`ssˇnf
(
c
, "%65535s", 
c°r
);

242 
n
->
cﬁ‹
 = 
	`XPM_∑r£_cﬁ‹
(
c°r
);

247 i‡(
söfo
.
bµ
 <= 8) {

248 i‡(
n
->
cﬁ‹
 == -1) {

249 
pimage
->
å™scﬁ‹
 = 
ö_cﬁ‹
;

250 
n
->
cﬁ‹
 = -1;

253 
pimage
->
∑Àâe
[
ö_cﬁ‹
].
r
 =

254 (
n
->
cﬁ‹
 >> 16) & 0xFF;

255 
pimage
->
∑Àâe
[
ö_cﬁ‹
].
g
 =

256 (
n
->
cﬁ‹
 >> 8) & 0xFF;

257 
pimage
->
∑Àâe
[
ö_cﬁ‹
].
b
 = 
n
->
cﬁ‹
 & 0xFF;

259 i‡(
n
->
cﬁ‹
 == -1) {

260 
n
->
cﬁ‹
 = 
XPM_TRANSCOLOR
;

264 i‡(++
ö_cﬁ‹
 =
cﬁ‹s
) {

265 
ªad_xlöe
 = 0;

266 
°©us
 = 
LOAD_PIXELS
;

272 i‡(
°©us
 =
LOAD_PIXELS
) {

273 
byãcou¡
 = 0;

274 
bôcou¡
 = 0;

275 
dw‹dcﬁ‹
 = 0;

276 
i
;

277 
pxl°r
[3];

279 
c
 = 
dlöe
;

281 *
c
) {

282 
z
 = 0;

284 i‡(
˝p
 == 1) {

285 
z
 = *
c
;

287 i‡(!
cﬁ‹m≠
[
z
]) {

288 
	`EPRINTF
("Nÿcﬁ‹É¡ry f‹ (%c)\n", 
z
);

292 i‡(
söfo
.
bµ
 <= 8)

293 
dw‹dcﬁ‹
 = ()
cﬁ‹m≠
[
z
]->
∑Àâe_íåy
;

295 
dw‹dcﬁ‹
 = 
cﬁ‹m≠
[
z
]->
cﬁ‹
;

297 
c
++;

299 
xpm_cm≠
 *
n
;

302 
	`°∫˝y
(
pxl°r
, 
c
, 
˝p
);

303 
z
 = 
pxl°r
[0];

305 i‡(!
cﬁ‹m≠
[
z
]) {

306 
	`EPRINTF
("Nÿcﬁ‹É¡ry f‹ (%s)\n", 
pxl°r
);

310 
n
 = 
cﬁ‹m≠
[
z
];

312 
n
) {

313 i‡(!
°∫cmp


314 (
n
->
m≠°r
, 
pxl°r
, 
˝p
))

317 
n
 =Ç->
√xt
;

320 i‡(!
n
) {

321 
	`EPRINTF
("Nÿcﬁ‹ found f‹ (%s)\n", 
pxl°r
);

325 i‡(
söfo
.
bµ
 <= 8)

326 
dw‹dcﬁ‹
 = ()
n
->
∑Àâe_íåy
;

328 
dw‹dcﬁ‹
 = 
n
->
cﬁ‹
;

329 
c
 +
˝p
;

336 
söfo
.
bµ
) {

338 i‡(
bôcou¡
 == 0)

339 
imagïå
[0] = 0;

341 
imagïå
[0] |(
dw‹dcﬁ‹
 & 0x3Ë<< (4 - 
bôcou¡
);

342 
bôcou¡
++;

344 i‡(
bôcou¡
 == 4) {

345 
imagïå
++;

346 
byãcou¡
 +
pimage
->
byã•îpixñ
;

347 
bôcou¡
 = 0;

353 i‡(
bôcou¡
 == 0)

354 
imagïå
[0] = 0;

356 
imagïå
[0] |(
dw‹dcﬁ‹
 & 0xFË<< (2 - 
bôcou¡
);

357 
bôcou¡
++;

359 i‡(
bôcou¡
 == 2) {

360 
imagïå
++;

361 
byãcou¡
 +
pimage
->
byã•îpixñ
;

362 
bôcou¡
 = 0;

372 
i
 = 0; i < 
pimage
->
byã•îpixñ
; i++)

373 
imagïå
[
i
] = (
dw‹dcﬁ‹
 >> (8 * i)) & 0xFF;

375 
imagïå
 +
pimage
->
byã•îpixñ
;

376 
byãcou¡
 +
pimage
->
byã•îpixñ
;

379 #ifde‡
NOTUSED


381 
imagïå
[0] = (Ë(
dw‹dcﬁ‹
 & 0xFF);

382 
imagïå
 +
pimage
->
byã•îpixñ
;

383 
byãcou¡
 +
pimage
->
byã•îpixñ
;

389 
imagïå
[0] = (Ë(
dw‹dcﬁ‹
 >> 24) & 0xFF;

390 
imagïå
[1] = (Ë(
dw‹dcﬁ‹
 >> 16) & 0xFF;

391 
imagïå
[2] = (Ë(
dw‹dcﬁ‹
 >> 8) & 0xFF;

392 
imagïå
[3] = (Ë(
dw‹dcﬁ‹
 & 0xFF);

393 
imagïå
 +
pimage
->
byã•îpixñ
;

394 
byãcou¡
 +
pimage
->
byã•îpixñ
;

401 i‡(
byãcou¡
 < 
pimage
->
pôch
)

402 
i
 = 0; i < (
pimage
->
pôch
 - 
byãcou¡
);

403 
i
++)

404 *
imagïå
++ = 0x00;

406 
ªad_xlöe
++;

408 i‡(
ªad_xlöe
 =
row
)

409 
°©us
 = 
LOAD_DONE
;

415 
	`‰ì
(
cﬁ‹hóp
);

417 i‡(
°©us
 !
LOAD_DONE
)

420 
	}
}

	@engine/obsolete.c

26 
	ggr_w¨nög_libmwígöe_is_obsﬁëe
[] =

	@engine/selfont.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	~<as£π.h
>

12 
	~<˘y≥.h
>

13 
	~<°rög.h
>

15 
	~"devi˚.h
"

16 #i‡(
UNIX
 | 
DOS_DJGPP
)

17 
	#°rcmpi
 
°rˇ£cmp


	)

20 #i‡
FONTMAPPER


23 
£À˘_f⁄t
(c⁄° 
PMWLOGFONT
 
∂ogf⁄t
, *
phy¢ame
);

31 
	savaûabÀ_f⁄t
 {

32 
MWLOGFONT
 
	mlf
;

33 *
	mfoundry
;

34 *
	mÁmûy
;

35 *
	mf⁄äame
;

36 
	mf⁄t˛ass
, 
	mÆüs
;

37 
avaûabÀ_f⁄t
 *
	m√xt
;

40 
avaûabÀ_f⁄t
 *
	gÆl_f⁄ts
 = 0;

46 
	#STREQ_EXACT
 0

	)

47 
	#STREQ_CASE
 1

	)

48 
	#STREQ_NOMATCH
 2

	)

50 
	$°ªq
(c⁄° *
a
, c⁄° *
b
)

52 
rc
;

54  
rc
 = 
STREQ_EXACT
; *
a
 !0;á++, 
b
++ ) {

55 i‡–*
a
 =*
b
 )

57 i‡–
	`touµî
(()*
a
Ë!touµî(()*
b
) )

58  
STREQ_NOMATCH
;

59 
rc
 = 
STREQ_CASE
;

61 i‡–*
b
 != 0 )

62  
STREQ_NOMATCH
;

63  
rc
;

64 
	}
}

70 
	$decode_f⁄t_˛ass
(c⁄° *
˛ass
)

72 i‡–
˛ass
 =
NULL
 )

74 i‡–!
	`°rcmp
("T1",
˛ass
) )

75  
MWLF_CLASS_T1LIB
;

76 i‡–!
	`°rcmp
("FT",
˛ass
) )

77  
MWLF_CLASS_FREETYPE
;

78 i‡–!
	`°rcmp
("FT2",
˛ass
) )

79  
MWLF_CLASS_FREETYPE
;

80 i‡–!
	`°rcmp
("MWF",
˛ass
) )

81  
MWLF_CLASS_BUILTIN
;

83 
	}
}

89 
	$ã°_f⁄t_«mög
(c⁄° *
foundry
, c⁄° *
f⁄äame
,

90 
avaûabÀ_f⁄t
 *
af
,

91 
avaûabÀ_f⁄t
 **
be°
, *
good√ss
)

93 
≥«…y
 = 0;

95 i‡–
foundry
 != 0 ) {

96 i‡–
af
->
foundry
 != 0 ) {

97  
	`°ªq
(
foundry
,
af
->foundry) ) {

98 
STREQ_EXACT
:

100 
STREQ_CASE
:

101 
≥«…y
 += 2;

104 
≥«…y
 += 8;

108 
≥«…y
 += 4;

112  
	`°ªq
(
f⁄äame
,
af
->fontname) ) {

113 
STREQ_EXACT
:

115 
STREQ_CASE
:

116 
≥«…y
 += 1;

119 
≥«…y
 += 16;

123 i‡–*
good√ss
 < 0 || 
≥«…y
 < *goodness ) {

124 *
be°
 = 
af
;

125 *
good√ss
 = 
≥«…y
;

127 
	}
}

142 
	#GOODNESS_NO_FONTNAME
 1000

	)

143 
	#GOODNESS_WEIGHT_DIFF
 1

	)

145 
	#GOODNESS_NO_FOUNDRY
 100

	)

147 
	#GOODNESS_FOUNDRY_UNKNOWN
 16

	)

148 
	#GOODNESS_CASE_FAMILY
 8

	)

149 
	#GOODNESS_CASE_FONTNAME
 4

	)

150 
	#GOODNESS_CASE_FOUNDRY
 2

	)

151 
	#GOODNESS_EXACT_FAMILY
 1

	)

153 
	#GOODNESS_EXACT_FOUNDRY
 0

	)

154 
	#GOODNESS_EXACT_FONTNAME
 0

	)

156 
	#GOODNESS_FAMILY_UNKNOWN
 3000

	)

157 
	#GOODNESS_NOMATCH_FAMILY
 10000

	)

159 
	#GOODNESS_EXACT_FONTFAMILY
 0

	)

160 
	#GOODNESS_CASE_FONTFAMILY
 32

	)

161 
	#GOODNESS_CLOSE_SLANT
 128

	)

162 
	#GOODNESS_BAD_SLANT
 256

	)

163 
	#GOODNESS_WRONG_SPACING
 2048

	)

165 
	#GOODNESS_WRONG_SERIFSTYLE
 1024

	)

167 
	#GOODNESS_WANTED_SMALLCAPS_NOT_AVAILABLE
 4096

	)

168 
	#GOODNESS_ONLY_SMALLCAPS_AVAILABLE
 8192

	)

171 
	$föd_foundry_≥«…y
(c⁄° 
avaûabÀ_f⁄t
 *
have
,

172 c⁄° *
foundry
)

174 i‡–
foundry
 == 0 )

177 i‡–
have
->
foundry
 == 0 )

178  
GOODNESS_FOUNDRY_UNKNOWN
;

180  
	`°ªq
(
foundry
,
have
->foundry) ) {

181 
STREQ_EXACT
:

182  
GOODNESS_EXACT_FOUNDRY
;

184 
STREQ_CASE
:

185  
GOODNESS_CASE_FOUNDRY
;

188  
GOODNESS_NO_FOUNDRY
;

191 
	}
}

193 
	$föd_Ámûy_≥«…y
(c⁄° 
avaûabÀ_f⁄t
 *
have
,

194 c⁄° *
Ámûy
)

196 i‡–
Ámûy
 == 0 )

199 i‡–
have
->
Ámûy
 == 0 )

200  
GOODNESS_FAMILY_UNKNOWN
;

202  
	`°ªq
(
Ámûy
,
have
->family) ) {

203 
STREQ_EXACT
:

204  
GOODNESS_EXACT_FAMILY
;

206 
STREQ_CASE
:

207  
GOODNESS_CASE_FAMILY
;

210  
GOODNESS_NOMATCH_FAMILY
;

213 
	}
}

215 
	$föd_f⁄äame_≥«…y
(c⁄° 
avaûabÀ_f⁄t
 *
have
,

216 c⁄° *
f⁄äame
)

218  
	`°ªq
(
have
->
f⁄äame
,fontname) ) {

219 
STREQ_EXACT
:

220  
GOODNESS_EXACT_FONTNAME
;

222 
STREQ_CASE
:

223  
GOODNESS_CASE_FONTNAME
;

230 i‡–
have
->
Ámûy
 != 0 ) {

231  
	`°ªq
(
have
->
Ámûy
,
f⁄äame
) ) {

232 
STREQ_EXACT
:

233  
GOODNESS_EXACT_FONTFAMILY
;

235 
STREQ_CASE
:

236  
GOODNESS_CASE_FONTFAMILY
;

243  
GOODNESS_NO_FONTNAME
;

244 
	}
}

246 
	$föd_weight_≥«…y
(
PMWLOGFONT
 
w™t
, PMWLOGFONT 
have
)

248 
weight_diff
;

250 
weight_diff
 = 
w™t
->
lfWeight
 - 
have
->lfWeight;

251 i‡–
weight_diff
 < 0 )

252 
weight_diff
 = -weight_diff;

253  
weight_diff
 * 
GOODNESS_WEIGHT_DIFF
;

254 
	}
}

256 
	$föd_¶™t_≥«…y
(
PMWLOGFONT
 
w™t
, PMWLOGFONT 
have
)

260 i‡–!
w™t
->
lfIèlic
 && !w™t->
lfRom™
 && !w™t->
lfOblique
 ) {

262 i‡–
have
->
lfIèlic
 || have->
lfOblique
 )

263  
GOODNESS_CLOSE_SLANT
;

267 i‡–
w™t
->
lfIèlic
 && 
have
->lfItalic )

270 i‡–
w™t
->
lfRom™
 && 
have
->lfRoman )

273 i‡–
w™t
->
lfOblique
 && 
have
->lfOblique )

278 i‡–
w™t
->
lfIèlic
 && 
have
->
lfOblique
 )

279  
GOODNESS_CLOSE_SLANT
;

281 i‡–
w™t
->
lfOblique
 && 
have
->
lfIèlic
 )

282  
GOODNESS_CLOSE_SLANT
;

284  
GOODNESS_BAD_SLANT
;

285 
	}
}

287 
	$föd_•acög_≥«…y
(
PMWLOGFONT
 
w™t
, PMWLOGFONT 
have
)

289 i‡–
w™t
->
lfPr›‹ti⁄Æ
 && 
have
->lfProportional )

291 i‡–
w™t
->
lfM⁄o•a˚
 && 
have
->lfMonospace )

293 i‡–
w™t
->
lfM⁄o•a˚
 || w™t->
lfPr›‹ti⁄Æ
 )

294  
GOODNESS_WRONG_SPACING
;

297 
	}
}

299 
	$föd_£rif_≥«…y
(
PMWLOGFONT
 
w™t
, PMWLOGFONT 
have
)

301 i‡–!
w™t
->
lfSîif
 && !w™t->
lfS™sSîif
 )

303 i‡–
w™t
->
lfSîif
 && 
have
->lfSerif )

305 i‡–
w™t
->
lfS™sSîif
 && 
have
->lfSansSerif )

308  
GOODNESS_WRONG_SERIFSTYLE
;

309 
	}
}

311 
	$föd_smÆlˇps_≥«…y
(
PMWLOGFONT
 
w™t
, PMWLOGFONT 
have
)

313 i‡–!
w™t
->
lfSmÆlC≠s
 && !
have
->lfSmallCaps )

315 i‡–
w™t
->
lfSmÆlC≠s
 && 
have
->lfSmallCaps )

317 i‡–
w™t
->
lfSmÆlC≠s
 )

318  
GOODNESS_WANTED_SMALLCAPS_NOT_AVAILABLE
;

319  
GOODNESS_ONLY_SMALLCAPS_AVAILABLE
;

320 
	}
}

323 
	$ã°_f⁄t_good√ss
(c⁄° *
foundry
, c⁄° *
Ámûy
,

324 c⁄° *
f⁄äame
, c⁄° 
PMWLOGFONT
 
lf
,

325 
avaûabÀ_f⁄t
 *
af
,

326 
avaûabÀ_f⁄t
 **
be°
, *
good√ss
)

328 
≥«…y
 = 0;

330 
≥«…y
 +
	`föd_foundry_≥«…y
(
af
,
foundry
);

331 
≥«…y
 +
	`föd_Ámûy_≥«…y
(
af
,
Ámûy
);

334 i‡–
Ámûy
 == 0 )

335 
≥«…y
 +
	`föd_f⁄äame_≥«…y
(
af
,
f⁄äame
);

337 i‡–
lf
 != 0 ) {

339 
≥«…y
 +
	`föd_weight_≥«…y
(
lf
,&
af
->lf);

340 
≥«…y
 +
	`föd_¶™t_≥«…y
(
lf
,&
af
->lf);

341 
≥«…y
 +
	`föd_•acög_≥«…y
(
lf
,&
af
->lf);

342 
≥«…y
 +
	`föd_£rif_≥«…y
(
lf
,&
af
->lf);

343 
≥«…y
 +
	`föd_smÆlˇps_≥«…y
(
lf
,&
af
->lf);

347 i‡–*
good√ss
 < 0 || 
≥«…y
 < *goodness ) {

349 *
be°
 = 
af
;

350 *
good√ss
 = 
≥«…y
;

352 
	}
}

354 
avaûabÀ_f⁄t
 *
	$föd_suôabÀ_f⁄t
(c⁄° *
foundry
,

355 c⁄° *
f⁄äame
,

356 c⁄° 
PMWLOGFONT
 
∂ogf⁄t
)

358 
avaûabÀ_f⁄t
 *
af
, *
be°
;

359 *
Ámûy
;

360 
good√ss
;

371 
good√ss
 = -1;

372  
af
 = 
be°
 = 
Æl_f⁄ts
;á‡!0;á‡af->
√xt
 ) {

373 
	`ã°_f⁄t_«mög
(
foundry
,
f⁄äame
,
af
,&
be°
,&
good√ss
);

375 
Ámûy
 = 0;

376 i‡–
good√ss
 != -1 ) {

381 
Ámûy
 = 
be°
->family;

389 
good√ss
 = -1;

390  
af
 = 
be°
 = 
Æl_f⁄ts
;á‡!0;á‡af->
√xt
 ) {

391 
	`ã°_f⁄t_good√ss
(
foundry
,
Ámûy
,
f⁄äame
,
∂ogf⁄t
,
af
,

392 &
be°
,&
good√ss
);

395  
be°
;

396 
	}
}

405 
	$£À˘_f⁄t
(c⁄° 
PMWLOGFONT
 
∂ogf⁄t
, c⁄° **
phy¢ame
)

407 
avaûabÀ_f⁄t
 *
f⁄t
;

408 
‚dry
[128], *
foundry
;

409 c⁄° *
f⁄äame
;

410 *
tmp
;

411 
t
, 
comma
;

412 
f⁄t˛ass
 = 0;

413 
found_f⁄t
 = 0;

415 
f⁄äame
 = 
∂ogf⁄t
->
lfFa˚Name
;

417  
t
=0;Å < 20;Å++ ) {

421 
foundry
 = 
NULL
;

422 i‡–(
tmp
 = 
	`ödex
(
f⁄äame
,',')Ë!
NULL
 ) {

428 
comma
 = 
tmp
 - 
f⁄äame
;

429 
tmp
++;

430 
	`°∫˝y
(
‚dry
,
f⁄äame
,
comma
);

431 
‚dry
[
comma
] = '\0';

432 
foundry
 = 
‚dry
;

433 
f⁄äame
 = 
tmp
;

436 
f⁄t˛ass
 = 
	`decode_f⁄t_˛ass
(
foundry
);

438 i‡–
∂ogf⁄t
 =
NULL
 && 
f⁄t˛ass
 == 0 )

439 
f⁄t˛ass
 = 
MWLF_CLASS_BUILTIN
;

441 i‡–
f⁄t˛ass
 ) {

443 *
phy¢ame
 = 
f⁄äame
;

444  
f⁄t˛ass
;

447 i‡–
found_f⁄t
 ) {

452 
deÁu…_f⁄t
;

455 
f⁄t
 = 
	`föd_suôabÀ_f⁄t
(
foundry
,
f⁄äame
,
∂ogf⁄t
);

457 i‡–
f⁄t
 =
NULL
 ) {

458 
deÁu…_f⁄t
;

461 i‡–!
f⁄t
->
Æüs
 )

462 
found_f⁄t
 = 1;

464 
f⁄äame
 = 
f⁄t
->
lf
.
lfFa˚Name
;

467 
deÁu…_f⁄t
:

469 *
phy¢ame
 = 
MWFONT_SYSTEM_VAR
;

470  
MWLF_CLASS_BUILTIN
;

471 
	}
}

478 
	$GdCÀ¨F⁄tLi°
()

480 
avaûabÀ_f⁄t
 *
f⁄t
, *
√xt_f⁄t
;

482 
f⁄t
 = 
Æl_f⁄ts
;

483  
f⁄t
 != 0 ) {

484 
√xt_f⁄t
 = 
f⁄t
->
√xt
;

485 i‡–
f⁄t
->
foundry
 != 0 )

486 
	`‰ì
(
f⁄t
->
foundry
);

487 i‡–
f⁄t
->
Ámûy
 != 0 )

488 
	`‰ì
(
f⁄t
->
Ámûy
);

489 
	`‰ì
(
f⁄t
->
f⁄äame
);

490 
	`‰ì
(
f⁄t
);

491 
f⁄t
 = 
√xt_f⁄t
;

494 
Æl_f⁄ts
 = 0;

495 
	}
}

502 
	$GdAddF⁄t
(*
‚dry
, *
fmly
, *
f⁄äame
, 
PMWLOGFONT
 
lf
,

503 
Êags
)

505 
avaûabÀ_f⁄t
 *
f⁄t
, *
wÆk
;

506 
f⁄t˛ass
 = 0;

507 *
phy¢ame
 = 
lf
->
lfFa˚Name
;

509 i‡–!
	`°∫cmp
(
phy¢ame
,"T1,",3) ) {

510 #ifde‡
HAVE_T1LIB_SUPPORT


512 
phy¢ame
 += 3;

513 
f⁄t˛ass
 = 
MWLF_CLASS_T1LIB
;

514 
do_f⁄t
;

521 i‡–!
	`°∫cmp
(
phy¢ame
,"FT,",3) ) {

522 #i‡
HAVE_FREETYPE_SUPPORT
 || 
HAVE_FREETYPE_2_SUPPORT


524 
phy¢ame
 += 3;

525 
f⁄t˛ass
 = 
MWLF_CLASS_FREETYPE
;

526 
do_f⁄t
;

533 i‡–!
	`°∫cmp
(
phy¢ame
,"FT2,",4) ) {

534 #i‡
HAVE_FREETYPE_2_SUPPORT


536 
phy¢ame
 += 3;

537 
f⁄t˛ass
 = 
MWLF_CLASS_FREETYPE
;

538 
do_f⁄t
;

545 i‡–!
	`°∫cmp
(
phy¢ame
,"MWF,",4) ) {

547 
phy¢ame
 += 4;

548 
f⁄t˛ass
 = 
MWLF_CLASS_BUILTIN
;

549 
do_f⁄t
;

553 i‡–!(
Êags
 & 
MWLF_FLAGS_ALIAS
) )

556 
do_f⁄t
:

558 
f⁄t
 = 
	`mÆloc
((*font));

559 i‡–
f⁄t
 == 0 )

562 
f⁄t
->
foundry
 = 0;

563 i‡–
	`°rcmp
("-",
‚dry
) ) {

564 
f⁄t
->
foundry
 = 
	`°rdup
(
‚dry
);

565 i‡–
f⁄t
->
foundry
 == 0 ) {

566 
	`‰ì
(
f⁄t
);

571 
f⁄t
->
Ámûy
 = 0;

572 i‡–
	`°rcmp
("-",
fmly
) ) {

573 
f⁄t
->
Ámûy
 = 
	`°rdup
(
fmly
);

574 i‡–
f⁄t
->
Ámûy
 == 0 ) {

575 
	`‰ì
(
f⁄t
->
foundry
);

576 
	`‰ì
(
f⁄t
);

581 
f⁄t
->
f⁄äame
 = 
	`°rdup
(fontname);

582 i‡–
f⁄t
->
f⁄äame
 == 0 ) {

583 
	`‰ì
(
f⁄t
->
foundry
);

584 
	`‰ì
(
f⁄t
->
Ámûy
);

585 
	`‰ì
(
f⁄t
);

589 
	`mem˝y
(&
f⁄t
->
lf
,lf,(*lf));

591 
	`¥ötf
("Addög f⁄t: '%s' '%s' '%s' '%s'\n",
f⁄t
->
foundry
,

592 
f⁄t
->
Ámûy
,f⁄t->
f⁄äame
,f⁄t->
lf
.
lfFa˚Name
);

594 
f⁄t
->
√xt
 = 0;

595 
f⁄t
->
Æüs
 = (
Êags
 & 
MWLF_FLAGS_ALIAS
) ? 1 : 0;

596 
f⁄t
->
f⁄t˛ass
 = fontclass;

599 i‡–
Æl_f⁄ts
 == 0 ) {

600 
Æl_f⁄ts
 = 
f⁄t
;

602  
wÆk
 = 
Æl_f⁄ts
; wÆk->
√xt
 != 0; walk = walk->next )

604 
wÆk
->
√xt
 = 
f⁄t
;

608 
	}
}

614 
	$f⁄t_£t_light
(
PMWLOGFONT
 
lf
)

615 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_LIGHT
; 
	}
}

616 
	$f⁄t_£t_ªguœr
(
PMWLOGFONT
 
lf
)

617 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_REGULAR
; 
	}
}

618 
	$f⁄t_£t_medium
(
PMWLOGFONT
 
lf
)

619 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_MEDIUM
; 
	}
}

620 
	$f⁄t_£t_demibﬁd
(
PMWLOGFONT
 
lf
)

621 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_DEMIBOLD
; 
	}
}

622 
	$f⁄t_£t_bﬁd
(
PMWLOGFONT
 
lf
)

623 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_BOLD
; 
	}
}

624 
	$f⁄t_£t_bœck
(
PMWLOGFONT
 
lf
)

625 { 
lf
->
lfWeight
 = 
MWLF_WEIGHT_BLACK
; 
	}
}

627 
	$f⁄t_£t_ôÆic
(
PMWLOGFONT
 
lf
Ë{Üf->
lfIèlic
 = 1; 
	}
}

628 
	$f⁄t_£t_rom™
(
PMWLOGFONT
 
lf
Ë{Üf->
lfRom™
 = 1; 
	}
}

629 
	$f⁄t_£t_oblique
(
PMWLOGFONT
 
lf
Ë{Üf->
lfOblique
 = 1; 
	}
}

631 
	$f⁄t_£t_n‹mÆ
(
PMWLOGFONT
 
lf
)

632 { 
lf
->
lfPôch
 = 
MWLF_PITCH_NORMAL
; 
	}
}

633 
	$f⁄t_£t_£mic⁄dí£d
(
PMWLOGFONT
 
lf
)

634 { 
lf
->
lfPôch
 = 
MWLF_PITCH_SEMICONDENSED
; 
	}
}

635 
	$f⁄t_£t_c⁄dí£d
(
PMWLOGFONT
 
lf
)

636 { 
lf
->
lfPôch
 = 
MWLF_PITCH_CONDENSED
; 
	}
}

638 
	$f⁄t_£t_£rif
(
PMWLOGFONT
 
lf
Ë{Üf->
lfSîif
 = 1; 
	}
}

639 
	$f⁄t_£t_ßns£rif
(
PMWLOGFONT
 
lf
Ë{Üf->
lfS™sSîif
 = 1; 
	}
}

640 
	$f⁄t_£t_m⁄o•a˚
(
PMWLOGFONT
 
lf
Ë{Üf->
lfM⁄o•a˚
 = 1; 
	}
}

641 
	$f⁄t_£t_¥›‹ti⁄Æ
(
PMWLOGFONT
 
lf
Ë{Üf->
lfPr›‹ti⁄Æ
 = 1; 
	}
}

643 
	$c⁄fig_f⁄t
(*
fûe
, 
löe
, 
¨gc
, *
¨gv
[])

645 
Êags
 = 0;

646 
MWLOGFONT
 
lf
;

647 
tmp
[512];

648 *
p
, *
q
, *
‚dry
, *
Ámûy
, *
f⁄äame
;

649 
size
, 
t
;

652 *
«me
;

653 (*
fun˘i⁄
)(
PMWLOGFONT
 
lf
);

654 } 
©ås
[] = {

656 { "Light", 
f⁄t_£t_light
 },

657 { "Reguœr", 
f⁄t_£t_ªguœr
 },

658 { "Medium", 
f⁄t_£t_medium
 },

659 { "DemiBﬁd", 
f⁄t_£t_demibﬁd
 },

660 { "Demibﬁd", 
f⁄t_£t_demibﬁd
 },

661 { "Bﬁd", 
f⁄t_£t_bﬁd
 },

662 { "Bœck", 
f⁄t_£t_bœck
 },

665 { "Ièlic", 
f⁄t_£t_ôÆic
 },

666 { "Ièlics", 
f⁄t_£t_ôÆic
 },

667 { "Rom™", 
f⁄t_£t_rom™
 },

668 { "Oblique", 
f⁄t_£t_oblique
 },

671 { "N‹mÆ", 
f⁄t_£t_n‹mÆ
 },

672 { "Semic⁄dí£d", 
f⁄t_£t_£mic⁄dí£d
 },

673 { "C⁄dí£d", 
f⁄t_£t_c⁄dí£d
 },

676 { "Sîif", 
f⁄t_£t_£rif
 },

677 { "S™s-£rif", 
f⁄t_£t_ßns£rif
 },

678 { "M⁄o•a˚", 
f⁄t_£t_m⁄o•a˚
 },

679 { "Pr›‹ti⁄Æ", 
f⁄t_£t_¥›‹ti⁄Æ
 },

684 
	`MWLF_CÀ¨
(&
lf
);

686 i‡–
¨gc
 != 6 ) {

687 
	`Ârötf
(
°dîr
,"Bad f⁄àdes¸ùti⁄ %s:%d\n",
fûe
,
löe
);

691 i‡–!
	`°rcmp
("Æüs",
¨gv
[1]) ) {

692 
Êags
 |
MWLF_FLAGS_ALIAS
;

693 
‚dry
 = "-";

695 
‚dry
 = 
¨gv
[1];

698 
Ámûy
 = 
¨gv
[2];

699 
f⁄äame
 = 
¨gv
[3];

700 
	`°r˝y
(
lf
.
lfFa˚Name
,
¨gv
[5]);

701 
p
 = 
¨gv
[4];

703  *
p
 != '\0' ) {

705 
q
 = 
	`°rchr
(
p
,',');

706 i‡–
q
 != 0 ) {

707 
size
 = 
q
 - 
p
;

708 
	`°∫˝y
(
tmp
,
p
,
size
);

709 
tmp
[
size
] = '\0';

710 
p
 = 
q
 + 1;

712 
	`°r˝y
(
tmp
,
p
);

713 
p
 +
	`°æí
(
tmp
);

716  
t
 = 0; 
©ås
[t].
«me
 != 0;Å++ ) {

717 i‡–!
	`°rcmp
(
©ås
[
t
].
«me
,
tmp
) ) {

718 
©ås
[
t
].
	`fun˘i⁄
(&
lf
);

719 
√xt
;

723 
	`Ârötf
(
°dîr
,"No such fontáttribute '%s' in %s:%d\n",

724 
tmp
,
fûe
,
löe
);

727 
√xt
: ;

730 
	`GdAddF⁄t
(
‚dry
,
Ámûy
,
f⁄äame
,&
lf
,
Êags
);

733 
	}
}

742 
	$c⁄fig_löe
(*
fûe
, 
löe
, 
¨gc
, *
¨gv
[])

744 i‡–!
¨gc
 )

747 i‡–
¨gv
[0][0] == '#' )

750 i‡–!
	`°rcmp
("f⁄t", 
¨gv
[0]) )

751  
	`c⁄fig_f⁄t
(
fûe
,
löe
,
¨gc
,
¨gv
);

753 i‡–!
	`°rcmp
("˛ór-f⁄ts", 
¨gv
[0]) ) {

754 
	`GdCÀ¨F⁄tLi°
();

759 
	}
}

765 
	#MAXCONFIGLINESIZE
 1024

	)

766 
	#MAXCONFIGELEMENTS
 64

	)

768 
	$ªad_c⁄figfûe
(*
fûe
)

770 
FILE
 *
cf
;

771 
buf„r
[
MAXCONFIGLINESIZE
+1];

772 *
¨gs
[
MAXCONFIGELEMENTS
+1];

773 *
p
;

774 
¨gc
, 
s
, 
rc
, 
t
, 
löe
;

776 i‡–(
cf
 = 
	`f›í
(
fûe
,"r")) == 0 ) {

777 
	`Ârötf
(
°dîr
,"U«bÀÅÿªad c⁄fig fûê'%s'\n",
fûe
);

781 
löe
 = 0;

782  !
	`„of
(
cf
) ) {

783 i‡–
	`fgës
(
buf„r
,1000,
cf
) == 0 )

785 
löe
++;

786 
s
 = 
	`°æí
(
buf„r
) - 1;

787  
s
 >0 && 
buf„r
[s] == '\n' )

788 
buf„r
[
s
--] = '\0';

789 
p
 = (*)
buf„r
;

790 
¨gc
 = 0;

791  
t
=0;Å < 
MAXCONFIGELEMENTS
;Å++ ) {

792  *
p
 !'\0' && 
	`is•a˚
(*p) )

793 
p
++;

794 i‡–*
p
 == '\"' ) {

796 
p
++;

797 
¨gs
[
t
] = 
p
;

798 
¨gc
++;

799  *
p
 != '\0' && *p != '\"' )

800 
p
++;

801 i‡–*
p
 == '\0' ) {

802 
	`Ârötf
(
°dîr
,"Unbalanced quotes in %s:%d\n",

803 
fûe
,
löe
);

806 *
p
++ = '\0';

808 i‡–*
p
 == '\0' )

810 
¨gs
[
t
] = 
p
;

811 
¨gc
++;

812  *
p
 !'\0' && !
	`is•a˚
(*p) )

813 
p
++;

814 *
p
++ = '\0';

819 
t
;

820  
t
=0;Å < 
¨gc
;Å++ )

821 
	`¥ötf
("#%d: '%s'\n",
t
,
¨gs
[t]);

824 
rc
 = 
	`c⁄fig_löe
(
fûe
, 
löe
, 
¨gc
, 
¨gs
);

825 i‡–
rc
 < 0 )

826  
rc
;

829 
	`f˛o£
(
cf
);

832 
	}
}

	@fonts/convbdf.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<°rög.h
>

13 
	~<time.h
>

17 
	#VERSION
 "RB11"

	)

20 
	#MWIMAGE_WORDS
(
x
Ë(((x)+15)/16Ë

	)

21 
	#MWIMAGE_BYTES
(
x
Ë(
	`MWIMAGE_WORDS
(x)*(
MWIMAGEBITS
))

	)

22 
	#MWIMAGE_BITSPERIMAGE
 ((
MWIMAGEBITS
Ë* 8)

	)

23 
	#MWIMAGE_BITVALUE
(
n
Ë((
MWIMAGEBITS
Ë(((MWIMAGEBITSË1Ë<< (n)))

	)

24 
	#MWIMAGE_FIRSTBIT
 (
	`MWIMAGE_BITVALUE
(
MWIMAGE_BITSPERIMAGE
 - 1))

	)

25 
	#MWIMAGE_TESTBIT
(
m
Ë((mË& 
MWIMAGE_FIRSTBIT
)

	)

26 
	#MWIMAGE_SHIFTBIT
(
m
Ë((
MWIMAGEBITS
Ë((mË<< 1))

	)

28 
	tMWIMAGEBITS
;

33 * 
	m«me
;

34 
	mmaxwidth
;

35 
	mheight
;

36 
	mas˚¡
;

37 
	mfú°ch¨
;

38 
	msize
;

39 
MWIMAGEBITS
 * 
	mbôs
;

40 * 
	moff£t
;

41 * 
	mwidth
;

42 
	mdeÁu…ch¨
;

43 
	mbôs_size
;

46 * 
	mÁ˚«me
;

47 * 
	mc›yright
;

48 
	mpixñ_size
;

49 
	mdes˚¡
;

50 
	mfbbw
, 
	mfbbh
, 
	mfbbx
, 
	mfbby
;

51 } 
	tMWCFONT
, *
	tPMWCFONT
;

54 
	#i•ªfix
(
buf
,
°r
Ë(!
	`°∫cmp
(buf, så, 
	`°æí
(°r)))

	)

55 
	#°ªquÆ
(
s1
,
s2
Ë(!
	`°rcmp
(s1, s2))

	)

57 
	#EXTRA
 300

	)

59 
	ggí_c
 = 0;

60 
	ggí_‚t
 = 0;

61 
	ggí_m≠
 = 1;

62 
	g°¨t_ch¨
 = 0;

63 
	glimô_ch¨
 = 65535;

64 
	goÊag
 = 0;

65 
	goutfûe
[256];

67 
ußge
();

68 
gë›ts
(*
∑c
, ***
∑v
);

69 
c⁄vbdf
(*
∑th
);

71 
‰ì_f⁄t
(
PMWCFONT
 
pf
);

72 
PMWCFONT
 
bdf_ªad_f⁄t
(*
∑th
);

73 
bdf_ªad_hódî
(
FILE
 *
Â
, 
PMWCFONT
 
pf
);

74 
bdf_ªad_bôm≠s
(
FILE
 *
Â
, 
PMWCFONT
 
pf
);

75 * 
bdf_gëlöe
(
FILE
 *
Â
, *
buf
, 
Àn
);

76 
MWIMAGEBITS
 
bdf_hexvÆ
(*
buf
, 
ndx1
, 
ndx2
);

78 
gí_c_sour˚
(
PMWCFONT
 
pf
, *
∑th
);

79 
gí_‚t_fûe
(
PMWCFONT
 
pf
, *
∑th
);

82 
	$ußge
()

84 
hñp
[] = {

95 
	`Ârötf
(
°dîr
, 
hñp
);

96 
	}
}

100 
	$gë›ts
(*
∑c
, ***
∑v
)

102 *
p
;

103 **
av
;

104 
ac
;

106 
ac
 = *
∑c
;

107 
av
 = *
∑v
;

108 
ac
 > 0 && 
av
[0][0] == '-') {

109 
p
 = &
av
[0][1];

110  *
p
)

111 *
p
++) {

113  *
p
 && *p == ' ')

114 
p
++;

115 if–*
p
++ != '-')

116 
p
 = "";

119 
gí_c
 = 1;

122 
gí_‚t
 = 1;

125 
gí_m≠
 = 0;

128 
oÊag
 = 1;

129 i‡(*
p
) {

130 
	`°r˝y
(
outfûe
, 
p
);

131 *
p
 && *p != ' ')

132 
p
++;

134 
av
++; 
ac
--;

135 i‡(
ac
 > 0)

136 
	`°r˝y
(
outfûe
, 
av
[0]);

140 i‡(*
p
) {

141 
limô_ch¨
 = 
	`©oi
(
p
);

142 *
p
 && *p != ' ')

143 
p
++;

145 
av
++; 
ac
--;

146 i‡(
ac
 > 0)

147 
limô_ch¨
 = 
	`©oi
(
av
[0]);

151 i‡(*
p
) {

152 
°¨t_ch¨
 = 
	`©oi
(
p
);

153 *
p
 && *p != ' ')

154 
p
++;

156 
av
++; 
ac
--;

157 i‡(
ac
 > 0)

158 
°¨t_ch¨
 = 
	`©oi
(
av
[0]);

162 
	`Ârötf
(
°dîr
, "Unknow¿›ti⁄ ign‹ed: %c\r\n", *(
p
-1));

164 ++
av
; --
ac
;

166 *
∑c
 = 
ac
;

167 *
∑v
 = 
av
;

168 
	}
}

172 
	$ba£«me
(*
∑th
)

174 *
p
, *
b
;

175 
ba£
[256];

178 
b
 = 
∑th
;

179 
p
=
∑th
; *p; ++p) {

180 i‡(*
p
 == '/')

181 
b
 = 
p
 + 1;

183 
	`°r˝y
(
ba£
, 
b
);

184 
p
=
ba£
; *p; ++p) {

185 i‡(*
p
 == '.') {

186 *
p
 = 0;

190  
ba£
;

191 
	}
}

194 
	$c⁄vbdf
(*
∑th
)

196 
PMWCFONT
 
pf
;

197 
ªt
 = 0;

199 
pf
 = 
	`bdf_ªad_f⁄t
(
∑th
);

200 i‡(!
pf
)

201 
	`exô
(1);

203 i‡(
gí_c
) {

204 i‡(!
oÊag
) {

205 
	`°r˝y
(
outfûe
, 
	`ba£«me
(
∑th
));

206 
	`°rˇt
(
outfûe
, ".c");

208 
ªt
 |
	`gí_c_sour˚
(
pf
, 
outfûe
);

211 i‡(
gí_‚t
) {

212 i‡(!
oÊag
) {

213 
	`°r˝y
(
outfûe
, 
	`ba£«me
(
∑th
));

214 
	`°rˇt
(
outfûe
, ".fnt");

216 
ªt
 |
	`gí_‚t_fûe
(
pf
, 
outfûe
);

219 
	`‰ì_f⁄t
(
pf
);

220  
ªt
;

221 
	}
}

224 
	$maö
(
ac
, **
av
)

226 
ªt
 = 0;

228 ++
av
; --
ac
;

229 
	`gë›ts
(&
ac
, &
av
);

231 i‡(
ac
 < 1 || (!
gí_c
 && !
gí_‚t
)) {

232 
	`ußge
();

233 
	`exô
(1);

235 i‡(
oÊag
) {

236 i‡(
ac
 > 1 || (
gí_c
 && 
gí_‚t
)) {

237 
	`ußge
();

238 
	`exô
(1);

242 
ac
 > 0) {

243 
ªt
 |
	`c⁄vbdf
(
av
[0]);

244 ++
av
; --
ac
;

247 
	`exô
(
ªt
);

248 
	}
}

252 
	$‰ì_f⁄t
(
PMWCFONT
 
pf
)

254 i‡(!
pf
)

256 i‡(
pf
->
«me
)

257 
	`‰ì
(
pf
->
«me
);

258 i‡(
pf
->
Á˚«me
)

259 
	`‰ì
(
pf
->
Á˚«me
);

260 i‡(
pf
->
bôs
)

261 
	`‰ì
(
pf
->
bôs
);

262 i‡(
pf
->
off£t
)

263 
	`‰ì
(
pf
->
off£t
);

264 i‡(
pf
->
width
)

265 
	`‰ì
(
pf
->
width
);

266 
	`‰ì
(
pf
);

267 
	}
}

270 
PMWCFONT


271 
	$bdf_ªad_f⁄t
(*
∑th
)

273 
FILE
 *
Â
;

274 
PMWCFONT
 
pf
;

276 
Â
 = 
	`f›í
(
∑th
, "rb");

277 i‡(!
Â
) {

278 
	`Ârötf
(
°dîr
, "Eº‹ o≥nög fûe: %s\n", 
∑th
);

279  
NULL
;

282 
pf
 = (
PMWCFONT
)
	`ˇŒoc
(1, (
MWCFONT
));

283 i‡(!
pf
)

284 
îrout
;

286 
pf
->
«me
 = 
	`°rdup
(
	`ba£«me
(
∑th
));

288 i‡(!
	`bdf_ªad_hódî
(
Â
, 
pf
)) {

289 
	`Ârötf
(
°dîr
, "ErrorÑeading font header\n");

290 
îrout
;

293 i‡(!
	`bdf_ªad_bôm≠s
(
Â
, 
pf
)) {

294 
	`Ârötf
(
°dîr
, "ErrorÑeading font bitmaps\n");

295 
îrout
;

298 
	`f˛o£
(
Â
);

299  
pf
;

301 
îrout
:

302 
	`f˛o£
(
Â
);

303 
	`‰ì_f⁄t
(
pf
);

304  
NULL
;

305 
	}
}

309 
	$bdf_ªad_hódî
(
FILE
 *
Â
, 
PMWCFONT
 
pf
)

311 
ícodög
;

312 
nch¨s
, 
maxwidth
;

313 
fú°ch¨
 = 65535;

314 
œ°ch¨
 = -1;

315 
buf
[256];

316 
Á˚«me
[256];

317 
c›yright
[256];

320 
pf
->
deÁu…ch¨
 = -1;

321 
pf
->
as˚¡
 = -1;

322 
pf
->
des˚¡
 = -1;

325 i‡(!
	`bdf_gëlöe
(
Â
, 
buf
, (buf))) {

326 
	`Ârötf
(
°dîr
, "Error: EOF on file\n");

329 i‡(
	`i•ªfix
(
buf
, "FONT ")) {

330 i‡(
	`ssˇnf
(
buf
, "FONT %[^\n]", 
Á˚«me
) != 1) {

331 
	`Ârötf
(
°dîr
, "Error: bad 'FONT'\n");

334 
pf
->
Á˚«me
 = 
	`°rdup
(facename);

337 i‡(
	`i•ªfix
(
buf
, "COPYRIGHT ")) {

338 i‡(
	`ssˇnf
(
buf
, "COPYRIGHT \"%[^\"]", 
c›yright
) != 1) {

339 
	`Ârötf
(
°dîr
, "Error: bad 'COPYRIGHT'\n");

342 
pf
->
c›yright
 = 
	`°rdup
(copyright);

345 i‡(
	`i•ªfix
(
buf
, "DEFAULT_CHAR ")) {

346 i‡(
	`ssˇnf
(
buf
, "DEFAULT_CHAR %d", &
pf
->
deÁu…ch¨
) != 1) {

347 
	`Ârötf
(
°dîr
, "Error: bad 'DEFAULT_CHAR'\n");

351 i‡(
	`i•ªfix
(
buf
, "FONT_DESCENT ")) {

352 i‡(
	`ssˇnf
(
buf
, "FONT_DESCENT %d", &
pf
->
des˚¡
) != 1) {

353 
	`Ârötf
(
°dîr
, "Error: bad 'FONT_DESCENT'\n");

358 i‡(
	`i•ªfix
(
buf
, "FONT_ASCENT ")) {

359 i‡(
	`ssˇnf
(
buf
, "FONT_ASCENT %d", &
pf
->
as˚¡
) != 1) {

360 
	`Ârötf
(
°dîr
, "Error: bad 'FONT_ASCENT'\n");

365 i‡(
	`i•ªfix
(
buf
, "FONTBOUNDINGBOX ")) {

366 i‡(
	`ssˇnf
(
buf
, "FONTBOUNDINGBOX %d %d %d %d",

367 &
pf
->
fbbw
, &pf->
fbbh
, &pf->
fbbx
, &pf->
fbby
) != 4) {

368 
	`Ârötf
(
°dîr
, "Error: bad 'FONTBOUNDINGBOX'\n");

373 i‡(
	`i•ªfix
(
buf
, "CHARS ")) {

374 i‡(
	`ssˇnf
(
buf
, "CHARS %d", &
nch¨s
) != 1) {

375 
	`Ârötf
(
°dîr
, "Error: bad 'CHARS'\n");

386 i‡(
	`i•ªfix
(
buf
, "ENCODING ")) {

387 i‡(
	`ssˇnf
(
buf
, "ENCODING %d", &
ícodög
) != 1) {

388 
	`Ârötf
(
°dîr
, "Error: bad 'ENCODING'\n");

391 i‡(
ícodög
 >0 &&Éncodög <
limô_ch¨
 &&Éncodög >
°¨t_ch¨
) {

392 i‡(
fú°ch¨
 > 
ícodög
)

393 
fú°ch¨
 = 
ícodög
;

394 i‡(
œ°ch¨
 < 
ícodög
)

395 
œ°ch¨
 = 
ícodög
;

399 i‡(
	`°ªquÆ
(
buf
, "ENDFONT"))

404 i‡(
pf
->
as˚¡
 < 0 ||Öf->
des˚¡
 < 0 || 
fú°ch¨
 < 0) {

405 
	`Ârötf
(
°dîr
, "Error: Invalid BDF file,Ñequires FONT_ASCENT/FONT_DESCENT/ENCODING\n");

408 
pf
->
height
 =Öf->
as˚¡
 +Öf->
des˚¡
;

411 i‡(
pf
->
deÁu…ch¨
 < 0 ||Öf->deÁu…ch¨ < 
fú°ch¨
 ||

412 
pf
->
deÁu…ch¨
 > 
limô_ch¨
)

413 
pf
->
deÁu…ch¨
 = 
fú°ch¨
;

416 
pf
->
fú°ch¨
 = firstchar;

417 
pf
->
size
 = 
œ°ch¨
 - 
fú°ch¨
 + 1;

421 
maxwidth
 = 
pf
->
fbbw
;

424 
pf
->
bôs_size
 = 
nch¨s
 * 
	`MWIMAGE_WORDS
(
maxwidth
Ë*Öf->
height
;

427 
pf
->
bôs
 = (
MWIMAGEBITS
 *)
	`mÆloc
’f->
bôs_size
 * (MWIMAGEBITSË+ 
EXTRA
);

428 
pf
->
off£t
 = (*)
	`mÆloc
’f->
size
 * ());

429 
pf
->
width
 = (*)
	`mÆloc
’f->
size
 * ());

431 i‡(!
pf
->
bôs
 || !pf->
off£t
 || !pf->
width
) {

432 
	`Ârötf
(
°dîr
, "Error:Ço memory for fontÜoad\n");

437 
	}
}

441 
	$bdf_ªad_bôm≠s
(
FILE
 *
Â
, 
PMWCFONT
 
pf
)

443 
ofs
 = 0;

444 
maxwidth
 = 0;

445 
i
, 
k
, 
ícodög
, 
width
;

446 
bbw
, 
bbh
, 
bbx
, 
bby
;

447 
¥›‹ti⁄Æ
 = 0;

448 
ícodëabÀ
 = 0;

449 
l
;

450 
buf
[256];

453 
	`f£ek
(
Â
, 0L, 
SEEK_SET
);

456 
i
=0; i<
pf
->
size
; ++i)

457 
pf
->
off£t
[
i
] = -1;

460 i‡(!
	`bdf_gëlöe
(
Â
, 
buf
, (buf))) {

461 
	`Ârötf
(
°dîr
, "Error: EOF on file\n");

464 i‡(
	`i•ªfix
(
buf
, "STARTCHAR")) {

465 
ícodög
 = 
width
 = 
bbw
 = 
bbh
 = 
bbx
 = 
bby
 = -1;

468 i‡(
	`i•ªfix
(
buf
, "ENCODING ")) {

469 i‡(
	`ssˇnf
(
buf
, "ENCODING %d", &
ícodög
) != 1) {

470 
	`Ârötf
(
°dîr
, "Error: bad 'ENCODING'\n");

473 i‡(
ícodög
 < 
°¨t_ch¨
 ||Éncodög > 
limô_ch¨
)

474 
ícodög
 = -1;

477 i‡(
	`i•ªfix
(
buf
, "DWIDTH ")) {

478 i‡(
	`ssˇnf
(
buf
, "DWIDTH %d", &
width
) != 1) {

479 
	`Ârötf
(
°dîr
, "Error: bad 'DWIDTH'\n");

483 i‡(
width
 <= 0)

484 
width
 = 
pf
->
fbbw
 -Öf->
fbbx
;

487 i‡(
	`i•ªfix
(
buf
, "BBX ")) {

488 i‡(
	`ssˇnf
(
buf
, "BBX %d %d %d %d", &
bbw
, &
bbh
, &
bbx
, &
bby
) != 4) {

489 
	`Ârötf
(
°dîr
, "Error: bad 'BBX'\n");

494 i‡(
	`°ªquÆ
(
buf
, "BITMAP")) {

495 
MWIMAGEBITS
 *
ch_bôm≠
 = 
pf
->
bôs
 + 
ofs
;

496 
ch_w‹ds
;

498 i‡(
ícodög
 < 0)

502 i‡(
pf
->
off£t
[
ícodög
-pf->
fú°ch¨
] != ()-1) {

503 
	`Ârötf
(
°dîr
, "Error: duplicateÉncoding for character %d (0x%02x), ignoring duplicate\n",

504 
ícodög
,Éncoding);

507 
pf
->
off£t
[
ícodög
-pf->
fú°ch¨
] = 
ofs
;

510 i‡(
bbx
 < 0) {

511 
width
 -
bbx
;

514 
bbx
 = 0;

516 i‡(
width
 > 
maxwidth
)

517 
maxwidth
 = 
width
;

518 
pf
->
width
[
ícodög
-pf->
fú°ch¨
] = width;

521 
	`mem£t
(
ch_bôm≠
, 0, 
	`MWIMAGE_BYTES
(
width
Ë* 
pf
->
height
);

523 
ch_w‹ds
 = 
	`MWIMAGE_WORDS
(
width
);

524 
	#BM
(
row
,
cﬁ
Ë(*(
ch_bôm≠
 + (‘ow)*
ch_w‹ds
Ë+ (cﬁ)))

	)

525 
	#MWIMAGE_NIBBLES
 (
MWIMAGE_BITSPERIMAGE
/4)

	)

528 
i
=0; ; ++i) {

529 
hexnibbÀs
;

531 i‡(!
	`bdf_gëlöe
(
Â
, 
buf
, (buf))) {

532 
	`Ârötf
(
°dîr
, "Error: EOFÑeading BITMAP data\n");

535 i‡(
	`i•ªfix
(
buf
, "ENDCHAR"))

538 
hexnibbÀs
 = 
	`°æí
(
buf
);

539 
k
=0; k<
ch_w‹ds
; ++k) {

540 
ndx
 = 
k
 * 
MWIMAGE_NIBBLES
;

541 
∑dnibbÀs
 = 
hexnibbÀs
 - 
ndx
;

542 
MWIMAGEBITS
 
vÆue
;

544 i‡(
∑dnibbÀs
 <= 0)

546 i‡(
∑dnibbÀs
 >
MWIMAGE_NIBBLES
)

547 
∑dnibbÀs
 = 0;

549 
vÆue
 = 
	`bdf_hexvÆ
((*)
buf
,

550 
ndx
,Çdx+
MWIMAGE_NIBBLES
-1-
∑dnibbÀs
);

551 
vÆue
 <<
∑dnibbÀs
 * 
MWIMAGE_NIBBLES
;

553 
	`BM
(
pf
->
height
 -Öf->
des˚¡
 - 
bby
 - 
bbh
 + 
i
, 
k
) |=

554 
vÆue
 >> 
bbx
;

556 i‡(
bbx
) {

557 
	`BM
(
pf
->
height
 -Öf->
des˚¡
 - 
bby
 - 
bbh
 + 
i
, 
k
+1) =

558 
vÆue
 << (
MWIMAGE_BITSPERIMAGE
 - 
bbx
);

563 
ofs
 +
	`MWIMAGE_WORDS
(
width
Ë* 
pf
->
height
;

567 i‡(
	`°ªquÆ
(
buf
, "ENDFONT"))

572 
pf
->
maxwidth
 = maxwidth;

575 
i
=0; i<
pf
->
size
; ++i) {

576 
defch¨
 = 
pf
->
deÁu…ch¨
 -Öf->
fú°ch¨
;

578 i‡(
pf
->
off£t
[
i
] == ()-1) {

579 
pf
->
off£t
[
i
] =Öf->off£t[
defch¨
];

580 
pf
->
width
[
i
] =Öf->width[
defch¨
];

585 
l
 = 0;

586 
i
=0; i<
pf
->
size
; ++i) {

587 i‡(
pf
->
off£t
[
i
] !
l
) {

588 
ícodëabÀ
 = 1;

591 
l
 +
	`MWIMAGE_WORDS
(
pf
->
width
[
i
]Ë*Öf->
height
;

593 i‡(!
ícodëabÀ
) {

594 
	`‰ì
(
pf
->
off£t
);

595 
pf
->
off£t
 = 
NULL
;

599 
i
=0; i<
pf
->
size
; ++i) {

600 i‡(
pf
->
width
[
i
] !
maxwidth
) {

601 
¥›‹ti⁄Æ
 = 1;

605 i‡(!
¥›‹ti⁄Æ
) {

606 
	`‰ì
(
pf
->
width
);

607 
pf
->
width
 = 
NULL
;

611 i‡(
ofs
 < 
pf
->
bôs_size
) {

612 
pf
->
bôs
 = 
	`ªÆloc
’f->bôs, 
ofs
 * (
MWIMAGEBITS
));

613 
pf
->
bôs_size
 = 
ofs
;

614 } i‡(
ofs
 > 
pf
->
bôs_size
) {

615 
	`Ârötf
(
°dîr
, "Warning: DWIDTH spec > max FONTBOUNDINGBOX\n");

616 i‡(
ofs
 > 
pf
->
bôs_size
+
EXTRA
) {

617 
	`Ârötf
(
°dîr
, "Error: NotÉnough bits initiallyállocated\n");

620 
pf
->
bôs_size
 = 
ofs
;

624 
	}
}

628 
	$bdf_gëlöe
(
FILE
 *
Â
, *
buf
, 
Àn
)

630 
c
;

631 *
b
;

634 
b
 = 
buf
;

635 (
c
 = 
	`gëc
(
Â
)Ë!
EOF
) {

636 i‡(
c
 == '\r')

638 i‡(
c
 == '\n')

640 i‡(
b
 - 
buf
 >(
Àn
 - 1))

642 *
b
++ = 
c
;

644 *
b
 = '\0';

645 i‡(
c
 =
EOF
 && 
b
 =
buf
)

646  
NULL
;

647 i‡(
b
 !
buf
 && !
	`i•ªfix
(buf, "COMMENT"))

650  
buf
;

651 
	}
}

654 
MWIMAGEBITS


655 
	$bdf_hexvÆ
(*
buf
, 
ndx1
, 
ndx2
)

657 
MWIMAGEBITS
 
vÆ
 = 0;

658 
i
, 
c
;

660 
i
=
ndx1
; i<=
ndx2
; ++i) {

661 
c
 = 
buf
[
i
];

662 i‡(
c
 >= '0' && c <= '9')

663 
c
 -= '0';

664 i‡(
c
 >= 'A' && c <= 'F')

665 
c
 = c - 'A' + 10;

666 i‡(
c
 >= 'a' && c <= 'f')

667 
c
 = c - 'a' + 10;

668 
c
 = 0;

669 
vÆ
 = (vÆ << 4Ë| 
c
;

671  
vÆ
;

672 
	}
}

676 
	$gí_c_sour˚
(
PMWCFONT
 
pf
, *
∑th
)

678 
FILE
 *
oÂ
;

679 
i
;

680 
did_deÁu…ch¨
 = 0;

681 
did_syncmsg
 = 0;

682 
time_t
 
t
 = 
	`time
(0);

683 
MWIMAGEBITS
 *
ofs
 = 
pf
->
bôs
;

684 
buf
[256];

685 
obuf
[256];

686 
hdr1
[] = {

708 
oÂ
 = 
	`f›í
(
∑th
, "w");

709 i‡(!
oÂ
) {

710 
	`Ârötf
(
°dîr
, "C™'à¸óã %s\n", 
∑th
);

713 
	`Ârötf
(
°dîr
, "Gíî©ög %s\n", 
∑th
);

715 
	`°r˝y
(
buf
, 
	`˘ime
(&
t
));

716 
buf
[
	`°æí
(buf)-1] = 0;

718 
	`Ârötf
(
oÂ
, 
hdr1
, 
buf
,

719 
pf
->
«me
,

720 
pf
->
Á˚«me
?Öf->facename: "",

721 
pf
->
maxwidth
,Öf->
height
,

722 
pf
->
size
,

723 
pf
->
as˚¡
,Öf->
des˚¡
,

724 
pf
->
fú°ch¨
,Öf->firstchar,

725 
pf
->
fú°ch¨
+pf->
size
-1,Öf->firstchar+pf->size-1,

726 
pf
->
deÁu…ch¨
,Öf->defaultchar,

727 
pf
->
width
? "yes": "no",

728 
pf
->
c›yright
?Öf->copyright: "",

729 
pf
->
«me
);

732 
i
=0; i<
pf
->
size
; ++i) {

733 
x
;

734 
bôcou¡
 = 0;

735 
width
 = 
pf
->width ?Öf->width[
i
] :Öf->
maxwidth
;

736 
height
 = 
pf
->height;

737 
MWIMAGEBITS
 *
bôs
 = 
pf
->bô†+ (pf->
off£t
?Öf->off£t[
i
]: (
height
 * i));

738 
MWIMAGEBITS
 
bôvÆue
;

745 i‡(
pf
->
off£t
 && (pf->off£t[
i
] =pf->off£t[pf->
deÁu…ch¨
-pf->
fú°ch¨
])) {

746 i‡(
did_deÁu…ch¨
)

748 
did_deÁu…ch¨
 = 1;

751 
	`Ârötf
(
oÂ
, "\n/* Character %d (0x%02x):\n width %d",

752 
i
+
pf
->
fú°ch¨
, i+pf->fú°ch¨, 
width
);

754 i‡(
gí_m≠
) {

755 
	`Ârötf
(
oÂ
, "\n +");

756 
x
=0; x<
width
; ++xË
	`Ârötf
(
oÂ
, "-");

757 
	`Ârötf
(
oÂ
, "+\n");

759 
x
 = 0;

760 
height
 > 0) {

761 i‡(
x
 =0Ë
	`Ârötf
(
oÂ
, " |");

763 i‡(
bôcou¡
 <= 0) {

764 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

765 
bôvÆue
 = *
bôs
++;

768 
	`Ârötf
(
oÂ
, 
	`MWIMAGE_TESTBIT
(
bôvÆue
)? "*": " ");

770 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT
(bitvalue);

771 --
bôcou¡
;

772 i‡(++
x
 =
width
) {

773 
	`Ârötf
(
oÂ
, "|\n");

774 --
height
;

775 
x
 = 0;

776 
bôcou¡
 = 0;

779 
	`Ârötf
(
oÂ
, " +");

780 
x
=0; x<
width
; ++xË
	`Ârötf
(
oÂ
, "-");

781 
	`Ârötf
(
oÂ
, "+ */\n");

783 
	`Ârötf
(
oÂ
, " */\n");

785 
bôs
 = 
pf
->bô†+ (pf->
off£t
?Öf->off£t[
i
]: (pf->
height
 * i));

786 
x
=
	`MWIMAGE_WORDS
(
width
)*
pf
->
height
; x>0; --x) {

787 
	`Ârötf
(
oÂ
, "0x%04x,\n", *
bôs
);

788 i‡(!
did_syncmsg
 && *
bôs
++ !*
ofs
++) {

789 
	`Ârötf
(
°dîr
, "Warning: foundÉncoding values inÇon-sorted order (notánÉrror).\n");

790 
did_syncmsg
 = 1;

794 
	`Ârötf
(
oÂ
, "};\n\n");

796 i‡(
pf
->
off£t
) {

798 
	`Ârötf
(
oÂ
, "/* Character->glyph mapping. */\n"

800 
pf
->
«me
);

802 
i
=0; i<
pf
->
size
; ++i)

803 
	`Ârötf
(
oÂ
, " %ld,\t/* (0x%02xË*/\n", 
pf
->
off£t
[
i
], i+pf->
fú°ch¨
);

804 
	`Ârötf
(
oÂ
, "};\n\n");

808 i‡(
pf
->
width
) {

809 
	`Ârötf
(
oÂ
, "/* Character width data. */\n"

811 
pf
->
«me
);

813 
i
=0; i<
pf
->
size
; ++i)

814 
	`Ârötf
(
oÂ
, " %d,\t/* (0x%02xË*/\n", 
pf
->
width
[
i
], i+pf->
fú°ch¨
);

815 
	`Ârötf
(
oÂ
, "};\n\n");

819 i‡(
pf
->
off£t
)

820 
	`•rötf
(
obuf
, "_%s_off£t,", 
pf
->
«me
);

821 
	`•rötf
(
obuf
, "0, /*ÇoÉncodeÅable*/");

822 i‡(
pf
->
width
)

823 
	`•rötf
(
buf
, "_%s_width,", 
pf
->
«me
);

824 
	`•rötf
(
buf
, "0, /* fixed width*/");

825 
	`Ârötf
(
oÂ
, "/* Exported structure definition. */\n"

839 
pf
->
«me
,Öf->name,

840 
pf
->
maxwidth
,Öf->
height
,

841 
pf
->
as˚¡
,

842 
pf
->
fú°ch¨
,

843 
pf
->
size
,

844 
pf
->
«me
,

845 
obuf
,

846 
buf
,

847 
pf
->
deÁu…ch¨
,

848 
pf
->
«me
);

851 
	}
}

854 
	$WRITEBYTE
(
FILE
 *
Â
, 
c
)

856  
	`putc
(
c
, 
Â
Ë!
EOF
;

857 
	}
}

860 
	$WRITESHORT
(
FILE
 *
Â
, 
s
)

862 
	`putc
(
s
, 
Â
);

863  
	`putc
(
s
>>8, 
Â
Ë!
EOF
;

864 
	}
}

867 
	$WRITELONG
(
FILE
 *
Â
, 
l
)

869 
	`putc
(
l
, 
Â
);

870 
	`putc
(
l
>>8, 
Â
);

871 
	`putc
(
l
>>16, 
Â
);

872  
	`putc
(
l
>>24, 
Â
Ë!
EOF
;

873 
	}
}

876 
	$WRITESTR
(
FILE
 *
Â
, *
°r
, 
cou¡
)

878  
	`fwrôe
(
°r
, 1, 
cou¡
, 
Â
) == count;

879 
	}
}

882 
	$WRITESTRPAD
(
FILE
 *
Â
, *
°r
, 
tŸÀn
)

884 
ªt
;

886 
°r
 && *°∏&& 
tŸÀn
 > 0)

887 i‡(*
°r
) {

888 
ªt
 = 
	`putc
(*
°r
++, 
Â
);

889 --
tŸÀn
;

891 --
tŸÀn
 >= 0)

892 
ªt
 = 
	`putc
(' ', 
Â
);

893  
ªt
;

894 
	}
}

898 
	$gí_‚t_fûe
(
PMWCFONT
 
pf
, *
∑th
)

900 
FILE
 *
oÂ
;

901 
i
;

903 
oÂ
 = 
	`f›í
(
∑th
, "wb");

904 i‡(!
oÂ
) {

905 
	`Ârötf
(
°dîr
, "C™'à¸óã %s\n", 
∑th
);

908 
	`Ârötf
(
°dîr
, "Gíî©ög %s\n", 
∑th
);

911 
	`WRITESTR
(
oÂ
, 
VERSION
, 4);

914 
	`WRITESTRPAD
(
oÂ
, 
pf
->
«me
, 64);

917 
	`WRITESTRPAD
(
oÂ
, 
pf
->
c›yright
, 256);

920 
	`WRITESHORT
(
oÂ
, 
pf
->
maxwidth
);

921 
	`WRITESHORT
(
oÂ
, 
pf
->
height
);

922 
	`WRITESHORT
(
oÂ
, 
pf
->
as˚¡
);

923 
	`WRITESHORT
(
oÂ
, 0);

924 
	`WRITELONG
(
oÂ
, 
pf
->
fú°ch¨
);

925 
	`WRITELONG
(
oÂ
, 
pf
->
deÁu…ch¨
);

926 
	`WRITELONG
(
oÂ
, 
pf
->
size
);

929 
	`WRITELONG
(
oÂ
, 
pf
->
bôs_size
);

930 
	`WRITELONG
(
oÂ
, 
pf
->
off£t
?Öf->
size
: 0);

931 
	`WRITELONG
(
oÂ
, 
pf
->
width
?Öf->
size
: 0);

934 
i
=0; i<
pf
->
bôs_size
; ++i)

935 
	`WRITESHORT
(
oÂ
, 
pf
->
bôs
[
i
]);

936 i‡(
	`·ñl
(
oÂ
) & 2)

937 
	`WRITESHORT
(
oÂ
, 0);

939 i‡(
pf
->
off£t
)

940 
i
=0; i<
pf
->
size
; ++i)

941 
	`WRITELONG
(
oÂ
, 
pf
->
off£t
[
i
]);

943 i‡(
pf
->
width
)

944 
i
=0; i<
pf
->
size
; ++i)

945 
	`WRITEBYTE
(
oÂ
, 
pf
->
width
[
i
]);

947 
	`f˛o£
(
oÂ
);

949 
	}
}

	@fonts/obsolete.c

26 
	ggr_w¨nög_libmwf⁄ts_is_obsﬁëe
[] =

	@fonts/rom8x16.c

2 
	~"devi˚.h
"

6 
MWIMAGEBITS
 
	grom8x16_bôs
[] = {

9484 
MWCFONT
 
	gf⁄t_rom8x16
 = {

9491 
rom8x16_bôs
,

	@fonts/rom8x8.c

2 
	~"devi˚.h
"

6 
MWIMAGEBITS
 
	grom8x8_bôs
[] = {

5388 
MWCFONT
 
	gf⁄t_rom8x8
 = {

5395 
rom8x8_bôs
,

	@fonts/tools/convfnt.c

29 
	#FONT_NORMAL
 0

	)

30 
	#FONT_BOLD
 1

	)

31 
	#FONT_ITALIC
 2

	)

32 
	#FONT_BOLDITALIC
 (
FONT_BOLD
 | 
FONT_ITALIC
)

	)

33 *
	gF⁄t_Name
 = "MS Sans Serif";

34 
	gF⁄t_Height
 = 20;

35 
	gF⁄t_Width
 = 0;

36 
	gF⁄t_StyÀ
 = 
FONT_NORMAL
;

37 *
	gF⁄t_StyÀ_Såög
 = "normal";

39 
	#WIN32_LEAN_AND_MEAN


	)

40 
	~<wödows.h
>

41 
	~<°dio.h
>

42 
	~<°dlib.h
>

43 
	~<°rög.h
>

45 
	#MAX_BITS_HEIGHT
 48

	)

46 
	#MAX_BITS_WIDTH
 80

	)

47 
	tIMAGEBITS
;

50 
	#IMAGE_SIZE
(
width
, 
height
Ë((heightË* (((widthË+ (
IMAGEBITS
Ë* 8 - 1Ë/ ((IMAGEBITSË* 8)))

	)

51 
	#IMAGE_WORDS
(
x
Ë(((x)+15)/16)

	)

52 
	#IMAGE_BITSPERIMAGE
 ((
IMAGEBITS
Ë* 8)

	)

53 
	#IMAGE_FIRSTBIT
 ((
IMAGEBITS
Ë0x8000)

	)

54 
	#IMAGE_NEXTBIT
(
m
Ë((
IMAGEBITS
Ë((mË>> 1))

	)

55 
	#IMAGE_TESTBIT
(
m
Ë((mË& 
IMAGE_FIRSTBIT
Ë

	)

56 
	#IMAGE_SHIFTBIT
(
m
Ë((
IMAGEBITS
Ë((mË<< 1)Ë

	)

59 
HINSTANCE
 
	gghIn°™˚
;

60 
	gAPPWINCLASS
[] = "convfnt";

61 
	gMAX_WIDTH
 = 0;

62 
	gAVE_WIDTH
;

63 
	gCHAR_HEIGHT
;

64 
	gCHAR_ASCENT
;

65 
	gf⁄äame
[64];

66 
FILE
 * 
	gÂ
;

67 
HFONT
 
	ghf⁄t
;

68 
	gFIRST_CHAR
 = ' ';

69 
	gLAST_CHAR
 = 256;

70 
	gcuroff
 = 0;

71 
	goff£ts
[256];

72 
	gwidths
[256];

73 
	ghaveArgs
 = 0;

77 
LRESULT
 
CALLBACK
 
WndProc
(
HWND
 
hwnd
,
UINT
 
uMsg
,
WPARAM
 
wp
,
LPARAM
 
Õ
);

79 
HWND
 
InôAµ
();

80 
InôCœs£s
();

81 
doô
(
HDC
 
hdc
);

82 
c⁄v‚t
(
HDC
 
hdc
);

83 
¥öt_ch¨
(
ch
,
IMAGEBITS
 *
b
, 
w
, 
h
);

84 
¥öt_bôs
(
IMAGEBITS
 *
bôs
, 
width
, 
height
);

85 
HFONT
 
WINAPI
 
GëF⁄t
(
HDC
 
hDC
, 
LPSTR
 
«me
, 
height
, 
width
, 
°yÀ
);

86 
HFONT
 
WINAPI
 
GëF⁄tEx
(
HDC
 
hDC
, 
LPSTR
 
«me
, 
height
, 
width
, 
°yÀ
,

87 
ch¨£t
);

89 
WINAPI


90 
	$WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
, 
LPSTR
 
ÕCmdLöe
,

91 
nShowCmd
)

93 
MSG
 
msg
;

94 
HDC
 
hdc
;

95 
i
;

96 *
¨gv
[10];

97 
¨gc
;

98 
cmdLöe
[1024];

99 *
cmdLöePå
;

101 
ghIn°™˚
 = 
hIn°™˚
;

102 
	`InôCœs£s
();

103 
	`InôAµ
();

105 
	`°∫˝y
(
cmdLöe
, 
ÕCmdLöe
, 1024);

106 
cmdLöe
[1023] = '\0';

108 
i
 = 
	`©oi
(
cmdLöe
);

109 
hdc
 = 
	`GëDC
(
NULL
);

110 
i
) {

112 if(*
cmdLöe
 == 0)

114 
haveArgs
 = 0;

115 
	`°r˝y
(
cmdLöe
, "\"MS Sans Serif\"");

118 
haveArgs
 = 1;

119 
¨gc
 = 0;

120 
cmdLöePå
 = 
cmdLöe
;

123 *
cmdLöePå
 != '\0'

124 && (*
cmdLöePå
 == ' ' || *cmdLinePtr == '\t'))

125 
cmdLöePå
++;

126 i‡(*
cmdLöePå
 != '\0')

128 if(*
cmdLöePå
 == '"' || *cmdLinePtr == '\'')

130 
cmdLöePå
++;

131 
¨gv
[
¨gc
] = 
cmdLöePå
;

132 
¨gc
++;

133 *
cmdLöePå
 != '\0' && *cmdLinePtr != '"'

134 && *
cmdLöePå
 != '\t')

135 
cmdLöePå
++;

136 i‡(*
cmdLöePå
 == '\0')

139 *
cmdLöePå
++ = '\0';

143 
¨gv
[
¨gc
] = 
cmdLöePå
;

144 
¨gc
++;

145 *
cmdLöePå
 != '\0' && *cmdLinePtr != ' '

146 && *
cmdLöePå
 != '\t')

147 
cmdLöePå
++;

148 i‡(*
cmdLöePå
 == '\0')

151 *
cmdLöePå
++ = '\0';

154 } 
¨gc
 < 10 && *
cmdLöePå
 != '\0');

156 i‡(
¨gc
 == 0)

157 
haveArgs
 = 0;

159 i‡(
¨gc
 >= 1)

160 
F⁄t_Name
 = 
¨gv
[0];

162 i‡(
¨gc
 >= 2)

163 
F⁄t_Height
 = 
	`©oi
(
¨gv
[1]);

165 i‡(
¨gc
 >3 && *(
¨gv
[2]) >= '0' && *(argv[2]) <= '9')

166 
F⁄t_Width
 = 
	`©oi
(
¨gv
[2]);

167 i‡(
F⁄t_Width
 < 0)

168 
F⁄t_Width
 = 0;

170 
i
 = 2; i < 
¨gc
; i++)

172 i‡(
	`°ricmp
(
¨gv
[
i
], "italic") == 0)

173 
F⁄t_StyÀ
 |
FONT_ITALIC
;

174 i‡(
	`°ricmp
(
¨gv
[
i
], "bold") == 0)

175 
F⁄t_StyÀ
 |
FONT_BOLD
;

178 
F⁄t_StyÀ
)

180 
FONT_BOLD
:

181 
F⁄t_StyÀ_Såög
 = "bold";

183 
FONT_ITALIC
:

184 
F⁄t_StyÀ_Såög
 = "italic";

186 
FONT_BOLD
 | 
FONT_ITALIC
:

187 
F⁄t_StyÀ_Såög
 = "bold italic";

191 
hf⁄t
 = 
	`GëF⁄t
(
hdc
, 
F⁄t_Name
, -
F⁄t_Height
,

192 
F⁄t_Width
, 
F⁄t_StyÀ
);

195 
hf⁄t
 = 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
);

198 
hf⁄t
 = 
	`GëStockObje˘
(
SYSTEM_FONT
);

201 
hf⁄t
 = 
	`GëStockObje˘
(
OEM_FIXED_FONT
);

204 
hf⁄t
 = 
	`GëStockObje˘
(
ANSI_VAR_FONT
);

207 
	`Rñó£DC
(
NULL
, 
hdc
);

209 
	`GëMesßge
(&
msg
, 
NULL
, 0, 0)) {

210 
	`Tøn¶©eMesßge
(&
msg
);

211 
	`Di•©chMesßge
(&
msg
);

214 
	}
}

217 
	$InôCœs£s
()

219 
WNDCLASS
 
wc
;

221 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

222 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
WndProc
;

223 
wc
.
cbClsExåa
 = 0;

224 
wc
.
cbWndExåa
 = 0;

225 
wc
.
hIn°™˚
 = 
ghIn°™˚
;

226 
wc
.
hIc⁄
 = 
	`LﬂdIc⁄
(
ghIn°™˚
, 
	`MAKEINTRESOURCE
( 1));

227 
wc
.
hCurs‹
 = 
	`LﬂdCurs‹
(
NULL
, 
IDC_ARROW
);

228 
wc
.
hbrBackground
 = 
	`GëStockObje˘
(
LTGRAY_BRUSH
);

229 
wc
.
ÕszMíuName
 = 
NULL
;

230 
wc
.
ÕszCœssName
 = 
APPWINCLASS
;

231  
	`Regi°îCœss
–&
wc
);

232 
	}
}

234 
HWND


235 
	$InôAµ
()

237 
HWND
 
hwnd
;

239 
hwnd
 = 
	`Cª©eWödowEx
–0L, 
APPWINCLASS
,

241 
WS_OVERLAPPEDWINDOW
,

242 
CW_USEDEFAULT
, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,

243 
NULL
,

244 
NULL
,

245 
ghIn°™˚
,

246 
NULL
);

248 if–
hwnd
 =
NULL
)

251 
	`ShowWödow
–
hwnd
, 
SW_SHOW
);

252  
hwnd
;

253 
	}
}

256 
LRESULT
 
CALLBACK


257 
	$WndProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

259 
PAINTSTRUCT
 
ps
;

260 
HDC
 
hdc
;

261 
LOGFONT
 
lf
;

262 
TEXTMETRIC
 
tm
;

263 
outfûe
[64];

264 *
p
, *
q
;

266  
msg
) {

267 
WM_CREATE
:

270 
WM_DESTROY
:

271 
	`Po°QuôMesßge
(0);

274 
WM_PAINT
:

275 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

276 
	`Sñe˘Obje˘
(
hdc
, 
hf⁄t
);

278 
	`GëObje˘
(
hf⁄t
, (
lf
), &lf);

279 
	`GëTextMërics
(
hdc
, &
tm
);

280 
MAX_WIDTH
 = 0;

281 
AVE_WIDTH
 = 
tm
.
tmAveCh¨Width
;

282 
CHAR_HEIGHT
 = 
tm
.
tmHeight
;

283 
CHAR_ASCENT
 = 
tm
.
tmAs˚¡
;

284 
FIRST_CHAR
 = 
tm
.
tmFú°Ch¨
;

285 
LAST_CHAR
 = 
tm
.
tmLa°Ch¨
 + 1;

286 
	`°r˝y
(
f⁄äame
, 
lf
.
lfFa˚Name
);

287 
q
 = 
p
 = 
f⁄äame
;

288 *
p
) {

289 if(*
p
 != ' ')

290 *
q
++ = *
p
;

291 ++
p
;

293 *
q
 = 0;

295 i‡(
haveArgs
)

297 
ßm∂e
[1024];

298 
	`•rötf
(
ßm∂e
, "C⁄vîtög f⁄à\"%s\", Heighà%d, Width %d, StyÀ \"%s\" ", 
F⁄t_Name
, 
F⁄t_Height
, 
F⁄t_Width
, 
F⁄t_StyÀ_Såög
);

299 
	`TextOut
(
hdc
, 0, 150, 
ßm∂e
, 
	`°æí
(sample));

300 
	`w•rötf
(
outfûe
, "wö%s%dx%d.c", 
f⁄äame
,

301 
AVE_WIDTH
, 
CHAR_HEIGHT
);

302 
	`•rötf
(
ßm∂e
,

304 
outfûe
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

305 
	`TextOut
(
hdc
, 0, 200, 
ßm∂e
, 
	`°æí
(sample));

306 
Â
 = 
	`f›í
(
outfûe
, "wt");

307 
	`doô
(
hdc
);

308 
	`f˛o£
(
Â
);

309 
	`TextOut
(
hdc
, 0, 250, " DONE! ", 7);

313 *
ußge
 = "Usage: convfnt.exe \"fontname\" [Öixel_height [pixel_width] [bold] [italic] ] ";

314 
	`TextOut
(
hdc
, 0, 0, 
ußge
, 
	`°æí
(usage));

315 
ußge
 = "Example: convfnt.exe \"my font\" 25 12 bold italic ";

316 
	`TextOut
(
hdc
, 0, 30, 
ußge
, 
	`°æí
(usage));

318 
	`EndPaöt
(
hwnd
, &
ps
);

321 
WM_LBUTTONDOWN
:

325  
	`DefWödowProc
–
hwnd
, 
msg
, 
wp
, 
Õ
);

328 
	}
}

332 
	$c⁄v‚t
(
HDC
 
hdc
)

334 
SIZE
 
size
;

335 
ch
;

336 
i
;

337 
x
, 
y
, 
w
;

338 
w‹d_width
;

339 
IMAGEBITS
 
mask_vÆue
;

340 
IMAGEBITS
 *
image_±r
;

341 
IMAGEBITS
 
c
;

342 
IMAGEBITS
 
image
[
MAX_BITS_HEIGHT
 * 
	`IMAGE_WORDS
(
MAX_BITS_WIDTH
)];

343 
IMAGEBITS
 
mask
[
IMAGE_BITSPERIMAGE
 * 
	`IMAGE_WORDS
(
MAX_BITS_WIDTH
)] = {

356 
i
 = 
FIRST_CHAR
; i < 
LAST_CHAR
; ++i)

358 
ch
 = 
i
;

359 
	`TextOut
(
hdc
, 0, 0, &
ch
, 1);

360 
	`GëTextExã¡Poöt32
(
hdc
, &
ch
, 1, &
size
);

361 i‡(
size
.
cx
 > 
MAX_BITS_WIDTH
)

363 
off£ts
[
ch
] = 
curoff
;

364 
widths
[
ch
] = 0;

366 i‡(
size
.
cx
 > 
MAX_WIDTH
)

367 
MAX_WIDTH
 = 
size
.
cx
;

368 
w‹d_width
 = 
	`IMAGE_WORDS
(
size
.
cx
);

369 
y
 = 0; y < 
size
.
cy
; ++y)

371 
w
 = 0; w < 
w‹d_width
; w++)

373 
image_±r
 = &(
image
[(
y
 * 
w‹d_width
Ë+ 
w
]);

374 *
image_±r
 = 0;

375 
x
=
IMAGE_BITSPERIMAGE
 * 
w
;

376 
x
 < ()((
IMAGE_BITSPERIMAGE
 * 
w
Ë+ 16Ë&& x < 
size
.
cx
;

377 ++
x
)

379 
c
 = 
	`GëPixñ
(
hdc
, 
x
, 
y
)? 0: 1;

380 
mask_vÆue
 = 
mask
[
x
];

381 *
image_±r
 = (*image_±∏& ~
mask_vÆue
)

382 | (
c
 << (15 - (
x
 % 16)));

386 
off£ts
[
ch
] = 
curoff
;

387 
widths
[
ch
] = 
size
.
cx
;

388 
	`¥öt_ch¨
(
ch
, 
image
, 
size
.
cx
, size.
cy
);

389 
	`¥öt_bôs
(
image
, 
size
.
cx
, size.
cy
);

390 
curoff
 +(
size
.
cy
 * 
w‹d_width
);

391 
	`Ârötf
(
Â
, "\n");

393 
	}
}

397 
	$doô
(
HDC
 
hdc
)

399 
i
;

401 
	`Ârötf
(
Â
, "/* Generated by convfnt.exe*/\n");

402 
	`Ârötf
(
Â
, "#include \"device.h\"\n\n");

403 
	`Ârötf
(
Â
, "/* Windows %s %dx%d Font */\n",

404 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

405 
	`Ârötf
(
Â
, "/* Originated from: \"%s\", Height %d, Width %d, Style \"%s\" */\n\n",

406 
F⁄t_Name
, 
F⁄t_Height
, 
F⁄t_Width
, 
F⁄t_StyÀ_Såög
);

407 
	`Ârötf
(
Â
, "static MWIMAGEBITS win%s%dx%d_bits[] = {\n\n",

408 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

410 
	`c⁄v‚t
(
hdc
);

412 
	`Ârötf
(
Â
, "};\n\n");

414 
	`Ârötf
(
Â
, "/* Character->glyph data. */\n");

415 
	`Ârötf
(
Â
, "static unsigned short win%s%dx%d_offset[] = {\n",

416 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

417 
i
=
FIRST_CHAR
; i<
LAST_CHAR
; ++i)

418 
	`Ârötf
(
Â
, " %d,\à/* %¯(0x%02xË*/\n", 
off£ts
[
i
], i<' '? ' ':i , i);

419 
	`Ârötf
(
Â
, "};\n\n");

421 
	`Ârötf
(
Â
, "/* Character width data. */\n");

422 
	`Ârötf
(
Â
, "static unsigned char win%s%dx%d_width[] = {\n",

423 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

424 
i
=
FIRST_CHAR
; i<
LAST_CHAR
; ++i)

425 
	`Ârötf
(
Â
, " %d,\à/* %¯(0x%02xË*/\n", 
widths
[
i
], i<' '? ' ':i , i);

426 
	`Ârötf
(
Â
, "};\n\n");

429 
	`Ârötf
(
Â
, "/* Exported structure definition. */\n"

431 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

432 
	`Ârötf
(
Â
, "\t\"wö%s%dx%d\",\n", 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

433 
	`Ârötf
(
Â
, "\t%d,\n", 
MAX_WIDTH
);

434 
	`Ârötf
(
Â
, "\t%d,\n", 
CHAR_HEIGHT
);

435 
	`Ârötf
(
Â
, "\t%d,\n", 
CHAR_ASCENT
);

436 
	`Ârötf
(
Â
, "\t%d,\n\t%d,\n", 
FIRST_CHAR
, 
LAST_CHAR
-FIRST_CHAR);

437 
	`Ârötf
(
Â
, "\twö%s%dx%d_bôs,\n", 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

438 
	`Ârötf
(
Â
, "\twö%s%dx%d_off£t,\n", 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

439 
	`Ârötf
(
Â
, "\twö%s%dx%d_width,\n", 
f⁄äame
, 
AVE_WIDTH
, 
CHAR_HEIGHT
);

440 
	`Ârötf
(
Â
, "};\n");

441 
	}
}

461 
	$¥öt_ch¨
(
ch
,
IMAGEBITS
 *
bôs
, 
width
, 
height
)

463 
x
, 
w‹d_width
;

464 
bôcou¡
;

465 
IMAGEBITS
 
bôvÆue
;

467 
	`Ârötf
(
Â
, "/* Ch¨a˘î %¯(0x%02x):\n", (
ch
 < ' '? ' ': ch), ch);

468 
	`Ârötf
(
Â
, " ht=%d, width=%d\n", 
height
, 
width
);

469 
	`Ârötf
(
Â
, " +");

470 
x
 = 0; x < 
width
; ++x)

471 
	`Ârötf
(
Â
, "-");

472 
	`Ârötf
(
Â
, "+\n");

473 
x
 = 0;

474 
bôcou¡
 = 0;

475 
w‹d_width
 = 
	`IMAGE_WORDS
(
width
);

476 
height
 > 0)

478 i‡(
bôcou¡
 <= 0)

480 
	`Ârötf
(
Â
, " |");

481 
bôcou¡
 = 
IMAGE_BITSPERIMAGE
 * 
w‹d_width
;

482 
bôvÆue
 = *
bôs
++;

484 i‡(
	`IMAGE_TESTBIT
(
bôvÆue
))

485 
	`Ârötf
(
Â
, "*");

487 
	`Ârötf
(
Â
, " ");

488 
bôvÆue
 = 
	`IMAGE_SHIFTBIT
(bitvalue);

489 --
bôcou¡
;

490 i‡(
bôcou¡
 > 0 && (bôcou¡ % 
IMAGE_BITSPERIMAGE
) == 0)

491 
bôvÆue
 = *
bôs
++;

492 i‡(
x
++ =
width
-1)

494 
x
 = 0;

495 --
height
;

496 
bôcou¡
 = 0;

497 
	`Ârötf
(
Â
, "|\n");

500 
	`Ârötf
(
Â
, " +");

501 
x
=0; x<
width
; ++x)

502 
	`Ârötf
(
Â
, "-");

503 
	`Ârötf
(
Â
, "+ */\n");

504 
	}
}

506 
	#IMAGE_GETBIT4
(
m
Ë(((mË& 0xf000Ë>> 12)

	)

507 
	#IMAGE_SHIFTBIT4
(
m
Ë((
IMAGEBITS
Ë((mË<< 4))

	)

510 
	$¥öt_bôs
(
IMAGEBITS
 *
bôs
, 
width
, 
height
)

512 
x
, 
w‹d_width
;

513 
bôcou¡
;

514 
IMAGEBITS
 
bôvÆue
;

516 
x
 = 0;

517 
bôcou¡
 = 0;

518 
w‹d_width
 = 
	`IMAGE_WORDS
(
width
);

519 
height
 > 0)

521 i‡(
bôcou¡
 <= 0)

523 
	`Ârötf
(
Â
, "0x");

524 
bôcou¡
 = 
IMAGE_BITSPERIMAGE
 * 
w‹d_width
;

525 
bôvÆue
 = *
bôs
++;

527 
	`Ârötf
(
Â
, "%x", 
	`IMAGE_GETBIT4
(
bôvÆue
));

528 
bôvÆue
 = 
	`IMAGE_SHIFTBIT4
(bitvalue);

529 
bôcou¡
 -= 4;

530 i‡(
bôcou¡
 > 0 && (bôcou¡ % 
IMAGE_BITSPERIMAGE
) == 0)

532 
	`Ârötf
(
Â
, ",0x");

533 
bôvÆue
 = *
bôs
++;

535 
x
 += 4;

536 i‡(
x
 >
width
)

538 if(
IMAGE_BITSPERIMAGE
 > (
width
 % IMAGE_BITSPERIMAGE)

539 && (
width
 % 
IMAGE_BITSPERIMAGE
) != 0)

540 
x
 = 
IMAGE_BITSPERIMAGE
 - (
width
 % IMAGE_BITSPERIMAGE);

541 
x
 > 3; x -= 4)

543 
	`Ârötf
(
Â
, "0");

545 
x
 = 0;

546 --
height
;

547 
bôcou¡
 = 0;

548 
	`Ârötf
(
Â
, ",\n");

551 
	}
}

563 
HFONT
 
WINAPI


564 
	$GëF⁄t
(
HDC
 
hDC
, 
LPSTR
 
f⁄tName
,
f⁄tSize
,
f⁄tWidth
,
f⁄tStyÀ
)

566  
	`GëF⁄tEx
(
hDC
, 
f⁄tName
, 
f⁄tSize
, 
f⁄tWidth
,

567 
f⁄tStyÀ
, 
ANSI_CHARSET
);

568 
	}
}

570 
HFONT
 
WINAPI


571 
	$GëF⁄tEx
(
HDC
 
hDC
, 
LPSTR
 
f⁄tName
,
f⁄tSize
,
f⁄tWidth
,

572 
f⁄tStyÀ
,
ch¨£t
)

574 
LOGFONT
 
lf
;

575 
HDC
 
hdc
;

577 
	`mem£t
–&
lf
, 0, (
LOGFONT
));

579 if–
f⁄tSize
 < 0 || 
hDC
)

580 
hdc
 = 
hDC
;

581 
hdc
 = 
	`GëDC
–
	`GëDeskt›Wödow
());

584 if–
f⁄tSize
 < 0)

585 
lf
.
lfHeight
 = -
f⁄tSize
;

586 
lf
.
lfHeight
 = -
	`MulDiv
–
f⁄tSize
,

587 
	`GëDevi˚C≠s
–
hdc
, 
LOGPIXELSY
), 72);

588 if–
f⁄tName
)

589 
	`°∫˝y
–
lf
.
lfFa˚Name
, 
f⁄tName
, 
LF_FACESIZE
);

590 
lf
.
lfFa˚Name
[ 0] = '\0';

591 
lf
.
lfWeight
 = (
f⁄tStyÀ
 & 01)? 
FW_BOLD
: 
FW_NORMAL
;

592 if–
f⁄tStyÀ
 & 02)

593 
lf
.
lfIèlic
 = 1;

594 
lf
.
lfCh¨Së
 = 
ch¨£t
;

595 
lf
.
lfWidth
 = 
f⁄tWidth
;

597 if–
f⁄tSize
 > 0 && !
hDC
)

598 
	`Rñó£DC
–
	`GëDeskt›Wödow
(), 
hdc
);

599  
	`Cª©eF⁄tIndúe˘
–&
lf
);

600 
	}
}

	@fonts/tools/convrom.c

7 
	~"../../devi˚.h
"

8 
	~"../vga.h
"

11 
	gROM_CHAR_HEIGHT
 = 16;

12 
	#ROM_CHAR_WIDTH
 8

	)

13 
	#MAX_ROM_HEIGHT
 16

	)

14 
	#FONT_CHARS
 256

	)

17 
	#FNGR640x480
 0x0012

	)

18 
	#FNGR640x350
 0x0010

	)

19 
	#FNTEXT
 0x0003

	)

20 
	#FNGETROMADDR
 0x1130

	)

21 
	#GETROM8x14
 0x0200

	)

22 
	#GETROM8x8
 0x0300

	)

23 
	#GETROM8x16
 0x0600

	)

26 
	#GRMODE
 
FNGR640x350


	)

29 
FARADDR
 
	grom_ch¨_addr
;

31 
¥öt_rom_èbÀ
();

32 
¥öt_ch¨
(
ch
,
MWIMAGEBITS
 *
b
, 
w
, 
h
);

33 
¥öt_bôs
(
MWIMAGEBITS
 *
bôs
, 
width
, 
height
);

35 
	$maö
()

38 
	`öt10
(
GRMODE
, 0);

41 
rom_ch¨_addr
 = 
	`öt10
(
FNGETROMADDR
, 
GETROM8x14
);

47 
ROM_CHAR_HEIGHT
 = 
	`GETBYTE_FP
(
	`MK_FP
(0x0040, 0x0085));

49 
ROM_CHAR_HEIGHT
 = 16;

52 
	`¥ötf
("/* Generated by convrom.exe*/\n");

53 
	`¥ötf
("#include \"device.h\"\n\n");

54 
	`¥ötf
("/* ROM %dx%d Font bios mode %x */\n\n",

55 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
, 
GRMODE
);

56 
	`¥ötf
("static MWIMAGEBITSÑom%dx%d_bits[] = {\n\n",

57 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

59 
	`¥öt_rom_èbÀ
();

61 
	`¥ötf
("};\n\n");

62 
	`¥ötf
("/* Exported structure definition. */\n"

64 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

65 
	`¥ötf
("\t\"rom%dx%d\",\n", 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

66 
	`¥ötf
("\t%d,\n", 
ROM_CHAR_WIDTH
);

67 
	`¥ötf
("\t%d,\n", 
ROM_CHAR_HEIGHT
);

68 
	`¥ötf
("\t%d,\n", 
ROM_CHAR_HEIGHT
);

69 
	`¥ötf
("\t0,\n\t256,\n");

70 
	`¥ötf
("\åom%dx%d_bôs,\n", 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

71 
	`¥ötf
("\t0,\n\t0\n");

72 
	`¥ötf
("};\n");

75 
	`öt10
(
FNTEXT
, 0);

76 
	}
}

79 
	$¥öt_rom_èbÀ
()

81 
FARADDR
 
bôs
;

82 
n
;

83 
ch
;

84 
MWIMAGEBITS
 * 
p
;

85 
MWIMAGEBITS
 
image
[
MAX_ROM_HEIGHT
];

87 
ch
=0; ch < 256; ++ch) {

88 
bôs
 = 
rom_ch¨_addr
 + 
ch
 * 
ROM_CHAR_HEIGHT
;

89 
p
 = 
image
;

90 
n
=0;Ç<
ROM_CHAR_HEIGHT
; ++n)

91 *
p
++ = 
	`GETBYTE_FP
(
bôs
++) << 8;

92 
	`¥öt_ch¨
(
ch
, 
image
, 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

93 
	`¥öt_bôs
(
image
, 
ROM_CHAR_WIDTH
, 
ROM_CHAR_HEIGHT
);

94 
	`¥ötf
("\n");

96 
	}
}

116 
	$¥öt_ch¨
(
ch
,
MWIMAGEBITS
 *
bôs
, 
width
, 
height
)

118 
COORD
 
x
;

119 
bôcou¡
;

120 
MWIMAGEBITS
 
bôvÆue
;

122 
	`¥ötf
("/* Ch¨a˘î %¯(0x%02x):\n", 
ch
? ch: ' ', ch);

123 
	`¥ötf
(" ht=%d, width=%d\n", 
height
, 
width
);

124 
	`¥ötf
(" +");

125 
x
=0; x<
width
; ++x)

126 
	`¥ötf
("-");

127 
	`¥ötf
("+\n");

128 
x
 = 0;

129 
bôcou¡
 = 0;

130 
height
 > 0) {

131 i‡(
bôcou¡
 <= 0) {

132 
	`¥ötf
(" |");

133 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

134 
bôvÆue
 = *
bôs
++;

136 i‡(
	`MWIMAGE_TESTBIT
(
bôvÆue
))

137 
	`¥ötf
("*");

138 
	`¥ötf
(" ");

139 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT
(bitvalue);

140 --
bôcou¡
;

141 i‡(
x
++ =
width
-1) {

142 
x
 = 0;

143 --
height
;

144 
bôcou¡
 = 0;

145 
	`¥ötf
("|\n");

148 
	`¥ötf
(" +");

149 
x
=0; x<
width
; ++x)

150 
	`¥ötf
("-");

151 
	`¥ötf
("+ */\n");

152 
	}
}

154 
	#MWIMAGE_GETBIT4
(
m
Ë(((mË& 0xf000Ë>> 12)

	)

155 
	#MWIMAGE_SHIFTBIT4
(
m
Ë((
IMAGEBITS
Ë((mË<< 4))

	)

158 
	$¥öt_bôs
(
MWIMAGEBITS
 *
bôs
, 
width
, 
height
)

160 
COORD
 
x
;

161 
bôcou¡
;

162 
MWIMAGEBITS
 
bôvÆue
;

164 
x
 = 0;

165 
bôcou¡
 = 0;

166 
height
 > 0) {

167 i‡(
bôcou¡
 <= 0) {

168 
	`¥ötf
("0x");

169 
bôcou¡
 = 
MWIMAGE_BITSPERIMAGE
;

170 
bôvÆue
 = *
bôs
++;

172 
	`¥ötf
("%x", 
	`MWIMAGE_GETBIT4
(
bôvÆue
));

173 
bôvÆue
 = 
	`MWIMAGE_SHIFTBIT4
(bitvalue);

174 
bôcou¡
 -= 4;

175 
x
 += 4;

176 i‡(
x
 >
width
-1) {

177 if(
MWIMAGE_BITSPERIMAGE
 > 
width
)

178 
x
=
MWIMAGE_BITSPERIMAGE
-
width
; x>0; ) {

179 
	`¥ötf
("0");

180 
x
 -= 4;

182 
x
 = 0;

183 --
height
;

184 
bôcou¡
 = 0;

185 
	`¥ötf
(",\n");

188 
	}
}

	@fonts/winFreeSansSerif11x13.c

2 
	~"devi˚.h
"

12 
MWIMAGEBITS
 
	gwöFªeS™sSîif11x13_bôs
[] = {

6962 
	gwöFªeS™sSîif11x13_off£t
[] = {

7191 
	gwöFªeS™sSîif11x13_width
[] = {

7419 
MWCFONT
 
	gf⁄t_wöFªeS™sSîif11x13
 = {

7426 
wöFªeS™sSîif11x13_bôs
,

7428 
wöFªeS™sSîif11x13_width
,

	@fonts/winFreeSystem14x16.c

2 
	~"devi˚.h
"

12 
MWIMAGEBITS
 
	gwöFªeSy°em14x16_bôs
[] = {

8306 
	gwöFªeSy°em14x16_off£t
[] = {

8535 
	gwöFªeSy°em14x16_width
[] = {

8763 
MWCFONT
 
	gf⁄t_wöFªeSy°em14x16
 = {

8770 
wöFªeSy°em14x16_bôs
,

8772 
wöFªeSy°em14x16_width
,

	@include/XtoNX.h

1 #i‚de‡
__XTONX_H


2 
	#__XTONX_H


	)

12 #ifde‡
__˝lu•lus


16 
	#MWINCLUDECOLORS


	)

17 
	~"«no-X.h
"

24 
GR_CURSOR_ID
 
	tCurs‹
;

25 
GR_DRAW_ID
 
	tDøwabÀ
;

26 
GR_FONT_ID
 
	tF⁄t
;

27 
GR_GC_ID
 
	tGC
;

28 
GR_WINDOW_ID
 
	tPixm≠
;

29 
GR_REGION_ID
 
	tRegi⁄
;

30 
	tTime
;

31 
GR_WINDOW_ID
 
	tWödow
;

32 
GR_EVENT
 
	tXEvít
;

33 
GR_FONT_INFO
 
	tXF⁄tSåu˘
;

34 
GR_POINT
 
	tXPoöt
;

35 
GR_RECT
 
	tXRe˘™gÀ
;

39 
GR_COORD
 
di•œy_width
;

40 
GR_COORD
 
di•œy_height
;

41 
di•œy_bµ
;

42 } 
	tDi•œy
;

45 
	#XCh¨Såu˘
 

	)

52 
	#FÆ£
 0

	)

53 
	#True
 1

	)

55 
	#GXc›y
 
GR_MODE_COPY


	)

56 
	#GXx‹
 
GR_MODE_XOR


	)

57 
	#N⁄e
 0

	)

58 
	#Re˘™gÀOut
 
MWRECT_OUT


	)

59 
	#Re˘™gÀIn
 
MWRECT_ALLIN


	)

60 
	#Re˘™gÀP¨t
 
MWRECT_PARTIN


	)

63 
	#Buâ⁄PªssMask
 
GR_EVENT_MASK_BUTTON_DOWN


	)

64 
	#Buâ⁄Rñó£Mask
 
GR_EVENT_MASK_BUTTON_UP


	)

65 
	#E¡îWödowMask
 
GR_EVENT_MASK_MOUSE_ENTER


	)

66 
	#ExposuªMask
 
GR_EVENT_MASK_EXPOSURE


	)

67 
	#KeyPªssMask
 
GR_EVENT_MASK_KEY_DOWN


	)

68 
	#KeyRñó£Mask
 
GR_EVENT_MASK_KEY_UP


	)

69 
	#LóveWödowMask
 
GR_EVENT_MASK_MOUSE_EXIT


	)

70 
	#Sub°ru˘uªNŸifyMask
 
GR_EVENT_MASK_CHLD_UPDATE


	)

72 
	#Buâ⁄Pªss
 
GR_EVENT_TYPE_BUTTON_DOWN


	)

73 
	#Buâ⁄Rñó£
 
GR_EVENT_TYPE_BUTTON_UP


	)

74 
	#C⁄figuªNŸify
 
GR_EVENT_TYPE_CHLD_UPDATE


	)

75 
	#E¡îNŸify
 
GR_EVENT_TYPE_MOUSE_ENTER


	)

76 
	#Expo£
 
GR_EVENT_TYPE_EXPOSURE


	)

77 
	#KeyPªss
 
GR_EVENT_TYPE_KEY_DOWN


	)

78 
	#KeyRñó£
 
GR_EVENT_TYPE_KEY_UP


	)

79 
	#LóveNŸify
 
GR_EVENT_TYPE_MOUSE_EXIT


	)

86 
	#BœckPixñ
(
d
,
s
Ë
BLACK


	)

87 
	#DeÁu…S¸ìn
(
d
Ë0

	)

88 
	#RoŸWödow
(
d
,
s
Ë
GR_ROOT_WINDOW_ID


	)

89 
	#WhôePixñ
(
d
,
s
Ë
WHITE


	)

90 
	#XCÀ¨Aªa
(
d
,
w
,
X
,
Y
,
W
,
H
,
e
Ë
	`GrCÀ¨Aªa
(w,X,Y,W,H,e)

	)

91 
	#XCÀ¨Wödow
(
d
,
w
Ë
	`GrCÀ¨Aªa
(w,0,0,0,0,
GR_FALSE
)

	)

92 
	#XClo£Di•œy
(
d
Ë
	`GrClo£
()

	)

93 
	#XC›yAªa
(
s
,
sw
,
dw
,
gc
,
sx
,
sy
,
W
,
H
,
dx
,
dy
Ë
	`GrC›yAªa
(dw,gc,dx,dy,W,H,sw,sx,sy,0)

	)

94 
	#XCª©eBôm≠FromD©a
(
d
,
w
,
bm
,
W
,
H
) \

95 
	`GrNewPixm≠FromD©a
(
W
,
H
,
WHITE
,
BLACK
,(*)
bm
, \

96 
GR_BMDATA_BYTEREVERSE
|
GR_BMDATA_BYTESWAP
)

	)

97 
	#XCª©eGC
(
d
,
a
,
b
,
c
Ë
	`GrNewGC
()

	)

98 
	#XCª©ePixm≠
(
d
,
w
,
W
,
H
,
dïth
Ë
	`GrNewPixm≠
(W,H,(*)0)

	)

99 
	#XCª©ePixm≠FromBôm≠D©a
(
d
,
w
,
bm
,
W
,
H
,
f
,
b
,
dïth
) \

100 
	`GrNewPixm≠FromD©a
(
W
,
H
,
f
,
b
,(*)
bm
, \

101 
GR_BMDATA_BYTEREVERSE
|
GR_BMDATA_BYTESWAP
)

	)

102 
	#XCª©eRegi⁄
(Ë
	`GrNewRegi⁄
()

	)

103 
	#XCª©eSim∂eWödow
(
d
,
p
,
x
,
y
,
w
,
h
,
bw
,
b‹dc
,
backc
) \

104 
	`GrNewWödow
(
p
,
x
,
y
,
w
,
h
,
bw
,
backc
,
b‹dc
)

	)

105 
	#XCª©eWödow
(
d
,
p
,
x
,
y
,
w
,
h
,
bw
,
dïth
,
˛
,
vis
,
vm
,
©å
) \

106 
	`GrNewWödow
(
p
,
x
,
y
,
w
,
h
,
bw
,
WHITE
,
BLACK
)

	)

107 
	#XDeföeCurs‹
(
d
,
w
,
c
Ë
	`GrSëWödowCurs‹
(w,c)

	)

108 
	#XDe°royRegi⁄
(
r
Ë
	`GrDe°royRegi⁄
‘)

	)

109 
	#XDe°royWödow
(
d
,
w
Ë
	`GrDe°royWödow
(w)

	)

110 
	#XDøwArc
(
d
,
w
,
g
,
x
,
y
,
W
,
H
,
a1
,
a2
Ë
	`GrArcAngÀ
(w,g,(x)+(W)/2,(y)+(H)/2,(W)/2,(H)/2,a1,(◊1)+◊2)),
GR_ARC
)

	)

111 
	#XDøwLöe
(
d
,
w
,
g
,
x1
,
y1
,
x2
,
y2
Ë
	`GrLöe
(w,g,x1,y1,x2,y2)

	)

112 
	#XDøwLöes
(
d
,
w
,
g
,
¨
,
˙t
,
B
Ë
	`GrDøwLöes
(w,g,¨,˙t)

	)

113 
	#XDøwRe˘™gÀ
(
d
,
w
,
g
,
x
,
y
,
W
,
H
Ë
	`GrRe˘
(w,g,x,y,W,H)

	)

114 
	#XDøwSåög
(
d
,
w
,
g
,
x
,
y
,
s
,
c
Ë
	`GrText
(w,g,x,y,(*)s,c,
GR_TFASCII
)

	)

115 
	#XFûlArc
(
d
,
w
,
g
,
x
,
y
,
W
,
H
,
a1
,
a2
Ë
	`GrArcAngÀ
(w,g,(x)+(W)/2,(y)+(H)/2,(W)/2,(H)/2,a1,(◊1)+◊2)),
GR_PIE
)

	)

116 
	#XFûlPﬁyg⁄
(
d
,
w
,
gc
,
¨
,
˙t
,
ign1
,
ign2
Ë
	`GrFûlPﬁy
(w,gc,˙t,¨)

	)

117 
	#XFûlRe˘™gÀ
(
d
,
w
,
g
,
x
,
y
,
W
,
H
Ë
	`GrFûlRe˘
(w,g,x,y,W,H)

	)

118 
	#XFlush
(
d
Ë
	`GrFlush
()

	)

119 
	#XFªe
(
p
Ë
	`‰ì
’)

	)

120 
	#XFªeGC
(
w
,
g
Ë
	`GrDe°royGC
(g)

	)

121 
	#XFªePixm≠
(
d
,
w
Ë
	`GrDe°royWödow
(w)

	)

122 
	#XLﬂdF⁄t
(
d
,
f
Ë
	`GrCª©eF⁄t
(0, 0, 0)

	)

123 
	#XLowîWödow
(
d
,
w
Ë
	`GrLowîWödow
(w)

	)

124 
	#XM≠Wödow
(
d
,
w
Ë
	`GrM≠Wödow
(w)

	)

125 
	#XMoveWödow
(
d
,
w
,
x
,
y
Ë
	`GrMoveWödow
(w,x,y)

	)

126 
	#XNextEvít
(
d
,
ï
Ë
	`GrGëNextEvít
”p)

	)

127 
	#XQuîyTªe
(
d
,
w
,
r
,
p
,
c
,
nc
Ë
	`GrQuîyTªe
(w,p,c,nc)

	)

128 
	#XRai£Wödow
(
d
,
w
Ë
	`GrRai£Wödow
(w)

	)

129 
	#XRe˘InRegi⁄
(
r
,
x
,
y
,
w
,
h
Ë
	`GrRe˘InRegi⁄
‘,x,y,w,h)

	)

130 
	#XRï¨ítWödow
(
d
,
w
,
p
,
x
,
y
Ë
	`GrRï¨ítWödow
(w,p,x,y)

	)

131 
	#XResizeWödow
(
d
,
w
,
W
,
H
Ë
	`GrResizeWödow
(w,W,H)

	)

132 
	#XSñe˘I≈ut
(
d
,
w
,
m
Ë
	`GrSñe˘Evíts
(w,m)

	)

133 
	#XSëF⁄t
(
d
,
g
,
f
Ë
	`GrSëGCF⁄t
(g,f)

	)

134 
	#XSëF‹eground
(
d
,
g
,
c
Ë
	`GrSëGCF‹eground
(g,c)

	)

135 
	#XSëFun˘i⁄
(
d
,
g
,
f
Ë
	`GrSëGCMode
(g,f)

	)

136 
	#XSëIc⁄Name
(
d
,
w
,
n
Ë

	)

137 
	#XSëRegi⁄
(
d
,
g
,
c
Ë
	`GrSëGCRegi⁄
(g,c)

	)

138 
	#XSëWödowBackground
(
d
,
w
,
c
Ë
	`GrSëWödowBackgroundCﬁ‹
(w,c)

	)

139 
	#XSëWödowBackgroundPixm≠
(
d
,
w
,
p
Ë
	`GrSëBackgroundPixm≠
(w,p,
GR_BACKGROUND_TILE
)

	)

140 
	#XSëWödowB‹dî
(
d
,
w
,
c
Ë
	`GrSëWödowB‹dîCﬁ‹
(w,c)

	)

141 
	#XSëWödowB‹dîWidth
(
d
,
w
,
bw
Ë
	`GrSëWödowB‹dîSize
(w,bw)

	)

142 
	#XSt‹eName
(
d
,
w
,
n
Ë
	`GrSëWödowTôÀ
(w,n)

	)

143 
	#XSubåa˘Regi⁄
(
§a
,
§b
,
dr
Ë
	`GrSubåa˘Regi⁄
(dr,§a,§b)

	)

144 
	#XSync
(
d
,
f
Ë
	`GrFlush
()

	)

145 
	#XUndeföeCurs‹
(
d
,
w
Ë
	`GrSëWödowCurs‹
(w,0)

	)

146 
	#XUni⁄Re˘WôhRegi⁄
(
ª˘
,
§
,
dr
Ë
	`GrUni⁄Re˘WôhRegi⁄
(dr,ª˘Ë

	)

147 
	#XUnm≠Wödow
(
d
,
w
Ë
	`GrUnm≠Wödow
(w)

	)

154 
	#Di•œyWidth
(
d
,
s
Ë(
_di•œy
.
di•œy_width
)

	)

155 
	#Di•œyHeight
(
d
,
s
Ë(
_di•œy
.
di•œy_height
)

	)

156 
	#DeÁu…Dïth
(
d
,
s
Ë(
_di•œy
.
di•œy_bµ
)

	)

158 
	#STATIC_FUNCTIONS
 \

159 
Di•œy
 
_di•œy
; \

161 
Di•œy
 * \

162 
	`XO≥nDi•œy
(*
«me
) \

164 
GR_SCREEN_INFO
 
söfo
; \

166 i‡(
	`GrO≥n
() < 0) \

167  
NULL
; \

169 
	`GrGëS¸ìnInfo
(&
söfo
); \

170 
_di•œy
.
di•œy_width
 = 
söfo
.
cﬁs
; \

171 
_di•œy
.
di•œy_height
 = 
söfo
.
rows
; \

172 
_di•œy
.
di•œy_bµ
 = 
söfo
.
bµ
; \

174  &
_di•œy
; \

178 
	`XPídög
(
Di•œy
 *
d
) \

180 
GR_EVENT
 
ev
; \

182 
	`GrFlush
(); \

183  
	`GrPìkEvít
(&
ev
); \

184 }

	)

186 #ifde‡
__˝lu•lus


	@include/device.h

1 #i‚de‡
_DEVICE_H


2 
	#_DEVICE_H


	)

11 
	~"mwty≥s.h
"

12 
	~"mwsy°em.h
"

15 
	#ALPHABLEND
 1

	)

16 
	#DYNAMICREGIONS
 1

	)

17 
	#HAVEFLOAT
 1

	)

18 
	#POLYREGIONS
 1

	)

19 
	#ANIMATEPALETTE
 0

	)

20 
	#FONTMAPPER
 0

	)

21 
	#USE_ALLOCA
 1

	)

22 
	#FASTJPEG
 1

	)

23 #i‡(
deföed
(
__πems__
Ë|| deföed (
PSP
))

24 
	#HAVE_MMAP
 0

	)

26 
	#HAVE_MMAP
 1

	)

29 
	#TRANSLATE_ESCAPE_SEQUENCES
 1

	)

31 #i‡!((
DOS_DJGPP
Ë|| (
__PACIFIC__
Ë|| (
DOS_TURBOC
))

32 
	#MW_FEATURE_IMAGES
 1

	)

34 
	#MW_FEATURE_IMAGES
 0

	)

37 #i‡
UNIX
 || 
DOS_DJGPP
 || 
HAVE_TIMER_SUPPORT


38 
	#MW_FEATURE_TIMERS
 1

	)

40 
	#MW_FEATURE_TIMERS
 0

	)

44 #i‚de‡
MW_FEATURE_GDERROR


45 #i‡(
deföed
(
GCC_VERSION
Ë&& (GCC_VERSION >2093)Ë|| (deföed(
__GNUC__
Ë&& (__GNUC__ >2Ë&& (
__GNUC_MINOR__
 >= 95))

46 
	#MW_FEATURE_GDERROR
 0

	)

48 
	#MW_FEATURE_GDERROR
 1

	)

52 #i‡
MW_FEATURE_GDERROR


53 
	#EPRINTF
 
GdEº‹


	)

54 #i‡
DEBUG


55 
	#DPRINTF
 
GdEº‹


	)

57 
	#DPRINTF
 
GdEº‹NuŒ


	)

62 
	~<°dio.h
>

63 
	#EPRINTF
(
°r
, 
¨gs
...Ë
	`Ârötf
(
°dîr
, så, ##¨gsË

	)

64 #i‡
DEBUG


65 
	#DPRINTF
(
°r
, 
¨gs
...Ë
	`Ârötf
(
°dîr
, så, ##¨gsË

	)

67 
	#DPRINTF
(
°r
, ...Ë

	)

72 
	#MW_FEATURE_PSDOP_COPY
 0

	)

73 
	#MW_FEATURE_PSDOP_ALPHAMAP
 0

	)

74 
	#MW_FEATURE_PSDOP_ALPHACOL
 0

	)

75 
	#MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST
 0

	)

76 
	#MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST
 0

	)

79 
	#MAX_CHAR_HEIGHT
 128

	)

80 
	#MAX_CHAR_WIDTH
 128

	)

81 
	#MIN_MWCOORD
 ((
MWCOORD
Ë-32768Ë

	)

82 
	#MAX_MWCOORD
 ((
MWCOORD
Ë32767Ë

	)

83 
	#MAX_CLIPRECTS
 200

	)

88 #ifde‡
HAVE_FREETYPE_2_SUPPORT


89 #unde‡
MW_FEATURE_PSDOP_ALPHACOL


90 
	#MW_FEATURE_PSDOP_ALPHACOL
 1

	)

91 #unde‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


92 
	#MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST
 1

	)

96 #i‡
VTSWITCH
 && !
MW_FEATURE_TIMERS


97 #îr‹ 
VTSWITCH
 
dïíds
 
⁄
 
MW_FEATURE_TIMERS
 - 
dißbÀ
 VTSWITCH 
ö
 
c⁄fig
 
‹
 
íabÀ
 MW_FEATURE_TIMERS i¿
this
 
fûe


100 
_mws¸ìndevi˚
 *
	tPSD
;

104 * 
	m«me
;

105 
	mmaxwidth
;

106 
	mheight
;

107 
	mas˚¡
;

108 
	mfú°ch¨
;

109 
	msize
;

110 
MWIMAGEBITS
 * 
	mbôs
;

111 *
	moff£t
;

112 * 
	mwidth
;

113 
	mdeÁu…ch¨
;

114 
	mbôs_size
;

115 } 
	tMWCFONT
, *
	tPMWCFONT
;

119 
MWTEXTFLAGS
 
	mícodög
;

120 
MWBOOL
 (*
GëF⁄tInfo
)(
PMWFONT
 
	mpf⁄t
, 
PMWFONTINFO
 
	mpf⁄töfo
);

121 (*
	mGëTextSize
)(
PMWFONT
 
	mpf⁄t
, c⁄° *
	mãxt
, 
	mcc
,

122 
MWTEXTFLAGS
 
	mÊags
, 
MWCOORD
 *
	mpwidth
, MWCOORD *
	mpheight
,

123 
MWCOORD
 *
	mpba£
);

124 (*
	mGëTextBôs
)(
PMWFONT
 
	mpf⁄t
, 
	mch
, c⁄° 
MWIMAGEBITS
 **
	mªtm≠
,

125 
MWCOORD
 *
	mpwidth
, MWCOORD *
	mpheight
, MWCOORD *
	mpba£
);

126 (*
	mDe°royF⁄t
)(
PMWFONT
 
	mpf⁄t
);

127 (*
	mDøwText
)(
PMWFONT
 
	mpf⁄t
, 
PSD
 
	mpsd
, 
MWCOORD
 
	mx
, MWCOORD 
	my
,

128 c⁄° *
	m°r
, 
	mcou¡
, 
MWTEXTFLAGS
 
	mÊags
);

129 (*
	mSëF⁄tSize
)(
PMWFONT
 
	mpf⁄t
, 
MWCOORD
 
	mf⁄tsize
);

130 (*
	mSëF⁄tRŸ©i⁄
)(
PMWFONT
 
	mpf⁄t
, 
	mã¡hdegªes
);

131 (*
	mSëF⁄tAâr
)(
PMWFONT
 
	mpf⁄t
, 
	m£tÊags
, 
	m˛rÊags
);

132 
PMWFONT
 (*
Du∂iˇã
Ë(PMWFONT 
	mp§cf⁄t
, 
MWCOORD
 
	mf⁄tsize
);

133 } 
	tMWFONTPROCS
, *
	tPMWFONTPROCS
;

136 
	s_mwf⁄t
 {

137 
PMWFONTPROCS
 
	mf⁄çrocs
;

138 
MWCOORD
 
	mf⁄tsize
;

139 
	mf⁄åŸ©i⁄
;

140 
	mf⁄èâr
;

142 } 
	tMWFONT
;

146 
PMWFONTPROCS
 
	mf⁄çrocs
;

147 
MWCOORD
 
	mf⁄tsize
;

148 
	mf⁄åŸ©i⁄
;

149 
	mf⁄èâr
;

151 * 
	m«me
;

152 
PMWCFONT
 
	mcf⁄t
;

153 } 
	tMWCOREFONT
, *
	tPMWCOREFONT
;

160 
MWCOORD
 
	md°x
, 
	md°y
, 
	md°w
, 
	md°h
, 
	md°_löñí
;

161 
MWCOORD
 
	m§cx
, 
	m§cy
, 
	m§c_löñí
;

162 *
	mpixñs
, *
	mmisc
;

163 
MWPIXELVAL
 
	mbg_cﬁ‹
, 
	mfg_cﬁ‹
;

164 
	mgr_u£bg
;

165 } 
	tdrivî_gc_t
;

169 #i‡
MW_FEATURE_PSDOP_COPY


174 
	#PSDOP_COPY
 0

	)

179 
	#PSDOP_COPYALL
 1

	)

184 
	#PSDOP_COPYTRANS
 2

	)

188 #i‡
MW_FEATURE_PSDOP_ALPHAMAP


203 
	#PSDOP_ALPHAMAP
 3

	)

206 #i‡
MW_FEATURE_PSDOP_ALPHACOL


221 
	#PSDOP_ALPHACOL
 4

	)

224 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_LSB_FIRST


245 
	#PSDOP_BITMAP_BYTES_LSB_FIRST
 5

	)

248 #i‡
MW_FEATURE_PSDOP_BITMAP_BYTES_MSB_FIRST


269 
	#PSDOP_BITMAP_BYTES_MSB_FIRST
 6

	)

274 
PSD
 
	md°psd
;

275 
MWCOORD
 
	md°x
, 
	md°y
;

276 
MWCOORD
 
	md°w
, 
	md°h
;

277 
MWCOORD
 
	m§cx
, 
	m§cy
;

278 
MWCOORD
 
	m§cw
, 
	m§ch
;

279 
PSD
 
	m§˝sd
;

280 
	mr›
;

281 
PSD
 
	mÆphach™
;

282 
MWPIXELVAL
 
	mfgcﬁ‹
;

283 
MWPIXELVAL
 
	mbgcﬁ‹
;

284 
MWPIXELVAL
 
	må™scﬁ‹
;

285 } 
	tMWBLITARGS
, *
	tPMWBLITARGS
;

290 (*
	mInô
)(
PSD
 
	mpsd
);

291 (*
	mDøwPixñ
)(
PSD
 
	mpsd
, 
MWCOORD
 
	mx
, MWCOORD 
	my
, 
MWPIXELVAL
 
	mc
);

292 
MWPIXELVAL
 (*
RódPixñ
)(
PSD
 
	mpsd
, 
MWCOORD
 
	mx
, MWCOORD 
	my
);

293 (*
	mDøwH‹zLöe
)(
PSD
 
	mpsd
, 
MWCOORD
 
	mx1
, MWCOORD 
	mx2
, MWCOORD 
	my
,

294 
MWPIXELVAL
 
	mc
);

295 (*
	mDøwVîtLöe
)(
PSD
 
	mpsd
, 
MWCOORD
 
	mx
, MWCOORD 
	my1
, MWCOORD 
	my2
,

296 
MWPIXELVAL
 
	mc
);

297 (*
	mFûlRe˘
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx1
,MWCOORD 
	my1
,MWCOORD 
	mx2
,

298 
MWCOORD
 
	my2
,
MWPIXELVAL
 
	mc
);

299 (*
	mBlô
)(
PSD
 
	mde°psd
, 
MWCOORD
 
	mde°x
, MWCOORD 
	mde°y
, MWCOORD 
	mw
,

300 
MWCOORD
 
	mh
,
PSD
 
	m§˝sd
,MWCOORD 
	m§cx
,MWCOORD 
	m§cy
,
	m›
);

301 (*
	mDøwAªa
)(
PSD
 
	mpsd
, 
drivî_gc_t
 *
	mgc
, 
	m›
);

307 (*
	mSåëchBlô
)(
PSD
 
	mde°psd
, 
MWCOORD
 
	mde°x
, MWCOORD 
	mde°y
,

308 
MWCOORD
 
	md°w
, MWCOORD 
	md°h
, 
PSD
 
	m§˝sd
, MWCOORD 
	m§cx
,

309 
MWCOORD
 
	m§cy
, MWCOORD 
	m§cw
, MWCOORD 
	m§ch
, 
	m›
);

310 (*
	mSåëchBlôEx
Ë(
PSD
 
	md°psd
, PSD 
	m§˝sd
,

311 
MWCOORD
 
	mde°_x_°¨t
, 
	mde°_y_°¨t
,

312 
MWCOORD
 
	mwidth
, 
	mheight
,

313 
	mx_díomö©‹
, 
	my_díomö©‹
,

314 
	m§c_x_‰a˘i⁄
, 
	m§c_y_‰a˘i⁄
,

315 
	mx_°ï_‰a˘i⁄
, 
	my_°ï_‰a˘i⁄
, 
	m›
);

316 } 
	tSUBDRIVER
, *
	tPSUBDRIVER
;

322 
	s_mws¸ìndevi˚
 {

323 
MWCOORD
 
	mxªs
;

324 
MWCOORD
 
	myªs
;

325 
MWCOORD
 
	mxvúåes
;

326 
MWCOORD
 
	myvúåes
;

327 
	m∂™es
;

328 
	mbµ
;

329 
	mlöñí
;

331 
	msize
;

332 
	mncﬁ‹s
;

333 
	mpixty≥
;

334 
	mÊags
;

335 * 
	maddr
;

337 
PSD
 (*
O≥n
)(PSD 
	mpsd
);

338 (*
	mClo£
)(
PSD
 
	mpsd
);

339 (*
	mGëS¸ìnInfo
)(
PSD
 
	mpsd
,
PMWSCREENINFO
 
	mpsi
);

340 (*
	mSëPÆëã
)(
PSD
 
	mpsd
,
	mfú°
,
	mcou¡
,
MWPALENTRY
 *
	m∑l
);

341 (*
	mDøwPixñ
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx
,MWCOORD 
	my
,
MWPIXELVAL
 
	mc
);

342 
MWPIXELVAL
 (*
RódPixñ
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx
,MWCOORD 
	my
);

343 (*
	mDøwH‹zLöe
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx1
,MWCOORD 
	mx2
,MWCOORD 
	my
,

344 
MWPIXELVAL
 
	mc
);

345 (*
	mDøwVîtLöe
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx
,MWCOORD 
	my1
,MWCOORD 
	my2
,

346 
MWPIXELVAL
 
	mc
);

347 (*
	mFûlRe˘
)(
PSD
 
	mpsd
,
MWCOORD
 
	mx1
,MWCOORD 
	my1
,MWCOORD 
	mx2
,MWCOORD 
	my2
,

348 
MWPIXELVAL
 
	mc
);

349 
PMWCOREFONT
 
	mbuûtö_f⁄ts
;

354 (*
	mBlô
)(
PSD
 
	mde°psd
,
MWCOORD
 
	mde°x
,MWCOORD 
	mde°y
,MWCOORD 
	mw
,

355 
MWCOORD
 
	mh
,
PSD
 
	m§˝sd
,MWCOORD 
	m§cx
,MWCOORD 
	m§cy
,
	m›
);

356 (*
	mPªSñe˘
)(
PSD
 
	mpsd
);

357 (*
	mDøwAªa
)(
PSD
 
	mpsd
, 
drivî_gc_t
 *
	mgc
, 
	m›
);

358 (*
	mSëIOPîmissi⁄s
)(
PSD
 
	mpsd
);

359 
PSD
 (*
AŒoˇãMemGC
)(PSD 
	mpsd
);

360 
MWBOOL
 (*
M≠MemGC
)(
PSD
 
	mmempsd
,
MWCOORD
 
	mw
,MWCOORD 
	mh
,
	m∂™es
,
	mbµ
,

361 
	mlöñí
,
	msize
,*
	maddr
);

362 (*
	mFªeMemGC
)(
PSD
 
	mmempsd
);

363 (*
	mSåëchBlô
)(
PSD
 
	mde°psd
,
MWCOORD
 
	mde°x
,MWCOORD 
	mde°y
,

364 
MWCOORD
 
	mde°w
,MWCOORD 
	mde°h
,
PSD
 
	m§˝sd
,MWCOORD 
	m§cx
,

365 
MWCOORD
 
	m§cy
,MWCOORD 
	m§cw
,MWCOORD 
	m§ch
,
	m›
);

366 (*
	mSëP‹åaô
)(
PSD
 
	mpsd
,
	mp‹åaômode
);

367 
	mp‹åaô
;

368 
PSUBDRIVER
 
	m‹gsubdrivî
;

369 (*
	mSåëchBlôEx
Ë(
PSD
 
	md°psd
, PSD 
	m§˝sd
,

370 
MWCOORD
 
	mde°_x_°¨t
, MWCOORD 
	mde°_y_°¨t
,

371 
MWCOORD
 
	mwidth
, MWCOORD 
	mheight
,

372 
	mx_díomö©‹
, 
	my_díomö©‹
,

373 
	m§c_x_‰a˘i⁄
, 
	m§c_y_‰a˘i⁄
,

374 
	mx_°ï_‰a˘i⁄
, 
	my_°ï_‰a˘i⁄
,

375 
	m›
);

376 } 
	tSCREENDEVICE
;

379 
	#PSF_SCREEN
 0x0001

	)

380 
	#PSF_MEMORY
 0x0002

	)

381 
	#PSF_HAVEBLIT
 0x0004

	)

382 
	#PSF_HAVEOP_COPY
 0x0008

	)

383 
	#PSF_ADDRMALLOC
 0x0010

	)

384 
	#PSF_ADDRSHAREDMEM
 0x0020

	)

387 
	s_mou£devi˚
 {

388 (*
	mO≥n
)(
	m_mou£devi˚
 *);

389 (*
	mClo£
)();

390 (*
	mGëBuâ⁄Info
)();

391 (*
	mGëDeÁu…Ac˚l
)(*
	mpsˇÀ
,*
	m±hªsh
);

392 (*
	mRód
)(
MWCOORD
 *
	mdx
,MWCOORD *
	mdy
,MWCOORD *
	mdz
,*
	mbp
);

393 (*
	mPﬁl
)();

394 
	mÊags
;

395 } 
	tMOUSEDEVICE
;

397 
	#MOUSE_NORMAL
 0x0000

	)

398 
	#MOUSE_RAW
 0x0001

	)

399 
	#MOUSE_TRANSFORM
 0x0002

	)

402 
	s_kbddevi˚
 {

403 (*
	mO≥n
)(
_kbddevi˚
 *
	mpkd
);

404 (*
	mClo£
)();

405 (*
	mGëModifõrInfo
)(
MWKEYMOD
 *
	mmodifõrs
, MWKEYMOD *
	mcurmodifõrs
);

406 (*
	mRód
)(
MWKEY
 *
	mbuf
,
MWKEYMOD
 *
	mmodifõrs
,
MWSCANCODE
 *
	msˇncode
);

407 (*
	mPﬁl
)();

408 } 
	tKBDDEVICE
;

411 
	#CLIP_VISIBLE
 0

	)

412 
	#CLIP_INVISIBLE
 1

	)

413 
	#CLIP_PARTIAL
 2

	)

417 
MWCOORD
 
	mx
;

418 
MWCOORD
 
	my
;

419 
MWCOORD
 
	mwidth
;

420 
MWCOORD
 
	mheight
;

421 } 
	tMWCLIPRECT
;

424 
MWCOORD
 
	mwidth
;

425 
MWCOORD
 
	mheight
;

426 
PSD
 
	mpsd
;

427 } 
	tMWTILE
;

429 #i‚de‡
TRUE


430 
	#TRUE
 1

	)

432 #i‚de‡
FALSE


433 
	#FALSE
 0

	)

436 
	#MWMIN
(
a
,
b
Ë(◊Ë< (bË? (aË: (b))

	)

437 
	#MWMAX
(
a
,
b
Ë(◊Ë> (bË? (aË: (b))

	)

440 
	#RGBDEF
(
r
,
g
,
b
Ë{r, g, b}

	)

442 
	#GETPALENTRY
(
∑l
,
ödex
Ë(()’Æ[ödex].
r
 |\

443 (
∑l
[
ödex
].
g
 << 8Ë| (∑l[ödex].
b
 << 16)))

	)

446 
	#REDVALUE
(
rgb
Ë(‘gbË& 0xff)

	)

447 
	#GREENVALUE
(
rgb
Ë((‘gbË>> 8Ë& 0xff)

	)

448 
	#BLUEVALUE
(
rgb
Ë((‘gbË>> 16Ë& 0xff)

	)

455 
	#RGB2PIXEL8888
(
r
,
g
,
b
) \

456 (0xFF000000UL | ((
r
Ë<< 16Ë| ((
g
Ë<< 8Ë| (
b
))

	)

459 
	#ARGB2PIXEL8888
(
a
,
r
,
g
,
b
) \

460 (((
a
Ë<< 24Ë| ((
r
Ë<< 16Ë| ((
g
Ë<< 8Ë| (
b
))

	)

463 
	#RGB2PIXEL888
(
r
,
g
,
b
) \

464 (((
r
Ë<< 16Ë| ((
g
Ë<< 8Ë| (
b
))

	)

467 
	#RGB2PIXEL565
(
r
,
g
,
b
) \

468 ((((
r
Ë& 0xf8Ë<< 8Ë| (((
g
Ë& 0xfcË<< 3Ë| (((
b
Ë& 0xf8Ë>> 3))

	)

471 
	#RGB2PIXEL555
(
r
,
g
,
b
) \

472 ((((
r
Ë& 0xf8Ë<< 7Ë| (((
g
Ë& 0xf8Ë<< 2Ë| (((
b
Ë& 0xf8Ë>> 3))

	)

475 
	#RGB2PIXEL332
(
r
,
g
,
b
) \

476 (((
r
Ë& 0xe0Ë| (((
g
Ë& 0xe0Ë>> 3Ë| (((
b
Ë& 0xc0Ë>> 6))

	)

483 
	#COLOR2PIXEL8888
(
c
) \

484 ((((
c
Ë& 0xffË<< 16Ë| ((cË& 0xff00ff00ulË| (((cË& 0xff0000Ë>> 16))

	)

488 
	#COLOR2PIXEL888
(
c
) \

489 ((((
c
Ë& 0xffË<< 16Ë| ((cË& 0xff00Ë| (((cË& 0xff0000Ë>> 16))

	)

493 
	#COLOR2PIXEL565
(
c
) \

494 ((((
c
Ë& 0xf8Ë<< 8Ë| (((cË& 0xfc00Ë>> 5Ë| (((cË& 0xf80000Ë>> 19))

	)

498 
	#COLOR2PIXEL555
(
c
) \

499 ((((
c
Ë& 0xf8Ë<< 7Ë| (((cË& 0xf800Ë>> 6Ë| (((cË& 0xf80000Ë>> 19))

	)

503 
	#COLOR2PIXEL332
(
c
) \

504 (((
c
Ë& 0xe0Ë| (((cË& 0xe000Ë>> 11Ë| (((cË& 0xc00000Ë>> 22))

	)

510 
	#PIXEL8888ALPHA
(
pixñvÆ
Ë((’ixñvÆË>> 24Ë& 0xff)

	)

511 
	#PIXEL8888RED
(
pixñvÆ
Ë((’ixñvÆË>> 16Ë& 0xff)

	)

512 
	#PIXEL8888GREEN
(
pixñvÆ
Ë((’ixñvÆË>> 8Ë& 0xff)

	)

513 
	#PIXEL8888BLUE
(
pixñvÆ
Ë(’ixñvÆË& 0xff)

	)

516 
	#PIXEL888RED
(
pixñvÆ
Ë((’ixñvÆË>> 16Ë& 0xff)

	)

517 
	#PIXEL888GREEN
(
pixñvÆ
Ë((’ixñvÆË>> 8Ë& 0xff)

	)

518 
	#PIXEL888BLUE
(
pixñvÆ
Ë(’ixñvÆË& 0xff)

	)

521 
	#PIXEL565RED
(
pixñvÆ
Ë((’ixñvÆË>> 11Ë& 0x1f)

	)

522 
	#PIXEL565GREEN
(
pixñvÆ
Ë((’ixñvÆË>> 5Ë& 0x3f)

	)

523 
	#PIXEL565BLUE
(
pixñvÆ
Ë(’ixñvÆË& 0x1f)

	)

526 
	#PIXEL555RED
(
pixñvÆ
Ë((’ixñvÆË>> 10Ë& 0x1f)

	)

527 
	#PIXEL555GREEN
(
pixñvÆ
Ë((’ixñvÆË>> 5Ë& 0x1f)

	)

528 
	#PIXEL555BLUE
(
pixñvÆ
Ë(’ixñvÆË& 0x1f)

	)

531 
	#PIXEL332RED
(
pixñvÆ
Ë((’ixñvÆË>> 5Ë& 0x07)

	)

532 
	#PIXEL332GREEN
(
pixñvÆ
Ë((’ixñvÆË>> 2Ë& 0x07)

	)

533 
	#PIXEL332BLUE
(
pixñvÆ
Ë(’ixñvÆË& 0x03)

	)

539 
	#PIXEL8888ALPHA8
(
pixñvÆ
Ë((’ixñvÆË>> 24Ë& 0xff)

	)

540 
	#PIXEL8888RED8
(
pixñvÆ
Ë((’ixñvÆË>> 16Ë& 0xff)

	)

541 
	#PIXEL8888GREEN8
(
pixñvÆ
Ë((’ixñvÆË>> 8Ë& 0xff)

	)

542 
	#PIXEL8888BLUE8
(
pixñvÆ
Ë(’ixñvÆË& 0xff)

	)

545 
	#PIXEL888RED8
(
pixñvÆ
Ë((’ixñvÆË>> 16Ë& 0xff)

	)

546 
	#PIXEL888GREEN8
(
pixñvÆ
Ë((’ixñvÆË>> 8Ë& 0xff)

	)

547 
	#PIXEL888BLUE8
(
pixñvÆ
Ë(’ixñvÆË& 0xff)

	)

550 
	#PIXEL565RED8
(
pixñvÆ
Ë((’ixñvÆË>> 8Ë& 0xf8)

	)

551 
	#PIXEL565GREEN8
(
pixñvÆ
Ë((’ixñvÆË>> 3Ë& 0xfc)

	)

552 
	#PIXEL565BLUE8
(
pixñvÆ
Ë((’ixñvÆË<< 3Ë& 0xf8)

	)

555 
	#PIXEL555RED8
(
pixñvÆ
Ë((’ixñvÆË>> 7Ë& 0xf8)

	)

556 
	#PIXEL555GREEN8
(
pixñvÆ
Ë((’ixñvÆË>> 2Ë& 0xf8)

	)

557 
	#PIXEL555BLUE8
(
pixñvÆ
Ë((’ixñvÆË<< 3Ë& 0xf8)

	)

560 
	#PIXEL332RED8
(
pixñvÆ
Ë–’ixñvÆË& 0xe0)

	)

561 
	#PIXEL332GREEN8
(
pixñvÆ
Ë((’ixñvÆË<< 3Ë& 0xe0)

	)

562 
	#PIXEL332BLUE8
(
pixñvÆ
Ë((’ixñvÆË<< 6Ë& 0xc0)

	)

570 
	#PIXEL8888ALPHA32
(
pixñvÆ
Ë–(()’ixñvÆ)Ë& 0xff000000UL)

	)

571 
	#PIXEL8888RED32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 8Ë& 0xff000000UL)

	)

572 
	#PIXEL8888GREEN32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 16Ë& 0xff000000UL)

	)

573 
	#PIXEL8888BLUE32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 24Ë& 0xff000000UL)

	)

576 
	#PIXEL888RED32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 8Ë& 0xff000000UL)

	)

577 
	#PIXEL888GREEN32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 16Ë& 0xff000000UL)

	)

578 
	#PIXEL888BLUE32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 24Ë& 0xff000000UL)

	)

581 
	#PIXEL565RED32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 16Ë& 0xf8000000UL)

	)

582 
	#PIXEL565GREEN32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 21Ë& 0xfc000000UL)

	)

583 
	#PIXEL565BLUE32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 27Ë& 0xf8000000UL)

	)

586 
	#PIXEL555RED32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 17Ë& 0xf8000000UL)

	)

587 
	#PIXEL555GREEN32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 22Ë& 0xf8000000UL)

	)

588 
	#PIXEL555BLUE32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 27Ë& 0xf8000000UL)

	)

591 
	#PIXEL332RED32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 24Ë& 0xe0000000UL)

	)

592 
	#PIXEL332GREEN32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 27Ë& 0xe0000000UL)

	)

593 
	#PIXEL332BLUE32
(
pixñvÆ
Ë(((()’ixñvÆ)Ë<< 30Ë& 0xc0000000UL)

	)

599 
	#PIXEL8888TOCOLORVAL
(
p
) \

600 ((((
p
Ë& 0xff0000ulË>> 16Ë| (’Ë& 0xff00ff00ulË| ((’Ë& 0xffuË<< 16Ë| 0xff000000ul)

	)

603 
	#PIXEL888TOCOLORVAL
(
p
) \

604 (0xff000000u»| (((
p
Ë& 0xff0000ulË>> 16Ë| (’Ë& 0xff00uË| ((’Ë& 0xffuË<< 16Ë| 0xff000000ul)

	)

607 
	#PIXEL565TOCOLORVAL
(
p
) \

608 (0xff000000u»| (((
p
Ë& 0xf800uË>> 8Ë| ((’Ë& 0x07e0uË<< 5Ë| ((’Ë& 0x1fulË<< 19Ë| 0xff000000ul)

	)

610 
	#PIXEL555TOCOLORVAL
(
p
) \

611 (0xff000000u»| (((
p
Ë& 0x7c00uË>> 7Ë| ((’Ë& 0x03e0uË<< 6Ë| ((’Ë& 0x1fulË<< 19Ë| 0xff000000ul)

	)

614 
	#PIXEL332TOCOLORVAL
(
p
) \

615 (0xff000000u»| (((
p
Ë& 0xe0u)Ë| ((’Ë& 0x1cuË<< 11Ë| ((’Ë& 0x03ulË<< 19Ë| 0xff000000ul)

	)

617 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR8888


618 
	#RGB2PIXEL
(
r
,
g
,
b
Ë
	`RGB2PIXEL8888
‘,g,b)

	)

619 
	#COLORVALTOPIXELVAL
(
c
Ë
	`COLOR2PIXEL8888
(c)

	)

620 
	#PIXELVALTOCOLORVAL
(
p
Ë
	`PIXEL8888TOCOLORVAL
’)

	)

621 
	#PIXEL2RED
(
p
Ë
	`PIXEL8888RED
’)

	)

622 
	#PIXEL2GREEN
(
p
Ë
	`PIXEL8888GREEN
’)

	)

623 
	#PIXEL2BLUE
(
p
Ë
	`PIXEL8888BLUE
’)

	)

626 #i‡(
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR888
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR0888
)

627 
	#RGB2PIXEL
(
r
,
g
,
b
Ë
	`RGB2PIXEL888
‘,g,b)

	)

628 
	#COLORVALTOPIXELVAL
(
c
Ë
	`COLOR2PIXEL888
(c)

	)

629 
	#PIXELVALTOCOLORVAL
(
p
Ë
	`PIXEL888TOCOLORVAL
’)

	)

630 
	#PIXEL2RED
(
p
Ë
	`PIXEL888RED
’)

	)

631 
	#PIXEL2GREEN
(
p
Ë
	`PIXEL888GREEN
’)

	)

632 
	#PIXEL2BLUE
(
p
Ë
	`PIXEL888BLUE
’)

	)

635 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR565


636 
	#RGB2PIXEL
(
r
,
g
,
b
Ë
	`RGB2PIXEL565
‘,g,b)

	)

637 
	#COLORVALTOPIXELVAL
(
c
Ë
	`COLOR2PIXEL565
(c)

	)

638 
	#PIXELVALTOCOLORVAL
(
p
Ë
	`PIXEL565TOCOLORVAL
’)

	)

639 
	#PIXEL2RED
(
p
Ë
	`PIXEL565RED
’)

	)

640 
	#PIXEL2GREEN
(
p
Ë
	`PIXEL565GREEN
’)

	)

641 
	#PIXEL2BLUE
(
p
Ë
	`PIXEL565BLUE
’)

	)

644 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR555


645 
	#RGB2PIXEL
(
r
,
g
,
b
Ë
	`RGB2PIXEL555
‘,g,b)

	)

646 
	#COLORVALTOPIXELVAL
(
c
Ë
	`COLOR2PIXEL555
(c)

	)

647 
	#PIXELVALTOCOLORVAL
(
p
Ë
	`PIXEL555TOCOLORVAL
’)

	)

648 
	#PIXEL2RED
(
p
Ë
	`PIXEL555RED
’)

	)

649 
	#PIXEL2GREEN
(
p
Ë
	`PIXEL555GREEN
’)

	)

650 
	#PIXEL2BLUE
(
p
Ë
	`PIXEL555BLUE
’)

	)

653 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR332


654 
	#RGB2PIXEL
(
r
,
g
,
b
Ë
	`RGB2PIXEL332
‘,g,b)

	)

655 
	#COLORVALTOPIXELVAL
(
c
Ë
	`COLOR2PIXEL332
(c)

	)

656 
	#PIXELVALTOCOLORVAL
(
p
Ë
	`PIXEL332TOCOLORVAL
’)

	)

657 
	#PIXEL2RED
(
p
Ë
	`PIXEL332RED
’)

	)

658 
	#PIXEL2GREEN
(
p
Ë
	`PIXEL332GREEN
’)

	)

659 
	#PIXEL2BLUE
(
p
Ë
	`PIXEL332BLUE
’)

	)

667 
	#BLACK
 
	`PALINDEX
(0Ë

	)

668 
	#BLUE
 
	`PALINDEX
(1)

	)

669 
	#GREEN
 
	`PALINDEX
(2)

	)

670 
	#CYAN
 
	`PALINDEX
(3)

	)

671 
	#RED
 
	`PALINDEX
(4)

	)

672 
	#MAGENTA
 
	`PALINDEX
(5)

	)

673 
	#BROWN
 
	`PALINDEX
(6)

	)

674 
	#LTGRAY
 
	`PALINDEX
(7Ë

	)

675 
	#GRAY
 
	`PALINDEX
(8Ë

	)

676 
	#LTBLUE
 
	`PALINDEX
(9)

	)

677 
	#LTGREEN
 
	`PALINDEX
(10)

	)

678 
	#LTCYAN
 
	`PALINDEX
(11)

	)

679 
	#LTRED
 
	`PALINDEX
(12)

	)

680 
	#LTMAGENTA
 
	`PALINDEX
(13)

	)

681 
	#YELLOW
 
	`PALINDEX
(14)

	)

682 
	#WHITE
 
	`PALINDEX
(15Ë

	)

686 
	#LOADPALETTE
 1

	)

687 
	#MERGEPALETTE
 2

	)

692 
PSD
 
GdO≥nS¸ìn
();

693 
GdClo£S¸ìn
(
PSD
 
psd
);

694 
GdSëP‹åaôMode
(
PSD
 
psd
, 
p‹åaômode
);

695 
GdSëMode
(
mode
);

696 
MWBOOL
 
GdSëU£Background
(MWBOOL 
Êag
);

697 
MWPIXELVAL
 
GdSëF‹egroundPixñVÆ
(
PSD
 
psd
, MWPIXELVAL 
fg
);

698 
MWPIXELVAL
 
GdSëBackgroundPixñVÆ
(
PSD
 
psd
, MWPIXELVAL 
bg
);

699 
MWPIXELVAL
 
GdSëF‹egroundCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
fg
);

700 
MWPIXELVAL
 
GdSëBackgroundCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
bg
);

702 
GdRe£tPÆëã
();

703 
GdSëPÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
);

704 
GdGëPÆëã
(
PSD
 
psd
,
fú°
, 
cou¡
, 
MWPALENTRY
 *
∑Àâe
);

705 
MWCOLORVAL
 
GdGëCﬁ‹RGB
(
PSD
 
psd
, 
MWPIXELVAL
 
pixñ
);

706 
MWPIXELVAL
 
GdFödCﬁ‹
(
PSD
 
psd
, 
MWCOLORVAL
 
c
);

707 
MWPIXELVAL
 
GdFödNóª°Cﬁ‹
(
MWPALENTRY
 *
∑l
, 
size
, 
MWCOLORVAL
 
¸
);

708 
GdC≠tuªS¸ìn
(*
∑th
);

709 
GdGëS¸ìnInfo
(
PSD
 
psd
,
PMWSCREENINFO
 
psi
);

710 
GdPoöt
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
);

711 
GdLöe
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
,

712 
MWBOOL
 
bDøwLa°Poöt
);

713 
GdRe˘
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
);

714 
GdFûlRe˘
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
);

715 
GdBôm≠
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,MWCOORD 
height
,

716 c⁄° 
MWIMAGEBITS
 *
imagebôs
);

717 
MWBOOL
 
GdCﬁ‹InPÆëã
(
MWCOLORVAL
 
¸
,
MWPALENTRY
 *
∑Àâe
,
∑lsize
);

718 
GdMakePÆëãC⁄vîsi⁄TabÀ
(
PSD
 
psd
,
MWPALENTRY
 *
∑Àâe
,
∑lsize
,

719 
MWPIXELVAL
 *
c⁄vèbÀ
,
fLﬂdTy≥
);

720 
GdDøwImage
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, 
PMWIMAGEHDR
 
pimage
);

721 
GdPﬁy
(
PSD
 
psd
,
cou¡
, 
MWPOINT
 *
poöts
);

722 
GdFûlPﬁy
(
PSD
 
psd
,
cou¡
, 
MWPOINT
 *
poöts
);

723 
GdRódAªa
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,MWCOORD 
height
,

724 
MWPIXELVAL
 *
pixñs
);

725 
GdAªa
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,MWCOORD 
height
,

726 *
pixñs
, 
pixty≥
);

727 
GdDøwAªaI¡î«l
(
PSD
 
psd
, 
drivî_gc_t
 * 
gc
, 
›
);

728 
GdTøn¶©eAªa
(
MWCOORD
 
width
, MWCOORD 
height
, *
ö
, 
öpixty≥
,

729 
MWCOORD
 
öpôch
, *
out
, 
ouçixty≥
, 
ouçôch
);

730 
GdC›yAªa
(
PSD
 
psd
,
MWCOORD
 
§cx
,MWCOORD 
§cy
,MWCOORD 
width
,

731 
MWCOORD
 
height
, MWCOORD 
de°x
, MWCOORD 
de°y
);

732 
GdBlô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
width
,

733 
MWCOORD
 
height
,
PSD
 
§˝sd
,MWCOORD 
§cx
,MWCOORD 
§cy
,
r›
);

734 
GdSåëchBlô
(
PSD
 
d°psd
, 
MWCOORD
 
d°x
, MWCOORD 
d°y
, MWCOORD 
d°w
,

735 
MWCOORD
 
d°h
, 
PSD
 
§˝sd
, MWCOORD 
§cx
, MWCOORD 
§cy
,

736 
MWCOORD
 
§cw
, MWCOORD 
§ch
, 
r›
);

737 
GdSåëchBlôEx
(
PSD
 
d°psd
, 
MWCOORD
 
d1_x
, MWCOORD 
d1_y
, MWCOORD 
d2_x
,

738 
MWCOORD
 
d2_y
, 
PSD
 
§˝sd
, MWCOORD 
s1_x
, MWCOORD 
s1_y
,

739 
MWCOORD
 
s2_x
, MWCOORD 
s2_y
, 
r›
);

740 
GdCÆcMemGCAŒoc
(
PSD
 
psd
, 
width
, 
height
,

741 
∂™es
, 
bµ
, *
size
, *
löñí
);

742 
døwbôm≠
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

743 c⁄° 
MWIMAGEBITS
 *
imagebôs
);

744 
døwpoöt
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
);

745 
døwrow
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
);

746 
SCREENDEVICE
 
s¸dev
;

751 
GdArcAngÀ
(
PSD
 
psd
, 
MWCOORD
 
x0
, MWCOORD 
y0
, MWCOORD 
rx
, MWCOORD 
ry
,

752 
MWCOORD
 
™gÀ1
, MWCOORD 
™gÀ2
, 
ty≥
);

754 
GdArc
(
PSD
 
psd
, 
MWCOORD
 
x0
, MWCOORD 
y0
, MWCOORD 
rx
, MWCOORD 
ry
,

755 
MWCOORD
 
ax
, MWCOORD 
ay
, MWCOORD 
bx
, MWCOORD 
by
, 
ty≥
);

756 
GdEŒù£
(
PSD
 
psd
,
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
rx
, MWCOORD 
ry
,

757 
MWBOOL
 
fûl
);

760 
GdCÀ¨F⁄tLi°
();

761 
GdAddF⁄t
(*
‚dry
, *
Ámûy
, *
f⁄äame
, 
PMWLOGFONT
 
lf
,

762 
Êags
);

763 
PMWFONT
 
GdSëF⁄t
(PMWFONT 
pf⁄t
);

764 
PMWFONT
 
GdCª©eF⁄t
(
PSD
 
psd
, c⁄° *
«me
, 
MWCOORD
 
height
,

765 c⁄° 
PMWLOGFONT
 
∂ogf⁄t
);

766 
MWCOORD
 
GdSëF⁄tSize
(
PMWFONT
 
pf⁄t
, MWCOORD 
f⁄tsize
);

767 
GdGëF⁄tLi°
(
MWFONTLIST
 ***
li°
, *
num
);

768 
GdFªeF⁄tLi°
(
MWFONTLIST
 ***
li°
, 
num
);

769 
GdSëF⁄tRŸ©i⁄
(
PMWFONT
 
pf⁄t
, 
ã¡hdegªes
);

770 
GdSëF⁄tAâr
(
PMWFONT
 
pf⁄t
, 
£tÊags
, 
˛rÊags
);

771 
GdDe°royF⁄t
(
PMWFONT
 
pf⁄t
);

772 
MWBOOL
 
GdGëF⁄tInfo
(
PMWFONT
 
pf⁄t
, 
PMWFONTINFO
 
pf⁄töfo
);

773 
GdC⁄vîtEncodög
(c⁄° *
i°r
, 
MWTEXTFLAGS
 
iÊags
, 
cc
, *
o°r
,

774 
MWTEXTFLAGS
 
oÊags
);

775 
GdGëTextSize
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
, 
MWCOORD
 *
pwidth
,

776 
MWCOORD
 *
pheight
, MWCOORD *
pba£
, 
MWTEXTFLAGS
 
Êags
);

777 
GdGëTextSizeEx
(
PMWFONT
 
pf⁄t
, c⁄° *
°r
, 
cc
,

778 
nMaxExã¡
, *
ÕnFô
, *
ÆpDx
, 
MWCOORD
 *
pwidth
,

779 
MWCOORD
 *
pheight
, MWCOORD *
pba£
, 
MWTEXTFLAGS
 
Êags
);

780 
GdText
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
,c⁄° *
°r
,
cou¡
,

781 
MWTEXTFLAGS
 
Êags
);

782 
PMWFONT
 
GdCª©eF⁄tFromBuf„r
(
PSD
 
psd
, c⁄° *
buf„r
,

783 
Àngth
, c⁄° *
f‹m©
, 
MWCOORD
 
height
);

784 
PMWFONT
 
GdDu∂iˇãF⁄t
(
PSD
 
psd
, PMWFONT 
p§cf⁄t
, 
MWCOORD
 
f⁄tsize
);

787 
GdSëClùRe˘s
(
PSD
 
psd
,
cou¡
,
MWCLIPRECT
 *
èbÀ
);

788 
MWBOOL
 
GdClùPoöt
(
PSD
 
psd
,
MWCOORD
 
x
,MWCOORD 
y
);

789 
GdClùAªa
(
PSD
 
psd
,
MWCOORD
 
x1
, MWCOORD 
y1
, MWCOORD 
x2
, MWCOORD 
y2
);

790 
MWCOORD
 
˛ùmöx
, 
˛ùmöy
, 
˛ùmaxx
, 
˛ùmaxy
;

793 
GdSëClùRegi⁄
(
PSD
 
psd
, 
MWCLIPREGION
 *
ªg
);

796 
MWBOOL
 
GdPtInRegi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
x
, MWCOORD 
y
);

797 
GdRe˘InRegi⁄
(
MWCLIPREGION
 *
rgn
, c⁄° 
MWRECT
 *
ª˘
);

798 
MWBOOL
 
GdEquÆRegi⁄
(
MWCLIPREGION
 *
r1
, MWCLIPREGION *
r2
);

799 
MWBOOL
 
GdEm±yRegi⁄
(
MWCLIPREGION
 *
rgn
);

800 
MWCLIPREGION
 *
GdAŒocRegi⁄
();

801 
MWCLIPREGION
 *
GdAŒocRe˘Regi⁄
(
MWCOORD
 
À·
,MWCOORD 
t›
,MWCOORD 
right
,MWCOORD 
bŸtom
);

802 
MWCLIPREGION
 *
GdAŒocRe˘Regi⁄Indúe˘
(
MWRECT
 *
¥c
);

803 
GdSëRe˘Regi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
À·
, MWCOORD 
t›
,

804 
MWCOORD
 
right
, MWCOORD 
bŸtom
);

805 
GdSëRe˘Regi⁄Indúe˘
(
MWCLIPREGION
 *
rgn
, 
MWRECT
 *
¥c
);

806 
GdDe°royRegi⁄
(
MWCLIPREGION
 *
rgn
);

807 
GdOff£tRegi⁄
(
MWCLIPREGION
 *
rgn
, 
MWCOORD
 
x
, MWCOORD 
y
);

808 
GdGëRegi⁄Box
(
MWCLIPREGION
 *
rgn
, 
MWRECT
 *
¥c
);

809 
GdUni⁄Re˘WôhRegi⁄
(c⁄° 
MWRECT
 *
ª˘
, 
MWCLIPREGION
 *
rgn
);

810 
GdSubåa˘Re˘FromRegi⁄
(c⁄° 
MWRECT
 *
ª˘
, 
MWCLIPREGION
 *
rgn
);

811 
GdC›yRegi⁄
(
MWCLIPREGION
 *
d
, MWCLIPREGION *
s
);

812 
GdI¡î£˘Regi⁄
(
MWCLIPREGION
 *
d
, MWCLIPREGION *
s1
, MWCLIPREGION *
s2
);

813 
GdUni⁄Regi⁄
(
MWCLIPREGION
 *
d
, MWCLIPREGION *
s1
, MWCLIPREGION *
s2
);

814 
GdSubåa˘Regi⁄
(
MWCLIPREGION
 *
d
, MWCLIPREGION *
s1
, MWCLIPREGION *
s2
);

815 
GdX‹Regi⁄
(
MWCLIPREGION
 *
d
, MWCLIPREGION *
s1
, MWCLIPREGION *
s2
);

816 
MWCLIPREGION
 *
GdAŒocBôm≠Regi⁄
(
MWIMAGEBITS
 *
bôm≠
, 
MWCOORD
 
width
, MWCOORD 
height
);

819 
MWCLIPREGION
 *
GdAŒocPﬁyg⁄Regi⁄
(
MWPOINT
 *
poöts
, 
cou¡
, 
mode
);

820 
MWCLIPREGION
 *
GdAŒocPﬁyPﬁyg⁄Regi⁄
(
MWPOINT
 *
poöts
, *
cou¡
,

821 
nbpﬁyg⁄s
, 
mode
);

824 
GdO≥nMou£
();

825 
GdClo£Mou£
();

826 
GdGëBuâ⁄Info
(*
buâ⁄s
);

827 
GdRe°ri˘Mou£
(
MWCOORD
 
√wmöx
,MWCOORD 
√wmöy
,MWCOORD 
√wmaxx
,

828 
MWCOORD
 
√wmaxy
);

829 
GdSëAc˚lMou£
(
√wthªsh
, 
√wsˇÀ
);

830 
GdMoveMou£
(
MWCOORD
 
√wx
, MWCOORD 
√wy
);

831 
GdRódMou£
(
MWCOORD
 *
px
, MWCOORD *
py
, *
pb
);

832 
GdMoveCurs‹
(
MWCOORD
 
x
, MWCOORD 
y
);

833 
MWBOOL
 
GdGëCurs‹Pos
(
MWCOORD
 *
px
, MWCOORD *
py
);

834 
GdSëCurs‹
(
PMWCURSOR
 
pcurs‹
);

835 
GdShowCurs‹
(
PSD
 
psd
);

836 
GdHideCurs‹
(
PSD
 
psd
);

837 
GdCheckCurs‹
(
PSD
 
psd
,
MWCOORD
 
x1
,MWCOORD 
y1
,MWCOORD 
x2
,MWCOORD 
y2
);

838 
GdFixCurs‹
(
PSD
 
psd
);

839 
GdSëTønsf‹m
(
MWTRANSFORM
 *);

841 
MOUSEDEVICE
 
mou£dev
;

844 
GdO≥nKeybﬂrd
();

845 
GdClo£Keybﬂrd
();

846 
GdGëModifõrInfo
(
MWKEYMOD
 *
modifõrs
, MWKEYMOD *
curmodifõrs
);

847 
GdRódKeybﬂrd
(
MWKEY
 *
buf
, 
MWKEYMOD
 *
modifõrs
, 
MWSCANCODE
 *
sˇncode
);

848 
KBDDEVICE
 
kbddev
;

850 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


851 
GdO≥nKeybﬂrd2
();

852 
KBDDEVICE
 
kbddev2
;

856 #i‡
MW_FEATURE_IMAGES


857 
GdLﬂdImageFromBuf„r
(
PSD
 
psd
, *
buf„r
, 
size
, 
Êags
);

858 
GdDøwImageFromBuf„r
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

859 
MWCOORD
 
height
, *
buf„r
, 
size
, 
Êags
);

860 
GdDøwImageFromFûe
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

861 
MWCOORD
 
height
, *
∑th
, 
Êags
);

862 
GdLﬂdImageFromFûe
(
PSD
 
psd
, *
∑th
, 
Êags
);

863 
GdDøwImageToFô
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

864 
MWCOORD
 
height
, 
id
);

865 
GdFªeImage
(
id
);

866 
MWBOOL
 
GdGëImageInfo
(
id
, 
PMWIMAGEINFO
 
pii
);

867 
GdSåëchImage
(
PMWIMAGEHDR
 
§c
, 
MWCLIPRECT
 *
§¸e˘
, PMWIMAGEHDR 
d°
,

868 
MWCLIPRECT
 *
d°ª˘
);

869 
GdCompuãImagePôch
(
bµ
, 
width
, *
pôch
, *
byã•îpixñ
);

873 *
	m°¨t
;

874 
	moff£t
;

875 
	msize
;

876 } 
	tbuf„r_t
;

877 
GdImageBuf„rInô
(
buf„r_t
 *
buf„r
, *
°¨td©a
, 
size
);

878 
GdImageBuf„rSìkTo
(
buf„r_t
 *
buf„r
, 
off£t
);

879 
GdImageBuf„rRód
(
buf„r_t
 *
buf„r
, *
de°
, 
size
);

880 
GdImageBuf„rGëCh¨
(
buf„r_t
 *
buf„r
);

881 * 
GdImageBuf„rGëSåög
(
buf„r_t
 *
buf„r
, *
de°
, 
size
);

882 
GdImageBuf„rEOF
(
buf„r_t
 *
buf„r
);

885 #ifde‡
HAVE_BMP_SUPPORT


886 
GdDecodeBMP
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
);

888 #ifde‡
HAVE_JPEG_SUPPORT


889 
GdDecodeJPEG
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
, 
PSD
 
psd
, 
MWBOOL
 
Á°_gøysˇÀ
);

891 #ifde‡
HAVE_PNG_SUPPORT


892 
GdDecodePNG
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
);

894 #ifde‡
HAVE_GIF_SUPPORT


895 
GdDecodeGIF
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
);

897 #ifde‡
HAVE_PNM_SUPPORT


898 
GdDecodePNM
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
);

900 #ifde‡
HAVE_XPM_SUPPORT


901 
GdDecodeXPM
(
buf„r_t
 *
§c
, 
PMWIMAGEHDR
 
pimage
, 
PSD
 
psd
);

903 #ifde‡
HAVE_TIFF_SUPPORT


904 
GdDecodeTIFF
(*
∑th
, 
PMWIMAGEHDR
 
pimage
);

910 
	#MWITEM_OFFSET
(
ty≥
, 
fõld
Ë(()&((—y≥ *)0)->fõld))

	)

912 * 
GdIãmAŒoc
(
size
);

913 
GdLi°Add
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
);

914 
GdLi°In£π
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
);

915 
GdLi°Remove
(
PMWLISTHEAD
 
pHód
,
PMWLIST
 
pIãm
);

916 
	#GdIãmNew
(
ty≥
Ë(—y≥ *)
	`GdIãmAŒoc
(—y≥)))

	)

917 
	#GdIãmFªe
(
±r
Ë
	`‰ì
((*Ìå)

	)

920 
GdSëDash
(*
mask
, *
cou¡
);

921 
GdSëStù∂eBôm≠
(
MWIMAGEBITS
 *
°ù∂e
, 
MWCOORD
 
width
, MWCOORD 
height
);

922 
GdSëTSOff£t
(
xoff
, 
yoff
);

923 
GdSëFûlMode
(
mode
);

924 
GdSëTûePixm≠
(
PSD
 
§c
, 
MWCOORD
 
width
, MWCOORD 
height
);

925 
ts_døwpoöt
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
);

926 
ts_døwrow
(
PSD
 
psd
, 
MWCOORD
 
x1
, MWCOORD 
x2
, MWCOORD 
y
);

927 
ts_fûÃe˘
(
PSD
 
psd
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
w
, MWCOORD 
h
);

928 
£t_ts_‹igö
(
x
, 
y
);

931 
	#GdIãmAddr
(
p
,
ty≥
,
li°
Ë(—y≥ *)((Ì - 
	`MWITEM_OFFSET
—y≥,li°)))

	)

933 #i‡
MW_FEATURE_TIMERS


934 
	~<sys/time.h
>

936 (*
	tMWTIMERCB
)(*);

938 
	#MWTIMER_ONESHOT
 0

	)

939 
	#MWTIMER_PERIODIC
 1

	)

941 
mw_timî
 
	tMWTIMER
;

942 
	smw_timî
 {

943 
timevÆ
 
timeout
;

944 
MWTIMERCB
 
ˇŒback
;

945 *
¨g
;

946 
MWTIMER
 *
√xt
;

947 
MWTIMER
 *
¥ev
;

948 
ty≥
;

949 
MWTIMEOUT
 
≥riod
;

952 
MWTIMER
 *
	`GdAddTimî
(
MWTIMEOUT
 
timeout
, 
MWTIMERCB
 
ˇŒback
, *
¨g
);

953 
MWTIMER
 *
	`GdAddPîiodicTimî
(
MWTIMEOUT
 
timeout
, 
MWTIMERCB
 
ˇŒback
, *
¨g
);

954 
	`GdDe°royTimî
(
MWTIMER
 *
timî
);

955 
MWTIMER
 *
	`GdFödTimî
(*
¨g
);

956 
MWBOOL
 
	`GdGëNextTimeout
(
timevÆ
 *
tv
, 
MWTIMEOUT
 
timeout
);

957 
MWBOOL
 
	`GdTimeout
();

962 
	`GdEº‹
(c⁄° *
f‹m©
, ...);

963 
	`GdEº‹NuŒ
(c⁄° *
f‹m©
, ...);

965 #i‡
USE_ALLOCA


967 
	#ALLOCA
(
size
Ë
	`Æloˇ
(size)

	)

968 
	#FREEA
(
pmem
)

	)

971 
	#ALLOCA
(
size
Ë
	`mÆloc
(size)

	)

972 
	#FREEA
(
pmem
Ë
	`‰ì
’mem)

	)

976 #i‡
MSDOS
 | 
ELKS


977 #unde‡
as£π


978 
	#as£π
(
x
)

	)

982 #i‡
__πems__


983 
	#maö
 
πems_maö


	)

986 #i‡!
_MINIX


987 #i‡(!
	`deföed
(
__πems__
Ë&& !deföed(
PSP
))

988 
	#HAVESELECT
 1

	)

	@include/graph3d.h

7 #i‚de‡
_GRAPH3D_H_


8 
	#_GRAPH3D_H_


	)

10 
	~<m©h.h
>

12 
	#pi
 3.1415926535

	)

13 
	#ïsû⁄
 0.000001

	)

14 
	#MAXPOLY
 32

	)

16 
FLOAT
 
	tvec1
;

19 
FLOAT
 
	mx
, 
	my
;

20 } 
	tvec2
;

23 
FLOAT
 
	mx
, 
	my
, 
	mz
;

24 } 
	tvec3
;

27 
öô3
(
HDC
 
hDC
,
HWND
 
hwndmem
);

28 
∑öt3
(
HDC
 
hDC
);

29 
£tcﬁ‹3
(
MWCOLORVAL
 
c
);

30 
movëo3
(
vec2
 
±
);

31 
löëo3
(
vec2
 
±
);

32 
pﬁyfûl
(
n
, 
vec2
 
poöts
[]);

33 
squ¨e
();

34 
cú˛e3
(
vec1
 
r
);

35 
daisy
(
vec1
 
r
,
poöts
);

36 
ro£
(
vec1
 
r
,
Àvñs
,
poöts
);

37 
åüngÀ
(
vec2
 
v0
, vec2 
v1
, vec2 
v2
);

38 
quadrû©îÆ
(
vec2
 
v0
, vec2 
v1
, vec2 
v2
, vec2 
v3
);

39 
look3
(
vec1
 
x
, vec1 
y
, vec1 
z
);

40 
døwgrid
(
vec1
 
xmö
, vec1 
xmax
, 
nx
, vec1 
zmö
, vec1 
zmax
, 
nz
);

41 
sˇÀ3
(
vec1
 
sx
, vec1 
sy
, vec1 
sz
, 
A
[][5]);

42 
å™3
(
vec1
 
tx
, vec1 
ty
, vec1 
tz
, 
A
[][5]);

43 
rŸ3
(
m
, 
vec1
 
thëa
, 
A
[][5]);

44 
mu…3
(
A
[][5], 
B
[][5], 
C
[][5]);

45 
födQ
();

	@include/lock.h

12 #i‡
THREADSAFE


13 
	#THREADSAFE_LINUX
 1

	)

19 #i‡
THREADSAFE_LINUX


20 
	#__USE_GNU


	)

21 
	~<±hªad.h
>

22 
±hªad_muãx_t
 
	tMWMUTEX
;

24 #i‡!
deföed
(
__CYGWIN__
)

30 
	#LOCK_DECLARE
(
«me
Ë
MWMUTEX
Çamê
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP


	)

31 
	#LOCK_INIT
(
m
)

	)

40 
	#LOCK_DECLARE
(
«me
Ë
MWMUTEX
 
	)
name

48 
	#LOCK_INIT
(
m
) \

50 
±hªad_muãx©å_t
 
©å
; \

51 
	`±hªad_muãx©å_öô
(&
©å
); \

52 
	`±hªad_muãx©å_£ây≥
(&
©å
, 
PTHREAD_MUTEX_RECURSIVE
); \

53 
	`±hªad_muãx_öô
((
m
), &
©å
); \

54 }

	)

57 
	#LOCK_INIT
(
m
) \

59 
±hªad_muãx©å_t
 
©å
; \

60 
	`±hªad_muãx©å_öô
(&
©å
); \

61 
	`±hªad_muãx©å_£tköd_≈
(&
©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

62 
	`±hªad_muãx_öô
((
m
), &
©å
); \

63 }

	)

67 
	#LOCK_EXTERN
(
«me
Ë
MWMUTEX
 
	)
name

68 
	#LOCK_FREE
(
m
Ë
	`±hªad_muãx_de°roy
(m)

	)

69 
	#LOCK
(
m
Ë
	`±hªad_muãx_lock
(m)

	)

70 
	#UNLOCK
(
m
Ë
	`±hªad_muãx_u∆ock
(m)

	)

74 #i‡!
THREADSAFE


75 
	tMWMUTEX
;

77 
	#LOCK_DECLARE
(
«me
Ë
MWMUTEX
 
	)
name

78 
	#LOCK_EXTERN
(
«me
Ë
MWMUTEX
 
	)
name

79 
	#LOCK_INIT
(
m
)

	)

80 
	#LOCK_FREE
(
m
)

	)

81 
	#LOCK
(
m
)

	)

82 
	#UNLOCK
(
m
)

	)

	@include/mwobjects.h

8 #i‡!
deföed
 (
_MWOBJECTS_H_
)

9 
	#_MWOBJECTS_H_


	)

13 
	~"wödows.h
"

14 
	~"wöã∫.h
"

15 
	~"gøph3d.h
"

18 
	~<£t
>

19 
	~<io°ªam
>

21 
«me•a˚
 
	gMi¸oWödowsObje˘s


23 
˛ass
 
	gFûeDes¸ùt‹
;

31 ˛as†
	cWödowCœss


33 
	gpublic
:

35 
WödowCœss
 ();

36 
WödowCœss
 (
LPCSTR
 
ÕszCœssName
,

37 
UINT
 
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
,

38 
cbClsExåa
 = 0,

39 
cbWndExåa
 = 0,

40 
HINSTANCE
 
hIn°™˚
 = 0,

41 
HICON
 
hIc⁄
 = 0,

42 
HCURSOR
 
hCurs‹
 = 0,

43 
HBRUSH
 
hbrBackground
 = 0,

44 
LPCSTR
 
ÕszMíuName
 = 0);

46 
£t_°yÀ
 (
UINT
 
°yÀ
)

47 { 
	gw˛ass
.
	g°yÀ
 = 
°yÀ
; }

49 
£t_˛ass_exåa
 (
cbClsExåa
)

50 { 
	gw˛ass
.
	gcbClsExåa
 = 
cbClsExåa
; }

52 
£t_wödow_exåa
 (
cbWndExåa
)

53 { 
	gw˛ass
.
	gcbWndExåa
 = 
cbWndExåa
; }

55 
£t_ö°™˚
 (
HINSTANCE
 
hIn°™˚
)

56 { 
	gw˛ass
.
	ghIn°™˚
 = 
hIn°™˚
; }

58 
£t_ic⁄
 (
HICON
 
hIc⁄
)

59 { 
	gw˛ass
.
	ghIc⁄
 = 
hIc⁄
; }

61 
£t_curs‹
 (
HCURSOR
 
hCurs‹
)

62 { 
	gw˛ass
.
	ghCurs‹
 = 
hCurs‹
; }

64 
£t_background
 (
HBRUSH
 
hbrBackground
)

65 { 
	gw˛ass
.
	ghbrBackground
 = 
hbrBackground
; }

67 
£t_míu_«me
 (
LPCSTR
 
ÕszMíuName
)

68 { 
	gw˛ass
.
	gÕszMíuName
 = 
ÕszMíuName
; }

70 
ATOM
 
ªgi°î_˛ass
 ();

72 
	g¥iv©e
:

79 
WNDCLASS
 
w˛ass
;

82 ˛as†
	cWödow


84 
‰õnd
 
	gWödowCœss
;

86 
	gpublic
:

88 
Wödow
 ();

89 
Wödow
 (
DWORD
 
dwExStyÀ
,

90 
LPCSTR
 
ÕCœssName
,

91 
LPCSTR
 
ÕWödowName
,

92 
DWORD
 
dwStyÀ
,

93 
x
,

94 
y
,

95 
nWidth
,

96 
nHeight
,

97 
HWND
 
hwndP¨ít
,

98 
HMENU
 
hMíu
,

99 
HINSTANCE
 
hIn°™˚
,

100 
LPVOID
 
ÕP¨am
);

102 
	gvútuÆ
 ~
Wödow
 ();

104 
HWND
 
¸óã
 (
DWORD
 
dwExStyÀ
,

105 
LPCSTR
 
ÕCœssName
,

106 
LPCSTR
 
ÕWödowName
,

107 
DWORD
 
dwStyÀ
,

108 
x
,

109 
y
,

110 
nWidth
,

111 
nHeight
,

112 
HWND
 
hwndP¨ít
,

113 
HMENU
 
hMíu
,

114 
HINSTANCE
 
hIn°™˚
,

115 
LPVOID
 
ÕP¨am
);

117 
BOOL
 
de°‹y
 ();

119 
HWND
 
gë_h™dÀ
 () const

120 {  
	ghwnd
; }

121 
›î©‹
 
HWND
 () const

122 {  
gë_h™dÀ
 (); }

124 
BOOL
 
is_visibÀ
 ()

125 {  
IsWödowVisibÀ
 (
hwnd
); }

126 
BOOL
 
show
 (
nCmdShow
)

127 {  ::
ShowWödow
 (
hwnd
, 
nCmdShow
); }

128 
BOOL
 
upd©e
 ()

129 {  ::
Upd©eWödow
 (
hwnd
); }

130 
BOOL
 
övÆid©e_ª˘
 (
CONST
 
RECT
 *
ÕRe˘
, BOOL 
bEø£
)

131 {  ::
InvÆid©eRe˘
 (
hwnd
, 
ÕRe˘
, 
bEø£
); }

133 
HWND
 
gë_focus
 ()

134 {  ::
GëFocus
 (); }

135 
HWND
 
£t_focus
 ()

136 {  ::
SëFocus
 (
hwnd
); }

138 
BOOL
 
move
 (
x
, 
y
, 
nWidth
, 
nHeight
, BOOL 
bRïaöt
)

139 {  
MoveWödow
 (
hwnd
, 
x
, 
y
, 
nWidth
, 
nHeight
, 
bRïaöt
); }

142 
BOOL
 
˛õ¡_to_s¸ìn
 (
LPPOINT
 
ÕPoöt
)

143 {  ::
Clõ¡ToS¸ìn
 (
hwnd
, 
ÕPoöt
); }

144 
BOOL
 
s¸ìn_to_˛õ¡
 (
LPPOINT
 
ÕPoöt
)

145 {  ::
Clõ¡ToS¸ìn
 (
hwnd
, 
ÕPoöt
); }

147 
LONG
 
gë_l⁄g
 (
nIndex
)

148 {  ::
GëWödowL⁄g
 (
hwnd
, 
nIndex
); }

149 
LONG
 
£t_l⁄g
 (
nIndex
, LONG 
wNewL⁄g
)

150 {  ::
SëWödowW‹d
 (
hwnd
, 
nIndex
, 
wNewL⁄g
); }

151 
WORD
 
gë_w‹d
 (
nIndex
)

152 {  ::
GëWödowW‹d
 (
hwnd
, 
nIndex
); }

153 
WORD
 
£t_w‹d
 (
nIndex
, WORD 
wNewW‹d
)

154 {  ::
SëWödowW‹d
 (
hwnd
, 
nIndex
, 
wNewW‹d
); }

156 
DWORD
 
gë_˛ass_l⁄g
 (
nIndex
)

157 {  ::
GëCœssL⁄g
 (
hwnd
, 
nIndex
); }

159 
gë_ãxt
 (
LPSTR
 
ÕSåög
, 
nMaxCou¡
)

160 {  
GëWödowText
 (
hwnd
, 
ÕSåög
, 
nMaxCou¡
); }

161 
BOOL
 
£t_ãxt
 (
LPCSTR
 
ÕSåög
)

162 {  
SëWödowText
 (
hwnd
, 
ÕSåög
); }

168 
vútuÆ
 
boﬁ
 
©èch
 (c⁄° 
fd
, 
FûeDes¸ùt‹
& 
fûe_des¸ùt‹
);

169 
vútuÆ
 
boﬁ
 
dëach
 (
FûeDes¸ùt‹
& 
fûe_des¸ùt‹
);

171 
	g¥Ÿe˘ed
:

179 
vútuÆ
 
LRESULT
 
mesßge_h™dÀr
 (
UINT
 
msg
,

180 
WPARAM
 
wP¨am
,

181 
LPARAM
 
lP¨am
);

183 
	g¥iv©e
:

189 
LRESULT
 
CALLBACK
 
WndProc
 (
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
);

191 
HWND
 
	ghwnd
;

192 
LPVOID
 
	gÕCª©eP¨ams
;

198 
	s…öt


200 
boﬁ
 
›î©‹
(Ë(c⁄° 
FûeDes¸ùt‹
* 
	gf1
, c⁄° FûeDes¸ùt‹* 
	gf2
) const;

203 
	g£t
<
	gFûeDes¸ùt‹
*, 
	g…öt
> 
	gfûe_des¸ùt‹s
;

207 ˛as†
	cRe˘


209 
	gpublic
:

211 
Re˘
 ()

212 { 
em±y
 (); }

213 
Re˘
 (
xLe·
, 
yT›
, 
xRight
, 
yBŸtom
)

214 { 
£t
 (
xLe·
, 
yT›
, 
xRight
, 
yBŸtom
); }

215 
Re˘
 (
HWND
 
hwnd
)

216 { 
gë_wödow
 (
hwnd
); }

218 
BOOL
 
gë_wödow
 (
HWND
 
hwnd
)

219 {  
GëWödowRe˘
 (
hwnd
, &
ª˘
); }

220 
BOOL
 
gë_˛õ¡
 (
HWND
 
hwnd
)

221 {  
GëClõ¡Re˘
 (
hwnd
, &
ª˘
); }

223 
BOOL
 
£t
 (
xLe·
, 
yT›
, 
xRight
, 
yBŸtom
)

224 {  ::
SëRe˘
 (&
ª˘
, 
xLe·
, 
yT›
, 
xRight
, 
yBŸtom
); }

226 
BOOL
 
em±y
 ()

227 {  ::
SëRe˘Em±y
 (&
ª˘
); }

229 
	gRe˘
& 
	g›î©‹
(c⁄° 
Re˘
& 
Ÿhî
)

230 { 
C›yRe˘
 (&
ª˘
, &
Ÿhî
.ª˘);  *
	gthis
; }

232 
›î©‹
 
boﬁ
 () const

233 {  ::
IsRe˘Em±y
 (&
ª˘
); }

235 
›î©‹
 
	gRECT
* ()

236 {  &
	gª˘
; }

238 
BOOL
 
c›y
 (
LPRECT
 
ÕRe˘D°
)

239 {  ::
C›yRe˘
 (
ÕRe˘D°
, &
ª˘
); }

241 
BOOL
 
öÊ©e
 (
dx
, 
dy
)

242 {  ::
InÊ©eRe˘
 (&
ª˘
, 
dx
, 
dy
); }

244 
BOOL
 
off£t
 (
dx
, 
dy
)

245 {  ::
Off£tRe˘
 (&
ª˘
, 
dx
, 
dy
); }

247 
BOOL
 
poöt_öside
 (
POINT
 
Poöt
)

248 {  
PtInRe˘
 (&
ª˘
, 
Poöt
); }

250 
MWCOORD
 
À·
 () const

251 {  
	gª˘
.
	gÀ·
; }

252 
MWCOORD
 
t›
 () const

253 {  
	gª˘
.
	gt›
; }

254 
MWCOORD
 
right
 () const

255 {  
	gª˘
.
	gright
; }

256 
MWCOORD
 
bŸtom
 () const

257 {  
	gª˘
.
	gbŸtom
; }

259 
	g¥iv©e
:

261 
RECT
 
ª˘
;

264 
ölöe
 
	go°ªam
& 
	g›î©‹
<< (o°ªam& 
	gs
, c⁄° 
	gRe˘
& 
	gr
) {

265 
	gs
 << "rect"

266 << "÷=" << 
	gr
.
À·
 (Ë<< ",t=" <<Ñ.
t›
 ()

267 << ",r=" << 
	gr
.
right
 (Ë<< ",b=" <<Ñ.
bŸtom
 ()

269  
	gs
;

276 ˛as†
	cPaöt


278 
	gpublic
:

280 íum { 
TEXT_BUF_SIZE
 = 512 };

282 
Paöt
 (
HWND
 
hwnd
);

283 
Paöt
 (
HWND
 
hwnd
, 
LPARAM
 
ÕP¨am
);

284 
	gvútuÆ
 ~
Paöt
 ();

290 
begö
 (
boﬁ
 
öô_3d
 = 
Ál£
, boﬁ 
døw_3d_ö_mem‹y
 = false);

291 
íd
 ();

297 
›î©‹
 
HWND
 ()

298 {  
	ghwnd
; }

299 
›î©‹
 
	gRECT
* ()

300 {  
	gr
; }

301 
›î©‹
 
HDC
 ()

302 {  
	ghdc
; }

303 
›î©‹
 
	gPAINTSTRUCT
* ()

304 {  &
	gps
; }

305 
›î©‹
 
	gPOINT
* ()

306 {  &
	g±
; }

308 
GDICOORD
 
gë_poöt_x
 () const

309 {  
	g±
.
	gx
; }

310 
GDICOORD
 
gë_poöt_y
 () const

311 {  
	g±
.
	gy
; }

313 
MWCOORD
 
À·
 () const

314 {  
	gr
.
À·
 (); }

315 
MWCOORD
 
t›
 () const

316 {  
	gr
.
t›
 (); }

317 
MWCOORD
 
right
 () const

318 {  
	gr
.
right
 (); }

319 
MWCOORD
 
bŸtom
 () const

320 {  
	gr
.
bŸtom
 (); }

326 
DWORD
 
gë_sy°em_cﬁour
 (
nIndex
)

327 {  ::
GëSysCﬁ‹
 (
nIndex
); }

333 
COLORREF
 
£t_pixñ
 (
x
, 
y
, COLORREF 
¸Cﬁour
)

334 {  ::
SëPixñ
 (
hdc
, 
x
, 
y
, 
¸Cﬁour
); }

336 
BOOL
 
move_to
 (
x
, 
y
)

337 {  ::
MoveToEx
 (
hdc
, 
x
, 
y
, 0); }

339 
BOOL
 
löe_to
 (
x
, 
y
)

340 {  ::
LöeTo
 (
hdc
, 
x
, 
y
); }

342 
BOOL
 
löe_to
 (
x1
, 
y1
, 
x2
, 
y2
)

343 { i‡(!
move_to
 (
x1
, 
y1
)Ë 
	gFALSE
;

344  
löe_to
 (
x2
, 
y2
); }

346 
BOOL
 
ª˘™gÀ
 (
x1
, 
y1
, 
x2
, 
y2
)

347 {  ::
Re˘™gÀ
 (
hdc
, 
x1
, 
y1
, 
x2
, 
y2
); }

349 
BOOL
 
fûl_ª˘™gÀ
 (
x1
, 
y1
, 
x2
, 
y2
, 
HBRUSH
 
hbr
)

350 { 
Re˘
 
r
 (
x1
, 
y1
, 
x2
, 
y2
);

351  ::
FûlRe˘
 (
hdc
, 
r
, 
hbr
); }

357 
öôüli£_3d
 (
boﬁ
 
døw_3d_ö_mem
)

358 { i‡(!
	gdøw_3d
) {

359 
	gdøw_3d
 = 
åue
; ::
öô3
 (
hdc
, 
døw_3d_ö_mem
 ? 
hwnd
 : 0); } }

360 
∑öt_3d
 ()

361 { i‡(
	gdøw_3d
Ë{ ::
∑öt3
 (
hdc
); døw_3d = 
Ál£
; } }

367 
£t_ãxt_‰om©
 (
UINT
 
uF‹m©
)

368 { 
	gãxt_f‹m©
 = 
uF‹m©
; }

370 
ãxt_out
 (
x
, 
y
, c⁄° *
f‹m©
, ...);

372 
	g¥iv©e
:

374 
HWND
 
hwnd
;

375 
boﬁ
 
	gdøw_3d
;

376 
boﬁ
 
	gdøwög
;

377 
Re˘
 
	gr
;

378 
HDC
 
	ghdc
;

379 
PAINTSTRUCT
 
	gps
;

380 
POINT
 
	g±
;

381 
UINT
 
	gãxt_f‹m©
;

383 
	gf‹m©_buf
[
TEXT_BUF_SIZE
];

392 ˛as†
	cFûeDes¸ùt‹


394 
‰õnd
 
˛ass
 
	gWödow
;

396 
	gpublic
:

398 
FûeDes¸ùt‹
 ();

399 
	gvútuÆ
 ~
FûeDes¸ùt‹
 ();

405 
boﬁ
 
íabÀ_ªad
 ();

406 
boﬁ
 
dißbÀ_ªad
 ();

407 
boﬁ
 
ªad_íabÀd
 () const

408 {  
	gªad_is_íabÀd
; }

410 
boﬁ
 
íabÀ_wrôe
 ();

411 
boﬁ
 
dißbÀ_wrôe
 ();

412 
boﬁ
 
wrôe_íabÀd
 () const

413 {  
	gwrôe_is_íabÀd
; }

415 
boﬁ
 
íabÀ_ex˚±
 ();

416 
boﬁ
 
dißbÀ_ex˚±
 ();

417 
boﬁ
 
ex˚±_íabÀd
 () const

418 {  
	gex˚±_is_íabÀd
; }

420 
fd
 () const

421 {  
	gfûe_desc
; }

423 
›î©‹
 () const

424 {  
fd
 (); }

426 c⁄° 
Wödow
 *
gë_wödow
 () const

427 {  
	gwödow
; }

429 
	g¥Ÿe˘ed
:

435 
vútuÆ
 
LRESULT
 
ªad
 ();

436 
vútuÆ
 
LRESULT
 
wrôe
 ();

437 
vútuÆ
 
LRESULT
 
ex˚±
 ();

439 
	g¥iv©e
:

441 
fûe_desc
;

442 
boﬁ
 
	gªad_is_íabÀd
;

443 
boﬁ
 
	gwrôe_is_íabÀd
;

444 
boﬁ
 
	gex˚±_is_íabÀd
;

445 
Wödow
 *
	gwödow
;

449 ˛as†
	cAµliˇti⁄


451 
	gpublic
:

453 
Aµliˇti⁄
 ();

454 
Aµliˇti⁄
 (
MWIMAGEHDR
& 
background
);

455 
	gvútuÆ
 ~
Aµliˇti⁄
 ();

457 
HINSTANCE
 
ö°™˚
 () const

458 {  
	g≠p_ö°™˚
; }

460 
HINSTANCE
 
¥ev_ö°™˚
 () const

461 {  
	g≠p_¥ev_ö°™˚
; }

463 
LPSTR
 
cmd_löe
 () const

464 {  
	g≠p_cmd_löe
; }

466 
show_cmd
 ()

467 {  
	g≠p_show_cmd
; }

473 
WINAPI
 
WöMaö
 (
HINSTANCE
 
hIn°™˚
,

474 
HINSTANCE
 
hPªvIn°™˚
,

475 
LPSTR
 
ÕCmdLöe
,

476 
nShowCmd
);

477 
	g¥Ÿe˘ed
:

479 
vútuÆ
 
öôüli£
 ();

480 
vútuÆ
 
shutdown
 ();

482 
	g¥iv©e
:

484 
MWIMAGEHDR
 *
background
;

485 
HINSTANCE
 
	g≠p_ö°™˚
;

486 
HINSTANCE
 
	g≠p_¥ev_ö°™˚
;

487 
LPSTR
 
	g≠p_cmd_löe
;

488 
	g≠p_show_cmd
;

	@include/mwsystem.h

9 #i‚de‡
MWSYSTEM_H_INCLUDED


10 
	#MWSYSTEM_H_INCLUDED


	)

31 
	~<°dlib.h
>

33 
	#GdMÆloc
(
size
Ë
	`mÆloc
((size))

	)

34 
	#GdCÆloc
(
num
,
size
Ë
	`ˇŒoc
(“um),(size))

	)

35 
	#GdRóŒoc
(
addr
,
ﬁdsize
,
√wsize
Ë
	`ªÆloc
(◊ddr),“ewsize))

	)

36 
	#GdFªe
(
addr
Ë
	`‰ì
(◊ddr))

	)

37 
	#GdSåDup
(
°rög
Ë
	`°rdup
((°rög))

	)

	@include/mwtypes.h

1 #i‚de‡
_MWTYPES_H


2 
	#_MWTYPES_H


	)

9 
	#MWPACKED
 
	`__©åibuã__
 ((
	`Æig√d
(1), 
∑cked
))

	)

12 
	#MWFONT_SYSTEM_VAR
 "Sy°em"

	)

13 
	#MWFONT_SYSTEM_FIXED
 "Sy°emFixed"

	)

14 
	#MWFONT_GUI_VAR
 "Sy°em"

	)

15 
	#MWFONT_OEM_FIXED
 "Sy°emFixed"

	)

18 
	#MWTF_ASCII
 0x00000000L

	)

19 
	#MWTF_UTF8
 0x00000001L

	)

20 
	#MWTF_UC16
 0x00000002L

	)

21 
	#MWTF_UC32
 0x00000004L

	)

22 
	#MWTF_XCHAR2B
 0x00000008L

	)

23 
	#MWTF_PACKMASK
 0x0000000FL

	)

26 
	#MWTF_DBCS_BIG5
 0x00000100L

	)

27 
	#MWTF_DBCS_EUCCN
 0x00000200L

	)

28 
	#MWTF_DBCS_EUCKR
 0x00000300L

	)

29 
	#MWTF_DBCS_EUCJP
 0x00000400L

	)

30 
	#MWTF_DBCS_JIS
 0x00000500L

	)

31 
	#MWTF_DBCSMASK
 0x00000700L

	)

34 
	#MWTF_TOP
 0x01000000L

	)

35 
	#MWTF_BASELINE
 0x02000000L

	)

36 
	#MWTF_BOTTOM
 0x04000000L

	)

39 
	#MWTF_KERNING
 0x0001

	)

40 
	#MWTF_ANTIALIAS
 0x0002

	)

41 
	#MWTF_UNDERLINE
 0x0004

	)

42 
	#MWTF_FREETYPE
 0x1000

	)

45 
	#MWMODE_COPY
 0

	)

46 
	#MWMODE_XOR
 1

	)

47 
	#MWMODE_OR
 2

	)

48 
	#MWMODE_AND
 3

	)

49 
	#MWMODE_CLEAR
 4

	)

50 
	#MWMODE_SETTO1
 5

	)

51 
	#MWMODE_EQUIV
 6

	)

52 
	#MWMODE_NOR
 7

	)

53 
	#MWMODE_NAND
 8

	)

54 
	#MWMODE_INVERT
 9

	)

55 
	#MWMODE_COPYINVERTED
 10

	)

56 
	#MWMODE_ORINVERTED
 11

	)

57 
	#MWMODE_ANDINVERTED
 12

	)

58 
	#MWMODE_ORREVERSE
 13

	)

59 
	#MWMODE_ANDREVERSE
 14

	)

60 
	#MWMODE_NOOP
 15

	)

61 
	#MWMODE_XOR_FGBG
 16

	)

63 
	#MWMODE_SIMPLE_MAX
 16

	)

75 
	#MWMODE_SRC
 
MWMODE_COPY


	)

76 
	#MWMODE_DST
 
MWMODE_NOOP


	)

77 
	#MWMODE_SRC_OVER
 17

	)

78 
	#MWMODE_DST_OVER
 18

	)

79 
	#MWMODE_SRC_IN
 19

	)

80 
	#MWMODE_DST_IN
 20

	)

81 
	#MWMODE_SRC_OUT
 21

	)

82 
	#MWMODE_DST_OUT
 22

	)

83 
	#MWMODE_SRC_ATOP
 23

	)

84 
	#MWMODE_DST_ATOP
 24

	)

85 
	#MWMODE_PORTERDUFF_XOR
 25

	)

87 
	#MWMODE_MAX
 25

	)

91 
	#MWLINE_SOLID
 0

	)

92 
	#MWLINE_ONOFF_DASH
 1

	)

97 
	#MWFILL_SOLID
 0

	)

98 
	#MWFILL_STIPPLE
 1

	)

99 
	#MWFILL_OPAQUE_STIPPLE
 2

	)

100 
	#MWFILL_TILE
 3

	)

103 
	#MWBUTTON_L
 04

	)

104 
	#MWBUTTON_M
 02

	)

105 
	#MWBUTTON_R
 01

	)

108 
	#MWARGB
(
a
,
r
,
g
,
b
Ë((
MWCOLORVAL
)((()(r)|\

109 ((()()(
g
))<<8))|\

110 ((()()(
b
))<<16)|\

111 ((()()(
a
))<<24)))

	)

112 
	#MWRGB
(
r
,
g
,
b
Ë
	`MWARGB
(255,‘),(g),(b)Ë

	)

113 
	#MW0RGB
(
r
,
g
,
b
Ë
	`MWARGB
(0,‘),(g),(b)Ë

	)

117 
	#MWROP_TO_MODE
(
›
Ë((›Ë>> 24)

	)

120 
	#MWMODE_TO_ROP
(
›
Ë((()(›)Ë<< 24)

	)

128 
	#MWROP_EXTENSION
 0xff000000L

	)

131 
	#MWROP_SRCTRANSCOPY
 0x21000000L

	)

134 
	#MWROP_BLENDCONSTANT
 0x22000000L

	)

137 
	#MWROP_BLENDFGBG
 0x23000000L

	)

140 
	#MWROP_BLENDCHANNEL
 0x24000000L

	)

143 
	#MWROP_STRETCH
 0x25000000L

	)

150 
	#MWROP_USE_GC_MODE
 0xff000000L

	)

153 
	#MWROP_COPY
 
	`MWMODE_TO_ROP
(
MWMODE_COPY
)

	)

154 
	#MWROP_XOR
 
	`MWMODE_TO_ROP
(
MWMODE_XOR
)

	)

155 
	#MWROP_OR
 
	`MWMODE_TO_ROP
(
MWMODE_OR
)

	)

156 
	#MWROP_AND
 
	`MWMODE_TO_ROP
(
MWMODE_AND
)

	)

157 
	#MWROP_CLEAR
 
	`MWMODE_TO_ROP
(
MWMODE_CLEAR
)

	)

158 
	#MWROP_SET
 
	`MWMODE_TO_ROP
(
MWMODE_SETTO1
)

	)

159 
	#MWROP_EQUIV
 
	`MWMODE_TO_ROP
(
MWMODE_EQUIV
)

	)

160 
	#MWROP_NOR
 
	`MWMODE_TO_ROP
(
MWMODE_NOR
)

	)

161 
	#MWROP_NAND
 
	`MWMODE_TO_ROP
(
MWMODE_NAND
)

	)

162 
	#MWROP_INVERT
 
	`MWMODE_TO_ROP
(
MWMODE_INVERT
)

	)

163 
	#MWROP_COPYINVERTED
 
	`MWMODE_TO_ROP
(
MWMODE_COPYINVERTED
)

	)

164 
	#MWROP_ORINVERTED
 
	`MWMODE_TO_ROP
(
MWMODE_ORINVERTED
)

	)

165 
	#MWROP_ANDINVERTED
 
	`MWMODE_TO_ROP
(
MWMODE_ANDINVERTED
)

	)

166 
	#MWROP_ORREVERSE
 
	`MWMODE_TO_ROP
(
MWMODE_ORREVERSE
)

	)

167 
	#MWROP_ANDREVERSE
 
	`MWMODE_TO_ROP
(
MWMODE_ANDREVERSE
)

	)

168 
	#MWROP_NOOP
 
	`MWMODE_TO_ROP
(
MWMODE_NOOP
)

	)

169 
	#MWROP_XOR_FGBG
 
	`MWMODE_TO_ROP
(
MWMODE_XOR_FGBG
)

	)

181 
	#MWROP_SRC
 
	`MWMODE_TO_ROP
(
MWMODE_SRC
)

	)

182 
	#MWROP_DST
 
	`MWMODE_TO_ROP
(
MWMODE_DST
)

	)

183 
	#MWROP_SRC_OVER
 
	`MWMODE_TO_ROP
(
MWMODE_SRC_OVER
)

	)

184 
	#MWROP_DST_OVER
 
	`MWMODE_TO_ROP
(
MWMODE_DST_OVER
)

	)

185 
	#MWROP_SRC_IN
 
	`MWMODE_TO_ROP
(
MWMODE_SRC_IN
)

	)

186 
	#MWROP_DST_IN
 
	`MWMODE_TO_ROP
(
MWMODE_DST_IN
)

	)

187 
	#MWROP_SRC_OUT
 
	`MWMODE_TO_ROP
(
MWMODE_SRC_OUT
)

	)

188 
	#MWROP_DST_OUT
 
	`MWMODE_TO_ROP
(
MWMODE_DST_OUT
)

	)

189 
	#MWROP_SRC_ATOP
 
	`MWMODE_TO_ROP
(
MWMODE_SRC_ATOP
)

	)

190 
	#MWROP_DST_ATOP
 
	`MWMODE_TO_ROP
(
MWMODE_DST_ATOP
)

	)

191 
	#MWROP_PORTERDUFF_XOR
 
	`MWMODE_TO_ROP
(
MWMODE_PORTERDUFF_XOR
)

	)

193 
	#MWROP_SRCCOPY
 
MWROP_COPY


	)

194 
	#MWROP_SRCAND
 
MWROP_AND


	)

195 
	#MWROP_SRCINVERT
 
MWROP_XOR


	)

196 
	#MWROP_BLACKNESS
 
MWROP_CLEAR


	)

205 
	#MWPF_RGB
 0

	)

206 
	#MWPF_PIXELVAL
 1

	)

207 
	#MWPF_PALETTE
 2

	)

208 
	#MWPF_TRUECOLOR0888
 3

	)

209 
	#MWPF_TRUECOLOR888
 4

	)

210 
	#MWPF_TRUECOLOR565
 5

	)

211 
	#MWPF_TRUECOLOR555
 6

	)

212 
	#MWPF_TRUECOLOR332
 7

	)

213 
	#MWPF_TRUECOLOR8888
 8

	)

232 #i‚de‡
MWPIXEL_FORMAT


233 
	#MWPIXEL_FORMAT
 
MWPF_TRUECOLOR0888


	)

236 #i‡
deföed
(
__AS386_16__
)

238 #unde‡
MWPIXEL_FORMAT


239 
	#MWPIXEL_FORMAT
 
MWPF_PALETTE


	)

242 #i‡(
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR565
Ë|| (MWPIXEL_FORMAT =
MWPF_TRUECOLOR555
)

243 
	tMWPIXELVAL
;

245 #i‡
MWPIXEL_FORMAT
 =
MWPF_TRUECOLOR332


246 
	tMWPIXELVAL
;

248 #i‡
MWPIXEL_FORMAT
 =
MWPF_PALETTE


249 
	tMWPIXELVAL
;

251 
	tMWPIXELVAL
;

257 
	#MWPORTRAIT_NONE
 0x00

	)

258 
	#MWPORTRAIT_LEFT
 0x01

	)

259 
	#MWPORTRAIT_RIGHT
 0x02

	)

260 
	#MWPORTRAIT_DOWN
 0x04

	)

265 
	tMWCOORD
;

266 
	tMWBOOL
;

267 
	tMWUCHAR
;

268 
	tMWCOLORVAL
;

269 
	tMWIMAGEBITS
;

270 
	tMWTIMEOUT
;

271 
	tMWTEXTFLAGS
;

273 
	#MWCOORD_MAX
 0x7ff‡

	)

274 
	#MWCOORD_MIN
 (-
MWCOORD_MAX
Ë

	)

277 
	#MWIMAGE_WORDS
(
x
Ë(((x)+15)/16)

	)

278 
	#MWIMAGE_BYTES
(
x
Ë(
	`MWIMAGE_WORDS
(x)*(
MWIMAGEBITS
))

	)

280 
	#MWIMAGE_SIZE
(
width
, 
height
) \

281 ((
height
Ë* (((
width
Ë+ 
MWIMAGE_BITSPERIMAGE
 - 1Ë/ MWIMAGE_BITSPERIMAGE))

	)

282 
	#MWIMAGE_BITSPERIMAGE
 ((
MWIMAGEBITS
Ë* 8)

	)

283 
	#MWIMAGE_BITVALUE
(
n
Ë((
MWIMAGEBITS
Ë(((MWIMAGEBITSË1Ë<< (n)))

	)

284 
	#MWIMAGE_FIRSTBIT
 (
	`MWIMAGE_BITVALUE
(
MWIMAGE_BITSPERIMAGE
 - 1))

	)

285 
	#MWIMAGE_NEXTBIT
(
m
Ë((
MWIMAGEBITS
Ë((mË>> 1))

	)

286 
	#MWIMAGE_TESTBIT
(
m
Ë((mË& 
MWIMAGE_FIRSTBIT
Ë

	)

287 
	#MWIMAGE_SHIFTBIT
(
m
Ë((
MWIMAGEBITS
Ë((mË<< 1)Ë

	)

290 
	s_mwli°
 {

291 
_mwli°
 *
	m√xt
;

292 
_mwli°
 *
	m¥ev
;

293 } 
	tMWLIST
, *
	tPMWLIST
;

296 
	s_mwli°hód
 {

297 
_mwli°
 *
	mhód
;

298 
_mwli°
 *
	mèû
;

299 } 
	tMWLISTHEAD
, *
	tPMWLISTHEAD
;

302 
	tMWKEYMOD
;

306 
MWCOORD
 
	mrows
;

307 
MWCOORD
 
	mcﬁs
;

308 
	mxdpcm
;

309 
	mydpcm
;

310 
	m∂™es
;

311 
	mbµ
;

312 
	mncﬁ‹s
;

313 
	mf⁄ts
;

314 
	mbuâ⁄s
;

315 
MWKEYMOD
 
	mmodifõrs
;

316 
	mpixty≥
;

317 
	mp‹åaô
;

318 
MWBOOL
 
	mfbdrivî
;

319 
	mrmask
;

320 
	mgmask
;

321 
	mbmask
;

322 
MWCOORD
 
	mxpos
;

323 
MWCOORD
 
	mypos
;

326 
	mvs_width
;

327 
	mvs_height
;

328 
	mws_width
;

329 
	mws_height
;

330 } 
	tMWSCREENINFO
, *
	tPMWSCREENINFO
;

334 * 
	mphy•ixñs
;

336 * 
	mwöpixñs
;

337 
	mpixty≥
;

338 
	mbµ
;

339 
	mbyã•p
;

340 
	mpôch
;

341 
MWCOORD
 
	mx
, 
	my
;

342 
	mp‹åaô_mode
;

343 
MWCOORD
 
	mxªs
;

344 
MWCOORD
 
	myªs
;

345 
MWCOORD
 
	mxvúåes
;

346 
MWCOORD
 
	myvúåes
;

347 } 
	tMWWINDOWFBINFO
;

364 
	mmaxwidth
;

371 
	mheight
;

382 
	mba£löe
;

390 
	mdes˚¡
;

395 
	mmaxas˚¡
;

402 
	mmaxdes˚¡
;

408 
	mlöe•acög
;

413 
	mfú°ch¨
;

418 
	mœ°ch¨
;

424 
MWBOOL
 
	mfixed
;

434 
MWUCHAR
 
	mwidths
[256];

435 } 
	tMWFONTINFO
, *
	tPMWFONTINFO
;

440 *
	mâ«me
;

441 *
	mmw«me
;

442 } 
	tMWFONTLIST
, *
	tPMWFONTLIST
;

447 
	#MWLF_CLASS_ANY
 0

	)

448 
	#MWLF_CLASS_BUILTIN
 1

	)

449 
	#MWLF_CLASS_FNT
 2

	)

450 
	#MWLF_CLASS_PCF
 3

	)

451 
	#MWLF_CLASS_FREETYPE
 4

	)

452 
	#MWLF_CLASS_T1LIB
 5

	)

453 
	#MWLF_CLASS_MGL
 6

	)

454 
	#MWLF_CLASS_HZK
 7

	)

456 
	#MWLF_FACESIZE
 64

	)

459 
	#MWLF_TYPE_DEFAULT
 0

	)

460 
	#MWLF_TYPE_SCALED
 4

	)

461 
	#MWLF_TYPE_RASTER
 5

	)

462 
	#MWLF_TYPE_TRUETYPE
 7

	)

463 
	#MWLF_TYPE_ADOBE
 10

	)

466 
	#MWLF_WEIGHT_DEFAULT
 0

	)

467 
	#MWLF_WEIGHT_THIN
 100

	)

468 
	#MWLF_WEIGHT_EXTRALIGHT
 200

	)

469 
	#MWLF_WEIGHT_LIGHT
 300

	)

470 
	#MWLF_WEIGHT_NORMAL
 400

	)

471 
	#MWLF_WEIGHT_REGULAR
 400

	)

472 
	#MWLF_WEIGHT_MEDIUM
 500

	)

473 
	#MWLF_WEIGHT_DEMIBOLD
 600

	)

474 
	#MWLF_WEIGHT_BOLD
 700

	)

475 
	#MWLF_WEIGTH_EXTRABOLD
 800

	)

476 
	#MWLF_WEIGHT_BLACK
 900

	)

479 
	#MWLF_CHARSET_ANSI
 0

	)

480 
	#MWLF_CHARSET_DEFAULT
 1

	)

481 
	#MWLF_CHARSET_UNICODE
 254

	)

482 
	#MWLF_CHARSET_OEM
 255

	)

485 
	#MWLF_PITCH_DEFAULT
 0

	)

486 
	#MWLF_PITCH_ULTRACONDENSED
 10

	)

487 
	#MWLF_PITCH_EXTRACONDENSED
 20

	)

488 
	#MWLF_PITCH_CONDENSED
 30

	)

489 
	#MWLF_PITCH_SEMICONDENSED
 40

	)

490 
	#MWLF_PITCH_NORMAL
 50

	)

491 
	#MWLF_PITCH_SEMIEXPANDED
 60

	)

492 
	#MWLF_PITCH_EXPANDED
 70

	)

493 
	#MWLF_PITCH_EXTRAEXPANDED
 80

	)

494 
	#MWLF_PITCH_ULTRAEXPANDED
 90

	)

497 
	#MWLF_FLAGS_ALIAS
 1

	)

501 
	mlfHeight
;

502 
	mlfWidth
;

503 
	mlfEsˇ≥mít
;

504 
	mlfOrõ¡©i⁄
;

505 
	mlfWeight
;

506 
MWUCHAR
 
	mlfIèlic
;

507 
MWUCHAR
 
	mlfUndîlöe
;

508 
MWUCHAR
 
	mlfSåikeOut
;

509 
MWUCHAR
 
	mlfCh¨Së
;

510 
MWUCHAR
 
	mlfOutPªcisi⁄
;

511 
MWUCHAR
 
	mlfClùPªcisi⁄
;

512 
MWUCHAR
 
	mlfQuÆôy
;

513 
MWUCHAR
 
	mlfPôchAndFamûy
;

516 
MWUCHAR
 
	mlfCœss
;

519 
MWUCHAR
 
	mlfPôch
;

520 
MWUCHAR
 
	mlfRom™
;

521 
MWUCHAR
 
	mlfSîif
;

522 
MWUCHAR
 
	mlfS™sSîif
;

523 
MWUCHAR
 
	mlfModîn
;

524 
MWUCHAR
 
	mlfM⁄o•a˚
;

525 
MWUCHAR
 
	mlfPr›‹ti⁄Æ
;

526 
MWUCHAR
 
	mlfOblique
;

527 
MWUCHAR
 
	mlfSmÆlC≠s
;

530 
	mlfFa˚Name
[
MWLF_FACESIZE
];

532 } 
	tMWLOGFONT
, *
	tPMWLOGFONT
;

539 
	#MWLF_CÀ¨
(
lf
) \

541 (
lf
)->
lfHeight
 = 0; \

542 (
lf
)->
lfWidth
 = 0; \

543 (
lf
)->
lfEsˇ≥mít
 = 0; \

544 (
lf
)->
lfOrõ¡©i⁄
 = 0; \

545 (
lf
)->
lfWeight
 = 
MWLF_WEIGHT_REGULAR
; \

546 (
lf
)->
lfPôch
 = 0; \

547 (
lf
)->
lfCœss
 = 
MWLF_CLASS_ANY
; \

548 (
lf
)->
lfIèlic
 = 0; \

549 (
lf
)->
lfOblique
 = 0; \

550 (
lf
)->
lfRom™
 = 0; \

551 (
lf
)->
lfSîif
 = 0; \

552 (
lf
)->
lfS™sSîif
 = 0; \

553 (
lf
)->
lfModîn
 = 0; \

554 (
lf
)->
lfM⁄o•a˚
 = 0; \

555 (
lf
)->
lfPr›‹ti⁄Æ
 = 0; \

556 (
lf
)->
lfSmÆlC≠s
 = 0; \

557 (
lf
)->
lfUndîlöe
 = 0; \

558 (
lf
)->
lfSåikeOut
 = 0; \

559 (
lf
)->
lfCh¨Së
 = 0; \

560 (
lf
)->
lfOutPªcisi⁄
 = 0; \

561 (
lf
)->
lfClùPªcisi⁄
 = 0; \

562 (
lf
)->
lfQuÆôy
 = 0; \

563 (
lf
)->
lfPôchAndFamûy
 = 0; \

564 (
lf
)->
lfFa˚Name
[0] = '\0'; \

565 } 0)

	)

567 
	#MWLF_SëBﬁd
(
lf
) \

569 (
lf
)->
lfWeight
 = 
MWLF_WEIGHT_BOLD
; \

570 } 0)

	)

572 
	#MWLF_SëReguœr
(
lf
) \

574 (
lf
)->
lfWeight
 = 
MWLF_WEIGHT_REGULAR
; \

575 } 0)

	)

577 
	#MWLF_SëIèlics
(
lf
) \

579 (
lf
)->
lfIèlic
 = 1; \

580 (
lf
)->
lfOblique
 = 0; \

581 (
lf
)->
lfRom™
 = 0; \

582 } 0)

	)

584 
	#MWLF_SëRom™
(
lf
) \

586 (
lf
)->
lfIèlic
 = 0; \

587 (
lf
)->
lfOblique
 = 0; \

588 (
lf
)->
lfRom™
 = 1; \

589 } 0)

	)

600 
MWCOORD
 
	mx
;

601 
MWCOORD
 
	my
;

602 } 
	tMWPOINT
;

606 
MWCOORD
 
	mÀ·
;

607 
MWCOORD
 
	mt›
;

608 
MWCOORD
 
	mright
;

609 
MWCOORD
 
	mbŸtom
;

610 } 
	tMWRECT
;

614 
	msize
;

615 
	mnumRe˘s
;

616 
	mty≥
;

617 
MWRECT
 *
	mª˘s
;

618 
MWRECT
 
	mexã¡s
;

619 } 
	tMWCLIPREGION
;

622 
	#MWREGION_ERROR
 0

	)

623 
	#MWREGION_NULL
 1

	)

624 
	#MWREGION_SIMPLE
 2

	)

625 
	#MWREGION_COMPLEX
 3

	)

628 
	#MWRECT_OUT
 0

	)

629 
	#MWRECT_ALLIN
 1

	)

630 
	#MWRECT_PARTIN
 2

	)

633 
	#MWPOLY_EVENODD
 1

	)

634 
	#MWPOLY_WINDING
 2

	)

637 
MWCOORD
 
	mwidth
;

638 
MWCOORD
 
	mheight
;

639 
MWIMAGEBITS
 * 
	mbôm≠
;

640 } 
	tMWSTIPPLE
;

644 
MWUCHAR
 
	mr
;

645 
MWUCHAR
 
	mg
;

646 
MWUCHAR
 
	mb
;

647 
MWUCHAR
 
	m_∑ddög
;

648 } 
	tMWPALENTRY
;

651 
	#MWIMAGE_UPSIDEDOWN
 01

	)

652 
	#MWIMAGE_BGR
 00

	)

653 
	#MWIMAGE_RGB
 02

	)

654 
	#MWIMAGE_ALPHA_CHANNEL
 04

	)

657 
	mwidth
;

658 
	mheight
;

659 
	m∂™es
;

660 
	mbµ
;

661 
	mpôch
;

662 
	mbyã•îpixñ
;

663 
	mcom¥essi⁄
;

664 
	m∑lsize
;

665 
	må™scﬁ‹
;

666 
MWPALENTRY
 * 
	m∑Àâe
;

667 
MWUCHAR
 * 
	mimagebôs
;

668 } 
	tMWIMAGEHDR
, *
	tPMWIMAGEHDR
;

672 
	mid
;

673 
	mwidth
;

674 
	mheight
;

675 
	m∂™es
;

676 
	mbµ
;

677 
	mpôch
;

678 
	mbyã•îpixñ
;

679 
	mcom¥essi⁄
;

680 
	m∑lsize
;

681 
MWPALENTRY
 
	m∑Àâe
[256];

682 } 
	tMWIMAGEINFO
, *
	tPMWIMAGEINFO
;

684 
	#MWMAX_CURSOR_SIZE
 32

	)

685 
	#MWMAX_CURSOR_BUFLEN
 
	`MWIMAGE_SIZE
(
MWMAX_CURSOR_SIZE
,MWMAX_CURSOR_SIZE)

	)

689 
	mwidth
;

690 
	mheight
;

691 
MWCOORD
 
	mhŸx
;

692 
MWCOORD
 
	mhŸy
;

693 
MWCOLORVAL
 
	mfgcﬁ‹
;

694 
MWCOLORVAL
 
	mbgcﬁ‹
;

695 
MWIMAGEBITS
 
	mimage
[
MWMAX_CURSOR_SIZE
*2];

696 
MWIMAGEBITS
 
	mmask
[
MWMAX_CURSOR_SIZE
*2];

697 } 
	tMWCURSOR
, *
	tPMWCURSOR
;

701 
	ma
, 
	mb
, 
	mc
;

702 
	md
, 
	me
, 
	mf
;

703 
	ms
;

704 } 
	tMWTRANSFORM
;

706 
_mwf⁄t
 * 
	tPMWFONT
;

709 
	#MWARC
 0x0001

	)

710 
	#MWOUTLINE
 0x0002

	)

711 
	#MWARCOUTLINE
 0x0003

	)

712 
	#MWPIE
 0x0004

	)

713 
	#MWELLIPSE
 0x0008

	)

714 
	#MWELLIPSEFILL
 0x0010

	)

716 #ifde‡
MWINCLUDECOLORS


725 
	#BLACK
 
	`MWRGB
–0 , 0 , 0 )

	)

726 
	#BLUE
 
	`MWRGB
–0 , 0 , 128 )

	)

727 
	#GREEN
 
	`MWRGB
–0 , 128, 0 )

	)

728 
	#CYAN
 
	`MWRGB
–0 , 128, 128 )

	)

729 
	#RED
 
	`MWRGB
–128, 0 , 0 )

	)

730 
	#MAGENTA
 
	`MWRGB
–128, 0 , 128 )

	)

731 
	#BROWN
 
	`MWRGB
–128, 64 , 0 )

	)

732 
	#LTGRAY
 
	`MWRGB
–192, 192, 192 )

	)

733 
	#GRAY
 
	`MWRGB
–128, 128, 128 )

	)

734 
	#LTBLUE
 
	`MWRGB
–0 , 0 , 255 )

	)

735 
	#LTGREEN
 
	`MWRGB
–0 , 255, 0 )

	)

736 
	#LTCYAN
 
	`MWRGB
–0 , 255, 255 )

	)

737 
	#LTRED
 
	`MWRGB
–255, 0 , 0 )

	)

738 
	#LTMAGENTA
 
	`MWRGB
–255, 0 , 255 )

	)

739 
	#YELLOW
 
	`MWRGB
–255, 255, 0 )

	)

740 
	#WHITE
 
	`MWRGB
–255, 255, 255 )

	)

743 
	#DKGRAY
 
	`MWRGB
–32, 32, 32)

	)

747 
	tMWKEY
;

748 
	tMWSCANCODE
;

750 
	#MWKEY_UNKNOWN
 0

	)

752 
	#MWKEY_BACKSPACE
 8

	)

753 
	#MWKEY_TAB
 9

	)

754 
	#MWKEY_ENTER
 13

	)

755 
	#MWKEY_ESCAPE
 27

	)

758 
	#MWKEY_NONASCII_MASK
 0xFF00

	)

761 
	#MWKEY_FIRST
 0xF800

	)

762 
	#MWKEY_LEFT
 0xF800

	)

763 
	#MWKEY_RIGHT
 0xF801

	)

764 
	#MWKEY_UP
 0xF802

	)

765 
	#MWKEY_DOWN
 0xF803

	)

766 
	#MWKEY_INSERT
 0xF804

	)

767 
	#MWKEY_DELETE
 0xF805

	)

768 
	#MWKEY_HOME
 0xF806

	)

769 
	#MWKEY_END
 0xF807

	)

770 
	#MWKEY_PAGEUP
 0xF808

	)

771 
	#MWKEY_PAGEDOWN
 0xF809

	)

774 
	#MWKEY_KP0
 0xF80A

	)

775 
	#MWKEY_KP1
 0xF80B

	)

776 
	#MWKEY_KP2
 0xF80C

	)

777 
	#MWKEY_KP3
 0xF80D

	)

778 
	#MWKEY_KP4
 0xF80E

	)

779 
	#MWKEY_KP5
 0xF80F

	)

780 
	#MWKEY_KP6
 0xF810

	)

781 
	#MWKEY_KP7
 0xF811

	)

782 
	#MWKEY_KP8
 0xF812

	)

783 
	#MWKEY_KP9
 0xF813

	)

784 
	#MWKEY_KP_PERIOD
 0xF814

	)

785 
	#MWKEY_KP_DIVIDE
 0xF815

	)

786 
	#MWKEY_KP_MULTIPLY
 0xF816

	)

787 
	#MWKEY_KP_MINUS
 0xF817

	)

788 
	#MWKEY_KP_PLUS
 0xF818

	)

789 
	#MWKEY_KP_ENTER
 0xF819

	)

790 
	#MWKEY_KP_EQUALS
 0xF81A

	)

793 
	#MWKEY_F1
 0xF81B

	)

794 
	#MWKEY_F2
 0xF81C

	)

795 
	#MWKEY_F3
 0xF81D

	)

796 
	#MWKEY_F4
 0xF81E

	)

797 
	#MWKEY_F5
 0xF81F

	)

798 
	#MWKEY_F6
 0xF820

	)

799 
	#MWKEY_F7
 0xF821

	)

800 
	#MWKEY_F8
 0xF822

	)

801 
	#MWKEY_F9
 0xF823

	)

802 
	#MWKEY_F10
 0xF824

	)

803 
	#MWKEY_F11
 0xF825

	)

804 
	#MWKEY_F12
 0xF827

	)

807 
	#MWKEY_NUMLOCK
 0xF828

	)

808 
	#MWKEY_CAPSLOCK
 0xF829

	)

809 
	#MWKEY_SCROLLOCK
 0xF82A

	)

810 
	#MWKEY_LSHIFT
 0xF82B

	)

811 
	#MWKEY_RSHIFT
 0xF82C

	)

812 
	#MWKEY_LCTRL
 0xF82D

	)

813 
	#MWKEY_RCTRL
 0xF82E

	)

814 
	#MWKEY_LALT
 0xF82F

	)

815 
	#MWKEY_RALT
 0xF830

	)

816 
	#MWKEY_LMETA
 0xF831

	)

817 
	#MWKEY_RMETA
 0xF832

	)

818 
	#MWKEY_ALTGR
 0xF833

	)

821 
	#MWKEY_PRINT
 0xF834

	)

822 
	#MWKEY_SYSREQ
 0xF835

	)

823 
	#MWKEY_PAUSE
 0xF836

	)

824 
	#MWKEY_BREAK
 0xF837

	)

825 
	#MWKEY_QUIT
 0xF838

	)

826 
	#MWKEY_MENU
 0xF839

	)

827 
	#MWKEY_REDRAW
 0xF83A

	)

832 
	#MWKEY_CONTRAST
 0xF842

	)

833 
	#MWKEY_BRIGHTNESS
 0xF843

	)

834 
	#MWKEY_SELECTUP
 0xF844

	)

835 
	#MWKEY_SELECTDOWN
 0xF845

	)

836 
	#MWKEY_ACCEPT
 0xF846

	)

837 
	#MWKEY_CANCEL
 0xF847

	)

838 
	#MWKEY_APP1
 0xF848

	)

839 
	#MWKEY_APP2
 0xF849

	)

840 
	#MWKEY_APP3
 0xF84A

	)

841 
	#MWKEY_APP4
 0xF84B

	)

842 
	#MWKEY_SUSPEND
 0xF84C

	)

843 
	#MWKEY_END_NORMAL
 0xF84D

	)

858 
	#MWKEY_HAVI_KEY_BASE
 (
MWKEY_END_NORMAL
+1)

	)

861 
	#MWKEY_HAVI_CODE_FIRST
 403

	)

864 
	#MWKEY_HAVI_CODE_LAST
 460

	)

867 
	#MWKEY_FROM_HAVI_CODE
(
h
Ë((hË+ (
MWKEY_HAVI_KEY_BASE
 - 
MWKEY_HAVI_CODE_FIRST
))

	)

870 
	#MWKEY_TO_HAVI_CODE
(
m
Ë((mË- (
MWKEY_HAVI_KEY_BASE
 - 
MWKEY_HAVI_CODE_FIRST
))

	)

873 
	#MWKEY_IS_HAVI_CODE
(
m
Ë–()((mË- 
MWKEY_HAVI_KEY_BASE
) \

874 <()(
MWKEY_HAVI_CODE_LAST
 - 
MWKEY_HAVI_CODE_FIRST
Ë)

	)

877 
	#MWKEY_COLORED_KEY_0
 
	`MWKEY_FROM_HAVI_CODE
(403)

	)

878 
	#MWKEY_COLORED_KEY_1
 
	`MWKEY_FROM_HAVI_CODE
(404)

	)

879 
	#MWKEY_COLORED_KEY_2
 
	`MWKEY_FROM_HAVI_CODE
(405)

	)

880 
	#MWKEY_COLORED_KEY_3
 
	`MWKEY_FROM_HAVI_CODE
(406)

	)

881 
	#MWKEY_COLORED_KEY_4
 
	`MWKEY_FROM_HAVI_CODE
(407)

	)

882 
	#MWKEY_COLORED_KEY_5
 
	`MWKEY_FROM_HAVI_CODE
(408)

	)

883 
	#MWKEY_POWER
 
	`MWKEY_FROM_HAVI_CODE
(409)

	)

884 
	#MWKEY_DIMMER
 
	`MWKEY_FROM_HAVI_CODE
(410)

	)

885 
	#MWKEY_WINK
 
	`MWKEY_FROM_HAVI_CODE
(411)

	)

886 
	#MWKEY_REWIND
 
	`MWKEY_FROM_HAVI_CODE
(412)

	)

887 
	#MWKEY_STOP
 
	`MWKEY_FROM_HAVI_CODE
(413)

	)

888 
	#MWKEY_EJECT_TOGGLE
 
	`MWKEY_FROM_HAVI_CODE
(414)

	)

889 
	#MWKEY_PLAY
 
	`MWKEY_FROM_HAVI_CODE
(415)

	)

890 
	#MWKEY_RECORD
 
	`MWKEY_FROM_HAVI_CODE
(416)

	)

891 
	#MWKEY_FAST_FWD
 
	`MWKEY_FROM_HAVI_CODE
(417)

	)

892 
	#MWKEY_PLAY_SPEED_UP
 
	`MWKEY_FROM_HAVI_CODE
(418)

	)

893 
	#MWKEY_PLAY_SPEED_DOWN
 
	`MWKEY_FROM_HAVI_CODE
(419)

	)

894 
	#MWKEY_PLAY_SPEED_RESET
 
	`MWKEY_FROM_HAVI_CODE
(420)

	)

895 
	#MWKEY_RECORD_SPEED_NEXT
 
	`MWKEY_FROM_HAVI_CODE
(421)

	)

896 
	#MWKEY_GO_TO_START
 
	`MWKEY_FROM_HAVI_CODE
(422)

	)

897 
	#MWKEY_GO_TO_END
 
	`MWKEY_FROM_HAVI_CODE
(423)

	)

898 
	#MWKEY_TRACK_PREV
 
	`MWKEY_FROM_HAVI_CODE
(424)

	)

899 
	#MWKEY_TRACK_NEXT
 
	`MWKEY_FROM_HAVI_CODE
(425)

	)

900 
	#MWKEY_RANDOM_TOGGLE
 
	`MWKEY_FROM_HAVI_CODE
(426)

	)

901 
	#MWKEY_CHANNEL_UP
 
	`MWKEY_FROM_HAVI_CODE
(427)

	)

902 
	#MWKEY_CHANNEL_DOWN
 
	`MWKEY_FROM_HAVI_CODE
(428)

	)

903 
	#MWKEY_STORE_FAVORITE_0
 
	`MWKEY_FROM_HAVI_CODE
(429)

	)

904 
	#MWKEY_STORE_FAVORITE_1
 
	`MWKEY_FROM_HAVI_CODE
(430)

	)

905 
	#MWKEY_STORE_FAVORITE_2
 
	`MWKEY_FROM_HAVI_CODE
(431)

	)

906 
	#MWKEY_STORE_FAVORITE_3
 
	`MWKEY_FROM_HAVI_CODE
(432)

	)

907 
	#MWKEY_RECALL_FAVORITE_0
 
	`MWKEY_FROM_HAVI_CODE
(433)

	)

908 
	#MWKEY_RECALL_FAVORITE_1
 
	`MWKEY_FROM_HAVI_CODE
(434)

	)

909 
	#MWKEY_RECALL_FAVORITE_2
 
	`MWKEY_FROM_HAVI_CODE
(435)

	)

910 
	#MWKEY_RECALL_FAVORITE_3
 
	`MWKEY_FROM_HAVI_CODE
(436)

	)

911 
	#MWKEY_CLEAR_FAVORITE_0
 
	`MWKEY_FROM_HAVI_CODE
(437)

	)

912 
	#MWKEY_CLEAR_FAVORITE_1
 
	`MWKEY_FROM_HAVI_CODE
(438)

	)

913 
	#MWKEY_CLEAR_FAVORITE_2
 
	`MWKEY_FROM_HAVI_CODE
(439)

	)

914 
	#MWKEY_CLEAR_FAVORITE_3
 
	`MWKEY_FROM_HAVI_CODE
(440)

	)

915 
	#MWKEY_SCAN_CHANNELS_TOGGLE
 
	`MWKEY_FROM_HAVI_CODE
(441)

	)

916 
	#MWKEY_PINP_TOGGLE
 
	`MWKEY_FROM_HAVI_CODE
(442)

	)

917 
	#MWKEY_SPLIT_SCREEN_TOGGLE
 
	`MWKEY_FROM_HAVI_CODE
(443)

	)

918 
	#MWKEY_DISPLAY_SWAP
 
	`MWKEY_FROM_HAVI_CODE
(444)

	)

919 
	#MWKEY_SCREEN_MODE_NEXT
 
	`MWKEY_FROM_HAVI_CODE
(445)

	)

920 
	#MWKEY_VIDEO_MODE_NEXT
 
	`MWKEY_FROM_HAVI_CODE
(446)

	)

921 
	#MWKEY_VOLUME_UP
 
	`MWKEY_FROM_HAVI_CODE
(447)

	)

922 
	#MWKEY_VOLUME_DOWN
 
	`MWKEY_FROM_HAVI_CODE
(448)

	)

923 
	#MWKEY_MUTE
 
	`MWKEY_FROM_HAVI_CODE
(449)

	)

924 
	#MWKEY_SURROUND_MODE_NEXT
 
	`MWKEY_FROM_HAVI_CODE
(450)

	)

925 
	#MWKEY_BALANCE_RIGHT
 
	`MWKEY_FROM_HAVI_CODE
(451)

	)

926 
	#MWKEY_BALANCE_LEFT
 
	`MWKEY_FROM_HAVI_CODE
(452)

	)

927 
	#MWKEY_FADER_FRONT
 
	`MWKEY_FROM_HAVI_CODE
(453)

	)

928 
	#MWKEY_FADER_REAR
 
	`MWKEY_FROM_HAVI_CODE
(454)

	)

929 
	#MWKEY_BASS_BOOST_UP
 
	`MWKEY_FROM_HAVI_CODE
(455)

	)

930 
	#MWKEY_BASS_BOOST_DOWN
 
	`MWKEY_FROM_HAVI_CODE
(456)

	)

931 
	#MWKEY_INFO
 
	`MWKEY_FROM_HAVI_CODE
(457)

	)

932 
	#MWKEY_GUIDE
 
	`MWKEY_FROM_HAVI_CODE
(458)

	)

933 
	#MWKEY_TELETEXT
 
	`MWKEY_FROM_HAVI_CODE
(459)

	)

934 
	#MWKEY_SUBTITLE
 
	`MWKEY_FROM_HAVI_CODE
(460)

	)

936 
	#MWKEY_LAST
 
MWKEY_SUBTITLE


	)

939 
	#MWKMOD_NONE
 0x0000

	)

940 
	#MWKMOD_LSHIFT
 0x0001

	)

941 
	#MWKMOD_RSHIFT
 0x0002

	)

942 
	#MWKMOD_LCTRL
 0x0040

	)

943 
	#MWKMOD_RCTRL
 0x0080

	)

944 
	#MWKMOD_LALT
 0x0100

	)

945 
	#MWKMOD_RALT
 0x0200

	)

946 
	#MWKMOD_LMETA
 0x0400

	)

947 
	#MWKMOD_RMETA
 0x0800

	)

948 
	#MWKMOD_NUM
 0x1000

	)

949 
	#MWKMOD_CAPS
 0x2000

	)

950 
	#MWKMOD_ALTGR
 0x4000

	)

951 
	#MWKMOD_SCR
 0x8000

	)

953 
	#MWKMOD_CTRL
 (
MWKMOD_LCTRL
|
MWKMOD_RCTRL
)

	)

954 
	#MWKMOD_SHIFT
 (
MWKMOD_LSHIFT
|
MWKMOD_RSHIFT
)

	)

955 
	#MWKMOD_ALT
 (
MWKMOD_LALT
|
MWKMOD_RALT
)

	)

956 
	#MWKMOD_META
 (
MWKMOD_LMETA
|
MWKMOD_RMETA
)

	)

958 
	#MWKINFO_LED_MASK
 (1 << 0)

	)

959 
	#MWKINFO_LED_MODE_MASK
 (1 << 1)

	)

962 
	#MWKINFO_LED_CAP
 (1 << 0)

	)

963 
	#MWKINFO_LED_NUM
 (1 << 1)

	)

964 
	#MWKINFO_LED_SCR
 (1 << 2)

	)

966 
	#MWKINFO_LED_MODE_ON
 (1 << 3)

	)

967 
	#MWKINFO_LED_MODE_OFF
 (1 << 4)

	)

970 
	mÀd
;

971 
	mÀd_mode
;

972 } 
	tMWKBINFO
, *
	tPMWKBINFO
;

	@include/nano-X.h

1 #i‚def 
_NANO_X_H


2 
	#_NANO_X_H


	)

13 #ifde‡
__˝lu•lus


17 
	~"mwty≥s.h
"

23 
MWCOORD
 
	tGR_COORD
;

24 
MWCOORD
 
	tGR_SIZE
;

25 
MWCOLORVAL
 
	tGR_COLOR
;

26 
MWPIXELVAL
 
	tGR_PIXELVAL
;

27 
MWIMAGEBITS
 
	tGR_BITMAP
;

28 
MWUCHAR
 
	tGR_CHAR
;

29 
MWTEXTFLAGS
 
	tGR_TEXTFLAGS
;

30 
MWKEY
 
	tGR_KEY
;

31 
MWSCANCODE
 
	tGR_SCANCODE
;

32 
MWKEYMOD
 
	tGR_KEYMOD
;

33 
MWSCREENINFO
 
	tGR_SCREEN_INFO
;

34 
MWWINDOWFBINFO
 
	tGR_WINDOW_FB_INFO
;

35 
MWFONTINFO
 
	tGR_FONT_INFO
;

36 
MWIMAGEINFO
 
	tGR_IMAGE_INFO
;

37 
MWIMAGEHDR
 
	tGR_IMAGE_HDR
;

38 
MWLOGFONT
 
	tGR_LOGFONT
;

39 
MWPALENTRY
 
	tGR_PALENTRY
;

40 
MWPOINT
 
	tGR_POINT
;

41 
MWTIMEOUT
 
	tGR_TIMEOUT
;

42 
MWFONTLIST
 
	tGR_FONTLIST
;

43 
MWKBINFO
 
	tGR_KBINFO
;

44 
MWSTIPPLE
 
	tGR_STIPPLE
;

45 
MWTRANSFORM
 
	tGR_TRANSFORM
;

48 
	tGR_COUNT
;

49 
	tGR_CHAR_WIDTH
;

50 
	tGR_ID
;

51 
GR_ID
 
	tGR_DRAW_ID
;

52 
GR_DRAW_ID
 
	tGR_WINDOW_ID
;

53 
GR_ID
 
	tGR_GC_ID
;

54 
GR_ID
 
	tGR_REGION_ID
;

55 
GR_ID
 
	tGR_FONT_ID
;

56 
GR_ID
 
	tGR_IMAGE_ID
;

57 
GR_ID
 
	tGR_TIMER_ID
;

58 
GR_ID
 
	tGR_CURSOR_ID
;

59 
	tGR_BOOL
;

60 
	tGR_ERROR
;

61 
	tGR_EVENT_TYPE
;

62 
	tGR_UPDATE_TYPE
;

63 
	tGR_EVENT_MASK
;

64 
	tGR_FUNC_NAME
[25];

65 
	tGR_WM_PROPS
;

66 
	tGR_SERIALNO
;

67 
	tGR_MIMETYPE
;

68 
	tGR_LENGTH
;

69 
	tGR_BUTTON
;

73 
GR_COORD
 
x
;

74 
GR_COORD
 
y
;

75 
GR_SIZE
 
width
;

76 
GR_SIZE
 
height
;

77 } 
	tGR_RECT
;

80 
	#GR_ROOT_WINDOW_ID
 ((
GR_WINDOW_ID
Ë1)

	)

83 
	#GR_RGB
(
r
,
g
,
b
Ë
	`MWRGB
‘,g,b)

	)

84 
	#GR_ARGB
(
a
,
r
,
g
,
b
Ë
	`MWARGB
◊,r,g,b)

	)

87 
	#GR_MODE_COPY
 
MWMODE_COPY


	)

88 
	#GR_MODE_SET
 
MWMODE_COPY


	)

89 
	#GR_MODE_XOR
 
MWMODE_XOR


	)

90 
	#GR_MODE_OR
 
MWMODE_OR


	)

91 
	#GR_MODE_AND
 
MWMODE_AND


	)

92 
	#GR_MODE_CLEAR
 
MWMODE_CLEAR


	)

93 
	#GR_MODE_SETTO1
 
MWMODE_SETTO1


	)

94 
	#GR_MODE_EQUIV
 
MWMODE_EQUIV


	)

95 
	#GR_MODE_NOR
 
MWMODE_NOR


	)

96 
	#GR_MODE_NAND
 
MWMODE_NAND


	)

97 
	#GR_MODE_INVERT
 
MWMODE_INVERT


	)

98 
	#GR_MODE_COPYINVERTED
 
MWMODE_COPYINVERTED


	)

99 
	#GR_MODE_ORINVERTED
 
MWMODE_ORINVERTED


	)

100 
	#GR_MODE_ANDINVERTED
 
MWMODE_ANDINVERTED


	)

101 
	#GR_MODE_ORREVERSE
 
MWMODE_ORREVERSE


	)

102 
	#GR_MODE_ANDREVERSE
 
MWMODE_ANDREVERSE


	)

103 
	#GR_MODE_NOOP
 
MWMODE_NOOP


	)

105 
	#GR_MODE_DRAWMASK
 0x00FF

	)

106 
	#GR_MODE_EXCLUDECHILDREN
 0x0100

	)

109 
	#GR_LINE_SOLID
 
MWLINE_SOLID


	)

110 
	#GR_LINE_ONOFF_DASH
 
MWLINE_ONOFF_DASH


	)

112 
	#GR_FILL_SOLID
 
MWFILL_SOLID


	)

113 
	#GR_FILL_STIPPLE
 
MWFILL_STIPPLE


	)

114 
	#GR_FILL_OPAQUE_STIPPLE
 
MWFILL_OPAQUE_STIPPLE


	)

115 
	#GR_FILL_TILE
 
MWFILL_TILE


	)

118 
	#GR_POLY_EVENODD
 
MWPOLY_EVENODD


	)

119 
	#GR_POLY_WINDING
 
MWPOLY_WINDING


	)

122 
	#GR_FONT_SYSTEM_VAR
 
MWFONT_SYSTEM_VAR


	)

123 
	#GR_FONT_SYSTEM_FIXED
 
MWFONT_SYSTEM_FIXED


	)

124 
	#GR_FONT_GUI_VAR
 
MWFONT_GUI_VAR


	)

125 
	#GR_FONT_OEM_FIXED
 
MWFONT_OEM_FIXED


	)

128 
	#GR_TFASCII
 
MWTF_ASCII


	)

129 
	#GR_TFUTF8
 
MWTF_UTF8


	)

130 
	#GR_TFUC16
 
MWTF_UC16


	)

131 
	#GR_TFUC32
 
MWTF_UC32


	)

132 
	#GR_TFXCHAR2B
 
MWTF_XCHAR2B


	)

133 
	#GR_TFPACKMASK
 
MWTF_PACKMASK


	)

136 
	#GR_TFTOP
 
MWTF_TOP


	)

137 
	#GR_TFBASELINE
 
MWTF_BASELINE


	)

138 
	#GR_TFBOTTOM
 
MWTF_BOTTOM


	)

141 
	#GR_TFKERNING
 
MWTF_KERNING


	)

142 
	#GR_TFANTIALIAS
 
MWTF_ANTIALIAS


	)

143 
	#GR_TFUNDERLINE
 
MWTF_UNDERLINE


	)

146 
	#GR_ARC
 
MWARC


	)

147 
	#GR_ARCOUTLINE
 
MWARCOUTLINE


	)

148 
	#GR_PIE
 
MWPIE


	)

151 
	#GR_WINDOW_BOUNDING_MASK
 0

	)

152 
	#GR_WINDOW_CLIP_MASK
 1

	)

155 
	#GR_FALSE
 0

	)

156 
	#GR_TRUE
 1

	)

159 
	#GR_IMAGE_MAX_SIZE
 (-1)

	)

162 
	#GR_BUTTON_R
 
MWBUTTON_R


	)

163 
	#GR_BUTTON_M
 
MWBUTTON_M


	)

164 
	#GR_BUTTON_L
 
MWBUTTON_L


	)

165 
	#GR_BUTTON_ANY
 (
MWBUTTON_R
|
MWBUTTON_M
|
MWBUTTON_L
Ë

	)

168 
	#GR_BACKGROUND_TILE
 0

	)

169 
	#GR_BACKGROUND_CENTER
 1

	)

170 
	#GR_BACKGROUND_TOPLEFT
 2

	)

171 
	#GR_BACKGROUND_STRETCH
 4

	)

172 
	#GR_BACKGROUND_TRANS
 8

	)

175 
	#GR_BMDATA_BYTEREVERSE
 01

	)

176 
	#GR_BMDATA_BYTESWAP
 02

	)

180 
	#GR_WM_PROP_NORESIZE
 0x04

	)

181 
	#GR_WM_PROP_NOICONISE
 0x08

	)

182 
	#GR_WM_PROP_NOWINMENU
 0x10

	)

183 
	#GR_WM_PROP_NOROLLUP
 0x20

	)

184 
	#GR_WM_PROP_ONTOP
 0x200

	)

185 
	#GR_WM_PROP_STICKY
 0x400

	)

186 
	#GR_WM_PROP_DND
 0x2000

	)

190 
	#GR_WM_PROPS_NOBACKGROUND
 0x00000001L

	)

191 
	#GR_WM_PROPS_NOFOCUS
 0x00000002L

	)

192 
	#GR_WM_PROPS_NOMOVE
 0x00000004L

	)

193 
	#GR_WM_PROPS_NORAISE
 0x00000008L

	)

194 
	#GR_WM_PROPS_NODECORATE
 0x00000010L

	)

195 
	#GR_WM_PROPS_NOAUTOMOVE
 0x00000020L

	)

196 
	#GR_WM_PROPS_NOAUTORESIZE
 0x00000040L

	)

199 
	#GR_WM_PROPS_APPWINDOW
 0x00000000L

	)

200 
	#GR_WM_PROPS_APPMASK
 0xF0000000L

	)

201 
	#GR_WM_PROPS_BORDER
 0x80000000L

	)

202 
	#GR_WM_PROPS_APPFRAME
 0x40000000L

	)

203 
	#GR_WM_PROPS_CAPTION
 0x20000000L

	)

204 
	#GR_WM_PROPS_CLOSEBOX
 0x10000000L

	)

205 
	#GR_WM_PROPS_MAXIMIZE
 0x08000000L

	)

208 
	#GR_WM_FLAGS_PROPS
 0x0001

	)

209 
	#GR_WM_FLAGS_TITLE
 0x0002

	)

210 
	#GR_WM_FLAGS_BACKGROUND
 0x0004

	)

211 
	#GR_WM_FLAGS_BORDERSIZE
 0x0008

	)

212 
	#GR_WM_FLAGS_BORDERCOLOR
 0x0010

	)

219 
GR_WM_PROPS
 
Êags
;

220 
GR_WM_PROPS
 
¥›s
;

221 
GR_CHAR
 *
tôÀ
;

222 
GR_COLOR
 
background
;

223 
GR_SIZE
 
b‹dîsize
;

224 
GR_COLOR
 
b‹dîcﬁ‹
;

225 } 
	tGR_WM_PROPERTIES
;

231 
GR_WINDOW_ID
 
wid
;

232 
GR_WINDOW_ID
 
∑ª¡
;

233 
GR_WINDOW_ID
 
chûd
;

234 
GR_WINDOW_ID
 
siblög
;

235 
GR_BOOL
 
öput⁄ly
;

236 
GR_BOOL
 
m≠≥d
;

237 
GR_BOOL
 
ªÆized
;

238 
GR_COORD
 
x
;

239 
GR_COORD
 
y
;

240 
GR_SIZE
 
width
;

241 
GR_SIZE
 
height
;

242 
GR_SIZE
 
b‹dîsize
;

243 
GR_COLOR
 
b‹dîcﬁ‹
;

244 
GR_COLOR
 
background
;

245 
GR_EVENT_MASK
 
evítmask
;

246 
GR_WM_PROPS
 
¥›s
;

247 
GR_CURSOR_ID
 
curs‹
;

248 
¥o˚ssid
;

249 } 
	tGR_WINDOW_INFO
;

255 
GR_GC_ID
 
gcid
;

256 
mode
;

257 
GR_REGION_ID
 
ªgi⁄
;

258 
xoff
;

259 
yoff
;

260 
GR_FONT_ID
 
f⁄t
;

261 
GR_COLOR
 
f‹eground
;

262 
GR_COLOR
 
background
;

263 
GR_BOOL
 
fgi•ixñvÆ
;

264 
GR_BOOL
 
bgi•ixñvÆ
;

265 
GR_BOOL
 
u£background
;

266 
GR_BOOL
 
exposuª
;

267 } 
	tGR_GC_INFO
;

273 
GR_COUNT
 
cou¡
;

274 
GR_PALENTRY
 
∑Àâe
[256];

275 } 
	tGR_PALETTE
;

279 
xªs
;

280 
yªs
;

281 
möx
;

282 
möy
;

283 
maxx
;

284 
maxy
;

285 
GR_BOOL
 
xsw≠
;

286 
GR_BOOL
 
ysw≠
;

287 } 
	tGR_CAL_DATA
;

290 
	#GR_ERROR_BAD_WINDOW_ID
 1

	)

291 
	#GR_ERROR_BAD_GC_ID
 2

	)

292 
	#GR_ERROR_BAD_CURSOR_SIZE
 3

	)

293 
	#GR_ERROR_MALLOC_FAILED
 4

	)

294 
	#GR_ERROR_BAD_WINDOW_SIZE
 5

	)

295 
	#GR_ERROR_KEYBOARD_ERROR
 6

	)

296 
	#GR_ERROR_MOUSE_ERROR
 7

	)

297 
	#GR_ERROR_INPUT_ONLY_WINDOW
 8

	)

298 
	#GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
 9

	)

299 
	#GR_ERROR_TOO_MUCH_CLIPPING
 10

	)

300 
	#GR_ERROR_SCREEN_ERROR
 11

	)

301 
	#GR_ERROR_UNMAPPED_FOCUS_WINDOW
 12

	)

302 
	#GR_ERROR_BAD_DRAWING_MODE
 13

	)

303 
	#GR_ERROR_BAD_LINE_ATTRIBUTE
 14

	)

304 
	#GR_ERROR_BAD_FILL_MODE
 15

	)

305 
	#GR_ERROR_BAD_REGION_ID
 16

	)

314 
	#GR_EVENT_TYPE_ERROR
 (-1)

	)

315 
	#GR_EVENT_TYPE_NONE
 0

	)

316 
	#GR_EVENT_TYPE_EXPOSURE
 1

	)

317 
	#GR_EVENT_TYPE_BUTTON_DOWN
 2

	)

318 
	#GR_EVENT_TYPE_BUTTON_UP
 3

	)

319 
	#GR_EVENT_TYPE_MOUSE_ENTER
 4

	)

320 
	#GR_EVENT_TYPE_MOUSE_EXIT
 5

	)

321 
	#GR_EVENT_TYPE_MOUSE_MOTION
 6

	)

322 
	#GR_EVENT_TYPE_MOUSE_POSITION
 7

	)

323 
	#GR_EVENT_TYPE_KEY_DOWN
 8

	)

324 
	#GR_EVENT_TYPE_KEY_UP
 9

	)

325 
	#GR_EVENT_TYPE_FOCUS_IN
 10

	)

326 
	#GR_EVENT_TYPE_FOCUS_OUT
 11

	)

327 
	#GR_EVENT_TYPE_FDINPUT
 12

	)

328 
	#GR_EVENT_TYPE_UPDATE
 13

	)

329 
	#GR_EVENT_TYPE_CHLD_UPDATE
 14

	)

330 
	#GR_EVENT_TYPE_CLOSE_REQ
 15

	)

331 
	#GR_EVENT_TYPE_TIMEOUT
 16

	)

332 
	#GR_EVENT_TYPE_SCREENSAVER
 17

	)

333 
	#GR_EVENT_TYPE_CLIENT_DATA_REQ
 18

	)

334 
	#GR_EVENT_TYPE_CLIENT_DATA
 19

	)

335 
	#GR_EVENT_TYPE_SELECTION_CHANGED
 20

	)

336 
	#GR_EVENT_TYPE_TIMER
 21

	)

337 
	#GR_EVENT_TYPE_PORTRAIT_CHANGED
 22

	)

340 
	#GR_EVENTMASK
(
n
Ë(((
GR_EVENT_MASK
Ë1Ë<< (n))

	)

342 
	#GR_EVENT_MASK_NONE
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_NONE
)

	)

343 
	#GR_EVENT_MASK_ERROR
 0x80000000L

	)

344 
	#GR_EVENT_MASK_EXPOSURE
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_EXPOSURE
)

	)

345 
	#GR_EVENT_MASK_BUTTON_DOWN
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_BUTTON_DOWN
)

	)

346 
	#GR_EVENT_MASK_BUTTON_UP
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_BUTTON_UP
)

	)

347 
	#GR_EVENT_MASK_MOUSE_ENTER
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_MOUSE_ENTER
)

	)

348 
	#GR_EVENT_MASK_MOUSE_EXIT
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_MOUSE_EXIT
)

	)

349 
	#GR_EVENT_MASK_MOUSE_MOTION
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_MOUSE_MOTION
)

	)

350 
	#GR_EVENT_MASK_MOUSE_POSITION
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_MOUSE_POSITION
)

	)

351 
	#GR_EVENT_MASK_KEY_DOWN
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_KEY_DOWN
)

	)

352 
	#GR_EVENT_MASK_KEY_UP
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_KEY_UP
)

	)

353 
	#GR_EVENT_MASK_FOCUS_IN
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_FOCUS_IN
)

	)

354 
	#GR_EVENT_MASK_FOCUS_OUT
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_FOCUS_OUT
)

	)

355 
	#GR_EVENT_MASK_FDINPUT
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_FDINPUT
)

	)

356 
	#GR_EVENT_MASK_UPDATE
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_UPDATE
)

	)

357 
	#GR_EVENT_MASK_CHLD_UPDATE
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_CHLD_UPDATE
)

	)

358 
	#GR_EVENT_MASK_CLOSE_REQ
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_CLOSE_REQ
)

	)

359 
	#GR_EVENT_MASK_TIMEOUT
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_TIMEOUT
)

	)

360 
	#GR_EVENT_MASK_SCREENSAVER
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_SCREENSAVER
)

	)

361 
	#GR_EVENT_MASK_CLIENT_DATA_REQ
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_CLIENT_DATA_REQ
)

	)

362 
	#GR_EVENT_MASK_CLIENT_DATA
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_CLIENT_DATA
)

	)

363 
	#GR_EVENT_MASK_SELECTION_CHANGED
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_SELECTION_CHANGED
)

	)

364 
	#GR_EVENT_MASK_TIMER
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_TIMER
)

	)

365 
	#GR_EVENT_MASK_PORTRAIT_CHANGED
 
	`GR_EVENTMASK
(
GR_EVENT_TYPE_PORTRAIT_CHANGED
)

	)

369 
	#GR_EVENT_MASK_ALL
 ((
GR_EVENT_MASK
Ë-1L)

	)

372 
	#GR_UPDATE_MAP
 1

	)

373 
	#GR_UPDATE_UNMAP
 2

	)

374 
	#GR_UPDATE_MOVE
 3

	)

375 
	#GR_UPDATE_SIZE
 4

	)

376 
	#GR_UPDATE_UNMAPTEMP
 5

	)

377 
	#GR_UPDATE_ACTIVATE
 6

	)

378 
	#GR_UPDATE_DESTROY
 7

	)

379 
	#GR_UPDATE_REPARENT
 8

	)

390 
GR_EVENT_TYPE
 
ty≥
;

391 
GR_FUNC_NAME
 
«me
;

392 
GR_ERROR
 
code
;

393 
GR_ID
 
id
;

394 } 
	tGR_EVENT_ERROR
;

400 
GR_EVENT_TYPE
 
ty≥
;

401 
GR_WINDOW_ID
 
wid
;

402 
GR_WINDOW_ID
 
subwid
;

403 
GR_COORD
 
roŸx
;

404 
GR_COORD
 
roŸy
;

405 
GR_COORD
 
x
;

406 
GR_COORD
 
y
;

407 
GR_BUTTON
 
buâ⁄s
;

408 
GR_BUTTON
 
ch™gebuâ⁄s
;

409 
GR_KEYMOD
 
modifõrs
;

410 
GR_TIMEOUT
 
time
;

411 } 
	tGR_EVENT_BUTTON
;

417 
GR_EVENT_TYPE
 
ty≥
;

418 
GR_WINDOW_ID
 
wid
;

419 
GR_WINDOW_ID
 
subwid
;

420 
GR_COORD
 
roŸx
;

421 
GR_COORD
 
roŸy
;

422 
GR_COORD
 
x
;

423 
GR_COORD
 
y
;

424 
GR_BUTTON
 
buâ⁄s
;

425 
GR_KEYMOD
 
modifõrs
;

426 
GR_KEY
 
ch
;

427 
GR_SCANCODE
 
sˇncode
;

428 
GR_BOOL
 
hŸkey
;

429 } 
	tGR_EVENT_KEYSTROKE
;

435 
GR_EVENT_TYPE
 
ty≥
;

436 
GR_WINDOW_ID
 
wid
;

437 
GR_COORD
 
x
;

438 
GR_COORD
 
y
;

439 
GR_SIZE
 
width
;

440 
GR_SIZE
 
height
;

441 } 
	tGR_EVENT_EXPOSURE
;

450 
GR_EVENT_TYPE
 
ty≥
;

451 
GR_WINDOW_ID
 
wid
;

452 
GR_WINDOW_ID
 
Ÿhîid
;

453 } 
	tGR_EVENT_GENERAL
;

459 
GR_EVENT_TYPE
 
ty≥
;

460 
GR_WINDOW_ID
 
wid
;

461 
GR_WINDOW_ID
 
subwid
;

462 
GR_COORD
 
roŸx
;

463 
GR_COORD
 
roŸy
;

464 
GR_COORD
 
x
;

465 
GR_COORD
 
y
;

466 
GR_BUTTON
 
buâ⁄s
;

467 
GR_KEYMOD
 
modifõrs
;

468 } 
	tGR_EVENT_MOUSE
;

474 
GR_EVENT_TYPE
 
ty≥
;

475 
fd
;

476 } 
	tGR_EVENT_FDINPUT
;

482 
GR_EVENT_TYPE
 
ty≥
;

483 
GR_WINDOW_ID
 
wid
;

484 
GR_WINDOW_ID
 
subwid
;

485 
GR_COORD
 
x
;

486 
GR_COORD
 
y
;

487 
GR_SIZE
 
width
;

488 
GR_SIZE
 
height
;

489 
GR_UPDATE_TYPE
 
uty≥
;

490 } 
	tGR_EVENT_UPDATE
;

496 
GR_EVENT_TYPE
 
ty≥
;

497 
GR_BOOL
 
a˘iv©e
;

498 } 
	tGR_EVENT_SCREENSAVER
;

504 
GR_EVENT_TYPE
 
ty≥
;

505 
GR_WINDOW_ID
 
wid
;

506 
GR_WINDOW_ID
 
rid
;

507 
GR_SERIALNO
 
£rül
;

508 
GR_MIMETYPE
 
mimëy≥
;

509 } 
	tGR_EVENT_CLIENT_DATA_REQ
;

515 
GR_EVENT_TYPE
 
ty≥
;

516 
GR_WINDOW_ID
 
wid
;

517 
GR_WINDOW_ID
 
rid
;

518 
GR_SERIALNO
 
£rül
;

519 
Àn
;

520 
d©Æí
;

521 *
d©a
;

522 } 
	tGR_EVENT_CLIENT_DATA
;

528 
GR_EVENT_TYPE
 
ty≥
;

529 
GR_WINDOW_ID
 
√w_ow√r
;

530 } 
	tGR_EVENT_SELECTION_CHANGED
;

536 
GR_EVENT_TYPE
 
ty≥
;

537 
GR_WINDOW_ID
 
wid
;

538 
GR_TIMER_ID
 
tid
;

539 } 
	tGR_EVENT_TIMER
;

546 
GR_EVENT_TYPE
 
ty≥
;

547 
GR_EVENT_ERROR
 
îr‹
;

548 
GR_EVENT_GENERAL
 
gíîÆ
;

549 
GR_EVENT_BUTTON
 
buâ⁄
;

550 
GR_EVENT_KEYSTROKE
 
key°roke
;

551 
GR_EVENT_EXPOSURE
 
exposuª
;

552 
GR_EVENT_MOUSE
 
mou£
;

553 
GR_EVENT_FDINPUT
 
fdöput
;

554 
GR_EVENT_UPDATE
 
upd©e
;

555 
GR_EVENT_SCREENSAVER
 
s¸ìnßvî
;

556 
GR_EVENT_CLIENT_DATA_REQ
 
˛õ¡d©¨eq
;

557 
GR_EVENT_CLIENT_DATA
 
˛õ¡d©a
;

558 
GR_EVENT_SELECTION_CHANGED
 
£À˘i⁄ch™ged
;

559 
GR_EVENT_TIMER
 
timî
;

560 } 
	tGR_EVENT
;

562 (*
GR_FNCALLBACKEVENT
)(
	tGR_EVENT
 *);

566 
	#GR_BITMAP_SIZE
(
width
, 
height
Ë
	`MWIMAGE_SIZE
(width, height)

	)

567 
	#GR_BITMAPBITS
 
MWIMAGE_BITSPERIMAGE


	)

568 
	#GR_BITVALUE
(
n
Ë
	`MWIMAGE_BITVALUE
“)

	)

569 
	#GR_FIRSTBIT
 
MWIMAGE_FIRSTBIT


	)

570 
	#GR_NEXTBIT
(
m
Ë
	`MWIMAGE_NEXTBIT
(m)

	)

571 
	#GR_TESTBIT
(
m
Ë
	`MWIMAGE_TESTBIT
(m)

	)

572 
	#GR_SHIFTBIT
(
m
Ë
	`MWIMAGE_SHIFTBIT
(m)

	)

592 
	#GR_GRAB_HOTKEY_EXCLUSIVE
 0

	)

614 
	#GR_GRAB_HOTKEY
 1

	)

634 
	#GR_GRAB_EXCLUSIVE
 2

	)

649 
	#GR_GRAB_EXCLUSIVE_MOUSE
 3

	)

657 
	#GR_GRAB_MAX
 
GR_GRAB_EXCLUSIVE_MOUSE


	)

661 
	#GR_COLOR_DESKTOP
 0

	)

664 
	#GR_COLOR_ACTIVECAPTION
 1

	)

665 
	#GR_COLOR_ACTIVECAPTIONTEXT
 2

	)

666 
	#GR_COLOR_INACTIVECAPTION
 3

	)

667 
	#GR_COLOR_INACTIVECAPTIONTEXT
 4

	)

670 
	#GR_COLOR_WINDOWFRAME
 5

	)

671 
	#GR_COLOR_BTNSHADOW
 6

	)

672 
	#GR_COLOR_3DLIGHT
 7

	)

673 
	#GR_COLOR_BTNHIGHLIGHT
 8

	)

676 
	#GR_COLOR_APPWINDOW
 9

	)

677 
	#GR_COLOR_APPTEXT
 10

	)

680 
	#GR_COLOR_BTNFACE
 11

	)

681 
	#GR_COLOR_BTNTEXT
 12

	)

684 
	#GR_COLOR_WINDOW
 13

	)

685 
	#GR_COLOR_WINDOWTEXT
 14

	)

686 
	#GR_COLOR_HIGHLIGHT
 15

	)

687 
	#GR_COLOR_HIGHLIGHTTEXT
 16

	)

688 
	#GR_COLOR_GRAYTEXT
 17

	)

691 
	#GR_COLOR_MENUTEXT
 18

	)

692 
	#GR_COLOR_MENU
 19

	)

697 
	#GR_ERROR_STRINGS
 \

714 "BadÑegi⁄ id: %d\n",

	)

716 *
nxEº‹Såögs
[];

719 
GrFlush
();

720 
GrO≥n
();

721 
GrClo£
();

722 
GrDñay
(
GR_TIMEOUT
 
m£cs
);

723 
GrGëS¸ìnInfo
(
GR_SCREEN_INFO
 *
sù
);

724 
GR_COLOR
 
GrGëSysCﬁ‹
(
ödex
);

725 
GR_WINDOW_ID
 
GrNewWödow
(GR_WINDOW_ID 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
,

726 
GR_SIZE
 
width
, GR_SIZE 
height
, GR_SIZE 
b‹dîsize
,

727 
GR_COLOR
 
background
, GR_COLOR 
b‹dîcﬁ‹
);

728 
GR_WINDOW_ID
 
GrNewPixm≠
(
GR_SIZE
 
width
, GR_SIZE 
height
, *
pixñs
);

729 
GR_WINDOW_ID
 
GrNewI≈utWödow
(GR_WINDOW_ID 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
,

730 
GR_SIZE
 
width
, GR_SIZE 
height
);

731 
GrDe°royWödow
(
GR_WINDOW_ID
 
wid
);

732 
GR_GC_ID
 
GrNewGC
();

733 
GR_GC_ID
 
GrC›yGC
(GR_GC_ID 
gc
);

734 
GrGëGCInfo
(
GR_GC_ID
 
gc
, 
GR_GC_INFO
 *
gcù
);

735 
GrDe°royGC
(
GR_GC_ID
 
gc
);

736 
GR_REGION_ID
 
GrNewRegi⁄
();

737 
GR_REGION_ID
 
GrNewBôm≠Regi⁄
(
GR_BITMAP
 *
bôm≠
, 
GR_SIZE
 
width
,

738 
GR_SIZE
 
height
);

739 
GR_REGION_ID
 
GrNewPﬁyg⁄Regi⁄
(
mode
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöts
);

740 
GrDe°royRegi⁄
(
GR_REGION_ID
 
ªgi⁄
);

741 
GrUni⁄Re˘WôhRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
);

742 
GrUni⁄Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

743 
GR_REGION_ID
 
§c_rgn2
);

744 
GrI¡î£˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

745 
GR_REGION_ID
 
§c_rgn2
);

746 
GrSubåa˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

747 
GR_REGION_ID
 
§c_rgn2
);

748 
GrX‹Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

749 
GR_REGION_ID
 
§c_rgn2
);

750 
GrSëGCRegi⁄
(
GR_GC_ID
 
gc
, 
GR_REGION_ID
 
ªgi⁄
);

751 
GrSëGCClùOrigö
(
GR_GC_ID
 
gc
, 
x
, 
y
);

752 
GR_BOOL
 
GrPoötInRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
);

753 
GrRe˘InRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
,

754 
GR_COORD
 
w
, GR_COORD 
h
);

755 
GR_BOOL
 
GrEm±yRegi⁄
(
GR_REGION_ID
 
ªgi⁄
);

756 
GR_BOOL
 
GrEquÆRegi⁄
(
GR_REGION_ID
 
rgn1
, GR_REGION_ID 
rgn2
);

757 
GrOff£tRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_SIZE
 
dx
, GR_SIZE 
dy
);

758 
GrGëRegi⁄Box
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
);

759 
GrM≠Wödow
(
GR_WINDOW_ID
 
wid
);

760 
GrUnm≠Wödow
(
GR_WINDOW_ID
 
wid
);

761 
GrRai£Wödow
(
GR_WINDOW_ID
 
wid
);

762 
GrLowîWödow
(
GR_WINDOW_ID
 
wid
);

763 
GrMoveWödow
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
);

764 
GrResizeWödow
(
GR_WINDOW_ID
 
wid
, 
GR_SIZE
 
width
, GR_SIZE 
height
);

765 
GrRï¨ítWödow
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pwid
,

766 
GR_COORD
 
x
, GR_COORD 
y
);

767 
GrGëWödowInfo
(
GR_WINDOW_ID
 
wid
, 
GR_WINDOW_INFO
 *
öf›å
);

768 
GrSëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
);

769 
GrGëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
);

770 
GR_FONT_ID
 
GrCª©eF⁄t
(
GR_CHAR
 *
«me
, 
GR_COORD
 
height
,

771 
GR_LOGFONT
 *
∂ogf⁄t
);

772 
GR_FONT_ID
 
GrCª©eF⁄tFromBuf„r
(c⁄° *
buf„r
, 
Àngth
,

773 c⁄° *
f‹m©
, 
GR_COORD
 
height
);

774 
GR_FONT_ID
 
GrC›yF⁄t
(GR_FONT_ID 
f⁄tid
, 
GR_COORD
 
height
);

775 
GrGëF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, *
numf⁄ts
);

776 
GrFªeF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, 
numf⁄ts
);

777 
GrSëF⁄tSize
(
GR_FONT_ID
 
f⁄tid
, 
GR_COORD
 
size
);

778 
GrSëF⁄tRŸ©i⁄
(
GR_FONT_ID
 
f⁄tid
, 
ã¡hsdegªes
);

779 
GrSëF⁄tAâr
(
GR_FONT_ID
 
f⁄tid
, 
£tÊags
, 
˛rÊags
);

780 
GrDe°royF⁄t
(
GR_FONT_ID
 
f⁄tid
);

781 
GrGëF⁄tInfo
(
GR_FONT_ID
 
f⁄t
, 
GR_FONT_INFO
 *
fù
);

782 
GR_WINDOW_ID
 
GrGëFocus
();

783 
GrSëFocus
(
GR_WINDOW_ID
 
wid
);

784 
GrCÀ¨Aªa
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
,

785 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_BOOL
 
expo£Êag
);

786 
GrSñe˘Evíts
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
evítmask
);

787 
GrGëNextEvít
(
GR_EVENT
 *
ï
);

788 
GrGëTy≥dEvít
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
mask
,

789 
GR_UPDATE_TYPE
 
upd©e
, 
GR_EVENT
 *
ï
, 
GR_BOOL
 
block
);

790 
GR_BOOL
 (*
	tGR_TYPED_EVENT_CALLBACK
)(
	tGR_WINDOW_ID
, 
	tGR_EVENT_MASK
,

791 
	tGR_UPDATE_TYPE
, 
	tGR_EVENT
 *, *);

792 
GrGëTy≥dEvítPªd
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
mask
,

793 
GR_UPDATE_TYPE
 
upd©e
, 
GR_EVENT
 * 
ï
, 
GR_BOOL
 
block
,

794 
GR_TYPED_EVENT_CALLBACK
 
m©ch‚
, *
¨g
);

795 
GrGëNextEvítTimeout
(
GR_EVENT
 *
ï
, 
GR_TIMEOUT
 
timeout
);

796 
GrCheckNextEvít
(
GR_EVENT
 *
ï
);

797 
GrPìkEvít
(
GR_EVENT
 *
ï
);

798 
GrPìkWaôEvít
(
GR_EVENT
 *
ï
);

799 
GrLöe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x1
, GR_COORD 
y1
,

800 
GR_COORD
 
x2
, GR_COORD 
y2
);

801 
GrPoöt
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
);

802 
GrPoöts
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
,

803 
GR_POINT
 *
poöâabÀ
);

804 
GrRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

805 
GR_SIZE
 
width
, GR_SIZE 
height
);

806 
GrFûlRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

807 
GR_SIZE
 
width
, GR_SIZE 
height
);

808 
GrPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
,

809 
GR_POINT
 *
poöâabÀ
);

810 
GrFûlPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
,

811 
GR_POINT
 *
poöâabÀ
);

812 
GrEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

813 
GR_SIZE
 
rx
, GR_SIZE 
ry
);

814 
GrFûlEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
,

815 
GR_COORD
 
y
, 
GR_SIZE
 
rx
, GR_SIZE 
ry
);

816 
GrArc
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

817 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
ax
, GR_COORD 
ay
,

818 
GR_COORD
 
bx
, GR_COORD 
by
, 
ty≥
);

819 
GrArcAngÀ
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

820 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
™gÀ1
,

821 
GR_COORD
 
™gÀ2
, 
ty≥
);

822 
GrSëGCF‹eground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
f‹eground
);

823 
GrSëGCF‹egroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
f‹eground
);

824 
GrSëGCBackground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
background
);

825 
GrSëGCBackgroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
background
);

826 
GrSëGCU£Background
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
Êag
);

827 
GrSëGCMode
(
GR_GC_ID
 
gc
, 
mode
);

829 
GrSëGCLöeAâribuãs
(
GR_GC_ID
, );

830 
GrSëGCDash
(
GR_GC_ID
, *, );

831 
GrSëGCFûlMode
(
GR_GC_ID
, );

832 
GrSëGCStù∂e
(
GR_GC_ID
, 
GR_BITMAP
 *, 
GR_SIZE
, GR_SIZE);

833 
GrSëGCTûe
(
GR_GC_ID
, 
GR_WINDOW_ID
, 
GR_SIZE
, GR_SIZE);

834 
GrSëGCTSOff£t
(
GR_GC_ID
, 
GR_COORD
, GR_COORD);

836 
GrSëGCGøphicsExposuª
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
exposuª
);

837 
GrSëGCF⁄t
(
GR_GC_ID
 
gc
, 
GR_FONT_ID
 
f⁄t
);

838 
GrGëGCTextSize
(
GR_GC_ID
 
gc
, *
°r
, 
cou¡
,

839 
GR_TEXTFLAGS
 
Êags
, 
GR_SIZE
 *
ªtwidth
,

840 
GR_SIZE
 *
ªtheight
,GR_SIZE *
ªtba£
);

841 
GrRódAªa
(
GR_DRAW_ID
 
id
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

842 
GR_SIZE
 
height
, 
GR_PIXELVAL
 *
pixñs
);

843 
GrAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

844 
GR_SIZE
 
width
,GR_SIZE 
height
,*
pixñs
,
pixty≥
);

845 
GrC›yAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

846 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_DRAW_ID
 
§cid
,

847 
GR_COORD
 
§cx
, GR_COORD 
§cy
, 
›
);

848 
GrSåëchAªa
(
GR_DRAW_ID
 
d°id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
dx1
,

849 
GR_COORD
 
dy1
, GR_COORD 
dx2
, GR_COORD 
dy2
,

850 
GR_DRAW_ID
 
§cid
, 
GR_COORD
 
sx1
, GR_COORD 
sy1
,

851 
GR_COORD
 
sx2
, GR_COORD 
sy2
, 
›
);

852 
GrBôm≠
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

853 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_BITMAP
 *
imagebôs
);

854 
GrDøwImageBôs
(
GR_DRAW_ID
 
id
,
GR_GC_ID
 
gc
,
GR_COORD
 
x
,GR_COORD 
y
,

855 
GR_IMAGE_HDR
 *
pimage
);

856 
GrDøwImageFromFûe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
,

857 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
,

858 *
∑th
, 
Êags
);

859 
GR_IMAGE_ID
 
GrLﬂdImageFromFûe
(*
∑th
, 
Êags
);

860 
GrDøwImageFromBuf„r
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
,

861 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
,

862 *
buf„r
, 
size
, 
Êags
);

863 
GR_IMAGE_ID
 
GrLﬂdImageFromBuf„r
(*
buf„r
, 
size
, 
Êags
);

864 
GrDøwImageToFô
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
,

865 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
,

866 
GR_IMAGE_ID
 
imageid
);

867 
GrFªeImage
(
GR_IMAGE_ID
 
id
);

868 
GrGëImageInfo
(
GR_IMAGE_ID
 
id
, 
GR_IMAGE_INFO
 *
iù
);

869 
GrText
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

870 *
°r
, 
GR_COUNT
 
cou¡
, 
GR_TEXTFLAGS
 
Êags
);

871 
GR_CURSOR_ID
 
GrNewCurs‹
(
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COORD
 
hŸx
,

872 
GR_COORD
 
hŸy
, 
GR_COLOR
 
f‹eground
, GR_COLOR 
background
,

873 
GR_BITMAP
 *
fgbôm≠
, GR_BITMAP *
bgbôm≠
);

874 
GrDe°royCurs‹
(
GR_CURSOR_ID
 
cid
);

875 
GrSëWödowCurs‹
(
GR_WINDOW_ID
 
wid
, 
GR_CURSOR_ID
 
cid
);

876 
GrSëWödowRegi⁄
(
GR_WINDOW_ID
 
wid
, 
GR_REGION_ID
 
rid
, 
ty≥
);

877 
GrMoveCurs‹
(
GR_COORD
 
x
, GR_COORD 
y
);

878 
GrGëSy°emPÆëã
(
GR_PALETTE
 *
∑l
);

879 
GrSëSy°emPÆëã
(
GR_COUNT
 
fú°
, 
GR_PALETTE
 *
∑l
);

880 
GrFödCﬁ‹
(
GR_COLOR
 
c
, 
GR_PIXELVAL
 *
ªçixñ
);

881 
GrReqShmCmds
(
shmsize
);

882 
GrInje˘PoöãrEvít
(
MWCOORD
 
x
, MWCOORD 
y
,

883 
buâ⁄
, 
visibÀ
);

884 
GrInje˘KeybﬂrdEvít
(
GR_WINDOW_ID
 
wid
, 
GR_KEY
 
keyvÆue
,

885 
GR_KEYMOD
 
modifõrs
, 
GR_SCANCODE
 
sˇncode
,

886 
GR_BOOL
 
¥es£d
);

887 
GrClo£Wödow
(
GR_WINDOW_ID
 
wid
);

888 
GrKûlWödow
(
GR_WINDOW_ID
 
wid
);

889 
GrSëS¸ìnSavîTimeout
(
GR_TIMEOUT
 
timeout
);

890 
GrSëSñe˘i⁄Ow√r
(
GR_WINDOW_ID
 
wid
, 
GR_CHAR
 *
ty≥li°
);

891 
GR_WINDOW_ID
 
GrGëSñe˘i⁄Ow√r
(
GR_CHAR
 **
ty≥li°
);

892 
GrReque°Clõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
,

893 
GR_SERIALNO
 
£rül
, 
GR_MIMETYPE
 
mimëy≥
);

894 
GrSídClõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
did
,

895 
GR_SERIALNO
 
£rül
, 
GR_LENGTH
 
Àn
, GR_LENGTH 
thi¶í
,

896 *
d©a
);

897 
GrBñl
();

898 
GrSëBackgroundPixm≠
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pixm≠
,

899 
Êags
);

900 
GrQuîyPoöãr
(
GR_WINDOW_ID
 *
mwö
, 
GR_COORD
 *
x
, GR_COORD *
y
,

901 
GR_BUTTON
 *
bmask
);

902 
GrQuîyTªe
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID *
∑ª¡id
,

903 
GR_WINDOW_ID
 **
chûdªn
, 
GR_COUNT
 *
nchûdªn
);

904 
GR_BOOL
 
GrGøbKey
(
GR_WINDOW_ID
 
wid
, 
GR_KEY
 
key
, 
ty≥
);

905 
GrUngøbKey
(
GR_WINDOW_ID
 
wid
, 
GR_KEY
 
key
);

907 
GR_TIMER_ID
 
GrCª©eTimî
(
GR_WINDOW_ID
 
wid
, 
GR_TIMEOUT
 
≥riod
);

908 
GrDe°royTimî
(
GR_TIMER_ID
 
tid
);

909 
GrSëP‹åaôMode
(
p‹åaômode
);

911 
GrRegi°îI≈ut
(
fd
);

912 
GrUƒegi°îI≈ut
(
fd
);

913 
GrMaöLo›
(
GR_FNCALLBACKEVENT
 
‚cb
);

914 
GR_FNCALLBACKEVENT
 
GrSëEº‹H™dÀr
(GR_FNCALLBACKEVENT 
‚cb
);

915 
GrDeÁu…Eº‹H™dÀr
(
GR_EVENT
 *
ï
);

918 
GrPª∑ªSñe˘
(*
maxfd
,*
rfd£t
);

919 
GrSîvi˚Sñe˘
(*
rfd£t
, 
GR_FNCALLBACKEVENT
 
‚cb
);

922 
GrQueueLígth
();

924 
GrSëTønsf‹m
(
GR_TRANSFORM
 *);

927 
GrCÆcTønsf‹m
(
GR_CAL_DATA
 *, 
GR_TRANSFORM
 *);

928 
GrLﬂdTønsf‹mD©a
(*
fûíame
, 
GR_TRANSFORM
 *);

929 
GrSaveTønsf‹mD©a
(
GR_TRANSFORM
 *, *
fûíame
);

932 
GR_WINDOW_ID
 
GrNewWödowEx
(
GR_WM_PROPS
 
¥›s
, 
GR_CHAR
 *
tôÀ
,

933 
GR_WINDOW_ID
 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
,

934 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COLOR
 
background
);

935 
GrDøwLöes
(
GR_DRAW_ID
 
w
, 
GR_GC_ID
 
gc
, 
GR_POINT
 *
poöts
,

936 
GR_COUNT
 
cou¡
);

937 
GR_BITMAP
 * 
GrNewBôm≠FromD©a
(
GR_SIZE
 
width
, GR_SIZE 
height
, GR_SIZE 
bôs_width
,

938 
GR_SIZE
 
bôs_height
, *
bôs
, 
Êags
);

939 
GR_WINDOW_ID
 
GrNewPixm≠FromD©a
(
GR_SIZE
 
width
, GR_SIZE 
height
,

940 
GR_COLOR
 
f‹eground
, GR_COLOR 
background
, * 
bôs
,

941 
Êags
);

942 
GR_BITMAP
 * 
GrNewBôm≠FromPixm≠
(
GR_WINDOW_ID
 
pixm≠
, 
x
, 
y
, 
GR_SIZE
 
width
,

943 
GR_SIZE
 
height
);

944 
GR_BITMAP
 * 
GrNewBôm≠FromPixm≠
(
GR_WINDOW_ID
 
pixm≠
, 
x
, 
y
,

945 
GR_SIZE
 
width
, GR_SIZE 
height
);

946 
GR_REGION_ID
 
GrNewRegi⁄FromPixm≠
(
GR_WINDOW_ID
 
§c
, 
MWCOORD
 
x
, MWCOORD 
y
,

947 
GR_SIZE
 
width
, GR_SIZE 
height
);

950 * 
GrO≥nClõ¡Fømebuf„r
();

951 
GrClo£Clõ¡Fømebuf„r
();

952 
GrGëWödowFBInfo
(
GR_WINDOW_ID
 
wid
, 
GR_WINDOW_FB_INFO
 *
fböfo
);

955 
GR_CURSOR_ID
 
GrSëCurs‹
(
GR_WINDOW_ID
 
wid
, 
GR_SIZE
 
width
, GR_SIZE 
height
,

956 
GR_COORD
 
hŸx
, GR_COORD 
hŸy
, 
GR_COLOR
 
f‹eground
,

957 
GR_COLOR
 
background
, 
GR_BITMAP
 *
fbbôm≠
,

958 
GR_BITMAP
 *
bgbôm≠
);

959 
	#GrSëB‹dîCﬁ‹
 
GrSëWödowB‹dîCﬁ‹


	)

960 
	#GrCÀ¨Wödow
(
wid
,
expo£Êag
Ë
	`GrCÀ¨Aªa
(wid,0,0,0,0,expo£ÊagË

	)

963 
	#GrSëWödowBackgroundCﬁ‹
(
wid
,
cﬁ‹
) \

964 { 
GR_WM_PROPERTIES
 
¥›s
; \

965 
¥›s
.
Êags
 = 
GR_WM_FLAGS_BACKGROUND
; \

966 
¥›s
.
background
 = 
cﬁ‹
; \

967 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
); \

968 }

	)

969 
	#GrSëWödowB‹dîSize
(
wid
,
width
) \

970 { 
GR_WM_PROPERTIES
 
¥›s
; \

971 
¥›s
.
Êags
 = 
GR_WM_FLAGS_BORDERSIZE
; \

972 
¥›s
.
b‹dîsize
 = 
width
; \

973 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
); \

974 }

	)

975 
	#GrSëWödowB‹dîCﬁ‹
(
wid
,
cﬁ‹
) \

976 { 
GR_WM_PROPERTIES
 
¥›s
; \

977 
¥›s
.
Êags
 = 
GR_WM_FLAGS_BORDERCOLOR
; \

978 
¥›s
.
b‹dîcﬁ‹
 = 
cﬁ‹
; \

979 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
); \

980 }

	)

981 
	#GrSëWödowTôÀ
(
wid
,
«me
) \

982 { 
GR_WM_PROPERTIES
 
¥›s
; \

983 
¥›s
.
Êags
 = 
GR_WM_FLAGS_TITLE
; \

984 
¥›s
.
tôÀ
 = (
GR_CHAR
 *)
«me
; \

985 
	`GrSëWMPr›îtõs
(
wid
, &
¥›s
); \

986 }

	)

988 #ifde‡
__˝lu•lus


993 #i‡
__πems__


994 
	#maö
 
πems_maö


	)

998 
evít_li°
 
	tEVENT_LIST
;

999 
	sevít_li°
 {

1000 
EVENT_LIST
 * 
	g√xt
;

1001 
GR_EVENT
 
	gevít
;

1006 *
	gbuÂå
;

1007 *
	gbufmax
;

1008 *
	gbuf„r
;

1009 } 
	tREQBUF
;

1011 #ifde‡
__ECOS


1012 
	~<sys/£À˘.h
>

1013 
	~<cyg/kî√l/k≠i.h
>

1020 
	g_nxSockë
;

1021 
MWMUTEX
 
	g_nxGlobÆLock
;

1022 
	g_°‹edevít
;

1023 
GR_EVENT
 
	g_°‹edevít_d©a
;

1024 
	g_ªgfdmax
;

1025 
fd_£t
 
	g_ªgfd£t
;

1026 
GR_FNCALLBACKEVENT
 
	g_GrEº‹Func
;

1027 
REQBUF
 
	g_ªqbuf
;

1028 
EVENT_LIST
 *
	g_evli°
;

1029 } 
	tecos_«nox_˛õ¡_d©a
;

1031 
ecos_«nox_˛õ¡_d©a_ödex
;

1033 
	#ACCESS_PER_THREAD_DATA
() \

1034 
ecos_«nox_˛õ¡_d©a
 *
d©a
 = (ecos_nanox_client_data*) \

1035 
	`cyg_thªad_gë_d©a
((
cyg_ucou¡32
)
ecos_«nox_˛õ¡_d©a_ödex
);

	)

1037 
	#INIT_PER_THREAD_DATA
() \

1039 
ecos_«nox_˛õ¡_d©a
 *
d±r
 = 
	`mÆloc
((ecos_nanox_client_data)); \

1040 
ecos_«nox_˛õ¡_d©a_ödex
 = 
d©a
; \

1041 
d±r
->
_nxSockë
 = -1; \

1042 
d±r
->
nxGlobÆLock
 = 0;

	)

1043 
	gd±r
->
	g_°‹edevít
 = 0; \

1044 
	gd±r
->
	g_ªgfdmax
 = -1; \

1045 
FD_ZERO
(&
d±r
->
_ªgfd£t
); \

1046 
	gd±r
->
	g_GrEº‹Func
 = 
GrDeÁu…Eº‹H™dÀr
; \

1047 
	gd±r
->
	g_ªqbuf
.
	gbuÂå
 = 
NULL
; \

1048 
	gd±r
->
	g_ªqbuf
.
	gbufmax
 = 
NULL
; \

1049 
	gd±r
->
	g_ªqbuf
.
	gbuf„r
 = 
NULL
; \

1050 
	gd±r
->
	g_evli°
 = 
NULL
; \

1051 
cyg_thªad_£t_d©a
(
ecos_«nox_˛õ¡_d©a_ödex
,(
CYG_ADDRWORD
)
d±r
); \

1054 
	#nxSockë
 (
d©a
->
_nxSockë
)

	)

1055 
	#nxGlobÆLock
 (
d©a
->
_nxGlobÆLock
)

	)

1056 
	#°‹edevít
 (
d©a
->
_°‹edevít
)

	)

1057 
	#°‹edevít_d©a
 (
d©a
->
_°‹edevít_d©a
)

	)

1058 
	#ªgfdmax
 (
d©a
->
_ªgfdmax
)

	)

1059 
	#ªgfd£t
 (
d©a
->
_ªgfd£t
)

	)

1060 
	#Eº‹Func
 (
d©a
->
_GrEº‹Func
)

	)

1061 
	#ªqbuf
 (
d©a
->
_ªqbuf
)

	)

1062 
	#evli°
 (
d©a
->
_evli°
)

	)

1065 
	#ACCESS_PER_THREAD_DATA
()

	)

1069 #i‡
PSP


1071 
	~<p•kî√l.h
>

1072 
	~<p•debug.h
>

1075 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

1077 
	#Ârötf
(...)

	)

	@include/nxcolors.h

1 #i‚de‡
NXCOLORS_H


2 
	#NXCOLORS_H


	)

10 
	~"mwty≥s.h
"

12 
	#GR_COLOR_SNOW
 
	`MWRGB
(255,250,250)

	)

13 
	#GR_COLOR_GHOSTWHITE
 
	`MWRGB
(248,248,255)

	)

14 
	#GR_COLOR_WHITESMOKE
 
	`MWRGB
(245,245,245)

	)

15 
	#GR_COLOR_GAINSBORO
 
	`MWRGB
(220,220,220)

	)

16 
	#GR_COLOR_FLORALWHITE
 
	`MWRGB
(255,250,240)

	)

17 
	#GR_COLOR_OLDLACE
 
	`MWRGB
(253,245,230)

	)

18 
	#GR_COLOR_LINEN
 
	`MWRGB
(250,240,230)

	)

19 
	#GR_COLOR_ANTIQUEWHITE
 
	`MWRGB
(250,235,215)

	)

20 
	#GR_COLOR_PAPAYAWHIP
 
	`MWRGB
(255,239,213)

	)

21 
	#GR_COLOR_BLANCHEDALMOND
 
	`MWRGB
(255,235,205)

	)

22 
	#GR_COLOR_BISQUE
 
	`MWRGB
(255,228,196)

	)

23 
	#GR_COLOR_PEACHPUFF
 
	`MWRGB
(255,218,185)

	)

24 
	#GR_COLOR_NAVAJOWHITE
 
	`MWRGB
(255,222,173)

	)

25 
	#GR_COLOR_MOCCASIN
 
	`MWRGB
(255,228,181)

	)

26 
	#GR_COLOR_CORNSILK
 
	`MWRGB
(255,248,220)

	)

27 
	#GR_COLOR_IVORY
 
	`MWRGB
(255,255,240)

	)

28 
	#GR_COLOR_LEMONCHIFFON
 
	`MWRGB
(255,250,205)

	)

29 
	#GR_COLOR_SEASHELL
 
	`MWRGB
(255,245,238)

	)

30 
	#GR_COLOR_HONEYDEW
 
	`MWRGB
(240,255,240)

	)

31 
	#GR_COLOR_MINTCREAM
 
	`MWRGB
(245,255,250)

	)

32 
	#GR_COLOR_AZURE
 
	`MWRGB
(240,255,255)

	)

33 
	#GR_COLOR_ALICEBLUE
 
	`MWRGB
(240,248,255)

	)

34 
	#GR_COLOR_LAVENDER
 
	`MWRGB
(230,230,250)

	)

35 
	#GR_COLOR_LAVENDERBLUSH
 
	`MWRGB
(255,240,245)

	)

36 
	#GR_COLOR_MISTYROSE
 
	`MWRGB
(255,228,225)

	)

37 
	#GR_COLOR_WHITE
 
	`MWRGB
(255,255,255)

	)

38 
	#GR_COLOR_BLACK
 
	`MWRGB
(0,0,0)

	)

39 
	#GR_COLOR_DARKSLATEGRAY
 
	`MWRGB
(47,79,79)

	)

40 
	#GR_COLOR_DARKSLATEGREY
 
	`MWRGB
(47,79,79)

	)

41 
	#GR_COLOR_DIMGRAY
 
	`MWRGB
(105,105,105)

	)

42 
	#GR_COLOR_DIMGREY
 
	`MWRGB
(105,105,105)

	)

43 
	#GR_COLOR_SLATEGRAY
 
	`MWRGB
(112,128,144)

	)

44 
	#GR_COLOR_SLATEGREY
 
	`MWRGB
(112,128,144)

	)

45 
	#GR_COLOR_LIGHTSLATEGRAY
 
	`MWRGB
(119,136,153)

	)

46 
	#GR_COLOR_LIGHTSLATEGREY
 
	`MWRGB
(119,136,153)

	)

47 
	#GR_COLOR_GRAY
 
	`MWRGB
(190,190,190)

	)

48 
	#GR_COLOR_GREY
 
	`MWRGB
(190,190,190)

	)

49 
	#GR_COLOR_LIGHTGREY
 
	`MWRGB
(211,211,211)

	)

50 
	#GR_COLOR_LIGHTGRAY
 
	`MWRGB
(211,211,211)

	)

51 
	#GR_COLOR_MIDNIGHTBLUE
 
	`MWRGB
(25,25,112)

	)

52 
	#GR_COLOR_NAVY
 
	`MWRGB
(0,0,128)

	)

53 
	#GR_COLOR_NAVYBLUE
 
	`MWRGB
(0,0,128)

	)

54 
	#GR_COLOR_CORNFLOWERBLUE
 
	`MWRGB
(100,149,237)

	)

55 
	#GR_COLOR_DARKSLATEBLUE
 
	`MWRGB
(72,61,139)

	)

56 
	#GR_COLOR_SLATEBLUE
 
	`MWRGB
(106,90,205)

	)

57 
	#GR_COLOR_MEDIUMSLATEBLUE
 
	`MWRGB
(123,104,238)

	)

58 
	#GR_COLOR_LIGHTSLATEBLUE
 
	`MWRGB
(132,112,255)

	)

59 
	#GR_COLOR_MEDIUMBLUE
 
	`MWRGB
(0,0,205)

	)

60 
	#GR_COLOR_ROYALBLUE
 
	`MWRGB
(65,105,225)

	)

61 
	#GR_COLOR_BLUE
 
	`MWRGB
(0,0,255)

	)

62 
	#GR_COLOR_DODGERBLUE
 
	`MWRGB
(30,144,255)

	)

63 
	#GR_COLOR_DEEPSKYBLUE
 
	`MWRGB
(0,191,255)

	)

64 
	#GR_COLOR_SKYBLUE
 
	`MWRGB
(135,206,235)

	)

65 
	#GR_COLOR_LIGHTSKYBLUE
 
	`MWRGB
(135,206,250)

	)

66 
	#GR_COLOR_STEELBLUE
 
	`MWRGB
(70,130,180)

	)

67 
	#GR_COLOR_LIGHTSTEELBLUE
 
	`MWRGB
(176,196,222)

	)

68 
	#GR_COLOR_LIGHTBLUE
 
	`MWRGB
(173,216,230)

	)

69 
	#GR_COLOR_POWDERBLUE
 
	`MWRGB
(176,224,230)

	)

70 
	#GR_COLOR_PALETURQUOISE
 
	`MWRGB
(175,238,238)

	)

71 
	#GR_COLOR_DARKTURQUOISE
 
	`MWRGB
(0,206,209)

	)

72 
	#GR_COLOR_MEDIUMTURQUOISE
 
	`MWRGB
(72,209,204)

	)

73 
	#GR_COLOR_TURQUOISE
 
	`MWRGB
(64,224,208)

	)

74 
	#GR_COLOR_CYAN
 
	`MWRGB
(0,255,255)

	)

75 
	#GR_COLOR_LIGHTCYAN
 
	`MWRGB
(224,255,255)

	)

76 
	#GR_COLOR_CADETBLUE
 
	`MWRGB
(95,158,160)

	)

77 
	#GR_COLOR_MEDIUMAQUAMARINE
 
	`MWRGB
(102,205,170)

	)

78 
	#GR_COLOR_AQUAMARINE
 
	`MWRGB
(127,255,212)

	)

79 
	#GR_COLOR_DARKGREEN
 
	`MWRGB
(0,100,0)

	)

80 
	#GR_COLOR_DARKOLIVEGREEN
 
	`MWRGB
(85,107,47)

	)

81 
	#GR_COLOR_DARKSEAGREEN
 
	`MWRGB
(143,188,143)

	)

82 
	#GR_COLOR_SEAGREEN
 
	`MWRGB
(46,139,87)

	)

83 
	#GR_COLOR_MEDIUMSEAGREEN
 
	`MWRGB
(60,179,113)

	)

84 
	#GR_COLOR_LIGHTSEAGREEN
 
	`MWRGB
(32,178,170)

	)

85 
	#GR_COLOR_PALEGREEN
 
	`MWRGB
(152,251,152)

	)

86 
	#GR_COLOR_SPRINGGREEN
 
	`MWRGB
(0,255,127)

	)

87 
	#GR_COLOR_LAWNGREEN
 
	`MWRGB
(124,252,0)

	)

88 
	#GR_COLOR_GREEN
 
	`MWRGB
(0,255,0)

	)

89 
	#GR_COLOR_CHARTREUSE
 
	`MWRGB
(127,255,0)

	)

90 
	#GR_COLOR_MEDIUMSPRINGGREEN
 
	`MWRGB
(0,250,154)

	)

91 
	#GR_COLOR_GREENYELLOW
 
	`MWRGB
(173,255,47)

	)

92 
	#GR_COLOR_LIMEGREEN
 
	`MWRGB
(50,205,50)

	)

93 
	#GR_COLOR_YELLOWGREEN
 
	`MWRGB
(154,205,50)

	)

94 
	#GR_COLOR_FORESTGREEN
 
	`MWRGB
(34,139,34)

	)

95 
	#GR_COLOR_OLIVEDRAB
 
	`MWRGB
(107,142,35)

	)

96 
	#GR_COLOR_DARKKHAKI
 
	`MWRGB
(189,183,107)

	)

97 
	#GR_COLOR_KHAKI
 
	`MWRGB
(240,230,140)

	)

98 
	#GR_COLOR_PALEGOLDENROD
 
	`MWRGB
(238,232,170)

	)

99 
	#GR_COLOR_LIGHTGOLDENRODYELLOW
 
	`MWRGB
(250,250,210)

	)

100 
	#GR_COLOR_LIGHTYELLOW
 
	`MWRGB
(255,255,224)

	)

101 
	#GR_COLOR_YELLOW
 
	`MWRGB
(255,255,0)

	)

102 
	#GR_COLOR_GOLD
 
	`MWRGB
(255,215,0)

	)

103 
	#GR_COLOR_LIGHTGOLDENROD
 
	`MWRGB
(238,221,130)

	)

104 
	#GR_COLOR_GOLDENROD
 
	`MWRGB
(218,165,32)

	)

105 
	#GR_COLOR_DARKGOLDENROD
 
	`MWRGB
(184,134,11)

	)

106 
	#GR_COLOR_ROSYBROWN
 
	`MWRGB
(188,143,143)

	)

107 
	#GR_COLOR_INDIANRED
 
	`MWRGB
(205,92,92)

	)

108 
	#GR_COLOR_SADDLEBROWN
 
	`MWRGB
(139,69,19)

	)

109 
	#GR_COLOR_SIENNA
 
	`MWRGB
(160,82,45)

	)

110 
	#GR_COLOR_PERU
 
	`MWRGB
(205,133,63)

	)

111 
	#GR_COLOR_BURLYWOOD
 
	`MWRGB
(222,184,135)

	)

112 
	#GR_COLOR_BEIGE
 
	`MWRGB
(245,245,220)

	)

113 
	#GR_COLOR_WHEAT
 
	`MWRGB
(245,222,179)

	)

114 
	#GR_COLOR_SANDYBROWN
 
	`MWRGB
(244,164,96)

	)

115 
	#GR_COLOR_TAN
 
	`MWRGB
(210,180,140)

	)

116 
	#GR_COLOR_CHOCOLATE
 
	`MWRGB
(210,105,30)

	)

117 
	#GR_COLOR_FIREBRICK
 
	`MWRGB
(178,34,34)

	)

118 
	#GR_COLOR_BROWN
 
	`MWRGB
(165,42,42)

	)

119 
	#GR_COLOR_DARKSALMON
 
	`MWRGB
(233,150,122)

	)

120 
	#GR_COLOR_SALMON
 
	`MWRGB
(250,128,114)

	)

121 
	#GR_COLOR_LIGHTSALMON
 
	`MWRGB
(255,160,122)

	)

122 
	#GR_COLOR_ORANGE
 
	`MWRGB
(255,165,0)

	)

123 
	#GR_COLOR_DARKORANGE
 
	`MWRGB
(255,140,0)

	)

124 
	#GR_COLOR_CORAL
 
	`MWRGB
(255,127,80)

	)

125 
	#GR_COLOR_LIGHTCORAL
 
	`MWRGB
(240,128,128)

	)

126 
	#GR_COLOR_TOMATO
 
	`MWRGB
(255,99,71)

	)

127 
	#GR_COLOR_ORANGERED
 
	`MWRGB
(255,69,0)

	)

128 
	#GR_COLOR_RED
 
	`MWRGB
(255,0,0)

	)

129 
	#GR_COLOR_HOTPINK
 
	`MWRGB
(255,105,180)

	)

130 
	#GR_COLOR_DEEPPINK
 
	`MWRGB
(255,20,147)

	)

131 
	#GR_COLOR_PINK
 
	`MWRGB
(255,192,203)

	)

132 
	#GR_COLOR_LIGHTPINK
 
	`MWRGB
(255,182,193)

	)

133 
	#GR_COLOR_PALEVIOLETRED
 
	`MWRGB
(219,112,147)

	)

134 
	#GR_COLOR_MAROON
 
	`MWRGB
(176,48,96)

	)

135 
	#GR_COLOR_MEDIUMVIOLETRED
 
	`MWRGB
(199,21,133)

	)

136 
	#GR_COLOR_VIOLETRED
 
	`MWRGB
(208,32,144)

	)

137 
	#GR_COLOR_MAGENTA
 
	`MWRGB
(255,0,255)

	)

138 
	#GR_COLOR_VIOLET
 
	`MWRGB
(238,130,238)

	)

139 
	#GR_COLOR_PLUM
 
	`MWRGB
(221,160,221)

	)

140 
	#GR_COLOR_ORCHID
 
	`MWRGB
(218,112,214)

	)

141 
	#GR_COLOR_MEDIUMORCHID
 
	`MWRGB
(186,85,211)

	)

142 
	#GR_COLOR_DARKORCHID
 
	`MWRGB
(153,50,204)

	)

143 
	#GR_COLOR_DARKVIOLET
 
	`MWRGB
(148,0,211)

	)

144 
	#GR_COLOR_BLUEVIOLET
 
	`MWRGB
(138,43,226)

	)

145 
	#GR_COLOR_PURPLE
 
	`MWRGB
(160,32,240)

	)

146 
	#GR_COLOR_MEDIUMPURPLE
 
	`MWRGB
(147,112,219)

	)

147 
	#GR_COLOR_THISTLE
 
	`MWRGB
(216,191,216)

	)

148 
	#GR_COLOR_SNOW1
 
	`MWRGB
(255,250,250)

	)

149 
	#GR_COLOR_SNOW2
 
	`MWRGB
(238,233,233)

	)

150 
	#GR_COLOR_SNOW3
 
	`MWRGB
(205,201,201)

	)

151 
	#GR_COLOR_SNOW4
 
	`MWRGB
(139,137,137)

	)

152 
	#GR_COLOR_SEASHELL1
 
	`MWRGB
(255,245,238)

	)

153 
	#GR_COLOR_SEASHELL2
 
	`MWRGB
(238,229,222)

	)

154 
	#GR_COLOR_SEASHELL3
 
	`MWRGB
(205,197,191)

	)

155 
	#GR_COLOR_SEASHELL4
 
	`MWRGB
(139,134,130)

	)

156 
	#GR_COLOR_ANTIQUEWHITE1
 
	`MWRGB
(255,239,219)

	)

157 
	#GR_COLOR_ANTIQUEWHITE2
 
	`MWRGB
(238,223,204)

	)

158 
	#GR_COLOR_ANTIQUEWHITE3
 
	`MWRGB
(205,192,176)

	)

159 
	#GR_COLOR_ANTIQUEWHITE4
 
	`MWRGB
(139,131,120)

	)

160 
	#GR_COLOR_BISQUE1
 
	`MWRGB
(255,228,196)

	)

161 
	#GR_COLOR_BISQUE2
 
	`MWRGB
(238,213,183)

	)

162 
	#GR_COLOR_BISQUE3
 
	`MWRGB
(205,183,158)

	)

163 
	#GR_COLOR_BISQUE4
 
	`MWRGB
(139,125,107)

	)

164 
	#GR_COLOR_PEACHPUFF1
 
	`MWRGB
(255,218,185)

	)

165 
	#GR_COLOR_PEACHPUFF2
 
	`MWRGB
(238,203,173)

	)

166 
	#GR_COLOR_PEACHPUFF3
 
	`MWRGB
(205,175,149)

	)

167 
	#GR_COLOR_PEACHPUFF4
 
	`MWRGB
(139,119,101)

	)

168 
	#GR_COLOR_NAVAJOWHITE1
 
	`MWRGB
(255,222,173)

	)

169 
	#GR_COLOR_NAVAJOWHITE2
 
	`MWRGB
(238,207,161)

	)

170 
	#GR_COLOR_NAVAJOWHITE3
 
	`MWRGB
(205,179,139)

	)

171 
	#GR_COLOR_NAVAJOWHITE4
 
	`MWRGB
(139,121,94)

	)

172 
	#GR_COLOR_LEMONCHIFFON1
 
	`MWRGB
(255,250,205)

	)

173 
	#GR_COLOR_LEMONCHIFFON2
 
	`MWRGB
(238,233,191)

	)

174 
	#GR_COLOR_LEMONCHIFFON3
 
	`MWRGB
(205,201,165)

	)

175 
	#GR_COLOR_LEMONCHIFFON4
 
	`MWRGB
(139,137,112)

	)

176 
	#GR_COLOR_CORNSILK1
 
	`MWRGB
(255,248,220)

	)

177 
	#GR_COLOR_CORNSILK2
 
	`MWRGB
(238,232,205)

	)

178 
	#GR_COLOR_CORNSILK3
 
	`MWRGB
(205,200,177)

	)

179 
	#GR_COLOR_CORNSILK4
 
	`MWRGB
(139,136,120)

	)

180 
	#GR_COLOR_IVORY1
 
	`MWRGB
(255,255,240)

	)

181 
	#GR_COLOR_IVORY2
 
	`MWRGB
(238,238,224)

	)

182 
	#GR_COLOR_IVORY3
 
	`MWRGB
(205,205,193)

	)

183 
	#GR_COLOR_IVORY4
 
	`MWRGB
(139,139,131)

	)

184 
	#GR_COLOR_HONEYDEW1
 
	`MWRGB
(240,255,240)

	)

185 
	#GR_COLOR_HONEYDEW2
 
	`MWRGB
(224,238,224)

	)

186 
	#GR_COLOR_HONEYDEW3
 
	`MWRGB
(193,205,193)

	)

187 
	#GR_COLOR_HONEYDEW4
 
	`MWRGB
(131,139,131)

	)

188 
	#GR_COLOR_LAVENDERBLUSH1
 
	`MWRGB
(255,240,245)

	)

189 
	#GR_COLOR_LAVENDERBLUSH2
 
	`MWRGB
(238,224,229)

	)

190 
	#GR_COLOR_LAVENDERBLUSH3
 
	`MWRGB
(205,193,197)

	)

191 
	#GR_COLOR_LAVENDERBLUSH4
 
	`MWRGB
(139,131,134)

	)

192 
	#GR_COLOR_MISTYROSE1
 
	`MWRGB
(255,228,225)

	)

193 
	#GR_COLOR_MISTYROSE2
 
	`MWRGB
(238,213,210)

	)

194 
	#GR_COLOR_MISTYROSE3
 
	`MWRGB
(205,183,181)

	)

195 
	#GR_COLOR_MISTYROSE4
 
	`MWRGB
(139,125,123)

	)

196 
	#GR_COLOR_AZURE1
 
	`MWRGB
(240,255,255)

	)

197 
	#GR_COLOR_AZURE2
 
	`MWRGB
(224,238,238)

	)

198 
	#GR_COLOR_AZURE3
 
	`MWRGB
(193,205,205)

	)

199 
	#GR_COLOR_AZURE4
 
	`MWRGB
(131,139,139)

	)

200 
	#GR_COLOR_SLATEBLUE1
 
	`MWRGB
(131,111,255)

	)

201 
	#GR_COLOR_SLATEBLUE2
 
	`MWRGB
(122,103,238)

	)

202 
	#GR_COLOR_SLATEBLUE3
 
	`MWRGB
(105,89,205)

	)

203 
	#GR_COLOR_SLATEBLUE4
 
	`MWRGB
(71,60,139)

	)

204 
	#GR_COLOR_ROYALBLUE1
 
	`MWRGB
(72,118,255)

	)

205 
	#GR_COLOR_ROYALBLUE2
 
	`MWRGB
(67,110,238)

	)

206 
	#GR_COLOR_ROYALBLUE3
 
	`MWRGB
(58,95,205)

	)

207 
	#GR_COLOR_ROYALBLUE4
 
	`MWRGB
(39,64,139)

	)

208 
	#GR_COLOR_BLUE1
 
	`MWRGB
(0,0,255)

	)

209 
	#GR_COLOR_BLUE2
 
	`MWRGB
(0,0,238)

	)

210 
	#GR_COLOR_BLUE3
 
	`MWRGB
(0,0,205)

	)

211 
	#GR_COLOR_BLUE4
 
	`MWRGB
(0,0,139)

	)

212 
	#GR_COLOR_DODGERBLUE1
 
	`MWRGB
(30,144,255)

	)

213 
	#GR_COLOR_DODGERBLUE2
 
	`MWRGB
(28,134,238)

	)

214 
	#GR_COLOR_DODGERBLUE3
 
	`MWRGB
(24,116,205)

	)

215 
	#GR_COLOR_DODGERBLUE4
 
	`MWRGB
(16,78,139)

	)

216 
	#GR_COLOR_STEELBLUE1
 
	`MWRGB
(99,184,255)

	)

217 
	#GR_COLOR_STEELBLUE2
 
	`MWRGB
(92,172,238)

	)

218 
	#GR_COLOR_STEELBLUE3
 
	`MWRGB
(79,148,205)

	)

219 
	#GR_COLOR_STEELBLUE4
 
	`MWRGB
(54,100,139)

	)

220 
	#GR_COLOR_DEEPSKYBLUE1
 
	`MWRGB
(0,191,255)

	)

221 
	#GR_COLOR_DEEPSKYBLUE2
 
	`MWRGB
(0,178,238)

	)

222 
	#GR_COLOR_DEEPSKYBLUE3
 
	`MWRGB
(0,154,205)

	)

223 
	#GR_COLOR_DEEPSKYBLUE4
 
	`MWRGB
(0,104,139)

	)

224 
	#GR_COLOR_SKYBLUE1
 
	`MWRGB
(135,206,255)

	)

225 
	#GR_COLOR_SKYBLUE2
 
	`MWRGB
(126,192,238)

	)

226 
	#GR_COLOR_SKYBLUE3
 
	`MWRGB
(108,166,205)

	)

227 
	#GR_COLOR_SKYBLUE4
 
	`MWRGB
(74,112,139)

	)

228 
	#GR_COLOR_LIGHTSKYBLUE1
 
	`MWRGB
(176,226,255)

	)

229 
	#GR_COLOR_LIGHTSKYBLUE2
 
	`MWRGB
(164,211,238)

	)

230 
	#GR_COLOR_LIGHTSKYBLUE3
 
	`MWRGB
(141,182,205)

	)

231 
	#GR_COLOR_LIGHTSKYBLUE4
 
	`MWRGB
(96,123,139)

	)

232 
	#GR_COLOR_SLATEGRAY1
 
	`MWRGB
(198,226,255)

	)

233 
	#GR_COLOR_SLATEGRAY2
 
	`MWRGB
(185,211,238)

	)

234 
	#GR_COLOR_SLATEGRAY3
 
	`MWRGB
(159,182,205)

	)

235 
	#GR_COLOR_SLATEGRAY4
 
	`MWRGB
(108,123,139)

	)

236 
	#GR_COLOR_LIGHTSTEELBLUE1
 
	`MWRGB
(202,225,255)

	)

237 
	#GR_COLOR_LIGHTSTEELBLUE2
 
	`MWRGB
(188,210,238)

	)

238 
	#GR_COLOR_LIGHTSTEELBLUE3
 
	`MWRGB
(162,181,205)

	)

239 
	#GR_COLOR_LIGHTSTEELBLUE4
 
	`MWRGB
(110,123,139)

	)

240 
	#GR_COLOR_LIGHTBLUE1
 
	`MWRGB
(191,239,255)

	)

241 
	#GR_COLOR_LIGHTBLUE2
 
	`MWRGB
(178,223,238)

	)

242 
	#GR_COLOR_LIGHTBLUE3
 
	`MWRGB
(154,192,205)

	)

243 
	#GR_COLOR_LIGHTBLUE4
 
	`MWRGB
(104,131,139)

	)

244 
	#GR_COLOR_LIGHTCYAN1
 
	`MWRGB
(224,255,255)

	)

245 
	#GR_COLOR_LIGHTCYAN2
 
	`MWRGB
(209,238,238)

	)

246 
	#GR_COLOR_LIGHTCYAN3
 
	`MWRGB
(180,205,205)

	)

247 
	#GR_COLOR_LIGHTCYAN4
 
	`MWRGB
(122,139,139)

	)

248 
	#GR_COLOR_PALETURQUOISE1
 
	`MWRGB
(187,255,255)

	)

249 
	#GR_COLOR_PALETURQUOISE2
 
	`MWRGB
(174,238,238)

	)

250 
	#GR_COLOR_PALETURQUOISE3
 
	`MWRGB
(150,205,205)

	)

251 
	#GR_COLOR_PALETURQUOISE4
 
	`MWRGB
(102,139,139)

	)

252 
	#GR_COLOR_CADETBLUE1
 
	`MWRGB
(152,245,255)

	)

253 
	#GR_COLOR_CADETBLUE2
 
	`MWRGB
(142,229,238)

	)

254 
	#GR_COLOR_CADETBLUE3
 
	`MWRGB
(122,197,205)

	)

255 
	#GR_COLOR_CADETBLUE4
 
	`MWRGB
(83,134,139)

	)

256 
	#GR_COLOR_TURQUOISE1
 
	`MWRGB
(0,245,255)

	)

257 
	#GR_COLOR_TURQUOISE2
 
	`MWRGB
(0,229,238)

	)

258 
	#GR_COLOR_TURQUOISE3
 
	`MWRGB
(0,197,205)

	)

259 
	#GR_COLOR_TURQUOISE4
 
	`MWRGB
(0,134,139)

	)

260 
	#GR_COLOR_CYAN1
 
	`MWRGB
(0,255,255)

	)

261 
	#GR_COLOR_CYAN2
 
	`MWRGB
(0,238,238)

	)

262 
	#GR_COLOR_CYAN3
 
	`MWRGB
(0,205,205)

	)

263 
	#GR_COLOR_CYAN4
 
	`MWRGB
(0,139,139)

	)

264 
	#GR_COLOR_DARKSLATEGRAY1
 
	`MWRGB
(151,255,255)

	)

265 
	#GR_COLOR_DARKSLATEGRAY2
 
	`MWRGB
(141,238,238)

	)

266 
	#GR_COLOR_DARKSLATEGRAY3
 
	`MWRGB
(121,205,205)

	)

267 
	#GR_COLOR_DARKSLATEGRAY4
 
	`MWRGB
(82,139,139)

	)

268 
	#GR_COLOR_AQUAMARINE1
 
	`MWRGB
(127,255,212)

	)

269 
	#GR_COLOR_AQUAMARINE2
 
	`MWRGB
(118,238,198)

	)

270 
	#GR_COLOR_AQUAMARINE3
 
	`MWRGB
(102,205,170)

	)

271 
	#GR_COLOR_AQUAMARINE4
 
	`MWRGB
(69,139,116)

	)

272 
	#GR_COLOR_DARKSEAGREEN1
 
	`MWRGB
(193,255,193)

	)

273 
	#GR_COLOR_DARKSEAGREEN2
 
	`MWRGB
(180,238,180)

	)

274 
	#GR_COLOR_DARKSEAGREEN3
 
	`MWRGB
(155,205,155)

	)

275 
	#GR_COLOR_DARKSEAGREEN4
 
	`MWRGB
(105,139,105)

	)

276 
	#GR_COLOR_SEAGREEN1
 
	`MWRGB
(84,255,159)

	)

277 
	#GR_COLOR_SEAGREEN2
 
	`MWRGB
(78,238,148)

	)

278 
	#GR_COLOR_SEAGREEN3
 
	`MWRGB
(67,205,128)

	)

279 
	#GR_COLOR_SEAGREEN4
 
	`MWRGB
(46,139,87)

	)

280 
	#GR_COLOR_PALEGREEN1
 
	`MWRGB
(154,255,154)

	)

281 
	#GR_COLOR_PALEGREEN2
 
	`MWRGB
(144,238,144)

	)

282 
	#GR_COLOR_PALEGREEN3
 
	`MWRGB
(124,205,124)

	)

283 
	#GR_COLOR_PALEGREEN4
 
	`MWRGB
(84,139,84)

	)

284 
	#GR_COLOR_SPRINGGREEN1
 
	`MWRGB
(0,255,127)

	)

285 
	#GR_COLOR_SPRINGGREEN2
 
	`MWRGB
(0,238,118)

	)

286 
	#GR_COLOR_SPRINGGREEN3
 
	`MWRGB
(0,205,102)

	)

287 
	#GR_COLOR_SPRINGGREEN4
 
	`MWRGB
(0,139,69)

	)

288 
	#GR_COLOR_GREEN1
 
	`MWRGB
(0,255,0)

	)

289 
	#GR_COLOR_GREEN2
 
	`MWRGB
(0,238,0)

	)

290 
	#GR_COLOR_GREEN3
 
	`MWRGB
(0,205,0)

	)

291 
	#GR_COLOR_GREEN4
 
	`MWRGB
(0,139,0)

	)

292 
	#GR_COLOR_CHARTREUSE1
 
	`MWRGB
(127,255,0)

	)

293 
	#GR_COLOR_CHARTREUSE2
 
	`MWRGB
(118,238,0)

	)

294 
	#GR_COLOR_CHARTREUSE3
 
	`MWRGB
(102,205,0)

	)

295 
	#GR_COLOR_CHARTREUSE4
 
	`MWRGB
(69,139,0)

	)

296 
	#GR_COLOR_OLIVEDRAB1
 
	`MWRGB
(192,255,62)

	)

297 
	#GR_COLOR_OLIVEDRAB2
 
	`MWRGB
(179,238,58)

	)

298 
	#GR_COLOR_OLIVEDRAB3
 
	`MWRGB
(154,205,50)

	)

299 
	#GR_COLOR_OLIVEDRAB4
 
	`MWRGB
(105,139,34)

	)

300 
	#GR_COLOR_DARKOLIVEGREEN1
 
	`MWRGB
(202,255,112)

	)

301 
	#GR_COLOR_DARKOLIVEGREEN2
 
	`MWRGB
(188,238,104)

	)

302 
	#GR_COLOR_DARKOLIVEGREEN3
 
	`MWRGB
(162,205,90)

	)

303 
	#GR_COLOR_DARKOLIVEGREEN4
 
	`MWRGB
(110,139,61)

	)

304 
	#GR_COLOR_KHAKI1
 
	`MWRGB
(255,246,143)

	)

305 
	#GR_COLOR_KHAKI2
 
	`MWRGB
(238,230,133)

	)

306 
	#GR_COLOR_KHAKI3
 
	`MWRGB
(205,198,115)

	)

307 
	#GR_COLOR_KHAKI4
 
	`MWRGB
(139,134,78)

	)

308 
	#GR_COLOR_LIGHTGOLDENROD1
 
	`MWRGB
(255,236,139)

	)

309 
	#GR_COLOR_LIGHTGOLDENROD2
 
	`MWRGB
(238,220,130)

	)

310 
	#GR_COLOR_LIGHTGOLDENROD3
 
	`MWRGB
(205,190,112)

	)

311 
	#GR_COLOR_LIGHTGOLDENROD4
 
	`MWRGB
(139,129,76)

	)

312 
	#GR_COLOR_LIGHTYELLOW1
 
	`MWRGB
(255,255,224)

	)

313 
	#GR_COLOR_LIGHTYELLOW2
 
	`MWRGB
(238,238,209)

	)

314 
	#GR_COLOR_LIGHTYELLOW3
 
	`MWRGB
(205,205,180)

	)

315 
	#GR_COLOR_LIGHTYELLOW4
 
	`MWRGB
(139,139,122)

	)

316 
	#GR_COLOR_YELLOW1
 
	`MWRGB
(255,255,0)

	)

317 
	#GR_COLOR_YELLOW2
 
	`MWRGB
(238,238,0)

	)

318 
	#GR_COLOR_YELLOW3
 
	`MWRGB
(205,205,0)

	)

319 
	#GR_COLOR_YELLOW4
 
	`MWRGB
(139,139,0)

	)

320 
	#GR_COLOR_GOLD1
 
	`MWRGB
(255,215,0)

	)

321 
	#GR_COLOR_GOLD2
 
	`MWRGB
(238,201,0)

	)

322 
	#GR_COLOR_GOLD3
 
	`MWRGB
(205,173,0)

	)

323 
	#GR_COLOR_GOLD4
 
	`MWRGB
(139,117,0)

	)

324 
	#GR_COLOR_GOLDENROD1
 
	`MWRGB
(255,193,37)

	)

325 
	#GR_COLOR_GOLDENROD2
 
	`MWRGB
(238,180,34)

	)

326 
	#GR_COLOR_GOLDENROD3
 
	`MWRGB
(205,155,29)

	)

327 
	#GR_COLOR_GOLDENROD4
 
	`MWRGB
(139,105,20)

	)

328 
	#GR_COLOR_DARKGOLDENROD1
 
	`MWRGB
(255,185,15)

	)

329 
	#GR_COLOR_DARKGOLDENROD2
 
	`MWRGB
(238,173,14)

	)

330 
	#GR_COLOR_DARKGOLDENROD3
 
	`MWRGB
(205,149,12)

	)

331 
	#GR_COLOR_DARKGOLDENROD4
 
	`MWRGB
(139,101,8)

	)

332 
	#GR_COLOR_ROSYBROWN1
 
	`MWRGB
(255,193,193)

	)

333 
	#GR_COLOR_ROSYBROWN2
 
	`MWRGB
(238,180,180)

	)

334 
	#GR_COLOR_ROSYBROWN3
 
	`MWRGB
(205,155,155)

	)

335 
	#GR_COLOR_ROSYBROWN4
 
	`MWRGB
(139,105,105)

	)

336 
	#GR_COLOR_INDIANRED1
 
	`MWRGB
(255,106,106)

	)

337 
	#GR_COLOR_INDIANRED2
 
	`MWRGB
(238,99,99)

	)

338 
	#GR_COLOR_INDIANRED3
 
	`MWRGB
(205,85,85)

	)

339 
	#GR_COLOR_INDIANRED4
 
	`MWRGB
(139,58,58)

	)

340 
	#GR_COLOR_SIENNA1
 
	`MWRGB
(255,130,71)

	)

341 
	#GR_COLOR_SIENNA2
 
	`MWRGB
(238,121,66)

	)

342 
	#GR_COLOR_SIENNA3
 
	`MWRGB
(205,104,57)

	)

343 
	#GR_COLOR_SIENNA4
 
	`MWRGB
(139,71,38)

	)

344 
	#GR_COLOR_BURLYWOOD1
 
	`MWRGB
(255,211,155)

	)

345 
	#GR_COLOR_BURLYWOOD2
 
	`MWRGB
(238,197,145)

	)

346 
	#GR_COLOR_BURLYWOOD3
 
	`MWRGB
(205,170,125)

	)

347 
	#GR_COLOR_BURLYWOOD4
 
	`MWRGB
(139,115,85)

	)

348 
	#GR_COLOR_WHEAT1
 
	`MWRGB
(255,231,186)

	)

349 
	#GR_COLOR_WHEAT2
 
	`MWRGB
(238,216,174)

	)

350 
	#GR_COLOR_WHEAT3
 
	`MWRGB
(205,186,150)

	)

351 
	#GR_COLOR_WHEAT4
 
	`MWRGB
(139,126,102)

	)

352 
	#GR_COLOR_TAN1
 
	`MWRGB
(255,165,79)

	)

353 
	#GR_COLOR_TAN2
 
	`MWRGB
(238,154,73)

	)

354 
	#GR_COLOR_TAN3
 
	`MWRGB
(205,133,63)

	)

355 
	#GR_COLOR_TAN4
 
	`MWRGB
(139,90,43)

	)

356 
	#GR_COLOR_CHOCOLATE1
 
	`MWRGB
(255,127,36)

	)

357 
	#GR_COLOR_CHOCOLATE2
 
	`MWRGB
(238,118,33)

	)

358 
	#GR_COLOR_CHOCOLATE3
 
	`MWRGB
(205,102,29)

	)

359 
	#GR_COLOR_CHOCOLATE4
 
	`MWRGB
(139,69,19)

	)

360 
	#GR_COLOR_FIREBRICK1
 
	`MWRGB
(255,48,48)

	)

361 
	#GR_COLOR_FIREBRICK2
 
	`MWRGB
(238,44,44)

	)

362 
	#GR_COLOR_FIREBRICK3
 
	`MWRGB
(205,38,38)

	)

363 
	#GR_COLOR_FIREBRICK4
 
	`MWRGB
(139,26,26)

	)

364 
	#GR_COLOR_BROWN1
 
	`MWRGB
(255,64,64)

	)

365 
	#GR_COLOR_BROWN2
 
	`MWRGB
(238,59,59)

	)

366 
	#GR_COLOR_BROWN3
 
	`MWRGB
(205,51,51)

	)

367 
	#GR_COLOR_BROWN4
 
	`MWRGB
(139,35,35)

	)

368 
	#GR_COLOR_SALMON1
 
	`MWRGB
(255,140,105)

	)

369 
	#GR_COLOR_SALMON2
 
	`MWRGB
(238,130,98)

	)

370 
	#GR_COLOR_SALMON3
 
	`MWRGB
(205,112,84)

	)

371 
	#GR_COLOR_SALMON4
 
	`MWRGB
(139,76,57)

	)

372 
	#GR_COLOR_LIGHTSALMON1
 
	`MWRGB
(255,160,122)

	)

373 
	#GR_COLOR_LIGHTSALMON2
 
	`MWRGB
(238,149,114)

	)

374 
	#GR_COLOR_LIGHTSALMON3
 
	`MWRGB
(205,129,98)

	)

375 
	#GR_COLOR_LIGHTSALMON4
 
	`MWRGB
(139,87,66)

	)

376 
	#GR_COLOR_ORANGE1
 
	`MWRGB
(255,165,0)

	)

377 
	#GR_COLOR_ORANGE2
 
	`MWRGB
(238,154,0)

	)

378 
	#GR_COLOR_ORANGE3
 
	`MWRGB
(205,133,0)

	)

379 
	#GR_COLOR_ORANGE4
 
	`MWRGB
(139,90,0)

	)

380 
	#GR_COLOR_DARKORANGE1
 
	`MWRGB
(255,127,0)

	)

381 
	#GR_COLOR_DARKORANGE2
 
	`MWRGB
(238,118,0)

	)

382 
	#GR_COLOR_DARKORANGE3
 
	`MWRGB
(205,102,0)

	)

383 
	#GR_COLOR_DARKORANGE4
 
	`MWRGB
(139,69,0)

	)

384 
	#GR_COLOR_CORAL1
 
	`MWRGB
(255,114,86)

	)

385 
	#GR_COLOR_CORAL2
 
	`MWRGB
(238,106,80)

	)

386 
	#GR_COLOR_CORAL3
 
	`MWRGB
(205,91,69)

	)

387 
	#GR_COLOR_CORAL4
 
	`MWRGB
(139,62,47)

	)

388 
	#GR_COLOR_TOMATO1
 
	`MWRGB
(255,99,71)

	)

389 
	#GR_COLOR_TOMATO2
 
	`MWRGB
(238,92,66)

	)

390 
	#GR_COLOR_TOMATO3
 
	`MWRGB
(205,79,57)

	)

391 
	#GR_COLOR_TOMATO4
 
	`MWRGB
(139,54,38)

	)

392 
	#GR_COLOR_ORANGERED1
 
	`MWRGB
(255,69,0)

	)

393 
	#GR_COLOR_ORANGERED2
 
	`MWRGB
(238,64,0)

	)

394 
	#GR_COLOR_ORANGERED3
 
	`MWRGB
(205,55,0)

	)

395 
	#GR_COLOR_ORANGERED4
 
	`MWRGB
(139,37,0)

	)

396 
	#GR_COLOR_RED1
 
	`MWRGB
(255,0,0)

	)

397 
	#GR_COLOR_RED2
 
	`MWRGB
(238,0,0)

	)

398 
	#GR_COLOR_RED3
 
	`MWRGB
(205,0,0)

	)

399 
	#GR_COLOR_RED4
 
	`MWRGB
(139,0,0)

	)

400 
	#GR_COLOR_DEEPPINK1
 
	`MWRGB
(255,20,147)

	)

401 
	#GR_COLOR_DEEPPINK2
 
	`MWRGB
(238,18,137)

	)

402 
	#GR_COLOR_DEEPPINK3
 
	`MWRGB
(205,16,118)

	)

403 
	#GR_COLOR_DEEPPINK4
 
	`MWRGB
(139,10,80)

	)

404 
	#GR_COLOR_HOTPINK1
 
	`MWRGB
(255,110,180)

	)

405 
	#GR_COLOR_HOTPINK2
 
	`MWRGB
(238,106,167)

	)

406 
	#GR_COLOR_HOTPINK3
 
	`MWRGB
(205,96,144)

	)

407 
	#GR_COLOR_HOTPINK4
 
	`MWRGB
(139,58,98)

	)

408 
	#GR_COLOR_PINK1
 
	`MWRGB
(255,181,197)

	)

409 
	#GR_COLOR_PINK2
 
	`MWRGB
(238,169,184)

	)

410 
	#GR_COLOR_PINK3
 
	`MWRGB
(205,145,158)

	)

411 
	#GR_COLOR_PINK4
 
	`MWRGB
(139,99,108)

	)

412 
	#GR_COLOR_LIGHTPINK1
 
	`MWRGB
(255,174,185)

	)

413 
	#GR_COLOR_LIGHTPINK2
 
	`MWRGB
(238,162,173)

	)

414 
	#GR_COLOR_LIGHTPINK3
 
	`MWRGB
(205,140,149)

	)

415 
	#GR_COLOR_LIGHTPINK4
 
	`MWRGB
(139,95,101)

	)

416 
	#GR_COLOR_PALEVIOLETRED1
 
	`MWRGB
(255,130,171)

	)

417 
	#GR_COLOR_PALEVIOLETRED2
 
	`MWRGB
(238,121,159)

	)

418 
	#GR_COLOR_PALEVIOLETRED3
 
	`MWRGB
(205,104,137)

	)

419 
	#GR_COLOR_PALEVIOLETRED4
 
	`MWRGB
(139,71,93)

	)

420 
	#GR_COLOR_MAROON1
 
	`MWRGB
(255,52,179)

	)

421 
	#GR_COLOR_MAROON2
 
	`MWRGB
(238,48,167)

	)

422 
	#GR_COLOR_MAROON3
 
	`MWRGB
(205,41,144)

	)

423 
	#GR_COLOR_MAROON4
 
	`MWRGB
(139,28,98)

	)

424 
	#GR_COLOR_VIOLETRED1
 
	`MWRGB
(255,62,150)

	)

425 
	#GR_COLOR_VIOLETRED2
 
	`MWRGB
(238,58,140)

	)

426 
	#GR_COLOR_VIOLETRED3
 
	`MWRGB
(205,50,120)

	)

427 
	#GR_COLOR_VIOLETRED4
 
	`MWRGB
(139,34,82)

	)

428 
	#GR_COLOR_MAGENTA1
 
	`MWRGB
(255,0,255)

	)

429 
	#GR_COLOR_MAGENTA2
 
	`MWRGB
(238,0,238)

	)

430 
	#GR_COLOR_MAGENTA3
 
	`MWRGB
(205,0,205)

	)

431 
	#GR_COLOR_MAGENTA4
 
	`MWRGB
(139,0,139)

	)

432 
	#GR_COLOR_ORCHID1
 
	`MWRGB
(255,131,250)

	)

433 
	#GR_COLOR_ORCHID2
 
	`MWRGB
(238,122,233)

	)

434 
	#GR_COLOR_ORCHID3
 
	`MWRGB
(205,105,201)

	)

435 
	#GR_COLOR_ORCHID4
 
	`MWRGB
(139,71,137)

	)

436 
	#GR_COLOR_PLUM1
 
	`MWRGB
(255,187,255)

	)

437 
	#GR_COLOR_PLUM2
 
	`MWRGB
(238,174,238)

	)

438 
	#GR_COLOR_PLUM3
 
	`MWRGB
(205,150,205)

	)

439 
	#GR_COLOR_PLUM4
 
	`MWRGB
(139,102,139)

	)

440 
	#GR_COLOR_MEDIUMORCHID1
 
	`MWRGB
(224,102,255)

	)

441 
	#GR_COLOR_MEDIUMORCHID2
 
	`MWRGB
(209,95,238)

	)

442 
	#GR_COLOR_MEDIUMORCHID3
 
	`MWRGB
(180,82,205)

	)

443 
	#GR_COLOR_MEDIUMORCHID4
 
	`MWRGB
(122,55,139)

	)

444 
	#GR_COLOR_DARKORCHID1
 
	`MWRGB
(191,62,255)

	)

445 
	#GR_COLOR_DARKORCHID2
 
	`MWRGB
(178,58,238)

	)

446 
	#GR_COLOR_DARKORCHID3
 
	`MWRGB
(154,50,205)

	)

447 
	#GR_COLOR_DARKORCHID4
 
	`MWRGB
(104,34,139)

	)

448 
	#GR_COLOR_PURPLE1
 
	`MWRGB
(155,48,255)

	)

449 
	#GR_COLOR_PURPLE2
 
	`MWRGB
(145,44,238)

	)

450 
	#GR_COLOR_PURPLE3
 
	`MWRGB
(125,38,205)

	)

451 
	#GR_COLOR_PURPLE4
 
	`MWRGB
(85,26,139)

	)

452 
	#GR_COLOR_MEDIUMPURPLE1
 
	`MWRGB
(171,130,255)

	)

453 
	#GR_COLOR_MEDIUMPURPLE2
 
	`MWRGB
(159,121,238)

	)

454 
	#GR_COLOR_MEDIUMPURPLE3
 
	`MWRGB
(137,104,205)

	)

455 
	#GR_COLOR_MEDIUMPURPLE4
 
	`MWRGB
(93,71,139)

	)

456 
	#GR_COLOR_THISTLE1
 
	`MWRGB
(255,225,255)

	)

457 
	#GR_COLOR_THISTLE2
 
	`MWRGB
(238,210,238)

	)

458 
	#GR_COLOR_THISTLE3
 
	`MWRGB
(205,181,205)

	)

459 
	#GR_COLOR_THISTLE4
 
	`MWRGB
(139,123,139)

	)

460 
	#GR_COLOR_GRAY0
 
	`MWRGB
(0,0,0)

	)

461 
	#GR_COLOR_GREY0
 
	`MWRGB
(0,0,0)

	)

462 
	#GR_COLOR_GRAY1
 
	`MWRGB
(3,3,3)

	)

463 
	#GR_COLOR_GREY1
 
	`MWRGB
(3,3,3)

	)

464 
	#GR_COLOR_GRAY2
 
	`MWRGB
(5,5,5)

	)

465 
	#GR_COLOR_GREY2
 
	`MWRGB
(5,5,5)

	)

466 
	#GR_COLOR_GRAY3
 
	`MWRGB
(8,8,8)

	)

467 
	#GR_COLOR_GREY3
 
	`MWRGB
(8,8,8)

	)

468 
	#GR_COLOR_GRAY4
 
	`MWRGB
(10,10,10)

	)

469 
	#GR_COLOR_GREY4
 
	`MWRGB
(10,10,10)

	)

470 
	#GR_COLOR_GRAY5
 
	`MWRGB
(13,13,13)

	)

471 
	#GR_COLOR_GREY5
 
	`MWRGB
(13,13,13)

	)

472 
	#GR_COLOR_GRAY6
 
	`MWRGB
(15,15,15)

	)

473 
	#GR_COLOR_GREY6
 
	`MWRGB
(15,15,15)

	)

474 
	#GR_COLOR_GRAY7
 
	`MWRGB
(18,18,18)

	)

475 
	#GR_COLOR_GREY7
 
	`MWRGB
(18,18,18)

	)

476 
	#GR_COLOR_GRAY8
 
	`MWRGB
(20,20,20)

	)

477 
	#GR_COLOR_GREY8
 
	`MWRGB
(20,20,20)

	)

478 
	#GR_COLOR_GRAY9
 
	`MWRGB
(23,23,23)

	)

479 
	#GR_COLOR_GREY9
 
	`MWRGB
(23,23,23)

	)

480 
	#GR_COLOR_GRAY10
 
	`MWRGB
(26,26,26)

	)

481 
	#GR_COLOR_GREY10
 
	`MWRGB
(26,26,26)

	)

482 
	#GR_COLOR_GRAY11
 
	`MWRGB
(28,28,28)

	)

483 
	#GR_COLOR_GREY11
 
	`MWRGB
(28,28,28)

	)

484 
	#GR_COLOR_GRAY12
 
	`MWRGB
(31,31,31)

	)

485 
	#GR_COLOR_GREY12
 
	`MWRGB
(31,31,31)

	)

486 
	#GR_COLOR_GRAY13
 
	`MWRGB
(33,33,33)

	)

487 
	#GR_COLOR_GREY13
 
	`MWRGB
(33,33,33)

	)

488 
	#GR_COLOR_GRAY14
 
	`MWRGB
(36,36,36)

	)

489 
	#GR_COLOR_GREY14
 
	`MWRGB
(36,36,36)

	)

490 
	#GR_COLOR_GRAY15
 
	`MWRGB
(38,38,38)

	)

491 
	#GR_COLOR_GREY15
 
	`MWRGB
(38,38,38)

	)

492 
	#GR_COLOR_GRAY16
 
	`MWRGB
(41,41,41)

	)

493 
	#GR_COLOR_GREY16
 
	`MWRGB
(41,41,41)

	)

494 
	#GR_COLOR_GRAY17
 
	`MWRGB
(43,43,43)

	)

495 
	#GR_COLOR_GREY17
 
	`MWRGB
(43,43,43)

	)

496 
	#GR_COLOR_GRAY18
 
	`MWRGB
(46,46,46)

	)

497 
	#GR_COLOR_GREY18
 
	`MWRGB
(46,46,46)

	)

498 
	#GR_COLOR_GRAY19
 
	`MWRGB
(48,48,48)

	)

499 
	#GR_COLOR_GREY19
 
	`MWRGB
(48,48,48)

	)

500 
	#GR_COLOR_GRAY20
 
	`MWRGB
(51,51,51)

	)

501 
	#GR_COLOR_GREY20
 
	`MWRGB
(51,51,51)

	)

502 
	#GR_COLOR_GRAY21
 
	`MWRGB
(54,54,54)

	)

503 
	#GR_COLOR_GREY21
 
	`MWRGB
(54,54,54)

	)

504 
	#GR_COLOR_GRAY22
 
	`MWRGB
(56,56,56)

	)

505 
	#GR_COLOR_GREY22
 
	`MWRGB
(56,56,56)

	)

506 
	#GR_COLOR_GRAY23
 
	`MWRGB
(59,59,59)

	)

507 
	#GR_COLOR_GREY23
 
	`MWRGB
(59,59,59)

	)

508 
	#GR_COLOR_GRAY24
 
	`MWRGB
(61,61,61)

	)

509 
	#GR_COLOR_GREY24
 
	`MWRGB
(61,61,61)

	)

510 
	#GR_COLOR_GRAY25
 
	`MWRGB
(64,64,64)

	)

511 
	#GR_COLOR_GREY25
 
	`MWRGB
(64,64,64)

	)

512 
	#GR_COLOR_GRAY26
 
	`MWRGB
(66,66,66)

	)

513 
	#GR_COLOR_GREY26
 
	`MWRGB
(66,66,66)

	)

514 
	#GR_COLOR_GRAY27
 
	`MWRGB
(69,69,69)

	)

515 
	#GR_COLOR_GREY27
 
	`MWRGB
(69,69,69)

	)

516 
	#GR_COLOR_GRAY28
 
	`MWRGB
(71,71,71)

	)

517 
	#GR_COLOR_GREY28
 
	`MWRGB
(71,71,71)

	)

518 
	#GR_COLOR_GRAY29
 
	`MWRGB
(74,74,74)

	)

519 
	#GR_COLOR_GREY29
 
	`MWRGB
(74,74,74)

	)

520 
	#GR_COLOR_GRAY30
 
	`MWRGB
(77,77,77)

	)

521 
	#GR_COLOR_GREY30
 
	`MWRGB
(77,77,77)

	)

522 
	#GR_COLOR_GRAY31
 
	`MWRGB
(79,79,79)

	)

523 
	#GR_COLOR_GREY31
 
	`MWRGB
(79,79,79)

	)

524 
	#GR_COLOR_GRAY32
 
	`MWRGB
(82,82,82)

	)

525 
	#GR_COLOR_GREY32
 
	`MWRGB
(82,82,82)

	)

526 
	#GR_COLOR_GRAY33
 
	`MWRGB
(84,84,84)

	)

527 
	#GR_COLOR_GREY33
 
	`MWRGB
(84,84,84)

	)

528 
	#GR_COLOR_GRAY34
 
	`MWRGB
(87,87,87)

	)

529 
	#GR_COLOR_GREY34
 
	`MWRGB
(87,87,87)

	)

530 
	#GR_COLOR_GRAY35
 
	`MWRGB
(89,89,89)

	)

531 
	#GR_COLOR_GREY35
 
	`MWRGB
(89,89,89)

	)

532 
	#GR_COLOR_GRAY36
 
	`MWRGB
(92,92,92)

	)

533 
	#GR_COLOR_GREY36
 
	`MWRGB
(92,92,92)

	)

534 
	#GR_COLOR_GRAY37
 
	`MWRGB
(94,94,94)

	)

535 
	#GR_COLOR_GREY37
 
	`MWRGB
(94,94,94)

	)

536 
	#GR_COLOR_GRAY38
 
	`MWRGB
(97,97,97)

	)

537 
	#GR_COLOR_GREY38
 
	`MWRGB
(97,97,97)

	)

538 
	#GR_COLOR_GRAY39
 
	`MWRGB
(99,99,99)

	)

539 
	#GR_COLOR_GREY39
 
	`MWRGB
(99,99,99)

	)

540 
	#GR_COLOR_GRAY40
 
	`MWRGB
(102,102,102)

	)

541 
	#GR_COLOR_GREY40
 
	`MWRGB
(102,102,102)

	)

542 
	#GR_COLOR_GRAY41
 
	`MWRGB
(105,105,105)

	)

543 
	#GR_COLOR_GREY41
 
	`MWRGB
(105,105,105)

	)

544 
	#GR_COLOR_GRAY42
 
	`MWRGB
(107,107,107)

	)

545 
	#GR_COLOR_GREY42
 
	`MWRGB
(107,107,107)

	)

546 
	#GR_COLOR_GRAY43
 
	`MWRGB
(110,110,110)

	)

547 
	#GR_COLOR_GREY43
 
	`MWRGB
(110,110,110)

	)

548 
	#GR_COLOR_GRAY44
 
	`MWRGB
(112,112,112)

	)

549 
	#GR_COLOR_GREY44
 
	`MWRGB
(112,112,112)

	)

550 
	#GR_COLOR_GRAY45
 
	`MWRGB
(115,115,115)

	)

551 
	#GR_COLOR_GREY45
 
	`MWRGB
(115,115,115)

	)

552 
	#GR_COLOR_GRAY46
 
	`MWRGB
(117,117,117)

	)

553 
	#GR_COLOR_GREY46
 
	`MWRGB
(117,117,117)

	)

554 
	#GR_COLOR_GRAY47
 
	`MWRGB
(120,120,120)

	)

555 
	#GR_COLOR_GREY47
 
	`MWRGB
(120,120,120)

	)

556 
	#GR_COLOR_GRAY48
 
	`MWRGB
(122,122,122)

	)

557 
	#GR_COLOR_GREY48
 
	`MWRGB
(122,122,122)

	)

558 
	#GR_COLOR_GRAY49
 
	`MWRGB
(125,125,125)

	)

559 
	#GR_COLOR_GREY49
 
	`MWRGB
(125,125,125)

	)

560 
	#GR_COLOR_GRAY50
 
	`MWRGB
(127,127,127)

	)

561 
	#GR_COLOR_GREY50
 
	`MWRGB
(127,127,127)

	)

562 
	#GR_COLOR_GRAY51
 
	`MWRGB
(130,130,130)

	)

563 
	#GR_COLOR_GREY51
 
	`MWRGB
(130,130,130)

	)

564 
	#GR_COLOR_GRAY52
 
	`MWRGB
(133,133,133)

	)

565 
	#GR_COLOR_GREY52
 
	`MWRGB
(133,133,133)

	)

566 
	#GR_COLOR_GRAY53
 
	`MWRGB
(135,135,135)

	)

567 
	#GR_COLOR_GREY53
 
	`MWRGB
(135,135,135)

	)

568 
	#GR_COLOR_GRAY54
 
	`MWRGB
(138,138,138)

	)

569 
	#GR_COLOR_GREY54
 
	`MWRGB
(138,138,138)

	)

570 
	#GR_COLOR_GRAY55
 
	`MWRGB
(140,140,140)

	)

571 
	#GR_COLOR_GREY55
 
	`MWRGB
(140,140,140)

	)

572 
	#GR_COLOR_GRAY56
 
	`MWRGB
(143,143,143)

	)

573 
	#GR_COLOR_GREY56
 
	`MWRGB
(143,143,143)

	)

574 
	#GR_COLOR_GRAY57
 
	`MWRGB
(145,145,145)

	)

575 
	#GR_COLOR_GREY57
 
	`MWRGB
(145,145,145)

	)

576 
	#GR_COLOR_GRAY58
 
	`MWRGB
(148,148,148)

	)

577 
	#GR_COLOR_GREY58
 
	`MWRGB
(148,148,148)

	)

578 
	#GR_COLOR_GRAY59
 
	`MWRGB
(150,150,150)

	)

579 
	#GR_COLOR_GREY59
 
	`MWRGB
(150,150,150)

	)

580 
	#GR_COLOR_GRAY60
 
	`MWRGB
(153,153,153)

	)

581 
	#GR_COLOR_GREY60
 
	`MWRGB
(153,153,153)

	)

582 
	#GR_COLOR_GRAY61
 
	`MWRGB
(156,156,156)

	)

583 
	#GR_COLOR_GREY61
 
	`MWRGB
(156,156,156)

	)

584 
	#GR_COLOR_GRAY62
 
	`MWRGB
(158,158,158)

	)

585 
	#GR_COLOR_GREY62
 
	`MWRGB
(158,158,158)

	)

586 
	#GR_COLOR_GRAY63
 
	`MWRGB
(161,161,161)

	)

587 
	#GR_COLOR_GREY63
 
	`MWRGB
(161,161,161)

	)

588 
	#GR_COLOR_GRAY64
 
	`MWRGB
(163,163,163)

	)

589 
	#GR_COLOR_GREY64
 
	`MWRGB
(163,163,163)

	)

590 
	#GR_COLOR_GRAY65
 
	`MWRGB
(166,166,166)

	)

591 
	#GR_COLOR_GREY65
 
	`MWRGB
(166,166,166)

	)

592 
	#GR_COLOR_GRAY66
 
	`MWRGB
(168,168,168)

	)

593 
	#GR_COLOR_GREY66
 
	`MWRGB
(168,168,168)

	)

594 
	#GR_COLOR_GRAY67
 
	`MWRGB
(171,171,171)

	)

595 
	#GR_COLOR_GREY67
 
	`MWRGB
(171,171,171)

	)

596 
	#GR_COLOR_GRAY68
 
	`MWRGB
(173,173,173)

	)

597 
	#GR_COLOR_GREY68
 
	`MWRGB
(173,173,173)

	)

598 
	#GR_COLOR_GRAY69
 
	`MWRGB
(176,176,176)

	)

599 
	#GR_COLOR_GREY69
 
	`MWRGB
(176,176,176)

	)

600 
	#GR_COLOR_GRAY70
 
	`MWRGB
(179,179,179)

	)

601 
	#GR_COLOR_GREY70
 
	`MWRGB
(179,179,179)

	)

602 
	#GR_COLOR_GRAY71
 
	`MWRGB
(181,181,181)

	)

603 
	#GR_COLOR_GREY71
 
	`MWRGB
(181,181,181)

	)

604 
	#GR_COLOR_GRAY72
 
	`MWRGB
(184,184,184)

	)

605 
	#GR_COLOR_GREY72
 
	`MWRGB
(184,184,184)

	)

606 
	#GR_COLOR_GRAY73
 
	`MWRGB
(186,186,186)

	)

607 
	#GR_COLOR_GREY73
 
	`MWRGB
(186,186,186)

	)

608 
	#GR_COLOR_GRAY74
 
	`MWRGB
(189,189,189)

	)

609 
	#GR_COLOR_GREY74
 
	`MWRGB
(189,189,189)

	)

610 
	#GR_COLOR_GRAY75
 
	`MWRGB
(191,191,191)

	)

611 
	#GR_COLOR_GREY75
 
	`MWRGB
(191,191,191)

	)

612 
	#GR_COLOR_GRAY76
 
	`MWRGB
(194,194,194)

	)

613 
	#GR_COLOR_GREY76
 
	`MWRGB
(194,194,194)

	)

614 
	#GR_COLOR_GRAY77
 
	`MWRGB
(196,196,196)

	)

615 
	#GR_COLOR_GREY77
 
	`MWRGB
(196,196,196)

	)

616 
	#GR_COLOR_GRAY78
 
	`MWRGB
(199,199,199)

	)

617 
	#GR_COLOR_GREY78
 
	`MWRGB
(199,199,199)

	)

618 
	#GR_COLOR_GRAY79
 
	`MWRGB
(201,201,201)

	)

619 
	#GR_COLOR_GREY79
 
	`MWRGB
(201,201,201)

	)

620 
	#GR_COLOR_GRAY80
 
	`MWRGB
(204,204,204)

	)

621 
	#GR_COLOR_GREY80
 
	`MWRGB
(204,204,204)

	)

622 
	#GR_COLOR_GRAY81
 
	`MWRGB
(207,207,207)

	)

623 
	#GR_COLOR_GREY81
 
	`MWRGB
(207,207,207)

	)

624 
	#GR_COLOR_GRAY82
 
	`MWRGB
(209,209,209)

	)

625 
	#GR_COLOR_GREY82
 
	`MWRGB
(209,209,209)

	)

626 
	#GR_COLOR_GRAY83
 
	`MWRGB
(212,212,212)

	)

627 
	#GR_COLOR_GREY83
 
	`MWRGB
(212,212,212)

	)

628 
	#GR_COLOR_GRAY84
 
	`MWRGB
(214,214,214)

	)

629 
	#GR_COLOR_GREY84
 
	`MWRGB
(214,214,214)

	)

630 
	#GR_COLOR_GRAY85
 
	`MWRGB
(217,217,217)

	)

631 
	#GR_COLOR_GREY85
 
	`MWRGB
(217,217,217)

	)

632 
	#GR_COLOR_GRAY86
 
	`MWRGB
(219,219,219)

	)

633 
	#GR_COLOR_GREY86
 
	`MWRGB
(219,219,219)

	)

634 
	#GR_COLOR_GRAY87
 
	`MWRGB
(222,222,222)

	)

635 
	#GR_COLOR_GREY87
 
	`MWRGB
(222,222,222)

	)

636 
	#GR_COLOR_GRAY88
 
	`MWRGB
(224,224,224)

	)

637 
	#GR_COLOR_GREY88
 
	`MWRGB
(224,224,224)

	)

638 
	#GR_COLOR_GRAY89
 
	`MWRGB
(227,227,227)

	)

639 
	#GR_COLOR_GREY89
 
	`MWRGB
(227,227,227)

	)

640 
	#GR_COLOR_GRAY90
 
	`MWRGB
(229,229,229)

	)

641 
	#GR_COLOR_GREY90
 
	`MWRGB
(229,229,229)

	)

642 
	#GR_COLOR_GRAY91
 
	`MWRGB
(232,232,232)

	)

643 
	#GR_COLOR_GREY91
 
	`MWRGB
(232,232,232)

	)

644 
	#GR_COLOR_GRAY92
 
	`MWRGB
(235,235,235)

	)

645 
	#GR_COLOR_GREY92
 
	`MWRGB
(235,235,235)

	)

646 
	#GR_COLOR_GRAY93
 
	`MWRGB
(237,237,237)

	)

647 
	#GR_COLOR_GREY93
 
	`MWRGB
(237,237,237)

	)

648 
	#GR_COLOR_GRAY94
 
	`MWRGB
(240,240,240)

	)

649 
	#GR_COLOR_GREY94
 
	`MWRGB
(240,240,240)

	)

650 
	#GR_COLOR_GRAY95
 
	`MWRGB
(242,242,242)

	)

651 
	#GR_COLOR_GREY95
 
	`MWRGB
(242,242,242)

	)

652 
	#GR_COLOR_GRAY96
 
	`MWRGB
(245,245,245)

	)

653 
	#GR_COLOR_GREY96
 
	`MWRGB
(245,245,245)

	)

654 
	#GR_COLOR_GRAY97
 
	`MWRGB
(247,247,247)

	)

655 
	#GR_COLOR_GREY97
 
	`MWRGB
(247,247,247)

	)

656 
	#GR_COLOR_GRAY98
 
	`MWRGB
(250,250,250)

	)

657 
	#GR_COLOR_GREY98
 
	`MWRGB
(250,250,250)

	)

658 
	#GR_COLOR_GRAY99
 
	`MWRGB
(252,252,252)

	)

659 
	#GR_COLOR_GREY99
 
	`MWRGB
(252,252,252)

	)

660 
	#GR_COLOR_GRAY100
 
	`MWRGB
(255,255,255)

	)

661 
	#GR_COLOR_GREY100
 
	`MWRGB
(255,255,255)

	)

662 
	#GR_COLOR_DARKGREY
 
	`MWRGB
(169,169,169)

	)

663 
	#GR_COLOR_DARKGRAY
 
	`MWRGB
(169,169,169)

	)

664 
	#GR_COLOR_DARKBLUE
 
	`MWRGB
(0,0,139)

	)

665 
	#GR_COLOR_DARKCYAN
 
	`MWRGB
(0,139,139)

	)

666 
	#GR_COLOR_DARKMAGENTA
 
	`MWRGB
(139,0,139)

	)

667 
	#GR_COLOR_DARKRED
 
	`MWRGB
(139,0,0)

	)

668 
	#GR_COLOR_LIGHTGREEN
 
	`MWRGB
(144,238,144)

	)

	@include/nxdraw.h

11 
nxPaötNCAªa
(
GR_DRAW_ID
 
id
, 
w
, 
h
, 
GR_CHAR
 *
tôÀ
,

12 
GR_BOOL
 
a˘ive
, 
GR_WM_PROPS
 
¥›s
);

14 
nxInÊ©eRe˘
(
GR_RECT
 *
¥c
, 
GR_SIZE
 
dx
, GR_SIZE 
dy
);

15 
nxDøw3dBox
(
GR_WINDOW_ID
 
id
,
x
,
y
,
w
,
h
,

16 
GR_COLOR
 
¸T›
,GR_COLOR 
¸BŸtom
);

17 
nxDøw3dIn£t
(
GR_DRAW_ID
 
id
,
x
,
y
,
w
,
h
);

18 
nxDøw3dOut£t
(
GR_WINDOW_ID
 
id
,
x
,
y
,
w
,
h
);

19 
nxDøw3dPushDown
(
GR_DRAW_ID
 
id
, 
x
, 
y
, 
w
, 
h
);

20 
nxDøw3dUpDownSèã
(
GR_DRAW_ID
 
id
, 
x
, 
y
, 
w
, 
h
,

21 
GR_BOOL
 
fDown
);

22 
nxDøw3dUpFøme
(
GR_DRAW_ID
 
id
, 
l
, 
t
, 
r
, 
b
);

23 
nxDøw3dShadow
(
GR_DRAW_ID
 
id
, 
x
, 
y
, 
w
, 
h
, 
GR_COLOR
 
¸T›
, GR_COLOR 
¸BŸtom
);

26 
	#CXBORDER
 3

	)

27 
	#CYBORDER
 3

	)

28 
	#CYCAPTION
 12

	)

29 
	#CXCLOSEBOX
 9

	)

30 
	#CYCLOSEBOX
 9

	)

31 
	#CXFRAME
 (
CXBORDER
*2Ë

	)

32 
	#CYFRAME
 (
CYBORDER
*2Ë

	)

	@include/swap.h

15 #i‚de‡
MW_SWAP_H_INCLUDED


16 
	#MW_SWAP_H_INCLUDED


	)

22 #i‡!
MW_CPU_BIG_ENDIAN


25 
	#wsw≠
(
x
Ë(x)

	)

26 
	#dwsw≠
(
x
Ë(x)

	)

30 
	#wsw≠
(
x
Ë((((xË<< 8Ë& 0xff00Ë| (((xË>> 8Ë& 0x00ff))

	)

32 
	#dwsw≠
(
x
) ((((x) << 24) & 0xff000000L) | \

33 (((
x
) << 8) & 0x00ff0000L) | \

34 (((
x
) >> 8) & 0x0000ff00L) | \

35 (((
x
Ë>> 24Ë& 0x000000ffLË)

	)

42 
	#dwªad
(
addr
) ((((*)(addr))[0] | \

43 (((*)(
addr
))[1] << 8) | \

44 (((*)(
addr
))[2] << 16) | \

45 (((*)(
addr
))[3] << 24)))

	)

55 #ifde‡
löux


57 
	~<ídün.h
>

58 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


59 #i‡!
MW_CPU_BIG_ENDIAN


60 #îr‹ 
MW_CPU_BIG_ENDIAN
 
™d
 
your
 
OS
 
dißgªe
 
about
 you∏
CPUs
 
byã
-
‹dî
. 
Did
 
you
 
f‹gë
 
to
 
£t
 
BIGENDIAN
 
ö
 
the
 
c⁄fig
 
fûe
?

62 #unde‡
wsw≠


63 #unde‡
dwsw≠


64 
	~<byãsw≠.h
>

65 
	#wsw≠
(
x
Ë
	`bsw≠_16
(x)

	)

66 
	#dwsw≠
(
x
Ë
	`bsw≠_32
(x)

	)

68 #i‡
MW_CPU_BIG_ENDIAN


69 #îr‹ 
MW_CPU_BIG_ENDIAN
 
™d
 
your
 
OS
 
dißgªe
 
about
 you∏
CPUs
 
byã
-
‹dî
. 
Did
 
you
 
accidíèŒy
 
£t
 
BIGENDIAN
 
ö
 
the
 
c⁄fig
 
fûe
?

76 #ñi‡
deföed
(
__FªeBSD__
)

78 
	~<machöe/ídün.h
>

79 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


80 #i‡!
MW_CPU_BIG_ENDIAN


81 #îr‹ 
MW_CPU_BIG_ENDIAN
 
™d
 
your
 
OS
 
dißgªe
 
about
 you∏
CPUs
 
byã
-
‹dî
. 
Did
 
you
 
f‹gë
 
to
 
£t
 
BIGENDIAN
 
ö
 
the
 
c⁄fig
 
fûe
?

83 #i‚de‡
__byã_sw≠_w‹d


85 #w¨nög 
__byã_sw≠_w‹d
 
nŸ
 
deföed
 
ö
 
ídün
.
h
 
⁄
 
FªeBSD
.

87 #unde‡
wsw≠


88 #unde‡
dwsw≠


89 
	#wsw≠
(
x
Ë
	`__byã_sw≠_w‹d
(x)

	)

90 
	#dwsw≠
(
x
Ë
	`__byã_sw≠_l⁄g
(x)

	)

93 #i‡
MW_CPU_BIG_ENDIAN


94 #îr‹ 
MW_CPU_BIG_ENDIAN
 
™d
 
your
 
OS
 
dißgªe
 
about
 you∏
CPUs
 
byã
-
‹dî
. 
Did
 
you
 
accidíèŒy
 
£t
 
BIGENDIAN
 
ö
 
the
 
c⁄fig
 
fûe
?

101 #ñi‡
__ECOS


103 #unde‡
wsw≠


104 #unde‡
dwsw≠


105 
	~<machöe/ídün.h
>

106 
	#wsw≠
(
x
Ë
	`Àtoh16
(x)

	)

107 
	#dwsw≠
(
x
Ë
	`Àtoh32
(x)

	)

113 #ñi‡
deföed
(
__CYGWIN__
)

116 #i‡
MW_CPU_BIG_ENDIAN


117 #îr‹ 
MW_CPU_BIG_ENDIAN
 
™d
 
your
 
OS
 
dißgªe
 
about
 you∏
CPUs
 
byã
-
‹dî
. 
Did
 
you
 
accidíèŒy
 
£t
 
BIGENDIAN
 
ö
 
the
 
c⁄fig
 
fûe
?

121 #unde‡
dwªad


122 
	#dwªad
(
addr
Ë(*(*)◊ddr))

	)

128 #ñi‡
deföed
(
TRIMEDIA
)

142 #w¨nög 
You
 
might
 
w™t
 
to
 
deföe
 
›timized
 
byã
 
sw≠pög
 
ma¸os
 
this
 
machöe
 - 
nŸ
, 
you
 
ˇn
 
ß„ly
 
ign‹e
Åhi†
w¨nög
.

	@include/winctl.h

8 
WINAPI
 
MwRegi°îBuâ⁄C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

9 
WINAPI
 
MwRegi°îLi°boxC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

10 
WINAPI
 
MwRegi°îEdôC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

11 
WINAPI
 
MwRegi°îSèticC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

12 
WINAPI
 
MwRegi°îProgªssB¨C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

13 
WINAPI
 
MwRegi°îComboboxC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

14 
WINAPI
 
MwRegi°îS¸ﬁlb¨C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

15 
WINAPI
 
MwRegi°îMEdôC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
);

18 
WINAPI
 
CheckRadioBuâ⁄
(
HWND
 
hDlg
, 
nIDFú°
,
nIDLa°
,

19 
nIDCheckBuâ⁄
);

22 
	#DLGC_WANTARROWS
 0x0001

	)

23 
	#DLGC_WANTTAB
 0x0002

	)

24 
	#DLGC_WANTALLKEYS
 0x0004

	)

25 
	#DLGC_WANTMESSAGE
 0x0004

	)

26 
	#DLGC_HASSETSEL
 0x0008

	)

27 
	#DLGC_DEFPUSHBUTTON
 0x0010

	)

28 
	#DLGC_UNDEFPUSHBUTTON
 0x0020

	)

29 
	#DLGC_RADIOBUTTON
 0x0040

	)

30 
	#DLGC_WANTCHARS
 0x0080

	)

31 
	#DLGC_STATIC
 0x0100

	)

32 
	#DLGC_BUTTON
 0x2000

	)

35 
	#BS_PUSHBUTTON
 0x00000000L

	)

36 
	#BS_DEFPUSHBUTTON
 0x00000001L

	)

37 
	#BS_CHECKBOX
 0x00000002L

	)

38 
	#BS_AUTOCHECKBOX
 0x00000003L

	)

39 
	#BS_RADIOBUTTON
 0x00000004L

	)

40 
	#BS_3STATE
 0x00000005L

	)

41 
	#BS_AUTO3STATE
 0x00000006L

	)

42 
	#BS_GROUPBOX
 0x00000007L

	)

43 
	#BS_USERBUTTON
 0x00000008L

	)

44 
	#BS_AUTORADIOBUTTON
 0x00000009L

	)

45 
	#BS_OWNERDRAW
 0x0000000BL

	)

46 
	#BS_LEFTTEXT
 0x00000020L

	)

47 
	#BS_TEXT
 0x00000000L

	)

48 
	#BS_ICON
 0x00000040L

	)

49 
	#BS_BITMAP
 0x00000080L

	)

50 
	#BS_LEFT
 0x00000100L

	)

51 
	#BS_RIGHT
 0x00000200L

	)

52 
	#BS_CENTER
 0x00000300L

	)

53 
	#BS_TOP
 0x00000400L

	)

54 
	#BS_BOTTOM
 0x00000800L

	)

55 
	#BS_VCENTER
 0x00000C00L

	)

56 
	#BS_PUSHLIKE
 0x00001000L

	)

57 
	#BS_MULTILINE
 0x00002000L

	)

58 
	#BS_NOTIFY
 0x00004000L

	)

59 
	#BS_FLAT
 0x00008000L

	)

60 
	#BS_RIGHTBUTTON
 
BS_LEFTTEXT


	)

63 
	#BN_CLICKED
 0

	)

64 
	#BN_PAINT
 1

	)

65 
	#BN_HILITE
 2

	)

66 
	#BN_UNHILITE
 3

	)

67 
	#BN_DISABLE
 4

	)

68 
	#BN_DOUBLECLICKED
 5

	)

69 
	#BN_PUSHED
 
BN_HILITE


	)

70 
	#BN_UNPUSHED
 
BN_UNHILITE


	)

71 
	#BN_DBLCLK
 
BN_DOUBLECLICKED


	)

72 
	#BN_SETFOCUS
 6

	)

73 
	#BN_KILLFOCUS
 7

	)

76 
	#BM_GETCHECK
 0x00F0

	)

77 
	#BM_SETCHECK
 0x00F1

	)

78 
	#BM_GETSTATE
 0x00F2

	)

79 
	#BM_SETSTATE
 0x00F3

	)

80 
	#BM_SETSTYLE
 0x00F4

	)

81 
	#BM_CLICK
 0x00F5

	)

82 
	#BM_GETIMAGE
 0x00F6

	)

83 
	#BM_SETIMAGE
 0x00F7

	)

85 
	#BST_UNCHECKED
 0x0000

	)

86 
	#BST_CHECKED
 0x0001

	)

87 
	#BST_INDETERMINATE
 0x0002

	)

88 
	#BST_PUSHED
 0x0004

	)

89 
	#BST_FOCUS
 0x0008

	)

92 
	#PBM_SETRANGE
 0xF0A0

	)

93 
	#PBM_SETSTEP
 0xF0A1

	)

94 
	#PBM_SETPOS
 0xF0A2

	)

95 
	#PBM_DELTAPOS
 0xF0A3

	)

96 
	#PBM_STEPIT
 0xF0A4

	)

99 
	#PBS_NOTIFY
 0x0001L

	)

100 
	#PBS_VERTICAL
 0x0002L

	)

103 
	#PBN_REACHMAX
 1

	)

104 
	#PBN_REACHMIN
 2

	)

107 
	#LB_ADDSTRING
 0xF180

	)

108 
	#LB_INSERTSTRING
 0xF181

	)

109 
	#LB_DELETESTRING
 0xF182

	)

110 
	#LB_SELITEMRANGEEX
 0xF183

	)

111 
	#LB_RESETCONTENT
 0xF184

	)

112 
	#LB_SETSEL
 0xF185

	)

113 
	#LB_SETCURSEL
 0xF186

	)

114 
	#LB_GETSEL
 0xF187

	)

115 
	#LB_GETCURSEL
 0xF188

	)

116 
	#LB_GETTEXT
 0xF189

	)

117 
	#LB_GETTEXTLEN
 0xF18A

	)

118 
	#LB_GETCOUNT
 0xF18B

	)

119 
	#LB_SELECTSTRING
 0xF18C

	)

120 
	#LB_DIR
 0xF18D

	)

121 
	#LB_GETTOPINDEX
 0xF18E

	)

122 
	#LB_FINDSTRING
 0xF18F

	)

123 
	#LB_GETSELCOUNT
 0xF190

	)

124 
	#LB_GETSELITEMS
 0xF191

	)

125 
	#LB_SETTABSTOPS
 0xF192

	)

126 
	#LB_GETHORIZONTALEXTENT
 0xF193

	)

127 
	#LB_SETHORIZONTALEXTENT
 0xF194

	)

128 
	#LB_SETCOLUMNWIDTH
 0xF195

	)

129 
	#LB_ADDFILE
 0xF196

	)

130 
	#LB_SETTOPINDEX
 0xF197

	)

131 
	#LB_GETITEMRECT
 0xF198

	)

132 
	#LB_GETITEMDATA
 0xF199

	)

133 
	#LB_SETITEMDATA
 0xF19A

	)

134 
	#LB_SELITEMRANGE
 0xF19B

	)

135 
	#LB_SETANCHORINDEX
 0xF19C

	)

136 
	#LB_GETANCHORINDEX
 0xF19D

	)

137 
	#LB_SETCARETINDEX
 0xF19E

	)

138 
	#LB_GETCARETINDEX
 0xF19F

	)

139 
	#LB_SETITEMHEIGHT
 0xF1A0

	)

140 
	#LB_GETITEMHEIGHT
 0xF1A1

	)

141 
	#LB_FINDSTRINGEXACT
 0xF1A2

	)

142 
	#LB_SETLOCALE
 0xF1A5

	)

143 
	#LB_GETLOCALE
 0xF1A6

	)

144 
	#LB_SETCOUNT
 0xF1A7

	)

145 
	#LB_INITSTORAGE
 0xF1A8

	)

146 
	#LB_ITEMFROMPOINT
 0xF1A9

	)

147 
	#LB_SETTEXT
 0xF1AA

	)

148 
	#LB_GETCHECKMARK
 0xF1AB

	)

149 
	#LB_SETCHECKMARK
 0xF1AC

	)

150 
	#LB_GETITEMADDDATA
 0xF1AD

	)

151 
	#LB_SETITEMADDDATA
 0xF1AE

	)

152 
	#LB_MSGMAX
 0xF1B0

	)

155 
	#LBS_NOTIFY
 0x0001L

	)

156 
	#LBS_SORT
 0x0002L

	)

157 
	#LBS_NOREDRAW
 0x0004L

	)

158 
	#LBS_MULTIPLESEL
 0x0008L

	)

159 
	#LBS_OWNERDRAWFIXED
 0x0010L

	)

160 
	#LBS_OWNERDRAWVARIABLE
 0x0020L

	)

161 
	#LBS_HASSTRINGS
 0x0040L

	)

162 
	#LBS_USETABSTOPS
 0x0080L

	)

163 
	#LBS_NOINTEGRALHEIGHT
 0x0100L

	)

164 
	#LBS_MULTICOLUMN
 0x0200L

	)

165 
	#LBS_WANTKEYBOARDINPUT
 0x0400L

	)

166 
	#LBS_EXTENDEDSEL
 0x0800L

	)

167 
	#LBS_STANDARD
 (
LBS_NOTIFY
 | 
LBS_SORT
 | 
WS_VSCROLL
 | 
WS_BORDER
)

	)

168 
	#LBS_CHECKBOX
 0x1000L

	)

169 
	#LBS_USEICON
 0x2000L

	)

170 
	#LBS_AUTOCHECK
 0x4000L

	)

171 
	#LBS_AUTOCHECKBOX
 0x5000L

	)

173 
	#LBS_PRELOADED
 0x4000L

	)

174 
	#LBS_COMBOLBOX
 0x8000L

	)

177 
	#LBS_DISABLENOSCROLL
 0x1000L

	)

178 
	#LBS_NODATA
 0x2000L

	)

179 
	#LBS_NOSEL
 0x4000L

	)

183 
	#LBN_ERRSPACE
 (-2)

	)

184 
	#LBN_SELCHANGE
 1

	)

185 
	#LBN_DBLCLK
 2

	)

186 
	#LBN_SELCANCEL
 3

	)

187 
	#LBN_SETFOCUS
 4

	)

188 
	#LBN_KILLFOCUS
 5

	)

189 
	#LBN_CLICKCHECKMARK
 6

	)

192 
	#LB_OKAY
 0

	)

193 
	#LB_ERR
 (-1)

	)

194 
	#LB_ERRSPACE
 (-2)

	)

197 
	#EN_SETFOCUS
 0x0100

	)

198 
	#EN_KILLFOCUS
 0x0200

	)

199 
	#EN_CHANGE
 0x0300

	)

200 
	#EN_UPDATE
 0x0400

	)

201 
	#EN_ERRSPACE
 0x0500

	)

202 
	#EN_MAXTEXT
 0x0501

	)

203 
	#EN_HSCROLL
 0x0601

	)

204 
	#EN_VSCROLL
 0x0602

	)

207 
	#ES_LEFT
 0x0000L

	)

208 
	#ES_CENTER
 0x0001L

	)

209 
	#ES_RIGHT
 0x0002L

	)

210 
	#ES_MULTILINE
 0x0004L

	)

211 
	#ES_UPPERCASE
 0x0008L

	)

212 
	#ES_LOWERCASE
 0x0010L

	)

213 
	#ES_PASSWORD
 0x0020L

	)

214 
	#ES_AUTOVSCROLL
 0x0040L

	)

215 
	#ES_AUTOHSCROLL
 0x0080L

	)

216 
	#ES_NOHIDESEL
 0x0100L

	)

217 
	#ES_OEMCONVERT
 0x0400L

	)

218 
	#ES_READONLY
 0x0800L

	)

219 
	#ES_WANTRETURN
 0x1000L

	)

220 
	#ES_NUMBER
 0x2000L

	)

223 
	#EM_GETSEL
 0xF0B0

	)

224 
	#EM_SETSEL
 0xF0B1

	)

225 
	#EM_GETRECT
 0xF0B2

	)

226 
	#EM_SETRECT
 0xF0B3

	)

227 
	#EM_SETRECTNP
 0xF0B4

	)

228 
	#EM_SCROLL
 0xF0B5

	)

229 
	#EM_LINESCROLL
 0xF0B6

	)

230 
	#EM_SCROLLCARET
 0xF0B7

	)

231 
	#EM_GETMODIFY
 0xF0B8

	)

232 
	#EM_SETMODIFY
 0xF0B9

	)

233 
	#EM_GETLINECOUNT
 0xF0BA

	)

234 
	#EM_LINEINDEX
 0xF0BB

	)

235 
	#EM_SETHANDLE
 0xF0BC

	)

236 
	#EM_GETHANDLE
 0xF0BD

	)

237 
	#EM_GETTHUMB
 0xF0BE

	)

238 
	#EM_LINELENGTH
 0xF0C1

	)

239 
	#EM_REPLACESEL
 0xF0C2

	)

240 
	#EM_GETLINE
 0xF0C4

	)

241 
	#EM_LIMITTEXT
 0xF0C5

	)

242 
	#EM_CANUNDO
 0xF0C6

	)

243 
	#EM_UNDO
 0xF0C7

	)

244 
	#EM_FMTLINES
 0xF0C8

	)

245 
	#EM_LINEFROMCHAR
 0xF0C9

	)

246 
	#EM_SETTABSTOPS
 0xF0CB

	)

247 
	#EM_SETPASSWORDCHAR
 0xF0CC

	)

248 
	#EM_EMPTYUNDOBUFFER
 0xF0CD

	)

249 
	#EM_GETFIRSTVISIBLELINE
 0xF0CE

	)

250 
	#EM_SETREADONLY
 0xF0CF

	)

251 
	#EM_SETWORDBREAKPROC
 0xF0D0

	)

252 
	#EM_GETWORDBREAKPROC
 0xF0D1

	)

253 
	#EM_GETPASSWORDCHAR
 0xF0D2

	)

254 
	#EM_SETMARGINS
 0xF0D3

	)

255 
	#EM_GETMARGINS
 0xF0D4

	)

256 
	#EM_SETLIMITTEXT
 
EM_LIMITTEXT


	)

257 
	#EM_GETLIMITTEXT
 0xF0D5

	)

258 
	#EM_POSFROMCHAR
 0xF0D6

	)

259 
	#EM_CHARFROMPOS
 0xF0D7

	)

260 
	#EM_SETIMESTATUS
 0xF0D8

	)

261 
	#EM_GETIMESTATUS
 0xF0D9

	)

264 
	#STM_SETICON
 0xF170

	)

265 
	#STM_GETICON
 0xF171

	)

266 
	#STM_SETIMAGE
 0xF172

	)

267 
	#STM_GETIMAGE
 0xF173

	)

268 
	#STM_MSGMAX
 0xF174

	)

271 
	#STN_CLICKED
 0

	)

272 
	#STN_DBLCLK
 1

	)

273 
	#STN_ENABLE
 2

	)

274 
	#STN_DISABLE
 3

	)

277 
	#SS_LEFT
 0x00000000L

	)

278 
	#SS_CENTER
 0x00000001L

	)

279 
	#SS_RIGHT
 0x00000002L

	)

280 
	#SS_ICON
 0x00000003L

	)

281 
	#SS_BLACKRECT
 0x00000004L

	)

282 
	#SS_GRAYRECT
 0x00000005L

	)

283 
	#SS_WHITERECT
 0x00000006L

	)

284 
	#SS_BLACKFRAME
 0x00000007L

	)

285 
	#SS_GRAYFRAME
 0x00000008L

	)

286 
	#SS_WHITEFRAME
 0x00000009L

	)

287 
	#SS_GROUPBOX
 0x0000000AL

	)

288 
	#SS_SIMPLE
 0x0000000BL

	)

289 
	#SS_LEFTNOWORDWRAP
 0x0000000CL

	)

290 
	#SS_OWNERDRAW
 0x0000000DL

	)

291 
	#SS_BITMAP
 0x0000000EL

	)

292 
	#SS_ENHMETAFILE
 0x0000000FL

	)

293 
	#SS_TYPEMASK
 0x0000000FL

	)

294 
	#SS_NOPREFIX
 0x00000080L

	)

295 
	#SS_ETCHEDHORZ
 0x00000010L

	)

296 
	#SS_ETCHEDVERT
 0x00000011L

	)

297 
	#SS_ETCHEDFRAME
 0x00000012L

	)

298 
	#SS_ETCTYPEMAKS
 0x0000001FL

	)

299 
	#SS_NOTIFY
 0x00000100L

	)

300 
	#SS_CENTERIMAGE
 0x00000200L

	)

301 
	#SS_RIGHTJUST
 0x00000400L

	)

302 
	#SS_REALSIZEIMAGE
 0x00000800L

	)

303 
	#SS_SUNKEN
 0x00001000L

	)

304 
	#SS_ENDELLIPSIS
 0x00004000L

	)

305 
	#SS_PATHELLIPSIS
 0x00008000L

	)

306 
	#SS_WORDELLIPSIS
 0x0000C000L

	)

307 
	#SS_ELLIPSISMASK
 0x0000C000L

	)

310 
	#CBS_SIMPLE
 0x0001L

	)

311 
	#CBS_DROPDOWN
 0x0002L

	)

312 
	#CBS_DROPDOWNLIST
 0x0003L

	)

313 
	#CBS_OWNERDRAWFIXED
 0x0010L

	)

314 
	#CBS_OWNERDRAWVARIABLE
 0x0020L

	)

315 
	#CBS_AUTOHSCROLL
 0x0040L

	)

316 
	#CBS_OEMCONVERT
 0x0080L

	)

317 
	#CBS_SORT
 0x0100L

	)

318 
	#CBS_HASSTRINGS
 0x0200L

	)

319 
	#CBS_NOINTEGRALHEIGHT
 0x0400L

	)

320 
	#CBS_DISABLENOSCROLL
 0x0800L

	)

321 
	#CBS_UPPERCASE
 0x2000L

	)

322 
	#CBS_LOWERCASE
 0x4000L

	)

325 
	#CB_GETEDITSEL
 0xF140

	)

326 
	#CB_LIMITTEXT
 0xF141

	)

327 
	#CB_SETEDITSEL
 0xF142

	)

328 
	#CB_ADDSTRING
 0xF143

	)

329 
	#CB_DELETESTRING
 0xF144

	)

330 
	#CB_DIR
 0xF145

	)

331 
	#CB_GETCOUNT
 0xF146

	)

332 
	#CB_GETCURSEL
 0xF147

	)

333 
	#CB_GETLBTEXT
 0xF148

	)

334 
	#CB_GETLBTEXTLEN
 0xF149

	)

335 
	#CB_INSERTSTRING
 0xF14A

	)

336 
	#CB_RESETCONTENT
 0xF14B

	)

337 
	#CB_FINDSTRING
 0xF14C

	)

338 
	#CB_SELECTSTRING
 0xF14D

	)

339 
	#CB_SETCURSEL
 0xF14E

	)

340 
	#CB_SHOWDROPDOWN
 0xF14F

	)

341 
	#CB_GETITEMDATA
 0xF150

	)

342 
	#CB_SETITEMDATA
 0xF151

	)

343 
	#CB_GETDROPPEDCONTROLRECT
 0xF152

	)

344 
	#CB_SETITEMHEIGHT
 0xF153

	)

345 
	#CB_GETITEMHEIGHT
 0xF154

	)

346 
	#CB_SETEXTENDEDUI
 0xF155

	)

347 
	#CB_GETEXTENDEDUI
 0xF156

	)

348 
	#CB_GETDROPPEDSTATE
 0xF157

	)

349 
	#CB_FINDSTRINGEXACT
 0xF158

	)

350 
	#CB_SETLOCALE
 0xF159

	)

351 
	#CB_GETLOCALE
 0xF15A

	)

352 
	#CB_GETTOPINDEX
 0xF15b

	)

353 
	#CB_SETTOPINDEX
 0xF15¯

	)

354 
	#CB_GETHORIZONTALEXTENT
 0xF15d

	)

355 
	#CB_SETHORIZONTALEXTENT
 0xF15ê

	)

356 
	#CB_GETDROPPEDWIDTH
 0xF15‡

	)

357 
	#CB_SETDROPPEDWIDTH
 0xF160

	)

358 
	#CB_INITSTORAGE
 0xF161

	)

359 
	#CB_MSGMAX
 0xF162

	)

362 
	#CBN_ERRSPACE
 (-1)

	)

363 
	#CBN_SELCHANGE
 1

	)

364 
	#CBN_DBLCLK
 2

	)

365 
	#CBN_SETFOCUS
 3

	)

366 
	#CBN_KILLFOCUS
 4

	)

367 
	#CBN_EDITCHANGE
 5

	)

368 
	#CBN_EDITUPDATE
 6

	)

369 
	#CBN_DROPDOWN
 7

	)

370 
	#CBN_CLOSEUP
 8

	)

371 
	#CBN_SELENDOK
 9

	)

372 
	#CBN_SELENDCANCEL
 10

	)

375 
	#CB_OKAY
 0

	)

376 
	#CB_ERR
 (-1)

	)

377 
	#CB_ERRSPACE
 (-2)

	)

380 
	#SBS_HORZ
 0x0000L

	)

381 
	#SBS_VERT
 0x0001L

	)

382 
	#SBS_TYPEMASK
 0x0001L

	)

383 
	#SBS_TOPALIGN
 0x0002L

	)

384 
	#SBS_LEFTALIGN
 0x0002L

	)

385 
	#SBS_BOTTOMALIGN
 0x0004L

	)

386 
	#SBS_RIGHTALIGN
 0x0004L

	)

387 
	#SBS_SIZEBOXTOPLEFTALIGN
 0x0002L

	)

388 
	#SBS_SIZEBOXBOTTOMRIGHTALIGN
 0x0004L

	)

389 
	#SBS_SIZEBOX
 0x0008L

	)

390 
	#SBS_SIZEGRIP
 0x0010L

	)

393 
	#SB_HORZ
 0

	)

394 
	#SB_VERT
 1

	)

395 
	#SB_CTL
 2

	)

396 
	#SB_BOTH
 3

	)

399 
	#SB_LINEUP
 0

	)

400 
	#SB_LINELEFT
 0

	)

401 
	#SB_LINEDOWN
 1

	)

402 
	#SB_LINERIGHT
 1

	)

403 
	#SB_PAGEUP
 2

	)

404 
	#SB_PAGELEFT
 2

	)

405 
	#SB_PAGEDOWN
 3

	)

406 
	#SB_PAGERIGHT
 3

	)

407 
	#SB_THUMBPOSITION
 4

	)

408 
	#SB_THUMBTRACK
 5

	)

409 
	#SB_TOP
 6

	)

410 
	#SB_LEFT
 6

	)

411 
	#SB_BOTTOM
 7

	)

412 
	#SB_RIGHT
 7

	)

413 
	#SB_ENDSCROLL
 8

	)

415 
	#SIF_RANGE
 0x0001

	)

416 
	#SIF_PAGE
 0x0002

	)

417 
	#SIF_POS
 0x0004

	)

418 
	#SIF_DISABLENOSCROLL
 0x0008

	)

419 
	#SIF_TRACKPOS
 0x0010

	)

420 
	#SIF_ALL
 (
SIF_RANGE
 | 
SIF_PAGE
 | 
SIF_POS
 | 
SIF_TRACKPOS
)

	)

422 
	sègSCROLLINFO
 {

423 
UINT
 
	mcbSize
;

424 
UINT
 
	mfMask
;

425 
	mnMö
;

426 
	mnMax
;

427 
UINT
 
	mnPage
;

428 
	mnPos
;

429 
	mnTøckPos
;

430 } 
	tSCROLLINFO
, *
	tLPSCROLLINFO
;

431 
SCROLLINFO
 
	tCONST
 *
	tLPCSCROLLINFO
;

433 
WINAPI
 
SëS¸ﬁlInfo
(
HWND
, , 
LPCSCROLLINFO
, 
BOOL
);

434 
BOOL
 
WINAPI
 
GëS¸ﬁlInfo
(
HWND
, , 
LPSCROLLINFO
);

	@include/windef.h

8 
	#_WINDEF_H


	)

11 #ifde‡
VXWORKS


14 
	#__INC¡c⁄ãxth


	)

17 
	~<vxW‹ks.h
>

21 #i‚de‡
NULL


22 
	#NULL
 ((*)0)

	)

25 #i‚de‡
FALSE


26 
	#FALSE
 0

	)

29 #i‚de‡
TRUE


30 
	#TRUE
 1

	)

33 #i‚de‡
NOMINMAX


34 #i‚de‡
max


35 
	#max
(
a
,
b
Ë((◊Ë> (b)Ë? (aË: (b))

	)

38 #i‚de‡
mö


39 
	#mö
(
a
,
b
Ë((◊Ë< (b)Ë? (aË: (b))

	)

43 
	#CALLBACK


	)

44 
	#WINAPI


	)

45 
	#WINAPIV


	)

46 
	#APIENTRY
 
WINAPI


	)

47 
	#APIPRIVATE


	)

48 
	#PASCAL


	)

50 
	#FAR


	)

51 
	#NEAR


	)

52 
	#CONST
 c⁄°

	)

53 
	#CDECL


	)

55 
	#VOID
 

	)

56 *
	tPVOID
;

57 
	tCHAR
;

58 
	tSHORT
;

59 
	tLONG
;

60 
SHORT
 *
	tPSHORT
;

61 
LONG
 *
	tPLONG
;

63 #i‚de‡
VXWORKS


64 
	tUCHAR
;

65 
	tUSHORT
;

66 
	tULONG
;

67 #i‚de‡
__ITRON_TYPES_h_


68 
	tUINT
;

71 #i‚de‡
__ITRON_TYPES_h_


72 #i‚de‡
COMMON_H


73 
	tBOOL
;

79 
ULONG
 * 
	tPULONG
;

80 
USHORT
 * 
	tPUSHORT
;

81 
UCHAR
 * 
	tPUCHAR
;

82 * 
	tPSZ
;

83 #i‚de‡
__ITRON_TYPES_h_


84 
	tINT
;

86 *
	tPUINT
;

88 
	tDWORD
;

89 
	tBYTE
;

90 
	tWORD
;

92 
	tFLOAT
;

93 
FLOAT
 *
	tPFLOAT
;

94 
BOOL
 
	tNEAR
 *
	tPBOOL
;

95 
BOOL
 
	tFAR
 *
	tLPBOOL
;

96 
BYTE
 
	tNEAR
 *
	tPBYTE
;

97 
BYTE
 
	tFAR
 *
	tLPBYTE
;

98 
	tNEAR
 *
	tPINT
;

99 
	tFAR
 *
	tLPINT
;

100 
WORD
 
	tNEAR
 *
	tPWORD
;

101 
WORD
 
	tFAR
 *
	tLPWORD
;

102 
	tFAR
 *
	tLPLONG
;

103 
DWORD
 
	tNEAR
 *
	tPDWORD
;

104 
DWORD
 
	tFAR
 *
	tLPDWORD
;

105 
	tFAR
 *
	tLPVOID
;

106 
CONST
 
	tFAR
 *
	tLPCVOID
;

108 
	tWCHAR
;

109 
WCHAR
 *
	tPWCHAR
;

110 
WCHAR
 *
	tLPWCH
, *
	tPWCH
;

111 
CONST
 
	tWCHAR
 *
	tLPCWCH
, *
	tPCWCH
;

112 
WCHAR
 *
	tNWPSTR
;

113 
WCHAR
 *
	tLPWSTR
, *
	tPWSTR
;

114 
CONST
 
	tWCHAR
 *
	tLPCWSTR
, *
	tPCWSTR
;

116 
CHAR
 *
	tPCHAR
;

117 
CHAR
 *
	tLPCH
, *
	tPCH
;

118 
CONST
 
	tCHAR
 *
	tLPCCH
, *
	tPCCH
;

119 
CHAR
 *
	tNPSTR
;

120 
CHAR
 *
	tLPSTR
, *
	tPSTR
;

121 
CONST
 
	tCHAR
 *
	tLPCSTR
, *
	tPCSTR
;

122 
	tTCHAR
, *
	tPTCHAR
;

123 
	tTBYTE
 , *
	tPTBYTE
 ;

124 
LPSTR
 
	tLPTCH
, 
	tPTCH
;

125 
LPSTR
 
	tPTSTR
, 
	tLPTSTR
;

126 
LPCSTR
 
	tLPCTSTR
;

128 
	#__TEXT
(
quŸe
Ë
	)
quote

129 
	#TEXT
(
quŸe
Ë
	`__TEXT
(quŸe)

	)

131 (
FAR
 
	tWINAPI
 *
	tFARPROC
)();

132 (
NEAR
 
	tWINAPI
 *
	tNEARPROC
)();

133 (
WINAPI
 *
	tPROC
)();

135 
UINT
 
	tWPARAM
;

136 
LONG
 
	tLPARAM
;

137 
LONG
 
	tLRESULT
;

138 
LONG
 
	tHRESULT
;

140 
	#MAKEWORD
(
a
, 
b
Ë((
WORD
)(((
BYTE
)◊)Ë| ((WORD)((BYTE)(b))Ë<< 8))

	)

141 
	#MAKELONG
(
a
, 
b
Ë((
LONG
)(((
WORD
)◊)Ë| ((
DWORD
)((WORD)(b))Ë<< 16))

	)

142 
	#LOWORD
(
l
Ë((
WORD
)÷))

	)

143 
	#HIWORD
(
l
Ë((
WORD
)(((
DWORD
)÷Ë>> 16Ë& 0xFFFF))

	)

144 
	#LOBYTE
(
w
Ë((
BYTE
)(w))

	)

145 
	#HIBYTE
(
w
Ë((
BYTE
)(((
WORD
)(wË>> 8Ë& 0xFF))

	)

147 
	#PALETTEINDEX
(
i
Ë((
COLORREF
)(0x01000000 | (
DWORD
)(
WORD
)(i)))

	)

149 
DWORD
 
	tCOLORREF
;

150 
DWORD
 *
	tLPCOLORREF
;

153 
PVOID
 
	tHANDLE
;

155 
HANDLE
 *
	tPHANDLE
;

156 
HANDLE
 
	tNEAR
 *
	tSPHANDLE
;

157 
HANDLE
 
	tFAR
 *
	tLPHANDLE
;

158 
HANDLE
 
	tHGLOBAL
;

159 
HANDLE
 
	tHLOCAL
;

160 
HANDLE
 
	tGLOBALHANDLE
;

161 
HANDLE
 
	tLOCALHANDLE
;

163 
WORD
 
	tATOM
;

165 
hwnd
 * 
	tHWND
;

166 
hdc
 * 
	tHDC
;

167 
hcurs‹
 *
	tHCURSOR
;

168 
hgdiobj
 *
	tHGDIOBJ
;

169 
hgdiobj
 *
	tHBRUSH
;

170 
hgdiobj
 *
	tHPEN
;

171 
hgdiobj
 *
	tHFONT
;

172 
hgdiobj
 *
	tHBITMAP
;

173 
hgdiobj
 *
	tHRGN
;

174 
hgdiobj
 *
	tHPALETTE
;

175 
HANDLE
 
	tHICON
;

176 
HANDLE
 
	tHINSTANCE
;

177 
HANDLE
 
	tHMENU
;

	@include/windows.h

1 #i‚de‡
_WINDOWS_H


2 
	#_WINDOWS_H


	)

9 #ifde‡
__˝lu•lus


13 
	~"mwty≥s.h
"

14 
	~"wödef.h
"

15 
	~"wögdi.h
"

16 
	~"wöf⁄t.h
"

17 
	~"wökbd.h
"

18 
	~"wöu£r.h
"

21 
WINAPI
 
WöMaö
(
HINSTANCE
 
hIn°™˚
, HINSTANCE 
hPªvIn°™˚
,

22 
LPSTR
 
ÕCmdLöe
, 
nShowCmd
);

24 
MwU£rInô
(
ac
, **
av
);

31 
ty≥
;

32 
BOOL
 
°ockobj
;

33 } 
	tMWGDIOBJHDR
;

36 
	shgdiobj
 {

37 
MWGDIOBJHDR
 
hdr
;

42 
MWGDIOBJHDR
 
hdr
;

43 
°yÀ
;

44 
COLORREF
 
cﬁ‹
;

45 } 
	tMWPENOBJ
;

48 
MWGDIOBJHDR
 
hdr
;

49 
°yÀ
;

50 
COLORREF
 
cﬁ‹
;

51 } 
	tMWBRUSHOBJ
;

54 
MWGDIOBJHDR
 
hdr
;

55 
PMWFONT
 
pf⁄t
;

56 
«me
[32];

57 } 
	tMWFONTOBJ
;

60 
MWGDIOBJHDR
 
hdr
;

61 
width
;

62 
height
;

63 
∂™es
;

64 
bµ
;

65 
löñí
;

66 
size
;

67 
bôs
[1];

68 } 
	tMWBITMAPOBJ
;

71 
MWGDIOBJHDR
 
hdr
;

72 
MWCLIPREGION
 * 
rgn
;

73 } 
	tMWRGNOBJ
;

76 
	shdc
 {

77 
_mws¸ìndevi˚
 *
psd
;

78 
HWND
 
hwnd
;

79 
DWORD
 
Êags
;

80 
bkmode
;

81 
UINT
 
ãxèlign
;

82 
MWCOLORVAL
 
bkcﬁ‹
;

83 
MWCOLORVAL
 
ãxtcﬁ‹
;

84 
MWBRUSHOBJ
 * 
brush
;

85 
MWPENOBJ
 * 
≥n
;

86 
MWFONTOBJ
 * 
f⁄t
;

87 
MWBITMAPOBJ
 * 
bôm≠
;

88 
MWRGNOBJ
 * 
ªgi⁄
;

89 
døwmode
;

90 
POINT
 
±
;

94 
	shcurs‹
 {

95 
u£cou¡
;

96 
MWCURSOR
 
curs‹
;

101 
möPos
;

102 
maxPos
;

103 
curPos
;

104 
∑geSãp
;

105 
b¨Sèπ
;

106 
b¨Lí
;

107 
°©us
;

108 
RECT
 
rc
;

109 } 
	tMWSCROLLBARINFO
, *
	tPMWSCROLLBARINFO
;

112 
	shwnd
 {

113 
RECT
 
wöª˘
;

114 
RECT
 
˛úe˘
;

115 
RECT
 
ª°‹îc
;

116 
DWORD
 
°yÀ
;

117 
DWORD
 
ex°yÀ
;

118 
PWNDCLASS
 
pCœss
;

119 
hwnd
 *
∑ª¡
;

120 
hwnd
 *
ow√r
;

121 
hwnd
 *
chûdªn
;

122 
hwnd
 *
siblögs
;

123 
hwnd
 *
√xt
;

124 
hcurs‹
 *
curs‹
;

125 
hdc
 * 
owndc
;

126 
unm≠cou¡
;

127 
id
;

128 
CHAR
 
szTôÀ
[64];

129 
gŸPaötMsg
;

130 
∑ötSîül
;

131 
∑ötNC
;

132 
MWCLIPREGION
 * 
upd©e
;

133 
DWORD
 
u£rd©a
;

134 
DWORD
 
u£rd©a2
;

135 
MWSCROLLBARINFO
 
hs¸ﬁl
;

136 
MWSCROLLBARINFO
 
vs¸ﬁl
;

137 
√xåabyãs
;

138 
exåabyãs
[1];

142 
DWORD
 
WINAPI
 
GëTickCou¡
(
VOID
);

143 
VOID
 
WINAPI
 
SÀï
(
DWORD
 
dwMûli£c⁄ds
);

145 #ifde‡
__˝lu•lus


	@include/windowsx.h

1 
	#HANDLE_WM_COMMAND
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

2 ((
‚
)((
hwnd
), ()(
	`LOWORD
(
wP¨am
)), (
HWND
)(
lP¨am
), (
UINT
)
	`HIWORD
(wP¨am)), 0L)

	)

3 
	#FORWARD_WM_COMMAND
(
hwnd
, 
id
, 
hwndCé
, 
codeNŸify
, 
‚
) \

4 ()(
‚
)((
hwnd
), 
WM_COMMAND
, 
	`MAKEWPARAM
((
UINT
)(
id
),(UINT)(
codeNŸify
)), (
LPARAM
)(
HWND
)(
hwndCé
))

	)

6 
	#HANDLE_WM_CREATE
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

7 ((
‚
)((
hwnd
), (
LPCREATESTRUCT
)(
lP¨am
)Ë? 0L : (
LRESULT
)-1L)

	)

8 
	#FORWARD_WM_CREATE
(
hwnd
, 
ÕCª©eSåu˘
, 
‚
) \

9 (
BOOL
)(
DWORD
)(
‚
)((
hwnd
), 
WM_CREATE
, 0L, (
LPARAM
)(
LPCREATESTRUCT
)(
ÕCª©eSåu˘
))

	)

11 
	#HANDLE_WM_DESTROY
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

12 ((
‚
)(
hwnd
), 0L)

	)

13 
	#FORWARD_WM_DESTROY
(
hwnd
, 
‚
) \

14 ()(
‚
)((
hwnd
), 
WM_DESTROY
, 0L, 0L)

	)

16 
	#HANDLE_WM_ERASEBKGND
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

17 (
LRESULT
)(
DWORD
)(
BOOL
)(
‚
)((
hwnd
), (
HDC
)(
wP¨am
))

	)

18 
	#FORWARD_WM_ERASEBKGND
(
hwnd
, 
hdc
, 
‚
) \

19 (
BOOL
)(
DWORD
)(
‚
)((
hwnd
), 
WM_ERASEBKGND
, (
WPARAM
)(
HDC
)(
hdc
), 0L)

	)

21 
	#HANDLE_WM_LBUTTONDOWN
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

22 ((
‚
)((
hwnd
), 
FALSE
, ()()
	`LOWORD
(
lP¨am
), ()()
	`HIWORD
÷P¨am), (
UINT
)(
wP¨am
)), 0L)

	)

23 
	#FORWARD_WM_LBUTTONDOWN
(
hwnd
, 
fDoubÀClick
, 
x
, 
y
, 
keyFœgs
, 
‚
) \

24 ()(
‚
)((
hwnd
), (
fDoubÀClick
Ë? 
WM_LBUTTONDBLCLK
 : 
WM_LBUTTONDOWN
, (
WPARAM
)(
UINT
)(
keyFœgs
), 
	`MAKELPARAM
((
x
), (
y
)))

	)

26 
	#HANDLE_WM_LBUTTONDBLCLK
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

27 ((
‚
)((
hwnd
), 
TRUE
, ()()
	`LOWORD
(
lP¨am
), ()()
	`HIWORD
÷P¨am), (
UINT
)(
wP¨am
)), 0L)

	)

29 
	#HANDLE_WM_LBUTTONUP
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

30 ((
‚
)((
hwnd
), ()()
	`LOWORD
(
lP¨am
), ()()
	`HIWORD
÷P¨am), (
UINT
)(
wP¨am
)), 0L)

	)

31 
	#FORWARD_WM_LBUTTONUP
(
hwnd
, 
x
, 
y
, 
keyFœgs
, 
‚
) \

32 ()(
‚
)((
hwnd
), 
WM_LBUTTONUP
, (
WPARAM
)(
UINT
)(
keyFœgs
), 
	`MAKELPARAM
((
x
), (
y
)))

	)

34 
	#HANDLE_WM_MOUSEMOVE
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

35 ((
‚
)((
hwnd
), ()()
	`LOWORD
(
lP¨am
), ()()
	`HIWORD
÷P¨am), (
UINT
)(
wP¨am
)), 0L)

	)

36 
	#FORWARD_WM_MOUSEMOVE
(
hwnd
, 
x
, 
y
, 
keyFœgs
, 
‚
) \

37 ()(
‚
)((
hwnd
), 
WM_MOUSEMOVE
, (
WPARAM
)(
UINT
)(
keyFœgs
), 
	`MAKELPARAM
((
x
), (
y
)))

	)

39 
	#HANDLE_WM_SETFOCUS
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

40 ((
‚
)((
hwnd
), (
HWND
)(
wP¨am
)), 0L)

	)

41 
	#FORWARD_WM_SETFOCUS
(
hwnd
, 
hwndOldFocus
, 
‚
) \

42 ()(
‚
)((
hwnd
), 
WM_SETFOCUS
, (
WPARAM
)(
HWND
)(
hwndOldFocus
), 0L)

	)

44 
	#HANDLE_WM_KILLFOCUS
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

45 ((
‚
)((
hwnd
), (
HWND
)(
wP¨am
)), 0L)

	)

46 
	#FORWARD_WM_KILLFOCUS
(
hwnd
, 
hwndNewFocus
, 
‚
) \

47 ()(
‚
)((
hwnd
), 
WM_KILLFOCUS
, (
WPARAM
)(
HWND
)(
hwndNewFocus
), 0L)

	)

49 
	#HANDLE_WM_SETTEXT
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

50 ((
‚
)((
hwnd
), (
LPCTSTR
)(
lP¨am
)), 0L)

	)

51 
	#FORWARD_WM_SETTEXT
(
hwnd
, 
ÕszText
, 
‚
) \

52 ()(
‚
)((
hwnd
), 
WM_SETTEXT
, 0L, (
LPARAM
)(
LPCTSTR
)(
ÕszText
))

	)

54 
	#HANDLE_MSG
(
hwnd
, 
mesßge
, 
‚
) \

55 (
mesßge
):  
HANDLE_
##
	`mesßge
((
hwnd
), (
wP¨am
), (
lP¨am
), (
‚
))

	)

	@include/winfont.h

9 
	#TMPF_FIXED_PITCH
 0x01

	)

10 
	#TMPF_VECTOR
 0x02

	)

11 
	#TMPF_TRUETYPE
 0x04

	)

12 
	#TMPF_DEVICE
 0x08

	)

14 
	sègTEXTMETRIC
 {

15 
LONG
 
	mtmHeight
;

16 
LONG
 
	mtmAs˚¡
;

17 
LONG
 
	mtmDes˚¡
;

18 
LONG
 
	mtmI¡î«lLódög
;

19 
LONG
 
	mtmExã∫ÆLódög
;

20 
LONG
 
	mtmAveCh¨Width
;

21 
LONG
 
	mtmMaxCh¨Width
;

22 
LONG
 
	mtmWeight
;

23 
LONG
 
	mtmOvîh™g
;

24 
LONG
 
	mtmDigôizedA•e˘X
;

25 
LONG
 
	mtmDigôizedA•e˘Y
;

26 
BYTE
 
	mtmFú°Ch¨
;

27 
BYTE
 
	mtmLa°Ch¨
;

28 
BYTE
 
	mtmDeÁu…Ch¨
;

29 
BYTE
 
	mtmBªakCh¨
;

30 
BYTE
 
	mtmIèlic
;

31 
BYTE
 
	mtmUndîlöed
;

32 
BYTE
 
	mtmSåuckOut
;

33 
BYTE
 
	mtmPôchAndFamûy
;

34 
BYTE
 
	mtmCh¨Së
;

35 } 
	tTEXTMETRIC
, *
	tPTEXTMETRIC
, 
	tNEAR
 *
	tNPTEXTMETRIC
, 
	tFAR
 *
	tLPTEXTMETRIC
;

37 
BOOL
 
WINAPI
 
GëTextMërics
(
HDC
 
hdc
, 
LPTEXTMETRIC
 
Õtm
);

38 
BOOL
 
WINAPI
 
GëCh¨Width
(
HDC
 
hdc
,
UINT
 
iFú°Ch¨
,UINT 
iLa°Ch¨
,
LPINT
 
ÕBuf„r
);

39 
BOOL
 
WINAPI
 
GëTextExã¡Poöt
(
HDC
 
hdc
,
LPCTSTR
 
ÕszSå
,
cchSåög
,

40 
LPSIZE
 
ÕSize
);

41 
BOOL
 
WINAPI
 
GëTextExã¡ExPoöt
(
HDC
 
hdc
,
LPCTSTR
 
ÕszSå
,
cchSåög
,

42 
nMaxExã¡
,
LPINT
 
ÕnFô
,LPINT 
ÆpDx
,
LPSIZE
 
ÕSize
);

47 
LONG
 
	mlfHeight
;

48 
LONG
 
	mlfWidth
;

49 
LONG
 
	mlfEsˇ≥mít
;

50 
LONG
 
	mlfOrõ¡©i⁄
;

51 
LONG
 
	mlfWeight
;

52 
BYTE
 
	mlfIèlic
;

53 
BYTE
 
	mlfUndîlöe
;

54 
BYTE
 
	mlfSåikeOut
;

55 
BYTE
 
	mlfCh¨Së
;

56 
BYTE
 
	mlfOutPªcisi⁄
;

57 
BYTE
 
	mlfClùPªcisi⁄
;

58 
BYTE
 
	mlfQuÆôy
;

59 
BYTE
 
	mlfPôchAndFamûy
;

60 
CHAR
 
	mlfFa˚Name
[
MWLF_FACESIZE
];

61 } 
	tLOGFONT
, *
	tPLOGFONT
, 
	tNEAR
 *
	tNPLOGFONT
, 
	tFAR
 *
	tLPLOGFONT
;

63 
	#LF_FACESIZE
 
MWLF_FACESIZE


	)

66 
	#FW_DONTCARE
 
MWLF_WEIGHT_DEFAULT


	)

67 
	#FW_THIN
 
MWLF_WEIGHT_THIN


	)

68 
	#FW_EXTRALIGHT
 
MWLF_WEIGHT_EXTRALIGHT


	)

69 
	#FW_LIGHT
 
MWLF_WEIGHT_LIGHT


	)

70 
	#FW_NORMAL
 
MWLF_WEIGHT_NORMAL


	)

71 
	#FW_MEDIUM
 
MWLF_WEIGHT_MEDIUM


	)

72 
	#FW_SEMIBOLD
 
MWLF_WEIGHT_DEMIBOLD


	)

73 
	#FW_BOLD
 
MWLF_WEIGHT_BOLD


	)

74 
	#FW_EXTRABOLD
 
MWLF_WEIGHT_EXTRABOLD


	)

75 
	#FW_HEAVY
 
MWLF_WEIGHT_BLACK


	)

76 
	#FW_ULTRALIGHT
 
FW_EXTRALIGHT


	)

77 
	#FW_REGULAR
 
FW_NORMAL


	)

78 
	#FW_DEMIBOLD
 
FW_SEMIBOLD


	)

79 
	#FW_ULTRABOLD
 
FW_EXTRABOLD


	)

80 
	#FW_BLACK
 
FW_HEAVY


	)

83 
	#OUT_DEFAULT_PRECIS
 
MWLF_TYPE_DEFAULT


	)

84 
	#OUT_STRING_PRECIS
 1

	)

85 
	#OUT_CHARACTER_PRECIS
 2

	)

86 
	#OUT_STROKE_PRECIS
 3

	)

87 
	#OUT_TT_PRECIS
 
MWLF_TYPE_SCALED


	)

88 
	#OUT_DEVICE_PRECIS
 
MFLF_TYPE_RASTER


	)

89 
	#OUT_RASTER_PRECIS
 
MFLF_TYPE_RASTER


	)

90 
	#OUT_TT_ONLY_PRECIS
 
MWLF_TYPE_TRUETYPE


	)

91 
	#OUT_OUTLINE_PRECIS
 8

	)

92 
	#OUT_SCREEN_OUTLINE_PRECIS
 9

	)

95 
	#CLIP_DEFAULT_PRECIS
 0

	)

96 
	#CLIP_CHARACTER_PRECIS
 1

	)

97 
	#CLIP_STROKE_PRECIS
 2

	)

98 
	#CLIP_MASK
 0xf

	)

99 
	#CLIP_LH_ANGLES
 (1<<4)

	)

100 
	#CLIP_TT_ALWAYS
 (2<<4)

	)

101 
	#CLIP_EMBEDDED
 (8<<4)

	)

104 
	#DEFAULT_QUALITY
 0

	)

105 
	#DRAFT_QUALITY
 1

	)

106 
	#PROOF_QUALITY
 2

	)

107 
	#NONANTIALIASED_QUALITY
 3

	)

108 
	#ANTIALIASED_QUALITY
 4

	)

111 
	#ANSI_CHARSET
 
MWLF_CHARSET_ANSI


	)

112 
	#DEFAULT_CHARSET
 
MWLF_CHARSET_DEFAULT


	)

113 
	#SYMBOL_CHARSET
 2

	)

114 
	#OEM_CHARSET
 
MWLF_CHARSET_OEM


	)

117 
	#MWLF_PITCH_DEFAULT
 0

	)

118 
	#MWLF_PITCH_FIXED
 1

	)

119 
	#MWLF_PITCH_VARIABLE
 2

	)

122 
	#DEFAULT_PITCH
 
MWLF_PITCH_DEFAULT


	)

123 
	#FIXED_PITCH
 
MWLF_PITCH_FIXED


	)

124 
	#VARIABLE_PITCH
 
MWLF_PITCH_VARIABLE


	)

125 
	#MONO_FONT
 8

	)

134 
	#MWLF_FAMILY_DEFAULT
 (0<<4Ë

	)

135 
	#MWLF_FAMILY_SERIF
 (1<<4Ë

	)

136 
	#MWLF_FAMILY_SANSSERIF
 (2<<4Ë

	)

137 
	#MWLF_FAMILY_MODERN
 (3<<4Ë

	)

140 
	#MWLF_FAMILY_BITSTREAM
 (6<<4Ë

	)

141 
	#MWLF_FAMILY_ADOBE
 (7<<4Ë

	)

144 
	#FF_DONTCARE
 
MWLF_FAMILY_DEFAULT


	)

145 
	#FF_ROMAN
 
MWLF_FAMILY_SERIF


	)

146 
	#FF_SWISS
 
MWLF_FAMILY_SANSSERIF


	)

147 
	#FF_MODERN
 
MWLF_FAMILY_MODERN


	)

148 
	#FF_SCRIPT
 (4<<4Ë

	)

149 
	#FF_DECORATIVE
 (5<<4Ë

	)

151 
HFONT
 
WINAPI
 
Cª©eF⁄t
(
nHeight
, 
nWidth
, 
nEsˇ≥mít
,

152 
nOrõ¡©i⁄
, 
‚Weight
, 
DWORD
 
fdwIèlic
,

153 
DWORD
 
fdwUndîlöe
, DWORD 
fdwSåikeOut
,DWORD 
fdwCh¨Së
,

154 
DWORD
 
fdwOuçutPªcisi⁄
,DWORD 
fdwClùPªcisi⁄
,

155 
DWORD
 
fdwQuÆôy
, DWORD 
fdwPôchAndFamûy
, 
LPCSTR
 
ÕszFa˚
);

156 
HFONT
 
WINAPI
 
Cª©eF⁄tIndúe˘
(
CONST
 
LOGFONT
 *
Õlf
);

	@include/wingdi.h

9 
MWCOORD
 
	tGDICOORD
;

12 
MWRECT
 
	tRECT
;

13 
MWPOINT
 
	tPOINT
;

16 
	sègRECT
 {

17 
GDICOORD
 
	mÀ·
;

18 
GDICOORD
 
	mt›
;

19 
GDICOORD
 
	mright
;

20 
GDICOORD
 
	mbŸtom
;

21 } 
	tRECT
;

23 
	sègPOINT
 {

24 
GDICOORD
 
	mx
;

25 
GDICOORD
 
	my
;

26 } 
	tPOINT
;

29 
RECT
 
	tNEAR
 *
	tPRECT
, 
	tFAR
 *
	tLPRECT
;

31 
POINT
 
	tNEAR
 *
	tPPOINT
, 
	tFAR
 *
	tLPPOINT
;

33 
	sègSIZE
 {

34 
GDICOORD
 
	mcx
;

35 
GDICOORD
 
	mcy
;

36 } 
	tSIZE
, 
	tNEAR
 *
	tPSIZE
, 
	tFAR
 *
	tLPSIZE
;

39 
	#DCX_WINDOW
 0x00000001L

	)

40 
	#DCX_CACHE
 0x00000002L

	)

41 
	#DCX_NORESETATTRS
 0x00000004L

	)

42 
	#DCX_CLIPCHILDREN
 0x00000008L

	)

43 
	#DCX_CLIPSIBLINGS
 0x00000010L

	)

44 
	#DCX_PARENTCLIP
 0x00000020L

	)

45 
	#DCX_EXCLUDERGN
 0x00000040L

	)

46 
	#DCX_INTERSECTRGN
 0x00000080L

	)

47 
	#DCX_EXCLUDEUPDATE
 0x00000100L

	)

48 
	#DCX_INTERSECTUPDATE
 0x00000200L

	)

49 
	#DCX_LOCKWINDOWUPDATE
 0x00000400L

	)

50 
	#DCX_VALIDATE
 0x00200000L

	)

51 
	#DCX_DEFAULTCLIP
 0x80000000L

	)

53 
HDC
 
WINAPI
 
GëDCEx
(
HWND
 
hwnd
,
HRGN
 
hrgnClù
,
DWORD
 
Êags
);

54 
HDC
 
WINAPI
 
GëDC
(
HWND
 
hWnd
);

55 
HDC
 
WINAPI
 
GëWödowDC
(
HWND
 
hWnd
);

56 
WINAPI
 
Rñó£DC
(
HWND
 
hWnd
, 
HDC
 
hDC
);

57 
BOOL
 
WINAPI
 
DñëeDC
(
HDC
 
hdc
);

59 
	sègPAINTSTRUCT
 {

60 
HDC
 
	mhdc
;

61 
BOOL
 
	mfEø£
;

62 
RECT
 
	mrcPaöt
;

63 
BOOL
 
	mfRe°‹e
;

64 
BOOL
 
	mfIncUpd©e
;

65 
BYTE
 
	mrgbRe£rved
[32];

66 } 
	tPAINTSTRUCT
, *
	tPPAINTSTRUCT
, *
	tNPPAINTSTRUCT
, 
	tFAR
 *
	tLPPAINTSTRUCT
;

68 
HDC
 
WINAPI
 
BegöPaöt
(
HWND
 
hWnd
, 
LPPAINTSTRUCT
 
ÕPaöt
);

69 
BOOL
 
WINAPI
 
EndPaöt
(
HWND
 
hWnd
, 
CONST
 
PAINTSTRUCT
 *
ÕPaöt
);

71 
	#RGB
(
r
,
g
,
b
Ë
	`MWRGB
‘,g,b)

	)

72 
	#GëRVÆue
(
rgb
Ë((
BYTE
)‘gb))

	)

73 
	#GëGVÆue
(
rgb
Ë((
BYTE
)(((
WORD
)‘gb)Ë>> 8))

	)

74 
	#GëBVÆue
(
rgb
Ë((
BYTE
)(‘gb)>>16))

	)

77 
	#TRANSPARENT
 1

	)

78 
	#OPAQUE
 2

	)

81 
	#TA_NOUPDATECP
 0

	)

82 
	#TA_UPDATECP
 1

	)

84 
	#TA_LEFT
 0

	)

85 
	#TA_RIGHT
 2

	)

86 
	#TA_CENTER
 6

	)

88 
	#TA_TOP
 0

	)

89 
	#TA_BOTTOM
 8

	)

90 
	#TA_BASELINE
 24

	)

91 
	#TA_RTLREADING
 256

	)

92 
	#TA_MASK
 (
TA_BASELINE
+
TA_CENTER
+
TA_UPDATECP
+
TA_RTLREADING
)

	)

94 
COLORREF
 
WINAPI
 
SëTextCﬁ‹
(
HDC
, COLORREF);

95 
COLORREF
 
WINAPI
 
SëBkCﬁ‹
(
HDC
, COLORREF);

96 
WINAPI
 
SëBkMode
(
HDC
, );

97 
UINT
 
WINAPI
 
SëTextAlign
(
HDC
 
hdc
, UINT 
fMode
);

100 
	#R2_BLACK
 (
MWMODE_CLEAR
+1Ë

	)

101 
	#R2_NOTMERGEPEN
 (
MWMODE_NOR
+1Ë

	)

102 
	#R2_MASKNOTPEN
 (
MWMODE_ANDINVERTED
+1Ë

	)

103 
	#R2_NOTCOPYPEN
 (
MWMODE_COPYINVERTED
+1Ë

	)

104 
	#R2_MASKPENNOT
 (
MWMODE_ANDREVERSE
+1Ë

	)

105 
	#R2_NOT
 (
MWMODE_INVERT
+1Ë

	)

106 
	#R2_XORPEN
 (
MWMODE_XOR
+1Ë

	)

107 
	#R2_NOTMASKPEN
 (
MWMODE_NAND
+1Ë

	)

108 
	#R2_MASKPEN
 (
MWMODE_AND
+1Ë

	)

109 
	#R2_NOTXORPEN
 (
MWMODE_EQUIV
+1Ë

	)

110 
	#R2_NOP
 (
MWMODE_NOOP
+1Ë

	)

111 
	#R2_MERGENOTPEN
 (
MWMODE_ORINVERTED
+1Ë

	)

112 
	#R2_COPYPEN
 (
MWMODE_COPY
+1Ë

	)

113 
	#R2_MERGEPENNOT
 (
MWMODE_ORREVERSE
+1Ë

	)

114 
	#R2_MERGEPEN
 (
MWMODE_OR
+1Ë

	)

115 
	#R2_WHITE
 (
MWMODE_SETTO1
+1Ë

	)

116 
	#R2_LAST
 16

	)

118 
WINAPI
 
SëROP2
(
HDC
 
hdc
, 
‚DøwMode
);

120 
	#GDI_ERROR
 (0xFFFFFFFFL)

	)

121 
	#CLR_INVALID
 0xFFFFFFFF

	)

123 
COLORREF
 
WINAPI
 
GëPixñ
(
HDC
 
hdc
, 
x
, 
y
);

124 
COLORREF
 
WINAPI
 
SëPixñ
(
HDC
 
hdc
, 
x
, 
y
, COLORREF 
¸Cﬁ‹
);

125 
BOOL
 
WINAPI
 
MoveToEx
(
HDC
 
hdc
, 
x
, 
y
, 
LPPOINT
 
ÕPoöt
);

126 
BOOL
 
WINAPI
 
LöeTo
(
HDC
 
hdc
, 
x
, 
y
);

127 
BOOL
 
WINAPI
 
Pﬁylöe
(
HDC
 
hdc
, 
CONST
 
POINT
 *
Õ±
, 
cPoöts
);

128 
BOOL
 
WINAPI
 
PﬁyPﬁyg⁄
(
HDC
 
hdc
, 
CONST
 
POINT
 *
ÕPoöts
, 
LPINT
 
ÕPﬁyCou¡s
,

129 
nCou¡
);

130 
BOOL
 
WINAPI
 
Re˘™gÀ
(
HDC
 
hdc
, 
nLe·
, 
nT›
, 
nRight
,
nBŸtom
);

131 
BOOL
 
WINAPI
 
EŒù£
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
,

132 
nBŸtomRe˘
);

133 
BOOL
 
WINAPI
 
Arc
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
,

134 
nBŸtomRe˘
, 
nXSèπArc
, 
nYSèπArc
,

135 
nXEndArc
, 
nYEndArc
);

136 
BOOL
 
WINAPI
 
Põ
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
,

137 
nBŸtomRe˘
, 
nXRadül1
, 
nYRadül1
,

138 
nXRadül2
, 
nYRadül2
);

139 
BOOL
 
WINAPI
 
Pﬁyg⁄
(
HDC
 
hdc
, 
CONST
 
POINT
 *
ÕPoöts
, 
nCou¡
);

140 
WINAPI
 
FûlRe˘
(
HDC
 
hDC
, 
CONST
 
RECT
 *
Õrc
, 
HBRUSH
 
hbr
);

143 
	#ETO_OPAQUE
 0x0002

	)

144 
	#ETO_CLIPPED
 0x0004

	)

146 
BOOL
 
WINAPI
 
TextOut
(
HDC
 
hdc
, 
x
, 
y
, 
LPCSTR
 
ÕszSåög
, 
cbSåög
);

147 
BOOL
 
WINAPI
 
ExtTextOut
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
,

148 
CONST
 
RECT
 *
Õrc
, 
LPCSTR
 
ÕszSåög
, 
UINT
 
cbCou¡
,

149 
CONST
 
INT
 *
ÕDx
);

150 
BOOL
 
WINAPI
 
ExtTextOutW
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
,

151 
CONST
 
RECT
 *
Õrc
, 
LPCWSTR
 
ÕszSåög
, 
UINT
 
cbCou¡
,

152 
CONST
 
INT
 *
ÕDx
);

155 
	#DT_TOP
 0x00000000

	)

156 
	#DT_LEFT
 0x00000000

	)

157 
	#DT_CENTER
 0x00000001

	)

158 
	#DT_RIGHT
 0x00000002

	)

159 
	#DT_VCENTER
 0x00000004

	)

160 
	#DT_BOTTOM
 0x00000008

	)

161 
	#DT_WORDBREAK
 0x00000010

	)

162 
	#DT_SINGLELINE
 0x00000020

	)

163 
	#DT_EXPANDTABS
 0x00000040

	)

164 
	#DT_TABSTOP
 0x00000080

	)

165 
	#DT_NOCLIP
 0x00000100

	)

166 
	#DT_EXTERNALLEADING
 0x00000200

	)

167 
	#DT_CALCRECT
 0x00000400

	)

168 
	#DT_NOPREFIX
 0x00000800

	)

169 
	#DT_INTERNAL
 0x00001000

	)

170 
	#DT_EDITCONTROL
 0x00002000

	)

171 
	#DT_PATH_ELLIPSIS
 0x00004000

	)

172 
	#DT_END_ELLIPSIS
 0x00008000

	)

173 
	#DT_MODIFYSTRING
 0x00010000

	)

174 
	#DT_RTLREADING
 0x00020000

	)

175 
	#DT_WORD_ELLIPSIS
 0x00040000

	)

177 
WINAPI
 
DøwTextA
(
HDC
 
hdc
, 
LPCSTR
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
,

178 
UINT
 
uF‹m©
);

179 
WINAPI
 
DøwTextW
(
HDC
 
hdc
, 
LPCWSTR
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
,

180 
UINT
 
uF‹m©
);

181 
	#DøwText
 
DøwTextA


	)

183 
BOOL
 
WINAPI
 
DøwDIB
(
HDC
 
hdc
,
x
, 
y
,
PMWIMAGEHDR
 
pimage
);

186 
	#COLOR_SCROLLBAR
 0

	)

187 
	#COLOR_BACKGROUND
 1

	)

188 
	#COLOR_ACTIVECAPTION
 2

	)

189 
	#COLOR_INACTIVECAPTION
 3

	)

190 
	#COLOR_MENU
 4

	)

191 
	#COLOR_WINDOW
 5

	)

192 
	#COLOR_WINDOWFRAME
 6

	)

193 
	#COLOR_MENUTEXT
 7

	)

194 
	#COLOR_WINDOWTEXT
 8

	)

195 
	#COLOR_CAPTIONTEXT
 9

	)

196 
	#COLOR_ACTIVEBORDER
 10

	)

197 
	#COLOR_INACTIVEBORDER
 11

	)

198 
	#COLOR_APPWORKSPACE
 12

	)

199 
	#COLOR_HIGHLIGHT
 13

	)

200 
	#COLOR_HIGHLIGHTTEXT
 14

	)

201 
	#COLOR_BTNFACE
 15

	)

202 
	#COLOR_BTNSHADOW
 16

	)

203 
	#COLOR_GRAYTEXT
 17

	)

204 
	#COLOR_BTNTEXT
 18

	)

205 
	#COLOR_INACTIVECAPTIONTEXT
 19

	)

206 
	#COLOR_BTNHIGHLIGHT
 20

	)

207 
	#COLOR_3DDKSHADOW
 21

	)

208 
	#COLOR_3DLIGHT
 22

	)

209 
	#COLOR_INFOTEXT
 23

	)

210 
	#COLOR_INFOBK
 24

	)

211 
	#COLOR_DESKTOP
 
COLOR_BACKGROUND


	)

212 
	#COLOR_3DFACE
 
COLOR_BTNFACE


	)

213 
	#COLOR_3DSHADOW
 
COLOR_BTNSHADOW


	)

214 
	#COLOR_3DHIGHLIGHT
 
COLOR_BTNHIGHLIGHT


	)

215 
	#COLOR_3DHILIGHT
 
COLOR_BTNHIGHLIGHT


	)

216 
	#COLOR_BTNHILIGHT
 
COLOR_BTNHIGHLIGHT


	)

217 
	#COLOR_ALTERNATEBUTTONFACE
 25

	)

218 
	#COLOR_HOTLIGHT
 26

	)

219 
	#COLOR_GRADIENTACTIVECAPTION
 27

	)

220 
	#COLOR_GRADIENTINACTIVECAPTION
 28

	)

222 
DWORD
 
WINAPI
 
GëSysCﬁ‹
(
nIndex
);

223 
COLORREF
 
WINAPI
 
SëSysCﬁ‹
(
nIndex
, COLORREF 
¸Cﬁ‹
);

226 
	#WHITE_BRUSH
 0

	)

227 
	#LTGRAY_BRUSH
 1

	)

228 
	#GRAY_BRUSH
 2

	)

229 
	#DKGRAY_BRUSH
 3

	)

230 
	#BLACK_BRUSH
 4

	)

231 
	#NULL_BRUSH
 5

	)

232 
	#HOLLOW_BRUSH
 
NULL_BRUSH


	)

233 
	#WHITE_PEN
 6

	)

234 
	#BLACK_PEN
 7

	)

235 
	#NULL_PEN
 8

	)

236 
	#OEM_FIXED_FONT
 10

	)

237 
	#ANSI_FIXED_FONT
 11

	)

238 
	#ANSI_VAR_FONT
 12

	)

239 
	#SYSTEM_FONT
 13

	)

240 
	#DEVICE_DEFAULT_FONT
 14

	)

241 
	#DEFAULT_PALETTE
 15

	)

242 
	#SYSTEM_FIXED_FONT
 16

	)

243 
	#DEFAULT_GUI_FONT
 17

	)

244 
	#DC_BRUSH
 18

	)

245 
	#DC_PEN
 19

	)

246 
	#STOCK_LAST
 19

	)

249 
	#OBJ_PEN
 1

	)

250 
	#OBJ_BRUSH
 2

	)

251 
	#OBJ_DC
 3

	)

252 
	#OBJ_METADC
 4

	)

253 
	#OBJ_PAL
 5

	)

254 
	#OBJ_FONT
 6

	)

255 
	#OBJ_BITMAP
 7

	)

256 
	#OBJ_REGION
 8

	)

257 
	#OBJ_METAFILE
 9

	)

258 
	#OBJ_MEMDC
 10

	)

259 
	#OBJ_EXTPEN
 11

	)

260 
	#OBJ_ENHMETADC
 12

	)

261 
	#OBJ_ENHMETAFILE
 13

	)

263 
HGDIOBJ
 
WINAPI
 
GëStockObje˘
(
nObje˘
);

264 
HGDIOBJ
 
WINAPI
 
Sñe˘Obje˘
(
HDC
 
hdc
, HGDIOBJ 
hObje˘
);

265 
BOOL
 
WINAPI
 
DñëeObje˘
(
HGDIOBJ
 
hObje˘
);

266 
WINAPI
 
Sñe˘ClùRgn
(
HDC
 
hdc
, 
HRGN
 
hrgn
);

267 
WINAPI
 
ExtSñe˘ClùRgn
(
HDC
 
hdc
, 
HRGN
 
hrgn
, 
‚Mode
);

268 
WINAPI
 
GëUpd©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
, 
BOOL
 
bEø£
);

269 
BOOL
 
WINAPI
 
GëUpd©eRe˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
, BOOL 
bEø£
);

272 
	#BS_SOLID
 0

	)

273 
	#BS_NULL
 1

	)

274 
	#BS_HOLLOW
 
BS_NULL


	)

276 
HBRUSH
 
WINAPI
 
Cª©eSﬁidBrush
(
COLORREF
 
¸Cﬁ‹
);

279 
	#PS_SOLID
 0

	)

280 
	#PS_NULL
 5

	)

282 
HPEN
 
WINAPI
 
Cª©ePí
(
nPíStyÀ
, 
nWidth
, 
COLORREF
 
¸Cﬁ‹
);

284 
HBITMAP
 
WINAPI
 
Cª©eCom∑tibÀBôm≠
(
HDC
 
hdc
, 
nWidth
, 
nHeight
);

285 
HDC
 
WINAPI
 
Cª©eCom∑tibÀDC
(HDC 
hdc
);

288 
	#SRCCOPY
 (
DWORD
)
MWROP_COPY


	)

289 
	#SRCPAINT
 (
DWORD
)
MWROP_OR


	)

290 
	#SRCAND
 (
DWORD
)
MWROP_AND


	)

291 
	#SRCINVERT
 (
DWORD
)
MWROP_XOR


	)

292 
	#SRCERASE
 (
DWORD
)
MWROP_ANDREVERSE


	)

293 
	#NOTSRCCOPY
 (
DWORD
)
MWROP_COPYINVERTED


	)

294 
	#NOTSRCERASE
 (
DWORD
)
MWROP_NOR


	)

295 
	#MERGEPAINT
 (
DWORD
)
MWROP_ORINVERTED


	)

296 
	#DSTINVERT
 (
DWORD
)
MWROP_INVERT


	)

297 
	#BLACKNESS
 (
DWORD
)
MWROP_CLEAR


	)

298 
	#WHITENESS
 (
DWORD
)
MWROP_SET


	)

300 
	#MERGECOPY
 (
DWORD
)0x00C000CA

	)

301 
	#PATCOPY
 (
DWORD
)0x00F00021

	)

302 
	#PATPAINT
 (
DWORD
)0x00FB0A09

	)

303 
	#PATINVERT
 (
DWORD
)0x005A0049

	)

306 
BOOL
 
WINAPI
 
BôB…
(
HDC
 
hdcDe°
,
nXDe°
,
nYDe°
,
nWidth
,
nHeight
,

307 
HDC
 
hdcSrc
,
nXSrc
,
nYSrc
,
DWORD
 
dwR›
);

308 
BOOL
 
WINAPI
 
SåëchB…
(
HDC
 
hdcDe°
,
nXOrigöDe°
,
nYOrigöDe°
,

309 
nWidthDe°
,
nHeightDe°
,
HDC
 
hdcSrc
,

310 
nXOrigöSrc
,
nYOrigöSrc
,
nWidthSrc
,

311 
nHeightSrc
, 
DWORD
 
dwR›
);

314 
	#PC_RESERVED
 0x01

	)

315 
	#PC_EXPLICIT
 0x02

	)

316 
	#PC_NOCOLLAPSE
 0x04

	)

318 
	sègPALETTEENTRY
 {

319 
BYTE
 
	m≥Red
;

320 
BYTE
 
	m≥Gªí
;

321 
BYTE
 
	m≥Blue
;

322 
BYTE
 
	m≥Fœgs
;

323 } 
	tPALETTEENTRY
, *
	tPPALETTEENTRY
, 
	tFAR
 *
	tLPPALETTEENTRY
;

325 
UINT
 
WINAPI
 
GëSy°emPÆëãE¡rõs
(
HDC
 
hdc
,UINT 
iSèπIndex
,UINT 
nE¡rõs
,

326 
LPPALETTEENTRY
 
Õ≥
);

329 
	#HORZRES
 8

	)

330 
	#VERTRES
 10

	)

331 
	#BITSPIXEL
 12

	)

332 
	#PLANES
 14

	)

333 
	#LOGPIXELSX
 88

	)

334 
	#LOGPIXELSY
 90

	)

335 
	#SIZEPALETTE
 104

	)

337 
WINAPI
 
GëDevi˚C≠s
(
HDC
 
hdc
, 
nIndex
);

340 
	#ERRORREGION
 
MWREGION_ERROR


	)

341 
	#NULLREGION
 
MWREGION_NULL


	)

342 
	#SIMPLEREGION
 
MWREGION_SIMPLE


	)

343 
	#COMPLEXREGION
 
MWREGION_COMPLEX


	)

345 #ifde‡
ERROR


346 #unde‡
ERROR


348 
	#ERROR
 
ERRORREGION


	)

349 
	#RGN_ERROR
 
ERRORREGION


	)

352 
	#RGN_AND
 1

	)

353 
	#RGN_OR
 2

	)

354 
	#RGN_XOR
 3

	)

355 
	#RGN_DIFF
 4

	)

356 
	#RGN_COPY
 5

	)

357 
	#RGN_MIN
 
RGN_AND


	)

358 
	#RGN_MAX
 
RGN_COPY


	)

361 
	#RDH_RECTANGLES
 1

	)

362 
	s_RGNDATAHEADER
 {

363 
DWORD
 
	mdwSize
;

364 
DWORD
 
	miTy≥
;

365 
DWORD
 
	mnCou¡
;

366 
DWORD
 
	mnRgnSize
;

367 
RECT
 
	mrcBound
;

368 } 
	tRGNDATAHEADER
, *
	tPRGNDATAHEADER
;

370 
	s_RGNDATA
 {

371 
RGNDATAHEADER
 
	mrdh
;

372 
	mBuf„r
[1];

373 } 
	tRGNDATA
, *
	tPRGNDATA
, *
	tNPRGNDATA
, *
	tLPRGNDATA
;

376 
INT
 
WINAPI
 
Off£tRgn
(
HRGN
 
hrgn
, INT 
x
, INT 
y
 );

377 
INT
 
WINAPI
 
GëRgnBox
(
HRGN
 
hrgn
, 
LPRECT
 
ª˘
 );

378 
HRGN
 
WINAPI
 
Cª©eRe˘Rgn
(
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
);

379 
HRGN
 
WINAPI
 
Cª©eRe˘RgnIndúe˘
(c⁄° 
RECT
* 
ª˘
 );

380 
VOID
 
WINAPI
 
SëRe˘Rgn
(
HRGN
 
hrgn
, 
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
 );

381 
HRGN
 
WINAPI
 
Cª©eRoundRe˘Rgn
(
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
,

382 
INT
 
ñlù£_width
, INT 
ñlù£_height
 );

383 
HRGN
 
WINAPI
 
Cª©eEŒùticRgn
(
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
 );

384 
HRGN
 
WINAPI
 
Cª©eEŒùticRgnIndúe˘
(c⁄° 
RECT
 *
ª˘
 );

385 
DWORD
 
WINAPI
 
GëRegi⁄D©a
(
HRGN
 
hrgn
, DWORD 
cou¡
, 
LPRGNDATA
 
rgnd©a
);

386 
BOOL
 
WINAPI
 
PtInRegi⁄
(
HRGN
 
hrgn
, 
INT
 
x
, INT 
y
 );

387 
BOOL
 
WINAPI
 
Re˘InRegi⁄
(
HRGN
 
hrgn
, c⁄° 
RECT
 *
ª˘
 );

388 
BOOL
 
WINAPI
 
EquÆRgn
(
HRGN
 
hrgn1
, HRGN 
hrgn2
 );

389 
INT
 
WINAPI
 
ComböeRgn
(
HRGN
 
hDe°
, HRGN 
hSrc1
, HRGN 
hSrc2
, INT 
mode
);

392 
BOOL
 
WINAPI
 
I¡î£˘Re˘
(
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 );

393 
BOOL
 
WINAPI
 
Uni⁄Re˘
(
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 );

394 
BOOL
 
WINAPI
 
EquÆRe˘
(c⁄° 
RECT
* 
ª˘1
, c⁄° RECT* 
ª˘2
 );

395 
BOOL
 
WINAPI
 
Subåa˘Re˘
(
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 );

	@include/winkbd.h

9 
	#VK_LBUTTON
 0x01

	)

10 
	#VK_RBUTTON
 0x02

	)

11 
	#VK_CANCEL
 0x03

	)

12 
	#VK_MBUTTON
 0x04

	)

13 
	#VK_BACK
 0x08

	)

14 
	#VK_TAB
 0x09

	)

15 
	#VK_CLEAR
 0x0C

	)

16 
	#VK_RETURN
 0x0D

	)

17 
	#VK_SHIFT
 0x10

	)

18 
	#VK_CONTROL
 0x11

	)

19 
	#VK_MENU
 0x12

	)

20 
	#VK_PAUSE
 0x13

	)

21 
	#VK_CAPITAL
 0x14

	)

22 
	#VK_KANA
 0x15

	)

23 
	#VK_HANGEUL
 
VK_KANA


	)

24 
	#VK_HANGUL
 0x15

	)

25 
	#VK_JUNJA
 0x17

	)

26 
	#VK_FINAL
 0x18

	)

27 
	#VK_HANJA
 0x19

	)

28 
	#VK_KANJI
 0x19

	)

29 
	#VK_ESCAPE
 0x1B

	)

30 
	#VK_CONVERT
 0x1C

	)

31 
	#VK_NONCONVERT
 0x1D

	)

32 
	#VK_ACCEPT
 0x1E

	)

33 
	#VK_MODECHANGE
 0x1F

	)

34 
	#VK_SPACE
 0x20

	)

35 
	#VK_PRIOR
 0x21

	)

36 
	#VK_NEXT
 0x22

	)

37 
	#VK_END
 0x23

	)

38 
	#VK_HOME
 0x24

	)

39 
	#VK_LEFT
 0x25

	)

40 
	#VK_UP
 0x26

	)

41 
	#VK_RIGHT
 0x27

	)

42 
	#VK_DOWN
 0x28

	)

43 
	#VK_SELECT
 0x29

	)

44 
	#VK_PRINT
 0x2A

	)

45 
	#VK_EXECUTE
 0x2B

	)

46 
	#VK_SNAPSHOT
 0x2C

	)

47 
	#VK_INSERT
 0x2D

	)

48 
	#VK_DELETE
 0x2E

	)

49 
	#VK_HELP
 0x2F

	)

54 
	#VK_LWIN
 0x5B

	)

55 
	#VK_RWIN
 0x5C

	)

56 
	#VK_APPS
 0x5D

	)

59 
	#VK_NUMPAD0
 0x60

	)

60 
	#VK_NUMPAD1
 0x61

	)

61 
	#VK_NUMPAD2
 0x62

	)

62 
	#VK_NUMPAD3
 0x63

	)

63 
	#VK_NUMPAD4
 0x64

	)

64 
	#VK_NUMPAD5
 0x65

	)

65 
	#VK_NUMPAD6
 0x66

	)

66 
	#VK_NUMPAD7
 0x67

	)

67 
	#VK_NUMPAD8
 0x68

	)

68 
	#VK_NUMPAD9
 0x69

	)

69 
	#VK_MULTIPLY
 0x6A

	)

70 
	#VK_ADD
 0x6B

	)

71 
	#VK_SEPARATOR
 0x6C

	)

72 
	#VK_SUBTRACT
 0x6D

	)

73 
	#VK_DECIMAL
 0x6E

	)

74 
	#VK_DIVIDE
 0x6F

	)

76 
	#VK_F1
 0x70

	)

77 
	#VK_F2
 0x71

	)

78 
	#VK_F3
 0x72

	)

79 
	#VK_F4
 0x73

	)

80 
	#VK_F5
 0x74

	)

81 
	#VK_F6
 0x75

	)

82 
	#VK_F7
 0x76

	)

83 
	#VK_F8
 0x77

	)

84 
	#VK_F9
 0x78

	)

85 
	#VK_F10
 0x79

	)

86 
	#VK_F11
 0x7A

	)

87 
	#VK_F12
 0x7B

	)

88 
	#VK_F13
 0x7C

	)

89 
	#VK_F14
 0x7D

	)

90 
	#VK_F15
 0x7E

	)

91 
	#VK_F16
 0x7F

	)

92 
	#VK_F17
 0x80

	)

93 
	#VK_F18
 0x81

	)

94 
	#VK_F19
 0x82

	)

95 
	#VK_F20
 0x83

	)

96 
	#VK_F21
 0x84

	)

97 
	#VK_F22
 0x85

	)

98 
	#VK_F23
 0x86

	)

99 
	#VK_F24
 0x87

	)

100 
	#VK_NUMLOCK
 0x90

	)

101 
	#VK_SCROLL
 0x91

	)

104 
	#VK_LSHIFT
 0xA0

	)

105 
	#VK_RSHIFT
 0xA1

	)

106 
	#VK_LCONTROL
 0xA2

	)

107 
	#VK_RCONTROL
 0xA3

	)

108 
	#VK_LMENU
 0xA4

	)

109 
	#VK_RMENU
 0xA5

	)

111 
	#VK_PROCESSKEY
 0xE5

	)

112 
	#VK_ATTN
 0xF6

	)

113 
	#VK_CRSEL
 0xF7

	)

114 
	#VK_EXSEL
 0xF8

	)

115 
	#VK_EREOF
 0xF9

	)

116 
	#VK_PLAY
 0xFA

	)

117 
	#VK_ZOOM
 0xFB

	)

118 
	#VK_NONAME
 0xFC

	)

119 
	#VK_PA1
 0xFD

	)

120 
	#VK_OEM_CLEAR
 0xFE

	)

123 
	#KF_EXTENDED
 0x0100

	)

124 
	#KF_DLGMODE
 0x0800

	)

125 
	#KF_MENUMODE
 0x1000

	)

126 
	#KF_ALTDOWN
 0x2000

	)

127 
	#KF_REPEAT
 0x4000

	)

128 
	#KF_UP
 0x8000

	)

	@include/wintern.h

7 
	~<°rög.h
>

9 #i‡(
UNIX
 | 
DOS_DJGPP
)

10 
	#°rcmpi
 
°rˇ£cmp


	)

11 #ñi‡(
VXWORKS
)

12 
°rcmpi
(c⁄° *
s1
, c⁄° *
s2
);

15 #ifde‡
__PACIFIC__


16 
	#°rcmpi
 
°ricmp


	)

19 
	#DBLCLICKSPEED
 750

	)

22 
	#PAINT_PAINTED
 0

	)

23 
	#PAINT_NEEDSPAINT
 1

	)

24 
	#PAINT_DELAYPAINT
 2

	)

27 
BOOL
 
MwSëDeskt›WÆÕ≠î
(
PMWIMAGEHDR
 
pImage
);

28 
MwRegi°îFdI≈ut
(
HWND
 
hwnd
,
fd
);

29 
MwUƒegi°îFdI≈ut
(
HWND
 
hwnd
,
fd
);

30 
MwRegi°îFdOuçut
(
HWND
 
hwnd
,
fd
);

31 
MwUƒegi°îFdOuçut
(
HWND
 
hwnd
,
fd
);

32 
MwRegi°îFdEx˚±
(
HWND
 
hwnd
,
fd
);

33 
MwUƒegi°îFdEx˚±
(
HWND
 
hwnd
,
fd
);

38 
PWNDCLASS
 
MwFödCœssByName
(
LPCSTR
 
ÕCœssName
);

39 
MwDe°royWödow
(
HWND
 
hwnd
,
BOOL
 
bSídMsg
);

40 
HWND
 
MwGëT›Wödow
(HWND 
hwnd
);

41 
MwCÆcClõ¡Re˘
(
HWND
 
hwnd
);

42 
MwSídSizeMove
(
HWND
 
hwnd
, 
BOOL
 
bSize
, BOOL 
bMove
);

43 
MwSëCurs‹
(
HWND
 
wp
, 
PMWCURSOR
 
pcurs‹
);

46 
	#MwIsClõ¡DC
(
hdc
Ë(((hdc)->
Êags
 & 
DCX_WINDOW
Ë=0)

	)

47 
	#MwIsMemDC
(
hdc
Ë((hdc)->
psd
->
Êags
 =
PSF_MEMORY
)

	)

48 
MwPaötNCAªa
(
HWND
 
hwnd
);

49 
HWND
 
MwPª∑ªDC
(
HDC
 
hdc
);

50 
MwSëClùWödow
(
HDC
 
hdc
);

53 
MwAdju°NCS¸ﬁlb¨s
(
HWND
 
hwnd
);

54 
MwPaötNCS¸ﬁlb¨s
(
HWND
 
hwnd
, 
HDC
 
hdc
);

55 
MwH™dÀNCMesßgeS¸ﬁlb¨
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
hôcode
,

56 
LPARAM
 
lP¨am
);

59 
MwRedøwS¸ìn
();

60 
MwHideWödow
(
HWND
 
hwnd
,
BOOL
 
bCh™geFocus
,BOOL 
bSídMsg
);

61 
MwShowWödow
(
HWND
 
hwnd
,
BOOL
 
bSídMsg
);

62 
MwRai£Wödow
(
HWND
 
hwnd
);

63 
MwLowîWödow
(
HWND
 
hwnd
);

64 
BOOL
 
MwCheckOvîœp
(
HWND
 
t›wp
, HWND 
bŸwp
);

65 
MwCÀ¨Wödow
(
HWND
 
wp
,
MWCOORD
 
x
,MWCOORD 
y
,MWCOORD 
width
,

66 
MWCOORD
 
height
,
BOOL
 
expo£Êag
);

67 
MwExpo£Aªa
(
HWND
 
wp
, 
MWCOORD
 
roŸx
,MWCOORD 
roŸy
,

68 
MWCOORD
 
width
,MWCOORD 
height
);

70 
BOOL
 
MwCheckMou£Evít
();

71 
BOOL
 
MwCheckKeybﬂrdEvít
();

72 
MwH™dÀMou£Sètus
(
MWCOORD
 
√wx
, MWCOORD 
√wy
, 
√wbuâ⁄s
);

73 
MwTøn¶©eMou£Mesßge
(
HWND
 
hwnd
,
UINT
 
msg
,
hôã°
);

74 
MwDñivîMou£Evít
(
buâ⁄s
, 
ch™gebuâ⁄s
,

75 
MWKEYMOD
 
modifõrs
);

76 
MwDñivîKeybﬂrdEvít
(
MWKEY
 
keyvÆue
, 
MWKEYMOD
 
modifõrs
,

77 
MWSCANCODE
 
sˇncode
, 
BOOL
 
¥es£d
);

78 
MwDñivîExposuªEvít
(
HWND
 
wp
, 
MWCOORD
 
x
, MWCOORD 
y
,

79 
MWCOORD
 
width
,MWCOORD 
height
);

80 
MwUni⁄Upd©eRegi⁄
(
HWND
 
wp
, 
MWCOORD
 
x
, MWCOORD 
y
,

81 
MWCOORD
 
width
,MWCOORD 
height
, 
BOOL
 
bUni⁄
);

82 
MwMoveCurs‹
(
MWCOORD
 
x
, MWCOORD 
y
);

83 
MwCheckCurs‹
();

84 
HWND
 
MwFödVisibÀWödow
(
MWCOORD
 
x
, MWCOORD 
y
);

85 
MwCheckMou£Wödow
();

86 
°rz˝y
(*
d°
,c⁄° *
§c
,
d°siz
);

89 
mwSYSMETRICS_CYCAPTION
;

90 
mwSYSMETRICS_CXBORDER
;

91 
mwSYSMETRICS_CYBORDER
;

92 
mwSYSMETRICS_CXFRAME
;

93 
mwSYSMETRICS_CYFRAME
;

94 
mwSYSMETRICS_CXDOUBLECLK
;

95 
mwSYSMETRICS_CYDOUBLECLK
;

96 
mwSYSMETRICS_CYHSCROLL
;

97 
mwSYSMETRICS_CXHSCROLL
;

98 
mwSYSMETRICS_CXVSCROLL
;

99 
mwSYSMETRICS_CYVSCROLL
;

102 
BOOL
 
mwERASEMOVE
;

105 
MwO≥n
();

106 
MwClo£
();

107 
MwSñe˘
();

108 
MwInôülize
();

109 
MwTîmö©e
();

110 
HWND
 
li°wp
;

111 
HWND
 
roŸwp
;

112 
HWND
 
focuswp
;

113 
HWND
 
mou£wp
;

114 
HWND
 
ˇ±uªwp
;

115 
HWND
 
døgwp
;

116 
HCURSOR
 
curcurs‹
;

117 
MWCOORD
 
curs‹x
;

118 
MWCOORD
 
curs‹y
;

119 
MWSCREENINFO
 
söfo
;

120 
DWORD
 
°¨tTicks
;

121 
mw∑ötNC
;

122 
BOOL
 
mwf‹˚NC∑öt
;

124 #i‡
VTSWITCH


128 
MwInôVt
();

129 
MwCuºítVt
();

130 
MwCheckVtCh™ge
();

131 
MwRedøwVt
(
t
);

132 
MwExôVt
();

133 
mwvãrm
;

	@include/wintools.h

15 
WINAPI
 
Døw3dShadow
(
HDC
 
hDC
,
x
,
y
,
w
,
h
,
COLORREF
 
¸T›
,

16 
COLORREF
 
¸BŸtom
);

17 
WINAPI
 
Døw3dBox
(
HDC
 
hDC
,
x
,
y
,
w
,
h
,
COLORREF
 
¸T›
,

18 
COLORREF
 
¸BŸtom
);

19 
WINAPI
 
Døw3dIn£t
(
HDC
 
hDC
,
x
,
y
,
w
,
h
);

20 
WINAPI
 
Døw3dOut£t
(
HDC
 
hDC
,
x
,
y
,
w
,
h
);

21 
WINAPI
 
Døw3dPushDown
(
HDC
 
hDC
, 
x
, 
y
, 
w
, 
h
);

22 
WINAPI
 
Døw3dUpDownSèã
(
HDC
 
hDC
, 
x
, 
y
, 
w
, 
h
,

23 
BOOL
 
fDown
);

24 
WINAPI
 
Døw3dUpFøme
(
HDC
 
hDC
, 
l
, 
t
, 
r
, 
b
);

25 
WINAPI
 
Fa°FûlRe˘
(
HDC
 
hdc
,
LPRECT
 
Õª˘
,
COLORREF
 
¸
);

26 
WINAPI
 
In£tR
(
LPRECT
 
Õrc
,
h
,
v
);

27 
BOOL
 
WINAPI
 
PtInsideWödow
(
HWND
 
hwnd
,
UINT
 
x
,UINT 
y
);

	@include/winuser.h

7 
	~"wö˘l.h
"

10 
	$LRESULT
 (
	tCALLBACK
* 
	tWNDPROC
)(
	tHWND
, 
	tUINT
, 
	tWPARAM
, 
	tLPARAM
);

11 
	$LRESULT
 (
	tCALLBACK
* 
	tDLGPROC
)(
	tHWND
, 
	tUINT
, 
	tWPARAM
, 
	tLPARAM
);

14 
LRESULT
 
WINAPI
 
	`DefWödowProc
(
HWND
 
hwnd
,
UINT
 
msg
,
WPARAM
 
wP¨am
,
LPARAM
 
lP¨am
);

17 
	#CS_VREDRAW
 0x0001

	)

18 
	#CS_HREDRAW
 0x0002

	)

19 
	#CS_DBLCLKS
 0x0008

	)

20 
	#CS_OWNDC
 0x0020

	)

21 
	#CS_CLASSDC
 0x0040

	)

22 
	#CS_PARENTDC
 0x0080

	)

23 
	#CS_NOCLOSE
 0x0200

	)

24 
	#CS_SAVEBITS
 0x0800

	)

25 
	#CS_BYTEALIGNCLIENT
 0x1000

	)

26 
	#CS_BYTEALIGNWINDOW
 0x2000

	)

27 
	#CS_GLOBALCLASS
 0x4000

	)

29 
	sègWNDCLASSA
 {

30 
MWLIST
 
lök
;

31 
UINT
 
°yÀ
;

32 
WNDPROC
 
Õ‚WndProc
;

33 
cbClsExåa
;

34 
cbWndExåa
;

35 
HINSTANCE
 
hIn°™˚
;

36 
HICON
 
hIc⁄
;

37 
HCURSOR
 
hCurs‹
;

38 
HBRUSH
 
hbrBackground
;

39 
LPCSTR
 
ÕszMíuName
;

40 
LPCSTR
 
ÕszCœssName
;

41 
CHAR
 
szCœssName
[40];

42 } 
	tWNDCLASS
, *
	tPWNDCLASS
, 
	tNEAR
 *
	tNPWNDCLASS
, 
	tFAR
 *
	tLPWNDCLASS
;

44 
ATOM
 
WINAPI
 
	`Regi°îCœss
(
CONST
 
WNDCLASS
 *
ÕWndCœss
);

49 
	sègMSG
 {

50 
MWLIST
 
lök
;

51 
HWND
 
hwnd
;

52 
UINT
 
mesßge
;

53 
WPARAM
 
wP¨am
;

54 
LPARAM
 
lP¨am
;

55 
DWORD
 
time
;

56 
POINT
 
±
;

57 } 
	tMSG
, *
	tPMSG
, 
	tNEAR
 *
	tNPMSG
, 
	tFAR
 *
	tLPMSG
;

59 
	#POINTSTOPOINT
(
±
, 
±s
) \

60 { (
±
).
x
 = (
LONG
)(
SHORT
)
	`LOWORD
(*(LONG*)&
±s
); \

61 (
±
).
y
 = (
LONG
)(
SHORT
)
	`HIWORD
(*(LONG*)&
±s
); 
	}

	)
}

63 
	#POINTTOPOINTS
(
±
Ë(
	`MAKELONG
(()(’t).
x
), ()(’t).
y
)))

	)

64 
	#MAKEWPARAM
(
l
, 
h
Ë(
WPARAM
)
	`MAKELONG
÷, h)

	)

65 
	#MAKELPARAM
(
l
, 
h
Ë(
LPARAM
)
	`MAKELONG
÷, h)

	)

66 
	#MAKELRESULT
(
l
, 
h
Ë(
LRESULT
)
	`MAKELONG
÷, h)

	)

69 
	#WM_NULL
 0x0000

	)

70 
	#WM_CREATE
 0x0001

	)

71 
	#WM_DESTROY
 0x0002

	)

72 
	#WM_MOVE
 0x0003

	)

73 
	#WM_SIZE
 0x0005

	)

74 
	#WM_ACTIVATE
 0x0006

	)

75 
	#WM_SETFOCUS
 0x0007

	)

76 
	#WM_KILLFOCUS
 0x0008

	)

77 
	#WM_ENABLE
 0x000A

	)

78 
	#WM_SETTEXT
 0x000C

	)

79 
	#WM_GETTEXT
 0x000D

	)

80 
	#WM_GETTEXTLENGTH
 0x000E

	)

81 
	#WM_PAINT
 0x000F

	)

82 
	#WM_CLOSE
 0x0010

	)

83 
	#WM_QUIT
 0x0012

	)

84 
	#WM_ERASEBKGND
 0x0014

	)

85 
	#WM_SHOWWINDOW
 0x0018

	)

86 
	#WM_SETFONT
 0x0030

	)

87 
	#WM_GETFONT
 0x0031

	)

88 
	#WM_WINDOWPOSCHANGED
 0x0047

	)

89 
	#WM_NCCALCSIZE
 0x0083

	)

90 
	#WM_NCHITTEST
 0x0084

	)

91 
	#WM_NCPAINT
 0x0085

	)

92 
	#WM_GETDLGCODE
 0x0087

	)

93 
	#WM_NCMOUSEMOVE
 0x00A0

	)

94 
	#WM_NCLBUTTONDOWN
 0x00A1

	)

95 
	#WM_NCLBUTTONUP
 0x00A2

	)

96 
	#WM_NCLBUTTONDBLCLK
 0x00A3

	)

97 
	#WM_NCRBUTTONDOWN
 0x00A4

	)

98 
	#WM_NCRBUTTONUP
 0x00A5

	)

99 
	#WM_NCRBUTTONDBLCLK
 0x00A6

	)

100 
	#WM_KEYFIRST
 0x0100

	)

101 
	#WM_KEYDOWN
 0x0100

	)

102 
	#WM_KEYUP
 0x0101

	)

103 
	#WM_CHAR
 0x0102

	)

104 
	#WM_DEADCHAR
 0x0103

	)

105 
	#WM_SYSKEYDOWN
 0x0104

	)

106 
	#WM_SYSKEYUP
 0x0105

	)

107 
	#WM_SYSCHAR
 0x0106

	)

108 
	#WM_SYSDEADCHAR
 0x0107

	)

109 
	#WM_KEYLAST
 0x0108

	)

110 
	#WM_COMMAND
 0x0111

	)

111 
	#WM_TIMER
 0x0113

	)

112 
	#WM_HSCROLL
 0x0114

	)

113 
	#WM_VSCROLL
 0x0115

	)

115 
	#WM_MOUSEFIRST
 0x0200

	)

116 
	#WM_MOUSEMOVE
 0x0200

	)

117 
	#WM_LBUTTONDOWN
 0x0201

	)

118 
	#WM_LBUTTONUP
 0x0202

	)

119 
	#WM_LBUTTONDBLCLK
 0x0203

	)

120 
	#WM_RBUTTONDOWN
 0x0204

	)

121 
	#WM_RBUTTONUP
 0x0205

	)

122 
	#WM_RBUTTONDBLCLK
 0x0206

	)

123 
	#WM_MBUTTONDOWN
 0x0207

	)

124 
	#WM_MBUTTONUP
 0x0208

	)

125 
	#WM_MBUTTONDBLCLK
 0x0209

	)

126 
	#WM_MOUSEWHEEL
 0x020A

	)

127 
	#WM_MOUSELAST
 0x020A

	)

129 
	#WM_CARET_CREATE
 0x03E0

	)

130 
	#WM_CARET_DESTROY
 0x03E1

	)

131 
	#WM_CARET_BLINK
 0x03E2

	)

132 
	#WM_FDINPUT
 0x03F0

	)

133 
	#WM_FDOUTPUT
 0x03F1

	)

134 
	#WM_FDEXCEPT
 0x03F2

	)

135 
	#WM_USER
 0x0400

	)

138 
	#WA_INACTIVE
 0

	)

139 
	#WA_ACTIVE
 1

	)

140 
	#WA_CLICKACTIVE
 2

	)

143 
	#HTERROR
 (-2)

	)

144 
	#HTTRANSPARENT
 (-1)

	)

145 
	#HTNOWHERE
 0

	)

146 
	#HTCLIENT
 1

	)

147 
	#HTCAPTION
 2

	)

148 
	#HTSYSMENU
 3

	)

149 
	#HTGROWBOX
 4

	)

150 
	#HTSIZE
 
HTGROWBOX


	)

151 
	#HTMENU
 5

	)

152 
	#HTHSCROLL
 6

	)

153 
	#HTVSCROLL
 7

	)

154 
	#HTMINBUTTON
 8

	)

155 
	#HTMAXBUTTON
 9

	)

156 
	#HTLEFT
 10

	)

157 
	#HTRIGHT
 11

	)

158 
	#HTTOP
 12

	)

159 
	#HTTOPLEFT
 13

	)

160 
	#HTTOPRIGHT
 14

	)

161 
	#HTBOTTOM
 15

	)

162 
	#HTBOTTOMLEFT
 16

	)

163 
	#HTBOTTOMRIGHT
 17

	)

164 
	#HTBORDER
 18

	)

165 
	#HTREDUCE
 
HTMINBUTTON


	)

166 
	#HTZOOM
 
HTMAXBUTTON


	)

167 
	#HTSIZEFIRST
 
HTLEFT


	)

168 
	#HTSIZELAST
 
HTBOTTOMRIGHT


	)

169 
	#HTOBJECT
 19

	)

170 
	#HTCLOSE
 20

	)

171 
	#HTHELP
 21

	)

174 
	#SIZE_RESTORED
 0

	)

175 
	#SIZE_MINIMIZED
 1

	)

176 
	#SIZE_MAXIMIZED
 2

	)

177 
	#SIZE_MAXSHOW
 3

	)

178 
	#SIZE_MAXHIDE
 4

	)

180 
LRESULT
 
WINAPI
 
CÆlWödowProc
(
WNDPROC
 
ÕPªvWndFunc
, 
HWND
 
hwnd
, 
UINT
 
Msg
,

181 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

182 
LRESULT
 
WINAPI
 
SídMesßge
(
HWND
 
hwnd
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

183 
BOOL
 
WINAPI
 
Po°Mesßge
(
HWND
 
hwnd
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

184 
BOOL
 
WINAPI
 
Po°ThªadMesßge
(
DWORD
 
dwThªadId
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
,

185 
LPARAM
 
lP¨am
);

186 
VOID
 
WINAPI
 
Po°QuôMesßge
(
nExôCode
);

189 
	#PM_NOREMOVE
 0x0000

	)

190 
	#PM_REMOVE
 0x0001

	)

191 
	#PM_NOYIELD
 0x0002

	)

193 
BOOL
 
WINAPI
 
PìkMesßge
(
LPMSG
 
ÕMsg
, 
HWND
 
hwnd
, 
UINT
 
uMsgFûãrMö
,

194 
UINT
 
uMsgFûãrMax
, UINT 
wRemoveMsg
);

195 
BOOL
 
WINAPI
 
GëMesßge
(
LPMSG
 
ÕMsg
,
HWND
 
hwnd
,
UINT
 
wMsgFûãrMö
,

196 
UINT
 
wMsgFûãrMax
);

197 
BOOL
 
WINAPI
 
Tøn¶©eMesßge
(
CONST
 
MSG
 *
ÕMsg
);

198 
LONG
 
WINAPI
 
Di•©chMesßge
(
CONST
 
MSG
 *
ÕMsg
);

203 
	sègCREATESTRUCT
 {

204 
DWORD
 
	mdwExStyÀ
;

205 
LPCSTR
 
	mÕszCœss
;

206 
LPCSTR
 
	mÕszName
;

207 
LONG
 
	m°yÀ
;

208 
	mx
;

209 
	my
;

210 
	mcx
;

211 
	mcy
;

212 
HWND
 
	mhwndP¨ít
;

213 
HMENU
 
	mhMíu
;

214 
HINSTANCE
 
	mhIn°™˚
;

215 
LPVOID
 
	mÕCª©eP¨ams
;

216 } 
	tCREATESTRUCT
, *
	tLPCREATESTRUCT
;

221 
	#WS_OVERLAPPED
 0x00000000L

	)

222 
	#WS_POPUP
 0x80000000L

	)

223 
	#WS_CHILD
 0x40000000L

	)

224 
	#WS_MINIMIZE
 0x20000000L

	)

225 
	#WS_VISIBLE
 0x10000000L

	)

226 
	#WS_DISABLED
 0x08000000L

	)

227 
	#WS_CLIPSIBLINGS
 0x04000000L

	)

228 
	#WS_CLIPCHILDREN
 0x02000000L

	)

229 
	#WS_MAXIMIZE
 0x01000000L

	)

230 
	#WS_CAPTION
 0x00C00000L

	)

231 
	#WS_BORDER
 0x00800000L

	)

232 
	#WS_DLGFRAME
 0x00400000L

	)

233 
	#WS_VSCROLL
 0x00200000L

	)

234 
	#WS_HSCROLL
 0x00100000L

	)

235 
	#WS_SYSMENU
 0x00080000L

	)

236 
	#WS_THICKFRAME
 0x00040000L

	)

237 
	#WS_GROUP
 0x00020000L

	)

238 
	#WS_TABSTOP
 0x00010000L

	)

240 
	#WS_MINIMIZEBOX
 0x00020000L

	)

241 
	#WS_MAXIMIZEBOX
 0x00010000L

	)

244 
	#WS_TILED
 
WS_OVERLAPPED


	)

245 
	#WS_ICONIC
 
WS_MINIMIZE


	)

246 
	#WS_SIZEBOX
 
WS_THICKFRAME


	)

247 
	#WS_TILEDWINDOW
 
WS_OVERLAPPEDWINDOW


	)

252 
	#WS_OVERLAPPEDWINDOW
 (
WS_OVERLAPPED
 | \

253 
WS_CAPTION
 | \

254 
WS_SYSMENU
 | \

255 
WS_THICKFRAME
 | \

256 
WS_MINIMIZEBOX
 | \

257 
WS_MAXIMIZEBOX
)

	)

259 
	#WS_POPUPWINDOW
 (
WS_POPUP
 | \

260 
WS_BORDER
 | \

261 
WS_SYSMENU
)

	)

263 
	#WS_CHILDWINDOW
 (
WS_CHILD
)

	)

268 
	#WS_EX_DLGMODALFRAME
 0x00000001L

	)

269 
	#WS_EX_NOPARENTNOTIFY
 0x00000004L

	)

270 
	#WS_EX_TOPMOST
 0x00000008L

	)

271 
	#WS_EX_ACCEPTFILES
 0x00000010L

	)

272 
	#WS_EX_TRANSPARENT
 0x00000020L

	)

273 
	#WS_EX_MDICHILD
 0x00000040L

	)

274 
	#WS_EX_TOOLWINDOW
 0x00000080L

	)

275 
	#WS_EX_WINDOWEDGE
 0x00000100L

	)

276 
	#WS_EX_CLIENTEDGE
 0x00000200L

	)

277 
	#WS_EX_CONTEXTHELP
 0x00000400L

	)

279 
	#WS_EX_RIGHT
 0x00001000L

	)

280 
	#WS_EX_LEFT
 0x00000000L

	)

281 
	#WS_EX_RTLREADING
 0x00002000L

	)

282 
	#WS_EX_LTRREADING
 0x00000000L

	)

283 
	#WS_EX_LEFTSCROLLBAR
 0x00004000L

	)

284 
	#WS_EX_RIGHTSCROLLBAR
 0x00000000L

	)

286 
	#WS_EX_CONTROLPARENT
 0x00010000L

	)

287 
	#WS_EX_STATICEDGE
 0x00020000L

	)

288 
	#WS_EX_APPWINDOW
 0x00040000L

	)

289 
	#WS_EX_LAYERED
 0x00080000L

	)

291 
	#WS_EX_OVERLAPPEDWINDOW
 (
WS_EX_WINDOWEDGE
 | 
WS_EX_CLIENTEDGE
)

	)

292 
	#WS_EX_PALETTEWINDOW
 (
WS_EX_WINDOWEDGE
 | 
WS_EX_TOOLWINDOW
 | 
WS_EX_TOPMOST
)

	)

294 
	#CW_USEDEFAULT
 (()0x80000000)

	)

296 
	#HWND_DESKTOP
 ((
HWND
)0)

	)

298 
	#Cª©eWödow
(
ÕCœssName
, 
ÕWödowName
, 
dwStyÀ
, 
x
, 
y
, 
nWidth
, 
nHeight
, 
hwndP¨ít
, 
hMíu
, 
hIn°™˚
, 
ÕP¨am
)\

299 
	`Cª©eWödowEx
(0L, 
ÕCœssName
, 
ÕWödowName
, 
dwStyÀ
, 
x
, 
y
,\

300 
nWidth
, 
nHeight
, 
hwndP¨ít
, 
hMíu
, 
hIn°™˚
, 
ÕP¨am
)

	)

302 
HWND
 
WINAPI
 
Cª©eWödowEx
(
DWORD
 
dwExStyÀ
, 
LPCSTR
 
ÕCœssName
,

303 
LPCSTR
 
ÕWödowName
, 
DWORD
 
dwStyÀ
, 
X
, 
Y
,

304 
nWidth
, 
nHeight
, 
HWND
 
hwndP¨ít
, 
HMENU
 
hMíu
,

305 
HINSTANCE
 
hIn°™˚
, 
LPVOID
 
ÕP¨am
);

306 
BOOL
 
WINAPI
 
De°royWödow
(
HWND
 
hwnd
);

307 
BOOL
 
WINAPI
 
IsWödow
(
HWND
 
hwnd
);

308 
	#IsWödowVisibÀ
(
hwnd
Ë((
BOOL
)((hwnd)->
unm≠cou¡
 =0))

	)

313 
	#SW_HIDE
 0

	)

314 
	#SW_SHOWNORMAL
 1

	)

315 
	#SW_NORMAL
 1

	)

316 
	#SW_SHOWMINIMIZED
 2

	)

317 
	#SW_SHOWMAXIMIZED
 3

	)

318 
	#SW_MAXIMIZE
 3

	)

319 
	#SW_SHOWNOACTIVATE
 4

	)

320 
	#SW_SHOW
 5

	)

321 
	#SW_MINIMIZE
 6

	)

322 
	#SW_SHOWMINNOACTIVE
 7

	)

323 
	#SW_SHOWNA
 8

	)

324 
	#SW_RESTORE
 9

	)

325 
	#SW_SHOWDEFAULT
 10

	)

326 
	#SW_FORCEMINIMIZE
 11

	)

327 
	#SW_MAX
 11

	)

329 
BOOL
 
WINAPI
 
ShowWödow
(
HWND
 
hwnd
, 
nCmdShow
);

330 
BOOL
 
WINAPI
 
InvÆid©eRe˘
(
HWND
 
hwnd
, 
CONST
 
RECT
 *
ÕRe˘
, BOOL 
bEø£
);

331 
BOOL
 
WINAPI
 
InvÆid©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
, BOOL 
bEø£
);

332 
BOOL
 
WINAPI
 
VÆid©eRe˘
(
HWND
 
hwnd
, 
CONST
 
RECT
 *
Õrc
);

333 
BOOL
 
WINAPI
 
VÆid©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
);

334 
BOOL
 
WINAPI
 
Upd©eWödow
(
HWND
 
hwnd
);

336 
BOOL
 
WINAPI
 
SëLayîedWödowAâribuãs
(
HWND
 
hwnd
, 
COLORREF
 
¸Key
,

337 
BYTE
 
bAÕha
, 
DWORD
 
dwFœgs
);

338 
	#LWA_COLORKEY
 0x00000001

	)

339 
	#LWA_ALPHA
 0x00000002

	)

341 
HWND
 
WINAPI
 
GëFocus
(
VOID
);

342 
HWND
 
WINAPI
 
SëFocus
(HWND 
hwnd
);

343 
BOOL
 
WINAPI
 
SëF‹egroundWödow
(
HWND
 
hwnd
);

344 
HWND
 
WINAPI
 
SëA˘iveWödow
(HWND 
hwnd
);

345 
HWND
 
WINAPI
 
GëA˘iveWödow
(
VOID
);

346 
BOOL
 
WINAPI
 
BrögWödowToT›
(
HWND
 
hwnd
);

347 
HWND
 
WINAPI
 
GëDeskt›Wödow
(
VOID
);

348 
HWND
 
WINAPI
 
GëP¨ít
(HWND 
hwnd
);

349 
BOOL
 
WINAPI
 
E«bÀWödow
(
HWND
 
hwnd
, BOOL 
bE«bÀ
);

350 
	#IsWödowE«bÀd
(
hwnd
Ë((
BOOL
)(((hwnd)->
°yÀ
&
WS_DISABLED
Ë=0))

	)

352 
BOOL
 
WINAPI
 
Adju°WödowRe˘Ex
(
LPRECT
 
ÕRe˘
, 
DWORD
 
dwStyÀ
, BOOL 
bMíu
,

353 
DWORD
 
dwExStyÀ
);

354 
BOOL
 
WINAPI
 
GëClõ¡Re˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
);

355 
BOOL
 
WINAPI
 
GëWödowRe˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
);

357 
BOOL
 
WINAPI
 
Clõ¡ToS¸ìn
(
HWND
 
hwnd
, 
LPPOINT
 
ÕPoöt
);

358 
BOOL
 
WINAPI
 
S¸ìnToClõ¡
(
HWND
 
hwnd
, 
LPPOINT
 
ÕPoöt
);

359 
WINAPI
 
M≠WödowPoöts
(
HWND
 
hwndFrom
, HWND 
hwndTo
, 
LPPOINT
 
ÕPoöts
,

360 
UINT
 
cPoöts
);

362 
BOOL
 
WINAPI
 
SëRe˘
(
LPRECT
 
Õrc
,
xLe·
,
yT›
,
xRight
,
yBŸtom
);

363 
BOOL
 
WINAPI
 
SëRe˘Em±y
(
LPRECT
 
Õrc
);

364 
BOOL
 
WINAPI
 
C›yRe˘
(
LPRECT
 
ÕrcD°
, 
CONST
 
RECT
 *
ÕrcSrc
);

365 
BOOL
 
WINAPI
 
IsRe˘Em±y
(
CONST
 
RECT
 *
Õrc
);

366 
BOOL
 
WINAPI
 
InÊ©eRe˘
(
LPRECT
 
Õrc
, 
dx
, 
dy
);

367 
BOOL
 
WINAPI
 
Off£tRe˘
(
LPRECT
 
Õrc
, 
dx
, 
dy
);

369 #i‡
ELKS


370 
	#PtInRe˘
(
Õrc
,
±
Ë
	`MwPTINRECT
÷¥c, *(*)&’t))

	)

372 
	#PtInRe˘
(
Õrc
,
±
Ë
	`MwPTINRECT
÷¥c,Öt)

	)

374 
BOOL
 
WINAPI
 
MwPTINRECT
(
CONST
 
RECT
 *
Õrc
, 
POINT
 
±
);

379 
	#GWL_WNDPROC
 (-4)

	)

380 
	#GWL_HINSTANCE
 (-6)

	)

381 
	#GWL_HWNDPARENT
 (-8)

	)

382 
	#GWL_STYLE
 (-16)

	)

383 
	#GWL_EXSTYLE
 (-20)

	)

384 
	#GWL_USERDATA
 (-21)

	)

385 
	#GWL_ID
 (-12)

	)

390 
	#GCL_MENUNAME
 (-8)

	)

391 
	#GCL_HBRBACKGROUND
 (-10)

	)

392 
	#GCL_HCURSOR
 (-12)

	)

393 
	#GCL_HICON
 (-14)

	)

394 
	#GCL_HMODULE
 (-16)

	)

395 
	#GCL_CBWNDEXTRA
 (-18)

	)

396 
	#GCL_CBCLSEXTRA
 (-20)

	)

397 
	#GCL_WNDPROC
 (-24)

	)

398 
	#GCL_STYLE
 (-26)

	)

399 
	#GCW_ATOM
 (-32)

	)

400 
	#GCL_HICONSM
 (-34)

	)

402 
LONG
 
WINAPI
 
GëWödowL⁄g
(
HWND
 
hwnd
, 
nIndex
);

403 
LONG
 
WINAPI
 
SëWödowL⁄g
(
HWND
 
hwnd
, 
nIndex
, LONG 
lNewL⁄g
);

404 
WORD
 
WINAPI
 
GëWödowW‹d
(
HWND
 
hwnd
, 
nIndex
);

405 
WORD
 
WINAPI
 
SëWödowW‹d
(
HWND
 
hwnd
, 
nIndex
, WORD 
wNewW‹d
);

406 
	#GëDlgCålID
(
hwnd
Ë(()(hwnd)->
id
)

	)

407 
DWORD
 
WINAPI
 
GëCœssL⁄g
(
HWND
 
hwnd
, 
nIndex
);

408 
WINAPI
 
GëWödowTextLígth
(
HWND
 
hwnd
);

409 
WINAPI
 
GëWödowText
(
HWND
 
hwnd
, 
LPSTR
 
ÕSåög
, 
nMaxCou¡
);

410 
BOOL
 
WINAPI
 
SëWödowText
(
HWND
 
hwnd
, 
LPCSTR
 
ÕSåög
);

412 
BOOL
 
WINAPI
 
MoveWödow
(
HWND
 
hwnd
, 
x
, 
y
, 
nWidth
, 
nHeight
,

413 
BOOL
 
bRïaöt
);

416 
	#SWP_NOSIZE
 0x0001

	)

417 
	#SWP_NOMOVE
 0x0002

	)

418 
	#SWP_NOZORDER
 0x0004

	)

419 
	#SWP_NOREDRAW
 0x0008

	)

420 
	#SWP_NOACTIVATE
 0x0010

	)

421 
	#SWP_FRAMECHANGED
 0x0020

	)

422 
	#SWP_SHOWWINDOW
 0x0040

	)

423 
	#SWP_HIDEWINDOW
 0x0080

	)

424 
	#SWP_NOCOPYBITS
 0x0100

	)

425 
	#SWP_NOOWNERZORDER
 0x0200

	)

426 
	#SWP_NOSENDCHANGING
 0x0400

	)

427 
	#SWP_DRAWFRAME
 
SWP_FRAMECHANGED


	)

428 
	#SWP_NOREPOSITION
 
SWP_NOOWNERZORDER


	)

429 
	#SWP_DEFERERASE
 0x2000

	)

430 
	#SWP_ASYNCWINDOWPOS
 0x4000

	)

432 
	#HWND_TOP
 ((
HWND
)0Ë

	)

433 
	#HWND_BOTTOM
 ((
HWND
)1Ë

	)

434 
	#HWND_TOPMOST
 ((
HWND
)-1Ë

	)

435 
	#HWND_NOTOPMOST
 ((
HWND
)-2Ë

	)

438 
	sègWINDOWPOS
 {

439 
HWND
 
	mhwnd
;

440 
HWND
 
	mhwndIn£πA·î
;

441 
	mx
;

442 
	my
;

443 
	mcx
;

444 
	mcy
;

445 
UINT
 
	mÊags
;

446 } 
	tWINDOWPOS
, *
	tLPWINDOWPOS
, *
	tPWINDOWPOS
;

448 
BOOL
 
WINAPI
 
SëWödowPos
(
HWND
 
hwnd
, HWND 
hwndIn£πA·î
, 
x
, 
y
,

449 
cx
, 
cy
, 
UINT
 
fuFœgs
);

451 
BOOL
 
WINAPI
 
GëCurs‹Pos
(
LPPOINT
 
ÕPoöt
);

452 
HWND
 
WINAPI
 
GëC≠tuª
(
VOID
);

453 
HWND
 
WINAPI
 
SëC≠tuª
(HWND 
hwnd
);

454 
BOOL
 
WINAPI
 
Rñó£C≠tuª
(
VOID
);

459 
	sègNCCALCSIZE_PARAMS
 {

460 
RECT
 
	mrgrc
[3];

462 } 
	tNCCALCSIZE_PARAMS
, *
	tLPNCCALCSIZE_PARAMS
;

464 
FARPROC
 
	tTIMERPROC
;

466 
UINT
 
WINAPI
 
SëTimî
(
HWND
 
hwnd
, UINT 
idTimî
, UINT 
uTimeout
,

467 
TIMERPROC
 
ÕTimîFunc
);

468 
BOOL
 
WINAPI
 
KûlTimî
(
HWND
 
hwnd
, 
UINT
 
idTimî
);

469 
UINT
 
MwGëNextTimeoutVÆue
();

470 
MwH™dÀTimîs
();

473 
	#SM_CXSCREEN
 0

	)

474 
	#SM_CYSCREEN
 1

	)

475 
	#SM_CXVSCROLL
 2

	)

476 
	#SM_CYHSCROLL
 3

	)

477 
	#SM_CYCAPTION
 4

	)

478 
	#SM_CXBORDER
 5

	)

479 
	#SM_CYBORDER
 6

	)

480 
	#SM_CXDLGFRAME
 7

	)

481 
	#SM_CYDLGFRAME
 8

	)

482 
	#SM_CXFIXEDFRAME
 
SM_CXDLGFRAME


	)

483 
	#SM_CYFIXEDFRAME
 
SM_CYDLGFRAME


	)

484 
	#SM_CYMENU
 15

	)

485 
	#SM_CYVSCROLL
 20

	)

486 
	#SM_CXHSCROLL
 21

	)

487 
	#SM_CXFRAME
 32

	)

488 
	#SM_CYFRAME
 33

	)

489 
	#SM_CXSIZEFRAME
 
SM_CXFRAME


	)

490 
	#SM_CYSIZEFRAME
 
SM_CYFRAME


	)

492 
WINAPI
 
GëSy°emMërics
(
nIndex
);

494 
HWND
 
WINAPI
 
GëDlgIãm
(HWND 
hDlg
, 
nIDDlgIãm
);

497 
BOOL
 
WINAPI
 
Cª©eC¨ë
(
HWND
 
hwnd
, 
HBITMAP
 
hBôm≠
, 
nWidth
, 
nHeight
);

498 
BOOL
 
WINAPI
 
De°royC¨ë
(
VOID
);

499 
BOOL
 
WINAPI
 
HideC¨ë
 (
HWND
 
hwnd
);

500 
BOOL
 
WINAPI
 
ShowC¨ë
(
HWND
 
hwnd
);

501 
BOOL
 
WINAPI
 
SëC¨ëPos
(
nX
, 
nY
);

502 
BOOL
 
WINAPI
 
GëC¨ëPos
(
LPPOINT
 
ÕPoöt
);

503 
UINT
 
WINAPI
 
GëC¨ëBlökTime
(
VOID
);

504 
BOOL
 
WINAPI
 
SëC¨ëBlökTime
(
UINT
 
uMSec⁄ds
);

	@mwin/bmp/convbmp.c

11 
	~<°dio.h
>

12 
	~<°rög.h
>

13 
	~<°dlib.h
>

14 
	~"../../ö˛ude/devi˚.h
"

17 
	#OS_FILE_SEPARATOR
 "/\\"

	)

19 
	#PIX2BYTES
(
n
Ë((“)+7)/8)

	)

21 
	#BI_RGB
 0L

	)

22 
	#BI_RLE8
 1L

	)

23 
	#BI_RLE4
 2L

	)

24 
	#BI_BITFIELDS
 3L

	)

26 
	tUCHAR
;

27 
	tBYTE
;

38 
	tWORD
[2];

39 
	tDWORD
[4];

40 
	tLONG
[4];

41 
	#READWORD
(
x
) ( (()(x)[0]) | \

42 ((()(
x
)[1]Ë<< 8Ë)

	)

43 
	#READDWORD
(
x
) ( (()(x)[0]) | \

44 ((()(
x
)[1]) << 8) | \

45 ((()(
x
)[2]) << 16) | \

46 ((()(
x
)[3]Ë<< 24Ë)

	)

47 
	#READLONG
(
x
Ë(()
	`READDWORD
(x))

	)

49 #¥agm®
∑ck
(1)

53 
BYTE
 
	mbfTy≥
[2];

54 
DWORD
 
	mbfSize
;

55 
WORD
 
	mbfRe£rved1
;

56 
WORD
 
	mbfRe£rved2
;

57 
DWORD
 
	mbfOffBôs
;

59 
DWORD
 
	mBiSize
;

60 
LONG
 
	mBiWidth
;

61 
LONG
 
	mBiHeight
;

62 
WORD
 
	mBiPœ√s
;

63 
WORD
 
	mBiBôCou¡
;

64 
DWORD
 
	mBiCom¥essi⁄
;

65 
DWORD
 
	mBiSizeImage
;

66 
LONG
 
	mBiX≥lsPîMëî
;

67 
LONG
 
	mBiY≥lsPîMëî
;

68 
DWORD
 
	mBiCÃU£d
;

69 
DWORD
 
	mBiCÃImp‹è¡
;

70 } 
	tBMPHEAD
;

75 
BYTE
 
	mbfTy≥
[2];

76 
DWORD
 
	mbfSize
;

77 
WORD
 
	mbfRe£rved1
;

78 
WORD
 
	mbfRe£rved2
;

79 
DWORD
 
	mbfOffBôs
;

81 
DWORD
 
	mbcSize
;

82 
WORD
 
	mbcWidth
;

83 
WORD
 
	mbcHeight
;

84 
WORD
 
	mbcPœ√s
;

85 
WORD
 
	mbcBôCou¡
;

86 } 
	tBMPCOREHEAD
;

87 #¥agm®
∑ck
()

89 * 
SåùP©h
(*
buf„r
);

90 
C⁄vBMP
(
FILE
 *
Â
,*
«me
);

91 
C⁄vBMPFûe
(*
öfûíame
, *
outfûíame
);

92 
ouéöe
(
UCHAR
 *
löebuf„r
, 
bôdïth
, 
löesize
, 
y
);

93 
DecodeRLE8
(
UCHAR
 *
buf
,
FILE
 *
Â
);

94 
DecodeRLE4
(
UCHAR
 *
buf
,
FILE
 *
Â
);

95 
put4
(
b
);

97 
	gs_Êag
 = 0;

99 
	#MAX_FILENAME_LEN
 256

	)

101 
	$maö
(
¨gc
,*
¨gv
[])

103 
o_Êag
 = 0;

104 *
p
;

105 
«me
[
MAX_FILENAME_LEN
];

106 
⁄ame
[
MAX_FILENAME_LEN
];

109 
¨gc
--;

110 
¨gv
++;

113 if(
¨gc
 && 
	`°rcmp
(*
¨gv
, "-s") == 0) {

114 
s_Êag
 = -1;

115 
¨gc
--;

116 
¨gv
++;

120 if(
¨gc
 && 
	`°rcmp
(*
¨gv
, "-o") == 0) {

121 
o_Êag
 = -1;

122 
¨gc
--;

123 
¨gv
++;

127 if((
¨gc
 =0Ë|| (
o_Êag
 && (argc != 2))) {

128 
	`Ârötf
(
°dîr
, "Usage: convbmp [-s] <bmpfile>...\n"

133 i‡(
o_Êag
) {

134 i‡(
	`°æí
(
¨gv
[0]Ë> 
MAX_FILENAME_LEN
 - 3) {

135 
	`Ârötf
(
°dîr
, "Fûíamêtoÿl⁄g (%d byãs, max i†%d): '%s'\n", 
	`°æí
(*
¨gv
), 
MAX_FILENAME_LEN
 - 3, *argv);

138 i‡(
	`°æí
(
¨gv
[1]Ë> 
MAX_FILENAME_LEN
 - 3) {

139 
	`Ârötf
(
°dîr
, "Fûíamêtoÿl⁄g (%d byãs, max i†%d): '%s'\n", 
	`°æí
(*
¨gv
), 
MAX_FILENAME_LEN
 - 3, *argv);

142 if(
	`C⁄vBMPFûe
(
¨gv
[1],árgv[0])) {

149 
¨gv
--;

150 
¨gc
--) {

151 
¨gv
++;

152 i‡(
	`°æí
(*
¨gv
Ë> 
MAX_FILENAME_LEN
 - 3) {

154 
	`Ârötf
(
°dîr
, "Fûíamêtoÿl⁄g (%d byãs, max i†%d): '%s'\n", 
	`°æí
(*
¨gv
), 
MAX_FILENAME_LEN
 - 3, *argv);

157 
	`°r˝y
(
«me
, *
¨gv
);

158 
	`°r˝y
(
⁄ame
, *
¨gv
);

159 if((
p
 = 
	`°ºchr
(
⁄ame
, '.')Ë!(*)
NULL
)

160 *
p
 = '\0';

161 if(
s_Êag
)

162 
	`°rˇt
(
⁄ame
, ".s");

164 
	`°rˇt
(
⁄ame
, ".c");

165 if(
	`C⁄vBMPFûe
(
«me
, 
⁄ame
)) {

170 
	}
}

172 
	$C⁄vBMPFûe
(*
öfûíame
, *
outfûíame
)

174 
«mebuf
[
MAX_FILENAME_LEN
];

175 *
p
;

176 *
«me
;

177 
FILE
 *
Â
;

179 
	`°r˝y
(
«mebuf
, 
öfûíame
);

180 if((
p
 = 
	`°ºchr
(
«mebuf
, '.')Ë!(*)
NULL
)

181 *
p
 = '\0';

187 
«me
 = 
	`SåùP©h
(
«mebuf
);

189 if((
Â
 = 
	`f›í
(
öfûíame
, "rb")Ë=(
FILE
 *)
NULL
) {

190 
	`Ârötf
(
°dîr
, "C™'à›í fûe: %s\n", 
öfûíame
);

193 if(
	`‰e›í
(
outfûíame
, "w", 
°dout
Ë=(
FILE
 *)
NULL
) {

194 
	`f˛o£
(
Â
);

195 
	`Ârötf
(
°dîr
, "CouldÇŸ o≥¿ouçuàfûê%s\n", 
outfûíame
);

199 if(
	`C⁄vBMP
(
Â
, 
«me
)) {

200 
	`Ârötf
(
°dîr
, "C⁄vîsi⁄ faûed: %s\n", 
öfûíame
);

201 
	`f˛o£
(
Â
);

204 
	`f˛o£
(
Â
);

207 
	}
}

218 * 
	$SåùP©h
(*
buf„r
)

220 *
p
 = 
buf„r
;

223 *
p1
 = 
p
;

224 
p1
 = 
	`°Ωbrk
–
p
, 
OS_FILE_SEPARATOR
 );

225 if–
p1
 )

227 
p
 = 
p1
+1;

234 (
p
);

235 
	}
}

238 
	$C⁄vBMP
(
FILE
 *
Â
, *
«me
)

240 
BMPHEAD
 
bmp
;

241 
BMPCOREHEAD
 *
bmc
;

242 
i
, 
∑lsize
;

243 
UCHAR
 *
löebuf„r
 = 
NULL
;

244 
cx
, 
cy
, 
bôdïth
, 
löesize
;

245 
com¥essi⁄
;

246 
MWPALENTRY
 
cm≠
[256];

247 
l
;

248 
g
;

249 
byã•îpixñ
;

250 
UCHAR
 *
p
 = (UCHAR *)&
l
;

253 if(
	`‰ód
(&
bmp
, 1, (
BMPHEAD
), 
Â
) != (BMPHEAD)) {

254 
	`Ârötf
(
°dîr
, "ErrorÑeading .bmp file header\n");

259 if(
	`READDWORD
(
bmp
.
BiSize
) == 12) {

260 
bmc
 = (
BMPCOREHEAD
 *)&
bmp
;

261 
cx
 = ()
	`READWORD
(
bmc
->
bcWidth
);

262 
cy
 = ()
	`READWORD
(
bmc
->
bcHeight
);

263 
bôdïth
 = 
	`READWORD
(
bmc
->
bcBôCou¡
);

264 
∑lsize
 = 1 << 
bôdïth
;

265 
com¥essi⁄
 = 
BI_RGB
;

266 
	`f£ek
(
Â
, (
BMPCOREHEAD
), 
SEEK_SET
);

268 
cx
 = ()
	`READLONG
(
bmp
.
BiWidth
);

269 
cy
 = ()
	`READLONG
(
bmp
.
BiHeight
);

270 
bôdïth
 = 
	`READWORD
(
bmp
.
BiBôCou¡
);

271 
∑lsize
 = ()
	`READDWORD
(
bmp
.
BiCÃU£d
);

272 if(
∑lsize
 == 0)

273 
∑lsize
 = 1 << 
bôdïth
;

274 
com¥essi⁄
 = 
	`READDWORD
(
bmp
.
BiCom¥essi⁄
);

277 if(
bôdïth
 > 8)

278 
∑lsize
 = 0;

281 if(
bôdïth
 > 8 && bitdepth != 24) {

282 
	`Ârötf
(
°dîr
, "Error: bitsÖerÖixel must be 1, 4, 8 or 24\n");

287 if(
bôdïth
 == 1) {

288 
löesize
 = 
	`PIX2BYTES
(
cx
);

289 
byã•îpixñ
 = 1;

290 } if(
bôdïth
 <= 4) {

291 
löesize
 = 
	`PIX2BYTES
(
cx
<<2);

292 
byã•îpixñ
 = 1;

293 } if(
bôdïth
 <= 8) {

294 
löesize
 = 
cx
;

295 
byã•îpixñ
 = 1;

296 } if(
bôdïth
 <= 16) {

297 
löesize
 = 
cx
 * 2;

298 
byã•îpixñ
 = 2;

299 } if(
bôdïth
 <= 24) {

300 
löesize
 = 
cx
 * 3;

301 
byã•îpixñ
 = 3;

303 
löesize
 = 
cx
 * 4;

304 
byã•îpixñ
 = 4;

307 
löesize
 = (linesize+3) & ~3;

309 if((
löebuf„r
 = 
	`mÆloc
(
löesize
)Ë=(
UCHAR
 *)
NULL
) {

310 
	`Ârötf
(
°dîr
, "Eº‹ wôh mÆloc(%d)\n", 
löesize
);

314 if(!
s_Êag
) {

315 
	`¥ötf
("/* Generated by convbmp*/\n");

316 
	`¥ötf
("#include \"device.h\"\n\n");

317 
	`¥ötf
("/* MWIMAGEHDR image_%s converted from %s.bmp*/\n\n",

318 
«me
,Çame);

322 if(
bôdïth
 <= 8) {

323 
i
=0; i<
∑lsize
; i++) {

324 
cm≠
[
i
].
b
 = 
	`fgëc
(
Â
);

325 
cm≠
[
i
].
g
 = 
	`fgëc
(
Â
);

326 
cm≠
[
i
].
r
 = 
	`fgëc
(
Â
);

327 if(
	`READDWORD
(
bmp
.
BiSize
) != 12)

328 
	`fgëc
(
Â
);

331 if(!
s_Êag
) {

333 
	`¥ötf
("°©i¯MWPALENTRYÖÆëã[%d] = {\n", 
∑lsize
);

334 
i
=0; i<
∑lsize
; ++i)

335 
	`¥ötf
(" RGBDEF( %3d, %3d, %3d ),\t/*Öal %d*/\n",

336 
cm≠
[
i
].
r
, cm≠[i].
g
, cm≠[i].
b
, i);

337 
	`¥ötf
("};\n\n");

339 
	`¥ötf
(".sect .text; .sect .rom; .sect .data; .sect .bss\n");

340 
	`¥ötf
(".sect .data\n");

341 
	`¥ötf
("__II0:\n");

342 
l
 = 0L; 
g
 = 0; 
p
 = (
UCHAR
 *)&l;

343 
i
=0; i<
∑lsize
; ++i) {

344 
p
[
g
++] = 
cm≠
[
i
].
r
;

345 if(
g
 == 4)

346 { 
g
 = 0; 
	`¥ötf
(".d©a4\t%ld\n", 
l
);Ü = 0L; }

347 
p
[
g
++] = 
cm≠
[
i
].g;

348 if(
g
 == 4)

349 { 
g
 = 0; 
	`¥ötf
(".d©a4\t%ld\n", 
l
);Ü = 0L; }

350 
p
[
g
++] = 
cm≠
[
i
].
b
;

351 if(
g
 == 4)

352 { 
g
 = 0; 
	`¥ötf
(".d©a4\t%ld\n", 
l
);Ü = 0L; }

354 if(
g
)

355 
	`¥ötf
(".d©a4\t%ld\n", 
l
);

359 if(!
s_Êag
) {

360 
	`¥ötf
("static MWUCHAR imagebits[] = {\n");

362 
	`¥ötf
("__II1:\n");

363 
l
 = 0L; 
g
 = 0;

367 
	`f£ek
(
Â
, 
	`READDWORD
(
bmp
.
bfOffBôs
), 
SEEK_SET
);

368 if(
com¥essi⁄
 =
BI_RLE8
) {

369 
i
 = 
cy
-1; i>= 0; i--) {

370 if(!
	`DecodeRLE8
(
löebuf„r
, 
Â
))

372 
	`ouéöe
(
löebuf„r
, 
bôdïth
, 
löesize
, 
i
);

374 } if(
com¥essi⁄
 =
BI_RLE4
) {

375 
i
 = 
cy
-1; i>= 0; i--) {

376 if(!
	`DecodeRLE4
(
löebuf„r
, 
Â
))

378 
	`ouéöe
(
löebuf„r
, 
bôdïth
, 
löesize
, 
i
);

381 
i
=0; i<
cy
; i++) {

382 if(
	`‰ód
(
löebuf„r
, 1, 
löesize
, 
Â
Ë!(
size_t
)linesize) {

383 
	`‰ì
(
löebuf„r
);

384 
	`Ârötf
(
°dîr
, "Error fread\n");

387 
	`ouéöe
(
löebuf„r
, 
bôdïth
, 
löesize
, 
cy
-
i
-1);

391 if(!
s_Êag
) {

392 
	`¥ötf
("};\n\n");

394 
	`¥ötf
("MWIMAGEHDR image_%†{\n", 
«me
);

395 
	`¥ötf
(" %d, %d,\t/* width, height*/\n", 
cx
, 
cy
);

396 
	`¥ötf
(" %d, %d,\t\t/*Öœ√s, bµ*/\n", 1, 
bôdïth
);

397 
	`¥ötf
(" %d, %d,\t/*Öitch, bytesperpixel*/\n",

398 
löesize
, 
byã•îpixñ
);

399 
	`¥ötf
(" %d, %d,\t/* com¥essi⁄,ÖÆsize*/\n", 1, 
∑lsize
);

400 
	`¥ötf
(" %ldL,\t\t/*Åranscolor*/\n", -1L);

401 if(
∑lsize
)

402 
	`¥ötf
("Öalette,\n");

404 
	`¥ötf
(" 0,\n");

405 
	`¥ötf
(" imagebits,\n");

406 
	`¥ötf
("};\n");

408 
	`¥ötf
(".exã∫ _image_%s\n", 
«me
);

409 
	`¥ötf
("_image_%s:\n", 
«me
);

410 
	`¥ötf
(".d©a4\t%ld\n",()
cx
);

411 
	`¥ötf
(".d©a4\t%ld\n",()
cy
);

412 
	`¥ötf
(".data4\t%ld\n",1L);

413 
	`¥ötf
(".d©a4\t%ld\n",()
bôdïth
);

414 
	`¥ötf
(".d©a4\t%ld\n",()
löesize
);

415 
	`¥ötf
(".d©a4\t%ld\n",()
byã•îpixñ
);

416 
	`¥ötf
(".data4\t%ld\n",1L);

417 
	`¥ötf
(".d©a4\t%ld\n",()
∑lsize
);

418 
	`¥ötf
(".data4\t%ld\n",-1L);

419 
	`¥ötf
(".data4\t__II0\n");

420 if(
∑lsize
)

421 
	`¥ötf
(".data4\t__II1\n");

423 
	`¥ötf
(".data4\t0\n");

424 
	`¥ötf
(".sect .text\n");

427 
	`‰ì
(
löebuf„r
);

430 
	}
}

432 
	$ouéöe
(
UCHAR
 *
löebuf„r
, 
bôdïth
, 
löesize
, 
y
)

434 
bc
 = 0;

435 
l
 = 0;

436 *
p
 = (*)&
l
;

437 
n
;

439 
bôdïth
) {

442 
n
=0;Ç<
löesize
; ++n) {

443 if(!
s_Êag
)

444 
	`¥ötf
("0x%02x,", 
löebuf„r
[
n
]);

446 
p
[
bc
++] = 
löebuf„r
[
n
];

447 if(
bc
 == 4) {

448 
bc
 = 0;

449 
	`¥ötf
(".d©a4\t%ld\n", 
l
);

450 
l
 = 0L;

457 
n
=0;Ç<
löesize
; ++n) {

458 if(!
s_Êag
)

459 
	`¥ötf
("%d,", 
löebuf„r
[
n
]);

461 
p
[
bc
++] = 
löebuf„r
[
n
];

462 if(
bc
 == 4) {

463 
bc
 = 0;

464 
	`¥ötf
(".d©a4\t%ld\n", 
l
);

465 
l
 = 0L;

470 if(!
s_Êag
)

471 
	`¥ötf
("\n");

472 
	}
}

477 
	$DecodeRLE8
(
UCHAR
 *
buf
,
FILE
 *
Â
)

479 
c
, 
n
;

480 
UCHAR
 * 
p
 = 
buf
;

483 
n
 = 
	`fgëc
(
Â
)) {

484 
EOF
:

487 
n
 = 
	`fgëc
(
Â
)) {

493 ()
	`fgëc
(
Â
);

494 ()
	`fgëc
(
Â
);

497 
c
=0; c<
n
; c++)

498 *
p
++ = 
	`fgëc
(
Â
);

499 if(
n
 & 1)

500 ()
	`fgëc
(
Â
);

504 
c
 = 
	`fgëc
(
Â
);

505 
n
--)

506 *
p
++ = 
c
;

510 
	}
}

515 
UCHAR
 *
	gp
;

516 
	g⁄˚
;

518 
	$put4
(
b
)

520 
œ°
;

522 
œ°
 = (œ° << 4Ë| 
b
;

523 if(++
⁄˚
 == 2) {

524 *
p
++ = 
œ°
;

525 
⁄˚
 = 0;

527 
	}
}

529 
	$DecodeRLE4
(
UCHAR
 *
buf
, 
FILE
 *
Â
)

531 
c
, 
n
, 
c1
, 
c2
;

533 
p
 = 
buf
;

534 
⁄˚
 = 0;

536 
n
 = 
	`fgëc
(
Â
)) {

537 
EOF
:

540 
n
 = 
	`fgëc
(
Â
)) {

542 if(
⁄˚
)

543 
	`put4
(0);

546 if(
⁄˚
)

547 
	`put4
(0);

550 ()
	`fgëc
(
Â
);

551 ()
	`fgëc
(
Â
);

554 
c2
 = (
n
+3) & ~3;

555 
c
=0; c<
c2
; c++) {

556 if((
c
 & 1) == 0)

557 
c1
 = 
	`fgëc
(
Â
);

558 if(
c
 < 
n
)

559 
	`put4
((
c1
 >> 4) & 0x0f);

560 
c1
 <<= 4;

565 
c
 = 
	`fgëc
(
Â
);

566 
c1
 = (
c
 >> 4) & 0x0f;

567 
c2
 = 
c
 & 0x0f;

568 
c
=0; c<
n
; c++)

569 
	`put4
((
c
&1)? 
c2
: 
c1
);

573 
	}
}

	@mwin/bmp/makebmp.c

8 
	~<°dio.h
>

9 
	~<uni°d.h
>

11 
	#BI_RGB
 0L

	)

12 
	#BI_RLE8
 1L

	)

13 
	#BI_RLE4
 2L

	)

14 
	#BI_BITFIELDS
 3L

	)

16 
	tBYTE
;

17 
	tWORD
;

18 
	tDWORD
;

19 
	tLONG
;

21 #¥agm®
∑ck
(1)

25 
BYTE
 
	mbfTy≥
[2];

26 
DWORD
 
	mbfSize
;

27 
WORD
 
	mbfRe£rved1
;

28 
WORD
 
	mbfRe£rved2
;

29 
DWORD
 
	mbfOffBôs
;

31 
DWORD
 
	mBiSize
;

32 
LONG
 
	mBiWidth
;

33 
LONG
 
	mBiHeight
;

34 
WORD
 
	mBiPœ√s
;

35 
WORD
 
	mBiBôCou¡
;

36 
DWORD
 
	mBiCom¥essi⁄
;

37 
DWORD
 
	mBiSizeImage
;

38 
LONG
 
	mBiX≥lsPîMëî
;

39 
LONG
 
	mBiY≥lsPîMëî
;

40 
DWORD
 
	mBiCÃU£d
;

41 
DWORD
 
	mBiCÃImp‹è¡
;

42 } 
	tBMPHEAD
;

43 #¥agm®
∑ck
()

45 
MakeBMP
(
FILE
 *
iÂ
,FILE *
oÂ
);

48 
	$maö
(
ac
,**
av
)

50 
FILE
 *
iÂ
;

51 
FILE
 *
oÂ
;

53 if(
ac
 < 3) {

54 
	`Ârötf
(
°dîr
, "Usage: makebmp <infile> <outfile>\n");

55 
	`exô
(1);

57 
iÂ
 = 
	`f›í
(
av
[1], "rb");

58 if(!
iÂ
) {

59 
	`Ârötf
(
°dîr
, "C™'à›í fûe: %s\n", 
av
[1]);

60 
	`exô
(1);

62 
oÂ
 = 
	`f›í
(
av
[2], "wb");

63 if(!
oÂ
) {

64 
	`Ârötf
(
°dîr
, "C™'à¸óã fûe: %s\n", 
av
[2]);

65 
	`exô
(1);

67 if(!
	`MakeBMP
(
iÂ
, 
oÂ
)) {

68 
	`Ârötf
(
°dîr
, "C⁄vîsi⁄ faûed: %s\n", 
av
[2]);

69 
	`f˛o£
(
oÂ
);

70 
	`u∆ök
(
av
[2]);

71 
	`exô
(1);

73 
	`f˛o£
(
iÂ
);

74 
	`f˛o£
(
oÂ
);

76 
	}
}

80 
	$MakeBMP
(
FILE
 *
iÂ
, FILE *
oÂ
)

82 
BMPHEAD
 
bmp
;

83 
i
, 
j
;

84 
cx
, 
cy
, 
exåa
, 
bôdïth
, 
ncﬁ‹s
;

86 
cx
 = 640;

87 
cy
 = 480;

88 
exåa
 = (
cx
 + 3) & 3;

89 
bôdïth
 = 8;

90 if(
bôdïth
 <= 8)

91 
ncﬁ‹s
 = 1<<
bôdïth
;

92 
ncﬁ‹s
 = 0;

94 
	`mem£t
(&
bmp
, 0, (bmp));

95 
bmp
.
bfTy≥
[0] = 'B';

96 
bmp
.
bfTy≥
[1] = 'M';

97 
bmp
.
bfSize
 = (bmpË+ 
ncﬁ‹s
*4 + ()
cx
*
cy
;

98 
bmp
.
bfOffBôs
 = (bmpË+ 
ncﬁ‹s
*4;

99 
bmp
.
BiSize
 = 40;

100 
bmp
.
BiWidth
 = 
cx
;

101 
bmp
.
BiHeight
 = 
cy
;

102 
bmp
.
BiPœ√s
 = 1;

103 
bmp
.
BiBôCou¡
 = 
bôdïth
;

104 
bmp
.
BiCom¥essi⁄
 = 
BI_RGB
;

106 
bmp
.
BiCÃU£d
 = 
ncﬁ‹s
;

107 
bmp
.
BiCÃImp‹è¡
 = 
ncﬁ‹s
;

110 
	`fwrôe
(&
bmp
, (bmp), 1, 
oÂ
);

113 if(
bôdïth
 <= 8) {

114 
i
=0; i<
ncﬁ‹s
; i++) {

115 
r
, 
g
, 
b
;

116 
r
 = 
	`gëc
(
iÂ
);

117 
g
 = 
	`gëc
(
iÂ
);

118 
b
 = 
	`gëc
(
iÂ
);

119 
	`putc
(
b
, 
oÂ
);

120 
	`putc
(
g
, 
oÂ
);

121 
	`putc
(
r
, 
oÂ
);

122 
	`putc
(0, 
oÂ
);

127 
i
=
cy
-1; i>0; --i) {

128 
ba£
 = (
bmp
Ë+ 
ncﬁ‹s
*4 + ()
i
*
cx
;

129 
	`f£ek
(
oÂ
, 
ba£
, 
SEEK_SET
);

130 
j
=0; j<
cx
; ++j)

131 
	`putc
(
	`gëc
(
iÂ
), 
oÂ
);

132 
j
=0; j<
exåa
; ++j)

133 
	`putc
(0, 
oÂ
);

136 
	}
}

	@mwin/mwobjects/mwobjects.cc

8 
	~<Æg‹ôhm
>

9 
	~<°d¨g.h
>

10 
	~<°dio.h
>

11 
	~<mwobje˘s.h
>

13 
«me•a˚
 
	gMi¸oWödowsObje˘s


16 
Aµliˇti⁄
 *
	gthe_≠∂iˇti⁄
 = 0;

18 
	gWödowCœss
::
WödowCœss
 ()

20 
w˛ass
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

21 
	gw˛ass
.
	gÕ‚WndProc
 = 0;

22 
	gw˛ass
.
	gÕ‚WndProc
 = 0;

23 
	gw˛ass
.
	gcbClsExåa
 = 0;

24 
	gw˛ass
.
	gcbWndExåa
 = 0;

25 
	gw˛ass
.
	ghIn°™˚
 = 0;

26 
	gw˛ass
.
	ghIc⁄
 = 0;

27 
	gw˛ass
.
	ghCurs‹
 = 0;

28 
	gw˛ass
.
	ghbrBackground
 = 0;

29 
	gw˛ass
.
	gÕszMíuName
 = 0;

30 
	gw˛ass
.
	gÕszCœssName
 = 0;

33 
	gWödowCœss
::
WödowCœss
 (
LPCSTR
 
ÕszCœssName
,

34 
UINT
 
°yÀ
,

35 
cbClsExåa
,

36 
cbWndExåa
,

37 
HINSTANCE
 
hIn°™˚
,

38 
HICON
 
hIc⁄
,

39 
HCURSOR
 
hCurs‹
,

40 
HBRUSH
 
hbrBackground
,

41 
LPCSTR
 
ÕszMíuName
)

43 
	gw˛ass
.
	g°yÀ
 = 
°yÀ
;

44 
	gw˛ass
.
	gÕ‚WndProc
 = (
WNDPROC
Ë
Wödow
::
WndProc
;

45 
	gw˛ass
.
	gcbClsExåa
 = 
cbClsExåa
;

46 
	gw˛ass
.
	gcbWndExåa
 = 
cbWndExåa
 +  (
Wödow
 *);

47 
	gw˛ass
.
	ghIn°™˚
 = 
hIn°™˚
;

48 
	gw˛ass
.
	ghIc⁄
 = 
hIc⁄
;

49 
	gw˛ass
.
	ghCurs‹
 = 
hCurs‹
;

50 
	gw˛ass
.
	ghbrBackground
 = 
hbrBackground
;

51 
	gw˛ass
.
	gÕszMíuName
 = 
ÕszMíuName
;

52 
	gw˛ass
.
	gÕszCœssName
 = 
ÕszCœssName
;

55 
ATOM
 
	gWödowCœss
::
ªgi°î_˛ass
 ()

57  
Regi°îCœss
 (&
w˛ass
);

60 
	gWödow
::
Wödow
 ()

61 : 
hwnd
 (0)

65 
Wödow
::Wödow (
DWORD
 
dwExStyÀ
,

66 
LPCSTR
 
ÕCœssName
,

67 
LPCSTR
 
ÕWödowName
,

68 
DWORD
 
dwStyÀ
,

69 
x
,

70 
y
,

71 
nWidth
,

72 
nHeight
,

73 
HWND
 
hwndP¨ít
,

74 
HMENU
 
hMíu
,

75 
HINSTANCE
 
hIn°™˚
,

76 
LPVOID
 
ÕP¨am
)

77 : 
hwnd
 (0)

79 
¸óã
 (
dwExStyÀ
,

80 
ÕCœssName
,

81 
ÕWödowName
,

82 
dwStyÀ
,

83 
x
, 
y
, 
nWidth
, 
nHeight
,

84 
hwndP¨ít
,

85 
hMíu
,

86 
hIn°™˚
,

87 
ÕP¨am
);

90 
	gWödow
::~
Wödow
 ()

92 
de°‹y
 ();

95 
HWND


96 
	gWödow
::
¸óã
 (
DWORD
 
dwExStyÀ
,

97 
LPCSTR
 
ÕCœssName
,

98 
LPCSTR
 
ÕWödowName
,

99 
DWORD
 
dwStyÀ
,

100 
x
,

101 
y
,

102 
nWidth
,

103 
nHeight
,

104 
HWND
 
hwndP¨ít
,

105 
HMENU
 
hMíu
,

106 
HINSTANCE
 
hIn°™˚
,

107 
LPVOID
 
ÕP¨am
)

109 
	gÕCª©eP¨ams
 = 
ÕP¨am
;

111 
	gÕP¨am
 = (
LPVOID
Ë
this
;

113 
	ghwnd
 = ::
Cª©eWödowEx
 (
dwExStyÀ
,

114 
ÕCœssName
,

115 
ÕWödowName
,

116 
dwStyÀ
,

117 
x
, 
y
, 
nWidth
, 
nHeight
,

118 
hwndP¨ít
,

119 
hMíu
,

120 
hIn°™˚
,

121 
ÕP¨am
);

122  
	ghwnd
;

125 
BOOL


126 
	gWödow
::
de°‹y
 ()

128 i‡(
hwnd
)

130 
HWND
 
ﬁd_hwnd
 = 
hwnd
;

131 
	ghwnd
 = 0;

132  ::
De°royWödow
 (
ﬁd_hwnd
);

137 
boﬁ


138 
	gWödow
::
©èch
 (c⁄° 
fd
, 
FûeDes¸ùt‹
& 
fûe_des¸ùt‹
)

144 i‡((
	gfd
 < 0Ë|| (fd >
FD_SETSIZE
Ë|| (
fûe_des¸ùt‹
.
fûe_desc
 != -1))

145  
Ál£
;

151 
	gfûe_des¸ùt‹
.
	gfûe_desc
 = 
fd
;

152 
	gfûe_des¸ùt‹
.
	gwödow
 = 
this
;

154 i‡(
	gfûe_des¸ùt‹s
.
föd
 (&
fûe_des¸ùt‹
Ë!
fûe_des¸ùt‹s
.
íd
 ())

156 
fûe_des¸ùt‹
.
fûe_desc
 = -1;

157 
	gfûe_des¸ùt‹
.
	gwödow
 = 0;

158  
	gÁl£
;

161 
	gfûe_des¸ùt‹s
.
ö£π
 (&
fûe_des¸ùt‹
);

163  
	gåue
;

166 
boﬁ


167 
	gWödow
::
dëach
 (
FûeDes¸ùt‹
& 
fûe_des¸ùt‹
)

173 i‡((
fûe_des¸ùt‹
.
fd
 (Ë< 0Ë|| (fûe_des¸ùt‹.fd (Ë>
FD_SETSIZE
))

174  
Ál£
;

180 i‡(
	gfûe_des¸ùt‹s
.
föd
 (&
fûe_des¸ùt‹
Ë=
fûe_des¸ùt‹s
.
íd
 ())

181  
Ál£
;

183 
	gfûe_des¸ùt‹
.
dißbÀ_ªad
 ();

184 
	gfûe_des¸ùt‹
.
dißbÀ_wrôe
 ();

185 
	gfûe_des¸ùt‹
.
dißbÀ_ex˚±
 ();

187 
	gfûe_des¸ùt‹s
.
îa£
 (&
fûe_des¸ùt‹
);

189 
	gfûe_des¸ùt‹
.
	gfûe_desc
 = -1;

190 
	gfûe_des¸ùt‹
.
	gwödow
 = 0;

192  
	gåue
;

195 
	seq_fd


197 c⁄° 
	gfd
;

198 
eq_fd
 (c⁄° 
fd
) : fd (fd) {}

199 
boﬁ
 
›î©‹
(Ë(c⁄° 
FûeDes¸ùt‹
* 
f1
) const

200 {  (
f1
->
fd
 () == fd); }

203 
LRESULT


204 
	gWödow
::
mesßge_h™dÀr
 (
UINT
 
msg
,

205 
WPARAM
 
wp
,

206 
LPARAM
 
Õ
)

208 
	gmsg
)

210 
	gWM_FDINPUT
:

211 
WM_FDOUTPUT
:

212 
WM_FDEXCEPT
:

220 
£t
<
FûeDes¸ùt‹
*>::
ôî©‹
 
fûe_des¸ùt‹
;

222 
	gfûe_des¸ùt‹
 = 
föd_if
 (
fûe_des¸ùt‹s
.
begö
 (),

223 
fûe_des¸ùt‹s
.
íd
 (),

224 
eq_fd
 ((Ë
wp
));

226 i‡(
	gfûe_des¸ùt‹
 !
fûe_des¸ùt‹s
.
íd
 ())

228 
msg
)

230 
WM_FDINPUT
:

231  (*
fûe_des¸ùt‹
)->
ªad
 ();

233 
	gWM_FDOUTPUT
:

234  (*
fûe_des¸ùt‹
)->
wrôe
 ();

236 
	gWM_FDEXCEPT
:

237  (*
fûe_des¸ùt‹
)->
ex˚±
 ();

247  ::
DefWödowProc
 (
hwnd
, 
msg
, 
wp
, 
Õ
);

250 
boﬁ


251 
	gWödow
::
…öt
::
›î©‹
 (Ë(c⁄° 
FûeDes¸ùt‹
* 
f1
,

252 c⁄° 
FûeDes¸ùt‹
* 
	gf2
) const

254  
	gf1
->
fd
 (Ë< 
	gf2
->fd ();

257 
LRESULT
 
CALLBACK


258 
	gWödow
::
WndProc
 (
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wp
, 
LPARAM
 
Õ
)

260 
	goff£t
 = 
GëCœssL⁄g
 (
hwnd
, 
GCL_CBWNDEXTRA
Ë-  (
	gWödow
 *);

261 
Wödow
 *
	gwödow
 = 0;

263 i‡(
	gmsg
 =
WM_CREATE
)

265 
LPCREATESTRUCT
 
cs
 = (LPCREATESTRUCTË
Õ
;

267 
	gwödow
 = 
dy«mic_ˇ°
<
Wödow
*>((Wödow*Ë
cs
->
ÕCª©eP¨ams
);

269 i‡(
	gwödow
)

271 
	gwödow
->
	ghwnd
 = 
hwnd
;

272 
SëWödowL⁄g
 (
hwnd
, 
off£t
, (
DWORD
Ë
wödow
);

273 
	gcs
->
	gÕCª©eP¨ams
 = 
wödow
->
ÕCª©eP¨ams
;

278 
	gwödow
 = 
dy«mic_ˇ°
<
Wödow
*>((Wödow*Ë
GëWödowL⁄g
 (
hwnd
, 
off£t
));

281 i‡(
	gwödow
)

282  
	gwödow
->
mesßge_h™dÀr
 (
msg
, 
wp
, 
Õ
);

284  ::
DefWödowProc
 (
hwnd
, 
msg
, 
wp
, 
Õ
);

287 
	gPaöt
::
Paöt
 (
HWND
 
hwnd
)

288 : 
hwnd
 (hwnd),

289 
døw_3d
 (
Ál£
),

290 
døwög
 (
Ál£
),

291 
r
 (0, 0, 0, 0),

292 
ãxt_f‹m©
 (0)

296 
	gPaöt
::
Paöt
 (
HWND
 
hwnd
, 
LPARAM
 
ÕP¨am
)

297 : 
hwnd
 (hwnd),

298 
døw_3d
 (
Ál£
),

299 
døwög
 (
Ál£
),

300 
r
 (0, 0, 0, 0),

301 
ãxt_f‹m©
 (0)

303 
POINTSTOPOINT
 (
±
, 
ÕP¨am
);

306 
	gPaöt
::~
Paöt
 ()

308 
íd
 ();

312 
	gPaöt
::
begö
 (
boﬁ
 
öô_3d
, boﬁ 
døw_3d_ö_mem
)

314 i‡(!
	gdøwög
 && 
	ghwnd
)

316 
	ghdc
 = ::
BegöPaöt
 (
hwnd
, &
ps
);

318 
	gr
.
gë_˛õ¡
 (
hwnd
);

320 i‡(
	göô_3d
)

321 
öôüli£_3d
 (
døw_3d_ö_mem
);

323 
	gdøwög
 = 
åue
;

328 
	gPaöt
::
íd
 ()

330 i‡(
døwög
)

332 
∑öt_3d
 ();

334 ::
EndPaöt
 (
hwnd
, &
ps
);

336 
	gdøwög
 = 
Ál£
;

341 
	gPaöt
::
ãxt_out
 (
x
, 
y
, c⁄° *
f‹m©
, ...)

343 
Re˘
 
ª˘
 (
x
, 
y
, x + 100, y + 100);

344 
va_li°
 
	g¨g
;

346 
va_°¨t
 (
¨g
, 
f‹m©
);

347 
v¢¥ötf
 (
f‹m©_buf
, 
TEXT_BUF_SIZE
, 
f‹m©
, 
¨g
);

348 
	gf‹m©_buf
[
TEXT_BUF_SIZE
 - 1] = '\0';

350  ::
DøwText
 (
hdc
, 
f‹m©_buf
, -1, 
ª˘
, 
ãxt_f‹m©
);

353 
	gFûeDes¸ùt‹
::
FûeDes¸ùt‹
 ()

354 : 
fûe_desc
 (-1),

355 
wödow
 (0)

359 
	gFûeDes¸ùt‹
::~
FûeDes¸ùt‹
 ()

361 i‡(
wödow
)

362 
wödow
->
dëach
 (*
this
);

365 
boﬁ


366 
	gFûeDes¸ùt‹
::
íabÀ_ªad
 ()

368 i‡(!
ªad_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

370 ::
MwRegi°îFdI≈ut
 (*
wödow
, 
fûe_desc
);

371 
	gªad_is_íabÀd
 = 
åue
;

372  
	gåue
;

374  
	gÁl£
;

377 
boﬁ


378 
	gFûeDes¸ùt‹
::
dißbÀ_ªad
 ()

380 i‡(
ªad_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

382 ::
MwUƒegi°îFdI≈ut
 (*
wödow
, 
fûe_desc
);

383 
	gªad_is_íabÀd
 = 
Ál£
;

384  
	gåue
;

386  
	gÁl£
;

390 
boﬁ


391 
	gFûeDes¸ùt‹
::
íabÀ_wrôe
 ()

393 i‡(!
wrôe_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

395 ::
MwRegi°îFdOuçut
 (*
wödow
, 
fûe_desc
);

396 
	gwrôe_is_íabÀd
 = 
åue
;

397  
	gåue
;

399  
	gÁl£
;

402 
boﬁ


403 
	gFûeDes¸ùt‹
::
dißbÀ_wrôe
 ()

405 i‡(
wrôe_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

407 ::
MwUƒegi°îFdOuçut
 (*
wödow
, 
fûe_desc
);

408 
	gwrôe_is_íabÀd
 = 
Ál£
;

409  
	gåue
;

411  
	gÁl£
;

414 
boﬁ


415 
	gFûeDes¸ùt‹
::
íabÀ_ex˚±
 ()

417 i‡(!
ex˚±_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

419 ::
MwRegi°îFdEx˚±
 (*
wödow
, 
fûe_desc
);

420 
	gex˚±_is_íabÀd
 = 
åue
;

421  
	gåue
;

423  
	gÁl£
;

426 
boﬁ


427 
	gFûeDes¸ùt‹
::
dißbÀ_ex˚±
 ()

429 i‡(
ex˚±_is_íabÀd
 && 
wödow
 && (
fûe_desc
 != -1))

431 ::
MwUƒegi°îFdEx˚±
 (*
wödow
, 
fûe_desc
);

432 
	gex˚±_is_íabÀd
 = 
Ál£
;

433  
	gåue
;

435  
	gÁl£
;

438 
LRESULT


439 
	gFûeDes¸ùt‹
::
ªad
 ()

444 
LRESULT


445 
	gFûeDes¸ùt‹
::
wrôe
 ()

450 
LRESULT


451 
	gFûeDes¸ùt‹
::
ex˚±
 ()

456 
	gAµliˇti⁄
::
Aµliˇti⁄
 ()

457 : 
background
 (0)

459 i‡(!
the_≠∂iˇti⁄
)

460 
the_≠∂iˇti⁄
 = 
this
;

463 
	gAµliˇti⁄
::
Aµliˇti⁄
 (
MWIMAGEHDR
& 
background
)

464 : 
background
 (&background)

466 i‡(!
the_≠∂iˇti⁄
)

467 
the_≠∂iˇti⁄
 = 
this
;

470 
	gAµliˇti⁄
::~
Aµliˇti⁄
 ()

475 
Aµliˇti⁄
::
öôüli£
 ()

481 
	gAµliˇti⁄
::
shutdown
 ()

486 
WINAPI


487 
	gAµliˇti⁄
::
WöMaö
 (
HINSTANCE
 
hIn°™˚
,

488 
HINSTANCE
 
hPªvIn°™˚
,

489 
LPSTR
 
ÕCmdLöe
,

490 
nShowCmd
)

492 i‡(
	gthe_≠∂iˇti⁄
)

494 
	gªsu…
;

496 
MwRegi°îBuâ⁄C⁄åﬁ
 (0);

498 
	gªsu…
 = 
the_≠∂iˇti⁄
->
öôüli£
 ();

500 i‡(
	gªsu…
)

501  
	gªsu…
;

507 i‡(
	gthe_≠∂iˇti⁄
->
	gbackground
)

508 
MwSëDeskt›WÆÕ≠î
 (
the_≠∂iˇti⁄
->
background
);

510 
MSG
 
	gmsg
;

516 
GëMesßge
 (&
msg
, 0, 0, 0))

518 
Tøn¶©eMesßge
 (&
msg
);

519 
Di•©chMesßge
 (&
msg
);

522 
	gªsu…
 = 
the_≠∂iˇti⁄
->
shutdown
 ();

524 i‡(
	gªsu…
)

525  
	gªsu…
;

541 
WöMaö
 (
HINSTANCE
 
hIn°™˚
,

542 
HINSTANCE
 
hPªvIn°™˚
,

543 
LPSTR
 
ÕCmdLöe
,

544 
nShowCmd
)

546  
Mi¸oWödowsObje˘s
::
Aµliˇti⁄
::
WöMaö
 (
hIn°™˚
,

547 
hPªvIn°™˚
,

548 
ÕCmdLöe
,

549 
nShowCmd
);

	@mwin/winclip.c

1 
	~"devi˚.h
"

3 #i‡
DYNAMICREGIONS


4 
	~"wö˛ù2.c
"

6 
	~"wö˛ù1.c
"

	@mwin/winclip1.c

7 
	~"wödows.h
"

8 
	~"wöã∫.h
"

13 
	#GAPVAL
(
À·g≠
, 
rightg≠
, 
t›g≠
, 
bŸtomg≠
) \

14 (((
À·g≠
Ë<< 3Ë+ ((
rightg≠
Ë<< 2Ë+ ((
t›g≠
Ë<< 1Ë+ (
bŸtomg≠
))

	)

16 
BOOL
 
MwEx˛udeClùRe˘
(
möx
,
möy
,
maxx
,
maxy
,*
cou¡
,

17 
MWCLIPRECT
 *
˛ùª˘s
);

18 
MwS∂ôClùRe˘
(
MWCLIPRECT
 *
§¸e˘
, MWCLIPRECT *
de°ª˘
,

19 
MWCOORD
 
möx
, MWCOORD 
möy
, MWCOORD 
maxx
, MWCOORD 
maxy
);

29 
	$MwSëClùWödow
(
HDC
 
hdc
)

31 
HWND
 
wp
 = 
hdc
->
hwnd
;

32 
HWND
 
pwp
;

33 
HWND
 
sibwp
;

34 
MWCLIPRECT
 *
˛ù
;

35 
cou¡
;

36 
MWCOORD
 
diff
;

37 
BOOL
 
toom™y
;

38 
PRECT
 
¥c
;

39 
MWCLIPRECT
 
˛ùª˘s
[
MAX_CLIPRECTS
];

41 i‡(
wp
->
unm≠cou¡
)

48 
¥c
 = 
	`MwIsClõ¡DC
(
hdc
)? &
wp
->
˛úe˘
: &wp->
wöª˘
;

49 
cou¡
 = 1;

50 
˛ù
 = 
˛ùª˘s
;

51 
˛ù
->
x
 = 
¥c
->
À·
;

52 
˛ù
->
y
 = 
¥c
->
t›
;

53 
˛ù
->
width
 = 
¥c
->
right
 -Örc->
À·
;

54 
˛ù
->
height
 = 
¥c
->
bŸtom
 -Örc->
t›
;

61 
pwp
 = 
wp
;

62 
pwp
 !
roŸwp
) {

63 
pwp
 =Öwp->
∑ª¡
;

65 
diff
 = 
pwp
->
˛úe˘
.
À·
 - 
˛ù
->
x
;

66 i‡(
diff
 > 0) {

67 
˛ù
->
width
 -
diff
;

68 
˛ù
->
x
 = 
pwp
->
˛úe˘
.
À·
;

71 
diff
 = 
pwp
->
˛úe˘
.
right
 - (
˛ù
->
x
 + clù->
width
);

72 i‡(
diff
 < 0)

73 
˛ù
->
width
 +
diff
;

75 
diff
 = 
pwp
->
˛úe˘
.
t›
 - 
˛ù
->
y
;

76 i‡(
diff
 > 0) {

77 
˛ù
->
height
 -
diff
;

78 
˛ù
->
y
 = 
pwp
->
˛úe˘
.
t›
;

81 
diff
 = 
pwp
->
˛úe˘
.
bŸtom
 - (
˛ù
->
y
 + clù->
height
);

82 i‡(
diff
 < 0)

83 
˛ù
->
height
 +
diff
;

90 i‡(
˛ù
->
width
 <0 || clù->
height
 <= 0) {

91 
	`GdSëClùRe˘s
(
hdc
->
psd
, 1, 
˛ùª˘s
);

102 
toom™y
 = 
FALSE
;

103 
pwp
 = 
wp
;

104 
pwp
 !
NULL
) {

105 
wp
 = 
pwp
;

106 
pwp
 = 
wp
->
∑ª¡
;

107 if(!
pwp
) {

109 if(
hdc
->
Êags
 & 
DCX_CLIPCHILDREN
)

111 
sibwp
 = 
roŸwp
->
chûdªn
;

112 
sibwp
 = 
NULL
;

113 
wp
 = 
NULL
;

115 if(
hdc
->
Êags
 & 
DCX_CLIPSIBLINGS
)

116 
sibwp
 = 
pwp
->
chûdªn
;

117 
sibwp
 = 
wp
;

119 ; 
sibwp
 !
wp
; sibw∞sibwp->
siblögs
) {

120 i‡(
sibwp
->
unm≠cou¡
)

123 
toom™y
 |
	`MwEx˛udeClùRe˘
(
sibwp
->
wöª˘
.
À·
,

124 
sibwp
->
wöª˘
.
t›
, sibwp->wöª˘.
right
-1,

125 
sibwp
->
wöª˘
.
bŸtom
-1, &
cou¡
, 
˛ùª˘s
);

130 if(
pwp
 =
roŸwp
)

141 
wp
 = 
hdc
->
hwnd
;

142 if(
wp
 !
roŸwp
 && 
	`MwIsClõ¡DC
(
hdc
)) {

143 
sibwp
=
wp
->
chûdªn
; sibwp; sibw∞sibwp->
siblögs
) {

144 i‡(
sibwp
->
unm≠cou¡
)

147 
toom™y
 |
	`MwEx˛udeClùRe˘
(
sibwp
->
wöª˘
.
À·
,

148 
sibwp
->
wöª˘
.
t›
, sibwp->wöª˘.
right
-1,

149 
sibwp
->
wöª˘
.
bŸtom
-1, &
cou¡
, 
˛ùª˘s
);

153 i‡(
toom™y
) {

155 
˛ù
->
x
 = 0;

156 
˛ù
->
y
 = 0;

157 
˛ù
->
width
 = -1;

158 
˛ù
->
height
 = -1;

159 
cou¡
 = 1;

165 
	`GdSëClùRe˘s
(
hdc
->
psd
, 
cou¡
, 
˛ùª˘s
);

166 
	}
}

168 
BOOL


169 
	$MwEx˛udeClùRe˘
(
möx
,
möy
,
maxx
,
maxy
,*
cou¡
,

170 
MWCLIPRECT
 *
˛ùª˘s
)

172 
i
;

173 
√wcou¡
;

174 
BOOL
 
toom™y
 = 
FALSE
;

176 
√wcou¡
 = *
cou¡
;

177 
i
 = 0; i < *
cou¡
; i++) {

178 i‡(
√wcou¡
 > 
MAX_CLIPRECTS
 - 3) {

179 
toom™y
 = 
TRUE
;

182 
√wcou¡
 +
	`MwS∂ôClùRe˘
(&
˛ùª˘s
[
i
],

183 &
˛ùª˘s
[
√wcou¡
],

184 
möx
, 
möy
, 
maxx
, 
maxy
);

186 *
cou¡
 = 
√wcou¡
;

187  
toom™y
;

188 
	}
}

203 
	$MwS∂ôClùRe˘
(
MWCLIPRECT
 *
§¸e˘
, MWCLIPRECT *
de°ª˘
, 
MWCOORD
 
möx
,

204 
MWCOORD
 
möy
, MWCOORD 
maxx
, MWCOORD 
maxy
)

206 
MWCOORD
 
x
;

207 
MWCOORD
 
y
;

208 
MWCOORD
 
width
;

209 
MWCOORD
 
height
;

210 
MWCOORD
 
dx
;

211 
MWCOORD
 
dy
;

212 
g≠s
;

218 
x
 = 
§¸e˘
->x;

219 
y
 = 
§¸e˘
->y;

220 
width
 = 
§¸e˘
->width;

221 
height
 = 
§¸e˘
->height;

223 i‡((
möx
 > 
maxx
Ë|| (
möy
 > 
maxy
Ë|| (maxx < 
x
Ë|| (maxy < 
y
) ||

224 (
x
 + 
width
 <
möx
Ë|| (
y
 + 
height
 <
möy
))

233 
g≠s
 = 0;

234 i‡(
x
 < 
möx
)

235 
g≠s
 |
	`GAPVAL
(1, 0, 0, 0);

236 i‡(
x
 + 
width
 - 1 > 
maxx
)

237 
g≠s
 |
	`GAPVAL
(0, 1, 0, 0);

238 i‡(
y
 < 
möy
)

239 
g≠s
 |
	`GAPVAL
(0, 0, 1, 0);

240 i‡(
y
 + 
height
 - 1 > 
maxy
)

241 
g≠s
 |
	`GAPVAL
(0, 0, 0, 1);

243 
g≠s
) {

244 
	`GAPVAL
(0, 0, 0, 0):

245 
§¸e˘
->
x
 = 0;

246 
§¸e˘
->
y
 = 0;

247 
§¸e˘
->
width
 = 0;

248 
§¸e˘
->
height
 = 0;

251 
	`GAPVAL
(0, 0, 0, 1):

252 
dy
 = 
maxy
 - 
y
 + 1;

253 
§¸e˘
->
y
 +
dy
;

254 
§¸e˘
->
height
 -
dy
;

257 
	`GAPVAL
(0, 0, 1, 0):

258 
§¸e˘
->
height
 = 
möy
 - 
y
;

261 
	`GAPVAL
(0, 0, 1, 1):

262 
§¸e˘
->
height
 = 
möy
 - 
y
;

263 
de°ª˘
->
x
 = x;

264 
de°ª˘
->
width
 = width;

265 
de°ª˘
->
y
 = 
maxy
 + 1;

266 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

269 
	`GAPVAL
(0, 1, 0, 0):

270 
dx
 = 
maxx
 - 
x
 + 1;

271 
§¸e˘
->
x
 +
dx
;

272 
§¸e˘
->
width
 -
dx
;

275 
	`GAPVAL
(0, 1, 0, 1):

276 
dx
 = 
maxx
 - 
x
 + 1;

277 
§¸e˘
->
x
 +
dx
;

278 
§¸e˘
->
width
 -
dx
;

279 
§¸e˘
->
height
 = 
maxy
 - 
y
 + 1;

280 
de°ª˘
->
x
 = x;

281 
de°ª˘
->
width
 = width;

282 
de°ª˘
->
y
 = 
maxy
 + 1;

283 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

286 
	`GAPVAL
(0, 1, 1, 0):

287 
dx
 = 
maxx
 - 
x
 + 1;

288 
§¸e˘
->
height
 = 
möy
 - 
y
;

289 
de°ª˘
->
x
 = x + 
dx
;

290 
de°ª˘
->
width
 = width - 
dx
;

291 
de°ª˘
->
y
 = 
möy
;

292 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

295 
	`GAPVAL
(0, 1, 1, 1):

296 
dx
 = 
maxx
 - 
x
 + 1;

297 
§¸e˘
->
height
 = 
möy
 - 
y
;

298 
de°ª˘
->
x
 = x;

299 
de°ª˘
->
width
 = width;

300 
de°ª˘
->
y
 = 
maxy
 + 1;

301 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

302 
de°ª˘
++;

303 
de°ª˘
->
x
 = x + 
dx
;

304 
de°ª˘
->
width
 = width - 
dx
;

305 
de°ª˘
->
y
 = 
möy
;

306 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

309 
	`GAPVAL
(1, 0, 0, 0):

310 
§¸e˘
->
width
 = 
möx
 - 
x
;

313 
	`GAPVAL
(1, 0, 0, 1):

314 
§¸e˘
->
width
 = 
möx
 - 
x
;

315 
§¸e˘
->
height
 = 
maxy
 - 
y
 + 1;

316 
de°ª˘
->
x
 = x;

317 
de°ª˘
->
width
 = width;

318 
de°ª˘
->
y
 = 
maxy
 + 1;

319 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

322 
	`GAPVAL
(1, 0, 1, 0):

323 
§¸e˘
->
height
 = 
möy
 - 
y
;

324 
de°ª˘
->
x
 = x;

325 
de°ª˘
->
width
 = 
möx
 - 
x
;

326 
de°ª˘
->
y
 = 
möy
;

327 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

330 
	`GAPVAL
(1, 0, 1, 1):

331 
§¸e˘
->
height
 = 
möy
 - 
y
;

332 
de°ª˘
->
x
 = x;

333 
de°ª˘
->
width
 = 
möx
 - 
x
;

334 
de°ª˘
->
y
 = 
möy
;

335 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

336 
de°ª˘
++;

337 
de°ª˘
->
x
 = x;

338 
de°ª˘
->
width
 = width;

339 
de°ª˘
->
y
 = 
maxy
 + 1;

340 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

343 
	`GAPVAL
(1, 1, 0, 0):

344 
de°ª˘
->
x
 = 
maxx
 + 1;

345 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

346 
de°ª˘
->
y
 = y;

347 
de°ª˘
->
height
 = height;

348 
§¸e˘
->
width
 = 
möx
 - 
x
;

351 
	`GAPVAL
(1, 1, 0, 1):

352 
dy
 = 
maxy
 - 
y
 + 1;

353 
§¸e˘
->
y
 +
dy
;

354 
§¸e˘
->
height
 -
dy
;

355 
de°ª˘
->
x
 = x;

356 
de°ª˘
->
width
 = 
möx
 - 
x
;

357 
de°ª˘
->
y
 = y;

358 
de°ª˘
->
height
 = 
dy
;

359 
de°ª˘
++;

360 
de°ª˘
->
x
 = 
maxx
 + 1;

361 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

362 
de°ª˘
->
y
 = y;

363 
de°ª˘
->
height
 = 
dy
;

366 
	`GAPVAL
(1, 1, 1, 0):

367 
§¸e˘
->
height
 = 
möy
 - 
y
;

368 
de°ª˘
->
x
 = x;

369 
de°ª˘
->
width
 = 
möx
 - 
x
;

370 
de°ª˘
->
y
 = 
möy
;

371 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

372 
de°ª˘
++;

373 
de°ª˘
->
x
 = 
maxx
 + 1;

374 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

375 
de°ª˘
->
y
 = 
möy
;

376 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

379 
	`GAPVAL
(1, 1, 1, 1):

380 
§¸e˘
->
height
 = 
möy
 - 
y
;

381 
de°ª˘
->
x
 = x;

382 
de°ª˘
->
width
 = 
möx
 - 
x
;

383 
de°ª˘
->
y
 = 
möy
;

384 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

385 
de°ª˘
++;

386 
de°ª˘
->
x
 = 
maxx
 + 1;

387 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

388 
de°ª˘
->
y
 = 
möy
;

389 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

390 
de°ª˘
++;

391 
de°ª˘
->
x
 = x;

392 
de°ª˘
->
width
 = width;

393 
de°ª˘
->
y
 = 
maxy
 + 1;

394 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

398 
	}
}

	@mwin/winclip2.c

9 
	~"wödows.h
"

10 
	~"wöã∫.h
"

20 
	$MwSëClùWödow
(
HDC
 
hdc
)

22 
HWND
 
wp
 = 
hdc
->
hwnd
;

23 
HWND
 
pwp
;

24 
HWND
 
sibwp
;

25 
MWCOORD
 
diff
;

26 
PRECT
 
¥c
;

27 
MWCLIPREGION
 *
vis
, *
r
;

28 
MWCOORD
 
x
, 
y
, 
width
, 
height
;

34 
¥c
 = 
	`MwIsClõ¡DC
(
hdc
)? &
wp
->
˛úe˘
: &wp->
wöª˘
;

35 
x
 = 
¥c
->
À·
;

36 
y
 = 
¥c
->
t›
;

37 
width
 = 
¥c
->
right
 -Örc->
À·
;

38 
height
 = 
¥c
->
bŸtom
 -Örc->
t›
;

45 
pwp
 = 
wp
;

46 
pwp
 !
roŸwp
) {

47 
pwp
 =Öwp->
∑ª¡
;

49 
diff
 = 
pwp
->
˛úe˘
.
À·
 - 
x
;

50 i‡(
diff
 > 0) {

51 
width
 -
diff
;

52 
x
 = 
pwp
->
˛úe˘
.
À·
;

55 
diff
 = 
pwp
->
˛úe˘
.
right
 - (
x
 + 
width
);

56 i‡(
diff
 < 0)

57 
width
 +
diff
;

59 
diff
 = 
pwp
->
˛úe˘
.
t›
 - 
y
;

60 i‡(
diff
 > 0) {

61 
height
 -
diff
;

62 
y
 = 
pwp
->
˛úe˘
.
t›
;

65 
diff
 = 
pwp
->
˛úe˘
.
bŸtom
 - (
y
 + 
height
);

66 i‡(
diff
 < 0)

67 
height
 +
diff
;

74 i‡(
width
 <0 || 
height
 <= 0) {

75 
	`GdSëClùRegi⁄
(
hdc
->
psd
, 
NULL
);

82 
vis
 = 
	`GdAŒocRe˘Regi⁄
(
x
, 
y
, x+
width
, y+
height
);

87 
r
 = 
	`GdAŒocRegi⁄
();

96 
pwp
 = 
wp
;

97 
pwp
 !
NULL
) {

98 
wp
 = 
pwp
;

99 
pwp
 = 
wp
->
∑ª¡
;

100 if(!
pwp
) {

102 if(
hdc
->
Êags
 & 
DCX_CLIPCHILDREN
)

104 
sibwp
 = 
roŸwp
->
chûdªn
;

105 
sibwp
 = 
NULL
;

106 
wp
 = 
NULL
;

108 if(
hdc
->
Êags
 & 
DCX_CLIPSIBLINGS
)

109 
sibwp
 = 
pwp
->
chûdªn
;

110 
sibwp
 = 
wp
;

112 ; 
sibwp
 !
wp
; sibw∞sibwp->
siblögs
) {

113 i‡(
sibwp
->
unm≠cou¡
)

116 
	`GdSëRe˘Regi⁄Indúe˘
(
r
, &
sibwp
->
wöª˘
);

117 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
r
);

121 if(
pwp
 =
roŸwp
)

132 
wp
 = 
hdc
->
hwnd
;

133 if(
wp
 !
roŸwp
 && 
	`MwIsClõ¡DC
(
hdc
)) {

134 
sibwp
=
wp
->
chûdªn
; sibwp; sibw∞sibwp->
siblögs
) {

135 i‡(
sibwp
->
unm≠cou¡
)

138 
	`GdSëRe˘Regi⁄Indúe˘
(
r
, &
sibwp
->
wöª˘
);

139 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
r
);

143 #i‡
UPDATEREGIONS


147 if(!(
hdc
->
Êags
 & 
DCX_EXCLUDEUPDATE
))

148 
	`GdI¡î£˘Regi⁄
(
vis
, vis, 
wp
->
upd©e
);

153 i‡(
hdc
->
ªgi⁄
)

154 
	`GdI¡î£˘Regi⁄
(
vis
, vis, 
hdc
->
ªgi⁄
->
rgn
);

158 
	`GdSëClùRegi⁄
(
hdc
->
psd
, 
vis
);

163 
	`GdDe°royRegi⁄
(
r
);

164 
	}
}

	@mwin/windefw.c

9 
	~"wödows.h
"

10 
	~"wöã∫.h
"

11 
	~"devi˚.h
"

12 
	~"wötoﬁs.h
"

13 
	~<°rög.h
>

16 
PMWIMAGEHDR
 
	gpImageWÆÕ≠î
 = 
NULL
;

19 
GëClo£BoxRe˘
(
HWND
 
hwnd
, 
LPRECT
 
Õrc
);

20 
DøwXORFøme
(
HWND
 
hwnd
,
x
, 
y
, 
BOOL
 
bDøwCuºít
);

21 
RECT
 
	gœ°rc
;

23 
BOOL


24 
	$MwSëDeskt›WÆÕ≠î
(
PMWIMAGEHDR
 
pImage
)

26 
pImageWÆÕ≠î
 = 
pImage
;

27 
	`InvÆid©eRe˘
(
roŸwp
, 
NULL
, 
TRUE
);

28  
TRUE
;

29 
	}
}

33 
	$DøwXORFøme
(
HWND
 
hwnd
,
x
, 
y
, 
BOOL
 
bDøwCuºít
)

35 
HDC
 
hdc
;

36 
RECT
 
rc
;

38 
hdc
 = 
	`GëDCEx
(
NULL
, NULL, 
DCX_WINDOW
|
DCX_EXCLUDEUPDATE
);

39 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

40 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_PEN
));

41 
	`GdSëMode
(
MWMODE_XOR
);

42 if(!
	`IsRe˘Em±y
(&
œ°rc
))

43 
	`Re˘™gÀ
(
hdc
, 
œ°rc
.
À·
,Üa°rc.
t›
,Üa°rc.
right
,

44 
œ°rc
.
bŸtom
);

45 
	`GëWödowRe˘
(
hwnd
, &
rc
);

46 
	`SëRe˘
(&
œ°rc
, 
rc
.
À·
+
x
,Ñc.
t›
+
y
,Ñc.
right
+x,Ñc.
bŸtom
+y);

47 if(
bDøwCuºít
)

48 
	`Re˘™gÀ
(
hdc
, 
œ°rc
.
À·
,Üa°rc.
t›
,Üa°rc.
right
,

49 
œ°rc
.
bŸtom
);

50 
	`Rñó£DC
(
NULL
, 
hdc
);

51 
	`GdSëMode
(
MWMODE_COPY
);

52 
	}
}

58 
LRESULT
 
WINAPI


59 
	$DefWödowProc
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

61 
HDC
 
hdc
;

62 
RECT
 
rc
;

63 
DWORD
 
dwStyÀ
;

64 
HBRUSH
 
hbr
;

65 
HPEN
 
h≥n
, 
hﬁd≥n
;

66 
PAINTSTRUCT
 
ps
;

67 
POINT
 
cuΩt
;

68 
x
, 
y
;

69 
HWND
 
wp
;

70 
HWND
 
ﬁdA˘ive
;

71 
COLORREF
 
¸C≠ti⁄
;

72 
LPNCCALCSIZE_PARAMS
 
Õnc
;

73 
CHAR
 
szTôÀ
[64];

74 
POINT
 
°¨çt
;

76 
msg
) {

77 
WM_NCCALCSIZE
:

79 
Õnc
 = (
LPNCCALCSIZE_PARAMS
)
lP¨am
;

80 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

81 if(
dwStyÀ
 & 
WS_BORDER
) {

82 if((
dwStyÀ
 & 
WS_CAPTION
) == WS_CAPTION) {

83 
	`InÊ©eRe˘
(&
Õnc
->
rgrc
[0],

84 -
mwSYSMETRICS_CXFRAME
,

85 -
mwSYSMETRICS_CYFRAME
);

86 
Õnc
->
rgrc
[0].
t›
 +
mwSYSMETRICS_CYCAPTION
 + 1;

88 
	`InÊ©eRe˘
(&
Õnc
->
rgrc
[0], -1, -1);

92 
WM_NCPAINT
:

94 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

96 if(
dwStyÀ
 & 
WS_BORDER
) {

97 
hdc
 = 
	`GëWödowDC
(
hwnd
);

98 
	`GëWödowRe˘
(
hwnd
, &
rc
);

100 if((
dwStyÀ
 & 
WS_CAPTION
) == WS_CAPTION) {

102 
	`Døw3dOut£t
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

103 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
);

104 
	`InÊ©eRe˘
(&
rc
, -2, -2);

107 
h≥n
 = 
	`Cª©ePí
(
PS_SOLID
, 1,

108 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

109 
hﬁd≥n
 = 
	`Sñe˘Obje˘
(
hdc
, 
h≥n
);

110 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

111 
	`Re˘™gÀ
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
,

112 
rc
.
bŸtom
);

113 
	`InÊ©eRe˘
(&
rc
, -1, -1);

116 
rc
.
bŸtom
 =Ñc.
t›
 + 
mwSYSMETRICS_CYCAPTION
;

117 
¸C≠ti⁄
 = 
	`GëA˘iveWödow
()==
hwnd
?

118 
	`GëSysCﬁ‹
(
COLOR_ACTIVECAPTION
):

119 
	`GëSysCﬁ‹
(
COLOR_INACTIVECAPTION
);

120 
hbr
 = 
	`Cª©eSﬁidBrush
(
¸C≠ti⁄
);

121 
	`FûlRe˘
(
hdc
, &
rc
, 
hbr
);

122 
	`DñëeObje˘
(
hbr
);

125 
	`MoveToEx
(
hdc
, 
rc
.
À·
,Ñc.
bŸtom
, 
NULL
);

126 
	`LöeTo
(
hdc
, 
rc
.
right
,Ñc.
bŸtom
);

127 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
, 
hﬁd≥n
));

130 if(
	`GëWödowText
(
hwnd
, 
szTôÀ
,

131 (
szTôÀ
))) {

132 
	`SëBkMode
(
hdc
, 
TRANSPARENT
);

139 
	`SëBkCﬁ‹
(
hdc
, 
¸C≠ti⁄
);

140 
	`SëTextCﬁ‹
(
hdc
,

141 
	`GëA˘iveWödow
()==
hwnd
?

142 
	`GëSysCﬁ‹
(
COLOR_CAPTIONTEXT
):

143 
	`GëSysCﬁ‹
(
COLOR_INACTIVECAPTIONTEXT
));

144 
	`Sñe˘Obje˘
(
hdc
,

145 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

146 
	`GëWödowRe˘
(
hwnd
, &
rc
);

147 
	`TextOut
(
hdc
, 
rc
.
À·
+4,Ñc.
t›
+2,

148 
szTôÀ
, 
	`°æí
(szTitle));

152 
	`GëClo£BoxRe˘
(
hwnd
, &
rc
);

155 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

156 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

157 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
),

158 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
));

159 
	`InÊ©eRe˘
(&
rc
, -1, -1);

160 
hbr
 = 
	`Cª©eSﬁidBrush
(

161 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

162 
	`FûlRe˘
(
hdc
, &
rc
, 
hbr
);

163 
	`DñëeObje˘
(
hbr
);

165 
	`InÊ©eRe˘
(&
rc
, -1, -1);

166 
	`MoveToEx
(
hdc
, 
rc
.
À·
,Ñc.
t›
, 
NULL
);

167 
	`LöeTo
(
hdc
, 
rc
.
right
-1,Ñc.
bŸtom
-1);

168 
	`MoveToEx
(
hdc
, 
rc
.
À·
,Ñc.
bŸtom
-1, 
NULL
);

169 
	`LöeTo
(
hdc
, 
rc
.
right
-1,Ñc.
t›
);

171 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

172 
	`Re˘™gÀ
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
,

173 
rc
.
bŸtom
);

175 
	`Rñó£DC
(
hwnd
, 
hdc
);

179 
WM_NCHITTEST
:

181 if(
døgwp
)

182  
HTCAPTION
;

185 
	`POINTSTOPOINT
(
cuΩt
, 
lP¨am
);

187 if(
	`PtInRe˘
(&
hwnd
->
˛úe˘
, 
cuΩt
))

188  
HTCLIENT
;

190 if(
	`PtInRe˘
(&
hwnd
->
vs¸ﬁl
.
rc
, 
cuΩt
))

191  
HTVSCROLL
;

192 if(
	`PtInRe˘
(&
hwnd
->
hs¸ﬁl
.
rc
, 
cuΩt
))

193  
HTHSCROLL
;

195 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

196 if((
dwStyÀ
 & 
WS_CAPTION
) == WS_CAPTION) {

197 
	`GëClo£BoxRe˘
(
hwnd
, &
rc
);

198 if(
	`PtInRe˘
(&
rc
, 
cuΩt
))

199  
HTCLOSE
;

201 
	`GëWödowRe˘
(
hwnd
, &
rc
);

202 
	`InÊ©eRe˘
(&
rc
, -2, -2);

203 
rc
.
bŸtom
 =Ñc.
t›
 + 
mwSYSMETRICS_CYCAPTION
;

204 if(
	`PtInRe˘
(&
rc
, 
cuΩt
))

205  
HTCAPTION
;

207 
	`GëWödowRe˘
(
hwnd
, &
rc
);

208 
	`InÊ©eRe˘
(&
rc
, -2, -2);

209 
rc
.
t›
 +
mwSYSMETRICS_CYCAPTION
;

210 if(
	`PtInRe˘
(&
rc
, 
cuΩt
))

211  
HTCLIENT
;

213  
HTBORDER
;

215  
HTNOWHERE
;

217 
WM_NCLBUTTONDOWN
:

219 if(
wP¨am
 =
HTCLOSE
) {

220 
	`SídMesßge
(
hwnd
, 
WM_CLOSE
, 0, 0L);

225 
ﬁdA˘ive
 = 
	`GëA˘iveWödow
();

226 if(
wP¨am
 =
HTCLIENT
 || wP¨am =
HTVSCROLL
 ||

227 
wP¨am
 =
HTHSCROLL
)

230 
	`SëF‹egroundWödow
(
hwnd
);

234 
	`SëFocus
(
hwnd
);

237 
	`Upd©eWödow
(
ﬁdA˘ive
);

238 
	`Upd©eWödow
(
hwnd
);

240 if(
wP¨am
 =
HTVSCROLL
 || wP¨am =
HTHSCROLL
) {

241 
	`MwH™dÀNCMesßgeS¸ﬁlb¨
(
hwnd
, 
msg
, 
wP¨am
, 
lP¨am
);

246 if(
wP¨am
 =
HTCAPTION
 && 
hwnd
 !
roŸwp
) {

247 
	`POINTSTOPOINT
(
°¨çt
, 
lP¨am
);

248 if(!(
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
Ë& 
WS_MAXIMIZE
))

249 
døgwp
 = 
hwnd
;

250 
	`SëRe˘Em±y
(&
œ°rc
);

254 
WM_NCMOUSEMOVE
:

255 if(
wP¨am
 =
HTVSCROLL
 || wP¨am =
HTHSCROLL
) {

256 
	`MwH™dÀNCMesßgeS¸ﬁlb¨
(
hwnd
, 
msg
, 
wP¨am
, 
lP¨am
);

261 if(
døgwp
 =
hwnd
) {

262 
	`POINTSTOPOINT
(
cuΩt
, 
lP¨am
);

263 
x
 = 
cuΩt
.x - 
°¨çt
.x;

264 
y
 = 
cuΩt
.y - 
°¨çt
.y;

266 if(
mwERASEMOVE
) {

267 
	`GëWödowRe˘
(
hwnd
, &
rc
);

268 
	`MoveWödow
(
hwnd
, 
rc
.
À·
+
x
,Ñc.
t›
+
y
,

269 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

270 
TRUE
);

271 
°¨çt
 = 
cuΩt
;

273 
	`DøwXORFøme
(
hwnd
, 
x
, 
y
, 
TRUE
);

277 
WM_NCLBUTTONUP
:

279 if(
døgwp
 =
hwnd
) {

280 
døgwp
 = 
NULL
;

282 if(
mwERASEMOVE
) {

287 
wp
=
li°wp
; wp; wp=wp->
√xt
)

288 if(
wp
->
gŸPaötMsg
 =
PAINT_DELAYPAINT
)

289 
wp
->
gŸPaötMsg
 = 
PAINT_NEEDSPAINT
;

291 
	`POINTSTOPOINT
(
cuΩt
, 
lP¨am
);

292 
x
 = 
cuΩt
.x - 
°¨çt
.x;

293 
y
 = 
cuΩt
.y - 
°¨çt
.y;

294 
	`DøwXORFøme
(
hwnd
, 
x
, 
y
, 
FALSE
);

295 
	`GëWödowRe˘
(
hwnd
, &
rc
);

296 
	`MoveWödow
(
hwnd
, 
rc
.
À·
+
x
,Ñc.
t›
+
y
,

297 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
, 
TRUE
);

301 if(
wP¨am
 =
HTVSCROLL
 || wP¨am =
HTHSCROLL
) {

302 
	`MwH™dÀNCMesßgeS¸ﬁlb¨
(
hwnd
, 
msg
, 
wP¨am
, 
lP¨am
);

307 
WM_NCLBUTTONDBLCLK
:

308 if(
wP¨am
 =
HTVSCROLL
 || wP¨am =
HTHSCROLL
) {

309 
	`MwH™dÀNCMesßgeS¸ﬁlb¨
(
hwnd
, 
msg
, 
wP¨am
, 
lP¨am
);

314 if(
wP¨am
 !
HTCAPTION
)

317 if((
hwnd
->
°yÀ
 & 
WS_CAPTION
) == WS_CAPTION) {

318 if(
hwnd
->
°yÀ
 & 
WS_MAXIMIZE
) {

319 
rc
 = 
hwnd
->
ª°‹îc
;

320 
	`MoveWödow
(
hwnd
, 
rc
.
À·
,Ñc.
t›
,

321 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

322 
TRUE
);

323 
hwnd
->
°yÀ
 &~
WS_MAXIMIZE
;

325 
hwnd
->
ª°‹îc
 = hwnd->
wöª˘
;

326 
	`GëWödowRe˘
(
roŸwp
, &
rc
);

327 
	`MoveWödow
(
hwnd
, -
mwSYSMETRICS_CXFRAME
,

328 -
mwSYSMETRICS_CYFRAME
,

329 
rc
.
right
+2*
mwSYSMETRICS_CXFRAME
,

330 
rc
.
bŸtom
+2*
mwSYSMETRICS_CYFRAME
, 
TRUE
);

331 
hwnd
->
°yÀ
 |
WS_MAXIMIZE
;

336 
WM_GETTEXTLENGTH
:

340  
	`°æí
(
hwnd
->
szTôÀ
);

342 
WM_GETTEXT
:

346  
	`°rz˝y
((
LPSTR
)
lP¨am
, 
hwnd
->
szTôÀ
, 
wP¨am
);

348 
WM_SETTEXT
:

353 
	`°rz˝y
(
hwnd
->
szTôÀ
, (
LPSTR
)
lP¨am
, (hwnd->szTitle));

354  
TRUE
;

356 
WM_CLOSE
:

357 
	`De°royWödow
(
hwnd
);

358 if(
hwnd
 =
roŸwp
)

359 
	`Po°QuôMesßge
(0);

362 
WM_ERASEBKGND
:

364 
hbr
 = (
HBRUSH
)
	`GëCœssL⁄g
(
hwnd
, 
GCL_HBRBACKGROUND
);

365 if(!
hbr
)

368 
hdc
 = 
	`GëDCEx
(
hwnd
, 
NULL
, 
DCX_DEFAULTCLIP
);

369 
	`FûlRe˘
(
hdc
, 
NULL
, 
hbr
);

370 
	`Rñó£DC
(
hwnd
, 
hdc
);

373 
WM_PAINT
:

375 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

378 if(
hwnd
 =
roŸwp
 && 
pImageWÆÕ≠î
) {

379 
	`GëWödowRe˘
(
hwnd
, &
rc
);

380 
	`DøwDIB
(
hdc
,

381 (
rc
.
right
-rc.
À·
-
pImageWÆÕ≠î
->
width
)/2,

382 (
rc
.
bŸtom
-rc.
t›
-
pImageWÆÕ≠î
->
height
)/2,

383 
pImageWÆÕ≠î
);

386 
	`EndPaöt
(
hwnd
, &
ps
);

390 
	}
}

393 
	$GëClo£BoxRe˘
(
HWND
 
hwnd
, 
LPRECT
 
Õrc
)

395 
	#XSIZE_CLOSEBOX
 9

	)

396 
	#YSIZE_CLOSEBOX
 9

	)

397 
	`GëWödowRe˘
(
hwnd
, 
Õrc
);

398 
Õrc
->
À·
 =Ü¥c->
right
 - 
XSIZE_CLOSEBOX
 - 5;

399 
Õrc
->
t›
 =Üprc->top + 5;

400 
Õrc
->
right
 =Ü¥c->
À·
 + 
XSIZE_CLOSEBOX
;

401 
Õrc
->
bŸtom
 =Ü¥c->
t›
 + 
YSIZE_CLOSEBOX
;

402 
	}
}

	@mwin/winevent.c

9 
	~"wödows.h
"

10 
	~"wöã∫.h
"

11 
	~"devi˚.h
"

12 
	~<°dio.h
>

13 
	~<°dlib.h
>

14 
	~<°rög.h
>

16 #i‡!(
DOS_TURBOC
 | 
DOS_QUICKC
 | 
_MINIX
 | 
VXWORKS
 | 
PSP
)

18 
	$abs
(
n
)

20  
n
 >= 0?Ç: -n;

21 
	}
}

29 
BOOL


30 
	$MwCheckMou£Evít
()

32 
MWCOORD
 
roŸx
;

33 
MWCOORD
 
roŸy
;

34 
√wbuâ⁄s
;

35 
mou£°©us
;

38 
mou£°©us
 = 
	`GdRódMou£
(&
roŸx
, &
roŸy
, &
√wbuâ⁄s
);

39 if(
mou£°©us
 < 0) {

41  
FALSE
;

42 } if(
mou£°©us
) {

43 
	`MwH™dÀMou£Sètus
(
roŸx
, 
roŸy
, 
√wbuâ⁄s
);

44  
TRUE
;

46  
FALSE
;

47 
	}
}

54 
BOOL


55 
	$MwCheckKeybﬂrdEvít
()

57 
MWKEY
 
mwkey
;

58 
MWKEYMOD
 
modifõrs
;

59 
MWSCANCODE
 
sˇncode
;

60 
key°©us
;

63 
key°©us
 = 
	`GdRódKeybﬂrd
(&
mwkey
, &
modifõrs
, &
sˇncode
);

64 if(
key°©us
 < 0) {

65 if(
key°©us
 == -2)

66 
	`MwTîmö©e
();

68  
FALSE
;

69 } if(
key°©us
) {

70 
mwkey
) {

71 
MWKEY_QUIT
:

72 
	`MwTîmö©e
();

74 
MWKEY_REDRAW
:

75 
	`MwRedøwS¸ìn
();

77 
MWKEY_PRINT
:

78 i‡(
key°©us
 == 1)

79 
	`GdC≠tuªS¸ìn
("screen.bmp");

82 
	`MwDñivîKeybﬂrdEvít
(
mwkey
, 
modifõrs
, 
sˇncode
,

83 
key°©us
==1? 
TRUE
: 
FALSE
);

84  
TRUE
;

86  
FALSE
;

87 
	}
}

95 
	$MwH™dÀMou£Sètus
(
MWCOORD
 
√wx
, MWCOORD 
√wy
, 
√wbuâ⁄s
)

97 
ch™gebuâ⁄s
;

98 
MWKEYMOD
 
modifõrs
;

99 
curbuâ⁄s
;

101 
	`GdGëModifõrInfo
(
NULL
, &
modifõrs
);

109 i‡(
√wx
 !
curs‹x
 || 
√wy
 !
curs‹y
) {

110 
	`MwMoveCurs‹
(
√wx
, 
√wy
);

111 
	`MwDñivîMou£Evít
(
√wbuâ⁄s
, 0, 
modifõrs
);

117 
ch™gebuâ⁄s
 = (
curbuâ⁄s
 & ~
√wbuâ⁄s
);

118 i‡(
ch™gebuâ⁄s
)

119 
	`MwDñivîMou£Evít
(
√wbuâ⁄s
, 
ch™gebuâ⁄s
, 
modifõrs
);

125 
ch™gebuâ⁄s
 = (~
curbuâ⁄s
 & 
√wbuâ⁄s
);

126 i‡(
ch™gebuâ⁄s
)

127 
	`MwDñivîMou£Evít
(
√wbuâ⁄s
, 
ch™gebuâ⁄s
, 
modifõrs
);

129 
curbuâ⁄s
 = 
√wbuâ⁄s
;

130 
	}
}

136 
	$MwTøn¶©eMou£Mesßge
(
HWND
 
hwnd
,
UINT
 
msg
,
hôã°
)

138 
POINT
 
±
;

139 
DWORD
 
tick
;

140 
UINT
 
œ°msg
 = 0;

141 
HWND
 
œ°hwnd
;

142 
DWORD
 
œ°tick
;

143 
œ°x
, 
œ°y
;

146 if(
msg
 =
WM_LBUTTONDOWN
 || msg =
WM_RBUTTONDOWN
) {

147 
tick
 = 
	`GëTickCou¡
();

148 if((
hwnd
->
pCœss
->
°yÀ
 & 
CS_DBLCLKS
) &&

149 
msg
 =
œ°msg
 && 
hwnd
 =
œ°hwnd
 &&

150 
tick
 - 
œ°tick
 < 
DBLCLICKSPEED
 &&

151 
	`abs
(
curs‹x
-
œ°x
Ë< 
mwSYSMETRICS_CXDOUBLECLK
 &&

152 
	`abs
(
curs‹y
-
œ°y
Ë< 
mwSYSMETRICS_CYDOUBLECLK
)

153 
msg
 +(
WM_LBUTTONDBLCLK
 - 
WM_LBUTTONDOWN
);

154 
œ°msg
 = 
msg
;

155 
œ°hwnd
 = 
hwnd
;

156 
œ°tick
 = 
tick
;

157 
œ°x
 = 
curs‹x
;

158 
œ°y
 = 
curs‹y
;

165 
	`Po°Mesßge
(
hwnd
, 
msg
 + (
WM_NCMOUSEMOVE
-
WM_MOUSEMOVE
), 
hôã°
,

166 
	`MAKELONG
(
curs‹x
, 
curs‹y
));

169 if(
hôã°
 =
HTCLIENT
) {

170 
±
.
x
 = 
curs‹x
;

171 
±
.
y
 = 
curs‹y
;

172 
	`S¸ìnToClõ¡
(
hwnd
, &
±
);

173 
	`Po°Mesßge
(
hwnd
, 
msg
, 0, 
	`MAKELONG
(
±
.
x
,Öt.
y
));

175 
	}
}

180 
	gmwCuºítBuâ⁄s
;

183 
	$MwDñivîMou£Evít
(
buâ⁄s
, 
ch™gebuâ⁄s
, 
MWKEYMOD
 
modifõrs
)

185 
HWND
 
hwnd
;

186 
hôã°
;

187 
UINT
 
msg
;

189 
mwCuºítBuâ⁄s
 = 
buâ⁄s
;

191 
hwnd
 = 
	`GëC≠tuª
();

192 if(!
hwnd
)

193 
hwnd
 = 
mou£wp
;

194 
hôã°
 = 
	`SídMesßge
(
hwnd
, 
WM_NCHITTEST
, 0, 
	`MAKELONG
(
curs‹x
,
curs‹y
));

196 if(!
ch™gebuâ⁄s
)

197 
	`MwTøn¶©eMou£Mesßge
(
hwnd
, 
WM_MOUSEMOVE
, 
hôã°
);

199 if(
ch™gebuâ⁄s
 & 
MWBUTTON_L
) {

200 
msg
 = (
buâ⁄s
&
MWBUTTON_L
)? 
WM_LBUTTONDOWN
: 
WM_LBUTTONUP
;

201 
	`MwTøn¶©eMou£Mesßge
(
hwnd
, 
msg
, 
hôã°
);

204 if(
ch™gebuâ⁄s
 & 
MWBUTTON_M
) {

205 
msg
 = (
buâ⁄s
&
MWBUTTON_M
)? 
WM_MBUTTONDOWN
: 
WM_MBUTTONUP
;

206 
	`MwTøn¶©eMou£Mesßge
(
hwnd
, 
msg
, 
hôã°
);

209 if(
ch™gebuâ⁄s
 & 
MWBUTTON_R
) {

210 
msg
 = (
buâ⁄s
&
MWBUTTON_R
)? 
WM_RBUTTONDOWN
: 
WM_RBUTTONUP
;

211 
	`MwTøn¶©eMou£Mesßge
(
hwnd
, 
msg
, 
hôã°
);

213 
	}
}

219 
	$MwDñivîKeybﬂrdEvít
(
MWKEY
 
keyvÆue
, 
MWKEYMOD
 
modifõrs
, 
MWSCANCODE
 
sˇncode
,

220 
BOOL
 
¥es£d
)

222 
WPARAM
 
VK_Code
 = 
keyvÆue
;

225 i‡(
keyvÆue
 < 1 || keyvalue > 255)

226 
keyvÆue
) {

229 
MWKEY_LEFT
:

230 
VK_Code
 = 
VK_LEFT
;

232 
MWKEY_RIGHT
:

233 
VK_Code
 = 
VK_RIGHT
;

235 
MWKEY_UP
:

236 
VK_Code
 = 
VK_UP
;

238 
MWKEY_DOWN
:

239 
VK_Code
 = 
VK_DOWN
;

241 
MWKEY_INSERT
:

242 
VK_Code
 = 
VK_INSERT
;

244 
MWKEY_DELETE
:

245 
VK_Code
 = 
VK_DELETE
;

247 
MWKEY_HOME
:

248 
VK_Code
 = 
VK_HOME
;

250 
MWKEY_END
:

251 
VK_Code
 = 
VK_END
;

253 
MWKEY_PAGEUP
:

254 
VK_Code
 = 
VK_PRIOR
;

256 
MWKEY_PAGEDOWN
:

257 
VK_Code
 = 
VK_NEXT
;

261 
MWKEY_KP0
:

262 
VK_Code
 = 
VK_NUMPAD0
;

264 
MWKEY_KP1
:

265 
VK_Code
 = 
VK_NUMPAD1
;

267 
MWKEY_KP2
:

268 
VK_Code
 = 
VK_NUMPAD2
;

270 
MWKEY_KP3
:

271 
VK_Code
 = 
VK_NUMPAD3
;

273 
MWKEY_KP4
:

274 
VK_Code
 = 
VK_NUMPAD4
;

276 
MWKEY_KP5
:

277 
VK_Code
 = 
VK_NUMPAD5
;

279 
MWKEY_KP6
:

280 
VK_Code
 = 
VK_NUMPAD6
;

282 
MWKEY_KP7
:

283 
VK_Code
 = 
VK_NUMPAD7
;

285 
MWKEY_KP8
:

286 
VK_Code
 = 
VK_NUMPAD8
;

288 
MWKEY_KP9
:

289 
VK_Code
 = 
VK_NUMPAD9
;

291 
MWKEY_KP_PERIOD
:

292 
VK_Code
 = 
VK_DECIMAL
;

294 
MWKEY_KP_DIVIDE
:

295 
VK_Code
 = 
VK_DIVIDE
;

297 
MWKEY_KP_MULTIPLY
:

298 
VK_Code
 = 
VK_MULTIPLY
;

300 
MWKEY_KP_MINUS
:

301 
VK_Code
 = 
VK_SUBTRACT
;

303 
MWKEY_KP_PLUS
:

304 
VK_Code
 = 
VK_ADD
;

306 
MWKEY_KP_ENTER
:

307 
VK_Code
 = 
VK_RETURN
;

311 
MWKEY_F1
:

312 
VK_Code
 = 
VK_F1
;

314 
MWKEY_F2
:

315 
VK_Code
 = 
VK_F2
;

317 
MWKEY_F3
:

318 
VK_Code
 = 
VK_F3
;

320 
MWKEY_F4
:

321 
VK_Code
 = 
VK_F4
;

323 
MWKEY_F5
:

324 
VK_Code
 = 
VK_F5
;

326 
MWKEY_F6
:

327 
VK_Code
 = 
VK_F6
;

329 
MWKEY_F7
:

330 
VK_Code
 = 
VK_F7
;

332 
MWKEY_F8
:

333 
VK_Code
 = 
VK_F8
;

335 
MWKEY_F9
:

336 
VK_Code
 = 
VK_F9
;

338 
MWKEY_F10
:

339 
VK_Code
 = 
VK_F10
;

341 
MWKEY_F11
:

342 
VK_Code
 = 
VK_F11
;

344 
MWKEY_F12
:

345 
VK_Code
 = 
VK_F12
;

349 
MWKEY_NUMLOCK
:

350 
VK_Code
 = 
VK_NUMLOCK
;

352 
MWKEY_CAPSLOCK
:

353 
VK_Code
 = 
VK_CAPITAL
;

355 
MWKEY_SCROLLOCK
:

356 
VK_Code
 = 
VK_CAPITAL
;

358 
MWKEY_LSHIFT
:

359 
VK_Code
 = 
VK_LSHIFT
;

361 
MWKEY_RSHIFT
:

362 
VK_Code
 = 
VK_RSHIFT
;

364 
MWKEY_LCTRL
:

365 
VK_Code
 = 
VK_LCONTROL
;

367 
MWKEY_RCTRL
:

368 
VK_Code
 = 
VK_RCONTROL
;

370 
MWKEY_LALT
:

371 
VK_Code
 = 
VK_MENU
;

373 
MWKEY_RALT
:

374 
VK_Code
 = 
VK_MENU
;

378 
MWKEY_PRINT
:

379 
VK_Code
 = 
VK_PRINT
;

381 
MWKEY_PAUSE
:

382 
VK_Code
 = 
VK_PAUSE
;

384 
MWKEY_MENU
:

385 
VK_Code
 = 
VK_LMENU
;

389 
MWKEY_KP_EQUALS
:

390 
VK_Code
 = '=';

395 
MWKEY_UNKNOWN
:

396 
MWKEY_SYSREQ
:

397 
MWKEY_BREAK


398 
MWKEY_QUIT
:

399 
MWKEY_REDRAW
:

400 
MWKEY_LMETA
:

401 
MWKEY_RMETA
:

402 
MWKEY_ALTGR
:

404 
MWKEY_RECORD
:

405 
MWKEY_PLAY
:

406 
MWKEY_CONTRAST
:

407 
MWKEY_BRIGHTNESS
:

408 
MWKEY_SELECTUP
:

409 
MWKEY_SELECTDOWN
:

410 
MWKEY_ACCEPT
:

411 
MWKEY_CANCEL
:

412 
MWKEY_APP1
:

413 
MWKEY_APP2
:

414 
MWKEY_LAST
:

417 
VK_Code
 = 
VK_NONAME
;

421 i‡(
¥es£d
)

422 
	`Po°Mesßge
(
focuswp
, 
WM_KEYDOWN
, 
VK_Code
, 0L);

424 
	`Po°Mesßge
(
focuswp
, 
WM_KEYUP
, 
VK_Code
, 0L);

425 
	}
}

434 
	$MwDñivîExposuªEvít
(
HWND
 
wp
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

435 
MWCOORD
 
height
)

437 i‡(
wp
->
unm≠cou¡
)

440 
	`MwUni⁄Upd©eRegi⁄
(
wp
, 
x
, 
y
, 
width
, 
height
, 
TRUE
);

441 
	`Po°Mesßge
(
wp
, 
WM_PAINT
, 0, 0L);

442 
	}
}

450 
	$MwUni⁄Upd©eRegi⁄
(
HWND
 
wp
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
,

451 
MWCOORD
 
height
, 
BOOL
 
bUni⁄
)

453 #i‡
UPDATEREGIONS


454 
MWRECT
 
rc
;

456 i‡(
wp
->
unm≠cou¡
)

460 
rc
.
À·
 = 
x
 + 
wp
->
wöª˘
.left;

461 
rc
.
t›
 = 
y
 + 
wp
->
wöª˘
.top;

462 
rc
.
right
 =Ñc.
À·
 + 
width
;

463 
rc
.
bŸtom
 =Ñc.
t›
 + 
height
;

465 if(
bUni⁄
)

466 
	`GdUni⁄Re˘WôhRegi⁄
(&
rc
, 
wp
->
upd©e
);

468 
	`GdSubåa˘Re˘FromRegi⁄
(&
rc
, 
wp
->
upd©e
);

470 
	}
}

479 
	$MwMoveCurs‹
(
MWCOORD
 
x
, MWCOORD 
y
)

485 i‡(
x
 !
curs‹x
 || 
y
 !
curs‹y
) {

486 if(
curcurs‹
)

487 
	`GdMoveCurs‹
(
x
 - 
curcurs‹
->
curs‹
.
hŸx
,

488 
y
 - 
curcurs‹
->
curs‹
.
hŸy
);

489 
curs‹x
 = 
x
;

490 
curs‹y
 = 
y
;

497 
	`MwCheckMou£Wödow
();

498 
	`MwCheckCurs‹
();

499 
	}
}

505 
	$MwCheckCurs‹
()

507 
HWND
 
wp
;

508 
HCURSOR
 
˝
;

515 
wp
 = 
ˇ±uªwp
;

516 i‡(
wp
 =
NULL
)

517 
wp
 = 
mou£wp
;

519 
˝
 = 
wp
->
curs‹
;

520 i‡(
˝
 =
curcurs‹
)

526 
curcurs‹
 = 
˝
;

527 
	`GdMoveCurs‹
(
curs‹x
 - 
˝
->
curs‹
.
hŸx
, 
curs‹y
 - cp->curs‹.
hŸy
);

528 
	`GdSëCurs‹
(&
˝
->
curs‹
);

529 
	}
}

537 
HWND


538 
	$MwFödVisibÀWödow
(
MWCOORD
 
x
, MWCOORD 
y
)

540 
HWND
 
wp
;

541 
HWND
 
ªtwp
;

543 
wp
 = 
roŸwp
;

544 
ªtwp
 = 
wp
;

545 
wp
) {

546 i‡(!
wp
->
unm≠cou¡
 &&

547 
wp
->
wöª˘
.
À·
 <
x
 && wp->wöª˘.
t›
 <
y
 &&

548 
wp
->
wöª˘
.
right
 > 
x
 && wp->wöª˘.
bŸtom
 > 
y
) {

549 
ªtwp
 = 
wp
;

550 
wp
 = wp->
chûdªn
;

553 
wp
 = wp->
siblögs
;

555  
ªtwp
;

556 
	}
}

561 
	$MwCheckMou£Wödow
()

563 
HWND
 
wp
;

566 
wp
 = 
døgwp
;

567 if(!
wp
)

568 
wp
 = 
ˇ±uªwp
;

569 if(!
wp
)

570 
wp
 = 
	`MwFödVisibÀWödow
(
curs‹x
, 
curs‹y
);

571 
mou£wp
 = 
wp
;

572 
	}
}

579 
	$°rz˝y
(*
d°
,c⁄° *
§c
,
d°siz
)

581 
cc
 = 
d°siz
;

584 if(!
§c
)

585 
cc
 = 
d°siz
 = 1;

587 --
d°siz
 > 0) {

588 if((*
d°
++ = *
§c
++) == '\0')

589  
cc
 - 
d°siz
 - 1;

591 *
d°
 = 0;

592  
cc
 - 
d°siz
 - 1;

593 
	}
}

	@mwin/winexpos.c

7 
	~"wödows.h
"

8 
	~"wöã∫.h
"

9 
	~<°dlib.h
>

13 
	$MwRedøwS¸ìn
()

16 
	`MwExpo£Aªa
(
roŸwp
, 0, 0,ÑoŸwp->
wöª˘
.
right
,

17 
roŸwp
->
wöª˘
.
bŸtom
);

20 
	`Po°Mesßge
(
roŸwp
, 
WM_PAINT
, 0, 0L);

21 
	}
}

30 
	$MwHideWödow
(
HWND
 
hwnd
,
BOOL
 
bCh™geFocus
, BOOL 
bSídMsg
)

32 
HWND
 
wp
 = 
hwnd
;

33 
HWND
 
pwp
;

34 
HWND
 
sibwp
;

35 
HWND
 
chûdwp
;

37 i‡(
wp
 =
roŸwp
)

40 ++
mw∑ötNC
;

43 if(
bSídMsg
 && 
wp
->
unm≠cou¡
 == 0)

44 
	`SídMesßge
(
wp
, 
WM_SHOWWINDOW
, 
FALSE
, 0L);

46 
wp
->
unm≠cou¡
++;

48 
chûdwp
 = 
wp
->
chûdªn
; chûdwp; chûdw∞chûdwp->
siblögs
)

49 
	`MwHideWödow
(
chûdwp
, 
bCh™geFocus
, 
bSídMsg
);

51 i‡(
wp
 =
mou£wp
) {

52 
	`MwCheckMou£Wödow
();

53 
	`MwCheckCurs‹
();

56 i‡(
bCh™geFocus
 && 
wp
 =
focuswp
)

57 
	`SëFocus
(
roŸwp
->
chûdªn
?Ñootwp->children:Ñootwp);

62 i‡(
wp
->
∑ª¡
->
unm≠cou¡
)

69 
pwp
 = 
wp
->
∑ª¡
;

70 
	`MwCÀ¨Wödow
(
pwp
, 
wp
->
wöª˘
.
À·
 -Öwp->winrect.left,

71 
wp
->
wöª˘
.
t›
 - 
pwp
->winrect.top,

72 
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
,

73 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
, 
TRUE
);

79 
sibwp
 = 
wp
;

80 
sibwp
->
siblögs
) {

81 
sibwp
 = sibwp->
siblögs
;

82 
	`MwExpo£Aªa
(
sibwp
, 
wp
->
wöª˘
.
À·
, wp->wöª˘.
t›
,

83 
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
,

84 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
);

86 
	}
}

95 
	$MwShowWödow
(
HWND
 
hwnd
, 
BOOL
 
bSídMsg
)

97 
HWND
 
wp
 = 
hwnd
;

99 i‡(
wp
 =
roŸwp
)

102 ++
mw∑ötNC
;

104 i‡(
wp
->
unm≠cou¡
)

105 
wp
->
unm≠cou¡
--;

107 i‡(
wp
->
unm≠cou¡
 == 0) {

108 
	`SídMesßge
(
wp
, 
WM_SHOWWINDOW
, 
TRUE
, 0L);

109 
	`MwCheckMou£Wödow
();

110 
	`MwCheckCurs‹
();

118 i‡(
wp
->
unm≠cou¡
 == 0) {

120 
	`MwCÀ¨Wödow
(
wp
, 0, 0, wp->
wöª˘
.
right
 - wp->wöª˘.
À·
,

121 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
, 
TRUE
);

127 
wp
 = wp->
chûdªn
; wp; w∞wp->
siblögs
)

128 
	`MwShowWödow
(
wp
, 
bSídMsg
);

129 
	}
}

135 
	$MwRai£Wödow
(
HWND
 
hwnd
)

137 
HWND
 
wp
 = 
hwnd
;

138 
HWND
 
¥evwp
;

139 
BOOL
 
ovîœp
;

141 i‡(!
wp
 || w∞=
roŸwp
)

144 ++
mw∑ötNC
;

149 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

150 i‡(
¥evwp
 =
wp
)

158 
ovîœp
 = 
FALSE
;

159 
¥evwp
->
siblögs
 !
wp
) {

160 
ovîœp
 |
	`MwCheckOvîœp
(
¥evwp
, 
wp
);

161 
¥evwp
 =Öªvwp->
siblögs
;

163 
ovîœp
 |
	`MwCheckOvîœp
(
¥evwp
, 
wp
);

169 
¥evwp
->
siblögs
 = 
wp
->siblings;

170 
wp
->
siblögs
 = wp->
∑ª¡
->
chûdªn
;

171 
wp
->
∑ª¡
->
chûdªn
 = wp;

176 i‡(
ovîœp
) {

178 
	`MwExpo£Aªa
(
wp
, wp->
wöª˘
.
À·
, wp->wöª˘.
t›
,

179 
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
,

180 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
);

182 
	}
}

188 
	$MwLowîWödow
(
HWND
 
hwnd
)

190 
HWND
 
wp
 = 
hwnd
;

191 
HWND
 
¥evwp
;

192 
HWND
 
sibwp
;

193 
HWND
 
expwp
;

195 i‡(!
wp
 || w∞=
roŸwp
 || !wp->
siblögs
)

198 ++
mw∑ötNC
;

203 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

204 i‡(
¥evwp
 !
wp
) {

205 
¥evwp
->
siblögs
 !
wp
)

206 
¥evwp
 =Öªvwp->
siblögs
;

214 
expwp
 = 
wp
->
siblögs
;

215 
sibwp
 = 
wp
;

216 
sibwp
->
siblögs
)

217 
sibwp
 = sibwp->
siblögs
;

223 i‡(
¥evwp
 =
wp
)

224 
wp
->
∑ª¡
->
chûdªn
 = wp->
siblögs
;

226 
¥evwp
->
siblögs
 = 
wp
->siblings;

227 
sibwp
->
siblögs
 = 
wp
;

229 
wp
->
siblögs
 = 
NULL
;

235 
expwp
 && (expw∞!
wp
)) {

236 i‡(
	`MwCheckOvîœp
(
wp
, 
expwp
))

237 
	`MwExpo£Aªa
(
expwp
, 
wp
->
wöª˘
.
À·
, wp->wöª˘.
t›
,

238 
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
,

239 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
);

240 
expwp
 =Éxpwp->
siblögs
;

242 
	}
}

247 
BOOL


248 
	$MwCheckOvîœp
(
HWND
 
t›wp
, HWND 
bŸwp
)

250 
MWCOORD
 
möx1
;

251 
MWCOORD
 
möy1
;

252 
MWCOORD
 
maxx1
;

253 
MWCOORD
 
maxy1
;

254 
MWCOORD
 
möx2
;

255 
MWCOORD
 
möy2
;

256 
MWCOORD
 
maxx2
;

257 
MWCOORD
 
maxy2
;

259 i‡(
t›wp
->
unm≠cou¡
 || 
bŸwp
->unmapcount)

260  
FALSE
;

262 
möx1
 = 
t›wp
->
wöª˘
.
À·
;

263 
möy1
 = 
t›wp
->
wöª˘
.
t›
;

264 
maxx1
 = 
t›wp
->
wöª˘
.
right
 - 1;

265 
maxy1
 = 
t›wp
->
wöª˘
.
bŸtom
 - 1;

267 
möx2
 = 
bŸwp
->
wöª˘
.
À·
;

268 
möy2
 = 
bŸwp
->
wöª˘
.
t›
;

269 
maxx2
 = 
bŸwp
->
wöª˘
.
right
 - 1;

270 
maxy2
 = 
bŸwp
->
wöª˘
.
bŸtom
 - 1;

272 i‡(
möx1
 > 
maxx2
 || 
möx2
 > 
maxx1
 || 
möy1
 > 
maxy2
 || 
möy2
 > 
maxy1
)

273  
FALSE
;

275  
TRUE
;

276 
	}
}

284 
	$MwCÀ¨Wödow
(
HWND
 
wp
, 
MWCOORD
 
x
, MWCOORD 
y
, MWCOORD 
width
, MWCOORD 
height
,

285 
BOOL
 
expo£Êag
)

287 i‡(
wp
->
unm≠cou¡
)

293 i‡(
x
 < 0) {

294 
width
 +
x
;

295 
x
 = 0;

297 i‡(
y
 < 0) {

298 
height
 +
y
;

299 
y
 = 0;

301 i‡(
x
 + 
width
 > 
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
)

302 
width
 = (
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
Ë- 
x
;

303 i‡(
y
 + 
height
 > 
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
)

304 
height
 = (
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
Ë- 
y
;

310 i‡(
x
 >(
wp
->
wöª˘
.
right
 - wp->wöª˘.
À·
) ||

311 
y
 >(
wp
->
wöª˘
.
bŸtom
 - wp->wöª˘.
t›
) ||

312 
width
 <0 || 
height
 <= 0)

318 i‡(
expo£Êag
)

319 
	`MwDñivîExposuªEvít
(
wp
, 
x
, 
y
, 
width
, 
height
);

320 
	}
}

329 
	$MwExpo£Aªa
(
HWND
 
wp
, 
MWCOORD
 
roŸx
, MWCOORD 
roŸy
, MWCOORD 
width
,

330 
MWCOORD
 
height
)

332 i‡(
wp
->
unm≠cou¡
)

335 ++
mw∑ötNC
;

341 i‡(
roŸx
 >
wp
->
wöª˘
.
right
 || 
roŸy
 >wp->wöª˘.
bŸtom
 ||

342 (
roŸx
 + 
width
Ë<
wp
->
wöª˘
.
À·
 ||

343 (
roŸy
 + 
height
Ë<
wp
->
wöª˘
.
t›
)

351 i‡(
roŸx
 < 
wp
->
wöª˘
.
À·
 || 
roŸy
 < wp->wöª˘.
t›
 ||

352 (
roŸx
 + 
width
Ë> 
wp
->
wöª˘
.
right
 ||

353 (
roŸy
 + 
height
Ë> 
wp
->
wöª˘
.
bŸtom
)

354 
	`MwDøwB‹dî
(
wp
);

361 
	`MwCÀ¨Wödow
(
wp
, 
roŸx
 - wp->
wöª˘
.
À·
, 
roŸy
 - wp->wöª˘.
t›
,

362 
width
, 
height
, 
TRUE
);

367 
wp
 = wp->
chûdªn
; wp; w∞wp->
siblögs
)

368 
	`MwExpo£Aªa
(
wp
, 
roŸx
, 
roŸy
, 
width
, 
height
);

369 
	}
}

	@mwin/winfont.c

8 
	~"wödows.h
"

9 
	~"wöã∫.h
"

10 
	~"devi˚.h
"

11 
	~<°dlib.h
>

12 
	~<°rög.h
>

14 
HFONT
 
WINAPI


15 
	$Cª©eF⁄t
(
nHeight
, 
nWidth
, 
nEsˇ≥mít
, 
nOrõ¡©i⁄
,

16 
‚Weight
, 
DWORD
 
fdwIèlic
, DWORD 
fdwUndîlöe
, DWORD 
fdwSåikeOut
,

17 
DWORD
 
fdwCh¨Së
,DWORD 
fdwOuçutPªcisi⁄
,DWORD 
fdwClùPªcisi⁄
,

18 
DWORD
 
fdwQuÆôy
, DWORD 
fdwPôchAndFamûy
, 
LPCSTR
 
ÕszFa˚
)

20 
LOGFONT
 
lf
;

22 
lf
.
lfHeight
 = 
nHeight
;

23 
lf
.
lfWidth
 = 
nWidth
;

24 
lf
.
lfEsˇ≥mít
 = 
nEsˇ≥mít
;

25 
lf
.
lfOrõ¡©i⁄
 = 
nOrõ¡©i⁄
;

26 
lf
.
lfWeight
 = 
‚Weight
;

27 
lf
.
lfIèlic
 = 
fdwIèlic
;

28 
lf
.
lfUndîlöe
 = 
fdwUndîlöe
;

29 
lf
.
lfSåikeOut
 = 
fdwSåikeOut
;

30 
lf
.
lfCh¨Së
 = 
fdwCh¨Së
;

31 
lf
.
lfOutPªcisi⁄
 = 
fdwOuçutPªcisi⁄
;

32 
lf
.
lfClùPªcisi⁄
 = 
fdwClùPªcisi⁄
;

33 
lf
.
lfQuÆôy
 = 
fdwQuÆôy
;

34 
lf
.
lfPôchAndFamûy
 = 
fdwPôchAndFamûy
;

35 
	`°∫˝y
(
lf
.
lfFa˚Name
, 
ÕszFa˚
, (lf.lfFaceName));

37  
	`Cª©eF⁄tIndúe˘
(&
lf
);

38 
	}
}

40 
HFONT
 
WINAPI


41 
	$Cª©eF⁄tIndúe˘
(
CONST
 
LOGFONT
 *
Õlf
)

43 
MWFONTOBJ
 * 
hf⁄t
;

44 
Ámûy
, 
pôch
;

45 
MWLOGFONT
 
mwlf
;

48 
hf⁄t
 = 
	`GdIãmNew
(
MWFONTOBJ
);

49 if(!
hf⁄t
)

50  
NULL
;

51 
hf⁄t
->
hdr
.
ty≥
 = 
OBJ_FONT
;

52 
hf⁄t
->
hdr
.
°ockobj
 = 
FALSE
;

55 
	`mem£t
(&
mwlf
, 0, (mwlf));

56 
mwlf
.
lfHeight
 = 
Õlf
->lfHeight;

57 
mwlf
.
lfWidth
 = 
Õlf
->lfWidth;

58 
mwlf
.
lfEsˇ≥mít
 = 
Õlf
->lfEscapement;

59 
mwlf
.
lfOrõ¡©i⁄
 = 
Õlf
->lfOrientation;

60 
mwlf
.
lfWeight
 = 
Õlf
->lfWeight;

61 
mwlf
.
lfIèlic
 = 
Õlf
->lfItalic;

62 
mwlf
.
lfUndîlöe
 = 
Õlf
->lfUnderline;

63 
mwlf
.
lfSåikeOut
 = 
Õlf
->lfStrikeOut;

64 
mwlf
.
lfCh¨Së
 = 
Õlf
->lfCharSet;

65 
mwlf
.
lfOutPªcisi⁄
 = 
Õlf
->lfOutPrecision;

66 
mwlf
.
lfClùPªcisi⁄
 = 
Õlf
->lfClipPrecision;

67 
mwlf
.
lfQuÆôy
 = 
Õlf
->lfQuality;

68 
	`°∫˝y
(
mwlf
.
lfFa˚Name
, 
Õlf
->lfFaceName, (mwlf.lfFaceName));

70 
Ámûy
 = 
Õlf
->
lfPôchAndFamûy
 & 0xf0;

71 
Ámûy
) {

72 
FF_DONTCARE
:

74 
FF_ROMAN
:

75 
mwlf
.
lfRom™
 = 1;

76 
mwlf
.
lfSîif
 = 1;

78 
FF_SWISS
:

79 
mwlf
.
lfS™sSîif
 = 1;

81 
FF_MODERN
:

82 
mwlf
.
lfModîn
 = 1;

86 
pôch
 = 
Õlf
->
lfPôchAndFamûy
 & 0x0f;

87 
pôch
) {

88 
DEFAULT_PITCH
:

90 
FIXED_PITCH
:

91 
MONO_FONT
:

92 
mwlf
.
lfM⁄o•a˚
 = 1;

94 
VARIABLE_PITCH
:

95 
mwlf
.
lfPr›‹ti⁄Æ
 = 1;

104 i‡(
mwlf
.
lfWeight
 =
FW_BOLD
 && mwlf.
lfIèlic
)

105 
	`°rˇt
(
mwlf
.
lfFa˚Name
, "z");

107 i‡(
mwlf
.
lfWeight
 =
FW_BOLD
)

108 
	`°rˇt
(
mwlf
.
lfFa˚Name
, "b");

109 i‡(
mwlf
.
lfIèlic
)

110 
	`°rˇt
(
mwlf
.
lfFa˚Name
, "i");

113 
hf⁄t
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
, 
NULL
, 0, &
mwlf
);

114 i‡(!
hf⁄t
->
pf⁄t
)

115 
hf⁄t
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
, 
NULL
, 0, NULL);

117  (
HFONT
)
hf⁄t
;

118 
	}
}

120 
BOOL
 
WINAPI


121 
	$GëTextMërics
(
HDC
 
hdc
, 
LPTEXTMETRIC
 
Õtm
)

123 
MWFONTINFO
 
fi
;

125 if(!
hdc
)

126  
FALSE
;

128 
	`GdGëF⁄tInfo
(
hdc
->
f⁄t
->
pf⁄t
, &
fi
);

131 
Õtm
->
tmHeight
 = 
fi
.
height
;

138 
Õtm
->
tmDes˚¡
 = 
fi
.
height
 - fi.
ba£löe
;

139 
Õtm
->
tmAs˚¡

fi
.
ba£löe
;

140 
Õtm
->
tmI¡î«lLódög
 = 0;

141 
Õtm
->
tmExã∫ÆLódög
 = 0;

142 
Õtm
->
tmAveCh¨Width
 = 
fi
.
widths
['x'];

143 
Õtm
->
tmMaxCh¨Width
 = 
fi
.
maxwidth
;

144 
Õtm
->
tmWeight
 = 
FW_NORMAL
;

145 
Õtm
->
tmOvîh™g
 = 0;

146 
Õtm
->
tmDigôizedA•e˘X
 = 
fi
.
maxwidth
;

147 
Õtm
->
tmDigôizedA•e˘Y
 = 
fi
.
height
;

148 
Õtm
->
tmFú°Ch¨
 = 32;

149 
Õtm
->
tmLa°Ch¨
 = 255;

150 
Õtm
->
tmDeÁu…Ch¨
 = '?';

151 
Õtm
->
tmBªakCh¨
 = 0;

152 
Õtm
->
tmIèlic
 = 0;

153 
Õtm
->
tmUndîlöed
 = 0;

154 
Õtm
->
tmSåuckOut
 = 0;

156 
Õtm
->
tmPôchAndFamûy
 = 
fi
.
fixed
?

157 
FF_DONTCARE
: (FF_DONTCARE | 
TMPF_FIXED_PITCH
);

158 
Õtm
->
tmCh¨Së
 = 
OEM_CHARSET
;

159  
TRUE
;

160 
	}
}

162 
BOOL
 
WINAPI


163 
	$GëCh¨Width
(
HDC
 
hdc
, 
UINT
 
iFú°Ch¨
, UINT 
iLa°Ch¨
, 
LPINT
 
ÕBuf„r
)

165 
i
;

166 
j
 = 0;

167 
MWFONTINFO
 
fi
;

169 if(!
hdc
 || 
iLa°Ch¨
 < 
iFú°Ch¨
)

170  
FALSE
;

172 
	`GdGëF⁄tInfo
(
hdc
->
f⁄t
->
pf⁄t
, &
fi
);

173 
i
=
iFú°Ch¨
; i <
iLa°Ch¨
; ++i)

174 if(
i
 < 
fi
.
fú°ch¨
 || i > fi.
œ°ch¨
 || i > 255)

175 
ÕBuf„r
[
j
++] = 0;

177 
ÕBuf„r
[
j
++] = 
fi
.
widths
[
i
];

179  
TRUE
;

180 
	}
}

182 
BOOL
 
WINAPI


183 
	$GëTextExã¡Poöt
(

184 
HDC
 
hdc
,

185 
LPCTSTR
 
ÕszSå
,

186 
cchSåög
,

187 
LPSIZE
 
ÕSize
)

189 
width
 = 1, 
height
 = 1, 
ba£löe
 = 0;

191 i‡(
ÕSize
) {

192 
ÕSize
->
cx
 = 0;

193 
ÕSize
->
cy
 = 0;

195 i‡(!
hdc
 || !
ÕszSå
 || !
cchSåög
 || !
ÕSize
)

196  
FALSE
;

197 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
, 
ÕszSå
, 
cchSåög
, &
width
, &
height
,

198 &
ba£löe
, 
MWTF_UTF8
);

199 
ÕSize
->
cx
 = 
width
;

200 
ÕSize
->
cy
 = 
height
;

203  
TRUE
;

204 
	}
}

206 
BOOL
 
WINAPI


207 
	$GëTextExã¡ExPoöt
(
HDC
 
hdc
,

208 
LPCTSTR
 
ÕszSå
,

209 
cchSåög
,

210 
nMaxExã¡
,

211 
LPINT
 
ÕnFô
,

212 
LPINT
 
ÆpDx
,

213 
LPSIZE
 
ÕSize
)

216 
©å
,
width
=0,
height
=0;

218 if(!
hdc
 || !
ÕszSå
)

219  
FALSE
;

220 i‡(
cchSåög
<0)

221 
cchSåög
 = 
	`°æí
((*)
ÕszSå
);

222 
©å
=
hdc
->
f⁄t
->
pf⁄t
->
f⁄èâr
;

223 i‡(
©å
&
MWTF_FREETYPE
)

225 i‡(
	`GdGëTextSizeEx
(
hdc
->
f⁄t
->
pf⁄t
,
ÕszSå
,
cchSåög
,

226 
nMaxExã¡
,
ÕnFô
,
ÆpDx
,&
width
,&
height
,
NULL
,
MWTF_UTF8
))

228 
ÕSize
->
cx
=
width
;

229 
ÕSize
->
cy
=
height
;

230  
TRUE
;

232  
FALSE
;

236 
SIZE
 
sz
;

237 
i
;

239 i‡(!
	`GëTextExã¡Poöt
(
hdc
, 
ÕszSå
, 
cchSåög
, 
ÕSize
))

240  
FALSE
;

241 i‡((!
nMaxExã¡
)||(!
ÕnFô
)||(!
ÆpDx
))

242  
TRUE
;

243 
i
=0; i<
cchSåög
; i++) {

244 i‡(!
	`GëTextExã¡Poöt
(
hdc
, 
ÕszSå
, 
i
+1, &
sz
))

245  
FALSE
;

246 i‡(
sz
.
cx
 <
nMaxExã¡
)

247 
ÆpDx
[
i
] = 
sz
.
cx
;

249 (*
ÕnFô
Ë
i
;

250  
TRUE
;

253 (*
ÕnFô
Ë
cchSåög
;

254  
TRUE
;

256 
	}
}

	@mwin/wingdi.c

7 
	~"wödows.h
"

8 
	~"wöã∫.h
"

9 
	~"devi˚.h
"

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

13 
	#MAXSYSCOLORS
 29

	)

14 
	#MAXSTOCKOBJECTS
 18

	)

16 #i‡
ERASEMOVE


17 
BOOL
 
	gmwERASEMOVE
 = 
TRUE
;

19 
BOOL
 
	gmwERASEMOVE
 = 
FALSE
;

23 #i‡
DOS_TURBOC


24 
	#PTRTOINT
 

	)

26 
	#PTRTOINT
 

	)

29 
HDC
 
	g˛ùhdc
;

32 
MWBITMAPOBJ
 
	gdeÁu…_bôm≠
 = {

33 {
OBJ_BITMAP
, 
TRUE
}, 1, 1, 1, 1, 1, 1

36 
BOOL
 
MwExtTextOut
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
,

37 
CONST
 
RECT
 *
Õrc
, 
LPCVOID
 
ÕszSåög
, 
UINT
 
cbCou¡
,

38 
CONST
 
INT
 *
ÕDx
, 
Êags
);

39 
MwDøwText
(
HDC
 
hdc
, 
LPCVOID
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
,

40 
UINT
 
uF‹m©
, 
Êags
);

42 
HDC
 
WINAPI


43 
	$GëDCEx
(
HWND
 
hwnd
,
HRGN
 
hrgnClù
,
DWORD
 
Êags
)

45 
HDC
 
hdc
;

47 if(!
hwnd
)

48 
hwnd
 = 
roŸwp
;

51 if(
hwnd
->
owndc
 && !(
Êags
 & 
DCX_WINDOW
))

52  
hwnd
->
owndc
;

55 
hdc
 = 
	`GdIãmNew
(hdc);

56 if(!
hdc
)

57  
NULL
;

59 
hdc
->
psd
 = &
s¸dev
;

60 
hdc
->
hwnd
 = hwnd;

61 if(
Êags
 & 
DCX_DEFAULTCLIP
) {

62 
Êags
 &~
DCX_DEFAULTCLIP
;

63 if(
hwnd
->
°yÀ
 & 
WS_CLIPSIBLINGS
)

64 
Êags
 |
DCX_CLIPSIBLINGS
;

65 if(
hwnd
->
°yÀ
 & 
WS_CLIPCHILDREN
)

66 
Êags
 |
DCX_CLIPCHILDREN
;

68 
hdc
->
Êags
 = flags;

69 
hdc
->
bkmode
 = 
OPAQUE
;

70 
hdc
->
ãxèlign
 = 
TA_LEFT
 | 
TA_TOP
 | 
TA_NOUPDATECP
;

71 
hdc
->
bkcﬁ‹
 = 
	`RGB
(255, 255, 255);

72 
hdc
->
ãxtcﬁ‹
 = 
	`RGB
(0, 0, 0);

73 
hdc
->
brush
 = (
MWBRUSHOBJ
 *)
	`GëStockObje˘
(
WHITE_BRUSH
);

74 
hdc
->
≥n
 = (
MWPENOBJ
 *)
	`GëStockObje˘
(
BLACK_PEN
);

75 
hdc
->
f⁄t
 = (
MWFONTOBJ
 *)
	`GëStockObje˘
(
SYSTEM_FONT
);

76 #i‡
UPDATEREGIONS


77 if(
hrgnClù
) {

79 
hdc
->
ªgi⁄
 = (
MWRGNOBJ
 *)
	`Cª©eRe˘Rgn
(0, 0, 0, 0);

80 
	`ComböeRgn
((
HRGN
)
hdc
->
ªgi⁄
, 
hrgnClù
, 
NULL
, 
RGN_COPY
);

90 
deÁu…_bôm≠
.
∂™es
 = 
s¸dev
.planes;

91 
deÁu…_bôm≠
.
bµ
 = 
s¸dev
.bpp;

92 
hdc
->
bôm≠
 = &
deÁu…_bôm≠
;

94 
hdc
->
døwmode
 = 
R2_COPYPEN
;

95 
hdc
->
±
.
x
 = 0;

96 
hdc
->
±
.
y
 = 0;

99 if((
hwnd
->
pCœss
->
°yÀ
 & 
CS_OWNDC
Ë&& !(
Êags
 & 
DCX_WINDOW
)) {

101 
hdc
->
Êags
 |
DCX_EXCLUDEUPDATE
;

102 
hwnd
->
owndc
 = 
hdc
;

105  
hdc
;

106 
	}
}

108 
HDC
 
WINAPI


109 
	$GëDC
(
HWND
 
hwnd
)

117  
	`GëDCEx
(
hwnd
, 
NULL
, 
DCX_DEFAULTCLIP
|
DCX_EXCLUDEUPDATE
);

118 
	}
}

120 
HDC
 
WINAPI


121 
	$GëWödowDC
(
HWND
 
hwnd
)

127  
	`GëDCEx
(
hwnd
, 
NULL
,
DCX_WINDOW
|
DCX_DEFAULTCLIP
|
DCX_EXCLUDEUPDATE
);

128 
	}
}

131 
WINAPI


132 
	$Rñó£DC
(
HWND
 
hwnd
, 
HDC
 
hdc
)

135 if(!
hdc
 || (hdc->
psd
->
Êags
&
PSF_MEMORY
))

138 if(
hdc
 =
˛ùhdc
)

139 
˛ùhdc
 = 
NULL
;

142 if(
hdc
->
hwnd
->
owndc
 && !(hdc->
Êags
 & 
DCX_WINDOW
))

145 
	`DñëeObje˘
((
HBRUSH
)
hdc
->
brush
);

146 
	`DñëeObje˘
((
HPEN
)
hdc
->
≥n
);

148 
	`DñëeObje˘
((
HFONT
)
hdc
->
f⁄t
);

150 
	`DñëeObje˘
((
HRGN
)
hdc
->
ªgi⁄
);

155 
	`DñëeObje˘
((
HBITMAP
)
hdc
->
bôm≠
);

156 
	`GdIãmFªe
(
hdc
);

158 
	}
}

161 
BOOL
 
WINAPI


162 
	$DñëeDC
(
HDC
 
hdc
)

165 if(!
hdc
 || !(hdc->
psd
->
Êags
&
PSF_MEMORY
))

169 
hdc
->
psd
->
	`FªeMemGC
(hdc->psd);

172 
hdc
->
psd
 = &
s¸dev
;

173  
	`Rñó£DC
(
NULL
, 
hdc
);

174 
	}
}

177 
	$MwPaötNCAªa
(
HWND
 
hwnd
)

179 
	`SídMesßge
(
hwnd
, 
WM_NCPAINT
, 0, 0L);

182 
	`MwPaötNCS¸ﬁlb¨s
(
hwnd
, 
NULL
);

183 
	}
}

185 
HDC
 
WINAPI


186 
	$BegöPaöt
(
HWND
 
hwnd
, 
LPPAINTSTRUCT
 
ÕPaöt
)

188 
HDC
 
hdc
;

191 if(
mwf‹˚NC∑öt
 || 
hwnd
->
∑ötNC
 !
mw∑ötNC
) {

192 
	`MwPaötNCAªa
(
hwnd
);

193 
hwnd
->
∑ötNC
 = 
mw∑ötNC
;

202 if(
mwERASEMOVE
 && 
døgwp
) {

203 
hdc
 = 
NULL
;

204 
ÕPaöt
->
fEø£
 = !
	`DefWödowProc
(
hwnd
, 
WM_ERASEBKGND
, 0, 0L);

205 
hwnd
->
gŸPaötMsg
 = 
PAINT_DELAYPAINT
;

207 
	`HideC¨ë
(
hwnd
);

210 
hdc
 = 
	`GëDCEx
(
hwnd
, 
NULL
, 
DCX_DEFAULTCLIP


211 |
DCX_EXCLUDEUPDATE
);

214 
ÕPaöt
->
fEø£
 = !
	`SídMesßge
(
hwnd
, 
WM_ERASEBKGND
, (
WPARAM
)
hdc
,

217 
ÕPaöt
->
hdc
 = hdc;

219 
	`GëUpd©eRe˘
(
hwnd
, &
ÕPaöt
->
rcPaöt
, 
FALSE
);

220  
hdc
;

221 
	}
}

223 
BOOL
 
WINAPI


224 
	$EndPaöt
(
HWND
 
hwnd
, 
CONST
 
PAINTSTRUCT
 *
ÕPaöt
)

226 
	`Rñó£DC
(
hwnd
, 
ÕPaöt
->
hdc
);

227 #i‡
UPDATEREGIONS


229 if(
mwERASEMOVE
 && !
døgwp
)

230 
	`GdSëRe˘Regi⁄
(
hwnd
->
upd©e
, 0, 0, 0, 0);

232 
	`ShowC¨ë
(
hwnd
);

233  
TRUE
;

234 
	}
}

236 
COLORREF
 
WINAPI


237 
	$SëTextCﬁ‹
(
HDC
 
hdc
, 
COLORREF
 
¸Cﬁ‹
)

239 
COLORREF
 
ﬁdãxtcﬁ‹
;

241 i‡(!
hdc
)

242  
CLR_INVALID
;

243 
ﬁdãxtcﬁ‹
 = 
hdc
->
ãxtcﬁ‹
;

244 
hdc
->
ãxtcﬁ‹
 = (
MWCOLORVAL
)
¸Cﬁ‹
;

245  
ﬁdãxtcﬁ‹
;

246 
	}
}

248 
COLORREF
 
WINAPI


249 
	$SëBkCﬁ‹
(
HDC
 
hdc
, 
COLORREF
 
¸Cﬁ‹
)

251 
COLORREF
 
ﬁdbkcﬁ‹
;

253 i‡(!
hdc
)

254  
CLR_INVALID
;

255 
ﬁdbkcﬁ‹
 = 
hdc
->
bkcﬁ‹
;

256 
hdc
->
bkcﬁ‹
 = 
¸Cﬁ‹
;

257  
ﬁdbkcﬁ‹
;

258 
	}
}

260 
WINAPI


261 
	$SëBkMode
(
HDC
 
hdc
, 
iBkMode
)

263 
ﬁdbkmode
;

265 if(!
hdc
)

267 
ﬁdbkmode
 = 
hdc
->
bkmode
;

268 
hdc
->
bkmode
 = 
iBkMode
;

269  
ﬁdbkmode
;

270 
	}
}

272 
UINT
 
WINAPI


273 
	$SëTextAlign
(
HDC
 
hdc
, 
UINT
 
fMode
)

275 
UINT
 
ﬁdfMode
;

277 if(!
hdc
)

278  
GDI_ERROR
;

279 
ﬁdfMode
 = 
hdc
->
ãxèlign
;

280 
hdc
->
ãxèlign
 = 
fMode
;

281  
ﬁdfMode
;

282 
	}
}

285 
WINAPI


286 
	$SëROP2
(
HDC
 
hdc
, 
‚DøwMode
)

288 
√wmode
, 
ﬁdmode
;

290 if(!
hdc
 || (
‚DøwMode
 <0 || fnDøwModê> 
R2_LAST
))

293 
ﬁdmode
 = 
hdc
->
døwmode
;

294 
√wmode
 = 
‚DøwMode
 - 1;

295 
hdc
->
døwmode
 = 
√wmode
;

296 
	`GdSëMode
(
√wmode
);

297  
ﬁdmode
;

298 
	}
}

305 
HWND


306 
	$MwPª∑ªDC
(
HDC
 
hdc
)

308 
HWND
 
hwnd
;

310 if(!
hdc
 || !hdc->
hwnd
)

311  
NULL
;

313 
hwnd
 = 
hdc
->hwnd;

314 i‡(
hwnd
->
unm≠cou¡
)

315  
NULL
;

321 if(
hdc
 !
˛ùhdc
) {

323 if(
hdc
->
psd
->
Êags
&
PSF_MEMORY
) {

324 #i‡
DYNAMICREGIONS


326 i‡(
hdc
->
ªgi⁄
 !
NULL
 && hdc->ªgi⁄->
rgn
 != NULL

327 && 
hdc
->
ªgi⁄
->
rgn
->
size
 != 0) {

328 
LPRECT
 
Ωå
 = &(
hdc
->
ªgi⁄
->
rgn
->
exã¡s
);

329 
MWCOORD
 
À·
, 
t›
;

334 
À·
 = (
Ωå
->left <= 0) ? 0 :Ñptr->left;

335 
t›
 = (
Ωå
->top <= 0) ? 0 :Ñptr->top;

336 
	`GdSëClùRegi⁄
(
hdc
->
psd
,

337 
	`GdAŒocRe˘Regi⁄
(
Ωå
->
À·
,Ñ±r->
t›
,

338 
Ωå
->
right
,Ñ±r->
bŸtom
));

340 
	`GdSëClùRegi⁄
(
hdc
->
psd
,

341 
	`GdAŒocRe˘Regi⁄
(0, 0,

342 
hdc
->
psd
->
xvúåes
, hdc->psd->
yvúåes
));

345 
MWCLIPRECT
 
¸c
 = {0, 0, 0, 0};

348 i‡(
hdc
->
ªgi⁄
 !
NULL
 && hdc->ªgi⁄->
rgn
 != NULL

349 && 
hdc
->
ªgi⁄
->
rgn
->
size
 != 0) {

350 
LPRECT
 
Ωå
 = &(
hdc
->
ªgi⁄
->
rgn
->
exã¡s
);

355 i‡(
Ωå
->
À·
 > 0)

356 
¸c
.
x
 = 
Ωå
->
À·
;

357 i‡(
Ωå
->
t›
 > 0)

358 
¸c
.
y
 = 
Ωå
->
t›
;

359 
¸c
.
width
 = 
Ωå
->
right
;

360 
¸c
.
height
 = 
Ωå
->
bŸtom
;

362 
¸c
.
width
 = 
hdc
->
psd
->
xvúåes
;

363 
¸c
.
height
 = 
hdc
->
psd
->
yvúåes
;

365 
	`GdSëClùRe˘s
(
hdc
->
psd
, 1, &
¸c
);

367 } 
	`MwSëClùWödow
(
hdc
);

368 
˛ùhdc
 = 
hdc
;

371  
hwnd
;

372 
	}
}

375 
COLORREF
 
WINAPI


376 
	$GëPixñ
(
HDC
 
hdc
, 
x
, 
y
)

378 
HWND
 
hwnd
;

379 
POINT
 
±
;

380 
MWPIXELVAL
 
pixñ
;

382 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

383 if(!
hwnd
)

384  
CLR_INVALID
;

385 
±
.
x
 = x;

386 
±
.
y
 = y;

387 if(
	`MwIsClõ¡DC
(
hdc
))

388 
	`Clõ¡ToS¸ìn
(
hwnd
, &
±
);

391 
	`GdRódAªa
(
hdc
->
psd
, 
±
.
x
,Öt.
y
, 1, 1, &
pixñ
);

393  
	`GdGëCﬁ‹RGB
(
hdc
->
psd
, 
pixñ
);

394 
	}
}

396 
COLORREF
 
WINAPI


397 
	$SëPixñ
(
HDC
 
hdc
, 
x
, 
y
, 
COLORREF
 
¸Cﬁ‹
)

399 
HWND
 
hwnd
;

400 
POINT
 
±
;

402 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

403 if(!
hwnd
)

405 
±
.
x
 = x;

406 
±
.
y
 = y;

407 if(
	`MwIsClõ¡DC
(
hdc
))

408 
	`Clõ¡ToS¸ìn
(
hwnd
, &
±
);

411 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
¸Cﬁ‹
);

412 
	`GdPoöt
(
hdc
->
psd
, 
±
.
x
,Öt.
y
);

414 
	}
}

416 
BOOL
 
WINAPI


417 
	$MoveToEx
(
HDC
 
hdc
, 
x
, 
y
, 
LPPOINT
 
ÕPoöt
)

419 if(!
hdc
)

420  
FALSE
;

421 if(
ÕPoöt
)

422 *
ÕPoöt
 = 
hdc
->
±
;

423 
hdc
->
±
.
x
 = x;

424 
hdc
->
±
.
y
 = y;

425  
TRUE
;

426 
	}
}

428 
BOOL
 
WINAPI


429 
	$LöeTo
(
HDC
 
hdc
, 
x
, 
y
)

431 
HWND
 
hwnd
;

432 
POINT
 
beg
, 
íd
;

434 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

435 if(!
hwnd
)

436  
FALSE
;

438 
beg
.
x
 = 
hdc
->
±
.x;

439 
beg
.
y
 = 
hdc
->
±
.y;

440 
íd
.
x
 = x;

441 
íd
.
y
 = y;

442 if(
	`MwIsClõ¡DC
(
hdc
)) {

443 
	`Clõ¡ToS¸ìn
(
hwnd
, &
beg
);

444 
	`Clõ¡ToS¸ìn
(
hwnd
, &
íd
);

448 if(
hdc
->
≥n
->
°yÀ
 !
PS_NULL
) {

449 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

451 
	`GdLöe
(
hdc
->
psd
, 
beg
.
x
, beg.
y
, 
íd
.x,Énd.y, 
FALSE
);

453 
hdc
->
±
.
x
 = x;

454 
hdc
->
±
.
y
 = y;

455  
TRUE
;

456 
	}
}

459 
BOOL
 
WINAPI


460 
	$Pﬁylöe
(
HDC
 
hdc
, 
CONST
 
POINT
 *
Õ±
, 
cPoöts
)

462 
HWND
 
hwnd
;

463 
POINT
 
beg
, 
íd
;

465 if(
cPoöts
 <= 1)

466  
FALSE
;

468 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

469 if(!
hwnd
)

470  
FALSE
;

472 if(
hdc
->
≥n
->
°yÀ
 =
PS_NULL
)

473  
TRUE
;

476 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

478 
beg
 = *
Õ±
++;

479 if(
	`MwIsClõ¡DC
(
hdc
))

480 
	`Clõ¡ToS¸ìn
(
hwnd
, &
beg
);

481 --
cPoöts
 > 0) {

482 
íd
 = *
Õ±
++;

483 if(
	`MwIsClõ¡DC
(
hdc
))

484 
	`Clõ¡ToS¸ìn
(
hwnd
, &
íd
);

487 
	`GdLöe
(
hdc
->
psd
, 
beg
.
x
, beg.
y
, 
íd
.x,Énd.y, 
FALSE
);

489 
beg
 = 
íd
;

491  
TRUE
;

492 
	}
}

494 
BOOL
 
WINAPI


495 
	$Re˘™gÀ
(
HDC
 
hdc
, 
nLe·
, 
nT›
, 
nRight
, 
nBŸtom
)

497 
HWND
 
hwnd
;

498 
RECT
 
rc
;

500 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

501 if(!
hwnd
)

502  
FALSE
;

504 
	`SëRe˘
(&
rc
, 
nLe·
, 
nT›
, 
nRight
, 
nBŸtom
);

505 if(
	`MwIsClõ¡DC
(
hdc
))

506 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc
, 2);

509 if(
hdc
->
≥n
->
°yÀ
 !
PS_NULL
) {

510 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

511 
	`GdRe˘
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
,

512 
rc
.
right
 -Ñc.
À·
,Ñc.
bŸtom
 -Ñc.
t›
);

516 if(
hdc
->
brush
->
°yÀ
 !
BS_NULL
) {

517 
	`InÊ©eRe˘
(&
rc
, -1, -1);

518 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
brush
->
cﬁ‹
);

519 
	`GdFûlRe˘
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
 -Ñc.left,

520 
rc
.
bŸtom
 -Ñc.
t›
);

523  
TRUE
;

524 
	}
}

526 
BOOL
 
WINAPI


527 
	$EŒù£
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
)

529 
HWND
 
hwnd
;

530 
rx
, 
ry
;

531 
RECT
 
rc
;

533 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

534 if(!
hwnd
)

535  
FALSE
;

537 
	`SëRe˘
(&
rc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
);

538 if(
	`MwIsClõ¡DC
(
hdc
))

539 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc
, 2);

541 
rx
 = (
rc
.
right
 -Ñc.
À·
)/2 - 1;

542 
ry
 = (
rc
.
bŸtom
 -Ñc.
t›
)/2 - 1;

543 
rc
.
À·
 +
rx
;

544 
rc
.
t›
 +
ry
;

547 if(
hdc
->
brush
->
°yÀ
 !
BS_NULL
) {

548 
	`InÊ©eRe˘
(&
rc
, -1, -1);

549 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
brush
->
cﬁ‹
);

550 
	`GdEŒù£
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
, 
rx
, 
ry
, 
TRUE
);

554 if(
hdc
->
≥n
->
°yÀ
 !
PS_NULL
) {

555 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

556 
	`GdEŒù£
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
, 
rx
, 
ry
, 
FALSE
);

559  
TRUE
;

560 
	}
}

563 
	$d›õ¨c
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
,

564 
ax
, 
ay
, 
bx
, 
by
, 
ty≥
)

566 
HWND
 
hwnd
;

567 
rx
, 
ry
;

568 
RECT
 
rc
, 
rc2
;

570 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

571 if(!
hwnd
)

574 
	`SëRe˘
(&
rc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
);

575 
	`SëRe˘
(&
rc2
, 
ax
, 
ay
, 
bx
, 
by
);

576 if(
	`MwIsClõ¡DC
(
hdc
)) {

577 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc
, 2);

578 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc2
, 2);

581 
rx
 = (
rc
.
right
 -Ñc.
À·
)/2 - 1;

582 
ry
 = (
rc
.
bŸtom
 -Ñc.
t›
)/2 - 1;

583 
rc
.
À·
 +
rx
;

584 
rc
.
t›
 +
ry
;

587 if(
hdc
->
brush
->
°yÀ
 !
BS_NULL
 && 
ty≥
 =
MWPIE
) {

588 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
brush
->
cﬁ‹
);

589 
	`GdArc
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
, 
rx
, 
ry
,

590 
rc2
.
À·
,Ñc2.
t›
,Ñc2.
right
,Ñc2.
bŸtom
, 
MWPIE
);

594 if(
hdc
->
≥n
->
°yÀ
 !
PS_NULL
) {

595 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

596 if(
ty≥
 =
MWPIE
)

597 
ty≥
 = 
MWARC
;

598 
	`GdArc
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
, 
rx
, 
ry
,

599 
rc2
.
À·
,Ñc2.
t›
,Ñc2.
right
,Ñc2.
bŸtom
, 
ty≥
);

601 
	}
}

603 
BOOL
 
WINAPI


604 
	$Arc
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
,

605 
nXSèπArc
, 
nYSèπArc
, 
nXEndArc
, 
nYEndArc
)

607 
	`d›õ¨c
(
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
,

608 
nXSèπArc
, 
nYSèπArc
, 
nXEndArc
, 
nYEndArc
, 
MWARC
);

609  
TRUE
;

610 
	}
}

612 
BOOL
 
WINAPI


613 
	$Põ
(
HDC
 
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
,

614 
nXRadül1
, 
nYRadül1
, 
nXRadül2
, 
nYRadül2
)

616 
	`d›õ¨c
(
hdc
, 
nLe·Re˘
, 
nT›Re˘
, 
nRightRe˘
, 
nBŸtomRe˘
,

617 
nXRadül1
, 
nYRadül1
, 
nXRadül2
, 
nYRadül2
, 
MWPIE
);

618  
TRUE
;

619 
	}
}

621 
BOOL
 
WINAPI


622 
	$Pﬁyg⁄
(
HDC
 
hdc
, 
CONST
 
POINT
 *
ÕPoöts
, 
nCou¡
)

624 
HWND
 
hwnd
;

625 
i
;

626 
LPPOINT
 
µ
, 
µAŒoc
 = 
NULL
;

628 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

629 if(!
hwnd
)

630  
FALSE
;

632 if(
	`MwIsClõ¡DC
(
hdc
)) {

634 
µAŒoc
 = (
LPPOINT
)
	`mÆloc
(
nCou¡
 * (
POINT
));

635 if(!
µAŒoc
)

636  
FALSE
;

637 
	`mem˝y
(
µAŒoc
, 
ÕPoöts
, 
nCou¡
*(
POINT
));

638 
µ
 = 
µAŒoc
;

639 
i
=0; i<
nCou¡
; ++i)

640 
	`Clõ¡ToS¸ìn
(
hwnd
, 
µ
++);

641 
µ
 = 
µAŒoc
;

642 } 
µ
 = (
LPPOINT
)
ÕPoöts
;

645 if(
hdc
->
brush
->
°yÀ
 !
BS_NULL
) {

646 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
brush
->
cﬁ‹
);

647 
	`GdFûlPﬁy
(
hdc
->
psd
, 
nCou¡
, 
µ
);

651 if(
hdc
->
≥n
->
°yÀ
 !
PS_NULL
) {

652 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

653 
	`GdPﬁy
(
hdc
->
psd
, 
nCou¡
, 
µ
);

656 if(
µAŒoc
)

657 
	`‰ì
(
µAŒoc
);

658  
TRUE
;

659 
	}
}

662 
BOOL
 
WINAPI


663 
	$PﬁyPﬁyg⁄
(
HDC
 
hdc
, 
CONST
 
POINT
 *
ÕPoöts
, 
LPINT
 
ÕPﬁyCou¡s
, 
nCou¡
)

665 --
nCou¡
 >= 0) {

666 i‡(!
	`Pﬁyg⁄
(
hdc
, 
ÕPoöts
, *
ÕPﬁyCou¡s
))

667  
FALSE
;

668 
ÕPoöts
 +*
ÕPﬁyCou¡s
++;

670  
TRUE
;

671 
	}
}

673 
WINAPI


674 
	$FûlRe˘
(
HDC
 
hdc
, 
CONST
 
RECT
 *
Õrc
, 
HBRUSH
 
hbr
)

676 
HWND
 
hwnd
;

677 
RECT
 
rc
;

678 
MWBRUSHOBJ
 * 
obr
 = (MWBRUSHOBJ *)
hbr
;

679 
COLORREF
 
¸Fûl
;

681 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

682 if(!
hwnd
 || !
obr
)

683  
FALSE
;

685 if(!
Õrc
) {

686 if(
	`MwIsClõ¡DC
(
hdc
))

687 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

689 
	`GëWödowRe˘
(
hwnd
, &
rc
);

690 
Õrc
 = &
rc
;

692 
rc
 = *
Õrc
;

693 if(
	`MwIsClõ¡DC
(
hdc
))

694 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc
, 2);

697 if((
PTRTOINT
)
obr
 <
MAXSYSCOLORS
)

698 
¸Fûl
 = 
	`GëSysCﬁ‹
(()
obr
-1);

701 if(
obr
->
°yÀ
 =
BS_NULL
)

702  
TRUE
;

703 
¸Fûl
 = 
obr
->
cﬁ‹
;

707 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, 
¸Fûl
);

708 
	`GdFûlRe˘
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
,

709 
rc
.
right
 -Ñc.
À·
,Ñc.
bŸtom
 -Ñc.
t›
);

710  
TRUE
;

711 
	}
}

714 
BOOL
 
WINAPI


715 
	$TextOut
(
HDC
 
hdc
, 
x
, 
y
, 
LPCSTR
 
ÕszSåög
, 
cbSåög
)

718  
	`MwExtTextOut
(
hdc
, 
x
, 
y
, 0, 
NULL
, 
ÕszSåög
, 
cbSåög
, NULL,

719 
MWTF_ASCII
);

720 
	}
}

723 
BOOL
 
WINAPI


724 
	$ExtTextOut
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
, 
CONST
 
RECT
 *
Õrc
,

725 
LPCSTR
 
ÕszSåög
, 
UINT
 
cbCou¡
, 
CONST
 
INT
 *
ÕDx
)

727  
	`MwExtTextOut
(
hdc
, 
x
, 
y
, 
fuO±i⁄s
, 
Õrc
, 
ÕszSåög
,

728 
cbCou¡
, 
ÕDx
, 
MWTF_ASCII
);

729 
	}
}

732 
BOOL
 
WINAPI


733 
	$ExtTextOutW
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
, 
CONST
 
RECT
 *
Õrc
,

734 
LPCWSTR
 
ÕszSåög
, 
UINT
 
cbCou¡
, 
CONST
 
INT
 *
ÕDx
)

736  
	`MwExtTextOut
(
hdc
, 
x
, 
y
, 
fuO±i⁄s
, 
Õrc
, 
ÕszSåög
,

737 
cbCou¡
, 
ÕDx
, 
MWTF_UC16
);

738 
	}
}

741 
BOOL


742 
	$MwExtTextOut
(
HDC
 
hdc
, 
x
, 
y
, 
UINT
 
fuO±i⁄s
, 
CONST
 
RECT
 *
Õrc
,

743 
LPCVOID
 
ÕszSåög
, 
UINT
 
cbCou¡
, 
CONST
 
INT
 *
ÕDx
, 
Êags
)

745 
HWND
 
hwnd
;

746 
POINT
 
±
;

747 
RECT
 
rc
;

749 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

750 if(!
hwnd
)

751  
FALSE
;

753 
±
.
x
 = x;

754 
±
.
y
 = y;

755 if(
	`MwIsClõ¡DC
(
hdc
))

756 
	`Clõ¡ToS¸ìn
(
hwnd
, &
±
);

759 if(
Õrc
 && (
fuO±i⁄s
&
ETO_OPAQUE
)) {

760 
rc
 = *
Õrc
;

761 if(
	`MwIsClõ¡DC
(
hdc
))

762 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, (
LPPOINT
)&
rc
, 2);

765 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
bkcﬁ‹
);

766 
	`GdFûlRe˘
(
hdc
->
psd
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
 -Ñc.left,

767 
rc
.
bŸtom
 -Ñc.
t›
);

768 
	`GdSëU£Background
(
FALSE
);

771 
	`GdSëU£Background
(
hdc
->
bkmode
 =
OPAQUE
? 
TRUE
: 
FALSE
);

777 
	`GdSëBackgroundCﬁ‹
(
hdc
->
psd
, hdc->
bkcﬁ‹
);

780 i‡(
cbCou¡
 == 0) {

782  
TRUE
;

788 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
ãxtcﬁ‹
);

789 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

792 if((
hdc
->
ãxèlign
 & 
TA_BASELINE
) == TA_BASELINE) {

796 
Êags
 |
MWTF_BASELINE
;

797 } if(
hdc
->
ãxèlign
 & 
TA_BOTTOM
) {

798 
MWCOORD
 
ph
, 
pw
, 
pb
;

800 if(
Õrc
)

801 
±
.
y
 +
Õrc
->
bŸtom
 -Ü¥c->
t›
;

803 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
, 
ÕszSåög
, 
cbCou¡
,

804 &
pw
, &
ph
, &
pb
, 
Êags
);

805 
±
.
y
 +
ph
;

807 
Êags
 |
MWTF_BOTTOM
;

809 
Êags
 |
MWTF_TOP
;

810 
	`GdText
(
hdc
->
psd
, 
±
.
x
,Öt.
y
, 
ÕszSåög
, 
cbCou¡
, 
Êags
);

812  
TRUE
;

813 
	}
}

816 
WINAPI


817 
	$DøwTextA
(
HDC
 
hdc
, 
LPCSTR
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
, 
UINT
 
uF‹m©
)

819  
	`MwDøwText
(
hdc
, 
ÕSåög
, 
nCou¡
, 
ÕRe˘
, 
uF‹m©
, 
MWTF_ASCII
);

820 
	}
}

823 
WINAPI


824 
	$DøwTextW
(
HDC
 
hdc
, 
LPCWSTR
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
, 
UINT
 
uF‹m©
)

826  
	`MwDøwText
(
hdc
, 
ÕSåög
, 
nCou¡
, 
ÕRe˘
, 
uF‹m©
, 
MWTF_UC16
);

827 
	}
}

832 
	$MwDøwText
(
HDC
 
hdc
, 
LPCVOID
 
ÕSåög
, 
nCou¡
, 
LPRECT
 
ÕRe˘
, 
UINT
 
uF‹m©
,

833 
Êags
)

835 
MWCOORD
 
x
, 
y
, 
width
, 
height
, 
ba£löe
;

837 if(
nCou¡
 == -1)

838 
nCou¡
 = 
	`°æí
(
ÕSåög
);

840 if(
uF‹m©
 & (
DT_CALCRECT
|
DT_CENTER
|
DT_RIGHT
)) {

841 if(!
hdc
)

843 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
, 
ÕSåög
, 
nCou¡
,

844 &
width
, &
height
, &
ba£löe
, 
MWTF_ASCII
);

846 
x
 = 
ÕRe˘
->
À·
;

847 
y
 = 
ÕRe˘
->
t›
;

849 if(
uF‹m©
 & 
DT_CALCRECT
) {

850 
ÕRe˘
->
right
 = 
x
 + 
width
;

851 
ÕRe˘
->
bŸtom
 = 
y
 + 
height
;

852  
height
;

855 if(
uF‹m©
 & 
DT_CENTER
)

856 
x
 = (
ÕRe˘
->
À·
 +ÜpRe˘->
right
 - 
width
) / 2;

857 if(
uF‹m©
 & 
DT_RIGHT
)

858 
x
 +
ÕRe˘
->
right
 - 
width
;

861 
	`MwExtTextOut
(
hdc
, 
x
, 
y
, 0, 
NULL
, 
ÕSåög
, 
nCou¡
, NULL, 
Êags
);

862  
height
;

863 
	}
}

866 
BOOL
 
WINAPI


867 
	$DøwDIB
(
HDC
 
hdc
,
x
,
y
,
PMWIMAGEHDR
 
pimage
)

869 
HWND
 
hwnd
;

870 
POINT
 
±
;

872 
hwnd
 = 
	`MwPª∑ªDC
(
hdc
);

873 if(!
hwnd
 || !
pimage
)

874  
FALSE
;

875 
±
.
x
 = x;

876 
±
.
y
 = y;

877 if(
	`MwIsClõ¡DC
(
hdc
))

878 
	`Clõ¡ToS¸ìn
(
hwnd
, &
±
);

880 
	`GdDøwImage
(
hdc
->
psd
, 
±
.
x
,Öt.
y
, 
pimage
);

881  
TRUE
;

882 
	}
}

885 #i‡
ELKS


886 
	#B


	)

888 
	#A


	)

891 
	#A_RGB
(
r
,
g
,
b
)

	)

892 
	#B_RGB
(
r
,
g
,
b
)

	)

893 
	#C_RGB
(
r
,
g
,
b
)

	)

895 #ifde‡
A


896 #unde‡
A_RGB


897 
	#A_RGB
(
r
,
g
,
b
Ë
	`RGB
‘,g,b),

	)

899 #ifde‡
B


900 #unde‡
B_RGB


901 
	#B_RGB
(
r
,
g
,
b
Ë
	`RGB
‘,g,b),

	)

903 #ifde‡
C


904 #unde‡
C_RGB


905 
	#C_RGB
(
r
,
g
,
b
Ë
	`RGB
‘,g,b),

	)

908 
COLORREF
 
	gsysCﬁ‹s
[
MAXSYSCOLORS
] = {

909 
RGB
(192, 192, 192),

910 
RGB
( 0, 128, 128),

911 
A_RGB
(128, 0, 0)

912 
B_RGB
(128, 0, 128)

913 
C_RGB
(128, 0, 128)

914 
A_RGB
(162, 141, 104)

915 
B_RGB
(128, 128, 128)

916 
C_RGB
( 0, 64, 128)

917 
RGB
(192, 192, 192),

918 
RGB
(255, 255, 255),

919 
RGB
( 0, 0, 0),

920 
RGB
( 0, 0, 0),

921 
RGB
( 0, 0, 0),

922 
RGB
(255, 255, 255),

923 
RGB
(192, 192, 192),

924 
RGB
(192, 192, 192),

925 
RGB
(128, 128, 128),

926 
RGB
(128, 0, 0),

927 
RGB
(255, 255, 255),

928 
A_RGB
(213, 204, 187)

929 
B_RGB
(192, 192, 192)

930 
C_RGB
(160, 160, 160)

931 
A_RGB
(162, 141, 104)

932 
B_RGB
(128, 128, 128)

933 
C_RGB
(128, 128, 128)

934 
RGB
( 64, 64, 64),

935 
RGB
( 0, 0, 0),

936 
RGB
(192, 192, 192),

937 
A_RGB
(234, 230, 221)

938 
B_RGB
(255, 255, 255)

939 
C_RGB
(223, 223, 223)

940 
RGB
( 0, 0, 0),

941 
A_RGB
(213, 204, 187)

942 
B_RGB
(223, 223, 223)

943 
C_RGB
(192, 192, 192)

944 
RGB
( 0, 0, 0),

945 
RGB
(225, 255, 255),

946 
RGB
(184, 180, 184),

947 
RGB
( 0, 0, 255),

948 
RGB
( 16, 132, 208),

949 
RGB
(184, 180, 184)

952 
DWORD
 
WINAPI


953 
	$GëSysCﬁ‹
(
nIndex
)

955 if(
nIndex
 >0 &&ÇIndex < 
MAXSYSCOLORS
)

956  
sysCﬁ‹s
[
nIndex
];

958 
	}
}

960 
COLORREF
 
WINAPI


961 
	$SëSysCﬁ‹
(
nIndex
, 
COLORREF
 
¸Cﬁ‹
)

963 
COLORREF
 
ﬁdCﬁ‹
;

965 if(
nIndex
 >0 &&ÇIndex < 
MAXSYSCOLORS
) {

966 
ﬁdCﬁ‹
 = 
sysCﬁ‹s
[
nIndex
];

967 
sysCﬁ‹s
[
nIndex
] = 
¸Cﬁ‹
;

968  
ﬁdCﬁ‹
;

971 
	}
}

973 
MWBRUSHOBJ
 
	gOBJ_WHITE_BRUSH
 = {

974 {
OBJ_BRUSH
, 
TRUE
}, 
BS_SOLID
, 
RGB
(255, 255, 255)

977 
MWBRUSHOBJ
 
	gOBJ_LTGRAY_BRUSH
 = {

978 {
OBJ_BRUSH
, 
TRUE
}, 
BS_SOLID
, 
RGB
(192, 192, 192)

981 
MWBRUSHOBJ
 
	gOBJ_GRAY_BRUSH
 = {

982 {
OBJ_BRUSH
, 
TRUE
}, 
BS_SOLID
, 
RGB
(128, 128, 128)

985 
MWBRUSHOBJ
 
	gOBJ_DKGRAY_BRUSH
 = {

986 {
OBJ_BRUSH
, 
TRUE
}, 
BS_SOLID
, 
RGB
(32, 32, 32)

989 
MWBRUSHOBJ
 
	gOBJ_BLACK_BRUSH
 = {

990 {
OBJ_BRUSH
, 
TRUE
}, 
BS_SOLID
, 
RGB
(0, 0, 0)

993 
MWBRUSHOBJ
 
	gOBJ_NULL_BRUSH
 = {

994 {
OBJ_BRUSH
, 
TRUE
}, 
BS_NULL
, 
RGB
(0, 0, 0)

997 
MWPENOBJ
 
	gOBJ_WHITE_PEN
 = {

998 {
OBJ_PEN
, 
TRUE
}, 
PS_SOLID
, 
RGB
(255, 255, 255)

1001 
MWPENOBJ
 
	gOBJ_BLACK_PEN
 = {

1002 {
OBJ_PEN
, 
TRUE
}, 
PS_SOLID
, 
RGB
(0, 0, 0)

1005 
MWPENOBJ
 
	gOBJ_NULL_PEN
 = {

1006 {
OBJ_PEN
, 
TRUE
}, 
PS_NULL
, 
RGB
(0, 0, 0)

1009 
MWFONTOBJ
 
	gOBJ_OEM_FIXED_FONT
 = {

1010 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_FIXED


1013 
MWFONTOBJ
 
	gOBJ_ANSI_FIXED_FONT
 = {

1014 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_FIXED


1017 
MWFONTOBJ
 
	gOBJ_ANSI_VAR_FONT
 = {

1018 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_VAR


1021 
MWFONTOBJ
 
	gOBJ_SYSTEM_FONT
 = {

1022 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_VAR


1025 
MWFONTOBJ
 
	gOBJ_DEVICE_DEFAULT_FONT
 = {

1026 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_FIXED


1029 
MWFONTOBJ
 
	gOBJ_SYSTEM_FIXED_FONT
 = {

1030 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_FIXED


1033 
MWFONTOBJ
 
	gOBJ_DEFAULT_GUI_FONT
 = {

1034 {
OBJ_FONT
, 
TRUE
}, 
NULL
, 
MWFONT_SYSTEM_VAR


1037 
hgdiobj
 *
	g°ockObje˘s
[
MAXSTOCKOBJECTS
] = {

1038 (
hgdiobj
 *)&
OBJ_WHITE_BRUSH
,

1039 (
hgdiobj
 *)&
OBJ_LTGRAY_BRUSH
,

1040 (
hgdiobj
 *)&
OBJ_GRAY_BRUSH
,

1041 (
hgdiobj
 *)&
OBJ_DKGRAY_BRUSH
,

1042 (
hgdiobj
 *)&
OBJ_BLACK_BRUSH
,

1043 (
hgdiobj
 *)&
OBJ_NULL_BRUSH
,

1044 (
hgdiobj
 *)&
OBJ_WHITE_PEN
,

1045 (
hgdiobj
 *)&
OBJ_BLACK_PEN
,

1046 (
hgdiobj
 *)&
OBJ_NULL_PEN
,

1047 (
hgdiobj
 *)
NULL
,

1048 (
hgdiobj
 *)&
OBJ_OEM_FIXED_FONT
,

1049 (
hgdiobj
 *)&
OBJ_ANSI_FIXED_FONT
,

1050 (
hgdiobj
 *)&
OBJ_ANSI_VAR_FONT
,

1051 (
hgdiobj
 *)&
OBJ_SYSTEM_FONT
,

1052 (
hgdiobj
 *)&
OBJ_DEVICE_DEFAULT_FONT
,

1053 (
hgdiobj
 *)
NULL
,

1054 (
hgdiobj
 *)&
OBJ_SYSTEM_FIXED_FONT
,

1055 (
hgdiobj
 *)&
OBJ_DEFAULT_GUI_FONT


1058 
HGDIOBJ
 
WINAPI


1059 
	$GëStockObje˘
(
nObje˘
)

1061 
HGDIOBJ
 
pObj
;

1062 
MWFONTOBJ
 * 
pF⁄t
;

1064 if(
nObje˘
 >0 &&ÇObje˘ < 
MAXSTOCKOBJECTS
) {

1065 
pObj
 = 
°ockObje˘s
[
nObje˘
];

1068 if(
pObj
->
hdr
.
ty≥
 =
OBJ_FONT
) {

1069 
pF⁄t
 = (
MWFONTOBJ
 *)
pObj
;

1070 if(
pF⁄t
->
pf⁄t
 =
NULL
) {

1071 
pF⁄t
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
,

1072 
pF⁄t
->
«me
, 0, 
NULL
);

1073 i‡(!
pF⁄t
->
pf⁄t
)

1074 
pF⁄t
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
,

1075 
NULL
, 0, NULL);

1077  
pObj
;

1083 
nObje˘
) {

1084 
LTGRAY_BRUSH
:

1085 
GRAY_BRUSH
:

1086 ((
MWBRUSHOBJ
 *)
pObj
)->
cﬁ‹
 =
	`GëSysCﬁ‹
(
COLOR_BTNFACE
);

1088 
DKGRAY_BRUSH
:

1089 ((
MWBRUSHOBJ
 *)
pObj
)->
cﬁ‹
 =

1090 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
);

1093  
pObj
;

1095  
NULL
;

1096 
	}
}

1098 
HGDIOBJ
 
WINAPI


1099 
	$Sñe˘Obje˘
(
HDC
 
hdc
, 
HGDIOBJ
 
hObje˘
)

1101 
HGDIOBJ
 
objOrg
;

1102 
MWBITMAPOBJ
 * 
pb
;

1104 if(!
hdc
 || !
hObje˘
)

1105  
NULL
;

1107 
hObje˘
->
hdr
.
ty≥
) {

1108 
OBJ_PEN
:

1109 
objOrg
 = (
HGDIOBJ
)
hdc
->
≥n
;

1110 
hdc
->
≥n
 = (
MWPENOBJ
 *)
hObje˘
;

1112 
OBJ_BRUSH
:

1113 
objOrg
 = (
HGDIOBJ
)
hdc
->
brush
;

1114 
hdc
->
brush
 = (
MWBRUSHOBJ
 *)
hObje˘
;

1116 
OBJ_FONT
:

1117 
objOrg
 = (
HGDIOBJ
)
hdc
->
f⁄t
;

1118 
hdc
->
f⁄t
 = (
MWFONTOBJ
 *)
hObje˘
;

1120 
OBJ_BITMAP
:

1122 if(!(
hdc
->
psd
->
Êags
&
PSF_MEMORY
))

1123  
NULL
;

1124 
objOrg
 = (
HGDIOBJ
)
hdc
->
bôm≠
;

1127 
pb
 = (
MWBITMAPOBJ
 *)
hObje˘
;

1130 i‡(!
hdc
->
psd
->
	`M≠MemGC
(hdc->psd, 
pb
->
width
,Öb->
height
,

1131 
pb
->
∂™es
,Öb->
bµ
,Öb->
löñí
,Öb->
size
,

1132 &
pb
->
bôs
[0]))

1133  
NULL
;

1135 
hdc
->
bôm≠
 = (
MWBITMAPOBJ
 *)
hObje˘
;

1137 #i‡
UPDATEREGIONS


1138 
OBJ_REGION
:

1140 
objOrg
 = 
NULL
;

1141 
	`Sñe˘ClùRgn
(
hdc
, (
HRGN
)
hObje˘
);

1145  
NULL
;

1148  
objOrg
;

1149 
	}
}

1151 
BOOL
 
WINAPI


1152 
	$DñëeObje˘
(
HGDIOBJ
 
hObje˘
)

1154 if(!
hObje˘
 || hObje˘->
hdr
.
°ockobj
)

1155  
FALSE
;

1156 if(
hObje˘
->
hdr
.
ty≥
 =
OBJ_FONT
)

1157 
	`GdDe°royF⁄t
(((
MWFONTOBJ
 *)
hObje˘
)->
pf⁄t
);

1158 if(
hObje˘
->
hdr
.
ty≥
 =
OBJ_REGION
)

1159 
	`GdDe°royRegi⁄
(((
MWRGNOBJ
 *)
hObje˘
)->
rgn
);

1160 
	`GdIãmFªe
(
hObje˘
);

1161  
TRUE
;

1162 
	}
}

1164 #i‡
UPDATEREGIONS


1166 
WINAPI


1167 
	$Sñe˘ClùRgn
(
HDC
 
hdc
, 
HRGN
 
hrgn
)

1169  
	`ExtSñe˘ClùRgn
(
hdc
, 
hrgn
, 
RGN_COPY
);

1170 
	}
}

1177 
WINAPI


1178 
	$ExtSñe˘ClùRgn
(
HDC
 
hdc
, 
HRGN
 
hrgn
, 
‚Mode
)

1180 
HRGN
 
√wrgn
;

1182 if(!
hdc
)

1183  
ERROR
;

1184 if(
hdc
->
ªgi⁄
 !(
MWRGNOBJ
 *)
hrgn
) {

1186 if(
hrgn
) {

1187 
√wrgn
 = 
	`Cª©eRe˘Rgn
(0, 0, 0, 0);

1194 
	`Off£tRgn
(
hrgn
, 
hdc
->
hwnd
->
˛úe˘
.
À·
,

1195 
hdc
->
hwnd
->
˛úe˘
.
t›
);

1197 if(
‚Mode
 =
RGN_COPY
)

1198 
	`ComböeRgn
(
√wrgn
, 
hrgn
, 
NULL
, 
‚Mode
);

1199 
	`ComböeRgn
(
√wrgn
, (
HRGN
)
hdc
->
ªgi⁄
, 
hrgn
,
‚Mode
);

1202 
	`Off£tRgn
(
hrgn
, -
hdc
->
hwnd
->
˛úe˘
.
À·
,

1203 -
hdc
->
hwnd
->
˛úe˘
.
t›
);

1206 
hrgn
 = 
√wrgn
;

1208 
	`DñëeObje˘
((
HRGN
)
hdc
->
ªgi⁄
);

1209 
hdc
->
ªgi⁄
 = (
MWRGNOBJ
 *)
hrgn
;

1212 
˛ùhdc
 = 
NULL
;

1213 
	`MwPª∑ªDC
(
hdc
);

1215 if(
hrgn
)

1216  ((
MWRGNOBJ
 *)
hrgn
)->
rgn
->
ty≥
;

1217  
NULLREGION
;

1218 
	}
}

1221 
WINAPI


1222 
	$GëUpd©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
, 
BOOL
 
bEø£
)

1225 if(!
hwnd
)

1226  
ERROR
;

1229 
	`GdOff£tRegi⁄
(
hwnd
->
upd©e
, -hwnd->
˛úe˘
.
À·
, -hwnd->˛úe˘.
t›
);

1230 
	`GdC›yRegi⁄
(((
MWRGNOBJ
 *)
hrgn
)->
rgn
, 
hwnd
->
upd©e
);

1231 
	`GdOff£tRegi⁄
(
hwnd
->
upd©e
, hwnd->
˛úe˘
.
À·
, hwnd->˛úe˘.
t›
);

1232  
hwnd
->
upd©e
->
ty≥
;

1233 
	}
}

1237 
BOOL
 
WINAPI


1238 
	$GëUpd©eRe˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
, 
BOOL
 
bEø£
)

1241 if(!
hwnd
)

1242  
FALSE
;

1243 #i‡
UPDATEREGIONS


1244 if(
ÕRe˘
) {

1245 *
ÕRe˘
 = 
hwnd
->
upd©e
->
exã¡s
;

1247 
	`S¸ìnToClõ¡
(
hwnd
, (
LPPOINT
)&
ÕRe˘
->
À·
);

1248 
	`S¸ìnToClõ¡
(
hwnd
, (
LPPOINT
)&
ÕRe˘
->
right
);

1252  
hwnd
->
upd©e
->
ty≥
 !
NULLREGION
;

1254 
	`GëClõ¡Re˘
(
hwnd
, 
ÕRe˘
);

1255  
TRUE
;

1257 
	}
}

1259 
HBRUSH
 
WINAPI


1260 
	$Cª©eSﬁidBrush
(
COLORREF
 
¸Cﬁ‹
)

1262 
MWBRUSHOBJ
 *
hbr
;

1264 
hbr
 = 
	`GdIãmNew
(
MWBRUSHOBJ
);

1265 if(!
hbr
)

1266  
NULL
;

1267 
hbr
->
hdr
.
ty≥
 = 
OBJ_BRUSH
;

1268 
hbr
->
hdr
.
°ockobj
 = 
FALSE
;

1269 
hbr
->
°yÀ
 = 
BS_SOLID
;

1270 
hbr
->
cﬁ‹
 = 
¸Cﬁ‹
;

1271  (
HBRUSH
)
hbr
;

1272 
	}
}

1274 
HPEN
 
WINAPI


1275 
	$Cª©ePí
(
nPíStyÀ
, 
nWidth
, 
COLORREF
 
¸Cﬁ‹
)

1277 
MWPENOBJ
 *
h≥n
;

1280 
h≥n
 = 
	`GdIãmNew
(
MWPENOBJ
);

1281 if(!
h≥n
)

1282  
NULL
;

1283 
h≥n
->
hdr
.
ty≥
 = 
OBJ_PEN
;

1284 
h≥n
->
hdr
.
°ockobj
 = 
FALSE
;

1285 
h≥n
->
°yÀ
 = 
nPíStyÀ
;

1286 
h≥n
->
cﬁ‹
 = 
¸Cﬁ‹
;

1287  (
HPEN
)
h≥n
;

1288 
	}
}

1290 
HBITMAP
 
WINAPI


1291 
	$Cª©eCom∑tibÀBôm≠
(
HDC
 
hdc
, 
nWidth
, 
nHeight
)

1293 
MWBITMAPOBJ
 * 
hbôm≠
;

1294 
size
;

1295 
löñí
;

1297 if(!
hdc
)

1298  
NULL
;

1300 
nWidth
 = 
	`MWMAX
(nWidth, 1);

1301 
nHeight
 = 
	`MWMAX
(nHeight, 1);

1304 if(!
	`GdCÆcMemGCAŒoc
(
hdc
->
psd
, 
nWidth
, 
nHeight
, 0, 0, &
size
, &
löñí
))

1305  
NULL
;

1308 
hbôm≠
 = (
MWBITMAPOBJ
 *)
	`GdIãmAŒoc
((MWBITMAPOBJ)-1+
size
);

1309 if(!
hbôm≠
)

1310  
NULL
;

1311 
hbôm≠
->
hdr
.
ty≥
 = 
OBJ_BITMAP
;

1312 
hbôm≠
->
hdr
.
°ockobj
 = 
FALSE
;

1313 
hbôm≠
->
width
 = 
nWidth
;

1314 
hbôm≠
->
height
 = 
nHeight
;

1317 
hbôm≠
->
∂™es
 = 
hdc
->
psd
->planes;

1318 
hbôm≠
->
bµ
 = 
hdc
->
psd
->bpp;

1319 
hbôm≠
->
löñí
 =Üinelen;

1320 
hbôm≠
->
size
 = size;

1322  (
HBRUSH
)
hbôm≠
;

1323 
	}
}

1326 
HDC
 
WINAPI


1327 
	$Cª©eCom∑tibÀDC
(
HDC
 
hdc
)

1329 
HDC
 
hdcmem
;

1330 
PSD
 
psd
;

1331 
PSD
 
mempsd
;

1334 
psd
 = 
hdc
? hdc->psd: &
s¸dev
;

1337 
mempsd
 = 
psd
->
	`AŒoˇãMemGC
(psd);

1338 if(!
mempsd
)

1339  
NULL
;

1342 
hdcmem
 = 
	`GëDCEx
(
NULL
, NULL, 
DCX_DEFAULTCLIP
);

1343 if(!
hdcmem
) {

1344 
mempsd
->
	`FªeMemGC
(mempsd);

1345  
NULL
;

1347 
hdcmem
->
psd
 = 
mempsd
;

1350 
	`Sñe˘Obje˘
(
hdcmem
, (
HGDIOBJ
)&
deÁu…_bôm≠
);

1351  
hdcmem
;

1352 
	}
}

1354 
BOOL
 
WINAPI


1355 
	$BôB…
(
HDC
 
hdcDe°
, 
nXDe°
, 
nYDe°
, 
nWidth
, 
nHeight
,

1356 
HDC
 
hdcSrc
, 
nXSrc
, 
nYSrc
, 
DWORD
 
dwR›
)

1359  
	`SåëchB…
(
hdcDe°
, 
nXDe°
, 
nYDe°
, 
nWidth
, 
nHeight
,

1360 
hdcSrc
, 
nXSrc
, 
nYSrc
, 
nWidth
, 
nHeight
, 
dwR›
);

1361 
	}
}

1363 
BOOL
 
WINAPI


1364 
	$SåëchB…
(
HDC
 
hdcDe°
, 
nXOrigöDe°
, 
nYOrigöDe°
, 
nWidthDe°
,

1365 
nHeightDe°
, 
HDC
 
hdcSrc
, 
nXOrigöSrc
, 
nYOrigöSrc
,

1366 
nWidthSrc
, 
nHeightSrc
, 
DWORD
 
dwR›
)

1369 
HWND
 
hwnd
;

1370 
POINT
 
d°
, 
§c
;

1372 if(!
hdcDe°
 || !
hdcSrc
)

1373  
FALSE
;

1374 
d°
.
x
 = 
nXOrigöDe°
;

1375 
d°
.
y
 = 
nYOrigöDe°
;

1376 
§c
.
x
 = 
nXOrigöSrc
;

1377 
§c
.
y
 = 
nYOrigöSrc
;

1381 if(!
	`MwIsMemDC
(
hdcSrc
Ë&& 
	`MwIsClõ¡DC
(hdcSrc)) {

1382 if(!(
hwnd
 = 
	`MwPª∑ªDC
(
hdcSrc
)))

1383  
FALSE
;

1384 
	`Clõ¡ToS¸ìn
(
hwnd
, &
§c
);

1388 if(!
	`MwIsMemDC
(
hdcDe°
Ë&& 
	`MwIsClõ¡DC
(hdcDest)) {

1389 if(!(
hwnd
 = 
	`MwPª∑ªDC
(
hdcDe°
)))

1390  
FALSE
;

1391 
	`Clõ¡ToS¸ìn
(
hwnd
, &
d°
);

1394 i‡(
nWidthDe°
 =
nWidthSrc
 && 
nHeightDe°
 =
nHeightSrc
) {

1395 
	`GdBlô
(
hdcDe°
->
psd
, 
d°
.
x
, d°.
y
, 
nWidthDe°
, 
nHeightDe°
,

1396 
hdcSrc
->
psd
, 
§c
.
x
, src.
y
, 
dwR›
);

1398 
	`GdSåëchBlô
(
hdcDe°
->
psd
, 
d°
.
x
, d°.
y
,

1399 
nWidthDe°
, 
nHeightDe°
, 
hdcSrc
->
psd
, 
§c
.
x
, src.
y
,

1400 
nWidthSrc
, 
nHeightSrc
, 
dwR›
);

1402  
TRUE
;

1403 
	}
}

1405 
UINT
 
WINAPI


1406 
	$GëSy°emPÆëãE¡rõs
(
HDC
 
hdc
,
UINT
 
iSèπIndex
,UINT 
nE¡rõs
,

1407 
LPPALETTEENTRY
 
Õ≥
)

1409 
UINT
 
i
;

1410 
MWPALENTRY
 
rgb
;

1413 if(!
hdc
 || hdc->
psd
 !&
s¸dev
)

1416 
i
=0; i<
nE¡rõs
; ++i) {

1417 if(!
	`GdGëPÆëã
(
hdc
->
psd
, 
i
+
iSèπIndex
, 1, &
rgb
))

1419 
Õ≥
->
≥Red
 = 
rgb
.
r
;

1420 
Õ≥
->
≥Gªí
 = 
rgb
.
g
;

1421 
Õ≥
->
≥Blue
 = 
rgb
.
b
;

1422 
Õ≥
->
≥Fœgs
 = 0;

1423 ++
Õ≥
;

1425  
i
;

1426 
	}
}

1429 
WINAPI


1430 
	$GëDevi˚C≠s
(
HDC
 
hdc
, 
nIndex
)

1432 
PSD
 
psd
;

1434 i‡(!
hdc
)

1435 
psd
 = &
s¸dev
;

1436 
psd
 = 
hdc
->psd;

1438 
nIndex
) {

1439 
HORZRES
:

1440  
psd
->
xvúåes
;

1441 
VERTRES
:

1442  
psd
->
yvúåes
;

1443 
BITSPIXEL
:

1444  
psd
->
bµ
;

1445 
PLANES
:

1446  
psd
->
∂™es
;

1447 
LOGPIXELSX
:

1448 
LOGPIXELSY
:

1450 
SIZEPALETTE
:

1451 i‡(
psd
->
bµ
 <= 8)

1452  
psd
->
ncﬁ‹s
;

1456 
	}
}

	@mwin/winlib/button.c

1 
	~"wödows.h
"

2 
	~"wödowsx.h
"

3 
	~"wötoﬁs.h
"

12 
	#GET_PBSTATE
(
h
Ë(
	`GëWödowW‹d
(h, 0))

	)

13 
	#GET_PBCAPTURE
(
h
Ë(
	`GëWödowW‹d
(h, 2))

	)

14 
	#GET_PBWASINSIDE
(
h
Ë(
	`GëWödowW‹d
(h, 4))

	)

15 
	#GET_PBDELETEFONT
(
h
Ë(
	`GëWödowW‹d
(h, 6))

	)

16 
	#GET_PBFONT
(
h
Ë(
	`GëWödowW‹d
(h, 8))

	)

18 
	#SET_PBSTATE
(
h
,
x
Ë(
	`SëWödowW‹d
(h, 0, x))

	)

19 
	#SET_PBCAPTURE
(
h
,
x
Ë(
	`SëWödowW‹d
(h, 2, x))

	)

20 
	#SET_PBWASINSIDE
(
h
,
x
Ë(
	`SëWödowW‹d
(h, 4, x))

	)

21 
	#SET_PBDELETEFONT
(
h
,
x
Ë(
	`SëWödowW‹d
(h, 6, x))

	)

22 
	#SET_PBFONT
(
h
,
x
Ë(
	`SëWödowW‹d
(h, 8, x))

	)

24 
	#PARENT
(
hwnd
Ë((
HWND
)
	`GëWödowL⁄g
(hwnd,
GWL_HWNDPARENT
))

	)

27 
	#PUSH_UP
 0x0000

	)

28 
	#PUSH_DOWN
 0x0001

	)

29 
	#PUSH_FOCUS
 0x0002

	)

30 
	#PUSH_DISABLED
 0x0004

	)

31 
	#PUSH_DEFAULT
 0x0008

	)

32 
	#PUSH_CHECKED
 0x0010

	)

35 
	#PBS_UP
 0x0000

	)

36 
	#PBS_FOCUSDOWN
 0x0001

	)

37 
	#PBS_FOCUSUP
 0x0002

	)

38 
	#PBS_DISABLED
 0x0004

	)

39 
	#PBS_DEFAULT
 0x0008

	)

40 
	#PBS_CHECKED
 0x0010

	)

42 
	#WM_PAINT_SPECIAL
 
WM_PAINT


	)

43 
	#HANDLE_WM_PAINT_SPECIAL
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

44 ((
‚
)((
hwnd
),(
HDC
)(
wP¨am
)), 0L)

	)

47 
	#HANDLE_BM_GETSTATE
(
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
Ë((‚)(hwnd))

	)

48 
	#FORWARD_BM_GETSTATE
(
hwnd
) \

49 (
LONG
)(
‚
)((
hwnd
), 
BM_GETSTATE
, (
WPARAM
)0, (
LPARAM
)0)

	)

52 
	#HANDLE_BM_SETSTATE
–
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

53 ((
‚
)((
hwnd
), (
WORD
)
wP¨am
), 0)

	)

54 
	#FORWARD_BM_SETSTATE
–
hwnd
, 
wSèã
) \

55 (
‚
)((
hwnd
), 
BM_SETSTATE
, (
WPARAM
)
wSèã
, (
LPARAM
)0)

	)

58 
	#HANDLE_BM_SETSTYLE
–
hwnd
, 
wP¨am
, 
lP¨am
, 
‚
) \

59 ((
‚
)((
hwnd
), (
WORD
)
wP¨am
, (
BOOL
)
	`LOWORD
(
lP¨am
)), 0)

	)

60 
	#FORWARD_BM_SETSTYLE
–
hwnd
, 
°yÀ
, 
bRedøw
, 
‚
) \

61 (
‚
)((
hwnd
), 
BM_SETSTYLE
, (
WPARAM
)
°yÀ
, 
	`MAKELPARAM
(
bRedøw
, 0))

	)

64 
WINAPI
 
CheckRadioBuâ⁄
(
HWND
 
hDlg
, 
nIDFú°
,
nIDLa°
,

65 
nIDCheckBuâ⁄
);

68 
WINAPI
 
˚nBuâ⁄_FnEnd
–
HWND
, 
WORD
);

69 
WORD
 
WINAPI
 
˚nBuâ⁄_FnSèπ
–
HWND
);

70 
BOOL
 
WINAPI
 
˚nBuâ⁄_OnCª©e
–
HWND
, 
LPCREATESTRUCT
);

73 
BOOL
 
WINAPI
 
˚nBuâ⁄_OnEø£Bkgnd
–
HWND
, 
HDC
);

75 
LONG
 
WINAPI
 
˚nBuâ⁄_OnGëSèã
–
HWND
);

77 
WINAPI
 
˚nBuâ⁄_OnKûlFocus
–
HWND
, HWND);

78 
WINAPI
 
˚nBuâ⁄_OnLBuâ⁄Down
–
HWND
, 
BOOL
, 
UINT
, UINT, UINT);

79 
WINAPI
 
˚nBuâ⁄_OnLBuâ⁄Up
–
HWND
, 
UINT
, UINT, UINT);

80 
WINAPI
 
˚nBuâ⁄_OnMou£Move
–
HWND
, 
UINT
, UINT, UINT);

81 
WINAPI
 
˚nBuâ⁄_OnPaöt
–
HWND
, 
HDC
);

82 
WINAPI
 
DøwPushBuâ⁄
(
HWND
 
hwnd
,
HDC
 
hDCwP¨am
,
UINT
 
wEnumSèã
,

83 
DWORD
 
dwStyÀ
);

84 
WINAPI
 
DøwGroupBox
(
HWND
 
hwnd
,
HDC
 
hDCwP¨am
, 
DWORD
 
dwStyÀ
);

85 
WINAPI
 
˚nBuâ⁄_OnSëFocus
–
HWND
, HWND);

86 
WINAPI
 
˚nBuâ⁄_OnSëStyÀ
–
HWND
, 
WORD
, 
BOOL
);

87 
WINAPI
 
˚nBuâ⁄_OnSëSèã
–
HWND
, 
WORD
);

88 
WINAPI
 
˚nBuâ⁄_SëSèã
–
HWND
, 
WORD
, 
BOOL
);

89 
WINAPI
 
˚nBuâ⁄_OnSëText
–
HWND
, 
LPCSTR
);

91 
WINAPI


92 
	$˚nBuâ⁄_FnEnd
(

93 
HWND
 
hwnd
,

94 
WORD
 
wSèã
)

96 if–
wSèã
 !
	`GET_PBSTATE
–
hwnd
)) {

97 if–
	`IsWödowVisibÀ
–
hwnd
))

98 
	`Upd©eWödow
–
hwnd
);

100 
	}
}

102 
WORD
 
WINAPI


103 
	$˚nBuâ⁄_FnSèπ
(

104 
HWND
 
hwnd
)

106  
	`GET_PBSTATE
–
hwnd
);

107 
	}
}

109 
BOOL
 
WINAPI


110 
	$˚nBuâ⁄_OnCª©e
(

111 
HWND
 
hwnd
,

112 
LPCREATESTRUCT
 
ÕCª©e
)

117 
	`SET_PBSTATE
–
hwnd
, 
PUSH_UP
 );

118 
	`SET_PBCAPTURE
–
hwnd
, 
FALSE
 );

119 
	`SET_PBWASINSIDE
–
hwnd
, 
FALSE
 );

121 i‡((
ÕCª©e
->
°yÀ
 & 0x0fË=
BS_DEFPUSHBUTTON
)

122 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DEFAULT
, 
TRUE
 );

124 i‡(
ÕCª©e
->
°yÀ
 & 
WS_DISABLED
)

125 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DISABLED
, 
TRUE
 );

127 –
TRUE
);

128 
	}
}

131 
WINAPI


132 
	$˚nBuâ⁄_OnDe°roy
(

133 
HWND
 
hwnd
)

135 if–
	`GET_PBDELETEFONT
–
hwnd
)) {

136 
	`DñëeObje˘
–
	`GET_PBFONT
–
hwnd
));

137 
	`SET_PBDELETEFONT
–
hwnd
, 
FALSE
);

139 
	}
}

141 
WINAPI


142 
	$˚nBuâ⁄_OnE«bÀ
(

143 
HWND
 
hwnd
,

144 
BOOL
 
bE«bÀ
)

146 
WORD
 
wSèã
;

148 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

149 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DISABLED
, !
bE«bÀ
);

150 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

151 
	}
}

154 
BOOL
 
WINAPI


155 
	$˚nBuâ⁄_OnEø£Bkgnd
(

156 
HWND
 
hwnd
,

157 
HDC
 
hdc
)

160  
TRUE
;

161 
	}
}

164 
UINT
 
WINAPI


165 
	$˚nBuâ⁄_OnGëDlgCode
(

166 
HWND
 
hwnd
,

167 
LPMSG
 
ÕMsg
)

178 –
DLGC_BUTTON
);

179 
	}
}

182 
LONG
 
WINAPI


183 
	$˚nBuâ⁄_OnGëSèã
(

184 
HWND
 
hwnd
)

190 ––
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_DOWN
) == PUSH_DOWN);

191 
	}
}

194 
WINAPI


195 
	$˚nBuâ⁄_OnKey
(

196 
HWND
 
hwnd
,

197 
UINT
 
vk
,

198 
BOOL
 
bDown
,

199 
cRïót
,

200 
UINT
 
Êag
)

202 
WORD
 
wSèã
;

204 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

205 i‡(
bDown
) {

211 i‡–(
vk
 =' 'Ë&& !(
	`HIBYTE
(
Êag
) & 0x40) )

212 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
TRUE
 );

220 i‡–
vk
 == ' ' )

221 { 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
FALSE
 );

223 i‡(
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_FOCUS
) {

224 
	`FORWARD_WM_COMMAND
–
	`PARENT
–
hwnd
), 
	`GëDlgCålID
( hwnd),

225 
hwnd
, 
BN_CLICKED
, 
SídMesßge
);

226 if(!
	`IsWödow
(
hwnd
))

231 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

232 
	}
}

235 
WINAPI


236 
	$˚nBuâ⁄_OnKûlFocus
(

237 
HWND
 
hwnd
,

238 
HWND
 
hwndNewFocus
)

240 
WORD
 
wSèã
;

242 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

243 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_FOCUS
, 
FALSE
 );

244 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

245 
	}
}

247 
WINAPI


248 
	$˚nBuâ⁄_OnLBuâ⁄Down
(

249 
HWND
 
hwnd
,

250 
BOOL
 
bDblClick
,

251 
UINT
 
x
,

252 
UINT
 
y
,

253 
UINT
 
keySèã
)

255 
WORD
 
wSèã
;

257 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

259 
	`SëC≠tuª
–
hwnd
 );

261 
	`SëFocus
–
hwnd
 );

262 
	`SET_PBCAPTURE
–
hwnd
, 
TRUE
 );

263 
	`SET_PBWASINSIDE
–
hwnd
, 
TRUE
 );

265 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
TRUE
 );

266 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

267 
	}
}

269 
WINAPI


270 
	$˚nBuâ⁄_OnLBuâ⁄Up
(

271 
HWND
 
hwnd
,

272 
UINT
 
x
,

273 
UINT
 
y
,

274 
UINT
 
keys
)

276 
WORD
 
wSèã
;

277 
DWORD
 
dwStyÀ
;

279 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

280 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

283 if(
	`GëC≠tuª
(Ë=
hwnd
)

284 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
FALSE
 );

286 
	`Rñó£C≠tuª
();

289 i‡(
	`GET_PBWASINSIDE
–
hwnd
)) {

290 ()(
dwStyÀ
 & 0x0f)) {

291 
BS_AUTOCHECKBOX
:

292 
	`SídMesßge
(
hwnd
,
BM_SETCHECK
,(
wSèã
 & 
PBS_CHECKED
)?0:1,0L);

294 
BS_AUTORADIOBUTTON
:

295 
	`CheckRadioBuâ⁄
(
	`PARENT
(
hwnd
),0,0xffff,hwnd->
id
);

298 
	`FORWARD_WM_COMMAND
–
	`PARENT
–
hwnd
), 
	`GëDlgCålID
( hwnd), hwnd,

299 
BN_CLICKED
, 
SídMesßge
);

300 if(!
	`IsWödow
(
hwnd
))

304 
	`SET_PBCAPTURE
–
hwnd
, 
FALSE
 );

305 
	`SET_PBWASINSIDE
–
hwnd
, 
FALSE
 );

306 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

307 
	}
}

309 
WINAPI


310 
	$˚nBuâ⁄_OnMou£Move
(

311 
HWND
 
hwnd
,

312 
UINT
 
x
,

313 
UINT
 
y
,

314 
UINT
 
keys
)

325 
WORD
 
wSèã
;

326 
DWORD
 
dwStyÀ
;

328 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

329 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

330 if–
	`GET_PBCAPTURE
–
hwnd
)) {

331 if–!
	`PtInsideWödow
–
hwnd
, 
x
, 
y
) ) {

332 if–
	`GET_PBWASINSIDE
–
hwnd
)) {

333 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
FALSE
);

334 
	`SET_PBWASINSIDE
–
hwnd
, 
FALSE
 );

335 
	`Rñó£C≠tuª
();

336 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

339 if–!
	`GET_PBWASINSIDE
–
hwnd
) ) {

340 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, 
TRUE
 );

341 
	`SET_PBWASINSIDE
–
hwnd
, 
TRUE
 );

342 
	`GëC≠tuª
();

343 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

347 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

349 
	}
}

351 
WINAPI


352 
	$˚nBuâ⁄_OnPaöt
(

353 
HWND
 
hwnd
,

354 
HDC
 
hDCwP¨am
)

356 
UINT
 
wEnumSèã
;

357 
DWORD
 
dwStyÀ
;

359 if–
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_DISABLED
)

360 
wEnumSèã
 = 
PBS_DISABLED
;

361 if–
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_DOWN
)

362 
wEnumSèã
 = 
PBS_FOCUSDOWN
;

363 if–
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_CHECKED
)

364 
wEnumSèã
 = 
PBS_CHECKED
;

367 if–
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_FOCUS
)

368 
wEnumSèã
 = 
PBS_FOCUSUP
;

370 
wEnumSèã
 = 
PBS_UP
;

371 if–
	`GET_PBSTATE
–
hwnd
Ë& 
PUSH_DEFAULT
)

372 
wEnumSèã
 |
PBS_DEFAULT
;

376 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

377 ()(
dwStyÀ
 & 0x0f)) {

378 
BS_GROUPBOX
:

379 
	`DøwGroupBox
–
hwnd
, 
hDCwP¨am
, 
dwStyÀ
);

382 
	`DøwPushBuâ⁄
–
hwnd
, 
hDCwP¨am
, 
wEnumSèã
, 
dwStyÀ
);

384 
	}
}

386 
WINAPI


387 
	$DøwPushBuâ⁄
(
HWND
 
hwnd
,
HDC
 
hDCwP¨am
,
UINT
 
wEnumSèã
,
DWORD
 
dwStyÀ
)

389 
HDC
 
hdc
;

390 
HBRUSH
 
hNewBrush
;

391 
RECT
 
ª˘
;

392 
RECT
 
ª˘Clõ¡
;

393 
RECT
 
ª˘Save
;

394 
RECT
 
rc
;

395 
iFa˚Off£t
 = 0;

396 
INT
 
uiHeight
;

397 
INT
 
uiWidth
;

398 
COLORREF
 
¸Old
;

399 
COLORREF
 
¸BkOld
;

400 
ﬁdBkMode
;

401 
HFONT
 
hNewF⁄t
;

402 
HFONT
 
hOldF⁄t
;

403 
HPEN
 
hOldPí
;

404 
COLORREF
 
hOldCﬁ‹
;

405 
PAINTSTRUCT
 
ps
;

406 
buf
[256];

407 
	#uiWidthFøme
 0

	)

408 
	#uiWidthShadow
 2

	)

410 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

411 if(!
hdc
)

412 
Rëu∫
;

414 
	`GëWödowText
(
hwnd
, 
buf
, (buf));

415 
	`GëClõ¡Re˘
–
hwnd
, &
ª˘Clõ¡
 );

416 
uiWidth
 = 
ª˘Clõ¡
.
right
 -Ñe˘Clõ¡.
À·
;

417 
uiHeight
 = 
ª˘Clõ¡
.
bŸtom
 -Ñe˘Clõ¡.
t›
;

419 
hNewBrush
 = (
HBRUSH
Ë
	`GëStockObje˘
(
LTGRAY_BRUSH
);

420 
¸Old
 = 
	`SëTextCﬁ‹
–
hdc
, 
	`GëSysCﬁ‹
–
COLOR_BTNTEXT
));

421 
¸BkOld
 = 
	`SëBkCﬁ‹
–
hdc
, 
	`GëSysCﬁ‹
–
COLOR_BTNFACE
));

423 
rc
 = 
ª˘Clõ¡
;

424 ()(
dwStyÀ
 & 0x0f)) {

425 
BS_PUSHBUTTON
:

426 
BS_DEFPUSHBUTTON
:

427 if–
wEnumSèã
 & 
PBS_FOCUSDOWN
) {

428 if(
dwStyÀ
 & 
BS_BITMAP
)

429 
	`DøwDIB
(
hdc
, 
rc
.
À·
+1,Ñc.
t›
+1, (
PMWIMAGEHDR
)
hwnd
->
u£rd©a
);

430 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.À·,Ñc.
bŸtom
-rc.top,

431 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
), GetSysColor(COLOR_WINDOWFRAME));

432 
	`In£tR
(&
rc
, 1, 1);

433 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.À·,Ñc.
bŸtom
-rc.top,

434 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
), GetSysColor(COLOR_BTNSHADOW));

435 
	`In£tR
(&
rc
, 1, 1);

436 if(!(
dwStyÀ
 & 
BS_BITMAP
))

437 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

438 
iFa˚Off£t
 = 1;

440 if(
dwStyÀ
 & 
BS_BITMAP
)

441 
	`DøwDIB
(
hdc
, 
rc
.
À·
,Ñc.
t›
, (
PMWIMAGEHDR
)
hwnd
->
u£rd©a
);

442 if(
wEnumSèã
 & 
PBS_DEFAULT
) {

443 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

444 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

445 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
),

446 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
));

447 
	`In£tR
(&
rc
, 1, 1);

449 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.À·,Ñc.
bŸtom
-rc.top,

450 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
),GëSysCﬁ‹(
COLOR_WINDOWFRAME
));

451 
	`In£tR
(&
rc
, 1, 1);

452 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.À·,Ñc.
bŸtom
-rc.top,

453 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
), GëSysCﬁ‹(
COLOR_BTNSHADOW
));

454 
	`In£tR
(&
rc
, 1, 1);

455 if(!(
dwStyÀ
 & 
BS_BITMAP
))

456 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

457 
iFa˚Off£t
 = 0;

461 
BS_CHECKBOX
:

462 
BS_AUTOCHECKBOX
:

463 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

466 
rc
.
right
 =Ñc.
À·
 + 12;

467 
rc
.
bŸtom
 =Ñc.
t›
 + 12;

470 
	`Døw3dIn£t
(
hdc
, 
rc
.
À·
,Ñc.
t›
, 12, 12);

471 
	`In£tR
(&
rc
, 2, 2);

472 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
));

473 
iFa˚Off£t
 = 1;

474 if(
wEnumSèã
 & 
PBS_CHECKED
) {

475 
	`MoveToEx
(
hdc
, 
rc
.
À·
,Ñc.
t›
,
NULL
);

476 
	`LöeTo
(
hdc
, 
rc
.
right
,Ñc.
bŸtom
);

477 
	`MoveToEx
(
hdc
, 
rc
.
À·
,Ñc.
bŸtom
,
NULL
);

478 
	`LöeTo
(
hdc
, 
rc
.
right
,Ñc.
t›
);

482 
BS_AUTORADIOBUTTON
:

483 
BS_RADIOBUTTON
:

484 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

485 
rc
.
À·
 = 0;

486 
rc
.
t›
 += 1;

487 
rc
.
right
 =Ñc.
À·
 + 10;

488 
rc
.
bŸtom
 =Ñc.
t›
 + 10;

490 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

491 
hOldPí
 = 
	`Sñe˘Obje˘
(
hdc
, 
	`Cª©ePí
(
PS_SOLID
, 1,

492 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
)));

493 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_BRUSH
));

494 
	`EŒù£
(
hdc
,
rc
.
À·
,rc.
t›
,Ñc.
right
,rc.
bŸtom
);

495 
	`In£tR
(&
rc
, 1, 1);

497 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_BRUSH
));

498 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
,

499 
	`Cª©ePí
(
PS_SOLID
, 1,
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
))));

500 
	`EŒù£
(
hdc
,
rc
.
À·
,rc.
t›
,Ñc.
right
,rc.
bŸtom
);

501 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
, 
hOldPí
));

503 
iFa˚Off£t
 = 0;

504 if(
wEnumSèã
 & 
PBS_CHECKED
)

505 
	`EŒù£
(
hdc
, 
rc
.
À·
+2,Ñc.
t›
+2,Ñc.
right
-2,

506 
rc
.
bŸtom
-2);

513 if(
buf
[ 0]) {

514 
hNewF⁄t
 = 
	`GëStockObje˘
–
DEFAULT_GUI_FONT
);

515 
hOldF⁄t
 = 
	`Sñe˘Obje˘
–
hdc
, 
hNewF⁄t
);

518 
ª˘
.
À·
 = 0;

519 
ª˘
.
t›
 = 0;

520 
	`DøwText
–
hdc
, 
buf
, -1, &
ª˘
, 
DT_CALCRECT
 | 
DT_LEFT
 |

521 
DT_SINGLELINE
 | 
DT_TOP
);

522 
ª˘Save
 = 
ª˘
;

527 ()(
dwStyÀ
 & (
BS_LEFT
|
BS_CENTER
|
BS_RIGHT
))) {

528 
BS_CENTER
:

530 
ª˘
.
À·
 = (
uiWidth
 - (ª˘.
right
 -Ñect.left)) / 2

531 + 
iFa˚Off£t
;

533 
BS_LEFT
:

534 
ª˘
.
À·
 = 
uiWidthFøme
 + 
uiWidthShadow
 + 2

535 + 
iFa˚Off£t
;

537 
BS_RIGHT
:

538 
ª˘
.
À·
 = (ª˘.
right
 -Ñe˘.À·Ë+ 
uiWidthFøme


539 + 
uiWidthShadow
 + 4 + 
iFa˚Off£t
;

543 ()(
dwStyÀ
 & 0x0f)) {

544 
BS_CHECKBOX
:

545 
BS_AUTOCHECKBOX
:

546 
BS_AUTORADIOBUTTON
:

547 
BS_RADIOBUTTON
:

548 
ª˘
.
À·
 = 12;

552 
ª˘
.
right
 +ª˘.
À·
 - 
ª˘Save
.left;

554 ()(
dwStyÀ
 & (
BS_TOP
|
BS_VCENTER
|
BS_BOTTOM
))) {

555 
BS_VCENTER
:

557 
ª˘
.
t›
 = (
uiHeight
 - (ª˘.
bŸtom
 -Ñect.top)) / 2

558 + 
iFa˚Off£t
;

560 
BS_TOP
:

561 
ª˘
.
t›
 = 2 + 
uiWidthFøme
 + 
uiWidthShadow


562 + 
iFa˚Off£t
;

564 
BS_BOTTOM
:

565 
ª˘
.
t›
 = 
uiHeight
 - 
uiWidthFøme
 - 
uiWidthShadow
 -

566 (
ª˘
.
bŸtom
 -Ñe˘.
t›
Ë- 1 + 
iFa˚Off£t
;

569 ()(
dwStyÀ
 & 0x0f)) {

570 
BS_CHECKBOX
:

571 
BS_AUTOCHECKBOX
:

572 
BS_AUTORADIOBUTTON
:

573 
BS_RADIOBUTTON
:

574 
ª˘
.
t›
 = 0;

577 
ª˘
.
bŸtom
 +ª˘.
t›
 - 
ª˘Save
.top;

579 
ﬁdBkMode
 = 
	`SëBkMode
–
hdc
, 
TRANSPARENT
);

580 if(
wEnumSèã
 & 
PBS_DISABLED
)

581 
hOldCﬁ‹
 = 
	`SëTextCﬁ‹
–
hdc
,

582 
	`GëSysCﬁ‹
–
COLOR_GRAYTEXT
));

584 
hOldCﬁ‹
 = 
	`SëTextCﬁ‹
–
hdc
,

585 
	`GëSysCﬁ‹
–
COLOR_BTNTEXT
));

587 
	`DøwText
–
hdc
, 
buf
, -1, &
ª˘
,
DT_LEFT
 | 
DT_SINGLELINE
 | 
DT_TOP
);

589 
	`SëBkMode
–
hdc
, 
ﬁdBkMode
);

590 
	`SëTextCﬁ‹
–
hdc
, 
hOldCﬁ‹
);

591 
	`Sñe˘Obje˘
–
hdc
, 
hOldF⁄t
);

595 if–(!(
wEnumSèã
&
PBS_CHECKED
Ë&& (wEnumSèã&
PBS_FOCUSDOWN
)) ||

596 (
wEnumSèã
 & 
PBS_FOCUSUP
)) {

597 
ª˘
 = 
ª˘Clõ¡
;

598 
uiWidth
 = 
uiWidthFøme
 + 
uiWidthShadow
 + 2;

599 
ª˘
.
À·
 +
uiWidth
;

600 
ª˘
.
t›
 +
uiWidth
;

601 
ª˘
.
right
 -
uiWidth
;

602 
ª˘
.
bŸtom
 -
uiWidth
;

603 if((
dwStyÀ
 & (
BS_FLAT
|
BS_NOFOCUSRECT
)) == 0)

604 
	`DøwFocusRe˘
–
hdc
, &
ª˘
);

608 
	`SëTextCﬁ‹
–
hdc
, 
¸Old
);

609 
	`SëBkCﬁ‹
–
hdc
, 
¸BkOld
);

611 
Rëu∫
:

612 
	`EndPaöt
(
hwnd
, &
ps
);

613 
	}
}

615 
WINAPI


616 
	$˚nBuâ⁄_OnSëFocus
(

617 
HWND
 
hwnd
,

618 
HWND
 
hwndOldFocus
)

626 
WORD
 
wSèã
;

628 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

631 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

632 
	}
}

634 
WINAPI


635 
	$˚nBuâ⁄_OnSëStyÀ
(

636 
HWND
 
hwnd
,

637 
WORD
 
°yÀ
,

638 
BOOL
 
bRedøw
)

640 
WORD
 
wSèã
;

642 
wSèã
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

643 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DEFAULT
,

644 (
°yÀ
 & 0x0fË=
BS_DEFPUSHBUTTON
);

645 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèã
);

646 
	}
}

648 
WINAPI


649 
	$˚nBuâ⁄_OnSëSèã
(

650 
HWND
 
hwnd
,

651 
WORD
 
wSèã
)

653 
WORD
 
wSèãOld
;

655 
wSèãOld
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

656 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_DOWN
, (
wSèã
 ? 
TRUE
 : 
FALSE
 ) );

657 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèãOld
);

658 
	}
}

660 
WINAPI


661 
	$˚nBuâ⁄_SëSèã
(

662 
HWND
 
hwnd
,

663 
WORD
 
wSèã
,

664 
BOOL
 
bE«bÀ
 )

670 
WORD
 
wNewSèã
;

671 
WORD
 
wOldSèã
;

672 
RECT
 
ª˘Clõ¡
;

674 
wOldSèã
 = 
	`GET_PBSTATE
–
hwnd
);

675 
wNewSèã
 = (
bE«bÀ
 ? (
wOldSèã
 | 
wSèã
) : (wOldState & ~wState));

677 i‡(
wOldSèã
 !
wNewSèã
)

678 { 
	`SET_PBSTATE
–
hwnd
, 
wNewSèã
 );

679 
	`GëClõ¡Re˘
(
hwnd
, &
ª˘Clõ¡
);

680 
	`InvÆid©eRe˘
(
hwnd
, &
ª˘Clõ¡
, 
FALSE
);

682 
	}
}

685 
WINAPI


686 
	$˚nBuâ⁄_OnSëF⁄t
(

687 
HWND
 
hwnd
,

688 
HFONT
 
hF⁄t
,

689 
BOOL
 
bRedøw
)

691 
BOOL
 
bDñëeF⁄t
 = 
FALSE
;

692 
HFONT
 
hF⁄tNew
 = 0;

693 
LOGFONT
 
logF⁄t
;

696 if–
	`GëObje˘
–
hF⁄t
, –
logF⁄t
), &logFont) != 0) {

697 if–
logF⁄t
.
lfWeight
 !
FW_NORMAL
) {

698 
logF⁄t
.
lfWeight
 = 
FW_NORMAL
;

699 if––
hF⁄tNew
 = 
	`Cª©eF⁄tIndúe˘
–&
logF⁄t
)) != 0) {

700 
hF⁄t
 = 
hF⁄tNew
;

701 
bDñëeF⁄t
 = 
TRUE
;

706 if–
	`GET_PBDELETEFONT
–
hwnd
))

707 
	`DñëeObje˘
–
	`GET_PBFONT
–
hwnd
));

709 
	`SET_PBDELETEFONT
–
hwnd
, 
bDñëeF⁄t
);

710 
	`SET_PBFONT
–
hwnd
, 
hF⁄t
);

712 
	`FORWARD_WM_SETFONT
–
hwnd
, 
hF⁄t
, 
bRedøw
, 
DefWödowProc
);

713 
	}
}

716 
WINAPI


717 
	$˚nBuâ⁄_OnSëText
(

718 
HWND
 
hwnd
,

719 
LPCSTR
 
ÕszText
)

729 
	`FORWARD_WM_SETTEXT
–
hwnd
, 
ÕszText
, 
DefWödowProc
);

730 
	`InvÆid©eRe˘
–
hwnd
, 
NULL
, 
FALSE
);

731 
	`Upd©eWödow
–
hwnd
);

732 
	}
}

734 
LRESULT
 
CALLBACK


735 
	$˚nBuâ⁄WndFn
(

736 
HWND
 
hwnd
,

737 
UINT
 
mesßge
,

738 
WPARAM
 
wP¨am
,

739 
LPARAM
 
lP¨am
)

745  
mesßge
) {

746 
	`HANDLE_MSG
–
hwnd
, 
WM_CREATE
, 
˚nBuâ⁄_OnCª©e
);

748 
	`HANDLE_MSG
–
hwnd
, 
WM_SETFOCUS
, 
˚nBuâ⁄_OnSëFocus
);

749 
	`HANDLE_MSG
–
hwnd
, 
WM_KILLFOCUS
, 
˚nBuâ⁄_OnKûlFocus
);

750 
	`HANDLE_MSG
–
hwnd
, 
WM_LBUTTONDOWN
, 
˚nBuâ⁄_OnLBuâ⁄Down
);

751 
	`HANDLE_MSG
–
hwnd
, 
WM_LBUTTONDBLCLK
, 
˚nBuâ⁄_OnLBuâ⁄Down
);

752 
	`HANDLE_MSG
–
hwnd
, 
WM_LBUTTONUP
, 
˚nBuâ⁄_OnLBuâ⁄Up
);

753 
	`HANDLE_MSG
–
hwnd
, 
WM_MOUSEMOVE
, 
˚nBuâ⁄_OnMou£Move
);

756 
	`HANDLE_MSG
–
hwnd
, 
WM_ERASEBKGND
, 
˚nBuâ⁄_OnEø£Bkgnd
);

757 
	`HANDLE_MSG
–
hwnd
, 
WM_PAINT_SPECIAL
, 
˚nBuâ⁄_OnPaöt
);

759 
	`HANDLE_MSG
–
hwnd
, 
BM_SETSTYLE
, 
˚nBuâ⁄_OnSëStyÀ
);

760 
	`HANDLE_MSG
–
hwnd
, 
BM_GETSTATE
, 
˚nBuâ⁄_OnGëSèã
);

761 
	`HANDLE_MSG
–
hwnd
, 
BM_SETSTATE
, 
˚nBuâ⁄_OnSëSèã
);

764 
	`HANDLE_MSG
–
hwnd
, 
WM_SETTEXT
, 
˚nBuâ⁄_OnSëText
);

766 
BM_GETCHECK
:

768  
	`˚nBuâ⁄_OnGëSèã
(
hwnd
);

770 ––
	`GET_PBSTATE
(
hwnd
Ë& 
PUSH_CHECKED
) == PUSH_CHECKED);

773 
BM_SETCHECK
:

775 
	`˚nBuâ⁄_OnSëSèã
(
hwnd
, (
WORD
)
wP¨am
);

778 
WORD
 
wSèãOld
;

780 
wSèãOld
 = 
	`˚nBuâ⁄_FnSèπ
–
hwnd
);

781 
	`˚nBuâ⁄_SëSèã
–
hwnd
, 
PUSH_CHECKED
,

782 ((
WORD
)
wP¨am
 ? 
TRUE
 : 
FALSE
) );

783 
	`˚nBuâ⁄_FnEnd
–
hwnd
, 
wSèãOld
);

787 
BM_SETIMAGE
:

788 
hwnd
->
u£rd©a
 = (
DWORD
)
wP¨am
;

789 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
FALSE
);

792 
WM_NCMOUSEMOVE
:

793 i‡(
	`SídMesßge
(
hwnd
,
WM_NCHITTEST
,0,
lP¨am
Ë!
HTCLIENT
){

794 
	`˚nBuâ⁄_OnMou£Move
(
hwnd
,
	`LOWORD
 (
lP¨am
),
	`HIWORD
 (lParam),0);

799  
	`DefWödowProc
–
hwnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

800 
	}
}

803 
WINAPI


804 
	$MwBuâ⁄Regi°î
(
HINSTANCE
 
hIn°™˚
)

806  
	`MwRegi°îBuâ⁄C⁄åﬁ
(
hIn°™˚
);

807 
	}
}

809 
WINAPI


810 
	$MwRegi°îBuâ⁄C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

812 
WNDCLASS
 
wc
;

814 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

815 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
˚nBuâ⁄WndFn
;

816 
wc
.
cbClsExåa
 = 0;

817 
wc
.
cbWndExåa
 = 10;

818 
wc
.
hIn°™˚
 = hInstance;

819 
wc
.
hIc⁄
 = 
NULL
;

820 
wc
.
hCurs‹
 = 0;

821 
wc
.
hbrBackground

	`GëStockObje˘
(
LTGRAY_BRUSH
);

822 
wc
.
ÕszMíuName
 = 
NULL
;

823 
wc
.
ÕszCœssName
= "BUTTON";

825  
	`Regi°îCœss
(&
wc
);

826 
	}
}

828 
WINAPI


829 
	$DøwGroupBox
(
HWND
 
hwnd
,
HDC
 
hDCwP¨am
,
DWORD
 
dwStyÀ
)

831 
HDC
 
hdc
;

832 
HFONT
 
hF⁄t
;

833 
RECT
 
rcClõ¡
;

834 
RECT
 
rcText
;

835 
RECT
 
rc
;

836 
PAINTSTRUCT
 
ps
;

837 
buf
[256];

838 
HPEN
 
hPíT›
, 
hPíBŸtom
, 
hﬁdPí
;

839 
COLORREF
 
¸T›
,
¸BŸtom
;

842 
hdc
 = 
	`BegöPaöt
(
hwnd
, &
ps
);

843 if(!
hdc
)

844 
Rëu∫
;

846 
	`GëWödowText
(
hwnd
, 
buf
, (buf));

847 
	`GëClõ¡Re˘
–
hwnd
, &
rcClõ¡
 );

849 
hF⁄t
 = 
	`GëStockObje˘
–
DEFAULT_GUI_FONT
);

850 i‡(
hF⁄t
)

851 
hF⁄t
 = 
	`Sñe˘Obje˘
(
hdc
,hFont);

853 
rc
.
À·
 = 0;

854 
rc
.
t›
 = 0;

855 
	`DøwText
–
hdc
, 
buf
, -1, &
rc
, 
DT_CALCRECT
);

857 if(
buf
[ 0]) {

858 
	`SëTextCﬁ‹
(
hdc
,
	`GëSysCﬁ‹
(
COLOR_WINDOWTEXT
));

859 
	`SëBkMode
(
hdc
,
TRANSPARENT
);

860 
	`SëRe˘
(&
rcText
,8,2,
rc
.
right
+8,rc.
bŸtom
+2);

861 
	`DøwText
(
hdc
,
buf
,-1,&
rcText
,
DT_CENTER
);

864 
¸T›
=
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
);

865 
¸BŸtom
=
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
);

867 
hPíT›
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸T›
);

868 
hPíBŸtom
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸BŸtom
);

869 
hﬁdPí
 = 
	`Sñe˘Obje˘
–
hdc
, 
hPíT›
);

871 
	`MoveToEx
(
hdc
,0,
rc
.
bŸtom
/2,
NULL
);

873 if(
buf
[ 0]) {

874 
	`LöeTo
(
hdc
,5,
rc
.
bŸtom
/2);

875 
	`MoveToEx
(
hdc
,
rc
.
right
+11,rc.
bŸtom
/2,
NULL
);

876 
	`LöeTo
(
hdc
,
rcClõ¡
.
right
-1,
rc
.
bŸtom
/2);

879 
	`LöeTo
(
hdc
,
rcClõ¡
.
right
-1,
rc
.
bŸtom
/2);

881 
	`LöeTo
(
hdc
,
rcClõ¡
.
right
-1,rcClõ¡.
bŸtom
-1);

883 
	`Sñe˘Obje˘
–
hdc
, 
hPíBŸtom
);

884 
	`LöeTo
(
hdc
,
rcClõ¡
.
À·
,rcClõ¡.
bŸtom
-1);

885 
	`LöeTo
(
hdc
,
rcClõ¡
.
À·
,
rc
.
bŸtom
/2);

887 
	`Sñe˘Obje˘
–
hdc
, 
hﬁdPí
);

888 
	`DñëeObje˘
–
hPíT›
);

889 
	`DñëeObje˘
–
hPíBŸtom
);

891 i‡(
hF⁄t
)

892 
	`Sñe˘Obje˘
(
hdc
,
hF⁄t
);

894 
Rëu∫
:

895 
	`EndPaöt
(
hwnd
, &
ps
);

896 
	}
}

899 
WINAPI


900 
	$CheckRadioBuâ⁄
(
HWND
 
hDlg
, 
nIDFú°
,
nIDLa°
,
nIDCheckBuâ⁄
)

902 
HWND
 
hWndCheck
,
hWndTemp
;

903 
DWORD
 
dwStyÀ
;

905 i‡(!(
hWndCheck
 = 
	`GëDlgIãm
(
hDlg
,
nIDCheckBuâ⁄
)))

908 
hWndTemp
=
hDlg
->
chûdªn
; hWndTemp; hWndTemp=hWndTemp->
siblögs
) {

909 if(
hWndCheck
 =
hWndTemp
) ;

910 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hWndTemp
,
GWL_STYLE
);

911 i‡((
hWndTemp
->
id
 >(
WORD
)
nIDFú°
) &&

912 (
hWndTemp
->
id
 <(
WORD
)
nIDLa°
) &&

913 ((
	`LOWORD
(
dwStyÀ
Ë=
BS_RADIOBUTTON
) ||

914 (
	`LOWORD
(
dwStyÀ
Ë=
BS_AUTORADIOBUTTON
)))

915 
	`SídMesßge
(
hWndTemp
,
BM_SETCHECK
,
FALSE
,0);

917 
	`SídMesßge
(
hWndCheck
,
BM_SETCHECK
,
TRUE
,0);

918 
	}
}

	@mwin/winlib/caret.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<sys/time.h
>

11 #i‚de‡
__ECOS


12 
	~<mÆloc.h
>

14 
	~"wödows.h
"

15 
	~"devi˚.h
"

17 
	#DEF_BLINK_TIME
 500

	)

20 
HWND
 
	mhwnd
;

21 
	mx
;

22 
	my
;

23 
	mnWidth
;

24 
	mnHeight
;

25 
BOOL
 
	mfShown
;

26 
	mnShowCou¡
;

27 
UINT
 
	mnBlökTime
;

28 } 
	tCARETINFO
;

31 
CARETINFO
 
	gsysC¨ë
;

34 
MwShowC¨ë
();

35 
MwHideC¨ë
();

36 
MwUpd©eC¨ë
();

38 
BOOL
 
WINAPI


39 
	$Cª©eC¨ë
(
HWND
 
hwnd
, 
HBITMAP
 
hBôm≠
, 
nWidth
, 
nHeight
)

42 
	`De°royC¨ë
();

44 i‡(
nWidth
 <= 0)

45 
nWidth
 = 1;

46 i‡(
nHeight
 <= 0)

47 
nHeight
 = 1;

49 
sysC¨ë
.
hwnd
 = hwnd;

50 
sysC¨ë
.
x
 = 0;

51 
sysC¨ë
.
y
 = 0;

52 
sysC¨ë
.
nWidth
 =ÇWidth;

53 
sysC¨ë
.
nHeight
 =ÇHeight;

54 
sysC¨ë
.
fShown
 = 
FALSE
;

55 
sysC¨ë
.
nShowCou¡
 = 0;

56 
sysC¨ë
.
nBlökTime
 = 
DEF_BLINK_TIME
;

57  
TRUE
;

58 
	}
}

60 
BOOL
 
WINAPI


61 
	$De°royC¨ë
(
VOID
)

63 i‡(
sysC¨ë
.
fShown
)

64 
	`MwHideC¨ë
();

65 
sysC¨ë
.
hwnd
 = 
NULL
;

66 
sysC¨ë
.
fShown
 = 
FALSE
;

67  
TRUE
;

68 
	}
}

70 
BOOL
 
WINAPI


71 
	$HideC¨ë
(
HWND
 
hwnd
)

73 i‡(
hwnd
 =
NULL
)

74 
hwnd
 = 
sysC¨ë
.hwnd;

75 i‡(
hwnd
 =
NULL
 || hwnd !
sysC¨ë
.hwnd)

76  
FALSE
;

79 i‡(--
sysC¨ë
.
nShowCou¡
 == 0) {

80 
	`MwHideC¨ë
();

81  
TRUE
;

83  
FALSE
;

84 
	}
}

86 
BOOL
 
WINAPI


87 
	$ShowC¨ë
(
HWND
 
hwnd
)

89 i‡(
hwnd
 =
NULL
)

90 
hwnd
 = 
sysC¨ë
.hwnd;

91 i‡(
hwnd
 =
NULL
 || hwnd !
sysC¨ë
.hwnd || sysC¨ë.
nShowCou¡
 < 0)

92  
FALSE
;

94 i‡(++
sysC¨ë
.
nShowCou¡
 > 1)

95  
TRUE
;

98 
	`MwShowC¨ë
();

99  
TRUE
;

100 
	}
}

102 
BOOL
 
WINAPI


103 
	$SëC¨ëPos
(
nX
, 
nY
)

105 i‡(
sysC¨ë
.
fShown
 && (sysC¨ë.
x
 !
nX
 || sysC¨ë.
y
 !
nY
)) {

106 
	`MwUpd©eC¨ë
();

107 
sysC¨ë
.
x
 = 
nX
;

108 
sysC¨ë
.
y
 = 
nY
;

109 
	`MwUpd©eC¨ë
();

110  
TRUE
;

112 
sysC¨ë
.
x
 = 
nX
;

113 
sysC¨ë
.
y
 = 
nY
;

114  
TRUE
;

115 
	}
}

117 
BOOL
 
WINAPI


118 
	$GëC¨ëPos
(
LPPOINT
 
ÕPoöt
)

120 
ÕPoöt
->
x
 = 
sysC¨ë
.x;

121 
ÕPoöt
->
y
 = 
sysC¨ë
.y;

122  
TRUE
;

123 
	}
}

125 
UINT
 
WINAPI


126 
	$GëC¨ëBlökTime
(
VOID
)

128  
sysC¨ë
.
nBlökTime
;

129 
	}
}

131 
BOOL
 
WINAPI


132 
	$SëC¨ëBlökTime
(
UINT
 
uMSec⁄ds
)

134 
sysC¨ë
.
nBlökTime
 = 
uMSec⁄ds
;

136  
TRUE
;

137 
	}
}

140 
	$MwShowC¨ë
()

142 i‡(
sysC¨ë
.
fShown
)

144 
	`MwUpd©eC¨ë
();

145 
sysC¨ë
.
fShown
 = 
TRUE
;

146 
	}
}

149 
	$MwHideC¨ë
()

151 i‡(!
sysC¨ë
.
fShown
)

153 
	`MwUpd©eC¨ë
();

154 
sysC¨ë
.
fShown
 = 
FALSE
;

155 
	}
}

159 
	$MwUpd©eC¨ë
()

161 
ﬁdmode
;

162 
HDC
 
hdc
;

163 
HPEN
 
h≥n
;

164 
HBRUSH
 
hbr
;

166 
ﬁdmode
 = 
	`GdSëMode
(
MWMODE_XOR
);

167 
hdc
 = 
	`GëDC
(
sysC¨ë
.
hwnd
);

168 
h≥n
 = 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_PEN
));

171 i‡(
sysC¨ë
.
nWidth
 == 1) {

172 
	`MoveToEx
(
hdc
, 
sysC¨ë
.
x
, sysC¨ë.
y
, 
NULL
);

173 
	`LöeTo
(
hdc
, 
sysC¨ë
.
x
, sysC¨ë.
y
+sysC¨ë.
nHeight
);

175 
hbr
 = 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
WHITE_BRUSH
));

176 
	`Re˘™gÀ
(
hdc
, 
sysC¨ë
.
x
, sysC¨ë.
y
,

177 
sysC¨ë
.
x
+sysC¨ë.
nWidth
,

178 
sysC¨ë
.
y
+sysC¨ë.
nHeight
);

179 
	`Sñe˘Obje˘
(
hdc
, 
hbr
);

181 
	`Sñe˘Obje˘
(
hdc
, 
h≥n
);

182 
	`Rñó£DC
(
sysC¨ë
.
hwnd
, 
hdc
);

183 
	`GdSëMode
(
ﬁdmode
);

184 
	}
}

	@mwin/winlib/combobox.c

34 
	~<°dio.h
>

35 
	~<°dlib.h
>

36 
	~<°rög.h
>

37 
	~"wödows.h
"

38 
	~"wödowsx.h
"

39 
	~"mwsy°em.h
"

41 #i‡
PSP


43 
	~<p•kî√l.h
>

44 
	~<p•debug.h
>

47 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

49 
	#Ârötf
(...)

	)

54 
	#WöMÆloc
(
n
Ë
	`mÆloc
(“))

	)

55 
	#WöFªe
(
p
Ë
	`‰ì
’)

	)

57 
	#GET_WM_COMMAND_ID
(
wp
, 
Õ
Ë
	`LOWORD
(wp)

	)

58 
	#GET_WM_COMMAND_HWND
(
wp
, 
Õ
Ë(
HWND
)÷p)

	)

59 
	#GET_WM_COMMAND_CMD
(
wp
, 
Õ
Ë
	`HIWORD
(wp)

	)

60 
	#GET_WM_COMMAND_MPS
(
id
, 
hwnd
, 
cmd
) \

61 (
WPARAM
)
	`MAKELONG
(
id
, 
cmd
), (
LONG
)(
hwnd
)

	)

62 
	#LOSHORT
(
x
Ë()
	`LOWORD
(x)

	)

63 
	#Edô_SëSñ
(
hwndCé
, 
ichSèπ
, 
ichEnd
Ë(()
	`SídMesßge
((hwndCé), 
EM_SETSEL
, (ichSèπ), (ichEnd)))

	)

67 
HFONT
 
	mhF⁄t
;

68 
HWND
 
	mhWndP¨ít
;

69 
UINT
 
	mnID
;

70 
WORD
 
	mwSèãFœgs
;

71 
UINT
 
	mwStyÀ
;

72 
BOOL
 
	mbExãnded
;

73 
BOOL
 
	mbRedøw
;

74 
HWND
 
	mEdôC⁄åﬁ
;

75 
HWND
 
	mLi°BoxC⁄åﬁ
;

76 
RECT
 
	mBuâ⁄Re˘
;

77 
RECT
 
	mLi°BoxRe˘
;

78 
UINT
 
	muHeight
;

79 
WNDPROC
 
	mÕ‚OldSètic
;

80 
UINT
 
	mnLi°Iãms
;

81 } 
	tCOMBOBOX
;

83 
	#CWD_LPCBDATA
 0

	)

84 
	#CBC_EDITID
 1

	)

86 
	#CSF_CAPTUREACTIVE
 0x0001

	)

87 
	#CSF_LOCALBUTTONDOWN
 0x0002

	)

88 
	#CSF_BUTTONDOWN
 0x0004

	)

89 
	#CSF_LBOXBUTTONDOWN
 0x0008

	)

90 
	#CSF_FOCUS
 0x0010

	)

91 
	#CSF_HASDROPPED
 0x0020

	)

93 
	#SET_STATE
(
Õ
, 
wMask
Ë÷p->
wSèãFœgs
 |(wMask))

	)

94 
	#CLEAR_STATE
(
Õ
, 
wMask
Ë÷p->
wSèãFœgs
 &~(wMask))

	)

95 
	#IS_SET
(
Õ
, 
wMask
Ë÷p->
wSèãFœgs
 & (wMask))

	)

97 
	#BOWNERDRAW
(
l
Ë(÷)->
wStyÀ
 & (
CBS_OWNERDRAWFIXED
|
CBS_OWNERDRAWVARIABLE
))

	)

130 
	$Døw3DBuâ⁄Re˘
(
HDC
 
hDC
, 
HPEN
 
hPíHigh
, HPEN 
hPíShadow
,

131 
RECT
 
rc
, 
BOOL
 
fClicked
)

133 
HPEN
 
hPíOld
;

134 
POINT
 
Õt
[6];

136 
POINT
 
p3
[3];

137 
shrök
=1;

139 
hPíOld
 = 
	`Sñe˘Obje˘
(
hDC
, 
hPíShadow
);

140 i‡(
fClicked
) {

141 
Õt
[0].
x
 =Ü±[1].x = 
rc
.
À·
;

142 
Õt
[1].
y
 =Ü±[2].y = 
rc
.
t›
;

143 
Õt
[2].
x
 = 
rc
.
right
-1;

144 
Õt
[0].
y
 = 
rc
.
bŸtom
-1;

145 
	`Pﬁylöe
(
hDC
,
Õt
,3);

148 
Õt
[0].
x
 =Ü±[1].x = 
rc
.
right
-1;

149 
Õt
[0].
y
 = 
rc
.
t›
;

150 
Õt
[1].
y
 =Ü±[2].y = 
rc
.
bŸtom
-1;

151 
Õt
[2].
x
 = 
rc
.
À·
;

152 
Õt
[3].
x
 = 
rc
.
À·
+1;

153 
Õt
[3].
y
 =Ü±[4].y = 
rc
.
bŸtom
-2;

154 
Õt
[4].
x
 =Ü±[5].x = 
rc
.
right
-2;

155 
Õt
[5].
y
 = 
rc
.
t›
+1;

156 
	`Pﬁylöe
(
hDC
,
Õt
,6);

158 
	`Sñe˘Obje˘
(
hDC
, 
hPíHigh
);

159 
Õt
[0].
x
 = 
rc
.
right
-1;

160 
Õt
[0].
y
 =Ü±[1].y = 
rc
.
t›
;

161 
Õt
[1].
x
 =Ü±[2].x = 
rc
.
À·
;

162 
Õt
[2].
y
 = 
rc
.
bŸtom
-1;

163 
Õt
[3].
x
 =Ü±[4].x = 
rc
.
À·
+1;

164 
Õt
[3].
y
 = 
rc
.
bŸtom
-2;

165 
Õt
[4].
y
 =Ü±[5].y = 
rc
.
t›
+1;

166 
Õt
[5].
x
 = 
rc
.
right
-2;

167 
	`Pﬁylöe
(
hDC
,
Õt
,6);

170 
	`Sñe˘Obje˘
(
hDC
,
	`GëStockObje˘
(
BLACK_BRUSH
));

172 
p3
[0].
x

rc
.
À·
 + (‘c.
right
-rc.left)/2) - 1;

173 
p3
[0].
y

rc
.
bŸtom
 - 4 - 
shrök
;

174 
p3
[1].
x

rc
.
À·
 + 2 + 
shrök
 - 1;

175 
p3
[1].
y

rc
.
bŸtom
-‘c.bŸtom-rc.
t›
Ë+ 2 + 
shrök
;

176 
p3
[2].
x

rc
.
À·
 + (‘c.
right
-rc.À·)-4Ë- 
shrök
;

177 
p3
[2].
y

rc
.
bŸtom
-‘c.bŸtom-rc.
t›
Ë+ 2 + 
shrök
;

178 
	`Pﬁyg⁄
(
hDC
,
p3
,3);

180 
	`Sñe˘Obje˘
(
hDC
,
hPíOld
);

181 
	}
}

185 
LRESULT
 
DefLISTBOXProc
(
HWND
, 
UINT
, 
WPARAM
, 
LPARAM
);

186 
LRESULT
 
Li°boxCålProc
(
HWND
, 
UINT
, 
WPARAM
, 
LPARAM
);

190 
HPEN
 
	$GëSysCﬁ‹Pí
(
cﬁ‹
)

192  
NULL
;

193 
	}
}

194 
HBRUSH
 
	$GëSysCﬁ‹Brush
(
cﬁ‹
)

196  
NULL
;

197 
	}
}

200 
HWND
 
	tHWND32
;

203 
HANDLE
 
	tHCLASS32
;

204 
HCLASS32
 
	$FödCœss
(
LPCSTR
 
°r
, 
HINSTANCE
 
hIn°™˚
)

206  
NULL
;

207 
	}
}

211 
HWND
 
	$TWIN_C⁄vîtToSysS¸ﬁl
(
HWND
 
hwnd
, 
BOOL
 
°©us
, 
LPPOINT
 
µ
)

213  
NULL
;

214 
	}
}

216 
HWND
 
li°wp
;

217 
HWND
 
	$WödowFromPoöt
(
POINT
 
±
)

219 
HWND
 
wp
,
wp1
;

220 
dx
,
dy
,
dx1
,
dy1
;

222  
NULL
;

224 
wp1
=
NULL
;

225 (
dx
))

228 
dx
=0x7fffffff;

229 
dy
=0x7fffffff;

232 
dx
=0x7fff;

233 
dy
=0x7fff;

236 
wp
=
li°wp
; wp; wp=wp->
√xt
)

238 i‡(
wp
->
wöª˘
.
À·
 <
±
.
x
 &&Öt.x <wp->wöª˘.
right
)

240 
dx1
=(
wp
->
wöª˘
.
right
-
±
.
x
);

241 i‡(
dx1
<
dx
)

243 
wp1
=
wp
;

244 
dx
=
dx1
;

246 
dx1
=(
±
.
x
-
wp
->
wöª˘
.
À·
);

247 i‡(
dx1
<
dx
)

249 
wp1
=
wp
;

250 
dx
=
dx1
;

253 i‡(
wp
->
wöª˘
.
t›
 <
±
.
y
 &&Öt.y <wp->wöª˘.
bŸtom
)

255 
dy1
=(
wp
->
wöª˘
.
bŸtom
-
±
.
y
);

256 i‡(
dy1
<
dy
)

258 
wp1
=
wp
;

259 
dy
=
dy1
;

261 
dy1
=(
±
.
y
-
wp
->
wöª˘
.
t›
);

262 i‡(
dy1
<
dy
)

264 
wp1
=
wp
;

265 
dy
=
dy1
;

270  
wp1
;

271 
	}
}

274 
CBoxDøwBuâ⁄
(
HWND
,
UINT
,
COMBOBOX
 *);

275 
CBoxSídMou£ToLBox
(
COMBOBOX
 *, 
UINT
, 
WPARAM
, 
POINT
);

276 
CBoxC≠tuª
(
HWND
, 
WORD
);

277 
CBoxDøwEdô
(
COMBOBOX
 *, 
HWND
, 
UINT
);

278 
CBoxDøwSètic
(
COMBOBOX
 *, 
HWND
, 
UINT
);

281 
LRESULT
 
DefCBProc
(
HWND
 , 
UINT
 , 
WPARAM
 , 
LPARAM
 );

284 
WNDPROC
 
	gÕComboBöToN©
 = 0;

287 
LRESULT
 
CALLBACK


288 
DefComboboxProc
(
HWND
 
hWnd
, 
UINT
 
uMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

290 
WINAPI
 
	$MwRegi°îComboboxC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

292 
WNDCLASS
 
wc
;

294 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

295 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
DefComboboxProc
;

296 
wc
.
cbClsExåa
 = 0;

297 
wc
.
cbWndExåa
 = 0;

298 
wc
.
hIn°™˚
 = hInstance;

299 
wc
.
hIc⁄
 = 
NULL
;

300 
wc
.
hCurs‹
 = 0;

301 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

302 
wc
.
ÕszMíuName
 = 
NULL
;

303 
wc
.
ÕszCœssName
= "COMBOBOX";

305  
	`Regi°îCœss
(&
wc
);

306 
	}
}

308 
LRESULT
 
CALLBACK


309 
	$DefComboboxProc
(
HWND
 
hWnd
, 
UINT
 
uMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

311 
PAINTSTRUCT
 
ps
;

312 
HDC
 
hDC
;

313 
TEXTMETRIC
 
tm
;

315 
MEASUREITEMSTRUCT
 
mis
;

317 
COMBOBOX
 *
Õ
 = (COMBOBOX *)
NULL
;

318 
LRESULT
 
rc
;

319 
HINSTANCE
 
hIn°
;

320 
POINT
 
˝
,
˝S¸ìn
,
µ
;

321 
UINT
 
uiKey
;

322 
LPCREATESTRUCT
 
Õcs
;

324 
LPWINDOWPOS
 
Õwp
;

327 
HCLASS32
 
hComboCœss32
;

328 
LPMEASUREITEMSTRUCT
 
Õmis
;

329 
LPDRAWITEMSTRUCT
 
Õdis
;

330 
LPDELETEITEMSTRUCT
 
Õdlis
;

332 
DWORD
 
dwStyÀ
,
dwExStyÀ
;

333 
WORD
 
wEdôWidth
 = 0,
wEdôHeight
;

334 
WORD
 
wCBN
;

336 
RECT
 
rcClõ¡
;

339 
rc
 = 
CB_OKAY
;

340 i‡((
uMsg
 !
WM_CREATE
 ) &&

341 !(
Õ
 = (
COMBOBOX
 *)
hWnd
->
u£rd©a
 ))

342  
rc
;

344 
uMsg
) {

346 
WM_SIZE
:

347 
WM_ENABLE
:

348 
WM_LBUTTONDBLCLK
:

349 
WM_COMPAREITEM
:

350 
WM_CUT
:

351 
WM_CLEAR
:

354 
WM_SETFOCUS
:

355 
	`SET_STATE
(
Õ
, 
CSF_FOCUS
);

356 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_DROPDOWNLIST
)

358 
uiKey
 = (
UINT
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0L);

359 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
uiKey
);

361 i‡(
Õ
->
EdôC⁄åﬁ
)

363 
	`SëFocus
(
Õ
->
EdôC⁄åﬁ
);

367 
WM_KILLFOCUS
:

368 
	`CLEAR_STATE
(
Õ
, 
CSF_FOCUS
);

369 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_DROPDOWNLIST
)

371 
uiKey
 = (
UINT
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0L);

372 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
uiKey
);

379 i‡((
Õ
->
wStyÀ
 & 0x0FË!
CBS_SIMPLE
 && 
wP¨am
 !(
WPARAM
Óp->
Li°BoxC⁄åﬁ
 && wParam != 0)

380 
	`SídMesßge
(
hWnd
, 
CB_SHOWDROPDOWN
, 0, 0L);

381 
	`Ârötf
(
°dîr
," 385: WM_KILLFOCUS\n");

385 
WM_KEYDOWN
:

393 
nCur
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
,0, 0L);

394 
nPªvCur
 = 
nCur
;

395 
nCou¡
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCOUNT
, 0, 0L);

397 i‡(
nCou¡
 == 0)

400 
wP¨am
)

402 
VK_HOME
:

403 
nCur
 = 0;

406 
VK_END
:

407 
nCur
 = 
nCou¡
 - 1;

410 
VK_UP
:

411 
nCur
--;

414 
VK_DOWN
:

415 
nCur
++;

422 i‡(
nCur
 >
nCou¡
)

423 
nCur
 = 
nCou¡
 - 1;

424 i‡(
nCur
 < 0)

425 
nCur
 = 0;

427 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_SETCURSEL
, 
nCur
, 0L);

428 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
, 
hWnd
, 
CBN_SELCHANGE
));

429 i‡(
nCur
 !
nPªvCur
)

430  
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
, 
hWnd
, 
CBN_SELENDOK
));

431 
	`InvÆid©eRe˘
(
hWnd
, 
NULL
, 1);

436 
WM_CHAR
:

438 
nNewCur
;

439 
nOldCur
;

441 i‡(
Õ
->
EdôC⁄åﬁ
)

443 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
uMsg
, 
wP¨am
, 
lP¨am
);

446 
nOldCur
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
,0, 0L);

447 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
uMsg
, 
wP¨am
, 
lP¨am
);

448 
nNewCur
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0L);

449 i‡(
nNewCur
 !
nOldCur
)

451 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
, 
hWnd
, 
CBN_SELCHANGE
));

452 
	`InvÆid©eRe˘
(
hWnd
, 
NULL
, 1);

459 
WM_SETREDRAW
:

460 
Õ
->
bRedøw
 = 
wP¨am
;

461 i‡(
Õ
->
EdôC⁄åﬁ
)

462 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_SETREDRAW
, 
wP¨am
, 
lP¨am
);

463 i‡(
Õ
->
Li°BoxC⁄åﬁ
)

464 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
WM_SETREDRAW
, 
wP¨am
, 
lP¨am
);

467 
WM_CREATE
:

468 
Õ
 = (
COMBOBOX
 *)
	`WöMÆloc
((COMBOBOX));

469 
	`mem£t
((
LPSTR
)
Õ
,'\0',(
COMBOBOX
));

472 
hWnd
->
u£rd©a
=(
DWORD
)
Õ
;

475 
hIn°
 = 
NULL
;

478 
Õcs
 = (
LPCREATESTRUCT
)
lP¨am
;

479 
Õ
->
bRedøw
 = 1;

480 
Õ
->
wSèãFœgs
 = 0;

481 
Õ
->
wStyÀ
 = (
UINT
)
	`LOWORD
(
Õcs
->
°yÀ
);

482 i‡(!
	`BOWNERDRAW
(
Õ
))

483 
Õ
->
wStyÀ
 |
CBS_HASSTRINGS
;

484 
Õ
->
bExãnded
 = 
TRUE
;

485 
Õ
->
hF⁄t
 = 0;

486 
Õ
->
hWndP¨ít
 = 
Õcs
->
hwndP¨ít
;

487 
Õ
->
nID
 = (
UINT
)
Õcs
->
hMíu
;

493 
mis
.
CéTy≥
 = 
ODT_COMBOBOX
;

494 
mis
.
CéID
 = (
UINT
)
Õcs
->
hMíu
;

495 
mis
.
ôemID
 = (
UINT
)-1;

496 
mis
.
ôemD©a
 = 0L;

497 
	`SídMesßge
(
Õcs
->
hwndP¨ít
, 
WM_MEASUREITEM
, (
WPARAM
Ópcs->
hMíu
, (
LPARAM
)&
mis
);

503 
hDC
 = 
	`GëDC
((
HWND
)0);

504 
	`GëTextMërics
(
hDC
,&
tm
);

505 
	`Rñó£DC
((
HWND
)0,
hDC
);

510 
wEdôHeight
 = 
tm
.
tmHeight
 +Åm.
tmI¡î«lLódög
 * 3;

512 
Õ
->
uHeight
 = (
UINT
)
wEdôHeight
;

514 i‡((
Õ
->
wStyÀ
 & 0x0FË!
CBS_SIMPLE
)

516 
Õ
->
Buâ⁄Re˘
.
t›
 = 0;

517 
Õ
->
Buâ⁄Re˘
.
À·
 = 
Õcs
->
cx
 - 1 - 
	`GëSy°emMërics
(
SM_CXVSCROLL
);

518 
Õ
->
Buâ⁄Re˘
.
right
 = 
Õcs
->
cx
;

519 
Õ
->
Buâ⁄Re˘
.
bŸtom
 = 
wEdôHeight
;

521 
	`SëWödowPos
(
hWnd
, 0,

522 0, 0, 
Õcs
->
cx
, ()
wEdôHeight
,

523 
SWP_NOACTIVATE
 | 
SWP_NOMOVE
 | 
SWP_NOZORDER
 | 
SWP_NOREDRAW
);

525 
	`SëRe˘Em±y
(&
Õ
->
Buâ⁄Re˘
);

527 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_DROPDOWNLIST
)

529 
dwStyÀ
 = 
WS_CHILD
 | 
WS_VISIBLE
 | 
WS_BORDER
;

530 i‡(
Õ
->
wStyÀ
 & 
CBS_AUTOHSCROLL
)

531 
dwStyÀ
 |
ES_AUTOHSCROLL
;

532 i‡(
Õ
->
wStyÀ
 & 
CBS_OEMCONVERT
)

533 
dwStyÀ
 |
ES_OEMCONVERT
;

535 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_SIMPLE
)

537 
	`Ârötf
(
°dîr
," 528: wEdôWidth =Üpcs->cx=%d\n",
Õcs
->
cx
);

538 
wEdôWidth
 = 
Õcs
->
cx
;

542 
	`Ârötf
(
°dîr
," 533: wEdôWidth =Üp->Buâ⁄Re˘.À· - 5=%d;\n",
Õ
->
Buâ⁄Re˘
.
À·
 - 5);

543 
wEdôWidth
 = 
Õ
->
Buâ⁄Re˘
.
À·
 - 5;

546 
Õ
->
EdôC⁄åﬁ
 = 
	`Cª©eWödow
("EDIT", 
NULL
, 
dwStyÀ
,

547 0, 0, 
wEdôWidth
, 
wEdôHeight
,

548 
hWnd
, (
HMENU
)
CBC_EDITID
,

549 
hIn°
,(
LPVOID
)
NULL
);

552 
Õ
->
EdôC⁄åﬁ
 = 0;

556 
dwExStyÀ
 = 0L;

557 
dwStyÀ
 = 
WS_BORDER
 | 
LBS_NOTIFY
 ;

558 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

559 
dwStyÀ
 |
WS_VISIBLE
 | 
WS_CHILD
;

561 
dwStyÀ
 |
WS_POPUP
;

563 i‡(
Õ
->
wStyÀ
 & 
CBS_DISABLENOSCROLL
)

564 
dwStyÀ
 |
LBS_DISABLENOSCROLL
;

566 i‡(
Õ
->
wStyÀ
 & 
CBS_HASSTRINGS
)

567 
dwStyÀ
 |
LBS_HASSTRINGS
;

568 i‡(
Õ
->
wStyÀ
 & 
CBS_NOINTEGRALHEIGHT
)

569 
dwStyÀ
 |
LBS_NOINTEGRALHEIGHT
;

570 i‡(
Õ
->
wStyÀ
 & 
CBS_OWNERDRAWFIXED
)

571 
dwStyÀ
 |
LBS_OWNERDRAWFIXED
;

572 i‡(
Õ
->
wStyÀ
 & 
CBS_OWNERDRAWVARIABLE
)

573 
dwStyÀ
 |
LBS_OWNERDRAWVARIABLE
;

574 i‡(
Õ
->
wStyÀ
 & 
CBS_SORT
)

575 
dwStyÀ
 |
LBS_SORT
;

576 i‡(
Õcs
->
°yÀ
 & 
WS_VSCROLL
)

577 
dwStyÀ
 |
WS_VSCROLL
;

580 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
) {

581 
Õ
->
Li°BoxRe˘
.
À·
 = 5;

582 
Õ
->
Li°BoxRe˘
.
t›
 = 
wEdôHeight
 - 1;

583 
Õ
->
Li°BoxRe˘
.
right
 = 
Õcs
->
cx
;

584 
Õ
->
Li°BoxRe˘
.
bŸtom
 = 
Õcs
->
cy
 - 2;

586 
Õ
->
Li°BoxRe˘
.
À·
 = 
Õcs
->
x
;

587 
Õ
->
Li°BoxRe˘
.
right
 =Üp->Li°BoxRe˘.
À·
 + 
Õcs
->
cx
 - 1;

588 
Õ
->
Li°BoxRe˘
.
t›
 = 
Õcs
->
y
 + 
wEdôHeight
 - 1;

589 
Õ
->
Li°BoxRe˘
.
bŸtom
 =Üp->Li°BoxRe˘.
t›
 + 
Õcs
->
cy
 + 1;

590 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_DROPDOWN
) {

591 
Õ
->
Li°BoxRe˘
.
À·
 += 5;

594 #ifde‡
LATER


595 
˝
.
x
 = ((
Õ
->
wStyÀ
 & 0xfË=
CBS_DROPDOWNLIST
)?0:5;

596 
˝
.
y
 = 
wEdôHeight
 - 1;

597 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

598 
	`Clõ¡ToS¸ìn
(
hWnd
,&
˝
);

599 
Õ
->
Li°BoxRe˘
.
À·
 = 
˝
.
x
;

600 
Õ
->
Li°BoxRe˘
.
t›
 = 
˝
.
y
;

601 
Õ
->
Li°BoxRe˘
.
right
 = 
˝
.
x
 + 
Õcs
->
cx
;

602 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_DROPDOWNLIST
)

603 
Õ
->
Li°BoxRe˘
.
right
 -= 5;

604 
Õ
->
Li°BoxRe˘
.
bŸtom
 =Üp->Li°BoxRe˘.
t›
 + 
Õcs
->
cy
 -

605 
wEdôHeight
 + 1;

608 
Õ
->
Li°BoxC⁄åﬁ
 = 
	`Cª©eWödowEx
(
dwExStyÀ
,"LISTBOX",

609 
NULL
, 
dwStyÀ
,

610 
Õ
->
Li°BoxRe˘
.
À·
,Üp->Li°BoxRe˘.
t›
,

611 
Õ
->
Li°BoxRe˘
.
right
 -Üp->Li°BoxRe˘.
À·
,

612 
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
,

613 
hWnd
, 0,

614 
hIn°
,(
LPVOID
)
NULL
);

615 #i‡
MWCLIENT


617 
	`GrLowîWödow
(
Õ
->
Li°BoxC⁄åﬁ
->
wid
);

619 
	`MwLowîWödow
(
Õ
->
Li°BoxC⁄åﬁ
);

621 #ifde‡ 
LATER


624 i‡(
dwStyÀ
 & 
WS_POPUP
)

626 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 
HWND_TOP
,

628 
SWP_NOREDRAW
 | 
SWP_NOACTIVATE
 | 
SWP_NOSIZE
 | 
SWP_NOMOVE
);

636 i‡(
Õcs
->
°yÀ
 & 
WS_VSCROLL
)

638 
HWND32
 
hWnd32
 = 
	`GETHWND32
(
hWnd
);

640 
	`SëRe˘Em±y
(&
hWnd32
->
rcNC
);

642 
hWnd32
->
wWidth
 = (
WORD
ËhWnd32->
rWnd
.
right
-hWnd32->rWnd.
À·
;

643 
hWnd32
->
wHeight
 = (
WORD
)hWnd32->
rWnd
.
bŸtom
-hWnd32->rWnd.
t›
;

644 
	`RELEASEWININFO
(
hWnd32
);

651 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hWnd
, 
GWL_STYLE
);

652 
dwStyÀ
 &~(
WS_VSCROLL
 | 
WS_HSCROLL
 | 
WS_BORDER
 | 
WS_DLGFRAME
 | 
WS_THICKFRAME
);

653 
	`SëWödowL⁄g
(
hWnd
, 
GWL_STYLE
, 
dwStyÀ
);

654 
Õ
->
nLi°Iãms
 = 0;

655  
TRUE
;

657 
WM_DESTROY
:

658 i‡(
	`IsWödow
(
Õ
->
Li°BoxC⁄åﬁ
))

659 
	`De°royWödow
(
Õ
->
Li°BoxC⁄åﬁ
);

660 i‡(
	`IsWödow
(
Õ
->
EdôC⁄åﬁ
))

661 
	`De°royWödow
(
Õ
->
EdôC⁄åﬁ
);

662 
	`WöFªe
((
LPSTR
)
Õ
);

665 
WM_GETDLGCODE
:

666  (
LRESULT
)(
DLGC_WANTCHARS
|
DLGC_WANTARROWS
);

669 
WM_NCLBUTTONDOWN
:

671 
WM_LBUTTONDOWN
:

673 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

676 
˝
.
x
 = ()()
	`LOWORD
(
lP¨am
);

677 
˝
.
y
 = ()()
	`HIWORD
(
lP¨am
);

679 
	`S¸ìnToClõ¡
(
hWnd
, &
˝
);

681 i‡(!
	`IS_SET
(
Õ
, 
CSF_CAPTUREACTIVE
))

684 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
, 
˝
) ||

685 (
Õ
->
wStyÀ
 & 0x0FË=
CBS_DROPDOWNLIST
)

687 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
, 
˝
))

688 
	`CBoxDøwBuâ⁄
(
hWnd
, 1, 
Õ
);

690 
˝
.
x
 = ((
Õ
->
wStyÀ
 & 0xfË!
CBS_DROPDOWNLIST
) ? 5 : 0;

691 
˝
.
y
 = 
Õ
->
uHeight
 - 1;

693 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

695 
	`Ârötf
(
°dîr
," (1)lp->ListBoxRect:(%d,%d,%d,%d)\n",

696 
Õ
->
Li°BoxRe˘
.
À·
,

697 
Õ
->
Li°BoxRe˘
.
t›
,

698 
Õ
->
Li°BoxRe˘
.
right
,

699 
Õ
->
Li°BoxRe˘
.
bŸtom
);

701 
	`Off£tRe˘
(&
Õ
->
Li°BoxRe˘
, 
˝
.
x
 -Üp->Li°BoxRe˘.
À·
, cp.
y
 -Üp->Li°BoxRe˘.
t›
);

703 
	`Ârötf
(
°dîr
," (2)lp->ListBoxRect:(%d,%d,%d,%d)\n",

704 
Õ
->
Li°BoxRe˘
.
À·
,

705 
Õ
->
Li°BoxRe˘
.
t›
,

706 
Õ
->
Li°BoxRe˘
.
right
,

707 
Õ
->
Li°BoxRe˘
.
bŸtom
);

709 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 
HWND_TOP
,

710 
˝
.
x
, cp.
y
, 0, 0,

711 
SWP_NOSIZE
 | 
SWP_NOACTIVATE
);

713 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_DROPDOWN
));

720 
nôems
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETCOUNT
,0,0L);

723 i‡(
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
 <

724 ((
Õ
->
uHeight
-2Ë* 
nôems
))

727 
nôems
 = (nitems > 12 ? 12 :Çitems);

730 
Õ
->
Li°BoxRe˘
.
bŸtom
 =

731 
Õ
->
Li°BoxRe˘
.
t›
 + (÷p->
uHeight
-2Ë* 
nôems
);

733 
	`Ârötf
(
°dîr
," (2.5)lp->ListBoxRect:(%d,%d,%d,%d)\n",

734 
Õ
->
Li°BoxRe˘
.
À·
,

735 
Õ
->
Li°BoxRe˘
.
t›
,

736 
Õ
->
Li°BoxRe˘
.
right
,

737 
Õ
->
Li°BoxRe˘
.
bŸtom
);

740 
	`Ârötf
(
°dîr
," 706: fixed: SëWödowPos÷p->Li°BoxC⁄åﬁ,,%d,%d,...)\n",
˝
.
x
,˝.
y
);

742 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
,
HWND_TOP
,0,0,

743 
Õ
->
Li°BoxRe˘
.
right
 -Üp->Li°BoxRe˘.
À·
,

744 
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
,

745 
SWP_NOMOVE
 | 
SWP_NOACTIVATE
 | 
SWP_NOZORDER
);

747 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
,
HWND_TOP
,
˝
.
x
,˝.
y
,

748 
Õ
->
Li°BoxRe˘
.
right
 -Üp->Li°BoxRe˘.
À·
,

749 
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
,

750 
SWP_NOMOVE
 | 
SWP_NOACTIVATE
 | 
SWP_NOZORDER
);

756 
	`SET_STATE
(
Õ
, 
CSF_HASDROPPED
);

759 
	`ShowWödow
(
Õ
->
Li°BoxC⁄åﬁ
, 
SW_SHOW
);

761 
	`SëFocus
(
Õ
->
Li°BoxC⁄åﬁ
);

763 
	`SëF‹egroundWödow
(
Õ
->
Li°BoxC⁄åﬁ
);

765 
	`CBoxC≠tuª
(
hWnd
, 1);

766 
	`SET_STATE
(
Õ
, 
CSF_CAPTUREACTIVE
);

767 
	`SET_STATE
(
Õ
, 
CSF_BUTTONDOWN
);

772 
HWND
 
hwndNewFocus
 = 0;

774 
˝S¸ìn
 = 
˝
;

776 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

778 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝S¸ìn
);

779 
hwndNewFocus
 = 
	`WödowFromPoöt
(
˝S¸ìn
);

782 
	`Ârötf
(
°dîr
," (3)lp->ListBoxRect:(%d,%d,%d,%d)\n",

783 
Õ
->
Li°BoxRe˘
.
À·
,

784 
Õ
->
Li°BoxRe˘
.
t›
,

785 
Õ
->
Li°BoxRe˘
.
right
,

786 
Õ
->
Li°BoxRe˘
.
bŸtom
);

788 i‡(
	`PtInRe˘
(&
Õ
->
Li°BoxRe˘
, 
˝S¸ìn
))

790 
	`CBoxSídMou£ToLBox
(
Õ
, 
WM_LBUTTONDOWN
, 
wP¨am
, 
˝S¸ìn
);

794 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
, 
˝
))

795 
	`CBoxDøwBuâ⁄
(
hWnd
, 0, 
Õ
);

796 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_DROPDOWN
 && 
hwndNewFocus
 =Õ->
EdôC⁄åﬁ
)

799 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_CLOSEUP
));

801 
	`Ârötf
(
°dîr
," 802: (hide) SetWindowPos(lp->ListBoxControl, , 0, 0, 0, 0,..)\n");

803 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 0,

805 
SWP_NOMOVE
 | 
SWP_NOSIZE
 | 
SWP_NOACTIVATE
 | 
SWP_NOZORDER
 | 
SWP_HIDEWINDOW
);

806 #i‡
MWCLIENT


807 
	`MwLowîWödow
(
Õ
->
Li°BoxC⁄åﬁ
);

809 
	`CBoxC≠tuª
(
hWnd
, 0);

810 
	`CLEAR_STATE
(
Õ
, 
CSF_BUTTONDOWN
);

812 
	`CLEAR_STATE
(
Õ
, 
CSF_CAPTUREACTIVE
);

814 i‡(
hwndNewFocus
 && hwndNewFocu†!
hWnd
)

816 
	`S¸ìnToClõ¡
(
hwndNewFocus
, &
˝S¸ìn
);

817 
	`SëFocus
(
hwndNewFocus
);

819 
	`SídMesßge
(
hwndNewFocus
, 
WM_LBUTTONDOWN
, 
wP¨am
, 
	`MAKELONG
(
˝S¸ìn
.
x
, cpS¸ìn.
y
));

826 
WM_NCMOUSEMOVE
:

828 
WM_MOUSEMOVE
:

830 i‡(!
	`IS_SET
(
Õ
,
CSF_BUTTONDOWN
Ë&& (÷p->
wStyÀ
 & 0xfË=
CBS_SIMPLE
))

833 
˝
.
x
 = ()()
	`LOWORD
(
lP¨am
);

834 
˝
.
y
 = ()()
	`HIWORD
(
lP¨am
);

836 
	`S¸ìnToClõ¡
(
hWnd
, &
˝
);

839 i‡(
	`IS_SET
(
Õ
, 
CSF_CAPTUREACTIVE
))

841 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
,
˝
))

843 i‡(!
	`IS_SET
(
Õ
, 
CSF_LOCALBUTTONDOWN
))

844 
	`CBoxDøwBuâ⁄
(
hWnd
, 1, 
Õ
);

847 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

848 
	`Clõ¡ToS¸ìn
(
hWnd
,&
˝
);

849 i‡(
	`PtInRe˘
(&
Õ
->
Li°BoxRe˘
,
˝
))

851 
	`CBoxSídMou£ToLBox
(
Õ
,
WM_MOUSEMOVE
,
wP¨am
,
˝
);

853 i‡(
	`IS_SET
(
Õ
,
CSF_LOCALBUTTONDOWN
Ë&& (÷p->
wStyÀ
 & 0xfË!
CBS_SIMPLE
))

854 
	`CBoxDøwBuâ⁄
(
hWnd
,0,
Õ
);

859 
WM_NCLBUTTONUP
:

861 
WM_LBUTTONUP
:

863 i‡(!
	`IS_SET
(
Õ
, 
CSF_CAPTUREACTIVE
))

866 
˝
.
x
 = ()()
	`LOWORD
(
lP¨am
);

867 
˝
.
y
 = ()()
	`HIWORD
(
lP¨am
);

869 
	`S¸ìnToClõ¡
(
hWnd
, &
˝
);

872 
	`CLEAR_STATE
(
Õ
,
CSF_BUTTONDOWN
);

874 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
, 
˝
))

877 i‡(
	`PtInRe˘
(&
Õ
->
Buâ⁄Re˘
, 
˝
))

878 
	`CBoxDøwBuâ⁄
(
hWnd
, 0, 
Õ
);

879 i‡(
	`IS_SET
(
Õ
, 
CSF_LBOXBUTTONDOWN
))

881 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

882 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

883 
	`CBoxSídMou£ToLBox
(
Õ
, 
WM_LBUTTONUP
, 
wP¨am
, 
˝
);

884 
	`CLEAR_STATE
(
Õ
,
CSF_LBOXBUTTONDOWN
);

888 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

889 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

891 i‡(
	`PtInRe˘
(&
Õ
->
Li°BoxRe˘
, 
˝
))

893 
uiKey
 = (
UINT
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0);

894 i‡(
uiKey
 !(
UINT
)
LB_ERR
)

896 i‡(
Õ
->
EdôC⁄åﬁ
)

898 
	`SëFocus
(
Õ
->
EdôC⁄åﬁ
);

900 
	`CBoxDøwEdô
(
Õ
, 
hWnd
, 
uiKey
);

903 
	`SëFocus
(
hWnd
);

905 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
uiKey
);

909  
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_SELENDOK
));

910 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_CLOSEUP
));

912 
	`Ârötf
(
°dîr
," 844: (hide) SetWindowPos(lp->ListBoxControl, , 0, 0, 0, 0,..)\n");

914 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 0,

916 
SWP_NOMOVE
 | 
SWP_NOSIZE
 | 
SWP_NOACTIVATE
 | 
SWP_NOZORDER
 | 
SWP_HIDEWINDOW
);

918 
	`CBoxC≠tuª
(
hWnd
, 0);

919 
	`CLEAR_STATE
(
Õ
,
CSF_CAPTUREACTIVE
);

922 
	`CBoxSídMou£ToLBox
(
Õ
, 
WM_LBUTTONUP
, 
wP¨am
, 
˝
);

923 
	`CLEAR_STATE
(
Õ
,
CSF_LBOXBUTTONDOWN
);

924 #i‡
MWCLIENT


926 
	`GrLowîWödow
(
Õ
->
Li°BoxC⁄åﬁ
->
wid
);

928 
	`MwLowîWödow
(
Õ
->
Li°BoxC⁄åﬁ
);

934 i‡(
	`IS_SET
(
Õ
, 
CSF_LBOXBUTTONDOWN
))

936 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

937 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

938 
	`CBoxSídMou£ToLBox
(
Õ
, 
WM_LBUTTONUP
, 
wP¨am
, 
˝
);

939 
	`CLEAR_STATE
(
Õ
,
CSF_LBOXBUTTONDOWN
);

943 
WM_ERASEBKGND
:

946 
WM_PAINT
:

947 
	`BegöPaöt
(
hWnd
,&
ps
);

948 
	`EndPaöt
(
hWnd
,&
ps
);

950 i‡(!
	`IsWödowVisibÀ
(
hWnd
Ë|| !
Õ
->
bRedøw
)

953 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

954 
	`CBoxDøwBuâ⁄
(
hWnd
, 
	`IS_SET
(
Õ
,
CSF_LOCALBUTTONDOWN
),Üp);

955 
uiKey
 = (
UINT
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0);

956 i‡(
Õ
->
EdôC⁄åﬁ
)

957 
	`CBoxDøwEdô
(
Õ
, 
hWnd
, 
uiKey
);

958 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
uiKey
);

961 
WM_COMMAND
:

962 i‡(
	`GET_WM_COMMAND_ID
(
wP¨am
,
lP¨am
Ë=
CBC_EDITID
) {

964 ()
	`GET_WM_COMMAND_CMD
(
wP¨am
,
lP¨am
)) {

965 
EN_SETFOCUS
:

966 #ifde‡ 
LATER


967 
wCBN
 = 
CBN_SETFOCUS
;

969 
wCBN
 = 0;

972 
EN_KILLFOCUS
:

973 
wCBN
 = 
CBN_KILLFOCUS
;

975 
EN_CHANGE
:

977 
ödex
 = 0;

978 
sz
[128];

984 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_GETTEXT
, (
sz
)-1, (
LPARAM
)sz);

985 i‡–
	`°æí
(
sz
) > 0 )

986 
ödex
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_FINDSTRING
, -1, (
LPARAM
)
sz
);

987 i‡(
ödex
 =
LB_ERR
)

988 
ödex
 = 0;

989 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_SETTOPINDEX
, 
ödex
, 0L);

990 
wCBN
 = 
CBN_EDITCHANGE
;

993 
EN_UPDATE
:

994 
wCBN
 = 
CBN_EDITUPDATE
;

996 
EN_ERRSPACE
:

997 
wCBN
 = 
CBN_ERRSPACE
;

1000 
wCBN
 = 0;

1003 i‡(
wCBN
)

1004  
	`SídMesßge
(
Õ
->
hWndP¨ít
,
WM_COMMAND
,

1005 
	`GET_WM_COMMAND_MPS
(
Õ
->
nID
,
hWnd
,
wCBN
));

1007  
rc
;

1009 i‡(
	`GET_WM_COMMAND_ID
(
wP¨am
,
lP¨am
) == 0) {

1011 ()
	`GET_WM_COMMAND_CMD
(
wP¨am
,
lP¨am
)) {

1012 
LBN_ERRSPACE
:

1013 
wCBN
 = 
CBN_ERRSPACE
;

1015 
LBN_SELCHANGE
:

1016 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

1018 
uiKey
 = (
UINT
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0);

1019 i‡(
uiKey
 !(
UINT
)
LB_ERR
)

1020 i‡(
Õ
->
EdôC⁄åﬁ
)

1022 
	`CBoxDøwEdô
(
Õ
, 
hWnd
, 
uiKey
);

1025 
wCBN
 = 
CBN_SELCHANGE
;

1027 
LBN_DBLCLK
:

1028 
wCBN
 = 
CBN_DBLCLK
;

1030 
LBN_SELCANCEL
:

1031 
wCBN
 = 0;

1033 
LBN_SETFOCUS
:

1034 
wCBN
 = 
CBN_SETFOCUS
;

1036 
LBN_KILLFOCUS
:

1037 
wCBN
 = 
CBN_KILLFOCUS
;

1040 
wCBN
 = 0;

1043 i‡(
wCBN
)

1044  
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
wCBN
));

1046  
rc
;

1050 
WM_GETTEXT
:

1051 i‡–
Õ
->
EdôC⁄åﬁ
 )

1052  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
uMsg
,
wP¨am
,
lP¨am
);

1053 i‡–
Õ
->
Li°BoxC⁄åﬁ
 ) {

1054 
WPARAM
 
£l
, 
Àn
;

1056 
£l
 = (
WPARAM
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0);

1057 i‡–
£l
 !(
WPARAM
)
LB_ERR
 ) {

1058 
Àn
 = (
WPARAM
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, 0, 0);

1059 i‡–
Àn
 <
wP¨am
 )

1060  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXT
, 
£l
, 
lP¨am
);

1063  
CB_ERR
;

1065 
WM_GETTEXTLENGTH
:

1066 i‡–
Õ
->
EdôC⁄åﬁ
 )

1067  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
uMsg
,
wP¨am
,
lP¨am
);

1068 i‡–
Õ
->
Li°BoxC⁄åﬁ
 ) {

1069 
WPARAM
 
£l
;

1071 
£l
 = (
WPARAM
)
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETCURSEL
, 0, 0);

1072 i‡–
£l
 !(
WPARAM
)
LB_ERR
 )

1073  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, 
£l
, 0);

1075  
CB_ERR
;

1077 
WM_SETTEXT
:

1078 i‡–
Õ
->
EdôC⁄åﬁ
 )

1079  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
uMsg
,
wP¨am
,
lP¨am
);

1080  
CB_ERR
;

1083 
WM_SETFONT
:

1084 
Õ
->
hF⁄t
 = (
HFONT
)
wP¨am
;

1086 
hDC
 = 
	`GëDC
(
hWnd
);

1087 
	`Sñe˘Obje˘
(
hDC
,
Õ
->
hF⁄t
);

1088 
	`GëTextMërics
(
hDC
,&
tm
);

1089 
	`Rñó£DC
(
hWnd
,
hDC
);

1090 
wEdôHeight
 = 
tm
.
tmHeight
 + 3 *Åm.
tmI¡î«lLódög
;

1092 i‡(
wEdôHeight
 =
Õ
->
uHeight
)

1095 
Õ
->
uHeight
 = (
UINT
)
wEdôHeight
;

1096 
Õ
->
Buâ⁄Re˘
.
bŸtom
 = 
wEdôHeight
;

1101 
	`ShowWödow
(
hWnd
, 
SW_HIDE
);

1102 
	`GëClõ¡Re˘
(
hWnd
,&
rcClõ¡
);

1103 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

1104 
	`SëWödowPos
(
hWnd
, 0,

1105 0, 0, 
rcClõ¡
.
right
, ()
wEdôHeight
,

1106 
SWP_NOACTIVATE
 | 
SWP_NOMOVE
 | 
SWP_NOZORDER
 | 
SWP_NOREDRAW
);

1107 
	`SëWödowPos
(
hWnd
, 0,

1108 0, 0, 
rcClõ¡
.
right
, ()
wEdôHeight
 + 
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
 + 1,

1109 
SWP_NOACTIVATE
 | 
SWP_NOMOVE
 | 
SWP_NOZORDER
 | 
SWP_NOREDRAW
);

1110 
	`ShowWödow
(
hWnd
, 
SW_SHOWNA
);

1112 i‡(
Õ
->
EdôC⁄åﬁ
)

1113 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_SETFONT
, 
wP¨am
,
lP¨am
);

1114 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
WM_SETFONT
, 
wP¨am
,
lP¨am
);

1116 if(
	`LOWORD
(
lP¨am
))

1117 
	`RedøwWödow
(
hWnd
,(c⁄° 
RECT
 *)0,(
HRGN
)0,

1118 
RDW_INVALIDATE
 | 
RDW_ERASE
 | 
RDW_UPDATENOW
 );

1119  (
LRESULT
)0;

1121 
WM_GETFONT
:

1122  
Õ
->
hF⁄t
;

1125 
WM_MOVE
:

1127 
Õwp
 = (
LPWINDOWPOS
)
lP¨am
;

1129 
µ
.
x
=
	`LOWORD
(
lP¨am
);

1130 
µ
.
y
=
	`HIWORD
(
lP¨am
);

1134 
Õ
->
Buâ⁄Re˘
.
right
 = (
hWnd
->
wöª˘
.right-hWnd->wöª˘.
À·
);

1135 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

1136 
Õ
->
Buâ⁄Re˘
.
À·
 =Üp->Buâ⁄Re˘.
right
;

1137 
Õ
->
Buâ⁄Re˘
.
À·
 = (
hWnd
->
wöª˘
.
right
-hWnd->winrect.left) - 1 -

1138 
	`GëSy°emMërics
(
SM_CXVSCROLL
);

1140 i‡(
Õ
->
EdôC⁄åﬁ
)

1142 
wEdôWidth
 = 
Õ
->
Buâ⁄Re˘
.
À·
 + 1;

1143 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

1144 
wEdôWidth
 --;

1145 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_DROPDOWN
)

1146 
wEdôWidth
 -= 5;

1147 
	`SëWödowPos
(
Õ
->
EdôC⁄åﬁ
,(
HWND
)0,

1149 
wEdôWidth
, 
Õ
->
uHeight
,

1150 
SWP_NOACTIVATE
|
SWP_NOMOVE
|
SWP_NOZORDER
);

1152 i‡(
Õ
->
Li°BoxC⁄åﬁ
)

1154 i‡((
Õ
->
wStyÀ
 & 0x0FË=
CBS_SIMPLE
)

1156 
Õ
->
Li°BoxRe˘
.
À·
 = 5;

1157 
Õ
->
Li°BoxRe˘
.
t›
 =Üp->
uHeight
 - 1;

1158 
Õ
->
Li°BoxRe˘
.
right
 = (
hWnd
->
wöª˘
.right-hWnd->wöª˘.
À·
);

1159 
Õ
->
Li°BoxRe˘
.
bŸtom
 = (
hWnd
->
wöª˘
.bŸtom-hWnd->wöª˘.
t›
) - 2;

1162 
POINT
 
˝
;

1163 
˝
.
x
 = 0;

1164 
˝
.
y
 = 
Õ
->
uHeight
 - 1;

1165 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

1166 
	`Off£tRe˘
(&
Õ
->
Li°BoxRe˘
, 
˝
.
x
 -Üp->Li°BoxRe˘.
À·
, cp.
y
 -Üp->Li°BoxRe˘.
t›
);

1168 
Õ
->
Li°BoxRe˘
.
right
 =Üp->Li°BoxRe˘.
À·
 + (
hWnd
->
wöª˘
.right-hWnd->winrect.left) ;

1169 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_DROPDOWNLIST
)

1170 
Õ
->
Li°BoxRe˘
.
right
 -= 5;

1173 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
,(
HWND
)0,

1174 
Õ
->
Li°BoxRe˘
.
À·
,Üp->Li°BoxRe˘.
t›
,

1175 
Õ
->
Li°BoxRe˘
.
right
 -Üp->Li°BoxRe˘.
À·
,

1176 
Õ
->
Li°BoxRe˘
.
bŸtom
 -Üp->Li°BoxRe˘.
t›
,

1177 
SWP_NOACTIVATE
|
SWP_NOZORDER
);

1181 i‡((
Õ
->
wStyÀ
 & 0xfË!
CBS_SIMPLE
)

1182 
Õwp
->
cy
 = ()
Õ
->
uHeight
;

1186  (
LRESULT
)0;

1188 
WM_WINDOWPOSCHANGED
:

1189 
	`DefWödowProc
(
hWnd
,
uMsg
,
wP¨am
,
lP¨am
);

1190 
Õwp
 = (
LPWINDOWPOS
)
lP¨am
;

1191 i‡(
Õwp
) {

1192 i‡(!(
Õwp
->
Êags
 & 
SWP_NOSIZE
))

1194 
	`RedøwWödow
(
hWnd
,(c⁄° 
RECT
 *)0,(
HRGN
)0,

1195 
RDW_INVALIDATE
|
RDW_ERASE
);

1197 
	`InvÆid©eRe˘
(
hWnd
,
NULL
,
TRUE
);

1200  (
LRESULT
)0;

1206 
WM_DRAWITEM
:

1207 
Õdis
 = (
LPDRAWITEMSTRUCT
)
lP¨am
;

1208 
Õdis
->
CéTy≥
 = 
ODT_COMBOBOX
;

1209 
Õdis
->
CéID
 = 
Õ
->
nID
;

1210 
Õdis
->
hwndIãm
 = 
hWnd
;

1211  
	`SídMesßge
(
Õ
->
hWndP¨ít
,
WM_DRAWITEM
,

1212 (
WPARAM
)
Õ
->
nID
,
lP¨am
);

1214 
WM_MEASUREITEM
:

1215 
Õmis
 = (
LPMEASUREITEMSTRUCT
)
lP¨am
;

1216 
Õmis
->
CéTy≥
 = 
ODT_COMBOBOX
;

1217 
Õmis
->
CéID
 = 
Õ
->
nID
;

1218  
	`SídMesßge
(
Õ
->
hWndP¨ít
,
WM_MEASUREITEM
,

1219 (
WPARAM
)
Õ
->
nID
,
lP¨am
);

1221 
WM_DELETEITEM
:

1222 
Õdlis
 = (
LPDELETEITEMSTRUCT
)
lP¨am
;

1223 
Õdlis
->
CéTy≥
 = 
ODT_COMBOBOX
;

1224 
Õdlis
->
CéID
 = 
Õ
->
nID
;

1225 
Õdlis
->
hwndIãm
 = 
hWnd
;

1226  
	`SídMesßge
(
Õ
->
hWndP¨ít
,
WM_DELETEITEM
,

1227 (
WPARAM
)
Õ
->
nID
,
lP¨am
);

1229 
WM_CONVERT
:

1230 i‡(!
ÕComboBöToN©
) {

1231 
hComboCœss32
 = 
	`FödCœss
("COMBOBOX",0);

1232 
ÕComboBöToN©
 = (
WNDPROC
)
	`GëCœssH™dÀL⁄g
(

1233 
hComboCœss32
,
GCL_BINTONAT
);

1235 i‡(
ÕComboBöToN©
)

1236  
	`ÕComboBöToN©
(
hWnd
, 
uMsg
, 
wP¨am
, 
lP¨am
);

1238  (
LRESULT
)0;

1242  
	`DefCBProc
–
hWnd
, 
uMsg
, 
wP¨am
, 
lP¨am
);

1244  
rc
;

1245 
	}
}

1250 
LRESULT
 
	$DefCBProc
(
HWND
 
hWnd
, 
UINT
 
uMsg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1252 
Àn
,
ödex
;

1253 
COMBOBOX
 *
Õ
;

1254 *
£À˘i⁄
;

1255 
rc
;

1256 
POINT
 
˝
;

1258 
Õ
 = (
COMBOBOX
 *Ë
hWnd
->
u£rd©a
 ;

1259 
uMsg
) {

1263 
CB_ADDSTRING
:

1264 
Õ
->
nLi°Iãms
++;

1265  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_ADDSTRING
,

1266 
wP¨am
,
lP¨am
);

1268 
CB_DELETESTRING
:

1269 i‡(
Õ
->
nLi°Iãms
)

1270 
Õ
->
nLi°Iãms
--;

1271  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_DELETESTRING
,

1272 
wP¨am
,
lP¨am
);

1274 
CB_DIR
:

1275  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_DIR
,

1276 
wP¨am
,
lP¨am
);

1278 
CB_FINDSTRING
:

1279  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_FINDSTRING
,

1280 
wP¨am
,
lP¨am
);

1282 
CB_FINDSTRINGEXACT
:

1283  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_FINDSTRINGEXACT
,

1284 
wP¨am
,
lP¨am
);

1286 
CB_GETCOUNT
:

1287  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETCOUNT
,

1288 
wP¨am
,
lP¨am
);

1290 
CB_GETCURSEL
:

1291  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETCURSEL
,

1292 
wP¨am
,
lP¨am
);

1294 
CB_GETITEMDATA
:

1295  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETITEMDATA
,

1296 
wP¨am
,
lP¨am
);

1298 
CB_GETITEMHEIGHT
:

1299  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETITEMHEIGHT
,

1300 
wP¨am
,
lP¨am
);

1302 
CB_GETLBTEXT
:

1303  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETTEXT
,

1304 
wP¨am
,
lP¨am
);

1306 
CB_GETLBTEXTLEN
:

1307  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_GETTEXTLEN
,

1308 
wP¨am
,
lP¨am
);

1310 
CB_INSERTSTRING
:

1311  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_INSERTSTRING
,

1312 
wP¨am
,
lP¨am
);

1314 
CB_SETITEMDATA
:

1315  
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_SETITEMDATA
,

1316 
wP¨am
,
lP¨am
);

1321 
CB_GETEDITSEL
:

1322  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
EM_GETSEL
,0,0);

1324 
CB_LIMITTEXT
:

1325  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
EM_LIMITTEXT
,

1326 
wP¨am
,
lP¨am
);

1328 
CB_SETEDITSEL
:

1329  
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
EM_SETSEL
,

1330 
wP¨am
,
lP¨am
);

1335 
CB_GETDROPPEDCONTROLRECT
:

1336 
	`C›yRe˘
((
LPRECT
)
lP¨am
,&
Õ
->
Li°BoxRe˘
);

1338 
CB_GETDROPPEDSTATE
:

1339  
	`IS_SET
(
Õ
,
CSF_CAPTUREACTIVE
);

1341 
CB_GETEXTENDEDUI
:

1342  (
LRESULT
)
Õ
->
bExãnded
;

1344 
CB_RESETCONTENT
:

1345 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
,
LB_RESETCONTENT
,0,0);

1346 i‡(
Õ
->
EdôC⁄åﬁ
)

1347 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
,
WM_SETTEXT
,0,(
LPARAM
)(
LPSTR
)"");

1350 
CB_SELECTSTRING
:

1351 
ödex
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_SELECTSTRING
, 
wP¨am
, 
lP¨am
);

1352 i‡(
ödex
 =
LB_ERR
)

1353  
CB_ERR
;

1355 
Àn
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, 
ödex
, 0);

1356 i‡(
Àn
 <= 0)

1357  
CB_ERR
;

1359 
£À˘i⁄
 = (
LPSTR
)
	`WöMÆloc
((
UINT
)
Àn
+1);

1360 
rc
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXT
, (
WPARAM
)
ödex
, (
LPARAM
)
£À˘i⁄
);

1361 i‡(
Õ
->
EdôC⁄åﬁ
)

1362 
rc
 = ()
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_SETTEXT
, 0, (
LPARAM
)
£À˘i⁄
);

1363 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
ödex
);

1364 
	`WöFªe
(
£À˘i⁄
);

1367 
CB_SETCURSEL
:

1368 
rc
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_SETCURSEL
, 
wP¨am
, 
lP¨am
);

1369 i‡(
rc
 =
LB_ERR
)

1370  
CB_ERR
;

1371 
Àn
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, 
wP¨am
, 0);

1372 i‡(
Àn
 <= 0)

1373  
CB_ERR
;

1375 
£À˘i⁄
 = (
LPSTR
)
	`WöMÆloc
((
UINT
)
Àn
+1);

1376 
rc
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXT
, 
wP¨am
, (
LPARAM
)
£À˘i⁄
);

1377 i‡(
Õ
->
EdôC⁄åﬁ
)

1378 
rc
 = ()
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_SETTEXT
, 0, (
LPARAM
)
£À˘i⁄
);

1379 
	`CBoxDøwSètic
(
Õ
, 
hWnd
, 
wP¨am
);

1380 
	`WöFªe
(
£À˘i⁄
);

1381  (
LRESULT
)
wP¨am
;

1383 
CB_SETEXTENDEDUI
:

1384 
Õ
->
bExãnded
 = (
BOOL
)
wP¨am
;

1387 
CB_SETITEMHEIGHT
:

1390 
CB_SHOWDROPDOWN
:

1391 i‡((
Õ
->
wStyÀ
 & 0xfË=
CBS_SIMPLE
)

1393 i‡(
wP¨am
)

1395 i‡(
	`IS_SET
(
Õ
,
CSF_CAPTUREACTIVE
))

1398 
˝
.
x
 = ((
Õ
->
wStyÀ
 & 0xfË!
CBS_DROPDOWNLIST
) ? 5 : 0;

1399 
˝
.
y
 = 
Õ
->
uHeight
 -1;

1401 
	`Clõ¡ToS¸ìn
(
hWnd
, &
˝
);

1402 
	`Off£tRe˘
(&
Õ
->
Li°BoxRe˘
, 
˝
.
x
 -Üp->Li°BoxRe˘.
À·
, cp.
y
 -Üp->Li°BoxRe˘.
t›
);

1404 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 0,

1405 
˝
.
x
, cp.
y
, 0, 0,

1406 
SWP_NOSIZE
 | 
SWP_NOZORDER
 | 
SWP_NOACTIVATE
);

1408 
	`SídMesßge
(
Õ
->
hWndP¨ít
,
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_DROPDOWN
));

1410 
	`Ârötf
(
°dîr
," 1330: SetWindowPos(lp->ListBoxControl, , 0, 0, 0, 0,..)\n");

1412 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 
HWND_TOP
,

1414 
SWP_NOMOVE
 | 
SWP_NOSIZE
 | 
SWP_NOACTIVATE
 | 
SWP_SHOWWINDOW
);

1416 
	`CBoxC≠tuª
(
hWnd
, 1);

1417 
	`SET_STATE
(
Õ
,
CSF_CAPTUREACTIVE
);

1421 i‡(!
	`IS_SET
(
Õ
,
CSF_CAPTUREACTIVE
))

1424 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_COMMAND
, 
	`GET_WM_COMMAND_MPS
÷p->
nID
,
hWnd
,
CBN_CLOSEUP
));

1426 
	`Ârötf
(
°dîr
," 1343: (hide) SetWindowPos(lp->ListBoxControl, , 0, 0, 0, 0,..)\n");

1428 
	`SëWödowPos
(
Õ
->
Li°BoxC⁄åﬁ
, 0,

1430 
SWP_NOMOVE
 | 
SWP_NOSIZE
 | 
SWP_NOACTIVATE
 | 
SWP_NOZORDER
 | 
SWP_HIDEWINDOW
);

1432 
	`CBoxC≠tuª
(
hWnd
, 0);

1433 
	`CLEAR_STATE
(
Õ
, 
CSF_CAPTUREACTIVE
);

1441  
	`DefWödowProc
–
hWnd
, 
uMsg
, 
wP¨am
, 
lP¨am
);

1443  
CB_OKAY
;

1444 
	}
}

1448 
	$CBoxDøwBuâ⁄
(
HWND
 
hWnd
,
UINT
 
wSèã
,
COMBOBOX
 *
Õ
)

1450 
HDC
 
hDC
;

1451 
x
,
y
;

1452 
dx
,
dy
;

1454 
cx
,
cy
;

1455 
nWidth
,
nHeight
;

1456 
BITMAP
 
bmpCombo
;

1457 
HBITMAP
 
hbmpCombo
 = 0;

1458 
HBITMAP
 
hbmpOld
 = 0;

1459 
HDC
 
hdcSrc
;

1460 
COLORREF
 
rgbText
, 
rgbBk
;

1462 
HBRUSH
 
hBrush
;

1463 
HPEN
 
hPíHigh
,
hPíShadow
;

1464 
RECT
 
rc
;

1466 
hDC
 = 
	`GëDC
(
hWnd
);

1468 
	`C›yRe˘
(&
rc
,&
Õ
->
Buâ⁄Re˘
);

1469 
x
 = 
rc
.
À·
;

1470 
y
 = 
rc
.
t›
;

1471 
dx
 = 
rc
.
right
;

1472 
dy
 = 
rc
.
bŸtom
;

1474 
hPíHigh
 = 
	`GëStockObje˘
(
WHITE_PEN
);

1476 
hPíShadow
 = 
	`GëSysCﬁ‹Pí
(
COLOR_BTNSHADOW
);

1478 
hPíShadow
 = 
	`Cª©ePí
(
PS_SOLID
,1,
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
));

1481 
hBrush
 = 
	`GëSysCﬁ‹Brush
(
COLOR_BTNFACE
);

1483 
hBrush
 = 
	`Cª©eSﬁidBrush
(
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

1485 
	`FûlRe˘
(
hDC
, &
rc
, 
hBrush
);

1487 
hBrush
 = 
	`GëStockObje˘
(
BLACK_BRUSH
);

1488 
FûlRe˘
 (
hDC
, &
Õ
->
Buâ⁄Re˘
, 
hBrush
);

1490 
	`Sñe˘Obje˘
(
hDC
,
	`GëStockObje˘
(
BLACK_PEN
));

1491 
	`Re˘™gÀ
(
hDC
,
Õ
->
Buâ⁄Re˘
.
À·
,Õ->Buâ⁄Re˘.
t›
,Õ->Buâ⁄Re˘.
right
,Õ->Buâ⁄Re˘.
bŸtom
);

1493 
rc
.
À·
 +1;Ñc.
right
 -= 1;

1494 
rc
.
t›
 +1;Ñc.
bŸtom
 -= 1;

1496 
	`Døw3DBuâ⁄Re˘
(
hDC
,
hPíHigh
,
hPíShadow
,
rc
,
wSèã
);

1499 i‡(
hbmpCombo
 == 0)

1501 
hbmpCombo
 = 
	`LﬂdBôm≠
(0,(
LPSTR
)
OBM_COMBO
);

1502 
	`GëObje˘
(
hbmpCombo
, (
BITMAP
), (
LPVOID
)&
bmpCombo
);

1503 
nWidth
 = 
bmpCombo
.
bmWidth
;

1504 
nHeight
 = 
bmpCombo
.
bmHeight
;

1510 
hdcSrc
 = 
	`Cª©eCom∑tibÀDC
(
hDC
);

1511 
hbmpOld
 = 
	`Sñe˘Obje˘
(
hdcSrc
, 
hbmpCombo
);

1515 
rgbText
 = 
	`SëTextCﬁ‹
(
hDC
,
	`GëSysCﬁ‹
(
COLOR_BTNTEXT
));

1516 
rgbBk
 = 
	`SëBkCﬁ‹
(
hDC
,
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

1518 
cx
 = (
dx
 - 
x
 - 
nWidth
)/2;

1519 
cy
 = (
dy
 - 
y
 - 
nHeight
)/2;

1520 i‡(
wSèã
)

1521 { 
cx
++; 
cy
++; }

1522 
	`BôB…
(
hDC
, 
x
+
cx
, 
y
+
cy
, 
nWidth
, 
nHeight
, 
hdcSrc
, 0, 0, 
SRCCOPY
);

1524 
	`SëTextCﬁ‹
(
hDC
, 
rgbText
);

1525 
	`SëBkCﬁ‹
(
hDC
, 
rgbBk
);

1526 
	`Sñe˘Obje˘
(
hdcSrc
,
hbmpOld
);

1527 
	`DñëeDC
(
hdcSrc
);

1530 
	`DñëeObje˘
(
hBrush
);

1531 
	`DñëeObje˘
(
hPíShadow
);

1533 
	`Rñó£DC
(
hWnd
,
hDC
);

1535 i‡(
wSèã
)

1536 
	`SET_STATE
(
Õ
,
CSF_LOCALBUTTONDOWN
);

1538 
	`CLEAR_STATE
(
Õ
,
CSF_LOCALBUTTONDOWN
);

1539 
	}
}

1545 
LRESULT
 
	$DefCOMBOLBOXProc
(
HWND
 
hWnd
, 
UINT
 
msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1548  
	`DefLISTBOXProc
(
hWnd
, 
msg
, 
wP¨am
,
lP¨am
);

1550  
	`Li°boxCålProc
(
hWnd
, 
msg
, 
wP¨am
,
lP¨am
);

1551 
	}
}

1557 
	$CBoxSídMou£ToLBox
(
COMBOBOX
 *
Õ
, 
UINT
 
uiMsg
, 
WPARAM
 
wP¨am
, 
POINT
 
±S¸ìn
)

1559 
POINT
 
±
;

1560 
nNCHô
;

1562 
HWND
 
hWndS¸ﬁl
;

1564 
±
 = 
±S¸ìn
;

1565 
	`S¸ìnToClõ¡
(
Õ
->
Li°BoxC⁄åﬁ
,&
±
);

1567 
nNCHô
 = 
	`LOSHORT
(
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
WM_NCHITTEST
, 0, 
	`MAKELPARAM
(
±S¸ìn
.
x
,±S¸ìn.
y
)));

1569 
nNCHô
)

1571 
HTCLIENT
:

1572 i‡(
uiMsg
 =
WM_MOUSEMOVE
 && !
	`IS_SET
(
Õ
,
CSF_LBOXBUTTONDOWN
))

1574 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
WM_LBUTTONDOWN
, 0, 
	`MAKELONG
((
WORD
)
±
.
x
,(WORDÌt.
y
));

1576 
	`SET_STATE
(
Õ
, 
CSF_BUTTONDOWN
 | 
CSF_LBOXBUTTONDOWN
);

1578 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
uiMsg
, 
wP¨am
, 
	`MAKELONG
((
WORD
)
±
.
x
,(WORDÌt.
y
));

1582 
HTVSCROLL
:

1583 i‡(0 !(
hWndS¸ﬁl
 = 
	`TWIN_C⁄vîtToSysS¸ﬁl
(
Õ
->
Li°BoxC⁄åﬁ
, 
TRUE
 , &
±
)))

1584 
	`SídMesßge
(
hWndS¸ﬁl
, 
uiMsg
, 
wP¨am
, 
	`MAKELONG
((
WORD
)
±
.
x
,(WORDÌt.
y
));

1590 
	}
}

1595 
	$CBoxC≠tuª
(
HWND
 
hWnd
, 
WORD
 
wFunc
)

1597 
HWND
 
hWndC≠tuª
 = (HWND)0;

1599 i‡(
wFunc
)

1601 
hWndC≠tuª
 = 
	`SëC≠tuª
(
hWnd
);

1603 
	`SëFocus
(
hWnd
);

1606 i‡(!
hWndC≠tuª
)

1607 
	`Rñó£C≠tuª
();

1609 #ifde‡ 
LATER


1610 
	`SëC≠tuª
(
hWndC≠tuª
);

1612 
	`Rñó£C≠tuª
();

1614 
hWndC≠tuª
 = (
HWND
)0;

1617 
	}
}

1622 
	$CBoxDøwEdô
(
COMBOBOX
 *
Õ
, 
HWND
 
hWnd
, 
UINT
 
uiKey
)

1624 
nLí
;

1625 
LPVOID
 
ÕD©a
;

1627 
HRGN
 
hRgn
;

1628 
DRAWITEMSTRUCT
 
dis
;

1636 i‡(
Õ
->
wStyÀ
 & 
CBS_HASSTRINGS
)

1638 i‡(
uiKey
 =(
UINT
)
LB_ERR
)

1640 
nLí
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, 
uiKey
, 0L);

1641 i‡(
nLí
 <= 0)

1643 
ÕD©a
 = (
LPVOID
)
	`WöMÆloc
(
nLí
+1);

1644 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXT
, 
uiKey
, (
LPARAM
)
ÕD©a
);

1645 
	`SídMesßge
(
Õ
->
EdôC⁄åﬁ
, 
WM_SETTEXT
, 
	`°æí
(
ÕD©a
), (
LPARAM
)lpData);

1646 
	`Edô_SëSñ
(
Õ
->
EdôC⁄åﬁ
, 0, -1);

1647 
	`WöFªe
((
LPSTR
)
ÕD©a
);

1651 
dis
.
CéTy≥
 = 
ODT_COMBOBOX
;

1652 
dis
.
CéID
 = (
UINT
)
Õ
->
nID
;

1653 
dis
.
ôemID
 = -1;

1654 
dis
.
ôemA˘i⁄
 = 
ODA_DRAWENTIRE
;

1655 
dis
.
ôemSèã
 = 
ODS_FOCUS
;

1656 
dis
.
hwndIãm
 = 
hWnd
;

1657 
dis
.
ôemD©a
 = 0;

1658 
	`GëClõ¡Re˘
(
Õ
->
EdôC⁄åﬁ
,&
dis
.
rcIãm
);

1659 
dis
.
rcIãm
.
À·
 += 3;

1660 
dis
.
rcIãm
.
right
 -= 3;

1661 
dis
.
rcIãm
.
t›
 += 2;

1662 
dis
.
rcIãm
.
bŸtom
 -= 2;

1664 
dis
.
hDC
 = 
	`GëDC
(
Õ
->
EdôC⁄åﬁ
);

1665 
hRgn
 = 
	`Cª©eRe˘RgnIndúe˘
(&
dis
.
rcIãm
);

1666 
	`Sñe˘ClùRgn
(
dis
.
hDC
,
hRgn
);

1667 
	`Sñe˘Obje˘
(
dis
.
hDC
, 
Õ
->
hF⁄t
);

1668 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_DRAWITEM
, (
WPARAM
)(
UINT
Óp->
nID
, (
LPARAM
)&
dis
);

1669 
	`Rñó£DC
(
Õ
->
EdôC⁄åﬁ
,
dis
.
hDC
);

1670 
	`DñëeObje˘
(
hRgn
);

1673 
	}
}

1678 
	$CBoxDøwSètic
(
COMBOBOX
 *
Õ
, 
HWND
 
hWnd
, 
UINT
 
uiKey
)

1680 
nLí
;

1681 
HDC
 
hdc
;

1682 
LPVOID
 
ÕD©a
;

1683 
RECT
 
rcClõ¡
;

1684 
HFONT
 
hf⁄Old
 = 0;

1686 
HRGN
 
hRgn
;

1687 
DRAWITEMSTRUCT
 
dis
;

1689 
HBRUSH
 
hbrSètic
, 
hbrOld
;

1693 
hdc
 = 
	`GëDC
(
hWnd
);

1694 
rcClõ¡
.
À·
 = 0;

1695 
rcClõ¡
.
t›
 = 0;

1696 
rcClõ¡
.
right
 = 
Õ
->
Buâ⁄Re˘
.
À·
+1;

1697 
rcClõ¡
.
bŸtom
 = 
Õ
->
uHeight
;

1698 
hbrSètic
 = 
	`Cª©eSﬁidBrush
(
	`GëSysCﬁ‹
(
COLOR_WINDOW
));

1699 
hbrOld
 = 
	`Sñe˘Obje˘
(
hdc
, 
hbrSètic
);

1700 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
BLACK_PEN
));

1701 
	`Re˘™gÀ
(
hdc
, 
rcClõ¡
.
À·
,ÑcClõ¡.
t›
,ÑcClõ¡.
right
,ÑcClõ¡.
bŸtom
);

1702 
	`Sñe˘Obje˘
(
hdc
, 
hbrOld
);

1703 
	`DñëeObje˘
(
hbrSètic
);

1704 
	`Rñó£DC
(
hWnd
, 
hdc
);

1706 i‡(
uiKey
 =(
UINT
)
LB_ERR
)

1713 
hdc
 = 
	`GëDC
(
hWnd
);

1714 
nLí
 = ()
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXTLEN
, (
WPARAM
)
uiKey
, 0L);

1715 i‡(
nLí
 > 0)

1717 
ÕD©a
 = (
LPVOID
)
	`WöMÆloc
(
nLí
+1);

1718 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETTEXT
, 
uiKey
, (
LPARAM
)
ÕD©a
);

1719 
	`SëBkMode
(
hdc
, 
TRANSPARENT
);

1720 i‡(!
	`IS_SET
(
Õ
, 
CSF_FOCUS
))

1722 
	`SëTextCﬁ‹
(
hdc
, 
	`GëSysCﬁ‹
(
COLOR_WINDOWTEXT
));

1723 
rcClõ¡
.
À·
 += 2;

1726 
	`InÊ©eRe˘
(&
rcClõ¡
, -2, -2);

1727 
hbrSètic
 = 
	`Cª©eSﬁidBrush
(
	`GëSysCﬁ‹
(
COLOR_HIGHLIGHT
));

1728 
hbrOld
 = 
	`Sñe˘Obje˘
(
hdc
, 
hbrSètic
);

1729 
	`FûlRe˘
(
hdc
, &
rcClõ¡
, 
hbrSètic
);

1731 
	`DøwFocusRe˘
(
hdc
, &
rcClõ¡
);

1733 
	`Sñe˘Obje˘
(
hdc
, 
hbrOld
);

1734 
	`DñëeObje˘
(
hbrSètic
);

1735 
	`SëTextCﬁ‹
(
hdc
, 
	`GëSysCﬁ‹
(
COLOR_HIGHLIGHTTEXT
));

1737 i‡(
Õ
->
hF⁄t
)

1738 
hf⁄Old
 = 
	`Sñe˘Obje˘
(
hdc
, 
Õ
->
hF⁄t
);

1739 
	`DøwText
(
hdc
, (
LPSTR
)
ÕD©a
, 
nLí
, &
rcClõ¡
, 
DT_VCENTER
 | 
DT_SINGLELINE
 | 
DT_NOPREFIX
);

1740 i‡(
Õ
->
hF⁄t
)

1741 
	`Sñe˘Obje˘
(
hdc
, 
hf⁄Old
);

1742 
	`WöFªe
((
LPVOID
)
ÕD©a
);

1744 
	`Rñó£DC
(
hWnd
, 
hdc
);

1748 
dis
.
CéTy≥
 = 
ODT_COMBOBOX
;

1749 
dis
.
CéID
 = (
UINT
)
Õ
->
nID
;

1750 
dis
.
ôemID
 = 
uiKey
;

1751 
dis
.
ôemA˘i⁄
 = 
ODA_DRAWENTIRE
;

1752 
dis
.
ôemSèã
 = 
ODS_FOCUS
;

1753 
dis
.
hwndIãm
 = 
hWnd
;

1754 
dis
.
ôemD©a
 = 
	`SídMesßge
(
Õ
->
Li°BoxC⁄åﬁ
, 
LB_GETITEMDATA
, 
uiKey
, 0L);

1755 
	`GëClõ¡Re˘
(
hWnd
, &
dis
.
rcIãm
);

1756 
dis
.
rcIãm
.
À·
 += 3;

1757 
dis
.
rcIãm
.
right
 = 
Õ
->
Buâ⁄Re˘
.
À·
 - 2;

1758 
dis
.
rcIãm
.
t›
 += 2;

1759 
dis
.
rcIãm
.
bŸtom
 -= 2;

1761 
dis
.
hDC
 = 
	`GëDC
(
hWnd
);

1762 
hRgn
 = 
	`Cª©eRe˘RgnIndúe˘
(&
dis
.
rcIãm
);

1763 
	`Sñe˘ClùRgn
(
dis
.
hDC
, 
hRgn
);

1764 
	`Sñe˘Obje˘
(
dis
.
hDC
, 
Õ
->
hF⁄t
);

1765 
	`SídMesßge
(
Õ
->
hWndP¨ít
, 
WM_DRAWITEM
, (
WPARAM
)(
UINT
Óp->
nID
, (
LPARAM
)&
dis
);

1766 
	`Rñó£DC
(
hWnd
, 
dis
.
hDC
);

1767 
	`DñëeObje˘
(
hRgn
);

1771 
	}
}

	@mwin/winlib/draw3d.c

1 
	~"wödows.h
"

2 
	~"wötoﬁs.h
"

23 
WINAPI


24 
	$Døw3dShadow
(
HDC
 
hDC
,
x
,
y
,
w
,
h
,
COLORREF
 
¸T›
,COLORREF 
¸BŸtom
)

26 
HPEN
 
hPíT›
, 
hPíBŸtom
, 
hﬁdPí
;

28 
hPíT›
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸T›
);

29 
hPíBŸtom
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸BŸtom
);

30 
hﬁdPí
 = 
	`Sñe˘Obje˘
–
hDC
, 
hPíT›
);

31 
	`MoveToEx
–
hDC
, 
x
, 
y
+
h
-2, 
NULL
);

32 
	`LöeTo
–
hDC
, 
x
, 
y
);

33 
	`LöeTo
–
hDC
, 
x
+
w
-1, 
y
);

35 
	`Sñe˘Obje˘
–
hDC
, 
hPíBŸtom
);

36 
	`MoveToEx
–
hDC
, 
x
+
w
-1, 
y
+1, 
NULL
);

37 
	`LöeTo
–
hDC
, 
x
+
w
-1, 
y
+
h
-1);

38 
	`LöeTo
–
hDC
, 
x
, 
y
+
h
-1);

40 
	`Sñe˘Obje˘
–
hDC
, 
hﬁdPí
);

41 
	`DñëeObje˘
–
hPíT›
);

42 
	`DñëeObje˘
–
hPíBŸtom
);

43 
	}
}

53 
WINAPI


54 
	$Døw3dBox
(
HDC
 
hDC
,
x
,
y
,
w
,
h
,
COLORREF
 
¸T›
,COLORREF 
¸BŸtom
)

56 
HPEN
 
hPíT›
, 
hPíBŸtom
, 
hﬁdPí
;

58 
hPíT›
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸T›
);

59 
hPíBŸtom
 = 
	`Cª©ePí
–
PS_SOLID
, 1, 
¸BŸtom
);

60 
hﬁdPí
 = 
	`Sñe˘Obje˘
–
hDC
, 
hPíT›
);

61 
	`MoveToEx
–
hDC
, 
x
, 
y
+
h
-2, 
NULL
);

62 
	`LöeTo
–
hDC
, 
x
, 
y
);

63 
	`MoveToEx
–
hDC
, 
x
, 
y
, 
NULL
);

64 
	`LöeTo
–
hDC
, 
x
+
w
-1, 
y
);

66 
	`Sñe˘Obje˘
–
hDC
, 
hPíBŸtom
);

67 
	`MoveToEx
–
hDC
, 
x
+
w
-1, 
y
, 
NULL
);

68 
	`LöeTo
–
hDC
, 
x
+
w
-1, 
y
+
h
-1);

69 
	`LöeTo
–
hDC
, 
x
-1, 
y
+
h
-1);

71 
	`Sñe˘Obje˘
–
hDC
, 
hﬁdPí
);

72 
	`DñëeObje˘
–
hPíT›
);

73 
	`DñëeObje˘
–
hPíBŸtom
);

74 
	}
}

79 
WINAPI


80 
	$Døw3dIn£t
(
HDC
 
hDC
,
x
,
y
,
w
,
h
)

82 
	`Døw3dBox
(
hDC
, 
x
, 
y
, 
w
, 
h
,

83 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
), GëSysCﬁ‹(
COLOR_BTNHIGHLIGHT
));

84 ++
x
; ++
y
; 
w
 -2; 
h
 -= 2;

85 
	`Døw3dBox
(
hDC
, 
x
, 
y
, 
w
, 
h
,

86 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
), GëSysCﬁ‹(
COLOR_3DLIGHT
));

87 
	}
}

92 
WINAPI


93 
	$Døw3dOut£t
(
HDC
 
hDC
,
x
,
y
,
w
,
h
)

95 
	`Døw3dBox
(
hDC
, 
x
, 
y
, 
w
, 
h
,

96 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
), GëSysCﬁ‹(
COLOR_WINDOWFRAME
));

97 ++
x
; ++
y
; 
w
 -2; 
h
 -= 2;

98 
	`Døw3dBox
(
hDC
, 
x
, 
y
, 
w
, 
h
,

99 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
), GëSysCﬁ‹(
COLOR_BTNSHADOW
));

100 
	}
}

105 
WINAPI


106 
	$Døw3dPushDown
(
HDC
 
hDC
, 
x
, 
y
, 
w
, 
h
)

108 
	`Døw3dBox
(
hDC
, 
x
, 
y
, 
w
, 
h
, 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
),

109 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
));

110 
	}
}

115 
WINAPI


116 
	$Døw3dUpDownSèã
(
HDC
 
hDC
, 
x
, 
y
, 
w
, 
h
, 
BOOL
 
fDown
)

118 i‡(
fDown
)

119 
	`Døw3dPushDown
(
hDC
, 
x
, 
y
, 
w
, 
h
);

120 
	`Døw3dOut£t
(
hDC
, 
x
, 
y
, 
w
, 
h
);

121 
	}
}

123 
WINAPI


124 
	$Døw3dUpFøme
(
HDC
 
hDC
, 
l
, 
t
, 
r
, 
b
)

126 
RECT
 
rc
;

127 
HBRUSH
 
hbr
;

129 
	`SëRe˘
(&
rc
, 
l
, 
t
, 
r
, 
b
);

130 
	`Døw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

131 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

132 
	`GëSysCﬁ‹
(
COLOR_3DLIGHT
),

133 
	`GëSysCﬁ‹
(
COLOR_WINDOWFRAME
));

134 
	`InÊ©eRe˘
(&
rc
, -1, -1);

135 
	`Døw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

136 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

137 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
),

138 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
));

139 
	`InÊ©eRe˘
(&
rc
, -1, -1);

141 
hbr
 = 
	`Cª©eSﬁidBrush
(
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

142 
	`FûlRe˘
(
hDC
, &
rc
, 
hbr
);

143 
	`DñëeObje˘
(
hbr
);

144 
	}
}

	@mwin/winlib/edit.c

51 
	~<°dio.h
>

52 
	~<°dlib.h
>

53 
	~<°rög.h
>

54 
	#MWINCLUDECOLORS


	)

55 
	~"wödows.h
"

56 
	~"wötoﬁs.h
"

57 
	~"devi˚.h
"

59 #i‡
PSP


61 
	~<p•kî√l.h
>

62 
	~<p•debug.h
>

65 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

67 
	#Ârötf
(...)

	)

72 #i‡
HAVE_HZK_SUPPORT
 || 
HAVE_BIG5_SUPPORT


73 
	#USE_BIG5


	)

74 
	#DEFAULT_FONT
 
SYSTEM_FIXED_FONT


	)

76 
	#DEFAULT_FONT
 
DEFAULT_GUI_FONT


	)

79 
	#WIDTH_EDIT_BORDER
 2

	)

80 
	#MARGIN_EDIT_LEFT
 1

	)

81 
	#MARGIN_EDIT_TOP
 1

	)

82 
	#MARGIN_EDIT_RIGHT
 2

	)

83 
	#MARGIN_EDIT_BOTTOM
 1

	)

85 
	#LEN_SLEDIT_BUFFER
 3000

	)

86 
	#LEN_SLEDIT_UNDOBUFFER
 1024

	)

88 
	#EST_FOCUSED
 0x00000001L

	)

89 
	#EST_MODIFY
 0x00000002L

	)

90 
	#EST_READONLY
 0x00000004L

	)

91 
	#EST_REPLACE
 0x00000008L

	)

93 
	#EDIT_OP_NONE
 0x00

	)

94 
	#EDIT_OP_DELETE
 0x01

	)

95 
	#EDIT_OP_INSERT
 0x02

	)

96 
	#EDIT_OP_REPLACE
 0x03

	)

98 
	sègSLEDITDATA
 {

99 
HFONT
 
	mhF⁄t
;

100 
	mbuf„rLí
;

102 
	md©aEnd
;

103 
	medôPos
;

104 
	mˇªtOff
;

105 
	m°¨tPos
;

107 
	m£lSèπ
;

108 
	m£lEnd
;

110 
	m∑sswdCh¨
;

112 
	mÀ·M¨gö
;

113 
	mt›M¨gö
;

114 
	mrightM¨gö
;

115 
	mbŸtomM¨gö
;

117 
	mh¨dLimô
;

119 
	mœ°Op
;

120 
	mœ°Pos
;

121 
	maf„˘edLí
;

122 
	mundoBuf„rLí
;

123 
	mundoBuf„r
 [
LEN_SLEDIT_UNDOBUFFER
];

124 
	mbuf„r
 [
LEN_SLEDIT_BUFFER
];

125 } 
	tSLEDITDATA
, *
	tPSLEDITDATA
;

127 
LRESULT
 
CALLBACK


128 
SLEdôCålProc
 (
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

130 
	$GëSysCh¨Height
 (
HWND
 
hwnd
)

132 #i‚de‡
USE_BIG5


133 
HDC
 
hdc
;

134 
xw
, 
xh
, 
xb
;

136 
hdc
 = 
	`GëDC
(
hwnd
);

137 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_FONT
));

138 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

139 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

140 
	`Rñó£DC
(
hwnd
,
hdc
);

142  
xh
;

146 
	}
}

148 
	$GëSysCh¨Width
 (
HWND
 
hwnd
)

150 #i‚de‡
USE_BIG5


151 
HDC
 
hdc
;

152 
xw
, 
xh
, 
xb
;

154 
hdc
 = 
	`GëDC
(
hwnd
);

155 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_FONT
));

156 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

157 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

158 
	`Rñó£DC
(
hwnd
,
hdc
);

160  
xw
;

164 
	}
}

166 
	$GëSysCCh¨Width
 (
HWND
 
hwnd
)

168  (2*
	`GëSysCh¨Width
(
hwnd
));

169 
	}
}

171 
WINAPI
 
	$MwRegi°îEdôC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

173 
WNDCLASS
 
wc
;

175 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

176 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
SLEdôCålProc
;

177 
wc
.
cbClsExåa
 = 0;

178 
wc
.
cbWndExåa
 = 0;

179 
wc
.
hIn°™˚
 = hInstance;

180 
wc
.
hIc⁄
 = 
NULL
;

181 
wc
.
hCurs‹
 = 0;

182 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

183 
wc
.
ÕszMíuName
 = 
NULL
;

184 
wc
.
ÕszCœssName
= "EDIT";

186  
	`Regi°îCœss
(&
wc
);

187 
	}
}

189 
	$edtGëOutWidth
 (c⁄° 
HWND
 
pCål
)

191  
pCål
->
˛úe˘
.
right
 -ÖCål->˛úe˘.
À·


192 - ((
PSLEDITDATA
)(
pCål
->
u£rd©a2
))->
À·M¨gö


193 - ((
PSLEDITDATA
)(
pCål
->
u£rd©a2
))->
rightM¨gö
;

194 
	}
}

196 
	$edtGëSèπDi•PosAtEnd
 (c⁄° 
HWND
 
pCål
, 
PSLEDITDATA
 
pSLEdôD©a
)

198 
nOutWidth
 = 
	`edtGëOutWidth
 (
pCål
);

199 
ídPos
 = 
pSLEdôD©a
->
d©aEnd
;

200 
√wSèπPos
 = 
pSLEdôD©a
->
°¨tPos
;

201 c⁄° * 
buf„r
 = 
pSLEdôD©a
->buffer;

203 
TRUE
) {

204 i‡((
ídPos
 - 
√wSèπPos
Ë* 
	`GëSysCh¨Width
 (
pCål
Ë< 
nOutWidth
)

208 i‡((
BYTE
)
buf„r
 [
√wSèπPos
] > 0xA0)

210 
√wSèπPos
 ++;

211 i‡(
√wSèπPos
 < 
pSLEdôD©a
->
d©aEnd
)

213 #i‚de‡
USE_BIG5


214 i‡((
BYTE
)
buf„r
 [
√wSèπPos
] > 0xA0)

216 i‡–((
BYTE
)
buf„r
 [
√wSèπPos
] >= 0x40 && (BYTE)buffer[newStartPos] <= 0x7e) ||

217 ((
BYTE
)
buf„r
 [
√wSèπPos
] >= 0xa1 && (BYTE)buffer[newStartPos] <= 0xfe))

219 
√wSèπPos
 ++;

223 
√wSèπPos
 ++;

226  
√wSèπPos
;

227 
	}
}

229 
	$edtGëDi•Lí
 (c⁄° 
HWND
 
pCål
)

231 
i
, 
n
 = 0;

232 
nOutWidth
 = 
	`edtGëOutWidth
 (
pCål
);

233 
nTextWidth
 = 0;

234 
PSLEDITDATA
 
pSLEdôD©a
 = (PSLEDITDATA)(
pCål
->
u£rd©a2
);

235 c⁄° * 
buf„r
 = 
pSLEdôD©a
->buffer;

237 
i
 = 
pSLEdôD©a
->
°¨tPos
; i <ÖSLEdôD©a->
d©aEnd
; i++) {

239 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

241 
i
++;

242 i‡(
i
 < 
pSLEdôD©a
->
d©aEnd
)

244 #i‚de‡
USE_BIG5


245 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

247 i‡–((
BYTE
)
buf„r
 [
i
] >= 0x40 && (BYTE)buffer[i] <= 0x7e) ||

248 ((
BYTE
)
buf„r
 [
i
] >= 0xa1 && (BYTE)buffer[i] <= 0xfe))

251 
nTextWidth
 +
	`GëSysCCh¨Width
 (
pCål
);

252 
n
 += 2;

255 
i
--;

259 
nTextWidth
 +
	`GëSysCh¨Width
 (
pCål
);

260 
n
++;

265 
nTextWidth
 +
	`GëSysCh¨Width
 (
pCål
);

266 
n
++;

269 i‡(
nTextWidth
 > 
nOutWidth
)

273  
n
;

274 
	}
}

276 
	$edtGëOff£t
 (
HWND
 
hwnd
,c⁄° 
SLEDITDATA
* 
pSLEdôD©a
, 
x
)

278 
i
;

279 
√wOff
 = 0;

280 
nTextWidth
 = 0;

281 c⁄° * 
buf„r
 = 
pSLEdôD©a
->buffer;

283 
x
 -
pSLEdôD©a
->
À·M¨gö
;

284 
i
 = 
pSLEdôD©a
->
°¨tPos
; i <ÖSLEdôD©a->
d©aEnd
; i++) {

285 i‡((
nTextWidth
 + (
	`GëSysCh¨Width
(
hwnd
Ë>> 1)Ë>
x
)

289 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

291 
i
++;

292 i‡(
i
 < 
pSLEdôD©a
->
d©aEnd
)

294 #i‚de‡
USE_BIG5


295 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

297 i‡–((
BYTE
)
buf„r
 [
i
] >= 0x40 && (BYTE)buffer[i] <= 0x7e) ||

298 ((
BYTE
)
buf„r
 [
i
] >= 0xa1 && (BYTE)buffer[i] <= 0xfe))

301 
nTextWidth
 +
	`GëSysCCh¨Width
 (
hwnd
);

302 
√wOff
 += 2;

305 
i
 --;

309 
nTextWidth
 +
	`GëSysCh¨Width
 (
hwnd
);

310 
√wOff
 ++;

315 
nTextWidth
 +
	`GëSysCh¨Width
 (
hwnd
);

316 
√wOff
 ++;

321  
√wOff
;

322 
	}
}

324 
BOOL
 
	$edtIsACCh¨Bef‹ePosôi⁄
 (c⁄° * 
°rög
, 
pos
)

326 i‡(
pos
 < 2)

327  
FALSE
;

330 #i‚de‡
USE_BIG5


332 i‡((
BYTE
)
°rög
 [
pos
 - 2] > 0xA0 && (BYTE)string [pos - 1] > 0xA0)

333  
TRUE
;

335 i‡((
BYTE
)
°rög
 [
pos
 - 2] > 0xA0)

337 i‡–((
BYTE
)
°rög
 [
pos
 - 1] >= 0x40 && (BYTE)string[pos - 1] <= 0x7e) ||

338 ((
BYTE
)
°rög
 [
pos
 - 1] >= 0xa1 && (BYTE)string[pos - 1] <= 0xfe))

339  
TRUE
;

343  
FALSE
;

344 
	}
}

346 
BOOL
 
	$edtIsACCh¨AtPosôi⁄
 (c⁄° * 
°rög
, 
Àn
, 
pos
)

348 i‡(
pos
 > (
Àn
 - 2))

349  
FALSE
;

352 #i‚de‡
USE_BIG5


353 i‡((
BYTE
)
°rög
 [
pos
] > 0xA0 && (BYTE)string [pos + 1] > 0xA0)

354  
TRUE
;

356 i‡((
BYTE
)
°rög
 [
pos
] > 0xA0)

358 i‡–((
BYTE
)
°rög
 [
pos
 + 1] >= 0x40 && (BYTE)string [pos + 1] <= 0x7e) ||

359 ((
BYTE
)
°rög
 [
pos
 + 1] >= 0xa1 && (BYTE)string [pos + 1] <= 0xfe)) {

362  
TRUE
;

367  
FALSE
;

368 
	}
}

370 
LRESULT
 
CALLBACK


371 
	$SLEdôCålProc
 (
HWND
 
hWnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

373 
HWND
 
pCål
;

374 
DWORD
 
dwStyÀ
;

375 
HDC
 
hdc
;

376 
PSLEDITDATA
 
pSLEdôD©a
;

377 
RECT
 
rc
;

379 
pCål
 = 
hWnd
;

380 
dwStyÀ
 = 
pCål
->
°yÀ
;

382 
mesßge
)

384 
WM_CREATE
:

385 i‡(!(
pSLEdôD©a
 = 
	`mÆloc
 ( (
SLEDITDATA
)))) {

386 
	`Ârötf
 (
°dîr
, "EDIT: mallocÉrror!\n");

390 
pSLEdôD©a
->
hF⁄t
 = 
	`GëStockObje˘
(
DEFAULT_FONT
);

392 
pSLEdôD©a
->
buf„rLí
 = 
LEN_SLEDIT_BUFFER
;

393 
pSLEdôD©a
->
edôPos
 = 0;

394 
pSLEdôD©a
->
ˇªtOff
 = 0;

395 
pSLEdôD©a
->
°¨tPos
 = 0;

397 
pSLEdôD©a
->
£lSèπ
 = 0;

398 
pSLEdôD©a
->
£lEnd
 = 0;

399 
pSLEdôD©a
->
∑sswdCh¨
 = '*';

400 
pSLEdôD©a
->
À·M¨gö
 = 
MARGIN_EDIT_LEFT
;

401 
pSLEdôD©a
->
t›M¨gö
 = 
MARGIN_EDIT_TOP
;

402 
pSLEdôD©a
->
rightM¨gö
 = 
MARGIN_EDIT_RIGHT
;

403 
pSLEdôD©a
->
bŸtomM¨gö
 = 
MARGIN_EDIT_BOTTOM
;

405 
pSLEdôD©a
->
h¨dLimô
 = -1;

408 
pSLEdôD©a
->
œ°Op
 = 
EDIT_OP_NONE
;

409 
pSLEdôD©a
->
œ°Pos
 = 0;

410 
pSLEdôD©a
->
af„˘edLí
 = 0;

411 
pSLEdôD©a
->
undoBuf„rLí
 = 
LEN_SLEDIT_UNDOBUFFER
;

412 
pSLEdôD©a
->
undoBuf„r
 [0] = '\0';

414 
pSLEdôD©a
->
d©aEnd
 = 
	`°æí
 (
pCål
->
szTôÀ
);

415 
	`mem˝y
 (
pSLEdôD©a
->
buf„r
, 
pCål
->
szTôÀ
,

416 
	`mö
 (
LEN_SLEDIT_BUFFER
, 
pSLEdôD©a
->
d©aEnd
));

418 
pCål
->
u£rd©a2
 = (
DWORD
Ë
pSLEdôD©a
;

420 
pCål
->
u£rd©a
 = 0;

423 
WM_DESTROY
:

424 
	`De°royC¨ë
 ();

426 
	`‰ì
 ((*)
pCål
->
u£rd©a2
);

429 
WM_CHANGESIZE
:

431 
pCål
->
˛
 =ÖCål->
À·
 + 
WIDTH_EDIT_BORDER
;

432 
pCål
->
˘
 =ÖCål->
t›
 + 
WIDTH_EDIT_BORDER
;

433 
pCål
->
¸
 =ÖCål->
right
 - 
WIDTH_EDIT_BORDER
;

434 
pCål
->
cb
 =ÖCål->
bŸtom
 - 
WIDTH_EDIT_BORDER
;

440 
WM_SETFONT
:

442 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

443 
pSLEdôD©a
->
hF⁄t
 = (
HFONT
)
wP¨am
;

445 
	`ShowWödow
(
hWnd
, 
SW_HIDE
);

446 
	`ShowWödow
(
hWnd
, 
SW_SHOWNA
);

448 if(
	`LOWORD
(
lP¨am
))

449 
	`InvÆid©eRe˘
(
hWnd
,
NULL
,
TRUE
);

451  (
LRESULT
)0;

453 
WM_GETFONT
:

454 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

455  (
LRESULT
)
pSLEdôD©a
->
hF⁄t
;

459 
WM_SETCURSOR
:

460 i‡(
dwStyÀ
 & 
WS_DISABLED
)

462 
	`SëCurs‹
 (
	`GëSy°emCurs‹
 (
IDC_ARROW
));

467 
WM_KILLFOCUS
:

468 
pCål
->
u£rd©a
 &~
EST_FOCUSED
;

470 
	`HideC¨ë
 (
hWnd
);

471 
	`De°royC¨ë
 ();

473 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

474 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_KILLFOCUS
), (
LPARAM
)
hWnd
);

477 
WM_SETFOCUS
:

478 i‡(
pCål
->
u£rd©a
 & 
EST_FOCUSED
)

481 
pCål
->
u£rd©a
 |
EST_FOCUSED
;

483 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

486 
	`Cª©eC¨ë
 (
hWnd
, 
NULL
, 1 ,

487 
hWnd
->
˛úe˘
.
bŸtom
-hWnd->˛úe˘.
t›
-2);

488 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

489 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

490 
	`ShowC¨ë
 (
hWnd
);

492 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

493 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_SETFOCUS
), (
LPARAM
Ë
hWnd
);

496 
WM_ENABLE
:

497 i‡–(!(
dwStyÀ
 & 
WS_DISABLED
Ë&& !
wP¨am
)

498 || ((
dwStyÀ
 & 
WS_DISABLED
Ë&& 
wP¨am
) ) {

499 i‡(
wP¨am
)

500 
pCål
->
°yÀ
 &~
WS_DISABLED
;

502 
pCål
->
°yÀ
 |
WS_DISABLED
;

504 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

508 
WM_NCCALCSIZE
:

510 
LPNCCALCSIZE_PARAMS
 
Õnc
;

513 
Õnc
 = (
LPNCCALCSIZE_PARAMS
)
lP¨am
;

514 if(
	`GëWödowL⁄g
(
hWnd
, 
GWL_STYLE
Ë& 
WS_BORDER
)

515 
	`InÊ©eRe˘
(&
Õnc
->
rgrc
[0], -2, -2);

519 
WM_NCPAINT
:

520 
hdc
 = 
wP¨am
? (
HDC
)wP¨am: 
	`GëWödowDC
 (
hWnd
);

521 
	`GëWödowRe˘
(
hWnd
, &
rc
);

523 i‡(
dwStyÀ
 & 
WS_BORDER
)

524 
	`Døw3dIn£t
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

525 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
);

527 i‡(!
wP¨am
)

528 
	`Rñó£DC
 (
hWnd
, 
hdc
);

531 
WM_PAINT
:

533 
di•Lí
;

534 * 
di•Buf„r
;

535 
RECT
 
ª˘
,
rc
;

536 
PAINTSTRUCT
 
ps
;

538 
HGDIOBJ
 
ﬁdf⁄t
;

539 
ﬁdf⁄t
=
NULL
;

541 
hdc
 = 
	`BegöPaöt
 (
hWnd
,&
ps
);

542 
	`GëClõ¡Re˘
 (
hWnd
, &
ª˘
);

544 i‡(
dwStyÀ
 & 
WS_DISABLED
)

547 
	`SëBrushCﬁ‹
 (
hdc
, 
LTGRAY
 );

548 
	`FûlBox
 (
hdc
, 0, 0, 
ª˘
.
right
,Ñe˘.
bŸtom
);

550 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
ª˘
.bŸtom;Ñc.
right
=rect.right;

551 
	`FûlRe˘
(
hdc
,&
rc
,
	`GëStockObje˘
(
LTGRAY_BRUSH
));

553 
	`SëBkCﬁ‹
 (
hdc
, 
LTGRAY
 );

558 
	`SëBrushCﬁ‹
 (
hdc
, 
WHITE
 );

559 
	`FûlBox
 (
hdc
, 0, 0, 
ª˘
.
right
,Ñe˘.
bŸtom
);

561 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
ª˘
.bŸtom;Ñc.
right
=rect.right;

562 
	`FûlRe˘
(
hdc
,&
rc
,
	`GëStockObje˘
(
WHITE_BRUSH
));

564 
	`SëBkCﬁ‹
 (
hdc
, 
WHITE
 );

567 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
 );

568 
di•Lí
 = 
	`edtGëDi•Lí
 (
pCål
);

569 i‡(
di•Lí
 == 0)

571 
	`EndPaöt
 (
hWnd
, &
ps
);

575 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

577 #ifde‡
_DEBUG


578 i‡(
pSLEdôD©a
->
°¨tPos
 >ÖSLEdôD©a->
d©aEnd
)

579 
	`Ârötf
 (
°dîr
, "ASSERT failure: %s.\n", "Edit Paint");

582 
di•Buf„r
 = 
	`ALLOCA
(
di•Lí
 + 1);

584 i‡(
dwStyÀ
 & 
ES_PASSWORD
)

585 
	`mem£t
 (
di•Buf„r
, '*', 
di•Lí
);

587 
	`mem˝y
 (
di•Buf„r
,

588 
pSLEdôD©a
->
buf„r
 +ÖSLEdôD©a->
°¨tPos
,

589 
di•Lí
);

591 
di•Buf„r
 [
di•Lí
] = '\0';

594 
ª˘
.
À·
 +
pSLEdôD©a
->
À·M¨gö
;

595 
ª˘
.
t›
 +
pSLEdôD©a
->
t›M¨gö
;

596 
ª˘
.
right
 -
pSLEdôD©a
->
rightM¨gö
;

597 
ª˘
.
bŸtom
 -
pSLEdôD©a
->
bŸtomM¨gö
;

601 
	`ClùRe˘I¡î£˘
 (
hdc
, &
ª˘
);

603 
	`GdSëClùRe˘s
(
hdc
->
psd
,1,&
ª˘
);

607 #ifde‡
USE_BIG5


608 
ﬁdf⁄t
=
	`Sñe˘Obje˘
(
hdc
,
	`Cª©eF⁄t
(12,

610 
FF_DONTCARE
|
DEFAULT_PITCH
,

613 
	`Sñe˘Obje˘
(
hdc
, 
pSLEdôD©a
->
hF⁄t
);

615 
	`TextOut
 (
hdc
, 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
,

616 
di•Buf„r
,-1);

618 #ifde‡
USE_BIG5


619 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
,
ﬁdf⁄t
));

622 
	`EndPaöt
 (
hWnd
, &
ps
);

624 
	`FREEA
(
di•Buf„r
);

628 
WM_KEYDOWN
:

630 
BOOL
 
bCh™ge
 = 
FALSE
;

631 
i
;

632 
RECT
 
InvRe˘
;

633 
dñëed
;

635 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

637 ()(
wP¨am
))

640 
SCANCODE_ENTER
:

641 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

642 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_ENTER
), (
LPARAM
Ë
hWnd
);

645 
SCANCODE_HOME
:

646 i‡(
pSLEdôD©a
->
edôPos
 == 0)

649 
pSLEdôD©a
->
edôPos
 = 0;

650 
pSLEdôD©a
->
ˇªtOff
 = 0;

652 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

653 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

654 i‡(
pSLEdôD©a
->
°¨tPos
 != 0)

655 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

657 
pSLEdôD©a
->
°¨tPos
 = 0;

660 
SCANCODE_END
:

662 
√wSèπPos
;

664 i‡(
pSLEdôD©a
->
edôPos
 =pSLEdôD©a->
d©aEnd
)

667 
√wSèπPos
 = 
	`edtGëSèπDi•PosAtEnd
 (
pCål
, 
pSLEdôD©a
);

669 
pSLEdôD©a
->
edôPos
 =ÖSLEdôD©a->
d©aEnd
;

670 
pSLEdôD©a
->
ˇªtOff
 =ÖSLEdôD©a->
edôPos
 - 
√wSèπPos
;

672 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

673 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

674 i‡(
pSLEdôD©a
->
°¨tPos
 !
√wSèπPos
)

675 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

677 
pSLEdôD©a
->
°¨tPos
 = 
√wSèπPos
;

682 
VK_LEFT
:

684 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

685 
s¸ﬁlSãp
;

687 i‡(
pSLEdôD©a
->
edôPos
 == 0)

690 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pSLEdôD©a
->
buf„r
,

691 
pSLEdôD©a
->
edôPos
))

693 
s¸ﬁlSãp
 = 2;

694 
pSLEdôD©a
->
edôPos
 -= 2;

697 
s¸ﬁlSãp
 = 1;

698 
pSLEdôD©a
->
edôPos
 --;

701 
pSLEdôD©a
->
ˇªtOff
 -
s¸ﬁlSãp
;

702 i‡(
pSLEdôD©a
->
ˇªtOff
 == 0

703 && 
pSLEdôD©a
->
edôPos
 != 0)

705 
bS¸ﬁl
 = 
TRUE
;

707 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pSLEdôD©a
->
buf„r
,

708 
pSLEdôD©a
->
edôPos
))

710 
pSLEdôD©a
->
°¨tPos
 -= 2;

711 
pSLEdôD©a
->
ˇªtOff
 = 2;

715 
pSLEdôD©a
->
°¨tPos
 --;

716 
pSLEdôD©a
->
ˇªtOff
 = 1;

719 i‡(
pSLEdôD©a
->
ˇªtOff
 < 0)

721 
pSLEdôD©a
->
°¨tPos
 = 0;

722 
pSLEdôD©a
->
ˇªtOff
 = 0;

725 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

726 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

728 i‡(
bS¸ﬁl
)

729 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

733 
VK_RIGHT
:

735 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

736 
s¸ﬁlSãp
, 
moveSãp
;

738 i‡(
pSLEdôD©a
->
edôPos
 =pSLEdôD©a->
d©aEnd
)

741 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

742 
pSLEdôD©a
->
d©aEnd
,

743 
pSLEdôD©a
->
°¨tPos
))

745 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

746 
pSLEdôD©a
->
d©aEnd
,

747 
pSLEdôD©a
->
edôPos
))

749 
s¸ﬁlSãp
 = 2;

750 
moveSãp
 = 2;

751 
pSLEdôD©a
->
edôPos
 += 2;

755 
s¸ﬁlSãp
 = 2;

756 
moveSãp
 = 1;

757 
pSLEdôD©a
->
edôPos
 ++;

762 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

763 
pSLEdôD©a
->
d©aEnd
,

764 
pSLEdôD©a
->
edôPos
))

766 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

767 
pSLEdôD©a
->
d©aEnd
,

768 
pSLEdôD©a
->
°¨tPos
 + 1))

769 
s¸ﬁlSãp
 = 3;

771 
s¸ﬁlSãp
 = 2;

773 
moveSãp
 = 2;

774 
pSLEdôD©a
->
edôPos
 += 2;

778 
s¸ﬁlSãp
 = 1;

779 
moveSãp
 = 1;

780 
pSLEdôD©a
->
edôPos
 ++;

784 
pSLEdôD©a
->
ˇªtOff
 +
moveSãp
;

785 i‡(
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

786 > 
	`edtGëOutWidth
 (
pCål
))

788 
bS¸ﬁl
 = 
TRUE
;

789 
pSLEdôD©a
->
°¨tPos
 +
s¸ﬁlSãp
;

791 
pSLEdôD©a
->
ˇªtOff
 =

792 
pSLEdôD©a
->
edôPos
 -ÖSLEdôD©a->
°¨tPos
;

795 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

796 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

797 i‡(
bS¸ﬁl
)

798 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

802 
SCANCODE_INSERT
:

803 
pCål
->
u£rd©a
 ^
EST_REPLACE
;

806 
VK_DELETE
:

807 i‡((
pCål
->
u£rd©a
 & 
EST_READONLY
)

808 || (
pSLEdôD©a
->
edôPos
 =pSLEdôD©a->
d©aEnd
)){

810 
	`Pög
 ();

815 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

816 
pSLEdôD©a
->
d©aEnd
,ÖSLEdôD©a->
edôPos
))

817 
dñëed
 = 2;

819 
dñëed
 = 1;

821 
i
 = 
pSLEdôD©a
->
edôPos
;

822 
i
 < 
pSLEdôD©a
->
d©aEnd
 - 
dñëed
; i++)

823 
pSLEdôD©a
->
buf„r
 [
i
]

824 
pSLEdôD©a
->
buf„r
 [
i
 + 
dñëed
];

826 
pSLEdôD©a
->
d©aEnd
 -
dñëed
;

827 
bCh™ge
 = 
TRUE
;

829 
InvRe˘
.
À·
 = 
pSLEdôD©a
->
À·M¨gö


830 + 
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
);

831 
InvRe˘
.
t›
 = 
pSLEdôD©a
->
t›M¨gö
;

832 
InvRe˘
.
right
 = 
pCål
->
˛úe˘
.righà-ÖCål->˛úe˘.
À·
;

833 
InvRe˘
.
bŸtom
 = 
pCål
->
˛úe˘
.bŸtom -ÖCål->˛úe˘.
t›
;

835 
	`InvÆid©eRe˘
 (
hWnd
, &
InvRe˘
, 
FALSE
);

838 
VK_BACK
:

839 i‡((
pCål
->
u£rd©a
 & 
EST_READONLY
)

840 || (
pSLEdôD©a
->
edôPos
 == 0)) {

842 
	`Pög
 ();

847 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pSLEdôD©a
->
buf„r
,

848 
pSLEdôD©a
->
edôPos
))

849 
dñëed
 = 2;

851 
dñëed
 = 1;

853 
i
 = 
pSLEdôD©a
->
edôPos
;

854 
i
 < 
pSLEdôD©a
->
d©aEnd
;

855 
i
++)

856 
pSLEdôD©a
->
buf„r
 [
i
 - 
dñëed
]

857 
pSLEdôD©a
->
buf„r
 [
i
];

859 
pSLEdôD©a
->
d©aEnd
 -
dñëed
;

860 
pSLEdôD©a
->
edôPos
 -
dñëed
;

861 
bCh™ge
 = 
TRUE
;

863 
pSLEdôD©a
->
ˇªtOff
 -
dñëed
;

864 i‡(
pSLEdôD©a
->
ˇªtOff
 == 0

865 && 
pSLEdôD©a
->
edôPos
 != 0) {

866 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pSLEdôD©a
->
buf„r
,

867 
pSLEdôD©a
->
edôPos
)) {

868 
pSLEdôD©a
->
°¨tPos
 -= 2;

869 
pSLEdôD©a
->
ˇªtOff
 = 2;

872 
pSLEdôD©a
->
°¨tPos
 --;

873 
pSLEdôD©a
->
ˇªtOff
 = 1;

876 
InvRe˘
.
À·
 = 
pSLEdôD©a
->
À·M¨gö
;

877 
InvRe˘
.
t›
 = 
pSLEdôD©a
->
t›M¨gö
;

878 
InvRe˘
.
right
 = 
pCål
->
˛úe˘
.right -

879 
pCål
->
˛úe˘
.
À·
;

880 
InvRe˘
.
bŸtom
 = 
pCål
->
˛úe˘
.bottom -

881 
pCål
->
˛úe˘
.
t›
;

884 
InvRe˘
.
À·
 = 
pSLEdôD©a
->
À·M¨gö


885 + 
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
);

886 
InvRe˘
.
t›
 = 
pSLEdôD©a
->
t›M¨gö
;

887 
InvRe˘
.
right
 = 
pCål
->
˛úe˘
.right -

888 
pCål
->
˛úe˘
.
À·
;

889 
InvRe˘
.
bŸtom
 = 
pCål
->
˛úe˘
.bottom -

890 
pCål
->
˛úe˘
.
t›
;

893 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

894 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

895 
	`InvÆid©eRe˘
 (
hWnd
, &
InvRe˘
, 
FALSE
);

902 i‡(
bCh™ge
)

903 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

904 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_CHANGE
), (
LPARAM
Ë
hWnd
);

908 
WM_CHAR
:

910 
ch¨Buf„r
 [2];

911 
i
, 
ch¨s
, 
s¸ﬁlSãp
, 
ö£πög
;

912 
RECT
 
InvRe˘
;

914 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

916 i‡(
dwStyÀ
 & 
ES_READONLY
) {

919 
	`Pög
();

924 i‡(
	`HIBYTE
 (
wP¨am
)) {

925 
ch¨Buf„r
 [0] = 
	`LOBYTE
 (
wP¨am
);

926 
ch¨Buf„r
 [1] = 
	`HIBYTE
 (
wP¨am
);

927 
ch¨s
 = 2;

930 
ch¨Buf„r
 [0] = 
	`LOBYTE
 (
wP¨am
);

931 
ch¨s
 = 1;

934 i‡(
ch¨s
 == 1) {

935 
ch¨Buf„r
 [0])

950 i‡(
pCål
->
u£rd©a
 & 
EST_REPLACE
) {

951 i‡(
pSLEdôD©a
->
d©aEnd
 =pSLEdôD©a->
edôPos
)

952 
ö£πög
 = 
ch¨s
;

953 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

954 
pSLEdôD©a
->
d©aEnd
,

955 
pSLEdôD©a
->
edôPos
)) {

956 i‡(
ch¨s
 == 2)

957 
ö£πög
 = 0;

959 
ö£πög
 = -1;

962 i‡(
ch¨s
 == 2)

963 
ö£πög
 = 1;

965 
ö£πög
 = 0;

969 
ö£πög
 = 
ch¨s
;

972 i‡(
pSLEdôD©a
->
d©aEnd
 + 
ö£πög
 >ÖSLEdôD©a->
buf„rLí
) {

975 
	`Pög
 ();

977 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

978 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_MAXTEXT
), (
LPARAM
Ë
hWnd
);

981 i‡((
pSLEdôD©a
->
h¨dLimô
 >= 0)

982 && ((
pSLEdôD©a
->
d©aEnd
 + 
ö£πög
)

983 > 
pSLEdôD©a
->
h¨dLimô
)) {

985 
	`Pög
 ();

987 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

988 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_MAXTEXT
), (
LPARAM
Ë
hWnd
);

992 i‡(
ö£πög
 == -1) {

993 
i
 = 
pSLEdôD©a
->
edôPos
; i <ÖSLEdôD©a->
d©aEnd
-1; i++)

994 
pSLEdôD©a
->
buf„r
 [
i
] =ÖSLEditData->buffer [i + 1];

996 i‡(
ö£πög
 > 0) {

997 
i
 = 
pSLEdôD©a
->
d©aEnd
 + 
ö£πög
 - 1;

998 
i
 > 
pSLEdôD©a
->
edôPos
 + 
ö£πög
 - 1;

999 
i
--)

1000 
pSLEdôD©a
->
buf„r
 [
i
]

1001 
pSLEdôD©a
->
buf„r
 [
i
 - 
ö£πög
];

1004 
i
 = 0; i < 
ch¨s
; i++)

1005 
pSLEdôD©a
->
buf„r
 [pSLEdôD©a->
edôPos
 + 
i
]

1006 
ch¨Buf„r
 [
i
];

1008 
pSLEdôD©a
->
edôPos
 +
ch¨s
;

1009 
pSLEdôD©a
->
ˇªtOff
 +
ch¨s
;

1010 
pSLEdôD©a
->
d©aEnd
 +
ö£πög
;

1012 i‡(
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

1013 > 
	`edtGëOutWidth
 (
pCål
))

1015 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

1016 
pSLEdôD©a
->
d©aEnd
,

1017 
pSLEdôD©a
->
°¨tPos
))

1018 
s¸ﬁlSãp
 = 2;

1020 i‡(
ch¨s
 == 2) {

1021 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pSLEdôD©a
->
buf„r
,

1022 
pSLEdôD©a
->
d©aEnd
,

1023 
pSLEdôD©a
->
°¨tPos
 + 1))

1024 
s¸ﬁlSãp
 = 3;

1026 
s¸ﬁlSãp
 = 2;

1029 
s¸ﬁlSãp
 = 1;

1032 
pSLEdôD©a
->
°¨tPos
 +
s¸ﬁlSãp
;

1034 
pSLEdôD©a
->
ˇªtOff
 =

1035 
pSLEdôD©a
->
edôPos
 -ÖSLEdôD©a->
°¨tPos
;

1037 
InvRe˘
.
À·
 = 
pSLEdôD©a
->
À·M¨gö
;

1038 
InvRe˘
.
t›
 = 
pSLEdôD©a
->
t›M¨gö
;

1039 
InvRe˘
.
right
 = 
pCål
->
˛úe˘
.righà-ÖCål->˛úe˘.
À·
;

1040 
InvRe˘
.
bŸtom
 = 
pCål
->
˛úe˘
.bŸtom -ÖCål->˛úe˘.
t›
;

1043 
InvRe˘
.
À·
 = 
pSLEdôD©a
->
À·M¨gö


1044 + (
pSLEdôD©a
->
ˇªtOff
 - 
ch¨s
)

1045 * 
	`GëSysCh¨Width
 (
hWnd
);

1046 
InvRe˘
.
t›
 = 
pSLEdôD©a
->
t›M¨gö
;

1047 
InvRe˘
.
right
 = 
pCål
->
˛úe˘
.righà-ÖCål->˛úe˘.
À·
;

1048 
InvRe˘
.
bŸtom
 = 
pCål
->
˛úe˘
.bŸtom -ÖCål->˛úe˘.
t›
;

1051 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

1052 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

1053 
	`InvÆid©eRe˘
 (
hWnd
, &
InvRe˘
, 
FALSE
);

1055 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

1056 (
WPARAM
Ë
	`MAKELONG
 (
pCål
->
id
, 
EN_CHANGE
), (
LPARAM
Ë
hWnd
);

1060 
WM_GETTEXTLENGTH
:

1061 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1062  
pSLEdôD©a
->
d©aEnd
;

1064 
WM_GETTEXT
:

1066 * 
buf„r
 = (*)
lP¨am
;

1067 
Àn
;

1069 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1071 
Àn
 = 
	`mö
 (()
wP¨am
, 
pSLEdôD©a
->
d©aEnd
);

1073 
	`mem˝y
 (
buf„r
, 
pSLEdôD©a
->buf„r, 
Àn
);

1074 
buf„r
 [
Àn
] = '\0';

1076  
Àn
;

1080 
WM_SETTEXT
:

1082 
Àn
;

1084 i‡(
dwStyÀ
 & 
ES_READONLY
)

1087 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1090 
Àn
 = 
	`°æí
 ((*)
lP¨am
);

1091 
Àn
 = 
	`mö
 (Àn, 
pSLEdôD©a
->
buf„rLí
);

1093 i‡(
pSLEdôD©a
->
h¨dLimô
 >= 0)

1094 
Àn
 = 
	`mö
 (Àn, 
pSLEdôD©a
->
h¨dLimô
);

1096 
pSLEdôD©a
->
d©aEnd
 = 
Àn
;

1097 
	`mem˝y
 (
pSLEdôD©a
->
buf„r
, (*)
lP¨am
, 
Àn
);

1099 
pSLEdôD©a
->
edôPos
 = 0;

1100 
pSLEdôD©a
->
ˇªtOff
 = 0;

1101 
pSLEdôD©a
->
°¨tPos
 = 0;

1103 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

1107 
WM_LBUTTONDBLCLK
:

1110 
WM_LBUTTONDOWN
:

1112 
√wOff
;

1114 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1115 
√wOff
 = 
	`edtGëOff£t
 (
hWnd
,
pSLEdôD©a
, 
	`LOWORD
 (
lP¨am
));

1117 i‡(
√wOff
 !
pSLEdôD©a
->
ˇªtOff
)

1119 
pSLEdôD©a
->
edôPos
 +
√wOff
 -ÖSLEdôD©a->
ˇªtOff
;

1120 
pSLEdôD©a
->
ˇªtOff
 = 
√wOff
;

1122 
	`SëC¨ëPos
 (
pSLEdôD©a
->
ˇªtOff
 * 
	`GëSysCh¨Width
 (
hWnd
)

1123 + 
pSLEdôD©a
->
À·M¨gö
,ÖSLEdôD©a->
t›M¨gö
);

1128 
WM_LBUTTONUP
:

1131 
WM_MOUSEMOVE
:

1134 
WM_GETDLGCODE
:

1135  
DLGC_WANTCHARS
 | 
DLGC_HASSETSEL
 | 
DLGC_WANTARROWS
;

1137 
EM_SETREADONLY
:

1138 i‡(
wP¨am
)

1139 
pCål
->
°yÀ
 |
ES_READONLY
;

1141 
pCål
->
°yÀ
 &~
ES_READONLY
;

1144 
EM_SETPASSWORDCHAR
:

1145 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1147 i‡(
pSLEdôD©a
->
∑sswdCh¨
 !()
wP¨am
) {

1148 i‡(
dwStyÀ
 & 
ES_PASSWORD
) {

1149 
pSLEdôD©a
->
∑sswdCh¨
 = ()
wP¨am
;

1150 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
TRUE
);

1155 
EM_GETPASSWORDCHAR
:

1157 * 
∑sswdch¨
;

1159 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1160 
∑sswdch¨
 = (*Ë
lP¨am
;

1162 *
∑sswdch¨
 = 
pSLEdôD©a
->
∑sswdCh¨
;

1166 
EM_LIMITTEXT
:

1168 
√wLimô
 = ()
wP¨am
;

1170 i‡(
√wLimô
 >= 0) {

1171 
pSLEdôD©a
 = (
PSLEDITDATA
Ë(
pCål
->
u£rd©a2
);

1172 i‡(
pSLEdôD©a
->
buf„rLí
 < 
√wLimô
)

1173 
pSLEdôD©a
->
h¨dLimô
 = -1;

1175 
pSLEdôD©a
->
h¨dLimô
 = 
√wLimô
;

1181  
	`DefWödowProc
 (
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1185 
	}
}

	@mwin/winlib/fastfill.c

1 
	~"wödows.h
"

2 
	~"wötoﬁs.h
"

11 
WINAPI


12 
	$Fa°FûlRe˘
(
HDC
 
hdc
,
LPRECT
 
Õª˘
,
COLORREF
 
¸
)

14 
COLORREF
 
¸Old
;

16 
¸Old
 = 
	`SëBkCﬁ‹
–
hdc
, 
¸
);

17 
	`ExtTextOut
–
hdc
, 0, 0, 
ETO_OPAQUE
 | 
ETO_CLIPPED
, 
Õª˘
, 
NULL
, 0, NULL);

18 
	`SëBkCﬁ‹
–
hdc
, 
¸Old
);

19 
	}
}

	@mwin/winlib/graph3d.c

7 
	#MWINCLUDECOLORS


	)

8 
	~"wödows.h
"

9 
	~"devi˚.h
"

10 
	~"gøph3d.h
"

11 
	#USEBLIT
 1

	)

13 
	gnxpix
;

14 
	gnypix
;

15 
vec1
 
	gxsˇÀ
;

16 
vec1
 
	gysˇÀ
;

17 
vec3
 
	geye
;

18 
vec3
 
	gdúe˘
;

19 
	gQ
[5][5];

20 
HDC
 
	ghdc
;

21 
HDC
 
	ghdcMem
;

22 
HBITMAP
 
	ghbmp
, 
	ghbmpOrg
;

26 
	$look3
(
vec1
 
x
, vec1 
y
, vec1 
z
)

28 
eye
.
x
 = x;

29 
eye
.
y
 = y;

30 
eye
.
z
 = z;

31 
dúe˘
.
x
 = -
eye
.x;

32 
dúe˘
.
y
 = -
eye
.y;

33 
dúe˘
.
z
 = -
eye
.z;

34 
	`födQ
();

35 
	}
}

38 
	$öô3
(
HDC
 
hDC
, 
HWND
 
memhwnd
)

40 
HBRUSH
 
hbr
;

42 
hdc
 = 
hDC
;

43 if(
hdc
) {

44 
nxpix
 = 
hdc
->
hwnd
->
˛úe˘
.
right
 - hdc->hwnd->˛úe˘.
À·
;

45 
nypix
 = 
hdc
->
hwnd
->
˛úe˘
.
bŸtom
 - hdc->hwnd->˛úe˘.
t›
;

46 
xsˇÀ
 = (
vec1
)(
nxpix
-1) /Çxpix *Çxpix/2;

47 
ysˇÀ
 = (
vec1
)(
nypix
-1) /Çypix *Çypix/2;

49 if(
memhwnd
) {

50 
hdcMem
 = 
	`Cª©eCom∑tibÀDC
(
NULL
);

51 if(
hdcMem
) {

52 
hbmp
 = 
	`Cª©eCom∑tibÀBôm≠
(
hdcMem
,

53 
nxpix
, 
nypix
);

54 
hbmpOrg
 = 
	`Sñe˘Obje˘
(
hdcMem
, 
hbmp
);

55 
hdc
 = 
hdcMem
;

57 
hbr
 = (
HBRUSH
)
	`GëCœssL⁄g
(
memhwnd
, 
GCL_HBRBACKGROUND
);

58 
	`FûlRe˘
(
hdc
, 
NULL
, 
hbr
);

61 
	`Sñe˘Obje˘
(
hdc
, 
	`Cª©ePí
(
PS_SOLID
, 1, 
BLACK
));

63 
	}
}

66 
	$∑öt3
(
HDC
 
hDC
)

68 if(
hdcMem
) {

69 
	`BôB…
(
hDC
, 0, 0, 
nxpix
, 
nypix
, 
hdcMem
, 0, 0, 
SRCCOPY
);

70 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdcMem
, 
hbmpOrg
));

71 
	`DñëeDC
(
hdcMem
);

73 
hdcMem
 = 
NULL
;

74 
	}
}

77 
	$fx
(
vec1
 
x
)

79  ()(
x
 * 
xsˇÀ
 + 
nxpix
*0.5 - 0.5);

80 
	}
}

83 
	$fy
(
vec1
 
y
)

85  ()(
y
 * 
ysˇÀ
 + 
nypix
*0.5 - 0.5);

86 
	}
}

89 
	$movëo3
(
vec2
 
±
)

91 
	`MoveToEx
(
hdc
, 
	`fx
(
±
.
x
), 
	`fy
’t.
y
), 
NULL
);

92 
	}
}

95 
	$£tcﬁ‹3
(
MWCOLORVAL
 
c
)

97 if(
hdc
)

98 
hdc
->
≥n
->
cﬁ‹
 = 
c
;

99 
	}
}

102 
	$löëo3
(
vec2
 
±
)

104 
	`LöeTo
(
hdc
, 
	`fx
(
±
.
x
), 
	`fy
’t.
y
));

105 
	}
}

108 
	$pﬁyfûl
(
n
, 
vec2
 
poöts
[])

110 
i
;

111 
xoff
, 
yoff
;

112 
MWPOINT
 
pv
[
MAXPOLY
];

114 if(!
hdc
)

118 
xoff
 = 
hdc
->
hwnd
->
˛úe˘
.
À·
;

119 
yoff
 = 
hdc
->
hwnd
->
˛úe˘
.
t›
;

122 if(
n
 > 2) {

123 
i
=0; i<
n
; ++i) {

124 
pv
[
i
].
x
 = 
	`fx
(
poöts
[i].xË+ 
xoff
;

125 
pv
[
i
].
y
 = 
	`fy
(
poöts
[i].yË+ 
yoff
;

132 
	`GdSëF‹egroundCﬁ‹
(
hdc
->
psd
, hdc->
≥n
->
cﬁ‹
);

133 
	`GdFûlPﬁy
(
hdc
->
psd
, 
n
, 
pv
);

135 
	}
}

138 
	$squ¨e
()

140 
vec2
 
±0
, 
±1
, 
±2
, 
±3
;

142 
±0
.
x
 = -1;Öt0.
y
 = 1;

143 
±1
.
x
 = -1;Öt1.
y
 = -1;

144 
±2
.
x
 = 1;Öt2.
y
 = -1;

145 
±3
.
x
 = 1;Öt3.
y
 = 1;

146 
	`movëo3
(
±0
);

147 
	`löëo3
(
±1
);

148 
	`löëo3
(
±2
);

149 
	`löëo3
(
±3
);

150 
	`löëo3
(
±0
);

151 
	}
}

154 
	$cú˛e3
(
vec1
 
r
)

156 
vec1
 
thëa
 = 0;

157 
vec1
 
thöc
 = 2*
pi
/100;

158 
i
;

159 
vec2
 
±
;

161 
±
.
x
 = 
r
;

162 
±
.
y
 = 0.0;

163 
	`movëo3
(
±
);

165 
i
=0; i<100; ++i) {

166 
thëa
 =Åhë®+ 
thöc
;

167 
±
.
x
 = 
r
*
	`cos
(
thëa
);

168 
±
.
y
 = 
r
*
	`sö
(
thëa
);

169 
	`löëo3
(
±
);

171 
	}
}

174 
	$daisy
(
vec1
 
r
,
poöts
)

176 
i
, 
j
;

177 
vec1
 
thëa
 = 0;

178 
vec1
 
thöc
;

179 
vec2
 
±
[100];

182 
thöc
 = 2*
pi
/
poöts
;

183 
i
=0; i<
poöts
; ++i) {

184 
±
[
i
].
x
 = 
r
*
	`cos
(
thëa
);

185 
±
[
i
].
y
 = 
r
*
	`sö
(
thëa
);

186 
thëa
 +
thöc
;

190 
i
=0; i<
poöts
-1; ++i) {

191 
j
=
i
+1; j<
poöts
; ++j) {

192 
	`movëo3
(
±
[
i
]);

193 
	`löëo3
(
±
[
j
]);

196 
	}
}

199 
	$ro£
(
vec1
 
r
,
Àvñs
,
poöts
)

201 
i
, 
j
, 
m
, 
n
;

202 
vec1
 
r1
, 
thëa
, 
thöc
;

203 
vec2
 
ö√r
[100];

204 
vec2
 
ouãr
[100];

205 
vec2
 
åüngÀ
[3];

207 
m
 = 
Àvñs
;

208 
n
 = 
poöts
;

209 
thöc
 = 2*
pi
/
n
;

212 
i
=0; i<
n
; ++i) {

213 
ö√r
[
i
].
x
 = 0.0;

214 
ö√r
[
i
].
y
 = 0.0;

218 
j
=1; j<=
m
; ++j) {

219 
thëa
 = -
j
*
pi
/
n
;

220 
r1
 = 
r
 * (
vec1
)
j
/
m
;

223 
i
=0; i<
n
; ++i) {

224 
thëa
 +
thöc
;

225 
ouãr
[
i
].
x
 = 
r1
*
	`cos
(
thëa
);

226 
ouãr
[
i
].
y
 = 
r1
*
	`sö
(
thëa
);

232 
i
=0; i<
n
; ++i) {

233 
åüngÀ
[0] = 
ouãr
[
i
];

234 
åüngÀ
[1] = 
ouãr
[(
i
+1Ë% 
n
];

235 
åüngÀ
[2] = 
ö√r
[
i
];

238 
	`£tcﬁ‹3
(
RED
);

239 
	`pﬁyfûl
(3, 
åüngÀ
);

243 
	`£tcﬁ‹3
(
WHITE
);

244 
	`movëo3
(
åüngÀ
[0]);

245 
	`löëo3
(
åüngÀ
[1]);

246 
	`löëo3
(
åüngÀ
[2]);

247 
	`löëo3
(
åüngÀ
[0]);

252 
i
=0; i<
n
; ++i)

253 
ö√r
[
i
] = 
ouãr
[i];

255 
	}
}

259 
	$åüngÀ
(
vec2
 
v0
, vec2 
v1
, vec2 
v2
)

261 
vec2
 
pﬁy
[3];

263 
pﬁy
[0] = 
v0
;

264 
pﬁy
[1] = 
v1
;

265 
pﬁy
[2] = 
v2
;

267 
	`£tcﬁ‹3
(
GREEN
);

268 
	`pﬁyfûl
(3, 
pﬁy
);

269 
	`£tcﬁ‹3
(
BLACK
);

270 
	`movëo3
(
pﬁy
[2]);

271 
	`löëo3
(
pﬁy
[0]);

272 
	`löëo3
(
pﬁy
[1]);

273 
	`löëo3
(
pﬁy
[2]);

274 
	}
}

278 
	$quadrû©îÆ
(
vec2
 
v0
, vec2 
v1
, vec2 
v2
, vec2 
v3
)

280 
vec2
 
pﬁy
[4];

282 
pﬁy
[0] = 
v0
;

283 
pﬁy
[1] = 
v1
;

284 
pﬁy
[2] = 
v2
;

285 
pﬁy
[3] = 
v3
;

286 
	`£tcﬁ‹3
(
GREEN
);

287 
	`pﬁyfûl
(4, 
pﬁy
);

288 
	`£tcﬁ‹3
(
BLACK
);

289 
	`movëo3
(
pﬁy
[3]);

290 
	`löëo3
(
pﬁy
[0]);

291 
	`löëo3
(
pﬁy
[1]);

292 
	`löëo3
(
pﬁy
[2]);

293 
	`löëo3
(
pﬁy
[3]);

294 
	}
}

298 
	$∑tch
(
vec2
 
v0
, vec2 
v1
, vec2 
v2
, vec2 
v3
)

300 
vec1
 
díom
;

301 
vec1
 
mu
;

302 
vec2
 
v4
;

304 
díom
 = (
v1
.
x
-
v0
.x)*(
v3
.
y
-
v2
.y) - (v1.y-v0.y)*(v3.x-v2.x);

305 if(
	`Ábs
(
díom
Ë> 
ïsû⁄
) {

306 
mu
 = ((
v2
.
x
-
v0
.x)*(
v3
.
y
-v2.yË- (v2.y-v0.y)*(v3.x-v2.x))/
díom
;

311 if(
mu
 >= 0 && mu <= 1) {

312 
v4
.
x
 = (1-
mu
)*
v0
.x + mu*
v1
.x;

313 
v4
.
y
 = (1-
mu
)*
v0
.y + mu*
v1
.y;

314 
	`åüngÀ
(
v0
, 
v2
, 
v4
);

315 
	`åüngÀ
(
v1
, 
v3
, 
v4
);

321 
díom
 = (
v2
.
x
-
v0
.x)*(
v3
.
y
-
v1
.y) - (v2.y-v0.y)*(v3.x-v1.x);

322 if(
	`Ábs
(
díom
Ë> 
ïsû⁄
) {

323 
mu
 = ((
v1
.
x
-
v0
.x)*(
v3
.
y
-v1.yË- (v1.y-v0.y)*(v3.x-v1.x))/
díom
;

328 if(
mu
 >= 0 && mu <= 1) {

329 
v4
.
x
 = (1-
mu
)*
v0
.x + mu*
v2
.x;

330 
v4
.
y
 = (1-
mu
)*
v0
.y + mu*
v2
.y;

331 
	`åüngÀ
(
v0
, 
v1
, 
v4
);

332 
	`åüngÀ
(
v2
, 
v3
, 
v4
);

338 
	`quadrû©îÆ
(
v0
, 
v1
, 
v3
, 
v2
);

340 
	}
}

343 
vec1


344 
	$∂Ÿ‚
(
vec1
 
x
, vec1 
z
)

346 
vec1
 
t
;

349 
t
 = 
	`sqπ
(
x
*x + 
z
*z);

350 if(
	`Ábs
(
t
Ë< 
ïsû⁄
)

352  4.0 * 
	`sö
(
t
) /Å;

353 
	}
}

357 
	$døwgrid
(
vec1
 
xmö
, vec1 
xmax
, 
nx
, vec1 
zmö
, vec1 
zmax
, 
nz
)

359 
i
, 
j
;

360 
vec1
 
xi
, 
x°ï
, 
yij
;

361 
vec1
 
zj
, 
z°ï
;

362 
vec2
 
v
[2][100];

363 
S
[5][5];

366 
	`sˇÀ3
(1.0/(
xmax
-
xmö
)*2, 1.0/(xmax-xmö)*2, 1.0/(
zmax
-
zmö
), 
S
);

367 
	`mu…3
(
Q
, 
S
, Q);

370 
x°ï
 = (
xmax
-
xmö
)/
nx
;

371 
z°ï
 = (
zmax
-
zmö
)/
nz
;

372 
xi
 = 
xmö
;

373 
zj
 = 
zmö
;

379 
i
=0; i<=
nx
; ++i) {

380 
yij
 = 
	`∂Ÿ‚
(
xi
, 
zj
);

381 
v
[0][
i
].
x
 = 
Q
[1][1]*
xi
 + Q[1][2]*
yij
 + Q[1][3]*
zj
;

382 
v
[0][
i
].
y
 = 
Q
[2][1]*
xi
 + Q[2][2]*
yij
 + Q[2][3]*
zj
;

383 
xi
 +
x°ï
;

387 
j
=0; j<
nz
; ++j) {

388 
xi
 = 
xmö
;

389 
zj
 +
z°ï
;

396 
i
=0; i<=
nx
; ++i) {

397 
yij
 = 
	`∂Ÿ‚
(
xi
, 
zj
);

398 
v
[1][
i
].
x
 = 
Q
[1][1]*
xi
 + Q[1][2]*
yij
 + Q[1][3]*
zj
;

399 
v
[1][
i
].
y
 = 
Q
[2][1]*
xi
 + Q[2][2]*
yij
 + Q[2][3]*
zj
;

400 
xi
 +
x°ï
;

404 
i
=0; i<
nx
; ++i)

405 
	`∑tch
(
v
[0][
i
], v[0][i+1], v[1][i], v[1][i+1]);

408 
i
=0; i<=
nx
; ++i)

409 
v
[0][
i
] = v[1][i];

411 
	}
}

416 
vec1


417 
	$™gÀ
(
vec1
 
x
, vec1 
y
)

419 if(
	`Ábs
(
x
Ë< 
ïsû⁄
)

420 if(
	`Ábs
(
y
Ë< 
ïsû⁄
)

423 if(
y
 > 0.0)

424  
pi
*0.5;

425  
pi
*1.5;

427 if(
x
 < 0.0)

428  
	`©™
(
y
/
x
Ë+ 
pi
;

429  
	`©™
(
y
/
x
);

430 
	}
}

437 
sˇÀ3
(
vec1
 
sx
, vec1 
sy
, vec1 
sz
, 
A
[][5])

439 
	gi
, 
	gj
;

441 
	gi
=1; i<5; ++i)

442 
	gj
=1; j<5; ++j)

443 
	gA
[
i
][
j
] = 0.0;

444 
	gA
[1][1] = 
sx
;

445 
	gA
[2][2] = 
sy
;

446 
	gA
[3][3] = 
sz
;

447 
	gA
[4][4] = 1.0;

454 
å™3
(
vec1
 
tx
, vec1 
ty
, vec1 
tz
, 
A
[][5])

456 
	gi
, 
	gj
;

458 
	gi
=1; i<5; ++i) {

459 
	gj
=1; j<5; ++j)

460 
	gA
[
i
][
j
] = 0.0;

461 
	gA
[
i
][i] = 1.0;

463 
	gA
[1][4] = -
tx
;

464 
	gA
[2][4] = -
ty
;

465 
	gA
[3][4] = -
tz
;

473 
rŸ3
(
m
, 
vec1
 
thëa
, 
A
[][5])

475 
	gi
, 
	gj
, 
	gm1
, 
	gm2
;

476 
vec1
 
	gc
, 
	gs
;

478 
	gi
=1; i<5; ++i)

479 
	gj
=1; j<5; ++j)

480 
	gA
[
i
][
j
] = 0.0;

481 
	gA
[
m
][m] = 1.0;

482 
	gA
[4][4] = 1.0;

483 
	gm1
 = (
m
 % 3) + 1;

484 
	gm2
 = (
m1
 % 3) + 1;

485 
	gc
 = 
cos
(
thëa
);

486 
	gs
 = 
sö
(
thëa
);

487 
	gA
[
m1
][m1] = 
c
;

488 
	gA
[
m2
][m2] = 
c
;

489 
	gA
[
m1
][
m2
] = 
s
;

490 
	gA
[
m2
][
m1
] = 
s
;

495 
mu…3
(
A
[][5], 
B
[][5], 
C
[][5])

497 
	gi
, 
	gj
, 
	gk
;

498 
vec1
 
	gab
;

500 
	gi
=1; i<5; ++i)

501 
	gj
=1; j<5; ++j) {

502 
	gab
 = 0;

503 
	gk
=1; k<5; ++k)

504 
	gab
 +
A
[
i
][
k
] * 
B
[k][
j
];

505 
	gC
[
i
][
j
] = 
ab
;

511 
	$födQ
()

513 
vec1
 
Æpha
, 
bëa
, 
gamma
, 
v
, 
w
;

514 
E
[5][5];

515 
F
[5][5];

516 
G
[5][5];

517 
H
[5][5];

518 
U
[5][5];

521 
	`å™3
(
eye
.
x
,Éye.
y
,Éye.
z
, 
F
);

524 
Æpha
 = 
	`™gÀ
(-
dúe˘
.
x
, -dúe˘.
y
);

525 
	`rŸ3
(3, 
Æpha
, 
G
);

528 
v
 = 
	`sqπ
(
dúe˘
.
x
*dúe˘.x + dúe˘.
y
*direct.y);

529 
bëa
 = 
	`™gÀ
(-
dúe˘
.
z
, 
v
);

530 
	`rŸ3
(2, 
bëa
, 
H
);

533 
w
 = 
	`sqπ
(
v
*v + 
dúe˘
.
z
*direct.z);

534 
gamma
 = 
	`™gÀ
(-
dúe˘
.
x
*
w
, dúe˘.
y
*dúe˘.
z
);

535 
	`rŸ3
(3, -
gamma
, 
U
);

538 
	`mu…3
(
G
, 
F
, 
Q
);

539 
	`mu…3
(
H
, 
Q
, 
E
);

540 
	`mu…3
(
U
, 
E
, 
Q
);

541 
	}
}

	@mwin/winlib/insetr.c

1 
	~"wödows.h
"

2 
	~"wötoﬁs.h
"

7 
WINAPI


8 
	$In£tR
(
LPRECT
 
Õrc
,
h
,
v
)

10 
Õrc
->
t›
 +
v
;

11 
Õrc
->
À·
 +
h
;

12 
Õrc
->
right
 -2*
h
-1;

13 
Õrc
->
bŸtom
 -2*
v
-1;

14 
	}
}

	@mwin/winlib/listbox.c

57 
	~<°dio.h
>

58 
	~<°dlib.h
>

59 
	~<°rög.h
>

60 
	#MWINCLUDECOLORS


	)

61 
	~"wödows.h
"

62 
	~"wötoﬁs.h
"

63 
	~"devi˚.h
"

65 
	#FixSåAŒoc
(
n
Ë
	`mÆloc
(“)+1)

	)

66 
	#FªeFixSå
(
p
Ë
	`‰ì
’)

	)

68 
	#LBIF_NORMAL
 0x0000L

	)

69 
	#LBIF_SELECTED
 0x0001L

	)

70 
	#LBIF_CHECKED
 0x0010L

	)

71 
	#LBIF_PARTCHECKED
 0x0020L

	)

72 
	#LBIF_CHECKMARKMASK
 0x00F0L

	)

74 
	#CMFLAG_BLANK
 0

	)

75 
	#CMFLAG_CHECKED
 1

	)

76 
	#CMFLAG_PARTCHECKED
 2

	)

77 
	s_LISTBOXITEMINFO
 {

78 
	mösPos
;

79 * 
	m°rög
;

80 
	mcmFœg
;

81 
HICON
 
	mhIc⁄
;

82 } 
	tLISTBOXITEMINFO
, *
	tPLISTBOXITEMINFO
;

84 
	s_LISTBOXITEM
 {

85 * 
	mkey
;

86 
DWORD
 
	mdwFœgs
;

87 
DWORD
 
	mdwD©a
;

88 
DWORD
 
	mdwAddD©a
;

89 
_LISTBOXITEM
* 
	m√xt
;

90 } 
	tLISTBOXITEM
, *
	tPLISTBOXITEM
;

92 
	#DEF_LB_BUFFER_LEN
 5

	)

94 
	#LBF_FOCUS
 0x0001

	)

95 
	#LBF_NOTHINGSELECTED
 0x0002

	)

97 
	s_LISTBOXDATA
 {

98 
DWORD
 
	mdwFœgs
;

100 
	môemCou¡
;

101 
	môemT›
;

102 
	môemVisibÀs
;

104 
	môemHûighãd
;

105 
	môemHeight
;

107 
LISTBOXITEM
* 
	mhód
;

109 
	mbuffLí
;

110 
LISTBOXITEM
* 
	mbuffSèπ
;

111 
LISTBOXITEM
* 
	mbuffEnd
;

112 
LISTBOXITEM
* 
	m‰ìLi°
;

113 } 
	tLISTBOXDATA
, *
	tPLISTBOXDATA
;

115 
Li°boxC⁄åﬁCÀ™up
 ();

116 
LRESULT
 
CALLBACK


117 
Li°boxCålProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

119 
	#ITEM_BOTTOM
(
x
Ë(x->
ôemT›
 + x->
ôemVisibÀs
 - 1)

	)

121 
	#LST_WIDTH_CHECKMARK
 11

	)

122 
	#LST_HEIGHT_CHECKMARK
 11

	)

123 
	#LST_INTER_BMPTEXT
 2

	)

125 
WINAPI
 
	$MwRegi°îLi°boxC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

127 
WNDCLASS
 
wc
;

129 
BITMAP
 
sg_bmpCheckM¨k
;

130 i‡(!
	`LﬂdSy°emBôm≠
 (&
sg_bmpCheckM¨k
, "checkmark")) {

131 
	`Ârötf
 (
°dîr
, "Load ListBox Check Mark Bitmap failure!\n");

132  
FALSE
;

135 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

136 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
Li°boxCålProc
;

137 
wc
.
cbClsExåa
 = 0;

138 
wc
.
cbWndExåa
 = 0;

139 
wc
.
hIn°™˚
 = hInstance;

140 
wc
.
hIc⁄
 = 
NULL
;

141 
wc
.
hCurs‹
 = 0;

142 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

143 
wc
.
ÕszMíuName
 = 
NULL
;

144 
wc
.
ÕszCœssName
= "LISTBOX";

146  
	`Regi°îCœss
(&
wc
);

147 
	}
}

149 
	$Li°boxC⁄åﬁCÀ™up
 ()

152 
	`U∆ﬂdBôm≠
 (&
sg_bmpCheckM¨k
);

154 
	}
}

156 
LRESULT
 
	$NŸifyP¨ít
 (
HWND
 
hwnd
, 
id
, 
code
)

158  
	`SídMesßge
 (
	`GëP¨ít
 (
hwnd
), 
WM_COMMAND
,

159 (
WPARAM
Ë
	`MAKELONG
 (
id
, 
code
), (
LPARAM
)
hwnd
);

160 
	}
}

162 
BOOL
 
	$l°InôLi°BoxD©a
 (
HWND
 
hwnd
,
LISTBOXDATA
* 
pD©a
, 
Àn
)

164 
i
, 
xw
, 
xh
, 
xb
;

165 
PLISTBOXITEM
 
∂bi
;

166 
HDC
 
hdc
;

168 
	`mem£t
 (
pD©a
, 0,  (
LISTBOXDATA
));

170 
pD©a
->
ôemHeight
 = 
	`GëSysCh¨Height
 ();

172 
hdc
=
	`GëDC
(
hwnd
);

173 #i‡
MWCLIENT


174 
	`GrSëGCF⁄t
(
hdc
->
gc
,hdc->
f⁄t
->
f⁄tid
);

175 
	`GrGëGCTextSize
(
hdc
->
gc
,"X",1,

176 
MWTF_ASCII
,&
xw
,&
xh
,&
xb
);

178 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

179 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1,

180 &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

182 
	`Rñó£DC
(
hwnd
,
hdc
);

183 
pD©a
->
ôemHeight
=
xh
 + 1;

185 
pD©a
->
ôemHûighãd
 = 0;

186 
pD©a
->
dwFœgs
 = 
LBF_NOTHINGSELECTED
;

189 i‡(!(
pD©a
->
buffSèπ
 = 
	`mÆloc
 (
Àn
 *  (
LISTBOXITEM
))))

190  
FALSE
;

192 
pD©a
->
buffLí
 = 
Àn
;

193 
pD©a
->
buffEnd
 =ÖD©a->
buffSèπ
 + 
Àn
;

194 
pD©a
->
‰ìLi°
 =ÖD©a->
buffSèπ
;

196 
∂bi
 = 
pD©a
->
‰ìLi°
;

197 
i
 = 0; i < 
Àn
 - 1; i++) {

198 
∂bi
->
√xt
 =Ölbi + 1;

199 
∂bi
 ++;

201 
∂bi
->
√xt
 = 
NULL
;

203  
TRUE
;

204 
	}
}

206 
	$l°Li°BoxCÀ™Up
 (
LISTBOXDATA
* 
pD©a
)

208 
PLISTBOXITEM
 
∂bi
;

209 
PLISTBOXITEM
 
√xt
;

211 
∂bi
 = 
pD©a
->
hód
;

212 
∂bi
) {

213 
	`FªeFixSå
 (
∂bi
->
key
);

214 
√xt
 = 
∂bi
->next;

215 i‡(
∂bi
 < 
pD©a
->
buffSèπ
 ||Ölbò>ÖD©a->
buffEnd
)

216 
	`‰ì
 (
∂bi
);

218 
∂bi
 = 
√xt
;

221 
	`‰ì
 (
pD©a
->
buffSèπ
);

222 
	}
}

224 
	$l°Re£tLi°BoxC⁄ã¡
 (
PLISTBOXDATA
 
pD©a
)

226 
i
;

227 
PLISTBOXITEM
 
∂bi
, 
√xt
;

229 
pD©a
->
ôemCou¡
 = 0;

230 
pD©a
->
ôemT›
 = 0;

231 
pD©a
->
ôemHûighãd
 = 0;

233 
pD©a
->
ôemVisibÀs
 = 0;

236 
∂bi
 = 
pD©a
->
hód
;

237 
∂bi
) {

238 
	`FªeFixSå
 (
∂bi
->
key
);

239 
√xt
 = 
∂bi
->next;

240 i‡(
∂bi
 < 
pD©a
->
buffSèπ
 ||Ölbò>ÖD©a->
buffEnd
)

241 
	`‰ì
 (
∂bi
);

243 
∂bi
 = 
√xt
;

246 
pD©a
->
hód
 = 
NULL
;

247 
pD©a
->
‰ìLi°
 =ÖD©a->
buffSèπ
;

249 
∂bi
 = 
pD©a
->
‰ìLi°
;

250 
i
 = 0; i < 
pD©a
->
buffLí
 - 1; i++) {

251 
∂bi
->
√xt
 =Ölbi + 1;

252 
∂bi
 ++;

254 
∂bi
->
√xt
 = 
NULL
;

255 
	}
}

257 
PLISTBOXITEM
 
	$l°AŒocIãm
 (
PLISTBOXDATA
 
pD©a
)

259 
PLISTBOXITEM
 
∂bi
;

261 i‡(
pD©a
->
‰ìLi°
) {

262 
∂bi
 = 
pD©a
->
‰ìLi°
;

263 
pD©a
->
‰ìLi°
 = 
∂bi
->
√xt
;

266 
∂bi
 = (
PLISTBOXITEM
Ë
	`mÆloc
 ( (
LISTBOXITEM
));

268  
∂bi
;

269 
	}
}

271 
	$l°FªeIãm
 (
PLISTBOXDATA
 
pD©a
, 
PLISTBOXITEM
 
∂bi
)

273 i‡(
∂bi
 < 
pD©a
->
buffSèπ
 ||Ölbò>ÖD©a->
buffEnd
)

274 
	`‰ì
 (
∂bi
);

276 
∂bi
->
√xt
 = 
pD©a
->
‰ìLi°
;

277 
pD©a
->
‰ìLi°
 = 
∂bi
;

279 
	}
}

281 
	$l°AddNewIãm
 (
DWORD
 
dwStyÀ
,

282 
PLISTBOXDATA
 
pD©a
, 
PLISTBOXITEM
 
√wIãm
, 
pos
)

284 
PLISTBOXITEM
 
∂bi
;

285 
PLISTBOXITEM
 
ösPosIãm
 = 
NULL
;

286 
ösPos
 = 0;

288 
√wIãm
->
√xt
 = 
NULL
;

289 i‡(!
pD©a
->
hód
)

290 
ösPosIãm
 = 
NULL
;

291 i‡(
dwStyÀ
 & 
LBS_SORT
) {

292 
∂bi
 = 
pD©a
->
hód
;

294 i‡(
	`°rcmp
 (
√wIãm
->
key
, 
∂bi
->key) < 0) {

295 
ösPosIãm
 = 
NULL
;

296 
ösPos
 = 0;

299 
∂bi
->
√xt
) {

300 i‡(
	`°rcmp
 (
√wIãm
->
key
, 
∂bi
->
√xt
->key) <= 0)

303 
∂bi
 =Ölbi->
√xt
;

304 
ösPos
 ++;

306 
ösPosIãm
 = 
∂bi
;

310 
∂bi
 = 
pD©a
->
hód
;

312 i‡(
pos
 < 0) {

313 
∂bi
->
√xt
) {

314 
∂bi
 =Ölbi->
√xt
;

315 
ösPos
 ++;

317 
ösPosIãm
 = 
∂bi
;

319 i‡(
pos
 > 0) {

320 
ödex
 = 0;

322 
∂bi
->
√xt
) {

323 i‡(
pos
 =
ödex
)

325 
∂bi
 =Ölbi->
√xt
;

326 
ödex
 ++;

327 
ösPos
 ++;

329 
ösPosIãm
 = 
∂bi
;

333 i‡(
ösPosIãm
) {

334 
∂bi
 = 
ösPosIãm
->
√xt
;

335 
ösPosIãm
->
√xt
 = 
√wIãm
;

336 
√wIãm
->
√xt
 = 
∂bi
;

338 
ösPos
 ++;

341 
∂bi
 = 
pD©a
->
hód
;

342 
pD©a
->
hód
 = 
√wIãm
;

343 
√wIãm
->
√xt
 = 
∂bi
;

346 
pD©a
->
ôemCou¡
 ++;

347  
ösPos
;

348 
	}
}

350 
PLISTBOXITEM
 
	$l°RemoveIãm
 (
PLISTBOXDATA
 
pD©a
, * 
pos
)

352 
ödex
 = 0;

353 
PLISTBOXITEM
 
∂bi
, 
¥ev
;

355 i‡(!
pD©a
->
hód
)

356  
NULL
;

358 i‡(*
pos
 < 0) {

359 
¥ev
 = 
pD©a
->
hód
;

360 
∂bi
 = 
pD©a
->
hód
;

361 
∂bi
->
√xt
) {

362 
¥ev
 = 
∂bi
;

363 
∂bi
 =Ölbi->
√xt
;

364 
ödex
 ++;

367 i‡(
∂bi
 =
pD©a
->
hód
) {

368 
pD©a
->
hód
 =ÖD©a->hód->
√xt
;

369 *
pos
 = 0;

370  
∂bi
;

373 
¥ev
->
√xt
 = 
∂bi
->next;

374 *
pos
 = 
ödex
;

375  
∂bi
;

378 i‡(*
pos
 == 0) {

379 
∂bi
 = 
pD©a
->
hód
;

380 
pD©a
->
hód
 = 
∂bi
->
√xt
;

381  
∂bi
;

384 
ödex
 = 0;

385 
¥ev
 = 
pD©a
->
hód
;

386 
∂bi
 = 
pD©a
->
hód
;

387 
∂bi
->
√xt
) {

388 i‡(*
pos
 =
ödex
)

391 
¥ev
 = 
∂bi
;

392 
∂bi
 =Ölbi->
√xt
;

393 
ödex
 ++;

396 i‡(
∂bi
 =
pD©a
->
hód
) {

397 
pD©a
->
hód
 =ÖD©a->hód->
√xt
;

398 *
pos
 = 0;

399  
∂bi
;

402 
¥ev
->
√xt
 = 
∂bi
->next;

403 *
pos
 = 
ödex
;

404  
∂bi
;

408  
NULL
;

409 
	}
}

411 
	$l°GëIãmsRe˘
 (
PLISTBOXDATA
 
pD©a
, 
°¨t
, 
íd
, 
RECT
* 
¥c
)

413 i‡(
°¨t
 < 0)

414 
°¨t
 = 0;

416 
¥c
->
t›
 = (
°¨t
 - 
pD©a
->
ôemT›
)*pD©a->
ôemHeight
;

418 i‡(
íd
 >= 0)

419 
¥c
->
bŸtom
 = (
íd
 - 
pD©a
->
ôemT›
 + 1)*pD©a->
ôemHeight
;

421 
	}
}

423 
	$l°InvÆid©eIãm
 (
HWND
 
hwnd
, 
PLISTBOXDATA
 
pD©a
, 
pos
,
BOOL
 
fEBk
)

425 
RECT
 
rcInv
;

427 i‡(
pos
 < 
pD©a
->
ôemT›
 ||Öo†> (pD©a->ôemT› +ÖD©a->
ôemVisibÀs
))

430 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

431 
rcInv
.
t›
 = (
pos
 - 
pD©a
->
ôemT›
)*pD©a->
ôemHeight
;

432 
rcInv
.
bŸtom
 =ÑcInv.
t›
 + 
pD©a
->
ôemHeight
;

434 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
fEBk
);

435 
	}
}

437 
BOOL
 
	$l°InvÆid©eUndîIãm
 (
HWND
 
hwnd
, 
PLISTBOXDATA
 
pD©a
, 
pos
)

439 
RECT
 
rcInv
;

441 i‡(
pos
 > (
pD©a
->
ôemT›
 +ÖD©a->
ôemVisibÀs
))

442  
FALSE
;

444 i‡(
pos
 <
pD©a
->
ôemT›
) {

445 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

446  
TRUE
;

449 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

451 
	`l°GëIãmsRe˘
 (
pD©a
, 
pos
, -1, &
rcInv
);

453 i‡(
rcInv
.
t›
 <ÑcInv.
bŸtom
)

454 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

456  
TRUE
;

457 
	}
}

459 
PLISTBOXITEM
 
	$l°GëIãm
 (
PLISTBOXDATA
 
pD©a
, 
pos
)

461 
i
;

462 
PLISTBOXITEM
 
∂bi
;

464 
∂bi
 = 
pD©a
->
hód
;

465 
i
=0; i < 
pos
 && 
∂bi
; i++)

466 
∂bi
 =Ölbi->
√xt
;

468  
∂bi
;

469 
	}
}

471 
	$l°FödIãm
 (
PLISTBOXDATA
 
pD©a
, 
°¨t
, * 
key
, 
BOOL
 
bExa˘
)

473 
PLISTBOXITEM
 
∂bi
;

474 
keyÀn
 = 
	`°æí
 (
key
);

476 i‡(
°¨t
 >(
pD©a
->
ôemCou¡
 - 1))

477 
°¨t
 = 0;

479 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, 
°¨t
);

481 
∂bi
)

483 i‡(
bExa˘
 && (
keyÀn
 !
	`°æí
 (
∂bi
->
key
))) {

484 
∂bi
 =Ölbi->
√xt
;

485 
°¨t
 ++;

489 i‡(
	`°∫ˇ£cmp
 (
key
, 
∂bi
->key, 
keyÀn
) == 0)

490  
°¨t
;

492 
∂bi
 =Ölbi->
√xt
;

493 
°¨t
 ++;

496  
LB_ERR
;

497 
	}
}

499 
	$l°OnDøwSLi°BoxIãms
 (
HDC
 
hdc
, 
DWORD
 
dwStyÀ
,

500 
PLISTBOXDATA
 
pD©a
, 
width
)

502 
PLISTBOXITEM
 
∂bi
;

503 
i
;

504 
x
 = 0, 
y
 = 0;

505 
off£t
;

506 
RECT
 
rc
;

507 
COLORREF
 
bk
;

509 
∂bi
 = 
	`l°GëIãm
 (
pD©a
,ÖD©a->
ôemT›
);

511 
i
 = 0; 
∂bi
 && i < (
pD©a
->
ôemVisibÀs
 + 1); i++) {

513 i‡(
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
) {

514 
	`SëBkCﬁ‹
 (
hdc
, 
bk
 = 
BLUE
);

515 
	`SëTextCﬁ‹
 (
hdc
, 
WHITE
);

518 
	`SëBkCﬁ‹
 (
hdc
, 
bk
 = 
WHITE
);

519 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
);

521 
rc
.
À·
 = 0;

522 
rc
.
t›
 = 
y
;

523 
rc
.
right
 = 
width
;

524 
rc
.
bŸtom
 = 
y
 + 
pD©a
->
ôemHeight
;

525 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
bk
);

527 i‡(
dwStyÀ
 & 
LBS_CHECKBOX
) {

528 
x
 = 
LST_INTER_BMPTEXT
;

529 i‡(
∂bi
->
dwFœgs
 & 
LBIF_CHECKED
)

530 
off£t
 = 0;

531 i‡(
∂bi
->
dwFœgs
 & 
LBIF_PARTCHECKED
)

532 
off£t
 = 
LST_WIDTH_CHECKMARK
 << 1;

534 
off£t
 = 
LST_WIDTH_CHECKMARK
;

536 
	`FûlBoxWôhBôm≠P¨t
 (
hdc
,

537 
x
, 
y
 + ((
pD©a
->
ôemHeight
 - 
LST_HEIGHT_CHECKMARK
)>>1),

538 
LST_WIDTH_CHECKMARK
, 
LST_HEIGHT_CHECKMARK
,

540 &
sg_bmpCheckM¨k
,

541 
off£t
, 0);

543 
x
 +
LST_WIDTH_CHECKMARK
 + 
LST_INTER_BMPTEXT
;

546 i‡(
dwStyÀ
 & 
LBS_USEICON
 && 
∂bi
->
dwD©a
) {

547 
	`DøwIc⁄
 (
hdc
,

548 
x
, 
y
, 
pD©a
->
ôemHeight
,ÖData->itemHeight,

549 (
HICON
Ë
∂bi
->
dwD©a
);

550 
x
 +
pD©a
->
ôemHeight
 + 
LST_INTER_BMPTEXT
;

556 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

558 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
SYSTEM_FIXED_FONT
));

559 
	`TextOut
 (
hdc
, 
x
+2, 
y
, 
∂bi
->
key
,-1);

561 
y
 +
pD©a
->
ôemHeight
;

562 
∂bi
 =Ölbi->
√xt
;

564 
	}
}

566 
	$l°Sñe˘Iãm
 (
DWORD
 
dwStyÀ
, 
PLISTBOXDATA
 
pD©a
, 
√wSñ
)

568 
PLISTBOXITEM
 
∂bi
, 
√wIãm
;

569 
ödex
;

571 
√wIãm
 = 
	`l°GëIãm
 (
pD©a
, 
√wSñ
);

573 i‡(!
√wIãm
)  -1;

575 #ifde‡
_DEBUG


576 i‡(!
√wIãm
)

577 
	`Ârötf
 (
°dîr
, "ASSERT failed:Ñeturn value ofÜstGetItem"

581 i‡(
dwStyÀ
 & 
LBS_MULTIPLESEL
) {

582 
√wIãm
->
dwFœgs
 ^
LBIF_SELECTED
;

583  
√wSñ
;

586 
ödex
 = 0;

587 
∂bi
 = 
pD©a
->
hód
;

588 
∂bi
) {

589 i‡(
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
) {

590 i‡(
ödex
 !
√wSñ
) {

591 
∂bi
->
dwFœgs
 &~
LBIF_SELECTED
;

592 
√wIãm
->
dwFœgs
 |
LBIF_SELECTED
;

593  
ödex
;

598 
∂bi
 =Ölbi->
√xt
;

599 
ödex
 ++;

602 
√wIãm
->
dwFœgs
 |
LBIF_SELECTED
;

604 
	}
}

606 
	$l°DøwFocusRe˘
 (
HDC
 
hdc
, 
PLISTBOXDATA
 
pD©a
, 
RECT
* 
rc
)

608 
HGDIOBJ
 
ﬁdbrush
,
ﬁd≥n
;

610 i‡(
pD©a
->
ôemHûighãd
 <ÖD©a->
ôemT›


611 || 
pD©a
->
ôemHûighãd
 > (pD©a->
ôemT›
 +ÖD©a->
ôemVisibÀs
))

614 i‡(
pD©a
->
dwFœgs
 & 
LBF_FOCUS
) {

615 
	`l°GëIãmsRe˘
 (
pD©a
,ÖD©a->
ôemHûighãd
,ÖD©a->ôemHûighãd, 
rc
);

617 
	`InÊ©eRe˘
 (
rc
, -1, -1);

619 
	`FocusRe˘
 (
hdc
, 
rc
->
À·
 - 1,Ñc->
t›
,Ñc->
right
,Ñc->
bŸtom
);

621 
ﬁdbrush
=
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
NULL_BRUSH
));

622 
ﬁd≥n
=
	`Sñe˘Obje˘
(
hdc
, 
	`Cª©ePí
(
PS_SOLID
, 1,

623 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
)));

625 
	`GdSëMode
(
MWMODE_XOR
);

627 
	`Re˘™gÀ
 (
hdc
, 
rc
->
À·
,Ñc->
t›
,Ñc->
right
,Ñc->
bŸtom
);

629 
	`GdSëMode
(
MWMODE_SET
);

631 
	`Sñe˘Obje˘
(
hdc
,
ﬁdbrush
);

632 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
,
ﬁd≥n
));

635 
	}
}

637 
	$l°CÆcP¨ams
 (c⁄° 
RECT
* 
rcClõ¡
, 
PLISTBOXDATA
 
pD©a
)

639 
	#RECTHP
(
¥c
Ë’rc->
bŸtom
 -Örc->
t›
)

	)

640 
pD©a
->
ôemVisibÀs
 = (
	`RECTHP
 (
rcClõ¡
)Ë/ÖD©a->
ôemHeight
;

643 if–((
	`RECTHP
 (
rcClõ¡
)Ë% 
pD©a
->
ôemHeight
) )

644 
pD©a
->
ôemVisibÀs
++;

646 
	}
}

648 
BOOL
 
SëS¸ﬁlPos
 (
HWND
 
hWnd
, 
iSB¨
, 
iNewPos
);

649 
BOOL
 
E«bÀS¸ﬁlB¨
 (
HWND
 
hWnd
, 
iSB¨
, BOOL 
bE«bÀ
);

651 
	$l°SëVS¸ﬁlInfo
 (
HWND
 
hwnd
, 
PLISTBOXDATA
 
pD©a
, 
BOOL
 
fRedøw
)

653 
SCROLLINFO
 
si
;

655 i‡(
pD©a
->
ôemVisibÀs
 >pD©a->
ôemCou¡
)

657 
	`SëS¸ﬁlPos
 (
hwnd
, 
SB_VERT
, 0);

658 
	`E«bÀS¸ﬁlB¨
 (
hwnd
, 
SB_VERT
, 
FALSE
);

662 
si
.
fMask
 = 
SIF_RANGE
 | 
SIF_PAGE
 | 
SIF_POS
;

663 
si
.
nMax
 = 
pD©a
->
ôemCou¡
 - 1;

664 
si
.
nMö
 = 0;

665 
si
.
nPage
 = 
	`mö
 (
pD©a
->
ôemVisibÀs
, (pD©a->
ôemCou¡
 -ÖD©a->
ôemT›
));

666 
si
.
nPos
 = 
pD©a
->
ôemT›
;

668 
	`SëS¸ﬁlInfo
 (
hwnd
, 
SB_VERT
, &
si
, 
fRedøw
);

669 
	`E«bÀS¸ﬁlB¨
 (
hwnd
, 
SB_VERT
, 
TRUE
);

670 
	}
}

672 
LRESULT
 
CALLBACK


673 
	$Li°boxCålProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

675 
HDC
 
hdc
;

676 
HWND
 
pCål
;

677 
PLISTBOXDATA
 
pD©a
;

678 
DWORD
 
dwStyÀ
;

680 
pCål
 = 
hwnd
;

681 
dwStyÀ
 = 
pCål
->
°yÀ
;

683 
mesßge
)

685 
WM_CREATE
:

686 
pD©a
 = (
LISTBOXDATA
*Ë
	`mÆloc
 ((LISTBOXDATA));

687 i‡(
pD©a
 =
NULL
)

690 
pCål
->
u£rd©a
 = (
DWORD
)
pD©a
;

691 i‡(!
	`l°InôLi°BoxD©a
 (
hwnd
, 
pD©a
, 
DEF_LB_BUFFER_LEN
)) {

692 
	`‰ì
 (
pD©a
);

697 
WM_SIZE
:

699 
RECT
 
rc
;

701 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

702 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

703 
	`l°CÆcP¨ams
 (&
rc
, 
pD©a
);

707 
WM_DESTROY
:

708 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

709 
	`l°Li°BoxCÀ™Up
 (
pD©a
);

710 
	`‰ì
 (
pD©a
);

713 
LB_RESETCONTENT
:

714 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

715 
	`l°Re£tLi°BoxC⁄ã¡
 (
pD©a
);

716 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

719 
LB_ADDSTRING
:

720 
LB_INSERTSTRING
:

722 * 
°rög
 = 
NULL
;

723 
PLISTBOXITEMINFO
 
∂bii
 = 
NULL
;

724 
PLISTBOXITEM
 
√wIãm
;

725 
pos
;

727 i‡(
dwStyÀ
 & 
LBS_CHECKBOX
 || dwStyÀ & 
LBS_USEICON
) {

728 
∂bii
 = (
PLISTBOXITEMINFO
)
lP¨am
;

729 i‡(!
∂bii
)

730  
LB_ERR
;

732 
°rög
 = 
∂bii
->string;

735 
°rög
 = (*)
lP¨am
;

736 i‡(
°rög
 =
NULL
 || string [0] == '\0')

737  
LB_ERR
;

740 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

741 
√wIãm
 = 
	`l°AŒocIãm
 (
pD©a
);

742 i‡(!
√wIãm
) {

743 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_ERRSPACE
);

744  
LB_ERRSPACE
;

747 
√wIãm
->
key
 = 
	`FixSåAŒoc
 (
	`°æí
 (
°rög
));

748 
	`°r˝y
 (
√wIãm
->
key
, 
°rög
);

749 
√wIãm
->
dwFœgs
 = 
LBIF_NORMAL
;

750 i‡(
∂bii
) {

751 
∂bii
->
cmFœg
) {

752 
CMFLAG_CHECKED
:

753 
√wIãm
->
dwFœgs
 |
LBIF_CHECKED
;

755 
CMFLAG_PARTCHECKED
:

756 
√wIãm
->
dwFœgs
 |
LBIF_PARTCHECKED
;

760 i‡(
dwStyÀ
 & 
LBS_USEICON
)

761 
√wIãm
->
dwD©a
 = (
DWORD
)
∂bii
->
hIc⁄
;

763 
√wIãm
->
dwD©a
 = 0L;

765 
√wIãm
->
dwAddD©a
 = 0L;

767 i‡(
mesßge
 =
LB_ADDSTRING
)

768 
pos
 = 
	`l°AddNewIãm
 (
dwStyÀ
, 
pD©a
, 
√wIãm
, -1);

770 
pos
 = 
	`l°AddNewIãm
 (
dwStyÀ
, 
pD©a
, 
√wIãm
, ()
wP¨am
);

772 
	`l°InvÆid©eUndîIãm
 (
hwnd
, 
pD©a
, 
pos
);

774 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

776  
pos
;

780 
LB_DELETESTRING
:

782 
PLISTBOXITEM
 
ªmoved
;

783 
dñëe
;

785 
dñëe
 = ()
wP¨am
;

787 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

788 
ªmoved
 = 
	`l°RemoveIãm
 (
pD©a
, &
dñëe
);

789 i‡(
ªmoved
) {

790 
	`FªeFixSå
 (
ªmoved
->
key
);

791 
	`l°FªeIãm
 (
pD©a
, 
ªmoved
);

793 
pD©a
->
ôemCou¡
 --;

795 i‡(
pD©a
->
ôemT›
 != 0

796 && 
pD©a
->
ôemCou¡
 <pD©a->
ôemVisibÀs
) {

797 
pD©a
->
ôemT›
 = 0;

798 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

801 
	`l°InvÆid©eUndîIãm
 (
hwnd
, 
pD©a
, 
dñëe
);

802 i‡(
dñëe
 <
pD©a
->
ôemT›
) {

803 
pD©a
->
ôemT›
 --;

804 i‡(
pD©a
->
ôemT›
 < 0)

805 
pD©a
->
ôemT›
 = 0;

809 i‡(
pD©a
->
ôemHûighãd
 >pD©a->
ôemCou¡
) {

810 
pD©a
->
ôemHûighãd
 =ÖD©a->
ôemCou¡
 - 1;

811 i‡(
pD©a
->
ôemHûighãd
 < 0)

812 
pD©a
->
ôemHûighãd
 = 0;

815 i‡(
pD©a
->
ôemHûighãd
 <ÖD©a->
ôemT›
)

816 
pD©a
->
ôemHûighãd
 =ÖD©a->
ôemT›
;

817 i‡(
pD©a
->
ôemHûighãd
 > 
	`ITEM_BOTTOM
 (pData))

818 
pD©a
->
ôemHûighãd
 = 
	`ITEM_BOTTOM
 (pData);

820 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

825 
LB_FINDSTRING
:

826 if–*(*)
lP¨am
 == '\0' )

827  
LB_ERR
;

829 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

830  
	`l°FödIãm
(
pD©a
, ()
wP¨am
, (*)
lP¨am
, 
FALSE
);

832 
LB_FINDSTRINGEXACT
:

833 if–*(*)
lP¨am
 == '\0' )

834  
LB_ERR
;

836 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

837  
	`l°FödIãm
(
pD©a
, ()
wP¨am
, (*)
lP¨am
, 
TRUE
);

839 
LB_SETTOPINDEX
:

841 
√wT›
 = (Ë
wP¨am
;

843 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

845 i‡(
√wT›
 <0)

846 
√wT›
 = 0;

847 i‡(
√wT›
 > 
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
)

848 
√wT›
 = 
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
;

850 i‡(
pD©a
->
ôemT›
 !
√wT›
) {

851 
pD©a
->
ôemT›
 = 
√wT›
;

853 i‡(
pD©a
->
ôemHûighãd
 <ÖD©a->
ôemT›
)

854 
pD©a
->
ôemHûighãd
 =ÖD©a->
ôemT›
;

855 i‡(
pD©a
->
ôemHûighãd
 > 
	`ITEM_BOTTOM
 (pData))

856 
pD©a
->
ôemHûighãd
 = 
	`ITEM_BOTTOM
 (pData);

858 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

860 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

865 
LB_SETCURSEL
:

866 
LB_SETCARETINDEX
:

868 
√w
 = ()
wP¨am
;

869 
ﬁd
, 
√wT›
;

871 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

872 i‡(
√w
 < 0 ||Çew > 
pD©a
->
ôemCou¡
 - 1)

873  
LB_ERR
;

875 
ﬁd
 = 
pD©a
->
ôemHûighãd
;

876 i‡(
√w
 >0 &&Çew !
ﬁd
) {

877 i‡(
pD©a
->
ôemCou¡
 - 
√w
 >pD©a->
ôemVisibÀs
)

878 
√wT›
 = 
√w
;

880 
√wT›
 = 
	`max
 (
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
, 0);

882 
pD©a
->
ôemT›
 = 
√wT›
;

883 
pD©a
->
ôemHûighãd
 = 
√w
;

884 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

887 i‡(!(
dwStyÀ
 & 
LBS_MULTIPLESEL
))

888 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
, 
√w
);

889 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

891  
ﬁd
;

895 
LB_GETCOUNT
:

896 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

897  
pD©a
->
ôemCou¡
;

900 
LB_GETCURSEL
:

902 
PLISTBOXITEM
 
∂bi
;

903 
ödex
 = 0;

905 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

906 i‡(
dwStyÀ
 & 
LBS_MULTIPLESEL
)

907  
pD©a
->
ôemHûighãd
;

909 
∂bi
 = 
pD©a
->
hód
;

910 
∂bi
) {

911 i‡(
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
)

912  
ödex
;

914 
ödex
 ++;

915 
∂bi
 =Ölbi->
√xt
;

918  
LB_ERR
;

922 
LB_GETSELCOUNT
:

924 
nSñ
;

925 
PLISTBOXITEM
 
∂bi
;

927 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

929 
nSñ
 = 0;

930 
∂bi
 = 
pD©a
->
hód
;

931 
∂bi
) {

932 i‡(
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
)

933 
nSñ
 ++;

934 
∂bi
 =Ölbi->
√xt
;

937  
nSñ
;

941 
LB_GETTOPINDEX
:

942 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

943  
pD©a
->
ôemT›
;

946 
LB_GETCARETINDEX
:

947 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

948  
pD©a
->
ôemHûighãd
;

951 
LB_GETTEXTLEN
:

953 
PLISTBOXITEM
 
∂bi
;

955 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

956 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
);

957 i‡(
∂bi
)

958  
	`°æí
 (
∂bi
->
key
);

960  
LB_ERR
;

964 
LB_GETTEXT
:

966 
PLISTBOXITEM
 
∂bi
;

968 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

969 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
);

970 i‡(
∂bi
)

971 
	`°r˝y
 ((*)
lP¨am
, 
∂bi
->
key
);

973  
LB_ERR
;

977 
LB_SETTEXT
:

979 
PLISTBOXITEM
 
∂bi
;

980 * 
√wSå
;

982 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

983 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
);

984 i‡(
∂bi
) {

985 
√wSå
 = 
	`FixSåAŒoc
 (
	`°æí
 ((*)
lP¨am
));

986 i‡(
√wSå
) {

987 
	`FªeFixSå
 (
∂bi
->
key
);

988 
∂bi
->
key
 = 
√wSå
;

989 
	`°r˝y
 (
∂bi
->
key
, (*)
lP¨am
);

990 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
, ()
wP¨am
, 
TRUE
);

993  
LB_ERR
;

996  
LB_ERR
;

1000 
LB_GETITEMDATA
:

1002 
PLISTBOXITEM
 
∂bi
;

1003 
PLISTBOXITEMINFO
 
∂bii
;

1005 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1006 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1007  
LB_ERR
;

1009 i‡(!(
dwStyÀ
 & 
LBS_CHECKBOX
 || dwStyÀ & 
LBS_USEICON
)) {

1010  
∂bi
->
dwD©a
;

1013 
∂bii
 = (
PLISTBOXITEMINFO
)
lP¨am
;

1014 i‡(!
∂bii
)

1015  
LB_ERR
;

1017 i‡(
∂bi
->
dwFœgs
 & 
LBIF_CHECKED
)

1018 
∂bii
->
cmFœg
 = 
CMFLAG_CHECKED
;

1019 i‡(
∂bi
->
dwFœgs
 & 
LBIF_PARTCHECKED
)

1020 
∂bii
->
cmFœg
 = 
CMFLAG_PARTCHECKED
;

1022 
∂bii
->
cmFœg
 = 
CMFLAG_BLANK
;

1023 
∂bii
->
hIc⁄
 = (
HICON
)
∂bi
->
dwD©a
;

1025  
LB_OKAY
;

1029 
LB_SETITEMDATA
:

1031 
PLISTBOXITEM
 
∂bi
;

1032 
PLISTBOXITEMINFO
 
∂bii
;

1034 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1035 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1036  
LB_ERR
;

1038 i‡(!(
dwStyÀ
 & 
LBS_CHECKBOX
 || dwStyÀ & 
LBS_USEICON
)) {

1039 
∂bi
->
dwD©a
 = (
DWORD
)
lP¨am
;

1040  
LB_OKAY
;

1043 
∂bii
 = (
PLISTBOXITEMINFO
)
lP¨am
;

1044 i‡(!
∂bii
)

1045  
LB_ERR
;

1047 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1048 
∂bii
->
cmFœg
) {

1049 
CMFLAG_CHECKED
:

1050 
∂bi
->
dwFœgs
 |
LBIF_CHECKED
;

1052 
CMFLAG_PARTCHECKED
:

1053 
∂bi
->
dwFœgs
 |
LBIF_PARTCHECKED
;

1057 i‡(
dwStyÀ
 & 
LBS_USEICON
)

1058 
∂bi
->
dwD©a
 = (
DWORD
)
∂bii
->
hIc⁄
;

1060 
∂bi
->
dwD©a
 = 0;

1062 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
, ()
wP¨am
, 
TRUE
);

1064  
LB_OKAY
;

1068 
LB_GETITEMADDDATA
:

1070 
PLISTBOXITEM
 
∂bi
;

1072 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1073 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1074  
LB_ERR
;

1076  
∂bi
->
dwAddD©a
;

1080 
LB_SETITEMADDDATA
:

1082 
PLISTBOXITEM
 
∂bi
;

1084 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1085 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1086  
LB_ERR
;

1088 
∂bi
->
dwAddD©a
 = (
DWORD
)
lP¨am
;

1090  
LB_OKAY
;

1094 
LB_GETCHECKMARK
:

1096 
PLISTBOXITEM
 
∂bi
;

1098 i‡(!(
dwStyÀ
 & 
LBS_CHECKBOX
))

1099  
LB_ERR
;

1101 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1102 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1103  
LB_ERR
;

1105 i‡(
∂bi
->
dwFœgs
 & 
LBIF_CHECKED
)

1106  
CMFLAG_CHECKED
;

1108 i‡(
∂bi
->
dwFœgs
 & 
LBIF_PARTCHECKED
)

1109  
CMFLAG_PARTCHECKED
;

1111  
CMFLAG_BLANK
;

1115 
LB_SETCHECKMARK
:

1117 
PLISTBOXITEM
 
∂bi
;

1119 i‡(!(
dwStyÀ
 & 
LBS_CHECKBOX
))

1120  
LB_ERR
;

1122 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1123 i‡(!(
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
)))

1124  
LB_ERR
;

1126 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1127 
lP¨am
) {

1128 
CMFLAG_CHECKED
:

1129 
∂bi
->
dwFœgs
 |
LBIF_CHECKED
;

1131 
CMFLAG_PARTCHECKED
:

1132 
∂bi
->
dwFœgs
 |
LBIF_PARTCHECKED
;

1136 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
, ()
wP¨am
, 
TRUE
);

1138  
LB_OKAY
;

1142 
LB_GETSELITEMS
:

1144 
nIãm
;

1145 
nSñ
 = 0;

1146 
ödex
 = 0;

1147 * 
pI¡
;

1148 
PLISTBOXITEM
 
∂bi
;

1150 
nIãm
 = ()
wP¨am
;

1151 
pI¡
 = (*)
lP¨am
;

1153 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1154 
∂bi
 = 
pD©a
->
hód
;

1155 
∂bi
) {

1157 i‡(
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
) {

1158 i‡(
pI¡
) {

1159 i‡(
nSñ
 < 
nIãm
)

1160 *(
pI¡
 + 
nSñ
Ë
ödex
;

1162  
nIãm
;

1164 
nSñ
 ++;

1167 
∂bi
 =Ölbi->
√xt
;

1168 
ödex
 ++;

1171  
nSñ
;

1175 
LB_GETSEL
:

1177 
PLISTBOXITEM
 
∂bi
;

1179 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1180 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
wP¨am
);

1181 i‡(
∂bi
)

1182  
∂bi
->
dwFœgs
 & 
LBIF_SELECTED
;

1184  
LB_ERR
;

1188 
LB_SETSEL
:

1190 
PLISTBOXITEM
 
∂bi
;

1192 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1193 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, ()
lP¨am
);

1194 i‡(
∂bi
) {

1195 
pD©a
->
dwFœgs
 &~
LBF_NOTHINGSELECTED
;

1196 i‡(
wP¨am
 == -1)

1197 
∂bi
->
dwFœgs
 ^
LBIF_SELECTED
;

1198 i‡(
wP¨am
 == 0)

1199 
∂bi
->
dwFœgs
 &~
LBIF_SELECTED
;

1201 
∂bi
->
dwFœgs
 |
LBIF_SELECTED
;

1203 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
, ()
lP¨am
, 
FALSE
);

1206  
LB_ERR
;

1210 
LB_GETITEMHEIGHT
:

1211 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1212  
pD©a
->
ôemHeight
;

1215 
LB_SETITEMHEIGHT
:

1216 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1217 i‡(
pD©a
->
ôemHeight
 !
	`LOWORD
 (
lP¨am
)) {

1218 
RECT
 
rcClõ¡
;

1220 
pD©a
->
ôemHeight
 = 
	`LOWORD
 (
lP¨am
);

1221 
	`GëClõ¡Re˘
 (
hwnd
, &
rcClõ¡
);

1222 
	`l°CÆcP¨ams
 (&
rcClõ¡
, 
pD©a
);

1224 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1225 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

1229 
WM_SETFOCUS
:

1231 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1233 i‡(
pD©a
->
dwFœgs
 & 
LBF_FOCUS
)

1236 
pD©a
->
dwFœgs
 |
LBF_FOCUS
;

1237 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

1239 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_SETFOCUS
);

1243 
WM_KILLFOCUS
:

1245 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1247 
pD©a
->
dwFœgs
 &~
LBF_FOCUS
;

1248 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
TRUE
);

1250 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_KILLFOCUS
);

1254 
WM_GETDLGCODE
:

1255  
DLGC_WANTARROWS
 | 
DLGC_WANTCHARS
;

1257 
WM_GETTEXTLENGTH
:

1258 
WM_GETTEXT
:

1259 
WM_SETTEXT
:

1262 
WM_SETFONT
:

1265 
WM_GETFONT
:

1268 
WM_NCCALCSIZE
:

1270 
LPNCCALCSIZE_PARAMS
 
Õnc
;

1273 
Õnc
 = (
LPNCCALCSIZE_PARAMS
)
lP¨am
;

1274 if(
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
Ë& 
WS_BORDER
)

1275 
	`InÊ©eRe˘
(&
Õnc
->
rgrc
[0], -2, -2);

1279 
WM_NCPAINT
:

1281 
RECT
 
rc
;

1283 
hdc
 = 
wP¨am
? (
HDC
)wP¨am: 
	`GëWödowDC
 (
hwnd
);

1284 
	`GëWödowRe˘
(
hwnd
, &
rc
);

1286 i‡(
dwStyÀ
 & 
WS_BORDER
)

1287 
	`Døw3dIn£t
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

1288 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
);

1290 i‡(!
wP¨am
)

1291 
	`Rñó£DC
 (
hwnd
, 
hdc
);

1295 
WM_PAINT
:

1297 
RECT
 
rc
;

1298 
PAINTSTRUCT
 
ps
;

1300 
hdc
 = 
	`BegöPaöt
 (
hwnd
,&
ps
);

1301 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1307 i‡(
pD©a
->
dwFœgs
 & 
LBF_NOTHINGSELECTED
) {

1308 
	`l°Sñe˘Iãm
 (
hwnd
->
°yÀ
, 
pD©a
,ÖD©a->
ôemT›
);

1309 
pD©a
->
dwFœgs
 &~
LBF_NOTHINGSELECTED
;

1311 
	`GëClõ¡Re˘
 (
hwnd
, &
rc
);

1312 
	`l°OnDøwSLi°BoxIãms
 (
hdc
, 
dwStyÀ
, 
pD©a
, 
rc
.
right
-rc.
À·
);

1313 
	`l°DøwFocusRe˘
 (
hdc
, 
pD©a
, &
rc
);

1315 
	`EndPaöt
 (
hwnd
, &
ps
);

1319 
WM_LBUTTONDBLCLK
:

1320 i‡(
dwStyÀ
 & 
LBS_NOTIFY
)

1321 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_DBLCLK
);

1324 
WM_LBUTTONDOWN
:

1326 
ﬁdSñ
, 
mou£X
, 
mou£Y
, 
hô
;

1327 
RECT
 
rcInv
;

1329 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1330 i‡(
pD©a
->
ôemCou¡
 == 0)

1333 
mou£X
 = 
	`LOWORD
 (
lP¨am
);

1334 
mou£Y
 = 
	`HIWORD
 (
lP¨am
);

1335 
hô
 = 
mou£Y
 / 
pD©a
->
ôemHeight
;

1336 
hô
 +
pD©a
->
ôemT›
;

1338 i‡(
hô
 >
pD©a
->
ôemCou¡
)

1341 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

1342 
ﬁdSñ
 = 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
, 
hô
);

1343 i‡((
dwStyÀ
 & 
LBS_NOTIFY
Ë&& (
ﬁdSñ
 !
hô
))

1344 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_SELCHANGE
);

1345 i‡(
ﬁdSñ
 >= 0) {

1346 i‡(
ﬁdSñ
 >
pD©a
->
ôemT›


1347 && (
ﬁdSñ
 <
pD©a
->
ôemT›
 +ÖD©a->
ôemVisibÀs
)) {

1348 
	`l°GëIãmsRe˘
 (
pD©a
, 
ﬁdSñ
, oldSñ, &
rcInv
);

1349 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

1353 
	`l°GëIãmsRe˘
 (
pD©a
, 
hô
, hô, &
rcInv
);

1354 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

1356 i‡(
pD©a
->
ôemHûighãd
 !
hô
)

1358 
hdc
 = 
	`GëDC
(
hwnd
);

1360 
	`l°DøwFocusRe˘
 (
hdc
, 
pD©a
, &
rcInv
);

1361 
	`Rñó£DC
 (
hwnd
,
hdc
);

1363 
pD©a
->
ôemHûighãd
 = 
hô
;

1365 i‡(
dwStyÀ
 & 
LBS_CHECKBOX
) {

1366 i‡(
mou£X
 > 0 && mou£X < 
LST_WIDTH_CHECKMARK
) {

1367 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_CLICKCHECKMARK
);

1369 i‡(
dwStyÀ
 & 
LBS_AUTOCHECK
) {

1370 
PLISTBOXITEM
 
∂bi
;

1372 
∂bi
 = 
	`l°GëIãm
 (
pD©a
, 
hô
);

1374 
∂bi
->
dwFœgs
 & 
LBIF_CHECKMARKMASK
) {

1375 
LBIF_CHECKED
:

1376 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1379 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1380 
∂bi
->
dwFœgs
 |
LBIF_CHECKED
;

1384 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
, 
hô
, 
TRUE
);

1389 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1393 
WM_LBUTTONUP
:

1396 
WM_MOUSEMOVE
:

1399 
WM_KEYDOWN
:

1401 
ﬁdSñ
, 
√wSñ
, 
√wT›
;

1402 
RECT
 
rcInv
;

1404 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1405 
√wT›
 = 
pD©a
->
ôemT›
;

1406 
√wSñ
 = 
pD©a
->
ôemHûighãd
;

1407 
	`LOWORD
 (
wP¨am
))

1409 
VK_HOME
:

1410 
√wSñ
 = 0;

1411 
√wT›
 = 0;

1414 
VK_END
:

1415 
√wSñ
 = 
pD©a
->
ôemCou¡
 - 1;

1416 i‡(
pD©a
->
ôemCou¡
 >ÖD©a->
ôemVisibÀs
)

1417 
√wT›
 = 
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
;

1419 
√wT›
 = 0;

1422 
VK_DOWN
:

1423 
√wSñ
 ++;

1424 i‡(
√wSñ
 >
pD©a
->
ôemCou¡
)

1426 i‡(
√wSñ
 > 
	`ITEM_BOTTOM
 (
pD©a
))

1427 
√wT›
 ++;

1430 
VK_UP
:

1431 
√wSñ
 --;

1432 i‡(
√wSñ
 < 0)

1434 i‡(
√wSñ
 < 
pD©a
->
ôemT›
)

1435 
√wT›
 --;

1438 
VK_NEXT
:

1439 
√wSñ
 +
pD©a
->
ôemVisibÀs
;

1440 i‡(
√wSñ
 >
pD©a
->
ôemCou¡
)

1441 
√wSñ
 = 
pD©a
->
ôemCou¡
 - 1;

1443 i‡(
pD©a
->
ôemCou¡
 - 
√wSñ
 >pD©a->
ôemVisibÀs
)

1444 
√wT›
 = 
√wSñ
;

1446 
√wT›
 = 
	`max
 (
pD©a
->
ôemCou¡
-pD©a->
ôemVisibÀs
, 0);

1449 
VK_PRIOR
:

1450 
√wSñ
 -
pD©a
->
ôemVisibÀs
;

1451 i‡(
√wSñ
 < 0)

1452 
√wSñ
 = 0;

1454 
√wT›
 -
pD©a
->
ôemVisibÀs
;

1455 i‡(
√wT›
 < 0)

1456 
√wT›
 = 0;

1463 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

1464 i‡(
pD©a
->
ôemHûighãd
 !
√wSñ
) {

1465 i‡(
pD©a
->
ôemT›
 !
√wT›
) {

1466 
pD©a
->
ôemT›
 = 
√wT›
;

1467 
pD©a
->
ôemHûighãd
 = 
√wSñ
;

1468 i‡(!(
dwStyÀ
 & 
LBS_MULTIPLESEL
)) {

1469 
ﬁdSñ
 = 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
, 
√wSñ
);

1470 i‡((
dwStyÀ
 & 
LBS_NOTIFY
Ë&& (
ﬁdSñ
 !
√wSñ
))

1471 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_SELCHANGE
);

1473 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

1476 i‡(!(
dwStyÀ
 & 
LBS_MULTIPLESEL
)) {

1477 
ﬁdSñ
 = 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
, 
√wSñ
);

1478 i‡((
dwStyÀ
 & 
LBS_NOTIFY
Ë&& (
ﬁdSñ
 !
√wSñ
))

1479 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_SELCHANGE
);

1480 i‡(
ﬁdSñ
 >= 0) {

1481 i‡(
ﬁdSñ
 >
pD©a
->
ôemT›


1482 && 
ﬁdSñ
 <(
	`ITEM_BOTTOM
 (
pD©a
) + 1)) {

1483 
	`l°GëIãmsRe˘
 (
pD©a
, 
ﬁdSñ
, oldSñ, &
rcInv
);

1484 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

1488 i‡(
√wSñ
 < 
√wT›
) {

1489 
pD©a
->
ôemHûighãd
 = 
√wSñ
;

1493 
	`l°GëIãmsRe˘
 (
pD©a
,ÖD©a->
ôemHûighãd
,

1494 
pD©a
->
ôemHûighãd
, &
rcInv
);

1496 
hdc
 = 
	`GëDC
(
hwnd
);

1498 
	`l°DøwFocusRe˘
 (
hdc
, 
pD©a
, &
rcInv
);

1499 
	`Rñó£DC
 (
hwnd
,
hdc
);

1501 
pD©a
->
ôemHûighãd
 = 
√wSñ
;

1502 
	`l°GëIãmsRe˘
 (
pD©a
, 
√wSñ
,ÇewSñ, &
rcInv
);

1503 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

1507 
hdc
 = 
	`GëDC
(
hwnd
);

1509 
	`l°DøwFocusRe˘
 (
hdc
, 
pD©a
, &
rcInv
);

1510 
pD©a
->
ôemHûighãd
 = 
√wSñ
;

1511 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

1512 
	`l°DøwFocusRe˘
 (
hdc
, 
pD©a
, &
rcInv
);

1513 
	`Rñó£DC
 (
hwnd
,
hdc
);

1516 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1521 
WM_CHAR
:

1523 
hód
 [2];

1524 
ödex
;

1525 
√wT›
;

1527 
hód
 [0] = (Ë(
wP¨am
);

1528 
hód
 [1] = '\0';

1530 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1532 i‡(
hód
[0] == ' ') {

1533 i‡(
dwStyÀ
 & 
LBS_MULTIPLESEL
) {

1534 
RECT
 
rcInv
;

1536 
	`GëClõ¡Re˘
 (
hwnd
, &
rcInv
);

1537 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
,ÖD©a->
ôemHûighãd
);

1538 
	`l°GëIãmsRe˘
 (
pD©a
,

1539 
pD©a
->
ôemHûighãd
,

1540 
pD©a
->
ôemHûighãd
,

1541 &
rcInv
);

1542 
	`InvÆid©eRe˘
 (
hwnd
, &
rcInv
, 
TRUE
);

1544 i‡(
dwStyÀ
 & 
LBS_CHECKBOX
) {

1545 
	`NŸifyP¨ít
 (
hwnd
, 
pCål
->
id
, 
LBN_CLICKCHECKMARK
);

1547 i‡(
dwStyÀ
 & 
LBS_AUTOCHECK
) {

1548 
PLISTBOXITEM
 
∂bi
;

1550 
∂bi
 = 
	`l°GëIãm
 (
pD©a
,ÖD©a->
ôemHûighãd
);

1552 
∂bi
->
dwFœgs
 & 
LBIF_CHECKMARKMASK
) {

1553 
LBIF_CHECKED
:

1554 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1557 
∂bi
->
dwFœgs
 &~
LBIF_CHECKMARKMASK
;

1558 
∂bi
->
dwFœgs
 |
LBIF_CHECKED
;

1562 
	`l°InvÆid©eIãm
 (
hwnd
, 
pD©a
,

1563 
pD©a
->
ôemHûighãd
, 
TRUE
);

1569 
ödex
 = 
	`l°FödIãm
 (
pD©a
,ÖD©a->
ôemHûighãd
 + 1, 
hód
, 
FALSE
);

1570 i‡(
ödex
 < 0) {

1571 
ödex
 = 
	`l°FödIãm
 (
pD©a
, 0, 
hód
, 
FALSE
);

1574 i‡(
ödex
 >= 0) {

1575 i‡(
pD©a
->
ôemCou¡
 - 
ödex
 >pD©a->
ôemVisibÀs
)

1576 
√wT›
 = 
ödex
;

1578 
√wT›
 = 
	`max
 (
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
, 0);

1580 
pD©a
->
ôemT›
 = 
√wT›
;

1581 
pD©a
->
ôemHûighãd
 = 
ödex
;

1582 i‡(!(
dwStyÀ
 & 
LBS_MULTIPLESEL
))

1583 
	`l°Sñe˘Iãm
 (
dwStyÀ
, 
pD©a
, 
ödex
);

1584 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

1586 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1591 
WM_VSCROLL
:

1593 
√wT›
;

1594 
s¸ﬁlHeight
 = 0;

1596 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1597 
√wT›
 = 
pD©a
->
ôemT›
;

1598 
wP¨am
)

1600 
SB_LINEDOWN
:

1603 
	`¥ötf
("ôemVisibÀs:%d\n",
pD©a
->
ôemVisibÀs
);

1604 
	`¥ötf
("SB_LINEDOWN:(%d:%d)\n",

1605 
	`ITEM_BOTTOM
 (
pD©a
),’D©a->
ôemCou¡
 - 1 ));

1607 i‡(
	`ITEM_BOTTOM
 (
pD©a
Ë< (pD©a->
ôemCou¡
 - 1 ))

1609 
√wT›
 ++;

1610 
s¸ﬁlHeight
 = -
pD©a
->
ôemHeight
;

1614 
SB_LINEUP
:

1615 i‡(
pD©a
->
ôemT›
 > 0)

1617 
√wT›
 --;

1618 
s¸ﬁlHeight
 = 
pD©a
->
ôemHeight
;

1622 
SB_PAGEDOWN
:

1623 i‡((
pD©a
->
ôemT›
 + (pD©a->
ôemVisibÀs
 << 1)) <=

1624 
pD©a
->
ôemCou¡
)

1625 
√wT›
 +
pD©a
->
ôemVisibÀs
;

1627 
√wT›
 = 
pD©a
->
ôemCou¡
 -ÖD©a->
ôemVisibÀs
;

1629 i‡(
√wT›
 < 0)

1632 
s¸ﬁlHeight
 = -(
√wT›
 - 
pD©a
->
ôemT›
)

1633 *
pD©a
->
ôemHeight
;

1636 
SB_PAGEUP
:

1637 i‡(
pD©a
->
ôemT›
 >pD©a->
ôemVisibÀs
)

1638 
√wT›
 -
pD©a
->
ôemVisibÀs
;

1640 
√wT›
 = 0;

1642 
s¸ﬁlHeight
 = (
pD©a
->
ôemT›
 - 
√wT›
)*pD©a->
ôemHeight
;

1645 
SB_THUMBTRACK
:

1646 
√wT›
 = ()
lP¨am
;

1647 
s¸ﬁlHeight
 = (
pD©a
->
ôemT›
 - 
√wT›
)*pD©a->
ôemHeight
;

1651 i‡(
s¸ﬁlHeight
)

1653 
pD©a
->
ôemT›
 = 
√wT›
;

1655 
	`S¸ﬁlWödow
 (
hwnd
, 0, 
s¸ﬁlHeight
, 
NULL
, NULL);

1657 
	`SídMesßge
 (
hwnd
, 
WM_PAINT
, 0, 0);

1659 
	`l°SëVS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1666 
WM_HSCROLL
:

1667 
pD©a
 = (
PLISTBOXDATA
)
pCål
->
u£rd©a
;

1668 
wP¨am
)

1670 
SB_LINERIGHT
:

1673 
SB_LINELEFT
:

1676 
SB_PAGELEFT
:

1679 
SB_PAGERIGHT
:

1685  
	`DefWödowProc
 (
hwnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1688 
	}
}

	@mwin/winlib/medit.c

50 
	~<°dio.h
>

51 
	~<°dlib.h
>

52 
	~<°rög.h
>

53 
	~<sys/time.h
>

54 
	#MWINCLUDECOLORS


	)

55 
	~"wödows.h
"

56 
	~"wötoﬁs.h
"

57 
	~"devi˚.h
"

59 #i‡
HAVE_HZK_SUPPORT
 || 
HAVE_BIG5_SUPPORT


60 
	#USE_BIG5


	)

62 
	#DEFAULT_FONT
 
DEFAULT_GUI_FONT


	)

65 
	#WIDTH_MEDIT_BORDER
 2

	)

66 
	#MARGIN_MEDIT_LEFT
 1

	)

67 
	#MARGIN_MEDIT_TOP
 1

	)

68 
	#MARGIN_MEDIT_RIGHT
 2

	)

69 
	#MARGIN_MEDIT_BOTTOM
 1

	)

71 
	#LEN_MLEDIT_BUFFER
 3000

	)

72 
	#LEN_MLEDIT_UNDOBUFFER
 1024

	)

74 
	#EST_FOCUSED
 0x00000001L

	)

75 
	#EST_MODIFY
 0x00000002L

	)

76 
	#EST_READONLY
 0x00000004L

	)

77 
	#EST_REPLACE
 0x00000008L

	)

79 
	#MEDIT_OP_NONE
 0x00

	)

80 
	#MEDIT_OP_DELETE
 0x01

	)

81 
	#MEDIT_OP_INSERT
 0x02

	)

82 
	#MEDIT_OP_REPLACE
 0x03

	)

84 
	sègLINEDATA
 {

85 
	mlöeNO
;

86 
	md©aEnd
;

87 
ègLINEDATA
 *
	m¥evious
;

88 
ègLINEDATA
 *
	m√xt
;

89 
	mbuf„r
[
LEN_MLEDIT_BUFFER
+1];

90 }
	tLINEDATA
;

91 
LINEDATA
* 
	tPLINEDATA
;

93 
	#ATTENG
 0

	)

94 
	#ATTCHL
 1

	)

95 
	#ATTCHR
 2

	)

96 
	g©å
[
LEN_MLEDIT_BUFFER
];

98 
	sègMLEDITDATA
 {

99 
	mtŸÆLí
;

101 
	medôPos
;

102 
	mˇªtPos
;

103 
	medôLöe
;

104 
	mdi•Pos
;

105 
	mSèπlöeDi•
;

106 
	mEndlöeDi•
;

107 
	mlöesDi•
;

108 
	mlöes
;

109 
	mMaxlöesDi•
;

111 
	m£lSèπPos
;

112 
	m£lSèπLöe
;

113 
	m£lEndPos
;

114 
	m£lEndLöe
;

116 
	m∑sswdCh¨
;

118 
	mÀ·M¨gö
;

119 
	mt›M¨gö
;

120 
	mrightM¨gö
;

121 
	mbŸtomM¨gö
;

123 
	mh¨dLimô
;

125 
	mœ°Op
;

126 
	mœ°Pos
;

127 
	mœ°Löe
;

128 
	maf„˘edLí
;

129 
	mundoBuf„rLí
;

130 
	mundoBuf„r
 [
LEN_MLEDIT_UNDOBUFFER
];

132 
PLINEDATA
 
	mhód
;

133 
PLINEDATA
 
	mèû
;

134 }
	tMLEDITDATA
;

135 
MLEDITDATA
* 
	tPMLEDITDATA
;

137 
BOOL
 
Regi°îMLEdôC⁄åﬁ
 ();

139 
MLEdôCålProc
 (
HWND
 
hWnd
, 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

141 
	#PIXEL_övÆid
 (-1)

	)

142 
HWND
 
sg_hC¨ëWnd
;

143 
HWND
 
roŸwp
;

145 
	$GëSysCh¨Height
 (
HWND
 
hwnd
)

147 #i‚de‡
USE_BIG5


148 
HDC
 
hdc
;

149 
xw
, 
xh
, 
xb
;

151 
hdc
 = 
	`GëDC
(
hwnd
);

152 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_FONT
));

153 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

154 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

155 
	`Rñó£DC
(
hwnd
,
hdc
);

157  
xh
;

161 
	}
}

163 
	$GëSysCh¨Width
 (
HWND
 
hwnd
)

165 #i‚de‡
USE_BIG5


166 
HDC
 
hdc
;

167 
xw
, 
xh
, 
xb
;

169 
hdc
 = 
	`GëDC
(
hwnd
);

170 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_FONT
));

171 
	`GdSëF⁄t
(
hdc
->
f⁄t
->
pf⁄t
);

172 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

173 
	`Rñó£DC
(
hwnd
,
hdc
);

175  
xw
;

179 
	}
}

181 
	$GëSysCCh¨Width
 (
HWND
 
hwnd
)

183  (2*
	`GëSysCh¨Width
(
hwnd
));

184 
	}
}

185 * 
	$GëWödowC≠ti⁄
 (
HWND
 
hWnd
)

187  
hWnd
->
szTôÀ
;

188 
	}
}

190 
DWORD
 
	$GëWödowAddôi⁄ÆD©a
 (
HWND
 
hWnd
)

192  
hWnd
->
u£rd©a
;

193 
	}
}

195 
DWORD
 
	$SëWödowAddôi⁄ÆD©a
 (
HWND
 
hWnd
, 
DWORD
 
√wD©a
)

197 
DWORD
 
ﬁdO√
 = 0L;

199 
ﬁdO√
 = 
hWnd
->
u£rd©a
;

200 
hWnd
->
u£rd©a
 = 
√wD©a
;

202  
ﬁdO√
;

203 
	}
}

205 
DWORD
 
	$GëWödowAddôi⁄ÆD©a2
 (
HWND
 
hWnd
)

207  
hWnd
->
u£rd©a2
;

208 
	}
}

210 
DWORD
 
	$SëWödowAddôi⁄ÆD©a2
 (
HWND
 
hWnd
, 
DWORD
 
√wD©a
)

212 
DWORD
 
ﬁdO√
 = 0L;

214 
ﬁdO√
 = 
hWnd
->
u£rd©a2
;

215 
hWnd
->
u£rd©a2
 = 
√wD©a
;

217  
ﬁdO√
;

218 
	}
}

220 
DWORD
 
	$GëWödowStyÀ
 (
HWND
 
hWnd
)

222  
hWnd
->
°yÀ
;

223 
	}
}

225 
BOOL
 
	$Ex˛udeWödowStyÀ
 (
HWND
 
hWnd
, 
DWORD
 
dwStyÀ
)

227 i‡(
hWnd
 =
roŸwp
 )

228  
FALSE
;

230 
hWnd
->
°yÀ
 &~
dwStyÀ
;

231  
TRUE
;

232 
	}
}

234 
BOOL
 
	$In˛udeWödowStyÀ
 (
HWND
 
hWnd
, 
DWORD
 
dwStyÀ
)

237 i‡(
hWnd
 =
roŸwp
 )

238  
FALSE
;

240 
hWnd
->
°yÀ
 |
dwStyÀ
;

241  
TRUE
;

242 
	}
}

244 
WINAPI
 
	$MwRegi°îMEdôC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

246 
WNDCLASS
 
wc
;

248 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

249 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
MLEdôCålProc
;

250 
wc
.
cbClsExåa
 = 0;

251 
wc
.
cbWndExåa
 = 0;

252 
wc
.
hIn°™˚
 = hInstance;

253 
wc
.
hIc⁄
 = 
NULL
;

254 
wc
.
hCurs‹
 = 0;

255 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

256 
wc
.
ÕszMíuName
 = 
NULL
;

257 
wc
.
ÕszCœssName
= "MEDIT";

259  
	`Regi°îCœss
(&
wc
);

260 
	}
}

262 
ölöe
 
	$edtGëOutWidth
 (
HWND
 
hWnd
)

264 
PMLEDITDATA
 
pMLEdôD©a
 =(PMLEDITDATAË
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

265 
RECT
 
rc
;

266 
	`GëClõ¡Re˘
(
hWnd
,&
rc
);

267  
rc
.
right
 -Ñc.
À·


268 - 
pMLEdôD©a
->
À·M¨gö


269 - 
pMLEdôD©a
->
rightM¨gö
;

270 
	}
}

272 
	$edtGëSèπDi•PosAtEnd
 (
HWND
 
hWnd
,

273 
PLINEDATA
 
pLöeD©a
)

275 
nOutWidth
 = 
	`edtGëOutWidth
 (
hWnd
);

276 
ídPos
 = 
pLöeD©a
->
d©aEnd
;

277 
PMLEDITDATA
 
pMLEdôD©a
 =(PMLEDITDATAË
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

278 
√wSèπPos
 = 
pMLEdôD©a
->
di•Pos
;

279 c⁄° * 
buf„r
 = 
pLöeD©a
->buffer;

281 if(
ídPos
 < 
√wSèπPos
)

283 
TRUE
)

285 i‡((
ídPos
 - 
√wSèπPos
Ë* 
	`GëSysCh¨Width
 (
hWnd
Ë< 
nOutWidth
)

289 i‡((
BYTE
)
buf„r
 [
√wSèπPos
] > 0xA0)

291 
√wSèπPos
 ++;

292 i‡(
√wSèπPos
 < 
pLöeD©a
->
d©aEnd
)

294 #i‚de‡
USE_BIG5


295 i‡((
BYTE
)
buf„r
 [
√wSèπPos
] > 0xA0)

297 i‡–((
BYTE
)
buf„r
 [
√wSèπPos
] >= 0x40 && (BYTE)buffer[newStartPos] <= 0x7e) ||

298 ((
BYTE
)
buf„r
 [
√wSèπPos
] >= 0xa1 && (BYTE)buffer[newStartPos] <= 0xfe))

300 
√wSèπPos
 ++;

304 
√wSèπPos
 ++;

306  
√wSèπPos
;

307 
	}
}

309 
	$edtGëDi•Lí
 (
HWND
 
hWnd
,
PLINEDATA
 
pLöeD©a
)

311 
i
, 
n
 = 0;

312 
nOutWidth
 = 
	`edtGëOutWidth
 (
hWnd
);

313 
nTextWidth
 = 0;

314 
PMLEDITDATA
 
pMLEdôD©a
 =(PMLEDITDATAË
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

315 c⁄° * 
buf„r
 = 
pLöeD©a
->buffer;

317 if(
buf„r
[0]==0||
pLöeD©a
->
d©aEnd
<
pMLEdôD©a
->
di•Pos
)

320 
i
 = 
pMLEdôD©a
->
di•Pos
; i < 
pLöeD©a
->
d©aEnd
; i++)

323 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

325 
i
++;

326 i‡(
i
 < 
pLöeD©a
->
d©aEnd
)

328 #i‚de‡
USE_BIG5


329 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

331 i‡–((
BYTE
)
buf„r
 [
i
] >= 0x40 && (BYTE)buffer[i] <= 0x7e) ||

332 ((
BYTE
)
buf„r
 [
i
] >= 0xa1 && (BYTE)buffer[i] <= 0xfe))

335 
nTextWidth
 +
	`GëSysCCh¨Width
 (
hWnd
);

336 
n
 += 2;

339 
i
--;

343 
nTextWidth
 +
	`GëSysCh¨Width
 (
hWnd
);

344 
n
++;

349 
nTextWidth
 +
	`GëSysCh¨Width
 (
hWnd
);

350 
n
++;

353 i‡(
nTextWidth
 > 
nOutWidth
)

357  
n
;

358 
	}
}

360 
	$edtGëOff£t
 (
HWND
 
hwnd
,c⁄° 
MLEDITDATA
* 
pMLEdôD©a
, 
PLINEDATA
 
pLöeD©a
, 
x
)

362 
i
;

363 
√wOff
 = 0;

364 
nTextWidth
 = 0;

365 c⁄° * 
buf„r
 = 
pLöeD©a
->buffer;

367 if(
pLöeD©a
->
d©aEnd
<
pMLEdôD©a
->
di•Pos
)

368  
pLöeD©a
->
d©aEnd
;

370 
x
 -
pMLEdôD©a
->
À·M¨gö
;

371 
i
 = 
pMLEdôD©a
->
di•Pos
; i < 
pLöeD©a
->
d©aEnd
; i++) {

372 i‡((
nTextWidth
 + (
	`GëSysCh¨Width
(
hwnd
Ë>> 1)Ë>
x
)

376 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

378 
i
++;

380 i‡(
nTextWidth
 + 
	`GëSysCCh¨Width
(
hwnd
)/2 >
x
)

383 i‡(
i
 < 
pLöeD©a
->
d©aEnd
)

385 #i‚de‡
USE_BIG5


386 i‡((
BYTE
)
buf„r
 [
i
] > 0xA0)

388 i‡–((
BYTE
)
buf„r
 [
i
] >= 0x40 && (BYTE)buffer[i] <= 0x7e) ||

389 ((
BYTE
)
buf„r
 [
i
] >= 0xa1 && (BYTE)buffer[i] <= 0xfe))

392 
nTextWidth
 +
	`GëSysCCh¨Width
 (
hwnd
);

393 
√wOff
 += 2;

396 
i
 --;

400 
nTextWidth
 +
	`GëSysCh¨Width
 (
hwnd
);

401 
√wOff
 ++;

406 
nTextWidth
 +
	`GëSysCh¨Width
 (
hwnd
);

407 
√wOff
 ++;

410  
√wOff
;

411 
	}
}

413 
	$edtGëLöeNO
 (
HWND
 
hwnd
,c⁄° 
MLEDITDATA
* 
pMLEdôD©a
, 
x
)

415 
∆öe
 = 0;

416 if(
x
>=0)

418 
∆öe
 = 
x
 / 
	`GëSysCh¨Height
(
hwnd
);

419 i‡(
∆öe
 <
pMLEdôD©a
->
löesDi•
)

420  
∆öe
;

423 
	}
}

425 
BOOL
 
	$edtIsACCh¨AtPosôi⁄
 (c⁄° * 
°rög
, 
Àn
, 
pos
)

427 i‡(
pos
 > (
Àn
 - 2))

428  
FALSE
;

431 #i‚de‡
USE_BIG5


432 i‡((
BYTE
)
°rög
 [
pos
] > 0xA0 && (BYTE)string [pos + 1] > 0xA0)

433  
TRUE
;

435 i‡((
BYTE
)
°rög
 [
pos
] > 0xA0)

437 i‡–((
BYTE
)
°rög
 [
pos
 + 1] >= 0x40 && (BYTE)string [pos + 1] <= 0x7e) ||

438 ((
BYTE
)
°rög
 [
pos
 + 1] >= 0xa1 && (BYTE)string [pos + 1] <= 0xfe)) {

441  
TRUE
;

446  
FALSE
;

447 
	}
}

449 
	$°r2©å
(c⁄° * 
°r
,
Àn
)

451 
i
=0;

454 i‡(
	`edtIsACCh¨AtPosôi⁄
(
°r
,
Àn
,
i
))

456 
©å
[
i
]=
ATTCHL
;

457 
©å
[
i
+1]=
ATTCHR
;

458 
i
+=2;

462 
©å
[
i
]=
ATTENG
;

463 
i
++;

465 }
i
<
Àn
);

466 
	}
}

468 
BOOL
 
	$edtIsACCh¨Bef‹ePosôi⁄
 (c⁄° * 
°rög
,
Àn
, 
pos
)

470 i‡(
pos
 < 2)

471  
FALSE
;

474 #i‚de‡
USE_BIG5


476 i‡((
BYTE
)
°rög
 [
pos
 - 2] > 0xA0 && (BYTE)string [pos - 1] > 0xA0)

477  
TRUE
;

480 i‡((
BYTE
)
°rög
 [
pos
 - 2] > 0xA0)

482 i‡–((
BYTE
)
°rög
 [
pos
 - 1] >= 0x40 && (BYTE)string[pos - 1] <= 0x7e) ||

483 ((
BYTE
)
°rög
 [
pos
 - 1] >= 0xa1 && (BYTE)string[pos - 1] <= 0xfe))

484  
TRUE
;

487 
	`°r2©å
(
°rög
,
Àn
);

488 i‡(
©å
[
pos
-1]==
ATTENG
Ë 
FALSE
;

489  
TRUE
;

493  
FALSE
;

494 
	}
}

497 
BOOL
 
	$edtIsACCh¨FromBegö
(c⁄° * 
°rög
,
Àn
,
pos
)

499 
i
;

500 if(
pos
 == 0)

501  
TRUE
;

502 if(
Àn
 == 0)

503  
FALSE
;

504 
i
=0;i<
Àn
;)

506 if–
	`edtIsACCh¨AtPosôi⁄
(
°rög
,
Àn
,
i
) )

507 
i
 += 2;

509 
i
++;

510 if(
i
==
pos
)

511  
TRUE
;

513  
FALSE
;

514 
	}
}

516 
	$GëRETURNPos
(*
°r
)

518 
i
;

519 
i
=0;i<
	`°æí
(
°r
);i++)

521 if(
°r
[
i
]==10)

522  
i
;

525 
	}
}

527 
	$MLEdôInôBuf„r
 (
PMLEDITDATA
 
pMLEdôD©a
,*
•ˇ±i⁄
)

529 *
ˇ±i⁄
=
•ˇ±i⁄
;

530 
off1
;

531 
löeNO
=0;

532 
PLINEDATA
 
pLöeD©a
;

533 i‡(!(
pMLEdôD©a
->
hód
 = 
	`mÆloc
 ( (
LINEDATA
)))) {

534 
	`Ârötf
 (
°dîr
, "EDITLINE: mallocÉrror!\n");

537 
pMLEdôD©a
->
hód
->
¥evious
 = 
NULL
;

538 
pLöeD©a
=
pMLEdôD©a
->
hód
;

539  (
off1
 = 
	`GëRETURNPos
(
ˇ±i⁄
)) != -1)

541 
off1
 = 
	`mö
(off1, 
LEN_MLEDIT_BUFFER
);

542 
	`mem˝y
(
pLöeD©a
->
buf„r
,
ˇ±i⁄
,
off1
);

543 
pLöeD©a
->
buf„r
[
off1
] = '\0';

544 
ˇ±i⁄
+=
	`mö
(
off1
,
LEN_MLEDIT_BUFFER
)+1;

545 
pLöeD©a
->
löeNO
 =ÜineNO;

546 
pMLEdôD©a
->
di•Pos
 = 0;

547 
pLöeD©a
->
d©aEnd
 = 
	`°æí
’LöeD©a->
buf„r
);

548 
pLöeD©a
->
√xt
 = 
	`mÆloc
 ( (
LINEDATA
));

549 
pLöeD©a
->
√xt
->
¥evious
 =ÖLineData;

550 
pLöeD©a
 =ÖLöeD©a->
√xt
;

551 
löeNO
++;

553 
off1
 = 
	`mö
(
	`°æí
(
ˇ±i⁄
),
LEN_MLEDIT_BUFFER
);

554 
	`mem˝y
(
pLöeD©a
->
buf„r
,
ˇ±i⁄
,
off1
);

555 
pLöeD©a
->
buf„r
[
off1
] = '\0';

556 
pLöeD©a
->
löeNO
 =ÜineNO++;

557 
pMLEdôD©a
->
di•Pos
 = 0;

558 
pLöeD©a
->
d©aEnd
 = 
	`°æí
’LöeD©a->
buf„r
);

559 
pLöeD©a
->
√xt
 = 
NULL
;

560 
pMLEdôD©a
->
löes
 = 
löeNO
 ;

561 
	}
}

563 
PLINEDATA
 
	$GëLöeD©a
(
PMLEDITDATA
 
pMLEdôD©a
,
löeNO
)

565 
PLINEDATA
 
pLöeD©a
=
pMLEdôD©a
->
hód
;

566 
pLöeD©a
)

568 if(
pLöeD©a
->
löeNO
==lineNO)

569  
pLöeD©a
;

570 
pLöeD©a
 =ÖLöeD©a->
√xt
;

572  
NULL
;

573 
	}
}

575 
	$MLEdôCålProc
 (
HWND
 
hWnd
, 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

577 
DWORD
 
dwStyÀ
;

578 
DWORD
 
dw
;

579 
HDC
 
hdc
;

580 
PLINEDATA
 
pLöeD©a
;

581 
RECT
 
˛õ¡Re˘
;

582 
PMLEDITDATA
 
pMLEdôD©a
;

583 
dwStyÀ
 = 
	`GëWödowStyÀ
(
hWnd
);

585 
mesßge
)

587 
WM_CREATE
:

589 i‡(!(
pMLEdôD©a
 = 
	`mÆloc
 ( (
MLEDITDATA
)))) {

590 
	`Ârötf
 (
°dîr
, "EDIT: mallocÉrror!\n");

594 
pMLEdôD©a
->
tŸÆLí
 = 
LEN_MLEDIT_BUFFER
;

595 
pMLEdôD©a
->
edôPos
 = 0;

596 
pMLEdôD©a
->
edôLöe
 = 0;

597 
pMLEdôD©a
->
ˇªtPos
 = 0;

599 
	`MLEdôInôBuf„r
(
pMLEdôD©a
,
	`GëWödowC≠ti⁄
(
hWnd
));

601 
	`GëClõ¡Re˘
(
hWnd
,&
˛õ¡Re˘
);

602 
pMLEdôD©a
->
MaxlöesDi•
 = (
˛õ¡Re˘
.
bŸtom
-˛õ¡Re˘.
t›
)/
	`GëSysCh¨Height
(
hWnd
);

603 
pMLEdôD©a
->
löesDi•
 = 
	`mö
’MLEdôD©a->
MaxlöesDi•
,pMLEdôD©a->
löes
);

604 
pMLEdôD©a
->
SèπlöeDi•
 = 0;

605 
pMLEdôD©a
->
EndlöeDi•
 =ÖMLEdôD©a->
SèπlöeDi•
 +ÖMLEdôD©a->
löesDi•
 - 1;

607 
pMLEdôD©a
->
£lSèπPos
 = 0;

608 
pMLEdôD©a
->
£lEndPos
 = 0;

609 
pMLEdôD©a
->
∑sswdCh¨
 = '*';

610 
pMLEdôD©a
->
À·M¨gö
 = 
MARGIN_MEDIT_LEFT
;

611 
pMLEdôD©a
->
t›M¨gö
 = 
MARGIN_MEDIT_TOP
;

612 
pMLEdôD©a
->
rightM¨gö
 = 
MARGIN_MEDIT_RIGHT
;

613 
pMLEdôD©a
->
bŸtomM¨gö
 = 
MARGIN_MEDIT_BOTTOM
;

615 
pMLEdôD©a
->
h¨dLimô
 = -1;

618 
pMLEdôD©a
->
œ°Op
 = 
MEDIT_OP_NONE
;

619 
pMLEdôD©a
->
œ°Pos
 = 0;

620 
pMLEdôD©a
->
af„˘edLí
 = 0;

621 
pMLEdôD©a
->
undoBuf„rLí
 = 
LEN_MLEDIT_UNDOBUFFER
;

622 
pMLEdôD©a
->
undoBuf„r
 [0] = '\0';

623 
	`SëWödowAddôi⁄ÆD©a2
(
hWnd
,(
DWORD
)
pMLEdôD©a
);

624 
	`SëWödowAddôi⁄ÆD©a
(
hWnd
,(
DWORD
)0);

627 
WM_DESTROY
:

629 
PLINEDATA
 
ãmp
;

630 
pMLEdôD©a
 =(
PMLEDITDATA
Ë
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

631 
	`De°royC¨ë
 ();

632 
pLöeD©a
 = 
pMLEdôD©a
->
hód
;

633 
pLöeD©a
)

636 
ãmp
 = 
pLöeD©a
->
√xt
;

637 
	`‰ì
(
pLöeD©a
);

638 
pLöeD©a
 = 
ãmp
;

640 
	`‰ì
(
pMLEdôD©a
);

644 
WM_SETFONT
:

647 
WM_GETFONT
:

651 
WM_SETCURSOR
:

652 i‡(
dwStyÀ
 & 
WS_DISABLED
) {

653 
	`SëCurs‹
 (
	`GëSy°emCurs‹
 (
IDC_ARROW
));

658 
WM_SIZECHANGED
:

663 
WM_KILLFOCUS
:

665 
dw

	`GëWödowAddôi⁄ÆD©a
(
hWnd
);

666 
dw
&~
EST_FOCUSED
;

667 
	`SëWödowAddôi⁄ÆD©a
(
hWnd
,
dw
);

669 
	`HideC¨ë
 (
hWnd
);

670 
	`De°royC¨ë
 ();

672 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
),

673 
WM_COMMAND
,

674 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_KILLFOCUS
),

675 (
LPARAM
)
hWnd
);

679 
WM_SETFOCUS
:

681 
dw

	`GëWödowAddôi⁄ÆD©a
(
hWnd
);

682 i‡(
dw
 & 
EST_FOCUSED
)

685 
dw
 |
EST_FOCUSED
;

686 
	`SëWödowAddôi⁄ÆD©a
(
hWnd
,
dw
);

688 
pMLEdôD©a
 =(
PMLEDITDATA
Ë
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

692 
	`Cª©eC¨ë
 (
hWnd
, 
NULL
, 1,

693 
hWnd
->
˛úe˘
.
bŸtom
-hWnd->˛úe˘.
t›
-2);

694 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

695 + 
pMLEdôD©a
->
À·M¨gö
,ÖMLEdôD©a->
t›M¨gö
);

696 
	`ShowC¨ë
(
hWnd
);

698 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
),

699 
WM_COMMAND
,

700 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_SETFOCUS
),

701 (
LPARAM
Ë
hWnd
);

705 
WM_ENABLE
:

706 i‡–(!(
dwStyÀ
 & 
WS_DISABLED
Ë&& !
wP¨am
)

707 || ((
dwStyÀ
 & 
WS_DISABLED
Ë&& 
wP¨am
) ) {

708 i‡(
wP¨am
)

709 
	`Ex˛udeWödowStyÀ
(
hWnd
,
WS_DISABLED
);

711 
	`In˛udeWödowStyÀ
(
hWnd
,
WS_DISABLED
);

713 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

717 
WM_NCPAINT
:

719 
RECT
 
rc
;

721 i‡(
wP¨am
)

722 
hdc
 = (
HDC
)
wP¨am
;

724 
hdc
 = 
	`GëDC
 (
hWnd
);

726 i‡(
lP¨am
)

727 
	`ClùRe˘I¡î£˘
 (
hdc
, (
RECT
*)
lP¨am
);

730 
hdc
 = 
wP¨am
? (
HDC
)wP¨am: 
	`GëWödowDC
 (
hWnd
);

731 
	`GëWödowRe˘
(
hWnd
, &
rc
);

733 i‡(
dwStyÀ
 & 
WS_BORDER
)

736 
RECT
 
rc
;

737 
	`GëWödowRe˘
(
hWnd
,&
rc
);

738 
	`Døw3DDownFøme
 (
hdc
, 0, 0,

739 
rc
.
right
 -Ñc.
À·
 - 1,

740 
rc
.
bŸtom
 -Ñc.
t›
 - 1,

741 
PIXEL_övÆid
);

743 
	`Døw3dIn£t
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

744 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
);

747 i‡(!
wP¨am
) {

748 
	`Rñó£DC
(
hWnd
,
hdc
);

753 
WM_PAINT
:

755 
di•Lí
,
i
;

756 * 
di•Buf„r
;

757 
RECT
 
ª˘
,
rc
;

758 
PAINTSTRUCT
 
ps
;

759 #ifde‡
USE_BIG5


760 
HGDIOBJ
 
ﬁdf⁄t
=
NULL
;

763 
hdc
 = 
	`BegöPaöt
 (
hWnd
,&
ps
);

764 
	`GëClõ¡Re˘
 (
hWnd
, &
ª˘
);

766 i‡(
dwStyÀ
 & 
WS_DISABLED
)

768 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
ª˘
.bŸtom;Ñc.
right
=rect.right;

769 
	`FûlRe˘
(
hdc
,&
rc
,
	`GëStockObje˘
(
LTGRAY_BRUSH
));

770 
	`SëBkCﬁ‹
 (
hdc
, 
LTGRAY
 );

773 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
ª˘
.bŸtom;Ñc.
right
=rect.right;

774 
	`FûlRe˘
(
hdc
,&
rc
,
	`GëStockObje˘
(
WHITE_BRUSH
));

775 
	`SëBkCﬁ‹
 (
hdc
, 
WHITE
 );

778 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
 );

780 
pMLEdôD©a
 =(
PMLEDITDATA
Ë
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

781 
i
 = 
pMLEdôD©a
->
SèπlöeDi•
; i <pMLEdôD©a->
EndlöeDi•
; i++)

783 
pLöeD©a

	`GëLöeD©a
(
pMLEdôD©a
,
i
);

784 
di•Lí
 = 
	`edtGëDi•Lí
 (
hWnd
,
pLöeD©a
);

785 i‡(
di•Lí
 =0 && 
pMLEdôD©a
->
EndlöeDi•
 >pMLEdôD©a->
löes
) {

789 #ifde‡
_DEBUG


790 i‡(
pMLEdôD©a
->
di•Pos
 > 
pLöeD©a
->
d©aEnd
)

791 
	`Ârötf
 (
°dîr
, "ASSERT failure: %s.\n", "Edit Paint");

794 
di•Buf„r
 = 
	`Æloˇ
 (
LEN_MLEDIT_BUFFER
+1);

796 i‡(
dwStyÀ
 & 
ES_PASSWORD
)

797 
	`mem£t
 (
di•Buf„r
, '*', 
pLöeD©a
->
d©aEnd
);

798 
	`mem˝y
 (
di•Buf„r
,

799 
pLöeD©a
->
buf„r
,

800 
pLöeD©a
->
d©aEnd
);

801 
di•Buf„r
[
pLöeD©a
->
d©aEnd
] = '\0';

804 
ª˘
.
À·
 = 
pMLEdôD©a
->
À·M¨gö
;

805 
ª˘
.
t›
 = 
pMLEdôD©a
->
t›M¨gö
 ;

806 
ª˘
.
right
 = 
pMLEdôD©a
->
rightM¨gö
;

807 
ª˘
.
bŸtom
 = 
pMLEdôD©a
->
bŸtomM¨gö
;

809 
	`¥ötf
("löeNO=%d,löes=%d,edôLöe=%d\n",
pLöeD©a
->
löeNO
,
pMLEdôD©a
->
löes
,

810 
pMLEdôD©a
->
edôLöe
);

811 
	`¥ötf
("--di•Buf„r=%s--\n",
di•Buf„r
);

812 
	`ClùRe˘I¡î£˘
 (
hdc
, &
ª˘
);

815 #ifde‡
USE_BIG5


816 
ﬁdf⁄t
=
	`Sñe˘Obje˘
(
hdc
,
	`Cª©eF⁄t
(12,

818 
FF_DONTCARE
|
DEFAULT_PITCH
,

821 
	`TextOut
 (
hdc
,

822 
pMLEdôD©a
->
À·M¨gö
 -ÖMLEdôD©a->
di•Pos
 * 
	`GëSysCh¨Width
(
hWnd
) ,

823 
	`GëSysCh¨Height
(
hWnd
)*(
pLöeD©a
->
löeNO
 - 
pMLEdôD©a
->
SèπlöeDi•
)

824 + 
pMLEdôD©a
->
t›M¨gö
,

825 
di•Buf„r
,-1);

827 #ifde‡
USE_BIG5


828 
	`DñëeObje˘
(
	`Sñe˘Obje˘
(
hdc
,
ﬁdf⁄t
));

830 
	`EndPaöt
 (
hWnd
, &
ps
);

834 
WM_KEYDOWN
:

836 
BOOL
 
bCh™ge
 = 
FALSE
;

837 
i
;

838 
dñëed
;

839 
PLINEDATA
 
ãmp
 = 
NULL
;

840 * 
ãmpP
 = 
NULL
;

842 
pMLEdôD©a
 =(
PMLEDITDATA
Ë
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

844 
	`LOWORD
 (
wP¨am
))

847 
VK_RETURN
:

849 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

850 i‡(
pMLEdôD©a
->
edôPos
 < 
pLöeD©a
->
d©aEnd
)

851 
ãmpP
 = 
pLöeD©a
->
buf„r
 + 
pMLEdôD©a
->
edôPos
;

852 
ãmp
 = 
pLöeD©a
->
√xt
;

853 
pLöeD©a
->
√xt
 = 
	`mÆloc
–(
LINEDATA
) );

854 
pLöeD©a
->
√xt
->
¥evious
 =ÖLineData;

855 
pLöeD©a
->
√xt
->√xà
ãmp
;

856 if(
ãmp
)

858 
ãmp
->
¥evious
 = 
pLöeD©a
->
√xt
;

860 
ãmp
 = 
pLöeD©a
->
√xt
;

861 
ãmp
->
löeNO
 = 
pMLEdôD©a
->
edôLöe
 + 1;

862 if(
ãmpP
)

864 
	`mem˝y
(
ãmp
->
buf„r
,
ãmpP
,
	`°æí
(tempP));

865 
ãmp
->
d©aEnd
 = 
	`°æí
(
ãmpP
);

868 
ãmp
->
d©aEnd
 = 0;

869 
ãmp
->
buf„r
[ãmp->
d©aEnd
] = '\0';

870 
pLöeD©a
->
d©aEnd
 = 
pMLEdôD©a
->
edôPos
;

871 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
]='\0';

872 
ãmp
 =Åemp->
√xt
;

873 
ãmp
)

875 
ãmp
->
löeNO
++;

876 
ãmp
 =Åemp->
√xt
;

878 
pMLEdôD©a
->
edôPos
 = 0;

879 
pMLEdôD©a
->
ˇªtPos
= 0;

880 
pMLEdôD©a
->
di•Pos
 = 0;

881 if(
pMLEdôD©a
->
löesDi•
 <ÖMLEdôD©a->
MaxlöesDi•
)

883 
pMLEdôD©a
->
EndlöeDi•
++;

884 
pMLEdôD©a
->
löesDi•
++;

886 if(
pMLEdôD©a
->
edôLöe
 =pMLEdôD©a->
EndlöeDi•
)

888 
pMLEdôD©a
->
SèπlöeDi•
++;

889 
pMLEdôD©a
->
EndlöeDi•
++;

891 
pMLEdôD©a
->
edôLöe
++;

892 
pMLEdôD©a
->
löes
++;

893 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

894 + 
pMLEdôD©a
->
À·M¨gö
,

895 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

896 +
pMLEdôD©a
->
t›M¨gö
);

897 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

900 
VK_HOME
:

902 
PLINEDATA
 
ãmp
;

903 i‡(
pMLEdôD©a
->
edôPos
 == 0)

906 
pMLEdôD©a
->
edôPos
 = 0;

907 
pMLEdôD©a
->
ˇªtPos
 = 0;

909 
	`SëC¨ëPos
 (
pMLEdôD©a
->
À·M¨gö
,

910 (
pMLEdôD©a
->
edôLöe
-pMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

911 +
pMLEdôD©a
->
t›M¨gö
);

912 
ãmp
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

913 i‡(
pMLEdôD©a
->
di•Pos
 != 0)

915 
pMLEdôD©a
->
di•Pos
 = 0;

916 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

920 
VK_END
:

922 
√wSèπPos
;

923 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

924 i‡(
pMLEdôD©a
->
edôPos
 =
pLöeD©a
->
d©aEnd
)

926 
√wSèπPos
 = 
	`edtGëSèπDi•PosAtEnd
 (
hWnd
, 
pLöeD©a
);

928 
pMLEdôD©a
->
edôPos
 = 
pLöeD©a
->
d©aEnd
;

929 
pMLEdôD©a
->
ˇªtPos
 =ÖMLEdôD©a->
edôPos
 - 
√wSèπPos
;

931 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

932 + 
pMLEdôD©a
->
À·M¨gö
,

933 (
pMLEdôD©a
->
edôLöe
-pMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

934 + 
pMLEdôD©a
->
t›M¨gö
);

936 i‡(
pMLEdôD©a
->
di•Pos
 !
√wSèπPos
)

937 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

938 
pMLEdôD©a
->
di•Pos
 = 
√wSèπPos
;

942 
VK_LEFT
:

944 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

945 
s¸ﬁlSãp
,
√wSèπPos
;

946 
PLINEDATA
 
ãmp
;

947 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

948 i‡(
pMLEdôD©a
->
edôPos
 == 0 )

950 
ãmp
 = 
pLöeD©a
->
¥evious
;

951 if(
ãmp
 && 
pMLEdôD©a
->
edôLöe
 >ÖMLEdôD©a->
SèπlöeDi•
)

953 
pMLEdôD©a
->
edôLöe
 --;

954 
pMLEdôD©a
->
edôPos
 = 
ãmp
->
d©aEnd
;

955 
√wSèπPos
 = 
	`edtGëSèπDi•PosAtEnd
 (
hWnd
, 
ãmp
);

956 
pMLEdôD©a
->
ˇªtPos
 =ÖMLEdôD©a->
edôPos
 - 
√wSèπPos
;

957 i‡(
pMLEdôD©a
->
di•Pos
 !
√wSèπPos
)

959 
pMLEdôD©a
->
di•Pos
 = 
√wSèπPos
;

960 
bS¸ﬁl
 = 
TRUE
;

967 { i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pLöeD©a
->
buf„r
,

968 
pLöeD©a
->
d©aEnd
,

969 
pMLEdôD©a
->
edôPos
)) {

970 
s¸ﬁlSãp
 = 2;

971 
pMLEdôD©a
->
edôPos
 -= 2;

974 
s¸ﬁlSãp
 = 1;

975 
pMLEdôD©a
->
edôPos
 --;

978 
pMLEdôD©a
->
ˇªtPos
 -
s¸ﬁlSãp
;

979 i‡(
pMLEdôD©a
->
ˇªtPos
 == 0

980 && 
pMLEdôD©a
->
edôPos
 != 0) {

982 
bS¸ﬁl
 = 
TRUE
;

984 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pLöeD©a
->
buf„r
,

985 
pLöeD©a
->
d©aEnd
,

986 
pMLEdôD©a
->
edôPos
)) {

987 
pMLEdôD©a
->
di•Pos
 -= 2;

988 
pMLEdôD©a
->
ˇªtPos
 = 2;

991 
pMLEdôD©a
->
di•Pos
--;

992 
pMLEdôD©a
->
ˇªtPos
 = 1;

995 i‡(
pMLEdôD©a
->
ˇªtPos
 < 0) {

996 
pMLEdôD©a
->
di•Pos
 = 0;

997 
pMLEdôD©a
->
ˇªtPos
 = 0;

1000 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1001 + 
pMLEdôD©a
->
À·M¨gö
,

1002 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1003 + 
pMLEdôD©a
->
t›M¨gö
);

1005 i‡(
bS¸ﬁl
)

1006 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

1010 
VK_RIGHT
:

1012 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

1013 
s¸ﬁlSãp
, 
moveSãp
;

1014 
PLINEDATA
 
ãmp
;

1016 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1017 i‡(
pMLEdôD©a
->
edôPos
 =
pLöeD©a
->
d©aEnd
)

1019 
ãmp
 = 
pLöeD©a
->
√xt
;

1020 if(
ãmp
)

1022 
pMLEdôD©a
->
edôLöe
++;

1023 
pMLEdôD©a
->
edôPos
 = 0;

1024 
pMLEdôD©a
->
ˇªtPos
 = 0;

1025 if(
pMLEdôD©a
->
di•Pos
 !=0)

1027 
pMLEdôD©a
->
di•Pos
 = 0;

1028 
bS¸ﬁl
 = 
TRUE
;

1036 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1037 
pLöeD©a
->
d©aEnd
,

1038 
pMLEdôD©a
->
di•Pos
)) {

1039 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1040 
pLöeD©a
->
d©aEnd
,

1041 
pMLEdôD©a
->
edôPos
)) {

1042 
s¸ﬁlSãp
 = 2;

1043 
moveSãp
 = 2;

1044 
pMLEdôD©a
->
edôPos
 += 2;

1047 
s¸ﬁlSãp
 = 2;

1048 
moveSãp
 = 1;

1049 
pMLEdôD©a
->
edôPos
 ++;

1053 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1054 
pLöeD©a
->
d©aEnd
,

1055 
pMLEdôD©a
->
edôPos
)) {

1057 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1058 
pLöeD©a
->
d©aEnd
,

1059 
pMLEdôD©a
->
di•Pos
 + 1))

1060 
s¸ﬁlSãp
 = 3;

1062 
s¸ﬁlSãp
 = 2;

1064 
moveSãp
 = 2;

1065 
pMLEdôD©a
->
edôPos
 += 2;

1068 
s¸ﬁlSãp
 = 1;

1069 
moveSãp
 = 1;

1070 
pMLEdôD©a
->
edôPos
 ++;

1074 
pMLEdôD©a
->
ˇªtPos
 +
moveSãp
;

1075 i‡(
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1076 > 
	`edtGëOutWidth
 (
hWnd
)) {

1077 
bS¸ﬁl
 = 
TRUE
;

1078 
pMLEdôD©a
->
di•Pos
 +
s¸ﬁlSãp
;

1079 
pMLEdôD©a
->
ˇªtPos
 =

1080 
pMLEdôD©a
->
edôPos
 -ÖMLEdôD©a->
di•Pos
;

1083 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1084 + 
pMLEdôD©a
->
À·M¨gö
,

1085 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
 (
hWnd
)

1086 + 
pMLEdôD©a
->
t›M¨gö
);

1088 i‡(
bS¸ﬁl
)

1089 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

1093 
VK_UP
:

1095 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

1096 
√wSèπPos
;

1097 
PLINEDATA
 
ãmp
;

1098 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1099 
ãmp
 = 
pLöeD©a
->
¥evious
;

1100 if(
pMLEdôD©a
->
edôLöe
 == 0)

1102 i‡(
pMLEdôD©a
->
edôLöe
 =pMLEdôD©a->
SèπlöeDi•
)

1104 
bS¸ﬁl
 = 
TRUE
;

1105 
pMLEdôD©a
->
SèπlöeDi•
--;

1106 
pMLEdôD©a
->
EndlöeDi•
--;

1108 
pMLEdôD©a
->
edôLöe
--;

1110 if–
pMLEdôD©a
->
edôPos
 >
ãmp
->
d©aEnd
 )

1112 
pMLEdôD©a
->
edôPos
 = 
ãmp
->
d©aEnd
;

1113 
pMLEdôD©a
->
di•Pos
 = 0;

1114 
√wSèπPos
 = 
	`edtGëSèπDi•PosAtEnd
 (
hWnd
, 
ãmp
);

1115 
pMLEdôD©a
->
di•Pos
 = 
√wSèπPos
;

1116 
pMLEdôD©a
->
ˇªtPos
 =ÖMLEdôD©a->
edôPos
 - 
√wSèπPos
;

1117 
bS¸ﬁl
 = 
TRUE
;

1121 
√wSèπPos
 = 
	`edtGëOff£t
(
hWnd
, 
pMLEdôD©a
,
ãmp
,

1122 
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1123 + 
pMLEdôD©a
->
À·M¨gö
);

1124 if(!
	`edtIsACCh¨FromBegö
(
ãmp
->
buf„r
,ãmp->
d©aEnd
,

1125 
pMLEdôD©a
->
di•Pos
))

1127 
bS¸ﬁl
 = 
TRUE
;

1128 
pMLEdôD©a
->
di•Pos
--;

1129 
√wSèπPos
 = 
	`edtGëOff£t
(
hWnd
, 
pMLEdôD©a
,
ãmp
,

1130 
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1131 + 
pMLEdôD©a
->
À·M¨gö
+
	`GëSysCh¨Width
(
hWnd
)/2);

1133 
pMLEdôD©a
->
edôPos
 = 
√wSèπPos
 +ÖMLEdôD©a->
di•Pos
;

1134 
pMLEdôD©a
->
ˇªtPos
 = 
√wSèπPos
;

1136 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1137 + 
pMLEdôD©a
->
À·M¨gö
,

1138 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1139 + 
pMLEdôD©a
->
t›M¨gö
);

1140 if(
bS¸ﬁl
)

1141 
	`InvÆid©eRe˘
(
hWnd
,
NULL
,
FALSE
);

1144 
VK_DOWN
:

1146 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

1147 
√wSèπPos
;

1148 
PLINEDATA
 
ãmp
;

1149 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1150 
ãmp
 = 
pLöeD©a
->
√xt
;

1151 if(
pMLEdôD©a
->
edôLöe
 =pMLEdôD©a->
löes
-1)

1153 i‡(
pMLEdôD©a
->
edôLöe
 =pMLEdôD©a->
EndlöeDi•
)

1155 
bS¸ﬁl
 = 
TRUE
;

1156 
pMLEdôD©a
->
SèπlöeDi•
++;

1157 
pMLEdôD©a
->
EndlöeDi•
++;

1159 
pMLEdôD©a
->
edôLöe
++;

1161 if–
pMLEdôD©a
->
edôPos
 >
ãmp
->
d©aEnd
 )

1163 
pMLEdôD©a
->
edôPos
 = 
ãmp
->
d©aEnd
;

1164 
pMLEdôD©a
->
di•Pos
 = 0;

1165 
√wSèπPos
 = 
	`edtGëSèπDi•PosAtEnd
 (
hWnd
, 
ãmp
);

1166 
pMLEdôD©a
->
di•Pos
 = 
√wSèπPos
;

1167 
pMLEdôD©a
->
ˇªtPos
 =ÖMLEdôD©a->
edôPos
 - 
√wSèπPos
;

1168 
bS¸ﬁl
 = 
TRUE
;

1172 
√wSèπPos
 = 
	`edtGëOff£t
(
hWnd
, 
pMLEdôD©a
,
ãmp
,

1173 
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1174 + 
pMLEdôD©a
->
À·M¨gö
);

1175 if(!
	`edtIsACCh¨FromBegö
(
ãmp
->
buf„r
,ãmp->
d©aEnd
,

1176 
pMLEdôD©a
->
di•Pos
))

1178 
bS¸ﬁl
 = 
TRUE
;

1179 
pMLEdôD©a
->
di•Pos
--;

1180 
√wSèπPos
 = 
	`edtGëOff£t
(
hWnd
, 
pMLEdôD©a
,
ãmp
,

1181 
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1182 + 
pMLEdôD©a
->
À·M¨gö
+
	`GëSysCh¨Width
(
hWnd
)/2);

1184 
pMLEdôD©a
->
edôPos
 = 
√wSèπPos
 +ÖMLEdôD©a->
di•Pos
;

1185 
pMLEdôD©a
->
ˇªtPos
 = 
√wSèπPos
;

1187 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1188 + 
pMLEdôD©a
->
À·M¨gö
,

1189 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1190 + 
pMLEdôD©a
->
t›M¨gö
);

1191 if(
bS¸ﬁl
)

1192 
	`InvÆid©eRe˘
(
hWnd
,
NULL
,
FALSE
);

1196 
VK_INSERT
:

1197 
dw
 = 
	`GëWödowAddôi⁄ÆD©a
(
hWnd
);

1198 
dw
 ^
EST_REPLACE
;

1199 
	`SëWödowAddôi⁄ÆD©a
(
hWnd
,
dw
);

1202 
VK_DELETE
:

1204 
PLINEDATA
 
ãmp
;

1205 
À·Lí
;

1206 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1207 i‡((
	`GëWödowAddôi⁄ÆD©a
(
hWnd
Ë& 
EST_READONLY
) ){

1209 
	`pög
 ();

1213 
ãmp
 = 
pLöeD©a
->
√xt
;

1214 i‡(
pLöeD©a
->
d©aEnd
 =
pMLEdôD©a
->
edôPos
 && 
ãmp
)

1216 if(
pLöeD©a
->
d©aEnd
 + 
ãmp
->d©aEnd <
LEN_MLEDIT_BUFFER
)

1218 
	`mem˝y
(
pLöeD©a
->
buf„r
+pLöeD©a->
d©aEnd
,
ãmp
->buffer,temp->dataEnd);

1219 
pLöeD©a
->
d©aEnd
 +
ãmp
->dataEnd;

1220 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
] = '\0';

1221 if(
ãmp
->
√xt
)

1223 
pLöeD©a
->
√xt
 = 
ãmp
->next;

1224 
ãmp
->
√xt
->
¥evious
 = 
pLöeD©a
;

1227 
pLöeD©a
->
√xt
 = 
NULL
;

1228 
	`‰ì
(
ãmp
);

1229 
ãmp
 = 
pLöeD©a
->
√xt
;

1230 
ãmp
)

1232 
ãmp
->
löeNO
--;

1233 
ãmp
 =Åemp->
√xt
;

1235 if(
pMLEdôD©a
->
löes
 <pMLEdôD©a->
MaxlöesDi•
)

1237 
pMLEdôD©a
->
EndlöeDi•
--;

1238 
pMLEdôD©a
->
löesDi•
--;

1240 if(
pMLEdôD©a
->
EndlöeDi•
 >pMLEdôD©a->
löes
-1)

1242 
pMLEdôD©a
->
EndlöeDi•
--;

1243 if(
pMLEdôD©a
->
SèπlöeDi•
 !=0)

1244 
pMLEdôD©a
->
SèπlöeDi•
--;

1246 
pMLEdôD©a
->
löesDi•
--;

1248 
pMLEdôD©a
->
löes
--;

1250 i‡(
ãmp
->
d©aEnd
 > 0)

1252 
À·Lí
 = 
LEN_MLEDIT_BUFFER
 - 
pLöeD©a
->
d©aEnd
;

1253 
	`mem˝y
(
pLöeD©a
->
buf„r
+pLöeD©a->
d©aEnd
,
ãmp
->buf„r,
À·Lí
);

1254 
pLöeD©a
->
d©aEnd
 +=
À·Lí
;

1255 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
] = '\0';

1256 
	`mem˝y
(
ãmp
->
buf„r
,ãmp->buf„r+
À·Lí
,ãmp->
d©aEnd
-leftLen);

1257 
ãmp
->
d©aEnd
 -=
À·Lí
;

1258 
ãmp
->
buf„r
[ãmp->
d©aEnd
] = '\0';

1261 i‡(
pMLEdôD©a
->
edôPos
 !
pLöeD©a
->
d©aEnd
)

1263 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1264 
pLöeD©a
->
d©aEnd
,

1265 
pMLEdôD©a
->
edôPos
))

1266 
dñëed
 = 2;

1268 
dñëed
 = 1;

1270 
i
 = 
pMLEdôD©a
->
edôPos
;

1271 
i
 < 
pLöeD©a
->
d©aEnd
 - 
dñëed
;

1272 
i
++)

1273 
pLöeD©a
->
buf„r
 [
i
]

1274 
pLöeD©a
->
buf„r
 [
i
 + 
dñëed
];

1276 
pLöeD©a
->
d©aEnd
 -
dñëed
;

1277 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
] = '\0';

1279 
bCh™ge
 = 
TRUE
;

1280 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
,
FALSE
);

1284 
VK_BACK
:

1286 
PLINEDATA
 
ãmp
;

1287 
À·Lí
,
ãmpEnd
;

1288 i‡((
	`GëWödowAddôi⁄ÆD©a
(
hWnd
Ë& 
EST_READONLY
) ){

1290 
	`Pög
 ();

1294 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1295 
ãmp
 = 
pLöeD©a
->
¥evious
;

1296 i‡(
pMLEdôD©a
->
edôPos
 =0 && 
ãmp
)

1298 
ãmpEnd
 = 
ãmp
->
d©aEnd
;

1299 if(
pLöeD©a
->
d©aEnd
 + 
ãmp
->d©aEnd <
LEN_MLEDIT_BUFFER
)

1301 
	`mem˝y
(
ãmp
->
buf„r
+ãmp->
d©aEnd
,
pLöeD©a
->buffer,pLineData->dataEnd);

1302 
ãmp
->
d©aEnd
 +=
pLöeD©a
->dataEnd;

1303 
ãmp
->
buf„r
[ãmp->
d©aEnd
] = '\0';

1304 if(
pLöeD©a
->
√xt
)

1306 
ãmp
->
√xt
 = 
pLöeD©a
->next;

1307 
pLöeD©a
->
√xt
->
¥evious
 = 
ãmp
;

1310 
ãmp
->
√xt
 = 
NULL
;

1311 
	`‰ì
(
pLöeD©a
);

1312 
pLöeD©a
 = 
ãmp
;

1313 
ãmp
 =Åemp->
√xt
;

1314 
ãmp
)

1316 
ãmp
->
löeNO
--;

1317 
ãmp
 =Åemp->
√xt
;

1319 if(
pMLEdôD©a
->
SèπlöeDi•
 =pMLEdôD©a->
edôLöe


1320 && 
pMLEdôD©a
->
SèπlöeDi•
 != 0)

1322 
pMLEdôD©a
->
SèπlöeDi•
--;

1323 if(
pMLEdôD©a
->
EndlöeDi•
 =pMLEdôD©a->
löes
)

1324 
pMLEdôD©a
->
EndlöeDi•
--;

1326 if(
pMLEdôD©a
->
löes
 <pMLEdôD©a->
MaxlöesDi•
)

1328 
pMLEdôD©a
->
löesDi•
--;

1329 
pMLEdôD©a
->
EndlöeDi•
--;

1331 
pMLEdôD©a
->
löes
--;

1333 i‡(
pLöeD©a
->
d©aEnd
 > 0)

1335 
À·Lí
 = 
LEN_MLEDIT_BUFFER
 - 
ãmp
->
d©aEnd
;

1336 
	`mem˝y
(
ãmp
->
buf„r
+ãmp->
d©aEnd
,
pLöeD©a
->buf„r,
À·Lí
);

1337 
ãmp
->
d©aEnd
 +=
À·Lí
;

1338 
ãmp
->
buf„r
[ãmp->
d©aEnd
] = '\0';

1339 
	`mem˝y
(
pLöeD©a
->
buf„r
,pLöeD©a->buf„r+
À·Lí
,pLöeD©a->
d©aEnd
-leftLen);

1340 
pLöeD©a
->
d©aEnd
 -=
À·Lí
;

1341 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
] = '\0';

1343 
pMLEdôD©a
->
edôLöe
--;

1344 
pMLEdôD©a
->
edôPos
 = 
ãmpEnd
;

1345 
pMLEdôD©a
->
di•Pos
 = 
ãmpEnd
;

1347 i‡(
pMLEdôD©a
->
ˇªtPos
 == 0

1348 && 
pMLEdôD©a
->
edôPos
 != 0) {

1349 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pLöeD©a
->
buf„r
,

1350 
pLöeD©a
->
d©aEnd
,

1351 
pMLEdôD©a
->
edôPos
)) {

1352 
pMLEdôD©a
->
di•Pos
 -= 2;

1353 
pMLEdôD©a
->
ˇªtPos
 = 2;

1356 
pMLEdôD©a
->
di•Pos
--;

1357 
pMLEdôD©a
->
ˇªtPos
 = 1;

1360 i‡(
pMLEdôD©a
->
ˇªtPos
 < 0) {

1361 
pMLEdôD©a
->
di•Pos
 = 0;

1362 
pMLEdôD©a
->
ˇªtPos
 = 0;

1365 i‡(
pMLEdôD©a
->
edôPos
 != 0 )

1367 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pLöeD©a
->
buf„r
,

1368 
pLöeD©a
->
d©aEnd
,

1369 
pMLEdôD©a
->
edôPos
))

1370 
dñëed
 = 2;

1372 
dñëed
 = 1;

1374 
i
 = 
pMLEdôD©a
->
edôPos
;

1375 
i
 < 
pLöeD©a
->
d©aEnd
;

1376 
i
++)

1377 
pLöeD©a
->
buf„r
 [
i
 - 
dñëed
]

1378 
pLöeD©a
->
buf„r
 [
i
];

1380 
pLöeD©a
->
d©aEnd
 -
dñëed
;

1381 
pMLEdôD©a
->
edôPos
 -
dñëed
;

1382 
pMLEdôD©a
->
ˇªtPos
 -
dñëed
;

1383 i‡(
pMLEdôD©a
->
ˇªtPos
 == 0

1384 && 
pMLEdôD©a
->
edôPos
 != 0) {

1385 i‡(
	`edtIsACCh¨Bef‹ePosôi⁄
 (
pLöeD©a
->
buf„r
,

1386 
pLöeD©a
->
d©aEnd
,

1387 
pMLEdôD©a
->
edôPos
)) {

1388 
pMLEdôD©a
->
di•Pos
 -= 2;

1389 
pMLEdôD©a
->
ˇªtPos
 = 2;

1392 
pMLEdôD©a
->
di•Pos
 --;

1393 
pMLEdôD©a
->
ˇªtPos
 = 1;

1398 
bCh™ge
 = 
TRUE
;

1399 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1400 + 
pMLEdôD©a
->
À·M¨gö
,

1401 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1402 + 
pMLEdôD©a
->
t›M¨gö
);

1403 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

1411 i‡(
bCh™ge
)

1412 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

1413 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_CHANGE
),

1414 (
LPARAM
Ë
hWnd
);

1418 
WM_CHAR
:

1420 
ch¨Buf„r
 [2];

1421 
i
, 
ch¨s
, 
s¸ﬁlSãp
, 
ö£πög
;

1422 
UINT
 
f‹m©
;

1424 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1426 
pLöeD©a
 = 
	`GëLöeD©a
(
pMLEdôD©a
,pMLEdôD©a->
edôLöe
);

1428 i‡(
dwStyÀ
 & 
ES_READONLY
) {

1430 
	`Pög
 ();

1434 i‡(
	`HIBYTE
 (
wP¨am
)) {

1435 
ch¨Buf„r
 [0] = 
	`LOBYTE
 (
wP¨am
);

1436 
ch¨Buf„r
 [1] = 
	`HIBYTE
 (
wP¨am
);

1437 
ch¨s
 = 2;

1440 
ch¨Buf„r
 [0] = 
	`LOBYTE
 (
wP¨am
);

1441 
ch¨s
 = 1;

1444 i‡(
ch¨s
 == 1) {

1445 
ch¨Buf„r
 [0])

1459 i‡(
	`GëWödowAddôi⁄ÆD©a
(
hWnd
Ë& 
EST_REPLACE
) {

1460 i‡(
pLöeD©a
->
d©aEnd
 =
pMLEdôD©a
->
edôPos
)

1461 
ö£πög
 = 
ch¨s
;

1462 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1463 
pLöeD©a
->
d©aEnd
,

1464 
pMLEdôD©a
->
edôPos
)) {

1465 i‡(
ch¨s
 == 2)

1466 
ö£πög
 = 0;

1468 
ö£πög
 = -1;

1471 i‡(
ch¨s
 == 2)

1472 
ö£πög
 = 1;

1474 
ö£πög
 = 0;

1478 
ö£πög
 = 
ch¨s
;

1481 i‡(
pLöeD©a
->
d©aEnd
 + 
ö£πög
 > 
pMLEdôD©a
->
tŸÆLí
) {

1483 
	`Pög
 ();

1485 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

1486 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_MAXTEXT
),

1487 (
LPARAM
Ë
hWnd
);

1490 i‡((
pMLEdôD©a
->
h¨dLimô
 >= 0)

1491 && ((
pLöeD©a
->
d©aEnd
 + 
ö£πög
)

1492 > 
pMLEdôD©a
->
h¨dLimô
)) {

1494 
	`Pög
 ();

1496 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

1497 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_MAXTEXT
),

1498 (
LPARAM
Ë
hWnd
);

1501 i‡(
ö£πög
 == -1) {

1502 
i
 = 
pMLEdôD©a
->
edôPos
; i < 
pLöeD©a
->
d©aEnd
-1; i++)

1503 
pLöeD©a
->
buf„r
 [
i
] =ÖLineData->buffer [i + 1];

1505 i‡(
ö£πög
 > 0) {

1506 
i
 = 
pLöeD©a
->
d©aEnd
 + 
ö£πög
 - 1;

1507 
i
 > 
pMLEdôD©a
->
edôPos
 + 
ö£πög
 - 1;

1508 
i
--)

1509 
pLöeD©a
->
buf„r
 [
i
]

1510 
pLöeD©a
->
buf„r
 [
i
 - 
ö£πög
];

1512 
i
 = 0; i < 
ch¨s
; i++)

1513 
pLöeD©a
->
buf„r
 [
pMLEdôD©a
->
edôPos
 + 
i
]

1514 
ch¨Buf„r
 [
i
];

1516 
pMLEdôD©a
->
edôPos
 +
ch¨s
;

1517 
pMLEdôD©a
->
ˇªtPos
 +
ch¨s
;

1518 
pLöeD©a
->
d©aEnd
 +
ö£πög
;

1519 
pLöeD©a
->
buf„r
[pLöeD©a->
d©aEnd
] = '\0';

1520 i‡(
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1521 > 
	`edtGëOutWidth
 (
hWnd
))

1523 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1524 
pLöeD©a
->
d©aEnd
,

1525 
pMLEdôD©a
->
di•Pos
))

1526 
s¸ﬁlSãp
 = 2;

1528 i‡(
ch¨s
 == 2) {

1529 i‡(
	`edtIsACCh¨AtPosôi⁄
 (
pLöeD©a
->
buf„r
,

1530 
pLöeD©a
->
d©aEnd
,

1531 
pMLEdôD©a
->
di•Pos
 + 1))

1532 
s¸ﬁlSãp
 = 3;

1534 
s¸ﬁlSãp
 = 2;

1537 
s¸ﬁlSãp
 = 1;

1540 
pMLEdôD©a
->
di•Pos
 +
s¸ﬁlSãp
;

1542 
pMLEdôD©a
->
ˇªtPos
 =

1543 
pMLEdôD©a
->
edôPos
 -ÖMLEdôD©a->
di•Pos
;

1546 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1547 + 
pMLEdôD©a
->
À·M¨gö
,

1548 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1549 + 
pMLEdôD©a
->
t›M¨gö
);

1550 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
,
FALSE
);

1551 
f‹m©
 = 
DT_NOPREFIX
;

1552 
	`SídMesßge
 (
	`GëP¨ít
 (
hWnd
), 
WM_COMMAND
,

1553 (
WPARAM
Ë
	`MAKELONG
 (
	`GëDlgCålID
(
hWnd
), 
EN_CHANGE
),

1554 (
LPARAM
Ë
hWnd
);

1558 
WM_GETTEXTLENGTH
:

1560 
PLINEDATA
 
ãmp
;

1561 
löeNO
 = ()
wP¨am
;

1562 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1563 
ãmp
 = 
pMLEdôD©a
->
hód
;

1564 
ãmp
)

1566 i‡(
ãmp
->
löeNO
 ==ÜineNO)

1567  
ãmp
->
d©aEnd
;

1568 
ãmp
 =Åemp->
√xt
;

1572 
WM_GETTEXT
:

1574 
PLINEDATA
 
ãmp
;

1575 
Àn
,
tŸÆ
 = 0,
löeNO
;

1576 * 
buf„r
 = (*)
lP¨am
;

1577 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1578 
Àn
 = ()
wP¨am
;

1579 
löeNO
 = ()
wP¨am
;

1580 
ãmp
 = 
pMLEdôD©a
->
hód
;

1581 
ãmp
 && 
tŸÆ
 +Åemp->
d©aEnd
 < 
Àn
)

1583 
	`mem˝y
(
buf„r
+
tŸÆ
,
ãmp
->buf„r,ãmp->
d©aEnd
);

1584 
tŸÆ
 +
ãmp
->
d©aEnd
;

1585 
ãmp
 =Åemp->
√xt
;

1592 
WM_GETLINETEXT
:

1594 
PLINEDATA
 
ãmp
;

1595 * 
buf„r
 = (*)
lP¨am
;

1596 
löeNO
,
Àn
;

1598 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1599 
löeNO
 = ()
wP¨am
;

1600 
ãmp
 = 
	`GëLöeD©a
(
pMLEdôD©a
,
löeNO
);

1601 if(
ãmp
)

1603 
Àn
 = 
	`mö
 (()
wP¨am
, 
ãmp
->
d©aEnd
);

1604 
	`mem˝y
 (
buf„r
, 
ãmp
->buf„r,
Àn
);

1605 
buf„r
 [
Àn
] = '\0';

1611 
WM_SETTEXT
:

1613 
	`MLEdôInôBuf„r
(
pMLEdôD©a
,(*)
lP¨am
);

1619 
WM_SETLINETEXT
:

1621 
Àn
,
löeNO
;

1622 
PLINEDATA
 
ãmp
;

1624 i‡(
dwStyÀ
 & 
ES_READONLY
)

1627 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1629 
Àn
 = 
	`°æí
 ((*)
lP¨am
);

1630 
löeNO
 = ()
wP¨am
;

1631 
ãmp
 = 
pMLEdôD©a
->
hód
;

1632 
Àn
 = 
	`mö
 (Àn, 
pMLEdôD©a
->
tŸÆLí
);

1634 i‡(
pMLEdôD©a
->
h¨dLimô
 >= 0)

1635 
Àn
 = 
	`mö
 (Àn, 
pMLEdôD©a
->
h¨dLimô
);

1636 
ãmp
)

1638 if(
ãmp
->
löeNO
 ==ÜineNO)

1640 
ãmp
->
d©aEnd
 = 
Àn
;

1641 
	`mem˝y
 (
ãmp
->
buf„r
, (*)
lP¨am
, 
Àn
);

1643 
ãmp
 =Åemp->
√xt
;

1645 
pMLEdôD©a
->
edôPos
 = 0;

1646 
pMLEdôD©a
->
ˇªtPos
 = 0;

1647 
pMLEdôD©a
->
di•Pos
 = 0;

1648 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
FALSE
);

1652 
WM_LBUTTONDBLCLK
:

1655 
WM_LBUTTONDOWN
:

1657 
√wOff
,
löeNO
;

1658 
PLINEDATA
 
ãmp
;

1659 
BOOL
 
bS¸ﬁl
 = 
FALSE
;

1661 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1662 
löeNO
 = 
	`edtGëLöeNO
 (
hWnd
,
pMLEdôD©a
, 
	`HIWORD
 (
lP¨am
));

1663 i‡–
löeNO
 < 0 )

1665 
löeNO
 +
pMLEdôD©a
->
SèπlöeDi•
;

1666 i‡(
löeNO
 <
pMLEdôD©a
->
EndlöeDi•
 &&ÜöeNO <pMLEdôD©a->
löes
-1 )

1668 
ãmp
 = 
	`GëLöeD©a
(
pMLEdôD©a
,
löeNO
);

1669 
√wOff
 = 
	`edtGëOff£t
 (
hWnd
,
pMLEdôD©a
,
ãmp
, 
	`LOWORD
 (
lP¨am
));

1670 if(!
	`edtIsACCh¨FromBegö
(
ãmp
->
buf„r
,ãmp->
d©aEnd
,
pMLEdôD©a
->
di•Pos
))

1672 
bS¸ﬁl
 = 
TRUE
;

1673 
pMLEdôD©a
->
di•Pos
--;

1674 
√wOff
 = 
	`edtGëOff£t
 (
hWnd
,
pMLEdôD©a
,
ãmp
, 
	`LOWORD
(
lP¨am
)+
	`GëSysCh¨Width
(hWnd)/2);

1676 i‡(
√wOff
 !
pMLEdôD©a
->
ˇªtPos
 || 
löeNO
 !pMLEdôD©a->
edôLöe
) {

1677 
pMLEdôD©a
->
edôLöe
 = 
ãmp
->
löeNO
;

1678 
pMLEdôD©a
->
edôPos
 = 
√wOff
 +pMLEdôD©a->
di•Pos
;

1679 
pMLEdôD©a
->
ˇªtPos
 = 
√wOff
;

1680 
	`SëC¨ëPos
 (
pMLEdôD©a
->
ˇªtPos
 * 
	`GëSysCh¨Width
 (
hWnd
)

1681 + 
pMLEdôD©a
->
À·M¨gö
,

1682 (
pMLEdôD©a
->
edôLöe
 -ÖMLEdôD©a->
SèπlöeDi•
Ë* 
	`GëSysCh¨Height
(
hWnd
)

1683 + 
pMLEdôD©a
->
t›M¨gö
);

1685 if(
bS¸ﬁl
)

1686 
	`InvÆid©eRe˘
(
hWnd
,
NULL
,
FALSE
);

1691 
WM_LBUTTONUP
:

1694 
WM_MOUSEMOVE
:

1697 
WM_GETDLGCODE
:

1698  
DLGC_WANTCHARS
 | 
DLGC_HASSETSEL
 | 
DLGC_WANTARROWS
;

1700 
EM_SETREADONLY
:

1701 i‡(
wP¨am
)

1702 
	`In˛udeWödowStyÀ
(
hWnd
,
ES_READONLY
);

1704 
	`Ex˛udeWödowStyÀ
(
hWnd
,
ES_READONLY
);

1707 
EM_SETPASSWORDCHAR
:

1708 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1710 i‡(
pMLEdôD©a
->
∑sswdCh¨
 !()
wP¨am
) {

1711 i‡(
dwStyÀ
 & 
ES_PASSWORD
) {

1712 
pMLEdôD©a
->
∑sswdCh¨
 = ()
wP¨am
;

1713 
	`InvÆid©eRe˘
 (
hWnd
, 
NULL
, 
TRUE
);

1718 
EM_GETPASSWORDCHAR
:

1720 * 
∑sswdch¨
;

1722 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1723 
∑sswdch¨
 = (*Ë
lP¨am
;

1725 *
∑sswdch¨
 = 
pMLEdôD©a
->
∑sswdCh¨
;

1729 
EM_LIMITTEXT
:

1731 
√wLimô
 = ()
wP¨am
;

1733 i‡(
√wLimô
 >= 0) {

1734 
pMLEdôD©a
 = (
PMLEDITDATA
)
	`GëWödowAddôi⁄ÆD©a2
(
hWnd
);

1735 i‡(
pMLEdôD©a
->
tŸÆLí
 < 
√wLimô
)

1736 
pMLEdôD©a
->
h¨dLimô
 = -1;

1738 
pMLEdôD©a
->
h¨dLimô
 = 
√wLimô
;

1744  
	`DefWödowProc
 (
hWnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1749 
	}
}

	@mwin/winlib/mwuser.c

1 
	~"wödows.h
"

4 
	$MwU£rInô
(
ac
,**
av
)

7 
	}
}

	@mwin/winlib/obsolete.c

21 
	ggr_w¨nög_libmwölib_is_obsﬁëe
[] =

	@mwin/winlib/progbar.c

49 
	~<°dio.h
>

50 
	~<°dlib.h
>

51 
	~<°rög.h
>

52 
	#MWINCLUDECOLORS


	)

53 
	~"wödows.h
"

54 
	~"wötoﬁs.h
"

55 
	~"devi˚.h
"

57 #i‡
PSP


59 
	~<p•kî√l.h
>

60 
	~<p•debug.h
>

63 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

65 
	#Ârötf
(...)

	)

70 
	#TEST
 1

	)

72 
	#WIDTH_PBAR_BORDER
 2

	)

74 
	s_PROGRESSDATA
 {

75 
	mnMö
;

76 
	mnMax
;

77 
	mnPos
;

78 
	mnSãpInc
;

79 } 
	tPROGRESSDATA
, *
	tPPROGRESSDATA
;

81 
LRESULT
 
CALLBACK


82 
ProgªssB¨CålProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

84 
WINAPI
 
	$MwRegi°îProgªssB¨C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

86 
WNDCLASS
 
wc
;

88 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

89 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
ProgªssB¨CålProc
;

90 
wc
.
cbClsExåa
 = 0;

91 
wc
.
cbWndExåa
 = 0;

92 
wc
.
hIn°™˚
 = hInstance;

93 
wc
.
hIc⁄
 = 
NULL
;

94 
wc
.
hCurs‹
 = 0;

95 
wc
.
hbrBackground

	`GëStockObje˘
(
LTGRAY_BRUSH
);

96 
wc
.
ÕszMíuName
 = 
NULL
;

97 
wc
.
ÕszCœssName
= "PROGBAR";

99  
	`Regi°îCœss
(&
wc
);

100 
	}
}

103 
	$FûlBox
(
HDC
 
hdc
, 
x
, 
y
, 
w
, 
h
, 
COLORREF
 
¸
)

105 
RECT
 
rc
;

107 i‡(
w
 <= 0)

109 
	`SëRe˘
(&
rc
, 
x
, 
y
, x+
w
, y+
h
);

110 
	`Fa°FûlRe˘
(
hdc
, &
rc
, 
¸
);

111 
	}
}

114 
	$GëSysCh¨Width
(
HDC
 
hdc
)

116 
cw
, 
ch
, 
cb
;

118 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
cw
,&
ch
,&
cb
,
MWTF_ASCII
);

119  
cw
;

120 
	}
}

123 
	$GëSysCh¨Height
(
HDC
 
hdc
)

125 
cw
, 
ch
, 
cb
;

127 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
cw
,&
ch
,&
cb
,
MWTF_ASCII
);

128  
ch
;

129 
	}
}

131 
	$pb¨OnDøw
 (
HWND
 
hwnd
, 
HDC
 
hdc
, 
PROGRESSDATA
* 
pD©a
, 
BOOL
 
fVîtiˇl
,

132 
BOOL
 
fEø£
)

134 
x
, 
y
, 
w
, 
h
;

135 
nAŒP¨t
;

136 
nNowP¨t
;

137 
whO√
, 
nRem
;

138 
ix
, 
iy
;

139 
i
;

140 
°ï
;

141 
COLORREF
 
¸
;

142 
RECT
 
rcClõ¡
;

143 
szText
[8];

145 i‡(!
hdc
 || (
pD©a
->
nMax
 =pD©a->
nMö
))

148 i‡((
pD©a
->
nMax
 -ÖD©a->
nMö
) > 5)

149 
°ï
 = 5;

151 
°ï
 = 1;

153 
	`GëClõ¡Re˘
 (
hwnd
, &
rcClõ¡
);

154 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
DEFAULT_GUI_FONT
));

156 
x
 = 
rcClõ¡
.
À·
 + 
WIDTH_PBAR_BORDER
;

157 
y
 = 
rcClõ¡
.
t›
 + 
WIDTH_PBAR_BORDER
;

158 
w
 = (
rcClõ¡
.
right
 -ÑcClõ¡.
À·
Ë- (
WIDTH_PBAR_BORDER
 << 1);

159 
h
 = (
rcClõ¡
.
bŸtom
 -ÑcClõ¡.
t›
Ë- (
WIDTH_PBAR_BORDER
 << 1);

161 
nAŒP¨t
 = (
pD©a
->
nMax
 -ÖD©a->
nMö
Ë/ 
°ï
;

162 
nNowP¨t
 = (
pD©a
->
nPos
 -ÖD©a->
nMö
Ë/ 
°ï
;

163 i‡(
fVîtiˇl
) {

164 
whO√
 = 
h
 / 
nAŒP¨t
;

165 
nRem
 = 
h
 % 
nAŒP¨t
;

167 
whO√
 = 
w
 / 
nAŒP¨t
;

168 
nRem
 = 
w
 % 
nAŒP¨t
;

171 i‡(
fEø£
)

172 
	`FûlBox
 (
hdc
, 
x
, 
y
, 
w
, 
h
, 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
));

174 if(
whO√
 >= 4) {

175 i‡(
fVîtiˇl
) {

176 
i
 = 0, 
iy
 = 
y
 + 
h
 - 1; i < 
nNowP¨t
; ++i) {

178 i‡((
iy
 - 
whO√
Ë< 
y
)

179 
whO√
 = 
iy
 - 
y
;

182 
	`FûlBox
 (
hdc
, 
x
, 
iy
 - 
whO√
, 
w
, whO√ - 1, 
BLUE
);

184 
iy
 -
whO√
 + 1;

186 if(
nRem
 > 0) {

187 
iy
 --;

188 
nRem
 --;

194 
i
 = 0, 
ix
 = 
x
 + 1; i < 
nNowP¨t
; ++i) {

196 i‡((
ix
 + 
whO√
Ë> (
x
 + 
w
))

197 
whO√
 = 
x
 + 
w
 - 
ix
;

199 
	`FûlBox
 (
hdc
, 
ix
, 
y
, 
whO√
 - 1, 
h
, 
BLUE
);

200 
ix
 +
whO√
 + 1;

202 if(
nRem
 > 0) {

203 
ix
 ++;

204 
nRem
 --;

212 
d
 = 
nNowP¨t
*100/
nAŒP¨t
;

213 
maxw
 = 
	`GëSysCh¨Width
 (
hdc
) << 2;

214 
ch¨h
 = 
	`GëSysCh¨Height
 (
hdc
);

216 i‡(
d
 > 50)

217 
¸
 = 
BLUE
;

219 
¸
 = 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
);

220 
	`FûlBox
 (
hdc
, 
x
 + ((
w
 - 
maxw
)>>1), 
y
 + ((
h
 - 
ch¨h
) > 1), maxw,

221 
ch¨h
 - 1, 
¸
);

222 
	`FûlBox
 (
hdc
, 
x
, 
y
, ()(()
w
*
d
/100L), 
h
, 
BLUE
);

223 
	`SëTextCﬁ‹
 (
hdc
, 
WHITE
);

224 
	`SëBkMode
 (
hdc
, 
TRANSPARENT
);

225 
	`•rötf
 (
szText
, "%d%%", 
d
);

226 
	`TextOut
 (
hdc
, 
x
 + ((
w
 - 
	`GëSysCh¨Width
 (hdcË* 
	`°æí
 (
szText
) )>>1),

227 
y
 + ((
h
 - 
	`GëSysCh¨Height
(
hdc
) )>>1),

228 
szText
, 
	`°æí
(szText));

230 
	}
}

232 
	$pb¨N‹mÆizeP¨ams
 (c⁄° 
HWND
 
pCål
,

233 
PROGRESSDATA
* 
pD©a
, 
BOOL
 
fNŸify
)

235 i‡(
pD©a
->
nPos
 >ÖD©a->
nMax
) {

236 i‡(
fNŸify
)

237 
	`SídMesßge
 (
	`GëP¨ít
 ((
HWND
)
pCål
), 
WM_COMMAND
,

238 (
WPARAM
)
	`MAKELONG
 (
pCål
->
id
, 
PBN_REACHMAX
), (
LPARAM
)pCtrl);

239 
pD©a
->
nPos
 =ÖD©a->
nMax
;

242 i‡(
pD©a
->
nPos
 <ÖD©a->
nMö
) {

243 i‡(
fNŸify
)

244 
	`SídMesßge
 (
	`GëP¨ít
 ((
HWND
)
pCål
), 
WM_COMMAND
,

245 (
WPARAM
)
	`MAKELONG
 (
pCål
->
id
, 
PBN_REACHMIN
), (
LPARAM
)pCtrl);

246 
pD©a
->
nPos
 =ÖD©a->
nMö
;

248 
	}
}

250 
LRESULT
 
CALLBACK


251 
	$ProgªssB¨CålProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

253 
HDC
 
hdc
;

254 
HWND
 
pCål
;

255 
PROGRESSDATA
* 
pD©a
;

256 
BOOL
 
fEø£
;

257 
RECT
 
rc
;

258 
PAINTSTRUCT
 
ps
;

259 
pos
;

261 
pCål
 = 
hwnd
;

263 
mesßge
)

265 
WM_CREATE
:

266 i‡(!(
pD©a
 = 
	`mÆloc
 ( (
PROGRESSDATA
)))) {

267 
	`Ârötf
(
°dîr
, "CreateÖrogress bar control failure!\n");

271 #i‡
TEST


272 
pD©a
->
nMax
 = 1000;

273 
pD©a
->
nMö
 = 0;

274 
pD©a
->
nPos
 = 500;

275 
pD©a
->
nSãpInc
 = 100;

277 
pD©a
->
nMax
 = 100;

278 
pD©a
->
nMö
 = 0;

279 
pD©a
->
nPos
 = 0;

280 
pD©a
->
nSãpInc
 = 10;

283 
pCål
->
u£rd©a
 = (
DWORD
)
pD©a
;

286 
WM_DESTROY
:

287 
	`‰ì
 ((*)(
pCål
->
u£rd©a
));

290 
WM_GETDLGCODE
:

291  
DLGC_STATIC
;

293 
WM_NCPAINT
:

294 if(
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
Ë& 
WS_BORDER
) {

295 
	`GëWödowRe˘
(
hwnd
, &
rc
);

296 
hdc
 = 
	`GëWödowDC
(
hwnd
);

297 
	`Døw3dBox
(
hdc
, 
rc
.
À·
,Ñc.
t›
,Ñc.
right
-rc.left,

298 
rc
.
bŸtom
-rc.
t›
, 
	`GëSysCﬁ‹
(
COLOR_BTNSHADOW
),

299 
	`GëSysCﬁ‹
(
COLOR_BTNHIGHLIGHT
));

303 
WM_PAINT
:

304 
hdc
 = 
	`BegöPaöt
 (
hwnd
,&
ps
);

305 
	`pb¨OnDøw
 (
hwnd
, 
hdc
, (
PROGRESSDATA
 *)
pCål
->
u£rd©a
,

306 
hwnd
->
°yÀ
 & 
PBS_VERTICAL
, 
TRUE
);

307 
	`EndPaöt
 (
hwnd
, &
ps
);

310 
PBM_SETRANGE
:

311 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

312 
pD©a
->
nMö
 = 
	`mö
 (
wP¨am
, 
lP¨am
);

313 
pD©a
->
nMax
 = 
	`max
 (
wP¨am
, 
lP¨am
);

314 i‡(
pD©a
->
nPos
 >ÖD©a->
nMax
)

315 
pD©a
->
nPos
 =ÖD©a->
nMax
;

316 i‡(
pD©a
->
nPos
 <ÖD©a->
nMö
)

317 
pD©a
->
nPos
 =ÖD©a->
nMö
;

320 
PBM_SETSTEP
:

321 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

322 
pD©a
->
nSãpInc
 = 
wP¨am
;

325 
PBM_SETPOS
:

326 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

328 i‡(
pD©a
->
nPos
 =
wP¨am
)

331 
fEø£
 = (
wP¨am
 < 
pD©a
->
nPos
);

332 
pD©a
->
nPos
 = 
wP¨am
;

333 
	`pb¨N‹mÆizeP¨ams
 (
pCål
, 
pD©a
, 
hwnd
->
°yÀ
 & 
PBS_NOTIFY
);

334 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
fEø£
);

337 
PBM_DELTAPOS
:

338 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

340 i‡(
wP¨am
 == 0)

343 
fEø£
 = (
wP¨am
 < 0);

344 
pD©a
->
nPos
 +
wP¨am
;

345 
	`pb¨N‹mÆizeP¨ams
 (
pCål
, 
pD©a
, 
hwnd
->
°yÀ
 & 
PBS_NOTIFY
);

346 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
fEø£
);

349 
PBM_STEPIT
:

350 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

352 i‡(
pD©a
->
nSãpInc
 == 0)

355 
fEø£
 = (
pD©a
->
nSãpInc
 < 0);

356 
pD©a
->
nPos
 +pD©a->
nSãpInc
;

357 
	`pb¨N‹mÆizeP¨ams
 (
pCål
, 
pD©a
, 
hwnd
->
°yÀ
 & 
PBS_NOTIFY
);

358 
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
fEø£
);

361 #i‡
TEST


362 
WM_LBUTTONDOWN
:

363 
WM_LBUTTONDBLCLK
:

364 
pD©a
 = (
PROGRESSDATA
 *)
pCål
->
u£rd©a
;

365 
pos
 = 
pD©a
->
nPos
;

366 
pos
 +
pD©a
->
nSãpInc
;

367 i‡(
pos
 > 
pD©a
->
nMax
)

368 
pos
 = 
pD©a
->
nMö
;

369 
	`SídMesßge
(
hwnd
, 
PBM_SETPOS
, 
pos
, 0L);

373  
	`DefWödowProc
 (
hwnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

376 
	}
}

	@mwin/winlib/ptinsid.c

1 
	~"wödows.h
"

2 
	~"wötoﬁs.h
"

4 
BOOL
 
WINAPI


5 
	$PtInsideWödow
(
HWND
 
hwnd
,
UINT
 
x
,UINT 
y
)

10 
RECT
 
˛õ¡Re˘
;

11 
POINT
 
buâ⁄Poöt
;

13 
buâ⁄Poöt
.
x
 = x;

14 
buâ⁄Poöt
.
y
 = y;

16 
	`GëClõ¡Re˘
–
hwnd
, &
˛õ¡Re˘
);

17  
	`PtInRe˘
–&
˛õ¡Re˘
, 
buâ⁄Poöt
);

18 
	}
}

	@mwin/winlib/scrlbar.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

11 
	#MWINCLUDECOLORS


	)

12 
	~"wödows.h
"

13 
	~"wöã∫.h
"

14 
	~"wötoﬁs.h
"

15 
	~"mwsy°em.h
"

17 #i‡
PSP


19 
	~<p•kî√l.h
>

20 
	~<p•debug.h
>

23 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

25 
	#Ârötf
(...)

	)

31 
	#SBS_UNKNOWN
 0x0000

	)

32 
	#SBS_LEFTARROW
 0x0001

	)

33 
	#SBS_RIGHTARROW
 0x0002

	)

34 
	#SBS_LEFTSPACE
 0x0004

	)

35 
	#SBS_RIGHTSPACE
 0x0008

	)

36 
	#SBS_HORZTHUMB
 0x0010

	)

37 
	#SBS_UPARROW
 0x0020

	)

38 
	#SBS_DOWNARROW
 0x0040

	)

39 
	#SBS_UPSPACE
 0x0080

	)

40 
	#SBS_DOWNSPACE
 0x0100

	)

41 
	#SBS_VERTTHUMB
 0x0200

	)

42 
	#SBS_MASK
 0x03ff

	)

43 
	#SBS_DISABLED
 0x4000

	)

44 
	#SBS_HIDE
 0x8000

	)

47 
	#MWM_DEFBARLEN
 18

	)

48 
	#MWM_MINBARLEN
 8

	)

50 
LRESULT
 
CALLBACK


51 
S¸ﬁlb¨C⁄åﬁProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

54 
WINAPI
 
	$MwRegi°îS¸ﬁlb¨C⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

56 
WNDCLASS
 
wc
;

58 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

59 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
S¸ﬁlb¨C⁄åﬁProc
;

60 
wc
.
cbClsExåa
 = 0;

61 
wc
.
cbWndExåa
 = 0;

62 
wc
.
hIn°™˚
 = hInstance;

63 
wc
.
hIc⁄
 = 
NULL
;

64 
wc
.
hCurs‹
 = 0;

65 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

66 
wc
.
ÕszMíuName
 = 
NULL
;

67 
wc
.
ÕszCœssName
= "SCROLLBAR";

69  
	`Regi°îCœss
(&
wc
);

70 
	}
}

72 
DWORD
 
	$GëWödowStyÀ
 (
HWND
 
hwnd
)

74  
hwnd
->
°yÀ
;

75 
	}
}

78 
	$wndGëB‹dî
(
HWND
 
hwnd
)

80 i‡(
hwnd
->
°yÀ
 & 
WS_BORDER
) {

81 i‡((
hwnd
->
°yÀ
 & 
WS_CAPTION
) == WS_CAPTION)

82  
mwSYSMETRICS_CXFRAME
;

83  
mwSYSMETRICS_CXBORDER
;

86 
	}
}

88 
BOOL


89 
	$wndGëVS¸ﬁlB¨Re˘
 (
HWND
 
hwnd
, 
RECT
* 
rcVB¨
)

91 
cx
,
cy
; 
RECT
 
rc
;

92 
MWSCROLLBARINFO
* 
pD©a
;

94 
pD©a
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

95 
rc
 = 
hwnd
->
wöª˘
;

96 
cx
=
rc
.
right
-rc.
À·
;

97 
cy
=
rc
.
bŸtom
-rc.
t›
;

99 
rcVB¨
->
À·
 = 
hwnd
->
wöª˘
.
right
 - 
cx


100 - 
	`wndGëB‹dî
 (
hwnd
);

101 
rcVB¨
->
right
 = 
hwnd
->
wöª˘
.righà- 
	`wndGëB‹dî
 (hwnd);

102 
rcVB¨
->
t›
 = 
hwnd
->
wöª˘
.top;

103 
rcVB¨
->
bŸtom
 = 
hwnd
->
wöª˘
.bŸtom - 
	`wndGëB‹dî
 (hwnd);

105  
TRUE
;

106 
	}
}

108 
BOOL


109 
	$wndGëHS¸ﬁlB¨Re˘
 (
HWND
 
hwnd
, 
RECT
* 
rcHB¨
)

111 
cx
,
cy
; 
RECT
 
rc
;

112 
MWSCROLLBARINFO
* 
pD©a
;

114 
pD©a
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

115 
rc
 = 
hwnd
->
wöª˘
;

116 
cx
=
rc
.
right
-rc.
À·
;

117 
cy
=
rc
.
bŸtom
-rc.
t›
;

119 
rcHB¨
->
t›
 = 
hwnd
->
wöª˘
.
bŸtom
 - 
cy


120 - 
	`wndGëB‹dî
 (
hwnd
);

121 
rcHB¨
->
bŸtom
 = 
hwnd
->
wöª˘
.bŸtom - 
	`wndGëB‹dî
 (hwnd);

122 
rcHB¨
->
À·
 = 
hwnd
->
wöª˘
.left;

123 
rcHB¨
->
right
 = 
hwnd
->
wöª˘
.righà- 
	`wndGëB‹dî
 (hwnd);

125  
TRUE
;

126 
	}
}

129 
	$MwPaötS¸ﬁlb¨s
(
HWND
 
hwnd
, 
HDC
 
hdc
, 
DWORD
 
°yÀ
)

131 
BOOL
 
vîtb¨
 = (
°yÀ
==
SBS_VERT
);

132 
BOOL
 
h‹zb¨
 = (
°yÀ
==
SBS_HORZ
);

133 
BOOL
 
fGŸDC
 = 
FALSE
;

134 
RECT
 
rc
,
rc2
;

136 
POINT
 
p3
[3];

137 
shrök
=2;

139 
°¨t
 = 0;

140 
RECT
 
rcHB¨
, 
rcVB¨
;

142 
cx
,
cy
;

143 
MWSCROLLBARINFO
* 
pD©a
;

145 
pD©a
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

146 
rc
 = 
hwnd
->
wöª˘
;

147 
cx
=
rc
.
right
-rc.
À·
;

148 
cy
=
rc
.
bŸtom
-rc.
t›
;

150 i‡(!
hdc
 && (
h‹zb¨
 || 
vîtb¨
)) {

151 
hdc
 = 
	`GëWödowDC
(
hwnd
);

152 
fGŸDC
 = 
TRUE
;

155 i‡(
vîtb¨
) {

159 
rc2
.
À·
=
rc
.À·;Ñc2.
right
Ùc2.À·+ 
cx
;

160 
rc2
.
t›
=
rc
.top;

161 
rc2
.
bŸtom
Ùc2.
t›
+ 
cx
;

162 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

163 
rc2
.
t›
=
rc
.
bŸtom
- 
cx
;

164 
rc2
.
bŸtom
Ùc2.
t›
+ 
cx
;

165 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

168 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

169 
cx
, cx,

170 
pD©a
->
°©us
 & 
SBS_UPARROW
);

172 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,rc.
bŸtom
-
cx
,

173 
cx
, cx,

174 
pD©a
->
°©us
 & 
SBS_DOWNARROW
);

176 
	`Sñe˘Obje˘
(
hdc
,
	`GëStockObje˘
(
BLACK_BRUSH
));

178 
p3
[0].
x

rc
.
À·
 + (
cx
/2) - 1;

179 
p3
[0].
y

rc
.
t›
 + 2 + 
shrök
;

180 
p3
[1].
x

rc
.
À·
 + 2 + 
shrök
 - 1;

181 
p3
[1].
y

rc
.
t›
 + (
cx
-4Ë- 
shrök
;

182 
p3
[2].
x

rc
.
À·
 + (
cx
-4Ë- 
shrök
;

183 
p3
[2].
y

rc
.
t›
 + (
cx
-4Ë- 
shrök
;

184 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

186 
p3
[0].
x

rc
.
À·
 + (
cx
/2) - 1;

187 
p3
[0].
y

rc
.
bŸtom
 - 4 - 
shrök
;

188 
p3
[1].
x

rc
.
À·
 + 2 + 
shrök
 - 1;

189 
p3
[1].
y

rc
.
bŸtom
-
cx
 + 2 + 
shrök
;

190 
p3
[2].
x

rc
.
À·
 + (
cx
-4Ë- 
shrök
;

191 
p3
[2].
y

rc
.
bŸtom
-
cx
 + 2 + 
shrök
;

192 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

196 
	`wndGëVS¸ﬁlB¨Re˘
 (
hwnd
, &
rcVB¨
);

197 
rcVB¨
.
À·
 -- ;

200 
°¨t
 = 
rcVB¨
.
t›
 + 
cx
 + 
pD©a
->
b¨Sèπ
;

202 i‡(
°¨t
 + 
pD©a
->
b¨Lí
 > 
rcVB¨
.
bŸtom
)

203 
°¨t
 = 
rcVB¨
.
bŸtom
 - 
pD©a
->
b¨Lí
;

205 i‡(
pD©a
->
b¨Lí
 == 0)

206 
pD©a
->
b¨Lí
=
rc
.
bŸtom
-rc.
t›
-(
cx
*2);

209 
rc2
.
À·
=
rc
.À·;Ñc2.
right
=rc.right ;

210 
rc2
.
t›
=
rc
.t›+
cx
;

211 
rc2
.
bŸtom
=
°¨t
;

212 i‡(
rc2
.
bŸtom
>rc2.
t›
)

213 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

215 
rc2
.
t›
=
°¨t
+
pD©a
->
b¨Lí
;

216 
rc2
.
bŸtom
=
rc
.bŸtom-
cx
;

217 i‡(
rc2
.
bŸtom
>rc2.
t›
)

218 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

220 
	`Døw3dUpFøme
 (
hdc
, 
rcVB¨
.
À·
, 
°¨t
,ÑcVB¨.
right
,

221 
°¨t
 + 
pD©a
->
b¨Lí
);

227 i‡(
h‹zb¨
) {

230 
rc2
.
t›
=
rc
.t›;Ñc2.
bŸtom
Ùc2.t›+ 
cy
;

231 
rc2
.
À·
=
rc
.left;

232 
rc2
.
right
Ùc2.
À·
+ 
cy
;

233 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

234 
rc2
.
À·
=
rc
.
right
- 
cy
;

235 
rc2
.
right
Ùc2.
À·
+ 
cy
;

236 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

239 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

240 
cy
, cy,

241 
pD©a
->
°©us
 & 
SBS_LEFTARROW
);

243 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
right
-
cy
,Ñc.
t›
,

244 
cy
, cy,

245 
pD©a
->
°©us
 & 
SBS_RIGHTARROW
);

247 
	`Sñe˘Obje˘
(
hdc
,
	`GëStockObje˘
(
BLACK_BRUSH
));

249 
p3
[0].
x

rc
.
À·
 + 2 + 
shrök
;

250 
p3
[0].
y

rc
.
t›
 + (
cy
/2) ;

251 
p3
[1].
x

rc
.
À·
 + (
cy
-4Ë- 
shrök
 ;

252 
p3
[1].
y

rc
.
t›
 + 2 + 
shrök
;

253 
p3
[2].
x

rc
.
À·
 + (
cy
-4Ë- 
shrök
;

254 
p3
[2].
y

rc
.
bŸtom
 - 4 - 
shrök
 + 1;

255 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

257 
p3
[0].
x

rc
.
right
 - 4 - 
shrök
;

258 
p3
[0].
y

rc
.
t›
 + (
cy
/2) ;

259 
p3
[1].
x

rc
.
right
-
cy
 + 2 + 
shrök
 ;

260 
p3
[1].
y

rc
.
t›
 + 2 + 
shrök
;

261 
p3
[2].
x

rc
.
right
-
cy
 + 2 + 
shrök
;

262 
p3
[2].
y

rc
.
bŸtom
 - 4 - 
shrök
 + 1;

263 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

267 
	`wndGëHS¸ﬁlB¨Re˘
 (
hwnd
, &
rcHB¨
);

268 
rcHB¨
.
t›
 -- ;

271 
°¨t
 = 
rcHB¨
.
À·
 + 
cy
 + 
pD©a
->
b¨Sèπ
;

273 i‡(
°¨t
 + 
pD©a
->
b¨Lí
 > 
rcHB¨
.
right
)

274 
°¨t
 = 
rcHB¨
.
right
 - 
pD©a
->
b¨Lí
;

276 i‡(
pD©a
->
b¨Lí
 == 0)

277 
pD©a
->
b¨Lí
=
rc
.
right
-rc.
À·
-(
cy
*2);

280 
rc2
.
t›
=
rc
.t›;Ñc2.
bŸtom
=rc.bottom ;

281 
rc2
.
À·
=
rc
.À·+
cy
;

282 
rc2
.
right
=
°¨t
;

283 i‡(
rc2
.
right
>rc2.
À·
)

284 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

286 
rc2
.
À·
=
°¨t
+
pD©a
->
b¨Lí
;

287 
rc2
.
right
=
rc
.right-
cy
;

288 i‡(
rc2
.
right
>rc2.
À·
)

289 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

291 
	`Døw3dUpFøme
 (
hdc
, 
°¨t
, 
rcHB¨
.
t›
, sèπ + 
pD©a
->
b¨Lí
,

292 
rcHB¨
.
bŸtom
);

298 i‡(
fGŸDC
)

299 
	`Rñó£DC
(
hwnd
, 
hdc
);

300 
	}
}

304 
	$MwH™dÀMesßgeS¸ﬁlb¨
(
HWND
 
hwnd
, 
WPARAM
 
hôcode
, 
LPARAM
 
lP¨am
, 
UINT
 
msg
, 
DWORD
 
°yÀ
)

306 
pos
 = 
SBS_UNKNOWN
;

307 
BOOL
 
vîtb¨
 = (
°yÀ
==
SBS_VERT
);

308 
BOOL
 
h‹zb¨
 = (
°yÀ
==
SBS_HORZ
);

309 * 
pSèt
;

310 
POINT
 
±
;

311 
RECT
 
rc
;

313 
BOOL
 
bDøw
;

315 
downPos
 = 
SBS_UNKNOWN
;

316 
sbCode
;

317 
√wThumbPos
;

319 
ôemMovóbÀ
,
ôemCou¡
,
ôemVisibÀ
,
moveR™ge
;

320 
moveT›
,
moveBŸtom
,
moveLe·
,
moveRight
;

322 
cx
,
cy
;

323 
MWSCROLLBARINFO
* 
pD©a
;

325 
pD©a
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

326 
rc
 = 
hwnd
->
wöª˘
;

327 
cx
=
rc
.
right
-rc.
À·
;

328 
cy
=
rc
.
bŸtom
-rc.
t›
;

330 
	`POINTSTOPOINT
(
±
, 
lP¨am
);

332 i‡(
vîtb¨
)

334 
pSèt
 = &
pD©a
->
°©us
;

335 
rc
 = 
hwnd
->
wöª˘
;

336 
rc
.
bŸtom
 =Ñc.
t›
 + 
cx
;

337 i‡(
	`PtInRe˘
(&
rc
, 
±
))

339 
pos
 = 
SBS_UPARROW
;

342 
rc
.
bŸtom
 = 
hwnd
->
wöª˘
.bottom;

343 
rc
.
t›
 =Ñc.
bŸtom
 - 
cx
;

344 i‡(
	`PtInRe˘
(&
rc
, 
±
))

346 
pos
 = 
SBS_DOWNARROW
;

349 
pos
 = 
SBS_VERTTHUMB
;

350 } i‡(
h‹zb¨
)

352 
pSèt
 = &
pD©a
->
°©us
;

353 
rc
 = 
hwnd
->
wöª˘
;

354 
rc
.
right
 =Ñc.
À·
 + 
cy
;

355 i‡(
	`PtInRe˘
(&
rc
, 
±
)) {

356 
pos
 = 
SBS_LEFTARROW
;

359 
rc
.
right
 = 
hwnd
->
wöª˘
.right;

360 
rc
.
À·
 =Ñc.
right
 - 
cy
;

361 i‡(
	`PtInRe˘
(&
rc
, 
±
)) {

362 
pos
 = 
SBS_RIGHTARROW
;

365 
pos
 = 
SBS_HORZTHUMB
;

371 i‡(
pos
 =
SBS_UNKNOWN
)

374 *
pSèt
 &~
SBS_MASK
;

376 i‡(
msg
 =
WM_NCLBUTTONDOWN
 || msg =
WM_NCLBUTTONDBLCLK
)

377 *
pSèt
 |
pos
;

378 *
pSèt
 &~
pos
;

380 i‡(
msg
 =
WM_NCLBUTTONDOWN
 || msg =
WM_NCLBUTTONDBLCLK
)

381 
bDøw
=
TRUE
;

383 i‡(
bDøw
)

384 
	`MwPaötS¸ﬁlb¨s
(
hwnd
, 
NULL
,
°yÀ
);

386 i‡(
pos
 =
SBS_UPARROW
 ||Öo†=
SBS_LEFTARROW
)

388 i‡(
pD©a
->
curPos
 !pD©a->
möPos
)

389 
sbCode
 = 
SB_LINEUP
;

391 i‡(
pos
 =
SBS_DOWNARROW
 ||Öo†=
SBS_RIGHTARROW
)

393 i‡(
pD©a
->
curPos
 !pD©a->
maxPos
)

394 
sbCode
 = 
SB_LINEDOWN
;

396 i‡(
pos
 =
SBS_VERTTHUMB
 ||Öo†=
SBS_HORZTHUMB
)

398 
sbCode
 = 
SB_THUMBTRACK
;

401 
msg
)

403 
WM_NCLBUTTONDOWN
:

404 
WM_NCLBUTTONDBLCLK
:

405 
downPos
 = 
pos
;

408 
WM_NCMOUSEMOVE
:

409 i‡(
vîtb¨
)

411 i‡(
sbCode
 =
SB_THUMBTRACK
 && 
downPos
 =
SBS_VERTTHUMB
)

415 
rc
 = 
hwnd
->
wöª˘
;

416 
moveT›
 = 
rc
.
t›
 + 
cx
;

417 
moveBŸtom
 = 
hwnd
->
wöª˘
.
bŸtom
 - 
cx
;

418 
moveR™ge
 = 
moveBŸtom
 - 
moveT›
;

420 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

421 
ôemVisibÀ
 = 
pD©a
->
∑geSãp
;

422 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

424 
√wThumbPos
 = ((
±
.
y
 - 
moveT›
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

425 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

426 
±
.
y
,
moveT›
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

428 i‡–
√wThumbPos
 >
pD©a
->
möPos
 &&

429 
√wThumbPos
 <
pD©a
->
maxPos
)

431 
	`SídMesßge
 (
hwnd
,

432 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

434 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
),

435 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

440 i‡(
h‹zb¨
)

442 i‡(
sbCode
 =
SB_THUMBTRACK
 && 
downPos
 =
SBS_HORZTHUMB
)

446 
rc
 = 
hwnd
->
wöª˘
;

447 
moveLe·
 = 
rc
.
À·
 + 
cy
;

448 
moveRight
 = 
hwnd
->
wöª˘
.
right
 - 
cy
;

449 
moveR™ge
 = 
moveRight
 - 
moveLe·
;

451 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

452 
ôemVisibÀ
 = 
pD©a
->
∑geSãp
;

453 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

455 
√wThumbPos
 = ((
±
.
x
 - 
moveLe·
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

456 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

457 
±
.
y
,
moveLe·
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

459 i‡–
√wThumbPos
 >
pD©a
->
möPos
 &&

460 
√wThumbPos
 <
pD©a
->
maxPos
)

462 
	`SídMesßge
 (
hwnd
,

463 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

465 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
),

466 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

473 
WM_NCLBUTTONUP
:

474 
bDøw
=
FALSE
;

475 
downPos
 = 
SBS_UNKNOWN
;

477 i‡(
sbCode
==
SB_THUMBTRACK
)

479 i‡(
vîtb¨
)

483 
rc
 = 
hwnd
->
wöª˘
;

484 
moveT›
 = 
rc
.
t›
 + 
cx
;

485 
moveBŸtom
 = 
hwnd
->
wöª˘
.
bŸtom
 - 
cx
;

486 
moveR™ge
 = 
moveBŸtom
 - 
moveT›
;

488 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

489 
ôemVisibÀ
 = 
pD©a
->
∑geSãp
;

490 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

492 
√wThumbPos
 = ((
±
.
y
 - 
moveT›
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

493 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

494 
±
.
y
,
moveT›
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

496 i‡–
√wThumbPos
 >
pD©a
->
möPos
 &&

497 
√wThumbPos
 <
pD©a
->
maxPos
)

499 
	`SídMesßge
 (
hwnd
,

500 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

502 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
),

503 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

507 i‡(
h‹zb¨
)

511 
rc
 = 
hwnd
->
wöª˘
;

512 
moveLe·
 = 
rc
.
À·
 + 
cy
;

513 
moveRight
 = 
hwnd
->
wöª˘
.
right
 - 
cy
;

514 
moveR™ge
 = 
moveRight
 - 
moveLe·
;

516 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

517 
ôemVisibÀ
 = 
pD©a
->
∑geSãp
;

518 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

520 
√wThumbPos
 = ((
±
.
x
 - 
moveLe·
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

521 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

522 
±
.
y
,
moveLe·
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

524 i‡–
√wThumbPos
 >
pD©a
->
möPos
 &&

525 
√wThumbPos
 <
pD©a
->
maxPos
)

527 
	`SídMesßge
 (
hwnd
,

528 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

530 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
),

531 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

538 i‡(
vîtb¨
)

540 
	`SídMesßge
 (
hwnd
, 
WM_VSCROLL
, 
sbCode
, 0);

541 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
), 
WM_VSCROLL
, 
sbCode
, 0);

543 i‡(
h‹zb¨
)

545 
	`SídMesßge
 (
hwnd
, 
WM_HSCROLL
, 
sbCode
, 0);

546 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
), 
WM_HSCROLL
, 
sbCode
, 0);

551 
	}
}

554 
BOOL


555 
	$PtInRe˘2
(c⁄° 
RECT
 *
Õrc
, 
x
, 
y
)

557 
POINT
 
p
;

559 
p
.
x
 = x;

560 
p
.
y
 = y;

561  
	`PtInRe˘
(
Õrc
, 
p
);

562 
	}
}

565 
	$wndS¸ﬁlB¨Pos
 (
HWND
 
hwnd
, 
BOOL
 
bIsHB¨
, 
RECT
* 
rcB¨
)

567 
UINT
 
moveR™ge
;

568 
PMWSCROLLBARINFO
 
pSB¨
;

569 
cx
,
cy
;

570 
RECT
 
rc
;

572 
rc
 = 
hwnd
->
wöª˘
;

573 
cx
=
rc
.
right
-rc.
À·
;

574 
cy
=
rc
.
bŸtom
-rc.
t›
;

575 
pSB¨
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

577 i‡(
pSB¨
->
möPos
 =pSB¨->
maxPos
) {

578 
pSB¨
->
°©us
 |
SBS_HIDE
;

582 i‡(
bIsHB¨
)

583 
moveR™ge
 = (
rcB¨
->
right
 -ÑcB¨->
À·
Ë- (
cy
 << 1);

585 
moveR™ge
 = (
rcB¨
->
bŸtom
 -ÑcB¨->
t›
Ë- (
cx
 << 1);

588 i‡(
pSB¨
->
∑geSãp
 == 0)

590 
pSB¨
->
b¨Lí
 = 
MWM_DEFBARLEN
;

592 i‡(
pSB¨
->
b¨Lí
 > 
moveR™ge
)

593 
pSB¨
->
b¨Lí
 = 
MWM_MINBARLEN
;

597 
pSB¨
->
b¨Lí
 = 
moveR™ge
 *ÖSB¨->
∑geSãp
 /

598 (
pSB¨
->
maxPos
 -ÖSB¨->
möPos
 + 1);

599 i‡(
pSB¨
->
b¨Lí
 < 
MWM_MINBARLEN
)

600 
pSB¨
->
b¨Lí
 = 
MWM_MINBARLEN
;

603 
pSB¨
->
b¨Sèπ
 = 
moveR™ge
 * (pSB¨->
curPos
 -ÖSB¨->
möPos
) /

604 (
pSB¨
->
maxPos
 -ÖSB¨->
möPos
 + 1);

607 i‡(
pSB¨
->
b¨Sèπ
 +ÖSB¨->
b¨Lí
 > 
moveR™ge
)

608 
pSB¨
->
b¨Sèπ
 = 
moveR™ge
 -ÖSB¨->
b¨Lí
;

611 i‡(
pSB¨
->
b¨Sèπ
 < 0)

612 
pSB¨
->
b¨Sèπ
 = 0;

613 
	}
}

615 
PMWSCROLLBARINFO
 
	$wndGëS¸ﬁlB¨
 (
HWND
 
pWö
)

617 
MWSCROLLBARINFO
* 
pD©a
;

619 
pD©a
 = (
MWSCROLLBARINFO
 *)
pWö
->
u£rd©a
;

621 i‡(!
	`°rcmp
(
pWö
->
pCœss
->
ÕszCœssName
,"SCROLLBAR"))

622  
pD©a
;

624  
NULL
;

625 
	}
}

627 
BOOL
 
	$E«bÀS¸ﬁlB¨Ex
 (
HWND
 
hWnd
, 
iSB¨
, 
BOOL
 
bE«bÀ
)

629 
PMWSCROLLBARINFO
 
pSB¨
;

630 
HWND
 
pWö
;

631 
BOOL
 
bPªvSèã
;

632 
RECT
 
rcB¨
;

634 
DWORD
 
dwStyÀ
;

636 
pWö
 = (
HWND
)
hWnd
;

638 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

639  
FALSE
;

641 
bPªvSèã
 = !(
pSB¨
->
°©us
 & 
SBS_DISABLED
);

643 i‡(
bE«bÀ
 && !
bPªvSèã
)

644 
pSB¨
->
°©us
 &~
SBS_DISABLED
;

645 i‡(!
bE«bÀ
 && 
bPªvSèã
)

646 
pSB¨
->
°©us
 |
SBS_DISABLED
;

648  
FALSE
;

650 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hWnd
Ë& 
SBS_TYPEMASK
);

652 i‡(
dwStyÀ
 =
SBS_VERT
)

654 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

655 
rcB¨
.
À·
 --;

656 
rcB¨
.
right
 --;

660 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

661 
rcB¨
.
t›
 --;

662 
rcB¨
.
bŸtom
 --;

665 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

667 
	`MwPaötS¸ﬁlb¨s
(
hWnd
,
NULL
,
dwStyÀ
);

670  
TRUE
;

671 
	}
}

673 
BOOL
 
	$GëS¸ﬁlPosEx
 (
HWND
 
hWnd
, 
iSB¨
, * 
pPos
)

675 
PMWSCROLLBARINFO
 
pSB¨
;

676 
HWND
 
pWö
;

678 
pWö
 = (
HWND
)
hWnd
;

680 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

681  
FALSE
;

683 *
pPos
 = 
pSB¨
->
curPos
;

684  
TRUE
;

685 
	}
}

687 
BOOL
 
	$GëS¸ﬁlR™geEx
 (
HWND
 
hWnd
, 
iSB¨
, * 
pMöPos
, * 
pMaxPos
)

689 
PMWSCROLLBARINFO
 
pSB¨
;

690 
HWND
 
pWö
;

692 
pWö
 = (
HWND
)
hWnd
;

694 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

695  
FALSE
;

697 *
pMöPos
 = 
pSB¨
->
möPos
;

698 *
pMaxPos
 = 
pSB¨
->
maxPos
;

699  
TRUE
;

700 
	}
}

702 
BOOL
 
	$SëS¸ﬁlPosEx
 (
HWND
 
hWnd
, 
iSB¨
, 
iNewPos
)

704 
PMWSCROLLBARINFO
 
pSB¨
;

705 
HWND
 
pWö
;

706 
RECT
 
rcB¨
;

708 
DWORD
 
dwStyÀ
;

710 
pWö
 = (
HWND
)
hWnd
;

712 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

713  
FALSE
;

715 i‡(
iNewPos
 < 
pSB¨
->
möPos
)

716 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

718 
pSB¨
->
curPos
 = 
iNewPos
;

721 
max
 = 
pSB¨
->
maxPos
;

722 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

724 i‡(
pSB¨
->
curPos
 > 
max
)

725 
pSB¨
->
curPos
 = 
max
;

728 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hWnd
Ë& 
SBS_TYPEMASK
);

730 i‡(
dwStyÀ
 =
SBS_VERT
)

732 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

733 
rcB¨
.
À·
 --;

734 
rcB¨
.
right
 --;

738 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

739 
rcB¨
.
t›
 --;

740 
rcB¨
.
bŸtom
 --;

743 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
dwStyÀ
 =
SBS_HORZ
, &
rcB¨
);

746 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

748 
	`MwPaötS¸ﬁlb¨s
(
hWnd
,
NULL
,
dwStyÀ
);

750  
TRUE
;

751 
	}
}

753 
BOOL
 
	$SëS¸ﬁlR™geEx
 (
HWND
 
hWnd
, 
iSB¨
, 
iMöPos
, 
iMaxPos
)

755 
PMWSCROLLBARINFO
 
pSB¨
;

756 
HWND
 
pWö
;

757 
RECT
 
rcB¨
;

759 
DWORD
 
dwStyÀ
;

761 
pWö
 = (
HWND
)
hWnd
;

763 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

764  
FALSE
;

766 
pSB¨
->
möPos
 = (
iMöPos
 < 
iMaxPos
)?iMinPos:iMaxPos;

767 
pSB¨
->
maxPos
 = (
iMöPos
 > 
iMaxPos
)?iMinPos:iMaxPos;

770 i‡(
pSB¨
->
curPos
 <ÖSB¨->
möPos
)

771 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

773 i‡(
pSB¨
->
∑geSãp
 <= 0)

774 
pSB¨
->
∑geSãp
 = 0;

775 i‡(
pSB¨
->
∑geSãp
 > (pSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1))

776 
pSB¨
->
∑geSãp
 =ÖSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1;

779 
max
 = 
pSB¨
->
maxPos
;

780 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

782 i‡(
pSB¨
->
curPos
 > 
max
)

783 
pSB¨
->
curPos
 = 
max
;

786 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hWnd
Ë& 
SBS_TYPEMASK
);

788 i‡(
dwStyÀ
 =
SBS_VERT
)

790 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

791 
rcB¨
.
À·
 --;

792 
rcB¨
.
right
 --;

796 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

797 
rcB¨
.
t›
 --;

798 
rcB¨
.
bŸtom
 --;

800 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
dwStyÀ
 =
SBS_HORZ
, &
rcB¨
);

803 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

805 
	`MwPaötS¸ﬁlb¨s
(
hWnd
,
NULL
,
dwStyÀ
);

808  
TRUE
;

809 
	}
}

811 
BOOL
 
	$SëS¸ﬁlInfoEx
 (
HWND
 
hWnd
, 
iSB¨
,

812 
LPCSCROLLINFO
 
Õsi
, 
BOOL
 
fRedøw
)

814 
PMWSCROLLBARINFO
 
pSB¨
;

815 
HWND
 
pWö
;

816 
RECT
 
rcB¨
;

818 
DWORD
 
dwStyÀ
;

820 
pWö
 = (
HWND
)
hWnd
;

822 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

823  
FALSE
;

825 if–
Õsi
->
fMask
 & 
SIF_RANGE
 )

827 
pSB¨
->
möPos
 = (
Õsi
->
nMö
 <Üpsi->
nMax
)?lpsi->nMin:lpsi->nMax;

828 
pSB¨
->
maxPos
 = (
Õsi
->
nMö
 <Üpsi->
nMax
)?lpsi->nMax:lpsi->nMin;

831 if–
Õsi
->
fMask
 & 
SIF_POS
 )

832 
pSB¨
->
curPos
 = 
Õsi
->
nPos
;

834 if–
Õsi
->
fMask
 & 
SIF_PAGE
 )

835 
pSB¨
->
∑geSãp
 = 
Õsi
->
nPage
;

838 i‡(
pSB¨
->
curPos
 <ÖSB¨->
möPos
)

839 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

841 i‡(
pSB¨
->
∑geSãp
 <= 0)

842 
pSB¨
->
∑geSãp
 = 0;

843 i‡(
pSB¨
->
∑geSãp
 > (pSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1))

844 
pSB¨
->
∑geSãp
 =ÖSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1;

847 
max
 = 
pSB¨
->
maxPos
;

848 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

850 i‡(
pSB¨
->
curPos
 > 
max
)

851 
pSB¨
->
curPos
 = 
max
;

854 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hWnd
Ë& 
SBS_TYPEMASK
);

856 if(
fRedøw
)

858 i‡(
dwStyÀ
 =
SBS_VERT
)

860 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

861 
rcB¨
.
À·
 --;

862 
rcB¨
.
right
 --;

866 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

867 
rcB¨
.
t›
 --;

868 
rcB¨
.
bŸtom
 --;

870 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
dwStyÀ
 =
SBS_HORZ
, &
rcB¨
);

873 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

875 
	`MwPaötS¸ﬁlb¨s
(
hWnd
,
NULL
,
dwStyÀ
);

879  
TRUE
;

880 
	}
}

882 
BOOL
 
	$GëS¸ﬁlInfoEx
(
HWND
 
hWnd
, 
iSB¨
, 
LPSCROLLINFO
 
Õsi
)

884 
PMWSCROLLBARINFO
 
pSB¨
;

885 
HWND
 
pWö
;

887 
pWö
 = (
HWND
)
hWnd
;

889 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

890  
FALSE
;

892 if–
Õsi
->
fMask
 & 
SIF_RANGE
 )

894 
Õsi
->
nMö
 = 
pSB¨
->
möPos
;

895 
Õsi
->
nMax
 = 
pSB¨
->
maxPos
;

898 if–
Õsi
->
fMask
 & 
SIF_POS
 )

900 
Õsi
->
nPos
 = 
pSB¨
->
curPos
;

903 if–
Õsi
->
fMask
 & 
SIF_PAGE
 )

904 
Õsi
->
nPage
 = 
pSB¨
->
∑geSãp
;

906  
TRUE
;

907 
	}
}

909 
BOOL
 
	$ShowS¸ﬁlB¨Ex
 (
HWND
 
hWnd
, 
iSB¨
, 
BOOL
 
bShow
)

911 
PMWSCROLLBARINFO
 
pSB¨
;

912 
HWND
 
pWö
;

913 
BOOL
 
bPªvSèã
;

914 
RECT
 
rcB¨
;

916 
DWORD
 
dwStyÀ
;

918 
pWö
 = (
HWND
)
hWnd
;

920 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
)) )

921  
FALSE
;

923 
bPªvSèã
 = !(
pSB¨
->
°©us
 & 
SBS_HIDE
);

925 i‡(
bShow
 && !
bPªvSèã
)

926 
pSB¨
->
°©us
 &~
SBS_HIDE
;

927 i‡(!
bShow
 && 
bPªvSèã
)

928 
pSB¨
->
°©us
 |
SBS_HIDE
;

930  
FALSE
;

933 
	`SídMesßge
 (
hWnd
, 
WM_CHANGESIZE
, 0, 0);

936 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hWnd
Ë& 
SBS_TYPEMASK
);

938 i‡(
dwStyÀ
 =
SBS_VERT
)

939 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

941 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

944 
RECT
 
rcWö
, 
rcClõ¡
;

946 
	`mem˝y
 (&
rcWö
, &
pWö
->
wöª˘
.
À·
,  (
RECT
));

948 
rcClõ¡
.
À·
 = 0;

949 
rcClõ¡
.
t›
 = 0;

950 
rcClõ¡
.
right
 = 
pWö
->
˛úe˘
.righà-ÖWö->˛úe˘.
À·
;

951 
rcClõ¡
.
bŸtom
 = 
pWö
->
˛úe˘
.bŸtom -ÖWö->˛úe˘.
t›
;

953 
	`SídMesßge
 (
hWnd
, 
WM_SIZECHANGED
,

954 (
WPARAM
)&
rcWö
, (
LPARAM
)&
rcClõ¡
);

958 i‡(
bShow
) {

959 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, 0);

962 
rcB¨
.
À·
 -
pWö
->
˛úe˘
.left;

963 
rcB¨
.
t›
 -
pWö
->
˛úe˘
.top;

964 
rcB¨
.
right
 -
pWö
->
˛úe˘
.
À·
;

965 
rcB¨
.
bŸtom
 -
pWö
->
˛úe˘
.
t›
;

966 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, 0);

967 
	`InvÆid©eRe˘
 (
hWnd
, &
rcB¨
, 
TRUE
);

970  
TRUE
;

971 
	}
}

973 
	$sbSëS¸ﬁlInfo
 (
HWND
 
hwnd
, 
PMWSCROLLBARINFO
 
pD©a
, 
BOOL
 
fRedøw
)

975 
SCROLLINFO
 
si
;

977 
ôemCou¡
,
ôemVisibÀs
;

979 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

980 
ôemVisibÀs
 = 
pD©a
->
∑geSãp
;

982 i‡(
ôemVisibÀs
 >
ôemCou¡
)

984 
	`SëS¸ﬁlPosEx
 (
hwnd
, 0, 0);

985 
	`E«bÀS¸ﬁlB¨Ex
 (
hwnd
, 0, 
FALSE
);

989 
si
.
fMask
 = 
SIF_RANGE
 | 
SIF_PAGE
 | 
SIF_POS
;

990 
si
.
nMax
 = 
ôemCou¡
 - 1;

991 
si
.
nMö
 = 0;

993 
si
.
nPage
 = 
ôemVisibÀs
;

995 
si
.
nPos
 = 
pD©a
->
curPos
;

997 
	`SëS¸ﬁlInfoEx
 (
hwnd
, 0, &
si
, 
fRedøw
);

998 
	`E«bÀS¸ﬁlB¨Ex
 (
hwnd
, 0, 
TRUE
);

999 
	}
}

1001 
LRESULT
 
CALLBACK


1002 
	$S¸ﬁlb¨C⁄åﬁProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

1004 
DWORD
 
dwStyÀ
;

1005 
MWSCROLLBARINFO
* 
pD©a
;

1007 
moveR™ge
;

1008 
RECT
 
rcB¨
;

1010 
dwStyÀ
 = (
	`GëWödowStyÀ
 (
hwnd
Ë& 
SBS_TYPEMASK
);

1011 
mesßge
)

1013 
WM_CREATE
:

1014 i‡(!(
pD©a
 = 
	`mÆloc
 ( (
MWSCROLLBARINFO
))))

1016 
	`Ârötf
(
°dîr
, "Create scroll bar control failure!\n");

1020 
pD©a
->
möPos
=0;

1022 
pD©a
->
maxPos
=0;

1023 i‡(
dwStyÀ
==
SBS_VERT
)

1024 
moveR™ge
=((
hwnd
->
wöª˘
.
bŸtom
-hwnd->wöª˘.
t›
)

1025 -((
hwnd
->
wöª˘
.
right
-hwnd->wöª˘.
À·
)<<1));

1027 
moveR™ge
=((
hwnd
->
wöª˘
.
right
-hwnd->wöª˘.
À·
)

1028 -((
hwnd
->
wöª˘
.
bŸtom
-hwnd->wöª˘.
t›
)<<1));

1029 i‡(
moveR™ge
 > 
MWM_MINBARLEN
)

1033 
pD©a
->
maxPos
=
moveR™ge
 / 
MWM_MINBARLEN
;

1034 if–(
moveR™ge
 % 
MWM_MINBARLEN
) )

1035 
pD©a
->
maxPos
++;

1037 
	`¥ötf
("maxPos=%d\n",
pD©a
->
maxPos
);

1039 
pD©a
->
curPos
=0;

1042 
pD©a
->
∑geSãp
=1;

1043 i‡–(
pD©a
->
maxPos
 - 2) > 1)

1044 
pD©a
->
∑geSãp
 =ÖD©a->
maxPos
 - 2;

1045 
	`¥ötf
("∑geSãp=%d\n",
pD©a
->
∑geSãp
);

1047 
pD©a
->
b¨Sèπ
=0;

1048 
pD©a
->
b¨Lí
=
MWM_MINBARLEN
;

1049 
pD©a
->
°©us
=
SBS_UNKNOWN
;

1051 
pD©a
->
rc
=
hwnd
->
wöª˘
;

1053 
hwnd
->
u£rd©a
 = (
DWORD
)
pD©a
;

1055 i‡(
dwStyÀ
 =
SBS_VERT
)

1057 
	`wndGëVS¸ﬁlB¨Re˘
 (
hwnd
, &
rcB¨
);

1058 
rcB¨
.
À·
 --;

1059 
rcB¨
.
right
 --;

1063 
	`wndGëHS¸ﬁlB¨Re˘
 (
hwnd
, &
rcB¨
);

1064 
rcB¨
.
t›
 --;

1065 
rcB¨
.
bŸtom
 --;

1068 
	`wndS¸ﬁlB¨Pos
 (
hwnd
, 
dwStyÀ
 =
SBS_HORZ
, &
rcB¨
);

1072 
WM_DESTROY
:

1073 
	`‰ì
 ((*)(
hwnd
->
u£rd©a
));

1076 
WM_PAINT
:

1077 
	`MwPaötS¸ﬁlb¨s
(
hwnd
,
NULL
,
dwStyÀ
);

1080 
WM_NCLBUTTONDOWN
:

1081 
WM_NCLBUTTONDBLCLK
:

1082 
WM_NCMOUSEMOVE
:

1083 
WM_NCLBUTTONUP
:

1084 
	`MwH™dÀMesßgeS¸ﬁlb¨
(
hwnd
, 
wP¨am
, 
lP¨am
, 
mesßge
, 
dwStyÀ
);

1087 
WM_HSCROLL
:

1088 
WM_VSCROLL
:

1090 
√wT›
,
ôemCou¡
,
ôemVisibÀs
;

1092 
pD©a
 = (
MWSCROLLBARINFO
 *)
hwnd
->
u£rd©a
;

1093 
√wT›
 = 
pD©a
->
curPos
;

1094 
ôemCou¡
 = 
pD©a
->
maxPos
 -ÖD©a->
möPos
 + 1;

1095 
ôemVisibÀs
 = 
pD©a
->
∑geSãp
;

1097 
wP¨am
)

1099 
SB_LINEDOWN
:

1100 
	#ITEM_BOTTOM
(
x
Ë(x->
curPos
 + 
ôemVisibÀs
 - 1)

	)

1101 i‡(
	`ITEM_BOTTOM
 (
pD©a
Ë< (
ôemCou¡
 - 1 ))

1103 
√wT›
 ++;

1107 
SB_LINEUP
:

1108 i‡(
pD©a
->
curPos
 > 0)

1110 
√wT›
 --;

1114 
SB_PAGEDOWN
:

1115 i‡((
pD©a
->
curPos
 + (
ôemVisibÀs
 << 1)) <=

1116 
ôemCou¡
)

1117 
√wT›
 +
ôemVisibÀs
;

1119 
√wT›
 = 
ôemCou¡
 - 
ôemVisibÀs
;

1121 i‡(
√wT›
 < 0)

1126 
SB_PAGEUP
:

1127 i‡(
pD©a
->
curPos
 >
ôemVisibÀs
)

1128 
√wT›
 -
ôemVisibÀs
;

1130 
√wT›
 = 0;

1134 
SB_THUMBTRACK
:

1135 
√wT›
 = ()
lP¨am
;

1139 
pD©a
->
curPos
 = 
√wT›
;

1141 
	`SídMesßge
 (
hwnd
, 
WM_PAINT
, 0, 0);

1143 
	`sbSëS¸ﬁlInfo
 (
hwnd
, 
pD©a
, 
TRUE
);

1150  
	`DefWödowProc
 (
hwnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

1153 
	}
}

	@mwin/winlib/static.c

45 
	~<°dio.h
>

46 
	~<°dlib.h
>

47 
	~<°rög.h
>

48 
	#MWINCLUDECOLORS


	)

49 
	~"wödows.h
"

50 
	~"wötoﬁs.h
"

51 
	~"devi˚.h
"

54 
	#FONT_NAME
 
SYSTEM_FIXED_FONT


	)

56 
LRESULT
 
CALLBACK


57 
SèticC⁄åﬁProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
);

59 
WINAPI
 
	$MwRegi°îSèticC⁄åﬁ
(
HINSTANCE
 
hIn°™˚
)

61 
WNDCLASS
 
wc
;

63 
wc
.
°yÀ
 = 
CS_HREDRAW
 | 
CS_VREDRAW
 | 
CS_DBLCLKS
 | 
CS_GLOBALCLASS
;

64 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
SèticC⁄åﬁProc
;

65 
wc
.
cbClsExåa
 = 0;

66 
wc
.
cbWndExåa
 = 0;

67 
wc
.
hIn°™˚
 = hInstance;

68 
wc
.
hIc⁄
 = 
NULL
;

69 
wc
.
hCurs‹
 = 0;

70 
wc
.
hbrBackground

	`GëStockObje˘
(
WHITE_BRUSH
);

71 
wc
.
ÕszMíuName
 = 
NULL
;

72 
wc
.
ÕszCœssName
= "STATIC";

74  
	`Regi°îCœss
(&
wc
);

75 
	}
}

78 
	#RECTW
(
rc
Ë‘c.
right
-rc.
À·
)

	)

79 
	#RECTH
(
rc
Ë‘c.
bŸtom
-rc.
t›
)

	)

81 
DWORD
 
	$GëWödowStyÀ
 (
HWND
 
hwnd
)

83  
hwnd
->
°yÀ
;

84 
	}
}

86 
COLORREF
 
	$GëWödowBkCﬁ‹
 (
HWND
 
hwnd
)

88 
MWBRUSHOBJ
 *
hbr
;

89 
hbr
=(
MWBRUSHOBJ
 *)
hwnd
->
pCœss
->
hbrBackground
;

90  
hbr
->
cﬁ‹
;

91 
	}
}

93 *
	$GëWödowC≠ti⁄
 (
HWND
 
hwnd
)

95  
hwnd
->
szTôÀ
;

96 
	}
}

98 
	$SëWödowC≠ti⁄
 (
HWND
 
hwnd
,*
ˇ±i⁄
)

100 i‡(
	`°æí
(
ˇ±i⁄
)<=63)

101 
	`°r˝y
(
hwnd
->
szTôÀ
,
ˇ±i⁄
);

104 
	`°∫˝y
(
hwnd
->
szTôÀ
,
ˇ±i⁄
,63);

105 
hwnd
->
szTôÀ
[63]='\0';

107 
	}
}

109 
	$GëSysCh¨Height
 (
HWND
 
hwnd
)

111 
HDC
 
hdc
;

112 
xw
, 
xh
, 
xb
;

114 
hdc
 = 
	`GëDC
(
hwnd
);

116 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONT_NAME
));

118 #i‡
MWCLIENT


119 
	`GrGëGCTextSize
(
hdc
->
gc
, "X", 1, 
MWTF_ASCII
, &
xw
, &
xh
, &
xb
);

121 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

123 
	`Rñó£DC
(
hwnd
,
hdc
);

125  
xh
;

126 
	}
}

128 
	$GëSysCh¨Width
 (
HWND
 
hwnd
)

130 
HDC
 
hdc
;

131 
xw
, 
xh
, 
xb
;

133 
hdc
 = 
	`GëDC
(
hwnd
);

135 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONT_NAME
));

137 #i‡
MWCLIENT


138 
	`GrGëGCTextSize
(
hdc
->
gc
, "X", 1, 
MWTF_ASCII
, &
xw
, &
xh
, &
xb
);

140 
	`GdGëTextSize
(
hdc
->
f⁄t
->
pf⁄t
,"X",1, &
xw
,&
xh
,&
xb
,
MWTF_ASCII
);

142 
	`Rñó£DC
(
hwnd
,
hdc
);

144  
xw
;

145 
	}
}

148 
LRESULT
 
CALLBACK


149 
	$SèticC⁄åﬁProc
 (
HWND
 
hwnd
, 
UINT
 
mesßge
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

151 
RECT
 
rcClõ¡
;

152 
HDC
 
hdc
;

153 * 
•C≠ti⁄
;

154 
HWND
 
pCål
;

155 
UINT
 
uF‹m©
;

156 
DWORD
 
dwStyÀ
;

158 
pCål
 = 
hwnd
;

159 
mesßge
) {

160 
WM_CREATE
:

163 
WM_DESTROY
:

166 
STM_GETIMAGE
:

167  ()(
pCål
->
u£rd©a
);

169 
STM_SETIMAGE
:

171 
pOldVÆue
;

173 
pOldVÆue
 = ()(
pCål
->
u£rd©a
);

174 
pCål
->
u£rd©a
 = (
DWORD
)
wP¨am
;

175 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
FALSE
);

176  
pOldVÆue
;

179 
WM_GETDLGCODE
:

180  
DLGC_STATIC
;

183 
WM_PAINT
:

185 
PAINTSTRUCT
 
ps
;

186 
RECT
 
rc
;

187 
HBRUSH
 
hbr
;

189 
hdc
 = 
	`BegöPaöt
 (
hwnd
,&
ps
);

191 
	`GëClõ¡Re˘
 (
hwnd
, &
rcClõ¡
);

193 
	`Fa°FûlRe˘
(
hdc
, &
rcClõ¡
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

195 
dwStyÀ
 = 
	`GëWödowStyÀ
 (
hwnd
);

197 
dwStyÀ
 & 
SS_TYPEMASK
)

199 
SS_GRAYRECT
:

201 
	`SëBrushCﬁ‹
 (
hdc
, 
LTGRAY
);

202 
	`FûlBox
(
hdc
, 0, 0, 
	`RECTW
(
rcClõ¡
), 
	`RECTH
(rcClient));

204 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
	`RECTH
(
rcClõ¡
);Ñc.
right
=
	`RECTW
(rcClient);

205 
	`FûlRe˘
(
hdc
,&
rc
,
	`GëStockObje˘
(
LTGRAY_BRUSH
));

209 
SS_GRAYFRAME
:

211 
	`Døw3DDownFøme
 (
hdc
,

212 0, 0, 
rcClõ¡
.
right
,ÑcClõ¡.
bŸtom
,

213 
DKGRAY
);

215 
	`Døw3dIn£t
(
hdc
, 0, 0,

216 
rcClõ¡
.
right
,ÑcClõ¡.
bŸtom
);

220 
SS_BITMAP
:

222 
	`FûlBoxWôhBôm≠
(
hdc
, 0, 0, 0, 0,

223 (
PBITMAP
)(
pCål
->
u£rd©a
));

227 
SS_ICON
:

229 
hIc⁄
 = (
HICON
)(
pCål
->
u£rd©a
);

230 
	`DøwIc⁄
 (
hdc
, 0, 0, 0, 0, 
hIc⁄
);

234 
SS_SIMPLE
:

236 
	`SëBrushCﬁ‹
 (
hdc
, 
	`GëWödowBkCﬁ‹
 (
hwnd
));

237 
	`FûlBox
 (
hdc
, 0, 0, 
rcClõ¡
.
right
,ÑcClõ¡.
bŸtom
);

239 
hbr
=
	`Cª©eSﬁidBrush
(
	`GëWödowBkCﬁ‹
(
hwnd
));

240 
rc
.
À·
=0;Ñc.
t›
=0;Ñc.
bŸtom
=
rcClõ¡
.bŸtom;Ñc.
right
=rcClient.right;

241 
	`FûlRe˘
(
hdc
,&
rc
,
hbr
);

242 
	`DñëeObje˘
(
hbr
);

244 i‡(
dwStyÀ
 & 
WS_DISABLED
)

245 
	`SëTextCﬁ‹
 (
hdc
, 
DKGRAY
);

247 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
);

248 
	`SëBkCﬁ‹
(
hdc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

249 
•C≠ti⁄
 = 
	`GëWödowC≠ti⁄
 (
hwnd
);

250 i‡(
•C≠ti⁄
)

252 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONT_NAME
));

253 
	`TextOut
 (
hdc
, 0, 0, 
•C≠ti⁄
, -1);

257 
SS_LEFT
:

258 
SS_CENTER
:

259 
SS_RIGHT
:

260 
SS_LEFTNOWORDWRAP
:

261 
uF‹m©
 = 
DT_TOP
;

262 i‡–(
dwStyÀ
 & 
SS_TYPEMASK
Ë=
SS_LEFT
)

263 
uF‹m©
 |
DT_LEFT
 | 
DT_WORDBREAK
;

264 i‡–(
dwStyÀ
 & 
SS_TYPEMASK
Ë=
SS_CENTER
)

265 
uF‹m©
 |
DT_CENTER
 | 
DT_WORDBREAK
;

266 i‡–(
dwStyÀ
 & 
SS_TYPEMASK
Ë=
SS_RIGHT
)

267 
uF‹m©
 |
DT_RIGHT
 | 
DT_WORDBREAK
;

268 i‡–(
dwStyÀ
 & 
SS_TYPEMASK
Ë=
SS_LEFTNOWORDWRAP
)

269 
uF‹m©
 |
DT_LEFT
 | 
DT_SINGLELINE
 | 
DT_EXPANDTABS
;

271 i‡(
dwStyÀ
 & 
WS_DISABLED
)

272 
	`SëTextCﬁ‹
 (
hdc
, 
DKGRAY
);

274 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
);

277 
	`SëBkCﬁ‹
 (
hdc
, 
	`GëWödowBkCﬁ‹
 (
hwnd
));

279 
	`SëBkCﬁ‹
(
hdc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

280 
•C≠ti⁄
 = 
	`GëWödowC≠ti⁄
 (
hwnd
);

281 i‡(
dwStyÀ
 & 
SS_NOPREFIX
)

282 
uF‹m©
 |
DT_NOPREFIX
;

284 i‡(
•C≠ti⁄
)

286 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONT_NAME
));

287 
	`DøwText
 (
hdc
, 
•C≠ti⁄
, -1, &
rcClõ¡
, 
uF‹m©
);

291 
SS_GROUPBOX
:

293 
	`Døw3DB‹dî
 (
hdc
, 
rcClõ¡
.
À·
,

294 
rcClõ¡
.
t›
 + (
	`GëSysCh¨Height
(
hwnd
) >> 1),

295 
rcClõ¡
.
right
,ÑcClõ¡.
bŸtom
);

297 
	`Døw3dIn£t
(
hdc
, 
rcClõ¡
.
À·
,

298 
rcClõ¡
.
t›
+(
	`GëSysCh¨Height
(
hwnd
) >> 1),

299 
rcClõ¡
.
right
-rcClõ¡.
À·
,

300 
rcClõ¡
.
bŸtom
-rcClõ¡.
t›
);

302 i‡(
dwStyÀ
 & 
WS_DISABLED
)

303 
	`SëTextCﬁ‹
 (
hdc
, 
DKGRAY
);

305 
	`SëTextCﬁ‹
 (
hdc
, 
BLACK
);

308 
	`SëBkCﬁ‹
(
hdc
, 
	`GëWödowBkCﬁ‹
 (
	`GëP¨ít
 (
hwnd
)));

310 
	`SëBkCﬁ‹
(
hdc
, 
	`GëSysCﬁ‹
(
COLOR_BTNFACE
));

311 
•C≠ti⁄
 = 
	`GëWödowC≠ti⁄
 (
hwnd
);

312 i‡(
•C≠ti⁄
)

314 
	`Sñe˘Obje˘
(
hdc
, 
	`GëStockObje˘
(
FONT_NAME
));

315 
	`TextOut
 (
hdc
, 
	`GëSysCh¨Width
 (
hwnd
), 2, 
•C≠ti⁄
, -1);

319 
	`EndPaöt
 (
hwnd
, &
ps
);

324 
WM_LBUTTONDBLCLK
:

325 i‡(
	`GëWödowStyÀ
 (
hwnd
Ë& 
SS_NOTIFY
)

326 
	`SídMesßge
 (
	`GëP¨ít
(
hwnd
), 
WM_COMMAND
,

327 (
WPARAM
)
	`MAKELONG
(
pCål
->
id
, 
STN_DBLCLK
),

328 (
LPARAM
)
hwnd
);

331 
WM_LBUTTONDOWN
:

334 
WM_NCLBUTTONDBLCLK
:

337 
WM_NCLBUTTONDOWN
:

340 
WM_NCHITTEST
:

341 
dwStyÀ
 = 
	`GëWödowStyÀ
 (
hwnd
);

342 i‡((
dwStyÀ
 & 
SS_TYPEMASK
Ë=
SS_GROUPBOX
)

343  
HTTRANSPARENT
;

346 i‡(
	`GëWödowStyÀ
 (
hwnd
Ë& 
SS_NOTIFY
)

347  
HTCLIENT
;

350  
HTNOWHERE
;

355 
WM_GETFONT
:

357 
WM_SETFONT
:

360 
WM_SETTEXT
:

361 
	`SëWödowC≠ti⁄
 (
hwnd
, (*)
lP¨am
);

362 
	`InvÆid©eRe˘
 (
hwnd
, 
NULL
, 
TRUE
);

366  
	`DefWödowProc
 (
hwnd
, 
mesßge
, 
wP¨am
, 
lP¨am
);

369 
	}
}

	@mwin/winmain.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<°rög.h
>

9 
	~<sig«l.h
>

11 #i‚de‡
__PACIFIC__


12 
	~<î∫o.h
>

13 
	~<sys/ty≥s.h
>

16 #i‡
UNIX
 | 
DOS_DJGPP


17 
	~<uni°d.h
>

18 #i‡
_MINIX


19 
	~<sys/times.h
>

21 
	~<sys/time.h
>

25 #i‡
ELKS


26 
	~<löuxmt/posix_ty≥s.h
>

27 
	~<löuxmt/time.h
>

30 #i‡
RTEMS


31 
	~<πems/mw_uid.h
>

34 #i‡
PSP


35 
	~<p•utûs.h
>

36 
	~<p•kî√l.h
>

37 
	~<p•debug.h
>

40 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

41 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

43 
	#¥ötf
(...)

	)

44 
	#Ârötf
(...)

	)

49 
	~"wödows.h
"

50 
	~"wöã∫.h
"

51 
	~"devi˚.h
"

56 
HWND
 
	gli°wp
;

57 
HWND
 
	groŸwp
;

58 
HWND
 
	gfocuswp
;

59 
HWND
 
	gmou£wp
;

60 
HWND
 
	gˇ±uªwp
;

61 
HWND
 
	gdøgwp
;

62 
HCURSOR
 
	gcurcurs‹
;

63 
MWCOORD
 
	gcurs‹x
;

64 
MWCOORD
 
	gcurs‹y
;

65 
DWORD
 
	g°¨tTicks
;

66 
	gkeyb_fd
;

67 
	gmou£_fd
;

68 
	gesˇ≥_quôs
 = 1;

71 
	$maö
(
ac
,**
av
)

75 if(
	`MwU£rInô
(
ac
, 
av
) < 0)

76 
	`exô
(1);

78 if(
	`MwO≥n
() < 0)

79 
	`exô
(1);

82 
	`WöMaö
(
NULL
, NULL, NULL, 
SW_SHOW
);

84 
	`MwClo£
();

86 
	}
}

93 
	$MwO≥n
()

98 if(
	`MwInôülize
() < 0)

101 
	}
}

107 
	$MwClo£
()

109 
	`MwTîmö©e
();

110 
	}
}

112 #i‡(
UNIX
 | 
DOS_DJGPP
Ë&& !
_MINIX


128 
HWND
 
	mªad
;

129 
HWND
 
	mwrôe
;

130 
HWND
 
	mex˚±
;

131 
	m√xt
;

132 } 
	tWNDUSERFD
;

134 
WNDUSERFD
 
	gu£ºegfd
[
FD_SETSIZE
];

135 
	gu£ºegfd_hód
;

138 
	$MwRegi°îFdI≈ut
(
HWND
 
hwnd
, 
fd
)

140 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

141 i‡(!
u£ºegfd
[
fd
].
ªad
) {

142 
u£ºegfd
[
fd
].
ªad
 = 
hwnd
;

143 i‡(
u£ºegfd
[
fd
].
√xt
 =-1 && !u£ºegfd[fd].
wrôe
 && !u£ºegfd[fd].
ex˚±
) {

144 
u£ºegfd
[
fd
].
√xt
 = 
u£ºegfd_hód
;

145 
u£ºegfd_hód
 = 
fd
;

149 
	}
}

152 
	$MwUƒegi°îFdI≈ut
(
HWND
 
hwnd
, 
fd
)

154 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

155 i‡(
u£ºegfd
[
fd
].
ªad
 =
hwnd
) {

156 
u£ºegfd
[
fd
].
ªad
 = 
NULL
;

157 i‡(!
u£ºegfd
[
fd
].
wrôe
 && !u£ºegfd[fd].
ex˚±
) {

158 *
li°fd
 = &
u£ºegfd_hód
;

159 *
li°fd
 != -1) {

160 i‡(*
li°fd
 =
fd
) {

161 *
li°fd
 = 
u£ºegfd
[
fd
].
√xt
;

162 
u£ºegfd
[
fd
].
√xt
 = -1;

165 
li°fd
 = &
u£ºegfd
[*li°fd].
√xt
;

167 
u£ºegfd_hód
 = 
fd
;

171 
	}
}

174 
	$MwRegi°îFdOuçut
(
HWND
 
hwnd
, 
fd
)

176 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

177 i‡(!
u£ºegfd
[
fd
].
wrôe
) {

178 
u£ºegfd
[
fd
].
wrôe
 = 
hwnd
;

179 i‡(
u£ºegfd
[
fd
].
√xt
 =-1 && !u£ºegfd[fd].
ªad
 && !u£ºegfd[fd].
ex˚±
) {

180 
u£ºegfd
[
fd
].
√xt
 = 
u£ºegfd_hód
;

181 
u£ºegfd_hód
 = 
fd
;

185 
	}
}

188 
	$MwUƒegi°îFdOuçut
(
HWND
 
hwnd
, 
fd
)

190 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

191 i‡(
u£ºegfd
[
fd
].
wrôe
 =
hwnd
) {

192 
u£ºegfd
[
fd
].
wrôe
 = 
NULL
;

193 i‡(!
u£ºegfd
[
fd
].
ªad
 && !u£ºegfd[fd].
ex˚±
) {

194 *
li°fd
 = &
u£ºegfd_hód
;

195 *
li°fd
 != -1) {

196 i‡(*
li°fd
 =
fd
) {

197 *
li°fd
 = 
u£ºegfd
[
fd
].
√xt
;

198 
u£ºegfd
[
fd
].
√xt
 = -1;

201 
li°fd
 = &
u£ºegfd
[*li°fd].
√xt
;

203 
u£ºegfd_hód
 = 
fd
;

207 
	}
}

210 
	$MwRegi°îFdEx˚±
(
HWND
 
hwnd
, 
fd
)

212 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

213 i‡(!
u£ºegfd
[
fd
].
ex˚±
) {

214 
u£ºegfd
[
fd
].
ex˚±
 = 
hwnd
;

215 i‡(
u£ºegfd
[
fd
].
√xt
 =-1 && !u£ºegfd[fd].
ªad
 && !u£ºegfd[fd].
wrôe
) {

216 
u£ºegfd
[
fd
].
√xt
 = 
u£ºegfd_hód
;

217 
u£ºegfd_hód
 = 
fd
;

221 
	}
}

224 
	$MwUƒegi°îFdEx˚±
(
HWND
 
hwnd
, 
fd
)

226 i‡(
fd
 < 
FD_SETSIZE
 && fd !
mou£_fd
 && fd !
keyb_fd
) {

227 i‡(
u£ºegfd
[
fd
].
ex˚±
 =
hwnd
) {

228 
u£ºegfd
[
fd
].
ex˚±
 = 
NULL
;

229 i‡(!
u£ºegfd
[
fd
].
ªad
 && !u£ºegfd[fd].
wrôe
) {

230 *
li°fd
 = &
u£ºegfd_hód
;

231 *
li°fd
 != -1) {

232 i‡(*
li°fd
 =
fd
) {

233 *
li°fd
 = 
u£ºegfd
[
fd
].
√xt
;

234 
u£ºegfd
[
fd
].
√xt
 = -1;

237 
li°fd
 = &
u£ºegfd
[*li°fd].
√xt
;

239 
u£ºegfd_hód
 = 
fd
;

243 
	}
}

247 #i‡
MSDOS
 | 
_MINIX


249 
	$MwSñe˘
()

252 if(
mou£dev
.
	`Pﬁl
())

253 
	`MwCheckMou£Evít
())

257 if(
kbddev
.
	`Pﬁl
())

258 
	`MwCheckKeybﬂrdEvít
())

261 
	`MwH™dÀTimîs
();

262 
	}
}

265 #i‡
UNIX
 && 
deföed
(
HAVESELECT
)

266 #i‡
ANIMATEPALETTE


267 
	gÁde
 = 0;

271 
	$MwSñe˘
()

273 
fd_£t
 
rfds
;

274 
fd_£t
 
wfds
;

275 
fd_£t
 
efds
;

276 
fd
;

277 
e
;

278 
£tsize
 = 0;

279 
UINT
 
timeout
;

280 
timevÆ
 
to
;

283 if(
s¸dev
.
PªSñe˘
)

284 
s¸dev
.
	`PªSñe˘
(&scrdev);

287 
	`FD_ZERO
(&
rfds
);

288 
	`FD_ZERO
(&
wfds
);

289 
	`FD_ZERO
(&
efds
);

291 if(
mou£_fd
 >= 0) {

292 
	`FD_SET
(
mou£_fd
, &
rfds
);

293 if(
mou£_fd
 > 
£tsize
)

294 
£tsize
 = 
mou£_fd
;

296 if(
keyb_fd
 >= 0) {

297 
	`FD_SET
(
keyb_fd
, &
rfds
);

298 if(
keyb_fd
 > 
£tsize
)

299 
£tsize
 = 
keyb_fd
;

303 
fd
 = 
u£ºegfd_hód
;

304 
fd
 != -1) {

305 i‡(
u£ºegfd
[
fd
].
ªad
Ë
	`FD_SET
(fd, &
rfds
);

306 i‡(
u£ºegfd
[
fd
].
wrôe
Ë
	`FD_SET
(fd, &
wfds
);

307 i‡(
u£ºegfd
[
fd
].
ex˚±
Ë
	`FD_SET
(fd, &
efds
);

308 if(
fd
 > 
£tsize
) setsize = fd;

309 
fd
 = 
u£ºegfd
[fd].
√xt
;

312 ++
£tsize
;

319 if(
døgwp
)

320 
timeout
 = 
to
.
tv_£c
 =Åo.
tv_u£c
 = 0L;

322 
timeout
 = 
	`MwGëNextTimeoutVÆue
();

323 #i‡
ANIMATEPALETTE


324 if(
Áde
 < 100)

325 
timeout
 = 40;

327 i‡(!
timeout
)Åimeout = 10;

328 #i‡
MW_FEATURE_TIMERS


329 
	`GdGëNextTimeout
(&
to
, 
timeout
);

331 
to
.
tv_£c
 = 
timeout
 / 1000;

332 
to
.
tv_u£c
 = (
timeout
 % 1000) * 1000;

337 if((
e
 = 
	`£À˘
(
£tsize
, &
rfds
, &
wfds
, &
efds
, &
to
)) > 0) {

340 if(
mou£_fd
 >0 && 
	`FD_ISSET
(mou£_fd, &
rfds
))

341 
	`MwCheckMou£Evít
())

345 if(
keyb_fd
 >0 && 
	`FD_ISSET
(keyb_fd, &
rfds
))

346 
	`MwCheckKeybﬂrdEvít
())

350 
fd
 = 
u£ºegfd_hód
;

351 
fd
 != -1) {

352 i‡(
u£ºegfd
[
fd
].
ªad
 && 
	`FD_ISSET
(fd, &
rfds
))

353 
	`Po°Mesßge
(
u£ºegfd
[
fd
].
ªad
, 
WM_FDINPUT
, fd, 0);

354 i‡(
u£ºegfd
[
fd
].
wrôe
 && 
	`FD_ISSET
(fd, &
wfds
))

355 
	`Po°Mesßge
(
u£ºegfd
[
fd
].
wrôe
, 
WM_FDOUTPUT
, fd, 0);

356 i‡(
u£ºegfd
[
fd
].
ex˚±
 && 
	`FD_ISSET
(fd, &
efds
))

357 
	`Po°Mesßge
(
u£ºegfd
[
fd
].
ex˚±
, 
WM_FDEXCEPT
, fd, 0);

358 
fd
 = 
u£ºegfd
[fd].
√xt
;

361 if(
e
 == 0) {

363 #i‡
MW_FEATURE_TIMERS


364 if(
	`GdTimeout
(Ë=
FALSE
)

367 #i‡
ANIMATEPALETTE


368 if(
Áde
 <= 100) {

369 
	`£tÁdñevñ
(&
s¸dev
, 
Áde
);

370 
Áde
 += 5;

373 
	`MwH™dÀTimîs
();

375 if(
î∫o
 !
EINTR
)

376 
	`EPRINTF
("Select() call in main failed\n");

377 
	}
}

380 #i‡
RTEMS


381 
MWBOOL
 
MwCheckMou£Evít
();

382 
MWBOOL
 
MwCheckKeybﬂrdEvít
();

383 
MW_UID_MESSAGE
 
m_kbd
;

384 
MW_UID_MESSAGE
 
m_mou
;

385 
HWND
 
døgwp
;

387 
	$MwSñe˘
 ()

389 
MW_UID_MESSAGE
 
m
;

390 
rc
;

391 
timeout
 = 0;

394 i‡(
s¸dev
.
PªSñe˘
)

395 
s¸dev
.
	`PªSñe˘
 (&scrdev);

402 i‡(!
døgwp
) {

403 
timeout
 = 
	`MwGëNextTimeoutVÆue
 ();

404 i‡(
timeout
 < 10)

405 
timeout
 = 10;

408 
m
.
ty≥
 = 
MV_UID_INVALID
;

411 
rc
 = 
	`uid_ªad_mesßge
 (&
m
, 
timeout
);

414 i‡(
rc
 < 0) {

415 i‡–
î∫o
 !
ETIMEDOUT
 )

416 
	`EPRINTF
 ("Ñc%d,Éºno=%d\n", 
rc
, 
î∫o
);

418 
	`MwH™dÀTimîs
 ();

424 
m
.
ty≥
) {

425 
MV_UID_REL_POS
:

426 
MV_UID_ABS_POS
:

427 
m_mou
 = 
m
;

428 
	`MwCheckMou£Evít
 ()) ;

430 
MV_UID_KBD
:

431 
m_kbd
 = 
m
;

432 
	`MwCheckKeybﬂrdEvít
();

434 
MV_UID_TIMER
:

435 
MV_UID_INVALID
:

439 
	}
}

442 #ifde‡
PSP


443 
	$MwSñe˘
()

445 #i‡
PSP


446 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

450 if(
mou£dev
.
	`Pﬁl
())

451 
	`MwCheckMou£Evít
())

455 if(
kbddev
.
	`Pﬁl
())

456 
	`MwCheckKeybﬂrdEvít
())

459 
	`MwH™dÀTimîs
();

461 #i‡
PSP


462 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

465 
	}
}

468 #i‡
VTSWITCH


470 
	$CheckVtCh™ge
(*
¨g
)

472 if(
	`MwCheckVtCh™ge
()) {

473 #i‡
ANIMATEPALETTE


474 
Áde
 = 0;

476 
	`MwRedøwS¸ìn
();

478 
	`GdAddTimî
(50, 
CheckVtCh™ge
, 
NULL
);

479 
	}
}

487 
	$MwInôülize
()

489 
HWND
 
wp
;

490 
PSD
 
psd
;

491 
WNDCLASS
 
wc
;

492 
fd
;

493 
MWCURSOR
 
¨row
 = {

496 
	`RGB
(255, 255, 255), RGB(0, 0, 0),

507 
MWLISTHEAD
 
mwCœssHód
;

509 #i‡(
UNIX
 | 
DOS_DJGPP
Ë&& !
_MINIX


510 
fd
 = 0; fd < 
FD_SETSIZE
; fd++) {

511 
u£ºegfd
[
fd
].
ªad
 = 
NULL
;

512 
u£ºegfd
[
fd
].
wrôe
 = 
NULL
;

513 
u£ºegfd
[
fd
].
ex˚±
 = 
NULL
;

514 
u£ºegfd
[
fd
].
√xt
 = -1;

516 
u£ºegfd_hód
 = -1;

519 #i‡!
PSP


521 
	`sig«l
(
SIGTERM
, (*)
MwTîmö©e
);

524 
°¨tTicks
 = 
	`GëTickCou¡
();

526 i‡((
keyb_fd
 = 
	`GdO≥nKeybﬂrd
()) == -1) {

527 
	`EPRINTF
("Cannot initialise keyboard\n");

531 i‡((
psd
 = 
	`GdO≥nS¸ìn
()Ë=
NULL
) {

532 
	`EPRINTF
("Cannot initialise screen\n");

533 
	`GdClo£Keybﬂrd
();

537 i‡((
mou£_fd
 = 
	`GdO≥nMou£
()) == -1) {

538 
	`EPRINTF
("Cannot initialise mouse\n");

539 
	`GdClo£S¸ìn
(
psd
);

540 
	`GdClo£Keybﬂrd
();

544 #i‡
ANIMATEPALETTE


545 
	`£tÁdñevñ
(
psd
, 0);

550 
wc
.
°yÀ
 = 
CS_DBLCLKS
 | 
CS_VREDRAW
 | 
CS_HREDRAW
;

551 
wc
.
Õ‚WndProc
 = (
WNDPROC
)
DefWödowProc
;

552 
wc
.
cbClsExåa
 = 0;

553 
wc
.
cbWndExåa
 = 0;

554 
wc
.
hIn°™˚
 = 0;

555 
wc
.
hIc⁄
 = 0;

556 
wc
.
hCurs‹
 = 0;

557 
wc
.
hbrBackground
 = 
	`Cª©eSﬁidBrush
(
	`GëSysCﬁ‹
(
COLOR_BACKGROUND
));

558 
wc
.
ÕszMíuName
 = 
NULL
;

559 
wc
.
ÕszCœssName
 = "DeskTop";

560 
	`Regi°îCœss
–&
wc
);

562 
wp
 = 
	`GdIãmNew
(
hwnd
);

563 i‡(!
wp
) {

564 
	`EPRINTF
("No memory forÑoot window\n");

565 
	`GdClo£Mou£
();

566 
	`GdClo£S¸ìn
(
psd
);

567 
	`GdClo£Keybﬂrd
();

572 
wp
->
°yÀ
 = 
WS_CLIPCHILDREN
 | 
WS_VISIBLE
;

573 
wp
->
ex°yÀ
 = 0;

574 
wp
->
pCœss
 = (
PWNDCLASS
)
mwCœssHód
.
hód
;

575 
wp
->
∑ª¡
 = 
NULL
;

576 
wp
->
chûdªn
 = 
NULL
;

577 
wp
->
siblögs
 = 
NULL
;

578 
wp
->
√xt
 = 
NULL
;

579 
	`SëRe˘
(&
wp
->
wöª˘
, 0, 0, 
psd
->
xvúåes
,Ösd->
yvúåes
);

580 
	`MwCÆcClõ¡Re˘
(
wp
);

581 
wp
->
curs‹
 = 
NULL
;

582 
wp
->
unm≠cou¡
 = 0;

583 
wp
->
id
 = 0;

584 
	`°r˝y
(
wp
->
szTôÀ
, "Microwindows");

585 
wp
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

586 #i‡
UPDATEREGIONS


587 
wp
->
upd©e
 = 
	`GdAŒocRegi⁄
();

590 
li°wp
 = 
wp
;

591 
roŸwp
 = 
wp
;

592 
focuswp
 = 
wp
;

593 
mou£wp
 = 
wp
;

596 
	`InvÆid©eRe˘
(
roŸwp
, 
NULL
, 
TRUE
);

598 #i‡
VTSWITCH


599 
	`MwInôVt
();

601 
	`GdAddTimî
(50, 
CheckVtCh™ge
, 
NULL
);

607 
curcurs‹
 = 
NULL
;

608 
curs‹x
 = -1;

609 
curs‹y
 = -1;

610 
	`GdShowCurs‹
(
psd
);

611 
	`MwMoveCurs‹
(
psd
->
xvúåes
 / 2,Ösd->
yvúåes
 / 2);

612 
	`MwSëCurs‹
(
roŸwp
, &
¨row
);

617 
	`GdRe°ri˘Mou£
(0, 0, 
psd
->
xvúåes
 - 1,Ösd->
yvúåes
 - 1);

618 
	`GdMoveMou£
(
psd
->
xvúåes
 / 2,Ösd->
yvúåes
 / 2);

621 
	}
}

627 
	$MwTîmö©e
()

629 
	`GdClo£S¸ìn
(&
s¸dev
);

630 
	`GdClo£Mou£
();

631 
	`GdClo£Keybﬂrd
();

632 #i‡
VTSWITCH


633 
	`MwRedøwVt
(
mwvãrm
);

634 
	`MwExôVt
();

636 
	`exô
(0);

637 
	}
}

643 
DWORD
 
WINAPI


644 
	$GëTickCou¡
(
VOID
)

646 #i‡
MSDOS


647 
	~<time.h
>

648  (
DWORD
)(
	`˛ock
(Ë* 1000 / 
CLOCKS_PER_SEC
);

650 #i‡
_MINIX


651 
tms
 
t
;

653  (
DWORD
)
	`times
(&
t
) * 16;

655 #i‡
UNIX


656 
timevÆ
 
t
;

658 
	`gëtimeofday
(&
t
, 
NULL
);

659  ((
t
.
tv_£c
 * 1000Ë+ (t.
tv_u£c
 / 25000Ë* 25Ë- 
°¨tTicks
;

660 #ñi‡
PSP


666  
	`s˚Kî√lLibcClock
()*1000/100;

672 
	}
}

674 
VOID
 
WINAPI


675 
	$SÀï
(
DWORD
 
dwMûli£c⁄ds
)

677 
i
, 
j
, 
k
;

678 c⁄° 
lo›s_≥r_ms
 = 20000;

681 
i
=0; i < 
dwMûli£c⁄ds
; i++)

682 
j
=0; j < 
lo›s_≥r_ms
; j++)

683 
k
 = 
i
 * 
j
;

684 
	}
}

	@mwin/winrgn.c

14 
	~"wödows.h
"

15 
	~"devi˚.h
"

16 
	~<°dlib.h
>

17 
	~<°rög.h
>

20 
	#GDI_GëObjPå
(
hrgn
,
ty≥
Ë(hrgn)

	)

23 
HRGN
 
REGION_Cª©eRegi⁄
();

27 
	#EMPTY_REGION
(
pReg
) { \

28 (
pReg
)->
numRe˘s
 = 0; \

29 (
pReg
)->
exã¡s
.
À·
 = (pReg)->exã¡s.
t›
 = 0; \

30 (
pReg
)->
exã¡s
.
right
 = (pReg)->exã¡s.
bŸtom
 = 0; \

31 (
pReg
)->
ty≥
 = 
NULLREGION
; \

32 }

	)

37 
HRGN


38 
	$REGION_Cª©eRegi⁄
()

40 
MWRGNOBJ
 *
obj
;

42 
obj
 = 
	`GdIãmNew
(
MWRGNOBJ
);

43 if(!
obj
)

44  
NULL
;

45 
obj
->
hdr
.
ty≥
 = 
OBJ_REGION
;

46 
obj
->
hdr
.
°ockobj
 = 
FALSE
;

47 if(!(
obj
->
rgn
 = 
	`GdAŒocRegi⁄
())) {

48 
	`GdIãmFªe
(
obj
);

49  
NULL
;

51  (
HRGN
)
obj
;

52 
	}
}

55 
INT
 
WINAPI


56 
	$Off£tRgn
–
HRGN
 
hrgn
, 
INT
 
x
, INT 
y
 )

58 
MWRGNOBJ
 * 
obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

60 i‡(
obj
)

62 
	`GdOff£tRegi⁄
(
obj
->
rgn
, 
x
, 
y
);

63  
obj
->
rgn
->
ty≥
;

65  
ERRORREGION
;

66 
	}
}

69 
INT
 
WINAPI


70 
	$GëRgnBox
–
HRGN
 
hrgn
, 
LPRECT
 
ª˘
 )

72 
MWRGNOBJ
 * 
obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

73 i‡(
obj
)

74  
	`GdGëRegi⁄Box
(
obj
->
rgn
, 
ª˘
);

75  
ERRORREGION
;

76 
	}
}

79 
HRGN
 
WINAPI


80 
	$Cª©eRe˘Rgn
(
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
)

82 
HRGN
 
hrgn
;

84 i‡(!(
hrgn
 = 
	`REGION_Cª©eRegi⁄
()))

87 
	`SëRe˘Rgn
(
hrgn
, 
À·
, 
t›
, 
right
, 
bŸtom
);

88  
hrgn
;

89 
	}
}

92 
HRGN
 
WINAPI


93 
	$Cª©eRe˘RgnIndúe˘
–c⁄° 
RECT
* 
ª˘
 )

95  
	`Cª©eRe˘Rgn
–
ª˘
->
À·
,Ñe˘->
t›
,Ñe˘->
right
,Ñe˘->
bŸtom
 );

96 
	}
}

102 
VOID
 
WINAPI


103 
	$SëRe˘Rgn
–
HRGN
 
hrgn
, 
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
 )

105 
MWRGNOBJ
 * 
obj
;

106 
MWCLIPREGION
 *
rgn
;

110 i‡(!(
obj
 = (
MWRGNOBJ
 *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 ))) ;

112 i‡(
À·
 > 
right
Ë{ 
INT
 
tmp
 =Üeft;Üeft =Ñight;Ñight =Åmp; }

113 i‡(
t›
 > 
bŸtom
Ë{ 
INT
 
tmp
 =Åop;Åop = bottom; bottom =Åmp; }

115 
rgn
 = 
obj
->rgn;

116 
	`GdSëRe˘Regi⁄
(
rgn
, 
À·
, 
t›
, 
right
, 
bŸtom
);

117 
	}
}

120 
HRGN
 
WINAPI


121 
	$Cª©eRoundRe˘Rgn
–
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
,

122 
INT
 
ñlù£_width
, INT 
ñlù£_height
 )

124 
MWRGNOBJ
 * 
obj
;

125 
HRGN
 
hrgn
;

126 
asq
, 
bsq
, 
d
, 
xd
, 
yd
;

127 
RECT
 
ª˘
;

130 i‡(
ñlù£_width
 =0 || 
ñlù£_height
 == 0)

131  
	`Cª©eRe˘Rgn
–
À·
, 
t›
, 
right
, 
bŸtom
 );

134 i‡(
À·
 > 
right
Ë{ 
INT
 
tmp
 =Üeft;Üeft =Ñight;Ñight =Åmp; }

135 i‡(
t›
 > 
bŸtom
Ë{ 
INT
 
tmp
 =Åop;Åop = bottom; bottom =Åmp; }

137 
ñlù£_width
 = 
	`abs
(ellipse_width);

138 
ñlù£_height
 = 
	`abs
(ellipse_height);

142 i‡(!(
hrgn
 = 
	`REGION_Cª©eRegi⁄
()))

144 
obj
 = (
MWRGNOBJ
 *)
hrgn
;

150 i‡(
ñlù£_width
 > 
right
-
À·
)Éllipse_width =Ñight-left;

151 i‡(
ñlù£_height
 > 
bŸtom
-
t›
)Éllipse_height = bottom-top;

156 
asq
 = 
ñlù£_width
 *Éllipse_width / 4;

157 
bsq
 = 
ñlù£_height
 *Éllipse_height / 4;

158 i‡(
asq
 == 0)ásq = 1;

159 i‡(
bsq
 == 0) bsq = 1;

160 
d
 = 
bsq
 - 
asq
 * 
ñlù£_height
 / 2 +ásq / 4;

161 
xd
 = 0;

162 
yd
 = 
asq
 * 
ñlù£_height
;

164 
ª˘
.
À·
 =Üe· + 
ñlù£_width
 / 2;

165 
ª˘
.
right
 =Ñighà- 
ñlù£_width
 / 2;

169 
xd
 < 
yd
)

171 i‡(
d
 > 0)

174 
ª˘
.
t›
 =Åop++;

175 
ª˘
.
bŸtom
 =Ñe˘.
t›
 + 1;

176 
	`GdUni⁄Re˘WôhRegi⁄
–&
ª˘
, 
obj
->
rgn
 );

177 
ª˘
.
t›
 = --
bŸtom
;

178 
ª˘
.
bŸtom
 =Ñe˘.
t›
 + 1;

179 
	`GdUni⁄Re˘WôhRegi⁄
–&
ª˘
, 
obj
->
rgn
 );

180 
yd
 -2*
asq
;

181 
d
 -
yd
;

183 
ª˘
.
À·
--;

184 
ª˘
.
right
++;

185 
xd
 +2*
bsq
;

186 
d
 +
bsq
 + 
xd
;

191 
d
 +(3 * (
asq
-
bsq
Ë/ 2 - (
xd
+
yd
)) / 2;

192 
yd
 >= 0)

195 
ª˘
.
t›
 =Åop++;

196 
ª˘
.
bŸtom
 =Ñe˘.
t›
 + 1;

197 
	`GdUni⁄Re˘WôhRegi⁄
–&
ª˘
, 
obj
->
rgn
 );

198 
ª˘
.
t›
 = --
bŸtom
;

199 
ª˘
.
bŸtom
 =Ñe˘.
t›
 + 1;

200 
	`GdUni⁄Re˘WôhRegi⁄
–&
ª˘
, 
obj
->
rgn
 );

201 i‡(
d
 < 0)

203 
ª˘
.
À·
--;

204 
ª˘
.
right
++;

205 
xd
 +2*
bsq
;

206 
d
 +
xd
;

208 
yd
 -2*
asq
;

209 
d
 +
asq
 - 
yd
;

214 i‡(
t›
 <
bŸtom
)

216 
ª˘
.
t›
 =Åop;

217 
ª˘
.
bŸtom
 = bottom;

218 
	`GdUni⁄Re˘WôhRegi⁄
–&
ª˘
, 
obj
->
rgn
 );

220 
obj
->
rgn
->
ty≥
 = 
SIMPLEREGION
;

221  
hrgn
;

222 
	}
}

225 
HRGN
 
WINAPI


226 
	$Cª©eEŒùticRgn
–
INT
 
À·
, INT 
t›
, INT 
right
, INT 
bŸtom
 )

228  
	`Cª©eRoundRe˘Rgn
(
À·
, 
t›
, 
right
, 
bŸtom
,Ñight-left, bottom-top);

229 
	}
}

232 
HRGN
 
WINAPI


233 
	$Cª©eEŒùticRgnIndúe˘
–c⁄° 
RECT
 *
ª˘
 )

235  
	`Cª©eRoundRe˘Rgn
–
ª˘
->
À·
,Ñe˘->
t›
,Ñe˘->
right
,

236 
ª˘
->
bŸtom
,Ñe˘->
right
 -Ñe˘->
À·
,

237 
ª˘
->
bŸtom
 -Ñe˘->
t›
 );

238 
	}
}

240 
HRGN
 
WINAPI


241 
	$Cª©ePﬁyg⁄Rgn
(c⁄° 
POINT
 *
poöts
, 
INT
 
cou¡
, INT 
mode
)

243 #i‡
POLYREGIONS


244 
HRGN
 
hrgn
;

245 
MWRGNOBJ
 * 
obj
;

246 
MWCLIPREGION
 * 
rgn
;

248 i‡(!(
hrgn
 = 
	`REGION_Cª©eRegi⁄
()))

249  
NULL
;

250 
obj
 = (
MWRGNOBJ
 *)
	`GDI_GëObjPå
(
hrgn
, 
OBJ_REGION
);

251 i‡(!
obj
)

252  
NULL
;

254 
rgn
 = 
	`GdAŒocPﬁyg⁄Regi⁄
((
POINT
 *)
poöts
, 
cou¡
, 
mode
);

255 i‡(!
rgn
)

256  
hrgn
;

257 
	`GdDe°royRegi⁄
(
obj
->
rgn
);

258 
obj
->
rgn
 =Ñgn;

259  
hrgn
;

261 
	}
}

263 
DWORD
 
WINAPI


264 
	$GëRegi⁄D©a
(
HRGN
 
hrgn
, 
DWORD
 
cou¡
, 
LPRGNDATA
 
rgnd©a
)

266 
DWORD
 
size
;

267 
MWRGNOBJ
 *
obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

268 
MWCLIPREGION
 *
rgn
;

272 if(!
obj
)  0;

274 
rgn
 = 
obj
->rgn;

275 
size
 = 
rgn
->
numRe˘s
 * (
RECT
);

276 if(
cou¡
 < (
size
 + (
RGNDATAHEADER
)Ë|| 
rgnd©a
 =
NULL
)

277  
size
 + (
RGNDATAHEADER
);

279 
rgnd©a
->
rdh
.
dwSize
 = (
RGNDATAHEADER
);

280 
rgnd©a
->
rdh
.
iTy≥
 = 
RDH_RECTANGLES
;

281 
rgnd©a
->
rdh
.
nCou¡
 = 
rgn
->
numRe˘s
;

282 
rgnd©a
->
rdh
.
nRgnSize
 = 
size
;

283 
rgnd©a
->
rdh
.
rcBound
.
À·
 = 
rgn
->
exã¡s
.left;

284 
rgnd©a
->
rdh
.
rcBound
.
t›
 = 
rgn
->
exã¡s
.top;

285 
rgnd©a
->
rdh
.
rcBound
.
right
 = 
rgn
->
exã¡s
.right;

286 
rgnd©a
->
rdh
.
rcBound
.
bŸtom
 = 
rgn
->
exã¡s
.bottom;

288 
	`mem˝y
–
rgnd©a
->
Buf„r
, 
rgn
->
ª˘s
, 
size
 );

291 
	}
}

295 
HRGN
 
WINAPI


296 
	$ExtCª©eRegi⁄
(c⁄° 
XFORM
* 
ÕXf‹m
, 
DWORD
 
dwCou¡
, c⁄° 
RGNDATA
* 
rgnd©a
)

298 
HRGN
 
hrgn
 = 
	`Cª©eRe˘Rgn
(0, 0, 0, 0);

299 
MWRGNOBJ
 *
obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

300 
RECT
 *
pCurRe˘
, *
pEndRe˘
;

304 if(!
hrgn
)

306 
	`WARN
(
ªgi⁄
, "Can't createáÑegion!\n");

309 if(
ÕXf‹m
)

310 
	`WARN
(
ªgi⁄
, "XformÇot implemented - ignoring\n");

312 if(
rgnd©a
->
rdh
.
iTy≥
 !
RDH_RECTANGLES
)

314 
	`WARN
(
ªgi⁄
, "TypeÇot RDH_RECTANGLES\n");

315 
	`DñëeObje˘
–
hrgn
 );

319 
pEndRe˘
 = (
RECT
 *)
rgnd©a
->
Buf„r
 +Ñgnd©a->
rdh
.
nCou¡
;

320 
pCurRe˘
 = (
RECT
 *)
rgnd©a
->
Buf„r
;ÖCurRe˘ < 
pEndRe˘
;ÖCurRect++)

321 
	`GdUni⁄Re˘WôhRegi⁄
–
pCurRe˘
, 
obj
->
rgn
 );

323  
hrgn
;

324 
	}
}

328 
BOOL
 
WINAPI


329 
	$PtInRegi⁄
–
HRGN
 
hrgn
, 
INT
 
x
, INT 
y
 )

331 
MWRGNOBJ
 * 
obj
;

333 
obj
 = (
MWRGNOBJ
 *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

334 if(!
obj
)

335  
FALSE
;

336  
	`GdPtInRegi⁄
(
obj
->
rgn
, 
x
, 
y
);

337 
	}
}

342 
BOOL
 
WINAPI


343 
	$Re˘InRegi⁄
–
HRGN
 
hrgn
, c⁄° 
RECT
 *
ª˘
 )

345 
MWRGNOBJ
 * 
obj
;

347 
obj
 = (
MWRGNOBJ
 *Ë
	`GDI_GëObjPå
–
hrgn
, 
OBJ_REGION
 );

348 if(!
obj
)

349  
FALSE
;

350  (
	`GdRe˘InRegi⁄
(
obj
->
rgn
, 
ª˘
Ë=
MWRECT_OUT
? 
FALSE
: 
TRUE
);

351 
	}
}

353 
BOOL
 
WINAPI


354 
	$EquÆRgn
–
HRGN
 
hrgn1
, HRGN 
hrgn2
 )

356 
MWRGNOBJ
 *
obj1
, *
obj2
;

358 i‡((
obj1
 = (
MWRGNOBJ
 *Ë
	`GDI_GëObjPå
–
hrgn1
, 
OBJ_REGION
 )))

359 i‡((
obj2
 = (
MWRGNOBJ
 *Ë
	`GDI_GëObjPå
–
hrgn2
, 
OBJ_REGION
 )))

360  
	`GdEquÆRegi⁄
(
obj1
->
rgn
, 
obj2
->rgn);

361  
FALSE
;

362 
	}
}

370 
BOOL


371 
	$REGION_Uni⁄Re˘WôhRgn
–
HRGN
 
hrgn
, c⁄° 
RECT
 *
ÕRe˘
 )

373 
MWRGNOBJ
 *
obj
 = (MWRGNOBJ *)
hrgn
;

375 if(!
obj
Ë 
FALSE
;

376 
	`GdUni⁄Re˘WôhRegi⁄
–
ÕRe˘
, 
obj
->
rgn
 );

377  
TRUE
;

378 
	}
}

385 
BOOL


386 
	$REGION_FømeRgn
–
HRGN
 
hDe°
, HRGN 
hSrc
, 
INT
 
x
, INT 
y
 )

388 
BOOL
 
bRë
;

389 
MWRGNOBJ
 *
§cObj
 = (MWRGNOBJ*Ë
	`GDI_GëObjPå
–
hSrc
, 
OBJ_REGION
 );

391 i‡(
§cObj
->
rgn
->
numRe˘s
 != 0)

393 
MWRGNOBJ
* 
de°Obj
 = (MWRGNOBJ*Ë
	`GDI_GëObjPå
–
hDe°
, 
OBJ_REGION
 );

394 
RECT
 *
pRe˘
, *
pEndRe˘
;

395 
RECT
 
ãmpRe˘
;

397 
	`EMPTY_REGION
–
de°Obj
->
rgn
 );

399 
pEndRe˘
 = 
§cObj
->
rgn
->
ª˘s
 + srcObj->rgn->
numRe˘s
;

400 
pRe˘
 = 
§cObj
->
rgn
->
ª˘s
;ÖRe˘ < 
pEndRe˘
;ÖRect++)

402 
ãmpRe˘
.
À·
 = 
pRe˘
->À· - 
x
;

403 
ãmpRe˘
.
t›
 = 
pRe˘
->t› - 
y
;

404 
ãmpRe˘
.
right
 = 
pRe˘
->righà+ 
x
;

405 
ãmpRe˘
.
bŸtom
 = 
pRe˘
->bŸtom + 
y
;

406 
	`GdUni⁄Re˘WôhRegi⁄
–&
ãmpRe˘
, 
de°Obj
->
rgn
 );

408 
	`GdSubåa˘Regi⁄
–
de°Obj
->
rgn
, de°Obj->rgn, 
§cObj
->rgn );

409 
bRë
 = 
TRUE
;

412 
bRë
 = 
FALSE
;

413  
bRë
;

414 
	}
}

420 
INT
 
WINAPI


421 
	$ComböeRgn
(
HRGN
 
hDe°
, HRGN 
hSrc1
, HRGN 
hSrc2
, 
INT
 
mode
)

423 
MWRGNOBJ
 *
de°Obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hDe°
, 
OBJ_REGION
);

424 
INT
 
ªsu…
 = 
ERRORREGION
;

428 i‡(
de°Obj
)

430 
MWRGNOBJ
 *
§c1Obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hSrc1
, 
OBJ_REGION
);

432 i‡(
§c1Obj
)

437 i‡(
mode
 =
RGN_COPY
)

439 
	`GdC›yRegi⁄
–
de°Obj
->
rgn
, 
§c1Obj
->rgn );

440 
ªsu…
 = 
de°Obj
->
rgn
->
ty≥
;

444 
MWRGNOBJ
 *
§c2Obj
 = (MWRGNOBJ *Ë
	`GDI_GëObjPå
–
hSrc2
, 
OBJ_REGION
);

446 i‡(
§c2Obj
)

451 
mode
)

453 
RGN_AND
:

454 
	`GdI¡î£˘Regi⁄
–
de°Obj
->
rgn
, 
§c1Obj
->rgn, 
§c2Obj
->rgn);

456 
RGN_OR
:

457 
	`GdUni⁄Regi⁄
–
de°Obj
->
rgn
, 
§c1Obj
->rgn, 
§c2Obj
->rgn );

459 
RGN_XOR
:

460 
	`GdX‹Regi⁄
–
de°Obj
->
rgn
, 
§c1Obj
->rgn, 
§c2Obj
->rgn );

462 
RGN_DIFF
:

463 
	`GdSubåa˘Regi⁄
–
de°Obj
->
rgn
, 
§c1Obj
->rgn, 
§c2Obj
->rgn );

466 
ªsu…
 = 
de°Obj
->
rgn
->
ty≥
;

474  
ªsu…
;

475 
	}
}

483 
BOOL
 
WINAPI


484 
	$I¡î£˘Re˘
–
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 )

486 i‡(
	`IsRe˘Em±y
(
§c1
Ë|| IsRe˘Em±y(
§c2
) ||

487 (
§c1
->
À·
 >
§c2
->
right
) || (src2->left >= src1->right) ||

488 (
§c1
->
t›
 >
§c2
->
bŸtom
) || (src2->top >= src1->bottom))

490 
	`SëRe˘Em±y
–
de°
 );

491  
FALSE
;

493 
de°
->
À·
 = 
	`MWMAX
–
§c1
->À·, 
§c2
->left );

494 
de°
->
right
 = 
	`MWMIN
–
§c1
->right, 
§c2
->right );

495 
de°
->
t›
 = 
	`MWMAX
–
§c1
->t›, 
§c2
->top );

496 
de°
->
bŸtom
 = 
	`MWMIN
–
§c1
->bŸtom, 
§c2
->bottom );

497  
TRUE
;

498 
	}
}

501 
BOOL
 
WINAPI


502 
	$Uni⁄Re˘
–
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 )

504 i‡(
	`IsRe˘Em±y
(
§c1
))

506 i‡(
	`IsRe˘Em±y
(
§c2
))

508 
	`SëRe˘Em±y
–
de°
 );

509  
FALSE
;

511 *
de°
 = *
§c2
;

515 i‡(
	`IsRe˘Em±y
(
§c2
)Ë*
de°
 = *
§c1
;

518 
de°
->
À·
 = 
	`MWMIN
–
§c1
->À·, 
§c2
->left );

519 
de°
->
right
 = 
	`MWMAX
–
§c1
->right, 
§c2
->right );

520 
de°
->
t›
 = 
	`MWMIN
–
§c1
->t›, 
§c2
->top );

521 
de°
->
bŸtom
 = 
	`MWMAX
–
§c1
->bŸtom, 
§c2
->bottom );

524  
TRUE
;

525 
	}
}

528 
BOOL
 
WINAPI


529 
	$EquÆRe˘
–c⁄° 
RECT
* 
ª˘1
, c⁄° RECT* 
ª˘2
 )

531  ((
ª˘1
->
À·
 =
ª˘2
->À·Ë&& (ª˘1->
right
 ==Ñect2->right) &&

532 (
ª˘1
->
t›
 =
ª˘2
->t›Ë&& (ª˘1->
bŸtom
 ==Ñect2->bottom));

533 
	}
}

536 
BOOL
 
WINAPI


537 
	$Subåa˘Re˘
–
LPRECT
 
de°
, c⁄° 
RECT
 *
§c1
, c⁄° RECT *
§c2
 )

539 
RECT
 
tmp
;

541 i‡(
	`IsRe˘Em±y
–
§c1
 ))

543 
	`SëRe˘Em±y
–
de°
 );

544  
FALSE
;

546 *
de°
 = *
§c1
;

547 i‡(
	`I¡î£˘Re˘
–&
tmp
, 
§c1
, 
§c2
 ))

549 i‡(
	`EquÆRe˘
–&
tmp
, 
de°
 ))

551 
	`SëRe˘Em±y
–
de°
 );

552  
FALSE
;

554 i‡((
tmp
.
t›
 =
de°
->t›Ë&& (tmp.
bŸtom
 == dest->bottom))

556 i‡(
tmp
.
À·
 =
de°
->À·Ëde°->À· =Åmp.
right
;

557 i‡(
tmp
.
right
 =
de°
->rightËde°->righàtmp.
À·
;

559 i‡((
tmp
.
À·
 =
de°
->À·Ë&& (tmp.
right
 == dest->right))

561 i‡(
tmp
.
t›
 =
de°
->t›Ëde°->t› =Åmp.
bŸtom
;

562 i‡(
tmp
.
bŸtom
 =
de°
->bŸtomËde°->bŸtom =Åmp.
t›
;

565  
TRUE
;

566 
	}
}

	@mwin/winsbar.c

8 
	#MWINCLUDECOLORS


	)

9 
	~"wödows.h
"

10 
	~"wöã∫.h
"

11 
	~"wötoﬁs.h
"

12 
	~<°dlib.h
>

13 
	~<°rög.h
>

14 
	~<°dio.h
>

17 
	#SBS_UNKNOWN
 0x0000

	)

18 
	#SBS_LEFTARROW
 0x0001

	)

19 
	#SBS_RIGHTARROW
 0x0002

	)

20 
	#SBS_LEFTSPACE
 0x0004

	)

21 
	#SBS_RIGHTSPACE
 0x0008

	)

22 
	#SBS_HORZTHUMB
 0x0010

	)

23 
	#SBS_UPARROW
 0x0020

	)

24 
	#SBS_DOWNARROW
 0x0040

	)

25 
	#SBS_UPSPACE
 0x0080

	)

26 
	#SBS_DOWNSPACE
 0x0100

	)

27 
	#SBS_VERTTHUMB
 0x0200

	)

28 
	#SBS_MASK
 0x03ff

	)

29 
	#SBS_DISABLED
 0x4000

	)

30 
	#SBS_HIDE
 0x8000

	)

32 
	#HSCROLLBARVISIBLE
(
hwnd
Ë((hwnd)->
°yÀ
 & 
WS_HSCROLL
)

	)

33 
	#VSCROLLBARVISIBLE
(
hwnd
Ë((hwnd)->
°yÀ
 & 
WS_VSCROLL
)

	)

40 
	$MwAdju°NCS¸ﬁlb¨s
(
HWND
 
hwnd
)

42 
BOOL
 
vîtb¨
 = 
	`VSCROLLBARVISIBLE
(
hwnd
);

43 
BOOL
 
h‹zb¨
 = 
	`HSCROLLBARVISIBLE
(
hwnd
);

45 i‡(
vîtb¨
) {

46 
hwnd
->
˛úe˘
.
right
 -
mwSYSMETRICS_CXVSCROLL
;

47 i‡(
h‹zb¨
)

48 
hwnd
->
˛úe˘
.
bŸtom
 -
mwSYSMETRICS_CYHSCROLL
;

49 
hwnd
->
vs¸ﬁl
.
rc
.
À·
 = hwnd->
˛úe˘
.
right
;

50 
hwnd
->
vs¸ﬁl
.
rc
.
right
 = hwnd->
˛úe˘
.right +

51 
mwSYSMETRICS_CXVSCROLL
;

52 
hwnd
->
vs¸ﬁl
.
rc
.
t›
 = hwnd->
˛úe˘
.top;

53 
hwnd
->
vs¸ﬁl
.
rc
.
bŸtom
 = hwnd->
˛úe˘
.bottom;

55 
	`SëRe˘Em±y
(&
hwnd
->
vs¸ﬁl
.
rc
);

56 i‡(
h‹zb¨
) {

57 i‡(!
vîtb¨
)

58 
hwnd
->
˛úe˘
.
bŸtom
 -
mwSYSMETRICS_CYHSCROLL
;

59 
hwnd
->
hs¸ﬁl
.
rc
.
t›
 = hwnd->
˛úe˘
.
bŸtom
;

60 
hwnd
->
hs¸ﬁl
.
rc
.
bŸtom
 = hwnd->
˛úe˘
.bottom +

61 
mwSYSMETRICS_CYHSCROLL
;

62 
hwnd
->
hs¸ﬁl
.
rc
.
À·
 = hwnd->
˛úe˘
.left;

63 
hwnd
->
hs¸ﬁl
.
rc
.
right
 = hwnd->
˛úe˘
.right;

65 
	`SëRe˘Em±y
(&
hwnd
->
hs¸ﬁl
.
rc
);

66 
	}
}

69 
	$wndGëB‹dî
(
HWND
 
hwnd
)

71 i‡(
hwnd
->
°yÀ
 & 
WS_BORDER
) {

72 i‡((
hwnd
->
°yÀ
 & 
WS_CAPTION
) == WS_CAPTION)

73  
mwSYSMETRICS_CXFRAME
;

74  
mwSYSMETRICS_CXBORDER
;

77 
	}
}

79 
BOOL


80 
	$wndGëVS¸ﬁlB¨Re˘
 (
HWND
 
hwnd
, 
RECT
* 
rcVB¨
)

82 i‡(
hwnd
->
°yÀ
 & 
WS_VSCROLL
) {

83 
rcVB¨
->
À·
 = 
hwnd
->
wöª˘
.
right
 - 
mwSYSMETRICS_CXVSCROLL


84 - 
	`wndGëB‹dî
 (
hwnd
);

85 
rcVB¨
->
right
 = 
hwnd
->
wöª˘
.righà- 
	`wndGëB‹dî
 (hwnd);

86 
rcVB¨
->
t›
 = 
hwnd
->
˛úe˘
.top;

87 
rcVB¨
->
bŸtom
 = 
hwnd
->
wöª˘
.bŸtom - 
	`wndGëB‹dî
 (hwnd);

89 i‡(
hwnd
->
°yÀ
 & 
WS_HSCROLL
 && !(hwnd->
hs¸ﬁl
.
°©us
 & 
SBS_HIDE
))

90 
rcVB¨
->
bŸtom
 -
mwSYSMETRICS_CYHSCROLL
;

92  
TRUE
;

95  
FALSE
;

96 
	}
}

98 
BOOL


99 
	$wndGëHS¸ﬁlB¨Re˘
 (
HWND
 
hwnd
, 
RECT
* 
rcHB¨
)

101 i‡(
hwnd
->
°yÀ
 & 
WS_HSCROLL
) {

102 
rcHB¨
->
t›
 = 
hwnd
->
wöª˘
.
bŸtom
 - 
mwSYSMETRICS_CYHSCROLL


103 - 
	`wndGëB‹dî
 (
hwnd
);

104 
rcHB¨
->
bŸtom
 = 
hwnd
->
wöª˘
.bŸtom - 
	`wndGëB‹dî
 (hwnd);

105 
rcHB¨
->
À·
 = 
hwnd
->
˛úe˘
.left;

106 
rcHB¨
->
right
 = 
hwnd
->
wöª˘
.righà- 
	`wndGëB‹dî
 (hwnd);

108 i‡(
hwnd
->
°yÀ
 & 
WS_VSCROLL
 && !(hwnd->
vs¸ﬁl
.
°©us
 & 
SBS_HIDE
))

109 
rcHB¨
->
right
 -
mwSYSMETRICS_CXVSCROLL
;

111  
TRUE
;

114  
FALSE
;

115 
	}
}

118 
	$MwPaötNCS¸ﬁlb¨s
(
HWND
 
hwnd
, 
HDC
 
hdc
)

120 
BOOL
 
vîtb¨
 = 
	`VSCROLLBARVISIBLE
(
hwnd
);

121 
BOOL
 
h‹zb¨
 = 
	`HSCROLLBARVISIBLE
(
hwnd
);

122 
BOOL
 
fGŸDC
 = 
FALSE
;

123 
RECT
 
rc
,
rc2
;

125 
POINT
 
p3
[3];

126 
shrök
=2;

128 
°¨t
 = 0;

129 
RECT
 
rcHB¨
, 
rcVB¨
;

132 i‡(!
hdc
 && (
h‹zb¨
 || 
vîtb¨
)) {

133 
hdc
 = 
	`GëWödowDC
(
hwnd
);

134 
fGŸDC
 = 
TRUE
;

137 i‡(
h‹zb¨
 && 
vîtb¨
) {

138 
rc
.
À·
 = 
hwnd
->
˛úe˘
.
right
;

139 
rc
.
t›
 = 
hwnd
->
˛úe˘
.
bŸtom
;

140 
rc
.
right
 =Ñc.
À·
 + 
mwSYSMETRICS_CXVSCROLL
;

141 
rc
.
bŸtom
 =Ñc.
t›
 + 
mwSYSMETRICS_CYHSCROLL
;

142 
	`FûlRe˘
(
hdc
, &
rc
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

144 i‡(
vîtb¨
) {

145 
rc
 = 
hwnd
->
vs¸ﬁl
.rc;

148 
rc2
.
À·
=
rc
.À·;Ñc2.
right
Ùc2.À·+ 
mwSYSMETRICS_CXVSCROLL
;

149 
rc2
.
t›
=
rc
.top;

150 
rc2
.
bŸtom
Ùc2.
t›
+ 
mwSYSMETRICS_CYHSCROLL
;

151 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

152 
rc2
.
t›
=
rc
.
bŸtom
- 
mwSYSMETRICS_CYHSCROLL
;

153 
rc2
.
bŸtom
Ùc2.
t›
+ 
mwSYSMETRICS_CYHSCROLL
;

154 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

157 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

158 
mwSYSMETRICS_CXVSCROLL
, 
mwSYSMETRICS_CYHSCROLL
,

159 
hwnd
->
vs¸ﬁl
.
°©us
 & 
SBS_UPARROW
);

161 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,rc.
bŸtom
-
mwSYSMETRICS_CYHSCROLL
,

162 
mwSYSMETRICS_CXVSCROLL
, 
mwSYSMETRICS_CYHSCROLL
,

163 
hwnd
->
vs¸ﬁl
.
°©us
 & 
SBS_DOWNARROW
);

165 
	`Sñe˘Obje˘
(
hdc
,
	`GëStockObje˘
(
BLACK_BRUSH
));

167 
p3
[0].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
/2) - 1;

168 
p3
[0].
y

rc
.
t›
 + 2 + 
shrök
;

169 
p3
[1].
x

rc
.
À·
 + 2 + 
shrök
 - 1;

170 
p3
[1].
y

rc
.
t›
 + (
mwSYSMETRICS_CYHSCROLL
-4Ë- 
shrök
;

171 
p3
[2].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
-4Ë- 
shrök
;

172 
p3
[2].
y

rc
.
t›
 + (
mwSYSMETRICS_CYHSCROLL
-4Ë- 
shrök
;

173 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

175 
p3
[0].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
/2) - 1;

176 
p3
[0].
y

rc
.
bŸtom
 - 4 - 
shrök
;

177 
p3
[1].
x

rc
.
À·
 + 2 + 
shrök
 - 1;

178 
p3
[1].
y

rc
.
bŸtom
-
mwSYSMETRICS_CYHSCROLL
 + 2 + 
shrök
;

179 
p3
[2].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
-4Ë- 
shrök
;

180 
p3
[2].
y

rc
.
bŸtom
-
mwSYSMETRICS_CYHSCROLL
 + 2 + 
shrök
;

181 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

185 
	`wndGëVS¸ﬁlB¨Re˘
 (
hwnd
, &
rcVB¨
);

186 
rcVB¨
.
À·
 -- ;

187 
rcVB¨
.
right
 -- ;

189 
°¨t
 = 
rcVB¨
.
t›
 + 
mwSYSMETRICS_CYVSCROLL
 + 
hwnd
->
vs¸ﬁl
.
b¨Sèπ
;

191 i‡(
°¨t
 + 
hwnd
->
vs¸ﬁl
.
b¨Lí
 > 
rcVB¨
.
bŸtom
)

192 
°¨t
 = 
rcVB¨
.
bŸtom
 - 
hwnd
->
vs¸ﬁl
.
b¨Lí
;

194 i‡(
hwnd
->
vs¸ﬁl
.
b¨Lí
 == 0)

195 
hwnd
->
vs¸ﬁl
.
b¨Lí
=
rc
.
bŸtom
-rc.
t›
-(
mwSYSMETRICS_CYVSCROLL
*2);

198 
rc2
.
À·
=
rc
.À·;Ñc2.
right
=rc.right ;

199 
rc2
.
t›
=
rc
.t›+
mwSYSMETRICS_CYHSCROLL
;

200 
rc2
.
bŸtom
=
°¨t
;

201 i‡(
rc2
.
bŸtom
>rc2.
t›
)

202 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

204 
rc2
.
t›
=
°¨t
+
hwnd
->
vs¸ﬁl
.
b¨Lí
;

205 
rc2
.
bŸtom
=
rc
.bŸtom-
mwSYSMETRICS_CYHSCROLL
;

206 i‡(
rc2
.
bŸtom
>rc2.
t›
)

207 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

209 
	`Døw3dUpFøme
 (
hdc
, 
rcVB¨
.
À·
, 
°¨t
,ÑcVB¨.
right
,

210 
°¨t
 + 
hwnd
->
vs¸ﬁl
.
b¨Lí
);

215 i‡(
h‹zb¨
) {

216 
rc
 = 
hwnd
->
hs¸ﬁl
.rc;

220 
rc2
.
t›
=
rc
.t›;Ñc2.
bŸtom
Ùc2.t›+ 
mwSYSMETRICS_CYHSCROLL
;

221 
rc2
.
À·
=
rc
.left;

222 
rc2
.
right
Ùc2.
À·
+ 
mwSYSMETRICS_CXVSCROLL
;

223 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

224 
rc2
.
À·
=
rc
.
right
- 
mwSYSMETRICS_CXVSCROLL
;

225 
rc2
.
right
Ùc2.
À·
+ 
mwSYSMETRICS_CXVSCROLL
;

226 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)(
COLOR_BTNFACE
+1));

230 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
À·
,Ñc.
t›
,

231 
mwSYSMETRICS_CXVSCROLL
, 
mwSYSMETRICS_CYHSCROLL
,

232 
hwnd
->
hs¸ﬁl
.
°©us
 & 
SBS_LEFTARROW
);

234 
	`Døw3dUpDownSèã
(
hdc
, 
rc
.
right
-
mwSYSMETRICS_CXVSCROLL
,Ñc.
t›
,

235 
mwSYSMETRICS_CXVSCROLL
, 
mwSYSMETRICS_CYHSCROLL
,

236 
hwnd
->
hs¸ﬁl
.
°©us
 & 
SBS_RIGHTARROW
);

238 
	`Sñe˘Obje˘
(
hdc
,
	`GëStockObje˘
(
BLACK_BRUSH
));

240 
p3
[0].
x

rc
.
À·
 + 2 + 
shrök
;

241 
p3
[0].
y

rc
.
t›
 + (
mwSYSMETRICS_CYHSCROLL
/2) ;

242 
p3
[1].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
-4Ë- 
shrök
 ;

243 
p3
[1].
y

rc
.
t›
 + 2 + 
shrök
;

244 
p3
[2].
x

rc
.
À·
 + (
mwSYSMETRICS_CXVSCROLL
-4Ë- 
shrök
;

245 
p3
[2].
y

rc
.
bŸtom
 - 4 - 
shrök
 + 1;

246 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

248 
p3
[0].
x

rc
.
right
 - 4 - 
shrök
;

249 
p3
[0].
y

rc
.
t›
 + (
mwSYSMETRICS_CYHSCROLL
/2) ;

250 
p3
[1].
x

rc
.
right
-
mwSYSMETRICS_CXVSCROLL
 + 2 + 
shrök
 ;

251 
p3
[1].
y

rc
.
t›
 + 2 + 
shrök
;

252 
p3
[2].
x

rc
.
right
-
mwSYSMETRICS_CXVSCROLL
 + 2 + 
shrök
;

253 
p3
[2].
y

rc
.
bŸtom
 - 4 - 
shrök
 + 1;

254 
	`Pﬁyg⁄
(
hdc
,
p3
,3);

258 
	`wndGëHS¸ﬁlB¨Re˘
 (
hwnd
, &
rcHB¨
);

259 
rcHB¨
.
t›
 -- ;

260 
rcHB¨
.
bŸtom
 -- ;

262 
°¨t
 = 
rcHB¨
.
À·
 + 
mwSYSMETRICS_CXHSCROLL
 + 
hwnd
->
hs¸ﬁl
.
b¨Sèπ
;

264 i‡(
°¨t
 + 
hwnd
->
hs¸ﬁl
.
b¨Lí
 > 
rcHB¨
.
right
)

265 
°¨t
 = 
rcHB¨
.
right
 - 
hwnd
->
hs¸ﬁl
.
b¨Lí
;

267 i‡(
hwnd
->
hs¸ﬁl
.
b¨Lí
 == 0)

268 
hwnd
->
hs¸ﬁl
.
b¨Lí
=
rc
.
right
-rc.
À·
-(
mwSYSMETRICS_CXHSCROLL
*2);

271 
rc2
.
t›
=
rc
.t›;Ñc2.
bŸtom
=rc.bottom ;

272 
rc2
.
À·
=
rc
.À·+
mwSYSMETRICS_CXVSCROLL
;

273 
rc2
.
right
=
°¨t
;

274 i‡(
rc2
.
right
>rc2.
À·
)

275 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

277 
rc2
.
À·
=
°¨t
+
hwnd
->
hs¸ﬁl
.
b¨Lí
;

278 
rc2
.
right
=
rc
.right-
mwSYSMETRICS_CXVSCROLL
;

279 i‡(
rc2
.
right
>rc2.
À·
)

280 
	`FûlRe˘
(
hdc
, &
rc2
, (
HBRUSH
)
	`GëStockObje˘
(
DKGRAY_BRUSH
));

282 
	`Døw3dUpFøme
 (
hdc
, 
°¨t
, 
rcHB¨
.
t›
, sèπ + 
hwnd
->
hs¸ﬁl
.
b¨Lí
,

283 
rcHB¨
.
bŸtom
);

290 i‡(
fGŸDC
)

291 
	`Rñó£DC
(
hwnd
, 
hdc
);

292 
	}
}

296 
	$MwH™dÀNCMesßgeS¸ﬁlb¨
(
HWND
 
hwnd
, 
UINT
 
msg
, 
WPARAM
 
hôcode
, 
LPARAM
 
lP¨am
)

298 
pos
 = 
SBS_UNKNOWN
;

299 
BOOL
 
vîtb¨
 = 
	`VSCROLLBARVISIBLE
(
hwnd
);

300 
BOOL
 
h‹zb¨
 = 
	`HSCROLLBARVISIBLE
(
hwnd
);

301 * 
pSèt
;

302 
POINT
 
±
;

303 
RECT
 
rc
;

305 
BOOL
 
bDøw
;

307 
downPos
 = 
SBS_UNKNOWN
;

308 
sbCode
;

309 
√wThumbPos
;

311 
ôemMovóbÀ
,
ôemCou¡
,
ôemVisibÀ
,
moveR™ge
;

312 
moveT›
,
moveBŸtom
,
moveLe·
,
moveRight
;

314 
	`POINTSTOPOINT
(
±
, 
lP¨am
);

316 i‡(
hôcode
 =
HTVSCROLL
 && 
vîtb¨
)

318 
pSèt
 = &
hwnd
->
vs¸ﬁl
.
°©us
;

319 
rc
 = 
hwnd
->
vs¸ﬁl
.rc;

320 
rc
.
bŸtom
 =Ñc.
t›
 + 
mwSYSMETRICS_CYVSCROLL
;

321 i‡(
	`PtInRe˘
(&
rc
, 
±
))

323 
pos
 = 
SBS_UPARROW
;

326 
rc
.
bŸtom
 = 
hwnd
->
vs¸ﬁl
.rc.bottom;

327 
rc
.
t›
 =Ñc.
bŸtom
 - 
mwSYSMETRICS_CYVSCROLL
;

328 i‡(
	`PtInRe˘
(&
rc
, 
±
))

330 
pos
 = 
SBS_DOWNARROW
;

333 
pos
 = 
SBS_VERTTHUMB
;

334 } i‡(
hôcode
 =
HTHSCROLL
 && 
h‹zb¨
)

336 
pSèt
 = &
hwnd
->
hs¸ﬁl
.
°©us
;

337 
rc
 = 
hwnd
->
hs¸ﬁl
.rc;

338 
rc
.
right
 =Ñc.
À·
 + 
mwSYSMETRICS_CXHSCROLL
;

339 i‡(
	`PtInRe˘
(&
rc
, 
±
)) {

340 
pos
 = 
SBS_LEFTARROW
;

343 
rc
.
right
 = 
hwnd
->
hs¸ﬁl
.rc.right;

344 
rc
.
À·
 =Ñc.
right
 - 
mwSYSMETRICS_CXHSCROLL
;

345 i‡(
	`PtInRe˘
(&
rc
, 
±
)) {

346 
pos
 = 
SBS_RIGHTARROW
;

349 
pos
 = 
SBS_HORZTHUMB
;

355 i‡(
pos
 =
SBS_UNKNOWN
)

358 *
pSèt
 &~
SBS_MASK
;

360 i‡(
msg
 =
WM_NCLBUTTONDOWN
 || msg =
WM_NCLBUTTONDBLCLK
)

361 *
pSèt
 |
pos
;

362 *
pSèt
 &~
pos
;

364 i‡(
msg
 =
WM_NCLBUTTONDOWN
 || msg =
WM_NCLBUTTONDBLCLK
)

365 
bDøw
=
TRUE
;

367 i‡(
bDøw
)

368 
	`MwPaötNCS¸ﬁlb¨s
(
hwnd
, 
NULL
);

370 i‡(
pos
 =
SBS_UPARROW
 ||Öo†=
SBS_LEFTARROW
)

372 i‡(
hwnd
->
vs¸ﬁl
.
curPos
 !hwnd->vs¸ﬁl.
möPos
)

373 
sbCode
 = 
SB_LINEUP
;

375 i‡(
pos
 =
SBS_DOWNARROW
 ||Öo†=
SBS_RIGHTARROW
)

377 i‡(
hwnd
->
vs¸ﬁl
.
curPos
 !hwnd->vs¸ﬁl.
maxPos
)

378 
sbCode
 = 
SB_LINEDOWN
;

380 i‡(
pos
 =
SBS_VERTTHUMB
 ||Öo†=
SBS_HORZTHUMB
)

382 
sbCode
 = 
SB_THUMBTRACK
;

385 
msg
)

387 
WM_NCLBUTTONDOWN
:

388 
WM_NCLBUTTONDBLCLK
:

389 
downPos
 = 
pos
;

390 #i‡
MWCLIENT


391 
	`InvÆid©eRe˘
(
hwnd
,
NULL
,
TRUE
);

395 
WM_NCMOUSEMOVE
:

396 i‡(
hôcode
 =
HTVSCROLL
 && 
vîtb¨
)

398 i‡(
sbCode
 =
SB_THUMBTRACK
 && 
downPos
 =
SBS_VERTTHUMB
)

402 
rc
 = 
hwnd
->
vs¸ﬁl
.rc;

403 
moveT›
 = 
rc
.
t›
 + 
mwSYSMETRICS_CYVSCROLL
;

404 
moveBŸtom
 = 
hwnd
->
vs¸ﬁl
.
rc
.
bŸtom
 - 
mwSYSMETRICS_CYVSCROLL
;

405 
moveR™ge
 = 
moveBŸtom
 - 
moveT›
;

407 
ôemCou¡
 = 
hwnd
->
vs¸ﬁl
.
maxPos
 - hwnd->vs¸ﬁl.
möPos
 + 1;

408 
ôemVisibÀ
 = 
hwnd
->
vs¸ﬁl
.
∑geSãp
;

409 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

411 
√wThumbPos
 = ((
±
.
y
 - 
moveT›
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

412 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

413 
±
.
y
,
moveT›
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

415 i‡–
√wThumbPos
 >
hwnd
->
vs¸ﬁl
.
möPos
 &&

416 
√wThumbPos
 <
hwnd
->
vs¸ﬁl
.
maxPos
)

417 
	`SídMesßge
 (
hwnd
,

418 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

423 i‡(
hôcode
 =
HTHSCROLL
 && 
h‹zb¨
)

425 i‡(
sbCode
 =
SB_THUMBTRACK
 && 
downPos
 =
SBS_HORZTHUMB
)

429 
rc
 = 
hwnd
->
hs¸ﬁl
.rc;

430 
moveLe·
 = 
rc
.
À·
 + 
mwSYSMETRICS_CXHSCROLL
;

431 
moveRight
 = 
hwnd
->
hs¸ﬁl
.
rc
.
right
 - 
mwSYSMETRICS_CXHSCROLL
;

432 
moveR™ge
 = 
moveRight
 - 
moveLe·
;

434 
ôemCou¡
 = 
hwnd
->
hs¸ﬁl
.
maxPos
 - hwnd->hs¸ﬁl.
möPos
 + 1;

435 
ôemVisibÀ
 = 
hwnd
->
hs¸ﬁl
.
∑geSãp
;

436 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

438 
√wThumbPos
 = ((
±
.
x
 - 
moveLe·
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

439 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

440 
±
.
y
,
moveLe·
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

442 i‡–
√wThumbPos
 >
hwnd
->
hs¸ﬁl
.
möPos
 &&

443 
√wThumbPos
 <
hwnd
->
hs¸ﬁl
.
maxPos
)

444 
	`SídMesßge
 (
hwnd
,

445 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

452 
WM_NCLBUTTONUP
:

453 
bDøw
=
FALSE
;

454 
downPos
 = 
SBS_UNKNOWN
;

456 i‡(
sbCode
==
SB_THUMBTRACK
)

458 i‡(
hôcode
 =
HTVSCROLL
 && 
vîtb¨
)

462 
rc
 = 
hwnd
->
vs¸ﬁl
.rc;

463 
moveT›
 = 
rc
.
t›
 + 
mwSYSMETRICS_CYVSCROLL
;

464 
moveBŸtom
 = 
hwnd
->
vs¸ﬁl
.
rc
.
bŸtom
 - 
mwSYSMETRICS_CYVSCROLL
;

465 
moveR™ge
 = 
moveBŸtom
 - 
moveT›
;

467 
ôemCou¡
 = 
hwnd
->
vs¸ﬁl
.
maxPos
 - hwnd->vs¸ﬁl.
möPos
 + 1;

468 
ôemVisibÀ
 = 
hwnd
->
vs¸ﬁl
.
∑geSãp
;

469 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

471 
√wThumbPos
 = ((
±
.
y
 - 
moveT›
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

472 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

473 
±
.
y
,
moveT›
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

475 i‡–
√wThumbPos
 >
hwnd
->
vs¸ﬁl
.
möPos
 &&

476 
√wThumbPos
 <
hwnd
->
vs¸ﬁl
.
maxPos
)

477 
	`SídMesßge
 (
hwnd
,

478 
WM_VSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

482 i‡(
hôcode
 =
HTHSCROLL
 && 
h‹zb¨
)

486 
rc
 = 
hwnd
->
hs¸ﬁl
.rc;

487 
moveLe·
 = 
rc
.
À·
 + 
mwSYSMETRICS_CXHSCROLL
;

488 
moveRight
 = 
hwnd
->
hs¸ﬁl
.
rc
.
right
 - 
mwSYSMETRICS_CXHSCROLL
;

489 
moveR™ge
 = 
moveRight
 - 
moveLe·
;

491 
ôemCou¡
 = 
hwnd
->
hs¸ﬁl
.
maxPos
 - hwnd->hs¸ﬁl.
möPos
 + 1;

492 
ôemVisibÀ
 = 
hwnd
->
hs¸ﬁl
.
∑geSãp
;

493 
ôemMovóbÀ
 = 
ôemCou¡
 - 
ôemVisibÀ
 + 1;

495 
√wThumbPos
 = ((
±
.
x
 - 
moveLe·
Ë* 
ôemMovóbÀ
Ë/ 
moveR™ge
;

496 
	`¥ötf
("((%d-%d)*%d)/%d=%d\n",

497 
±
.
y
,
moveLe·
,
ôemMovóbÀ
,
moveR™ge
,
√wThumbPos
);

499 i‡–
√wThumbPos
 >
hwnd
->
hs¸ﬁl
.
möPos
 &&

500 
√wThumbPos
 <
hwnd
->
hs¸ﬁl
.
maxPos
)

501 
	`SídMesßge
 (
hwnd
,

502 
WM_HSCROLL
, 
SB_THUMBTRACK
, 
√wThumbPos
);

508 i‡(
hôcode
 =
HTVSCROLL
 && 
vîtb¨
)

509 
	`SídMesßge
 (
hwnd
, 
WM_VSCROLL
, 
sbCode
, 0);

511 i‡(
hôcode
 =
HTHSCROLL
 && 
h‹zb¨
)

512 
	`SídMesßge
 (
hwnd
, 
WM_HSCROLL
, 
sbCode
, 0);

517 
	}
}

520 
BOOL


521 
	$PtInRe˘2
(c⁄° 
RECT
 *
Õrc
, 
x
, 
y
)

523 
POINT
 
p
;

525 
p
.
x
 = x;

526 
p
.
y
 = y;

527  
	`PtInRe˘
(
Õrc
, 
p
);

528 
	}
}

534 
	$wndS¸ﬁlB¨Pos
 (
HWND
 
hwnd
, 
BOOL
 
bIsHB¨
, 
RECT
* 
rcB¨
)

536 
UINT
 
moveR™ge
;

537 
PMWSCROLLBARINFO
 
pSB¨
;

539 i‡(
bIsHB¨
)

540 
pSB¨
 = &
hwnd
->
hs¸ﬁl
;

542 
pSB¨
 = &
hwnd
->
vs¸ﬁl
;

544 i‡(
pSB¨
->
möPos
 =pSB¨->
maxPos
) {

545 
pSB¨
->
°©us
 |
SBS_HIDE
;

549 i‡(
bIsHB¨
)

550 
moveR™ge
 = (
rcB¨
->
right
 -ÑcB¨->
À·
Ë- (
mwSYSMETRICS_CXHSCROLL
<<1);

552 
moveR™ge
 = (
rcB¨
->
bŸtom
 -ÑcB¨->
t›
Ë- (
mwSYSMETRICS_CYVSCROLL
<<1);

554 
	#MWM_DEFBARLEN
 18

	)

555 
	#MWM_MINBARLEN
 8

	)

557 i‡(
pSB¨
->
∑geSãp
 == 0)

559 
pSB¨
->
b¨Lí
 = 
MWM_DEFBARLEN
;

561 i‡(
pSB¨
->
b¨Lí
 > 
moveR™ge
)

562 
pSB¨
->
b¨Lí
 = 
MWM_MINBARLEN
;

566 
pSB¨
->
b¨Lí
 = 
moveR™ge
 *ÖSB¨->
∑geSãp
 /

567 (
pSB¨
->
maxPos
 -ÖSB¨->
möPos
 + 1);

568 i‡(
pSB¨
->
b¨Lí
 < 
MWM_MINBARLEN
)

569 
pSB¨
->
b¨Lí
 = 
MWM_MINBARLEN
;

572 
pSB¨
->
b¨Sèπ
 = 
moveR™ge
 * (pSB¨->
curPos
 -ÖSB¨->
möPos
) /

573 (
pSB¨
->
maxPos
 -ÖSB¨->
möPos
 + 1);

576 i‡(
pSB¨
->
b¨Sèπ
 +ÖSB¨->
b¨Lí
 > 
moveR™ge
)

577 
pSB¨
->
b¨Sèπ
 = 
moveR™ge
 -ÖSB¨->
b¨Lí
;

580 i‡(
pSB¨
->
b¨Sèπ
 < 0)

581 
pSB¨
->
b¨Sèπ
 = 0;

582 
	}
}

584 
PMWSCROLLBARINFO
 
	$wndGëS¸ﬁlB¨
 (
HWND
 
pWö
, 
iSB¨
)

586 i‡(
iSB¨
 =
SB_HORZ
) {

587 i‡(
pWö
->
°yÀ
 & 
WS_HSCROLL
)

588  &
pWö
->
hs¸ﬁl
;

590 i‡(
iSB¨
 =
SB_VERT
) {

591 i‡(
pWö
->
°yÀ
 & 
WS_VSCROLL
)

592  &
pWö
->
vs¸ﬁl
;

595  
NULL
;

596 
	}
}

598 
BOOL
 
	$E«bÀS¸ﬁlB¨
 (
HWND
 
hWnd
, 
iSB¨
, 
BOOL
 
bE«bÀ
)

600 
PMWSCROLLBARINFO
 
pSB¨
;

601 
HWND
 
pWö
;

602 
BOOL
 
bPªvSèã
;

603 
RECT
 
rcB¨
;

605 
pWö
 = (
HWND
)
hWnd
;

607 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

608  
FALSE
;

610 
bPªvSèã
 = !(
pSB¨
->
°©us
 & 
SBS_DISABLED
);

612 i‡(
bE«bÀ
 && !
bPªvSèã
)

613 
pSB¨
->
°©us
 &~
SBS_DISABLED
;

614 i‡(!
bE«bÀ
 && 
bPªvSèã
)

615 
pSB¨
->
°©us
 |
SBS_DISABLED
;

617  
FALSE
;

619 i‡(
iSB¨
 =
SB_VERT
)

621 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

622 
rcB¨
.
À·
 --;

623 
rcB¨
.
right
 --;

627 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

628 
rcB¨
.
t›
 --;

629 
rcB¨
.
bŸtom
 --;

632 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

634 
	`MwPaötNCS¸ﬁlb¨s
(
hWnd
,
NULL
);

637  
TRUE
;

638 
	}
}

640 
BOOL
 
	$GëS¸ﬁlPos
 (
HWND
 
hWnd
, 
iSB¨
, * 
pPos
)

642 
PMWSCROLLBARINFO
 
pSB¨
;

643 
HWND
 
pWö
;

645 
pWö
 = (
HWND
)
hWnd
;

647 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

648  
FALSE
;

650 *
pPos
 = 
pSB¨
->
curPos
;

651  
TRUE
;

652 
	}
}

654 
BOOL
 
	$GëS¸ﬁlR™ge
 (
HWND
 
hWnd
, 
iSB¨
, * 
pMöPos
, * 
pMaxPos
)

656 
PMWSCROLLBARINFO
 
pSB¨
;

657 
HWND
 
pWö
;

659 
pWö
 = (
HWND
)
hWnd
;

661 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

662  
FALSE
;

664 *
pMöPos
 = 
pSB¨
->
möPos
;

665 *
pMaxPos
 = 
pSB¨
->
maxPos
;

666  
TRUE
;

667 
	}
}

669 
BOOL
 
	$SëS¸ﬁlPos
 (
HWND
 
hWnd
, 
iSB¨
, 
iNewPos
)

671 
PMWSCROLLBARINFO
 
pSB¨
;

672 
HWND
 
pWö
;

673 
RECT
 
rcB¨
;

675 
pWö
 = (
HWND
)
hWnd
;

677 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

678  
FALSE
;

680 i‡(
iNewPos
 < 
pSB¨
->
möPos
)

681 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

683 
pSB¨
->
curPos
 = 
iNewPos
;

686 
max
 = 
pSB¨
->
maxPos
;

687 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

689 i‡(
pSB¨
->
curPos
 > 
max
)

690 
pSB¨
->
curPos
 = 
max
;

693 i‡(
iSB¨
 =
SB_VERT
)

695 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

696 
rcB¨
.
À·
 --;

697 
rcB¨
.
right
 --;

701 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

702 
rcB¨
.
t›
 --;

703 
rcB¨
.
bŸtom
 --;

706 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
iSB¨
 =
SB_HORZ
, &
rcB¨
);

709 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

711 
	`MwPaötNCS¸ﬁlb¨s
(
hWnd
,
NULL
);

713  
TRUE
;

714 
	}
}

716 
BOOL
 
	$SëS¸ﬁlR™ge
 (
HWND
 
hWnd
, 
iSB¨
, 
iMöPos
, 
iMaxPos
)

718 
PMWSCROLLBARINFO
 
pSB¨
;

719 
HWND
 
pWö
;

720 
RECT
 
rcB¨
;

722 
pWö
 = (
HWND
)
hWnd
;

724 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

725  
FALSE
;

727 
pSB¨
->
möPos
 = (
iMöPos
 < 
iMaxPos
)?iMinPos:iMaxPos;

728 
pSB¨
->
maxPos
 = (
iMöPos
 > 
iMaxPos
)?iMinPos:iMaxPos;

731 i‡(
pSB¨
->
curPos
 <ÖSB¨->
möPos
)

732 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

734 i‡(
pSB¨
->
∑geSãp
 <= 0)

735 
pSB¨
->
∑geSãp
 = 0;

736 i‡(
pSB¨
->
∑geSãp
 > (pSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1))

737 
pSB¨
->
∑geSãp
 =ÖSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1;

740 
max
 = 
pSB¨
->
maxPos
;

741 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

743 i‡(
pSB¨
->
curPos
 > 
max
)

744 
pSB¨
->
curPos
 = 
max
;

747 i‡(
iSB¨
 =
SB_VERT
)

749 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

750 
rcB¨
.
À·
 --;

751 
rcB¨
.
right
 --;

755 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

756 
rcB¨
.
t›
 --;

757 
rcB¨
.
bŸtom
 --;

759 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
iSB¨
 =
SB_HORZ
, &
rcB¨
);

762 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

764 
	`MwPaötNCS¸ﬁlb¨s
(
hWnd
,
NULL
);

767  
TRUE
;

768 
	}
}

770 
BOOL
 
	$SëS¸ﬁlInfo
 (
HWND
 
hWnd
, 
iSB¨
,

771 
LPCSCROLLINFO
 
Õsi
, 
BOOL
 
fRedøw
)

773 
PMWSCROLLBARINFO
 
pSB¨
;

774 
HWND
 
pWö
;

775 
RECT
 
rcB¨
;

777 
pWö
 = (
HWND
)
hWnd
;

779 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

780  
FALSE
;

782 if–
Õsi
->
fMask
 & 
SIF_RANGE
 )

784 
pSB¨
->
möPos
 = (
Õsi
->
nMö
 <Üpsi->
nMax
)?lpsi->nMin:lpsi->nMax;

785 
pSB¨
->
maxPos
 = (
Õsi
->
nMö
 <Üpsi->
nMax
)?lpsi->nMax:lpsi->nMin;

788 if–
Õsi
->
fMask
 & 
SIF_POS
 )

789 
pSB¨
->
curPos
 = 
Õsi
->
nPos
;

791 if–
Õsi
->
fMask
 & 
SIF_PAGE
 )

792 
pSB¨
->
∑geSãp
 = 
Õsi
->
nPage
;

795 i‡(
pSB¨
->
curPos
 <ÖSB¨->
möPos
)

796 
pSB¨
->
curPos
 =ÖSB¨->
möPos
;

798 i‡(
pSB¨
->
∑geSãp
 <= 0)

799 
pSB¨
->
∑geSãp
 = 0;

800 i‡(
pSB¨
->
∑geSãp
 > (pSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1))

801 
pSB¨
->
∑geSãp
 =ÖSB¨->
maxPos
 -ÖSB¨->
möPos
 + 1;

804 
max
 = 
pSB¨
->
maxPos
;

805 
max
 -((
pSB¨
->
∑geSãp
 - 1) > 0)?(pSBar->pageStep - 1):0;

807 i‡(
pSB¨
->
curPos
 > 
max
)

808 
pSB¨
->
curPos
 = 
max
;

811 if(
fRedøw
)

813 i‡(
iSB¨
 =
SB_VERT
)

815 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

816 
rcB¨
.
À·
 --;

817 
rcB¨
.
right
 --;

821 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

822 
rcB¨
.
t›
 --;

823 
rcB¨
.
bŸtom
 --;

825 
	`wndS¸ﬁlB¨Pos
 (
pWö
, 
iSB¨
 =
SB_HORZ
, &
rcB¨
);

828 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, (
LPARAM
)(&
rcB¨
));

830 
	`MwPaötNCS¸ﬁlb¨s
(
hWnd
,
NULL
);

834  
TRUE
;

835 
	}
}

837 
BOOL
 
	$GëS¸ﬁlInfo
(
HWND
 
hWnd
, 
iSB¨
, 
LPSCROLLINFO
 
Õsi
)

839 
PMWSCROLLBARINFO
 
pSB¨
;

840 
HWND
 
pWö
;

842 
pWö
 = (
HWND
)
hWnd
;

844 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

845  
FALSE
;

847 if–
Õsi
->
fMask
 & 
SIF_RANGE
 )

849 
Õsi
->
nMö
 = 
pSB¨
->
möPos
;

850 
Õsi
->
nMax
 = 
pSB¨
->
maxPos
;

853 if–
Õsi
->
fMask
 & 
SIF_POS
 )

855 
Õsi
->
nPos
 = 
pSB¨
->
curPos
;

858 if–
Õsi
->
fMask
 & 
SIF_PAGE
 )

859 
Õsi
->
nPage
 = 
pSB¨
->
∑geSãp
;

861  
TRUE
;

862 
	}
}

864 
BOOL
 
	$ShowS¸ﬁlB¨
 (
HWND
 
hWnd
, 
iSB¨
, 
BOOL
 
bShow
)

866 
PMWSCROLLBARINFO
 
pSB¨
;

867 
HWND
 
pWö
;

868 
BOOL
 
bPªvSèã
;

869 
RECT
 
rcB¨
;

871 
pWö
 = (
HWND
)
hWnd
;

873 i‡–!(
pSB¨
 = 
	`wndGëS¸ﬁlB¨
 (
pWö
, 
iSB¨
)) )

874  
FALSE
;

876 
bPªvSèã
 = !(
pSB¨
->
°©us
 & 
SBS_HIDE
);

878 i‡(
bShow
 && !
bPªvSèã
)

879 
pSB¨
->
°©us
 &~
SBS_HIDE
;

880 i‡(!
bShow
 && 
bPªvSèã
)

881 
pSB¨
->
°©us
 |
SBS_HIDE
;

883  
FALSE
;

885 
	`SídMesßge
 (
hWnd
, 
WM_CHANGESIZE
, 0, 0);

887 i‡(
iSB¨
 =
SB_VERT
)

888 
	`wndGëVS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

890 
	`wndGëHS¸ﬁlB¨Re˘
 (
pWö
, &
rcB¨
);

893 
RECT
 
rcWö
, 
rcClõ¡
;

895 
	`mem˝y
 (&
rcWö
, &
pWö
->
wöª˘
.
À·
,  (
RECT
));

897 
rcClõ¡
.
À·
 = 0;

898 
rcClõ¡
.
t›
 = 0;

899 
rcClõ¡
.
right
 = 
pWö
->
˛úe˘
.righà-ÖWö->˛úe˘.
À·
;

900 
rcClõ¡
.
bŸtom
 = 
pWö
->
˛úe˘
.bŸtom -ÖWö->˛úe˘.
t›
;

902 
SídMesßge
 (
hWnd
, 
WM_SIZECHANGED
,

903 (
WPARAM
)&
rcWö
, (
LPARAM
)&
rcClõ¡
);

907 i‡(
bShow
) {

908 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, 0);

911 
rcB¨
.
À·
 -
pWö
->
˛úe˘
.left;

912 
rcB¨
.
t›
 -
pWö
->
˛úe˘
.top;

913 
rcB¨
.
right
 -
pWö
->
˛úe˘
.
À·
;

914 
rcB¨
.
bŸtom
 -
pWö
->
˛úe˘
.
t›
;

915 
	`SídMesßge
 (
hWnd
, 
WM_NCPAINT
, 0, 0);

916 
	`InvÆid©eRe˘
 (
hWnd
, &
rcB¨
, 
TRUE
);

919  
TRUE
;

920 
	}
}

	@mwin/winuser.c

6 
	~"wödows.h
"

7 
	~"wöã∫.h
"

8 
	~"devi˚.h
"

9 
	~<°dlib.h
>

10 
	~<°rög.h
>

12 #i‡
PSP


13 
	~<p•kî√l.h
>

14 
	~<p•debug.h
>

17 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

18 
	#Ârötf
(
fh
,
ss
 ...Ë
	`p•DebugS¸ìnPrötf
(ss)

	)

20 
	#¥ötf
(...)

	)

21 
	#Ârötf
(...)

	)

26 
	#PAINTONCE
 1

	)

27 
	#MOUSETEST
 1

	)

29 
MWLISTHEAD
 
	gmwMsgHód
;

30 
MWLISTHEAD
 
	gmwCœssHód
;

32 
	gmwSYSMETRICS_CYCAPTION
 = 12;

33 
	gmwSYSMETRICS_CXFRAME
 = 3;

34 
	gmwSYSMETRICS_CYFRAME
 = 3;

35 
	gmwSYSMETRICS_CXBORDER
 = 1;

36 
	gmwSYSMETRICS_CYBORDER
 = 1;

37 
	gmwSYSMETRICS_CXVSCROLL
 = 13;

38 
	gmwSYSMETRICS_CYHSCROLL
 = 13;

39 
	gmwSYSMETRICS_CXHSCROLL
 = 13;

40 
	gmwSYSMETRICS_CYVSCROLL
 = 13;

41 
	gmwSYSMETRICS_CXDOUBLECLK
 = 2;

42 
	gmwSYSMETRICS_CYDOUBLECLK
 = 2;

43 
	gmw∑ötSîül
 = 1;

44 
	gmw∑ötNC
 = 1;

45 
BOOL
 
	gmwf‹˚NC∑öt
 = 
FALSE
;

47 
MwOff£tChûdªn
(
HWND
 
hwnd
, 
offx
, 
offy
);

49 
LRESULT
 
WINAPI


50 
	$CÆlWödowProc
(
WNDPROC
 
ÕPªvWndFunc
, 
HWND
 
hwnd
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
,

51 
LPARAM
 
lP¨am
)

53  (*
ÕPªvWndFunc
)(
hwnd
, 
Msg
, 
wP¨am
, 
lP¨am
);

54 
	}
}

56 
LRESULT
 
WINAPI


57 
	$SídMesßge
(
HWND
 
hwnd
, 
UINT
 
Msg
,
WPARAM
 
wP¨am
,
LPARAM
 
lP¨am
)

59 if(
hwnd
 && hwnd->
pCœss
) {

60 
hwnd
->
∑ötSîül
 = 
mw∑ötSîül
;

61  (*
hwnd
->
pCœss
->
Õ‚WndProc
)(hwnd, 
Msg
, 
wP¨am
, 
lP¨am
);

64 
	}
}

66 
BOOL
 
WINAPI


67 
	$Po°Mesßge
(
HWND
 
hwnd
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

69 
MSG
 * 
pMsg
;

71 #i‡
PAINTONCE


73 if(
Msg
 =
WM_PAINT
) {

74 
hwnd
->
gŸPaötMsg
 = 
PAINT_NEEDSPAINT
;

75  
TRUE
;

78 #i‡
MOUSETEST


80 if(
Msg
 =
WM_MOUSEMOVE
) {

81 
PMWLIST
 
p
;

82 
p
=
mwMsgHód
.
hód
;Ö;Öı->
√xt
) {

83 
pMsg
 = 
	`GdIãmAddr
(
p
, 
MSG
, 
lök
);

84 if(
pMsg
->
hwnd
 =hwnd &&ÖMsg->
mesßge
 =
Msg
) {

85 
pMsg
->
wP¨am
 = wParam;

86 
pMsg
->
lP¨am
 =ÜParam;

87 
pMsg
->
time
 = 
	`GëTickCou¡
();

88 
pMsg
->
±
.
x
 = 
curs‹x
;

89 
pMsg
->
±
.
y
 = 
curs‹y
;

90  
TRUE
;

95 
pMsg
 = 
	`GdIãmNew
(
MSG
);

96 if(!
pMsg
)

97  
FALSE
;

98 
pMsg
->
hwnd
 = hwnd;

99 
pMsg
->
mesßge
 = 
Msg
;

100 
pMsg
->
wP¨am
 = wParam;

101 
pMsg
->
lP¨am
 =ÜParam;

102 
pMsg
->
time
 = 
	`GëTickCou¡
();

103 
pMsg
->
±
.
x
 = 
curs‹x
;

104 
pMsg
->
±
.
y
 = 
curs‹y
;

105 
	`GdLi°Add
(&
mwMsgHód
, &
pMsg
->
lök
);

106  
TRUE
;

107 
	}
}

110 
BOOL
 
WINAPI


111 
	$Po°ThªadMesßge
(
DWORD
 
dwThªadId
, 
UINT
 
Msg
, 
WPARAM
 
wP¨am
, 
LPARAM
 
lP¨am
)

113  
	`Po°Mesßge
(
NULL
, 
Msg
, 
wP¨am
, 
lP¨am
);

114 
	}
}

116 
VOID
 
WINAPI


117 
	$Po°QuôMesßge
(
nExôCode
)

119 
	`Po°Mesßge
(
NULL
, 
WM_QUIT
, 
nExôCode
, 0L);

120 
	}
}

122 
BOOL


123 
	$chkPaötMsg
(
HWND
 
wp
, 
LPMSG
 
ÕMsg
)

130 if(
wp
->
gŸPaötMsg
 =
PAINT_NEEDSPAINT
 &&

131 (!
døgwp
 || døgw∞=
wp
)) {

132 
∑öt
:

133 
wp
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

134 
ÕMsg
->
hwnd
 = 
wp
;

135 
ÕMsg
->
mesßge
 = 
WM_PAINT
;

136 
ÕMsg
->
wP¨am
 = 0;

137 
ÕMsg
->
lP¨am
 = 0;

138 
ÕMsg
->
time
 = 0;

139 
ÕMsg
->
±
.
x
 = 
curs‹x
;

140 
ÕMsg
->
±
.
y
 = 
curs‹y
;

141  
TRUE
;

142 } if(
døgwp
 && 
wp
->
gŸPaötMsg
 =
PAINT_NEEDSPAINT
) {

146 
	`MwSñe˘
();

147 if(
mwMsgHód
.
hód
 =
NULL
)

148 
∑öt
;

150  
FALSE
;

151 
	}
}

153 
BOOL
 
WINAPI


154 
	$PìkMesßge
(
LPMSG
 
ÕMsg
, 
HWND
 
hwnd
, 
UINT
 
uMsgFûãrMö
, UINT 
uMsgFûãrMax
,

155 
UINT
 
wRemoveMsg
)

157 
HWND
 
wp
;

158 
PMSG
 
pNxtMsg
;

160 #i‡
PSP


161 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

165 if(
mwMsgHód
.
hód
 =
NULL
) {

166 #i‡
PAINTONCE


168 
wp
=
li°wp
; wp; wp=wp->
√xt
) {

169 if(!(
wp
->
°yÀ
 & 
WS_CHILD
)) {

170 if(
	`chkPaötMsg
(
wp
, 
ÕMsg
))

171  
TRUE
;

174 
wp
=
li°wp
; wp; wp=wp->
√xt
) {

175 if(
wp
->
°yÀ
 & 
WS_CHILD
) {

176 if(
	`chkPaötMsg
(
wp
, 
ÕMsg
))

177  
TRUE
;

181 
	`MwSñe˘
();

184 if(
mwMsgHód
.
hód
 =
NULL
)

185  
FALSE
;

187 
pNxtMsg
 = (
PMSG
)
mwMsgHód
.
hód
;

188 if(
wRemoveMsg
 & 
PM_REMOVE
)

189 
	`GdLi°Remove
(&
mwMsgHód
, &
pNxtMsg
->
lök
);

190 *
ÕMsg
 = *
pNxtMsg
;

191 if(
wRemoveMsg
 & 
PM_REMOVE
)

192 
	`GdIãmFªe
(
pNxtMsg
);

194 #i‡
PSP


195 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

198  
TRUE
;

199 
	}
}

201 
BOOL
 
WINAPI


202 
	$GëMesßge
(
LPMSG
 
ÕMsg
,
HWND
 
hwnd
,
UINT
 
wMsgFûãrMö
,UINT 
wMsgFûãrMax
)

208 !
	`PìkMesßge
(
ÕMsg
, 
hwnd
, 
wMsgFûãrMö
, 
wMsgFûãrMax
,
PM_REMOVE
))

210  
ÕMsg
->
mesßge
 !
WM_QUIT
;

211 
	}
}

213 
BOOL
 
WINAPI


214 
	$Tøn¶©eMesßge
(
CONST
 
MSG
 *
ÕMsg
)

217 if(
ÕMsg
 && (ÕMsg->
mesßge
 =
WM_KEYDOWN
))

218 
	`Po°Mesßge
(
ÕMsg
->
hwnd
, 
WM_CHAR
,ÜpMsg->
wP¨am
,ÜpMsg->
lP¨am
);

219  
FALSE
;

220 
	}
}

222 
LONG
 
WINAPI


223 
	$Di•©chMesßge
(
CONST
 
MSG
 *
ÕMsg
)

225  
	`SídMesßge
(
ÕMsg
->
hwnd
,ÜpMsg->
mesßge
,ÜpMsg->
wP¨am
,

226 
ÕMsg
->
lP¨am
);

227 
	}
}

230 
PWNDCLASS


231 
	$MwFödCœssByName
(
LPCSTR
 
ÕCœssName
)

233 
PMWLIST
 
p
;

234 
PWNDCLASS
 
pCœss
;

236 
p
=
mwCœssHód
.
hód
;Ö;Öı->
√xt
) {

237 
pCœss
 = 
	`GdIãmAddr
(
p
, 
WNDCLASS
, 
lök
);

238 if(
	`°rcmpi
(
pCœss
->
szCœssName
, 
ÕCœssName
) == 0)

239  
pCœss
;

241  
NULL
;

242 
	}
}

244 
ATOM
 
WINAPI


245 
	$Regi°îCœss
(
CONST
 
WNDCLASS
 *
ÕWndCœss
)

247 
PWNDCLASS
 
pCœss
;

250 
pCœss
 = 
	`MwFödCœssByName
(
ÕWndCœss
->
ÕszCœssName
);

251 if(
pCœss
)

255 
pCœss
 = 
	`GdIãmNew
(
WNDCLASS
);

256 if(!
pCœss
)

258 *
pCœss
 = *
ÕWndCœss
;

259 
	`°r˝y
(
pCœss
->
szCœssName
, 
ÕWndCœss
->
ÕszCœssName
);

260 
	`GdLi°Add
(&
mwCœssHód
, &
pCœss
->
lök
);

263 
	}
}

265 
BOOL
 
WINAPI


266 
	$Uƒegi°îCœss
(
LPCSTR
 
ÕCœssName
, 
HINSTANCE
 
hIn°™˚
)

268 
PWNDCLASS
 
pCœss
;

270 
pCœss
 = 
	`MwFödCœssByName
(
ÕCœssName
);

271 if(!
pCœss
)

272  
FALSE
;

273 
	`GdLi°Remove
(&
mwCœssHód
, &
pCœss
->
lök
);

274 
	`DñëeObje˘
(
pCœss
->
hbrBackground
);

275 
	`GdIãmFªe
(
pCœss
);

276  
TRUE
;

277 
	}
}

279 
HWND
 
WINAPI


280 
	$Cª©eWödowEx
(
DWORD
 
dwExStyÀ
, 
LPCSTR
 
ÕCœssName
, LPCSTR 
ÕWödowName
,

281 
DWORD
 
dwStyÀ
, 
x
, 
y
, 
nWidth
, 
nHeight
,

282 
HWND
 
hwndP¨ít
, 
HMENU
 
hMíu
, 
HINSTANCE
 
hIn°™˚
, 
LPVOID
 
ÕP¨am
)

284 
HWND
 
pwp
;

285 
HWND
 
wp
;

286 
HWND
 
hwndOw√r
;

287 
PWNDCLASS
 
pCœss
;

288 
CREATESTRUCT
 
cs
;

289 
√xtx
 = 20;

290 
√xty
 = 20;

292 
pCœss
 = 
	`MwFödCœssByName
(
ÕCœssName
);

293 if(!
pCœss
)

294  
NULL
;

296 if(
x
 =
CW_USEDEFAULT
 || 
y
 == CW_USEDEFAULT) {

297 
x
 = 
√xtx
;

298 
√xtx
 += 10;

299 
y
 = 
√xty
;

300 
√xty
 += 10;

301 if(
√xtx
 > 200)

302 
√xtx
 = 
√xty
 = 20;

304 if(
nWidth
 =
CW_USEDEFAULT
 || 
nHeight
 == CW_USEDEFAULT) {

305 
nWidth
 = 250;

306 
nHeight
 = 250;

309 if(
hwndP¨ít
 =
NULL
) {

310 if(
dwStyÀ
 & 
WS_CHILD
)

311  
NULL
;

312 
pwp
 = 
roŸwp
;

314 
pwp
 = 
hwndP¨ít
;

317 if(
dwStyÀ
 & 
WS_POPUP
)

318 
pwp
 = 
roŸwp
;

321 if(
dwStyÀ
 & 
WS_CHILD
)

322 
hwndOw√r
 = 
NULL
;

323 
hwndOw√r
 = 
hwndP¨ít
;

325 
wp
 = (
HWND
)
	`GdIãmAŒoc
((
hwnd
Ë- 1 + 
pCœss
->
cbWndExåa
);

326 if(!
wp
)

327  
NULL
;

330 
dwStyÀ
 |
WS_CLIPSIBLINGS
 | 
WS_CLIPCHILDREN
;

332 
wp
->
pCœss
 =ÖClass;

333 
wp
->
°yÀ
 = 
dwStyÀ
;

334 
wp
->
ex°yÀ
 = 
dwExStyÀ
;

335 
wp
->
∑ª¡
 = 
pwp
;

336 
wp
->
ow√r
 = 
hwndOw√r
;

337 
wp
->
chûdªn
 = 
NULL
;

338 
wp
->
siblögs
 = 
pwp
->
chûdªn
;

339 
pwp
->
chûdªn
 = 
wp
;

340 
wp
->
√xt
 = 
li°wp
;

341 
li°wp
 = 
wp
;

342 
wp
->
wöª˘
.
À·
 = 
pwp
->
˛úe˘
.À· + 
x
;

343 
wp
->
wöª˘
.
t›
 = 
pwp
->
˛úe˘
.t› + 
y
;

344 
wp
->
wöª˘
.
right
 = wp->wöª˘.
À·
 + 
nWidth
;

345 
wp
->
wöª˘
.
bŸtom
 = wp->wöª˘.
t›
 + 
nHeight
;

346 
wp
->
curs‹
 = 
pwp
->cursor;

347 
wp
->
curs‹
->
u£cou¡
++;

348 
wp
->
unm≠cou¡
 = 
pwp
->unmapcount + 1;

349 
wp
->
id
 = ()
hMíu
;

350 
wp
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

351 
	`°rz˝y
(
wp
->
szTôÀ
, 
ÕWödowName
, (wp->szTitle));

352 #i‡
UPDATEREGIONS


353 
wp
->
upd©e
 = 
	`GdAŒocRegi⁄
();

355 
wp
->
√xåabyãs
 = 
pCœss
->
cbWndExåa
;

358 
	`MwCÆcClõ¡Re˘
(
wp
);

360 
cs
.
ÕCª©eP¨ams
 = 
ÕP¨am
;

361 
cs
.
hIn°™˚
 = hInstance;

362 
cs
.
hMíu
 = hMenu;

363 
cs
.
hwndP¨ít
 = hwndParent;

364 
cs
.
cy
 = 
nHeight
;

365 
cs
.
cx
 = 
nWidth
;

366 
cs
.
y
 = y;

367 
cs
.
x
 = x;

368 
cs
.
°yÀ
 = 
dwStyÀ
;

369 
cs
.
ÕszName
 = 
ÕWödowName
;

370 
cs
.
ÕszCœss
 = 
ÕCœssName
;

371 
cs
.
dwExStyÀ
 = dwExStyle;

373 if(
	`SídMesßge
(
wp
, 
WM_CREATE
, 0, (
LPARAM
)(
LPSTR
)&
cs
) == -1) {

374 
	`MwDe°royWödow
(
wp
, 
FALSE
);

375  
NULL
;

379 
	`MwSídSizeMove
(
wp
, 
TRUE
, TRUE);

381 if(
wp
->
°yÀ
 & 
WS_VISIBLE
) {

382 
	`MwShowWödow
(
wp
, 
TRUE
);

383 
	`SëFocus
(
wp
);

386  
wp
;

387 
	}
}

389 
BOOL
 
WINAPI


390 
	$De°royWödow
(
HWND
 
hwnd
)

392 
	`MwDe°royWödow
(
hwnd
, 
TRUE
);

393  
TRUE
;

394 
	}
}

401 
	$MwDe°royWödow
(
HWND
 
hwnd
,
BOOL
 
bSídMsg
)

403 
HWND
 
wp
 = 
hwnd
;

404 
HWND
 
¥evwp
;

405 
PMWLIST
 
p
;

406 
PMSG
 
pmsg
;

408 i‡(
wp
 =
roŸwp
)

414 i‡(
wp
->
unm≠cou¡
 == 0)

415 
	`MwHideWödow
(
wp
, 
FALSE
, FALSE);

417 if(
bSídMsg
)

418 
	`SídMesßge
(
hwnd
, 
WM_DESTROY
, 0, 0L);

423 
wp
->
pCœss
 = 
NULL
;

428 
wp
->
chûdªn
)

429 
	`MwDe°royWödow
(
wp
->
chûdªn
, 
bSídMsg
);

434 i‡(
wp
->
curs‹
->
u£cou¡
-- == 1) {

435 
	`‰ì
(
wp
->
curs‹
);

436 
wp
->
curs‹
 = 
NULL
;

442 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

443 i‡(
¥evwp
 =
wp
)

444 
wp
->
∑ª¡
->
chûdªn
 = wp->
siblögs
;

446 
¥evwp
->
siblögs
 !
wp
)

447 
¥evwp
 =Öªvwp->
siblögs
;

448 
¥evwp
->
siblögs
 = 
wp
->siblings;

450 
wp
->
siblögs
 = 
NULL
;

455 
¥evwp
 = 
li°wp
;

456 i‡(
¥evwp
 =
wp
)

457 
li°wp
 = 
wp
->
√xt
;

459 
¥evwp
->
√xt
 !
wp
)

460 
¥evwp
 =Öªvwp->
√xt
;

461 
¥evwp
->
√xt
 = 
wp
->next;

463 
wp
->
√xt
 = 
NULL
;

471 
p
=
mwMsgHód
.
hód
;Ö; ) {

472 
pmsg
 = 
	`GdIãmAddr
(
p
, 
MSG
, 
lök
);

473 if(
pmsg
->
hwnd
 =
wp
) {

474 
p
 =Ö->
√xt
;

475 
	`GdLi°Remove
(&
mwMsgHód
, &
pmsg
->
lök
);

476 
	`GdIãmFªe
(
p
);

478 
p
 =Ö->
√xt
;

483 i‡(
wp
 =
ˇ±uªwp
) {

484 
ˇ±uªwp
 = 
NULL
;

485 
	`MwCheckMou£Wödow
();

488 i‡(
wp
 =
	`MwGëT›Wödow
(
focuswp
))

489 
	`SëFocus
(
roŸwp
->
chûdªn
?Ñootwp->children:Ñootwp);

492 if(
wp
->
owndc
) {

493 
HDC
 
hdc
 = 
wp
->
owndc
;

494 
wp
->
owndc
 = 
NULL
;

495 
	`Rñó£DC
(
wp
, 
hdc
);

497 #i‡
UPDATEREGIONS


498 
	`GdDe°royRegi⁄
(
wp
->
upd©e
);

500 
	`GdIãmFªe
(
wp
);

501 
	}
}

503 
BOOL
 
WINAPI


504 
	$IsWödow
(
HWND
 
hwnd
)

506 
HWND
 
wp
;

508 
wp
=
li°wp
; wp; wp=wp->
√xt
)

509 if(
wp
 =
hwnd
)

510  
TRUE
;

511  
FALSE
;

512 
	}
}

514 
BOOL
 
WINAPI


515 
	$ShowWödow
(
HWND
 
hwnd
, 
nCmdShow
)

517 if(!
hwnd
)

518  
FALSE
;

522 
nCmdShow
) {

523 
SW_HIDE
:

524 i‡(!(
hwnd
->
°yÀ
 & 
WS_VISIBLE
))

525  
FALSE
;

526 
	`MwHideWödow
(
hwnd
, 
TRUE
, TRUE);

527 
hwnd
->
°yÀ
 &~
WS_VISIBLE
;

531 i‡(
hwnd
->
°yÀ
 & 
WS_VISIBLE
)

532  
FALSE
;

533 
hwnd
->
°yÀ
 |
WS_VISIBLE
;

534 
	`MwShowWödow
(
hwnd
, 
TRUE
);

536  
TRUE
;

537 
	}
}

539 
BOOL
 
WINAPI


540 
	$InvÆid©eRe˘
(
HWND
 
hwnd
, 
CONST
 
RECT
 *
ÕRe˘
, 
BOOL
 
bEø£
)

543 if(!
hwnd
)

544 
	`MwRedøwS¸ìn
();

546 #i‡
UPDATEREGIONS


547 
RECT
 
rc
;

550 if(!
ÕRe˘
)

551 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

552 
rc
 = *
ÕRe˘
;

553 
rc
.
bŸtom
 +
mwSYSMETRICS_CYCAPTION
 +

554 
mwSYSMETRICS_CYFRAME
 + 1;

555 
rc
.
right
 +
mwSYSMETRICS_CXFRAME
;

556 
	`MwUni⁄Upd©eRegi⁄
(
hwnd
, 
rc
.
À·
,Ñc.
t›
,

557 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
, 
TRUE
);

560 if(
hwnd
->
upd©e
->
numRe˘s
 != 0)

562 if(
hwnd
->
gŸPaötMsg
 =
PAINT_PAINTED
)

563 
hwnd
->
gŸPaötMsg
 = 
PAINT_NEEDSPAINT
;

565  
TRUE
;

566 
	}
}

568 #i‡
UPDATEREGIONS


570 
BOOL
 
WINAPI


571 
	$InvÆid©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
, 
BOOL
 
bEø£
)

574 if(
hwnd
) {

575 if(!
hrgn
)

577  
	`InvÆid©eRe˘
(
hwnd
, 
NULL
, 
bEø£
);

580 
	`GdOff£tRegi⁄
(((
MWRGNOBJ
 *)
hrgn
)->
rgn
,

581 
hwnd
->
˛úe˘
.
À·
, hwnd->˛úe˘.
t›
);

582 
	`GdUni⁄Regi⁄
(
hwnd
->
upd©e
, hwnd->update,

583 ((
MWRGNOBJ
 *)
hrgn
)->
rgn
);

584 
	`GdOff£tRegi⁄
(((
MWRGNOBJ
 *)
hrgn
)->
rgn
,

585 -
hwnd
->
˛úe˘
.
À·
, -hwnd->˛úe˘.
t›
);

588 if(
hwnd
->
upd©e
->
numRe˘s
 != 0)

589 if(
hwnd
->
gŸPaötMsg
 =
PAINT_PAINTED
)

590 
hwnd
->
gŸPaötMsg
 = 
PAINT_NEEDSPAINT
;

592  
TRUE
;

593 
	}
}

595 
BOOL
 
WINAPI


596 
	$VÆid©eRe˘
(
HWND
 
hwnd
, 
CONST
 
RECT
 *
Õrc
)

598 
RECT
 
rc
;

600 if(!
hwnd
)

601 
	`MwRedøwS¸ìn
();

604 if(!
Õrc
)

605 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

606 
rc
 = *
Õrc
;

607 
rc
.
bŸtom
 +
mwSYSMETRICS_CYCAPTION
 +

608 
mwSYSMETRICS_CYFRAME
 + 1;

609 
rc
.
right
 +
mwSYSMETRICS_CXFRAME
;

610 
	`MwUni⁄Upd©eRegi⁄
(
hwnd
, 
rc
.
À·
,Ñc.
t›
,

611 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
, 
FALSE
);

614 if(
hwnd
->
upd©e
->
numRe˘s
 == 0)

615 if(
hwnd
->
gŸPaötMsg
 =
PAINT_NEEDSPAINT
)

616 
hwnd
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

618  
TRUE
;

619 
	}
}

622 
BOOL
 
WINAPI


623 
	$VÆid©eRgn
(
HWND
 
hwnd
, 
HRGN
 
hrgn
)

625 if(
hwnd
) {

626 if(!
hrgn
)

628  
	`VÆid©eRe˘
(
hwnd
, 
NULL
);

631 
	`GdOff£tRegi⁄
(((
MWRGNOBJ
 *)
hrgn
)->
rgn
,

632 
hwnd
->
˛úe˘
.
À·
, hwnd->˛úe˘.
t›
);

633 
	`GdSubåa˘Regi⁄
(
hwnd
->
upd©e
, hwnd->update,

634 ((
MWRGNOBJ
 *)
hrgn
)->
rgn
);

635 
	`GdOff£tRegi⁄
(((
MWRGNOBJ
 *)
hrgn
)->
rgn
,

636 -
hwnd
->
˛úe˘
.
À·
, -hwnd->˛úe˘.
t›
);

639 if(
hwnd
->
upd©e
->
numRe˘s
 == 0)

640 if(
hwnd
->
gŸPaötMsg
 =
PAINT_NEEDSPAINT
)

641 
hwnd
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

643  
TRUE
;

644 
	}
}

647 
BOOL
 
WINAPI


648 
	$Upd©eWödow
(
HWND
 
hwnd
)

650 #i‡
PAINTONCE


651 if(
hwnd
 && hwnd->
gŸPaötMsg
 =
PAINT_NEEDSPAINT
) {

652 
	`SídMesßge
(
hwnd
, 
WM_PAINT
, 0, 0L);

653 
hwnd
->
gŸPaötMsg
 = 
PAINT_PAINTED
;

654  
TRUE
;

656  
FALSE
;

659 
	`SídMesßge
(
hwnd
, 
WM_PAINT
, 0, 0L);

660  
TRUE
;

662 
	}
}

664 
HWND
 
WINAPI


665 
	$GëFocus
(
VOID
)

667  
focuswp
;

668 
	}
}

670 
HWND
 
WINAPI


671 
	$SëFocus
(
HWND
 
hwnd
)

673 
HWND
 
ﬁdfocus
;

674 
HWND
 
t›
, 
t›2
;

677 if(!
hwnd
 || hwnd->
unm≠cou¡
)

678 
hwnd
 = 
roŸwp
;

680 if(
hwnd
 =
focuswp
)

681  
focuswp
;

683 
ﬁdfocus
 = 
focuswp
;

684 
	`SídMesßge
(
ﬁdfocus
, 
WM_KILLFOCUS
, (
WPARAM
)
hwnd
, 0L);

685 
focuswp
 = 
hwnd
;

686 
	`SídMesßge
(
focuswp
, 
WM_SETFOCUS
, (
WPARAM
)
ﬁdfocus
, 0L);

689 
t›
 = 
	`MwGëT›Wödow
(
ﬁdfocus
);

690 
t›2
 = 
	`MwGëT›Wödow
(
focuswp
);

691 if(
t›2
 !
t›
) {

693 
	`SídMesßge
(
t›
, 
WM_ACTIVATE
, (
WPARAM
)
	`MAKELONG
(
WA_INACTIVE
, 0),

694 (
LPARAM
)
t›2
);

696 
	`MwPaötNCAªa
(
t›
);

703 
	`MwUni⁄Upd©eRegi⁄
(
t›2
, 0, 0,

704 
t›2
->
wöª˘
.
right
-t›2->wöª˘.
À·
,

705 
mwSYSMETRICS_CYCAPTION
+4, 
TRUE
);

708 
	`SídMesßge
(
t›
, 
WM_ACTIVATE
, (
WPARAM
)
	`MAKELONG
(
WA_ACTIVE
, 0),

709 (
LPARAM
)
t›
);

710 
	`MwPaötNCAªa
(
t›2
);

713  
ﬁdfocus
;

714 
	}
}

718 
BOOL
 
WINAPI


719 
	$SëF‹egroundWödow
(
HWND
 
hwnd
)

722 
	`SëFocus
(
hwnd
);

725 
	`SëWödowPos
(
	`MwGëT›Wödow
(
hwnd
), 
HWND_TOP
, 0, 0, 0, 0,

726 
SWP_NOMOVE
|
SWP_NOSIZE
);

728  
TRUE
;

729 
	}
}

732 
HWND
 
WINAPI


733 
	$SëA˘iveWödow
(
HWND
 
hwnd
)

735 
HWND
 
ﬁdA˘ive
;

737 
ﬁdA˘ive
 = 
	`GëA˘iveWödow
();

738 
	`SëFocus
(
hwnd
);

739  
ﬁdA˘ive
;

740 
	}
}

743 
HWND
 
WINAPI


744 
	$GëA˘iveWödow
(
VOID
)

746  
	`MwGëT›Wödow
(
focuswp
);

747 
	}
}

750 
BOOL
 
WINAPI


751 
	$BrögWödowToT›
(
HWND
 
hwnd
)

753  
	`SëF‹egroundWödow
(
hwnd
);

754 
	}
}

756 
HWND
 
WINAPI


757 
	$GëDeskt›Wödow
(
VOID
)

759  
roŸwp
;

760 
	}
}

762 
HWND


763 
	$MwGëT›Wödow
(
HWND
 
hwnd
)

765 
hwnd
->
°yÀ
 & 
WS_CHILD
)

766 
hwnd
 = hwnd->
∑ª¡
;

767  
hwnd
;

768 
	}
}

770 
HWND
 
WINAPI


771 
	$GëP¨ít
(
HWND
 
hwnd
)

774 if(!
hwnd
 || !(hwnd->
°yÀ
 & (
WS_POPUP
|
WS_CHILD
)))

775  
NULL
;

776 if(
hwnd
->
°yÀ
 & 
WS_POPUP
)

777  
hwnd
->
ow√r
;

778  
hwnd
->
∑ª¡
;

779 
	}
}

781 
BOOL
 
WINAPI


782 
	$E«bÀWödow
(
HWND
 
hwnd
, 
BOOL
 
bE«bÀ
)

784 if(
bE«bÀ
 && (
hwnd
->
°yÀ
 & 
WS_DISABLED
)) {

786 
hwnd
->
°yÀ
 &~
WS_DISABLED
;

787 
	`SídMesßge
(
hwnd
, 
WM_ENABLE
, 
TRUE
, 0L);

788  
TRUE
;

790 if(!
bE«bÀ
 && !(
hwnd
->
°yÀ
 & 
WS_DISABLED
)) {

792 
hwnd
->
°yÀ
 |
WS_DISABLED
;

795 if(
hwnd
 =
focuswp
)

796 
	`SëFocus
(
NULL
);

797 
	`SídMesßge
(
hwnd
, 
WM_ENABLE
, 
FALSE
, 0L);

798  
FALSE
;

800  (
hwnd
->
°yÀ
 & 
WS_DISABLED
) != 0;

801 
	}
}

804 
BOOL
 
WINAPI


805 
	$Adju°WödowRe˘Ex
(
LPRECT
 
ÕRe˘
, 
DWORD
 
dwStyÀ
, 
BOOL
 
bMíu
, DWORD 
dwExStyÀ
)

807 
yoff£t
;

809 if(
dwStyÀ
 & 
WS_BORDER
) {

810 if((
dwStyÀ
 & 
WS_CAPTION
) == WS_CAPTION) {

811 
	`InÊ©eRe˘
(
ÕRe˘
, 
mwSYSMETRICS_CXFRAME
,

812 
mwSYSMETRICS_CYFRAME
);

813 
yoff£t
 = 
mwSYSMETRICS_CYCAPTION
 + 1;

814 
ÕRe˘
->
t›
 -
yoff£t
;

815 
ÕRe˘
->
bŸtom
 -
yoff£t
;

817 
	`InÊ©eRe˘
(
ÕRe˘
, 1, 1);

820 if(
ÕRe˘
->
À·
 < 0) {

821 
ÕRe˘
->
right
 -ÕRe˘->
À·
;

822 
ÕRe˘
->
À·
 = 0;

824 if(
ÕRe˘
->
t›
 < 0) {

825 
ÕRe˘
->
bŸtom
 -ÕRe˘->
t›
;

826 
ÕRe˘
->
t›
 = 0;

829  
TRUE
;

830 
	}
}

834 
	$MwCÆcClõ¡Re˘
(
HWND
 
hwnd
)

836 
NCCALCSIZE_PARAMS
 
nccs
;

839 
nccs
.
rgrc
[0] = 
hwnd
->
wöª˘
;

840 
	`SídMesßge
(
hwnd
, 
WM_NCCALCSIZE
, 
FALSE
, (
LPARAM
)(
LPSTR
)&
nccs
);

841 
hwnd
->
˛úe˘
 = 
nccs
.
rgrc
[0];

844 
	`MwAdju°NCS¸ﬁlb¨s
(
hwnd
);

845 
	}
}

847 
BOOL
 
WINAPI


848 
	$GëClõ¡Re˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
)

850 if(!
hwnd
 || !
ÕRe˘
)

851  
FALSE
;

854 
ÕRe˘
->
À·
 = 0;

855 
ÕRe˘
->
t›
 = 0;

856 
ÕRe˘
->
right
 = 
hwnd
->
˛úe˘
.righà- hwnd->˛úe˘.
À·
;

857 
ÕRe˘
->
bŸtom
 = 
hwnd
->
˛úe˘
.bŸtom - hwnd->˛úe˘.
t›
;

858  
TRUE
;

859 
	}
}

861 
BOOL
 
WINAPI


862 
	$GëWödowRe˘
(
HWND
 
hwnd
, 
LPRECT
 
ÕRe˘
)

864 if(!
hwnd
 || !
ÕRe˘
)

865  
FALSE
;

868 *
ÕRe˘
 = 
hwnd
->
wöª˘
;

869  
TRUE
;

870 
	}
}

872 
BOOL
 
WINAPI


873 
	$Clõ¡ToS¸ìn
(
HWND
 
hwnd
, 
LPPOINT
 
ÕPoöt
)

875 if(!
hwnd
 || !
ÕPoöt
)

876  
FALSE
;

877 
	`M≠WödowPoöts
(
hwnd
, 
NULL
, 
ÕPoöt
, 1);

878  
TRUE
;

879 
	}
}

881 
BOOL
 
WINAPI


882 
	$S¸ìnToClõ¡
(
HWND
 
hwnd
, 
LPPOINT
 
ÕPoöt
)

884 if(!
hwnd
 || !
ÕPoöt
)

885  
FALSE
;

886 
	`M≠WödowPoöts
(
NULL
, 
hwnd
, 
ÕPoöt
, 1);

887  
TRUE
;

888 
	}
}

890 
WINAPI


891 
	$M≠WödowPoöts
(
HWND
 
hwndFrom
, HWND 
hwndTo
, 
LPPOINT
 
ÕPoöts
, 
UINT
 
cPoöts
)

893 
MWCOORD
 
offx
 = 0;

894 
MWCOORD
 
offy
 = 0;

897 if(
hwndFrom
) {

898 
offx
 = 
hwndFrom
->
˛úe˘
.
À·
;

899 
offy
 = 
hwndFrom
->
˛úe˘
.
t›
;

903 if(
hwndTo
) {

904 
offx
 -
hwndTo
->
˛úe˘
.
À·
;

905 
offy
 -
hwndTo
->
˛úe˘
.
t›
;

909 
cPoöts
--) {

910 
ÕPoöts
->
x
 +
offx
;

911 
ÕPoöts
->
y
 +
offy
;

912 ++
ÕPoöts
;

914  ()
	`MAKELONG
(
offx
, 
offy
);

915 
	}
}

917 
BOOL
 
WINAPI


918 
	$SëRe˘
(
LPRECT
 
Õrc
, 
xLe·
, 
yT›
, 
xRight
, 
yBŸtom
)

920 
Õrc
->
À·
 = 
xLe·
;

921 
Õrc
->
t›
 = 
yT›
;

922 
Õrc
->
right
 = 
xRight
;

923 
Õrc
->
bŸtom
 = 
yBŸtom
;

924  
TRUE
;

925 
	}
}

927 
BOOL
 
WINAPI


928 
	$SëRe˘Em±y
(
LPRECT
 
Õrc
)

930 
Õrc
->
À·
 =Ü¥c->
right
 =Ü¥c->
t›
 =Ü¥c->
bŸtom
 = 0;

931  
TRUE
;

932 
	}
}

934 
BOOL
 
WINAPI


935 
	$C›yRe˘
(
LPRECT
 
ÕrcD°
, 
CONST
 
RECT
 *
ÕrcSrc
)

937 *
ÕrcD°
 = *
ÕrcSrc
;

938  
TRUE
;

939 
	}
}

941 
BOOL
 
WINAPI


942 
	$IsRe˘Em±y
(
CONST
 
RECT
 *
Õrc
)

946  
Õrc
->
right
 <Õrc->
À·
 ||Ü¥c->
bŸtom
 <Õrc->
t›
;

947 
	}
}

949 
BOOL
 
WINAPI


950 
	$InÊ©eRe˘
(
LPRECT
 
Õrc
, 
dx
, 
dy
)

952 
Õrc
->
À·
 -
dx
;

953 
Õrc
->
t›
 -
dy
;

954 
Õrc
->
right
 +
dx
;

955 
Õrc
->
bŸtom
 +
dy
;

956  
TRUE
;

957 
	}
}

959 
BOOL
 
WINAPI


960 
	$Off£tRe˘
(
LPRECT
 
Õrc
, 
dx
, 
dy
)

962 
Õrc
->
À·
 +
dx
;

963 
Õrc
->
right
 +
dx
;

964 
Õrc
->
t›
 +
dy
;

965 
Õrc
->
bŸtom
 +
dy
;

966  
TRUE
;

967 
	}
}

970 
BOOL
 
WINAPI


971 
	$MwPTINRECT
(
CONST
 
RECT
 *
Õrc
, 
POINT
 
±
)

973  (
±
.
x
 >
Õrc
->
À·
 &&Öt.x <Ü¥c->
right
 &&

974 
±
.
y
 >
Õrc
->
t›
 &&Öt.y <Ü¥c->
bŸtom
);

975 
	}
}

977 
LONG
 
WINAPI


978 
	$GëWödowL⁄g
(
HWND
 
hwnd
, 
nIndex
)

980 
nIndex
) {

981 
GWL_WNDPROC
:

982  (
LONG
)
hwnd
->
pCœss
->
Õ‚WndProc
;

983 
GWL_HINSTANCE
:

986 
GWL_HWNDPARENT
:

987  (
LONG
)
hwnd
->
∑ª¡
;

988 
GWL_ID
:

989  
hwnd
->
id
;

990 
GWL_STYLE
:

991  
hwnd
->
°yÀ
;

992 
GWL_EXSTYLE
:

993  
hwnd
->
ex°yÀ
;

994 
GWL_USERDATA
:

995  
hwnd
->
u£rd©a
;

997 if(
nIndex
+3 < 
hwnd
->
√xåabyãs
)

998  *(
LONG
 *)&
hwnd
->
exåabyãs
[
nIndex
];

1001 
	}
}

1003 
LONG
 
WINAPI


1004 
	$SëWödowL⁄g
(
HWND
 
hwnd
, 
nIndex
, 
LONG
 
lNewL⁄g
)

1006 
LONG
 
ﬁdvÆ
 = 0;

1008 
nIndex
) {

1009 
GWL_USERDATA
:

1010 
ﬁdvÆ
 = 
hwnd
->
u£rd©a
;

1011 
hwnd
->
u£rd©a
 = 
lNewL⁄g
;

1013 
GWL_WNDPROC
:

1014 
ﬁdvÆ
 = (
LONG
)
hwnd
->
pCœss
->
Õ‚WndProc
;

1015 
hwnd
->
pCœss
->
Õ‚WndProc
 = (
WNDPROC
)
lNewL⁄g
;

1017 
GWL_HINSTANCE
:

1018 
GWL_HWNDPARENT
:

1019 
GWL_ID
:

1020 
GWL_STYLE
:

1021 
GWL_EXSTYLE
:

1025 if(
nIndex
+3 < 
hwnd
->
√xåabyãs
) {

1026 
ﬁdvÆ
 = 
	`GëWödowL⁄g
(
hwnd
, 
nIndex
);

1027 *(
LONG
 *)&
hwnd
->
exåabyãs
[
nIndex
] = 
lNewL⁄g
;

1031  
ﬁdvÆ
;

1032 
	}
}

1034 
WORD
 
WINAPI


1035 
	$GëWödowW‹d
(
HWND
 
hwnd
, 
nIndex
)

1037 if(
nIndex
+1 < 
hwnd
->
√xåabyãs
)

1038  *(
WORD
 *)&
hwnd
->
exåabyãs
[
nIndex
];

1040 
	}
}

1042 
WORD
 
WINAPI


1043 
	$SëWödowW‹d
(
HWND
 
hwnd
, 
nIndex
, 
WORD
 
wNewW‹d
)

1045 
WORD
 
ﬁdvÆ
 = 0;

1047 if(
nIndex
+1 < 
hwnd
->
√xåabyãs
) {

1048 
ﬁdvÆ
 = 
	`GëWödowW‹d
(
hwnd
, 
nIndex
);

1049 *(
WORD
 *)&
hwnd
->
exåabyãs
[
nIndex
] = 
wNewW‹d
;

1051  
ﬁdvÆ
;

1052 
	}
}

1054 
DWORD
 
WINAPI


1055 
	$GëCœssL⁄g
(
HWND
 
hwnd
, 
nIndex
)

1057 
nIndex
) {

1058 
GCL_HBRBACKGROUND
:

1059  (
DWORD
)
hwnd
->
pCœss
->
hbrBackground
;

1060 
GCL_CBWNDEXTRA
:

1061  (
DWORD
)
hwnd
->
pCœss
->
cbWndExåa
;

1064 
	}
}

1066 
WINAPI


1067 
	$GëWödowTextLígth
(
HWND
 
hwnd
)

1069  
	`SídMesßge
(
hwnd
, 
WM_GETTEXTLENGTH
, 0, 0L);

1070 
	}
}

1072 
WINAPI


1073 
	$GëWödowText
(
HWND
 
hwnd
, 
LPSTR
 
ÕSåög
, 
nMaxCou¡
)

1075  
	`SídMesßge
(
hwnd
, 
WM_GETTEXT
, 
nMaxCou¡
,(
LPARAM
)(
LPSTR
)
ÕSåög
);

1076 
	}
}

1078 
BOOL
 
WINAPI


1079 
	$SëWödowText
(
HWND
 
hwnd
, 
LPCSTR
 
ÕSåög
)

1081  
	`SídMesßge
(
hwnd
, 
WM_SETTEXT
, 0, (
LPARAM
)(
LPCSTR
)
ÕSåög
);

1082 
	}
}

1086 
	$MwOff£tChûdªn
(
HWND
 
hwnd
, 
offx
, 
offy
)

1088 
HWND
 
˝
;

1091 
˝
=
hwnd
->
chûdªn
; cp; cp=˝->
siblögs
) {

1094 
	`Off£tRe˘
(&
˝
->
wöª˘
, 
offx
, 
offy
);

1095 
	`Off£tRe˘
(&
˝
->
˛úe˘
, 
offx
, 
offy
);

1098 if(!
	`IsRe˘Em±y
(&
˝
->
vs¸ﬁl
.
rc
))

1099 
	`Off£tRe˘
(&
˝
->
vs¸ﬁl
.
rc
, 
offx
, 
offy
);

1100 if(!
	`IsRe˘Em±y
(&
˝
->
hs¸ﬁl
.
rc
))

1101 
	`Off£tRe˘
(&
˝
->
hs¸ﬁl
.
rc
, 
offx
, 
offy
);

1102 
	`MwOff£tChûdªn
(
˝
, 
offx
, 
offy
);

1104 
	}
}

1106 
BOOL


1107 
	$SëWödowPos
(
HWND
 
hwnd
, HWND 
hwndIn£πA·î
, 
x
, 
y
, 
cx
, 
cy
,

1108 
UINT
 
fuFœgs
)

1110 
hiddí
;

1111 
BOOL
 
bMove
, 
bSize
, 
bZ‹dî
;

1112 
MWCOORD
 
offx
 = 0, 
offy
 = 0;

1113 
WINDOWPOS
 
wöpos
;

1115 if(!
hwnd
 || hwnd =
roŸwp
 || 
cx
 < 0 || 
cy
 < 0)

1116  
FALSE
;

1120 if((
fuFœgs
 & 
SWP_SHOWWINDOW
))

1121  
	`ShowWödow
(
hwnd
, 
SW_SHOW
);

1123 if((
fuFœgs
 & 
SWP_HIDEWINDOW
))

1124  
	`ShowWödow
(
hwnd
, 
SW_HIDE
);

1127 if(
hwnd
->
°yÀ
 & 
WS_CHILD
) {

1128 
x
 +
hwnd
->
∑ª¡
->
˛úe˘
.
À·
;

1129 
y
 +
hwnd
->
∑ª¡
->
˛úe˘
.
t›
;

1131 
x
 +
hwnd
->
∑ª¡
->
wöª˘
.
À·
;

1132 
y
 +
hwnd
->
∑ª¡
->
wöª˘
.
t›
;

1135 
bMove
 = !(
fuFœgs
 & 
SWP_NOMOVE
) &&

1136 (
hwnd
->
wöª˘
.
À·
 !
x
 || hwnd->wöª˘.
t›
 !
y
);

1137 
bSize
 = !(
fuFœgs
 & 
SWP_NOSIZE
) &&

1138 ((
hwnd
->
wöª˘
.
right
 - hwnd->wöª˘.
À·
Ë!
cx
 ||

1139 (
hwnd
->
wöª˘
.
bŸtom
 - hwnd->wöª˘.
t›
Ë!
cy
);

1140 
bZ‹dî
 = !(
fuFœgs
 & 
SWP_NOZORDER
);

1141 if(!
bMove
 && !
bSize
 && !
bZ‹dî
)

1142  
TRUE
;

1145 
hiddí
 = 
hwnd
->
unm≠cou¡
 || (
fuFœgs
 & 
SWP_NOREDRAW
);

1147 if(
bZ‹dî
) {

1148 ()
hwndIn£πA·î
) {

1149 ()
HWND_TOP
:

1150 
	`MwRai£Wödow
(
hwnd
);

1152 ()
HWND_BOTTOM
:

1153 
	`MwLowîWödow
(
hwnd
);

1160 if(!
hiddí
)

1161 
	`MwHideWödow
(
hwnd
, 
FALSE
, FALSE);

1164 if(
bMove
) {

1165 
offx
 = 
x
 - 
hwnd
->
wöª˘
.
À·
;

1166 
offy
 = 
y
 - 
hwnd
->
wöª˘
.
t›
;

1168 if(
bMove
 || 
bSize
) {

1169 
hwnd
->
wöª˘
.
À·
 = 
x
;

1170 
hwnd
->
wöª˘
.
t›
 = 
y
;

1171 
hwnd
->
wöª˘
.
right
 = 
x
 + 
cx
;

1172 
hwnd
->
wöª˘
.
bŸtom
 = 
y
 + 
cy
;

1174 if(
bMove
)

1175 
	`MwOff£tChûdªn
(
hwnd
, 
offx
, 
offy
);

1177 if(
bMove
 || 
bSize
) {

1178 
	`MwCÆcClõ¡Re˘
(
hwnd
);

1182 
wöpos
.
hwnd
 = hwnd;

1183 
wöpos
.
hwndIn£πA·î
 = hwndInsertAfter;

1184 
wöpos
.
x
 = x;

1185 
wöpos
.
y
 = y;

1186 
wöpos
.
cx
 = cx;

1187 
wöpos
.
cy
 = cy;

1188 
wöpos
.
Êags
 = 
fuFœgs
;

1189 
	`SídMesßge
(
hwnd
, 
WM_WINDOWPOSCHANGED
, 0, (
LPARAM
)&
wöpos
);

1191 
	`MwSídSizeMove
(
hwnd
, 
bSize
, 
bMove
);

1194 ++
mw∑ötSîül
;

1195 ++
mw∑ötNC
;

1196 if(!
bZ‹dî
 && !
hiddí
)

1197 
	`MwShowWödow
(
hwnd
, 
FALSE
);

1199  
TRUE
;

1200 
	}
}

1202 
BOOL
 
WINAPI


1203 
	$MoveWödow
(
HWND
 
hwnd
, 
x
, 
y
, 
nWidth
, 
nHeight
, 
BOOL
 
bRïaöt
)

1205 
UINT
 
Êags
 = 
SWP_NOZORDER
 | 
SWP_NOACTIVATE
;

1207 if(!
bRïaöt
)

1208 
Êags
 |
SWP_NOREDRAW
;

1209  
	`SëWödowPos
(
hwnd
, 0, 
x
, 
y
, 
nWidth
, 
nHeight
, 
Êags
);

1210 
	}
}

1213 
	$MwSídSizeMove
(
HWND
 
hwnd
, 
BOOL
 
bSize
, BOOL 
bMove
)

1215 
DWORD
 
dwStyÀ
;

1216 
RECT
 
rc
;

1218 if(
bSize
) {

1219 
	`GëClõ¡Re˘
(
hwnd
, &
rc
);

1220 
	`SídMesßge
(
hwnd
, 
WM_SIZE
, 
SIZE_RESTORED
,

1221 
	`MAKELONG
(
rc
.
right
,Ñc.
bŸtom
));

1223 if(
bMove
) {

1224 
dwStyÀ
 = 
	`GëWödowL⁄g
(
hwnd
, 
GWL_STYLE
);

1225 
	`GëWödowRe˘
(
hwnd
, &
rc
);

1227 if(
dwStyÀ
 & 
WS_CHILD
)

1228 
	`S¸ìnToClõ¡
(
hwnd
->
∑ª¡
, (
LPPOINT
)&
rc
.
À·
);

1229 
	`SídMesßge
(
hwnd
, 
WM_MOVE
, 0, 
	`MAKELONG
(
rc
.
À·
,Ñc.
t›
));

1231 
	}
}

1240 
	$MwSëCurs‹
(
HWND
 
wp
, 
PMWCURSOR
 
pcurs‹
)

1242 
HCURSOR
 
˝
;

1243 
byãs
;

1245 if(!
wp
 || !
pcurs‹
)

1248 
byãs
 = 
	`MWIMAGE_SIZE
(
pcurs‹
->
width
,pcurs‹->
height
)

1249 * (
MWIMAGEBITS
);

1255 
˝
 = 
wp
->
curs‹
;

1256 i‡(!
˝
 || cp->
u£cou¡
-- > 1) {

1257 
˝
 = 
	`GdIãmNew
(
hcurs‹
);

1258 if(!
˝
)

1262 
˝
->
u£cou¡
 = 1;

1263 
˝
->
curs‹
.
width
 = 
pcurs‹
->width;

1264 
˝
->
curs‹
.
height
 = 
pcurs‹
->height;

1265 
˝
->
curs‹
.
hŸx
 = 
pcurs‹
->hotx;

1266 
˝
->
curs‹
.
hŸy
 = 
pcurs‹
->hoty;

1267 
˝
->
curs‹
.
fgcﬁ‹
 = 
pcurs‹
->fgcolor;

1268 
˝
->
curs‹
.
bgcﬁ‹
 = 
pcurs‹
->bgcolor;

1269 
	`mem˝y
(
˝
->
curs‹
.
image
, 
pcurs‹
->image, 
byãs
);

1270 
	`mem˝y
(
˝
->
curs‹
.
mask
, 
pcurs‹
->mask, 
byãs
);

1271 
wp
->
curs‹
 = 
˝
;

1276 i‡(
˝
 =
curcurs‹
 || curcurs‹ =
NULL
) {

1277 
	`GdMoveCurs‹
(
curs‹x
 - 
˝
->
curs‹
.
hŸx
,

1278 
curs‹y
 - 
˝
->
curs‹
.
hŸy
);

1279 
	`GdSëCurs‹
(&
˝
->
curs‹
);

1281 
	}
}

1283 
BOOL
 
WINAPI


1284 
	$GëCurs‹Pos
(
LPPOINT
 
ÕPoöt
)

1286 
MWCOORD
 
x
, 
y
;

1288 if(
ÕPoöt
) {

1289 
	`GdGëCurs‹Pos
(&
x
, &
y
);

1290 
ÕPoöt
->
x
 = x;

1291 
ÕPoöt
->
y
 = y;

1292  
TRUE
;

1294  
FALSE
;

1295 
	}
}

1297 
HWND
 
WINAPI


1298 
	$GëC≠tuª
(
VOID
)

1300  
ˇ±uªwp
;

1301 
	}
}

1303 
HWND
 
WINAPI


1304 
	$SëC≠tuª
(
HWND
 
hwnd
)

1306 
HWND
 
ﬁdC≠tuª
 = 
ˇ±uªwp
;

1308 
ˇ±uªwp
 = 
hwnd
;

1309 
	`MwCheckMou£Wödow
();

1310  
ﬁdC≠tuª
;

1311 
	}
}

1313 
BOOL
 
WINAPI


1314 
	$Rñó£C≠tuª
(
VOID
)

1316 
ˇ±uªwp
 = 
NULL
;

1317 
	`MwCheckMou£Wödow
();

1318  
TRUE
;

1319 
	}
}

1321 
	stimî
 {

1322 
HWND
 
	mhwnd
;

1323 
UINT
 
	midTimî
;

1324 
UINT
 
	muTimeout
;

1325 
DWORD
 
	mdwClockExpúes
;

1326 
TIMERPROC
 
	mÕTimîFunc
;

1329 
timî
 
	gtimî
;

1331 
UINT
 
WINAPI


1332 
	$SëTimî
(
HWND
 
hwnd
, 
UINT
 
idTimî
, UINT 
uTimeout
, 
TIMERPROC
 
ÕTimîFunc
)

1334 
UINT
 
√xtID
 = 0;

1337 
timî
.
hwnd
 = hwnd;

1338 
timî
.
idTimî
 = 
hwnd
? idTimî: ++
√xtID
;

1339 
timî
.
uTimeout
 = uTimeout;

1340 
timî
.
dwClockExpúes
 = 
	`GëTickCou¡
(Ë+ 
uTimeout
;

1341 
timî
.
ÕTimîFunc
 =ÜpTimerFunc;

1343  
timî
.
idTimî
;

1344 
	}
}

1346 
BOOL
 
WINAPI


1347 
	$KûlTimî
(
HWND
 
hwnd
, 
UINT
 
idTimî
)

1349 if(
timî
.
hwnd
 =hwnd &&Åimî.
idTimî
 == idTimer) {

1350 
timî
.
uTimeout
 = 0;

1351  
TRUE
;

1353  
FALSE
;

1354 
	}
}

1359 
UINT


1360 
	$MwGëNextTimeoutVÆue
()

1362 
timeout
;

1364 if(
timî
.
uTimeout
) {

1365 
timeout
 = 
timî
.
dwClockExpúes
 - 
	`GëTickCou¡
();

1366 if(
timeout
 > 0)

1367  
timeout
;

1370 
	}
}

1376 
	$MwH™dÀTimîs
()

1378 
timeout
;

1379 
DWORD
 
dwTime
;

1382 if(
timî
.
uTimeout
 == 0)

1386 
dwTime
 = 
	`GëTickCou¡
();

1387 
timeout
 = 
timî
.
dwClockExpúes
 - 
dwTime
;

1388 if(
timeout
 > 0)

1392 if(
timî
.
ÕTimîFunc
)

1393 
timî
.
	`ÕTimîFunc
—imî.
hwnd
, 
WM_TIMER
,Åimî.
idTimî
, 
dwTime
);

1394 
	`Po°Mesßge
(
timî
.
hwnd
, 
WM_TIMER
,Åimî.
idTimî
, 0);

1397 
timî
.
dwClockExpúes
 = 
dwTime
 +Åimî.
uTimeout
;

1398 
	}
}

1400 
WINAPI


1401 
	$GëSy°emMërics
(
nIndex
)

1403 
nIndex
) {

1404 
SM_CXSCREEN
:

1405  
s¸dev
.
xvúåes
;

1406 
SM_CYSCREEN
:

1407  
s¸dev
.
yvúåes
;

1408 
SM_CXVSCROLL
:

1409  
mwSYSMETRICS_CXVSCROLL
;

1410 
SM_CYHSCROLL
:

1411  
mwSYSMETRICS_CYHSCROLL
;

1412 
SM_CYCAPTION
:

1414  
mwSYSMETRICS_CYCAPTION
 + 1;

1415 
SM_CXBORDER
:

1416  
mwSYSMETRICS_CXBORDER
;

1417 
SM_CYBORDER
:

1418  
mwSYSMETRICS_CYBORDER
;

1419 
SM_CYMENU
:

1421 
SM_CYVSCROLL
:

1422  
mwSYSMETRICS_CYVSCROLL
;

1423 
SM_CXHSCROLL
:

1424  
mwSYSMETRICS_CXHSCROLL
;

1425 
SM_CXFRAME
:

1426 
SM_CXDLGFRAME
:

1427  
mwSYSMETRICS_CXFRAME
;

1428 
SM_CYFRAME
:

1429 
SM_CYDLGFRAME
:

1430  
mwSYSMETRICS_CYFRAME
;

1433 
	}
}

1435 
HWND
 
WINAPI


1436 
	$GëDlgIãm
(
HWND
 
hDlg
, 
nIDDlgIãm
)

1438 
HWND
 
wp
;

1440 if(
hDlg
) {

1441 
wp
=
hDlg
->
chûdªn
; wp; wp=wp->
siblögs
)

1442 if(
wp
->
id
 =
nIDDlgIãm
)

1443  
wp
;

1446 
	}
}

	@nanox/client.c

24 
	~<°dio.h
>

25 
	~<°dlib.h
>

26 
	~<uni°d.h
>

27 
	~<°rög.h
>

28 
	~<°ddef.h
>

29 
	~<sig«l.h
>

30 
	~<î∫o.h
>

31 
	~<time.h
>

32 #i‡
HAVE_SHAREDMEM_SUPPORT


33 
	~<sys/ty≥s.h
>

34 
	~<sys/ùc.h
>

35 
	~<sys/shm.h
>

37 
	~<sys/time.h
>

38 
	~<sys/sockë.h
>

39 #i‡
ELKS


40 
	~<löuxmt/«.h
>

41 
	~<löuxmt/time.h
>

42 
	#ADDR_FAM
 
AF_NANO


	)

43 #ñi‡
__ECOS


44 
	~<√töë/ö.h
>

45 
	~<¨∑/öë.h
>

46 
	~<sys/£À˘.h
>

47 
	~<cyg/kî√l/k≠i.h
>

48 
	#ADDR_FAM
 
AF_INET


	)

49 
	#_NO_SVR_MAPPING


	)

50 
	#gëpid
(Ë(()
	`cyg_thªad_£lf
())

	)

52 
	~<sys/un.h
>

53 #i‡
hpux


54 
	~<sys/time.h
>

56 #ifde‡
__GLIBC__


57 
	~<sys/£À˘.h
>

61 
	~"«no-X.h
"

62 
	~"£rv.h
"

63 
	~"nx¥Ÿo.h
"

64 
	~"lock.h
"

66 #i‚de‡
ADDR_FAM


71 
	#ADDR_FAM
 
AF_UNIX


	)

74 
	#GR_CLOSE_FIX
 1

	)

82 
	#SHM_BLOCK_SIZE
 4096

	)

85 #i‡
PSP


88 
	~<p•debug.h
>

91 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

93 
	#¥ötf
(...)

	)

98 #i‚de‡
__ECOS


100 
	gnxSockë
 = -1;

101 
LOCK_DECLARE
(
nxGlobÆLock
);

102 #i‡
HAVE_SHAREDMEM_SUPPORT


103 * 
	gnxSh¨edMem
 = 0;

104 
	gnxSh¨edMemSize
;

107 
	gªgfdmax
 = -1;

108 
fd_£t
 
	gªgfd£t
;

113 *
	gnxEº‹Såögs
[] = {

114 
GR_ERROR_STRINGS


117 
EVENT_LIST
 * 
	gevli°
;

125 
GR_FNCALLBACKEVENT
 
	gEº‹Func
 = 
GrDeÁu…Eº‹H™dÀr
;

131 
	gecos_«nox_˛õ¡_d©a_ödex
 = 
CYGNUM_KERNEL_THREADS_DATA_MAX
;

135 
QueueEvít
(
GR_EVENT
 *
ï
);

136 
GëNextQueuedEvít
(
GR_EVENT
 *
ï
);

137 
_GrGëNextEvítTimeout
(
GR_EVENT
 *
ï
, 
GR_TIMEOUT
 
timeout
);

138 
_GrPìkEvít
(
GR_EVENT
 * 
ï
);

152 
	$RódBlock
(*
b
, 
n
)

154 
i
 = 0;

155 *
v
;

156 
	`ACCESS_PER_THREAD_DATA
()

158 
v
 = (*Ë
b
;

160 
	`nxFlushReq
(0L,0);

161 
v
 < ((*Ë
b
 + 
n
)) {

162 
i
 = 
	`ªad
(
nxSockë
, 
v
, ((*Ë
b
 + 
n
 - v));

163 i‡–
i
 <= 0 ) {

164 i‡–
i
 == 0 ) {

168 
	`EPRINTF
("nxclient:Üost connectionÅo Nano-X "

170 
	`exô
(1);

172 i‡–
î∫o
 =
EINTR
 ||Éºnÿ=
EAGAIN
 )

175 
	`EPRINTF
("nx˛õ¡: badÑódblock %d,Éºnÿ%d\n", 
i
, 
î∫o
);

178 
v
 +
i
;

182 
	}
}

192 
	$RódByã
()

194 
c
;

196 if(
	`RódBlock
(&
c
, 1) == -1)

198  (Ë
c
;

199 
	}
}

212 
	$CheckF‹Clõ¡D©a
(
GR_EVENT
 *
evp
)

214 
GR_EVENT_CLIENT_DATA
 *
evít
;

216 if(
evp
->
ty≥
 =
GR_EVENT_TYPE_CLIENT_DATA
) {

217 
evít
 = (
GR_EVENT_CLIENT_DATA
 *)
evp
;

218 if(!
evít
->
d©Æí
) {

219 
evít
->
d©a
 = 
NULL
;

222 if(!(
evít
->
d©a
 = 
	`mÆloc
”vít->
d©Æí
))) ;

223 
	`RódBlock
(
evít
->
d©a
,Évít->
d©Æí
);

225 
	}
}

238 
	$CheckBlockTy≥
(
∑ckëty≥
)

240 
b
;

241 
GR_EVENT
 
evít
;

243 
	`RódBlock
(&
b
,(b)) != -1) {

244 i‡(
b
 =
∑ckëty≥
)

245  
b
;

247 i‡(
b
 =
GrNumGëNextEvít
) {

252 
	`RódBlock
(&
evít
, (event));

253 
	`CheckF‹Clõ¡D©a
(&
evít
);

254 
	`QueueEvít
(&
evít
);

256 
	`EPRINTF
("nxclient %d: WrongÖacketÅype %d "

257 "”x≥˘ed %d)\n", 
	`gëpid
(),
b
, 
∑ckëty≥
);

260 
	`EPRINTF
("nx˛õ¡ %d: C‹ru±edÖackë\n", 
	`gëpid
());

262 
	}
}

277 
	$Ty≥dRódBlock
(*
b
, 
n
, 
ty≥
)

279 
r
;

281 
r
 = 
	`CheckBlockTy≥
(
ty≥
);

282 i‡(
r
 !
ty≥
)

284  
	`RódBlock
(
b
, 
n
);

285 
	}
}

299 
	$CheckEº‹Evít
(
GR_EVENT
 *
ï
)

301 
	`ACCESS_PER_THREAD_DATA
()

303 i‡(
ï
->
ty≥
 =
GR_EVENT_TYPE_ERROR
) {

304 i‡(
Eº‹Func
) {

306 
	`Eº‹Func
(
ï
);

309 
ï
->
ty≥
 = 
GR_EVENT_TYPE_NONE
;

312 
	}
}

322 
	$GrO≥n
()

324 
size_t
 
size
;

325 
nxO≥nReq
 
ªq
;

326 
åõs
;

327 
ªt
 = 0;

329 #i‡
PSP


331 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

334 #i‡
ADDR_FAM
 =
AF_NANO


335 
sockaddr_«
 
«me
;

336 #ñi‡
ADDR_FAM
 =
AF_INET


337 
sockaddr_ö
 
«me
;

338 
ho°ít
 *
he
;

340 *
sockaddr
 = 
	`gëív
("NXDISPLAY");

341 i‡(!
sockaddr
)

342 
sockaddr
 = "127.0.0.1";

343 #ñi‡
ADDR_FAM
 =
AF_UNIX


344 
sockaddr_un
 
«me
;

346 *
sock«me
 = 
	`gëív
("NXDISPLAY");

347 i‡(!
sock«me
)

348 
sock«me
 = 
GR_NAMED_SOCKET
;

352 
	`ACCESS_PER_THREAD_DATA
()

355 i‡(
nxSockë
 >= 0)

356  
nxSockë
;

359 i‡((
nxSockë
 = 
	`sockë
(
ADDR_FAM
, 
SOCK_STREAM
, 0)) == -1)

363 
	`LOCK_INIT
(&
nxGlobÆLock
);

365 #i‡
ADDR_FAM
 =
AF_NANO


366 
«me
.
sun_Ámûy
 = 
AF_NANO
;

367 
«me
.
sun_no
 = 
GR_ELKS_SOCKET
;

368 
size
 = (
sockaddr_«
);

369 #ñi‡
ADDR_FAM
 =
AF_INET


370 
«me
.
sö_Ámûy
 = 
AF_INET
;

371 
«me
.
sö_p‹t
 = 
	`ht⁄s
(
GR_NUM_SOCKET
);

372 i‡(!(
he
 = 
	`gëho°by«me
(
sockaddr
))) {

373 
	`EPRINTF
("nx˛õ¡: C™'àªsﬁvêaddªs†f‹ sîvî %s\n", 
sockaddr
);

374 
	`˛o£
(
nxSockë
);

375 
nxSockë
 = -1;

378 
«me
.
sö_addr
 = *(
ö_addr
 *)
he
->
h_addr_li°
[0];

379 
size
 = (
sockaddr_ö
);

380 #ñi‡
ADDR_FAM
 =
AF_UNIX


381 
«me
.
sun_Ámûy
 = 
AF_UNIX
;

382 
	`°r˝y
(
«me
.
sun_∑th
, 
sock«me
);

383 
size
 = (
	`off£tof
(
sockaddr_un
, 
sun_∑th
) +

384 
	`°æí
(
«me
.
sun_∑th
) + 1);

391 
åõs
=1;Åries<=10; ++tries) {

392 
time•ec
 
ªq
;

394 
ªt
 = 
	`c⁄√˘
(
nxSockë
, (
sockaddr
 *Ë&
«me
, 
size
);

395 i‡(
ªt
 >= 0)

397 #i‡
ADDR_FAM
 =
AF_INET


398 
ªq
.
tv_£c
 = 0;

399 
ªq
.
tv_n£c
 = 100000000L;

401 
ªq
.
tv_£c
 = 2;

402 
ªq
.
tv_n£c
 = 0;

404 
	`«no¶ìp
(&
ªq
, 
NULL
);

405 
	`EPRINTF
("nx˛õ¡:Ñëry c⁄√˘áâem± %d\n", 
åõs
);

407 i‡(
ªt
 == -1) {

408 
	`˛o£
(
nxSockë
);

409 
nxSockë
 = -1;

413 
	`£tbuf
(
°dout
, 
NULL
);

414 
	`£tbuf
(
°dîr
, 
NULL
);

428 
ªq
.
ªqTy≥
 = 
GrNumO≥n
;

429 
ªq
.
hûígth
 = 0;

430 
ªq
.
Àngth
 = (req);

432 
ªq
.
pid
 = 
	`gëpid
();

434 
	`nxWrôeSockë
((*)&
ªq
,(req));

435  
nxSockë
;

436 
	}
}

438 #i‡
GR_CLOSE_FIX


440 
	$mySig«lh™dÀr
(
sig
)

442 i‡(
sig
 =
SIGALRM
) {

443 
	`EPRINTF
("Oops!ÇxFlushReq()Åimed out,Éxiting\n");

444 
	`exô
(127);

446 
	}
}

456 
	$GrClo£
()

458 
	`ACCESS_PER_THREAD_DATA
()

460 #i‡
GR_CLOSE_FIX


462 * 
ﬁdSig«lH™dÀr
 = 
	`sig«l
(
SIGALRM
, 
mySig«lh™dÀr
);

463 
	`Æ¨m
(1);

465 
	`LOCK
(&
nxGlobÆLock
);

466 
	`AŒocReq
(
Clo£
);

467 
	`GrFlush
();

468 
	`UNLOCK
(&
nxGlobÆLock
);

470 #i‡
GR_CLOSE_FIX


471 
	`Æ¨m
(0);

472 
	`sig«l
(
SIGALRM
, 
ﬁdSig«lH™dÀr
);

474 
	`˛o£
(
nxSockë
);

475 
nxSockë
 = -1;

476 
	`LOCK_FREE
(&
nxGlobÆLock
);

477 
	}
}

485 
	$GrFlush
()

487 
	`nxFlushReq
(0L,1);

489 #ifde‡
NOTUSED


490 
GR_EVENT
 
evít
;

493 
	`_GrPìkEvít
(&
evít
)) {

494 
	`_GrGëNextEvítTimeout
(&
evít
, 0L);

495 
	`QueueEvít
(&
evít
);

498 
	}
}

512 
	$GrDeÁu…Eº‹H™dÀr
(
GR_EVENT
 *
ï
)

514 i‡(
ï
->
ty≥
 =
GR_EVENT_TYPE_ERROR
) {

515 
	`EPRINTF
("nx˛õ¡ %d: Eº‹ (%sË", 
	`gëpid
(), 
ï
->
îr‹
.
«me
);

516 
	`EPRINTF
(
nxEº‹Såögs
[
ï
->
îr‹
.
code
],Ép->îr‹.
id
);

517 
	`GrClo£
();

518 
	`exô
(1);

520 
	}
}

532 
GR_FNCALLBACKEVENT


533 
	$GrSëEº‹H™dÀr
(
GR_FNCALLBACKEVENT
 
‚cb
)

535 
GR_FNCALLBACKEVENT
 
‹ig
;

536 
	`ACCESS_PER_THREAD_DATA
()

538 
	`LOCK
(&
nxGlobÆLock
);

539 
‹ig
 = 
Eº‹Func
;

540 
Eº‹Func
 = 
‚cb
;

541 
	`UNLOCK
(&
nxGlobÆLock
);

542  
‹ig
;

543 
	}
}

554 
	$GrDñay
(
GR_TIMEOUT
 
m£cs
)

556 
timevÆ
Åimeval;

558 
timevÆ
.
tv_£c
 = 
m£cs
 / 1000;

559 
timevÆ
.
tv_u£c
 = (
m£cs
 % 1000) * 1000;

560 
	`£À˘
(0, 
NULL
, NULL, NULL, &
timevÆ
);

561 
	}
}

571 
	$GrGëS¸ìnInfo
(
GR_SCREEN_INFO
 *
sù
)

573 
	`LOCK
(&
nxGlobÆLock
);

574 
	`AŒocReq
(
GëS¸ìnInfo
);

575 
	`Ty≥dRódBlock
(
sù
, (
GR_SCREEN_INFO
),
GrNumGëS¸ìnInfo
);

576 
	`UNLOCK
(&
nxGlobÆLock
);

577 
	}
}

590 
GR_COLOR


591 
	$GrGëSysCﬁ‹
(
ödex
)

593 
nxGëSysCﬁ‹Req
 *
ªq
;

594 
GR_COLOR
 
cﬁ‹
;

596 
	`LOCK
(&
nxGlobÆLock
);

597 
ªq
 = 
	`AŒocReq
(
GëSysCﬁ‹
);

598 
ªq
->
ödex
 = index;

599 if(
	`Ty≥dRódBlock
(&
cﬁ‹
, (cﬁ‹),
GrNumGëSysCﬁ‹
) == -1)

600 
cﬁ‹
 = 0;

601 
	`UNLOCK
(&
nxGlobÆLock
);

602  
cﬁ‹
;

603 
	}
}

614 
	$GrGëF⁄tInfo
(
GR_FONT_ID
 
f⁄t
, 
GR_FONT_INFO
 *
fù
)

616 
nxGëF⁄tInfoReq
 *
ªq
;

618 
	`LOCK
(&
nxGlobÆLock
);

619 
ªq
 = 
	`AŒocReq
(
GëF⁄tInfo
);

620 
ªq
->
f⁄tid
 = 
f⁄t
;

621 
	`Ty≥dRódBlock
(
fù
, (
GR_FONT_INFO
),
GrNumGëF⁄tInfo
);

622 
	`UNLOCK
(&
nxGlobÆLock
);

623 
	}
}

635 
	$GrGëGCInfo
(
GR_GC_ID
 
gc
, 
GR_GC_INFO
 *
gcù
)

637 
nxGëGCInfoReq
 *
ªq
;

639 
	`LOCK
(&
nxGlobÆLock
);

640 
ªq
 = 
	`AŒocReq
(
GëGCInfo
);

641 
ªq
->
gcid
 = 
gc
;

642 
	`Ty≥dRódBlock
(
gcù
, (
GR_GC_INFO
),
GrNumGëGCInfo
);

643 
	`UNLOCK
(&
nxGlobÆLock
);

644 
	}
}

662 
	$GrGëGCTextSize
(
GR_GC_ID
 
gc
, *
°r
, 
cou¡
, 
GR_TEXTFLAGS
 
Êags
,

663 
GR_SIZE
 *
ªtwidth
, GR_SIZE *
ªtheight
, GR_SIZE *
ªtba£
)

665 
nxGëGCTextSizeReq
 *
ªq
;

666 
size
;

669 if(
cou¡
 =-1 && (
Êags
&
MWTF_PACKMASK
Ë=
MWTF_ASCII
)

670 
cou¡
 = 
	`°æí
((*)
°r
);

672 
size
 = 
	`nxCÆcSåögByãs
(
°r
, 
cou¡
, 
Êags
);

674 
	`LOCK
(&
nxGlobÆLock
);

675 
ªq
 = 
	`AŒocReqExåa
(
GëGCTextSize
, 
size
);

676 
ªq
->
gcid
 = 
gc
;

677 
ªq
->
Êags
 = flags;

678 
ªq
->
ch¨cou¡
 = 
cou¡
;

679 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
°r
, 
size
);

680 
	`Ty≥dRódBlock
(
ªtwidth
, (*ªtwidth),
GrNumGëGCTextSize
);

681 
	`RódBlock
(
ªtheight
, (*retheight));

682 
	`RódBlock
(
ªtba£
, (*retbase));

683 
	`UNLOCK
(&
nxGlobÆLock
);

684 
	}
}

696 
	$GrRegi°îI≈ut
(
fd
)

698 
	`ACCESS_PER_THREAD_DATA
()

700 i‡(
fd
 < 0)

703 
	`LOCK
(&
nxGlobÆLock
);

704 
	`FD_SET
(
fd
, &
ªgfd£t
);

705 i‡(
fd
 >
ªgfdmax
)Ñegfdmax = fd + 1;

706 
	`UNLOCK
(&
nxGlobÆLock
);

707 
	}
}

718 
	$GrUƒegi°îI≈ut
(
fd
)

720 
i
, 
max
;

721 
	`ACCESS_PER_THREAD_DATA
()

723 
	`LOCK
(&
nxGlobÆLock
);

726 i‡(
fd
 == -1) {

727 
	`FD_ZERO
(&
ªgfd£t
);

728 
ªgfdmax
 = -1;

729 
	`UNLOCK
(&
nxGlobÆLock
);

733 
	`FD_CLR
(
fd
, &
ªgfd£t
);

735 
i
 = 0, 
max
 = 
ªgfdmax
,Ñegfdmax = -1; i < max; i++)

736 i‡(
	`FD_ISSET
(
i
, &
ªgfd£t
))

737 
ªgfdmax
 = 
i
 + 1;

738 
	`UNLOCK
(&
nxGlobÆLock
);

739 
	}
}

767 
	$GrPª∑ªSñe˘
(*
maxfd
,*
rfd£t
)

769 
fd_£t
 *
rfds
 = 
rfd£t
;

770 
fd
;

772 
	`ACCESS_PER_THREAD_DATA
()

774 
	`LOCK
(&
nxGlobÆLock
);

775 
	`AŒocReq
(
GëNextEvít
);

776 
	`GrFlush
();

778 
	`FD_SET
(
nxSockë
, 
rfds
);

779 if(
nxSockë
 > *
maxfd
)

780 *
maxfd
 = 
nxSockë
;

783 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

784 i‡(
	`FD_ISSET
(
fd
, &
ªgfd£t
)) {

785 
	`FD_SET
(
fd
, 
rfds
);

786 i‡(
fd
 > *
maxfd
) *maxfd = fd;

789 
	`UNLOCK
(&
nxGlobÆLock
);

790 
	}
}

807 
	$GrSîvi˚Sñe˘
(*
rfd£t
, 
GR_FNCALLBACKEVENT
 
‚cb
)

809 
fd_£t
 * 
rfds
 = 
rfd£t
;

810 
fd
;

811 
GR_EVENT
 
ev
;

813 
	`ACCESS_PER_THREAD_DATA
()

814 
	`LOCK
(&
nxGlobÆLock
);

822 i‡(
evli°
) {

824 
	`GëNextQueuedEvít
(&
ev
);

825 
	`CheckEº‹Evít
(&
ev
);

826 
	`‚cb
(&
ev
);

829 if(
	`FD_ISSET
(
nxSockë
, 
rfds
)) {

830 
	`Ty≥dRódBlock
(&
ev
, ”v),
GrNumGëNextEvít
);

831 
	`CheckF‹Clõ¡D©a
(&
ev
);

832 
	`CheckEº‹Evít
(&
ev
);

833 
	`‚cb
(&
ev
);

838 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

839 i‡(
	`FD_ISSET
(
fd
, &
ªgfd£t
Ë&& FD_ISSET(fd, 
rfds
)) {

840 
ev
.
ty≥
 = 
GR_EVENT_TYPE_FDINPUT
;

841 
ev
.
fdöput
.
fd
 = fd;

842 
	`‚cb
(&
ev
);

845 
	`UNLOCK
(&
nxGlobÆLock
);

846 
	}
}

858 
	$GrMaöLo›
(
GR_FNCALLBACKEVENT
 
‚cb
)

860 
fd_£t
 
rfds
;

861 
£tsize
 = 0;

864 
	`FD_ZERO
(&
rfds
);

865 
	`GrPª∑ªSñe˘
(&
£tsize
, &
rfds
);

866 if(
	`£À˘
(
£tsize
+1, &
rfds
, 
NULL
, NULL, NULL) > 0)

867 
	`GrSîvi˚Sñe˘
(&
rfds
, 
‚cb
);

869 
	}
}

879 
	$QueueEvít
(
GR_EVENT
 *
ï
)

881 
EVENT_LIST
 * 
ñp
;

882 
EVENT_LIST
 * 
¥evñp
;

883 
	`ACCESS_PER_THREAD_DATA
()

885 
ñp
 = 
	`mÆloc
((
EVENT_LIST
));

886 i‡(
ñp
) {

887 
ñp
->
evít
 = *
ï
;

888 
ñp
->
√xt
 = 
NULL
;

891 i‡(!
evli°
) {

892 
evli°
 = 
ñp
;

895 
¥evñp
 = 
evli°
;

896 
¥evñp
->
√xt
)

897 
¥evñp
 =Öªvñp->
√xt
;

898 
¥evñp
->
√xt
 = 
ñp
;

900 
	}
}

910 
	$GëNextQueuedEvít
(
GR_EVENT
 *
ï
)

912 
EVENT_LIST
 *
ñp
;

914 
	`ACCESS_PER_THREAD_DATA
()

916 *
ï
 = 
evli°
->
evít
;

917 
ñp
 = 
evli°
;

918 
evli°
 =Évli°->
√xt
;

919 
	`‰ì
(
ñp
);

920 
	}
}

932 
	$GrGëNextEvít
(
GR_EVENT
 *
ï
)

934 
	`GrGëNextEvítTimeout
(
ï
, 0L);

935 
	}
}

954 
	$GrGëNextEvítTimeout
(
GR_EVENT
 * 
ï
, 
GR_TIMEOUT
 
timeout
)

956 
	`LOCK
(&
nxGlobÆLock
);

957 i‡(
evli°
) {

959 
	`GëNextQueuedEvít
(
ï
);

960 
	`CheckEº‹Evít
(
ï
);

961 
	`UNLOCK
(&
nxGlobÆLock
);

965 
	`_GrGëNextEvítTimeout
(
ï
,
timeout
);

966 
	`UNLOCK
(&
nxGlobÆLock
);

967 
	}
}

989 
	$_GrGëNextEvítTimeout
(
GR_EVENT
 *
ï
, 
GR_TIMEOUT
 
timeout
)

991 
fd_£t
 
rfds
;

992 
£tsize
 = 0;

993 
e
;

994 
timevÆ
 
to
;

995 
	`ACCESS_PER_THREAD_DATA
()

998 
	`FD_ZERO
(&
rfds
);

1008 
	`GrPª∑ªSñe˘
(&
£tsize
, &
rfds
);

1009 i‡(
timeout
) {

1010 
to
.
tv_£c
 = 
timeout
 / 1000;

1011 
to
.
tv_u£c
 = (
timeout
 % 1000) * 1000;

1014 if((
e
 = 
	`£À˘
(
£tsize
+1, &
rfds
, 
NULL
, NULL, 
timeout
 ? &
to
 : NULL))>0) {

1015 
fd
;

1017 if(
	`FD_ISSET
(
nxSockë
, &
rfds
)) {

1022 
	`Ty≥dRódBlock
(
ï
, (*ï),
GrNumGëNextEvít
);

1023 
	`CheckF‹Clõ¡D©a
(
ï
);

1024 
	`CheckEº‹Evít
(
ï
);

1029 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

1030 i‡(
	`FD_ISSET
(
fd
, &
ªgfd£t
Ë&& FD_ISSET(fd, &
rfds
)) {

1031 
ï
->
ty≥
 = 
GR_EVENT_TYPE_FDINPUT
;

1032 
ï
->
fdöput
.
fd
 = fd;

1037 i‡(
e
 == 0) {

1042 
ï
->
ty≥
 = 
GR_EVENT_TYPE_TIMEOUT
;

1044 if(
î∫o
 =
EINTR
) {

1045 
ï
->
ty≥
 = 
GR_EVENT_TYPE_NONE
;

1047 
	`EPRINTF
("nxclient: select failed\n");

1048 
	`GrClo£
();

1049 
	`exô
(1);

1052 
	}
}

1065 
	$GrPìkEvít
(
GR_EVENT
 *
ï
)

1067 
ªt
;

1068 
	`ACCESS_PER_THREAD_DATA
()

1070 
	`LOCK
(&
nxGlobÆLock
);

1071 i‡(
evli°
) {

1072 *
ï
 = 
evli°
->
evít
;

1073 
	`CheckEº‹Evít
(
ï
);

1074 
	`UNLOCK
(&
nxGlobÆLock
);

1078 
ªt
 = 
	`_GrPìkEvít
(
ï
);

1079 
	`UNLOCK
(&
nxGlobÆLock
);

1080  
ªt
;

1081 
	}
}

1084 
	$_GrPìkEvít
(
GR_EVENT
 * 
ï
)

1086 
ªt
;

1088 
	`AŒocReq
(
PìkEvít
);

1089 
	`Ty≥dRódBlock
(
ï
, (*ï),
GrNumPìkEvít
);

1090 
	`CheckF‹Clõ¡D©a
(
ï
);

1091 
ªt
 = 
	`RódByã
();

1092 
	`CheckEº‹Evít
(
ï
);

1093  (
ªt
 > 0);

1094 
	}
}

1104 
	$GrPìkWaôEvít
(
GR_EVENT
 *
ï
)

1106 
EVENT_LIST
 * 
ñp
;

1108 
	`ACCESS_PER_THREAD_DATA
()

1110 
	`LOCK
(&
nxGlobÆLock
);

1111 i‡(
evli°
) {

1112 *
ï
 = 
evli°
->
evít
;

1113 
	`CheckEº‹Evít
(
ï
);

1114 
	`UNLOCK
(&
nxGlobÆLock
);

1119 
	`GrGëNextEvít
(
ï
);

1122 
ñp
 = 
	`mÆloc
((
EVENT_LIST
));

1123 i‡(
ñp
) {

1124 
ñp
->
evít
 = *
ï
;

1125 
ñp
->
√xt
 = 
evli°
;

1129 
	`GrPìkEvít
(
ï
);

1131 
	`UNLOCK
(&
nxGlobÆLock
);

1132 
	}
}

1144 
	$GrCheckNextEvít
(
GR_EVENT
 *
ï
)

1146 
	`ACCESS_PER_THREAD_DATA
()

1148 
	`LOCK
(&
nxGlobÆLock
);

1149 i‡(
evli°
) {

1151 
	`GëNextQueuedEvít
(
ï
);

1152 
	`CheckEº‹Evít
(
ï
);

1153 
	`UNLOCK
(&
nxGlobÆLock
);

1157 
	`AŒocReq
(
CheckNextEvít
);

1158 
	`Ty≥dRódBlock
(
ï
, (*ï),
GrNumGëNextEvít
);

1159 
	`CheckF‹Clõ¡D©a
(
ï
);

1160 
	`CheckEº‹Evít
(
ï
);

1161 
	`UNLOCK
(&
nxGlobÆLock
);

1162 
	}
}

1165 
GR_BOOL


1166 
	$GëTy≥dEvítCÆlback
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
mask
, 
GR_UPDATE_TYPE
 
upd©e
,

1167 
GR_EVENT
 *
ï
, *
¨g
)

1169 
GR_EVENT_MASK
 
emask
 = 
	`GR_EVENTMASK
(
ï
->
ty≥
);

1171 
	`DPRINTF
("GëTy≥dEvítCÆlback: wid %d mask %x upd©ê%d from %dÅy≥ %d\n", 
wid
, ()
mask
, 
upd©e
, 
ï
->
gíîÆ
.wid,Ép->
ty≥
);

1174 i‡(
wid
 && (wid !
ï
->
gíîÆ
.wid))

1177 i‡(
mask
) {

1178 i‡((
mask
 & 
emask
) == 0)

1181 i‡(
upd©e
 && ((
mask
 & 
emask
Ë=
GR_EVENT_MASK_UPDATE
))

1182 i‡(
upd©e
 !
ï
->upd©e.
uty≥
)

1187 
	}
}

1207 
	$GrGëTy≥dEvít
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
mask
, 
GR_UPDATE_TYPE
 
upd©e
,

1208 
GR_EVENT
 *
ï
, 
GR_BOOL
 
block
)

1210  
	`GrGëTy≥dEvítPªd
(
wid
, 
mask
, 
upd©e
, 
ï
, 
block
,

1211 
GëTy≥dEvítCÆlback
, 
NULL
);

1212 
	}
}

1235 
	$GrGëTy≥dEvítPªd
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
mask
, 
GR_UPDATE_TYPE
 
upd©e
,

1236 
GR_EVENT
 *
ï
, 
GR_BOOL
 
block
, 
GR_TYPED_EVENT_CALLBACK
 
m©ch‚
, *
¨g
)

1238 
EVENT_LIST
 *
ñp
, *
¥evñp
;

1239 
GR_EVENT
 
evít
;

1241 
	`ACCESS_PER_THREAD_DATA
();

1243 
	`LOCK
(&
nxGlobÆLock
);

1245 
	`_GrPìkEvít
(&
evít
)) {

1246 
gëevít
:

1247 
	`_GrGëNextEvítTimeout
(&
evít
, 0L);

1248 
	`QueueEvít
(&
evít
);

1254 
¥evñp
 = 
NULL
;

1255 
ñp
 = 
evli°
;

1256 
ñp
) {

1257 i‡(
	`m©ch‚
(
wid
, 
mask
, 
upd©e
, &
ñp
->
evít
, 
¨g
)) {

1259 i‡(
¥evñp
 =
NULL
)

1260 
evli°
 = 
ñp
->
√xt
;

1261 
¥evñp
->
√xt
 = 
ñp
->next;

1262 *
ï
 = 
ñp
->
evít
;

1264 
	`UNLOCK
(&
nxGlobÆLock
);

1265  
ï
->
ty≥
;

1267 
¥evñp
 = 
ñp
;

1268 
ñp
 =ÉÕ->
√xt
;

1272 i‡(
block
)

1273 
gëevít
;

1276 
ï
->
ty≥
 = 
GR_EVENT_TYPE_NONE
;

1277 
	`UNLOCK
(&
nxGlobÆLock
);

1278  
GR_EVENT_TYPE_NONE
;

1279 
	}
}

1290 
	$GrSñe˘Evíts
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
evítmask
)

1292 
nxSñe˘EvítsReq
 *
ªq
;

1294 
	`LOCK
(&
nxGlobÆLock
);

1295 
ªq
 = 
	`AŒocReq
(
Sñe˘Evíts
);

1296 
ªq
->
wödowid
 = 
wid
;

1297 
ªq
->
evítmask
 =Éventmask;

1298 
	`UNLOCK
(&
nxGlobÆLock
);

1299 
	}
}

1316 
GR_WINDOW_ID


1317 
	$GrNewWödow
(
GR_WINDOW_ID
 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

1318 
GR_SIZE
 
height
, GR_SIZE 
b‹dîsize
, 
GR_COLOR
 
background
,

1319 
GR_COLOR
 
b‹dîcﬁ‹
)

1321 
nxNewWödowReq
 *
ªq
;

1322 
GR_WINDOW_ID
 
wid
;

1324 
	`LOCK
(&
nxGlobÆLock
);

1325 
ªq
 = 
	`AŒocReq
(
NewWödow
);

1326 
ªq
->
∑ª¡id
 = 
∑ª¡
;

1327 
ªq
->
x
 = x;

1328 
ªq
->
y
 = y;

1329 
ªq
->
width
 = width;

1330 
ªq
->
height
 = height;

1331 
ªq
->
backgroundcﬁ‹
 = 
background
;

1332 
ªq
->
b‹dîcﬁ‹
 = bordercolor;

1333 
ªq
->
b‹dîsize
 = bordersize;

1334 if(
	`Ty≥dRódBlock
(&
wid
, (wid),
GrNumNewWödow
) == -1)

1335 
wid
 = 0;

1336 
	`UNLOCK
(&
nxGlobÆLock
);

1337  
wid
;

1338 
	}
}

1354 
GR_WINDOW_ID


1355 
	$GrNewPixm≠
(
GR_SIZE
 
width
, GR_SIZE 
height
, *
pixñs
)

1357 
nxNewPixm≠Req
 *
ªq
;

1358 
GR_WINDOW_ID
 
wid
;

1360 
	`LOCK
(&
nxGlobÆLock
);

1361 
ªq
 = 
	`AŒocReq
(
NewPixm≠
);

1362 
ªq
->
width
 = width;

1363 
ªq
->
height
 = height;

1364 if(
	`Ty≥dRódBlock
(&
wid
, (wid), 
GrNumNewPixm≠
) == -1)

1365 
wid
 = 0;

1366 
	`UNLOCK
(&
nxGlobÆLock
);

1367  
wid
;

1368 
	}
}

1383 
GR_WINDOW_ID


1384 
	$GrNewI≈utWödow
(
GR_WINDOW_ID
 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

1385 
GR_SIZE
 
height
)

1387 
nxNewI≈utWödowReq
 *
ªq
;

1388 
GR_WINDOW_ID
 
wid
;

1390 
	`LOCK
(&
nxGlobÆLock
);

1391 
ªq
 = 
	`AŒocReq
(
NewI≈utWödow
);

1392 
ªq
->
∑ª¡id
 = 
∑ª¡
;

1393 
ªq
->
x
 = x;

1394 
ªq
->
y
 = y;

1395 
ªq
->
width
 = width;

1396 
ªq
->
height
 = height;

1397 if(
	`Ty≥dRódBlock
(&
wid
, (wid), 
GrNumNewI≈utWödow
) == -1)

1398 
wid
 = 0;

1399 
	`UNLOCK
(&
nxGlobÆLock
);

1400  
wid
;

1401 
	}
}

1414 
	$GrDe°royWödow
(
GR_WINDOW_ID
 
wid
)

1416 
nxDe°royWödowReq
 *
ªq
;

1418 
	`LOCK
(&
nxGlobÆLock
);

1419 
ªq
 = 
	`AŒocReq
(
De°royWödow
);

1420 
ªq
->
wödowid
 = 
wid
;

1421 
	`UNLOCK
(&
nxGlobÆLock
);

1422 
	}
}

1433 
	$GrGëWödowInfo
(
GR_WINDOW_ID
 
wid
, 
GR_WINDOW_INFO
 *
öf›å
)

1435 
nxGëWödowInfoReq
 *
ªq
;

1437 
	`LOCK
(&
nxGlobÆLock
);

1438 
ªq
 = 
	`AŒocReq
(
GëWödowInfo
);

1439 
ªq
->
wödowid
 = 
wid
;

1440 
	`Ty≥dRódBlock
(
öf›å
, (
GR_WINDOW_INFO
), 
GrNumGëWödowInfo
);

1441 
	`UNLOCK
(&
nxGlobÆLock
);

1442 
	}
}

1452 
GR_GC_ID


1453 
	$GrNewGC
()

1455 
GR_GC_ID
 
gc
;

1457 
	`LOCK
(&
nxGlobÆLock
);

1458 
	`AŒocReq
(
NewGC
);

1459 if(
	`Ty≥dRódBlock
(&
gc
, (gc),
GrNumNewGC
) == -1)

1460 
gc
 = 0;

1461 
	`UNLOCK
(&
nxGlobÆLock
);

1462  
gc
;

1463 
	}
}

1474 
GR_GC_ID


1475 
	$GrC›yGC
(
GR_GC_ID
 
gc
)

1477 
nxC›yGCReq
 *
ªq
;

1478 
GR_GC_ID
 
√wgc
;

1480 
	`LOCK
(&
nxGlobÆLock
);

1481 
ªq
 = 
	`AŒocReq
(
C›yGC
);

1482 
ªq
->
gcid
 = 
gc
;

1483 if(
	`Ty≥dRódBlock
(&
√wgc
, “ewgc),
GrNumC›yGC
) == -1)

1484 
√wgc
 = 0;

1485 
	`UNLOCK
(&
nxGlobÆLock
);

1486  
√wgc
;

1487 
	}
}

1497 
	$GrDe°royGC
(
GR_GC_ID
 
gc
)

1499 
nxDe°royGCReq
 *
ªq
;

1501 
	`LOCK
(&
nxGlobÆLock
);

1502 
ªq
 = 
	`AŒocReq
(
De°royGC
);

1503 
ªq
->
gcid
 = 
gc
;

1504 
	`UNLOCK
(&
nxGlobÆLock
);

1505 
	}
}

1515 
GR_REGION_ID


1516 
	$GrNewRegi⁄
()

1518 
GR_REGION_ID
 
ªgi⁄
;

1520 
	`LOCK
(&
nxGlobÆLock
);

1521 
	`AŒocReq
(
NewRegi⁄
);

1522 if(
	`Ty≥dRódBlock
(&
ªgi⁄
, ‘egi⁄),
GrNumNewRegi⁄
) == -1)

1523 
ªgi⁄
 = 0;

1524 
	`UNLOCK
(&
nxGlobÆLock
);

1525  
ªgi⁄
;

1526 
	}
}

1536 
	$GrDe°royRegi⁄
(
GR_REGION_ID
 
ªgi⁄
)

1538 
nxDe°royRegi⁄Req
 *
ªq
;

1540 
	`LOCK
(&
nxGlobÆLock
);

1541 
ªq
 = 
	`AŒocReq
(
De°royRegi⁄
);

1542 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1543 
	`UNLOCK
(&
nxGlobÆLock
);

1544 
	}
}

1556 
	$GrUni⁄Re˘WôhRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
)

1558 
nxUni⁄Re˘WôhRegi⁄Req
 *
ªq
;

1560 
	`LOCK
(&
nxGlobÆLock
);

1561 
ªq
 = 
	`AŒocReq
(
Uni⁄Re˘WôhRegi⁄
);

1562 if(
ª˘
)

1563 
	`mem˝y
(&
ªq
->
ª˘
,Ñect, (*rect));

1564 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1565 
	`UNLOCK
(&
nxGlobÆLock
);

1566 
	}
}

1579 
	$GrUni⁄Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1580 
GR_REGION_ID
 
§c_rgn2
)

1582 
nxUni⁄Regi⁄Req
 *
ªq
;

1584 
	`LOCK
(&
nxGlobÆLock
);

1585 
ªq
 = 
	`AŒocReq
(
Uni⁄Regi⁄
);

1586 
ªq
->
ªgi⁄id
 = 
d°_rgn
;

1587 
ªq
->
§¸egi⁄id1
 = 
§c_rgn1
;

1588 
ªq
->
§¸egi⁄id2
 = 
§c_rgn2
;

1589 
	`UNLOCK
(&
nxGlobÆLock
);

1590 
	}
}

1603 
	$GrSubåa˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1604 
GR_REGION_ID
 
§c_rgn2
)

1606 
nxSubåa˘Regi⁄Req
 *
ªq
;

1608 
	`LOCK
(&
nxGlobÆLock
);

1609 
ªq
 = 
	`AŒocReq
(
Subåa˘Regi⁄
);

1610 
ªq
->
ªgi⁄id
 = 
d°_rgn
;

1611 
ªq
->
§¸egi⁄id1
 = 
§c_rgn1
;

1612 
ªq
->
§¸egi⁄id2
 = 
§c_rgn2
;

1613 
	`UNLOCK
(&
nxGlobÆLock
);

1614 
	}
}

1628 
	$GrX‹Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1629 
GR_REGION_ID
 
§c_rgn2
)

1631 
nxX‹Regi⁄Req
 *
ªq
;

1633 
	`LOCK
(&
nxGlobÆLock
);

1634 
ªq
 = 
	`AŒocReq
(
X‹Regi⁄
);

1635 
ªq
->
ªgi⁄id
 = 
d°_rgn
;

1636 
ªq
->
§¸egi⁄id1
 = 
§c_rgn1
;

1637 
ªq
->
§¸egi⁄id2
 = 
§c_rgn2
;

1638 
	`UNLOCK
(&
nxGlobÆLock
);

1639 
	}
}

1653 
	$GrI¡î£˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1654 
GR_REGION_ID
 
§c_rgn2
)

1656 
nxI¡î£˘Regi⁄Req
 *
ªq
;

1658 
	`LOCK
(&
nxGlobÆLock
);

1659 
ªq
 = 
	`AŒocReq
(
I¡î£˘Regi⁄
);

1660 
ªq
->
ªgi⁄id
 = 
d°_rgn
;

1661 
ªq
->
§¸egi⁄id1
 = 
§c_rgn1
;

1662 
ªq
->
§¸egi⁄id2
 = 
§c_rgn2
;

1663 
	`UNLOCK
(&
nxGlobÆLock
);

1664 
	}
}

1678 
	$GrSëGCRegi⁄
(
GR_GC_ID
 
gc
, 
GR_REGION_ID
 
ªgi⁄
)

1680 
nxSëGCRegi⁄Req
 *
ªq
;

1682 
	`LOCK
(&
nxGlobÆLock
);

1683 
ªq
 = 
	`AŒocReq
(
SëGCRegi⁄
);

1684 
ªq
->
gcid
 = 
gc
;

1685 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1686 
	`UNLOCK
(&
nxGlobÆLock
);

1687 
	}
}

1700 
	$GrSëGCClùOrigö
(
GR_GC_ID
 
gc
, 
xoff
, 
yoff
)

1702 
nxSëGCClùOrigöReq
 *
ªq
;

1704 
	`LOCK
(&
nxGlobÆLock
);

1705 
ªq
 = 
	`AŒocReq
(
SëGCClùOrigö
);

1706 
ªq
->
gcid
 = 
gc
;

1707 
ªq
->
xoff
 = xoff;

1708 
ªq
->
yoff
 = yoff;

1709 
	`UNLOCK
(&
nxGlobÆLock
);

1710 
	}
}

1722 
	$GrSëGCGøphicsExposuª
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
exposuª
)

1724 
nxSëGCGøphicsExposuªReq
 *
ªq
;

1726 
	`LOCK
(&
nxGlobÆLock
);

1727 
ªq
 = 
	`AŒocReq
(
SëGCGøphicsExposuª
);

1728 
ªq
->
gcid
 = 
gc
;

1729 
ªq
->
exposuª
 =Éxposure;

1730 
	`UNLOCK
(&
nxGlobÆLock
);

1731 
	}
}

1744 
GR_BOOL


1745 
	$GrPoötInRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
)

1747 
nxPoötInRegi⁄Req
 *
ªq
;

1748 
GR_BOOL
 
ªt_vÆue
;

1750 
	`LOCK
(&
nxGlobÆLock
);

1751 
ªq
 = 
	`AŒocReq
(
PoötInRegi⁄
);

1752 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1753 
ªq
->
x
 = x;

1754 
ªq
->
y
 = y;

1755 if(
	`Ty≥dRódBlock
(&
ªt_vÆue
, (ret_value),

1756 
GrNumPoötInRegi⁄
) == -1)

1757 
ªt_vÆue
 = 
GR_FALSE
;

1758 
	`UNLOCK
(&
nxGlobÆLock
);

1759  
ªt_vÆue
;

1760 
	}
}

1778 
	$GrRe˘InRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
, GR_COORD 
w
,

1779 
GR_COORD
 
h
)

1781 
nxRe˘InRegi⁄Req
 *
ªq
;

1782 
ªt_vÆue
;

1784 
	`LOCK
(&
nxGlobÆLock
);

1785 
ªq
 = 
	`AŒocReq
(
Re˘InRegi⁄
);

1786 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1787 
ªq
->
x
 = x;

1788 
ªq
->
y
 = y;

1789 
ªq
->
w
 = w;

1790 
ªq
->
h
 = h;

1791 if(
	`Ty≥dRódBlock
(&
ªt_vÆue
, (ret_value),

1792 
GrNumRe˘InRegi⁄
) == -1)

1793 
ªt_vÆue
 = 0;

1794 
	`UNLOCK
(&
nxGlobÆLock
);

1795  ()
ªt_vÆue
;

1796 
	}
}

1806 
GR_BOOL


1807 
	$GrEm±yRegi⁄
(
GR_REGION_ID
 
ªgi⁄
)

1809 
nxEm±yRegi⁄Req
 *
ªq
;

1810 
GR_BOOL
 
ªt_vÆue
;

1812 
	`LOCK
(&
nxGlobÆLock
);

1813 
ªq
 = 
	`AŒocReq
(
Em±yRegi⁄
);

1814 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1815 if(
	`Ty≥dRódBlock
(&
ªt_vÆue
, (ret_value),

1816 
GrNumEm±yRegi⁄
) == -1)

1817 
ªt_vÆue
 = 
GR_FALSE
;

1818 
	`UNLOCK
(&
nxGlobÆLock
);

1819  
ªt_vÆue
;

1820 
	}
}

1832 
GR_BOOL


1833 
	$GrEquÆRegi⁄
(
GR_REGION_ID
 
rgn1
, GR_REGION_ID 
rgn2
)

1835 
nxEquÆRegi⁄Req
 *
ªq
;

1836 
GR_BOOL
 
ªt_vÆue
;

1838 
	`LOCK
(&
nxGlobÆLock
);

1839 
ªq
 = 
	`AŒocReq
(
EquÆRegi⁄
);

1840 
ªq
->
ªgi⁄1
 = 
rgn1
;

1841 
ªq
->
ªgi⁄2
 = 
rgn2
;

1842 if(
	`Ty≥dRódBlock
(&
ªt_vÆue
, (ret_value),

1843 
GrNumEquÆRegi⁄
) == -1)

1844 
ªt_vÆue
 = 
GR_FALSE
;

1845 
	`UNLOCK
(&
nxGlobÆLock
);

1846  
ªt_vÆue
;

1847 
	}
}

1859 
	$GrOff£tRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_SIZE
 
dx
, GR_SIZE 
dy
)

1861 
nxOff£tRegi⁄Req
 *
ªq
;

1863 
	`LOCK
(&
nxGlobÆLock
);

1864 
ªq
 = 
	`AŒocReq
(
Off£tRegi⁄
);

1865 
ªq
->
ªgi⁄
 =Ñegion;

1866 
ªq
->
dx
 = dx;

1867 
ªq
->
dy
 = dy;

1868 
	`UNLOCK
(&
nxGlobÆLock
);

1869 
	}
}

1885 
	$GrGëRegi⁄Box
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
)

1887 
nxGëRegi⁄BoxReq
 *
ªq
;

1888 
ªt_vÆue
;

1890 i‡(!
ª˘
)

1891  
GR_FALSE
;

1893 
	`LOCK
(&
nxGlobÆLock
);

1894 
ªq
 = 
	`AŒocReq
(
GëRegi⁄Box
);

1895 
ªq
->
ªgi⁄id
 = 
ªgi⁄
;

1896 if(
	`Ty≥dRódBlock
(
ª˘
, (*ª˘), 
GrNumGëRegi⁄Box
) == -1)

1897  
GR_FALSE
;

1898 if(
	`Ty≥dRódBlock
(&
ªt_vÆue
, (ret_value),

1899 
GrNumGëRegi⁄Box
) == -1)

1900 
ªt_vÆue
 = 
GR_FALSE
;

1901 
	`UNLOCK
(&
nxGlobÆLock
);

1902  
ªt_vÆue
;

1903 
	}
}

1916 
GR_REGION_ID


1917 
	$GrNewPﬁyg⁄Regi⁄
(
mode
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöts
)

1919 
nxNewPﬁyg⁄Regi⁄Req
 *
ªq
;

1920 
size
;

1921 
GR_REGION_ID
 
ªgi⁄
;

1923 if(
cou¡
 == 0)

1924  
	`GrNewRegi⁄
();

1926 if(
poöts
 =
NULL
)

1929 
	`LOCK
(&
nxGlobÆLock
);

1930 
size
 = ()
cou¡
 * (
GR_POINT
);

1931 
ªq
 = 
	`AŒocReqExåa
(
NewPﬁyg⁄Regi⁄
, 
size
);

1932 
ªq
->
mode
 = mode;

1934 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
poöts
, 
size
);

1936 if(
	`Ty≥dRódBlock
(&
ªgi⁄
, (region),

1937 
GrNumNewPﬁyg⁄Regi⁄
) == -1)

1938 
ªgi⁄
 = 0;

1939 
	`UNLOCK
(&
nxGlobÆLock
);

1940  
ªgi⁄
;

1941 
	}
}

1954 
	$GrM≠Wödow
(
GR_WINDOW_ID
 
wid
)

1956 
nxM≠WödowReq
 *
ªq
;

1958 
	`LOCK
(&
nxGlobÆLock
);

1959 
ªq
 = 
	`AŒocReq
(
M≠Wödow
);

1960 
ªq
->
wödowid
 = 
wid
;

1961 
	`UNLOCK
(&
nxGlobÆLock
);

1962 
	}
}

1973 
	$GrUnm≠Wödow
(
GR_WINDOW_ID
 
wid
)

1975 
nxUnm≠WödowReq
 *
ªq
;

1977 
	`LOCK
(&
nxGlobÆLock
);

1978 
ªq
 = 
	`AŒocReq
(
Unm≠Wödow
);

1979 
ªq
->
wödowid
 = 
wid
;

1980 
	`UNLOCK
(&
nxGlobÆLock
);

1981 
	}
}

1992 
	$GrRai£Wödow
(
GR_WINDOW_ID
 
wid
)

1994 
nxRai£WödowReq
 *
ªq
;

1996 
	`LOCK
(&
nxGlobÆLock
);

1997 
ªq
 = 
	`AŒocReq
(
Rai£Wödow
);

1998 
ªq
->
wödowid
 = 
wid
;

1999 
	`UNLOCK
(&
nxGlobÆLock
);

2000 
	}
}

2011 
	$GrLowîWödow
(
GR_WINDOW_ID
 
wid
)

2013 
nxLowîWödowReq
 *
ªq
;

2015 
	`LOCK
(&
nxGlobÆLock
);

2016 
ªq
 = 
	`AŒocReq
(
LowîWödow
);

2017 
ªq
->
wödowid
 = 
wid
;

2018 
	`UNLOCK
(&
nxGlobÆLock
);

2019 
	}
}

2032 
	$GrMoveWödow
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
)

2034 
nxMoveWödowReq
 *
ªq
;

2036 
	`LOCK
(&
nxGlobÆLock
);

2037 
ªq
 = 
	`AŒocReq
(
MoveWödow
);

2038 
ªq
->
wödowid
 = 
wid
;

2039 
ªq
->
x
 = x;

2040 
ªq
->
y
 = y;

2041 
	`UNLOCK
(&
nxGlobÆLock
);

2042 
	}
}

2054 
	$GrResizeWödow
(
GR_WINDOW_ID
 
wid
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

2056 
nxResizeWödowReq
 *
ªq
;

2058 
	`LOCK
(&
nxGlobÆLock
);

2059 
ªq
 = 
	`AŒocReq
(
ResizeWödow
);

2060 
ªq
->
wödowid
 = 
wid
;

2061 
ªq
->
width
 = width;

2062 
ªq
->
height
 = height;

2063 
	`UNLOCK
(&
nxGlobÆLock
);

2064 
	}
}

2079 
	$GrRï¨ítWödow
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pwid
, 
GR_COORD
 
x
, GR_COORD 
y
)

2081 
nxRï¨ítWödowReq
 *
ªq
;

2083 
	`LOCK
(&
nxGlobÆLock
);

2084 
ªq
 = 
	`AŒocReq
(
Rï¨ítWödow
);

2085 
ªq
->
wödowid
 = 
wid
;

2086 
ªq
->
∑ª¡id
 = 
pwid
;

2087 
ªq
->
x
 = x;

2088 
ªq
->
y
 = y;

2089 
	`UNLOCK
(&
nxGlobÆLock
);

2090 
	}
}

2107 
	$GrCÀ¨Aªa
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

2108 
GR_SIZE
 
height
, 
GR_BOOL
 
expo£Êag
)

2110 
nxCÀ¨AªaReq
 *
ªq
;

2112 
	`LOCK
(&
nxGlobÆLock
);

2113 
ªq
 = 
	`AŒocReq
(
CÀ¨Aªa
);

2114 
ªq
->
wödowid
 = 
wid
;

2115 
ªq
->
x
 = x;

2116 
ªq
->
y
 = y;

2117 
ªq
->
width
 = width;

2118 
ªq
->
height
 = height;

2119 
ªq
->
expo£Êag
 =Éxposeflag;

2120 
	`UNLOCK
(&
nxGlobÆLock
);

2121 
	}
}

2130 
GR_WINDOW_ID


2131 
	$GrGëFocus
()

2133 
GR_WINDOW_ID
 
wid
;

2135 
	`LOCK
(&
nxGlobÆLock
);

2136 
	`AŒocReq
(
GëFocus
);

2137 if(
	`Ty≥dRódBlock
(&
wid
, (wid), 
GrNumGëFocus
) == -1)

2138 
wid
 = 0;

2139 
	`UNLOCK
(&
nxGlobÆLock
);

2140  
wid
;

2141 
	}
}

2151 
	$GrSëFocus
(
GR_WINDOW_ID
 
wid
)

2153 
nxSëFocusReq
 *
ªq
;

2155 
	`LOCK
(&
nxGlobÆLock
);

2156 
ªq
 = 
	`AŒocReq
(
SëFocus
);

2157 
ªq
->
wödowid
 = 
wid
;

2158 
	`UNLOCK
(&
nxGlobÆLock
);

2159 
	}
}

2174 
	$GrSëWödowCurs‹
(
GR_WINDOW_ID
 
wid
, 
GR_CURSOR_ID
 
cid
)

2176 
nxSëWödowCurs‹Req
 *
ªq
;

2178 
	`LOCK
(&
nxGlobÆLock
);

2179 
ªq
 = 
	`AŒocReq
(
SëWödowCurs‹
);

2180 
ªq
->
wödowid
 = 
wid
;

2181 
ªq
->
curs‹id
 = 
cid
;

2182 
	`UNLOCK
(&
nxGlobÆLock
);

2183 
	}
}

2199 
GR_CURSOR_ID


2200 
	$GrNewCurs‹
(
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COORD
 
hŸx
, GR_COORD 
hŸy
,

2201 
GR_COLOR
 
f‹eground
, GR_COLOR 
background
,

2202 
GR_BITMAP
 *
fgbôm≠
, GR_BITMAP *
bgbôm≠
)

2204 
nxNewCurs‹Req
 *
ªq
;

2205 
bôm≠size
;

2206 * 
d©a
;

2207 
GR_CURSOR_ID
 
curs‹id
;

2209 
bôm≠size
 = 
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
);

2210 
	`LOCK
(&
nxGlobÆLock
);

2211 
ªq
 = 
	`AŒocReqExåa
(
NewCurs‹
, 
bôm≠size
*2);

2212 
ªq
->
width
 = width;

2213 
ªq
->
height
 = height;

2214 
ªq
->
hŸx
 = hotx;

2215 
ªq
->
hŸy
 = hoty;

2216 
ªq
->
fgcﬁ‹
 = 
f‹eground
;

2217 
ªq
->
bgcﬁ‹
 = 
background
;

2218 
d©a
 = 
	`GëReqD©a
(
ªq
);

2219 
	`mem˝y
(
d©a
, 
fgbôm≠
, 
bôm≠size
);

2220 
	`mem˝y
(
d©a
+
bôm≠size
, 
bgbôm≠
, bitmapsize);

2222 if(
	`Ty≥dRódBlock
(&
curs‹id
, (curs‹id), 
GrNumNewCurs‹
) == -1)

2223 
curs‹id
 = 0;

2224 
	`UNLOCK
(&
nxGlobÆLock
);

2225  
curs‹id
;

2226 
	}
}

2242 
	$GrMoveCurs‹
(
GR_COORD
 
x
, GR_COORD 
y
)

2244 
nxMoveCurs‹Req
 *
ªq
;

2246 
	`LOCK
(&
nxGlobÆLock
);

2247 
ªq
 = 
	`AŒocReq
(
MoveCurs‹
);

2248 
ªq
->
x
 = x;

2249 
ªq
->
y
 = y;

2250 
	`UNLOCK
(&
nxGlobÆLock
);

2251 
	}
}

2263 
	$GrSëGCF‹eground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
f‹eground
)

2265 
nxSëGCF‹egroundReq
 *
ªq
;

2267 
	`LOCK
(&
nxGlobÆLock
);

2268 
ªq
 = 
	`AŒocReq
(
SëGCF‹eground
);

2269 
ªq
->
gcid
 = 
gc
;

2270 
ªq
->
cﬁ‹
 = 
f‹eground
;

2271 
	`UNLOCK
(&
nxGlobÆLock
);

2272 
	}
}

2284 
	$GrSëGCBackground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
background
)

2286 
nxSëGCBackgroundReq
 *
ªq
;

2288 
	`LOCK
(&
nxGlobÆLock
);

2289 
ªq
 = 
	`AŒocReq
(
SëGCBackground
);

2290 
ªq
->
gcid
 = 
gc
;

2291 
ªq
->
cﬁ‹
 = 
background
;

2292 
	`UNLOCK
(&
nxGlobÆLock
);

2293 
	}
}

2306 
	$GrSëGCF‹egroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
f‹eground
)

2308 
nxSëGCF‹egroundPixñVÆReq
 *
ªq
;

2310 
	`LOCK
(&
nxGlobÆLock
);

2311 
ªq
 = 
	`AŒocReq
(
SëGCF‹egroundPixñVÆ
);

2312 
ªq
->
gcid
 = 
gc
;

2313 
ªq
->
pixñvÆ
 = 
f‹eground
;

2314 
	`UNLOCK
(&
nxGlobÆLock
);

2315 
	}
}

2328 
	$GrSëGCBackgroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
background
)

2330 
nxSëGCBackgroundPixñVÆReq
 *
ªq
;

2332 
	`LOCK
(&
nxGlobÆLock
);

2333 
ªq
 = 
	`AŒocReq
(
SëGCBackgroundPixñVÆ
);

2334 
ªq
->
gcid
 = 
gc
;

2335 
ªq
->
pixñvÆ
 = 
background
;

2336 
	`UNLOCK
(&
nxGlobÆLock
);

2337 
	}
}

2349 
	$GrSëGCMode
(
GR_GC_ID
 
gc
, 
mode
)

2351 
nxSëGCModeReq
 *
ªq
;

2353 
	`LOCK
(&
nxGlobÆLock
);

2354 
ªq
 = 
	`AŒocReq
(
SëGCMode
);

2355 
ªq
->
gcid
 = 
gc
;

2356 
ªq
->
mode
 = mode;

2357 
	`UNLOCK
(&
nxGlobÆLock
);

2358 
	}
}

2369 
	$GrSëGCLöeAâribuãs
(
GR_GC_ID
 
gc
, 
löe°yÀ
)

2371 
nxSëGCLöeAâribuãsReq
 *
ªq
;

2373 
	`LOCK
(&
nxGlobÆLock
);

2374 
ªq
 = 
	`AŒocReq
(
SëGCLöeAâribuãs
);

2375 
ªq
->
gcid
 = 
gc
;

2376 
ªq
->
löe°yÀ
 =Üinestyle;

2377 
	`UNLOCK
(&
nxGlobÆLock
);

2378 
	}
}

2392 
	$GrSëGCDash
(
GR_GC_ID
 
gc
, *
dashes
, 
cou¡
)

2394 
nxSëGCDashReq
 *
ªq
;

2395 
size
;

2397 
size
 = 
cou¡
 * ();

2398 
	`LOCK
(&
nxGlobÆLock
);

2399 
ªq
 = 
	`AŒocReqExåa
(
SëGCDash
, 
size
);

2400 
ªq
->
gcid
 = 
gc
;

2401 
ªq
->
cou¡
 = count;

2402 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
dashes
, 
size
);

2403 
	`UNLOCK
(&
nxGlobÆLock
);

2404 
	}
}

2417 
	$GrSëGCFûlMode
(
GR_GC_ID
 
gc
, 
fûlmode
)

2419 
nxSëGCFûlModeReq
 *
ªq
;

2421 
	`LOCK
(&
nxGlobÆLock
);

2422 
ªq
 = 
	`AŒocReq
(
SëGCFûlMode
);

2423 
ªq
->
gcid
 = 
gc
;

2424 
ªq
->
fûlmode
 = fillmode;

2425 
	`UNLOCK
(&
nxGlobÆLock
);

2426 
	}
}

2441 
	$GrSëGCStù∂e
(
GR_GC_ID
 
gc
, 
GR_BITMAP
 *
bôm≠
, 
width
, 
height
)

2443 
nxSëGCStù∂eReq
 *
ªq
;

2444 
size
;

2446 
size
 = 
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
);

2447 
	`LOCK
(&
nxGlobÆLock
);

2448 
ªq
 = 
	`AŒocReqExåa
(
SëGCStù∂e
, 
size
);

2449 
ªq
->
gcid
 = 
gc
;

2450 
ªq
->
width
 = width;

2451 
ªq
->
height
 = height;

2452 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
bôm≠
, 
size
);

2453 
	`UNLOCK
(&
nxGlobÆLock
);

2454 
	}
}

2469 
	$GrSëGCTûe
(
GR_GC_ID
 
gc
, 
GR_WINDOW_ID
 
pixm≠
, 
width
, 
height
)

2471 
nxSëGCTûeReq
 *
ªq
;

2473 
	`LOCK
(&
nxGlobÆLock
);

2474 
ªq
 = 
	`AŒocReq
(
SëGCTûe
);

2475 
ªq
->
gcid
 = 
gc
;

2476 
ªq
->
pixm≠
 =Öixmap;

2477 
ªq
->
width
 = width;

2478 
ªq
->
height
 = height;

2479 
	`UNLOCK
(&
nxGlobÆLock
);

2480 
	}
}

2494 
	$GrSëGCTSOff£t
(
GR_GC_ID
 
gc
, 
xoff
, 
yoff
)

2496 
nxSëGCTSOff£tReq
 *
ªq
;

2498 
	`LOCK
(&
nxGlobÆLock
);

2499 
ªq
 = 
	`AŒocReq
(
SëGCTSOff£t
);

2500 
ªq
->
gcid
 = 
gc
;

2501 
ªq
->
xoff£t
 = 
xoff
;

2502 
ªq
->
yoff£t
 = 
yoff
;

2503 
	`UNLOCK
(&
nxGlobÆLock
);

2504 
	}
}

2517 
	$GrSëGCU£Background
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
Êag
)

2519 
nxSëGCU£BackgroundReq
 *
ªq
;

2521 
	`LOCK
(&
nxGlobÆLock
);

2522 
ªq
 = 
	`AŒocReq
(
SëGCU£Background
);

2523 
ªq
->
gcid
 = 
gc
;

2524 
ªq
->
Êag
 = flag;

2525 
	`UNLOCK
(&
nxGlobÆLock
);

2526 
	}
}

2544 
GR_FONT_ID


2545 
	$GrCª©eF⁄t
(
GR_CHAR
 *
«me
, 
GR_COORD
 
height
, 
GR_LOGFONT
 *
∂ogf⁄t
)

2547 
GR_FONT_ID
 
f⁄tid
;

2549 
	`LOCK
(&
nxGlobÆLock
);

2551 i‡(
∂ogf⁄t
)

2553 
nxCª©eLogF⁄tReq
 *
ªq
;

2554 
ªq
 = 
	`AŒocReq
(
Cª©eLogF⁄t
);

2555 
	`mem˝y
(&
ªq
->
lf
, 
∂ogf⁄t
, (*plogfont));

2557 i‡(
	`Ty≥dRódBlock
(&
f⁄tid
, (f⁄tid), 
GrNumCª©eLogF⁄t
) == -1)

2558 
f⁄tid
 = 0;

2562 
nxCª©eF⁄tReq
 *
ªq
;

2564 i‡(!
«me
)

2565 
«me
 = "";

2567 
ªq
 = 
	`AŒocReqExåa
(
Cª©eF⁄t
, 
	`°æí
(
«me
) + 1);

2568 
ªq
->
height
 = height;

2569 
	`°r˝y
((*)
	`GëReqD©a
(
ªq
), 
«me
);

2571 i‡(
	`Ty≥dRódBlock
(&
f⁄tid
, (f⁄tid), 
GrNumCª©eF⁄t
) == -1)

2572 
f⁄tid
 = 0;

2575 
	`UNLOCK
(&
nxGlobÆLock
);

2576  
f⁄tid
;

2577 
	}
}

2589 
	$GrGëF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, *
numf⁄ts
)

2591 
nxGëF⁄tLi°Req
 *
ªq
;

2592 *
tmp°r
;

2593 
GR_FONTLIST
 **
Êi°
;

2594 
num
, 
Àn
, 
i
;

2596 
	`LOCK
(&
nxGlobÆLock
);

2597 
ªq
 = 
	`AŒocReq
(
GëF⁄tLi°
);

2599 i‡(
	`Ty≥dRódBlock
(&
num
, (), 
GrNumGëF⁄tLi°
) == -1)

2600 
num
 = 0;

2602 *
numf⁄ts
 = 
num
;

2604 if(
num
 == -1)

2607 
Êi°
 = (
GR_FONTLIST
**)
	`mÆloc
(
num
 * (GR_FONTLIST*));

2609 
i
 = 0; i < 
num
; i++)

2610 
Êi°
[
i
] = (
GR_FONTLIST
*)
	`mÆloc
((GR_FONTLIST*));

2612 
i
 = 0; i < 
num
; i++) {

2613 
	`RódBlock
(&
Àn
, ());

2614 
tmp°r
 = (*)
	`mÆloc
(
Àn
 * ());

2615 
	`RódBlock
(
tmp°r
, 
Àn
 * ());

2616 
Êi°
[
i
]->
â«me
 = 
tmp°r
;

2618 
	`RódBlock
(&
Àn
, ());

2619 
tmp°r
 = (*)
	`mÆloc
(
Àn
 * ());

2620 
	`RódBlock
(
tmp°r
, 
Àn
 * ());

2621 
Êi°
[
i
]->
mw«me
 = 
tmp°r
;

2625 *
f⁄ts
 = 
Êi°
;

2626 
	`UNLOCK
(&
nxGlobÆLock
);

2627 
	}
}

2638 
	$GrFªeF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, 
numf⁄ts
)

2640 
i
;

2641 
MWFONTLIST
 *
g
, **
li°
 = *
f⁄ts
;

2643 
	`LOCK
(&
nxGlobÆLock
);

2644 
i
 = 0; i < 
numf⁄ts
; i++) {

2645 
g
 = 
li°
[
i
];

2646 if(
g
) {

2647 if(
g
->
mw«me
)

2648 
	`‰ì
(
g
->
mw«me
);

2649 if(
g
->
â«me
)

2650 
	`‰ì
(
g
->
â«me
);

2651 
	`‰ì
(
g
);

2654 
	`‰ì
(
li°
);

2655 *
f⁄ts
 = 0;

2656 
	`UNLOCK
(&
nxGlobÆLock
);

2657 
	}
}

2668 
	$GrSëF⁄tSize
(
GR_FONT_ID
 
f⁄tid
, 
GR_COORD
 
size
)

2670 
nxSëF⁄tSizeReq
 *
ªq
;

2672 
	`LOCK
(&
nxGlobÆLock
);

2673 
ªq
 = 
	`AŒocReq
(
SëF⁄tSize
);

2674 
ªq
->
f⁄tid
 = fontid;

2675 
ªq
->
f⁄tsize
 = 
size
;

2676 
	`UNLOCK
(&
nxGlobÆLock
);

2677 
	}
}

2688 
	$GrSëF⁄tRŸ©i⁄
(
GR_FONT_ID
 
f⁄tid
, 
ã¡hdegªes
)

2690 
nxSëF⁄tRŸ©i⁄Req
 *
ªq
;

2692 
	`LOCK
(&
nxGlobÆLock
);

2693 
ªq
 = 
	`AŒocReq
(
SëF⁄tRŸ©i⁄
);

2694 
ªq
->
f⁄tid
 = fontid;

2695 
ªq
->
ã¡hdegªes
 =Åenthdegrees;

2696 
	`UNLOCK
(&
nxGlobÆLock
);

2697 
	}
}

2710 
	$GrSëF⁄tAâr
(
GR_FONT_ID
 
f⁄tid
, 
£tÊags
, 
˛rÊags
)

2712 
nxSëF⁄tAârReq
 *
ªq
;

2714 
	`LOCK
(&
nxGlobÆLock
);

2715 
ªq
 = 
	`AŒocReq
(
SëF⁄tAâr
);

2716 
ªq
->
f⁄tid
 = fontid;

2717 
ªq
->
£tÊags
 = setflags;

2718 
ªq
->
˛rÊags
 = clrflags;

2719 
	`UNLOCK
(&
nxGlobÆLock
);

2720 
	}
}

2732 
	$GrDe°royF⁄t
(
GR_FONT_ID
 
f⁄tid
)

2734 
nxDe°royF⁄tReq
 *
ªq
;

2736 
	`LOCK
(&
nxGlobÆLock
);

2737 
ªq
 = 
	`AŒocReq
(
De°royF⁄t
);

2738 
ªq
->
f⁄tid
 = fontid;

2739 
	`UNLOCK
(&
nxGlobÆLock
);

2740 
	}
}

2752 
	$GrSëGCF⁄t
(
GR_GC_ID
 
gc
, 
GR_FONT_ID
 
f⁄t
)

2754 
nxSëGCF⁄tReq
 *
ªq
;

2756 
	`LOCK
(&
nxGlobÆLock
);

2757 
ªq
 = 
	`AŒocReq
(
SëGCF⁄t
);

2758 
ªq
->
gcid
 = 
gc
;

2759 
ªq
->
f⁄tid
 = 
f⁄t
;

2760 
	`UNLOCK
(&
nxGlobÆLock
);

2761 
	}
}

2777 
	$GrLöe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x1
, GR_COORD 
y1
, GR_COORD 
x2
,

2778 
GR_COORD
 
y2
)

2780 
nxLöeReq
 *
ªq
;

2782 
	`LOCK
(&
nxGlobÆLock
);

2783 
ªq
 = 
	`AŒocReq
(
Löe
);

2784 
ªq
->
døwid
 = 
id
;

2785 
ªq
->
gcid
 = 
gc
;

2786 
ªq
->
x1
 = x1;

2787 
ªq
->
y1
 = y1;

2788 
ªq
->
x2
 = x2;

2789 
ªq
->
y2
 = y2;

2790 
	`UNLOCK
(&
nxGlobÆLock
);

2791 
	}
}

2807 
	$GrRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

2808 
GR_SIZE
 
height
)

2810 
nxRe˘Req
 *
ªq
;

2812 
	`LOCK
(&
nxGlobÆLock
);

2813 
ªq
 = 
	`AŒocReq
(
Re˘
);

2814 
ªq
->
døwid
 = 
id
;

2815 
ªq
->
gcid
 = 
gc
;

2816 
ªq
->
x
 = x;

2817 
ªq
->
y
 = y;

2818 
ªq
->
width
 = width;

2819 
ªq
->
height
 = height;

2820 
	`UNLOCK
(&
nxGlobÆLock
);

2821 
	}
}

2837 
	$GrFûlRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2838 
GR_SIZE
 
width
, GR_SIZE 
height
)

2840 
nxFûlRe˘Req
 *
ªq
;

2842 
	`LOCK
(&
nxGlobÆLock
);

2843 
ªq
 = 
	`AŒocReq
(
FûlRe˘
);

2844 
ªq
->
døwid
 = 
id
;

2845 
ªq
->
gcid
 = 
gc
;

2846 
ªq
->
x
 = x;

2847 
ªq
->
y
 = y;

2848 
ªq
->
width
 = width;

2849 
ªq
->
height
 = height;

2850 
	`UNLOCK
(&
nxGlobÆLock
);

2851 
	}
}

2867 
	$GrEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
rx
,

2868 
GR_SIZE
 
ry
)

2870 
nxEŒù£Req
 *
ªq
;

2872 
	`LOCK
(&
nxGlobÆLock
);

2873 
ªq
 = 
	`AŒocReq
(
EŒù£
);

2874 
ªq
->
døwid
 = 
id
;

2875 
ªq
->
gcid
 = 
gc
;

2876 
ªq
->
x
 = x;

2877 
ªq
->
y
 = y;

2878 
ªq
->
rx
 =Ñx;

2879 
ªq
->
ry
 =Ñy;

2880 
	`UNLOCK
(&
nxGlobÆLock
);

2881 
	}
}

2897 
	$GrFûlEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2898 
GR_SIZE
 
rx
, GR_SIZE 
ry
)

2900 
nxFûlEŒù£Req
 *
ªq
;

2902 
	`LOCK
(&
nxGlobÆLock
);

2903 
ªq
 = 
	`AŒocReq
(
FûlEŒù£
);

2904 
ªq
->
døwid
 = 
id
;

2905 
ªq
->
gcid
 = 
gc
;

2906 
ªq
->
x
 = x;

2907 
ªq
->
y
 = y;

2908 
ªq
->
rx
 =Ñx;

2909 
ªq
->
ry
 =Ñy;

2910 
	`UNLOCK
(&
nxGlobÆLock
);

2911 
	}
}

2934 
	$GrArc
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2935 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
ax
, GR_COORD 
ay
,

2936 
GR_COORD
 
bx
, GR_COORD 
by
, 
ty≥
)

2938 
nxArcReq
 *
ªq
;

2940 
	`LOCK
(&
nxGlobÆLock
);

2941 
ªq
 = 
	`AŒocReq
(
Arc
);

2942 
ªq
->
døwid
 = 
id
;

2943 
ªq
->
gcid
 = 
gc
;

2944 
ªq
->
x
 = x;

2945 
ªq
->
y
 = y;

2946 
ªq
->
rx
 =Ñx;

2947 
ªq
->
ry
 =Ñy;

2948 
ªq
->
ax
 =áx;

2949 
ªq
->
ay
 =áy;

2950 
ªq
->
bx
 = bx;

2951 
ªq
->
by
 = by;

2952 
ªq
->
ty≥
 =Åype;

2953 
	`UNLOCK
(&
nxGlobÆLock
);

2954 
	}
}

2976 
	$GrArcAngÀ
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2977 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
™gÀ1
, GR_COORD 
™gÀ2
, 
ty≥
)

2979 
nxArcAngÀReq
 *
ªq
;

2981 
	`LOCK
(&
nxGlobÆLock
);

2982 
ªq
 = 
	`AŒocReq
(
ArcAngÀ
);

2983 
ªq
->
døwid
 = 
id
;

2984 
ªq
->
gcid
 = 
gc
;

2985 
ªq
->
x
 = x;

2986 
ªq
->
y
 = y;

2987 
ªq
->
rx
 =Ñx;

2988 
ªq
->
ry
 =Ñy;

2989 
ªq
->
™gÀ1
 =ángle1;

2990 
ªq
->
™gÀ2
 =ángle2;

2991 
ªq
->
ty≥
 =Åype;

2992 
	`UNLOCK
(&
nxGlobÆLock
);

2993 
	}
}

3013 
	$GrBôm≠
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

3014 
GR_SIZE
 
height
, 
GR_BITMAP
 *
imagebôs
)

3016 
nxBôm≠Req
 *
ªq
;

3017 
bôm≠size
;

3019 
bôm≠size
 = ()
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
);

3020 
	`LOCK
(&
nxGlobÆLock
);

3021 
ªq
 = 
	`AŒocReqExåa
(
Bôm≠
, 
bôm≠size
);

3022 
ªq
->
døwid
 = 
id
;

3023 
ªq
->
gcid
 = 
gc
;

3024 
ªq
->
x
 = x;

3025 
ªq
->
y
 = y;

3026 
ªq
->
width
 = width;

3027 
ªq
->
height
 = height;

3028 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
imagebôs
, 
bôm≠size
);

3029 
	`UNLOCK
(&
nxGlobÆLock
);

3030 
	}
}

3046 
	$GrDøwImageBôs
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

3047 
GR_IMAGE_HDR
 *
pimage
)

3049 
nxDøwImageBôsReq
 *
ªq
;

3050 
imagesize
;

3051 
∑lsize
;

3052 *
addr
;

3054 
imagesize
 = 
pimage
->
pôch
 *Öimage->
height
;

3055 
∑lsize
 = 
pimage
->∑lsizê* (
MWPALENTRY
);

3056 
	`LOCK
(&
nxGlobÆLock
);

3057 
ªq
 = 
	`AŒocReqExåa
(
DøwImageBôs
, 
imagesize
 + 
∑lsize
);

3058 
ªq
->
døwid
 = 
id
;

3059 
ªq
->
gcid
 = 
gc
;

3060 
ªq
->
x
 = x;

3061 
ªq
->
y
 = y;

3063 
ªq
->
width
 = 
pimage
->width;

3064 
ªq
->
height
 = 
pimage
->height;

3065 
ªq
->
∂™es
 = 
pimage
->planes;

3066 
ªq
->
bµ
 = 
pimage
->bpp;

3067 
ªq
->
pôch
 = 
pimage
->pitch;

3068 
ªq
->
byã•îpixñ
 = 
pimage
->bytesperpixel;

3069 
ªq
->
com¥essi⁄
 = 
pimage
->compression;

3070 
ªq
->
∑lsize
 = 
pimage
->palsize;

3071 
ªq
->
å™scﬁ‹
 = 
pimage
->transcolor;

3072 
addr
 = 
	`GëReqD©a
(
ªq
);

3073 
	`mem˝y
(
addr
, 
pimage
->
imagebôs
, 
imagesize
);

3074 
	`mem˝y
(
addr
+
imagesize
, 
pimage
->
∑Àâe
, 
∑lsize
);

3075 
	`UNLOCK
(&
nxGlobÆLock
);

3076 
	}
}

3078 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_FILEIO
)

3103 
	$GrDøwImageFromFûe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

3104 
GR_SIZE
 
width
, GR_SIZE 
height
, * 
∑th
, 
Êags
)

3106 
nxDøwImageFromFûeReq
 *
ªq
;

3108 
	`LOCK
(&
nxGlobÆLock
);

3109 
ªq
 = 
	`AŒocReqExåa
(
DøwImageFromFûe
, 
	`°æí
(
∑th
)+1);

3110 
ªq
->
døwid
 = 
id
;

3111 
ªq
->
gcid
 = 
gc
;

3112 
ªq
->
x
 = x;

3113 
ªq
->
y
 = y;

3114 
ªq
->
width
 = width;

3115 
ªq
->
height
 = height;

3116 
ªq
->
Êags
 = flags;

3117 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
∑th
, 
	`°æí
(path)+1);

3118 
	`UNLOCK
(&
nxGlobÆLock
);

3119 
	}
}

3122 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_FILEIO
)

3138 
GR_IMAGE_ID


3139 
	$GrLﬂdImageFromFûe
(*
∑th
, 
Êags
)

3141 
nxLﬂdImageFromFûeReq
 *
ªq
;

3142 
GR_IMAGE_ID
 
imageid
;

3144 
	`LOCK
(&
nxGlobÆLock
);

3145 
ªq
 = 
	`AŒocReqExåa
(
LﬂdImageFromFûe
, 
	`°æí
(
∑th
)+1);

3146 
ªq
->
Êags
 = flags;

3147 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
∑th
, 
	`°æí
(path)+1);

3149 if(
	`Ty≥dRódBlock
(&
imageid
, (imageid),

3150 
GrNumLﬂdImageFromFûe
) == -1)

3151 
imageid
 = 0;

3152 
	`UNLOCK
(&
nxGlobÆLock
);

3153  
imageid
;

3154 
	}
}

3157 #i‡
MW_FEATURE_IMAGES


3175 
	$GrDøwImageToFô
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

3176 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_IMAGE_ID
 
imageid
)

3178 
nxDøwImageToFôReq
 *
ªq
;

3180 
	`LOCK
(&
nxGlobÆLock
);

3181 
ªq
 = 
	`AŒocReq
(
DøwImageToFô
);

3182 
ªq
->
døwid
 = 
id
;

3183 
ªq
->
gcid
 = 
gc
;

3184 
ªq
->
x
 = x;

3185 
ªq
->
y
 = y;

3186 
ªq
->
width
 = width;

3187 
ªq
->
height
 = height;

3188 
ªq
->
imageid
 = imageid;

3189 
	`UNLOCK
(&
nxGlobÆLock
);

3190 
	}
}

3193 #i‡
MW_FEATURE_IMAGES


3202 
	$GrFªeImage
(
GR_IMAGE_ID
 
id
)

3204 
nxFªeImageReq
 *
ªq
;

3206 
	`LOCK
(&
nxGlobÆLock
);

3207 
ªq
 = 
	`AŒocReq
(
FªeImage
);

3208 
ªq
->
id
 = id;

3209 
	`UNLOCK
(&
nxGlobÆLock
);

3210 
	}
}

3213 #i‡
MW_FEATURE_IMAGES


3224 
	$GrGëImageInfo
(
GR_IMAGE_ID
 
id
, 
GR_IMAGE_INFO
 *
iù
)

3226 
nxGëImageInfoReq
 *
ªq
;

3228 
	`LOCK
(&
nxGlobÆLock
);

3229 
ªq
 = 
	`AŒocReq
(
GëImageInfo
);

3230 
ªq
->
id
 = id;

3231 
	`Ty≥dRódBlock
(
iù
, (
GR_IMAGE_INFO
), 
GrNumGëImageInfo
);

3232 
	`UNLOCK
(&
nxGlobÆLock
);

3233 
	}
}

3244 
	$£ndImageBuf„r
(c⁄° *
buf„r
, 
size
)

3246 
bufid
;

3247 
bufsize
 = 
size
;

3248 c⁄° *
buÂå
 = (c⁄° *)
buf„r
;

3249 
nxImageBuf„rAŒocReq
 *
Æloc
;

3250 
nxImageBuf„rSídReq
 *
£nd
;

3253 
Æloc
 = 
	`AŒocReq
(
ImageBuf„rAŒoc
);

3254 
Æloc
->
size
 = size;

3255 
	`Ty≥dRódBlock
(&
bufid
, (bufid), 
GrNumImageBuf„rAŒoc
);

3257 i‡(
bufid
 < 0)

3261 
bufsize
 > 0) {

3262 
chunk
 = (
MAXREQUESTSZ
 - (
nxImageBuf„rSídReq
));

3263 i‡(
chunk
 > 
bufsize
)

3264 
chunk
 = 
bufsize
;

3266 
£nd
 = 
	`AŒocReqExåa
(
ImageBuf„rSíd
, 
chunk
);

3267 
£nd
->
buf„r_id
 = 
bufid
;

3268 
£nd
->
size
 = 
chunk
;

3270 
	`mem˝y
(
	`GëReqD©a
(
£nd
), 
buÂå
, 
chunk
);

3271 
buÂå
 +
chunk
;

3272 
bufsize
 -
chunk
;

3275  
bufid
;

3276 
	}
}

3278 #i‡
MW_FEATURE_IMAGES


3290 
GR_IMAGE_ID


3291 
	$GrLﬂdImageFromBuf„r
(*
buf„r
, 
size
, 
Êags
)

3293 
nxLﬂdImageFromBuf„rReq
 *
ªq
;

3294 
bufid
;

3295 
GR_IMAGE_ID
 
imageid
;

3297 
	`LOCK
(&
nxGlobÆLock
);

3299 
bufid
 = 
	`£ndImageBuf„r
(
buf„r
, 
size
);

3301 i‡(!
bufid
) {

3302 
	`UNLOCK
(&
nxGlobÆLock
);

3308 
ªq
 = 
	`AŒocReq
(
LﬂdImageFromBuf„r
);

3309 
ªq
->
Êags
 = flags;

3310 
ªq
->
buf„r
 = 
bufid
;

3312 i‡(
	`Ty≥dRódBlock
(&
imageid
, (imageid),

3313 
GrNumLﬂdImageFromBuf„r
) == -1)

3314 
imageid
 = 0;

3315 
	`UNLOCK
(&
nxGlobÆLock
);

3316  
imageid
;

3317 
	}
}

3320 #i‡
MW_FEATURE_IMAGES


3339 
	$GrDøwImageFromBuf„r
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

3340 
GR_SIZE
 
width
, GR_SIZE 
height
, *
buf„r
, 
size
, 
Êags
)

3342 
nxDøwImageFromBuf„rReq
 *
ªq
;

3343 
bufid
;

3345 
	`LOCK
(&
nxGlobÆLock
);

3347 
bufid
 = 
	`£ndImageBuf„r
(
buf„r
, 
size
);

3349 i‡(!
bufid
) {

3350 
	`UNLOCK
(&
nxGlobÆLock
);

3356 
ªq
 = 
	`AŒocReq
(
DøwImageFromBuf„r
);

3357 
ªq
->
Êags
 = flags;

3358 
ªq
->
døwid
 = 
id
;

3359 
ªq
->
gcid
 = 
gc
;

3360 
ªq
->
x
 = x;

3361 
ªq
->
y
 = y;

3362 
ªq
->
width
 = width;

3363 
ªq
->
height
 = height;

3364 
ªq
->
Êags
 = flags;

3365 
ªq
->
buf„r
 = 
bufid
;

3366 
	`UNLOCK
(&
nxGlobÆLock
);

3367 
	}
}

3411 
	$GrAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

3412 
GR_SIZE
 
height
, *
pixñs
, 
pixty≥
)

3414 
nxAªaReq
 *
ªq
;

3415 
size
;

3416 
chunk_y
;

3417 
pixsize
;

3420 
pixty≥
) {

3421 
MWPF_RGB
:

3422 
pixsize
 = (
MWCOLORVAL
);

3424 
MWPF_PIXELVAL
:

3425 
pixsize
 = (
MWPIXELVAL
);

3427 
MWPF_PALETTE
:

3428 
MWPF_TRUECOLOR332
:

3429 
pixsize
 = ();

3431 
MWPF_TRUECOLOR0888
:

3432 
pixsize
 = ();

3434 
MWPF_TRUECOLOR888
:

3435 
pixsize
 = 3;

3437 
MWPF_TRUECOLOR565
:

3438 
MWPF_TRUECOLOR555
:

3439 
pixsize
 = ();

3445 
	`LOCK
(&
nxGlobÆLock
);

3447 
height
 > 0) {

3448 
chunk_y
 = (
MAXREQUESTSZ
 - (
nxAªaReq
)) /

3449 (()
width
 * 
pixsize
);

3450 if(
chunk_y
 > 
height
)

3451 
chunk_y
 = 
height
;

3452 
size
 = 
chunk_y
 * (()
width
 * 
pixsize
);

3453 
ªq
 = 
	`AŒocReqExåa
(
Aªa
, 
size
);

3454 
ªq
->
døwid
 = 
id
;

3455 
ªq
->
gcid
 = 
gc
;

3456 
ªq
->
x
 = x;

3457 
ªq
->
y
 = y;

3458 
ªq
->
width
 = width;

3459 
ªq
->
height
 = 
chunk_y
;

3460 
ªq
->
pixty≥
 =Öixtype;

3461 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
pixñs
, 
size
);

3462 
pixñs
 = (*)(((*ÌixñsË+ 
size
);

3463 
y
 +
chunk_y
;

3464 
height
 -
chunk_y
;

3466 
	`UNLOCK
(&
nxGlobÆLock
);

3467 
	}
}

3488 
	$GrC›yAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

3489 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_DRAW_ID
 
§cid
,

3490 
GR_COORD
 
§cx
, GR_COORD 
§cy
, 
›
)

3492 
nxC›yAªaReq
 *
ªq
;

3494 
	`LOCK
(&
nxGlobÆLock
);

3495 
ªq
 = 
	`AŒocReq
(
C›yAªa
);

3496 
ªq
->
døwid
 = 
id
;

3497 
ªq
->
gcid
 = 
gc
;

3498 
ªq
->
x
 = x;

3499 
ªq
->
y
 = y;

3500 
ªq
->
width
 = width;

3501 
ªq
->
height
 = height;

3502 
ªq
->
§cid
 = srcid;

3503 
ªq
->
§cx
 = srcx;

3504 
ªq
->
§cy
 = srcy;

3505 
ªq
->
›
 = op;

3506 
	`UNLOCK
(&
nxGlobÆLock
);

3507 
	}
}

3527 
	$GrRódAªa
(
GR_DRAW_ID
 
id
,
GR_COORD
 
x
,GR_COORD 
y
,
GR_SIZE
 
width
,

3528 
GR_SIZE
 
height
, 
GR_PIXELVAL
 *
pixñs
)

3530 
nxRódAªaReq
 *
ªq
;

3531 
size
;

3533 
	`LOCK
(&
nxGlobÆLock
);

3534 
ªq
 = 
	`AŒocReq
(
RódAªa
);

3535 
ªq
->
døwid
 = 
id
;

3536 
ªq
->
x
 = x;

3537 
ªq
->
y
 = y;

3538 
ªq
->
width
 = width;

3539 
ªq
->
height
 = height;

3540 
size
 = ()
width
 * 
height
 * (
MWPIXELVAL
);

3541 
	`Ty≥dRódBlock
(
pixñs
, 
size
, 
GrNumRódAªa
);

3542 
	`UNLOCK
(&
nxGlobÆLock
);

3543 
	}
}

3557 
	$GrPoöt
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
)

3559 
nxPoötReq
 *
ªq
;

3561 
	`LOCK
(&
nxGlobÆLock
);

3562 
ªq
 = 
	`AŒocReq
(
Poöt
);

3563 
ªq
->
døwid
 = 
id
;

3564 
ªq
->
gcid
 = 
gc
;

3565 
ªq
->
x
 = x;

3566 
ªq
->
y
 = y;

3567 
	`UNLOCK
(&
nxGlobÆLock
);

3568 
	}
}

3582 
	$GrPoöts
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöâabÀ
)

3584 
nxPoötsReq
 *
ªq
;

3585 
size
;

3587 
size
 = ()
cou¡
 * (
GR_POINT
);

3588 
	`LOCK
(&
nxGlobÆLock
);

3589 
ªq
 = 
	`AŒocReqExåa
(
Poöts
, 
size
);

3590 
ªq
->
døwid
 = 
id
;

3591 
ªq
->
gcid
 = 
gc
;

3592 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
poöâabÀ
, 
size
);

3593 
	`UNLOCK
(&
nxGlobÆLock
);

3594 
	}
}

3610 
	$GrPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöâabÀ
)

3612 
nxPﬁyReq
 *
ªq
;

3613 
size
;

3615 
	`LOCK
(&
nxGlobÆLock
);

3616 
size
 = ()
cou¡
 * (
GR_POINT
);

3617 
ªq
 = 
	`AŒocReqExåa
(
Pﬁy
, 
size
);

3618 
ªq
->
døwid
 = 
id
;

3619 
ªq
->
gcid
 = 
gc
;

3620 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
poöâabÀ
, 
size
);

3621 
	`UNLOCK
(&
nxGlobÆLock
);

3622 
	}
}

3638 
	$GrFûlPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
,
GR_POINT
 *
poöâabÀ
)

3640 
nxFûlPﬁyReq
 *
ªq
;

3641 
size
;

3643 
	`LOCK
(&
nxGlobÆLock
);

3644 
size
 = ()
cou¡
 * (
GR_POINT
);

3645 
ªq
 = 
	`AŒocReqExåa
(
FûlPﬁy
, 
size
);

3646 
ªq
->
døwid
 = 
id
;

3647 
ªq
->
gcid
 = 
gc
;

3648 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
poöâabÀ
, 
size
);

3649 
	`UNLOCK
(&
nxGlobÆLock
);

3650 
	}
}

3668 
	$GrText
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, *
°r
,

3669 
GR_COUNT
 
cou¡
, 
GR_TEXTFLAGS
 
Êags
)

3671 
nxTextReq
 *
ªq
;

3672 
size
;

3675 if(
cou¡
 =-1 && (
Êags
&
MWTF_PACKMASK
Ë=
MWTF_ASCII
)

3676 
cou¡
 = 
	`°æí
((*)
°r
);

3678 
size
 = 
	`nxCÆcSåögByãs
(
°r
, 
cou¡
, 
Êags
);

3680 
	`LOCK
(&
nxGlobÆLock
);

3681 
ªq
 = 
	`AŒocReqExåa
(
Text
, 
size
);

3682 
ªq
->
døwid
 = 
id
;

3683 
ªq
->
gcid
 = 
gc
;

3684 
ªq
->
x
 = x;

3685 
ªq
->
y
 = y;

3686 
ªq
->
cou¡
 = count;

3687 
ªq
->
Êags
 = flags;

3688 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
°r
, 
size
);

3689 
	`UNLOCK
(&
nxGlobÆLock
);

3690 
	}
}

3702 
	$GrGëSy°emPÆëã
(
GR_PALETTE
 *
∑l
)

3704 
	`LOCK
(&
nxGlobÆLock
);

3705 
	`AŒocReq
(
GëSy°emPÆëã
);

3706 
	`Ty≥dRódBlock
(
∑l
, (*∑l), 
GrNumGëSy°emPÆëã
);

3707 
	`UNLOCK
(&
nxGlobÆLock
);

3708 
	}
}

3720 
	$GrSëSy°emPÆëã
(
GR_COUNT
 
fú°
, 
GR_PALETTE
 *
∑l
)

3722 
nxSëSy°emPÆëãReq
 *
ªq
;

3724 
	`LOCK
(&
nxGlobÆLock
);

3725 
ªq
 = 
	`AŒocReq
(
SëSy°emPÆëã
);

3726 
ªq
->
fú°
 = first;

3727 
ªq
->
cou¡
 = 
∑l
->count;

3728 
	`mem˝y
(
ªq
->
∑Àâe
, 
∑l
->∑Àâe, (
GR_PALENTRY
Ë*ÖÆ->
cou¡
);

3729 
	`UNLOCK
(&
nxGlobÆLock
);

3730 
	}
}

3743 
	$GrFödCﬁ‹
(
GR_COLOR
 
c
, 
GR_PIXELVAL
 *
ªçixñ
)

3745 
nxFödCﬁ‹Req
 *
ªq
;

3747 
	`LOCK
(&
nxGlobÆLock
);

3748 
ªq
 = 
	`AŒocReq
(
FödCﬁ‹
);

3749 
ªq
->
cﬁ‹
 = 
c
;

3750 
	`Ty≥dRódBlock
(
ªçixñ
, (*ªçixñ), 
GrNumFödCﬁ‹
);

3751 
	`UNLOCK
(&
nxGlobÆLock
);

3752 
	}
}

3772 
	$GrReqShmCmds
(
shmsize
)

3774 #i‡
HAVE_SHAREDMEM_SUPPORT


3775 
nxReqShmCmdsReq
 
ªq
;

3776 
key
, 
shmid
;

3778 i‡(
nxSh¨edMem
 != 0)

3781 
	`LOCK
(&
nxGlobÆLock
);

3782 
	`GrFlush
();

3784 
shmsize
 = (shmsize+
SHM_BLOCK_SIZE
-1) & ~(SHM_BLOCK_SIZE-1);

3785 
ªq
.
ªqTy≥
 = 
GrNumReqShmCmds
;

3786 
ªq
.
hûígth
 = 0;

3787 
ªq
.
Àngth
 = (req);

3788 
ªq
.
size
 = 
shmsize
;

3790 
	`nxWrôeSockë
((*)&
ªq
,(req));

3791 
	`RódBlock
(&
key
,(key));

3793 i‡(!
key
) {

3794 
	`EPRINTF
("nxclient:Ço shared memory support on server\n");

3795 
	`UNLOCK
(&
nxGlobÆLock
);

3799 
shmid
 = 
	`shmgë
(
key
, 
shmsize
, 0);

3800 i‡(
shmid
 == -1) {

3801 
	`EPRINTF
("nx˛õ¡: C™'àshmgë key %d: %m\n", 
key
);

3802 
	`UNLOCK
(&
nxGlobÆLock
);

3806 
nxSh¨edMem
 = 
	`shm©
(
shmid
, 0, 0);

3807 
	`shm˘l
(
shmid
,
IPC_RMID
,0);

3808 i‡(
nxSh¨edMem
 == (*)-1) {

3809 
	`UNLOCK
(&
nxGlobÆLock
);

3813 
nxSh¨edMemSize
 = 
shmsize
;

3814 
	`nxAssignReqbuf„r
(
nxSh¨edMem
, 
shmsize
);

3815 
	`UNLOCK
(&
nxGlobÆLock
);

3817 
	}
}

3833 
	$GrInje˘PoöãrEvít
(
GR_COORD
 
x
, GR_COORD 
y
, 
buâ⁄
, 
visibÀ
)

3835 
nxInje˘EvítReq
 *
ªq
;

3837 
	`LOCK
(&
nxGlobÆLock
);

3838 
ªq
 = 
	`AŒocReq
(
Inje˘Evít
);

3839 
ªq
->
evít_ty≥
 = 
GR_INJECT_EVENT_POINTER
;

3840 
ªq
->
evít
.
poöãr
.
visibÀ
 = visible;

3841 
ªq
->
evít
.
poöãr
.
x
 = x;

3842 
ªq
->
evít
.
poöãr
.
y
 = y;

3843 
ªq
->
evít
.
poöãr
.
buâ⁄
 = button;

3845 
	`GrFlush
();

3846 
	`UNLOCK
(&
nxGlobÆLock
);

3847 
	}
}

3864 
	$GrInje˘KeybﬂrdEvít
(
GR_WINDOW_ID
 
wid
, 
GR_KEY
 
keyvÆue
,

3865 
GR_KEYMOD
 
modifõrs
, 
GR_SCANCODE
 
sˇncode
, 
GR_BOOL
 
¥es£d
)

3867 
nxInje˘EvítReq
 *
ªq
;

3869 
	`LOCK
(&
nxGlobÆLock
);

3870 
ªq
 = 
	`AŒocReq
(
Inje˘Evít
);

3871 
ªq
->
evít_ty≥
 = 
GR_INJECT_EVENT_KEYBOARD
;

3872 
ªq
->
evít
.
keybﬂrd
.
wid
 = wid;

3873 
ªq
->
evít
.
keybﬂrd
.
keyvÆue
 = keyvalue;

3874 
ªq
->
evít
.
keybﬂrd
.
modifõr
 = 
modifõrs
;

3875 
ªq
->
evít
.
keybﬂrd
.
sˇncode
 = scancode;

3876 
ªq
->
evít
.
keybﬂrd
.
¥es£d
 =Öressed;

3878 
	`GrFlush
();

3879 
	`UNLOCK
(&
nxGlobÆLock
);

3880 
	}
}

3892 
	$GrSëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
)

3894 
nxSëWMPr›îtõsReq
 *
ªq
;

3895 *
addr
;

3896 
s
;

3898 i‡((
¥›s
->
Êags
 & 
GR_WM_FLAGS_TITLE
Ë&&Ör›s->
tôÀ
)

3899 
s
 = 
	`°æí
(
¥›s
->
tôÀ
) + 1;

3900 
s
 = 0;

3902 
	`LOCK
(&
nxGlobÆLock
);

3903 
ªq
 = 
	`AŒocReqExåa
(
SëWMPr›îtõs
, 
s
 + (
GR_WM_PROPERTIES
));

3904 
ªq
->
wödowid
 = 
wid
;

3905 
addr
 = 
	`GëReqD©a
(
ªq
);

3906 
	`mem˝y
(
addr
, 
¥›s
, (
GR_WM_PROPERTIES
));

3907 i‡(
s
)

3908 
	`mem˝y
(
addr
 + (
GR_WM_PROPERTIES
), 
¥›s
->
tôÀ
, 
s
);

3909 
	`UNLOCK
(&
nxGlobÆLock
);

3910 
	}
}

3924 
	$GrGëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
)

3926 
nxGëWMPr›îtõsReq
 *
ªq
;

3927 
UINT16
 
ãxéí
;

3928 
GR_CHAR
 
c
;

3930 
	`LOCK
(&
nxGlobÆLock
);

3931 
ªq
 = 
	`AŒocReq
(
GëWMPr›îtõs
);

3932 
ªq
->
wödowid
 = 
wid
;

3934 
	`Ty≥dRódBlock
(
¥›s
, (
GR_WM_PROPERTIES
), 
GrNumGëWMPr›îtõs
);

3935 
	`RódBlock
(&
ãxéí
, (textlen));

3936 if(!
ãxéí
) {

3937 
¥›s
->
tôÀ
 = 
NULL
;

3938 
	`UNLOCK
(&
nxGlobÆLock
);

3941 if(!(
¥›s
->
tôÀ
 = 
	`mÆloc
(
ãxéí
))) {

3944 
ãxéí
--)

3945 
	`RódBlock
(&
c
, 1);

3947 
	`RódBlock
(
¥›s
->
tôÀ
, 
ãxéí
);

3949 
	`UNLOCK
(&
nxGlobÆLock
);

3950 
	}
}

3963 
	$GrClo£Wödow
(
GR_WINDOW_ID
 
wid
)

3965 
nxClo£WödowReq
 *
ªq
;

3967 
	`LOCK
(&
nxGlobÆLock
);

3968 
ªq
 = 
	`AŒocReq
(
Clo£Wödow
);

3969 
ªq
->
wödowid
 = 
wid
;

3970 
	`UNLOCK
(&
nxGlobÆLock
);

3971 
	}
}

3983 
	$GrKûlWödow
(
GR_WINDOW_ID
 
wid
)

3985 
nxKûlWödowReq
 *
ªq
;

3987 
	`LOCK
(&
nxGlobÆLock
);

3988 
ªq
 = 
	`AŒocReq
(
KûlWödow
);

3989 
ªq
->
wödowid
 = 
wid
;

3990 
	`UNLOCK
(&
nxGlobÆLock
);

3991 
	}
}

4004 
	$GrSëS¸ìnSavîTimeout
(
GR_TIMEOUT
 
timeout
)

4006 
nxSëS¸ìnSavîTimeoutReq
 *
ªq
;

4008 
	`LOCK
(&
nxGlobÆLock
);

4009 
ªq
 = 
	`AŒocReq
(
SëS¸ìnSavîTimeout
);

4010 
ªq
->
timeout
 =Åimeout;

4011 
	`UNLOCK
(&
nxGlobÆLock
);

4012 
	}
}

4033 
	$GrSëSñe˘i⁄Ow√r
(
GR_WINDOW_ID
 
wid
, 
GR_CHAR
 *
ty≥li°
)

4035 
nxSëSñe˘i⁄Ow√rReq
 *
ªq
;

4036 *
p
;

4037 
Àn
;

4039 
	`LOCK
(&
nxGlobÆLock
);

4040 if(
wid
) {

4041 
Àn
 = 
	`°æí
(
ty≥li°
) + 1;

4042 
ªq
 = 
	`AŒocReqExåa
(
SëSñe˘i⁄Ow√r
, 
Àn
);

4043 
p
 = 
	`GëReqD©a
(
ªq
);

4044 
	`mem˝y
(
p
, 
ty≥li°
, 
Àn
);

4046 
ªq
 = 
	`AŒocReq
(
SëSñe˘i⁄Ow√r
);

4049 
ªq
->
wid
 = wid;

4050 
	`UNLOCK
(&
nxGlobÆLock
);

4051 
	}
}

4068 
GR_WINDOW_ID


4069 
	$GrGëSñe˘i⁄Ow√r
(
GR_CHAR
 **
ty≥li°
)

4071 
nxGëSñe˘i⁄Ow√rReq
 *
ªq
;

4072 
UINT16
 
ãxéí
;

4073 
GR_CHAR
 
c
;

4074 
GR_WINDOW_ID
 
wid
;

4076 
	`LOCK
(&
nxGlobÆLock
);

4077 
ªq
 = 
	`AŒocReq
(
GëSñe˘i⁄Ow√r
);

4078 
	`Ty≥dRódBlock
(&
wid
, (wid), 
GrNumGëSñe˘i⁄Ow√r
);

4079 if(
wid
) {

4080 
	`RódBlock
(&
ãxéí
, (textlen));

4081 if(!(*
ty≥li°
 = 
	`mÆloc
(
ãxéí
))) {

4084 
ãxéí
--)

4085 
	`RódBlock
(&
c
, 1);

4087 
	`RódBlock
(*
ty≥li°
, 
ãxéí
);

4091 
	`UNLOCK
(&
nxGlobÆLock
);

4092  
wid
;

4093 
	}
}

4118 
	$GrReque°Clõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
, 
GR_SERIALNO
 
£rül
,

4119 
GR_MIMETYPE
 
mimëy≥
)

4121 
nxReque°Clõ¡D©aReq
 *
ªq
;

4123 
	`LOCK
(&
nxGlobÆLock
);

4124 
ªq
 = 
	`AŒocReq
(
Reque°Clõ¡D©a
);

4125 
ªq
->
wid
 = wid;

4126 
ªq
->
rid
 =Ñid;

4127 
ªq
->
£rül
 = serial;

4128 
ªq
->
mimëy≥
 = mimetype;

4129 
	`UNLOCK
(&
nxGlobÆLock
);

4130 
	}
}

4152 
	$GrSídClõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
did
, 
GR_SERIALNO
 
£rül
,

4153 
GR_LENGTH
 
Àn
, GR_LENGTH 
thi¶í
, *
d©a
)

4155 
nxSídClõ¡D©aReq
 *
ªq
;

4156 *
p
;

4157 
GR_LENGTH
 
l
, 
pos
 = 0;

4159 
	`LOCK
(&
nxGlobÆLock
);

4160 
pos
 < 
Àn
) {

4161 
l
 = 
MAXREQUESTSZ
 - (
nxSídClõ¡D©aReq
);

4162 if(
l
 > (
Àn
 - 
pos
))Ü =Üen -Öos;

4163 
ªq
 = 
	`AŒocReqExåa
(
SídClõ¡D©a
, 
l
);

4164 
ªq
->
wid
 = wid;

4165 
ªq
->
did
 = did;

4166 
ªq
->
£rül
 = serial;

4167 
ªq
->
Àn
 =Üen;

4168 
p
 = 
	`GëReqD©a
(
ªq
);

4169 
	`mem˝y
(
p
, ((*)
d©a
 + 
pos
), 
l
);

4170 
pos
 +
l
;

4172 
	`UNLOCK
(&
nxGlobÆLock
);

4173 
	}
}

4183 
	$GrBñl
()

4185 
	`LOCK
(&
nxGlobÆLock
);

4186 
	`AŒocReq
(
Bñl
);

4187 
	`UNLOCK
(&
nxGlobÆLock
);

4188 
	}
}

4204 
	$GrSëBackgroundPixm≠
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pixm≠
, 
Êags
)

4206 
nxSëBackgroundPixm≠Req
 *
ªq
;

4208 
	`LOCK
(&
nxGlobÆLock
);

4209 
ªq
 = 
	`AŒocReq
(
SëBackgroundPixm≠
);

4210 
ªq
->
wid
 = wid;

4211 
ªq
->
pixm≠
 =Öixmap;

4212 
ªq
->
Êags
 = flags;

4213 
	`UNLOCK
(&
nxGlobÆLock
);

4214 
	}
}

4225 
	$GrDe°royCurs‹
(
GR_CURSOR_ID
 
cid
)

4227 
nxDe°royCurs‹Req
 *
ªq
;

4229 
	`LOCK
(&
nxGlobÆLock
);

4230 
ªq
 = 
	`AŒocReq
(
De°royCurs‹
);

4231 
ªq
->
curs‹id
 = 
cid
;

4232 
	`UNLOCK
(&
nxGlobÆLock
);

4233 
	}
}

4247 
	$GrQuîyTªe
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID *
∑ª¡id
, GR_WINDOW_ID **
chûdªn
,

4248 
GR_COUNT
 *
nchûdªn
)

4250 
nxQuîyTªeReq
 *
ªq
;

4251 
GR_COUNT
 
cou¡
;

4252 
GR_WINDOW_ID
 
dummy
;

4254 
	`LOCK
(&
nxGlobÆLock
);

4255 
ªq
 = 
	`AŒocReq
(
QuîyTªe
);

4256 
ªq
->
wödowid
 = 
wid
;

4258 
	`Ty≥dRódBlock
(
∑ª¡id
, (*∑ª¡id), 
GrNumQuîyTªe
);

4259 
	`RódBlock
(
nchûdªn
, (*nchildren));

4260 i‡(!*
nchûdªn
) {

4261 *
chûdªn
 = 
NULL
;

4262 
	`UNLOCK
(&
nxGlobÆLock
);

4265 
cou¡
 = *
nchûdªn
;

4266 if(!(*
chûdªn
 = 
	`mÆloc
(
cou¡
 * (
GR_WINDOW_ID
)))) {

4269 
cou¡
--)

4270 
	`RódBlock
(&
dummy
, (
GR_WINDOW_ID
));

4272 
	`RódBlock
(*
chûdªn
, 
cou¡
 * (
GR_WINDOW_ID
));

4274 
	`UNLOCK
(&
nxGlobÆLock
);

4275 
	}
}

4277 #i‡
YOU_WANT_TO_IMPLEMENT_DRAG_AND_DROP


4300 
	$GrRegi°îDøgAndDr›Wödow
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
iid
, 
GR_CHAR
 *
ty≥li°
)

4302 
	}
}

4306 #i‡
MW_FEATURE_TIMERS


4318 
GR_TIMER_ID


4319 
	$GrCª©eTimî
 (
GR_WINDOW_ID
 
wid
, 
GR_TIMEOUT
 
≥riod
)

4321 
nxCª©eTimîReq
 *
ªq
;

4322 
GR_TIMER_ID
 
timîid
;

4324 
	`LOCK
(&
nxGlobÆLock
);

4325 
ªq
 = 
	`AŒocReq
(
Cª©eTimî
);

4326 
ªq
->
wid
 = wid;

4327 
ªq
->
≥riod
 =Öeriod;

4329 if(
	`Ty≥dRódBlock
(&
timîid
,  (timîid), 
GrNumCª©eTimî
) == -1)

4330 
timîid
 = 0;

4331 
	`UNLOCK
(&
nxGlobÆLock
);

4332  
timîid
;

4333 
	}
}

4336 #i‡
MW_FEATURE_TIMERS


4347 
	$GrDe°royTimî
 (
GR_TIMER_ID
 
tid
)

4349 
nxDe°royTimîReq
 *
ªq
;

4351 
	`LOCK
(&
nxGlobÆLock
);

4352 
ªq
 = 
	`AŒocReq
(
De°royTimî
);

4353 
ªq
->
timîid
 = 
tid
;

4354 
	`UNLOCK
(&
nxGlobÆLock
);

4355 
	}
}

4366 
	$GrSëP‹åaôMode
(
p‹åaômode
)

4368 
nxSëP‹åaôModeReq
 *
ªq
;

4370 
	`LOCK
(&
nxGlobÆLock
);

4371 
ªq
 = 
	`AŒocReq
(
SëP‹åaôMode
);

4372 
ªq
->
p‹åaômode
 =Öortraitmode;

4373 
	`UNLOCK
(&
nxGlobÆLock
);

4374 
	}
}

4387 
	$GrQuîyPoöãr
(
GR_WINDOW_ID
 *
mwö
, 
GR_COORD
 *
x
, GR_COORD *
y
, 
GR_BUTTON
 *
bmask
)

4389 
nxQuîyPoöãrReq
 *
ªq
;

4391 
	`LOCK
(&
nxGlobÆLock
);

4392 
ªq
 = 
	`AŒocReq
(
QuîyPoöãr
);

4393 
	`Ty≥dRódBlock
(
mwö
, (*mwö), 
GrNumQuîyPoöãr
);

4394 
	`RódBlock
(
x
, (*x));

4395 
	`RódBlock
(
y
, (*y));

4396 
	`RódBlock
(
bmask
, (*bmask));

4397 
	`UNLOCK
(&
nxGlobÆLock
);

4398 
	}
}

4408 
	$GrQueueLígth
()

4410 
cou¡
 = 0;

4411 
EVENT_LIST
 *
p
;

4413 
	`ACCESS_PER_THREAD_DATA
();

4414 
	`LOCK
(&
nxGlobÆLock
);

4415 
p
 = 
evli°
;Ö;Ö =Ö->
√xt
)

4416 ++
cou¡
;

4418 
	`UNLOCK
(&
nxGlobÆLock
);

4419  
cou¡
;

4420 
	}
}

4434 
GR_REGION_ID


4435 
	$GrNewBôm≠Regi⁄
(
GR_BITMAP
 *
bôm≠
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

4437 
size
;

4438 
GR_REGION_ID
 
ªgi⁄
;

4439 
nxNewBôm≠Regi⁄Req
 * 
ªq
;

4441 
size
 = (
GR_BITMAP
Ë* 
height
 * (((
width
 - 1) / 16) + 1);

4443 
	`LOCK
(&
nxGlobÆLock
);

4444 
ªq
 = 
	`AŒocReqExåa
(
NewBôm≠Regi⁄
, 
size
);

4445 
ªq
->
width
 = width;

4446 
ªq
->
height
 = height;

4447 
	`mem˝y
(
	`GëReqD©a
(
ªq
), 
bôm≠
, 
size
);

4449 if(
	`Ty≥dRódBlock
(&
ªgi⁄
, ‘egi⁄), 
GrNumNewBôm≠Regi⁄
) < 0)

4450 
ªgi⁄
 = 0;

4451 
	`UNLOCK
(&
nxGlobÆLock
);

4452  
ªgi⁄
;

4453 
	}
}

4491 
	$GrSëWödowRegi⁄
(
GR_WINDOW_ID
 
wid
, 
GR_REGION_ID
 
rid
, 
ty≥
)

4493 
nxSëWödowRegi⁄Req
 *
ªq
;

4495 
	`LOCK
(&
nxGlobÆLock
);

4496 
ªq
 = 
	`AŒocReq
(
SëWödowRegi⁄
);

4497 
ªq
->
wid
 = wid;

4498 
ªq
->
rid
 =Ñid;

4499 
ªq
->
ty≥
 =Åype;

4500 
	`UNLOCK
(&
nxGlobÆLock
);

4501 
	}
}

4531 
	$GrSåëchAªa
(
GR_DRAW_ID
 
d°id
, 
GR_GC_ID
 
gc
,

4532 
GR_COORD
 
dx1
, GR_COORD 
dy1
,

4533 
GR_COORD
 
dx2
, GR_COORD 
dy2
,

4534 
GR_DRAW_ID
 
§cid
,

4535 
GR_COORD
 
sx1
, GR_COORD 
sy1
,

4536 
GR_COORD
 
sx2
, GR_COORD 
sy2
,

4537 
›
)

4539 
nxSåëchAªaReq
 *
ªq
;

4541 
	`LOCK
(&
nxGlobÆLock
);

4542 
ªq
 = 
	`AŒocReq
(
SåëchAªa
);

4543 
ªq
->
døwid
 = 
d°id
;

4544 
ªq
->
gcid
 = 
gc
;

4545 
ªq
->
dx1
 = dx1;

4546 
ªq
->
dy1
 = dy1;

4547 
ªq
->
dx2
 = dx2;

4548 
ªq
->
dy2
 = dy2;

4549 
ªq
->
§cid
 = srcid;

4550 
ªq
->
sx1
 = sx1;

4551 
ªq
->
sy1
 = sy1;

4552 
ªq
->
sx2
 = sx2;

4553 
ªq
->
sy2
 = sy2;

4554 
ªq
->
›
 = op;

4555 
	`UNLOCK
(&
nxGlobÆLock
);

4556 
	}
}

4588 
GR_BOOL


4589 
	$GrGøbKey
(
GR_WINDOW_ID
 
id
, 
GR_KEY
 
key
, 
ty≥
)

4591 
ªt
 = 0;

4592 
nxGøbKeyReq
 *
ªq
;

4594 i‡(()
ty≥
 > 
GR_GRAB_MAX
)

4595  
GR_FALSE
;

4597 
	`LOCK
(&
nxGlobÆLock
);

4598 
ªq
 = 
	`AŒocReq
(
GøbKey
);

4599 
ªq
->
wid
 = 
id
;

4600 
ªq
->
ty≥
 =Åype;

4601 
ªq
->
key
 = key;

4604 i‡(
	`Ty≥dRódBlock
(&
ªt
, ‘ë), 
GrNumGøbKey
) < 0)

4605 
ªt
 = -1;

4607 
	`UNLOCK
(&
nxGlobÆLock
);

4608  (
GR_BOOL
)
ªt
;

4609 
	}
}

4620 
	$GrUngøbKey
(
GR_WINDOW_ID
 
id
, 
GR_KEY
 
key
)

4622 
nxGøbKeyReq
 *
ªq
;

4624 
	`LOCK
(&
nxGlobÆLock
);

4625 
ªq
 = 
	`AŒocReq
(
GøbKey
);

4626 
ªq
->
wid
 = 
id
;

4627 
ªq
->
ty≥
 = 
GR_GRAB_MAX
 + 1;

4628 
ªq
->
key
 = key;

4629 
	`UNLOCK
(&
nxGlobÆLock
);

4630 
	}
}

4641 
	$GrSëTønsf‹m
(
GR_TRANSFORM
 *
å™s
)

4643 
nxSëTønsf‹mReq
 *
ªq
;

4645 
	`LOCK
(&
nxGlobÆLock
);

4647 
ªq
 = 
	`AŒocReq
(
SëTønsf‹m
);

4648 
ªq
->
mode
 = 
å™s
? 1: 0;

4650 i‡(
å™s
) {

4651 
ªq
->
å™s_a
 = 
å™s
->
a
;

4652 
ªq
->
å™s_b
 = 
å™s
->
b
;

4653 
ªq
->
å™s_c
 = 
å™s
->
c
;

4654 
ªq
->
å™s_d
 = 
å™s
->
d
;

4655 
ªq
->
å™s_e
 = 
å™s
->
e
;

4656 
ªq
->
å™s_f
 = 
å™s
->
f
;

4657 
ªq
->
å™s_s
 = 
å™s
->
s
;

4660 
	`UNLOCK
(&
nxGlobÆLock
);

4661 
	}
}

4663 #i‡
HAVE_FREETYPE_2_SUPPORT


4699 
GR_FONT_ID


4700 
	$GrCª©eF⁄tFromBuf„r
(c⁄° *
buf„r
, 
Àngth
,

4701 c⁄° *
f‹m©
, 
GR_COORD
 
height
)

4703 
GR_FONT_ID
 
ªsu…
;

4704 
nxCª©eF⁄tFromBuf„rReq
 *
ªq
;

4705 
bufid
;

4707 
	`LOCK
(&
nxGlobÆLock
);

4710 
bufid
 = 
	`£ndImageBuf„r
(
buf„r
, 
Àngth
);

4712 i‡(!
bufid
) {

4713 
	`UNLOCK
(&
nxGlobÆLock
);

4717 
ªq
 = 
	`AŒocReq
(
Cª©eF⁄tFromBuf„r
);

4718 
ªq
->
height
 = height;

4719 
ªq
->
buf„r_id
 = 
bufid
;

4721 i‡(
f‹m©
 =
NULL
)

4722 
f‹m©
 = "";

4724 
	`°∫˝y
(
ªq
->
f‹m©
, format, (req->format) - 1);

4725 
ªq
->
f‹m©
[(req->format) - 1] = '\0';

4727 i‡(
Ty≥dRódBlock


4728 (&
ªsu…
, ‘esu…), 
GrNumCª©eF⁄tFromBuf„r
) == -1)

4729 
ªsu…
 = 0;

4731 
	`UNLOCK
(&
nxGlobÆLock
);

4732  
ªsu…
;

4733 
	}
}

4746 
GR_FONT_ID


4747 
	$GrC›yF⁄t
(
GR_FONT_ID
 
f⁄tid
, 
GR_COORD
 
height
)

4749 
GR_FONT_ID
 
ªsu…
;

4750 
nxC›yF⁄tReq
 *
ªq
;

4752 
	`LOCK
(&
nxGlobÆLock
);

4753 
ªq
 = 
	`AŒocReq
(
C›yF⁄t
);

4754 
ªq
->
f⁄tid
 = fontid;

4755 
ªq
->
height
 = height;

4757 i‡(
	`Ty≥dRódBlock
(&
ªsu…
, ‘esu…), 
GrNumC›yF⁄t
) == -1)

4758 
ªsu…
 = 0;

4760 
	`UNLOCK
(&
nxGlobÆLock
);

4761  
ªsu…
;

4762 
	}
}

	@nanox/clientfb.c

6 
	~<°dio.h
>

7 
	~<°dlib.h
>

8 
	~<uni°d.h
>

9 #ifde‡
LINUX


10 
	~<f˙é.h
>

11 
	~<sys/io˘l.h
>

12 
	~<sys/mm™.h
>

13 
	~<asm/∑ge.h
>

14 
	~<löux/fb.h
>

16 
	~"«no-X.h
"

17 
	~"lock.h
"

19 
	#CG6_RAM
 0x70016000

	)

21 
LOCK_EXTERN
(
nxGlobÆLock
);

24 * 
	gphy•ixñs
 = 
NULL
;

25 
GR_SCREEN_INFO
 
	gsöfo
;

26 
GR_BOOL
 
	gsöfo_vÆid
 = 
GR_FALSE
;

27 #ifde‡
LINUX


28 
	g‰ame_fd
 = -1;

29 * 
	g‰ame_m≠
 = 
NULL
;

30 
	g‰ame_Àn
 = 0;

40 
	$GrO≥nClõ¡Fømebuf„r
()

42 #ifde‡
LINUX


43 
‰ame_off£t
;

44 * 
fbdev
;

45 
fb_fix_s¸ìnöfo
 
föfo
;

47 
	`LOCK
(&
nxGlobÆLock
);

50 i‡(
phy•ixñs
) {

51 
	`UNLOCK
(&
nxGlobÆLock
);

52  
phy•ixñs
;

63 
	`GrGëS¸ìnInfo
(&
söfo
);

64 
söfo_vÆid
 = 
GR_TRUE
;

65 i‡(!
söfo
.
fbdrivî
) {

66 
	`UNLOCK
(&
nxGlobÆLock
);

67  
NULL
;

73 i‡(!(
fbdev
 = 
	`gëív
("FRAMEBUFFER")))

74 
fbdev
 = "/dev/fb0";

75 
‰ame_fd
 = 
	`›í
(
fbdev
, 
O_RDWR
);

76 i‡(
‰ame_fd
 < 0) {

77 
	`¥ötf
("Can't open framebuffer device\n");

78 
	`UNLOCK
(&
nxGlobÆLock
);

79  
NULL
;

83 i‡(
	`io˘l
(
‰ame_fd
, 
FBIOGET_FSCREENINFO
, &
föfo
) < 0 ) {

84 
	`¥ötf
("Couldn't get fb hardware info\n");

85 
îr
;

89 
föfo
.
visuÆ
) {

90 
FB_VISUAL_TRUECOLOR
:

91 
FB_VISUAL_PSEUDOCOLOR
:

92 
FB_VISUAL_STATIC_PSEUDOCOLOR
:

93 
FB_VISUAL_DIRECTCOLOR
:

96 
	`¥ötf
("Unsupported fb color map\n");

97 
îr
;

101 
‰ame_off£t
 = ((()
föfo
.
smem_°¨t
) -

102 ((()
föfo
.
smem_°¨t
)&~(
PAGE_SIZE
-1)));

103 
‰ame_Àn
 = 
föfo
.
smem_Àn
 + 
‰ame_off£t
;

104 
‰ame_m≠
 = (*)
	`mm≠
(
NULL
, 
‰ame_Àn
, 
PROT_READ
|
PROT_WRITE
,

105 
MAP_SHARED
, 
‰ame_fd
,

106 #ifde‡
ARCH_LINUX_SPARC


107 
CG6_RAM
);

111 i‡(
‰ame_m≠
 == (*)-1) {

112 
	`¥ötf
("UnableÅo memory mapÅhe video hardware\n");

113 
‰ame_m≠
 = 
NULL
;

114 
îr
;

116 
phy•ixñs
 = 
‰ame_m≠
 + 
‰ame_off£t
;

117 
	`UNLOCK
(&
nxGlobÆLock
);

118  
phy•ixñs
;

120 
îr
:

121 
	`˛o£
(
‰ame_fd
);

122 
	`UNLOCK
(&
nxGlobÆLock
);

124  
NULL
;

125 
	}
}

131 
	$GrClo£Clõ¡Fømebuf„r
()

133 #ifde‡
LINUX


134 
	`LOCK
(&
nxGlobÆLock
);

135 i‡(
‰ame_fd
 >= 0) {

136 i‡(
‰ame_m≠
) {

137 
	`munm≠
(
‰ame_m≠
, 
‰ame_Àn
);

138 
‰ame_m≠
 = 
NULL
;

139 
phy•ixñs
 = 
NULL
;

141 
	`˛o£
(
‰ame_fd
);

142 
‰ame_fd
 = -1;

145 
söfo_vÆid
 = 
GR_FALSE
;

147 
	`UNLOCK
(&
nxGlobÆLock
);

149 
	}
}

161 
	$GrGëWödowFBInfo
(
GR_WINDOW_ID
 
wid
, 
GR_WINDOW_FB_INFO
 *
fböfo
)

163 
physoff£t
;

164 
x
, 
y
;

165 
GR_WINDOW_INFO
 
öfo
;

166 
œ°_p‹åaô
 = -1;

168 
	`LOCK
(&
nxGlobÆLock
);

171 i‡(!
söfo_vÆid
 || (
œ°_p‹åaô
 !
söfo
.
p‹åaô
)) {

172 
	`GrGëS¸ìnInfo
(&
söfo
);

173 
söfo_vÆid
 = 
GR_TRUE
;

175 
œ°_p‹åaô
 = 
söfo
.
p‹åaô
;

178 
	`GrGëWödowInfo
(
wid
, &
öfo
);

180 
fböfo
->
bµ
 = 
söfo
.bpp;

181 
fböfo
->
byã•p
 = (
söfo
.
bµ
+7)/8;

182 
fböfo
->
pixty≥
 = 
söfo
.pixtype;

183 
fböfo
->
p‹åaô_mode
 = 
söfo
.
p‹åaô
;

185 
fböfo
->
p‹åaô_mode
) {

186 
MWPORTRAIT_RIGHT
:

187 
MWPORTRAIT_LEFT
:

194 
fböfo
->
xªs
 = 
söfo
.
rows
;

195 
fböfo
->
yªs
 = 
söfo
.
cﬁs
;

198 
fböfo
->
xªs
 = 
söfo
.
cﬁs
;

199 
fböfo
->
yªs
 = 
söfo
.
rows
;

202 
fböfo
->
xvúåes
 = 
söfo
.
cﬁs
;

203 
fböfo
->
yvúåes
 = 
söfo
.
rows
;

204 
fböfo
->
pôch
 = fböfo->
xªs
 * fböfo->
byã•p
;

207 
x
 = 
öfo
.x;

208 
y
 = 
öfo
.y;

209 
öfo
.
∑ª¡
 != 0) {

210 
	`GrGëWödowInfo
(
öfo
.
∑ª¡
, &info);

211 
x
 +
öfo
.x;

212 
y
 +
öfo
.y;

214 
fböfo
->
x
 = x;

215 
fböfo
->
y
 = y;

218 
fböfo
->
phy•ixñs
 =Öhyspixels;

221 
physoff£t
 = 
fböfo
->
y
*fböfo->
pôch
 + fböfo->
x
*fböfo->
byã•p
;

222 
fböfo
->
wöpixñs
 = 
phy•ixñs
? (phy•ixñ†+ 
physoff£t
): 
NULL
;

224 
	`UNLOCK
(&
nxGlobÆLock
);

225 
	}
}

	@nanox/error.c

11 
	~<°dio.h
>

12 
	~<°d¨g.h
>

13 
	~<°rög.h
>

14 #i‡(
UNIX
 | 
DOS_DJGPP
)

15 
	~<uni°d.h
>

17 
	~"devi˚.h
"

19 #i‡
MW_FEATURE_GDERROR


24 
	$GdEº‹
(c⁄° *
f‹m©
, ...)

26 
va_li°
 
¨gs
;

27 
buf
[1024];

29 
	`va_°¨t
(
¨gs
, 
f‹m©
);

31 
	`v•rötf
(
buf
, 
f‹m©
, 
¨gs
);

32 #i‡!
PSP


33 
	`wrôe
(2, 
buf
, 
	`°æí
(buf));

35 
	`va_íd
(
¨gs
);

37 
	}
}

43 
	$GdEº‹NuŒ
(c⁄° *
f‹m©
, ...)

46 
	}
}

	@nanox/nxdraw.c

6 
	#MWINCLUDECOLORS


	)

7 
	~<°dio.h
>

8 
	~"«no-X.h
"

9 
	~"nxdøw.h
"

12 
	$nxPaötNCAªa
(
GR_DRAW_ID
 
id
, 
w
, 
h
, 
GR_CHAR
 *
tôÀ
, 
GR_BOOL
 
a˘ive
,

13 
GR_WM_PROPS
 
¥›s
)

15 
x
 = 0;

16 
y
 = 0;

17 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

18 
GR_RECT
 
r
;

22 i‡(
¥›s
 & 
GR_WM_PROPS_APPFRAME
) {

24 
	`nxDøw3dOut£t
(
id
, 
x
, 
y
, 
w
, 
h
);

25 
x
 +2; 
y
 +2; 
w
 -4; 
h
 -= 4;

28 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

29 
	`GrRe˘
(
id
, 
gc
, 
x
, 
y
, 
w
, 
h
);

30 
x
 +1; 
y
 +1; 
w
 -2; 
h
 -= 2;

31 } i‡(
¥›s
 & 
GR_WM_PROPS_BORDER
) {

33 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWFRAME
));

34 
	`GrRe˘
(
id
, 
gc
, 
x
, 
y
, 
w
, 
h
);

35 
x
 +1; 
y
 +1; 
w
 -2; 
h
 -= 2;

38 i‡(!(
¥›s
 & 
GR_WM_PROPS_CAPTION
))

39 
out
;

42 
	`GrSëGCF‹eground
(
gc
,

43 
	`GrGëSysCﬁ‹
(
a˘ive
? 
GR_COLOR_ACTIVECAPTION
:

44 
GR_COLOR_INACTIVECAPTION
));

45 
	`GrFûlRe˘
(
id
, 
gc
, 
x
, 
y
, 
w
, 
CYCAPTION
);

48 i‡(
tôÀ
) {

49 
	`GrSëGCF‹eground
(
gc
,

50 
	`GrGëSysCﬁ‹
(
a˘ive
? 
GR_COLOR_ACTIVECAPTIONTEXT
:

51 
GR_COLOR_INACTIVECAPTIONTEXT
));

52 
	`GrSëGCU£Background
(
gc
, 
GR_FALSE
);

57 
	`GrText
(
id
, 
gc
, 
x
+4, 
y
-1, 
tôÀ
, -1, 
GR_TFASCII
|
GR_TFTOP
);

59 
y
 +
CYCAPTION
;

62 i‡(
¥›s
 & 
GR_WM_PROPS_APPFRAME
) {

63 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

64 
	`GrLöe
(
id
, 
gc
, 
x
, 
y
, x+
w
-1, y);

67 i‡(
¥›s
 & 
GR_WM_PROPS_CLOSEBOX
) {

69 
r
.
x
 = x + 
w
 - 
CXCLOSEBOX
 - 2;

70 
r
.
y
 = y - 
CYCAPTION
 + 2;

71 
r
.
width
 = 
CXCLOSEBOX
;

72 
r
.
height
 = 
CYCLOSEBOX
;

74 
	`nxDøw3dBox
(
id
, 
r
.
x
,Ñ.
y
,Ñ.
width
,Ñ.
height
,

75 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNHIGHLIGHT
),

76 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWFRAME
));

77 
	`nxInÊ©eRe˘
(&
r
, -1, -1);

78 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

79 
	`GrFûlRe˘
(
id
, 
gc
, 
r
.
x
,Ñ.
y
,Ñ.
width
,Ñ.
height
);

81 
	`nxInÊ©eRe˘
(&
r
, -1, -1);

82 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNTEXT
));

83 
	`GrLöe
(
id
, 
gc
, 
r
.
x
,Ñ.
y
,Ñ.x+r.
width
-1,Ñ.y+r.
height
-1);

84 
	`GrLöe
(
id
, 
gc
, 
r
.
x
,Ñ.
y
+r.
height
-1,Ñ.x+r.
width
-1,Ñ.y);

89 
y
++;

90 
h
 -
CYCAPTION
+1;

91 
	`GrSëGCF‹eground
(
gc
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

92 
	`GrFûlRe˘
(
id
, 
gc
, 
x
, 
y
, 
w
, 
h
);

95 
out
:

96 
	`GrDe°royGC
(
gc
);

97 
	}
}

103 
	$nxInÊ©eRe˘
(
GR_RECT
 *
¥c
, 
GR_SIZE
 
dx
, GR_SIZE 
dy
)

105 
¥c
->
x
 -
dx
;

106 
¥c
->
y
 -
dy
;

107 
¥c
->
width
 +
dx
 * 2;

108 
¥c
->
height
 +
dy
 * 2;

109 
	}
}

124 
	$nxDøw3dShadow
(
GR_DRAW_ID
 
id
,
x
,
y
,
w
,
h
,
GR_COLOR
 
¸T›
,

125 
GR_COLOR
 
¸BŸtom
)

127 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

129 
	`GrSëGCF‹eground
(
gc
, 
¸T›
);

132 
	`GrLöe
(
id
, 
gc
, 
x
, 
y
+
h
-2, x, y);

134 
	`GrLöe
(
id
, 
gc
, 
x
, 
y
, x+
w
-2, y);

136 
	`GrSëGCF‹eground
(
gc
, 
¸BŸtom
);

139 
	`GrLöe
(
id
, 
gc
, 
x
+
w
-1, 
y
+1, x+w-1, y+
h
-2);

141 
	`GrLöe
(
id
, 
gc
, 
x
+
w
-1, 
y
+
h
-1, x, y+h-1);

143 
	`GrDe°royGC
(
gc
);

144 
	}
}

155 
	$nxDøw3dBox
(
GR_WINDOW_ID
 
id
,
x
,
y
,
w
,
h
,
GR_COLOR
 
¸T›
,

156 
GR_COLOR
 
¸BŸtom
)

158 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

160 
	`GrSëGCF‹eground
(
gc
, 
¸T›
);

163 
	`GrLöe
(
id
, 
gc
, 
x
, 
y
+
h
-2, x, y+1);

166 
	`GrLöe
(
id
, 
gc
, 
x
, 
y
, x+
w
-2, y);

168 
	`GrSëGCF‹eground
(
gc
, 
¸BŸtom
);

169 
	`GrLöe
(
id
, 
gc
, 
x
+
w
-1, 
y
, x+w-1, y+
h
-2);

172 
	`GrLöe
(
id
, 
gc
, 
x
+
w
-1, 
y
+
h
-1, x, y+h-1);

175 
	`GrDe°royGC
(
gc
);

176 
	}
}

182 
	$nxDøw3dIn£t
(
GR_DRAW_ID
 
id
,
x
,
y
,
w
,
h
)

184 
	`nxDøw3dBox
(
id
, 
x
, 
y
, 
w
, 
h
,

185 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNSHADOW
),

186 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNHIGHLIGHT
));

187 ++
x
; ++
y
; 
w
 -2; 
h
 -= 2;

188 
	`nxDøw3dBox
(
id
, 
x
, 
y
, 
w
, 
h
,

189 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWFRAME
),

190 
	`GrGëSysCﬁ‹
(
GR_COLOR_3DLIGHT
));

191 
	}
}

197 
	$nxDøw3dOut£t
(
GR_DRAW_ID
 
id
,
x
,
y
,
w
,
h
)

199 
	`nxDøw3dBox
(
id
, 
x
, 
y
, 
w
, 
h
,

200 
	`GrGëSysCﬁ‹
(
GR_COLOR_3DLIGHT
),

201 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWFRAME
));

202 ++
x
; ++
y
; 
w
 -2; 
h
 -= 2;

203 
	`nxDøw3dBox
(
id
, 
x
, 
y
, 
w
, 
h
,

204 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNHIGHLIGHT
),

205 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNSHADOW
));

206 
	}
}

212 
	$nxDøw3dPushDown
(
GR_DRAW_ID
 
id
, 
x
, 
y
, 
w
, 
h
)

214 
	`nxDøw3dBox
(
id
, 
x
, 
y
, 
w
, 
h
, 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNSHADOW
),

215 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNSHADOW
));

216 
	}
}

222 
	$nxDøw3dUpDownSèã
(
GR_DRAW_ID
 
id
, 
x
, 
y
, 
w
, 
h
, 
GR_BOOL
 
fDown
)

224 i‡(
fDown
)

225 
	`nxDøw3dPushDown
(
id
, 
x
, 
y
, 
w
, 
h
);

226 
	`nxDøw3dOut£t
(
id
, 
x
, 
y
, 
w
, 
h
);

227 
	}
}

231 
	$nxDøw3dUpFøme
(
GR_DRAW_ID
 
id
, 
l
, 
t
, 
r
, 
b
)

233 
RECT
 
rc
;

234 
HBRUSH
 
hbr
;

236 
	`SëRe˘
(&
rc
, 
l
, 
t
, 
r
, 
b
);

237 
	`nxDøw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

238 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

239 
	`GrGëSysCﬁ‹
(
GR_COLOR_3DLIGHT
),

240 
	`GrGëSysCﬁ‹
(
GR_COLOR_WINDOWFRAME
));

241 
	`nxInÊ©eRe˘
(&
rc
, -1, -1);

242 
	`nxDøw3dBox
(
hDC
, 
rc
.
À·
,Ñc.
t›
,

243 
rc
.
right
-rc.
À·
,Ñc.
bŸtom
-rc.
t›
,

244 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNHIGHLIGHT
),

245 
	`GrGëSysCﬁ‹
(
GR_COLOR_BTNSHADOW
));

246 
	`nxInÊ©eRe˘
(&
rc
, -1, -1);

248 
hbr
 = 
	`Cª©eSﬁidBrush
(
	`GrGëSysCﬁ‹
(
GR_COLOR_APPWINDOW
));

249 
	`FûlRe˘
(
hDC
, &
rc
, 
hbr
);

250 
	`DñëeObje˘
(
hbr
);

251 
	}
}

	@nanox/nxproto.c

6 
	~<°dio.h
>

7 
	~<uni°d.h
>

8 
	~<°dlib.h
>

9 
	~<as£π.h
>

10 
	~<î∫o.h
>

11 
	~<°rög.h
>

12 
	~"£rv.h
"

13 
	~"nx¥Ÿo.h
"

14 
	~"lock.h
"

16 
	#SZREQBUF
 2048

	)

18 #i‚de‡
__ECOS


19 
REQBUF
 
	gªqbuf
;

20 
nxSockë
;

21 * 
nxSh¨edMem
;

22 
LOCK_EXTERN
(
nxGlobÆLock
);

27 
	$nxAŒocReq
(
ty≥
, 
size
, 
exåa
)

29 
nxReq
 * 
ªq
;

30 
Æig√d_Àn
;

31 
	`ACCESS_PER_THREAD_DATA
();

34 if(
exåa
)

35 
	`as£π
((
size
 & ()(
ALIGNSZ
-1)) == 0);

38 
Æig√d_Àn
 = (
size
 + 
exåa
 + ()(
ALIGNSZ
-1)) & ~()(ALIGNSZ-1);

41 
	`as£π
(
Æig√d_Àn
 <
MAXREQUESTSZ
);

44 if(
ªqbuf
.
buÂå
 + 
Æig√d_Àn
 >ªqbuf.
bufmax
)

45 
	`nxFlushReq
(
Æig√d_Àn
,1);

48 
ªq
 = (
nxReq
 *)
ªqbuf
.
buÂå
;

49 
ªq
->
ªqTy≥
 = (
BYTE8
)
ty≥
;

50 
ªq
->
hûígth
 = (
BYTE8
)((
size
 + 
exåa
) >> 16);

51 
ªq
->
Àngth
 = (
UINT16
)(
size
 + 
exåa
);

52 
ªqbuf
.
buÂå
 +
Æig√d_Àn
;

53  
ªq
;

54 
	}
}

56 
	$nxAŒocReqbuf„r
(
√wsize
)

58 
	`ACCESS_PER_THREAD_DATA
();

60 if(
√wsize
 < ()
SZREQBUF
)

61 
√wsize
 = 
SZREQBUF
;

62 
ªqbuf
.
buf„r
 = 
	`mÆloc
(
√wsize
);

63 if(!
ªqbuf
.
buf„r
) {

64 
	`EPRINTF
("nxFlushReq: Can'tállocate initialÑequest buffer\n");

65 
	`exô
(1);

67 
ªqbuf
.
buÂå
 =Ñeqbuf.
buf„r
;

68 
ªqbuf
.
bufmax
 =Ñeqbuf.
buf„r
 + 
√wsize
;

69 
	}
}

72 
	$nxAssignReqbuf„r
(*
buf„r
, 
size
)

74 
	`ACCESS_PER_THREAD_DATA
();

76 i‡–
ªqbuf
.
buf„r
 != 0 )

77 
	`‰ì
(
ªqbuf
.
buf„r
);

78 
ªqbuf
.
buf„r
 = buffer;

79 
ªqbuf
.
buÂå
 =Ñeqbuf.
buf„r
;

80 
ªqbuf
.
bufmax
 =Ñeqbuf.
buf„r
 + 
size
;

81 
	}
}

85 
	$nxWrôeSockë
(*
buf
, 
todo
)

87 
wrôãn
;

88 
	`ACCESS_PER_THREAD_DATA
();

91 
wrôãn
 = 
	`wrôe
(
nxSockë
, 
buf
, 
todo
);

92 i‡–
wrôãn
 < 0 ) {

93 i‡–
î∫o
 =
EAGAIN
 ||Éºnÿ=
EINTR
 )

95 
	`EPRINTF
("nxFlushReq: write failed: %m\n");

96 
	`exô
(1);

98 
buf
 +
wrôãn
;

99 
todo
 -
wrôãn
;

100 }  
todo
 > 0 );

101 
	}
}

105 
	$nxFlushReq
(
√wsize
, 
ª∂y_√eded
)

107 
	`ACCESS_PER_THREAD_DATA
();

108 
	`LOCK
(&
nxGlobÆLock
);

111 if(
ªqbuf
.
buf„r
 =
NULL
) {

112 
	`nxAŒocReqbuf„r
(
√wsize
);

113 
	`UNLOCK
(&
nxGlobÆLock
);

118 if(
ªqbuf
.
buÂå
 >Ñeqbuf.
buf„r
) {

119 * 
buf
 = 
ªqbuf
.
buf„r
;

120 
todo
 = 
ªqbuf
.
buÂå
 -Ñeqbuf.
buf„r
;

122 #i‡
HAVE_SHAREDMEM_SUPPORT


123 i‡–
nxSh¨edMem
 != 0 ) {

151 
c
;

152 
nxShmCmdsFlushReq
 
ªq
;

154 
ªq
.
ªqTy≥
 = 
GrNumShmCmdsFlush
;

155 
ªq
.
hûígth
 = 0;

156 
ªq
.
Àngth
 = (req);

157 
ªq
.
size
 = 
todo
;

158 
ªq
.
ª∂y
 = 
ª∂y_√eded
;

160 
	`nxWrôeSockë
((*)&
ªq
,(req));

162 i‡–
ª∂y_√eded
 )

163  
	`ªad
(
nxSockë
, &
c
, 1) != 1 )

166 
ªqbuf
.
buÂå
 =Ñeqbuf.
buf„r
;

168 i‡–
ªqbuf
.
buf„r
 + 
√wsize
 >Ñeqbuf.
bufmax
 ) {

170 
	`EPRINTF
("nxFlushReq: shmÑegionÅoo small\n");

171 
	`exô
(1);

173 
	`UNLOCK
(&
nxGlobÆLock
);

179 
	`nxWrôeSockë
(
buf
,
todo
);

180 
ªqbuf
.
buÂå
 =Ñeqbuf.
buf„r
;

184 if(
ªqbuf
.
buÂå
 + 
√wsize
 >ªqbuf.
bufmax
) {

185 
ªqbuf
.
buf„r
 = 
	`GdRóŒoc
‘eqbuf.buf„r,Ñeqbuf.
bufmax
 -Ñeqbuf.buf„r, 
√wsize
);

186 if(!
ªqbuf
.
buf„r
) {

187 
	`EPRINTF
("nxFlushReq: Can'tÑeallocateÑequest buffer\n");

188 
	`exô
(1);

190 
ªqbuf
.
buÂå
 =Ñeqbuf.
buf„r
;

191 
ªqbuf
.
bufmax
 =Ñeqbuf.
buf„r
 + 
√wsize
;

193 
	`UNLOCK
(&
nxGlobÆLock
);

194 
	}
}

198 
	$nxCÆcSåögByãs
(*
°r
, 
cou¡
, 
GR_TEXTFLAGS
 
Êags
)

200 
nbyãs
;

203 if(
Êags
 & (
MWTF_UC16
|
MWTF_XCHAR2B
))

204 
nbyãs
 = 
cou¡
 * 2;

205 if(
Êags
 & 
MWTF_UC32
)

206 
nbyãs
 = 
cou¡
 * 4;

208 
nbyãs
 = 
cou¡
;

210  
nbyãs
;

211 
	}
}

	@nanox/nxproto.h

36 
	#MAXREQUESTSZ
 30000

	)

38 
	tBYTE8
;

39 
	tUINT16
;

40 
	tINT16
;

41 
	tUINT32
;

43 #i‡
ELKS


44 
UINT16
 
	tIDTYPE
;

45 
	#ALIGNSZ
 2

	)

47 
UINT32
 
	tIDTYPE
;

48 
	#ALIGNSZ
 4

	)

53 
BYTE8
 
	mªqTy≥
;

54 
BYTE8
 
	mhûígth
;

55 
UINT16
 
	mÀngth
;

56 } 
	tnxReq
;

59 
	#AŒocReq
(
«me
) \

60 ((
nx
##
«me
##
Req
 *)
	`nxAŒocReq
(
GrNum
##«me,“x##«me##Req), 0))

	)

63 
	#AŒocReqExåa
(
«me
,
n
) \

64 ((
nx
##
«me
##
Req
 *)
	`nxAŒocReq
(
GrNum
##«me,“x##«me##Req), 
n
))

	)

67 
	#GëReqD©a
(
ªq
Ë((*)((*Ïeq + (* (ªq))))

	)

71 
	#GëReqLí
(
ªq
Ë((‘eq)->
hûígth
 << 16Ë| (ªq)->
Àngth
)

	)

74 
	#GëReqV¨Lí
(
ªq
Ë(
	`GëReqLí
‘eqË- (* (ªq)))

	)

77 
	#GëReqAlig√dLí
(
ªq
Ë((
	`GëReqLí
‘eqË+ (
ALIGNSZ
-1)Ë& ~(ALIGNSZ-1))

	)

79 * 
nxAŒocReq
(
ty≥
, 
size
, 
exåa
);

80 
nxFlushReq
(
√wsize
, 
ª∂y_√eded
);

81 
nxAssignReqbuf„r
(*
buf„r
, 
size
);

82 
nxWrôeSockë
(*
buf
, 
todo
);

83 
nxCÆcSåögByãs
(*
°r
, 
cou¡
, 
GR_TEXTFLAGS
 
Êags
);

85 #i‡
nŸyë


88 
BYTE8
 
	mªpTy≥
;

89 
BYTE8
 
	mhûígth
;

90 
UINT16
 
	mÀngth
;

91 } 
	tnxRïly
;

94 
	#GrNumEº‹Rïly
 255

	)

95 
	#GrNumEvítRïly
 254

	)

98 
	#GrNumO≥n
 0

	)

100 
BYTE8
 
	mªqTy≥
;

101 
BYTE8
 
	mhûígth
;

102 
UINT16
 
	mÀngth
;

103 
UINT32
 
	mpid
;

104 } 
	tnxO≥nReq
;

106 
	#GrNumClo£
 1

	)

108 
BYTE8
 
	mªqTy≥
;

109 
BYTE8
 
	mhûígth
;

110 
UINT16
 
	mÀngth
;

111 } 
	tnxClo£Req
;

113 
	#GrNumGëS¸ìnInfo
 2

	)

115 
BYTE8
 
	mªqTy≥
;

116 
BYTE8
 
	mhûígth
;

117 
UINT16
 
	mÀngth
;

118 } 
	tnxGëS¸ìnInfoReq
;

120 
	#GrNumNewWödow
 3

	)

122 
BYTE8
 
	mªqTy≥
;

123 
BYTE8
 
	mhûígth
;

124 
UINT16
 
	mÀngth
;

125 
IDTYPE
 
	m∑ª¡id
;

126 
INT16
 
	mx
;

127 
INT16
 
	my
;

128 
INT16
 
	mwidth
;

129 
INT16
 
	mheight
;

130 
UINT32
 
	mbackgroundcﬁ‹
;

131 
UINT32
 
	mb‹dîcﬁ‹
;

132 
INT16
 
	mb‹dîsize
;

133 } 
	tnxNewWödowReq
;

135 
	#GrNumNewI≈utWödow
 4

	)

137 
BYTE8
 
	mªqTy≥
;

138 
BYTE8
 
	mhûígth
;

139 
UINT16
 
	mÀngth
;

140 
IDTYPE
 
	m∑ª¡id
;

141 
INT16
 
	mx
;

142 
INT16
 
	my
;

143 
INT16
 
	mwidth
;

144 
INT16
 
	mheight
;

145 } 
	tnxNewI≈utWödowReq
;

147 
	#GrNumDe°royWödow
 5

	)

149 
BYTE8
 
	mªqTy≥
;

150 
BYTE8
 
	mhûígth
;

151 
UINT16
 
	mÀngth
;

152 
IDTYPE
 
	mwödowid
;

153 } 
	tnxDe°royWödowReq
;

155 
	#GrNumNewGC
 6

	)

157 
BYTE8
 
	mªqTy≥
;

158 
BYTE8
 
	mhûígth
;

159 
UINT16
 
	mÀngth
;

160 } 
	tnxNewGCReq
;

162 
	#GrNumC›yGC
 7

	)

164 
BYTE8
 
	mªqTy≥
;

165 
BYTE8
 
	mhûígth
;

166 
UINT16
 
	mÀngth
;

167 
IDTYPE
 
	mgcid
;

168 } 
	tnxC›yGCReq
;

170 
	#GrNumGëGCInfo
 8

	)

172 
BYTE8
 
	mªqTy≥
;

173 
BYTE8
 
	mhûígth
;

174 
UINT16
 
	mÀngth
;

175 
IDTYPE
 
	mgcid
;

176 } 
	tnxGëGCInfoReq
;

178 
	#GrNumDe°royGC
 9

	)

180 
BYTE8
 
	mªqTy≥
;

181 
BYTE8
 
	mhûígth
;

182 
UINT16
 
	mÀngth
;

183 
IDTYPE
 
	mgcid
;

184 } 
	tnxDe°royGCReq
;

186 
	#GrNumM≠Wödow
 10

	)

188 
BYTE8
 
	mªqTy≥
;

189 
BYTE8
 
	mhûígth
;

190 
UINT16
 
	mÀngth
;

191 
IDTYPE
 
	mwödowid
;

192 } 
	tnxM≠WödowReq
;

194 
	#GrNumUnm≠Wödow
 11

	)

196 
BYTE8
 
	mªqTy≥
;

197 
BYTE8
 
	mhûígth
;

198 
UINT16
 
	mÀngth
;

199 
IDTYPE
 
	mwödowid
;

200 } 
	tnxUnm≠WödowReq
;

202 
	#GrNumRai£Wödow
 12

	)

204 
BYTE8
 
	mªqTy≥
;

205 
BYTE8
 
	mhûígth
;

206 
UINT16
 
	mÀngth
;

207 
IDTYPE
 
	mwödowid
;

208 } 
	tnxRai£WödowReq
;

210 
	#GrNumLowîWödow
 13

	)

212 
BYTE8
 
	mªqTy≥
;

213 
BYTE8
 
	mhûígth
;

214 
UINT16
 
	mÀngth
;

215 
IDTYPE
 
	mwödowid
;

216 } 
	tnxLowîWödowReq
;

218 
	#GrNumMoveWödow
 14

	)

220 
BYTE8
 
	mªqTy≥
;

221 
BYTE8
 
	mhûígth
;

222 
UINT16
 
	mÀngth
;

223 
IDTYPE
 
	mwödowid
;

224 
INT16
 
	mx
;

225 
INT16
 
	my
;

226 } 
	tnxMoveWödowReq
;

228 
	#GrNumResizeWödow
 15

	)

230 
BYTE8
 
	mªqTy≥
;

231 
BYTE8
 
	mhûígth
;

232 
UINT16
 
	mÀngth
;

233 
IDTYPE
 
	mwödowid
;

234 
INT16
 
	mwidth
;

235 
INT16
 
	mheight
;

236 } 
	tnxResizeWödowReq
;

238 
	#GrNumGëWödowInfo
 16

	)

240 
BYTE8
 
	mªqTy≥
;

241 
BYTE8
 
	mhûígth
;

242 
UINT16
 
	mÀngth
;

243 
IDTYPE
 
	mwödowid
;

244 } 
	tnxGëWödowInfoReq
;

246 
	#GrNumGëF⁄tInfo
 17

	)

248 
BYTE8
 
	mªqTy≥
;

249 
BYTE8
 
	mhûígth
;

250 
UINT16
 
	mÀngth
;

251 
IDTYPE
 
	mf⁄tid
;

252 } 
	tnxGëF⁄tInfoReq
;

254 
	#GrNumSëFocus
 18

	)

256 
BYTE8
 
	mªqTy≥
;

257 
BYTE8
 
	mhûígth
;

258 
UINT16
 
	mÀngth
;

259 
IDTYPE
 
	mwödowid
;

260 } 
	tnxSëFocusReq
;

262 
	#GrNumSëWödowCurs‹
 19

	)

264 
BYTE8
 
	mªqTy≥
;

265 
BYTE8
 
	mhûígth
;

266 
UINT16
 
	mÀngth
;

267 
IDTYPE
 
	mwödowid
;

268 
IDTYPE
 
	mcurs‹id
;

269 } 
	tnxSëWödowCurs‹Req
;

271 
	#GrNumCÀ¨Aªa
 20

	)

273 
BYTE8
 
	mªqTy≥
;

274 
BYTE8
 
	mhûígth
;

275 
UINT16
 
	mÀngth
;

276 
IDTYPE
 
	mwödowid
;

277 
INT16
 
	mx
;

278 
INT16
 
	my
;

279 
INT16
 
	mwidth
;

280 
INT16
 
	mheight
;

281 
UINT16
 
	mexpo£Êag
;

282 } 
	tnxCÀ¨AªaReq
;

284 
	#GrNumSñe˘Evíts
 21

	)

286 
BYTE8
 
	mªqTy≥
;

287 
BYTE8
 
	mhûígth
;

288 
UINT16
 
	mÀngth
;

289 
IDTYPE
 
	mwödowid
;

290 
UINT32
 
	mevítmask
;

291 } 
	tnxSñe˘EvítsReq
;

293 
	#GrNumGëNextEvít
 22

	)

295 
BYTE8
 
	mªqTy≥
;

296 
BYTE8
 
	mhûígth
;

297 
UINT16
 
	mÀngth
;

298 } 
	tnxGëNextEvítReq
;

300 
	#GrNumCheckNextEvít
 23

	)

302 
BYTE8
 
	mªqTy≥
;

303 
BYTE8
 
	mhûígth
;

304 
UINT16
 
	mÀngth
;

305 } 
	tnxCheckNextEvítReq
;

307 
	#GrNumPìkEvít
 24

	)

309 
BYTE8
 
	mªqTy≥
;

310 
BYTE8
 
	mhûígth
;

311 
UINT16
 
	mÀngth
;

312 } 
	tnxPìkEvítReq
;

314 
	#GrNumLöe
 25

	)

316 
BYTE8
 
	mªqTy≥
;

317 
BYTE8
 
	mhûígth
;

318 
UINT16
 
	mÀngth
;

319 
IDTYPE
 
	mdøwid
;

320 
IDTYPE
 
	mgcid
;

321 
INT16
 
	mx1
;

322 
INT16
 
	my1
;

323 
INT16
 
	mx2
;

324 
INT16
 
	my2
;

325 } 
	tnxLöeReq
;

327 
	#GrNumPoöt
 26

	)

329 
BYTE8
 
	mªqTy≥
;

330 
BYTE8
 
	mhûígth
;

331 
UINT16
 
	mÀngth
;

332 
IDTYPE
 
	mdøwid
;

333 
IDTYPE
 
	mgcid
;

334 
INT16
 
	mx
;

335 
INT16
 
	my
;

336 } 
	tnxPoötReq
;

338 
	#GrNumRe˘
 27

	)

340 
BYTE8
 
	mªqTy≥
;

341 
BYTE8
 
	mhûígth
;

342 
UINT16
 
	mÀngth
;

343 
IDTYPE
 
	mdøwid
;

344 
IDTYPE
 
	mgcid
;

345 
INT16
 
	mx
;

346 
INT16
 
	my
;

347 
INT16
 
	mwidth
;

348 
INT16
 
	mheight
;

349 } 
	tnxRe˘Req
;

351 
	#GrNumFûlRe˘
 28

	)

353 
BYTE8
 
	mªqTy≥
;

354 
BYTE8
 
	mhûígth
;

355 
UINT16
 
	mÀngth
;

356 
IDTYPE
 
	mdøwid
;

357 
IDTYPE
 
	mgcid
;

358 
INT16
 
	mx
;

359 
INT16
 
	my
;

360 
INT16
 
	mwidth
;

361 
INT16
 
	mheight
;

362 } 
	tnxFûlRe˘Req
;

364 
	#GrNumPﬁy
 29

	)

366 
BYTE8
 
	mªqTy≥
;

367 
BYTE8
 
	mhûígth
;

368 
UINT16
 
	mÀngth
;

369 
IDTYPE
 
	mdøwid
;

370 
IDTYPE
 
	mgcid
;

372 } 
	tnxPﬁyReq
;

374 
	#GrNumFûlPﬁy
 30

	)

376 
BYTE8
 
	mªqTy≥
;

377 
BYTE8
 
	mhûígth
;

378 
UINT16
 
	mÀngth
;

379 
IDTYPE
 
	mdøwid
;

380 
IDTYPE
 
	mgcid
;

382 } 
	tnxFûlPﬁyReq
;

384 
	#GrNumEŒù£
 31

	)

386 
BYTE8
 
	mªqTy≥
;

387 
BYTE8
 
	mhûígth
;

388 
UINT16
 
	mÀngth
;

389 
IDTYPE
 
	mdøwid
;

390 
IDTYPE
 
	mgcid
;

391 
INT16
 
	mx
;

392 
INT16
 
	my
;

393 
INT16
 
	mrx
;

394 
INT16
 
	mry
;

395 } 
	tnxEŒù£Req
;

397 
	#GrNumFûlEŒù£
 32

	)

399 
BYTE8
 
	mªqTy≥
;

400 
BYTE8
 
	mhûígth
;

401 
UINT16
 
	mÀngth
;

402 
IDTYPE
 
	mdøwid
;

403 
IDTYPE
 
	mgcid
;

404 
INT16
 
	mx
;

405 
INT16
 
	my
;

406 
INT16
 
	mrx
;

407 
INT16
 
	mry
;

408 } 
	tnxFûlEŒù£Req
;

410 
	#GrNumSëGCF‹eground
 33

	)

412 
BYTE8
 
	mªqTy≥
;

413 
BYTE8
 
	mhûígth
;

414 
UINT16
 
	mÀngth
;

415 
IDTYPE
 
	mgcid
;

416 
UINT32
 
	mcﬁ‹
;

417 } 
	tnxSëGCF‹egroundReq
;

419 
	#GrNumSëGCBackground
 34

	)

421 
BYTE8
 
	mªqTy≥
;

422 
BYTE8
 
	mhûígth
;

423 
UINT16
 
	mÀngth
;

424 
IDTYPE
 
	mgcid
;

425 
UINT32
 
	mcﬁ‹
;

426 } 
	tnxSëGCBackgroundReq
;

428 
	#GrNumSëGCU£Background
 35

	)

430 
BYTE8
 
	mªqTy≥
;

431 
BYTE8
 
	mhûígth
;

432 
UINT16
 
	mÀngth
;

433 
IDTYPE
 
	mgcid
;

434 
UINT16
 
	mÊag
;

435 } 
	tnxSëGCU£BackgroundReq
;

437 
	#GrNumSëGCMode
 36

	)

439 
BYTE8
 
	mªqTy≥
;

440 
BYTE8
 
	mhûígth
;

441 
UINT16
 
	mÀngth
;

442 
IDTYPE
 
	mgcid
;

443 
UINT16
 
	mmode
;

444 } 
	tnxSëGCModeReq
;

446 
	#GrNumSëGCF⁄t
 37

	)

448 
BYTE8
 
	mªqTy≥
;

449 
BYTE8
 
	mhûígth
;

450 
UINT16
 
	mÀngth
;

451 
IDTYPE
 
	mgcid
;

452 
IDTYPE
 
	mf⁄tid
;

453 } 
	tnxSëGCF⁄tReq
;

455 
	#GrNumGëGCTextSize
 38

	)

457 
BYTE8
 
	mªqTy≥
;

458 
BYTE8
 
	mhûígth
;

459 
UINT16
 
	mÀngth
;

460 
IDTYPE
 
	mgcid
;

461 
UINT32
 
	mÊags
;

462 
UINT32
 
	mch¨cou¡
;

464 } 
	tnxGëGCTextSizeReq
;

466 
	#GrNumRódAªa
 39

	)

468 
BYTE8
 
	mªqTy≥
;

469 
BYTE8
 
	mhûígth
;

470 
UINT16
 
	mÀngth
;

471 
IDTYPE
 
	mdøwid
;

472 
INT16
 
	mx
;

473 
INT16
 
	my
;

474 
INT16
 
	mwidth
;

475 
INT16
 
	mheight
;

476 } 
	tnxRódAªaReq
;

478 
	#GrNumAªa
 40

	)

480 
BYTE8
 
	mªqTy≥
;

481 
BYTE8
 
	mhûígth
;

482 
UINT16
 
	mÀngth
;

483 
IDTYPE
 
	mdøwid
;

484 
IDTYPE
 
	mgcid
;

485 
INT16
 
	mx
;

486 
INT16
 
	my
;

487 
INT16
 
	mwidth
;

488 
INT16
 
	mheight
;

489 
INT16
 
	mpixty≥
;

490 
INT16
 
	m∑d
;

492 } 
	tnxAªaReq
;

494 
	#GrNumBôm≠
 41

	)

496 
BYTE8
 
	mªqTy≥
;

497 
BYTE8
 
	mhûígth
;

498 
UINT16
 
	mÀngth
;

499 
IDTYPE
 
	mdøwid
;

500 
IDTYPE
 
	mgcid
;

501 
INT16
 
	mx
;

502 
INT16
 
	my
;

503 
INT16
 
	mwidth
;

504 
INT16
 
	mheight
;

506 } 
	tnxBôm≠Req
;

508 
	#GrNumText
 42

	)

510 
BYTE8
 
	mªqTy≥
;

511 
BYTE8
 
	mhûígth
;

512 
UINT16
 
	mÀngth
;

513 
IDTYPE
 
	mdøwid
;

514 
IDTYPE
 
	mgcid
;

515 
INT16
 
	mx
;

516 
INT16
 
	my
;

517 
INT16
 
	mcou¡
;

518 
INT16
 
	m∑d
;

519 
UINT32
 
	mÊags
;

521 } 
	tnxTextReq
;

523 
	#GrNumNewCurs‹
 43

	)

525 
BYTE8
 
	mªqTy≥
;

526 
BYTE8
 
	mhûígth
;

527 
UINT16
 
	mÀngth
;

528 
INT16
 
	mwidth
;

529 
INT16
 
	mheight
;

530 
INT16
 
	mhŸx
;

531 
INT16
 
	mhŸy
;

532 
UINT32
 
	mfgcﬁ‹
;

533 
UINT32
 
	mbgcﬁ‹
;

536 } 
	tnxNewCurs‹Req
;

538 
	#GrNumMoveCurs‹
 44

	)

540 
BYTE8
 
	mªqTy≥
;

541 
BYTE8
 
	mhûígth
;

542 
UINT16
 
	mÀngth
;

543 
INT16
 
	mx
;

544 
INT16
 
	my
;

545 } 
	tnxMoveCurs‹Req
;

547 
	#GrNumGëSy°emPÆëã
 45

	)

549 
BYTE8
 
	mªqTy≥
;

550 
BYTE8
 
	mhûígth
;

551 
UINT16
 
	mÀngth
;

552 } 
	tnxGëSy°emPÆëãReq
;

554 
	#GrNumFödCﬁ‹
 46

	)

556 
BYTE8
 
	mªqTy≥
;

557 
BYTE8
 
	mhûígth
;

558 
UINT16
 
	mÀngth
;

559 
UINT32
 
	mcﬁ‹
;

560 } 
	tnxFödCﬁ‹Req
;

562 
	#GrNumRï¨ítWödow
 47

	)

564 
BYTE8
 
	mªqTy≥
;

565 
BYTE8
 
	mhûígth
;

566 
UINT16
 
	mÀngth
;

567 
IDTYPE
 
	mwödowid
;

568 
IDTYPE
 
	m∑ª¡id
;

569 
INT16
 
	mx
;

570 
INT16
 
	my
;

571 } 
	tnxRï¨ítWödowReq
;

573 
	#GrNumDøwImageFromFûe
 48

	)

575 
BYTE8
 
	mªqTy≥
;

576 
BYTE8
 
	mhûígth
;

577 
UINT16
 
	mÀngth
;

578 
IDTYPE
 
	mdøwid
;

579 
IDTYPE
 
	mgcid
;

580 
INT16
 
	mx
;

581 
INT16
 
	my
;

582 
INT16
 
	mwidth
;

583 
INT16
 
	mheight
;

584 
IDTYPE
 
	mÊags
;

586 } 
	tnxDøwImageFromFûeReq
;

588 
	#GrNumLﬂdImageFromFûe
 49

	)

590 
BYTE8
 
	mªqTy≥
;

591 
BYTE8
 
	mhûígth
;

592 
UINT16
 
	mÀngth
;

593 
INT16
 
	mÊags
;

594 
INT16
 
	m∑d
;

595 } 
	tnxLﬂdImageFromFûeReq
;

597 
	#GrNumNewPixm≠
 50

	)

599 
BYTE8
 
	mªqTy≥
;

600 
BYTE8
 
	mhûígth
;

601 
UINT16
 
	mÀngth
;

602 
INT16
 
	mwidth
;

603 
INT16
 
	mheight
;

605 } 
	tnxNewPixm≠Req
;

607 
	#GrNumC›yAªa
 51

	)

609 
BYTE8
 
	mªqTy≥
;

610 
BYTE8
 
	mhûígth
;

611 
UINT16
 
	mÀngth
;

612 
IDTYPE
 
	mdøwid
;

613 
IDTYPE
 
	mgcid
;

614 
INT16
 
	mx
;

615 
INT16
 
	my
;

616 
INT16
 
	mwidth
;

617 
INT16
 
	mheight
;

618 
IDTYPE
 
	m§cid
;

619 
INT16
 
	m§cx
;

620 
INT16
 
	m§cy
;

621 
UINT32
 
	m›
;

622 } 
	tnxC›yAªaReq
;

624 
	#GrNumSëF⁄tSize
 52

	)

626 
BYTE8
 
	mªqTy≥
;

627 
BYTE8
 
	mhûígth
;

628 
UINT16
 
	mÀngth
;

629 
IDTYPE
 
	mf⁄tid
;

630 
INT16
 
	mf⁄tsize
;

631 } 
	tnxSëF⁄tSizeReq
;

633 
	#GrNumCª©eF⁄t
 53

	)

635 
BYTE8
 
	mªqTy≥
;

636 
BYTE8
 
	mhûígth
;

637 
UINT16
 
	mÀngth
;

638 
INT16
 
	mheight
;

639 
INT16
 
	m∑ddög
;

640 } 
	tnxCª©eF⁄tReq
;

642 
	#GrNumDe°royF⁄t
 54

	)

644 
BYTE8
 
	mªqTy≥
;

645 
BYTE8
 
	mhûígth
;

646 
UINT16
 
	mÀngth
;

647 
IDTYPE
 
	mf⁄tid
;

648 } 
	tnxDe°royF⁄tReq
;

650 
	#GrNumReqShmCmds
 55

	)

652 
BYTE8
 
	mªqTy≥
;

653 
BYTE8
 
	mhûígth
;

654 
UINT16
 
	mÀngth
;

655 
UINT32
 
	msize
;

656 } 
	tnxReqShmCmdsReq
;

658 
	#GrNumShmCmdsFlush
 56

	)

660 
BYTE8
 
	mªqTy≥
;

661 
BYTE8
 
	mhûígth
;

662 
UINT16
 
	mÀngth
;

663 
UINT32
 
	msize
;

664 
UINT32
 
	mª∂y
;

665 } 
	tnxShmCmdsFlushReq
;

667 
	#GrNumSëF⁄tRŸ©i⁄
 57

	)

669 
BYTE8
 
	mªqTy≥
;

670 
BYTE8
 
	mhûígth
;

671 
UINT16
 
	mÀngth
;

672 
IDTYPE
 
	mf⁄tid
;

673 
INT16
 
	mã¡hdegªes
;

674 } 
	tnxSëF⁄tRŸ©i⁄Req
;

676 
	#GrNumSëF⁄tAâr
 58

	)

678 
BYTE8
 
	mªqTy≥
;

679 
BYTE8
 
	mhûígth
;

680 
UINT16
 
	mÀngth
;

681 
IDTYPE
 
	mf⁄tid
;

682 
INT16
 
	m£tÊags
;

683 
INT16
 
	m˛rÊags
;

684 } 
	tnxSëF⁄tAârReq
;

686 
	#GrNumSëSy°emPÆëã
 59

	)

688 
BYTE8
 
	mªqTy≥
;

689 
BYTE8
 
	mhûígth
;

690 
UINT16
 
	mÀngth
;

691 
INT16
 
	mfú°
;

692 
INT16
 
	mcou¡
;

693 
MWPALENTRY
 
	m∑Àâe
[256];

694 } 
	tnxSëSy°emPÆëãReq
;

696 
	#GrNumInje˘Evít
 60

	)

697 
	#GR_INJECT_EVENT_POINTER
 0

	)

698 
	#GR_INJECT_EVENT_KEYBOARD
 1

	)

700 
BYTE8
 
	mªqTy≥
;

701 
BYTE8
 
	mhûígth
;

702 
UINT16
 
	mÀngth
;

705 
INT16
 
	mx
;

706 
INT16
 
	my
;

707 
UINT16
 
	mbuâ⁄
;

708 
BYTE8
 
	mvisibÀ
;

709 } 
	mpoöãr
;

711 
IDTYPE
 
	mwid
;

712 
UINT16
 
	mkeyvÆue
;

713 
UINT16
 
	mmodifõr
;

714 
BYTE8
 
	msˇncode
;

715 
BYTE8
 
	m¥es£d
;

716 } 
	mkeybﬂrd
;

717 } 
	mevít
;

718 
UINT16
 
	mevít_ty≥
;

719 } 
	tnxInje˘EvítReq
;

721 
	#GrNumNewRegi⁄
 61

	)

723 
BYTE8
 
	mªqTy≥
;

724 
BYTE8
 
	mhûígth
;

725 
UINT16
 
	mÀngth
;

726 } 
	tnxNewRegi⁄Req
;

728 
	#GrNumDe°royRegi⁄
 62

	)

730 
BYTE8
 
	mªqTy≥
;

731 
BYTE8
 
	mhûígth
;

732 
UINT16
 
	mÀngth
;

733 
IDTYPE
 
	mªgi⁄id
;

734 } 
	tnxDe°royRegi⁄Req
;

736 
	#GrNumUni⁄Re˘WôhRegi⁄
 63

	)

738 
BYTE8
 
	mªqTy≥
;

739 
BYTE8
 
	mhûígth
;

740 
UINT16
 
	mÀngth
;

741 
IDTYPE
 
	mªgi⁄id
;

742 
GR_RECT
 
	mª˘
;

743 } 
	tnxUni⁄Re˘WôhRegi⁄Req
;

745 
	#GrNumUni⁄Regi⁄
 64

	)

747 
BYTE8
 
	mªqTy≥
;

748 
BYTE8
 
	mhûígth
;

749 
UINT16
 
	mÀngth
;

750 
IDTYPE
 
	mªgi⁄id
;

751 
IDTYPE
 
	m§¸egi⁄id1
;

752 
IDTYPE
 
	m§¸egi⁄id2
;

753 } 
	tnxUni⁄Regi⁄Req
;

755 
	#GrNumI¡î£˘Regi⁄
 65

	)

757 
BYTE8
 
	mªqTy≥
;

758 
BYTE8
 
	mhûígth
;

759 
UINT16
 
	mÀngth
;

760 
IDTYPE
 
	mªgi⁄id
;

761 
IDTYPE
 
	m§¸egi⁄id1
;

762 
IDTYPE
 
	m§¸egi⁄id2
;

763 } 
	tnxI¡î£˘Regi⁄Req
;

765 
	#GrNumSëGCRegi⁄
 66

	)

767 
BYTE8
 
	mªqTy≥
;

768 
BYTE8
 
	mhûígth
;

769 
UINT16
 
	mÀngth
;

770 
IDTYPE
 
	mgcid
;

771 
IDTYPE
 
	mªgi⁄id
;

772 } 
	tnxSëGCRegi⁄Req
;

774 
	#GrNumSubåa˘Regi⁄
 67

	)

776 
BYTE8
 
	mªqTy≥
;

777 
BYTE8
 
	mhûígth
;

778 
UINT16
 
	mÀngth
;

779 
IDTYPE
 
	mªgi⁄id
;

780 
IDTYPE
 
	m§¸egi⁄id1
;

781 
IDTYPE
 
	m§¸egi⁄id2
;

782 } 
	tnxSubåa˘Regi⁄Req
;

784 
	#GrNumX‹Regi⁄
 68

	)

786 
BYTE8
 
	mªqTy≥
;

787 
BYTE8
 
	mhûígth
;

788 
UINT16
 
	mÀngth
;

789 
IDTYPE
 
	mªgi⁄id
;

790 
IDTYPE
 
	m§¸egi⁄id1
;

791 
IDTYPE
 
	m§¸egi⁄id2
;

792 } 
	tnxX‹Regi⁄Req
;

794 
	#GrNumPoötInRegi⁄
 69

	)

796 
BYTE8
 
	mªqTy≥
;

797 
BYTE8
 
	mhûígth
;

798 
UINT16
 
	mÀngth
;

799 
IDTYPE
 
	mªgi⁄id
;

800 
INT16
 
	mx
;

801 
INT16
 
	my
;

802 } 
	tnxPoötInRegi⁄Req
;

804 
	#GrNumRe˘InRegi⁄
 70

	)

806 
BYTE8
 
	mªqTy≥
;

807 
BYTE8
 
	mhûígth
;

808 
UINT16
 
	mÀngth
;

809 
IDTYPE
 
	mªgi⁄id
;

810 
INT16
 
	mx
;

811 
INT16
 
	my
;

812 
INT16
 
	mw
;

813 
INT16
 
	mh
;

814 } 
	tnxRe˘InRegi⁄Req
;

816 
	#GrNumEm±yRegi⁄
 71

	)

818 
BYTE8
 
	mªqTy≥
;

819 
BYTE8
 
	mhûígth
;

820 
UINT16
 
	mÀngth
;

821 
IDTYPE
 
	mªgi⁄id
;

822 } 
	tnxEm±yRegi⁄Req
;

824 
	#GrNumEquÆRegi⁄
 72

	)

826 
BYTE8
 
	mªqTy≥
;

827 
BYTE8
 
	mhûígth
;

828 
UINT16
 
	mÀngth
;

829 
IDTYPE
 
	mªgi⁄1
;

830 
IDTYPE
 
	mªgi⁄2
;

831 } 
	tnxEquÆRegi⁄Req
;

833 
	#GrNumOff£tRegi⁄
 73

	)

835 
BYTE8
 
	mªqTy≥
;

836 
BYTE8
 
	mhûígth
;

837 
UINT16
 
	mÀngth
;

838 
IDTYPE
 
	mªgi⁄
;

839 
INT16
 
	mdx
;

840 
INT16
 
	mdy
;

841 } 
	tnxOff£tRegi⁄Req
;

843 
	#GrNumGëRegi⁄Box
 74

	)

845 
BYTE8
 
	mªqTy≥
;

846 
BYTE8
 
	mhûígth
;

847 
UINT16
 
	mÀngth
;

848 
IDTYPE
 
	mªgi⁄id
;

849 } 
	tnxGëRegi⁄BoxReq
;

851 
	#GrNumNewPﬁyg⁄Regi⁄
 75

	)

853 
BYTE8
 
	mªqTy≥
;

854 
BYTE8
 
	mhûígth
;

855 
UINT16
 
	mÀngth
;

856 
UINT16
 
	mmode
;

857 
UINT16
 
	m∑d
;

859 } 
	tnxNewPﬁyg⁄Regi⁄Req
;

861 
	#GrNumArc
 76

	)

863 
BYTE8
 
	mªqTy≥
;

864 
BYTE8
 
	mhûígth
;

865 
UINT16
 
	mÀngth
;

866 
IDTYPE
 
	mdøwid
;

867 
IDTYPE
 
	mgcid
;

868 
INT16
 
	mx
;

869 
INT16
 
	my
;

870 
INT16
 
	mrx
;

871 
INT16
 
	mry
;

872 
INT16
 
	max
;

873 
INT16
 
	may
;

874 
INT16
 
	mbx
;

875 
INT16
 
	mby
;

876 
INT16
 
	mty≥
;

877 } 
	tnxArcReq
;

879 
	#GrNumArcAngÀ
 77

	)

881 
BYTE8
 
	mªqTy≥
;

882 
BYTE8
 
	mhûígth
;

883 
UINT16
 
	mÀngth
;

884 
IDTYPE
 
	mdøwid
;

885 
IDTYPE
 
	mgcid
;

886 
INT16
 
	mx
;

887 
INT16
 
	my
;

888 
INT16
 
	mrx
;

889 
INT16
 
	mry
;

890 
INT16
 
	m™gÀ1
;

891 
INT16
 
	m™gÀ2
;

892 
INT16
 
	mty≥
;

893 } 
	tnxArcAngÀReq
;

895 
	#GrNumSëWMPr›îtõs
 78

	)

897 
BYTE8
 
	mªqTy≥
;

898 
BYTE8
 
	mhûígth
;

899 
UINT16
 
	mÀngth
;

900 
IDTYPE
 
	mwödowid
;

903 } 
	tnxSëWMPr›îtõsReq
;

905 
	#GrNumGëWMPr›îtõs
 79

	)

907 
BYTE8
 
	mªqTy≥
;

908 
BYTE8
 
	mhûígth
;

909 
UINT16
 
	mÀngth
;

910 
IDTYPE
 
	mwödowid
;

911 } 
	tnxGëWMPr›îtõsReq
;

913 
	#GrNumClo£Wödow
 80

	)

915 
BYTE8
 
	mªqTy≥
;

916 
BYTE8
 
	mhûígth
;

917 
UINT16
 
	mÀngth
;

918 
IDTYPE
 
	mwödowid
;

919 } 
	tnxClo£WödowReq
;

921 
	#GrNumKûlWödow
 81

	)

923 
BYTE8
 
	mªqTy≥
;

924 
BYTE8
 
	mhûígth
;

925 
UINT16
 
	mÀngth
;

926 
IDTYPE
 
	mwödowid
;

927 } 
	tnxKûlWödowReq
;

929 
	#GrNumDøwImageToFô
 82

	)

931 
BYTE8
 
	mªqTy≥
;

932 
BYTE8
 
	mhûígth
;

933 
UINT16
 
	mÀngth
;

934 
IDTYPE
 
	mdøwid
;

935 
IDTYPE
 
	mgcid
;

936 
INT16
 
	mx
;

937 
INT16
 
	my
;

938 
INT16
 
	mwidth
;

939 
INT16
 
	mheight
;

940 
IDTYPE
 
	mimageid
;

941 } 
	tnxDøwImageToFôReq
;

943 
	#GrNumFªeImage
 83

	)

945 
BYTE8
 
	mªqTy≥
;

946 
BYTE8
 
	mhûígth
;

947 
UINT16
 
	mÀngth
;

948 
IDTYPE
 
	mid
;

949 } 
	tnxFªeImageReq
;

951 
	#GrNumGëImageInfo
 84

	)

953 
BYTE8
 
	mªqTy≥
;

954 
BYTE8
 
	mhûígth
;

955 
UINT16
 
	mÀngth
;

956 
IDTYPE
 
	mid
;

957 } 
	tnxGëImageInfoReq
;

959 
	#GrNumDøwImageBôs
 85

	)

961 
BYTE8
 
	mªqTy≥
;

962 
BYTE8
 
	mhûígth
;

963 
UINT16
 
	mÀngth
;

964 
IDTYPE
 
	mdøwid
;

965 
IDTYPE
 
	mgcid
;

966 
INT16
 
	mx
;

967 
INT16
 
	my
;

968 
INT16
 
	mwidth
;

969 
INT16
 
	mheight
;

970 
INT16
 
	m∂™es
;

971 
INT16
 
	mbµ
;

972 
INT16
 
	mpôch
;

973 
INT16
 
	mbyã•îpixñ
;

974 
INT16
 
	mcom¥essi⁄
;

975 
INT16
 
	m∑lsize
;

976 
UINT32
 
	må™scﬁ‹
;

979 } 
	tnxDøwImageBôsReq
;

981 
	#GrNumPoöts
 86

	)

983 
BYTE8
 
	mªqTy≥
;

984 
BYTE8
 
	mhûígth
;

985 
UINT16
 
	mÀngth
;

986 
IDTYPE
 
	mdøwid
;

987 
IDTYPE
 
	mgcid
;

989 } 
	tnxPoötsReq
;

991 
	#GrNumGëFocus
 87

	)

993 
BYTE8
 
	mªqTy≥
;

994 
BYTE8
 
	mhûígth
;

995 
UINT16
 
	mÀngth
;

996 } 
	tnxGëFocusReq
;

998 
	#GrNumGëSysCﬁ‹
 88

	)

1000 
BYTE8
 
	mªqTy≥
;

1001 
BYTE8
 
	mhûígth
;

1002 
UINT16
 
	mÀngth
;

1003 
UINT16
 
	mödex
;

1004 } 
	tnxGëSysCﬁ‹Req
;

1006 
	#GrNumSëS¸ìnSavîTimeout
 89

	)

1008 
BYTE8
 
	mªqTy≥
;

1009 
BYTE8
 
	mhûígth
;

1010 
UINT16
 
	mÀngth
;

1011 
UINT32
 
	mtimeout
;

1012 } 
	tnxSëS¸ìnSavîTimeoutReq
;

1014 
	#GrNumSëSñe˘i⁄Ow√r
 90

	)

1016 
BYTE8
 
	mªqTy≥
;

1017 
BYTE8
 
	mhûígth
;

1018 
UINT16
 
	mÀngth
;

1019 
IDTYPE
 
	mwid
;

1021 } 
	tnxSëSñe˘i⁄Ow√rReq
;

1023 
	#GrNumGëSñe˘i⁄Ow√r
 91

	)

1025 
BYTE8
 
	mªqTy≥
;

1026 
BYTE8
 
	mhûígth
;

1027 
UINT16
 
	mÀngth
;

1028 } 
	tnxGëSñe˘i⁄Ow√rReq
;

1030 
	#GrNumReque°Clõ¡D©a
 92

	)

1032 
BYTE8
 
	mªqTy≥
;

1033 
BYTE8
 
	mhûígth
;

1034 
UINT16
 
	mÀngth
;

1035 
IDTYPE
 
	mwid
;

1036 
IDTYPE
 
	mrid
;

1037 
UINT32
 
	m£rül
;

1038 
UINT16
 
	mmimëy≥
;

1039 } 
	tnxReque°Clõ¡D©aReq
;

1041 
	#GrNumSídClõ¡D©a
 93

	)

1043 
BYTE8
 
	mªqTy≥
;

1044 
BYTE8
 
	mhûígth
;

1045 
UINT16
 
	mÀngth
;

1046 
IDTYPE
 
	mwid
;

1047 
IDTYPE
 
	mdid
;

1048 
UINT32
 
	m£rül
;

1049 
UINT32
 
	mÀn
;

1051 } 
	tnxSídClõ¡D©aReq
;

1053 
	#GrNumBñl
 94

	)

1055 
BYTE8
 
	mªqTy≥
;

1056 
BYTE8
 
	mhûígth
;

1057 
UINT16
 
	mÀngth
;

1058 } 
	tnxBñlReq
;

1060 
	#GrNumSëBackgroundPixm≠
 95

	)

1062 
BYTE8
 
	mªqTy≥
;

1063 
BYTE8
 
	mhûígth
;

1064 
UINT16
 
	mÀngth
;

1065 
IDTYPE
 
	mwid
;

1066 
IDTYPE
 
	mpixm≠
;

1067 
UINT32
 
	mÊags
;

1068 } 
	tnxSëBackgroundPixm≠Req
;

1070 
	#GrNumDe°royCurs‹
 96

	)

1072 
BYTE8
 
	mªqTy≥
;

1073 
BYTE8
 
	mhûígth
;

1074 
UINT16
 
	mÀngth
;

1075 
IDTYPE
 
	mcurs‹id
;

1076 } 
	tnxDe°royCurs‹Req
;

1078 
	#GrNumQuîyTªe
 97

	)

1080 
BYTE8
 
	mªqTy≥
;

1081 
BYTE8
 
	mhûígth
;

1082 
UINT16
 
	mÀngth
;

1083 
IDTYPE
 
	mwödowid
;

1084 } 
	tnxQuîyTªeReq
;

1086 
	#GrNumCª©eTimî
 98

	)

1088 
BYTE8
 
	mªqTy≥
;

1089 
BYTE8
 
	mhûígth
;

1090 
UINT16
 
	mÀngth
;

1091 
IDTYPE
 
	mwid
;

1092 
UINT32
 
	m≥riod
;

1093 } 
	tnxCª©eTimîReq
;

1095 
	#GrNumDe°royTimî
 99

	)

1097 
BYTE8
 
	mªqTy≥
;

1098 
BYTE8
 
	mhûígth
;

1099 
UINT16
 
	mÀngth
;

1100 
IDTYPE
 
	mtimîid
;

1101 } 
	tnxDe°royTimîReq
;

1103 
	#GrNumSëP‹åaôMode
 100

	)

1105 
BYTE8
 
	mªqTy≥
;

1106 
BYTE8
 
	mhûígth
;

1107 
UINT16
 
	mÀngth
;

1108 
UINT32
 
	mp‹åaômode
;

1109 } 
	tnxSëP‹åaôModeReq
;

1111 
	#GrNumImageBuf„rAŒoc
 101

	)

1114 
BYTE8
 
	mªqTy≥
;

1115 
BYTE8
 
	mhûígth
;

1116 
UINT16
 
	mÀngth
;

1117 
UINT32
 
	msize
;

1118 } 
	tnxImageBuf„rAŒocReq
;

1120 
	#GrNumImageBuf„rSíd
 102

	)

1123 
BYTE8
 
	mªqTy≥
;

1124 
BYTE8
 
	mhûígth
;

1125 
UINT16
 
	mÀngth
;

1126 
UINT32
 
	mbuf„r_id
;

1127 
UINT32
 
	msize
;

1128 } 
	tnxImageBuf„rSídReq
;

1130 
	#GrNumLﬂdImageFromBuf„r
 103

	)

1132 
BYTE8
 
	mªqTy≥
;

1133 
BYTE8
 
	mhûígth
;

1134 
UINT16
 
	mÀngth
;

1135 
UINT32
 
	mbuf„r
;

1136 
INT16
 
	mÊags
;

1137 
INT16
 
	m∑d
;

1138 } 
	tnxLﬂdImageFromBuf„rReq
;

1140 
	#GrNumDøwImageFromBuf„r
 104

	)

1142 
BYTE8
 
	mªqTy≥
;

1143 
BYTE8
 
	mhûígth
;

1144 
UINT16
 
	mÀngth
;

1145 
IDTYPE
 
	mdøwid
;

1146 
IDTYPE
 
	mgcid
;

1147 
INT16
 
	mx
;

1148 
INT16
 
	my
;

1149 
INT16
 
	mwidth
;

1150 
INT16
 
	mheight
;

1151 
UINT32
 
	mbuf„r
;

1152 
IDTYPE
 
	mÊags
;

1153 } 
	tnxDøwImageFromBuf„rReq
;

1155 
	#GrNumGëF⁄tLi°
 105

	)

1157 
BYTE8
 
	mªqTy≥
;

1158 
BYTE8
 
	mhûígth
;

1159 
UINT16
 
	mÀngth
;

1160 } 
	tnxGëF⁄tLi°Req
;

1162 
	#GrNumSëGCClùOrigö
 106

	)

1165 
BYTE8
 
	mªqTy≥
;

1166 
BYTE8
 
	mhûígth
;

1167 
UINT16
 
	mÀngth
;

1168 
IDTYPE
 
	mgcid
;

1169 
UINT32
 
	mxoff
;

1170 
UINT32
 
	myoff
;

1171 } 
	tnxSëGCClùOrigöReq
;

1173 
	#GrNumSëGCGøphicsExposuª
 107

	)

1176 
BYTE8
 
	mªqTy≥
;

1177 
BYTE8
 
	mhûígth
;

1178 
UINT16
 
	mÀngth
;

1179 
IDTYPE
 
	mgcid
;

1180 
UINT16
 
	mexposuª
;

1181 } 
	tnxSëGCGøphicsExposuªReq
;

1183 
	#GrNumQuîyPoöãr
 108

	)

1186 
BYTE8
 
	mªqTy≥
;

1187 
BYTE8
 
	mhûígth
;

1188 
UINT16
 
	mÀngth
;

1189 } 
	tnxQuîyPoöãrReq
;

1191 
	#GrNumSëGCLöeAâribuãs
 109

	)

1194 
BYTE8
 
	mªqTy≥
;

1195 
BYTE8
 
	mhûígth
;

1196 
UINT16
 
	mÀngth
;

1197 
IDTYPE
 
	mgcid
;

1198 
UINT16
 
	mlöe°yÀ
;

1199 } 
	tnxSëGCLöeAâribuãsReq
;

1201 
	#GrNumSëGCDash
 110

	)

1204 
BYTE8
 
	mªqTy≥
;

1205 
BYTE8
 
	mhûígth
;

1206 
UINT16
 
	mÀngth
;

1207 
IDTYPE
 
	mgcid
;

1208 
UINT16
 
	mcou¡
;

1209 } 
	tnxSëGCDashReq
;

1211 
	#GrNumSëGCFûlMode
 111

	)

1214 
BYTE8
 
	mªqTy≥
;

1215 
BYTE8
 
	mhûígth
;

1216 
UINT16
 
	mÀngth
;

1217 
IDTYPE
 
	mgcid
;

1218 
UINT16
 
	mfûlmode
;

1219 } 
	tnxSëGCFûlModeReq
;

1221 
	#GrNumSëGCStù∂e
 112

	)

1224 
BYTE8
 
	mªqTy≥
;

1225 
BYTE8
 
	mhûígth
;

1226 
UINT16
 
	mÀngth
;

1227 
IDTYPE
 
	mgcid
;

1228 
INT16
 
	mwidth
;

1229 
INT16
 
	mheight
;

1230 } 
	tnxSëGCStù∂eReq
;

1232 
	#GrNumSëGCTSOff£t
 113

	)

1235 
BYTE8
 
	mªqTy≥
;

1236 
BYTE8
 
	mhûígth
;

1237 
UINT16
 
	mÀngth
;

1238 
IDTYPE
 
	mgcid
;

1239 
INT16
 
	mxoff£t
;

1240 
INT16
 
	myoff£t
;

1241 } 
	tnxSëGCTSOff£tReq
;

1243 
	#GrNumSëGCTûe
 114

	)

1246 
BYTE8
 
	mªqTy≥
;

1247 
BYTE8
 
	mhûígth
;

1248 
UINT16
 
	mÀngth
;

1249 
IDTYPE
 
	mgcid
;

1250 
IDTYPE
 
	mpixm≠
;

1251 
INT16
 
	mwidth
;

1252 
INT16
 
	mheight
;

1253 } 
	tnxSëGCTûeReq
;

1255 
	#GrNumNewBôm≠Regi⁄
 115

	)

1258 
BYTE8
 
	mªqTy≥
;

1259 
BYTE8
 
	mhûígth
;

1260 
UINT16
 
	mÀngth
;

1261 
INT16
 
	mwidth
;

1262 
INT16
 
	mheight
;

1264 } 
	tnxNewBôm≠Regi⁄Req
;

1266 
	#GrNumSëWödowRegi⁄
 116

	)

1269 
BYTE8
 
	mªqTy≥
;

1270 
BYTE8
 
	mhûígth
;

1271 
UINT16
 
	mÀngth
;

1272 
IDTYPE
 
	mwid
;

1273 
IDTYPE
 
	mrid
;

1274 
UINT16
 
	mty≥
;

1275 } 
	tnxSëWödowRegi⁄Req
;

1277 
	#GrNumSëGCF‹egroundPixñVÆ
 117

	)

1280 
BYTE8
 
	mªqTy≥
;

1281 
BYTE8
 
	mhûígth
;

1282 
UINT16
 
	mÀngth
;

1283 
IDTYPE
 
	mgcid
;

1284 
UINT32
 
	mpixñvÆ
;

1285 } 
	tnxSëGCF‹egroundPixñVÆReq
;

1287 
	#GrNumSëGCBackgroundPixñVÆ
 118

	)

1290 
BYTE8
 
	mªqTy≥
;

1291 
BYTE8
 
	mhûígth
;

1292 
UINT16
 
	mÀngth
;

1293 
IDTYPE
 
	mgcid
;

1294 
UINT32
 
	mpixñvÆ
;

1295 } 
	tnxSëGCBackgroundPixñVÆReq
;

1297 
	#GrNumCª©eLogF⁄t
 119

	)

1299 
BYTE8
 
	mªqTy≥
;

1300 
BYTE8
 
	mhûígth
;

1301 
UINT16
 
	mÀngth
;

1302 
MWLOGFONT
 
	mlf
;

1303 } 
	tnxCª©eLogF⁄tReq
;

1305 
	#GrNumSåëchAªa
 120

	)

1307 
BYTE8
 
	mªqTy≥
;

1308 
BYTE8
 
	mhûígth
;

1309 
UINT16
 
	mÀngth
;

1310 
IDTYPE
 
	mdøwid
;

1311 
IDTYPE
 
	mgcid
;

1312 
INT16
 
	mdx1
;

1313 
INT16
 
	mdy1
;

1314 
INT16
 
	mdx2
;

1315 
INT16
 
	mdy2
;

1316 
IDTYPE
 
	m§cid
;

1317 
INT16
 
	msx1
;

1318 
INT16
 
	msy1
;

1319 
INT16
 
	msx2
;

1320 
INT16
 
	msy2
;

1321 
UINT32
 
	m›
;

1322 } 
	tnxSåëchAªaReq
;

1324 
	#GrNumGøbKey
 121

	)

1326 
BYTE8
 
	mªqTy≥
;

1327 
BYTE8
 
	mhûígth
;

1328 
UINT16
 
	mÀngth
;

1329 
IDTYPE
 
	mwid
;

1330 
INT16
 
	mty≥
;

1331 
UINT16
 
	mkey
;

1332 } 
	tnxGøbKeyReq
;

1334 
	#GrNumSëTønsf‹m
 122

	)

1336 
BYTE8
 
	mªqTy≥
;

1337 
BYTE8
 
	mhûígth
;

1338 
UINT16
 
	mÀngth
;

1339 
UINT32
 
	mmode
;

1340 
UINT32
 
	må™s_a
;

1341 
UINT32
 
	må™s_b
;

1342 
UINT32
 
	må™s_c
;

1343 
UINT32
 
	må™s_d
;

1344 
UINT32
 
	må™s_e
;

1345 
UINT32
 
	må™s_f
;

1346 
UINT32
 
	må™s_s
;

1347 } 
	tnxSëTønsf‹mReq
;

1349 
	#GrNumCª©eF⁄tFromBuf„r
 123

	)

1351 
BYTE8
 
	mªqTy≥
;

1352 
BYTE8
 
	mhûígth
;

1353 
UINT16
 
	mÀngth
;

1354 
UINT32
 
	mbuf„r_id
;

1355 
BYTE8
 
	mf‹m©
[16];

1356 
INT16
 
	mheight
;

1357 
UINT16
 
	m∑ddög
;

1358 } 
	tnxCª©eF⁄tFromBuf„rReq
;

1360 
	#GrNumC›yF⁄t
 124

	)

1362 
BYTE8
 
	mªqTy≥
;

1363 
BYTE8
 
	mhûígth
;

1364 
UINT16
 
	mÀngth
;

1365 
IDTYPE
 
	mf⁄tid
;

1366 
INT16
 
	mheight
;

1367 } 
	tnxC›yF⁄tReq
;

1369 
	#GrTŸÆNumCÆls
 125

	)

	@nanox/nxtransform.c

11 
	~<°dio.h
>

12 
	~<°rög.h
>

13 
	~"«no-X.h
"

15 
CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(
GR_CAL_DATA
 * 
ßm∂es
,

16 
GR_TRANSFORM
 * 
±c
);

19 
	$GrCÆcTønsf‹m
(
GR_CAL_DATA
 * 
d©a
, 
GR_TRANSFORM
 * 
å™s
)

21  
	`CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(
d©a
, 
å™s
);

22 
	}
}

26 
	$GrSaveTønsf‹mD©a
(
GR_TRANSFORM
 * 
å™s
, *
fûíame
)

28 
FILE
 *
out
 = 
	`f›í
(
fûíame
, "w");

29 i‡(!
out
)

32 
	`Ârötf
(
out
, "# Nano-XÅouchscreen data\n");

33 
	`Ârötf
(
out
, "# Generatedáutomatically, doÇotÉdit\n\n");

35 
	`Ârötf
(
out
, "%d %d %d %d %d %d %d\n",

36 
å™s
->
a
,Åøns->
b
,Åøns->
c
,

37 
å™s
->
d
,Åøns->
e
,Åøns->
f
,Åøns->
s
);

39 
	`Ârötf
(
out
, "\n# ---\n");

40 
	`f˛o£
(
out
);

43 
	}
}

46 
	$GrLﬂdTønsf‹mD©a
(*
fûíame
, 
GR_TRANSFORM
 * 
å™s
)

48 
ªt
 = 0;

49 
FILE
 *
ö
 = 0;

51 i‡(!
å™s
)

53 
	`mem£t
(
å™s
, '\0', (
GR_TRANSFORM
));

55 
ö
 = 
	`f›í
(
fûíame
, "r");

56 i‡(!
ö
)

59 !
	`„of
(
ö
Ë&& !
	`„º‹
(in)) {

60 
buf„r
[128];

61 i‡(!
	`fgës
(
buf„r
, (buf„rË- 1, 
ö
))

64 i‡(
buf„r
[0] == '#')

67 i‡(
	`ssˇnf
(
buf„r
, "%d %d %d %d %d %d %d",

68 &
å™s
->
a
, &å™s->
b
, &å™s->
c
,

69 &
å™s
->
d
, &å™s->
e
, &å™s->
f
, &å™s->
s
) == 7)

70 
exô_lﬂd
;

73 
ªt
 = -1;

74 
exô_lﬂd
:

76 
	`f˛o£
(
ö
);

77  
ªt
;

78 
	}
}

90 
	$CÆcTønsf‹m©i⁄C€fficõ¡sBëãr
(
GR_CAL_DATA
 * 
ßm∂es
,

91 
GR_TRANSFORM
 * 
±c
)

99 
i
, 
j
, 
r
, 
k
;

100 
ve˘‹
[3][2];

101 
m©rix
[3][3];

102 
p
, 
q
;

104 
ve˘‹
[0][0] = 0.0; vector[0][1] = 0.0;

105 
ve˘‹
[1][0] = 
ßm∂es
->
xªs
; vector[1][1] = 0.0;

106 
ve˘‹
[2][0] = 
ßm∂es
->
xªs
; ve˘‹[2][1] = sam∂es->
yªs
;

108 
m©rix
[0][0] = 
ßm∂es
->
möx
; m©rix[0][1] = sam∂es->
möy
; matrix[0][2] = 1.0;

109 
m©rix
[1][0] = 
ßm∂es
->
maxx
; m©rix[1][1] = sam∂es->
möy
; matrix[1][2] = 1.0;

110 
m©rix
[2][0] = 
ßm∂es
->
maxx
; m©rix[2][1] = sam∂es->
maxy
; matrix[2][2] = 1.0;

112 
i
 = 0; i < 3; i++) {

113 
p
 = 
m©rix
[
i
][i];

115 
j
 = 0; j < 3; j++) {

116 
m©rix
[
i
][
j
] = m©rix[i][j] / 
p
;

119 
j
 = 0; j < 2; j++) {

120 
ve˘‹
[
i
][
j
] = ve˘‹[i][j] / 
p
;

123 
r
 = 0;Ñ < 3;Ñ++) {

124 i‡(
r
 !
i
) {

125 
q
 = 
m©rix
[
r
][
i
];

127 
m©rix
[
r
][
i
] = 0.0;

129 
k
 = 
i
 + 1; k < 3; k++) {

130 
m©rix
[
r
][
k
] =

131 
m©rix
[
r
][
k
] -

132 (
q
 * 
m©rix
[
i
][
k
]);

135 
k
 = 0; k < 2; k++) {

136 
ve˘‹
[
r
][
k
] =

137 
ve˘‹
[
r
][
k
] -

138 (
q
 * 
ve˘‹
[
i
][
k
]);

144 
±c
->
s
 = 1 << 16;

145 
±c
->
a
 = 
ve˘‹
[0][0] *Ötc->
s
;

146 
±c
->
b
 = 
ve˘‹
[1][0] *Ötc->
s
;

147 
±c
->
c
 = 
ve˘‹
[2][0] *Ötc->
s
;

148 
±c
->
d
 = 
ve˘‹
[0][1] *Ötc->
s
;

149 
±c
->
e
 = 
ve˘‹
[1][1] *Ötc->
s
;

150 
±c
->
f
 = 
ve˘‹
[2][1] *Ötc->
s
;

153 
	}
}

	@nanox/nxutil.c

8 
	~<°dio.h
>

9 
	~<°dlib.h
>

10 
	#MWINCLUDECOLORS


	)

11 
	~"«no-X.h
"

12 
	~"devi˚.h
"

17 
GR_WINDOW_ID


18 
	$GrNewWödowEx
(
GR_WM_PROPS
 
¥›s
, 
GR_CHAR
 * 
tôÀ
, 
GR_WINDOW_ID
 
∑ª¡
,

19 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
,

20 
GR_COLOR
 
background
)

22 
GR_WINDOW_ID
 
wid
;

23 
GR_WM_PROPERTIES
 
wm¥›s
;

26 
wid
 = 
	`GrNewWödow
(
∑ª¡
, 
x
, 
y
, 
width
, 
height
, 0, 
background
, 
BLACK
);

27 i‡(
wid
) {

29 
wm¥›s
.
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
;

30 
wm¥›s
.
¥›s
 =Örops;

31 
wm¥›s
.
tôÀ
 =Åitle;

32 
	`GrSëWMPr›îtõs
(
wid
, &
wm¥›s
);

34  
wid
;

35 
	}
}

39 
	$GrDøwLöes
(
GR_DRAW_ID
 
w
, 
GR_GC_ID
 
gc
, 
GR_POINT
 * 
poöts
, 
GR_COUNT
 
cou¡
)

41 
GR_POINT
 
beg
, 
íd
;

43 i‡(
cou¡
 < 1)

45 i‡(
cou¡
 == 1) {

46 
	`GrPoöt
(
w
, 
gc
, 
poöts
->
x
,Öoöts->
y
);

50 
beg
 = *
poöts
++;

51 --
cou¡
 > 0) {

52 
íd
 = *
poöts
++;

53 
	`GrLöe
(
w
, 
gc
, 
beg
.
x
, beg.
y
, 
íd
.x,Énd.y);

54 
beg
 = 
íd
;

56 
	}
}

61 
GR_CURSOR_ID


62 
	$GrSëCurs‹
(
GR_WINDOW_ID
 
wid
, 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COORD
 
hŸx
,

63 
GR_COORD
 
hŸy
, 
GR_COLOR
 
f‹eground
, GR_COLOR 
background
,

64 
GR_BITMAP
 * 
fgbôm≠
, GR_BITMAP * 
bgbôm≠
)

66 
GR_CURSOR_ID
 
cid
;

68 
cid
 = 
	`GrNewCurs‹
(
width
, 
height
, 
hŸx
, 
hŸy
, 
f‹eground
,

69 
background
, 
fgbôm≠
, 
bgbôm≠
);

70 i‡(
cid
)

71 
	`GrSëWödowCurs‹
(
wid
, 
cid
);

72  
cid
;

73 
	}
}

76 
	gªvbyã
[256] = {

118 
GR_BITMAP
 *

119 
	$GrNewBôm≠FromD©a
(
GR_SIZE
 
width
, GR_SIZE 
height
, GR_SIZE 
bôs_width
,

120 
GR_SIZE
 
bôs_height
, *
bôs
, 
Êags
)

122 
x
, 
y
;

123 
xb
;

124 
bªv
 = 
Êags
 & 
GR_BMDATA_BYTEREVERSE
;

125 
bsw≠
 = 
Êags
 & 
GR_BMDATA_BYTESWAP
;

126 *
öbuf
 = 
bôs
;

127 *
p
;

128 
GR_BITMAP
 *
buf
;

134 
xb
 = (
width
 + 7) / 8;

135 
buf
 = (
GR_BITMAP
 *Ë
	`mÆloc
(((
xb
 + 1Ë& ~01Ë* 
height
);

136 i‡(!
buf
)

137  
NULL
;

140 
p
 = (*Ë
buf
;

142 
y
 = 0; y < 
height
; ++y) {

143 
x
 = 0; x < 
xb
;) {

147 i‡((
xb
 - 
x
) == 1) {

148 
c
 = *
öbuf
++;

149 *
p
++ = 
bªv
 ? 
ªvbyã
[
c
] : c;

150 
x
++;

152 i‡(
bsw≠
) {

154 
c
 = *
öbuf
++;

155 
p
[1] = 
bªv
 ? 
ªvbyã
[
c
] : c;

156 i‡(
x
 < 
xb
 - 1) {

157 
c
 = *
öbuf
++;

158 
p
[0] = 
bªv
 ? 
ªvbyã
[
c
] : c;

160 
p
[0] = 0;

163 
c
 = *
öbuf
++;

164 
p
[0] = 
bªv
 ? 
ªvbyã
[
c
] : c;

165 i‡(
x
 < 
xb
 - 1) {

166 
c
 = *
öbuf
++;

167 
p
[1] = 
bªv
 ? 
ªvbyã
[
c
] : c;

169 
p
[1] = 0;

172 
x
 += 2;

173 
p
 += 2;

176 
öbuf
 +(
bôs_width
 + 7Ë/ 8 - (
width
 + 7) / 8;

179 i‡(
xb
 & 1)

180 *
p
++ = 0;

182  
buf
;

183 
	}
}

188 
GR_WINDOW_ID


189 
	$GrNewPixm≠FromD©a
(
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COLOR
 
f‹eground
,

190 
GR_COLOR
 
background
, *
bôs
, 
Êags
)

192 
GR_WINDOW_ID
 
pid
;

193 
GR_GC_ID
 
gc
;

194 
GR_BITMAP
 *
buf
;

196 
pid
 = 
	`GrNewPixm≠
(
width
, 
height
, 
NULL
);

197 i‡(
pid
) {

198 
gc
 = 
	`GrNewGC
();

199 
	`GrSëGCF‹eground
(
gc
, 
f‹eground
);

200 
	`GrSëGCBackground
(
gc
, 
background
);

202 
buf
 = 
	`GrNewBôm≠FromD©a
(
width
, 
height
, width, height,

203 
bôs
, 
Êags
);

204 i‡(
buf
) {

205 
	`GrBôm≠
(
pid
, 
gc
, 0, 0, 
width
, 
height
, 
buf
);

206 
	`‰ì
(
buf
);

208 
	`GrDe°royGC
(
gc
);

210  
pid
;

211 
	}
}

217 
GR_BITMAP
 *

218 
	$GrNewBôm≠FromPixm≠
(
GR_WINDOW_ID
 
pixm≠
, 
MWCOORD
 
x
, MWCOORD 
y
,

219 
GR_SIZE
 
width
, GR_SIZE 
height
)

221 
w
, 
h
;

222 
bwidth
, 
rowsize
;

223 
GR_PIXELVAL
 *
pixñ
, *
buf„r
;

224 
GR_BITMAP
 *
bôm≠
;

226 
buf„r
 = 
	`mÆloc
(
width
 * 
height
 * (
GR_PIXELVAL
));

227 i‡(!
buf„r
)

228  
NULL
;

230 
bwidth
 = (
width
 + 15) / 16;

231 
rowsize
 = (
GR_BITMAP
Ë* ((
bwidth
 + 1) & ~01);

232 
bôm≠
 = (
GR_BITMAP
 *Ë
	`ˇŒoc
(
rowsize
, 
height
);

233 i‡(!
bôm≠
) {

234 
	`‰ì
(
buf„r
);

235  
NULL
;

239 
	`GrRódAªa
(
pixm≠
, 
x
, 
y
, 
width
, 
height
, (*Ë
buf„r
);

241 
pixñ
 = 
buf„r
;

242 
h
 = 0; h < 
height
; h++) {

243 
w
 = 0; w < 
width
; w++) {

244 i‡(*
pixñ
++)

245 
bôm≠
[(
h
 * 
bwidth
Ë+ (
w
 >> 4)] |=

246 (1 << (15 - (
w
 % 16)));

249 
	`‰ì
(
buf„r
);

250  
bôm≠
;

251 
	}
}

256 
GR_REGION_ID


257 
	$GrNewRegi⁄FromPixm≠
(
GR_WINDOW_ID
 
§c
, 
MWCOORD
 
x
, MWCOORD 
y
, 
GR_SIZE
 
width
,

258 
GR_SIZE
 
height
)

260 
w
, 
h
;

261 
mx
, 
my
, 
mw
, 
mh
;

262 
GR_REGION_ID
 
r
;

263 
GR_PIXELVAL
 *
pixñ
;

264 
GR_PIXELVAL
 *
buf„r
;

265 
GR_WINDOW_INFO
 
wöfo
;

267 i‡(!
§c
)

271 
	`GrGëWödowInfo
(
§c
, &
wöfo
);

272 
buf„r
 = 
	`ALLOCA
(
wöfo
.
width
 * wöfo.
height
 * (
GR_PIXELVAL
));

273 i‡(!
buf„r
)

275 
	`GrRódAªa
(
§c
, 0, 0, 
wöfo
.
width
, wöfo.
height
, 
buf„r
);

278 
r
 = 
	`GrNewRegi⁄
();

279 
pixñ
 = 
buf„r
;

280 
mx
 = 
	`MWMIN
(0, 
x
);

281 
my
 = 
	`MWMIN
(0, 
y
);

282 
mw
 = 
	`MWMIN
(
wöfo
.
width
, width);

283 
mh
 = 
	`MWMIN
(
wöfo
.
height
, height);

284 
h
 = 
my
; h < 
mh
; h++) {

285 
°©e
 = 0;

286 
GR_RECT
 
loˇl
;

288 
w
 = 
mx
; w < 
mw
; w++) {

289 i‡(*
pixñ
++) {

290 i‡(
°©e
 != 0)

293 
loˇl
.
x
 = 
w
;

294 
loˇl
.
y
 = 
h
;

295 
loˇl
.
height
 = 1;

296 
°©e
 = 1;

298 i‡(
°©e
 == 0)

301 
loˇl
.
width
 = (
w
 -Üoˇl.
x
);

302 
	`GrUni⁄Re˘WôhRegi⁄
(
r
, &
loˇl
);

303 
°©e
 = 0;

307 i‡(
°©e
 != 0) {

308 
loˇl
.
width
 = ((
wöfo
.width - 1Ë-Üoˇl.
x
);

309 
	`GrUni⁄Re˘WôhRegi⁄
(
r
, &
loˇl
);

312 
	`FREEA
(
buf„r
);

314  
r
;

315 
	}
}

	@nanox/serv.h

1 #i‚def 
_SERV_H


2 
	#_SERV_H


	)

15 
	~"mwsy°em.h
"

18 #i‡
deföed
(
__ECOS
Ë&& !deföed(
_NO_SVR_MAPPING
)

25 
	#nxEº‹Såögs
 
SVR_nxEº‹Såögs


	)

26 
	#GrArcAngÀ
 
SVR_GrArcAngÀ


	)

27 
	#GrArc
 
SVR_GrArc


	)

28 
	#GrAªa
 
SVR_GrAªa


	)

29 
	#GrBñl
 
SVR_GrBñl


	)

30 
	#GrBôm≠
 
SVR_GrBôm≠


	)

31 
	#GrCheckNextEvít
 
SVR_GrCheckNextEvít


	)

32 
	#GrCÀ¨Aªa
 
SVR_GrCÀ¨Aªa


	)

33 
	#GrClo£
 
SVR_GrClo£


	)

34 
	#GrClo£Wödow
 
SVR_GrClo£Wödow


	)

35 
	#GrC›yAªa
 
SVR_GrC›yAªa


	)

36 
	#GrC›yGC
 
SVR_GrC›yGC


	)

37 
	#GrCª©eF⁄t
 
SVR_GrCª©eF⁄t


	)

38 
	#GrCª©eTimî
 
SVR_GrCª©eTimî


	)

39 
	#GrDñay
 
SVR_GrDñay


	)

40 
	#GrDe°royCurs‹
 
SVR_GrDe°royCurs‹


	)

41 
	#GrDe°royF⁄t
 
SVR_GrDe°royF⁄t


	)

42 
	#GrDe°royGC
 
SVR_GrDe°royGC


	)

43 
	#GrDe°royRegi⁄
 
SVR_GrDe°royRegi⁄


	)

44 
	#GrDe°royTimî
 
SVR_GrDe°royTimî


	)

45 
	#GrDe°royWödow
 
SVR_GrDe°royWödow


	)

46 
	#GrDøwImageBôs
 
SVR_GrDøwImageBôs


	)

47 
	#GrDøwImageFromBuf„r
 
SVR_GrDøwImageFromBuf„r


	)

48 
	#GrDøwImageFromFûe
 
SVR_GrDøwImageFromFûe


	)

49 
	#GrDøwImageToFô
 
SVR_GrDøwImageToFô


	)

50 
	#GrEŒù£
 
SVR_GrEŒù£


	)

51 
	#GrEm±yRegi⁄
 
SVR_GrEm±yRegi⁄


	)

52 
	#GrEquÆRegi⁄
 
SVR_GrEquÆRegi⁄


	)

53 
	#GrFûlEŒù£
 
SVR_GrFûlEŒù£


	)

54 
	#GrFûlPﬁy
 
SVR_GrFûlPﬁy


	)

55 
	#GrFûlRe˘
 
SVR_GrFûlRe˘


	)

56 
	#GrFödCﬁ‹
 
SVR_GrFödCﬁ‹


	)

57 
	#GrFªeF⁄tLi°
 
SVR_GrFªeF⁄tLi°


	)

58 
	#GrFªeImage
 
SVR_GrFªeImage


	)

59 
	#GrGëFocus
 
SVR_GrGëFocus


	)

60 
	#GrGëF⁄tInfo
 
SVR_GrGëF⁄tInfo


	)

61 
	#GrGëF⁄tLi°
 
SVR_GrGëF⁄tLi°


	)

62 
	#GrGëGCInfo
 
SVR_GrGëGCInfo


	)

63 
	#GrGëGCTextSize
 
SVR_GrGëGCTextSize


	)

64 
	#GrGëImageInfo
 
SVR_GrGëImageInfo


	)

65 
	#GrGëRegi⁄Box
 
SVR_GrGëRegi⁄Box


	)

66 
	#GrGëS¸ìnInfo
 
SVR_GrGëS¸ìnInfo


	)

67 
	#GrGëSñe˘i⁄Ow√r
 
SVR_GrGëSñe˘i⁄Ow√r


	)

68 
	#GrGëSysCﬁ‹
 
SVR_GrGëSysCﬁ‹


	)

69 
	#GrGëSy°emPÆëã
 
SVR_GrGëSy°emPÆëã


	)

70 
	#GrGëWödowInfo
 
SVR_GrGëWödowInfo


	)

71 
	#GrGëWMPr›îtõs
 
SVR_GrGëWMPr›îtõs


	)

72 
	#GrInje˘KeybﬂrdEvít
 
SVR_GrInje˘KeybﬂrdEvít


	)

73 
	#GrInje˘PoöãrEvít
 
SVR_GrInje˘PoöãrEvít


	)

74 
	#GrI¡î£˘Regi⁄
 
SVR_GrI¡î£˘Regi⁄


	)

75 
	#GrKûlWödow
 
SVR_GrKûlWödow


	)

76 
	#GrLöe
 
SVR_GrLöe


	)

77 
	#GrLﬂdImageFromFûe
 
SVR_GrLﬂdImageFromFûe


	)

78 
	#GrLowîWödow
 
SVR_GrLowîWödow


	)

79 
	#GrM≠Wödow
 
SVR_GrM≠Wödow


	)

80 
	#GrMoveCurs‹
 
SVR_GrMoveCurs‹


	)

81 
	#GrMoveWödow
 
SVR_GrMoveWödow


	)

82 
	#GrNewCurs‹
 
SVR_GrNewCurs‹


	)

83 
	#GrNewGC
 
SVR_GrNewGC


	)

84 
	#GrNewI≈utWödow
 
SVR_GrNewI≈utWödow


	)

85 
	#GrNewPixm≠
 
SVR_GrNewPixm≠


	)

86 
	#GrNewPﬁyg⁄Regi⁄
 
SVR_GrNewPﬁyg⁄Regi⁄


	)

87 
	#GrNewRegi⁄
 
SVR_GrNewRegi⁄


	)

88 
	#GrNewWödow
 
SVR_GrNewWödow


	)

89 
	#GrOff£tRegi⁄
 
SVR_GrOff£tRegi⁄


	)

90 
	#GrO≥n
 
SVR_GrO≥n


	)

91 
	#GrPìkEvít
 
SVR_GrPìkEvít


	)

92 
	#GrPoötInRegi⁄
 
SVR_GrPoötInRegi⁄


	)

93 
	#GrPoöts
 
SVR_GrPoöts


	)

94 
	#GrPoöt
 
SVR_GrPoöt


	)

95 
	#GrPﬁy
 
SVR_GrPﬁy


	)

96 
	#GrQuîyTªe
 
SVR_GrQuîyTªe


	)

97 
	#GrRai£Wödow
 
SVR_GrRai£Wödow


	)

98 
	#GrRódAªa
 
SVR_GrRódAªa


	)

99 
	#GrRe˘InRegi⁄
 
SVR_GrRe˘InRegi⁄


	)

100 
	#GrRe˘
 
SVR_GrRe˘


	)

101 
	#GrRï¨ítWödow
 
SVR_GrRï¨ítWödow


	)

102 
	#GrReque°Clõ¡D©a
 
SVR_GrReque°Clõ¡D©a


	)

103 
	#GrResizeWödow
 
SVR_GrResizeWödow


	)

104 
	#GrSñe˘Evíts
 
SVR_GrSñe˘Evíts


	)

105 
	#GrSídClõ¡D©a
 
SVR_GrSídClõ¡D©a


	)

106 
	#GrSëBackgroundPixm≠
 
SVR_GrSëBackgroundPixm≠


	)

107 
	#GrSëCurs‹
 
SVR_GrSëCurs‹


	)

108 
	#GrSëFocus
 
SVR_GrSëFocus


	)

109 
	#GrSëF⁄tAâr
 
SVR_GrSëF⁄tAâr


	)

110 
	#GrSëF⁄tRŸ©i⁄
 
SVR_GrSëF⁄tRŸ©i⁄


	)

111 
	#GrSëF⁄tSize
 
SVR_GrSëF⁄tSize


	)

112 
	#GrSëGCBackground
 
SVR_GrSëGCBackground


	)

113 
	#GrSëGCClùOrigö
 
SVR_GrSëGCClùOrigö


	)

114 
	#GrSëGCF⁄t
 
SVR_GrSëGCF⁄t


	)

115 
	#GrSëGCF‹eground
 
SVR_GrSëGCF‹eground


	)

116 
	#GrSëGCGøphicsExposuª
 
SVR_GrSëGCGøphicsExposuª


	)

117 
	#GrSëGCMode
 
SVR_GrSëGCMode


	)

118 
	#GrSëGCRegi⁄
 
SVR_GrSëGCRegi⁄


	)

119 
	#GrSëGCU£Background
 
SVR_GrSëGCU£Background


	)

120 
	#GrSëP‹åaôMode
 
SVR_GrSëP‹åaôMode


	)

121 
	#GrSëS¸ìnSavîTimeout
 
SVR_GrSëS¸ìnSavîTimeout


	)

122 
	#GrSëSñe˘i⁄Ow√r
 
SVR_GrSëSñe˘i⁄Ow√r


	)

123 
	#GrSëSy°emPÆëã
 
SVR_GrSëSy°emPÆëã


	)

124 
	#GrSëWödowCurs‹
 
SVR_GrSëWödowCurs‹


	)

125 
	#GrSëWMPr›îtõs
 
SVR_GrSëWMPr›îtõs


	)

126 
	#GrSubåa˘Regi⁄
 
SVR_GrSubåa˘Regi⁄


	)

127 
	#GrText
 
SVR_GrText


	)

128 
	#GrUni⁄Re˘WôhRegi⁄
 
SVR_GrUni⁄Re˘WôhRegi⁄


	)

129 
	#GrUni⁄Regi⁄
 
SVR_GrUni⁄Regi⁄


	)

130 
	#GrUnm≠Wödow
 
SVR_GrUnm≠Wödow


	)

131 
	#GrX‹Regi⁄
 
SVR_GrX‹Regi⁄


	)

134 
	~"«no-X.h
"

135 
	~"devi˚.h
"

143 #i‡
NONETWORK


146 
	~"lock.h
"

148 
LOCK_EXTERN
(
gr_£rvî_muãx
);

150 
	#SERVER_LOCK_DECLARE
 
	`LOCK_DECLARE
(
gr_£rvî_muãx
);

	)

151 
	#SERVER_LOCK_INIT
(Ë
	`LOCK_INIT
(&
gr_£rvî_muãx
)

	)

152 
	#SERVER_LOCK
(Ë
	`LOCK
(&
gr_£rvî_muãx
)

	)

153 
	#SERVER_UNLOCK
(Ë
	`UNLOCK
(&
gr_£rvî_muãx
)

	)

158 
	#SERVER_LOCK_DECLARE


	)

159 
	#SERVER_LOCK_INIT
(Ëdÿ{} 0Ë

	)

160 
	#SERVER_LOCK
(Ëdÿ{} 0Ë

	)

161 
	#SERVER_UNLOCK
(Ëdÿ{} 0Ë

	)

169 
	tGR_DRAW_TYPE
;

171 
	#GR_DRAW_TYPE_NONE
 0

	)

172 
	#GR_DRAW_TYPE_WINDOW
 1

	)

173 
	#GR_DRAW_TYPE_PIXMAP
 2

	)

175 
	#GR_MAX_MODE
 
MWMODE_MAX


	)

179 
gr_evít_li°
 
	tGR_EVENT_LIST
;

180 
	sgr_evít_li°
 {

181 
GR_EVENT_LIST
 *
	m√xt
;

182 
GR_EVENT
 
	mevít
;

188 
gr_˛õ¡
 
	tGR_CLIENT
;

189 
	sgr_˛õ¡
 {

190 
	mid
;

191 
GR_EVENT_LIST
 *
	mevíthód
;

192 
GR_EVENT_LIST
 *
	mevíâaû
;

193 
GR_CLIENT
 *
	m√xt
;

194 
GR_CLIENT
 *
	m¥ev
;

195 
	mwaôög_f‹_evít
;

196 *
	mshm_cmds
;

197 
	mshm_cmds_size
;

198 
	mshm_cmds_shmid
;

199 
	m¥o˚ssid
;

205 
gr_evít_˛õ¡
 
	tGR_EVENT_CLIENT
;

206 
	sgr_evít_˛õ¡
 {

207 
GR_EVENT_CLIENT
 *
	m√xt
;

208 
GR_EVENT_MASK
 
	mevítmask
;

209 
GR_CLIENT
 *
	m˛õ¡
;

215 
gr_gc
 
	tGR_GC
;

216 
	sgr_gc
 {

217 
GR_GC_ID
 
	mid
;

218 
	mmode
;

219 
GR_REGION_ID
 
	mªgi⁄id
;

220 
GR_COORD
 
	mxoff
;

221 
GR_COORD
 
	myoff
;

222 
GR_FONT_ID
 
	mf⁄tid
;

223 
GR_COLOR
 
	mf‹eground
;

224 
GR_COLOR
 
	mbackground
;

225 
GR_BOOL
 
	mfgi•ixñvÆ
;

226 
GR_BOOL
 
	mbgi•ixñvÆ
;

227 
GR_BOOL
 
	mu£background
;

228 
GR_BOOL
 
	mexposuª
;

230 
	mlöe°yÀ
;

231 
	mdashmask
;

232 
	mdashcou¡
;

234 
	mfûlmode
;

235 
GR_STIPPLE
 
	m°ù∂e
;

237 
PSD
 
	mpsd
;

238 
GR_SIZE
 
	mwidth
;

239 
GR_SIZE
 
	mheight
;

240 } 
	mtûe
;

241 
GR_POINT
 
	mts_off£t
;

243 
GR_BOOL
 
	mch™ged
;

244 
GR_CLIENT
 *
	mow√r
;

245 
GR_GC
 *
	m√xt
;

251 
gr_ªgi⁄
 
	tGR_REGION
;

252 
	sgr_ªgi⁄
 {

253 
MWCLIPREGION
 * 
	mrgn
;

254 
GR_REGION_ID
 
	mid
;

255 
GR_CLIENT
 * 
	mow√r
;

256 
GR_REGION
 * 
	m√xt
;

262 
gr_f⁄t
 
	tGR_FONT
;

263 
	sgr_f⁄t
 {

264 
PMWFONT
 
	mpf⁄t
;

265 
	mf⁄tsize
;

266 
GR_FONT_ID
 
	mid
;

267 
GR_CLIENT
 * 
	mow√r
;

268 
GR_FONT
 * 
	m√xt
;

274 
gr_curs‹
 
	tGR_CURSOR
;

275 
	sgr_curs‹
 {

276 
GR_CURSOR_ID
 
	mid
;

277 
GR_CLIENT
 *
	mow√r
;

278 
GR_CURSOR
 *
	m√xt
;

279 
MWCURSOR
 
	mcurs‹
;

286 
GR_WINDOW_ID
 
	mwid
;

287 
GR_CHAR
 *
	mty≥li°
;

288 } 
	tGR_SELECTIONOWNER
;

291 #i‡
MW_FEATURE_IMAGES


295 
gr_image
 
	tGR_IMAGE
;

296 
	sgr_image
 {

297 
GR_IMAGE_ID
 
	mid
;

298 
GR_CLIENT
 * 
	mow√r
;

299 
GR_IMAGE
 * 
	m√xt
;

303 #i‡
MW_FEATURE_TIMERS


307 
gr_timî
 
	tGR_TIMER
;

308 
	sgr_timî


310 
GR_TIMER_ID
 
	mid
;

311 
GR_CLIENT
 *
	mow√r
;

312 
GR_WINDOW_ID
 
	mwid
;

313 
MWTIMER
 *
	mtimî
;

314 
GR_TIMER
 *
	m√xt
;

325 
	sgr_døwabÀ
 {

326 
GR_COORD
 
	mx
;

327 
GR_COORD
 
	my
;

328 
GR_SIZE
 
	mwidth
;

329 
GR_SIZE
 
	mheight
;

330 
_mws¸ìndevi˚
 *
	mpsd
;

331 
GR_WINDOW_ID
 
	mid
;

332 } 
	tGR_DRAWABLE
;

338 
gr_pixm≠
 
	tGR_PIXMAP
;

339 
gr_wödow
 
	tGR_WINDOW
;

340 
	sgr_wödow
 {

341 
GR_COORD
 
	mx
;

342 
GR_COORD
 
	my
;

343 
GR_SIZE
 
	mwidth
;

344 
GR_SIZE
 
	mheight
;

345 
_mws¸ìndevi˚
 *
	mpsd
;

346 
GR_WINDOW_ID
 
	mid
;

349 
GR_WINDOW
 *
	m√xt
;

350 
GR_CLIENT
 *
	mow√r
;

351 
GR_WINDOW
 *
	m∑ª¡
;

352 
GR_WINDOW
 *
	mchûdªn
;

353 
GR_WINDOW
 *
	msiblögs
;

354 
GR_SIZE
 
	mb‹dîsize
;

355 
GR_COLOR
 
	mb‹dîcﬁ‹
;

356 
GR_COLOR
 
	mbackground
;

357 
GR_PIXMAP
 *
	mbgpixm≠
;

358 
	mbgpixm≠Êags
;

359 
GR_EVENT_MASK
 
	mn›r›mask
;

360 
GR_EVENT_CLIENT
 *
	mevít˛õ¡s
;

361 
GR_CURSOR_ID
 
	mcurs‹id
;

362 
GR_BOOL
 
	mm≠≥d
;

363 
GR_BOOL
 
	mªÆized
;

364 
GR_BOOL
 
	mouçut
;

365 
GR_WM_PROPS
 
	m¥›s
;

366 
GR_CHAR
 *
	mtôÀ
;

367 
MWCLIPREGION
 *
	m˛ùªgi⁄
;

374 
	sgr_pixm≠
 {

375 
GR_COORD
 
	mx
;

376 
GR_COORD
 
	my
;

377 
GR_SIZE
 
	mwidth
;

378 
GR_SIZE
 
	mheight
;

379 
_mws¸ìndevi˚
 *
	mpsd
;

380 
GR_WINDOW_ID
 
	mid
;

383 
GR_PIXMAP
 *
	m√xt
;

384 
GR_CLIENT
 *
	mow√r
;

390 
gr_gøbbed_key
 
	tGR_GRABBED_KEY
;

391 
	sgr_gøbbed_key
 {

392 
GR_GRABBED_KEY
 *
	m√xt
;

393 
GR_CLIENT
 *
	mow√r
;

394 
	mty≥
;

395 
GR_WINDOW_ID
 
	mwid
;

396 
GR_KEY
 
	mkey
;

410 
GsInôülize
();

411 
GsClo£
(
fd
);

412 
GsSñe˘
(
GR_TIMEOUT
 
timeout
);

413 
GsTîmö©e
();

414 
GR_TIMEOUT
 
GsGëTickCou¡
();

415 
GsRedøwS¸ìn
();

416 
GsEº‹
(
GR_ERROR
 
code
, 
GR_ID
 
id
);

417 
GR_BOOL
 
GsCheckMou£Evít
();

418 
GR_BOOL
 
GsCheckKeybﬂrdEvít
();

419 
GsRódKeybﬂrd
(
GR_CHAR
 *
buf
, *
modifõrs
);

420 
GsO≥nKeybﬂrd
();

421 
GsGëBuâ⁄Info
(*
buâ⁄s
);

422 
GsGëModifõrInfo
(*
modifõrs
);

423 
GsClo£Keybﬂrd
();

424 
GsExpo£Aªa
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
roŸx
, GR_COORD 
roŸy
,

425 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_WINDOW
 *
°›wp
);

426 
GsCheckCurs‹
();

427 
GsWpNŸifyA˘iv©e
(
GR_WINDOW
 *
wp
);

428 
GsWpSëFocus
(
GR_WINDOW
 *
wp
);

429 
GsWpDøwBackgroundPixm≠
(
GR_WINDOW
 *
wp
, 
GR_PIXMAP
 *
pm
,

430 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
);

431 
GsWpTûeBackgroundPixm≠
(
GR_WINDOW
 *
wp
, 
GR_PIXMAP
 *
pm
,

432 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
);

433 
GsWpCÀ¨Wödow
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
x
, GR_COORD 
y
,

434 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_BOOL
 
expo£Êag
);

435 
GsWpUƒólizeWödow
(
GR_WINDOW
 *
wp
, 
GR_BOOL
 
ãmp_unm≠
);

436 
GsWpRólizeWödow
(
GR_WINDOW
 *
wp
, 
GR_BOOL
 
ãmp
);

437 
GsWpDe°royWödow
(
GR_WINDOW
 *
wp
);

438 
GsSëP‹åaôMode
(
mode
);

439 
GsSëP‹åaôModeFromXY
(
GR_COORD
 
roŸx
, GR_COORD 
roŸy
);

440 
GsSëClùWödow
(
GR_WINDOW
 *
wp
, 
MWCLIPREGION
 *
u£ºegi⁄
,

441 
Êags
);

442 
GsH™dÀMou£Sètus
(
GR_COORD
 
√wx
, GR_COORD 
√wy
,

443 
√wbuâ⁄s
);

444 
GsFªePosôi⁄Evít
(
GR_CLIENT
 *
˛õ¡
, 
GR_WINDOW_ID
 
wid
,

445 
GR_WINDOW_ID
 
subwid
);

446 
GsDñivîBuâ⁄Evít
(
GR_EVENT_TYPE
 
ty≥
, 
buâ⁄s
,

447 
ch™gebuâ⁄s
, 
modifõrs
);

448 
GsDñivîMŸi⁄Evít
(
GR_EVENT_TYPE
 
ty≥
, 
buâ⁄s
,

449 
MWKEYMOD
 
modifõrs
);

450 
GsDñivîKeybﬂrdEvít
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_TYPE
 
ty≥
,

451 
GR_KEY
 
keyvÆue
, 
GR_KEYMOD
 
modifõrs
,

452 
GR_SCANCODE
 
sˇncode
);

453 
GsDñivîExposuªEvít
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
x
, GR_COORD 
y
,

454 
GR_SIZE
 
width
, GR_SIZE 
height
);

455 
GsFªeExposuªEvít
(
GR_CLIENT
 *
˛õ¡
, 
GR_WINDOW_ID
 
wid
,

456 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
);

457 
GsDñivîUpd©eEvít
(
GR_WINDOW
 *
wp
, 
GR_UPDATE_TYPE
 
uty≥
,

458 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
);

459 
GsDñivîGíîÆEvít
(
GR_WINDOW
 *
wp
, 
GR_EVENT_TYPE
 
ty≥
,

460 
GR_WINDOW
 *
Ÿhî
);

461 
GsDñivîP‹åaôCh™gedEvít
();

462 
GsDñivîS¸ìnSavîEvít
(
GR_BOOL
 
a˘iv©e
);

463 
GsDñivîRawMou£Evít
(
x
, 
y
, 
buâ⁄s
, );

464 
GsDñivîClõ¡D©aReqEvít
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
,

465 
GR_SERIALNO
 
£rül
, 
GR_MIMETYPE
 
mimëy≥
);

466 
GsDñivîClõ¡D©aEvít
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
,

467 
GR_SERIALNO
 
£rül
, 
GR_LENGTH
 
Àn
, GR_LENGTH 
thi¶í
,

468 *
d©a
);

469 
GsDñivîSñe˘i⁄Ch™gedEvít
(
GR_WINDOW_ID
 
ﬁd_ow√r
,

470 
GR_WINDOW_ID
 
√w_ow√r
);

471 #i‡
MW_FEATURE_TIMERS


472 
GsDñivîTimîEvít
(
GR_CLIENT
 *
˛õ¡
, 
GR_WINDOW_ID
 
wid
,

473 
GR_TIMER_ID
 
tid
);

474 
GR_TIMER
 *
GsFödTimî
(
GR_TIMER_ID
 
timî_id
);

475 
GsTimîCB
(*
¨g
);

478 
GsCheckMou£Wödow
();

479 
GsCheckFocusWödow
();

480 
GR_DRAW_TYPE
 
GsPª∑ªDøwög
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gcid
,

481 
GR_DRAWABLE
 **
ªtdp
);

482 
GR_BOOL
 
GsCheckOvîœp
(
GR_WINDOW
 *
t›wp
, GR_WINDOW *
bŸwp
);

483 
GR_EVENT
 *
GsAŒocEvít
(
GR_CLIENT
 *
˛õ¡
);

484 
GR_WINDOW
 *
GsFödWödow
(
GR_WINDOW_ID
 
id
);

485 
GR_PIXMAP
 *
GsFödPixm≠
(
GR_WINDOW_ID
 
id
);

486 
GR_GC
 *
GsFödGC
(
GR_GC_ID
 
gcid
);

487 
GR_REGION
 *
GsFödRegi⁄
(
GR_REGION_ID
 
ªgi⁄id
);

488 
GR_FONT
 *
GsFödF⁄t
(
GR_FONT_ID
 
f⁄tid
);

489 
GR_CURSOR
 *
GsFödCurs‹
(
GR_CURSOR_ID
 
curs‹id
);

490 
GR_WINDOW
 *
GsPª∑ªWödow
(
GR_WINDOW_ID
 
wid
);

491 
GR_WINDOW
 *
GsFödVisibÀWödow
(
GR_COORD
 
x
, GR_COORD 
y
);

492 
GsDøwB‹dî
(
GR_WINDOW
 *
wp
);

493 
GsCuºítVt
();

494 
GsRedøwVt
(
t
);

495 
GsO≥nSockë
();

496 
GsClo£Sockë
();

497 
GsAc˚±Clõ¡
();

498 
GsAc˚±Clõ¡Fd
(
i
);

499 
GsPutCh
(
fd
, 
c
);

500 
GR_CLIENT
 *
GsFödClõ¡
(
fd
);

501 
GsDe°royClõ¡Resour˚s
(
GR_CLIENT
 * 
˛õ¡
);

502 
GsDr›Clõ¡
(
fd
);

503 
GsRód
(
fd
, *
buf
, 
c
);

504 
GsWrôe
(
fd
, *
buf
, 
c
);

505 
GsH™dÀClõ¡
(
fd
);

506 
GsRe£tS¸ìnSavî
();

507 
GsA˘iv©eS¸ìnSavî
(*
¨g
);

508 
GrGëNextEvítWøµîFöish
();

513 * 
curfunc
;

514 
GR_WINDOW_ID
 
ˇchewödowid
;

515 
GR_WINDOW_ID
 
ˇchïixm≠id
;

516 
GR_GC_ID
 
ˇchegcid
;

517 
GR_GC
 *
ˇcheg˝
;

518 
GR_GC
 *
li°g˝
;

519 
GR_REGION
 *
li°ªgi⁄p
;

520 
GR_FONT
 *
li°f⁄ç
;

521 #i‡
MW_FEATURE_IMAGES


522 
GR_IMAGE
 *
li°imagï
;

524 
GR_CURSOR
 *
li°curs‹p
;

525 
GR_CURSOR
 *
°dcurs‹
;

526 
GR_GC
 *
curg˝
;

527 
GR_WINDOW
 *
ˇchewp
;

528 
GR_PIXMAP
 *
ˇchïp
;

529 
GR_WINDOW
 *
li°wp
;

530 
GR_PIXMAP
 *
li°µ
;

531 
GR_WINDOW
 *
roŸwp
;

532 
GR_WINDOW
 *
˛ùwp
;

533 
GR_WINDOW
 *
focuswp
;

534 
GR_WINDOW
 *
mou£wp
;

535 
GR_WINDOW
 *
gøbbuâ⁄wp
;

536 
GR_CURSOR
 *
curcurs‹
;

537 
GR_COORD
 
curs‹x
;

538 
GR_COORD
 
curs‹y
;

539 
GR_BUTTON
 
curbuâ⁄s
;

540 
GR_CLIENT
 *
cur˛õ¡
;

541 *
cuºít_shm_cmds
;

542 
cuºít_shm_cmds_size
;

543 
GR_EVENT_LIST
 *
evít‰ì
;

544 
GR_BOOL
 
focusfixed
;

545 
GR_SCREEN_INFO
 
söfo
;

546 
PMWFONT
 
°df⁄t
;

547 
esˇ≥_quôs
;

548 
c⁄√˘cou¡
;

549 #i‡
MW_FEATURE_TIMERS


550 
GR_TIMEOUT
 
s¸ìnßvî_dñay
;

552 
GR_TIMER_ID
 
ˇche_timî_id
;

553 
GR_TIMER
 *
ˇche_timî
;

554 
GR_TIMER
 *
li°_timî
;

556 
GR_GRABBED_KEY
 *
li°_gøbbed_keys
;

558 
GR_BOOL
 
s¸ìnßvî_a˘ive
;

559 
GR_SELECTIONOWNER
 
£À˘i⁄_ow√r
;

560 
aut›‹åaô
;

561 
MWCOORD
 
nxªs
;

562 
MWCOORD
 
nyªs
;

569 
	#GR_NAMED_SOCKET
 "/tmp/.«no-X"

	)

570 
	#GR_NUM_SOCKET
 6600

	)

571 
	#GR_ELKS_SOCKET
 79

	)

573 #i‡
VTSWITCH


577 
MwInôVt
();

578 
MwCuºítVt
();

579 
MwCheckVtCh™ge
();

580 
MwRedøwVt
(
t
);

581 
MwExôVt
();

582 
mwvãrm
;

	@nanox/srvclip.c

1 
	~"devi˚.h
"

3 #i‡
DYNAMICREGIONS


4 
	~"§v˛ù2.c
"

6 
	~"§v˛ù1.c
"

	@nanox/srvclip1.c

7 
	~<°dio.h
>

8 
	~<°dlib.h
>

9 
	~"£rv.h
"

14 
	#GAPVAL
(
À·g≠
, 
rightg≠
, 
t›g≠
, 
bŸtomg≠
) \

15 (((
À·g≠
Ë<< 3Ë+ ((
rightg≠
Ë<< 2Ë+ ((
t›g≠
Ë<< 1Ë+ (
bŸtomg≠
))

	)

17 
GR_COUNT
 
GsS∂ôClùRe˘
(
MWCLIPRECT
 *
§¸e˘
, MWCLIPRECT *
de°ª˘
,

18 
GR_COORD
 
möx
, GR_COORD 
möy
, GR_COORD 
maxx
,

19 
GR_COORD
 
maxy
);

29 
	$GsSëClùWödow
(
GR_WINDOW
 *
wp
, 
MWCLIPREGION
 *
u£ºegi⁄
, 
Êags
)

31 
GR_WINDOW
 *
pwp
;

32 
GR_WINDOW
 *
sibwp
;

33 
MWCLIPRECT
 *
˛ù
;

34 
GR_COUNT
 
cou¡
;

35 
GR_COUNT
 
√wcou¡
;

36 
GR_COUNT
 
i
;

37 
GR_COORD
 
möx
;

38 
GR_COORD
 
möy
;

39 
GR_COORD
 
maxx
;

40 
GR_COORD
 
maxy
;

41 
GR_COORD
 
diff
;

42 
GR_SIZE
 
bs
;

43 
GR_BOOL
 
toom™y
;

44 
MWCLIPRECT
 
˛ùª˘s
[
MAX_CLIPRECTS
];

46 i‡(
wp
->
unm≠cou¡
 || !wp->
ouçut
 || (w∞=
˛ùwp
))

49 
˛ùwp
 = 
wp
;

55 
cou¡
 = 1;

56 
˛ù
 = 
˛ùª˘s
;

57 
˛ù
->
x
 = 
wp
->x;

58 
˛ù
->
y
 = 
wp
->y;

59 
˛ù
->
width
 = 
wp
->width;

60 
˛ù
->
height
 = 
wp
->height;

67 
pwp
 = 
wp
;

68 
pwp
 !
roŸwp
) {

69 
pwp
 =Öwp->
∑ª¡
;

71 
diff
 = 
pwp
->
x
 - 
˛ù
->x;

72 i‡(
diff
 > 0) {

73 
˛ù
->
width
 -
diff
;

74 
˛ù
->
x
 = 
pwp
->x;

77 
diff
 = (
pwp
->
x
 +Öwp->
width
Ë- (
˛ù
->x + clip->width);

78 i‡(
diff
 < 0)

79 
˛ù
->
width
 +
diff
;

81 
diff
 = 
pwp
->
y
 - 
˛ù
->y;

82 i‡(
diff
 > 0) {

83 
˛ù
->
height
 -
diff
;

84 
˛ù
->
y
 = 
pwp
->y;

87 
diff
 = (
pwp
->
y
 +Öwp->
height
Ë- (
˛ù
->y + clip->height);

88 i‡(
diff
 < 0)

89 
˛ù
->
height
 +
diff
;

96 i‡((
˛ù
->
width
 <0Ë|| (˛ù->
height
 <= 0)) {

97 
	`GdSëClùRe˘s
(
˛ùwp
->
psd
, 1, 
˛ùª˘s
);

108 
toom™y
 = 
GR_FALSE
;

109 
pwp
 = 
wp
;

111 
pwp
 !
NULL
) {

112 
wp
 = 
pwp
;

113 
pwp
 = 
wp
->
∑ª¡
;

115 if(!
pwp
) {

117 
sibwp
 = 
roŸwp
->
chûdªn
;

118 
wp
 = 
NULL
;

120 
sibwp
 = 
pwp
->
chûdªn
;

122 ; 
sibwp
 !
wp
; sibw∞sibwp->
siblögs
) {

123 i‡(
sibwp
->
unm≠cou¡
 || !sibwp->
ouçut
)

126 
bs
 = 
sibwp
->
b‹dîsize
;

127 
möx
 = 
sibwp
->
x
 - 
bs
;

128 
möy
 = 
sibwp
->
y
 - 
bs
;

129 
maxx
 = 
sibwp
->
x
 + sibwp->
width
 + 
bs
 - 1;

130 
maxy
 = 
sibwp
->
y
 + sibwp->
height
 + 
bs
 - 1;

132 
√wcou¡
 = 
cou¡
;

133 
i
 = 0; i < 
cou¡
; i++) {

134 i‡(
√wcou¡
 > 
MAX_CLIPRECTS
 - 3) {

135 
toom™y
 = 
GR_TRUE
;

138 
√wcou¡
 +
	`GsS∂ôClùRe˘
(&
˛ùª˘s
[
i
],

139 &
˛ùª˘s
[
√wcou¡
],

140 
möx
, 
möy
, 
maxx
, 
maxy
);

142 
cou¡
 = 
√wcou¡
;

144 if(
pwp
 =
roŸwp
)

148 i‡(
toom™y
) {

149 
	`GsEº‹
(
GR_ERROR_TOO_MUCH_CLIPPING
, 
wp
->
id
);

150 
˛ù
->
x
 = 0;

151 
˛ù
->
y
 = 0;

152 
˛ù
->
width
 = -1;

153 
˛ù
->
height
 = -1;

154 
cou¡
 = 1;

160 
	`GdSëClùRe˘s
(
˛ùwp
->
psd
, 
cou¡
, 
˛ùª˘s
);

161 
	}
}

175 
GR_COUNT


176 
	$GsS∂ôClùRe˘
(
MWCLIPRECT
 *
§¸e˘
, MWCLIPRECT *
de°ª˘
, 
GR_COORD
 
möx
,

177 
GR_COORD
 
möy
, GR_COORD 
maxx
, GR_COORD 
maxy
)

179 
GR_COORD
 
x
;

180 
GR_COORD
 
y
;

181 
GR_SIZE
 
width
;

182 
GR_SIZE
 
height
;

183 
GR_COORD
 
dx
;

184 
GR_COORD
 
dy
;

185 
g≠s
;

191 
x
 = 
§¸e˘
->x;

192 
y
 = 
§¸e˘
->y;

193 
width
 = 
§¸e˘
->width;

194 
height
 = 
§¸e˘
->height;

196 i‡((
möx
 > 
maxx
Ë|| (
möy
 > 
maxy
Ë|| (maxx < 
x
Ë|| (maxy < 
y
) ||

197 (
x
 + 
width
 <
möx
Ë|| (
y
 + 
height
 <
möy
))

206 
g≠s
 = 0;

207 i‡(
x
 < 
möx
)

208 
g≠s
 |
	`GAPVAL
(1, 0, 0, 0);

209 i‡(
x
 + 
width
 - 1 > 
maxx
)

210 
g≠s
 |
	`GAPVAL
(0, 1, 0, 0);

211 i‡(
y
 < 
möy
)

212 
g≠s
 |
	`GAPVAL
(0, 0, 1, 0);

213 i‡(
y
 + 
height
 - 1 > 
maxy
)

214 
g≠s
 |
	`GAPVAL
(0, 0, 0, 1);

216 
g≠s
) {

217 
	`GAPVAL
(0, 0, 0, 0):

218 
§¸e˘
->
x
 = 0;

219 
§¸e˘
->
y
 = 0;

220 
§¸e˘
->
width
 = 0;

221 
§¸e˘
->
height
 = 0;

224 
	`GAPVAL
(0, 0, 0, 1):

225 
dy
 = 
maxy
 - 
y
 + 1;

226 
§¸e˘
->
y
 +
dy
;

227 
§¸e˘
->
height
 -
dy
;

230 
	`GAPVAL
(0, 0, 1, 0):

231 
§¸e˘
->
height
 = 
möy
 - 
y
;

234 
	`GAPVAL
(0, 0, 1, 1):

235 
§¸e˘
->
height
 = 
möy
 - 
y
;

236 
de°ª˘
->
x
 = x;

237 
de°ª˘
->
width
 = width;

238 
de°ª˘
->
y
 = 
maxy
 + 1;

239 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

242 
	`GAPVAL
(0, 1, 0, 0):

243 
dx
 = 
maxx
 - 
x
 + 1;

244 
§¸e˘
->
x
 +
dx
;

245 
§¸e˘
->
width
 -
dx
;

248 
	`GAPVAL
(0, 1, 0, 1):

249 
dx
 = 
maxx
 - 
x
 + 1;

250 
§¸e˘
->
x
 +
dx
;

251 
§¸e˘
->
width
 -
dx
;

252 
§¸e˘
->
height
 = 
maxy
 - 
y
 + 1;

253 
de°ª˘
->
x
 = x;

254 
de°ª˘
->
width
 = width;

255 
de°ª˘
->
y
 = 
maxy
 + 1;

256 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

259 
	`GAPVAL
(0, 1, 1, 0):

260 
dx
 = 
maxx
 - 
x
 + 1;

261 
§¸e˘
->
height
 = 
möy
 - 
y
;

262 
de°ª˘
->
x
 = x + 
dx
;

263 
de°ª˘
->
width
 = width - 
dx
;

264 
de°ª˘
->
y
 = 
möy
;

265 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

268 
	`GAPVAL
(0, 1, 1, 1):

269 
dx
 = 
maxx
 - 
x
 + 1;

270 
§¸e˘
->
height
 = 
möy
 - 
y
;

271 
de°ª˘
->
x
 = x;

272 
de°ª˘
->
width
 = width;

273 
de°ª˘
->
y
 = 
maxy
 + 1;

274 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

275 
de°ª˘
++;

276 
de°ª˘
->
x
 = x + 
dx
;

277 
de°ª˘
->
width
 = width - 
dx
;

278 
de°ª˘
->
y
 = 
möy
;

279 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

282 
	`GAPVAL
(1, 0, 0, 0):

283 
§¸e˘
->
width
 = 
möx
 - 
x
;

286 
	`GAPVAL
(1, 0, 0, 1):

287 
§¸e˘
->
width
 = 
möx
 - 
x
;

288 
§¸e˘
->
height
 = 
maxy
 - 
y
 + 1;

289 
de°ª˘
->
x
 = x;

290 
de°ª˘
->
width
 = width;

291 
de°ª˘
->
y
 = 
maxy
 + 1;

292 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

295 
	`GAPVAL
(1, 0, 1, 0):

296 
§¸e˘
->
height
 = 
möy
 - 
y
;

297 
de°ª˘
->
x
 = x;

298 
de°ª˘
->
width
 = 
möx
 - 
x
;

299 
de°ª˘
->
y
 = 
möy
;

300 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

303 
	`GAPVAL
(1, 0, 1, 1):

304 
§¸e˘
->
height
 = 
möy
 - 
y
;

305 
de°ª˘
->
x
 = x;

306 
de°ª˘
->
width
 = 
möx
 - 
x
;

307 
de°ª˘
->
y
 = 
möy
;

308 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

309 
de°ª˘
++;

310 
de°ª˘
->
x
 = x;

311 
de°ª˘
->
width
 = width;

312 
de°ª˘
->
y
 = 
maxy
 + 1;

313 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

316 
	`GAPVAL
(1, 1, 0, 0):

317 
de°ª˘
->
x
 = 
maxx
 + 1;

318 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

319 
de°ª˘
->
y
 = y;

320 
de°ª˘
->
height
 = height;

321 
§¸e˘
->
width
 = 
möx
 - 
x
;

324 
	`GAPVAL
(1, 1, 0, 1):

325 
dy
 = 
maxy
 - 
y
 + 1;

326 
§¸e˘
->
y
 +
dy
;

327 
§¸e˘
->
height
 -
dy
;

328 
de°ª˘
->
x
 = x;

329 
de°ª˘
->
width
 = 
möx
 - 
x
;

330 
de°ª˘
->
y
 = y;

331 
de°ª˘
->
height
 = 
dy
;

332 
de°ª˘
++;

333 
de°ª˘
->
x
 = 
maxx
 + 1;

334 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

335 
de°ª˘
->
y
 = y;

336 
de°ª˘
->
height
 = 
dy
;

339 
	`GAPVAL
(1, 1, 1, 0):

340 
§¸e˘
->
height
 = 
möy
 - 
y
;

341 
de°ª˘
->
x
 = x;

342 
de°ª˘
->
width
 = 
möx
 - 
x
;

343 
de°ª˘
->
y
 = 
möy
;

344 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

345 
de°ª˘
++;

346 
de°ª˘
->
x
 = 
maxx
 + 1;

347 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

348 
de°ª˘
->
y
 = 
möy
;

349 
de°ª˘
->
height
 = 
y
 + heighà- 
möy
;

352 
	`GAPVAL
(1, 1, 1, 1):

353 
§¸e˘
->
height
 = 
möy
 - 
y
;

354 
de°ª˘
->
x
 = x;

355 
de°ª˘
->
width
 = 
möx
 - 
x
;

356 
de°ª˘
->
y
 = 
möy
;

357 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

358 
de°ª˘
++;

359 
de°ª˘
->
x
 = 
maxx
 + 1;

360 
de°ª˘
->
width
 = 
x
 + width - 
maxx
 - 1;

361 
de°ª˘
->
y
 = 
möy
;

362 
de°ª˘
->
height
 = 
maxy
 - 
möy
 + 1;

363 
de°ª˘
++;

364 
de°ª˘
->
x
 = x;

365 
de°ª˘
->
width
 = width;

366 
de°ª˘
->
y
 = 
maxy
 + 1;

367 
de°ª˘
->
height
 = 
y
 + heighà- 
maxy
 - 1;

371 
	}
}

	@nanox/srvclip2.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~"£rv.h
"

22 
	$GsSëClùWödow
(
GR_WINDOW
 *
wp
, 
MWCLIPREGION
 *
u£ºegi⁄
, 
Êags
)

24 
GR_WINDOW
 *
‹gwp
;

25 
GR_WINDOW
 *
pwp
;

26 
GR_WINDOW
 *
sibwp
;

27 
GR_COORD
 
möx
;

28 
GR_COORD
 
möy
;

29 
GR_COORD
 
maxx
;

30 
GR_COORD
 
maxy
;

31 
GR_COORD
 
diff
;

32 
GR_SIZE
 
bs
;

33 
GR_COORD
 
x
, 
y
, 
width
, 
height
;

34 
MWCLIPREGION
 *
vis
, *
r
;

36 i‡(!
wp
->
ªÆized
 || !wp->
ouçut
)

39 
˛ùwp
 = 
wp
;

45 
x
 = 
wp
->x;

46 
y
 = 
wp
->y;

47 
width
 = 
wp
->width;

48 
height
 = 
wp
->height;

55 
pwp
 = 
wp
;

56 
pwp
 !
roŸwp
) {

57 
pwp
 =Öwp->
∑ª¡
;

59 
diff
 = 
pwp
->
x
 - x;

60 i‡(
diff
 > 0) {

61 
width
 -
diff
;

62 
x
 = 
pwp
->x;

65 
diff
 = (
pwp
->
x
 +Öwp->
width
) - (x + width);

66 i‡(
diff
 < 0)

67 
width
 +
diff
;

69 
diff
 = 
pwp
->
y
 - y;

70 i‡(
diff
 > 0) {

71 
height
 -
diff
;

72 
y
 = 
pwp
->y;

75 
diff
 = (
pwp
->
y
 +Öwp->
height
) - (y + height);

76 i‡(
diff
 < 0)

77 
height
 +
diff
;

84 i‡(
width
 <0 || 
height
 <= 0) {

85 
	`GdSëClùRegi⁄
(
˛ùwp
->
psd
, 
NULL
);

93 
vis
 = 
	`GdAŒocRe˘Regi⁄
(
x
, 
y
, x+
width
, y+
height
);

94 i‡(
wp
->
˛ùªgi⁄
) {

95 
	`GdOff£tRegi⁄
(
wp
->
˛ùªgi⁄
, wp->
x
, wp->
y
);

96 
	`GdI¡î£˘Regi⁄
(
vis
, vis, 
wp
->
˛ùªgi⁄
);

97 
	`GdOff£tRegi⁄
(
wp
->
˛ùªgi⁄
, -wp->
x
, -wp->
y
);

103 
r
 = 
	`GdAŒocRegi⁄
();

112 
‹gwp
 = 
wp
;

113 
pwp
 = 
wp
;

114 
pwp
 !
NULL
) {

115 
wp
 = 
pwp
;

116 
pwp
 = 
wp
->
∑ª¡
;

118 if(!
pwp
) {

120 i‡(!(
Êags
 & 
GR_MODE_EXCLUDECHILDREN
))

122 
sibwp
 = 
roŸwp
->
chûdªn
;

123 
sibwp
 = 
NULL
;

124 
wp
 = 
NULL
;

126 
sibwp
 = 
pwp
->
chûdªn
;

129 ; 
sibwp
 !
wp
; sibw∞sibwp->
siblögs
) {

130 i‡(!
sibwp
->
ªÆized
 || !sibwp->
ouçut
)

133 
bs
 = 
sibwp
->
b‹dîsize
;

134 
möx
 = 
sibwp
->
x
 - 
bs
;

135 
möy
 = 
sibwp
->
y
 - 
bs
;

136 
maxx
 = 
sibwp
->
x
 + sibwp->
width
 + 
bs
;

137 
maxy
 = 
sibwp
->
y
 + sibwp->
height
 + 
bs
;

139 
	`GdSëRe˘Regi⁄
(
r
, 
möx
, 
möy
, 
maxx
, 
maxy
);

140 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
r
);

142 i‡(
sibwp
->
˛ùªgi⁄
) {

144 
	`GdOff£tRegi⁄
(
sibwp
->
˛ùªgi⁄
,

145 
sibwp
->
x
, sibwp->
y
);

146 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
sibwp
->
˛ùªgi⁄
);

147 
	`GdOff£tRegi⁄
(
sibwp
->
˛ùªgi⁄
,

148 -
sibwp
->
x
, -sibwp->
y
);

153 i‡(
pwp
 =
roŸwp
)

157 
wp
 = 
‹gwp
;

162 if(
wp
 !
roŸwp
 && !(
Êags
 & 
GR_MODE_EXCLUDECHILDREN
)) {

163 
sibwp
=
wp
->
chûdªn
; sibwp; sibw∞sibwp->
siblögs
) {

164 i‡(!
sibwp
->
ªÆized
 || !sibwp->
ouçut
)

167 
bs
 = 
sibwp
->
b‹dîsize
;

168 
möx
 = 
sibwp
->
x
 - 
bs
;

169 
möy
 = 
sibwp
->
y
 - 
bs
;

170 
maxx
 = 
sibwp
->
x
 + sibwp->
width
 + 
bs
;

171 
maxy
 = 
sibwp
->
y
 + sibwp->
height
 + 
bs
;

173 
	`GdSëRe˘Regi⁄
(
r
, 
möx
, 
möy
, 
maxx
, 
maxy
);

174 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
r
);

176 i‡(
wp
->
˛ùªgi⁄
) {

178 
	`GdOff£tRegi⁄
(
sibwp
->
˛ùªgi⁄
,

179 
sibwp
->
x
, sibwp->
y
);

180 
	`GdSubåa˘Regi⁄
(
vis
, vis, 
sibwp
->
˛ùªgi⁄
);

181 
	`GdOff£tRegi⁄
(
sibwp
->
˛ùªgi⁄
,

182 -
sibwp
->
x
, -sibwp->
y
);

190 i‡(
u£ºegi⁄
) {

192 
	`GdOff£tRegi⁄
(
u£ºegi⁄
, 
wp
->
x
, wp->
y
);

193 
	`GdI¡î£˘Regi⁄
(
vis
, vis, 
u£ºegi⁄
);

194 
	`GdOff£tRegi⁄
(
u£ºegi⁄
, -
wp
->
x
, -wp->
y
);

200 
	`GdSëClùRegi⁄
(
˛ùwp
->
psd
, 
vis
);

205 
	`GdDe°royRegi⁄
(
r
);

206 
	}
}

	@nanox/srvevent.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	~"£rv.h
"

15 *
	gnxEº‹Såögs
[] = {

16 
GR_ERROR_STRINGS


19 
MOUSEDEVICE
 
mou£dev
;

21 #i‡
NONETWORK


28 
GR_FNCALLBACKEVENT
 
	gEº‹Func
 = 
GrDeÁu…Eº‹H™dÀr
;

35 
	$GrDeÁu…Eº‹H™dÀr
(
GR_EVENT
 *
ï
)

37 i‡(
ï
->
ty≥
 =
GR_EVENT_TYPE_ERROR
) {

38 
	`EPRINTF
("nx˛õ¡: Eº‹ (%sË", 
ï
->
îr‹
.
«me
);

39 
	`EPRINTF
(
nxEº‹Såögs
[
ï
->
îr‹
.
code
],Ép->îr‹.
id
);

40 
	`GrClo£
();

41 
	`exô
(1);

43 
	}
}

51 
GR_FNCALLBACKEVENT


52 
	$GrSëEº‹H™dÀr
(
GR_FNCALLBACKEVENT
 
‚cb
)

54 
GR_FNCALLBACKEVENT
 
‹ig
;

56 
	`SERVER_LOCK
();

58 
‹ig
 = 
Eº‹Func
;

59 
Eº‹Func
 = 
‚cb
;

61 
	`SERVER_UNLOCK
();

63  
‹ig
;

64 
	}
}

76 
	$GsEº‹
(
GR_ERROR
 
code
, 
GR_ID
 
id
)

78 
GR_EVENT_ERROR
 *
ï
;

80 
	`EPRINTF
("nano-X: GsError ");

81 if(
curfunc
)

82 
	`EPRINTF
("(%sË", 
curfunc
);

83 
	`EPRINTF
(
nxEº‹Såögs
[
code
], 
id
);

86 i‡(!
cur˛õ¡
)

93 i‡(
code
 =
GR_ERROR_MALLOC_FAILED
)

97 
ï
 = (
GR_EVENT_ERROR
 *)
	`GsAŒocEvít
(
cur˛õ¡
);

98 
ï
->
ty≥
 = 
GR_EVENT_TYPE_ERROR
;

99 
ï
->
«me
[0] = 0;

100 if(
curfunc
) {

101 
	`°∫˝y
(
ï
->
«me
, 
curfunc
, (
GR_FUNC_NAME
));

102 
ï
->
«me
[(
GR_FUNC_NAME
)-1] = '\0';

104 
ï
->
code
 = code;

105 
ï
->
id
 = id;

106 
	}
}

114 
GR_EVENT
 *
	$GsAŒocEvít
(
GR_CLIENT
 *
˛õ¡
)

116 
GR_EVENT_LIST
 *
ñp
;

117 
GR_CLIENT
 *
ﬁdcur˛õ¡
;

123 
ñp
 = 
evít‰ì
;

124 i‡(
ñp
)

125 
evít‰ì
 = 
ñp
->
√xt
;

127 
ñp
 = (
GR_EVENT_LIST
 *Ë
	`mÆloc
((GR_EVENT_LIST));

128 i‡(
ñp
 =
NULL
) {

129 
ﬁdcur˛õ¡
 = 
cur˛õ¡
;

130 
cur˛õ¡
 = 
˛õ¡
;

131 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

132 
cur˛õ¡
 = 
ﬁdcur˛õ¡
;

133  
NULL
;

140 i‡(
˛õ¡
->
evíthód
)

141 i‡(!
˛õ¡
->
evíâaû
)

142 
˛õ¡
->
evíâaû
 = 
ñp
;

144 
˛õ¡
->
evíâaû
->
√xt
 = 
ñp
;

146 
˛õ¡
->
evíthód
 = 
ñp
;

148 
˛õ¡
->
evíâaû
 = 
ñp
;

149 
ñp
->
√xt
 = 
NULL
;

150 
ñp
->
evít
.
ty≥
 = 
GR_EVENT_TYPE_NONE
;

152  &
ñp
->
evít
;

153 
	}
}

160 
GR_BOOL
 
	$GsCheckMou£Evít
()

162 
GR_COORD
 
roŸx
;

163 
GR_COORD
 
roŸy
;

164 
√wbuâ⁄s
;

165 
mou£°©us
;

168 
mou£°©us
 = 
	`GdRódMou£
(&
roŸx
, &
roŸy
, &
√wbuâ⁄s
);

169 if(
mou£°©us
 < 0) {

170 
	`GsEº‹
(
GR_ERROR_MOUSE_ERROR
, 0);

171  
FALSE
;

172 } if(
mou£°©us
) {

173 
	`GsH™dÀMou£Sètus
(
roŸx
, 
roŸy
, 
√wbuâ⁄s
);

176 i‡(
aut›‹åaô
)

177 
	`GsSëP‹åaôModeFromXY
(
roŸx
, 
roŸy
);

178  
TRUE
;

180  
FALSE
;

181 
	}
}

188 
GR_BOOL
 
	$GsCheckKeybﬂrdEvít
()

190 
MWKEY
 
mwkey
;

191 
MWKEYMOD
 
modifõrs
;

192 
MWSCANCODE
 
sˇncode
;

193 
key°©us
;

196 
key°©us
 = 
	`GdRódKeybﬂrd
(&
mwkey
, &
modifõrs
, &
sˇncode
);

198 if(
key°©us
 < 0) {

199 if(
key°©us
 == -2)

200 
	`GsTîmö©e
();

201 
	`GsEº‹
(
GR_ERROR_KEYBOARD_ERROR
, 0);

202  
FALSE
;

203 } if(
key°©us
) {

204 
mwkey
) {

205 
MWKEY_QUIT
:

206 
	`GsTîmö©e
();

208 
MWKEY_REDRAW
:

209 
	`GsRedøwS¸ìn
();

211 
MWKEY_PRINT
:

212 i‡(
key°©us
 == 1)

213 
	`GdC≠tuªS¸ìn
("screen.bmp");

217 
	`GsDñivîKeybﬂrdEvít
(0,

218 (
key°©us
==1?

219 
GR_EVENT_TYPE_KEY_DOWN
: 
GR_EVENT_TYPE_KEY_UP
),

220 
mwkey
, 
modifõrs
, 
sˇncode
);

221  
TRUE
;

223  
FALSE
;

224 
	}
}

231 
	$GsH™dÀMou£Sètus
(
GR_COORD
 
√wx
, GR_COORD 
√wy
, 
√wbuâ⁄s
)

233 
ch™gebuâ⁄s
;

234 
MWKEYMOD
 
modifõrs
;

236 
	`GdGëModifõrInfo
(
NULL
, &
modifõrs
);

239 i‡(
mou£dev
.
Êags
 & 
MOUSE_RAW
) {

240 
	`GsDñivîRawMou£Evít
(
√wx
, 
√wy
, 
√wbuâ⁄s
, 
modifõrs
);

251 i‡((
√wx
 !
curs‹x
Ë|| (
√wy
 !
curs‹y
)) {

252 
	`GsRe£tS¸ìnSavî
();

253 
	`GrMoveCurs‹
(
√wx
, 
√wy
);

255 
	`GsDñivîMŸi⁄Evít
(
GR_EVENT_TYPE_MOUSE_MOTION
,

256 
√wbuâ⁄s
, 
modifõrs
);

257 
	`GsDñivîMŸi⁄Evít
(
GR_EVENT_TYPE_MOUSE_POSITION
,

258 
√wbuâ⁄s
, 
modifõrs
);

264 
ch™gebuâ⁄s
 = (
curbuâ⁄s
 & ~
√wbuâ⁄s
);

265 i‡(
ch™gebuâ⁄s
) {

267 
	`GsRe£tS¸ìnSavî
();

268 
	`GsDñivîBuâ⁄Evít
(
GR_EVENT_TYPE_BUTTON_UP
,

269 
√wbuâ⁄s
, 
ch™gebuâ⁄s
, 
modifõrs
);

276 
ch™gebuâ⁄s
 = (~
curbuâ⁄s
 & 
√wbuâ⁄s
);

277 i‡(
ch™gebuâ⁄s
) {

278 i‡((
√wbuâ⁄s
&(
GR_BUTTON_L
|
GR_BUTTON_R
)) == (GR_BUTTON_L|GR_BUTTON_R))

279 
	`GsTîmö©e
();

280 
	`GsRe£tS¸ìnSavî
();

281 
	`GsDñivîBuâ⁄Evít
(
GR_EVENT_TYPE_BUTTON_DOWN
,

282 
√wbuâ⁄s
, 
ch™gebuâ⁄s
, 
modifõrs
);

285 
curbuâ⁄s
 = 
√wbuâ⁄s
;

286 
	}
}

303 
	$GsDñivîBuâ⁄Evít
(
GR_EVENT_TYPE
 
ty≥
, 
buâ⁄s
, 
ch™gebuâ⁄s
,

304 
modifõrs
)

306 
GR_EVENT_BUTTON
 *
ï
;

307 
GR_WINDOW
 *
wp
;

308 
GR_EVENT_CLIENT
 *
e˝
;

309 
GR_CLIENT
 *
˛õ¡
;

310 
GR_WINDOW_ID
 
subwid
;

311 
GR_EVENT_MASK
 
evítmask
;

312 
GR_EVENT_MASK
 
ãmpmask
;

314 
evítmask
 = 
	`GR_EVENTMASK
(
ty≥
);

315 i‡(
evítmask
 == 0)

324 
wp
 = 
mou£wp
;

325 
subwid
 = 
wp
->
id
;

327 i‡(
gøbbuâ⁄wp
) {

329 (
wp
 !
roŸwp
Ë&& (w∞!
gøbbuâ⁄wp
))

330 
wp
 = wp->
∑ª¡
;

331 i‡(
wp
 !
gøbbuâ⁄wp
)

332 
subwid
 = 
gøbbuâ⁄wp
->
id
;

334 
wp
 = 
gøbbuâ⁄wp
;

338 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

339 i‡((
e˝
->
evítmask
 &Éventmask) == 0)

342 
˛õ¡
 = 
e˝
->client;

350 i‡((
ty≥
 =
GR_EVENT_TYPE_BUTTON_DOWN
)

351 && (
gøbbuâ⁄wp
 =
NULL
))

353 
ãmpmask
 = 
GR_EVENT_MASK_BUTTON_UP
;

354 i‡(
e˝
->
evítmask
 & 
ãmpmask
) {

355 
	`DPRINTF
("«no-X: im∂icô gøb o¿wödow %d\n", 
wp
->
id
);

356 
gøbbuâ⁄wp
 = 
wp
;

360 
ï
 = (
GR_EVENT_BUTTON
 *Ë
	`GsAŒocEvít
(
˛õ¡
);

361 i‡(
ï
 =
NULL
)

364 
ï
->
ty≥
 =Åype;

365 
ï
->
wid
 = 
wp
->
id
;

366 
ï
->
subwid
 = subwid;

367 
ï
->
roŸx
 = 
curs‹x
;

368 
ï
->
roŸy
 = 
curs‹y
;

369 
ï
->
x
 = 
curs‹x
 - 
wp
->x;

370 
ï
->
y
 = 
curs‹y
 - 
wp
->y;

371 
ï
->
buâ⁄s
 = buttons;

372 
ï
->
ch™gebuâ⁄s
 = changebuttons;

373 
ï
->
modifõrs
 = modifiers;

374 
ï
->
time
 = 
	`GsGëTickCou¡
();

382 i‡(
gøbbuâ⁄wp
) {

383 i‡(
buâ⁄s
 == 0) {

384 
	`DPRINTF
("«no-X: im∂icô ungøb o¿wödow %d\n", 
gøbbuâ⁄wp
->
id
);

385 
gøbbuâ⁄wp
 = 
NULL
;

386 
	`GrMoveCurs‹
(
curs‹x
, 
curs‹y
);

391 i‡((
wp
 =
roŸwp
Ë|| (wp->
n›r›mask
 & 
evítmask
))

394 
wp
 = wp->
∑ª¡
;

396 
	}
}

412 
	$GsDñivîMŸi⁄Evít
(
GR_EVENT_TYPE
 
ty≥
, 
buâ⁄s
, 
MWKEYMOD
 
modifõrs
)

414 
GR_EVENT_MOUSE
 *
ï
;

415 
GR_WINDOW
 *
wp
;

416 
GR_EVENT_CLIENT
 *
e˝
;

417 
GR_CLIENT
 *
˛õ¡
;

418 
GR_WINDOW_ID
 
subwid
;

419 
GR_EVENT_MASK
 
evítmask
;

421 
evítmask
 = 
	`GR_EVENTMASK
(
ty≥
);

422 i‡(
evítmask
 == 0)

425 
wp
 = 
mou£wp
;

426 
subwid
 = 
wp
->
id
;

428 i‡(
gøbbuâ⁄wp
) {

430 (
wp
 !
roŸwp
Ë&& (w∞!
gøbbuâ⁄wp
))

431 
wp
 = wp->
∑ª¡
;

432 i‡(
wp
 !
gøbbuâ⁄wp
)

433 
subwid
 = 
gøbbuâ⁄wp
->
id
;

435 
wp
 = 
gøbbuâ⁄wp
;

439 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

440 i‡((
e˝
->
evítmask
 &Éventmask) == 0)

443 
˛õ¡
 = 
e˝
->client;

450 i‡(
ty≥
 =
GR_EVENT_TYPE_MOUSE_POSITION
)

451 
	`GsFªePosôi⁄Evít
(
˛õ¡
, 
wp
->
id
, 
subwid
);

453 
ï
 = (
GR_EVENT_MOUSE
 *Ë
	`GsAŒocEvít
(
˛õ¡
);

454 i‡(
ï
 =
NULL
)

457 
ï
->
ty≥
 =Åype;

458 
ï
->
wid
 = 
wp
->
id
;

459 
ï
->
subwid
 = subwid;

460 
ï
->
roŸx
 = 
curs‹x
;

461 
ï
->
roŸy
 = 
curs‹y
;

462 
ï
->
x
 = 
curs‹x
 - 
wp
->x;

463 
ï
->
y
 = 
curs‹y
 - 
wp
->y;

464 
ï
->
buâ⁄s
 = buttons;

465 
ï
->
modifõrs
 = modifiers;

468 i‡((
wp
 =
roŸwp
Ë|| 
gøbbuâ⁄wp
 ||

469 (
wp
->
n›r›mask
 & 
evítmask
))

472 
wp
 = wp->
∑ª¡
;

474 
	}
}

486 
	$GsDñivîKeybﬂrdEvít
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_TYPE
 
ty≥
,

487 
GR_KEY
 
keyvÆue
, 
GR_KEYMOD
 
modifõrs
, 
GR_SCANCODE
 
sˇncode
)

489 
GR_EVENT_KEYSTROKE
 *
ï
;

490 
GR_WINDOW
 *
wp
;

491 
GR_WINDOW
 *
ãmpwp
;

492 
GR_EVENT_CLIENT
 *
e˝
;

493 
GR_WINDOW_ID
 
subwid
;

494 
GR_EVENT_MASK
 
evítmask
;

495 
GR_WINDOW
 *
kwp
;

496 
GR_GRABBED_KEY
 *
keygøb
;

498 
evítmask
 = 
	`GR_EVENTMASK
(
ty≥
);

499 i‡(
evítmask
 == 0)

502 
	`GsRe£tS¸ìnSavî
();

517 
keygøb
 = 
li°_gøbbed_keys
; keygøb !
NULL
; keygøb = keygøb->
√xt
) {

518 i‡(
keygøb
->
key
 =
keyvÆue
) {

519 i‡((
keygøb
->
ty≥
 =
GR_GRAB_HOTKEY
)

520 || (
keygøb
->
ty≥
 =
GR_GRAB_HOTKEY_EXCLUSIVE
)) {

521 
ï
 = (
GR_EVENT_KEYSTROKE
 *Ë
	`GsAŒocEvít
(
keygøb
->
ow√r
);

522 i‡(
ï
 =
NULL
)

525 
ï
->
ty≥
 =Åype;

526 
ï
->
wid
 = 
keygøb
->wid;

527 
ï
->
subwid
 = 
keygøb
->
wid
;

528 
ï
->
roŸx
 = 
curs‹x
;

529 
ï
->
roŸy
 = 
curs‹y
;

530 
ï
->
x
 = 
curs‹x
;

531 
ï
->
y
 = 
curs‹y
;

532 
ï
->
buâ⁄s
 = 
curbuâ⁄s
;

533 
ï
->
modifõrs
 = modifiers;

534 
ï
->
ch
 = 
keyvÆue
;

535 
ï
->
sˇncode
 = scancode;

536 
ï
->
hŸkey
 = 
GR_TRUE
;

537 i‡(
keygøb
->
ty≥
 =
GR_GRAB_HOTKEY_EXCLUSIVE
)

551 i‡(
keygøb
 !
NULL
) {

557 
wp
 = 
	`GsFödWödow
(
keygøb
->
wid
);

558 i‡(
wp
 =
NULL
)

562 
kwp
 = 
focuswp
;

563 
kwp
 !
wp
 && kw∞!
roŸwp
)

564 
kwp
 = kwp->
∑ª¡
;

571 i‡(
kwp
 !
wp
 && (
keygøb
->
ty≥
 !
GR_GRAB_EXCLUSIVE_MOUSE
 || w∞!
mou£wp
))

574 
subwid
 = 
wp
->
id
;

577 i‡(
wid
) {

578 
kwp
 = 
	`GsFödWödow
(
wid
);

579 i‡(!
kwp
)

582 
kwp
 = 
focuswp
;

583 
wp
 = 
mou£wp
;

584 
subwid
 = 
wp
->
id
;

591 
ãmpwp
 = 
wp
;

592 
ãmpwp
 !
kwp
 &&Åempw∞!
roŸwp
)

593 
ãmpwp
 =Åempwp->
∑ª¡
;

595 i‡(
ãmpwp
 !
kwp
) {

596 
wp
 = 
kwp
;

597 
subwid
 = 
wp
->
id
;

607 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

609 i‡((
e˝
->
evítmask
 &Éventmask) == 0)

612 
ï
 = (
GR_EVENT_KEYSTROKE
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

613 i‡(
ï
 =
NULL
)

616 
ï
->
ty≥
 =Åype;

617 
ï
->
wid
 = 
wp
->
id
;

618 
ï
->
subwid
 = subwid;

619 
ï
->
roŸx
 = 
curs‹x
;

620 
ï
->
roŸy
 = 
curs‹y
;

621 
ï
->
x
 = 
curs‹x
 - 
wp
->x;

622 
ï
->
y
 = 
curs‹y
 - 
wp
->y;

623 
ï
->
buâ⁄s
 = 
curbuâ⁄s
;

624 
ï
->
modifõrs
 = modifiers;

625 
ï
->
ch
 = 
keyvÆue
;

626 
ï
->
sˇncode
 = scancode;

627 
ï
->
hŸkey
 = 
GR_FALSE
;

631 i‡((
wp
 =
roŸwp
Ë|| (w∞=
kwp
) ||

632 (
wp
->
n›r›mask
 & 
evítmask
))

635 
wp
 = wp->
∑ª¡
;

637 
	}
}

645 
	$GsDñivîExposuªEvít
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
x
, GR_COORD 
y
,

646 
GR_SIZE
 
width
, GR_SIZE 
height
)

648 
GR_EVENT_EXPOSURE
 *
ï
;

649 
GR_EVENT_CLIENT
 *
e˝
;

651 i‡(!
wp
->
ªÆized
 || !wp->
ouçut
)

654 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

655 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_EXPOSURE
) == 0)

658 
	`GsFªeExposuªEvít
(
e˝
->
˛õ¡
, 
wp
->
id
, 
x
, 
y
, 
width
, 
height
);

660 
ï
 = (
GR_EVENT_EXPOSURE
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

661 i‡(
ï
 =
NULL
)

664 
ï
->
ty≥
 = 
GR_EVENT_TYPE_EXPOSURE
;

665 
ï
->
wid
 = 
wp
->
id
;

666 
ï
->
x
 = x;

667 
ï
->
y
 = y;

668 
ï
->
width
 = width;

669 
ï
->
height
 = height;

671 
	}
}

680 
	$GsFªeExposuªEvít
(
GR_CLIENT
 *
˛õ¡
, 
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
,

681 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

683 
GR_EVENT_LIST
 *
ñp
;

684 
GR_EVENT_LIST
 *
¥evñp
;

686 
¥evñp
 = 
NULL
;

687 
ñp
 = 
˛õ¡
->
evíthód
;ÉÕ; 
¥evñp
 =ÉÕ,ÉÕ =ÉÕ->
√xt
) {

688 i‡(
ñp
->
evít
.
ty≥
 !
GR_EVENT_TYPE_EXPOSURE
 ||

689 
ñp
->
evít
.
exposuª
.
wid
 != wid)

691 i‡(
ñp
->
evít
.
exposuª
.
x
 < x ||ÉÕ->evít.exposuª.
y
 < y ||

692 
ñp
->
evít
.
exposuª
.
x
+ñp->evít.exposuª.
width
 > x+width ||

693 
ñp
->
evít
.
exposuª
.
y
+ñp->evít.exposuª.
height
 > y+height)

699 i‡(
¥evñp
)

700 
¥evñp
->
√xt
 = 
ñp
->next;

702 
˛õ¡
->
evíthód
 = 
ñp
->
√xt
;

703 i‡(
˛õ¡
->
evíâaû
 =
ñp
)

704 
˛õ¡
->
evíâaû
 = 
¥evñp
;

706 
ñp
->
√xt
 = 
evít‰ì
;

707 
evít‰ì
 = 
ñp
;

710 
	}
}

716 
	$GsDñivîUpd©eEvít
(
GR_WINDOW
 *
wp
, 
GR_UPDATE_TYPE
 
uty≥
, 
GR_COORD
 
x
,

717 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

719 
GR_EVENT_MASK
 
cmask
 = 
GR_EVENT_MASK_UPDATE
;

720 
GR_EVENT_UPDATE
 *
ï
;

721 
GR_EVENT_CLIENT
 *
e˝
;

722 
GR_WINDOW_ID
 
id
 = 
wp
->id;

723 
lcou¡
 = 0;

726 i‡(
wp
->
∑ª¡
) {

727 
x
 -
wp
->
∑ª¡
->x;

728 
y
 -
wp
->
∑ª¡
->y;

731 
upd©e_agaö
:

732 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

733 i‡((
e˝
->
evítmask
 & 
cmask
) == 0)

736 
ï
 = (
GR_EVENT_UPDATE
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

737 i‡(
ï
 =
NULL
)

740 
ï
->
ty≥
 = 
lcou¡
?

741 
GR_EVENT_TYPE_CHLD_UPDATE
: 
GR_EVENT_TYPE_UPDATE
;

742 
ï
->
uty≥
 = utype;

743 
ï
->
wid
 = 
wp
->
id
;

744 
ï
->
subwid
 = 
id
;

745 
ï
->
x
 = x;

746 
ï
->
y
 = y;

747 
ï
->
width
 = width;

748 
ï
->
height
 = height;

753 i‡(!
lcou¡
++) {

754 
wp
 = wp->
∑ª¡
;

756 i‡(
wp
 =
NULL
)

758 
cmask
 = 
GR_EVENT_MASK_CHLD_UPDATE
;

759 
upd©e_agaö
;

761 
	}
}

769 
	$GsDñivîGíîÆEvít
(
GR_WINDOW
 *
wp
, 
GR_EVENT_TYPE
 
ty≥
, GR_WINDOW *
Ÿhî
)

771 
GR_EVENT_GENERAL
 *
gp
;

772 
GR_EVENT_CLIENT
 *
e˝
;

773 
GR_EVENT_MASK
 
evítmask
;

775 
evítmask
 = 
	`GR_EVENTMASK
(
ty≥
);

776 i‡(
evítmask
 == 0)

779 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

780 i‡((
e˝
->
evítmask
 &Éventmask) == 0)

783 
gp
 = (
GR_EVENT_GENERAL
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

784 i‡(
gp
 =
NULL
)

787 
gp
->
ty≥
 =Åype;

788 
gp
->
wid
 = 
wp
->
id
;

789 i‡(
Ÿhî
)

790 
gp
->
Ÿhîid
 = 
Ÿhî
->
id
;

791 
gp
->
Ÿhîid
 = 0;

793 
	}
}

800 
	$GsDñivîP‹åaôCh™gedEvít
()

802 
GR_WINDOW
 *
wp
;

803 
GR_EVENT_GENERAL
 *
gp
;

804 
GR_EVENT_CLIENT
 *
e˝
;

806 
wp
=
li°wp
; wp; wp=wp->
√xt
) {

807 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

808 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_PORTRAIT_CHANGED
) == 0)

811 
gp
 = (
GR_EVENT_GENERAL
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

812 i‡(
gp
 =
NULL
)

815 
gp
->
ty≥
 = 
GR_EVENT_TYPE_PORTRAIT_CHANGED
;

816 
gp
->
wid
 = 
wp
->
id
;

817 
gp
->
Ÿhîid
 = 0;

820 
	}
}

830 
	$GsDñivîS¸ìnSavîEvít
(
GR_BOOL
 
a˘iv©e
)

832 
GR_EVENT_SCREENSAVER
 *
gp
;

833 
GR_EVENT_CLIENT
 *
e˝
;

835 
e˝
 = 
roŸwp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

836 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_SCREENSAVER
) == 0)

839 
gp
 = (
GR_EVENT_SCREENSAVER
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

840 i‡(
gp
 =
NULL
)

843 
gp
->
ty≥
 = 
GR_EVENT_TYPE_SCREENSAVER
;

844 
gp
->
a˘iv©e
 =áctivate;

846 
	}
}

853 
	$GsDñivîClõ¡D©aReqEvít
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
,

854 
GR_SERIALNO
 
£rül
, 
GR_MIMETYPE
 
mimëy≥
)

856 
GR_EVENT_CLIENT_DATA_REQ
 *
gp
;

857 
GR_EVENT_CLIENT
 *
e˝
;

858 
GR_WINDOW
 *
wp
;

860 if(!(
wp
 = 
	`GsFödWödow
(
wid
)))

863 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

864 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_CLIENT_DATA_REQ
) == 0)

867 
gp
 = (
GR_EVENT_CLIENT_DATA_REQ
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

868 i‡(
gp
 =
NULL
)

871 
gp
->
ty≥
 = 
GR_EVENT_TYPE_CLIENT_DATA_REQ
;

872 
gp
->
wid
 = wid;

873 
gp
->
rid
 =Ñid;

874 
gp
->
£rül
 = serial;

875 
gp
->
mimëy≥
 = mimetype;

878 
	}
}

885 
	$GsDñivîClõ¡D©aEvít
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
,

886 
GR_SERIALNO
 
£rül
, 
GR_LENGTH
 
Àn
, GR_LENGTH 
thi¶í
, *
d©a
)

888 
GR_EVENT_CLIENT_DATA
 *
gp
;

889 
GR_EVENT_CLIENT
 *
e˝
;

890 
GR_WINDOW
 *
wp
;

892 if(!(
wp
 = 
	`GsFödWödow
(
wid
)))

895 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

896 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_CLIENT_DATA
) == 0)

899 
gp
 = (
GR_EVENT_CLIENT_DATA
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

900 i‡(
gp
 =
NULL
)

903 
gp
->
ty≥
 = 
GR_EVENT_TYPE_CLIENT_DATA
;

904 
gp
->
wid
 = wid;

905 
gp
->
rid
 =Ñid;

906 
gp
->
£rül
 = serial;

907 
gp
->
Àn
 =Üen;

908 
gp
->
d©Æí
 = 
thi¶í
;

909 if(!(
gp
->
d©a
 = 
	`mÆloc
(
thi¶í
))) {

910 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 
wid
);

913 
	`mem˝y
(
gp
->
d©a
, d©a, 
thi¶í
);

916 
	}
}

925 
	$GsFªePosôi⁄Evít
(
GR_CLIENT
 *
˛õ¡
, 
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
subwid
)

927 
GR_EVENT_LIST
 *
ñp
;

928 
GR_EVENT_LIST
 *
¥evñp
;

930 
¥evñp
 = 
NULL
;

931 
ñp
 = 
˛õ¡
->
evíthód
;ÉÕ; 
¥evñp
 =ÉÕ,ÉÕ =ÉÕ->
√xt
) {

932 i‡(
ñp
->
evít
.
ty≥
 !
GR_EVENT_TYPE_MOUSE_POSITION
)

934 i‡(
ñp
->
evít
.
mou£
.
wid
 != wid)

936 i‡(
ñp
->
evít
.
mou£
.
subwid
 != subwid)

942 i‡(
¥evñp
)

943 
¥evñp
->
√xt
 = 
ñp
->next;

945 
˛õ¡
->
evíthód
 = 
ñp
->
√xt
;

946 i‡(
˛õ¡
->
evíâaû
 =
ñp
)

947 
˛õ¡
->
evíâaû
 = 
¥evñp
;

949 
ñp
->
√xt
 = 
evít‰ì
;

950 
evít‰ì
 = 
ñp
;

953 
	}
}

962 
	$GsDñivîSñe˘i⁄Ch™gedEvít
(
GR_WINDOW_ID
 
ﬁd_ow√r
, GR_WINDOW_ID 
√w_ow√r
)

964 
GR_EVENT_SELECTION_CHANGED
 *
gp
;

965 
GR_EVENT_CLIENT
 *
e˝
;

966 
GR_WINDOW
 *
wp
;

968 if(!(
wp
 = 
	`GsFödWödow
(
ﬁd_ow√r
)))

971 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

972 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_SELECTION_CHANGED
) == 0)

975 
gp
 = (
GR_EVENT_SELECTION_CHANGED
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

976 i‡(
gp
 =
NULL
)

979 
gp
->
ty≥
 = 
GR_EVENT_TYPE_SELECTION_CHANGED
;

980 
gp
->
√w_ow√r
 =Çew_owner;

982 
	}
}

989 
	$GsDñivîRawMou£Evít
(
rx
, 
ry
, 
buâ⁄s
, 
modifõrs
)

991 
i
;

993 
GR_WINDOW
 *
wp
;

994 
GR_CLIENT
 *
˛õ¡
;

995 
GR_WINDOW_ID
 
subwid
;

997 
GR_EVENT_CLIENT
 *
e˝
;

1002 
wp
 = 
mou£wp
;

1003 
subwid
 = 
wp
->
id
;

1005 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

1006 
GR_EVENT_MOUSE
 *
ï
;

1008 i‡((
e˝
->
evítmask
 & 
GR_EVENT_MASK_MOUSE_POSITION
) == 0)

1011 
˛õ¡
 = 
e˝
->client;

1013 
	`GsFªePosôi⁄Evít
(
˛õ¡
, 
wp
->
id
, 
subwid
);

1015 
ï
 = (
GR_EVENT_MOUSE
 *Ë
	`GsAŒocEvít
(
˛õ¡
);

1016 i‡(
ï
 =
NULL
)

1019 
ï
->
ty≥
 = 
GR_EVENT_TYPE_MOUSE_POSITION
;

1020 
ï
->
wid
 = 
wp
->
id
;

1021 
ï
->
subwid
 = subwid;

1022 
ï
->
roŸx
 = 
rx
;

1023 
ï
->
roŸy
 = 
ry
;

1024 
ï
->
x
 = 0;

1025 
ï
->
y
 = 0;

1026 
ï
->
buâ⁄s
 = buttons;

1027 
ï
->
modifõrs
 = modifiers;

1029 i‡((
wp
 =
roŸwp
)

1030 || (
wp
->
n›r›mask
 & 
GR_EVENT_MASK_MOUSE_POSITION
))

1033 
wp
 = wp->
∑ª¡
;

1037 
i
 = 0; i < 2; i++) {

1038 
GR_EVENT_BUTTON
 *
gp
;

1039 
cbuâ⁄s
 = 0;

1040 
GR_EVENT_TYPE
 
ëy≥
 = (
i
 =0Ë? 
GR_EVENT_TYPE_BUTTON_DOWN
 :

1041 
GR_EVENT_TYPE_BUTTON_UP
;

1043 i‡(
i
 == 0)

1044 
cbuâ⁄s
 = (
curbuâ⁄s
 & ~
buâ⁄s
);

1046 
cbuâ⁄s
 = (~
buâ⁄s
 & 
curbuâ⁄s
);

1047 i‡(!
cbuâ⁄s
)

1050 
wp
 = 
mou£wp
;

1051 
subwid
 = 
wp
->
id
;

1053 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

1054 
˛õ¡
 = 
e˝
->client;

1056 i‡((
e˝
->
evítmask
 & 
	`GR_EVENTMASK
(
ëy≥
)) == 0)

1059 
gp
 = (
GR_EVENT_BUTTON
 *Ë
	`GsAŒocEvít
(
e˝
->
˛õ¡
);

1061 i‡(
gp
 =
NULL
)

1064 
gp
->
ty≥
 = 
ëy≥
;

1065 
gp
->
wid
 = 
wp
->
id
;

1066 
gp
->
subwid
 = subwid;

1067 
gp
->
roŸx
 = 
rx
;

1068 
gp
->
roŸy
 = 
ry
;

1069 
gp
->
x
 = 0;

1070 
gp
->
y
 = 0;

1071 
gp
->
buâ⁄s
 = buttons;

1072 
gp
->
ch™gebuâ⁄s
 = 
cbuâ⁄s
;

1073 
gp
->
modifõrs
 = modifiers;

1074 
gp
->
time
 = 
	`GsGëTickCou¡
();

1076 i‡((
wp
 =
roŸwp
Ë|| (wp->
n›r›mask
 & 
	`GR_EVENTMASK
(
ëy≥
)))

1079 
wp
 = wp->
∑ª¡
;

1083 
curbuâ⁄s
 = 
buâ⁄s
;

1084 
	}
}

1087 
	$GsDñivîTimîEvít
(
GR_CLIENT
 * 
˛õ¡
, 
GR_WINDOW_ID
 
wid
, 
GR_TIMER_ID
 
tid
)

1089 
GR_EVENT_TIMER
 *
evít
;

1090 
GR_EVENT_CLIENT
 *
e˝
;

1091 
GR_WINDOW
 *
wp
;

1093 i‡((
wp
 = 
	`GsFödWödow
(
wid
)Ë=
NULL
)

1096 
e˝
 = 
wp
->
evít˛õ¡s
;É˝ !
NULL
;É˝ =É˝->
√xt
) {

1097 i‡((
e˝
->
˛õ¡
 == client)

1098 && ((
e˝
->
evítmask
 & 
GR_EVENT_MASK_TIMER
) != 0)) {

1099 
evít
 = (
GR_EVENT_TIMER
 *Ë
	`GsAŒocEvít
(
˛õ¡
);

1100 i‡(
evít
 =
NULL
)

1103 
evít
->
ty≥
 = 
GR_EVENT_TYPE_TIMER
;

1104 
evít
->
wid
 = wid;

1105 
evít
->
tid
 =Åid;

1108 
	}
}

	@nanox/srvfunc.c

9 
	~<°dio.h
>

10 
	~<°dlib.h
>

11 
	~<°rög.h
>

12 
	#MWINCLUDECOLORS


	)

13 
	~"£rv.h
"

15 
	g√xtid
 = 
GR_ROOT_WINDOW_ID
 + 1;

17 
CheckNextEvít
(
GR_EVENT
 *
ï
, 
GR_BOOL
 
doCheckEvít
);

23 
	$GrGëS¸ìnInfo
(
GR_SCREEN_INFO
 *
sù
)

25 
	`SERVER_LOCK
();

27 
	`GdGëS¸ìnInfo
(
roŸwp
->
psd
, 
sù
);

30 
sù
->
vs_width
 = 
nxªs
?Çxªs: sù->
cﬁs
;

31 
sù
->
vs_height
 = 
nyªs
?Çyªs: sù->
rows
;

34 
sù
->
ws_width
 = sù->
vs_width
;

35 
sù
->
ws_height
 = sù->
vs_height
 - 22;

37 
	`SERVER_UNLOCK
();

38 
	}
}

46 
	$GrGëGCTextSize
(
GR_GC_ID
 
gc
, *
°r
, 
cou¡
, 
GR_TEXTFLAGS
 
Êags
,

47 
GR_SIZE
 *
ªtwidth
, GR_SIZE *
ªtheight
, GR_SIZE *
ªtba£
)

49 
GR_GC
 *
g˝
;

50 
GR_FONT
 *
f⁄ç
;

51 
PMWFONT
 
pf
;

53 
	`SERVER_LOCK
();

55 
g˝
 = 
	`GsFödGC
(
gc
);

56 i‡(
g˝
 =
NULL
)

57 
f⁄ç
 = 
NULL
;

59 
f⁄ç
 = 
	`GsFödF⁄t
(
g˝
->
f⁄tid
);

60 
pf
 = 
f⁄ç
? f⁄ç->
pf⁄t
: 
°df⁄t
;

61 
	`GdGëTextSize
(
pf
, 
°r
, 
cou¡
, 
ªtwidth
, 
ªtheight
, 
ªtba£
, 
Êags
);

63 
	`SERVER_UNLOCK
();

64 
	}
}

66 #i‡
NONETWORK


74 
	$GrGëNextEvít
(
GR_EVENT
 *
ï
)

76 
	`GrGëNextEvítTimeout
(
ï
, 0L);

77 
	}
}

85 
	$GrGëNextEvítTimeout
(
GR_EVENT
 *
ï
, 
GR_TIMEOUT
 
timeout
)

87 
	`SERVER_LOCK
();

91 
cur˛õ¡
->
evíthód
 =
NULL
)

92 
	`GsSñe˘
(
timeout
);

93 
	`CheckNextEvít
(
ï
, 
GR_FALSE
);

94 
	`SERVER_UNLOCK
();

95 
	}
}

101 
	$GrPìkWaôEvít
(
GR_EVENT
 *
ï
)

103 
	`SERVER_LOCK
();

104 
cur˛õ¡
->
evíthód
 =
NULL
)

105 
	`GsSñe˘
(0L);

106 
	`GrPìkEvít
(
ï
);

107 
	`SERVER_UNLOCK
();

108 
	}
}

118 
	$GrCheckNextEvít
(
GR_EVENT
 *
ï
)

120 
	`SERVER_LOCK
();

121 
	`CheckNextEvít
(
ï
, 
GR_TRUE
);

122 
	`SERVER_UNLOCK
();

123 
	}
}

126 
	$CheckNextEvít
(
GR_EVENT
 *
ï
, 
GR_BOOL
 
doCheckEvít
)

128 
GR_EVENT_LIST
 * 
ñp
;

132 i‡(
doCheckEvít
)

133 
	`GsSñe˘
(1L);

136 if(!
	`GrPìkEvít
(
ï
))

140 
ñp
 = 
cur˛õ¡
->
evíthód
;

142 #i‡
NONETWORK


144 i‡(
doCheckEvít
 && 
ñp
->
evít
.
ty≥
 =
GR_EVENT_TYPE_TIMEOUT
)

145 
ï
->
ty≥
 = 
GR_EVENT_TYPE_NONE
;

149 
cur˛õ¡
->
evíthód
 = 
ñp
->
√xt
;

150 i‡(
cur˛õ¡
->
evíâaû
 =
ñp
)

151 
cur˛õ¡
->
evíâaû
 = 
NULL
;

153 
ñp
->
√xt
 = 
evít‰ì
;

154 
evít‰ì
 = 
ñp
;

155 
	}
}

163 
	$GrPìkEvít
(
GR_EVENT
 *
ï
)

165 
GR_EVENT_LIST
 * 
ñp
;

167 
	`SERVER_LOCK
();

168 
ñp
 = 
cur˛õ¡
->
evíthód
;

169 #i‡
NONETWORK


171 i‡(
ñp
 =
NULL
) {

172 
	`GsSñe˘
(-1L);

173 
ñp
 = 
cur˛õ¡
->
evíthód
;

176 if(
ñp
 =
NULL
) {

177 
ï
->
ty≥
 = 
GR_EVENT_TYPE_NONE
;

178 
	`SERVER_UNLOCK
();

183 *
ï
 = 
ñp
->
evít
;

185 
	`SERVER_UNLOCK
();

187 
	}
}

193 
	$GrGëWödowInfo
(
GR_WINDOW_ID
 
wid
, 
GR_WINDOW_INFO
 *
öf›å
)

195 
GR_WINDOW
 *
wp
;

196 
GR_PIXMAP
 *
µ
;

197 
GR_EVENT_CLIENT
 *
evp
;

199 
	`SERVER_LOCK
();

202 
wp
 = 
	`GsFödWödow
(
wid
);

203 i‡(
wp
) {

204 
öf›å
->
wid
 = wid;

206 
öf›å
->
x
 = 
wp
->x - (wp->
∑ª¡
 ? wp->parent->x : 0);

207 
öf›å
->
y
 = 
wp
->y - (wp->
∑ª¡
 ? wp->parent->y : 0);

208 
öf›å
->
width
 = 
wp
->width;

209 
öf›å
->
height
 = 
wp
->height;

210 
öf›å
->
∑ª¡
 = 
wp
->∑ª¡? wp->∑ª¡->
id
: 0;

211 
öf›å
->
chûd
 = 
wp
->
chûdªn
? wp->chûdªn->
id
: 0;

212 
öf›å
->
siblög
 = 
wp
->
siblögs
? wp->siblögs->
id
: 0;

213 
öf›å
->
m≠≥d
 = 
wp
->mapped;

214 
öf›å
->
ªÆized
 = 
wp
->realized;

215 
öf›å
->
öput⁄ly
 = !
wp
->
ouçut
;

216 
öf›å
->
b‹dîsize
 = 
wp
->bordersize;

217 
öf›å
->
b‹dîcﬁ‹
 = 
wp
->bordercolor;

218 
öf›å
->
background
 = 
wp
->background;

219 
öf›å
->
¥›s
 = 
wp
->props;

220 
öf›å
->
curs‹
 = 
wp
->
curs‹id
;

221 
öf›å
->
¥o˚ssid
 = 
wp
->
ow√r
? wp->owner->processid: 0;

222 
öf›å
->
evítmask
 = 0;

224 
evp
 = 
wp
->
evít˛õ¡s
;Évp;Év∞evp->
√xt
) {

225 i‡(
evp
->
˛õ¡
 =
cur˛õ¡
)

226 
öf›å
->
evítmask
 = 
evp
->eventmask;

228 
	`SERVER_UNLOCK
();

233 
µ
 = 
	`GsFödPixm≠
(
wid
);

234 i‡(
µ
) {

235 
öf›å
->
wid
 = wid;

236 
öf›å
->
x
 = 
µ
->x;

237 
öf›å
->
y
 = 
µ
->y;

238 
öf›å
->
width
 = 
µ
->width;

239 
öf›å
->
height
 = 
µ
->height;

240 
öf›å
->
∑ª¡
 = 0;

241 
öf›å
->
chûd
 = 0;

242 
öf›å
->
siblög
 = 0;

243 
öf›å
->
m≠≥d
 = 
GR_FALSE
;

244 
öf›å
->
ªÆized
 = 
GR_TRUE
;

245 
öf›å
->
öput⁄ly
 = 
GR_FALSE
;

246 
öf›å
->
b‹dîsize
 = 0;

247 
öf›å
->
b‹dîcﬁ‹
 = 0;

248 
öf›å
->
background
 = 0;

249 
öf›å
->
evítmask
 = 0;

250 
öf›å
->
curs‹
 = 0;

251 
öf›å
->
¥o˚ssid
 = 
µ
->
ow√r
?Öp->owner->processid: 0;

252 
	`SERVER_UNLOCK
();

257 
	`mem£t
(
öf›å
, 0, (
GR_WINDOW_INFO
));

258 
	`SERVER_UNLOCK
();

259 
	}
}

266 
	$GrDe°royWödow
(
GR_WINDOW_ID
 
wid
)

268 
GR_WINDOW
 *
wp
;

269 
GR_PIXMAP
 *
µ
;

270 
GR_PIXMAP
 *
¥evµ
;

271 
PSD
 
psd
;

273 
	`SERVER_LOCK
();

275 
wp
 = 
	`GsFödWödow
(
wid
);

276 i‡(
wp
) {

277 
	`GsWpDe°royWödow
(
wp
);

279 
µ
 = 
	`GsFödPixm≠
(
wid
);

280 i‡(
µ
) {

281 
psd
 = 
µ
->psd;

283 i‡(
psd
->
Êags
 & 
PSF_ADDRMALLOC
)

284 
	`‰ì
(
psd
->
addr
);

287 
psd
->
	`FªeMemGC
(psd);

292 
¥evµ
 = 
li°µ
;

293 i‡(
¥evµ
 =
µ
)

294 
li°µ
 = 
µ
->
√xt
;

296 
¥evµ
->
√xt
 !
µ
)

297 
¥evµ
 =Öªvµ->
√xt
;

298 
¥evµ
->
√xt
 = 
µ
->next;

305 i‡(
µ
 =
ˇchïp
) {

306 
ˇchïixm≠id
 = 0;

307 
ˇchïp
 = 
NULL
;

309 
	`‰ì
(
µ
);

313 
	`SERVER_UNLOCK
();

314 
	}
}

321 
	$GrRai£Wödow
(
GR_WINDOW_ID
 
wid
)

323 
GR_WINDOW
 *
wp
;

324 
GR_WINDOW
 *
¥evwp
;

325 
GR_BOOL
 
ovîœp
;

327 
	`SERVER_LOCK
();

329 
wp
 = 
	`GsFödWödow
(
wid
);

330 i‡((
wp
 =
NULL
Ë|| (w∞=
roŸwp
)) {

331 
	`SERVER_UNLOCK
();

338 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

339 i‡(
¥evwp
 =
wp
) {

340 
	`SERVER_UNLOCK
();

349 
ovîœp
 = 
GR_FALSE
;

350 
¥evwp
->
siblögs
 !
wp
) {

351 
ovîœp
 |
	`GsCheckOvîœp
(
¥evwp
, 
wp
);

352 
¥evwp
 =Öªvwp->
siblögs
;

354 
ovîœp
 |
	`GsCheckOvîœp
(
¥evwp
, 
wp
);

360 
¥evwp
->
siblögs
 = 
wp
->siblings;

361 
wp
->
siblögs
 = wp->
∑ª¡
->
chûdªn
;

362 
wp
->
∑ª¡
->
chûdªn
 = wp;

367 i‡(
ovîœp
) {

368 
	`GsDøwB‹dî
(
wp
);

369 
	`GsExpo£Aªa
(
wp
, wp->
x
, wp->
y
, wp->
width
, wp->
height
, 
NULL
);

372 
	`SERVER_UNLOCK
();

373 
	}
}

379 
	$GrLowîWödow
(
GR_WINDOW_ID
 
wid
)

381 
GR_WINDOW
 *
wp
;

382 
GR_WINDOW
 *
¥evwp
;

383 
GR_WINDOW
 *
sibwp
;

384 
GR_WINDOW
 *
expwp
;

386 
	`SERVER_LOCK
();

388 
wp
 = 
	`GsFödWödow
(
wid
);

389 i‡((
wp
 =
NULL
Ë|| (w∞=
roŸwp
)) {

390 
	`SERVER_UNLOCK
();

393 i‡(
wp
->
siblögs
 =
NULL
) {

394 
	`SERVER_UNLOCK
();

401 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

402 i‡(
¥evwp
 !
wp
) {

403 
¥evwp
->
siblögs
 !
wp
)

404 
¥evwp
 =Öªvwp->
siblögs
;

412 
expwp
 = 
wp
->
siblögs
;

413 
sibwp
 = 
wp
;

414 
sibwp
->
siblögs
)

415 
sibwp
 = sibwp->
siblögs
;

421 i‡(
¥evwp
 =
wp
)

422 
wp
->
∑ª¡
->
chûdªn
 = wp->
siblögs
;

424 
¥evwp
->
siblögs
 = 
wp
->siblings;

425 
sibwp
->
siblögs
 = 
wp
;

427 
wp
->
siblögs
 = 
NULL
;

433 
expwp
 && (expw∞!
wp
)) {

434 i‡(
	`GsCheckOvîœp
(
wp
, 
expwp
)) {

435 
	`GsExpo£Aªa
(
expwp
, 
wp
->
x
 - wp->
b‹dîsize
,

436 
wp
->
y
 - wp->
b‹dîsize
,

437 
wp
->
width
 + wp->
b‹dîsize
 * 2,

438 
wp
->
height
 + wp->
b‹dîsize
 * 2, 
NULL
);

440 
expwp
 =Éxpwp->
siblögs
;

443 
	`SERVER_UNLOCK
();

444 
	}
}

448 
	$Off£tWödow
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
offx
, GR_COORD 
offy
)

450 
GR_WINDOW
 *
˝
;

452 
wp
->
x
 +
offx
;

453 
wp
->
y
 +
offy
;

454 
˝
=
wp
->
chûdªn
; cp; cp=˝->
siblögs
)

455 
	`Off£tWödow
(
˝
, 
offx
, 
offy
);

456 
	}
}

460 
	$DñivîUpd©eMoveEvítAndChûdªn
(
GR_WINDOW
 *
wp
)

462 
GR_WINDOW
 * 
chûdwp
;

464 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_MOVE
, wp->
x
, wp->
y
,

465 
wp
->
width
, wp->
height
);

467 
chûdwp
 = 
wp
->
chûdªn
; chûdwp; chûdw∞chûdwp->
siblögs
)

468 
	`DñivîUpd©eMoveEvítAndChûdªn
(
chûdwp
);

469 
	}
}

475 
	$GrMoveWödow
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
)

477 
GR_WINDOW
 *
wp
;

478 
GR_COORD
 
offx
, 
offy
;

480 
	`SERVER_LOCK
();

482 
wp
 = 
	`GsFödWödow
(
wid
);

483 i‡(
wp
 =
NULL
) {

484 
	`SERVER_UNLOCK
();

487 i‡(
wp
 =
roŸwp
) {

488 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wid
);

489 
	`SERVER_UNLOCK
();

493 
x
 +
wp
->
∑ª¡
->x;

494 
y
 +
wp
->
∑ª¡
->y;

495 
offx
 = 
x
 - 
wp
->x;

496 
offy
 = 
y
 - 
wp
->y;

498 i‡(
wp
->
x
 =x && wp->
y
 == y) {

499 
	`SERVER_UNLOCK
();

506 i‡(
wp
->
m≠≥d
 && w∞=wp->
∑ª¡
->
chûdªn


507 && 
wp
->
∑ª¡
->
id
 =
GR_ROOT_WINDOW_ID


513 && !
wp
->
˛ùªgi⁄


515 
ﬁdx
 = 
wp
->
x
;

516 
ﬁdy
 = 
wp
->
y
;

517 
GR_WINDOW_ID
 
pixid
 = 
	`GrNewPixm≠
(
wp
->
width
, wp->
height
,
NULL
);

518 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

519 
GR_WINDOW
 * 
°›wp
 = 
wp
;

520 
X
, 
Y
, 
W
, 
H
;

523 
	`GdHideCurs‹
(
roŸwp
->
psd
);

526 
	`GrSëGCMode
(
gc
, 
GR_MODE_COPY
|
GR_MODE_EXCLUDECHILDREN
);

529 
	`GrC›yAªa
(
pixid
, 
gc
, 0, 0, 
wp
->
width
, wp->
height
,

530 
GR_ROOT_WINDOW_ID
, 
ﬁdx
, 
ﬁdy
, 
MWROP_COPY
);

533 
	`Off£tWödow
(
wp
, 
offx
, 
offy
);

536 
˛ùwp
 = 
NULL
;

539 
	`GrC›yAªa
(
GR_ROOT_WINDOW_ID
, 
gc
, 
wp
->
x
, wp->
y
, wp->
width
,

540 
wp
->
height
, 
pixid
, 0, 0, 
MWROP_COPY
);

547 i‡((
ﬁdx
 < 0 && 
wp
->
x
 > oldx) ||

548 (
ﬁdy
 < 0 && 
wp
->
y
 > oldy) ||

549 (
ﬁdx
+
wp
->
width
 > 
roŸwp
->width && wp->
x
 < oldx) ||

550 (
ﬁdy
+
wp
->
height
 > 
roŸwp
->heighà&& wp->
y
 < oldy))

551 
°›wp
 = 
NULL
;

557 
X
 = 
	`MWMIN
(
ﬁdx
, 
wp
->
x
);

558 
Y
 = 
	`MWMIN
(
ﬁdy
, 
wp
->
y
);

559 
W
 = 
	`MWMAX
(
ﬁdx
, 
wp
->
x
Ë+ wp->
width
 - 
X
;

560 
H
 = 
	`MWMAX
(
ﬁdy
, 
wp
->
y
Ë+ wp->
height
 - 
Y
;

561 
	`GsExpo£Aªa
(
roŸwp
, 
X
, 
Y
, 
W
, 
H
, 
°›wp
);

563 
	`GdShowCurs‹
(
roŸwp
->
psd
);

564 
	`GrDe°royGC
(
gc
);

565 
	`GrDe°royWödow
(
pixid
);

566 
	`DñivîUpd©eMoveEvítAndChûdªn
(
wp
);

567 
	`SERVER_UNLOCK
();

573 i‡(
wp
->
m≠≥d
 && w∞=wp->
∑ª¡
->
chûdªn
) {

574 
ﬁdx
 = 
wp
->
x
;

575 
ﬁdy
 = 
wp
->
y
;

576 
X
, 
Y
, 
W
, 
H
;

578 
	`Off£tWödow
(
wp
, 
offx
, 
offy
);

581 
˛ùwp
 = 
NULL
;

583 
X
 = 
	`MWMIN
(
ﬁdx
, 
wp
->
x
);

584 
Y
 = 
	`MWMIN
(
ﬁdy
, 
wp
->
y
);

585 
W
 = 
	`MWMAX
(
ﬁdx
, 
wp
->
x
Ë+ wp->
width
 - 
X
;

586 
H
 = 
	`MWMAX
(
ﬁdy
, 
wp
->
y
Ë+ wp->
height
 - 
Y
;

587 
	`GsExpo£Aªa
(
roŸwp
, 
X
, 
Y
, 
W
, 
H
, 
NULL
);

588 
	`DñivîUpd©eMoveEvítAndChûdªn
(
wp
);

589 
	`SERVER_UNLOCK
();

597 
	`GsWpUƒólizeWödow
(
wp
, 
GR_TRUE
);

598 
	`Off£tWödow
(
wp
, 
offx
, 
offy
);

599 
	`GsWpRólizeWödow
(
wp
, 
GR_FALSE
);

600 
	`DñivîUpd©eMoveEvítAndChûdªn
(
wp
);

602 
	`SERVER_UNLOCK
();

604 
	}
}

610 
	$GrResizeWödow
(
GR_WINDOW_ID
 
wid
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

612 
GR_WINDOW
 *
wp
;

614 
	`SERVER_LOCK
();

616 
wp
 = 
	`GsFödWödow
(
wid
);

617 i‡(
wp
 =
NULL
) {

618 
	`SERVER_UNLOCK
();

621 i‡(
wp
 =
roŸwp
) {

622 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wid
);

623 
	`SERVER_UNLOCK
();

626 i‡((
width
 <0Ë|| (
height
 <= 0)) {

627 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_SIZE
, 
wid
);

628 
	`SERVER_UNLOCK
();

632 i‡((
wp
->
width
 =widthË&& (wp->
height
 == height)) {

633 
	`SERVER_UNLOCK
();

637 i‡(!
wp
->
ªÆized
 || !wp->
ouçut
) {

638 
wp
->
width
 = width;

639 
wp
->
height
 = height;

640 
	`SERVER_UNLOCK
();

648 
	`GsWpUƒólizeWödow
(
wp
, 
GR_TRUE
);

649 
wp
->
width
 = width;

650 
wp
->
height
 = height;

652 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_SIZE
, wp->
x
, wp->
y
, 
width
, 
height
);

653 
	`GsWpRólizeWödow
(
wp
, 
GR_FALSE
);

655 
	`SERVER_UNLOCK
();

656 
	}
}

662 
	$GrRï¨ítWödow
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pwid
, 
GR_COORD
 
x
, GR_COORD 
y
)

664 
GR_WINDOW
 *
wp
;

665 
GR_WINDOW
 *
pwp
;

666 
GR_WINDOW
 **
mysib±r
;

667 
GR_COORD
 
offx
, 
offy
;

669 
	`SERVER_LOCK
();

671 
wp
 = 
	`GsFödWödow
(
wid
);

672 
pwp
 = 
	`GsFödWödow
(
pwid
);

673 i‡(!
wp
 || !
pwp
 || wp ==Öwp) {

674 
	`SERVER_UNLOCK
();

677 i‡(
wp
 =
roŸwp
) {

678 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wid
);

679 
	`SERVER_UNLOCK
();

684 
x
 +
pwp
->x;

685 
y
 +
pwp
->y;

686 
offx
 = 
x
 - 
wp
->x;

687 
offy
 = 
y
 - 
wp
->y;

693 
	`GsWpUƒólizeWödow
(
wp
, 
GR_TRUE
);

696 
mysib±r
 = &(
wp
->
∑ª¡
->
chûdªn
); *mysibptr != wp;

697 
mysib±r
 = &((*mysib±r)->
siblögs
))

700 *
mysib±r
 = 
wp
->
siblögs
;

701 
wp
->
∑ª¡
 = 
pwp
;

702 
wp
->
siblögs
 = 
pwp
->
chûdªn
;

703 
pwp
->
chûdªn
 = 
wp
;

705 i‡(
offx
 || 
offy
)

706 
	`Off£tWödow
(
wp
, 
offx
, 
offy
);

715 
	`GsWpRólizeWödow
(
wp
, 
GR_TRUE
);

718 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_REPARENT
, wp->
x
, wp->
y
, wp->
width
, wp->
height
);

720 
	`SERVER_UNLOCK
();

721 
	}
}

723 
	g√xtgcid
 = 1000;

728 
GR_GC_ID


729 
	$GrNewGC
()

731 
GR_GC
 *
g˝
;

733 
	`SERVER_LOCK
();

735 
g˝
 = (
GR_GC
 *Ë
	`mÆloc
((GR_GC));

736 i‡(
g˝
 =
NULL
) {

737 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

738 
	`SERVER_UNLOCK
();

742 
g˝
->
id
 = 
√xtgcid
++;

743 
g˝
->
mode
 = 
GR_MODE_COPY
;

744 
g˝
->
ªgi⁄id
 = 0;

745 
g˝
->
xoff
 = 0;

746 
g˝
->
yoff
 = 0;

747 
g˝
->
f⁄tid
 = 0;

748 
g˝
->
f‹eground
 = 
WHITE
;

749 
g˝
->
background
 = 
BLACK
;

750 
g˝
->
fgi•ixñvÆ
 = 
GR_FALSE
;

751 
g˝
->
bgi•ixñvÆ
 = 
GR_FALSE
;

752 
g˝
->
u£background
 = 
GR_TRUE
;

754 
g˝
->
exposuª
 = 
GR_TRUE
;

756 
g˝
->
löe°yÀ
 = 
GR_LINE_SOLID
;

757 
g˝
->
fûlmode
 = 
GR_FILL_SOLID
;

759 
g˝
->
dashcou¡
 = 0;

760 
g˝
->
dashmask
 = 0;

762 
g˝
->
°ù∂e
.
bôm≠
 = 
NULL
;

763 
g˝
->
°ù∂e
.
width
 = 0;

764 
g˝
->
°ù∂e
.
height
 = 0;

766 
g˝
->
tûe
.
psd
 = 
NULL
;

767 
g˝
->
tûe
.
width
 = 0;

768 
g˝
->
tûe
.
height
 = 0;

770 
g˝
->
ts_off£t
.
x
 = 0;

771 
g˝
->
ts_off£t
.
y
 = 0;

773 
g˝
->
ch™ged
 = 
GR_TRUE
;

774 
g˝
->
ow√r
 = 
cur˛õ¡
;

775 
g˝
->
√xt
 = 
li°g˝
;

777 
li°g˝
 = 
g˝
;

779 
	`SERVER_UNLOCK
();

781  
g˝
->
id
;

782 
	}
}

788 
	$GrDe°royGC
(
GR_GC_ID
 
gc
)

790 
GR_GC
 *
g˝
;

791 
GR_GC
 *
¥evg˝
;

793 
	`SERVER_LOCK
();

795 
g˝
 = 
	`GsFödGC
(
gc
);

796 i‡(
g˝
 =
NULL
) {

797 
	`SERVER_UNLOCK
();

801 i‡(
gc
 =
ˇchegcid
) {

802 
ˇchegcid
 = 0;

803 
ˇcheg˝
 = 
NULL
;

805 i‡(
g˝
 =
curg˝
)

806 
curg˝
 = 
NULL
;

808 i‡(
li°g˝
 =
g˝
)

809 
li°g˝
 = 
g˝
->
√xt
;

811 
¥evg˝
 = 
li°g˝
;

812 
¥evg˝
->
√xt
 !
g˝
)

813 
¥evg˝
 =Öªvg˝->
√xt
;

815 
¥evg˝
->
√xt
 = 
g˝
->next;

818 i‡(
g˝
->
°ù∂e
.
bôm≠
)

819 
	`‰ì
(
g˝
->
°ù∂e
.
bôm≠
);

820 
	`‰ì
(
g˝
);

822 
	`SERVER_UNLOCK
();

823 
	}
}

829 
GR_GC_ID


830 
	$GrC›yGC
(
GR_GC_ID
 
gc
)

832 
GR_GC
 *
ﬁdg˝
;

833 
GR_GC
 *
g˝
;

834 
GR_GC_ID
 
id
;

836 
	`SERVER_LOCK
();

838 
ﬁdg˝
 = 
	`GsFödGC
(
gc
);

839 i‡(
ﬁdg˝
 =
NULL
) {

840 
	`SERVER_UNLOCK
();

844 
g˝
 = (
GR_GC
 *Ë
	`mÆloc
((GR_GC));

845 i‡(
g˝
 =
NULL
) {

846 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

847 
	`SERVER_UNLOCK
();

855 *
g˝
 = *
ﬁdg˝
;

856 
g˝
->
id
 = 
√xtgcid
++;

857 
id
 = 
g˝
->id;

858 
g˝
->
ch™ged
 = 
GR_TRUE
;

859 
g˝
->
ow√r
 = 
cur˛õ¡
;

860 
g˝
->
√xt
 = 
li°g˝
;

861 
li°g˝
 = 
g˝
;

863 
	`SERVER_UNLOCK
();

865  
id
;

866 
	}
}

872 
	$GrGëGCInfo
(
GR_GC_ID
 
gc
, 
GR_GC_INFO
 *
gcù
)

874 
GR_GC
 *
g˝
;

876 
	`SERVER_LOCK
();

881 
g˝
 = 
li°g˝
; g˝ && (g˝->
id
 !
gc
); g˝ = g˝->
√xt
)

884 i‡(
g˝
 =
NULL
) {

885 
	`mem£t
(
gcù
, 0, (
GR_GC_INFO
));

886 
	`SERVER_UNLOCK
();

890 
gcù
->
gcid
 = 
gc
;

891 
gcù
->
mode
 = 
g˝
->mode;

892 
gcù
->
ªgi⁄
 = 
g˝
->
ªgi⁄id
;

893 
gcù
->
xoff
 = 
g˝
->xoff;

894 
gcù
->
yoff
 = 
g˝
->yoff;

895 
gcù
->
f⁄t
 = 
g˝
->
f⁄tid
;

896 
gcù
->
f‹eground
 = 
g˝
->foreground;

897 
gcù
->
background
 = 
g˝
->background;

898 
gcù
->
fgi•ixñvÆ
 = 
g˝
->fgispixelval;

899 
gcù
->
bgi•ixñvÆ
 = 
g˝
->bgispixelval;

900 
gcù
->
u£background
 = 
g˝
->usebackground;

901 
gcù
->
exposuª
 = 
g˝
->exposure;

903 
	`SERVER_UNLOCK
();

904 
	}
}

906 
	g√xåegi⁄id
 = 1000;

911 
GR_REGION_ID


912 
	$GrNewRegi⁄
()

914 
GR_REGION
 *
ªgi⁄p
;

915 
GR_REGION_ID
 
id
;

917 
	`SERVER_LOCK
();

919 
ªgi⁄p
 = (
GR_REGION
 *Ë
	`mÆloc
((GR_REGION));

920 i‡(
ªgi⁄p
 =
NULL
) {

921 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

922 
	`SERVER_UNLOCK
();

926 
ªgi⁄p
->
rgn
 = 
	`GdAŒocRegi⁄
();

927 
ªgi⁄p
->
id
 = 
√xåegi⁄id
++;

928 
ªgi⁄p
->
ow√r
 = 
cur˛õ¡
;

929 
ªgi⁄p
->
√xt
 = 
li°ªgi⁄p
;

931 
li°ªgi⁄p
 = 
ªgi⁄p
;

933 
id
 = 
ªgi⁄p
->id;

935 
	`SERVER_UNLOCK
();

937  
id
;

938 
	}
}

944 
GR_REGION_ID


945 
	$GrNewPﬁyg⁄Regi⁄
(
mode
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöts
)

947 #i‡
POLYREGIONS


948 
GR_REGION
 *
ªgi⁄p
;

949 
GR_REGION_ID
 
id
;

951 
	`SERVER_LOCK
();

953 
ªgi⁄p
 = (
GR_REGION
 *Ë
	`mÆloc
((GR_REGION));

954 i‡(
ªgi⁄p
 =
NULL
) {

955 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

956 
	`SERVER_UNLOCK
();

960 
ªgi⁄p
->
rgn
 = 
	`GdAŒocPﬁyg⁄Regi⁄
(
poöts
, 
cou¡
, 
mode
);

961 
ªgi⁄p
->
id
 = 
√xåegi⁄id
++;

962 
ªgi⁄p
->
ow√r
 = 
cur˛õ¡
;

963 
ªgi⁄p
->
√xt
 = 
li°ªgi⁄p
;

965 
li°ªgi⁄p
 = 
ªgi⁄p
;

967 
id
 = 
ªgi⁄p
->id;

969 
	`SERVER_UNLOCK
();

971  
id
;

975 
	}
}

981 
	$GrDe°royRegi⁄
(
GR_REGION_ID
 
ªgi⁄
)

983 
GR_REGION
 *
ªgi⁄p
;

984 
GR_REGION
 *
¥evªgi⁄p
;

986 
	`SERVER_LOCK
();

988 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

989 i‡(
ªgi⁄p
 =
NULL
) {

990 
	`SERVER_UNLOCK
();

994 i‡(
li°ªgi⁄p
 =
ªgi⁄p
) {

995 
li°ªgi⁄p
 = 
ªgi⁄p
->
√xt
;

997 
¥evªgi⁄p
 = 
li°ªgi⁄p
;

998 
¥evªgi⁄p
->
√xt
 !
ªgi⁄p
)

999 
¥evªgi⁄p
 =Öªvªgi⁄p->
√xt
;

1001 
¥evªgi⁄p
->
√xt
 = 
ªgi⁄p
->next;

1003 
	`GdDe°royRegi⁄
(
ªgi⁄p
->
rgn
);

1004 
	`‰ì
(
ªgi⁄p
);

1006 
	`SERVER_UNLOCK
();

1007 
	}
}

1014 
	$GrUni⁄Re˘WôhRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
)

1016 
GR_REGION
 *
ªgi⁄p
;

1017 
MWRECT
 
rc
;

1019 
	`SERVER_LOCK
();

1021 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1022 i‡(
ªgi⁄p
) {

1024 
rc
.
À·
 = 
ª˘
->
x
;

1025 
rc
.
t›
 = 
ª˘
->
y
;

1026 
rc
.
right
 = 
ª˘
->
x
 +Ñe˘->
width
;

1027 
rc
.
bŸtom
 = 
ª˘
->
y
 +Ñe˘->
height
;

1028 
	`GdUni⁄Re˘WôhRegi⁄
(&
rc
, 
ªgi⁄p
->
rgn
);

1031 
	`SERVER_UNLOCK
();

1032 
	}
}

1038 
	$GrUni⁄Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1039 
GR_REGION_ID
 
§c_rgn2
)

1041 
GR_REGION
 *
ªgi⁄p
;

1042 
GR_REGION
 *
§¸egi⁄p1
;

1043 
GR_REGION
 *
§¸egi⁄p2
;

1045 
	`SERVER_LOCK
();

1047 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
d°_rgn
);

1048 i‡(
ªgi⁄p
 =
NULL
) {

1049 
	`SERVER_UNLOCK
();

1053 
§¸egi⁄p1
 = 
	`GsFödRegi⁄
(
§c_rgn1
);

1054 i‡(
§¸egi⁄p1
 =
NULL
) {

1055 
	`SERVER_UNLOCK
();

1059 
§¸egi⁄p2
 = 
	`GsFödRegi⁄
(
§c_rgn2
);

1060 i‡(
§¸egi⁄p2
 =
NULL
) {

1061 
	`SERVER_UNLOCK
();

1065 
	`GdUni⁄Regi⁄
(
ªgi⁄p
->
rgn
, 
§¸egi⁄p1
->rgn, 
§¸egi⁄p2
->rgn);

1067 
	`SERVER_UNLOCK
();

1068 
	}
}

1074 
	$GrSubåa˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1075 
GR_REGION_ID
 
§c_rgn2
)

1077 
GR_REGION
 *
ªgi⁄p
;

1078 
GR_REGION
 *
§¸egi⁄p1
;

1079 
GR_REGION
 *
§¸egi⁄p2
;

1081 
	`SERVER_LOCK
();

1083 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
d°_rgn
);

1084 i‡(
ªgi⁄p
 =
NULL
) {

1085 
	`SERVER_UNLOCK
();

1089 
§¸egi⁄p1
 = 
	`GsFödRegi⁄
(
§c_rgn1
);

1090 i‡(
§¸egi⁄p1
 =
NULL
) {

1091 
	`SERVER_UNLOCK
();

1095 
§¸egi⁄p2
 = 
	`GsFödRegi⁄
(
§c_rgn2
);

1096 i‡(
§¸egi⁄p2
 =
NULL
) {

1097 
	`SERVER_UNLOCK
();

1101 
	`GdSubåa˘Regi⁄
(
ªgi⁄p
->
rgn
, 
§¸egi⁄p1
->rgn, 
§¸egi⁄p2
->rgn);

1103 
	`SERVER_UNLOCK
();

1104 
	}
}

1110 
	$GrX‹Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1111 
GR_REGION_ID
 
§c_rgn2
)

1113 
GR_REGION
 *
ªgi⁄p
;

1114 
GR_REGION
 *
§¸egi⁄p1
;

1115 
GR_REGION
 *
§¸egi⁄p2
;

1117 
	`SERVER_LOCK
();

1119 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
d°_rgn
);

1120 i‡(
ªgi⁄p
 =
NULL
) {

1121 
	`SERVER_UNLOCK
();

1125 
§¸egi⁄p1
 = 
	`GsFödRegi⁄
(
§c_rgn1
);

1126 i‡(
§¸egi⁄p1
 =
NULL
) {

1127 
	`SERVER_UNLOCK
();

1131 
§¸egi⁄p2
 = 
	`GsFödRegi⁄
(
§c_rgn2
);

1132 i‡(
§¸egi⁄p2
 =
NULL
) {

1133 
	`SERVER_UNLOCK
();

1137 
	`GdX‹Regi⁄
(
ªgi⁄p
->
rgn
, 
§¸egi⁄p1
->rgn, 
§¸egi⁄p2
->rgn);

1139 
	`SERVER_UNLOCK
();

1140 
	}
}

1146 
	$GrI¡î£˘Regi⁄
(
GR_REGION_ID
 
d°_rgn
, GR_REGION_ID 
§c_rgn1
,

1147 
GR_REGION_ID
 
§c_rgn2
)

1149 
GR_REGION
 *
ªgi⁄p
;

1150 
GR_REGION
 *
§¸egi⁄p1
;

1151 
GR_REGION
 *
§¸egi⁄p2
;

1153 
	`SERVER_LOCK
();

1155 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
d°_rgn
);

1156 i‡(
ªgi⁄p
 =
NULL
) {

1157 
	`SERVER_UNLOCK
();

1161 
§¸egi⁄p1
 = 
	`GsFödRegi⁄
(
§c_rgn1
);

1162 i‡(
§¸egi⁄p1
 =
NULL
) {

1163 
	`SERVER_UNLOCK
();

1167 
§¸egi⁄p2
 = 
	`GsFödRegi⁄
(
§c_rgn2
);

1168 i‡(
§¸egi⁄p2
 =
NULL
) {

1169 
	`SERVER_UNLOCK
();

1173 
	`GdI¡î£˘Regi⁄
(
ªgi⁄p
->
rgn
, 
§¸egi⁄p1
->rgn, 
§¸egi⁄p2
->rgn);

1175 
	`SERVER_UNLOCK
();

1176 
	}
}

1182 
	$GrSëGCRegi⁄
(
GR_GC_ID
 
gc
, 
GR_REGION_ID
 
ªgi⁄
)

1184 
GR_GC
 *
g˝
;

1186 
	`SERVER_LOCK
();

1188 
g˝
 = 
	`GsFödGC
(
gc
);

1189 i‡(
g˝
) {

1190 
g˝
->
ªgi⁄id
 = 
ªgi⁄
;

1191 
g˝
->
ch™ged
 = 
GR_TRUE
;

1194 
	`SERVER_UNLOCK
();

1195 
	}
}

1201 
	$GrSëGCClùOrigö
(
GR_GC_ID
 
gc
, 
xoff
, 
yoff
)

1203 
GR_GC
 *
g˝
;

1205 
	`SERVER_LOCK
();

1207 
g˝
 = 
	`GsFödGC
(
gc
);

1208 i‡(
g˝
) {

1209 
g˝
->
xoff
 = xoff;

1210 
g˝
->
yoff
 = yoff;

1211 
g˝
->
ch™ged
 = 
GR_TRUE
;

1214 
	`SERVER_UNLOCK
();

1215 
	}
}

1220 
GR_BOOL


1221 
	$GrPoötInRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
)

1223 
GR_REGION
 *
ªgi⁄p
;

1224 
GR_BOOL
 
ªsu…
;

1226 
	`SERVER_LOCK
();

1228 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1229 i‡(
ªgi⁄p
 =
NULL
) {

1230 
	`SERVER_UNLOCK
();

1231  
GR_FALSE
;

1234 
ªsu…
 = 
	`GdPtInRegi⁄
(
ªgi⁄p
->
rgn
, 
x
, 
y
);

1236 
	`SERVER_UNLOCK
();

1238  
ªsu…
;

1239 
	}
}

1246 
	$GrRe˘InRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_COORD
 
x
, GR_COORD 
y
, GR_COORD 
w
,

1247 
GR_COORD
 
h
)

1249 
GR_REGION
 *
ªgi⁄p
;

1250 
MWRECT
 
ª˘
;

1251 
ªsu…
;

1253 
	`SERVER_LOCK
();

1255 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1256 i‡(
ªgi⁄p
 =
NULL
) {

1257 
	`SERVER_UNLOCK
();

1258  
MWRECT_OUT
;

1261 
ª˘
.
À·
 = 
x
;

1262 
ª˘
.
t›
 = 
y
;

1263 
ª˘
.
right
 = 
x
 + 
w
;

1264 
ª˘
.
bŸtom
 = 
y
 + 
h
;

1265 
ªsu…
 = 
	`GdRe˘InRegi⁄
(
ªgi⁄p
->
rgn
, &
ª˘
);

1267 
	`SERVER_UNLOCK
();

1269  
ªsu…
;

1270 
	}
}

1275 
GR_BOOL


1276 
	$GrEm±yRegi⁄
(
GR_REGION_ID
 
ªgi⁄
)

1278 
GR_REGION
 *
ªgi⁄p
;

1279 
GR_BOOL
 
ªsu…
;

1281 
	`SERVER_LOCK
();

1283 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1284 i‡(
ªgi⁄p
 =
NULL
) {

1285 
	`SERVER_UNLOCK
();

1286  
GR_TRUE
;

1289 
ªsu…
 = 
	`GdEm±yRegi⁄
(
ªgi⁄p
->
rgn
);

1291 
	`SERVER_UNLOCK
();

1293  
ªsu…
;

1294 
	}
}

1299 
GR_BOOL


1300 
	$GrEquÆRegi⁄
(
GR_REGION_ID
 
rgn1
, GR_REGION_ID 
rgn2
)

1302 
GR_REGION
 *
¥gn1
;

1303 
GR_REGION
 *
¥gn2
;

1304 
GR_BOOL
 
ªsu…
;

1306 
	`SERVER_LOCK
();

1308 
¥gn1
 = 
	`GsFödRegi⁄
(
rgn1
);

1309 
¥gn2
 = 
	`GsFödRegi⁄
(
rgn2
);

1311 i‡(!
¥gn1
 && !
¥gn2
) {

1312 
ªsu…
 = 
GR_TRUE
;

1313 } i‡(!
¥gn1
 || !
¥gn2
) {

1314 
ªsu…
 = 
GR_FALSE
;

1316 
ªsu…
 = 
	`GdEquÆRegi⁄
(
¥gn1
->
rgn
, 
¥gn2
->rgn);

1319 
	`SERVER_UNLOCK
();

1321  
ªsu…
;

1322 
	}
}

1328 
	$GrOff£tRegi⁄
(
GR_REGION_ID
 
ªgi⁄
, 
GR_SIZE
 
dx
, GR_SIZE 
dy
)

1330 
GR_REGION
 *
ªgi⁄p
;

1332 
	`SERVER_LOCK
();

1334 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1335 i‡(
ªgi⁄p
)

1336 
	`GdOff£tRegi⁄
(
ªgi⁄p
->
rgn
, 
dx
, 
dy
);

1338 
	`SERVER_UNLOCK
();

1339 
	}
}

1345 
	$GrGëRegi⁄Box
(
GR_REGION_ID
 
ªgi⁄
, 
GR_RECT
 *
ª˘
)

1347 
GR_REGION
 *
ªgi⁄p
;

1348 
MWRECT
 
rc
;

1349 
ªt_vÆ
;

1351 
	`SERVER_LOCK
();

1353 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
ªgi⁄
);

1354 i‡(
ªgi⁄p
 =
NULL
) {

1355 
	`mem£t
(
ª˘
, 0, (
GR_RECT
));

1356 
	`SERVER_UNLOCK
();

1357  
MWREGION_ERROR
;

1360 
ªt_vÆ
 = 
	`GdGëRegi⁄Box
(
ªgi⁄p
->
rgn
, &
rc
);

1362 
ª˘
->
x
 = 
rc
.
À·
;

1363 
ª˘
->
y
 = 
rc
.
t›
;

1364 
ª˘
->
width
 = 
rc
.
right
 -Ñc.
À·
;

1365 
ª˘
->
height
 = 
rc
.
bŸtom
 -Ñc.
t›
;

1367 
	`SERVER_UNLOCK
();

1369  
ªt_vÆ
;

1370 
	}
}

1372 
	g√xtf⁄tid
 = 1000;

1377 
GR_FONT_ID


1378 
	$GrCª©eF⁄t
(
GR_CHAR
 *
«me
, 
GR_COORD
 
height
, 
GR_LOGFONT
 *
∂ogf⁄t
)

1380 
GR_FONT
 *
f⁄ç
;

1382 
	`SERVER_LOCK
();

1384 
f⁄ç
 = (
GR_FONT
 *Ë
	`mÆloc
((GR_FONT));

1385 i‡(
f⁄ç
 =
NULL
) {

1386 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1387 
	`SERVER_UNLOCK
();

1391 i‡(
∂ogf⁄t
)

1392 
f⁄ç
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
, 
NULL
, 0, 
∂ogf⁄t
);

1394 
f⁄ç
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
, (c⁄° *)
«me
, 
height
, 
NULL
);

1397 i‡(!
f⁄ç
->
pf⁄t
) {

1398 
	`‰ì
(
f⁄ç
);

1402 
f⁄ç
->
id
 = 
√xtf⁄tid
++;

1403 
f⁄ç
->
ow√r
 = 
cur˛õ¡
;

1404 
f⁄ç
->
√xt
 = 
li°f⁄ç
;

1406 
li°f⁄ç
 = 
f⁄ç
;

1408 
	`SERVER_UNLOCK
();

1410  
f⁄ç
->
id
;

1411 
	}
}

1413 #i‡
HAVE_FREETYPE_2_SUPPORT


1418 
GR_FONT_ID


1419 
	$GrCª©eF⁄tFromBuf„r
(c⁄° *
buf„r
, 
Àngth
,

1420 c⁄° *
f‹m©
, 
GR_COORD
 
height
)

1422 
GR_FONT
 *
f⁄ç
;

1424 
	`SERVER_LOCK
();

1426 
f⁄ç
 = (
GR_FONT
 *)
	`mÆloc
((GR_FONT));

1427 i‡(
f⁄ç
 =
NULL
) {

1428 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1429 
	`SERVER_UNLOCK
();

1438 
f⁄ç
->
pf⁄t
 = 
	`GdCª©eF⁄tFromBuf„r
(&
s¸dev
, 
buf„r
, 
Àngth
, 
f‹m©
,

1439 
height
);

1440 i‡(
f⁄ç
->
pf⁄t
 =
NULL
) {

1442 
	`‰ì
(
f⁄ç
);

1443 
	`SERVER_UNLOCK
();

1447 
f⁄ç
->
id
 = 
√xtf⁄tid
++;

1448 
f⁄ç
->
ow√r
 = 
cur˛õ¡
;

1449 
f⁄ç
->
√xt
 = 
li°f⁄ç
;

1450 
li°f⁄ç
 = 
f⁄ç
;

1452 
	`SERVER_UNLOCK
();

1453  
f⁄ç
->
id
;

1454 
	}
}

1460 
GR_FONT_ID


1461 
	$GrC›yF⁄t
(
GR_FONT_ID
 
f⁄tid
, 
GR_COORD
 
height
)

1463 
GR_FONT
 *
§cf⁄ç
;

1464 
GR_FONT
 *
f⁄ç
;

1466 
	`SERVER_LOCK
();

1468 
f⁄ç
 = (
GR_FONT
 *)
	`mÆloc
((GR_FONT));

1469 i‡(
f⁄ç
 =
NULL
) {

1470 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1471 
	`SERVER_UNLOCK
();

1475 
§cf⁄ç
 = 
	`GsFödF⁄t
(
f⁄tid
);

1476 i‡(
§cf⁄ç
)

1477 
f⁄ç
->
pf⁄t
 = 
	`GdDu∂iˇãF⁄t
(&
s¸dev
, 
§cf⁄ç
->pf⁄t,
height
);

1479 
f⁄ç
->
pf⁄t
 = 
	`GdCª©eF⁄t
(&
s¸dev
, 
NULL
, 
height
, NULL);

1481 
f⁄ç
->
id
 = 
√xtf⁄tid
++;

1482 
f⁄ç
->
ow√r
 = 
cur˛õ¡
;

1483 
f⁄ç
->
√xt
 = 
li°f⁄ç
;

1484 
li°f⁄ç
 = 
f⁄ç
;

1486 
	`SERVER_UNLOCK
();

1487  
f⁄ç
->
id
;

1488 
	}
}

1493 
	$GrSëF⁄tSize
(
GR_FONT_ID
 
f⁄tid
, 
GR_COORD
 
size
)

1495 
GR_FONT
 *
f⁄ç
;

1497 
	`SERVER_LOCK
();

1499 
f⁄ç
 = 
	`GsFödF⁄t
(
f⁄tid
);

1500 i‡(
f⁄ç
)

1501 
	`GdSëF⁄tSize
(
f⁄ç
->
pf⁄t
, 
size
);

1503 
	`SERVER_UNLOCK
();

1504 
	}
}

1508 
	$GrSëF⁄tRŸ©i⁄
(
GR_FONT_ID
 
f⁄tid
, 
ã¡hdegªes
)

1510 
GR_FONT
 *
f⁄ç
;

1512 
	`SERVER_LOCK
();

1514 
f⁄ç
 = 
	`GsFödF⁄t
(
f⁄tid
);

1515 i‡(
f⁄ç
)

1516 
	`GdSëF⁄tRŸ©i⁄
(
f⁄ç
->
pf⁄t
, 
ã¡hdegªes
);

1518 
	`SERVER_UNLOCK
();

1519 
	}
}

1523 
	$GrSëF⁄tAâr
(
GR_FONT_ID
 
f⁄tid
, 
£tÊags
, 
˛rÊags
)

1525 
GR_FONT
 *
f⁄ç
;

1527 
	`SERVER_LOCK
();

1529 
f⁄ç
 = 
	`GsFödF⁄t
(
f⁄tid
);

1530 i‡(
f⁄ç
)

1531 
	`GdSëF⁄tAâr
(
f⁄ç
->
pf⁄t
, 
£tÊags
, 
˛rÊags
);

1533 
	`SERVER_UNLOCK
();

1534 
	}
}

1540 
	$GrDe°royF⁄t
(
GR_FONT_ID
 
f⁄tid
)

1542 
GR_FONT
 *
f⁄ç
;

1543 
GR_FONT
 *
¥evf⁄ç
;

1545 
	`SERVER_LOCK
();

1547 
f⁄ç
 = 
	`GsFödF⁄t
(
f⁄tid
);

1548 i‡(
f⁄ç
 =
NULL
) {

1549 
	`SERVER_UNLOCK
();

1553 i‡(
li°f⁄ç
 =
f⁄ç
)

1554 
li°f⁄ç
 = 
f⁄ç
->
√xt
;

1556 
¥evf⁄ç
 = 
li°f⁄ç
;

1557 
¥evf⁄ç
->
√xt
 !
f⁄ç
)

1558 
¥evf⁄ç
 =Öªvf⁄ç->
√xt
;

1560 
¥evf⁄ç
->
√xt
 = 
f⁄ç
->next;

1562 
	`GdDe°royF⁄t
(
f⁄ç
->
pf⁄t
);

1563 
	`‰ì
(
f⁄ç
);

1565 
	`SERVER_UNLOCK
();

1566 
	}
}

1573 
	$GrGëF⁄tInfo
(
GR_FONT_ID
 
f⁄t
, 
GR_FONT_INFO
 *
fù
)

1575 
GR_FONT
 *
f⁄ç
;

1576 
PMWFONT
 
pf
;

1578 
	`SERVER_LOCK
();

1580 i‡(
f⁄t
 == 0)

1581 
pf
 = 
°df⁄t
;

1583 
f⁄ç
 = 
	`GsFödF⁄t
(
f⁄t
);

1584 i‡(!
f⁄ç
) {

1585 
	`mem£t
(
fù
, 0, (
GR_FONT_INFO
));

1586 
	`SERVER_UNLOCK
();

1589 
pf
 = 
f⁄ç
->
pf⁄t
;

1591 
	`GdGëF⁄tInfo
(
pf
, 
fù
);

1593 
	`SERVER_UNLOCK
();

1594 
	}
}

1601 
	$GrSñe˘Evíts
(
GR_WINDOW_ID
 
wid
, 
GR_EVENT_MASK
 
evítmask
)

1603 
GR_WINDOW
 *
wp
;

1604 
GR_EVENT_CLIENT
 *
evp
;

1606 
	`SERVER_LOCK
();

1608 
wp
 = 
	`GsFödWödow
(
wid
);

1609 i‡(
wp
 =
NULL
) {

1610 
	`SERVER_UNLOCK
();

1618 
evp
 = 
wp
->
evít˛õ¡s
;Évp;Év∞evp->
√xt
) {

1619 i‡(
evp
->
˛õ¡
 =
cur˛õ¡
) {

1620 
evp
->
evítmask
 =Éventmask;

1621 
	`SERVER_UNLOCK
();

1630 
evp
 = (
GR_EVENT_CLIENT
 *Ë
	`mÆloc
((GR_EVENT_CLIENT));

1631 i‡(
evp
 =
NULL
) {

1632 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 
wid
);

1633 
	`SERVER_UNLOCK
();

1637 
evp
->
˛õ¡
 = 
cur˛õ¡
;

1638 
evp
->
evítmask
 =Éventmask;

1639 
evp
->
√xt
 = 
wp
->
evít˛õ¡s
;

1640 
wp
->
evít˛õ¡s
 = 
evp
;

1648 i‡(
wid
==
GR_ROOT_WINDOW_ID
 && (
evítmask
 & 
GR_EVENT_MASK_CHLD_UPDATE
)) {

1649 
wp
 = 
li°wp
; wp; w∞wp->
√xt
) {

1650 i‡(
wp
->
ªÆized
)

1651 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_MAP
,

1652 
wp
->
x
, wp->
y
, wp->
width
, wp->
height
);

1656 
	`SERVER_UNLOCK
();

1657 
	}
}

1659 
GR_WINDOW
 *

1660 
	$NewWödow
(
GR_WINDOW
 *
pwp
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

1661 
GR_SIZE
 
height
, GR_SIZE 
b‹dîsize
, 
GR_COLOR
 
background
,

1662 
GR_COLOR
 
b‹dîcﬁ‹
)

1664 
GR_WINDOW
 *
wp
;

1666 i‡(
width
 <0 || 
height
 <0 || 
b‹dîsize
 < 0) {

1667 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_SIZE
, 0);

1668  
NULL
;

1671 
wp
 = (
GR_WINDOW
 *Ë
	`mÆloc
((GR_WINDOW));

1672 i‡(
wp
 =
NULL
) {

1673 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1674  
NULL
;

1677 
wp
->
id
 = 
√xtid
++;

1678 
wp
->
psd
 = 
roŸwp
->psd;

1679 
wp
->
∑ª¡
 = 
pwp
;

1680 
wp
->
chûdªn
 = 
NULL
;

1681 
wp
->
siblögs
 = 
pwp
->
chûdªn
;

1682 
wp
->
√xt
 = 
li°wp
;

1683 
wp
->
x
 = 
pwp
->x + x;

1684 
wp
->
y
 = 
pwp
->y + y;

1685 
wp
->
width
 = width;

1686 
wp
->
height
 = height;

1687 
wp
->
b‹dîsize
 = bordersize;

1688 
wp
->
background
 = background;

1689 
wp
->
bgpixm≠
 = 
NULL
;

1690 
wp
->
bgpixm≠Êags
 = 
GR_BACKGROUND_TILE
;

1691 
wp
->
b‹dîcﬁ‹
 = bordercolor;

1692 
wp
->
n›r›mask
 = 0;

1693 
wp
->
evít˛õ¡s
 = 
NULL
;

1694 
wp
->
ow√r
 = 
cur˛õ¡
;

1695 
wp
->
curs‹id
 = 
pwp
->cursorid;

1696 
wp
->
m≠≥d
 = 
GR_FALSE
;

1697 
wp
->
ªÆized
 = 
GR_FALSE
;

1698 
wp
->
ouçut
 = 
GR_TRUE
;

1699 
wp
->
¥›s
 = 0;

1700 
wp
->
tôÀ
 = 
NULL
;

1701 
wp
->
˛ùªgi⁄
 = 
NULL
;

1703 
pwp
->
chûdªn
 = 
wp
;

1704 
li°wp
 = 
wp
;

1706  
wp
;

1707 
	}
}

1714 
GR_WINDOW_ID


1715 
	$GrNewWödow
(
GR_WINDOW_ID
 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

1716 
GR_SIZE
 
height
, GR_SIZE 
b‹dîsize
, 
GR_COLOR
 
background
,

1717 
GR_COLOR
 
b‹dîcﬁ‹
)

1719 
GR_WINDOW
 *
pwp
;

1720 
GR_WINDOW
 *
wp
;

1721 
GR_WINDOW_ID
 
id
;

1723 
	`SERVER_LOCK
();

1725 
pwp
 = 
	`GsFödWödow
(
∑ª¡
);

1726 i‡(
pwp
 =
NULL
) {

1727 
	`SERVER_UNLOCK
();

1731 i‡(!
pwp
->
ouçut
) {

1732 
	`GsEº‹
(
GR_ERROR_INPUT_ONLY_WINDOW
, 
pwp
->
id
);

1733 
	`SERVER_UNLOCK
();

1737 
wp
 = 
	`NewWödow
(
pwp
, 
x
, 
y
, 
width
, 
height
, 
b‹dîsize
, 
background
,

1738 
b‹dîcﬁ‹
);

1739 
id
 = 
wp
? wp->id: 0;

1741 
	`SERVER_UNLOCK
();

1743  
id
;

1744 
	}
}

1752 
GR_WINDOW_ID


1753 
	$GrNewI≈utWödow
(
GR_WINDOW_ID
 
∑ª¡
, 
GR_COORD
 
x
, GR_COORD 
y
,

1754 
GR_SIZE
 
width
, GR_SIZE 
height
)

1756 
GR_WINDOW
 *
pwp
;

1757 
GR_WINDOW
 *
wp
;

1758 
GR_WINDOW_ID
 
id
;

1760 
	`SERVER_LOCK
();

1762 
pwp
 = 
	`GsFödWödow
(
∑ª¡
);

1763 i‡(
pwp
 =
NULL
) {

1764 
	`SERVER_UNLOCK
();

1768 
wp
 = 
	`NewWödow
(
pwp
, 
x
, 
y
, 
width
, 
height
, 0, 
BLACK
, BLACK);

1769 i‡(
wp
) {

1771 
wp
->
ouçut
 = 
GR_FALSE
;

1772 
id
 = 
wp
->id;

1773 
	`SERVER_UNLOCK
();

1774  
id
;

1776 
	`SERVER_UNLOCK
();

1778 
	}
}

1784 
GR_WINDOW_ID


1785 
	$GrNewPixm≠
(
GR_SIZE
 
width
, GR_SIZE 
height
, * 
pixñs
)

1787 
GR_PIXMAP
 *
µ
;

1788 
PSD
 
psd
;

1789 
size
, 
löñí
, 
bµ
, 
∂™es
;

1790 
GR_WINDOW_ID
 
id
;

1792 i‡(
width
 <0 || 
height
 <= 0) {

1798 
	`SERVER_LOCK
();

1805 
∂™es
 = 
roŸwp
->
psd
->planes;

1806 
bµ
 = 
roŸwp
->
psd
->bpp;

1807 
psd
 = 
roŸwp
->psd->
	`AŒoˇãMemGC
(rootwp->psd);

1808 i‡(!
psd
) {

1809 
	`SERVER_UNLOCK
();

1813 
µ
 = (
GR_PIXMAP
 *Ë
	`mÆloc
((GR_PIXMAP));

1814 i‡(
µ
 =
NULL
) {

1815 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1816 
psd
->
	`FªeMemGC
(psd);

1817 
	`SERVER_UNLOCK
();

1821 
	`GdCÆcMemGCAŒoc
(
psd
, 
width
, 
height
, 0, 0, &
size
, &
löñí
);

1824 i‡(!
pixñs
) {

1825 
pixñs
 = 
	`ˇŒoc
(
size
, 1);

1826 
psd
->
Êags
 |
PSF_ADDRMALLOC
;

1828 i‡(!
pixñs
) {

1829 
	`‰ì
(
µ
);

1830 
psd
->
	`FªeMemGC
(psd);

1831 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

1832 
	`SERVER_UNLOCK
();

1836 
µ
->
id
 = 
√xtid
++;

1837 
µ
->
√xt
 = 
li°µ
;

1838 
µ
->
psd
 =Ösd;

1839 
µ
->
x
 = 0;

1840 
µ
->
y
 = 0;

1841 
µ
->
width
 = width;

1842 
µ
->
height
 = height;

1843 
µ
->
ow√r
 = 
cur˛õ¡
;

1845 
psd
->
	`M≠MemGC
’sd, 
width
, 
height
, 
∂™es
, 
bµ
, 
löñí
, 
size
,

1846 
pixñs
);

1848 
li°µ
 = 
µ
;

1850 
id
 = 
µ
->id;

1852 
	`SERVER_UNLOCK
();

1854  
id
;

1855 
	}
}

1861 
	$GrM≠Wödow
(
GR_WINDOW_ID
 
wid
)

1863 
GR_WINDOW
 *
wp
;

1865 
	`SERVER_LOCK
();

1867 
wp
 = 
	`GsFödWödow
(
wid
);

1868 i‡(!
wp
 || wp->
m≠≥d
) {

1869 
	`SERVER_UNLOCK
();

1873 
wp
->
m≠≥d
 = 
GR_TRUE
;

1875 
	`GsWpRólizeWödow
(
wp
, 
GR_FALSE
);

1877 
	`SERVER_UNLOCK
();

1878 
	}
}

1884 
	$GrUnm≠Wödow
(
GR_WINDOW_ID
 
wid
)

1886 
GR_WINDOW
 *
wp
;

1888 
	`SERVER_LOCK
();

1890 
wp
 = 
	`GsFödWödow
(
wid
);

1891 i‡(!
wp
 || !wp->
m≠≥d
) {

1892 
	`SERVER_UNLOCK
();

1896 
	`GsWpUƒólizeWödow
(
wp
, 
GR_FALSE
);

1898 
wp
->
m≠≥d
 = 
GR_FALSE
;

1900 
	`SERVER_UNLOCK
();

1901 
	}
}

1908 
	$GrCÀ¨Aªa
(
GR_WINDOW_ID
 
wid
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

1909 
GR_SIZE
 
height
, 
GR_BOOL
 
expo£Êag
)

1911 
GR_WINDOW
 *
wp
;

1913 
	`SERVER_LOCK
();

1915 
wp
 = 
	`GsPª∑ªWödow
(
wid
);

1916 i‡(
wp
) {

1917 i‡(
width
 == 0)

1918 
width
 = 
wp
->width;

1919 i‡(
height
 == 0)

1920 
height
 = 
wp
->height;

1921 
	`GsWpCÀ¨Wödow
(
wp
, 
x
, 
y
, 
width
, 
height
, 
expo£Êag
);

1924 
	`SERVER_UNLOCK
();

1925 
	}
}

1928 
GR_WINDOW_ID


1929 
	$GrGëFocus
()

1931 
GR_WINDOW_ID
 
id
;

1933 
	`SERVER_LOCK
();

1934 
id
 = 
focuswp
->id;

1935 
	`SERVER_UNLOCK
();

1937  
id
;

1938 
	}
}

1946 
	$GrSëFocus
(
GR_WINDOW_ID
 
wid
)

1948 
GR_WINDOW
 *
wp
;

1950 
	`SERVER_LOCK
();

1952 
wp
 = 
	`GsFödWödow
(
wid
);

1953 i‡(
wp
 =
NULL
) {

1954 
	`SERVER_UNLOCK
();

1958 i‡(!
wp
->
ªÆized
) {

1959 
	`GsEº‹
(
GR_ERROR_UNMAPPED_FOCUS_WINDOW
, 
wid
);

1960 
	`SERVER_UNLOCK
();

1965 i‡(
wp
->
¥›s
 & 
GR_WM_PROPS_NOFOCUS
) {

1966 
	`SERVER_UNLOCK
();

1970 
focusfixed
 = (
wp
 !
roŸwp
);

1971 
	`GsWpSëFocus
(
wp
);

1973 
	`SERVER_UNLOCK
();

1974 
	}
}

1979 
	g√xtcurs‹id
 = 1000;

1980 
GR_CURSOR_ID


1981 
	$GrNewCurs‹
(
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_COORD
 
hŸx
, GR_COORD 
hŸy
,

1982 
GR_COLOR
 
f‹eground
, GR_COLOR 
background
, 
GR_BITMAP
 *
fgbôm≠
,

1983 
GR_BITMAP
 *
bgbôm≠
)

1985 
GR_CURSOR
 *
˝
;

1986 
byãs
;

1987 
GR_CURSOR_ID
 
id
;

1989 
	`SERVER_LOCK
();

1994 i‡(
width
 <0 || width > 
MWMAX_CURSOR_SIZE
 ||

1995 
height
 <0 || heighà> 
MWMAX_CURSOR_SIZE
) {

1996 
	`GsEº‹
(
GR_ERROR_BAD_CURSOR_SIZE
, 0);

1997 
	`SERVER_UNLOCK
();

2001 
˝
 = (
GR_CURSOR
 *)
	`mÆloc
((GR_CURSOR));

2002 i‡(
˝
 =
NULL
) {

2003 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

2004 
	`SERVER_UNLOCK
();

2009 
˝
->
curs‹
.
width
 = width;

2010 
˝
->
curs‹
.
height
 = height;

2011 
˝
->
curs‹
.
hŸx
 = hotx;

2012 
˝
->
curs‹
.
hŸy
 = hoty;

2013 
˝
->
curs‹
.
fgcﬁ‹
 = 
f‹eground
;

2014 
˝
->
curs‹
.
bgcﬁ‹
 = 
background
;

2016 
byãs
 = 
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
);

2017 
	`mem˝y
(&
˝
->
curs‹
.
image
, 
fgbôm≠
, 
byãs
);

2018 
	`mem˝y
(&
˝
->
curs‹
.
mask
, 
bgbôm≠
, 
byãs
);

2020 
˝
->
id
 = 
√xtcurs‹id
++;

2021 
˝
->
ow√r
 = 
cur˛õ¡
;

2022 
˝
->
√xt
 = 
li°curs‹p
;

2023 
li°curs‹p
 = 
˝
;

2025 
id
 = 
˝
->id;

2027 
	`SERVER_UNLOCK
();

2029  
id
;

2030 
	}
}

2036 
	$GrDe°royCurs‹
(
GR_CURSOR_ID
 
cid
)

2038 
GR_CURSOR
 *
curs‹p
;

2039 
GR_CURSOR
 *
¥evcurs‹p
;

2041 
	`SERVER_LOCK
();

2043 
curs‹p
 = 
	`GsFödCurs‹
(
cid
);

2044 i‡(
curs‹p
 =
NULL
) {

2045 
	`SERVER_UNLOCK
();

2049 i‡(
li°curs‹p
 =
curs‹p
)

2050 
li°curs‹p
 = 
curs‹p
->
√xt
;

2052 
¥evcurs‹p
 = 
li°curs‹p
;

2053 
¥evcurs‹p
->
√xt
 !
curs‹p
)

2054 
¥evcurs‹p
 =Öªvcurs‹p->
√xt
;

2056 
¥evcurs‹p
->
√xt
 = 
curs‹p
->next;

2059 i‡(
curcurs‹
 =
curs‹p
)

2060 
curcurs‹
 = 
NULL
;

2062 
	`‰ì
(
curs‹p
);

2063 
	`GsCheckCurs‹
();

2065 
	`SERVER_UNLOCK
();

2066 
	}
}

2076 
	$GrSëWödowCurs‹
(
GR_WINDOW_ID
 
wid
, 
GR_CURSOR_ID
 
cid
)

2078 
GR_WINDOW
 *
wp
;

2079 
GR_CURSOR
 *
˝
;

2081 
	`SERVER_LOCK
();

2083 
wp
 = 
	`GsFödWödow
(
wid
);

2084 i‡(
wp
 =
NULL
) {

2085 
	`SERVER_UNLOCK
();

2089 i‡(
cid
 == 0)

2090 
˝
 = 
°dcurs‹
;

2092 
˝
 = 
	`GsFödCurs‹
(
cid
);

2093 i‡(!
˝
) {

2094 
	`SERVER_UNLOCK
();

2098 
wp
->
curs‹id
 = 
cid
;

2103 i‡(
˝
 =
curcurs‹
 || curcurs‹ =
NULL
) {

2104 
	`GdMoveCurs‹
(
curs‹x
 - 
˝
->
curs‹
.
hŸx
,

2105 
curs‹y
 - 
˝
->
curs‹
.
hŸy
);

2106 
	`GdSëCurs‹
(&
˝
->
curs‹
);

2109 
	`GsCheckCurs‹
();

2111 
	`SERVER_UNLOCK
();

2112 
	}
}

2123 
	$GrMoveCurs‹
(
GR_COORD
 
x
, GR_COORD 
y
)

2126 
	`SERVER_LOCK
();

2132 i‡(
x
 !
curs‹x
 || 
y
 !
curs‹y
) {

2133 if(
curcurs‹
) {

2134 
	`GdMoveCurs‹
(
x
 - 
curcurs‹
->
curs‹
.
hŸx
,

2135 
y
 - 
curcurs‹
->
curs‹
.
hŸy
);

2136 
	`GdMoveMou£
(
x
, 
y
);

2138 
curs‹x
 = 
x
;

2139 
curs‹y
 = 
y
;

2147 
	`GsCheckMou£Wödow
();

2148 
	`GsCheckFocusWödow
();

2149 
	`GsCheckCurs‹
();

2151 
	`SERVER_UNLOCK
();

2152 
	}
}

2158 
	$GrSëGCF‹eground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
f‹eground
)

2160 
GR_GC
 *
g˝
;

2162 
	`SERVER_LOCK
();

2164 
g˝
 = 
	`GsFödGC
(
gc
);

2165 i‡(
g˝
 && ((g˝->
f‹eground
 !f‹egroundË|| g˝->
fgi•ixñvÆ
)) {

2166 
g˝
->
f‹eground
 = foreground;

2167 
g˝
->
fgi•ixñvÆ
 = 
GR_FALSE
;

2168 
g˝
->
ch™ged
 = 
GR_TRUE
;

2171 
	`SERVER_UNLOCK
();

2172 
	}
}

2178 
	$GrSëGCBackground
(
GR_GC_ID
 
gc
, 
GR_COLOR
 
background
)

2180 
GR_GC
 *
g˝
;

2182 
	`SERVER_LOCK
();

2184 
g˝
 = 
	`GsFödGC
(
gc
);

2185 i‡(
g˝
 && ((g˝->
background
 !backgroundË|| g˝->
bgi•ixñvÆ
)) {

2186 
g˝
->
background
 = background;

2187 
g˝
->
bgi•ixñvÆ
 = 
GR_FALSE
;

2188 
g˝
->
ch™ged
 = 
GR_TRUE
;

2191 
	`SERVER_UNLOCK
();

2192 
	}
}

2198 
	$GrSëGCF‹egroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
f‹eground
)

2200 
GR_GC
 *
g˝
;

2202 
	`SERVER_LOCK
();

2204 
g˝
 = 
	`GsFödGC
(
gc
);

2205 i‡(
g˝
 && ((g˝->
f‹eground
 !f‹egroundË|| !g˝->
fgi•ixñvÆ
)) {

2206 
g˝
->
f‹eground
 = foreground;

2207 
g˝
->
fgi•ixñvÆ
 = 
GR_TRUE
;

2208 
g˝
->
ch™ged
 = 
GR_TRUE
;

2211 
	`SERVER_UNLOCK
();

2212 
	}
}

2218 
	$GrSëGCBackgroundPixñVÆ
(
GR_GC_ID
 
gc
, 
GR_PIXELVAL
 
background
)

2220 
GR_GC
 *
g˝
;

2222 
	`SERVER_LOCK
();

2224 
g˝
 = 
	`GsFödGC
(
gc
);

2225 i‡(
g˝
 && ((g˝->
background
 !backgroundË|| !g˝->
bgi•ixñvÆ
)) {

2226 
g˝
->
background
 = background;

2227 
g˝
->
bgi•ixñvÆ
 = 
GR_TRUE
;

2228 
g˝
->
ch™ged
 = 
GR_TRUE
;

2231 
	`SERVER_UNLOCK
();

2232 
	}
}

2238 
	$GrSëGCU£Background
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
Êag
)

2240 
GR_GC
 *
g˝
;

2242 
	`SERVER_LOCK
();

2244 
Êag
 = (flag != 0);

2245 
g˝
 = 
	`GsFödGC
(
gc
);

2246 i‡(
g˝
 && g˝->
u£background
 !
Êag
) {

2247 
g˝
->
u£background
 = 
Êag
;

2248 
g˝
->
ch™ged
 = 
GR_TRUE
;

2251 
	`SERVER_UNLOCK
();

2252 
	}
}

2258 
	$GrSëGCMode
(
GR_GC_ID
 
gc
, 
mode
)

2260 
GR_GC
 *
g˝
;

2262 
	`SERVER_LOCK
();

2264 
g˝
 = 
	`GsFödGC
(
gc
);

2265 i‡(!
g˝
 || g˝->
mode
 == mode) {

2266 
	`SERVER_UNLOCK
();

2269 i‡((
mode
 & 
GR_MODE_DRAWMASK
Ë> 
GR_MAX_MODE
) {

2270 
	`GsEº‹
(
GR_ERROR_BAD_DRAWING_MODE
, 
gc
);

2271 
	`SERVER_UNLOCK
();

2275 
g˝
->
mode
 = mode;

2276 
g˝
->
ch™ged
 = 
GR_TRUE
;

2278 
	`SERVER_UNLOCK
();

2279 
	}
}

2285 
	$GrSëGCLöeAâribuãs
(
GR_GC_ID
 
gc
, 
löe°yÀ
)

2287 
GR_GC
 *
g˝
;

2289 
	`SERVER_LOCK
();

2291 
g˝
 = 
	`GsFödGC
(
gc
);

2292 i‡(!
g˝
) {

2293 
	`SERVER_UNLOCK
();

2297 
löe°yÀ
) {

2298 
GR_LINE_SOLID
:

2299 
GR_LINE_ONOFF_DASH
:

2300 
g˝
->
löe°yÀ
 =Üinestyle;

2304 
	`GsEº‹
(
GR_ERROR_BAD_LINE_ATTRIBUTE
, 
gc
);

2305 
	`SERVER_UNLOCK
();

2308 
g˝
->
ch™ged
 = 
GR_TRUE
;

2310 
	`SERVER_UNLOCK
();

2311 
	}
}

2319 
	$GrSëGCDash
(
GR_GC_ID
 
gc
, *
dashes
, 
cou¡
)

2321 
GR_GC
 *
g˝
;

2322 
dmask
 = 0;

2323 
dcou¡
 = 0;

2324 
⁄off
 = 1;

2325 
i
;

2327 
	`SERVER_LOCK
();

2329 
g˝
 = 
	`GsFödGC
(
gc
);

2330 i‡(!
g˝
) {

2331 
	`SERVER_UNLOCK
();

2336 
i
 = 0; i < 
cou¡
; i++) {

2337 
b
 = 0;

2339 ; 
b
 < 
dashes
[
i
]; b++) {

2340 i‡(
⁄off
)

2341 
dmask
 |(1 << 
dcou¡
);

2342 i‡((++
dcou¡
) == 32)

2346 
⁄off
 = (onoff + 1) % 2;

2347 i‡(
dcou¡
 == 32)

2350 
g˝
->
dashmask
 = 
dmask
;

2351 
g˝
->
dashcou¡
 = 
dcou¡
;

2352 
g˝
->
ch™ged
 = 
GR_TRUE
;

2354 
	`SERVER_UNLOCK
();

2355 
	}
}

2358 
	$GrSëGCFûlMode
(
GR_GC_ID
 
gc
, 
fûlmode
)

2360 
GR_GC
 *
g˝
;

2362 
	`SERVER_LOCK
();

2364 
g˝
 = 
	`GsFödGC
(
gc
);

2365 i‡(!
g˝
) {

2366 
	`SERVER_UNLOCK
();

2370 
fûlmode
) {

2371 
GR_FILL_SOLID
:

2372 
GR_FILL_STIPPLE
:

2373 
GR_FILL_OPAQUE_STIPPLE
:

2374 
GR_FILL_TILE
:

2375 
g˝
->
fûlmode
 = fillmode;

2379 
	`GsEº‹
(
GR_ERROR_BAD_FILL_MODE
, 
gc
);

2380 
	`SERVER_UNLOCK
();

2383 
g˝
->
ch™ged
 = 
GR_TRUE
;

2385 
	`SERVER_UNLOCK
();

2386 
	}
}

2389 
	$GrSëGCStù∂e
(
GR_GC_ID
 
gc
, 
GR_BITMAP
 * 
bôm≠
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

2391 
GR_GC
 *
g˝
;

2393 
	`SERVER_LOCK
();

2395 
g˝
 = 
	`GsFödGC
(
gc
);

2396 i‡(!
g˝
) {

2397 
	`SERVER_UNLOCK
();

2401 i‡(
g˝
->
°ù∂e
.
bôm≠
)

2402 
	`‰ì
(
g˝
->
°ù∂e
.
bôm≠
);

2404 i‡(!
bôm≠
) {

2405 
g˝
->
°ù∂e
.
bôm≠
 = 0;

2406 
g˝
->
°ù∂e
.
width
 = g˝->°ù∂e.
height
 = 0;

2407 
g˝
->
ch™ged
 = 
GR_TRUE
;

2408 
	`SERVER_UNLOCK
();

2412 
g˝
->
°ù∂e
.
bôm≠
 =

2413 
	`mÆloc
(
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
));

2414 
	`mem˝y
(
g˝
->
°ù∂e
.
bôm≠
, bitmap,

2415 
	`GR_BITMAP_SIZE
(
width
, 
height
Ë* (
GR_BITMAP
));

2417 
g˝
->
°ù∂e
.
width
 = width;

2418 
g˝
->
°ù∂e
.
height
 = height;

2419 
g˝
->
ch™ged
 = 
GR_TRUE
;

2421 
	`SERVER_UNLOCK
();

2422 
	}
}

2425 
	$GrSëGCTûe
(
GR_GC_ID
 
gc
, 
GR_WINDOW_ID
 
pixm≠
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

2427 
GR_WINDOW
 *
wö
;

2428 
GR_GC
 *
g˝
;

2430 
	`SERVER_LOCK
();

2432 
g˝
 = 
	`GsFödGC
(
gc
);

2433 i‡(!
g˝
) {

2434 
	`SERVER_UNLOCK
();

2438 i‡(!
pixm≠
) {

2439 
g˝
->
tûe
.
psd
 = 
NULL
;

2440 
g˝
->
tûe
.
width
 = g˝->tûe.
height
 = 0;

2441 
g˝
->
ch™ged
 = 
GR_TRUE
;

2442 
	`SERVER_UNLOCK
();

2446 
wö
 = 
	`GsFödWödow
(
pixm≠
);

2447 i‡(
wö
)

2448 
g˝
->
tûe
.
psd
 = 
wö
->psd;

2450 
GR_PIXMAP
 *
pix
 = 
	`GsFödPixm≠
(
pixm≠
);

2451 i‡(!
pix
) {

2452 
g˝
->
tûe
.
psd
 = 
NULL
;

2453 
g˝
->
tûe
.
width
 = g˝->tûe.
height
 = 0;

2454 
g˝
->
ch™ged
 = 
GR_TRUE
;

2455 
	`SERVER_UNLOCK
();

2458 
g˝
->
tûe
.
psd
 = 
pix
->psd;

2462 
g˝
->
tûe
.
width
 = width;

2463 
g˝
->
tûe
.
height
 = height;

2464 
g˝
->
ch™ged
 = 
GR_TRUE
;

2466 
	`SERVER_UNLOCK
();

2467 
	}
}

2470 
	$GrSëGCTSOff£t
(
GR_GC_ID
 
gc
, 
GR_COORD
 
xoff
, GR_COORD 
yoff
)

2472 
GR_GC
 *
g˝
;

2474 
	`SERVER_LOCK
();

2476 
g˝
 = 
	`GsFödGC
(
gc
);

2477 i‡(
g˝
) {

2478 
g˝
->
ts_off£t
.
x
 = 
xoff
;

2479 
g˝
->
ts_off£t
.
y
 = 
yoff
;

2480 
g˝
->
ch™ged
 = 
GR_TRUE
;

2483 
	`SERVER_UNLOCK
();

2484 
	}
}

2490 
	$GrSëGCGøphicsExposuª
(
GR_GC_ID
 
gc
, 
GR_BOOL
 
exposuª
)

2492 
GR_GC
 *
g˝
;

2494 
	`SERVER_LOCK
();

2496 
g˝
 = 
	`GsFödGC
(
gc
);

2497 i‡(
g˝
) {

2498 
g˝
->
exposuª
 =Éxposure;

2499 
g˝
->
ch™ged
 = 
GR_TRUE
;

2502 
	`SERVER_UNLOCK
();

2503 
	}
}

2510 
	$GrSëGCF⁄t
(
GR_GC_ID
 
gc
, 
GR_FONT_ID
 
f⁄t
)

2512 
GR_GC
 *
g˝
;

2514 
	`SERVER_LOCK
();

2516 
g˝
 = 
	`GsFödGC
(
gc
);

2517 i‡(
g˝
 && g˝->
f⁄tid
 !
f⁄t
) {

2518 
g˝
->
f⁄tid
 = 
f⁄t
;

2519 
g˝
->
ch™ged
 = 
GR_TRUE
;

2522 
	`SERVER_UNLOCK
();

2523 
	}
}

2530 
	$GrLöe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x1
, GR_COORD 
y1
, GR_COORD 
x2
,

2531 
GR_COORD
 
y2
)

2533 
GR_DRAWABLE
 *
dp
;

2535 
	`SERVER_LOCK
();

2537 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2538 
GR_DRAW_TYPE_WINDOW
:

2539 
GR_DRAW_TYPE_PIXMAP
:

2540 
	`GdLöe
(
dp
->
psd
, dp->
x
 + 
x1
, dp->
y
 + 
y1
,

2541 
dp
->
x
 + 
x2
, dp->
y
 + 
y2
, 
TRUE
);

2545 
	`SERVER_UNLOCK
();

2546 
	}
}

2555 
	$GrRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

2556 
GR_SIZE
 
height
)

2558 
GR_DRAWABLE
 *
dp
;

2560 
	`SERVER_LOCK
();

2562 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2563 
GR_DRAW_TYPE_WINDOW
:

2564 
GR_DRAW_TYPE_PIXMAP
:

2565 
	`GdRe˘
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
width
, 
height
);

2569 
	`SERVER_UNLOCK
();

2570 
	}
}

2577 
	$GrFûlRe˘
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2578 
GR_SIZE
 
width
, GR_SIZE 
height
)

2580 
GR_DRAWABLE
 *
dp
;

2582 
	`SERVER_LOCK
();

2584 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2585 
GR_DRAW_TYPE_WINDOW
:

2586 
GR_DRAW_TYPE_PIXMAP
:

2587 
	`GdFûlRe˘
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
width
,
height
);

2591 
	`SERVER_UNLOCK
();

2592 
	}
}

2599 
	$GrEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
rx
,

2600 
GR_SIZE
 
ry
)

2602 
GR_DRAWABLE
 *
dp
;

2604 
	`SERVER_LOCK
();

2606 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2607 
GR_DRAW_TYPE_WINDOW
:

2608 
GR_DRAW_TYPE_PIXMAP
:

2609 
	`GdEŒù£
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
rx
, 
ry
, 
FALSE
);

2613 
	`SERVER_UNLOCK
();

2614 
	}
}

2621 
	$GrFûlEŒù£
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
rx
,

2622 
GR_SIZE
 
ry
)

2624 
GR_DRAWABLE
 *
dp
;

2626 
	`SERVER_LOCK
();

2628 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2629 
GR_DRAW_TYPE_WINDOW
:

2630 
GR_DRAW_TYPE_PIXMAP
:

2631 
	`GdEŒù£
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
rx
, 
ry
, 
TRUE
);

2635 
	`SERVER_UNLOCK
();

2636 
	}
}

2643 
	$GrArc
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2644 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
ax
, GR_COORD 
ay
,

2645 
GR_COORD
 
bx
, GR_COORD 
by
, 
ty≥
)

2647 
GR_DRAWABLE
 *
dp
;

2649 
	`SERVER_LOCK
();

2651 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2652 
GR_DRAW_TYPE_WINDOW
:

2653 
GR_DRAW_TYPE_PIXMAP
:

2654 
	`GdArc
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
rx
, 
ry
, 
ax
, 
ay
,

2655 
bx
, 
by
, 
ty≥
);

2660 
	`SERVER_UNLOCK
();

2661 
	}
}

2668 
	$GrArcAngÀ
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2669 
GR_SIZE
 
rx
, GR_SIZE 
ry
, 
GR_COORD
 
™gÀ1
, GR_COORD 
™gÀ2
, 
ty≥
)

2671 
GR_DRAWABLE
 *
dp
;

2673 
	`SERVER_LOCK
();

2675 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2676 
GR_DRAW_TYPE_WINDOW
:

2677 
GR_DRAW_TYPE_PIXMAP
:

2678 
	`GdArcAngÀ
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
rx
, 
ry
,

2679 
™gÀ1
, 
™gÀ2
, 
ty≥
);

2683 
	`SERVER_UNLOCK
();

2684 
	}
}

2696 
	$GrBôm≠
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

2697 
GR_SIZE
 
height
, 
GR_BITMAP
 *
imagebôs
)

2699 
GR_DRAWABLE
 *
dp
;

2701 
	`SERVER_LOCK
();

2703 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2704 
GR_DRAW_TYPE_WINDOW
:

2705 
GR_DRAW_TYPE_PIXMAP
:

2706 
	`GdBôm≠
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
width
, 
height
,

2707 
imagebôs
);

2711 
	`SERVER_UNLOCK
();

2712 
	}
}

2716 
	$GrDøwImageBôs
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2717 
GR_IMAGE_HDR
 *
pimage
)

2719 
GR_DRAWABLE
 *
dp
;

2721 
	`SERVER_LOCK
();

2723 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2724 
GR_DRAW_TYPE_WINDOW
:

2725 
GR_DRAW_TYPE_PIXMAP
:

2726 
	`GdDøwImage
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
pimage
);

2730 
	`SERVER_UNLOCK
();

2731 
	}
}

2733 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_FILEIO
)

2736 
	$GrDøwImageFromFûe
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2737 
GR_SIZE
 
width
, GR_SIZE 
height
, * 
∑th
, 
Êags
)

2739 
GR_DRAWABLE
 *
dp
;

2741 
	`SERVER_LOCK
();

2743 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2744 
GR_DRAW_TYPE_WINDOW
:

2745 
GR_DRAW_TYPE_PIXMAP
:

2746 
	`GdDøwImageFromFûe
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y,

2747 
width
, 
height
, 
∑th
, 
Êags
);

2751 
	`SERVER_UNLOCK
();

2752 
	}
}

2755 
GR_IMAGE_ID


2756 
	$GrLﬂdImageFromFûe
(*
∑th
, 
Êags
)

2758 
GR_IMAGE_ID
 
id
;

2759 
GR_IMAGE
 * 
imagï
;

2761 
	`SERVER_LOCK
();

2763 
id
 = 
	`GdLﬂdImageFromFûe
(&
s¸dev
, 
∑th
, 
Êags
);

2764 i‡(!
id
) {

2765 
	`SERVER_UNLOCK
();

2769 
imagï
 = (
GR_IMAGE
 *Ë
	`mÆloc
((GR_IMAGE));

2770 i‡(!
imagï
) {

2771 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

2772 
	`GdFªeImage
(
id
);

2773 
	`SERVER_UNLOCK
();

2777 
imagï
->
id
 = id;

2778 
imagï
->
ow√r
 = 
cur˛õ¡
;

2779 
imagï
->
√xt
 = 
li°imagï
;

2780 
li°imagï
 = 
imagï
;

2782 
	`SERVER_UNLOCK
();

2783  
id
;

2784 
	}
}

2787 #i‡
MW_FEATURE_IMAGES


2790 
	$GrDøwImageFromBuf„r
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2791 
GR_SIZE
 
width
, GR_SIZE 
height
, *
buf„r
, 
size
, 
Êags
)

2793 
GR_DRAWABLE
 *
dp
;

2795 
	`SERVER_LOCK
();

2797 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2798 
GR_DRAW_TYPE_WINDOW
:

2799 
GR_DRAW_TYPE_PIXMAP
:

2800 
	`GdDøwImageFromBuf„r
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y,

2801 
width
, 
height
, 
buf„r
, 
size
, 
Êags
);

2805 
	`SERVER_UNLOCK
();

2806 
	}
}

2809 
GR_IMAGE_ID


2810 
	$GrLﬂdImageFromBuf„r
(*
buf„r
, 
size
, 
Êags
)

2812 
GR_IMAGE_ID
 
id
;

2813 
GR_IMAGE
 * 
imagï
;

2815 
	`SERVER_LOCK
();

2817 
id
 = 
	`GdLﬂdImageFromBuf„r
(&
s¸dev
, 
buf„r
, 
size
, 
Êags
);

2818 i‡(!
id
) {

2819 
	`SERVER_UNLOCK
();

2823 
imagï
 = (
GR_IMAGE
 *Ë
	`mÆloc
((GR_IMAGE));

2824 i‡(!
imagï
) {

2825 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

2826 
	`GdFªeImage
(
id
);

2827 
	`SERVER_UNLOCK
();

2831 
imagï
->
id
 = id;

2832 
imagï
->
ow√r
 = 
cur˛õ¡
;

2833 
imagï
->
√xt
 = 
li°imagï
;

2834 
li°imagï
 = 
imagï
;

2836 
	`SERVER_UNLOCK
();

2838  
id
;

2839 
	}
}

2843 
	$GrDøwImageToFô
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2844 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_IMAGE_ID
 
imageid
)

2846 
GR_DRAWABLE
 *
dp
;

2848 
	`SERVER_LOCK
();

2850 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2851 
GR_DRAW_TYPE_WINDOW
:

2852 
GR_DRAW_TYPE_PIXMAP
:

2853 
	`GdDøwImageToFô
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y,

2854 
width
, 
height
, 
imageid
);

2859 
	`SERVER_UNLOCK
();

2860 
	}
}

2864 
	$GrFªeImage
(
GR_IMAGE_ID
 
id
)

2866 
GR_IMAGE
 *
imagï
;

2867 
GR_IMAGE
 *
¥evimagï
;

2869 
	`SERVER_LOCK
();

2871 
imagï
 = 
li°imagï
; imagï; imagï = imagï->
√xt
) {

2872 i‡(
imagï
->
id
 == id) {

2874 i‡(
li°imagï
 =
imagï
)

2875 
li°imagï
 = 
imagï
->
√xt
;

2877 
¥evimagï
 = 
li°imagï
;

2878 
¥evimagï
->
√xt
 !
imagï
)

2879 
¥evimagï
 =Öªvimagï->
√xt
;

2881 
¥evimagï
->
√xt
 = 
imagï
->next;

2884 
	`GdFªeImage
(
imagï
->
id
);

2885 
	`‰ì
(
imagï
);

2886 
	`SERVER_UNLOCK
();

2891 
	`SERVER_UNLOCK
();

2892 
	}
}

2896 
	$GrGëImageInfo
(
GR_IMAGE_ID
 
id
, 
GR_IMAGE_INFO
 *
iù
)

2898 
	`SERVER_LOCK
();

2899 
	`GdGëImageInfo
(
id
, 
iù
);

2900 
	`SERVER_UNLOCK
();

2901 
	}
}

2911 
	$GrAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

2912 
GR_SIZE
 
height
, *
pixñs
, 
pixty≥
)

2914 
GR_DRAWABLE
 *
dp
;

2916 
	`SERVER_LOCK
();

2918 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

2919 
GR_DRAW_TYPE_WINDOW
:

2920 
GR_DRAW_TYPE_PIXMAP
:

2921 
	`GdAªa
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
width
, 
height
,

2922 
pixñs
, 
pixty≥
);

2926 
	`SERVER_UNLOCK
();

2927 
	}
}

2933 
	$GrC›yAªa
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
,

2934 
GR_SIZE
 
width
, GR_SIZE 
height
, 
GR_DRAW_ID
 
§cid
,

2935 
GR_COORD
 
§cx
, GR_COORD 
§cy
, 
›
)

2937 
GR_GC
 *
g˝
;

2938 
GR_BOOL
 
exposuª
 = 
GR_TRUE
;

2940 
GR_DRAWABLE
 *
dp
;

2941 
GR_WINDOW
 *
swp
;

2942 
GR_PIXMAP
 *
•p
 = 
NULL
;

2943 
GR_DRAW_TYPE
 
ty≥
;

2944 
PSD
 
§˝sd
;

2946 
	`SERVER_LOCK
();

2948 
§˝sd
 = 
NULL
;

2950 
swp
 = 
	`GsFödWödow
(
§cid
);

2951 
ty≥
 = 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
);

2952 i‡(
ty≥
 =
GR_DRAW_TYPE_NONE
) {

2953 
	`SERVER_UNLOCK
();

2957 i‡(
swp
) {

2958 
§˝sd
 = 
swp
->
psd
;

2959 
§cx
 +
swp
->
x
;

2960 
§cy
 +
swp
->
y
;

2962 
•p
 = 
	`GsFödPixm≠
(
§cid
);

2963 i‡(
•p
)

2964 
§˝sd
 = 
•p
->
psd
;

2966 i‡(!
§˝sd
) {

2967 
	`SERVER_UNLOCK
();

2971 #i‡
DYNAMICREGIONS


2972 
g˝
 = 
	`GsFödGC
(
gc
);

2973 i‡(
g˝
)

2974 
exposuª
 = 
g˝
->exposure;

2983 i‡(
exposuª
 && 
swp
 && (
§˝sd
 =
dp
->
psd
Ë&& swp->
evít˛õ¡s
 &&

2984 (
swp
->
evít˛õ¡s
->
evítmask
 & 
GR_EVENT_MASK_EXPOSURE
)) {

2985 
MWRECT
 
rc
;

2986 
MWCLIPREGION
 *
˛ùªgi⁄
;

2989 if(
§cx
+
width
 > 
§˝sd
->
xvúåes
)

2990 
width
 = 
§˝sd
->
xvúåes
 - 
§cx
;

2991 if(
§cy
+
height
 > 
§˝sd
->
yvúåes
)

2992 
height
 = 
§˝sd
->
yvúåes
 - 
§cy
;

2994 
rc
.
À·
 = 
§cx
;

2995 
rc
.
t›
 = 
§cy
;

2996 
rc
.
right
 = 
§cx
 + 
width
;

2997 
rc
.
bŸtom
 = 
§cy
 + 
height
;

3005 i‡(
	`GdRe˘InRegi⁄
(
˛ùªgi⁄
, &
rc
Ë!
MWRECT_ALLIN
) {

3006 
	`EPRINTF
("nano-X: skipping blit, sendingÉxposeÉvent\n");

3007 
	`GsDñivîExposuªEvít
(
swp
, 
dp
->
x
+x, dp->
y
+y,

3008 
width
, 
height
);

3009 
	`SERVER_UNLOCK
();

3015 i‡(
›
 =
MWROP_USE_GC_MODE
) {

3016 
GR_GC
 *
g˝
 = 
	`GsFödGC
(
gc
);

3018 i‡(
g˝
 =
NULL
) {

3019 
›
 = 
MWROP_COPY
;

3021 
›
 = 
	`MWMODE_TO_ROP
(
g˝
->
mode
);

3026 
	`GdCheckCurs‹
(
§˝sd
, 
§cx
, 
§cy
, srcx+
width
, srcy+
height
);

3027 
	`GdBlô
(
dp
->
psd
, dp->
x
+x, dp->
y
+y, 
width
, 
height
, 
§˝sd
, 
§cx
, 
§cy
,
›
);

3028 
	`GdFixCurs‹
(
§˝sd
);

3030 
	`SERVER_UNLOCK
();

3031 
	}
}

3042 
	$GrRódAªa
(
GR_DRAW_ID
 
id
,
GR_COORD
 
x
,GR_COORD 
y
,
GR_SIZE
 
width
,GR_SIZE 
height
,

3043 
GR_PIXELVAL
 *
pixñs
)

3045 
GR_WINDOW
 *
wp
;

3046 
GR_PIXMAP
 *
µ
 = 
NULL
;

3048 
	`SERVER_LOCK
();

3050 i‡((
wp
 = 
	`GsFödWödow
(
id
)Ë=
NULL
 && (
µ
 = 
	`GsFödPixm≠
(id)) == NULL){

3051 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
id
);

3052 
	`SERVER_UNLOCK
();

3056 i‡(
wp
 !
NULL
) {

3057 i‡(!
wp
->
ªÆized
 || (
x
 >wp->
width
Ë|| (
y
 >wp->
height
) ||

3058 (
x
 + 
width
 <0Ë|| (
y
 + 
height
 <= 0)) {

3067 
	`SERVER_UNLOCK
();

3070 
	`GdRódAªa
(
wp
->
psd
, wp->
x
+x, wp->
y
+y, 
width
, 
height
, 
pixñs
);

3072 i‡(
µ
 !
NULL
) {

3073 i‡((
x
 >
µ
->
width
Ë|| (
y
 >µ->
height
) ||

3074 (
x
 + 
width
 <0Ë|| (
y
 + 
height
 <= 0)) {

3075 
	`SERVER_UNLOCK
();

3078 
	`GdRódAªa
(
µ
->
psd
, 
x
, 
y
, 
width
, 
height
, 
pixñs
);

3081 
	`SERVER_UNLOCK
();

3082 
	}
}

3089 
	$GrPoöt
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
)

3091 
GR_DRAWABLE
 *
dp
;

3093 
	`SERVER_LOCK
();

3095 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

3096 
GR_DRAW_TYPE_WINDOW
:

3097 
GR_DRAW_TYPE_PIXMAP
:

3098 
	`GdPoöt
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y);

3102 
	`SERVER_UNLOCK
();

3103 
	}
}

3110 
	$GrPoöts
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöâabÀ
)

3112 
GR_DRAWABLE
 *
dp
;

3113 
GR_POINT
 *
µ
;

3114 
GR_COUNT
 
i
;

3115 
PSD
 
psd
;

3117 
	`SERVER_LOCK
();

3119 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

3120 
GR_DRAW_TYPE_WINDOW
:

3121 
GR_DRAW_TYPE_PIXMAP
:

3122 
psd
 = 
dp
->psd;

3125 
	`SERVER_UNLOCK
();

3129 
µ
 = 
poöâabÀ
;

3130 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

3131 
	`GdPoöt
(
psd
, 
µ
->
x
 + 
dp
->x,Öp->
y
 + dp->y);

3134 
	`SERVER_UNLOCK
();

3135 
	}
}

3143 
	$GrPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöâabÀ
)

3145 
GR_DRAWABLE
 *
dp
;

3146 
GR_POINT
 *
µ
;

3147 
GR_COUNT
 
i
;

3148 
PSD
 
psd
;

3150 
	`SERVER_LOCK
();

3152 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

3153 
GR_DRAW_TYPE_WINDOW
:

3154 
GR_DRAW_TYPE_PIXMAP
:

3155 
psd
 = 
dp
->psd;

3158 
	`SERVER_UNLOCK
();

3166 
µ
 = 
poöâabÀ
;

3167 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

3168 
µ
->
x
 +
dp
->x;

3169 
µ
->
y
 +
dp
->y;

3172 
	`GdPﬁy
(
psd
, 
cou¡
, 
poöâabÀ
);

3174 #ifde‡
NONETWORK


3180 
µ
 = 
poöâabÀ
;

3181 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

3182 
µ
->
x
 -
dp
->x;

3183 
µ
->
y
 -
dp
->y;

3187 
	`SERVER_UNLOCK
();

3188 
	}
}

3196 
	$GrFûlPﬁy
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COUNT
 
cou¡
, 
GR_POINT
 *
poöâabÀ
)

3198 
GR_DRAWABLE
 *
dp
;

3199 
GR_POINT
 *
µ
;

3200 
GR_COUNT
 
i
;

3201 
PSD
 
psd
;

3203 
	`SERVER_LOCK
();

3205 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

3206 
GR_DRAW_TYPE_WINDOW
:

3207 
GR_DRAW_TYPE_PIXMAP
:

3208 
psd
 = 
dp
->psd;

3211 
	`SERVER_UNLOCK
();

3219 
µ
 = 
poöâabÀ
;

3220 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

3221 
µ
->
x
 +
dp
->x;

3222 
µ
->
y
 +
dp
->y;

3225 
	`GdFûlPﬁy
(
psd
, 
cou¡
, 
poöâabÀ
);

3227 #ifde‡
NONETWORK


3233 
µ
 = 
poöâabÀ
;

3234 
i
 = 
cou¡
; i-- > 0; 
µ
++) {

3235 
µ
->
x
 -
dp
->x;

3236 
µ
->
y
 -
dp
->y;

3240 
	`SERVER_UNLOCK
();

3241 
	}
}

3248 
	$GrText
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gc
, 
GR_COORD
 
x
, GR_COORD 
y
, *
°r
,

3249 
GR_COUNT
 
cou¡
, 
GR_TEXTFLAGS
 
Êags
)

3251 
GR_DRAWABLE
 *
dp
;

3253 
	`SERVER_LOCK
();

3256 if((
Êags
&(
MWTF_TOP
|
MWTF_BASELINE
|
MWTF_BOTTOM
)) == 0)

3257 
Êags
 |
MWTF_BASELINE
;

3259 
	`GsPª∑ªDøwög
(
id
, 
gc
, &
dp
)) {

3260 
GR_DRAW_TYPE_WINDOW
:

3261 
GR_DRAW_TYPE_PIXMAP
:

3262 
	`GdText
(
dp
->
psd
, dp->
x
 + x, dp->
y
 + y, 
°r
, 
cou¡
,
Êags
);

3266 
	`SERVER_UNLOCK
();

3267 
	}
}

3271 
	$GrGëSy°emPÆëã
(
GR_PALETTE
 *
∑l
)

3274 
	`SERVER_LOCK
();

3277 
	`mem£t
(
∑l
, 0, (
GR_PALETTE
 *));

3279 if(
roŸwp
->
psd
->
pixty≥
 =
MWPF_PALETTE
) {

3280 
∑l
->
cou¡
 = ()
roŸwp
->
psd
->
ncﬁ‹s
;

3281 
	`GdGëPÆëã
(
roŸwp
->
psd
, 0, 
∑l
->
cou¡
,ÖÆ->
∑Àâe
);

3284 
	`SERVER_UNLOCK
();

3285 
	}
}

3289 
	$GrSëSy°emPÆëã
(
GR_COUNT
 
fú°
, 
GR_PALETTE
 *
∑l
)

3291 
	`SERVER_LOCK
();

3293 
	`GdSëPÆëã
(
roŸwp
->
psd
, 
fú°
, 
∑l
->
cou¡
,ÖÆ->
∑Àâe
);

3294 i‡(
fú°
 == 0)

3295 
	`GsRedøwS¸ìn
();

3297 
	`SERVER_UNLOCK
();

3298 
	}
}

3302 
	$GrFödCﬁ‹
(
GR_COLOR
 
c
, 
GR_PIXELVAL
 *
ªçixñ
)

3304 
	`SERVER_LOCK
();

3305 *
ªçixñ
 = 
	`GdFödCﬁ‹
(&
s¸dev
, 
c
);

3306 
	`SERVER_UNLOCK
();

3307 
	}
}

3311 
	$GrInje˘PoöãrEvít
(
GR_COORD
 
x
, GR_COORD 
y
, 
buâ⁄
, 
visibÀ
)

3313 
	`SERVER_LOCK
();

3315 i‡(
visibÀ
 != 0) {

3316 i‡(
visibÀ
 == 1)

3317 
	`GdShowCurs‹
(&
s¸dev
);

3319 
	`GdHideCurs‹
(&
s¸dev
);

3322 
	`GdMoveMou£
(
x
, 
y
);

3323 
	`GsH™dÀMou£Sètus
(
x
, 
y
, 
buâ⁄
);

3325 
	`SERVER_UNLOCK
();

3326 
	}
}

3329 
	$GrInje˘KeybﬂrdEvít
(
GR_WINDOW_ID
 
wid
, 
GR_KEY
 
keyvÆue
, 
GR_KEYMOD
 
modifõrs
,

3330 
GR_SCANCODE
 
sˇncode
, 
GR_BOOL
 
¥es£d
)

3332 
	`SERVER_LOCK
();

3335 
	`GsDñivîKeybﬂrdEvít
(
wid
,

3336 
¥es£d
? 
GR_EVENT_TYPE_KEY_DOWN
: 
GR_EVENT_TYPE_KEY_UP
,

3337 
keyvÆue
, 
modifõrs
, 
sˇncode
);

3339 
	`SERVER_UNLOCK
();

3340 
	}
}

3347 
	$GrSëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
)

3349 
GR_WINDOW
 *
wp
;

3350 
é
 = 0;

3352 
	`SERVER_LOCK
();

3355 
wp
 = 
	`GsFödWödow
(
wid
);

3356 if(!
wp
) {

3357 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
wid
);

3358 
	`SERVER_UNLOCK
();

3363 i‡(
¥›s
->
Êags
 & 
GR_WM_FLAGS_PROPS
)

3364 
wp
->
¥›s
 =Örops->props;

3367 i‡(
¥›s
->
Êags
 & 
GR_WM_FLAGS_TITLE
) {

3369 if(
wp
->
tôÀ
)

3370 
	`‰ì
(
wp
->
tôÀ
);

3373 if(
¥›s
->
tôÀ
)

3374 
é
 = 
	`°æí
((c⁄° *)
¥›s
->
tôÀ
) + 1;

3377 if(!
¥›s
->
tôÀ
 || 
é
 == 1) {

3378 
wp
->
tôÀ
 = 
NULL
;

3381 if(!(
wp
->
tôÀ
 = 
	`mÆloc
(
é
)))

3382 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 
wid
);

3384 
	`mem˝y
(
wp
->
tôÀ
, 
¥›s
->tôÀ, 
é
);

3388 
	`GsWpNŸifyA˘iv©e
(
focuswp
);

3392 i‡(
¥›s
->
Êags
 & 
GR_WM_FLAGS_BACKGROUND
) {

3393 i‡(
wp
->
background
 !
¥›s
->background) {

3394 
wp
->
background
 = 
¥›s
->background;

3395 
	`GsExpo£Aªa
(
wp
, wp->
x
, wp->
y
, wp->
width
, wp->
height
,

3396 
NULL
);

3401 i‡(
¥›s
->
Êags
 & 
GR_WM_FLAGS_BORDERSIZE
) {

3402 i‡(
wp
->
b‹dîsize
 !
¥›s
->bordersize) {

3404 
	`GsWpUƒólizeWödow
(
wp
, 
GR_TRUE
);

3405 
wp
->
b‹dîsize
 = 
¥›s
->bordersize;

3406 
	`GsWpRólizeWödow
(
wp
, 
GR_TRUE
);

3411 i‡(
¥›s
->
Êags
 & 
GR_WM_FLAGS_BORDERCOLOR
) {

3412 i‡(
wp
->
b‹dîcﬁ‹
 !
¥›s
->bordercolor) {

3413 
wp
->
b‹dîcﬁ‹
 = 
¥›s
->bordercolor;

3414 i‡(
wp
->
b‹dîsize
)

3415 
	`GsDøwB‹dî
(
wp
);

3419 
	`SERVER_UNLOCK
();

3420 
	}
}

3426 
	$GrGëWMPr›îtõs
(
GR_WINDOW_ID
 
wid
, 
GR_WM_PROPERTIES
 *
¥›s
)

3428 
GR_WINDOW
 *
wp
;

3430 
	`SERVER_LOCK
();

3433 
wp
 = 
	`GsFödWödow
(
wid
);

3434 if(!
wp
) {

3436 
	`mem£t
(
¥›s
, 0, (
GR_WM_PROPERTIES
));

3437 
	`SERVER_UNLOCK
();

3442 
¥›s
->
Êags
 = 
GR_WM_FLAGS_PROPS
 | 
GR_WM_FLAGS_TITLE
 |

3443 
GR_WM_FLAGS_BACKGROUND
 | 
GR_WM_FLAGS_BORDERSIZE
 |

3444 
GR_WM_FLAGS_BORDERCOLOR
;

3445 
¥›s
->¥›†
wp
->props;

3446 
¥›s
->
tôÀ
 = 
wp
->title;

3447 
¥›s
->
background
 = 
wp
->background;

3448 
¥›s
->
b‹dîsize
 = 
wp
->bordersize;

3449 
¥›s
->
b‹dîcﬁ‹
 = 
wp
->bordercolor;

3451 
	`SERVER_UNLOCK
();

3452 
	}
}

3455 
	$GrClo£Wödow
(
GR_WINDOW_ID
 
wid
)

3457 
GR_WINDOW
 *
wp
;

3459 
	`SERVER_LOCK
();

3462 
wp
 = 
	`GsFödWödow
(
wid
);

3463 if(!
wp
) {

3469 
	`SERVER_UNLOCK
();

3474 
	`GsDñivîGíîÆEvít
(
wp
, 
GR_EVENT_TYPE_CLOSE_REQ
, 
NULL
);

3476 
	`SERVER_UNLOCK
();

3477 
	}
}

3480 
	$GrKûlWödow
(
GR_WINDOW_ID
 
wid
)

3482 
GR_WINDOW
 *
wp
;

3484 
	`SERVER_LOCK
();

3487 
wp
 = 
	`GsFödWödow
(
wid
);

3488 if(!
wp
) {

3489 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
wid
);

3490 
	`SERVER_UNLOCK
();

3495 
	`GsClo£
(
wp
->
ow√r
->
id
);

3497 
	`SERVER_UNLOCK
();

3498 
	}
}

3504 
	#A


	)

3506 
	#A_RGB
(
r
,
g
,
b
)

	)

3507 
	#B_RGB
(
r
,
g
,
b
)

	)

3508 
	#C_RGB
(
r
,
g
,
b
)

	)

3510 #ifde‡
A


3511 #unde‡
A_RGB


3512 
	#A_RGB
(
r
,
g
,
b
Ë
	`GR_RGB
‘,g,b),

	)

3514 #ifde‡
B


3515 #unde‡
B_RGB


3516 
	#B_RGB
(
r
,
g
,
b
Ë
	`GR_RGB
‘,g,b),

	)

3518 #ifde‡
C


3519 #unde‡
C_RGB


3520 
	#C_RGB
(
r
,
g
,
b
Ë
	`GR_RGB
‘,g,b),

	)

3523 
	#MAXSYSCOLORS
 20

	)

3525 
GR_COLOR
 
	gsysCﬁ‹s
[
MAXSYSCOLORS
] = {

3527 
GR_RGB
( 0, 128, 128),

3530 
A_RGB
(128, 0, 0)

3531 
B_RGB
(128, 0, 128)

3532 
C_RGB
(128, 0, 128)

3533 
GR_RGB
(255, 255, 255),

3534 
A_RGB
(162, 141, 104)

3535 
B_RGB
(128, 128, 128)

3536 
C_RGB
( 0, 64, 128)

3537 
GR_RGB
(192, 192, 192),

3540 
GR_RGB
( 0, 0, 0),

3541 
A_RGB
(162, 141, 104)

3542 
B_RGB
(128, 128, 128)

3543 
C_RGB
(128, 128, 128)

3544 
A_RGB
(213, 204, 187)

3545 
B_RGB
(223, 223, 223)

3546 
C_RGB
(192, 192, 192)

3547 
A_RGB
(234, 230, 221)

3548 
B_RGB
(255, 255, 255)

3549 
C_RGB
(223, 223, 223)

3552 
A_RGB
(213, 204, 187)

3553 
B_RGB
(192, 192, 192)

3554 
C_RGB
(160, 160, 160)

3555 
GR_RGB
( 0, 0, 0),

3558 
A_RGB
(213, 204, 187)

3559 
B_RGB
(192, 192, 192)

3560 
C_RGB
(160, 160, 160)

3561 
GR_RGB
( 0, 0, 0),

3564 
GR_RGB
(255, 255, 255),

3565 
GR_RGB
( 0, 0, 0),

3566 
GR_RGB
(128, 0, 0),

3567 
GR_RGB
(255, 255, 255),

3568 
GR_RGB
( 64, 64, 64),

3571 
A_RGB
(213, 204, 187)

3572 
B_RGB
(192, 192, 192)

3573 
C_RGB
(160, 160, 160)

3574 
GR_RGB
( 0, 0, 0),

3578 
GR_COLOR


3579 
	$GrGëSysCﬁ‹
(
ödex
)

3581 
GR_COLOR
 
cﬁ‹
 = 0;

3582 
	`SERVER_LOCK
();

3583 if(
ödex
 >0 && index < 
MAXSYSCOLORS
)

3584 
cﬁ‹
 = 
sysCﬁ‹s
[
ödex
];

3585 
	`SERVER_UNLOCK
();

3586  
cﬁ‹
;

3587 
	}
}

3590 
	$GrSëS¸ìnSavîTimeout
(
GR_TIMEOUT
 
timeout
)

3592 #i‡
MW_FEATURE_TIMERS


3593 
MWTIMER
 *
timî
;

3595 
	`SERVER_LOCK
();

3597 
s¸ìnßvî_dñay
 = 
timeout
 * 1000;

3599 if((
timî
 = 
	`GdFödTimî
(
GsA˘iv©eS¸ìnSavî
)))

3600 
	`GdDe°royTimî
(
timî
);

3603 i‡(
timeout
 == 0) {

3604 
	`SERVER_UNLOCK
();

3608 
	`GdAddTimî
(
s¸ìnßvî_dñay
, 
GsA˘iv©eS¸ìnSavî
,

3609 
GsA˘iv©eS¸ìnSavî
);

3611 
	`SERVER_UNLOCK
();

3613 
	}
}

3616 
	$GrSëSñe˘i⁄Ow√r
(
GR_WINDOW_ID
 
wid
, 
GR_CHAR
 *
ty≥li°
)

3618 
GR_WINDOW_ID
 
ﬁdwid
 = 
£À˘i⁄_ow√r
.
wid
;

3620 
	`SERVER_LOCK
();

3622 if(
£À˘i⁄_ow√r
.
ty≥li°
Ë
	`‰ì
(selection_owner.typelist);

3624 
£À˘i⁄_ow√r
.
wid
 = wid;

3626 if(
wid
) {

3627 if(!(
£À˘i⁄_ow√r
.
ty≥li°
 = (
GR_CHAR
 *)
	`°rdup
((const *)typelist))) {

3628 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 
wid
);

3629 
£À˘i⁄_ow√r
.
wid
 = 0;

3631 } 
£À˘i⁄_ow√r
.
ty≥li°
 = 
NULL
;

3633 
	`GsDñivîSñe˘i⁄Ch™gedEvít
(
ﬁdwid
, 
wid
);

3635 
	`SERVER_UNLOCK
();

3636 
	}
}

3638 
GR_WINDOW_ID


3639 
	$GrGëSñe˘i⁄Ow√r
(
GR_CHAR
 **
ty≥li°
)

3641 
GR_WINDOW_ID
 
ªsu…
;

3643 
	`SERVER_LOCK
();

3644 *
ty≥li°
 = 
£À˘i⁄_ow√r
.typelist;

3645 
ªsu…
 = 
£À˘i⁄_ow√r
.
wid
;

3646 
	`SERVER_UNLOCK
();

3648  
ªsu…
;

3649 
	}
}

3652 
	$GrReque°Clõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
rid
, 
GR_SERIALNO
 
£rül
,

3653 
GR_MIMETYPE
 
mimëy≥
)

3655 
	`SERVER_LOCK
();

3656 
	`GsDñivîClõ¡D©aReqEvít
(
rid
, 
wid
, 
£rül
, 
mimëy≥
);

3657 
	`SERVER_UNLOCK
();

3658 
	}
}

3661 
	$GrSídClõ¡D©a
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
did
, 
GR_SERIALNO
 
£rül
,

3662 
GR_LENGTH
 
Àn
, GR_LENGTH 
thi¶í
, *
d©a
)

3664 *
p
;

3666 
	`SERVER_LOCK
();

3668 if(!(
p
 = 
	`mÆloc
(
Àn
))) {

3669 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 
wid
);

3670 
	`SERVER_UNLOCK
();

3673 
	`mem˝y
(
p
, 
d©a
, 
thi¶í
);

3675 
	`GsDñivîClõ¡D©aEvít
(
did
, 
wid
, 
£rül
, 
Àn
, 
thi¶í
, 
p
);

3677 
	`SERVER_UNLOCK
();

3678 
	}
}

3685 
	$GrSëBackgroundPixm≠
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID 
pixm≠
, 
Êags
)

3687 
GR_WINDOW
 *
wp
;

3688 
GR_PIXMAP
 *
µ
 = 
NULL
;

3690 
	`SERVER_LOCK
();

3692 i‡(!(
wp
 = 
	`GsFödWödow
(
wid
))) {

3693 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
wid
);

3694 
	`SERVER_UNLOCK
();

3698 i‡(
pixm≠
 && !(
µ
 = 
	`GsFödPixm≠
(pixmap))) {

3699 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
pixm≠
);

3700 
	`SERVER_UNLOCK
();

3703 
wp
->
bgpixm≠
 = 
µ
;

3704 
wp
->
bgpixm≠Êags
 = 
Êags
;

3706 
	`SERVER_UNLOCK
();

3707 
	}
}

3710 
	$GrGëF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, *
numf⁄ts
)

3712 
	`SERVER_LOCK
();

3713 
	`GdGëF⁄tLi°
(
f⁄ts
,
numf⁄ts
);

3714 
	`SERVER_UNLOCK
();

3715 
	}
}

3718 
	$GrFªeF⁄tLi°
(
GR_FONTLIST
 ***
f⁄ts
, 
numf⁄ts
)

3720 
	`SERVER_LOCK
();

3721 
	`GdFªeF⁄tLi°
(
f⁄ts
, 
numf⁄ts
);

3722 
	`SERVER_UNLOCK
();

3723 
	}
}

3729 
	$GrSåëchAªa
(
GR_DRAW_ID
 
d°id
, 
GR_GC_ID
 
gc
,

3730 
GR_COORD
 
dx1
, GR_COORD 
dy1
,

3731 
GR_COORD
 
dx2
, GR_COORD 
dy2
,

3732 
GR_DRAW_ID
 
§cid
,

3733 
GR_COORD
 
sx1
, GR_COORD 
sy1
,

3734 
GR_COORD
 
sx2
, GR_COORD 
sy2
,

3735 
›
)

3737 
GR_DRAWABLE
 *
dp
;

3738 
GR_WINDOW
 *
swp
;

3739 
GR_PIXMAP
 *
•p
 = 
NULL
;

3740 
GR_DRAW_TYPE
 
ty≥
;

3741 
PSD
 
§˝sd
;

3743 
	`SERVER_LOCK
();

3745 
§˝sd
 = 
NULL
;

3747 
ty≥
 = 
	`GsPª∑ªDøwög
(
d°id
, 
gc
, &
dp
);

3748 i‡(
ty≥
 =
GR_DRAW_TYPE_NONE
) {

3749 
	`SERVER_UNLOCK
();

3753 
dx1
 +
dp
->
x
;

3754 
dy1
 +
dp
->
y
;

3755 
dx2
 +
dp
->
x
;

3756 
dy2
 +
dp
->
y
;

3758 
swp
 = 
	`GsFödWödow
(
§cid
);

3759 i‡(
swp
) {

3760 
§˝sd
 = 
swp
->
psd
;

3761 
sx1
 +
swp
->
x
;

3762 
sy1
 +
swp
->
y
;

3763 
sx2
 +
swp
->
x
;

3764 
sy2
 +
swp
->
y
;

3766 
•p
 = 
	`GsFödPixm≠
(
§cid
);

3767 i‡(
•p
)

3768 
§˝sd
 = 
•p
->
psd
;

3770 i‡(!
§˝sd
) {

3771 
	`SERVER_UNLOCK
();

3775 i‡(
›
 =
MWROP_USE_GC_MODE
) {

3776 
GR_GC
 *
g˝
;

3777 
g˝
 = 
	`GsFödGC
(
gc
);

3778 i‡(
g˝
 =
NULL
) {

3779 
›
 = 
MWROP_COPY
;

3781 
›
 = 
	`MWMODE_TO_ROP
(
g˝
->
mode
);

3792 
	`GdSåëchBlôEx
(
dp
->
psd
, 
dx1
, 
dy1
, 
dx2
, 
dy2
,

3793 
§˝sd
, 
sx1
, 
sy1
, 
sx2
, 
sy2
, 
›
);

3797 
	`SERVER_UNLOCK
();

3798 
	}
}

3805 
	$GrQuîyTªe
(
GR_WINDOW_ID
 
wid
, GR_WINDOW_ID *
∑ª¡id
, GR_WINDOW_ID **
chûdªn
,

3806 
GR_COUNT
 *
nchûdªn
)

3808 
GR_WINDOW
 *
wp
;

3809 
GR_WINDOW
 *
˝
;

3810 
GR_WINDOW_ID
 *
ªèºay
;

3811 
GR_COUNT
 
n
 = 0;

3813 
	`SERVER_LOCK
();

3815 
wp
 = 
	`GsFödWödow
(
wid
);

3816 i‡(!
wp
) {

3817 *
∑ª¡id
 = 0;

3818 
nochûdªn
:

3819 *
chûdªn
 = 
NULL
;

3820 *
nchûdªn
 = 0;

3821 
	`SERVER_UNLOCK
();

3824 *
∑ª¡id
 = 
wp
->
∑ª¡
? wp->∑ª¡->
id
: 0;

3827 
˝
=
wp
->
chûdªn
; cp; cp=˝->
siblögs
)

3828 ++
n
;

3829 i‡(
n
 == 0)

3830 
nochûdªn
;

3833 
ªèºay
 = (
GR_WINDOW_ID
 *)
	`mÆloc
(
n
 * (GR_WINDOW_ID));

3834 i‡(!
ªèºay
) {

3835 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

3836 
nochûdªn
;

3840 
n
 = 0;

3841 
˝
=
wp
->
chûdªn
; cp; cp=˝->
siblögs
) {

3842 
ªèºay
[
n
++] = 
˝
->
id
;

3844 *
chûdªn
 = 
ªèºay
;

3845 *
nchûdªn
 = 
n
;

3847 
	`SERVER_UNLOCK
();

3848 
	}
}

3851 #i‡
MW_FEATURE_TIMERS


3852 
	g√xt_timî_id
 = 1000;

3865 
GR_TIMER_ID


3866 
	$GrCª©eTimî
 (
GR_WINDOW_ID
 
wid
, 
GR_TIMEOUT
 
≥riod
)

3868 
GR_TIMER
 *
timî
;

3869 
GR_TIMER_ID
 
id
;

3871 
	`SERVER_LOCK
();

3874 
timî
 = (
GR_TIMER
*Ë
	`mÆloc
 ( (GR_TIMER));

3875 i‡(
timî
 =
NULL
)

3877 
	`GsEº‹
 (
GR_ERROR_MALLOC_FAILED
, 0);

3878 
	`SERVER_UNLOCK
();

3883 
timî
->timî = 
	`GdAddPîiodicTimî
 (
≥riod
, 
GsTimîCB
,Åimer);

3884 i‡(
timî
->timî =
NULL
)

3886 
	`‰ì
 (
timî
);

3887 
	`GsEº‹
 (
GR_ERROR_MALLOC_FAILED
, 0);

3888 
	`SERVER_UNLOCK
();

3896 
timî
->
id
 = 
√xt_timî_id
++;

3897 
timî
->
ow√r
 = 
cur˛õ¡
;

3898 
timî
->
wid
 = wid;

3899 
timî
->
√xt
 = 
li°_timî
;

3900 
li°_timî
 = 
timî
;

3902 
id
 = 
timî
->id;

3904 
	`SERVER_UNLOCK
();

3906  
id
;

3907 
	}
}

3915 
	$GrDe°royTimî
 (
GR_TIMER_ID
 
tid
)

3917 
GR_TIMER
 *
timî
;

3918 
GR_TIMER
 *
¥ev_timî
;

3920 
	`SERVER_LOCK
();

3923 
timî
 = 
	`GsFödTimî
 (
tid
);

3924 i‡(
timî
 =
NULL
) {

3925 
	`SERVER_UNLOCK
();

3929 i‡(
tid
 =
ˇche_timî_id
)

3931 
ˇche_timî_id
 = 0;

3932 
ˇche_timî
 = 
NULL
;

3936 
	`GdDe°royTimî
 (
timî
->timer);

3939 i‡(
li°_timî
 =
timî
)

3941 
li°_timî
 = 
timî
->
√xt
;

3945 
¥ev_timî
 = 
li°_timî
;

3946 
¥ev_timî
->
√xt
 !
timî
)

3948 
¥ev_timî
 =Öªv_timî->
√xt
;

3950 
¥ev_timî
->
√xt
 = 
timî
->next;

3952 
	`‰ì
 (
timî
);

3954 
	`SERVER_UNLOCK
();

3955 
	}
}

3965 
	$GrSëP‹åaôMode
(
p‹åaômode
)

3967 
	`SERVER_LOCK
();

3968 
	`GsSëP‹åaôMode
(
p‹åaômode
);

3969 
	`SERVER_UNLOCK
();

3970 
	}
}

3981 
	$GrQuîyPoöãr
(
GR_WINDOW_ID
 *
mwö
, 
GR_COORD
 *
x
, GR_COORD *
y
, 
GR_BUTTON
 *
bmask
)

3983 
	`SERVER_LOCK
();

3984 *
mwö
 = 
mou£wp
->
id
;

3985 *
x
 = 
curs‹x
;

3986 *
y
 = 
curs‹y
;

3987 *
bmask
 = 
curbuâ⁄s
;

3988 
	`SERVER_UNLOCK
();

3989 
	}
}

3998 
GR_REGION_ID


3999 
	$GrNewBôm≠Regi⁄
(
GR_BITMAP
 *
bôm≠
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

4001 #i‡
DYNAMICREGIONS


4002 
GR_REGION
 *
ªgi⁄p
;

4003 
GR_REGION_ID
 
id
;

4005 
	`SERVER_LOCK
();

4007 i‡(!(
ªgi⁄p
 = 
	`mÆloc
((
GR_REGION
)))) {

4008 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

4009 
	`SERVER_UNLOCK
();

4013 
ªgi⁄p
->
rgn
 = 
	`GdAŒocBôm≠Regi⁄
(
bôm≠
, 
width
, 
height
);

4014 
ªgi⁄p
->
id
 = 
√xåegi⁄id
++;

4015 
ªgi⁄p
->
ow√r
 = 
cur˛õ¡
;

4016 
ªgi⁄p
->
√xt
 = 
li°ªgi⁄p
;

4018 
li°ªgi⁄p
 = 
ªgi⁄p
;

4019 
id
 = 
ªgi⁄p
->id;

4021 
	`SERVER_UNLOCK
();

4023  
id
;

4027 
	}
}

4047 
	$GrSëWödowRegi⁄
(
GR_WINDOW_ID
 
wid
, 
GR_REGION_ID
 
rid
, 
ty≥
)

4049 #i‡
DYNAMICREGIONS


4050 
GR_WINDOW
 *
wp
;

4051 
GR_REGION
 *
ªgi⁄
;

4052 
MWCLIPREGION
 *
√wªgi⁄
;

4054 
	`SERVER_LOCK
();

4058 i‡(!(
wp
 = 
	`GsFödWödow
(
wid
))) {

4059 
	`GsEº‹
(
GR_ERROR_BAD_WINDOW_ID
, 
wid
);

4060 
	`SERVER_UNLOCK
();

4064 i‡(
rid
) {

4065 i‡(!(
ªgi⁄
 = 
	`GsFödRegi⁄
(
rid
))) {

4066 
	`GsEº‹
(
GR_ERROR_BAD_REGION_ID
, 
rid
);

4067 
	`SERVER_UNLOCK
();

4071 i‡(!(
√wªgi⁄
 = 
	`GdAŒocRegi⁄
())) {

4072 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

4073 
	`SERVER_UNLOCK
();

4077 
	`GdC›yRegi⁄
(
√wªgi⁄
, 
ªgi⁄
->
rgn
);

4078 } 
√wªgi⁄
 = 
NULL
;

4080 i‡(
wp
->
˛ùªgi⁄
)

4081 
	`GdDe°royRegi⁄
(
wp
->
˛ùªgi⁄
);

4082 
wp
->
˛ùªgi⁄
 = 
√wªgi⁄
;

4084 
	`SERVER_UNLOCK
();

4086 
	}
}

4095 
	$GrSëTønsf‹m
(
GR_TRANSFORM
 *
å™s
)

4097 
	`SERVER_LOCK
();

4098 
	`GdSëTønsf‹m
(
å™s
);

4099 
	`SERVER_UNLOCK
();

4100 
	}
}

4114 
GR_BOOL


4115 
	$GrGøbKey
(
GR_WINDOW_ID
 
id
, 
GR_KEY
 
key
, 
ty≥
)

4117 
GR_GRABBED_KEY
 *
keygøb
;

4118 
GR_GRABBED_KEY
 *
œ°_keygøb
;

4120 i‡(()
ty≥
 > 
GR_GRAB_MAX
)

4121  
GR_FALSE
;

4123 
	`SERVER_LOCK
();

4126 
œ°_keygøb
 = 
NULL
;

4127 
keygøb
 = 
li°_gøbbed_keys
; keygøb !
NULL
;

4128 
keygøb
 = keygøb->
√xt
) {

4129 
œ°_keygøb
 = 
keygøb
;

4130 i‡(
keygøb
->
key
 == key) {

4131 i‡((
keygøb
->
wid
 =
id
)

4132 && (
keygøb
->
ty≥
 ==Åype)

4133 && (
keygøb
->
ow√r
 =
cur˛õ¡
)) {

4137 
	`SERVER_UNLOCK
();

4138  
GR_TRUE
;

4140 i‡((
ty≥
 !
GR_GRAB_HOTKEY
)

4141 && (
keygøb
->
ty≥
 !
GR_GRAB_HOTKEY
)) {

4146 
	`SERVER_UNLOCK
();

4147  
GR_FALSE
;

4153 
keygøb
 = (
GR_GRABBED_KEY
 *)
	`mÆloc
((GR_GRABBED_KEY));

4154 i‡(
keygøb
 =
NULL
) {

4155 
	`GsEº‹
(
GR_ERROR_MALLOC_FAILED
, 0);

4156 
	`SERVER_UNLOCK
();

4157  
GR_FALSE
;

4161 
keygøb
->
key
 = key;

4162 
keygøb
->
wid
 = 
id
;

4163 
keygøb
->
ty≥
 =Åype;

4164 
keygøb
->
ow√r
 = 
cur˛õ¡
;

4173 i‡((
ty≥
 !
GR_GRAB_HOTKEY
Ë|| (
œ°_keygøb
 =
NULL
)) {

4175 
keygøb
->
√xt
 = 
li°_gøbbed_keys
;

4176 
li°_gøbbed_keys
 = 
keygøb
;

4179 
keygøb
->
√xt
 = 
NULL
;

4180 
œ°_keygøb
->
√xt
 = 
keygøb
;

4183 
	`SERVER_UNLOCK
();

4184  
GR_TRUE
;

4185 
	}
}

4194 
	$GrUngøbKey
(
GR_WINDOW_ID
 
id
, 
GR_KEY
 
key
)

4196 
GR_GRABBED_KEY
 *
keygøb
;

4197 
GR_GRABBED_KEY
 **
keygøb_¥ev_√xt
;

4199 
	`SERVER_LOCK
();

4201 
keygøb_¥ev_√xt
 = &
li°_gøbbed_keys
;

4202 
keygøb
 = 
li°_gøbbed_keys
;

4203 
keygøb
 !
NULL
) {

4204 i‡((
keygøb
->
key
 =keyË&& (keygøb->
wid
 =
id
) &&

4205 (
keygøb
->
ow√r
 =
cur˛õ¡
)) {

4206 *
keygøb_¥ev_√xt
 = 
keygøb
->
√xt
;

4207 
	`‰ì
(
keygøb
);

4208 
	`SERVER_UNLOCK
();

4211 
keygøb_¥ev_√xt
 = &
keygøb
->
√xt
;

4212 
keygøb
 = keygøb->
√xt
;

4215 
	`SERVER_UNLOCK
();

4216 
	}
}

	@nanox/srvmain.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

12 
	~<sig«l.h
>

13 
	~<°rög.h
>

15 #ifde‡
__PACIFIC__


16 
	~<unixio.h
>

18 
	~<î∫o.h
>

19 
	~<sys/ty≥s.h
>

22 #ifde‡
DOS_TURBOC


23 
	~<io.h
>

26 
	#MWINCLUDECOLORS


	)

27 
	~"£rv.h
"

28 #i‡
UNIX
 | 
DOS_DJGPP


29 
	~<uni°d.h
>

30 #i‡
_MINIX


31 
	~<sys/times.h
>

33 
	~<sys/time.h
>

37 #i‡
ELKS


38 
	~<löuxmt/posix_ty≥s.h
>

39 
	~<löuxmt/time.h
>

42 #i‡
RTEMS


43 
	~<πems/mw_uid.h
>

46 #i‡
PSP


48 
	~<p•kî√l.h
>

49 
	~<p•debug.h
>

52 
	#¥ötf
 
p•DebugS¸ìnPrötf


	)

54 
	#¥ötf
(...)

	)

57 
	#EPRINTF
 
¥ötf


	)

63 
GR_WINDOW_ID
 
	gˇchewödowid
;

64 
GR_WINDOW_ID
 
	gˇchïixm≠id
;

65 
GR_GC_ID
 
	gˇchegcid
;

66 
GR_WINDOW
 *
	gˇchewp
;

67 
GR_GC
 *
	gˇcheg˝
;

68 
GR_PIXMAP
 *
	gˇchïp
;

69 
GR_PIXMAP
 *
	gli°µ
;

70 
GR_WINDOW
 *
	gli°wp
;

71 
GR_WINDOW
 *
	groŸwp
;

72 
GR_GC
 *
	gli°g˝
;

73 
GR_REGION
 *
	gli°ªgi⁄p
;

74 
GR_FONT
 *
	gli°f⁄ç
;

75 #i‡
MW_FEATURE_IMAGES


76 
GR_IMAGE
 *
	gli°imagï
;

78 
GR_CURSOR
 *
	gli°curs‹p
;

79 
GR_CURSOR
 *
	g°dcurs‹
;

80 
GR_GC
 *
	gcurg˝
;

81 
GR_WINDOW
 *
	g˛ùwp
;

82 
GR_WINDOW
 *
	gfocuswp
;

83 
GR_WINDOW
 *
	gmou£wp
;

84 
GR_WINDOW
 *
	ggøbbuâ⁄wp
;

85 
GR_CURSOR
 *
	gcurcurs‹
;

86 
GR_COORD
 
	gcurs‹x
;

87 
GR_COORD
 
	gcurs‹y
;

88 
GR_BUTTON
 
	gcurbuâ⁄s
;

89 
GR_CLIENT
 *
	gcur˛õ¡
;

90 
GR_EVENT_LIST
 *
	gevít‰ì
;

91 
GR_BOOL
 
	gfocusfixed
;

92 
PMWFONT
 
	g°df⁄t
;

93 
	gesˇ≥_quôs
 = 
TRUE
;

94 *
	g¥og«me
;

96 
	gcuºít_fd
;

97 
	gc⁄√˘cou¡
 = 0;

98 
GR_CLIENT
 *
	groŸ_˛õ¡
;

99 
GR_CLIENT
 *
	gcuºít_˛õ¡
;

100 *
	gcuºít_shm_cmds
;

101 
	gcuºít_shm_cmds_size
;

102 
	gkeyb_fd
;

103 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


104 
	gkeyb2_fd
;

106 
	gmou£_fd
;

107 *
	gcurfunc
;

108 
GR_BOOL
 
	gs¸ìnßvî_a˘ive
;

109 
GR_SELECTIONOWNER
 
	g£À˘i⁄_ow√r
;

110 
GR_TIMEOUT
 
	g°¨tTicks
;

111 
	gaut›‹åaô
 = 
FALSE
;

112 
MWCOORD
 
	gnxªs
;

113 
MWCOORD
 
	gnyªs
;

115 #i‡
MW_FEATURE_TIMERS


116 
GR_TIMEOUT
 
	gs¸ìnßvî_dñay
;

117 
GR_TIMER_ID
 
	gˇche_timî_id
;

118 
GR_TIMER
 *
	gˇche_timî
;

119 
GR_TIMER
 *
	gli°_timî
;

121 
GR_GRABBED_KEY
 *
	gli°_gøbbed_keys
 = 
NULL
;

123 
	g≥rsi°ít_mode
 = 
FALSE
;

124 
	gp‹åaômode
 = 
MWPORTRAIT_NONE
;

126 
	gSERVER_LOCK_DECLARE


128 #i‡!
NONETWORK


129 
	gun_sock
;

132 
	$ußge
()

134 
	`¥ötf
("Usage: %s [-e] [-p] [-A] [-NLRD] [-x#] [-y#] [-c <fontconfig-file> ...]\n",

135 
¥og«me
);

136 
	`exô
(1);

137 
	}
}

144 
	$maö
(
¨gc
, *
¨gv
[])

146 
t
;

148 
¥og«me
 = 
¨gv
[0];

150 
t
 = 1;

151  
t
 < 
¨gc
 ) {

152 i‡–!
	`°rcmp
("-e",
¨gv
[
t
])) {

153 
esˇ≥_quôs
 = 
FALSE
;

154 ++
t
;

157 i‡–!
	`°rcmp
("-p",
¨gv
[
t
]) ) {

158 
≥rsi°ít_mode
 = 
TRUE
;

159 ++
t
;

162 i‡–!
	`°rcmp
("-A",
¨gv
[
t
]) ) {

163 
aut›‹åaô
 = 
TRUE
;

164 ++
t
;

167 i‡–!
	`°rcmp
("-N",
¨gv
[
t
]) ) {

168 
p‹åaômode
 = 
MWPORTRAIT_NONE
;

169 ++
t
;

172 i‡–!
	`°rcmp
("-L",
¨gv
[
t
]) ) {

173 
p‹åaômode
 = 
MWPORTRAIT_LEFT
;

174 ++
t
;

177 i‡–!
	`°rcmp
("-R",
¨gv
[
t
]) ) {

178 
p‹åaômode
 = 
MWPORTRAIT_RIGHT
;

179 ++
t
;

182 i‡–!
	`°rcmp
("-D",
¨gv
[
t
]) ) {

183 
p‹åaômode
 = 
MWPORTRAIT_DOWN
;

184 ++
t
;

187 i‡–!
	`°rcmp
("-x",
¨gv
[
t
]) ) {

188 i‡(++
t
 >
¨gc
)

189 
	`ußge
();

190 
nxªs
 = 
	`©oi
(
¨gv
[
t
]);

191 ++
t
;

194 i‡–!
	`°rcmp
("-y",
¨gv
[
t
]) ) {

195 i‡(++
t
 >
¨gc
)

196 
	`ußge
();

197 
nyªs
 = 
	`©oi
(
¨gv
[
t
]);

198 ++
t
;

201 #i‡
FONTMAPPER


202 i‡–!
	`°rcmp
("-c",
¨gv
[
t
]) ) {

203 
	`ªad_c⁄figfûe
(*
fûe
);

205 i‡(++
t
 >
¨gc
)

206 
	`ußge
();

207 
	`ªad_c⁄figfûe
(
¨gv
[
t
]);

208 ++
t
;

212 
	`ußge
();

216 if(
	`GsInôülize
() < 0)

217 
	`exô
(1);

220 
	`GsSñe˘
(0L);

222 
	}
}

225 #i‡
PSP


228 
	$exô_ˇŒback
()

230 
	`s˚Kî√lExôGame
();

233 
	}
}

236 
	$CÆlbackThªad
(*
¨g
)

238 
cbid
;

241 
cbid
 = 
	`s˚Kî√lCª©eCÆlback
("Exô CÆlback", 
exô_ˇŒback
, 
NULL
);

242 
	`s˚Kî√lRegi°îExôCÆlback
(
cbid
);

244 
	`s˚Kî√lSÀïThªadCB
();

245 
	}
}

248 
	$SëupCÆlbacks
()

250 
thid
 = 0;

252 
thid
 = 
	`s˚Kî√lCª©eThªad
("upd©e_thªad", 
CÆlbackThªad
, 0x11, 0xFA0, 0, 0);

253 if(
thid
 >= 0)

255 
	`s˚Kî√lSèπThªad
(
thid
, 0, 0);

258  
thid
;

259 
	}
}

264 
	$GsAc˚±Clõ¡Fd
(
i
)

266 
GR_CLIENT
 *
˛õ¡
, *
˛
;

268 if(!(
˛õ¡
 = 
	`mÆloc
((
GR_CLIENT
)))) {

269 #i‡!
PSP


270 
	`˛o£
(
i
);

275 
˛õ¡
->
id
 = 
i
;

276 
˛õ¡
->
evíthód
 = 
NULL
;

277 
˛õ¡
->
evíâaû
 = 
NULL
;

279 
˛õ¡
->
√xt
 = 
NULL
;

280 
˛õ¡
->
¥ev
 = 
NULL
;

281 
˛õ¡
->
waôög_f‹_evít
 = 
FALSE
;

282 
˛õ¡
->
shm_cmds
 = 0;

284 if(
c⁄√˘cou¡
++ == 0)

285 
roŸ_˛õ¡
 = 
˛õ¡
;

287 
˛
 = 
roŸ_˛õ¡
;

288 
˛
->
√xt
)

289 
˛
 = cl->
√xt
;

290 
˛õ¡
->
¥ev
 = 
˛
;

291 
˛
->
√xt
 = 
˛õ¡
;

293 
	}
}

300 
	$GrO≥n
()

303 #i‡
PSP


304 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

307 #i‡
NONETWORK


308 
	`SERVER_LOCK
();

309 
esˇ≥_quôs
 = 1;

314 i‡(
c⁄√˘cou¡
 <= 0) {

315 if(
	`GsInôülize
() < 0) {

316 
	`SERVER_UNLOCK
();

319 
	`GsAc˚±Clõ¡Fd
(999);

320 
cur˛õ¡
 = 
roŸ_˛õ¡
;

322 
	`SERVER_UNLOCK
();

325 #i‡
PSP


326 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

330 
	}
}

336 
	$GrClo£
()

338 
	`SERVER_LOCK
();

339 
	`GsClo£
(
cuºít_fd
);

340 
	`SERVER_UNLOCK
();

341 
	}
}

347 
	$GsClo£
(
fd
)

349 
	`GsDr›Clõ¡
(
fd
);

350 if(!
≥rsi°ít_mode
 && 
c⁄√˘cou¡
 == 0)

351 
	`GsTîmö©e
();

352 
	}
}

354 #i‡
NONETWORK


357 
	$GsDr›Clõ¡
(
fd
)

359 --
c⁄√˘cou¡
;

360 
	}
}

363 #i‡
UNIX
 | 
DOS_DJGPP


364 #i‡
NONETWORK
 && 
deföed
(
HAVESELECT
)

370 
	gªgfdmax
 = -1;

371 
fd_£t
 
	gªgfd£t
;

374 
	$GrRegi°îI≈ut
(
fd
)

376 
	`SERVER_LOCK
();

377 
	`FD_SET
(
fd
, &
ªgfd£t
);

378 i‡(
fd
 >
ªgfdmax
)Ñegfdmax = fd + 1;

379 
	`SERVER_UNLOCK
();

380 
	}
}

383 
	$GrUƒegi°îI≈ut
(
fd
)

385 
i
, 
max
;

387 
	`SERVER_LOCK
();

390 i‡(
fd
 == -1) {

391 
	`FD_ZERO
(&
ªgfd£t
);

392 
ªgfdmax
 = -1;

393 
	`SERVER_UNLOCK
();

397 
	`FD_CLR
(
fd
, &
ªgfd£t
);

399 
i
 = 0, 
max
 = 
ªgfdmax
,Ñegfdmax = -1; i < max; i++)

400 i‡(
	`FD_ISSET
(
i
, &
ªgfd£t
))

401 
ªgfdmax
 = 
i
 + 1;

403 
	`SERVER_UNLOCK
();

404 
	}
}

414 
	$GrDñay
(
GR_TIMEOUT
 
m£cs
)

416 #i‡
UNIX
 && 
	`deföed
(
HAVESELECT
)

417 
timevÆ
Åimeval;

419 
timevÆ
.
tv_£c
 = 
m£cs
 / 1000;

420 
timevÆ
.
tv_u£c
 = (
m£cs
 % 1000) * 1000;

421 
	`£À˘
(0, 
NULL
, NULL, NULL, &
timevÆ
);

423 
	}
}

425 #i‡
NONETWORK


427 
	$GrFlush
()

429 
	}
}

432 
	$GrMaöLo›
(
GR_FNCALLBACKEVENT
 
‚cb
)

434 
GR_EVENT
 
evít
;

437 
	`GrGëNextEvít
(&
evít
);

438 
	`‚cb
(&
evít
);

440 
	}
}

443 
	$GrReqShmCmds
(
shmsize
)

446 
	}
}

450 #i‡
VXWORKS


452 
	#POLLTIME
 100

	)

453 
	#MAX_MOUSEEVENTS
 10

	)

454 
	#MAX_KEYBDEVENTS
 10

	)

456 
GdSÀï
(
dwMûli£c⁄ds
);

459 
	$GsSñe˘
(
GR_TIMEOUT
 
timeout
)

461 
mou£evíts
 = 0;

462 
keybdevíts
 = 0;

463 
GR_TIMEOUT
 
waôtime
 = 0;

464 
GR_EVENT_GENERAL
 *
gp
;

472 if(
s¸dev
.
PªSñe˘
)

474 
s¸dev
.
	`PªSñe˘
(&scrdev);

479 
mou£dev
.
	`Pﬁl
() > 0)

481 
	`GsCheckMou£Evít
();

482 i‡(
mou£evíts
++ > 
MAX_MOUSEEVENTS
)

491 
kbddev
.
	`Pﬁl
() > 0)

493 
	`GsCheckKeybﬂrdEvít
();

494 i‡(
keybdevíts
++ > 
MAX_KEYBDEVENTS
)

503 i‡((
mou£evíts
 > 0Ë|| (
keybdevíts
 > 0))

511 
	`GdSÀï
(
POLLTIME
);

512 
waôtime
 +
POLLTIME
;

516 i‡(
waôtime
 >
timeout
)

519 i‡(
timeout
 != 0)

525 i‡((
gp
 = (
GR_EVENT_GENERAL
 *)
	`GsAŒocEvít
(
cur˛õ¡
)Ë!
NULL
)

527 
gp
->
ty≥
 = 
GR_EVENT_TYPE_TIMEOUT
;

534 
	}
}

536 #ñi‡
MSDOS
 | 
_MINIX


539 
	$GsSñe˘
(
GR_TIMEOUT
 
timeout
)

542 if(
mou£dev
.
	`Pﬁl
())

543 
	`GsCheckMou£Evít
())

547 if(
kbddev
.
	`Pﬁl
())

548 
	`GsCheckKeybﬂrdEvít
())

551 
	}
}

553 #ñi‡
PSP


556 
	$GsSñe˘
(
GR_TIMEOUT
 
timeout
)

559 if(
mou£dev
.
	`Pﬁl
())

560 
	`GsCheckMou£Evít
())

564 if(
kbddev
.
	`Pﬁl
())

565 
	`GsCheckKeybﬂrdEvít
())

567 
	}
}

569 #ñi‡
UNIX
 && 
deföed
(
HAVESELECT
)

572 
	$GsSñe˘
(
GR_TIMEOUT
 
timeout
)

574 
fd_£t
 
rfds
;

575 
e
;

576 
£tsize
 = 0;

577 
timevÆ
 
tout
;

578 
timevÆ
 *
to
;

579 #i‡
NONETWORK


580 
fd
;

584 if(
roŸwp
->
psd
->
PªSñe˘
)

585 
roŸwp
->
psd
->
	`PªSñe˘
(rootwp->psd);

588 
	`FD_ZERO
(&
rfds
);

589 if(
mou£_fd
 >= 0) {

590 
	`FD_SET
(
mou£_fd
, &
rfds
);

591 i‡(
mou£_fd
 > 
£tsize
)

592 
£tsize
 = 
mou£_fd
;

594 if(
keyb_fd
 >= 0) {

595 
	`FD_SET
(
keyb_fd
, &
rfds
);

596 i‡(
keyb_fd
 > 
£tsize
)

597 
£tsize
 = 
keyb_fd
;

599 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


600 if(
keyb2_fd
 >= 0) {

601 
	`FD_SET
(
keyb2_fd
, &
rfds
);

602 i‡(
keyb2_fd
 > 
£tsize
)

603 
£tsize
 = 
keyb2_fd
;

606 #i‡
NONETWORK


608 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

609 i‡(!
	`FD_ISSET
(
fd
, &
ªgfd£t
))

612 
	`FD_SET
(
fd
, &
rfds
);

613 i‡(
fd
 > 
£tsize
) setsize = fd;

617 
	`FD_SET
(
un_sock
, &
rfds
);

618 i‡(
un_sock
 > 
£tsize
) setsize = un_sock;

619 
cur˛õ¡
 = 
roŸ_˛õ¡
;

620 
cur˛õ¡
) {

621 if(
cur˛õ¡
->
waôög_f‹_evít
 && cur˛õ¡->
evíthód
) {

622 
cur˛õ¡
->
waôög_f‹_evít
 = 
FALSE
;

623 
	`GrGëNextEvítWøµîFöish
(
cur˛õ¡
->
id
);

626 
	`FD_SET
(
cur˛õ¡
->
id
, &
rfds
);

627 if(
cur˛õ¡
->
id
 > 
£tsize
) setsize = curclient->id;

628 
cur˛õ¡
 = cur˛õ¡->
√xt
;

632 i‡(
timeout
 =(
GR_TIMEOUT
) -1L) {

634 
tout
.
tv_£c
 = 0;

635 
tout
.
tv_u£c
 = 0;

636 
to
 = &
tout
;

638 #i‡
MW_FEATURE_TIMERS


639 if(
	`GdGëNextTimeout
(&
tout
, 
timeout
Ë=
TRUE
)

640 
to
 = &
tout
;

643 
to
 = 
NULL
;

647 if((
e
 = 
	`£À˘
(
£tsize
+1, &
rfds
, 
NULL
, NULL, 
to
)) > 0) {

649 if(
mou£_fd
 >0 && 
	`FD_ISSET
(mou£_fd, &
rfds
))

650 
	`GsCheckMou£Evít
())

654 if–(
keyb_fd
 >0 && 
	`FD_ISSET
(keyb_fd, &
rfds
))

655 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


656 || (
keyb2_fd
 >0 && 
	`FD_ISSET
(keyb2_fd, &
rfds
))

659 
	`GsCheckKeybﬂrdEvít
())

662 #i‡
NONETWORK


664 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

665 
GR_EVENT_FDINPUT
 * 
gp
;

667 i‡(!
	`FD_ISSET
(
fd
, &
ªgfd£t
Ë|| !FD_ISSET(fd, &
rfds
))

670 
gp
 =(
GR_EVENT_FDINPUT
 *)
	`GsAŒocEvít
(
cur˛õ¡
);

671 if(
gp
) {

672 
gp
->
ty≥
 = 
GR_EVENT_TYPE_FDINPUT
;

673 
gp
->
fd
 = fd;

679 if(
	`FD_ISSET
(
un_sock
, &
rfds
))

680 
	`GsAc˚±Clõ¡
();

683 
cur˛õ¡
 = 
roŸ_˛õ¡
;

684 
cur˛õ¡
) {

685 
GR_CLIENT
 *
cur˛õ¡_√xt
;

688 
cur˛õ¡_√xt
 = 
cur˛õ¡
->
√xt
;

689 if(
	`FD_ISSET
(
cur˛õ¡
->
id
, &
rfds
))

690 
	`GsH™dÀClõ¡
(
cur˛õ¡
->
id
);

691 
cur˛õ¡
 = 
cur˛õ¡_√xt
;

695 i‡(
e
 == 0) {

696 #i‡
NONETWORK


704 #i‡
MW_FEATURE_TIMERS


705 if(
	`GdTimeout
(Ë=
TRUE
)

708 
GR_EVENT_GENERAL
 * 
gp
;

709 
gp
 = (
GR_EVENT_GENERAL
 *)
	`GsAŒocEvít
(
cur˛õ¡
);

710 if(
gp
)

711 
gp
->
ty≥
 = 
GR_EVENT_TYPE_TIMEOUT
;

714 #i‡
MW_FEATURE_TIMERS


715 
	`GdTimeout
();

719 if(
î∫o
 !
EINTR
)

720 
	`EPRINTF
("Select() call in main failed\n");

721 
	}
}

723 #i‡
NONETWORK


748 
	$GrPª∑ªSñe˘
(*
maxfd
, *
rfd£t
)

750 
fd_£t
 *
rfds
 = (fd_£à*Ë
rfd£t
;

751 
fd
;

753 
	`SERVER_LOCK
();

756 if(
roŸwp
->
psd
->
PªSñe˘
)

757 
roŸwp
->
psd
->
	`PªSñe˘
(rootwp->psd);

759 if(
mou£_fd
 >= 0) {

760 
	`FD_SET
(
mou£_fd
, 
rfds
);

761 i‡(
mou£_fd
 > *
maxfd
)

762 *
maxfd
 = 
mou£_fd
;

764 if(
keyb_fd
 >= 0) {

765 
	`FD_SET
(
keyb_fd
, 
rfds
);

766 i‡(
keyb_fd
 > *
maxfd
)

767 *
maxfd
 = 
keyb_fd
;

769 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


770 if(
keyb2_fd
 >= 0) {

771 
	`FD_SET
(
keyb2_fd
, 
rfds
);

772 i‡(
keyb2_fd
 > *
maxfd
)

773 *
maxfd
 = 
keyb2_fd
;

778 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

779 i‡(!
	`FD_ISSET
(
fd
, &
ªgfd£t
))

782 
	`FD_SET
(
fd
, 
rfds
);

783 i‡(
fd
 > *
maxfd
)

784 *
maxfd
 = 
fd
;

787 
	`SERVER_UNLOCK
();

788 
	}
}

803 
	$GrSîvi˚Sñe˘
(*
rfd£t
, 
GR_FNCALLBACKEVENT
 
‚cb
)

805 
fd_£t
 * 
rfds
 = 
rfd£t
;

806 
GR_EVENT_LIST
 * 
ñp
;

807 
GR_EVENT
 
ev
;

808 
fd
;

810 
	`SERVER_LOCK
();

813 if(
mou£_fd
 >0 && 
	`FD_ISSET
(mou£_fd, 
rfds
))

814 
	`GsCheckMou£Evít
())

818 if–(
keyb_fd
 >0 && 
	`FD_ISSET
(keyb_fd, 
rfds
))

819 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


820 || (
keyb2_fd
 >0 && 
	`FD_ISSET
(keyb2_fd, 
rfds
))

823 
	`GsCheckKeybﬂrdEvít
())

827 (
ñp
 = 
cur˛õ¡
->
evíthód
Ë!
NULL
) {

829 
ev
 = 
ñp
->
evít
;

832 
cur˛õ¡
->
evíthód
 = 
ñp
->
√xt
;

833 i‡(
cur˛õ¡
->
evíâaû
 =
ñp
)

834 
cur˛õ¡
->
evíâaû
 = 
NULL
;

836 
ñp
->
√xt
 = 
evít‰ì
;

837 
evít‰ì
 = 
ñp
;

839 
	`‚cb
(&
ev
);

843 
fd
 = 0; fd < 
ªgfdmax
; fd++) {

844 i‡(!
	`FD_ISSET
(
fd
, &
ªgfd£t
Ë|| !FD_ISSET(fd, 
rfds
))

847 
ev
.
ty≥
 = 
GR_EVENT_TYPE_FDINPUT
;

848 
ev
.
fdöput
.
fd
 = fd;

849 
	`‚cb
(&
ev
);

852 
	`SERVER_UNLOCK
();

853 
	}
}

859 #i‡
RTEMS


860 
MW_UID_MESSAGE
 
m_kbd
;

861 
MW_UID_MESSAGE
 
m_mou
;

864 
	$GsSñe˘
 (
GR_TIMEOUT
 
timeout
)

866 
MW_UID_MESSAGE
 
m
;

867 
rc
;

870 i‡(
s¸dev
.
PªSñe˘
)

871 
s¸dev
.
	`PªSñe˘
 (&scrdev);

874 
m
.
ty≥
 = 
MV_UID_INVALID
;

877 
rc
 = 
	`uid_ªad_mesßge
 (&
m
, 
timeout
);

880 i‡(
rc
 < 0) {

881 i‡(
î∫o
 !
ETIMEDOUT
)

882 
	`EPRINTF
 ("Ñc%d,Éºno=%d\n", 
rc
, 
î∫o
);

890 
m
.
ty≥
) {

891 
MV_UID_REL_POS
:

892 
MV_UID_ABS_POS
:

893 
m_mou
 = 
m
;

894 
	`GsCheckMou£Evít
 ()) ;

896 
MV_UID_KBD
:

897 
m_kbd
 = 
m
;

898 
	`GsCheckKeybﬂrdEvít
 ();

900 
MV_UID_TIMER
:

901 
MV_UID_INVALID
:

905 
	}
}

908 #i‡
VTSWITCH


910 
	$CheckVtCh™ge
(*
¨g
)

912 if(
	`MwCheckVtCh™ge
())

913 
	`GsRedøwS¸ìn
();

914 
	`GdAddTimî
(50, 
CheckVtCh™ge
, 
NULL
);

915 
	}
}

923 
	$GsInôülize
()

925 
GR_WINDOW
 *
wp
;

926 
PSD
 
psd
;

927 
GR_CURSOR_ID
 
cid
;

928 
MWIMAGEBITS
 
curs‹bôs
[16] = {

934 
MWIMAGEBITS
 
curs‹mask
[16] = {

943 #i‡
PSP


944 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

947 
	`SERVER_LOCK_INIT
();

949 #i‡!
PSP


950 
	`£tbuf
(
°dout
, 
NULL
);

951 
	`£tbuf
(
°dîr
, 
NULL
);

954 #i‡
PSP


955 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

958 
wp
 = (
GR_WINDOW
 *Ë
	`mÆloc
((GR_WINDOW));

959 i‡(
wp
 =
NULL
) {

960 
	`EPRINTF
("CannotállocateÑoot window\n");

964 #i‡
PSP


965 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

968 
°¨tTicks
 = 
	`GsGëTickCou¡
();

970 #i‚de‡
MW_NOSIGNALS


972 
	`sig«l
(
SIGTERM
, (*)
GsTîmö©e
);

974 #i‡
PSP


975 
	`SëupCÆlbacks
();

979 #i‡
MW_FEATURE_TIMERS


980 
s¸ìnßvî_dñay
 = 0;

983 #i‡
PSP


984 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

987 
s¸ìnßvî_a˘ive
 = 
GR_FALSE
;

989 
£À˘i⁄_ow√r
.
wid
 = 0;

990 
£À˘i⁄_ow√r
.
ty≥li°
 = 
NULL
;

992 #i‡!
NONETWORK


993 #i‚de‡
MW_NOSIGNALS


995 
	`sig«l
(
SIGPIPE
, 
SIG_IGN
);

996 
	`sig«l
(
SIGHUP
, 
SIG_IGN
);

999 i‡(
	`GsO≥nSockë
() < 0) {

1000 
	`EPRINTF
("Cannot bindÅoÇamed socket\n");

1001 
	`‰ì
(
wp
);

1006 #i‡
PSP


1007 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

1010 i‡((
keyb_fd
 = 
	`GdO≥nKeybﬂrd
()) == -1) {

1011 
	`EPRINTF
("Cannot initialise keyboard\n");

1013 
	`‰ì
(
wp
);

1017 #ifde‡
MW_FEATURE_TWO_KEYBOARDS


1018 i‡((
keyb2_fd
 = 
	`GdO≥nKeybﬂrd2
()) == -1) {

1019 
	`EPRINTF
("Cannot initialise second keyboard\n");

1021 
	`‰ì
(
wp
);

1026 #i‡
PSP


1027 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

1030 i‡((
psd
 = 
	`GdO≥nS¸ìn
()Ë=
NULL
) {

1031 
	`EPRINTF
("Cannot initialise screen\n");

1033 
	`GdClo£Keybﬂrd
();

1034 
	`‰ì
(
wp
);

1038 #i‡
PSP


1039 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

1042 
	`GdSëP‹åaôMode
(
psd
, 
p‹åaômode
);

1044 #i‡
PSP


1045 
	`¥ötf
("%†%d %s\n",
__FILE__
,
__LINE__
,
__FUNCTION__
);

1048 i‡((
mou£_fd
 = 
	`GdO≥nMou£
()) == -1) {

1049 
	`EPRINTF
("Cannot initialise mouse\n");

1051 
	`GdClo£S¸ìn
(
psd
);

1052 
	`GdClo£Keybﬂrd
();

1053 
	`‰ì
(
wp
);

1060 #i‡(
HAVE_BIG5_SUPPORT
 | 
HAVE_GB2312_SUPPORT
 | 
HAVE_JISX0213_SUPPORT
 | 
HAVE_KSC5601_SUPPORT
)

1062 
°df⁄t
 = 
	`GdCª©eF⁄t
(
psd
, 
MWFONT_SYSTEM_FIXED
, 0, 
NULL
);

1064 
°df⁄t
 = 
	`GdCª©eF⁄t
(
psd
, 
MWFONT_SYSTEM_VAR
, 0, 
NULL
);

1070 
wp
->
psd
 =Ösd;

1071 
wp
->
id
 = 
GR_ROOT_WINDOW_ID
;

1072 
wp
->
∑ª¡
 = 
NULL
;

1073 
wp
->
ow√r
 = 
NULL
;

1074 
wp
->
chûdªn
 = 
NULL
;

1075 
wp
->
siblögs
 = 
NULL
;

1076 
wp
->
√xt
 = 
NULL
;

1077 
wp
->
x
 = 0;

1078 
wp
->
y
 = 0;

1079 
wp
->
width
 = 
psd
->
xvúåes
;

1080 
wp
->
height
 = 
psd
->
yvúåes
;

1081 
wp
->
b‹dîsize
 = 0;

1082 
wp
->
background
 = 
BLACK
;

1083 
wp
->
b‹dîcﬁ‹
 = wp->
background
;

1084 
wp
->
n›r›mask
 = 0;

1085 
wp
->
bgpixm≠
 = 
NULL
;

1086 
wp
->
bgpixm≠Êags
 = 
GR_BACKGROUND_TILE
;

1087 
wp
->
evít˛õ¡s
 = 
NULL
;

1088 
wp
->
curs‹id
 = 0;

1089 
wp
->
m≠≥d
 = 
GR_TRUE
;

1090 
wp
->
ªÆized
 = 
GR_TRUE
;

1091 
wp
->
ouçut
 = 
GR_TRUE
;

1092 
wp
->
¥›s
 = 0;

1093 
wp
->
tôÀ
 = 
NULL
;

1094 
wp
->
˛ùªgi⁄
 = 
NULL
;

1096 
li°µ
 = 
NULL
;

1097 
li°wp
 = 
wp
;

1098 
roŸwp
 = 
wp
;

1099 
focuswp
 = 
wp
;

1100 
mou£wp
 = 
wp
;

1101 
focusfixed
 = 
GR_FALSE
;

1106 
curcurs‹
 = 
NULL
;

1107 
curs‹x
 = -1;

1108 
curs‹y
 = -1;

1109 
	`GdShowCurs‹
(
psd
);

1110 
	`GrMoveCurs‹
(
psd
->
xvúåes
 / 2,Ösd->
yvúåes
 / 2);

1111 
cid
 = 
	`GrNewCurs‹
(16, 16, 0, 0, 
WHITE
, 
BLACK
, 
curs‹bôs
, 
curs‹mask
);

1112 
	`GrSëWödowCurs‹
(
GR_ROOT_WINDOW_ID
, 
cid
);

1113 
°dcurs‹
 = 
	`GsFödCurs‹
(
cid
);

1115 #i‡
VTSWITCH


1116 
	`MwInôVt
();

1118 
	`GdAddTimî
(50, 
CheckVtCh™ge
, 
NULL
);

1120 
psd
->
	`FûlRe˘
’sd, 0, 0,Ösd->
xvúåes
-1,Ösd->
yvúåes
-1,

1121 
	`GdFödCﬁ‹
(
psd
, 
wp
->
background
));

1126 
curbuâ⁄s
 = 0;

1127 
	`GdRe°ri˘Mou£
(0, 0, 
psd
->
xvúåes
 - 1,Ösd->
yvúåes
 - 1);

1128 
	`GdMoveMou£
(
psd
->
xvúåes
 / 2,Ösd->
yvúåes
 / 2);

1131 
	`GsRedøwS¸ìn
();

1143 
c⁄√˘cou¡
 = 0;

1145 
	}
}

1151 
	$GsTîmö©e
()

1153 #i‡!
NONETWORK


1154 
	`GsClo£Sockë
();

1156 
	`GdClo£S¸ìn
(
roŸwp
->
psd
);

1157 
	`GdClo£Mou£
();

1158 
	`GdClo£Keybﬂrd
();

1159 #i‡
VTSWITCH


1160 
	`MwRedøwVt
(
mwvãrm
);

1162 
	`exô
(0);

1163 
	}
}

1169 
GR_TIMEOUT


1170 
	$GsGëTickCou¡
()

1172 #i‡
MSDOS


1173 
	~<time.h
>

1174  ()(
	`˛ock
(Ë* 1000 / 
CLOCKS_PER_SEC
);

1176 #i‡
_MINIX


1177 
tms
 
t
;

1179  ()
	`times
(&
t
) * 16;

1181 #i‡
UNIX


1182 
timevÆ
 
t
;

1184 
	`gëtimeofday
(&
t
, 
NULL
);

1185  ((
t
.
tv_£c
 * 1000Ë+ (t.
tv_u£c
 / 25000Ë* 25Ë- 
°¨tTicks
;

1191 
	}
}

1194 
	$GrBñl
()

1196 
	`SERVER_LOCK
();

1197 #i‡!
PSP


1198 
	`wrôe
(2, "\7", 1);

1200 
	`SERVER_UNLOCK
();

1201 
	}
}

	@nanox/srvnet.c

18 
	~<°dio.h
>

19 
	~<°ddef.h
>

20 
	~<°dlib.h
>

21 
	~<uni°d.h
>

22 
	~<î∫o.h
>

23 
	~<°rög.h
>

24 
	~<sys/sockë.h
>

25 #i‡
HAVE_SHAREDMEM_SUPPORT


26 
	~<sys/ty≥s.h
>

27 
	~<sys/ùc.h
>

28 
	~<sys/shm.h
>

30 #i‡
ELKS


31 
	~<löuxmt/«.h
>

32 #ñi‡
__ECOS


33 
	~<√töë/ö.h
>

36 #i‚de‡
TRIMEDIA


37 
	~<sys/un.h
>

40 
	~"£rv.h
"

41 
	~"nx¥Ÿo.h
"

44 #i‚de‡
SOCK_STREAM


45 
	#SOCK_STREAM
 2

	)

48 
un_sock
;

49 
GR_CLIENT
 *
roŸ_˛õ¡
;

50 
cuºít_fd
;

52 
GsWrôeTy≥
(,);

59 #i‡(!
MW_FEATURE_TIMERS
Ë|| (!
MW_FEATURE_IMAGES
Ë|| (!
deföed
(
HAVE_FILEIO
))

61 
	$GrNŸIm∂emíãdWøµî
(*
r
)

63 
	`EPRINTF
("«no-X: Fun˘i⁄ %s(ËnŸ im∂emíãd\n", 
curfunc
);

64 
	}
}

68 
	$GrO≥nWøµî
(*
r
)

70 
nxO≥nReq
 *
ªq
 = 
r
;

73 
cur˛õ¡
->
¥o˚ssid
 = 
ªq
->
pid
;

75 
	`GrO≥n
();

76 
	}
}

79 
	$GrClo£Wøµî
(*
r
)

81 
	`GrClo£
();

82 
	}
}

85 
	$GrGëS¸ìnInfoWøµî
(*
r
)

87 
GR_SCREEN_INFO
 
si
;

89 
	`GrGëS¸ìnInfo
(&
si
);

90 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëS¸ìnInfo
);

91 
	`GsWrôe
(
cuºít_fd
, &
si
, (si));

92 
	}
}

95 
	$GrGëSysCﬁ‹Wøµî
(*
r
)

97 
nxGëSysCﬁ‹Req
 *
ªq
 = 
r
;

98 
GR_COLOR
 
cﬁ‹
 = 
	`GrGëSysCﬁ‹
(
ªq
->
ödex
);

100 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëSysCﬁ‹
);

101 
	`GsWrôe
(
cuºít_fd
, &
cﬁ‹
, (color));

102 
	}
}

105 
	$GrNewWödowWøµî
(*
r
)

107 
nxNewWödowReq
 *
ªq
 = 
r
;

108 
GR_WINDOW_ID
 
wid
;

110 
wid
 = 
	`GrNewWödow
(
ªq
->
∑ª¡id
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

111 
ªq
->
height
,Ñeq->
b‹dîsize
,Ñeq->
backgroundcﬁ‹
,

112 
ªq
->
b‹dîcﬁ‹
);

114 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumNewWödow
);

115 
	`GsWrôe
(
cuºít_fd
, &
wid
, (wid));

116 
	}
}

120 
	$GrNewPixm≠Wøµî
(*
r
)

122 
nxNewPixm≠Req
 *
ªq
 = 
r
;

123 
GR_WINDOW_ID
 
wid
;

128 
wid
 = 
	`GrNewPixm≠
(
ªq
->
width
,Ñeq->
height
, 0);

130 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumNewPixm≠
);

131 
	`GsWrôe
(
cuºít_fd
, &
wid
, (wid));

132 
	}
}

135 
	$GrNewI≈utWödowWøµî
(*
r
)

137 
nxNewI≈utWödowReq
 *
ªq
 = 
r
;

138 
GR_WINDOW_ID
 
wid
;

140 
wid
 = 
	`GrNewI≈utWödow
(
ªq
->
∑ª¡id
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

141 
ªq
->
height
);

142 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumNewI≈utWödow
);

143 
	`GsWrôe
(
cuºít_fd
, &
wid
, (wid));

144 
	}
}

147 
	$GrDe°royWödowWøµî
(*
r
)

149 
nxDe°royWödowReq
 *
ªq
 = 
r
;

151 
	`GrDe°royWödow
(
ªq
->
wödowid
);

152 
	}
}

155 
	$GrNewGCWøµî
(*
r
)

157 
GR_GC_ID
 
gc
 = 
	`GrNewGC
();

159 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumNewGC
);

160 
	`GsWrôe
(
cuºít_fd
, &
gc
, (gc));

161 
	}
}

164 
	$GrC›yGCWøµî
(*
r
)

166 
nxC›yGCReq
 *
ªq
 = 
r
;

167 
GR_GC_ID
 
g˙ew
;

169 
g˙ew
 = 
	`GrC›yGC
(
ªq
->
gcid
);

170 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumC›yGC
);

171 
	`GsWrôe
(
cuºít_fd
, &
g˙ew
, (gcnew));

172 
	}
}

175 
	$GrGëGCInfoWøµî
(*
r
)

177 
nxGëGCInfoReq
 *
ªq
 = 
r
;

178 
GR_GC_INFO
 
gcöfo
;

180 
	`GrGëGCInfo
(
ªq
->
gcid
, &
gcöfo
);

181 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëGCInfo
);

182 
	`GsWrôe
(
cuºít_fd
, &
gcöfo
, (gcinfo));

183 
	}
}

186 
	$GrDe°royGCWøµî
(*
r
)

188 
nxDe°royGCReq
 *
ªq
 = 
r
;

190 
	`GrDe°royGC
(
ªq
->
gcid
);

191 
	}
}

194 
	$GrNewRegi⁄Wøµî
(*
r
)

196 
GR_REGION_ID
 
ªgi⁄
 = 
	`GrNewRegi⁄
();

198 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumNewRegi⁄
);

199 
	`GsWrôe
(
cuºít_fd
, &
ªgi⁄
, (region));

200 
	}
}

203 
	$GrDe°royRegi⁄Wøµî
(*
r
)

205 
nxDe°royRegi⁄Req
 *
ªq
 = 
r
;

207 
	`GrDe°royRegi⁄
(
ªq
->
ªgi⁄id
);

208 
	}
}

211 
	$GrI¡î£˘Regi⁄Wøµî
(*
r
)

213 
nxI¡î£˘Regi⁄Req
 *
ªq
 = 
r
;

215 
	`GrI¡î£˘Regi⁄
(
ªq
->
ªgi⁄id
,Ñeq->
§¸egi⁄id1
,

216 
ªq
->
§¸egi⁄id2
);

217 
	}
}

220 
	$GrUni⁄Re˘WôhRegi⁄Wøµî
(*
r
)

222 
nxUni⁄Re˘WôhRegi⁄Req
 *
ªq
 = 
r
;

224 
	`GrUni⁄Re˘WôhRegi⁄
(
ªq
->
ªgi⁄id
, &‘eq->
ª˘
));

225 
	}
}

228 
	$GrUni⁄Regi⁄Wøµî
(*
r
)

230 
nxUni⁄Regi⁄Req
 *
ªq
 = 
r
;

232 
	`GrUni⁄Regi⁄
(
ªq
->
ªgi⁄id
,Ñeq->
§¸egi⁄id1
,Ñeq->
§¸egi⁄id2
);

233 
	}
}

236 
	$GrSubåa˘Regi⁄Wøµî
(*
r
)

238 
nxSubåa˘Regi⁄Req
 *
ªq
 = 
r
;

240 
	`GrSubåa˘Regi⁄
(
ªq
->
ªgi⁄id
,Ñeq->
§¸egi⁄id1
,Ñeq->
§¸egi⁄id2
);

241 
	}
}

244 
	$GrX‹Regi⁄Wøµî
(*
r
)

246 
nxX‹Regi⁄Req
 *
ªq
 = 
r
;

248 
	`GrX‹Regi⁄
(
ªq
->
ªgi⁄id
,Ñeq->
§¸egi⁄id1
,Ñeq->
§¸egi⁄id2
);

249 
	}
}

252 
	$GrPoötInRegi⁄Wøµî
(*
r
)

254 
nxPoötInRegi⁄Req
 *
ªq
 = 
r
;

255 
GR_BOOL
 
ªt_vÆue
 = 
	`GrPoötInRegi⁄
(
ªq
->
ªgi⁄id
,Ñeq->
x
,Ñeq->
y
);

257 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumPoötInRegi⁄
);

258 
	`GsWrôe
(
cuºít_fd
, &
ªt_vÆue
, (ret_value));

259 
	}
}

262 
	$GrRe˘InRegi⁄Wøµî
(*
r
)

264 
nxRe˘InRegi⁄Req
 *
ªq
 = 
r
;

265 
ªt_vÆue
;

267 
ªt_vÆue
 = ()
	`GrRe˘InRegi⁄
(
ªq
->
ªgi⁄id
,

268 
ªq
->
x
,Ñeq->
y
,Ñeq->
w
,Ñeq->
h
);

270 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumRe˘InRegi⁄
);

271 
	`GsWrôe
(
cuºít_fd
, &
ªt_vÆue
, (ret_value));

272 
	}
}

275 
	$GrEm±yRegi⁄Wøµî
(*
r
)

277 
nxEm±yRegi⁄Req
 *
ªq
 = 
r
;

278 
GR_BOOL
 
ªt_vÆue
;

280 
ªt_vÆue
 = 
	`GrEm±yRegi⁄
(
ªq
->
ªgi⁄id
);

281 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumEm±yRegi⁄
);

282 
	`GsWrôe
(
cuºít_fd
, &
ªt_vÆue
, (ret_value));

283 
	}
}

286 
	$GrEquÆRegi⁄Wøµî
(*
r
)

288 
nxEquÆRegi⁄Req
 *
ªq
 = 
r
;

289 
GR_BOOL
 
ªt_vÆue
;

291 
ªt_vÆue
 = 
	`GrEquÆRegi⁄
(
ªq
->
ªgi⁄1
,Ñeq->
ªgi⁄2
);

292 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumEquÆRegi⁄
);

293 
	`GsWrôe
(
cuºít_fd
, &
ªt_vÆue
, (ret_value));

294 
	}
}

297 
	$GrOff£tRegi⁄Wøµî
(*
r
)

299 
nxOff£tRegi⁄Req
 *
ªq
 = 
r
;

301 
	`GrOff£tRegi⁄
(
ªq
->
ªgi⁄
,Ñeq->
dx
,Ñeq->
dy
);

302 
	}
}

305 
	$GrSëGCRegi⁄Wøµî
(*
r
)

307 
nxSëGCRegi⁄Req
 *
ªq
 = 
r
;

309 
	`GrSëGCRegi⁄
(
ªq
->
gcid
,Ñeq->
ªgi⁄id
);

310 
	}
}

313 
	$GrSëGCClùOrigöWøµî
(*
r
)

315 
nxSëGCClùOrigöReq
 *
ªq
 = 
r
;

316 
	`GrSëGCClùOrigö
(
ªq
->
gcid
,Ñeq->
xoff
,Ñeq->
yoff
);

317 
	}
}

320 
	$GrSëGCGøphicsExposuªWøµî
(*
r
)

322 
nxSëGCGøphicsExposuªReq
 *
ªq
 = 
r
;

323 
	`GrSëGCGøphicsExposuª
(
ªq
->
gcid
,Ñeq->
exposuª
);

324 
	}
}

327 
	$GrGëRegi⁄BoxWøµî
(*
r
)

329 
nxRe˘InRegi⁄Req
 *
ªq
 = 
r
;

330 
GR_BOOL
 
ªt_vÆue
;

331 
GR_RECT
 
ªt_ª˘
;

333 
ªt_vÆue
 = 
	`GrGëRegi⁄Box
(
ªq
->
ªgi⁄id
, &
ªt_ª˘
);

335 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëRegi⁄Box
);

336 
	`GsWrôe
(
cuºít_fd
, &
ªt_ª˘
, (ret_rect));

337 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëRegi⁄Box
);

338 
	`GsWrôe
(
cuºít_fd
, &
ªt_vÆue
, (ret_value));

339 
	}
}

342 
	$GrNewPﬁyg⁄Regi⁄Wøµî
(*
r
)

344 
GR_REGION_ID
 
ªgi⁄
;

345 
nxNewPﬁyg⁄Regi⁄Req
 *
ªq
 = 
r
;

346 
cou¡
;

349 
cou¡
 = 
	`GëReqV¨Lí
(
ªq
Ë/ (
GR_POINT
);

350 
ªgi⁄
 = 
	`GrNewPﬁyg⁄Regi⁄
(
ªq
->
mode
, 
cou¡
,

351 (
GR_POINT
 *)
	`GëReqD©a
(
ªq
));

353 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumNewPﬁyg⁄Regi⁄
);

354 
	`GsWrôe
(
cuºít_fd
, &
ªgi⁄
, (region));

355 
	}
}

358 
	$GrM≠WödowWøµî
(*
r
)

360 
nxM≠WödowReq
 *
ªq
 = 
r
;

362 
	`GrM≠Wödow
(
ªq
->
wödowid
);

363 
	}
}

366 
	$GrUnm≠WödowWøµî
(*
r
)

368 
nxUnm≠WödowReq
 *
ªq
 = 
r
;

370 
	`GrUnm≠Wödow
(
ªq
->
wödowid
);

371 
	}
}

374 
	$GrRai£WödowWøµî
(*
r
)

376 
nxRai£WödowReq
 *
ªq
 = 
r
;

378 
	`GrRai£Wödow
(
ªq
->
wödowid
);

379 
	}
}

382 
	$GrLowîWödowWøµî
(*
r
)

384 
nxLowîWödowReq
 *
ªq
 = 
r
;

386 
	`GrLowîWödow
(
ªq
->
wödowid
);

387 
	}
}

390 
	$GrMoveWödowWøµî
(*
r
)

392 
nxMoveWödowReq
 *
ªq
 = 
r
;

394 
	`GrMoveWödow
(
ªq
->
wödowid
,Ñeq->
x
,Ñeq->
y
);

395 
	}
}

398 
	$GrResizeWödowWøµî
(*
r
)

400 
nxResizeWödowReq
 *
ªq
 = 
r
;

402 
	`GrResizeWödow
(
ªq
->
wödowid
,Ñeq->
width
,Ñeq->
height
);

403 
	}
}

406 
	$GrRï¨ítWödowWøµî
(*
r
)

408 
nxRï¨ítWödowReq
 *
ªq
 = 
r
;

410 
	`GrRï¨ítWödow
(
ªq
->
wödowid
,Ñeq->
∑ª¡id
,Ñeq->
x
,Ñeq->
y
);

411 
	}
}

414 
	$GrGëWödowInfoWøµî
(*
r
)

416 
nxGëWödowInfoReq
 *
ªq
 = 
r
;

417 
GR_WINDOW_INFO
 
wi
;

419 
	`GrGëWödowInfo
(
ªq
->
wödowid
, &
wi
);

420 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëWödowInfo
);

421 
	`GsWrôe
(
cuºít_fd
, &
wi
, (wi));

422 
	}
}

425 
	$GrGëF⁄tInfoWøµî
(*
r
)

427 
nxGëF⁄tInfoReq
 *
ªq
 = 
r
;

428 
GR_FONT_INFO
 
fi
;

430 
	`GrGëF⁄tInfo
(
ªq
->
f⁄tid
, &
fi
);

431 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëF⁄tInfo
);

432 
	`GsWrôe
(
cuºít_fd
, &
fi
, (fi));

433 
	}
}

436 
	$GrGëFocusWøµî
(*
r
)

438 
GR_WINDOW_ID
 
wid
 = 
	`GrGëFocus
();

440 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëFocus
);

441 
	`GsWrôe
(
cuºít_fd
, &
wid
, (wid));

442 
	}
}

445 
	$GrSëFocusWøµî
(*
r
)

447 
nxSëFocusReq
 *
ªq
 = 
r
;

449 
	`GrSëFocus
(
ªq
->
wödowid
);

450 
	}
}

453 
	$GrSëWödowCurs‹Wøµî
(*
r
)

455 
nxSëWödowCurs‹Req
 *
ªq
 = 
r
;

457 
	`GrSëWödowCurs‹
(
ªq
->
wödowid
,Ñeq->
curs‹id
);

458 
	}
}

461 
	$GrCÀ¨AªaWøµî
(*
r
)

463 
nxCÀ¨AªaReq
 *
ªq
 = 
r
;

465 
	`GrCÀ¨Aªa
(
ªq
->
wödowid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

466 
ªq
->
height
,Ñeq->
expo£Êag
);

467 
	}
}

470 
	$GrSñe˘EvítsWøµî
(*
r
)

472 
nxSñe˘EvítsReq
 *
ªq
 = 
r
;

474 
	`GrSñe˘Evíts
(
ªq
->
wödowid
,Ñeq->
evítmask
);

475 
	}
}

478 
	$GrGëNextEvítWøµî
(*
r
)

482 
cur˛õ¡
->
waôög_f‹_evít
 = 
TRUE
;

484 
GR_EVENT
 
evt
;

487 
	`GrCheckNextEvít
(&
evt
);

488 if(
evt
.
ty≥
 =
GR_EVENT_TYPE_NONE
) {

490 
cur˛õ¡
->
waôög_f‹_evít
 = 
TRUE
;

494 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëNextEvít
);

495 
	`GsWrôe
(
cuºít_fd
, &
evt
, (evt));

496 if(
evt
.
ty≥
 =
GR_EVENT_TYPE_CLIENT_DATA
) {

497 
	`GsWrôe
(
fd
, 
evt
.
d©a
,Évt.
d©Æí
);

498 
	`‰ì
(
evt
.
d©a
);

501 
	}
}

507 
	$GrGëNextEvítWøµîFöish
(
fd
)

509 
GR_EVENT
 
evt
;

510 
GR_EVENT_CLIENT_DATA
 *
cde
;

514 
	`GrCheckNextEvít
(&
evt
);

516 
	`GsWrôeTy≥
(
fd
,
GrNumGëNextEvít
);

517 
	`GsWrôe
(
fd
, &
evt
, (evt));

518 if(
evt
.
ty≥
 =
GR_EVENT_TYPE_CLIENT_DATA
) {

519 
cde
 = (
GR_EVENT_CLIENT_DATA
 *)&
evt
;

520 if(
cde
->
d©a
) {

521 
	`GsWrôe
(
fd
, 
cde
->
d©a
, cde->
d©Æí
);

522 
	`‰ì
(
cde
->
d©a
);

523 } 
cde
->
d©Æí
 = 0;

525 
	}
}

528 
	$GrCheckNextEvítWøµî
(*
r
)

530 
GR_EVENT
 
evt
;

531 
GR_EVENT_CLIENT_DATA
 *
cde
;

533 
	`GrCheckNextEvít
(&
evt
);

535 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëNextEvít
);

536 
	`GsWrôe
(
cuºít_fd
, &
evt
, (evt));

537 if(
evt
.
ty≥
 =
GR_EVENT_TYPE_CLIENT_DATA
) {

538 
cde
 = (
GR_EVENT_CLIENT_DATA
 *)&
evt
;

539 if(
cde
->
d©a
) {

540 
	`GsWrôe
(
cuºít_fd
, 
cde
->
d©a
, cde->
d©Æí
);

541 
	`‰ì
(
cde
->
d©a
);

542 } 
cde
->
d©Æí
 = 0;

544 
	}
}

547 
	$GrPìkEvítWøµî
(*
r
)

549 
GR_EVENT
 
evt
;

550 
GR_CHAR
 
ªt
;

551 
GR_EVENT_CLIENT_DATA
 *
cde
;

553 
ªt
 = 
	`GrPìkEvít
(&
evt
);

555 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumPìkEvít
);

556 
	`GsWrôe
(
cuºít_fd
, &
evt
, (evt));

557 if(
evt
.
ty≥
 =
GR_EVENT_TYPE_CLIENT_DATA
) {

558 
cde
 = (
GR_EVENT_CLIENT_DATA
 *)&
evt
;

559 if(
cde
->
d©a
) {

560 
	`GsWrôe
(
cuºít_fd
, 
cde
->
d©a
, cde->
d©Æí
);

561 
	`‰ì
(
cde
->
d©a
);

562 } 
cde
->
d©Æí
 = 0;

564 
	`GsWrôe
(
cuºít_fd
, &
ªt
, (
GR_CHAR
));

567 i‡(
ªt
 == 0) {

569 
cur˛õ¡
->
waôög_f‹_evít
 = 
TRUE
;

571 
	}
}

574 
	$GrLöeWøµî
(*
r
)

576 
nxLöeReq
 *
ªq
 = 
r
;

578 
	`GrLöe
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x1
,Ñeq->
y1
,Ñeq->
x2
,Ñeq->
y2
);

579 
	}
}

582 
	$GrPoötWøµî
(*
r
)

584 
nxPoötReq
 *
ªq
 = 
r
;

586 
	`GrPoöt
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
);

588 
	}
}

591 
	$GrPoötsWøµî
(*
r
)

593 
nxPoötsReq
 *
ªq
 = 
r
;

594 
cou¡
;

596 
cou¡
 = 
	`GëReqV¨Lí
(
ªq
Ë/ (
GR_POINT
);

597 
	`GrPoöts
(
ªq
->
døwid
,Ñeq->
gcid
, 
cou¡
, (
GR_POINT
 *)
	`GëReqD©a
(req));

598 
	}
}

601 
	$GrRe˘Wøµî
(*
r
)

603 
nxRe˘Req
 *
ªq
 = 
r
;

605 
	`GrRe˘
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,Ñeq->
height
);

606 
	}
}

609 
	$GrFûlRe˘Wøµî
(*
r
)

611 
nxFûlRe˘Req
 *
ªq
 = 
r
;

613 
	`GrFûlRe˘
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

614 
ªq
->
height
);

615 
	}
}

618 
	$GrPﬁyWøµî
(*
r
)

620 
nxPﬁyReq
 *
ªq
 = 
r
;

621 
cou¡
;

623 
cou¡
 = 
	`GëReqV¨Lí
(
ªq
Ë/ (
GR_POINT
);

624 
	`GrPﬁy
(
ªq
->
døwid
,Ñeq->
gcid
, 
cou¡
, (
GR_POINT
 *)
	`GëReqD©a
(req));

625 
	}
}

629 
	$GrFûlPﬁyWøµî
(*
r
)

631 
nxPﬁyReq
 *
ªq
 = 
r
;

632 
cou¡
;

634 
cou¡
 = 
	`GëReqV¨Lí
(
ªq
Ë/ (
GR_POINT
);

635 
	`GrFûlPﬁy
(
ªq
->
døwid
,Ñeq->
gcid
, 
cou¡
, (
GR_POINT
 *)
	`GëReqD©a
(req));

636 
	}
}

639 
	$GrEŒù£Wøµî
(*
r
)

641 
nxEŒù£Req
 *
ªq
 = 
r
;

643 
	`GrEŒù£
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
rx
,Ñeq->
ry
);

644 
	}
}

647 
	$GrFûlEŒù£Wøµî
(*
r
)

649 
nxFûlEŒù£Req
 *
ªq
 = 
r
;

651 
	`GrFûlEŒù£
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
rx
,Ñeq->
ry
);

652 
	}
}

655 
	$GrArcWøµî
(*
r
)

657 
nxArcReq
 *
ªq
 = 
r
;

659 
	`GrArc
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
rx
,Ñeq->
ry
,

660 
ªq
->
ax
,Ñeq->
ay
,Ñeq->
bx
,Ñeq->
by
,Ñeq->
ty≥
);

661 
	}
}

664 
	$GrArcAngÀWøµî
(*
r
)

666 
nxArcAngÀReq
 *
ªq
 = 
r
;

668 
	`GrArcAngÀ
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
rx
,Ñeq->
ry
,

669 
ªq
->
™gÀ1
,Ñeq->
™gÀ2
,Ñeq->
ty≥
);

670 
	}
}

673 
	$GrSëGCF‹egroundWøµî
(*
r
)

675 
nxSëGCF‹egroundReq
 *
ªq
 = 
r
;

677 
	`GrSëGCF‹eground
(
ªq
->
gcid
,Ñeq->
cﬁ‹
);

678 
	}
}

681 
	$GrSëGCBackgroundWøµî
(*
r
)

683 
nxSëGCBackgroundReq
 *
ªq
 = 
r
;

685 
	`GrSëGCBackground
(
ªq
->
gcid
,Ñeq->
cﬁ‹
);

686 
	}
}

689 
	$GrSëGCF‹egroundPixñVÆWøµî
(*
r
)

691 
nxSëGCF‹egroundPixñVÆReq
 *
ªq
 = 
r
;

693 
	`GrSëGCF‹egroundPixñVÆ
(
ªq
->
gcid
,Ñeq->
pixñvÆ
);

694 
	}
}

697 
	$GrSëGCBackgroundPixñVÆWøµî
(*
r
)

699 
nxSëGCBackgroundPixñVÆReq
 *
ªq
 = 
r
;

701 
	`GrSëGCBackgroundPixñVÆ
(
ªq
->
gcid
,Ñeq->
pixñvÆ
);

702 
	}
}

705 
	$GrSëGCU£BackgroundWøµî
(*
r
)

707 
nxSëGCU£BackgroundReq
 *
ªq
 = 
r
;

709 
	`GrSëGCU£Background
(
ªq
->
gcid
,Ñeq->
Êag
);

710 
	}
}

713 
	$GrSëGCModeWøµî
(*
r
)

715 
nxSëGCModeReq
 *
ªq
 = 
r
;

717 
	`GrSëGCMode
(
ªq
->
gcid
,Ñeq->
mode
);

718 
	}
}

721 
	$GrSëGCLöeAâribuãsWøµî
(*
r
)

723 
nxSëGCLöeAâribuãsReq
 *
ªq
 = 
r
;

725 
	`GrSëGCLöeAâribuãs
(
ªq
->
gcid
,Ñeq->
löe°yÀ
);

726 
	}
}

729 
	$GrSëGCDashWøµî
(*
r
)

731 
nxSëGCDashReq
 *
ªq
 = 
r
;

732 *
buf„r
 = 
	`ALLOCA
(
ªq
->
cou¡
);

734 
	`mem˝y
((*Ë
buf„r
, 
	`GëReqD©a
(
ªq
),Ñeq->
cou¡
);

735 
	`GrSëGCDash
(
ªq
->
gcid
, 
buf„r
,Ñeq->
cou¡
);

736 
	`FREEA
(
buf„r
);

737 
	}
}

741 
	$GrSëGCFûlModeWøµî
(*
r
)

743 
nxSëGCFûlModeReq
 *
ªq
 = 
r
;

745 
	`GrSëGCFûlMode
(
ªq
->
gcid
,Ñeq->
fûlmode
);

746 
	}
}

749 
	$GrSëGCStù∂eWøµî
(*
r
)

751 
nxSëGCStù∂eReq
 *
ªq
 = 
r
;

752 
GR_BITMAP
 *
buf„r
;

754 
buf„r
 = 
	`ALLOCA
(
	`GR_BITMAP_SIZE
(
ªq
->
width
,Ñeq->
height
) *

755 (
GR_BITMAP
));

757 
	`mem˝y
((*Ë
buf„r
, 
	`GëReqD©a
(
ªq
),

758 
	`GR_BITMAP_SIZE
(
ªq
->
width
,Ñeq->
height
Ë* (
GR_BITMAP
));

760 
	`GrSëGCStù∂e
(
ªq
->
gcid
, (
GR_BITMAP
 *)
buf„r
,Ñeq->
width
,Ñeq->
height
);

761 
	`FREEA
(
buf„r
);

762 
	}
}

765 
	$GrSëGCTûeWøµî
(*
r
)

767 
nxSëGCTûeReq
 *
ªq
 = 
r
;

769 
	`GrSëGCTûe
(
ªq
->
gcid
,Ñeq->
pixm≠
,Ñeq->
width
,Ñeq->
height
);

770 
	}
}

773 
	$GrSëGCTSOff£tWøµî
(*
r
)

775 
nxSëGCTSOff£tReq
 *
ªq
 = 
r
;

777 
	`GrSëGCTSOff£t
(
ªq
->
gcid
,Ñeq->
xoff£t
,Ñeq->
yoff£t
);

778 
	}
}

781 
	$GrCª©eF⁄tWøµî
(*
r
)

783 
nxCª©eF⁄tReq
 *
ªq
 = 
r
;

784 
GR_FONT_ID
 
f⁄tid
;

786 
f⁄tid
 = 
	`GrCª©eF⁄t
(
	`GëReqD©a
(
ªq
),Ñeq->
height
, 
NULL
);

788 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumCª©eF⁄t
);

789 
	`GsWrôe
(
cuºít_fd
, &
f⁄tid
, (fontid));

790 
	}
}

793 
	$GrCª©eLogF⁄tWøµî
(*
r
)

795 
nxCª©eLogF⁄tReq
 *
ªq
 = 
r
;

796 
GR_FONT_ID
 
f⁄tid
;

798 
f⁄tid
 = 
	`GrCª©eF⁄t
(
NULL
, 0, &
ªq
->
lf
);

800 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumCª©eLogF⁄t
);

801 
	`GsWrôe
(
cuºít_fd
, &
f⁄tid
, (fontid));

802 
	}
}

805 
	$GrSëF⁄tSizeWøµî
(*
r
)

807 
nxSëF⁄tSizeReq
 *
ªq
 = 
r
;

809 
	`GrSëF⁄tSize
(
ªq
->
f⁄tid
,Ñeq->
f⁄tsize
);

810 
	}
}

813 
	$GrSëF⁄tRŸ©i⁄Wøµî
(*
r
)

815 
nxSëF⁄tRŸ©i⁄Req
 *
ªq
 = 
r
;

817 
	`GrSëF⁄tRŸ©i⁄
(
ªq
->
f⁄tid
,Ñeq->
ã¡hdegªes
);

818 
	}
}

821 
	$GrSëF⁄tAârWøµî
(*
r
)

823 
nxSëF⁄tAârReq
 *
ªq
 = 
r
;

825 
	`GrSëF⁄tAâr
(
ªq
->
f⁄tid
,Ñeq->
£tÊags
,Ñeq->
˛rÊags
);

826 
	}
}

829 
	$GrDe°royF⁄tWøµî
(*
r
)

831 
nxDe°royF⁄tReq
 *
ªq
 = 
r
;

833 
	`GrDe°royF⁄t
(
ªq
->
f⁄tid
);

834 
	}
}

837 
	$GrSëGCF⁄tWøµî
(*
r
)

839 
nxSëGCF⁄tReq
 *
ªq
 = 
r
;

841 
	`GrSëGCF⁄t
(
ªq
->
gcid
,Ñeq->
f⁄tid
);

842 
	}
}

845 
	$GrGëGCTextSizeWøµî
(*
r
)

847 
nxGëGCTextSizeReq
 *
ªq
 = 
r
;

848 
GR_SIZE
 
ªtwidth
, 
ªtheight
, 
ªtba£
;

850 
	`GrGëGCTextSize
(
ªq
->
gcid
, 
	`GëReqD©a
‘eq),Ñeq->
ch¨cou¡
,

851 
ªq
->
Êags
, &
ªtwidth
, &
ªtheight
, &
ªtba£
);

853 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëGCTextSize
);

854 
	`GsWrôe
(
cuºít_fd
, &
ªtwidth
, (retwidth));

855 
	`GsWrôe
(
cuºít_fd
, &
ªtheight
, (retheight));

856 
	`GsWrôe
(
cuºít_fd
, &
ªtba£
, (retbase));

857 
	}
}

861 
	$GrRódAªaWøµî
(*
r
)

863 
nxRódAªaReq
 *
ªq
 = 
r
;

864 
size
;

865 
GR_PIXELVAL
 * 
¨ó
;

868 
size
 = 
ªq
->
width
 *Ñeq->
height
 * (
GR_PIXELVAL
);

870 if(!(
¨ó
 = 
	`mÆloc
(
size
))) {

875 
	`GrRódAªa
(
ªq
->
døwid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,Ñeq->
height
, 
¨ó
);

876 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumRódAªa
);

877 
	`GsWrôe
(
cuºít_fd
, 
¨ó
, 
size
);

878 
	`‰ì
(
¨ó
);

879 
	}
}

883 
	$GrAªaWøµî
(*
r
)

885 
nxAªaReq
 *
ªq
 = 
r
;

887 
	`GrAªa
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,Ñeq->
height
,

888 
	`GëReqD©a
(
ªq
),Ñeq->
pixty≥
);

889 
	}
}

893 
	$GrBôm≠Wøµî
(*
r
)

895 
nxBôm≠Req
 *
ªq
 = 
r
;

897 
	`GrBôm≠
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

898 
ªq
->
height
, 
	`GëReqD©a
(req));

899 
	}
}

902 
	$GrDøwImageBôsWøµî
(*
r
)

904 
nxDøwImageBôsReq
 *
ªq
 = 
r
;

905 * 
addr
;

906 
imagesize
;

907 
GR_IMAGE_HDR
 
hdr
;

909 
hdr
.
width
 = 
ªq
->width;

910 
hdr
.
height
 = 
ªq
->height;

911 
hdr
.
∂™es
 = 
ªq
->planes;

912 
hdr
.
bµ
 = 
ªq
->bpp;

913 
hdr
.
pôch
 = 
ªq
->pitch;

914 
hdr
.
byã•îpixñ
 = 
ªq
->bytesperpixel;

915 
hdr
.
com¥essi⁄
 = 
ªq
->compression;

916 
hdr
.
∑lsize
 = 
ªq
->palsize;

917 
hdr
.
å™scﬁ‹
 = 
ªq
->transcolor;

918 
addr
 = 
	`GëReqD©a
(
ªq
);

919 
hdr
.
imagebôs
 = (
MWUCHAR
 *)
addr
;

920 
imagesize
 = 
hdr
.
pôch
 * hdr.
height
;

921 
hdr
.
∑Àâe
 = (
MWPALENTRY
 *)(
addr
 + 
imagesize
);

922 
	`GrDøwImageBôs
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
, &
hdr
);

923 
	}
}

926 
	$GrC›yAªaWøµî
(*
r
)

928 
nxC›yAªaReq
 *
ªq
 = 
r
;

930 
	`GrC›yAªa
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,Ñeq->
height
,

931 
ªq
->
§cid
,Ñeq->
§cx
,Ñeq->
§cy
,Ñeq->
›
);

932 
	}
}

935 
	$GrTextWøµî
(*
r
)

937 
nxTextReq
 *
ªq
 = 
r
;

939 
	`GrText
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
, 
	`GëReqD©a
(req),

940 
ªq
->
cou¡
,Ñeq->
Êags
);

941 
	}
}

944 
	$GrNewCurs‹Wøµî
(*
r
)

946 
nxNewCurs‹Req
 *
ªq
 = 
r
;

947 
v¨Àn
;

948 * 
bôm≠
;

949 
GR_CURSOR_ID
 
curs‹id
;

951 
v¨Àn
 = 
	`GëReqV¨Lí
(
ªq
);

952 
bôm≠
 = 
	`GëReqD©a
(
ªq
);

954 
curs‹id
 = 
	`GrNewCurs‹
(
ªq
->
width
,Ñeq->
height
,

955 
ªq
->
hŸx
,Ñeq->
hŸy
,Ñeq->
fgcﬁ‹
,Ñeq->
bgcﬁ‹
,

956 (
GR_BITMAP
 *)
bôm≠
, (GR_BITMAP *)(bôm≠+
v¨Àn
/2));

958 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumNewCurs‹
);

959 
	`GsWrôe
(
cuºít_fd
, &
curs‹id
, (cursorid));

960 
	}
}

963 
	$GrMoveCurs‹Wøµî
(*
r
)

965 
nxMoveCurs‹Req
 *
ªq
 = 
r
;

967 
	`GrMoveCurs‹
(
ªq
->
x
,Ñeq->
y
);

968 
	}
}

971 
	$GrGëSy°emPÆëãWøµî
(*
r
)

973 
GR_PALETTE
 
∑l
;

975 
	`GrGëSy°emPÆëã
(&
∑l
);

976 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëSy°emPÆëã
);

977 
	`GsWrôe
(
cuºít_fd
, &
∑l
, (pal));

978 
	}
}

981 
	$GrSëSy°emPÆëãWøµî
(*
r
)

983 
nxSëSy°emPÆëãReq
 *
ªq
 = 
r
;

984 
GR_PALETTE
 
∑l
;

986 
∑l
.
cou¡
 = 
ªq
->count;

987 
	`mem˝y
(
∑l
.
∑Àâe
, 
ªq
->palette, (pal.palette));

988 
	`GrSëSy°emPÆëã
(
ªq
->
fú°
, &
∑l
);

989 
	}
}

992 
	$GrFödCﬁ‹Wøµî
(*
r
)

994 
nxFödCﬁ‹Req
 *
ªq
 = 
r
;

995 
GR_PIXELVAL
 
pixñ
;

997 
	`GrFödCﬁ‹
(
ªq
->
cﬁ‹
, &
pixñ
);

998 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumFödCﬁ‹
);

999 
	`GsWrôe
(
cuºít_fd
, &
pixñ
, (pixel));

1000 
	}
}

1003 
	$GrInje˘EvítWøµî
(*
r
)

1005 
nxInje˘EvítReq
 *
ªq
 = 
r
;

1007 
ªq
->
evít_ty≥
) {

1008 
GR_INJECT_EVENT_POINTER
:

1009 
	`GrInje˘PoöãrEvít
(
ªq
->
evít
.
poöãr
.
x
,

1010 
ªq
->
evít
.
poöãr
.
y
,

1011 
ªq
->
evít
.
poöãr
.
buâ⁄
,

1012 
ªq
->
evít
.
poöãr
.
visibÀ
);

1015 
GR_INJECT_EVENT_KEYBOARD
:

1016 
	`GrInje˘KeybﬂrdEvít
(
ªq
->
evít
.
keybﬂrd
.
wid
,

1017 
ªq
->
evít
.
keybﬂrd
.
keyvÆue
,

1018 
ªq
->
evít
.
keybﬂrd
.
modifõr
,

1019 
ªq
->
evít
.
keybﬂrd
.
sˇncode
,

1020 
ªq
->
evít
.
keybﬂrd
.
¥es£d
);

1023 
	}
}

1026 
	$GrSëWMPr›îtõsWøµî
(*
r
)

1028 
nxSëWMPr›îtõsReq
 *
ªq
 = 
r
;

1029 
GR_WM_PROPERTIES
 *
¥›s
 = 
	`GëReqD©a
(
ªq
);

1031 if(
	`GëReqV¨Lí
(
ªq
Ë- (
GR_WM_PROPERTIES
))

1032 
¥›s
->
tôÀ
 = (
GR_CHAR
 *Ìr›†+ (
GR_WM_PROPERTIES
);

1034 
¥›s
->
tôÀ
 = 
NULL
;

1035 
	`GrSëWMPr›îtõs
(
ªq
->
wödowid
, 
¥›s
);

1036 
	}
}

1039 
	$GrGëWMPr›îtõsWøµî
(*
r
)

1041 
nxGëWMPr›îtõsReq
 *
ªq
 = 
r
;

1042 
UINT16
 
ãxéí
;

1043 
GR_WM_PROPERTIES
 
¥›s
;

1045 
	`GrGëWMPr›îtõs
(
ªq
->
wödowid
, &
¥›s
);

1047 if(
¥›s
.
tôÀ
)

1048 
ãxéí
 = 
	`°æí
((c⁄° *)
¥›s
.
tôÀ
) + 1;

1049 
ãxéí
 = 0;

1051 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumGëWMPr›îtõs
);

1052 
	`GsWrôe
(
cuºít_fd
, &
¥›s
, (props));

1053 
	`GsWrôe
(
cuºít_fd
, &
ãxéí
, (textlen));

1054 if(
ãxéí
)

1055 
	`GsWrôe
(
cuºít_fd
, 
¥›s
.
tôÀ
, 
ãxéí
);

1056 
	}
}

1059 
	$GrClo£WödowWøµî
(*
r
)

1061 
nxClo£WödowReq
 *
ªq
 = 
r
;

1063 
	`GrClo£Wödow
(
ªq
->
wödowid
);

1064 
	}
}

1067 
	$GrKûlWödowWøµî
(*
r
)

1069 
nxKûlWödowReq
 *
ªq
 = 
r
;

1071 
	`GrKûlWödow
(
ªq
->
wödowid
);

1072 
	}
}

1074 #i‡
MW_FEATURE_IMAGES
 && 
deföed
(
HAVE_FILEIO
)

1076 
	$GrDøwImageFromFûeWøµî
(*
r
)

1078 
nxDøwImageFromFûeReq
 *
ªq
 = 
r
;

1080 
	`GrDøwImageFromFûe
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

1081 
ªq
->
height
, 
	`GëReqD©a
‘eq),Ñeq->
Êags
);

1082 
	}
}

1085 
	$GrLﬂdImageFromFûeWøµî
(*
r
)

1087 
nxLﬂdImageFromFûeReq
 *
ªq
 = 
r
;

1088 
GR_IMAGE_ID
 
id
;

1090 
id
 = 
	`GrLﬂdImageFromFûe
(
	`GëReqD©a
(
ªq
),Ñeq->
Êags
);

1091 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumLﬂdImageFromFûe
);

1092 
	`GsWrôe
(
cuºít_fd
, &
id
, (id));

1093 
	}
}

1095 
	#GrDøwImageFromFûeWøµî
 
GrNŸIm∂emíãdWøµî


	)

1096 
	#GrLﬂdImageFromFûeWøµî
 
GrNŸIm∂emíãdWøµî


	)

1099 #i‡
MW_FEATURE_IMAGES


1101 
	$GrDøwImageToFôWøµî
(*
r
)

1103 
nxDøwImageToFôReq
 *
ªq
 = 
r
;

1105 
	`GrDøwImageToFô
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

1106 
ªq
->
height
,Ñeq->
imageid
);

1107 
	}
}

1110 
	$GrFªeImageWøµî
(*
r
)

1112 
nxFªeImageReq
 *
ªq
 = 
r
;

1114 
	`GrFªeImage
(
ªq
->
id
);

1115 
	}
}

1118 
	$GrGëImageInfoWøµî
(*
r
)

1120 
nxGëImageInfoReq
 *
ªq
 = 
r
;

1121 
GR_IMAGE_INFO
 
öfo
;

1123 
	`GrGëImageInfo
(
ªq
->
id
, &
öfo
);

1124 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëImageInfo
);

1125 
	`GsWrôe
(
cuºít_fd
, &
öfo
, (info));

1126 
	}
}

1128 
	#GrDøwImageToFôWøµî
 
GrNŸIm∂emíãdWøµî


	)

1129 
	#GrFªeImageWøµî
 
GrNŸIm∂emíãdWøµî


	)

1130 
	#GrGëImageInfoWøµî
 
GrNŸIm∂emíãdWøµî


	)

1134 
	$GrSëS¸ìnSavîTimeoutWøµî
(*
r
)

1136 
nxSëS¸ìnSavîTimeoutReq
 *
ªq
 = 
r
;

1138 
	`GrSëS¸ìnSavîTimeout
(
ªq
->
timeout
);

1139 
	}
}

1142 
	$GrSëSñe˘i⁄Ow√rWøµî
(*
r
)

1144 
nxSëSñe˘i⁄Ow√rReq
 *
ªq
 = 
r
;

1146 
	`GrSëSñe˘i⁄Ow√r
(
ªq
->
wid
, 
	`GëReqD©a
(req));

1147 
	}
}

1150 
	$GrGëSñe˘i⁄Ow√rWøµî
(*
r
)

1152 
GR_CHAR
 *
ty≥li°
;

1153 
GR_WINDOW_ID
 
wid
;

1154 
Àn
;

1156 
wid
 = 
	`GrGëSñe˘i⁄Ow√r
(&
ty≥li°
);

1157 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëSñe˘i⁄Ow√r
);

1158 
	`GsWrôe
(
cuºít_fd
, &
wid
, (wid));

1160 if(
wid
) {

1161 
Àn
 = 
	`°æí
((c⁄° *)
ty≥li°
) + 1;

1162 
	`GsWrôe
(
cuºít_fd
, &
Àn
, (len));

1163 
	`GsWrôe
(
cuºít_fd
, 
ty≥li°
, 
Àn
);

1165 
	}
}

1168 
	$GrReque°Clõ¡D©aWøµî
(*
r
)

1170 
nxReque°Clõ¡D©aReq
 *
ªq
 = 
r
;

1172 
	`GrReque°Clõ¡D©a
(
ªq
->
wid
,Ñeq->
rid
,Ñeq->
£rül
,Ñeq->
mimëy≥
);

1173 
	}
}

1176 
	$GrSídClõ¡D©aWøµî
(*
r
)

1178 
nxSídClõ¡D©aReq
 *
ªq
 = 
r
;

1180 
	`GrSídClõ¡D©a
(
ªq
->
wid
,Ñeq->
did
,Ñeq->
£rül
,Ñeq->
Àn
,

1181 
	`GëReqV¨Lí
(
ªq
), 
	`GëReqD©a
(req));

1182 
	}
}

1185 
	$GrBñlWøµî
(*
r
)

1187 
	`GrBñl
();

1188 
	}
}

1191 
	$GrSëBackgroundPixm≠Wøµî
(*
r
)

1193 
nxSëBackgroundPixm≠Req
 *
ªq
 = 
r
;

1195 
	`GrSëBackgroundPixm≠
(
ªq
->
wid
,Ñeq->
pixm≠
,Ñeq->
Êags
);

1196 
	}
}

1199 
	$GrDe°royCurs‹Wøµî
(*
r
)

1201 
nxDe°royCurs‹Req
 *
ªq
 = 
r
;

1203 
	`GrDe°royCurs‹
(
ªq
->
curs‹id
);

1204 
	}
}

1207 
	$GrQuîyTªeWøµî
(*
r
)

1209 
nxQuîyTªeReq
 *
ªq
 = 
r
;

1210 
GR_WINDOW_ID
 
∑ª¡id
;

1211 
GR_WINDOW_ID
 * 
chûdªn
;

1212 
GR_COUNT
 
nchûdªn
;

1214 
	`GrQuîyTªe
(
ªq
->
wödowid
, &
∑ª¡id
, &
chûdªn
, &
nchûdªn
);

1216 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumQuîyTªe
);

1217 
	`GsWrôe
(
cuºít_fd
, &
∑ª¡id
, (parentid));

1218 
	`GsWrôe
(
cuºít_fd
, &
nchûdªn
, (nchildren));

1219 i‡(
nchûdªn
) {

1220 
	`GsWrôe
(
cuºít_fd
, 
chûdªn
, 
nchûdªn
 * (
GR_WINDOW_ID
));

1221 
	`‰ì
(
chûdªn
);

1223 
	}
}

1225 #i‡
MW_FEATURE_TIMERS


1227 
	$GrCª©eTimîWøµî
(*
r
)

1229 
nxCª©eTimîReq
 *
ªq
 = 
r
;

1230 
GR_TIMER_ID
 
timîid
;

1232 
timîid
 = 
	`GrCª©eTimî
(
ªq
->
wid
,Ñeq->
≥riod
);

1234 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumCª©eTimî
);

1235 
	`GsWrôe
(
cuºít_fd
, &
timîid
,  (timerid));

1236 
	}
}

1238 
	#GrCª©eTimîWøµî
 
GrNŸIm∂emíãdWøµî


	)

1241 
	simage_li°
 {

1242 *
	md©a
;

1243 
	mid
;

1244 
	msize
;

1245 
	moff£t
;

1247 
image_li°
 *
	m√xt
;

1248 } 
	timagñi°_t
;

1250 
imagñi°_t
 *
	gimageLi°Hód
 = 0;

1251 
imagñi°_t
 *
	gimageLi°Taû
 = 0;

1252 
	gimageLi°Id
 = 0;

1254 
imagñi°_t
 *
	$födImageBuf„r
(
buf„r_id
)

1256 
imagñi°_t
 *
buf„r
 = 0;

1258 
buf„r
 = 
imageLi°Hód
; buf„r; buf„∏buf„r->
√xt
)

1259 i‡(
buf„r
->
id
 =
buf„r_id
)

1262  
buf„r
;

1263 
	}
}

1265 
	$‰ìImageBuf„r
(
imagñi°_t
 *
buf„r
)

1267 
imagñi°_t
 *
¥ev
 = 0;

1268 
imagñi°_t
 *
±r
 = 
imageLi°Hód
;

1270 
±r
) {

1271 i‡(
±r
 =
buf„r
) {

1272 i‡(
¥ev
)

1273 
¥ev
->
√xt
 = 
buf„r
->next;

1275 
imageLi°Hód
 = 
buf„r
->
√xt
;

1277 i‡(!
imageLi°Hód
Ë
imageLi°Taû
 = 0;

1279 
	`‰ì
(
buf„r
->
d©a
);

1280 
	`‰ì
(
buf„r
);

1284 
¥ev
 = 
±r
;

1285 
±r
 =Öå->
√xt
;

1287 
	}
}

1290 
	$GrImageBuf„rAŒocWøµî
(*
r
)

1292 
nxImageBuf„rAŒocReq
 *
ªq
 = 
r
;

1296 i‡(!
imageLi°Taû
) {

1297 
imageLi°Hód
 = 
imageLi°Taû
 = (
imagñi°_t
 *Ë
	`mÆloc
((imagelist_t));

1300 
imageLi°Taû
->
√xt
 = (
imagñi°_t
 *Ë
	`mÆloc
((imagelist_t));

1301 
imageLi°Taû
 = imageLi°Taû->
√xt
;

1304 
imageLi°Taû
->
id
 = ++
imageLi°Id
;

1305 
imageLi°Taû
->
d©a
 = (*Ë
	`mÆloc
(
ªq
->
size
);

1306 
imageLi°Taû
->
size
 = 
ªq
->size;

1307 
imageLi°Taû
->
off£t
 = 0;

1309 
imageLi°Taû
->
√xt
 = 0;

1311 
	`GsWrôeTy≥
(
cuºít_fd
,
GrNumImageBuf„rAŒoc
);

1312 
	`GsWrôe
(
cuºít_fd
, &
imageLi°Taû
->
id
, ());

1313 
	}
}

1316 
	$GrImageBuf„rSídWøµî
(*
r
)

1318 
csize
;

1319 
imagñi°_t
 *
buf„r
;

1320 
nxImageBuf„rSídReq
 *
ªq
 = 
r
;

1322 
buf„r
 = 
	`födImageBuf„r
(
ªq
->
buf„r_id
);

1324 i‡(!
buf„r
) ;

1326 i‡(
buf„r
->
off£t
 + 
ªq
->
size
 >= buffer->size)

1327 
csize
 = 
buf„r
->
size
 - buf„r->
off£t
;

1329 
csize
 = 
ªq
->
size
;

1331 i‡(!
csize
) ;

1333 
	`mem˝y
((*Ë(((*)
buf„r
->
d©a
Ë+ buf„r->
off£t
),

1334 
	`GëReqD©a
(
ªq
), 
csize
);

1336 
buf„r
->
off£t
 +
csize
;

1337 
	}
}

1339 #i‡
MW_FEATURE_IMAGES


1341 
	$GrLﬂdImageFromBuf„rWøµî
(*
r
)

1343 
GR_IMAGE_ID
 
id
;

1344 
imagñi°_t
 *
buf„r
;

1345 
nxLﬂdImageFromBuf„rReq
 *
ªq
 = 
r
;

1347 
buf„r
 = 
	`födImageBuf„r
(
ªq
->buffer);

1349 i‡(!
buf„r
) ;

1351 
id
 = 
	`GrLﬂdImageFromBuf„r
(
buf„r
->
d©a
, buf„r->
size
, 
ªq
->
Êags
);

1353 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumLﬂdImageFromBuf„r
);

1354 
	`GsWrôe
(
cuºít_fd
, &
id
, (id));

1356 
	`‰ìImageBuf„r
(
buf„r
);

1357 
	}
}

1360 
	$GrDøwImageFromBuf„rWøµî
(*
r
)

1362 
imagñi°_t
 *
buf„r
;

1363 
nxDøwImageFromBuf„rReq
 *
ªq
 = 
r
;

1365 
buf„r
 = 
	`födImageBuf„r
(
ªq
->buffer);

1367 i‡(!
buf„r
) ;

1369 
	`GrDøwImageFromBuf„r
(
ªq
->
døwid
,Ñeq->
gcid
,Ñeq->
x
,Ñeq->
y
,Ñeq->
width
,

1370 
ªq
->
height
, 
buf„r
->
d©a
, buf„r->
size
,

1371 
ªq
->
Êags
);

1373 
	`‰ìImageBuf„r
(
buf„r
);

1374 
	}
}

1376 
	#GrLﬂdImageFromBuf„rWøµî
 
GrNŸIm∂emíãdWøµî


	)

1377 
	#GrDøwImageFromBuf„rWøµî
 
GrNŸIm∂emíãdWøµî


	)

1381 #i‡
MW_FEATURE_TIMERS


1383 
	$GrDe°royTimîWøµî
(*
r
)

1385 
nxDe°royTimîReq
 *
ªq
 = 
r
;

1387 
	`GrDe°royTimî
(
ªq
->
timîid
);

1388 
	}
}

1390 
	#GrDe°royTimîWøµî
 
GrNŸIm∂emíãdWøµî


	)

1394 
	$GrSëP‹åaôModeWøµî
(*
r
)

1396 
nxSëP‹åaôModeReq
 *
ªq
 = 
r
;

1398 
	`GrSëP‹åaôMode
(
ªq
->
p‹åaômode
);

1399 
	}
}

1402 
	$GrQuîyPoöãrWøµî
(*
r
)

1404 
GR_WINDOW_ID
 
mwö
;

1405 
GR_COORD
 
x
, 
y
;

1406 
GR_BUTTON
 
bmask
;

1408 
	`GrQuîyPoöãr
(&
mwö
, &
x
, &
y
, &
bmask
);

1410 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumQuîyPoöãr
);

1412 
	`GsWrôe
(
cuºít_fd
, &
mwö
, (mwin));

1413 
	`GsWrôe
(
cuºít_fd
, &
x
, (x));

1414 
	`GsWrôe
(
cuºít_fd
, &
y
, (y));

1415 
	`GsWrôe
(
cuºít_fd
, &
bmask
, (bmask));

1416 
	}
}

1424 
	#SHMKEY_BASE
 1000000

	)

1425 
	#SHMKEY_MAX
 256

	)

1428 
	$GrReqShmCmdsWøµî
(*
r
)

1430 #i‡
HAVE_SHAREDMEM_SUPPORT


1431 
nxReqShmCmdsReq
 *
ªq
 = 
r
;

1432 
key
, 
shmid
;

1433 *
tmp
;

1435 i‡–
cur˛õ¡
->
shm_cmds
 != 0 )

1436 
bad
;

1438  
key
=
SHMKEY_BASE
; key < SHMKEY_BASE+
SHMKEY_MAX
; key++ ) {

1439 
shmid
 = 
	`shmgë
(
key
,
ªq
->
size
,
IPC_CREAT
|
IPC_EXCL
|0666);

1440 i‡–
shmid
 == -1 ) {

1441 i‡–
î∫o
 !
EEXIST
 )

1442 
bad
;

1444 
tmp
 = 
	`shm©
(
shmid
,0,0);

1445 i‡–
tmp
 == (*)-1 )

1446 
bad
;

1447 
cur˛õ¡
->
shm_cmds
 = 
tmp
;

1448 
cur˛õ¡
->
shm_cmds_shmid
 = 
shmid
;

1449 
cur˛õ¡
->
shm_cmds_size
 = 
ªq
->
size
;

1450 
föish
;

1454 
bad
:

1455 
key
 = 0;

1457 
föish
:

1458 
	`DPRINTF
("Shm: Reque° key gø¡ed=%d\n",
key
);

1459 
	`GsWrôe
(
cuºít_fd
, &
key
, (key));

1462 
key
 = 0;

1463 
	`GsWrôe
(
cuºít_fd
, &
key
, (key));

1465 
	}
}

1468 
	$GrGëF⁄tLi°Wøµî
(*
r
)

1470 
MWFONTLIST
 **
li°
;

1471 
num
;

1472 
i
, 
âÀn
, 
mwÀn
;

1474 
	`GrGëF⁄tLi°
(&
li°
, &
num
);

1476 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGëF⁄tLi°
);

1479 
	`GsWrôe
(
cuºít_fd
, &
num
, ());

1481 if(
num
 != -1) {

1482 
i
 = 0; i < 
num
; i++) {

1483 
âÀn
 = 
	`°æí
(
li°
[
i
]->
â«me
) + 1;

1484 
mwÀn
 = 
	`°æí
(
li°
[
i
]->
mw«me
) + 1;

1486 
	`GsWrôe
(
cuºít_fd
, &
âÀn
, ());

1487 
	`GsWrôe
(
cuºít_fd
, 
li°
[
i
]->
â«me
, 
âÀn
 * ());

1489 
	`GsWrôe
(
cuºít_fd
, &
mwÀn
, ());

1490 
	`GsWrôe
(
cuºít_fd
, 
li°
[
i
]->
mw«me
, 
mwÀn
 * ());

1493 
	`GrFªeF⁄tLi°
(&
li°
, 
num
);

1495 
	}
}

1498 
	$GrNewBôm≠Regi⁄Wøµî
(*
r
)

1500 
GR_REGION_ID
 
ªgi⁄
;

1501 
nxNewBôm≠Regi⁄Req
 *
ªq
 = 
r
;

1503 
ªgi⁄
 = 
	`GrNewBôm≠Regi⁄
(
	`GëReqD©a
(
ªq
),Ñeq->
width
,Ñeq->
height
);

1505 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumNewBôm≠Regi⁄
);

1506 
	`GsWrôe
(
cuºít_fd
, &
ªgi⁄
, (region));

1507 
	}
}

1510 
	$GrSëWödowRegi⁄Wøµî
(*
r
)

1512 
nxSëWödowRegi⁄Req
 *
ªq
 = 
r
;

1514 
	`GrSëWödowRegi⁄
(
ªq
->
wid
,Ñeq->
rid
,Ñeq->
ty≥
);

1515 
	}
}

1518 
	$GrSåëchAªaWøµî
(*
r
)

1520 
nxSåëchAªaReq
 *
ªq
 = 
r
;

1522 
	`GrSåëchAªa
(
ªq
->
døwid
,Ñeq->
gcid
,

1523 
ªq
->
dx1
,Ñeq->
dy1
,

1524 
ªq
->
dx2
,Ñeq->
dy2
,

1525 
ªq
->
§cid
,

1526 
ªq
->
sx1
,Ñeq->
sy1
,

1527 
ªq
->
sx2
,Ñeq->
sy2
,

1528 
ªq
->
›
);

1529 
	}
}

1533 
	$GrGøbKeyWøµî
(*
r
)

1535 
nxGøbKeyReq
 *
ªq
 = 
r
;

1537 i‡(
ªq
->
ty≥
 !
GR_GRAB_MAX
 + 1) {

1538 
ªt
 = 
	`GrGøbKey
(
ªq
->
wid
,Ñeq->
key
,Ñeq->
ty≥
);

1539 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumGøbKey
);

1540 
	`GsWrôe
(
cuºít_fd
, &
ªt
, (ret));

1542 
	`GrUngøbKey
(
ªq
->
wid
,Ñeq->
key
);

1543 
	}
}

1546 
	$GrSëTønsf‹mWøµî
(*
r
)

1548 
nxSëTønsf‹mReq
 *
ªq
 = 
r
;

1549 
GR_TRANSFORM
 
å™s
;

1551 i‡(
ªq
->
mode
) {

1552 
å™s
.
a
 = 
ªq
->
å™s_a
;

1553 
å™s
.
b
 = 
ªq
->
å™s_b
;

1554 
å™s
.
c
 = 
ªq
->
å™s_c
;

1555 
å™s
.
d
 = 
ªq
->
å™s_d
;

1556 
å™s
.
e
 = 
ªq
->
å™s_e
;

1557 
å™s
.
f
 = 
ªq
->
å™s_f
;

1558 
å™s
.
s
 = 
ªq
->
å™s_s
;

1559 
	`GrSëTønsf‹m
(&
å™s
);

1561 
	`GrSëTønsf‹m
(
NULL
);

1562 
	}
}

1565 
	$GrCª©eF⁄tFromBuf„rWøµî
(*
r
)

1567 #i‡
HAVE_FREETYPE_2_SUPPORT


1568 
imagñi°_t
 *
buf„r
;

1569 
nxCª©eF⁄tFromBuf„rReq
 *
ªq
 = 
r
;

1570 
GR_FONT_ID
 
ªsu…
;

1572 
buf„r
 = 
	`födImageBuf„r
(
ªq
->
buf„r_id
);

1573 i‡(!
buf„r
) {

1574 
ªsu…
 = 0;

1576 
ªsu…
 = 
	`GrCª©eF⁄tFromBuf„r
(
buf„r
->
d©a
, buf„r->
size
,

1577 (c⁄° *)
ªq
->
f‹m©
,Ñeq->
height
);

1579 
	`‰ìImageBuf„r
(
buf„r
);

1582 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumCª©eF⁄tFromBuf„r
);

1583 
	`GsWrôe
(
cuºít_fd
, &
ªsu…
, (result));

1585 
	}
}

1588 
	$GrC›yF⁄tWøµî
(*
r
)

1590 #i‡
HAVE_FREETYPE_2_SUPPORT


1591 
nxC›yF⁄tReq
 *
ªq
 = 
r
;

1592 
GR_FONT_ID
 
ªsu…
 = 
	`GrC›yF⁄t
(
ªq
->
f⁄tid
,Ñeq->
height
);

1594 
	`GsWrôeTy≥
(
cuºít_fd
, 
GrNumC›yF⁄t
);

1595 
	`GsWrôe
(
cuºít_fd
, &
ªsu…
, (result));

1597 
	}
}

1600 
GrShmCmdsFlushWøµî
(*
r
);

1605 
	sGrFun˘i⁄
 {

1606 (*
	mfunc
)(*);

1607 
GR_FUNC_NAME
 
	m«me
;

1608 } 
	gGrFun˘i⁄s
[] = {

1609  {
GrO≥nWøµî
, "GrOpen"},

1610  {
GrClo£Wøµî
, "GrClose"},

1611  {
GrGëS¸ìnInfoWøµî
, "GrGetScreenInfo"},

1612  {
GrNewWödowWøµî
, "GrNewWindow"},

1613  {
GrNewI≈utWödowWøµî
, "GrNewInputWindow"},

1614  {
GrDe°royWödowWøµî
, "GrDestroyWindow"},

1615  {
GrNewGCWøµî
, "GrNewGC"},

1616  {
GrC›yGCWøµî
, "GrCopyGC"},

1617  {
GrGëGCInfoWøµî
, "GrGetGCInfo"},

1618  {
GrDe°royGCWøµî
, "GrDestroyGC"},

1619  {
GrM≠WödowWøµî
, "GrMapWindow"},

1620  {
GrUnm≠WödowWøµî
, "GrUnmapWindow"},

1621  {
GrRai£WödowWøµî
, "GrRaiseWindow"},

1622  {
GrLowîWödowWøµî
, "GrLowerWindow"},

1623  {
GrMoveWödowWøµî
, "GrMoveWindow"},

1624  {
GrResizeWödowWøµî
, "GrResizeWindow"},

1625  {
GrGëWödowInfoWøµî
, "GrGetWindowInfo"},

1626  {
GrGëF⁄tInfoWøµî
, "GrGetFontInfo"},

1627  {
GrSëFocusWøµî
, "GrSetFocus"},

1628  {
GrSëWödowCurs‹Wøµî
, "GrSetWindowCursor"},

1629  {
GrCÀ¨AªaWøµî
, "GrClearAreaWrapper"},

1630  {
GrSñe˘EvítsWøµî
, "GrSelectEvents"},

1631  {
GrGëNextEvítWøµî
, "GrGetNextEvent"},

1632  {
GrCheckNextEvítWøµî
, "GrCheckNextEvent"},

1633  {
GrPìkEvítWøµî
, "GrPeekEvent"},

1634  {
GrLöeWøµî
, "GrLine"},

1635  {
GrPoötWøµî
, "GrPoint"},

1636  {
GrRe˘Wøµî
, "GrRect"},

1637  {
GrFûlRe˘Wøµî
, "GrFillRect"},

1638  {
GrPﬁyWøµî
, "GrPoly"},

1639  {
GrFûlPﬁyWøµî
, "GrFillPoly"},

1640  {
GrEŒù£Wøµî
, "GrEllipse"},

1641  {
GrFûlEŒù£Wøµî
, "GrFillEllipse"},

1642  {
GrSëGCF‹egroundWøµî
, "GrSetGCForeground"},

1643  {
GrSëGCBackgroundWøµî
, "GrSetGCBackGround"},

1644  {
GrSëGCU£BackgroundWøµî
, "GrSetGCUseBackGround"},

1645  {
GrSëGCModeWøµî
, "GrSetGCMode"},

1646  {
GrSëGCF⁄tWøµî
, "GrSetGCFont"},

1647  {
GrGëGCTextSizeWøµî
, "GrGetGCTextSize"},

1648  {
GrRódAªaWøµî
, "GrReadArea"},

1649  {
GrAªaWøµî
, "GrArea"},

1650  {
GrBôm≠Wøµî
, "GrBitmap"},

1651  {
GrTextWøµî
, "GrText"},

1652  {
GrNewCurs‹Wøµî
, "GrNewCursor"},

1653  {
GrMoveCurs‹Wøµî
, "GrMoveCursor"},

1654  {
GrGëSy°emPÆëãWøµî
, "GrGetSystemPalette"},

1655  {
GrFödCﬁ‹Wøµî
, "GrFindColor"},

1656  {
GrRï¨ítWödowWøµî
, "GrReparentWindow"},

1657  {
GrDøwImageFromFûeWøµî
, "GrDrawImageFromFile"},

1658  {
GrLﬂdImageFromFûeWøµî
, "GrLoadImageFromFile"},

1659  {
GrNewPixm≠Wøµî
, "GrNewPixmap"},

1660  {
GrC›yAªaWøµî
, "GrCopyArea"},

1661  {
GrSëF⁄tSizeWøµî
, "GrSetFontSize"},

1662  {
GrCª©eF⁄tWøµî
, "GrCreateFont"},

1663  {
GrDe°royF⁄tWøµî
, "GrDestroyFont"},

1664  {
GrReqShmCmdsWøµî
, "GrReqShmCmds"},

1665  {
GrShmCmdsFlushWøµî
, "GrShmCmdsFlush"},

1666  {
GrSëF⁄tRŸ©i⁄Wøµî
, "GrSetFontRotation"},

1667  {
GrSëF⁄tAârWøµî
, "GrSetFontAttr"},

1668  {
GrSëSy°emPÆëãWøµî
, "GrSetSystemPalette"},

1669  {
GrInje˘EvítWøµî
, "GrInjectEvent"},

1670  {
GrNewRegi⁄Wøµî
, "GrNewRegion"},

1671  {
GrDe°royRegi⁄Wøµî
, "GrDestroyRegion"},

1672  {
GrUni⁄Re˘WôhRegi⁄Wøµî
, "GrUnionRectWithRegion"},

1673  {
GrUni⁄Regi⁄Wøµî
, "GrUnionRegion"},

1674  {
GrI¡î£˘Regi⁄Wøµî
, "GrIntersectRegion"},

1675  {
GrSëGCRegi⁄Wøµî
, "GrSetGCRegion"},

1676  {
GrSubåa˘Regi⁄Wøµî
, "GrSubtractRegion"},

1677  {
GrX‹Regi⁄Wøµî
, "GrXorRegion"},

1678  {
GrPoötInRegi⁄Wøµî
, "GrPointInRegion"},

1679  {
GrRe˘InRegi⁄Wøµî
, "GrRectInRegion"},

1680  {
GrEm±yRegi⁄Wøµî
, "GrEmptyRegion"},

1681  {
GrEquÆRegi⁄Wøµî
, "GrEqualRegion"},

1682  {
GrOff£tRegi⁄Wøµî
, "GrOffsetRegion"},

1683  {
GrGëRegi⁄BoxWøµî
, "GrGetRegionBox"},

1684  {
GrNewPﬁyg⁄Regi⁄Wøµî
, "GrNewPolygonRegion"},

1685  {
GrArcWøµî
, "GrArc"},

1686  {
GrArcAngÀWøµî
, "GrArcAngle"},

1687  {
GrSëWMPr›îtõsWøµî
, "GrSetWMProperties"},

1688  {
GrGëWMPr›îtõsWøµî
, "GrGetWMProperties"},

1689  {
GrClo£WödowWøµî
, "GrCloseWindow"},

1690  {
GrKûlWödowWøµî
, "GrKillWindow"},

1691  {
GrDøwImageToFôWøµî
, "GrDrawImageToFit"},

1692  {
GrFªeImageWøµî
, "GrFreeImage"},

1693  {
GrGëImageInfoWøµî
, "GrGetImageInfo"},

1694  {
GrDøwImageBôsWøµî
, "GrDrawImageBits"},

1695  {
GrPoötsWøµî
, "GrPoints"},

1696  {
GrGëFocusWøµî
, "GrGetFocus"},

1697  {
GrGëSysCﬁ‹Wøµî
, "GrGetSysColor"},

1698  {
GrSëS¸ìnSavîTimeoutWøµî
, "GrSetScreenSaverTimeout"},

1699  {
GrSëSñe˘i⁄Ow√rWøµî
, "GrSetSelectionOwner"},

1700  {
GrGëSñe˘i⁄Ow√rWøµî
, "GrGetSelectionOwner"},

1701  {
GrReque°Clõ¡D©aWøµî
, "GrRequestClientData"},

1702  {
GrSídClõ¡D©aWøµî
, "GrSendClientData"},

1703  {
GrBñlWøµî
, "GrBell"},

1704  {
GrSëBackgroundPixm≠Wøµî
, "GrSetBackgroundPixmap"},

1705  {
GrDe°royCurs‹Wøµî
, "GrDestroyCursor"},

1706  {
GrQuîyTªeWøµî
, "GrQueryTree"},

1707  {
GrCª©eTimîWøµî
, "GrCreateTimer"},

1708  {
GrDe°royTimîWøµî
, "GrDestroyTimer"},

1709  {
GrSëP‹åaôModeWøµî
, "GrSetPortraitMode"},

1710  {
GrImageBuf„rAŒocWøµî
, "GrImageBufferAlloc"},

1711  {
GrImageBuf„rSídWøµî
, "GrImageBufferSend"},

1712  {
GrLﬂdImageFromBuf„rWøµî
, "GrLoadImageFromBuffer"},

1713  {
GrDøwImageFromBuf„rWøµî
, "GrDrawImageFromBuffer"},

1714  {
GrGëF⁄tLi°Wøµî
, "GrGetFontList"},

1715  {
GrSëGCClùOrigöWøµî
, "GrSetGCClipOrigin"},

1716  {
GrSëGCGøphicsExposuªWøµî
, "GrSetGCGraphicsExposure"},

1717  {
GrQuîyPoöãrWøµî
, "GrQueryPointer"},

1718  {
GrSëGCLöeAâribuãsWøµî
, "GretGCLineAttributes"},

1719  {
GrSëGCDashWøµî
, "GrSetGCDash"},

1720  {
GrSëGCFûlModeWøµî
, "GrSetGCFillMode"},

1721  {
GrSëGCStù∂eWøµî
, "GrSetGCStipple"},

1722  {
GrSëGCTSOff£tWøµî
, "GrSetGCTSOffset"},

1723  {
GrSëGCTûeWøµî
, "GrSetGCTile" },

1724  {
GrNewBôm≠Regi⁄Wøµî
, "GrNewBitmapRegion"},

1725  {
GrSëWödowRegi⁄Wøµî
, "GrSetWindowRegion"},

1726  {
GrSëGCF‹egroundPixñVÆWøµî
, "GrSetGCForegroundPixelVal"},

1727  {
GrSëGCBackgroundPixñVÆWøµî
, "GrSetGCBackgroundPixelVal"},

1728  {
GrCª©eLogF⁄tWøµî
, "GrCreateLogFont"},

1729  {
GrSåëchAªaWøµî
, "GrStretchArea"},

1730  {
GrGøbKeyWøµî
, "GrGrabKey" },

1731  {
GrSëTønsf‹mWøµî
, "GrSetTransform" },

1732  {
GrCª©eF⁄tFromBuf„rWøµî
, "GrCreateFontFromBuffer"},

1733  {
GrC›yF⁄tWøµî
, "GrCopyFont"},

1737 
	$GrShmCmdsFlushWøµî
(*
r
)

1739 
nxShmCmdsFlushReq
 *
ªq
 = 
r
;

1740 
ª∂y
;

1741 #i‡
HAVE_SHAREDMEM_SUPPORT


1742 
nxReq
 *
¥
;

1743 
Àngth
;

1744 *
do_ªq
, *
do_ªq_œ°
;

1746 i‡–
cuºít_shm_cmds
 =0 || 
cuºít_shm_cmds_size
 < 
ªq
->
size
 ) {

1748 
	`EPRINTF
("nano-X: Ill behaved clientássumes shm ok\n");

1749 i‡–
ªq
->
ª∂y
 ) {

1750 
ª∂y
 = 0;

1751 
	`GsWrôe
(
cuºít_fd
, &
ª∂y
, 1);

1756 
do_ªq
 = 
cuºít_shm_cmds
;

1757 
do_ªq_œ°
 = 
cuºít_shm_cmds
 + 
ªq
->
size
;

1759  
do_ªq
 < 
do_ªq_œ°
 ) {

1760 
¥
 = (
nxReq
 *)
do_ªq
;

1761 
Àngth
 = 
	`GëReqAlig√dLí
(
¥
);

1762 i‡–
¥
->
ªqTy≥
 < 
GrTŸÆNumCÆls
 ) {

1763 
GrFun˘i⁄s
[
¥
->
ªqTy≥
].
	`func
(pr);

1765 
	`EPRINTF
("nano-X: Error bad shm function!\n");

1767 
do_ªq
 +
Àngth
;

1770 i‡–
ªq
->
ª∂y
 ) {

1771 
ª∂y
 = 1;

1772 
	`GsWrôe
(
cuºít_fd
, &
ª∂y
, 1);

1776 i‡–
ªq
->
ª∂y
 ) {

1777 
ª∂y
 = 0;

1778 
	`GsWrôe
(
cuºít_fd
, &
ª∂y
, 1);

1781 
	}
}

1788 
	$GsO≥nSockë
()

1790 #i‡
ELKS


1791 
sockaddr_«
 
sckt
;

1792 #i‚de‡
SUN_LEN


1793 
	#SUN_LEN
(
±r
Ë((
sckt
))

	)

1795 #ñi‡
__ECOS


1796 
sockaddr_ö
 
sckt
;

1797 #i‚de‡
SUN_LEN


1798 
	#SUN_LEN
(
±r
Ë((
sckt
))

	)

1801 
sockaddr_un
 
sckt
;

1802 #i‚de‡
SUN_LEN


1803 
	#SUN_LEN
(
±r
Ë((
size_t
Ë(((
sockaddr_un
 *Ë0)->
sun_∑th
) \

1804 + 
	`°æí
 ((
±r
)->
sun_∑th
))

	)

1808 #i‡
ELKS


1809 if((
un_sock
 = 
	`sockë
(
AF_NANO
, 
SOCK_STREAM
, 0)) == -1)

1812 
sckt
.
sun_Ámûy
 = 
AF_NANO
;

1813 
sckt
.
sun_no
 = 
GR_NUMB_SOCKET
;

1814 #ñi‡
__ECOS


1816 if((
un_sock
 = 
	`sockë
(
AF_INET
, 
SOCK_STREAM
, 0)) == -1)

1820 
	`mem£t
–&
sckt
, '\0', (sckt) );

1821 
sckt
.
sö_Ámûy
 = 
AF_INET
;

1822 
sckt
.
sö_Àn
 = (sckt);

1823 
sckt
.
sö_p‹t
 = 
	`ht⁄s
(6600);

1824 
sckt
.
sö_addr
.
s_addr
 = 
INADDR_ANY
;

1826 i‡(
	`ac˚ss
(
GR_NAMED_SOCKET
, 
F_OK
) == 0) {

1828 if(
	`u∆ök
(
GR_NAMED_SOCKET
))

1833 if((
un_sock
 = 
	`sockë
(
AF_UNIX
, 
SOCK_STREAM
, 0)) == -1)

1837 
sckt
.
sun_Ámûy
 = 
AF_UNIX
;

1838 
	`°∫˝y
(
sckt
.
sun_∑th
, 
GR_NAMED_SOCKET
, (sckt.sun_path));

1840 if(
	`böd
(
un_sock
, (
sockaddr
 *Ë&
sckt
, 
	`SUN_LEN
(&sckt)) < 0)

1844 if(
	`li°í
(
un_sock
, 5) == -1)

1847 
	}
}

1850 
	$GsClo£Sockë
()

1852 if(
un_sock
 != -1)

1853 
	`˛o£
(
un_sock
);

1854 
un_sock
 = -1;

1855 
	`u∆ök
(
GR_NAMED_SOCKET
);

1856 
	}
}

1862 
	$GsAc˚±Clõ¡
()

1864 
i
;

1865 #i‡
ELKS


1866 
sockaddr_«
 
sckt
;

1867 #ñi‡
__ECOS


1868 
sockaddr_ö
 
sckt
;

1870 
sockaddr_un
 
sckt
;

1872 
sockÀn_t
 
size
 = (
sckt
);

1874 if((
i
 = 
	`ac˚±
(
un_sock
, (
sockaddr
 *Ë&
sckt
, &
size
)) == -1) {

1875 
	`EPRINTF
("«no-X: Eº‹ác˚± faûed (%d)\n", 
î∫o
);

1878 
	`GsAc˚±Clõ¡Fd
(
i
);

1879 
	}
}

1886 
GR_CLIENT
 *

1887 
	$GsFödClõ¡
(
fd
)

1889 
GR_CLIENT
 *
˛õ¡
;

1891 
˛õ¡
 = 
roŸ_˛õ¡
;

1893 
˛õ¡
) {

1894 if(
˛õ¡
->
id
 =
fd
)

1895 (
˛õ¡
);

1896 
˛õ¡
 = clõ¡->
√xt
;

1900 
	}
}

1908 
	$GsDe°royClõ¡Resour˚s
(
GR_CLIENT
 * 
˛õ¡
)

1910 
GR_WINDOW
 * 
wp
, *
nwp
;

1911 
GR_PIXMAP
 * 
µ
, *
≈p
;

1912 
GR_GC
 * 
gp
, *
ngp
;

1913 
GR_REGION
 * 
Ω
, *
ƒp
;

1914 
GR_FONT
 * 
Â
, *
nÂ
;

1915 
GR_CURSOR
 * 
˝
, *
n˝
;

1916 
GR_EVENT_CLIENT
 *
e˝
, *
√˝
;

1917 
GR_EVENT_CLIENT
 *
≥˝
 = 
NULL
;

1918 
GR_EVENT_LIST
 *
evp
;

1919 
GR_GRABBED_KEY
 *
kp
, *
nkp
;

1920 #i‡
MW_FEATURE_IMAGES


1921 
GR_IMAGE
 * 
ù
, *
nù
;

1923 #i‡
MW_FEATURE_TIMERS


1924 
GR_TIMER
 * 
ç
, *
¡p
;

1927 
	`DPRINTF
("De°roy clõ¡ %dÑesour˚s\n", 
˛õ¡
->
id
);

1929 
wp
=
li°wp
; wp; wp=
nwp
) {

1930 
nwp
 = 
wp
->
√xt
;

1934 
e˝
 = 
wp
->
evít˛õ¡s
;

1935 
e˝
) {

1936 
√˝
 = 
e˝
->
√xt
;

1937 i‡(
e˝
->
˛õ¡
 == client) {

1938 
	`DPRINTF
–" De°roy wödow %dÉvít˛õ¡ mask %08lx\n", 
wp
->
id
, 
e˝
->
evítmask
);

1939 i‡(
e˝
 =
wp
->
evít˛õ¡s
)

1940 
wp
->
evít˛õ¡s
 = 
e˝
->
√xt
;

1942 
≥˝
->
√xt
 = 
e˝
->next;

1943 
	`‰ì
(
e˝
);

1945 
≥˝
 = 
e˝
;

1946 
e˝
 = 
√˝
;

1948 i‡(
wp
->
ow√r
 =
˛õ¡
) {

1949 
	`DPRINTF
(" De°roy wödow %d\n", 
wp
->
id
);

1950 
	`GrDe°royWödow
(
wp
->
id
);

1955 
µ
=
li°µ
;Öp;Öp=
≈p
) {

1956 
≈p
 = 
µ
->
√xt
;

1957 i‡(
µ
->
ow√r
 =
˛õ¡
) {

1958 
	`DPRINTF
(" De°royÖixm≠ %d\n", 
µ
->
id
);

1959 
	`GrDe°royWödow
(
µ
->
id
);

1964 
gp
=
li°g˝
; gp; gp=
ngp
) {

1965 
ngp
 = 
gp
->
√xt
;

1966 i‡(
gp
->
ow√r
 =
˛õ¡
) {

1967 
	`DPRINTF
(" De°roy g¯%d\n", 
gp
->
id
);

1968 
	`GrDe°royGC
(
gp
->
id
);

1973 
Â
=
li°f⁄ç
; fp; fp=
nÂ
) {

1974 
nÂ
 = 
Â
->
√xt
;

1975 i‡(
Â
->
ow√r
 =
˛õ¡
) {

1976 
	`DPRINTF
(" De°roy f⁄à%d\n", 
Â
->
id
);

1977 
	`GrDe°royF⁄t
(
Â
->
id
);

1982 
Ω
=
li°ªgi⁄p
;Ñp;Ñp=
ƒp
) {

1983 
ƒp
 = 
Ω
->
√xt
;

1984 i‡(
Ω
->
ow√r
 =
˛õ¡
) {

1985 
	`DPRINTF
(" De°royÑegi⁄ %d\n", 
Ω
->
id
);

1986 
	`GrDe°royRegi⁄
(
Ω
->
id
);

1990 #i‡
MW_FEATURE_IMAGES


1992 
ù
=
li°imagï
; ip; ip=
nù
) {

1993 
nù
 = 
ù
->
√xt
;

1994 i‡(
ù
->
ow√r
 =
˛õ¡
) {

1995 
	`DPRINTF
(" De°roy imagê%d\n", 
ù
->
id
);

1996 
	`GrFªeImage
(
ù
->
id
);

2001 #i‡
MW_FEATURE_TIMERS


2003 
ç
=
li°_timî
;Åp;Åp=
¡p
) {

2004 
¡p
 = 
ç
->
√xt
;

2005 i‡(
ç
->
ow√r
 =
˛õ¡
) {

2006 
	`DPRINTF
(" De°royÅimî %d\n", 
ç
->
id
);

2007 
	`GrDe°royTimî
(
ç
->
id
);

2013 
˝
=
li°curs‹p
; cp; cp=
n˝
) {

2014 
n˝
 = 
˝
->
√xt
;

2015 i‡(
˝
->
ow√r
 =
˛õ¡
) {

2016 
	`DPRINTF
(" De°roy curs‹ %d\n", 
˝
->
id
);

2017 
	`GrDe°royCurs‹
(
˝
->
id
);

2022 
kp
=
li°_gøbbed_keys
; kp; k∞
nkp
) {

2023 
nkp
 = 
kp
->
√xt
;

2024 i‡(
kp
->
ow√r
 =
cur˛õ¡
) {

2025 
	`DPRINTF
(" De°roy gøbkey %d,%d\n", 
kp
->
wid
, kp->
key
);

2026 
	`GrUngøbKey
(
kp
->
wid
, kp->
key
);

2031 
evp
 = 
˛õ¡
->
evíthód
;

2032 
evp
) {

2033 
	`DPRINTF
(" De°royÉvíà%d\n", 
evp
->
evít
.
ty≥
);

2034 
˛õ¡
->
evíthód
 = 
evp
->
√xt
;

2035 
evp
->
√xt
 = 
evít‰ì
;

2036 
evít‰ì
 = 
evp
;

2037 
evp
 = 
˛õ¡
->
evíthód
;

2039 
	}
}

2045 
	$GsPrötResour˚s
()

2047 
GR_WINDOW
 *
wp
;

2048 
GR_PIXMAP
 *
µ
;

2049 
GR_GC
 *
gp
;

2050 
GR_REGION
 *
Ω
;

2051 
GR_FONT
 *
Â
;

2052 #i‡
MW_FEATURE_IMAGES


2053 
GR_IMAGE
 *
ù
;

2055 #i‡
MW_FEATURE_TIMERS


2056 
GR_TIMER
 *
ç
;

2060 
	`DPRINTF
("WindowÜist:\n");

2061 
wp
=
li°wp
; wp; wp=wp->
√xt
) {

2062 
	`DPRINTF
("%d(%d),", 
wp
->
id
, wp->
ow√r
? wp->owner->id: 0);

2064 
	`DPRINTF
("\nPixmapÜist:\n");

2065 
µ
=
li°µ
;Öp;Öpıp->
√xt
) {

2066 
	`DPRINTF
("%d(%d),", 
µ
->
id
,Öp->
ow√r
->id);

2068 
	`DPRINTF
("\nGCÜist:\n");

2069 
gp
=
li°g˝
; gp; gp=gp->
√xt
) {

2070 
	`DPRINTF
("%d(%d),", 
gp
->
id
, gp->
ow√r
->id);

2072 
	`DPRINTF
("\nFontÜist:\n");

2073 
Â
=
li°f⁄ç
; fp; fp=Â->
√xt
) {

2074 
	`DPRINTF
("%d(%d),", 
Â
->
id
, fp->
ow√r
->id);

2076 
	`DPRINTF
("\nRegionÜist:\n");

2077 
Ω
=
li°ªgi⁄p
;Ñp;ÑpÙp->
√xt
) {

2078 
	`DPRINTF
("%d(%d),", 
Ω
->
id
,Ñp->
ow√r
->id);

2080 #i‡
MW_FEATURE_IMAGES


2081 
	`DPRINTF
("\nImageÜist:\n");

2082 
ù
=
li°imagï
; ip; ip=ù->
√xt
) {

2083 
	`DPRINTF
("%d(%d),", 
ù
->
id
, ip->
ow√r
->id);

2086 #i‡
MW_FEATURE_TIMERS


2087 
	`DPRINTF
("\nTimerÜist:\n");

2088 
ç
=
li°_timî
;Åp;ÅpÒp->
√xt
) {

2089 
	`DPRINTF
("%d(%d),", 
ç
->
id
,Åp->
ow√r
->id);

2092 
	`DPRINTF
("\n");

2093 
	}
}

2100 
	$GsDr›Clõ¡
(
fd
)

2102 
GR_CLIENT
 *
˛õ¡
;

2104 if((
˛õ¡
 = 
	`GsFödClõ¡
(
fd
))) {

2105 
	`˛o£
(
fd
);

2107 
	`GsDe°royClõ¡Resour˚s
(
˛õ¡
);

2108 if(
˛õ¡
 =
roŸ_˛õ¡
)

2109 
roŸ_˛õ¡
 = 
˛õ¡
->
√xt
;

2111 if(
˛õ¡
->
¥ev
Ë˛õ¡->¥ev->
√xt
 = client->next;

2114 if(
˛õ¡
->
√xt
Ë˛õ¡->√xt->
¥ev
 = client->prev;

2116 #i‡
HAVE_SHAREDMEM_SUPPORT


2117 i‡–
˛õ¡
->
shm_cmds
 != 0 ) {

2119 
	`shm˘l
(
˛õ¡
->
shm_cmds_shmid
,
IPC_RMID
,0);

2120 
	`shmdt
(
˛õ¡
->
shm_cmds
);

2123 
	`GsPrötResour˚s
();

2124 
	`‰ì
(
˛õ¡
);

2126 
˛ùwp
 = 
NULL
;

2127 --
c⁄√˘cou¡
;

2128 } 
	`EPRINTF
("«no-X:ÅryögÅÿdr›Ç⁄-exi°íà˛õ¡ %d.\n", 
fd
);

2129 
	}
}

2136 #i‡
ELKS


2137 
	$GsRód
(
fd
, *
buf
, 
c
)

2139 
	$GsRód
(
fd
, *
buf
, 
c
)

2142 
e
, 
n
;

2144 
n
 = 0;

2146 
n
 < 
c
) {

2147 
e
 = 
	`ªad
(
fd
, ((*)
buf
Ë+ 
n
, 
c
 -Ç);

2148 if(
e
 <= 0) {

2149 i‡(
e
 == 0)

2150 
	`EPRINTF
("«no-X: clõ¡ clo£d sockë: %d\n", 
fd
);

2151 
	`EPRINTF
("nano-X: GsRead failed %d %d: %d\r\n",

2152 
e
, 
n
, 
î∫o
);

2153 
	`GsClo£
(
fd
);

2156 
n
 +
e
;

2160 
	}
}

2165 
	$GsWrôe
(
fd
, *
buf
, 
c
)

2167 
e
, 
n
;

2169 
n
 = 0;

2171 
n
 < 
c
) {

2172 
e
 = 
	`wrôe
(
fd
, ((*Ë
buf
 + 
n
), (
c
 -Ç));

2173 if(
e
 <= 0) {

2174 
	`GsClo£
(
fd
);

2177 
n
 +
e
;

2181 
	}
}

2183 
	$GsWrôeTy≥
(
fd
, 
ty≥
)

2185  
	`GsWrôe
(
fd
,&
ty≥
,(type));

2186 
	}
}

2194 
	$GsH™dÀClõ¡
(
fd
)

2196 
nxReq
 * 
ªq
;

2197 
Àn
;

2198 
buf
[
MAXREQUESTSZ
];

2200 
cuºít_fd
 = 
fd
;

2201 #i‡
HAVE_SHAREDMEM_SUPPORT


2202 
cuºít_shm_cmds
 = 
cur˛õ¡
->
shm_cmds
;

2203 
cuºít_shm_cmds_size
 = 
cur˛õ¡
->
shm_cmds_size
;

2206 if(
	`GsRód
(
fd
, 
buf
, (
nxReq
)))

2209 
Àn
 = 
	`GëReqAlig√dLí
((
nxReq
 *)&
buf
[0]);

2210 if(
Àn
 > (
nxReq
)) {

2211 if(
Àn
 > 
MAXREQUESTSZ
) {

2212 
	`EPRINTF
("nano-X: GsHandleClientÑequestÅooÜarge: %ld > %d\n",

2213 
Àn
, 
MAXREQUESTSZ
);

2214 
	`exô
(1);

2217 if(
	`GsRód
(
fd
, &
buf
[(
nxReq
)], 
Àn
-(nxReq)))

2220 
ªq
 = (
nxReq
 *)&
buf
[0];

2222 if(
ªq
->
ªqTy≥
 < 
GrTŸÆNumCÆls
) {

2223 
curfunc
 = 
GrFun˘i⁄s
[
ªq
->
ªqTy≥
].
«me
;

2225 
GrFun˘i⁄s
[
ªq
->
ªqTy≥
].
	`func
(req);

2227 
	`EPRINTF
("nano-X: GsHandleClient bad function\n");

2229 
	}
}

	@nanox/srvutil.c

10 
	~<°dio.h
>

11 
	~<°dlib.h
>

13 #i‚de‡
__PACIFIC__


14 
	~<f˙é.h
>

17 
	~"£rv.h
"

23 
	$GsRedøwS¸ìn
()

26 
	`GsExpo£Aªa
(
roŸwp
, 0, 0,ÑoŸwp->
width
,ÑoŸwp->
height
, 
NULL
);

27 
	}
}

33 
	$GsA˘iv©eS¸ìnSavî
(*
¨g
)

35 
s¸ìnßvî_a˘ive
 = 
GR_TRUE
;

36 
	`GsDñivîS¸ìnSavîEvít
(
GR_TRUE
);

37 
	}
}

43 
	$GsRe£tS¸ìnSavî
()

45 #i‡
MW_FEATURE_TIMERS


46 
MWTIMER
 *
timî
;

49 if(
s¸ìnßvî_a˘ive
 =
GR_TRUE
) {

50 
s¸ìnßvî_a˘ive
 = 
GR_FALSE
;

51 
	`GsDñivîS¸ìnSavîEvít
(
GR_FALSE
);

53 #i‡
MW_FEATURE_TIMERS


54 if(
s¸ìnßvî_dñay
) {

55 if((
timî
 = 
	`GdFödTimî
(
GsA˘iv©eS¸ìnSavî
)))

56 
	`GdDe°royTimî
(
timî
);

57 
	`GdAddTimî
(
s¸ìnßvî_dñay
, 
GsA˘iv©eS¸ìnSavî
,

58 
GsA˘iv©eS¸ìnSavî
);

61 
	}
}

63 #i‡
MW_FEATURE_TIMERS


65 
	$GsTimîCB
 (*
¨g
)

67 
GR_TIMER
 *
timî
 = (GR_TIMER*Ë
¨g
;

69 
	`GsDñivîTimîEvít
 (
timî
->
ow√r
,Åimî->
wid
,Åimî->
id
);

70 
	}
}

82 
	$GsWpUƒólizeWödow
(
GR_WINDOW
 *
wp
, 
GR_BOOL
 
ãmp_unm≠
)

84 
GR_WINDOW
 *
pwp
;

85 
GR_WINDOW
 *
sibwp
;

86 
GR_WINDOW
 *
chûdwp
;

87 
GR_SIZE
 
bs
;

89 i‡(
wp
 =
roŸwp
) {

90 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wp
->
id
);

94 i‡(
wp
 =
˛ùwp
)

95 
˛ùwp
 = 
NULL
;

98 i‡(!
wp
->
ªÆized
)

102 
wp
->
ªÆized
 = 
GR_FALSE
;

104 
chûdwp
 = 
wp
->
chûdªn
; chûdwp; chûdw∞chûdwp->
siblögs
)

105 
	`GsWpUƒólizeWödow
(
chûdwp
, 
ãmp_unm≠
);

107 i‡(!
ãmp_unm≠
 && 
wp
 =
mou£wp
) {

108 
	`GsCheckMou£Wödow
();

109 
	`GsCheckCurs‹
();

112 i‡(!
ãmp_unm≠
 && 
wp
 =
focuswp
) {

113 i‡(
focusfixed
)

115 
focuswp
 = 
roŸwp
;

117 
focusfixed
 = 
GR_FALSE
;

118 
	`GsCheckFocusWödow
();

123 
	`GsDñivîUpd©eEvít
(
wp
,

124 (
ãmp_unm≠
? 
GR_UPDATE_UNMAPTEMP
: 
GR_UPDATE_UNMAP
), 0, 0, 0, 0);

130 i‡(!
wp
->
∑ª¡
->
ªÆized
 || !wp->
ouçut
)

137 
bs
 = 
wp
->
b‹dîsize
;

138 
pwp
 = 
wp
->
∑ª¡
;

139 
	`GsWpCÀ¨Wödow
(
pwp
, 
wp
->
x
 -Öwp->x - 
bs
, wp->
y
 -Öwp->y - bs,

140 
wp
->
width
 + 
bs
 * 2, wp->
height
 + b†* 2, 
GR_TRUE
);

146 
sibwp
 = 
wp
;

147 
sibwp
->
siblögs
) {

148 
sibwp
 = sibwp->
siblögs
;

149 
	`GsExpo£Aªa
(
sibwp
, 
wp
->
x
 - 
bs
, wp->
y
 - bs,

150 
wp
->
width
 + 
bs
 * 2, wp->
height
 + b†* 2, 
NULL
);

152 
	}
}

162 
	$GsWpRólizeWödow
(
GR_WINDOW
 *
wp
, 
GR_BOOL
 
ãmp
)

164 i‡(
wp
 =
roŸwp
) {

165 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wp
->
id
);

171 
	#OLDWAY
 0

	)

172 #i‡
OLDWAY


178 i‡(
wp
->
ªÆized
 || !wp->
m≠≥d
 || !wp->
∑ª¡
->realized)

183 i‡(
wp
->
ªÆized
)

190 i‡(!
ãmp
) {

191 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_MAP
, wp->
x
, wp->
y
,

192 
wp
->
width
, wp->
height
);

199 i‡(!
wp
->
m≠≥d
 || !wp->
∑ª¡
->
ªÆized
)

204 
wp
->
ªÆized
 = 
GR_TRUE
;

206 i‡(!
ãmp
) {

207 
	`GsCheckMou£Wödow
();

208 
	`GsCheckFocusWödow
();

209 
	`GsCheckCurs‹
();

212 #i‡
OLDWAY


214 i‡(!
ãmp
) {

215 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_MAP
, wp->
x
, wp->
y
,

216 
wp
->
width
, wp->
height
);

223 i‡(
wp
->
ouçut
) {

224 
	`GsDøwB‹dî
(
wp
);

225 
	`GsWpCÀ¨Wödow
(
wp
, 0, 0, wp->
width
, wp->
height
, 
GR_TRUE
);

231 
wp
 = wp->
chûdªn
; wp; w∞wp->
siblögs
)

232 
	`GsWpRólizeWödow
(
wp
, 
ãmp
);

233 
	}
}

240 
	$GsWpDe°royWödow
(
GR_WINDOW
 *
wp
)

242 
GR_WINDOW
 *
¥evwp
;

243 
GR_EVENT_CLIENT
 *
e˝
;

244 
GR_WINDOW_ID
 
ﬁdwid
;

245 
GR_GRABBED_KEY
 *
keygøb
;

246 
GR_GRABBED_KEY
 **
keygøb_¥ev_√xt
;

248 i‡(
wp
 =
roŸwp
) {

249 
	`GsEº‹
(
GR_ERROR_ILLEGAL_ON_ROOT_WINDOW
, 
wp
->
id
);

254 if(
£À˘i⁄_ow√r
.
wid
 =
wp
->
id
) {

255 
ﬁdwid
 = 
£À˘i⁄_ow√r
.
wid
;

256 
£À˘i⁄_ow√r
.
wid
 = 0;

257 if(
£À˘i⁄_ow√r
.
ty≥li°
)

258 
	`‰ì
(
£À˘i⁄_ow√r
.
ty≥li°
);

259 
	`GsDñivîSñe˘i⁄Ch™gedEvít
(
ﬁdwid
, 0);

265 i‡(
wp
->
ªÆized
)

266 
	`GsWpUƒólizeWödow
(
wp
, 
GR_FALSE
);

269 
	`GsDñivîUpd©eEvít
(
wp
, 
GR_UPDATE_DESTROY
, wp->
x
, wp->
y
,

270 
wp
->
width
, wp->
height
);

275 
wp
->
chûdªn
)

276 
	`GsWpDe°royWödow
(
wp
->
chûdªn
);

281 
wp
->
evít˛õ¡s
) {

282 
e˝
 = 
wp
->
evít˛õ¡s
;

283 
wp
->
evít˛õ¡s
 = 
e˝
->
√xt
;

284 
	`‰ì
(
e˝
);

290 
¥evwp
 = 
wp
->
∑ª¡
->
chûdªn
;

291 i‡(
¥evwp
 =
wp
)

292 
wp
->
∑ª¡
->
chûdªn
 = wp->
siblögs
;

294 
¥evwp
->
siblögs
 !
wp
)

295 
¥evwp
 =Öªvwp->
siblögs
;

296 
¥evwp
->
siblögs
 = 
wp
->siblings;

298 
wp
->
siblögs
 = 
NULL
;

303 
¥evwp
 = 
li°wp
;

304 i‡(
¥evwp
 =
wp
)

305 
li°wp
 = 
wp
->
√xt
;

307 
¥evwp
->
√xt
 !
wp
)

308 
¥evwp
 =Öªvwp->
√xt
;

309 
¥evwp
->
√xt
 = 
wp
->next;

311 
wp
->
√xt
 = 
NULL
;

317 i‡(
wp
 =
˛ùwp
)

318 
˛ùwp
 = 
NULL
;

319 i‡(
wp
 =
gøbbuâ⁄wp
)

320 
gøbbuâ⁄wp
 = 
NULL
;

321 i‡(
wp
 =
ˇchewp
) {

322 
ˇchewödowid
 = 0;

323 
ˇchewp
 = 
NULL
;

325 i‡(
wp
 =
focuswp
) {

328 
focuswp
 = 
roŸwp
;

331 
	`GsCheckMou£Wödow
();

333 if(
wp
->
tôÀ
)

334 
	`‰ì
(
wp
->
tôÀ
);

335 i‡(
wp
->
˛ùªgi⁄
)

336 
	`GdDe°royRegi⁄
(
wp
->
˛ùªgi⁄
);

339 
keygøb_¥ev_√xt
 = &
li°_gøbbed_keys
;

340 
keygøb
 = 
li°_gøbbed_keys
;

341 
keygøb
 !
NULL
) {

342 i‡(
keygøb
->
wid
 =
wp
->
id
){

344 *
keygøb_¥ev_√xt
 = 
keygøb
->
√xt
;

345 
	`‰ì
(
keygøb
);

346 
keygøb
 = *
keygøb_¥ev_√xt
;

348 
keygøb_¥ev_√xt
 = &
keygøb
->
√xt
;

349 
keygøb
 = keygøb->
√xt
;

353 
	`‰ì
(
wp
);

354 
	}
}

369 
	$GsWpDøwBackgroundPixm≠
(
GR_WINDOW
 *
wp
, 
GR_PIXMAP
 *
pm
, 
GR_COORD
 
x
,

370 
GR_COORD
 
y
, 
GR_SIZE
 
width
, GR_SIZE 
height
)

372 
GR_SIZE
 
de°width
, 
de°height
, 
fûlwidth
, 
fûlheight
, 
pmwidth
, 
pmheight
;

373 
GR_COORD
 
‰omx
, 
‰omy
, 
de°x
, 
de°y
, 
pixm≠x
 = 0, 
pixm≠y
 = 0;

375 if(
wp
->
bgpixm≠Êags
 & (
GR_BACKGROUND_TOPLEFT
|
GR_BACKGROUND_STRETCH
)) {

376 
pixm≠x
 = 0;

377 
pixm≠y
 = 0;

378 } if(
wp
->
bgpixm≠Êags
 & 
GR_BACKGROUND_CENTER
) {

379 if(
pm
->
width
 >
wp
->widthË
pixm≠x
 = 0;

380 
pixm≠x
 = (
wp
->
width
 - 
pm
->width) / 2;

381 if(
pm
->
height
 >
wp
->heightË
pixm≠y
 = 0;

382 
pixm≠y
 = (
wp
->
height
 - 
pm
->height) / 2;

385 
	`GsWpTûeBackgroundPixm≠
(
wp
, 
pm
, 
x
, 
y
, 
width
, 
height
);

389 if(
pm
->
width
 > 
wp
->widthË
pmwidth
 = wp->width;

390 
pmwidth
 = 
pm
->
width
;

391 if(
pm
->
height
 > 
wp
->heightË
pmheight
 = wp->height;

392 
pmheight
 = 
pm
->
height
;

394 if(
x
 > 
pixm≠x
) {

395 
de°x
 = 
x
;

396 
‰omx
 = 
x
 - 
pixm≠x
;

397 
de°width
 = 
pixm≠x
 + 
pmwidth
 - 
x
;

399 
de°x
 = 
pixm≠x
;

400 
‰omx
 = 0;

401 
de°width
 = 
x
 + 
width
 - 
pixm≠x
;

404 if(
y
 > 
pixm≠y
) {

405 
de°y
 = 
y
;

406 
‰omy
 = 
y
 - 
pixm≠y
;

407 
de°height
 = 
pixm≠y
 + 
pmheight
 - 
de°y
;

409 
de°y
 = 
pixm≠y
;

410 
‰omy
 = 0;

411 
de°height
 = 
y
 + 
height
 - 
pixm≠y
;

414 if(
de°width
 > 0 && 
de°height
 > 0) {

415 i‡(
wp
->
bgpixm≠Êags
 & 
GR_BACKGROUND_STRETCH
) {

416 
	`GdSåëchBlô
(
wp
->
psd
, 
de°x
 + wp->
x
, 
de°y
 + wp->
y
,

417 
de°width
, 
de°height
, 
pm
->
psd
, 
‰omx
, 
‰omy
,

418 
pm
->
width
,Öm->
height
, 
MWROP_COPY
);

419 } 
	`GdBlô
(
wp
->
psd
, 
de°x
 + wp->
x
, 
de°y
 + wp->
y
, 
de°width
,

420 
de°height
, 
pm
->
psd
, 
‰omx
, 
‰omy
, 
MWROP_COPY
);

423 if(
wp
->
bgpixm≠Êags
 & (
GR_BACKGROUND_TRANS
|
GR_BACKGROUND_STRETCH
))

427 if(
x
 < 
pixm≠x
) {

428 
fûlwidth
 = 
pixm≠x
 - 
x
;

429 if(
fûlwidth
 > 
width
) fillwidth = width;

430 
fûlheight
 = 
height
;

431 
	`GdFûlRe˘
(
wp
->
psd
, wp->
x
 + x, wp->
y
 + y, 
fûlwidth
,
fûlheight
);

433 if((
x
 + 
width
Ë> (
pixm≠x
 + 
pmwidth
)) {

434 
fûlwidth
 = (
x
 + 
width
Ë- (
pixm≠x
 + 
pmwidth
);

435 if(
fûlwidth
 > 
width
) fillwidth = width;

436 
fûlheight
 = 
height
;

437 if(
x
 < (
pixm≠x
 + 
pmwidth
)Ë
de°x
 =Öixm≠x +Ömwidth + 
wp
->x;

438 
de°x
 = 
x
 + 
wp
->x;

439 
	`GdFûlRe˘
(
wp
->
psd
, 
de°x
, wp->
y
 + y, 
fûlwidth
, 
fûlheight
);

441 if(
y
 < 
pixm≠y
) {

442 
fûlheight
 = 
pixm≠y
 - 
y
;

443 if(
fûlheight
 > 
height
) fillheight = height;

444 if(
x
 < 
pixm≠x
Ë
de°x
 =Öixm≠x + 
wp
->x;

445 
de°x
 = 
x
 + 
wp
->x;

446 if((
x
 + 
width
Ë> (
pixm≠x
 + 
pmwidth
))

447 
fûlwidth
 = 
pixm≠x
 + 
pmwidth
 - 
de°x
;

448 
fûlwidth
 = 
x
 + 
width
 - 
de°x
;

449 if((
fûlwidth
 > 0Ë&& (
fûlheight
 > 0)) {

450 
	`GdFûlRe˘
(
wp
->
psd
, 
de°x
, wp->
y
 + y, 
fûlwidth
,

451 
fûlheight
);

454 if((
y
 + 
height
Ë> (
pixm≠y
 + 
pmheight
)) {

455 
fûlheight
 = (
y
 + 
height
Ë- (
pixm≠y
 + 
pmheight
);

456 if(
fûlheight
 > 
height
) fillheight = height;

457 if(
x
 < 
pixm≠x
Ë
de°x
 =Öixm≠x + 
wp
->x;

458 
de°x
 = 
x
 + 
wp
->x;

459 if(
y
 < (
pixm≠y
 + 
pmheight
)Ë
de°y
 =Öixm≠y +Ömheighà+ 
wp
->y;

460 
de°y
 = 
y
 + 
wp
->y;

462 if((
x
 + 
width
Ë> (
pixm≠x
 + 
pmwidth
))

463 
fûlwidth
 = 
pixm≠x
 + 
pmwidth
 - 
de°x
;

464 
fûlwidth
 = 
x
 + 
width
 - 
de°x
;

465 if((
fûlwidth
 > 0Ë&& (
fûlheight
 > 0)) {

466 
	`GdFûlRe˘
(
wp
->
psd
, 
de°x
, 
de°y
, 
fûlwidth
,
fûlheight
);

469 
	}
}

475 
	$GsWpTûeBackgroundPixm≠
(
GR_WINDOW
 *
wp
, 
GR_PIXMAP
 *
pm
, 
GR_COORD
 
x
, GR_COORD 
y
,

476 
GR_SIZE
 
width
, GR_SIZE 
height
)

478 
GR_COORD
 
tûex
 = 0, 
tûey
 = 0, 
‰omx
, 
‰omy
, 
cx
, 
cy
;

479 
GR_SIZE
 
de°width
, 
de°height
, 
pmwidth
, 
pmheight
, 
cwidth
, 
cheight
;

481 if(
pm
->
width
 > 
wp
->widthË
pmwidth
 = wp->width;

482 
pmwidth
 = 
pm
->
width
;

483 if(
pm
->
height
 > 
wp
->heightË
pmheight
 = wp->height;

484 
pmheight
 = 
pm
->
height
;

486 ;
tûey
 < 
wp
->
height
;Åûey +
pmheight
, 
tûex
 = 0) {

487 if(
tûey
 > (
y
 + 
height
)) ;

488 if(
y
 > (
tûey
 + 
pmheight
)) ;

489 if((
tûey
 + 
pmheight
Ë> 
wp
->
height
)

490 
de°height
 = 
wp
->
height
 - 
tûey
;

491 
de°height
 = 
pmheight
;

492 ;
tûex
 < 
wp
->
width
;Åûex +
pmwidth
) {

493 if(
tûex
 > (
x
 + 
width
)) ;

494 if(
x
 > (
tûex
 + 
pmwidth
)) ;

495 if((
tûex
 + 
pmwidth
Ë> 
wp
->
width
)

496 
de°width
 = 
wp
->
width
 - 
tûex
;

497 
de°width
 = 
pmwidth
;

499 if((
tûex
 >
x
Ë&& (—ûex + 
de°width
)<=(x + 
width
))) {

500 
‰omx
 = 0;

501 
cx
 = 
tûex
 + 
wp
->
x
;

502 
cwidth
 = 
de°width
;

504 if(
x
 > 
tûex
) {

505 
‰omx
 = 
x
 - 
tûex
;

506 
cwidth
 = 
de°width
 - 
‰omx
;

508 
‰omx
 = 0;

509 
cwidth
 = 
x
 + 
width
 - 
tûex
;

511 if(
cwidth
 > 
width
) cwidth = width;

512 if(
cwidth
 > 
de°width
) cwidth = destwidth;

513 
cx
 = 
wp
->
x
 + 
tûex
 + 
‰omx
;

516 if((
tûey
 >
y
)&&(—ûey + 
de°height
)<=(y + 
height
))) {

517 
‰omy
 = 0;

518 
cy
 = 
tûey
 + 
wp
->
y
;

519 
cheight
 = 
de°height
;

521 if(
y
 > 
tûey
) {

522 
‰omy
 = 
y
 - 
tûey
;

523 
cheight
 = 
de°height
 - 
‰omy
;

525 
‰omy
 = 0;

526 
cheight
 = 
y
 + 
height
 - 
tûey
;

528 if(
cwidth
 > 
width
) cwidth = width;

529 if(
cheight
 > 
de°height
) cheight = destheight;

530 
cy
 = 
wp
->
y
 + 
tûey
 + 
‰omy
;

533 if((
cwidth
 > 0Ë&& (
cheight
 > 0)) {

534 
	`GdBlô
(
wp
->
psd
, 
cx
, 
cy
, 
cwidth
, 
cheight
,

535 
pm
->
psd
, 
‰omx
, 
‰omy
, 
MWROP_COPY
);

539 
	}
}

548 
	$GsWpCÀ¨Wödow
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
x
, GR_COORD 
y
, 
GR_SIZE
 
width
,

549 
GR_SIZE
 
height
, 
GR_BOOL
 
expo£Êag
)

551 i‡(!
wp
->
ªÆized
 || !wp->
ouçut
)

556 i‡(
x
 < 0) {

557 
width
 +
x
;

558 
x
 = 0;

560 i‡(
y
 < 0) {

561 
height
 +
y
;

562 
y
 = 0;

564 i‡(
x
 + 
width
 > 
wp
->width)

565 
width
 = 
wp
->width - 
x
;

566 i‡(
y
 + 
height
 > 
wp
->height)

567 
height
 = 
wp
->heighà- 
y
;

573 i‡((
x
 >
wp
->
width
Ë|| (
y
 >wp->
height
) || (width <= 0) ||

574 (
height
 <= 0))

582 
	`GsSëClùWödow
(
wp
, 
NULL
, 0);

583 
curg˝
 = 
NULL
;

585 
	`GdSëFûlMode
(
GR_FILL_SOLID
);

587 i‡(!(
wp
->
¥›s
 & 
GR_WM_PROPS_NOBACKGROUND
)) {

588 
	`GdSëMode
(
GR_MODE_COPY
);

589 
	`GdSëF‹egroundCﬁ‹
(
wp
->
psd
, wp->
background
);

590 i‡(
wp
->
bgpixm≠
) {

591 
	`GsWpDøwBackgroundPixm≠
(
wp
, wp->
bgpixm≠
, 
x
, 
y
,

592 
width
, 
height
);

594 
	`GdFûlRe˘
(
wp
->
psd
, wp->
x
 + x, wp->
y
 + y, 
width
,
height
);

601 i‡(
expo£Êag
)

602 
	`GsDñivîExposuªEvít
(
wp
, 
x
, 
y
, 
width
, 
height
);

603 
	}
}

612 
	$GsExpo£Aªa
(
GR_WINDOW
 *
wp
, 
GR_COORD
 
roŸx
, GR_COORD 
roŸy
, 
GR_SIZE
 
width
,

613 
GR_SIZE
 
height
, 
GR_WINDOW
 *
°›wp
)

615 i‡(!
wp
->
ªÆized
 || w∞=
°›wp
 || !wp->
ouçut
)

622 i‡((
roŸx
 >
wp
->
x
 + wp->
width
 + wp->
b‹dîsize
) ||

623 (
roŸy
 >
wp
->
y
 + wp->
height
 + wp->
b‹dîsize
) ||

624 (
roŸx
 + 
width
 <
wp
->
x
 - wp->
b‹dîsize
) ||

625 (
roŸy
 + 
height
 <
wp
->
y
 - wp->
b‹dîsize
))

632 i‡((
roŸx
 < 
wp
->
x
Ë|| (
roŸy
 < wp->
y
) ||

633 (
roŸx
 + 
width
 > 
wp
->
x
 + wp->width) ||

634 (
roŸy
 + 
height
 > 
wp
->
y
 + wp->height))

635 
	`GsDøwB‹dî
(
wp
);

641 
	`GsWpCÀ¨Wödow
(
wp
, 
roŸx
 - wp->
x
, 
roŸy
 - wp->
y
,

642 
width
, 
height
, 
GR_TRUE
);

647 
wp
 = wp->
chûdªn
; wp; w∞wp->
siblögs
)

648 
	`GsExpo£Aªa
(
wp
, 
roŸx
, 
roŸy
, 
width
, 
height
, 
°›wp
);

649 
	}
}

657 
	$GsDøwB‹dî
(
GR_WINDOW
 *
wp
)

659 
GR_COORD
 
lmöx
;

660 
GR_COORD
 
rmöx
;

661 
GR_COORD
 
tmöy
;

662 
GR_COORD
 
bmöy
;

663 
GR_COORD
 
t›y
;

664 
GR_COORD
 
bŸy
;

665 
GR_SIZE
 
width
;

666 
GR_SIZE
 
height
;

667 
GR_SIZE
 
bs
;

669 
bs
 = 
wp
->
b‹dîsize
;

670 i‡(
bs
 <= 0)

673 
width
 = 
wp
->width;

674 
height
 = 
wp
->height;

675 
lmöx
 = 
wp
->
x
 - 
bs
;

676 
rmöx
 = 
wp
->
x
 + 
width
;

677 
tmöy
 = 
wp
->
y
 - 
bs
;

678 
bmöy
 = 
wp
->
y
 + 
height
;

679 
t›y
 = 
wp
->
y
;

680 
bŸy
 = 
bmöy
 - 1;

682 
wp
->
x
 -
bs
;

683 
wp
->
y
 -
bs
;

684 
wp
->
width
 +(
bs
 * 2);

685 
wp
->
height
 +(
bs
 * 2);

686 
wp
->
b‹dîsize
 = 0;

688 
˛ùwp
 = 
NULL
;

690 
	`GsSëClùWödow
(
wp
, 
NULL
, 0);

691 
curg˝
 = 
NULL
;

692 
	`GdSëMode
(
GR_MODE_COPY
);

693 
	`GdSëF‹egroundCﬁ‹
(
wp
->
psd
, wp->
b‹dîcﬁ‹
);

694 
	`GdSëDash
(0, 0);

695 
	`GdSëFûlMode
(
GR_FILL_SOLID
);

697 i‡(
bs
 == 1) {

698 
	`GdLöe
(
wp
->
psd
, 
lmöx
, 
tmöy
, 
rmöx
,Åmöy, 
TRUE
);

699 
	`GdLöe
(
wp
->
psd
, 
lmöx
, 
bmöy
, 
rmöx
, bmöy, 
TRUE
);

700 
	`GdLöe
(
wp
->
psd
, 
lmöx
, 
t›y
,Ümöx, 
bŸy
, 
TRUE
);

701 
	`GdLöe
(
wp
->
psd
, 
rmöx
, 
t›y
,Ñmöx, 
bŸy
, 
TRUE
);

703 
	`GdFûlRe˘
(
wp
->
psd
, 
lmöx
, 
tmöy
, 
width
 + 
bs
 * 2, bs);

704 
	`GdFûlRe˘
(
wp
->
psd
, 
lmöx
, 
bmöy
, 
width
 + 
bs
 * 2, bs);

705 
	`GdFûlRe˘
(
wp
->
psd
, 
lmöx
, 
t›y
, 
bs
, 
height
);

706 
	`GdFûlRe˘
(
wp
->
psd
, 
rmöx
, 
t›y
, 
bs
, 
height
);

713 
wp
->
x
 +
bs
;

714 
wp
->
y
 +
bs
;

715 
wp
->
width
 -(
bs
 * 2);

716 
wp
->
height
 -(
bs
 * 2);

717 
wp
->
b‹dîsize
 = 
bs
;

718 
˛ùwp
 = 
NULL
;

719 
	}
}

724 
GR_BOOL


725 
	$GsCheckOvîœp
(
GR_WINDOW
 *
t›wp
, GR_WINDOW *
bŸwp
)

727 
GR_COORD
 
möx1
;

728 
GR_COORD
 
möy1
;

729 
GR_COORD
 
maxx1
;

730 
GR_COORD
 
maxy1
;

731 
GR_COORD
 
möx2
;

732 
GR_COORD
 
möy2
;

733 
GR_COORD
 
maxx2
;

734 
GR_COORD
 
maxy2
;

735 
GR_SIZE
 
bs
;

737 i‡(!
t›wp
->
ouçut
 || !t›wp->
ªÆized
 || !
bŸwp
->realized)

738  
GR_FALSE
;

740 
bs
 = 
t›wp
->
b‹dîsize
;

741 
möx1
 = 
t›wp
->
x
 - 
bs
;

742 
möy1
 = 
t›wp
->
y
 - 
bs
;

743 
maxx1
 = 
t›wp
->
x
 +Å›wp->
width
 + 
bs
 - 1;

744 
maxy1
 = 
t›wp
->
y
 +Å›wp->
height
 + 
bs
 - 1;

746 
bs
 = 
bŸwp
->
b‹dîsize
;

747 
möx2
 = 
bŸwp
->
x
 - 
bs
;

748 
möy2
 = 
bŸwp
->
y
 - 
bs
;

749 
maxx2
 = 
bŸwp
->
x
 + bŸwp->
width
 + 
bs
 - 1;

750 
maxy2
 = 
bŸwp
->
y
 + bŸwp->
height
 + 
bs
 - 1;

752 i‡((
möx1
 > 
maxx2
Ë|| (
möx2
 > 
maxx1
Ë|| (
möy1
 > 
maxy2
)

753 || (
möy2
 > 
maxy1
))

754  
GR_FALSE
;

756  
GR_TRUE
;

757 
	}
}

763 
GR_WINDOW
 *

764 
	$GsFödWödow
(
GR_WINDOW_ID
 
id
)

766 
GR_WINDOW
 *
wp
;

771 i‡(
id
 =
GR_ROOT_WINDOW_ID
)

772  
roŸwp
;

774 i‡((
id
 =
ˇchewödowid
) && id)

775  
ˇchewp
;

780 
wp
 = 
li°wp
; wp; w∞wp->
√xt
) {

781 i‡(
wp
->
id
 == id) {

782 
ˇchewödowid
 = 
id
;

783 
ˇchewp
 = 
wp
;

784  
wp
;

788  
NULL
;

789 
	}
}

797 
GR_PIXMAP
 *

798 
	$GsFödPixm≠
(
GR_WINDOW_ID
 
id
)

800 
GR_PIXMAP
 *
µ
;

802 i‡((
id
 =
ˇchïixm≠id
) && id)

803  
ˇchïp
;

808 
µ
 = 
li°µ
;Öp;Ö∞µ->
√xt
) {

809 i‡(
µ
->
id
 == id) {

810 
ˇchïixm≠id
 = 
id
;

811 
ˇchïp
 = 
µ
;

812  
µ
;

816  
NULL
;

817 
	}
}

825 
GR_GC
 *

826 
	$GsFödGC
(
GR_GC_ID
 
gcid
)

828 
GR_GC
 *
g˝
;

833 i‡((
gcid
 =
ˇchegcid
) && gcid)

834  
ˇcheg˝
;

839 
g˝
 = 
li°g˝
; g˝; g˝ = g˝->
√xt
) {

840 i‡(
g˝
->
id
 =
gcid
) {

841 
ˇchegcid
 = 
gcid
;

842 
ˇcheg˝
 = 
g˝
;

843  
g˝
;

847 
	`GsEº‹
(
GR_ERROR_BAD_GC_ID
, 
gcid
);

849  
NULL
;

850 
	}
}

853 
GR_REGION
 *

854 
	$GsFödRegi⁄
(
GR_REGION_ID
 
ªgi⁄id
)

856 
GR_REGION
 *
ªgi⁄p
;

858 
ªgi⁄p
 = 
li°ªgi⁄p
;Ñegi⁄p;Ñegi⁄∞ªgi⁄p->
√xt
) {

859 i‡(
ªgi⁄p
->
id
 =
ªgi⁄id
) {

860  
ªgi⁄p
;

864  
NULL
;

865 
	}
}

868 
GR_FONT
 *

869 
	$GsFödF⁄t
(
GR_FONT_ID
 
f⁄tid
)

871 
GR_FONT
 *
f⁄ç
;

873 
f⁄ç
 = 
li°f⁄ç
; f⁄ç; f⁄ç = f⁄ç->
√xt
) {

874 i‡(
f⁄ç
->
id
 =
f⁄tid
)

875  
f⁄ç
;

877  
NULL
;

878 
	}
}

881 
GR_CURSOR
 *

882 
	$GsFödCurs‹
(
GR_CURSOR_ID
 
curs‹id
)

884 
GR_CURSOR
 *
curs‹p
;

886 
curs‹p
 = 
li°curs‹p
; curs‹p; curs‹∞curs‹p->
√xt
) {

887 i‡(
curs‹p
->
id
 =
curs‹id
)

888  
curs‹p
;

890  
NULL
;

891 
	}
}

893 #i‡
MW_FEATURE_TIMERS


894 
GR_TIMER
 *

895 
	$GsFödTimî
 (
GR_TIMER_ID
 
timî_id
)

897 
GR_TIMER
 *
timî
;

902 i‡((
timî_id
 =
ˇche_timî_id
) &&Åimer_id)

903  
ˇche_timî
;

908 
timî
 = 
li°_timî
;Åimî !
NULL
;Åimî =Åimî->
√xt
)

910 i‡(
timî
->
id
 =
timî_id
)

912 
ˇche_timî_id
 = 
timî_id
;

913 
ˇche_timî
 = 
timî
;

914  
timî
;

917  
NULL
;

918 
	}
}

928 
GR_DRAW_TYPE


929 
	$GsPª∑ªDøwög
(
GR_DRAW_ID
 
id
, 
GR_GC_ID
 
gcid
, 
GR_DRAWABLE
 **
ªtdp
)

931 
GR_WINDOW
 *
wp
;

932 
GR_PIXMAP
 *
µ
;

933 
GR_GC
 *
g˝
;

934 
GR_FONT
 *
f⁄ç
;

935 
GR_REGION
 *
ªgi⁄p
;

936 
MWCLIPREGION
 *
ªg
;

937 
PMWFONT
 
pf
;

939 *
ªtdp
 = 
NULL
;

941 
g˝
 = 
	`GsFödGC
(
gcid
);

942 i‡(
g˝
 =
NULL
)

943  
GR_DRAW_TYPE_NONE
;

949 i‡(
g˝
 !
curg˝
) {

950 
curg˝
 = 
g˝
;

951 
g˝
->
ch™ged
 = 
GR_TRUE
;

957 
µ
 = 
NULL
;

958 
wp
 = 
	`GsFödWödow
(
id
);

959 i‡(
wp
 =
NULL
) {

960 
µ
 = 
	`GsFödPixm≠
(
id
);

961 i‡(
µ
 =
NULL
)

962  
GR_DRAW_TYPE_NONE
;

964 #i‡
DYNAMICREGIONS


965 
ªg
 = 
	`GdAŒocRe˘Regi⁄
(0, 0, 
µ
->
psd
->
xvúåes
,

966 
µ
->
psd
->
yvúåes
);

968 i‡(
g˝
->
ªgi⁄id
) {

969 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
g˝
->
ªgi⁄id
);

970 i‡(
ªgi⁄p
)

971 
	`GdI¡î£˘Regi⁄
(
ªg
,Ñeg, 
ªgi⁄p
->
rgn
);

973 
	`GdSëClùRegi⁄
(
µ
->
psd
, 
ªg
);

976 
MWCLIPRECT
 
˛ùª˘
;

978 
˛ùª˘
.
x
 = 0;

979 
˛ùª˘
.
y
 = 0;

980 
˛ùª˘
.
width
 = 
µ
->
psd
->
xvúåes
;

981 
˛ùª˘
.
height
 = 
µ
->
psd
->
yvúåes
;

982 
	`GdSëClùRe˘s
(
µ
->
psd
, 1, &
˛ùª˘
);

986 
˛ùwp
 = 
NULL
;

989 i‡(!
wp
->
ouçut
) {

990 
	`GsEº‹
(
GR_ERROR_INPUT_ONLY_WINDOW
, 
id
);

991  
GR_DRAW_TYPE_NONE
;

994 i‡(!
wp
->
ªÆized
)

995  
GR_DRAW_TYPE_NONE
;

1001 i‡(
wp
 !
˛ùwp
 || 
g˝
->
ch™ged
) {

1003 i‡(
g˝
->
ªgi⁄id
)

1004 
ªgi⁄p
 = 
	`GsFödRegi⁄
(
g˝
->
ªgi⁄id
);

1005 
ªgi⁄p
 = 
NULL
;

1010 i‡(
ªgi⁄p
 && (
g˝
->
xoff
 || g˝->
yoff
)) {

1011 
MWCLIPREGION
 *
loˇl
 = 
	`GdAŒocRegi⁄
();

1013 
	`GdC›yRegi⁄
(
loˇl
, 
ªgi⁄p
->
rgn
);

1014 
	`GdOff£tRegi⁄
(
loˇl
, 
g˝
->
xoff
, g˝->
yoff
);

1016 
	`GsSëClùWödow
(
wp
, 
loˇl
,

1017 
g˝
->
mode
 & ~
GR_MODE_DRAWMASK
);

1019 
	`GdDe°royRegi⁄
(
loˇl
);

1021 
	`GsSëClùWödow
(
wp
, 
ªgi⁄p
?Ñegi⁄p->
rgn
: 
NULL
,

1022 
g˝
->
mode
 & ~
GR_MODE_DRAWMASK
);

1031 i‡(
g˝
->
ch™ged
) {

1032 
PSD
 
psd
 = (
wp
 ? wp->psd : 
µ
->psd);

1033 
mask
;

1034 
cou¡
;

1036 i‡(
g˝
->
löe°yÀ
 =
GR_LINE_SOLID
) {

1037 
mask
 = 0;

1038 
cou¡
 = 0;

1040 
mask
 = 
g˝
->
dashmask
;

1041 
cou¡
 = 
g˝
->
dashcou¡
;

1044 i‡(
g˝
->
fgi•ixñvÆ
)

1045 
	`GdSëF‹egroundPixñVÆ
(
psd
, 
g˝
->
f‹eground
);

1047 
	`GdSëF‹egroundCﬁ‹
(
psd
, 
g˝
->
f‹eground
);

1049 i‡(
g˝
->
bgi•ixñvÆ
)

1050 
	`GdSëBackgroundPixñVÆ
(
psd
, 
g˝
->
background
);

1052 
	`GdSëBackgroundCﬁ‹
(
psd
, 
g˝
->
background
);

1054 
	`GdSëMode
(
g˝
->
mode
 & 
GR_MODE_DRAWMASK
);

1055 
	`GdSëU£Background
(
g˝
->
u£background
);

1057 
	`GdSëDash
(&
mask
, &
cou¡
);

1058 
	`GdSëFûlMode
(
g˝
->
fûlmode
);

1059 
	`GdSëTSOff£t
(
g˝
->
ts_off£t
.
x
, g˝->ts_off£t.
y
);

1061 
g˝
->
fûlmode
) {

1062 
GR_FILL_STIPPLE
:

1063 
GR_FILL_OPAQUE_STIPPLE
:

1064 
	`GdSëStù∂eBôm≠
(
g˝
->
°ù∂e
.
bôm≠
,

1065 
g˝
->
°ù∂e
.
width
, g˝->°ù∂e.
height
);

1068 
GR_FILL_TILE
:

1069 
	`GdSëTûePixm≠
(
g˝
->
tûe
.
psd
,

1070 
g˝
->
tûe
.
width
, g˝->tûe.
height
);

1074 
f⁄ç
 = 
	`GsFödF⁄t
(
g˝
->
f⁄tid
);

1075 
pf
 = 
f⁄ç
? f⁄ç->
pf⁄t
: 
°df⁄t
;

1076 
	`GdSëF⁄t
(
pf
);

1077 
g˝
->
ch™ged
 = 
GR_FALSE
;

1080 *
ªtdp
 = 
wp
? (
GR_DRAWABLE
 *)wp: (GR_DRAWABLE *)
µ
;

1081  
wp
? 
GR_DRAW_TYPE_WINDOW
: 
GR_DRAW_TYPE_PIXMAP
;

1082 
	}
}

1090 
GR_WINDOW
 *

1091 
	$GsPª∑ªWödow
(
GR_WINDOW_ID
 
wid
)

1093 
GR_WINDOW
 *
wp
;

1095 
wp
 = 
	`GsFödWödow
(
wid
);

1096 i‡(
wp
 =
NULL
)

1097  
NULL
;

1099 i‡(!
wp
->
ouçut
) {

1100 
	`GsEº‹
(
GR_ERROR_INPUT_ONLY_WINDOW
, 
wid
);

1101  
NULL
;

1104 i‡(!
wp
->
ªÆized
)

1105  
NULL
;

1107 i‡(
wp
 !
˛ùwp
) {

1109 
	`GsSëClùWödow
(
wp
, 
NULL
, 0);

1112  
wp
;

1113 
	}
}

1121 
GR_WINDOW
 *

1122 
	$GsFödVisibÀWödow
(
GR_COORD
 
x
, GR_COORD 
y
)

1124 
GR_WINDOW
 *
wp
;

1125 
GR_WINDOW
 *
ªtwp
;

1127 
wp
 = 
roŸwp
;

1128 
ªtwp
 = 
wp
;

1129 
wp
) {

1130 i‡(
wp
->
ªÆized
 &&

1131 ((!
wp
->
˛ùªgi⁄
 && (wp->
x
 <xË&& (wp->
y
 <= y) &&

1132 (
wp
->
x
 + wp->
width
 > xË&& (wp->
y
 + wp->
height
 > y)) ||

1133 (
wp
->
˛ùªgi⁄
 && 
	`GdPtInRegi⁄
(wp->˛ùªgi⁄, 
x
 - wp->x, 
y
 - wp->y)))) {

1134 
ªtwp
 = 
wp
;

1135 
wp
 = wp->
chûdªn
;

1138 
wp
 = wp->
siblögs
;

1140  
ªtwp
;

1141 
	}
}

1148 
	$GsCheckCurs‹
()

1150 
GR_WINDOW
 *
wp
;

1151 
GR_CURSOR
 *
˝
;

1158 
wp
 = 
gøbbuâ⁄wp
;

1159 i‡(
wp
 =
NULL
)

1160 
wp
 = 
mou£wp
;

1162 
˝
 = 
	`GsFödCurs‹
(
wp
->
curs‹id
);

1163 i‡(!
˝
)

1164 
˝
 = 
°dcurs‹
;

1165 i‡(
˝
 =
curcurs‹
)

1171 
curcurs‹
 = 
˝
;

1172 
	`GdMoveCurs‹
(
curs‹x
 - 
˝
->
curs‹
.
hŸx
, 
curs‹y
 - cp->curs‹.
hŸy
);

1173 
	`GdSëCurs‹
(&
˝
->
curs‹
);

1174 
	}
}

1183 
	$GsCheckMou£Wödow
()

1185 
GR_WINDOW
 *
wp
;

1187 
wp
 = 
gøbbuâ⁄wp
;

1188 i‡(
wp
 =
NULL
)

1189 
wp
 = 
	`GsFödVisibÀWödow
(
curs‹x
, 
curs‹y
);

1190 i‡(
wp
 =
mou£wp
)

1193 
	`GsDñivîGíîÆEvít
(
mou£wp
, 
GR_EVENT_TYPE_MOUSE_EXIT
, 
NULL
);

1195 
mou£wp
 = 
wp
;

1197 
	`GsDñivîGíîÆEvít
(
wp
, 
GR_EVENT_TYPE_MOUSE_ENTER
, 
NULL
);

1198 
	}
}

1208 
	$GsCheckFocusWödow
()

1210 
GR_WINDOW
 *
wp
;

1211 
GR_EVENT_CLIENT
 *
e˝
;

1213 i‡(
focusfixed
)

1220 
wp
 = 
mou£wp
; ;w∞wp->
∑ª¡
) {

1221 i‡(
wp
->
¥›s
 & 
GR_WM_PROPS_NOFOCUS
)

1223 
e˝
 = 
wp
->
evít˛õ¡s
;É˝;É˝ =É˝->
√xt
) {

1224 i‡(
e˝
->
evítmask
 & 
GR_EVENT_MASK_KEY_DOWN
) {

1225 
	`GsWpSëFocus
(
wp
);

1229 i‡((
wp
 =
roŸwp
Ë|| (wp->
n›r›mask
 & 
GR_EVENT_MASK_KEY_DOWN
)) {

1230 
	`GsWpSëFocus
(
roŸwp
);

1234 
	}
}

1238 
	$GsWpNŸifyA˘iv©e
(
GR_WINDOW
 *
wp
)

1240 
GR_WINDOW
 *
pwp
;

1242 
pwp
=
wp
;Öwp->
∑ª¡
;Öwp=pwp->parent)

1243 i‡(
pwp
->
∑ª¡
->
id
 =
GR_ROOT_WINDOW_ID
)

1245 i‡(
pwp
->
id
 !
GR_ROOT_WINDOW_ID
)

1246 
	`GsDñivîUpd©eEvít
(
pwp
, 
GR_UPDATE_ACTIVATE
, 0, 0, 0, 0);

1247 
	}
}

1254 
	$GsWpSëFocus
(
GR_WINDOW
 *
wp
)

1256 
GR_WINDOW
 *
ﬁdfocus
;

1258 i‡(
wp
 =
focuswp
)

1261 
	`GsDñivîGíîÆEvít
(
focuswp
, 
GR_EVENT_TYPE_FOCUS_OUT
, 
wp
);

1262 
	`GsWpNŸifyA˘iv©e
(
focuswp
);

1264 
ﬁdfocus
 = 
focuswp
;

1265 
focuswp
 = 
wp
;

1267 
	`GsDñivîGíîÆEvít
(
wp
, 
GR_EVENT_TYPE_FOCUS_IN
, 
ﬁdfocus
);

1268 
	`GsWpNŸifyA˘iv©e
(
focuswp
);

1269 
	}
}

1275 
	$GsSëP‹åaôMode
(
mode
)

1277 
	`GdSëP‹åaôMode
(&
s¸dev
, 
mode
);

1278 
	`GdRe°ri˘Mou£
(0, 0, 
s¸dev
.
xvúåes
 - 1, s¸dev.
yvúåes
 - 1);

1281 
˛ùwp
 = 
NULL
;

1282 
roŸwp
->
width
 = 
s¸dev
.
xvúåes
;

1283 
roŸwp
->
height
 = 
s¸dev
.
yvúåes
;

1286 
	`GsDñivîP‹åaôCh™gedEvít
();

1289 
	`GsRedøwS¸ìn
();

1290 
	}
}

1297 
	$GsSëP‹åaôModeFromXY
(
GR_COORD
 
roŸx
, GR_COORD 
roŸy
)

1299 
√wmode
;

1301 i‡(
roŸx
 == 0) {

1303 
s¸dev
.
p‹åaô
) {

1304 
MWPORTRAIT_NONE
:

1306 
√wmode
 = 
MWPORTRAIT_LEFT
;

1308 
MWPORTRAIT_LEFT
:

1309 
√wmode
 = 
MWPORTRAIT_DOWN
;

1311 
MWPORTRAIT_DOWN
:

1312 
√wmode
 = 
MWPORTRAIT_RIGHT
;

1314 
MWPORTRAIT_RIGHT
:

1315 
√wmode
 = 
MWPORTRAIT_NONE
;

1318 
	`GsSëP‹åaôMode
(
√wmode
);

1319 
	`GrMoveCurs‹
(5, 
roŸy
);

1320 
	`GdMoveMou£
(5, 
roŸy
);

1321 } i‡(
roŸx
 =
s¸dev
.
xvúåes
-1) {

1323 
s¸dev
.
p‹åaô
) {

1324 
MWPORTRAIT_NONE
:

1326 
√wmode
 = 
MWPORTRAIT_RIGHT
;

1328 
MWPORTRAIT_LEFT
:

1329 
√wmode
 = 
MWPORTRAIT_NONE
;

1331 
MWPORTRAIT_DOWN
:

1332 
√wmode
 = 
MWPORTRAIT_LEFT
;

1334 
MWPORTRAIT_RIGHT
:

1335 
√wmode
 = 
MWPORTRAIT_DOWN
;

1338 
	`GsSëP‹åaôMode
(
√wmode
);

1339 
	`GrMoveCurs‹
(
s¸dev
.
xvúåes
-5, 
roŸy
);

1340 
	`GdMoveMou£
(
s¸dev
.
xvúåes
-5, 
roŸy
);

1342 
	}
}

	@rtems/mw_uid_test.c

4 
	~<°dio.h
>

5 
	~<°dlib.h
>

6 
	~<î∫o.h
>

7 
	~<sys/io˘l.h
>

8 
	~<f˙é.h
>

10 
	~<πems/mw_uid.h
>

11 
	~<πems/kd.h
>

13 c⁄° *
	gQ_NAME
 = "MWQ";

14 
	#Q_MAX_MSGS
 128

	)

21 
	$GsSñe˘
()

23 
MW_UID_MESSAGE
 
m
;

24 
rc
;

27 
m
.
ty≥
 = 
MV_UID_INVALID
;

30 
rc
 = 
	`uid_ªad_mesßge
–&
m
, 100 );

33 if–
rc
 < 0 )

35 if–
î∫o
 !
ETIMEDOUT
 )

36 
	`¥ötf
–"Ñc%d,Éºno=%d\n", 
rc
, 
î∫o
 );

40  
m
.
ty≥
 )

43 
MV_UID_REL_POS
:

44 
	`¥ötf
( "REL Mouse: btns=%X, dx=%d, dy=%d, dz=%d\n",

45 
m
.m.
pos
.
bäs
, m.m.pos.
x
, m.m.pos.
y
, m.m.pos.
z
 );

47 
MV_UID_ABS_POS
:

48 
	`¥ötf
( "ABS Mouse: btns=%X, dx=%d, dy=%d, dz=%d\n",

49 
m
.m.
pos
.
bäs
, m.m.pos.
x
, m.m.pos.
y
, m.m.pos.
z
 );

54 
MV_UID_KBD
:

55 
	`¥ötf
( "Kbd: code=%X, modifiers=%X, mode=%d\n",

56 ()
m
.m.
kbd
.
code
, m.m.kbd.
modifõrs
, m.m.kbd.
mode
 );

60 
MV_UID_TIMER
:

61 
MV_UID_INVALID
:

65 
	}
}

67 
˛o£
( );

68 
	$πems_maö
(
¨gc
, **
¨gv
)

70 
°©us
;

71 
MW_UID_MESSAGE
 
m
;

73 
rc
;

75 
rc
 = 
	`uid_›í_queue
–
Q_NAME
, 
O_CREAT
 | 
O_RDWR
, 
Q_MAX_MSGS
 );

77 
	`¥ötf
–"O≥¿QUEUE=%X\n", 
rc
 );

79 
mou£_fd
 = 
	`›í
–"/dev/mou£", 
O_NONBLOCK
 );

80 
	`uid_ªgi°î_devi˚
–
mou£_fd
, 
Q_NAME
 );

83 
kbd_fd
 = 
	`fûío
–
°dö
 );

84 
	`uid_ªgi°î_devi˚
–
kbd_fd
, 
Q_NAME
 );

86 
ﬁd_mode
 = 0;

88 
rc
 = 
	`uid_£t_kbd_mode
–
kbd_fd
, 
MV_KEY_MODE_SCANCODE
, &
ﬁd_mode
 );

89 
	`¥ötf
–"Kbd OldMode=%X,Ñc=%d\n", 
ﬁd_mode
, 
rc
 );

92 
	`GsSñe˘
();

94 
	`uid_uƒegi°î_devi˚
–
kbd_fd
 );

95 
	`uid_uƒegi°î_devi˚
–
mou£_fd
 );

96 
rc
 = 
	`uid_˛o£_queue
();

97 
	`¥ötf
–"Clo£ QUEUE=%X\n", 
rc
 );

99 
	`˛o£
–
mou£_fd
 );

101 
	`Ârötf
(
°dout
, "AboutÅoÜeave main()\n" );

103 
	}
}

	@rtems/net_cfg.h

20 #ifde‡
__˝lu•lus


28 
	~<°dio.h
>

29 
	~<πems/πems_bsd√t.h
>

36 
	#RTEMS_SET_ETHERNET_ADDRESS


	)

37 #i‡(
deföed
 (
RTEMS_SET_ETHERNET_ADDRESS
))

38 
ëhî√t_addªss
[6] = { 0x20, 0x00, 0x27, 0xAF, 0x03, 0x51 };

41 #unde‡
RTEMS_BSP_NETWORK_DRIVER_NAME


42 
	#RTEMS_BSP_NETWORK_DRIVER_NAME
 "ï0"

	)

44 
πems_3c509_drivî_©èch
–
πems_bsd√t_ifc⁄fig
 *
c⁄fig
 );

45 #unde‡
RTEMS_BSP_NETWORK_DRIVER_ATTACH


46 
	#RTEMS_BSP_NETWORK_DRIVER_ATTACH
 
πems_3c509_drivî_©èch


	)

51 
πems_bsd√t_ifc⁄fig
 
	g√tdrivî_c⁄fig
 =

53 
RTEMS_BSP_NETWORK_DRIVER_NAME
,

54 
RTEMS_BSP_NETWORK_DRIVER_ATTACH
,

56 
NULL
,

58 #i‡(
deföed
 (
RTEMS_USE_BOOTP
))

59 
NULL
,

60 
NULL
,

66 #i‡(
deföed
 (
RTEMS_SET_ETHERNET_ADDRESS
))

67 
ëhî√t_addªss
,

69 
NULL
,

77 
πems_bsd√t_c⁄fig
 
	gπems_bsd√t_c⁄fig
 = {

78 &
√tdrivî_c⁄fig
,

80 #i‡(
deföed
 (
RTEMS_USE_BOOTP
))

81 
πems_bsd√t_do_boŸp
,

83 
NULL
,

90 #i‡(!
deföed
 (
RTEMS_USE_BOOTP
))

103 #i‡(!
deföed
 (
RTEMS_USE_BOOTP
))

104 
	#RTEMS_TFTP_TEST_HOST_NAME
 "192.168.0.2"

	)

105 
	#RTEMS_TFTP_TEST_FILE_NAME
 "roŸ/boŸ.bt"

	)

109 #ifde‡
__˝lu•lus


	@rtems/rtems_init.c

20 
	#CONFIGURE_INIT


	)

21 
	~<°dio.h
>

22 
	~"πemscfg.h
"

25 
	~"√t_cfg.h
"

26 
	~<°dio.h
>

27 
	~<sys/sockë.h
>

28 
	~<√töë/ö.h
>

29 
	~<√tdb.h
>

30 
	~<¨∑/öë.h
>

32 
	~"devi˚.h
"

36 #ifde‡
USE_REMOTE_GDB__


37 
öô_ªmŸe_gdb
( );

38 
	#BREAKPOINT
(Ë
	`asm
(" i¡ $3");

	)

42 *
	gcc_¨gv
[] =

46 
	gcc_¨gc
 = –
cc_¨gv
 ) / ( cc_argv[ 0 ] );

49 
πems_maö
(
¨gc
, **
¨gv
);

54 *
	$POSIX_Inô
–*
¨gumít
 )

56 
size_t
 
°
 = 0;

58 #ifde‡
USE_REMOTE_GDB__


59 
	`öô_ªmŸe_gdb
();

63 
	`DPRINTF
( "\nStarting RTEMS initÅask...\n" );

65 #i‚de‡
NONETWORK


67 
	`πems_bsd√t_öôülize_√tw‹k
();

68 
	`DPRINTF
( "Network Initialization is complete.\n\n" );

71 
°
 = 
_Thªad_Executög
->
Sèπ
.
Inôül_°ack
.
size
;

72 
	`DPRINTF
–"Inô Task Sèck Sizêis: %d\n", 
°
 );

74 
	`πems_maö
–
cc_¨gc
, 
cc_¨gv
 );

75 
	`DPRINTF
( "*** Done ***\n\n\n" );

76 
	`±hªad_exô
–
NULL
 );

77  
NULL
;

78 
	}
}

	@rtems/rtemscfg.h

18 
	~<b•.h
>

19 
	~<ây_drv.h
>

20 
	~<πems/ps2_drv.h
>

21 
	~<πems/fb_vga.h
>

22 
	~<πems/£rül_mou£.h
>

25 #ifde‡
__˝lu•lus


30 
	#CONFIGURE_MAXIMUM_DEVICES
 40

	)

31 
	#CONFIGURE_MAXIMUM_TASKS
 300

	)

32 
	#CONFIGURE_MAXIMUM_TIMERS
 32

	)

33 
	#CONFIGURE_MAXIMUM_SEMAPHORES
 100

	)

34 
	#CONFIGURE_MAXIMUM_MESSAGE_QUEUES
 20

	)

35 
	#CONFIGURE_MAXIMUM_PARTITIONS
 100

	)

36 
	#CONFIGURE_MAXIMUM_REGIONS
 100

	)

39 
	#CONFIGURE_MAXIMUM_POSIX_MUTEXES
 32

	)

40 
	#CONFIGURE_MAXIMUM_POSIX_CONDITION_VARIABLES
 32

	)

41 
	#CONFIGURE_MAXIMUM_POSIX_KEYS
 32

	)

42 
	#CONFIGURE_MAXIMUM_POSIX_QUEUED_SIGNALS
 10

	)

43 
	#CONFIGURE_MAXIMUM_POSIX_THREADS
 256

	)

44 
	#CONFIGURE_MAXIMUM_POSIX_TIMERS
 10

	)

45 
	#CONFIGURE_LIBIO_MAXIMUM_FILE_DESCRIPTORS
 200

	)

48 
	#CONFIGURE_MAXIMUM_POSIX_MESSAGE_QUEUES
 20

	)

50 *
POSIX_Inô
–*
¨gumít
 );

51 
	#CONFIGURE_POSIX_INIT_THREAD_STACK_SIZE
 (512*1024)

	)

52 
	#CONFIGURE_POSIX_INIT_THREAD_TABLE


	)

54 
	#CONFIGURE_HAS_OWN_DEVICE_DRIVER_TABLE


	)

55 
	#CONFIGURE_MICROSECONDS_PER_TICK
 1000

	)

57 
	#PS2_MOUSE
 1

	)

60 
πems_drivî_addªss_èbÀ
 
Devi˚_drivîs
[] =

62 
CONSOLE_DRIVER_TABLE_ENTRY
,

63 
CLOCK_DRIVER_TABLE_ENTRY
,

69 
TTY2_DRIVER_TABLE_ENTRY
,

71 #i‡
PS2_MOUSE


72 
PAUX_DRIVER_TABLE_ENTRY
,

79 
SERIAL_MOUSE_DRIVER_TABLE_ENTRY
,

83 
FBVGA_DRIVER_TABLE_ENTRY
,

85 { 
NULL
,NULL, NULL,NULL,NULL, NULL }

88 
	~<c⁄fdefs.h
>

90 #ifde‡
__˝lu•lus


	@/usr/include/arpa/inet.h

19 #i‚de‡
_ARPA_INET_H


20 
	#_ARPA_INET_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<√töë/ö.h
>

26 #i‚de‡
__sockÀn_t_deföed


27 
__sockÀn_t
 
	tsockÀn_t
;

28 
	#__sockÀn_t_deföed


	)

31 
__BEGIN_DECLS


35 
ö_addr_t
 
	$öë_addr
 (
__c⁄°
 *
__˝
Ë
__THROW
;

38 
ö_addr_t
 
	$öë_ aof
 (
ö_addr
 
__ö
Ë
__THROW
;

42 
ö_addr
 
	$öë_makóddr
 (
ö_addr_t
 
__√t
, in_addr_à
__ho°
)

43 
__THROW
;

46 
ö_addr_t
 
	$öë_√tof
 (
ö_addr
 
__ö
Ë
__THROW
;

50 
ö_addr_t
 
	$öë_√tw‹k
 (
__c⁄°
 *
__˝
Ë
__THROW
;

54 *
	$öë_¡ﬂ
 (
ö_addr
 
__ö
Ë
__THROW
;

59 
	$öë_±⁄
 (
__af
, 
__c⁄°
 *
__ª°ri˘
 
__˝
,

60 *
__ª°ri˘
 
__buf
Ë
__THROW
;

65 
__c⁄°
 *
	$öë_¡›
 (
__af
, 
__c⁄°
 *
__ª°ri˘
 
__˝
,

66 *
__ª°ri˘
 
__buf
, 
sockÀn_t
 
__Àn
)

67 
__THROW
;

71 #ifde‡
__USE_MISC


74 
ö_addr_t
 
	$öë_©⁄
 (
__c⁄°
 *
__˝
, 
ö_addr
 *
__öp
Ë
__THROW
;

78 *
	$öë_√è
 (
ö_addr_t
 
__√t
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

83 *
	$öë_√t_¡›
 (
__af
, 
__c⁄°
 *
__˝
, 
__bôs
,

84 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

89 
	$öë_√t_±⁄
 (
__af
, 
__c⁄°
 *
__˝
,

90 *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

95 
	$öë_nßp_addr
 (
__c⁄°
 *
__˝
,

96 *
__buf
, 
__Àn
Ë
__THROW
;

100 *
	$öë_nßp_¡ﬂ
 (
__Àn
, 
__c⁄°
 *
__˝
,

101 *
__buf
Ë
__THROW
;

104 
__END_DECLS


	@/usr/include/asm/io.h

1 #i‚de‡
_ASM_IO_H


2 
	#_ASM_IO_H


	)

4 
	~<löux/c⁄fig.h
>

39 
	#IO_SPACE_LIMIT
 0xffff

	)

41 
	#XQUAD_PORTIO_BASE
 0x„400000

	)

42 
	#XQUAD_PORTIO_QUAD
 0x40000

	)

44 #ifde‡
__KERNEL__


46 
	~<löux/vmÆloc.h
>

52 #ifde‡
CONFIG_DEBUG_IOVIRT


53 *
__io_vút_debug
(
x
, c⁄° *
fûe
, 
löe
);

54 
	#__io_vút
(
x
Ë
	`__io_vút_debug
(()(x), 
__FILE__
, 
__LINE__
)

	)

56 
	#__io_vút
(
x
Ë((*)(x))

	)

72 
ölöe
 
	$vút_to_phys
(vﬁ©ûê* 
addªss
)

74  
	`__∑
(
addªss
);

75 
	}
}

90 
ölöe
 * 
	$phys_to_vút
(
addªss
)

92  
	`__va
(
addªss
);

93 
	}
}

98 
	#∑ge_to_phys
(
∑ge
Ë((
dma_addr_t
)
	`∑ge_to_p‚
’ageË<< 
PAGE_SHIFT
)

	)

100 * 
__i‹em≠
(
off£t
, 
size
, 
Êags
);

114 
ölöe
 * 
	$i‹em≠
 (
off£t
, 
size
)

116  
	`__i‹em≠
(
off£t
, 
size
, 0);

117 
	}
}

119 * 
i‹em≠_noˇche
 (
off£t
, 
size
);

120 
iounm≠
(*
addr
);

127 *
bt_i‹em≠
(
off£t
, 
size
);

128 
bt_iounm≠
(*
addr
, 
size
);

133 
	#iß_vút_to_bus
 
vút_to_phys


	)

134 
	#iß_∑ge_to_bus
 
∑ge_to_phys


	)

135 
	#iß_bus_to_vút
 
phys_to_vút


	)

143 
	#vút_to_bus
 
vút_to_phys


	)

144 
	#bus_to_vút
 
phys_to_vút


	)

153 
	#ªadb
(
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddr))

	)

154 
	#ªadw
(
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddr))

	)

155 
	#ªadl
(
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddr))

	)

156 
	#__øw_ªadb
 
ªadb


	)

157 
	#__øw_ªadw
 
ªadw


	)

158 
	#__øw_ªadl
 
ªadl


	)

160 
	#wrôeb
(
b
,
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddrË(b))

	)

161 
	#wrôew
(
b
,
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddrË(b))

	)

162 
	#wrôñ
(
b
,
addr
Ë(*(vﬁ©ûê*Ë
	`__io_vút
◊ddrË(b))

	)

163 
	#__øw_wrôeb
 
wrôeb


	)

164 
	#__øw_wrôew
 
wrôew


	)

165 
	#__øw_wrôñ
 
wrôñ


	)

167 
	#mem£t_io
(
a
,
b
,
c
Ë
	`mem£t
(
	`__io_vút
◊),(b),(c))

	)

168 
	#mem˝y_‰omio
(
a
,
b
,
c
Ë
	`__mem˝y
(◊),
	`__io_vút
(b),(c))

	)

169 
	#mem˝y_toio
(
a
,
b
,
c
Ë
	`__mem˝y
(
	`__io_vút
◊),(b),(c))

	)

179 
	#__ISA_IO_ba£
 ((*)(
PAGE_OFFSET
))

	)

181 
	#iß_ªadb
(
a
Ë
	`ªadb
(
__ISA_IO_ba£
 + (a))

	)

182 
	#iß_ªadw
(
a
Ë
	`ªadw
(
__ISA_IO_ba£
 + (a))

	)

183 
	#iß_ªadl
(
a
Ë
	`ªadl
(
__ISA_IO_ba£
 + (a))

	)

184 
	#iß_wrôeb
(
b
,
a
Ë
	`wrôeb
(b,
__ISA_IO_ba£
 + (a))

	)

185 
	#iß_wrôew
(
w
,
a
Ë
	`wrôew
(w,
__ISA_IO_ba£
 + (a))

	)

186 
	#iß_wrôñ
(
l
,
a
Ë
	`wrôñ
÷,
__ISA_IO_ba£
 + (a))

	)

187 
	#iß_mem£t_io
(
a
,
b
,
c
Ë
	`mem£t_io
(
__ISA_IO_ba£
 + (a),(b),(c))

	)

188 
	#iß_mem˝y_‰omio
(
a
,
b
,
c
Ë
	`mem˝y_‰omio
(◊),
__ISA_IO_ba£
 + (b),(c))

	)

189 
	#iß_mem˝y_toio
(
a
,
b
,
c
Ë
	`mem˝y_toio
(
__ISA_IO_ba£
 + (a),(b),(c))

	)

196 
	#ëh_io_c›y_™d_sum
(
a
,
b
,
c
,
d
Ë
	`ëh_c›y_™d_sum
(◊),
	`__io_vút
(b),(c),(d))

	)

197 
	#iß_ëh_io_c›y_™d_sum
(
a
,
b
,
c
,
d
Ë
	`ëh_c›y_™d_sum
(◊),
	`__io_vút
(
__ISA_IO_ba£
 + (b)),(c),(d))

	)

210 
ölöe
 
	$check_sig«tuª
(
io_addr
,

211 c⁄° *
sig«tuª
, 
Àngth
)

213 
ªtvÆ
 = 0;

215 i‡(
	`ªadb
(
io_addr
Ë!*
sig«tuª
)

216 
out
;

217 
io_addr
++;

218 
sig«tuª
++;

219 
Àngth
--;

220 } 
Àngth
);

221 
ªtvÆ
 = 1;

222 
out
:

223  
ªtvÆ
;

224 
	}
}

240 
ölöe
 
	$iß_check_sig«tuª
(
io_addr
,

241 c⁄° *
sig«tuª
, 
Àngth
)

243 
ªtvÆ
 = 0;

245 i‡(
	`iß_ªadb
(
io_addr
Ë!*
sig«tuª
)

246 
out
;

247 
io_addr
++;

248 
sig«tuª
++;

249 
Àngth
--;

250 } 
Àngth
);

251 
ªtvÆ
 = 1;

252 
out
:

253  
ªtvÆ
;

254 
	}
}

264 #i‡
deföed
(
CONFIG_X86_OOSTORE
Ë|| deföed(
CONFIG_X86_PPRO_FENCE
)

266 
ölöe
 
	$Êush_wrôe_buf„rs
()

268 
__asm__
 
	`__vﬁ©ûe__
 ("lock;áddl $0,0(%%esp)": : :"memory");

269 
	}
}

271 
	#dma_ˇche_öv
(
_°¨t
,
_size
Ë
	`Êush_wrôe_buf„rs
()

	)

272 
	#dma_ˇche_wback
(
_°¨t
,
_size
Ë
	`Êush_wrôe_buf„rs
()

	)

273 
	#dma_ˇche_wback_öv
(
_°¨t
,
_size
Ë
	`Êush_wrôe_buf„rs
()

	)

279 
	#dma_ˇche_öv
(
_°¨t
,
_size
Ëdÿ{ } 0)

	)

280 
	#dma_ˇche_wback
(
_°¨t
,
_size
Ëdÿ{ } 0)

	)

281 
	#dma_ˇche_wback_öv
(
_°¨t
,
_size
Ëdÿ{ } 0)

	)

282 
	#Êush_wrôe_buf„rs
()

	)

288 #ifde‡
SLOW_IO_BY_JUMPING


289 
	#__SLOW_DOWN_IO
 "jm∞1f; 1: jm∞1f; 1:"

	)

291 
	#__SLOW_DOWN_IO
 "outb %%Æ,$0x80;"

	)

294 
ölöe
 
	$¶ow_down_io
() {

295 
__asm__
 
	`__vﬁ©ûe__
(

296 
__SLOW_DOWN_IO


297 #ifde‡
REALLY_SLOW_IO


298 
__SLOW_DOWN_IO
 __SLOW_DOWN_IO __SLOW_DOWN_IO

301 
	}
}

303 #ifde‡
CONFIG_X86_NUMAQ


304 *
xquad_p‹tio
;

305 
	#XQUAD_PORT_ADDR
(
p‹t
, 
quad
Ë(
xquad_p‹tio
 + (
XQUAD_PORTIO_QUAD
*quadË+Ö‹t)

	)

306 
	#__BUILDIO
(
bwl
,
bw
,
ty≥
) \

307 
ölöe
 
out
##
bwl
##
	`_quad
(
ty≥
 
vÆue
, 
p‹t
, 
quad
) { \

308 i‡(
xquad_p‹tio
) \

309 
wrôe
##
	`bwl
(
vÆue
, 
	`XQUAD_PORT_ADDR
(
p‹t
, 
quad
)); \

311 
out
##
bwl
##
	`_loˇl
(
vÆue
, 
p‹t
); \

313 
ölöe
 
out
##
	`bwl
(
ty≥
 
vÆue
, 
p‹t
) { \

314 
out
##
bwl
##
	`_quad
(
vÆue
, 
p‹t
, 0); \

316 
ölöe
 
ty≥
 
ö
##
bwl
##
	`_quad
(
p‹t
, 
quad
) { \

317 i‡(
xquad_p‹tio
) \

318  
ªad
##
	`bwl
(
	`XQUAD_PORT_ADDR
(
p‹t
, 
quad
)); \

320  
ö
##
bwl
##
	`_loˇl
(
p‹t
); \

322 
ölöe
 
ty≥
 
ö
##
	`bwl
(
p‹t
) { \

323  
ö
##
bwl
##
	`_quad
(
p‹t
, 0); \

324 }

	)

326 
	#__BUILDIO
(
bwl
,
bw
,
ty≥
) \

327 
ölöe
 
out
##
	`bwl
(
ty≥
 
vÆue
, 
p‹t
) { \

328 
out
##
bwl
##
	`_loˇl
(
vÆue
, 
p‹t
); \

330 
ölöe
 
ty≥
 
ö
##
	`bwl
(
p‹t
) { \

331  
ö
##
bwl
##
	`_loˇl
(
p‹t
); \

332 }

	)

336 
	#BUILDIO
(
bwl
,
bw
,
ty≥
) \

337 
ölöe
 
out
##
bwl
##
	`_loˇl
(
ty≥
 
vÆue
, 
p‹t
) { \

338 
__asm__
 
	`__vﬁ©ûe__
("out" #bw»" %" #bw "0, %w1" : : "a"(
vÆue
), "Nd"(
p‹t
)); \

340 
ölöe
 
ty≥
 
ö
##
bwl
##
	`_loˇl
(
p‹t
) { \

341 
ty≥
 
vÆue
; \

342 
__asm__
 
	`__vﬁ©ûe__
("ö" #bw»" %w1, %" #bw "0" : "˜"(
vÆue
Ë: "Nd"(
p‹t
)); \

343  
vÆue
; \

345 
ölöe
 
out
##
bwl
##
	`_loˇl_p
(
ty≥
 
vÆue
, 
p‹t
) { \

346 
out
##
bwl
##
	`_loˇl
(
vÆue
, 
p‹t
); \

347 
	`¶ow_down_io
(); \

349 
ölöe
 
ty≥
 
ö
##
bwl
##
	`_loˇl_p
(
p‹t
) { \

350 
ty≥
 
vÆue
 = 
ö
##
bwl
##
	`_loˇl
(
p‹t
); \

351 
	`¶ow_down_io
(); \

352  
vÆue
; \

354 
	`__BUILDIO
(
bwl
,
bw
,
ty≥
) \

355 
ölöe
 
out
##
bwl
##
	`_p
(
ty≥
 
vÆue
, 
p‹t
) { \

356 
out
##
	`bwl
(
vÆue
, 
p‹t
); \

357 
	`¶ow_down_io
(); \

359 
ölöe
 
ty≥
 
ö
##
bwl
##
	`_p
(
p‹t
) { \

360 
ty≥
 
vÆue
 = 
ö
##
	`bwl
(
p‹t
); \

361 
	`¶ow_down_io
(); \

362  
vÆue
; \

364 
ölöe
 
outs
##
	`bwl
(
p‹t
, c⁄° *
addr
, 
cou¡
) { \

365 
__asm__
 
	`__vﬁ©ûe__
("ªp; outs" #bw»: "+S"(
addr
), "+c"(
cou¡
Ë: "d"(
p‹t
)); \

367 
ölöe
 
ös
##
	`bwl
(
p‹t
, *
addr
, 
cou¡
) { \

368 
__asm__
 
	`__vﬁ©ûe__
("ªp; ins" #bw»: "+D"(
addr
), "+c"(
cou¡
Ë: "d"(
p‹t
)); \

369 }

	)

371 
	$BUILDIO
(
b
,b,)

372 
	$BUILDIO
(
w
,w,)

373 
	$BUILDIO
(
l
,,)

	@/usr/include/asm/page.h

1 #i‚de‡
_I386_PAGE_H


2 
	#_I386_PAGE_H


	)

5 
	#PAGE_SHIFT
 12

	)

6 
	#PAGE_SIZE
 (1UL << 
PAGE_SHIFT
)

	)

7 
	#PAGE_MASK
 (~(
PAGE_SIZE
-1))

	)

9 
	#LARGE_PAGE_MASK
 (~(
LARGE_PAGE_SIZE
-1))

	)

10 
	#LARGE_PAGE_SIZE
 (1UL << 
PMD_SHIFT
)

	)

12 #ifde‡
__KERNEL__


13 #i‚de‡
__ASSEMBLY__


15 
	~<löux/c⁄fig.h
>

17 #ifde‡
CONFIG_X86_USE_3DNOW


19 
	~<asm/mmx.h
>

21 
	#˛ór_∑ge
(
∑ge
Ë
	`mmx_˛ór_∑ge
((*)’age))

	)

22 
	#c›y_∑ge
(
to
,
‰om
Ë
	`mmx_c›y_∑ge
—o,‰om)

	)

31 
	#˛ór_∑ge
(
∑ge
Ë
	`mem£t
((*)’age), 0, 
PAGE_SIZE
)

	)

32 
	#c›y_∑ge
(
to
,
‰om
Ë
	`mem˝y
((*)—o), (*)(‰om), 
PAGE_SIZE
)

	)

36 
	#˛ór_u£r_∑ge
(
∑ge
, 
vaddr
, 
pg
Ë
	`˛ór_∑ge
’age)

	)

37 
	#c›y_u£r_∑ge
(
to
, 
‰om
, 
vaddr
, 
pg
Ë
	`c›y_∑ge
—o, from)

	)

42 #ifde‡
CONFIG_X86_PAE


43 °ru˘ { 
	m±e_low
, 
	m±e_high
; } 
	t±e_t
;

44 °ru˘ { 
	mpmd
; } 
	tpmd_t
;

45 °ru˘ { 
	mpgd
; } 
	tpgd_t
;

46 
	#±e_vÆ
(
x
Ë((x).
±e_low
 | (()(x).
±e_high
 << 32))

	)

47 
	#HPAGE_SHIFT
 21

	)

49 °ru˘ { 
	m±e_low
; } 
	t±e_t
;

50 °ru˘ { 
	mpmd
; } 
	tpmd_t
;

51 °ru˘ { 
	mpgd
; } 
	tpgd_t
;

52 
	#boŸ_±e_t
 
±e_t


	)

53 
	#±e_vÆ
(
x
Ë((x).
±e_low
)

	)

54 
	#HPAGE_SHIFT
 22

	)

56 
	#PTE_MASK
 
PAGE_MASK


	)

58 #ifde‡
CONFIG_HUGETLB_PAGE


59 
	#HPAGE_SIZE
 ((1ULË<< 
HPAGE_SHIFT
)

	)

60 
	#HPAGE_MASK
 (~(
HPAGE_SIZE
 - 1))

	)

61 
	#HUGETLB_PAGE_ORDER
 (
HPAGE_SHIFT
 - 
PAGE_SHIFT
)

	)

64 °ru˘ { 
	mpg¥Ÿ
; } 
	tpg¥Ÿ_t
;

66 
	#pmd_vÆ
(
x
Ë((x).
pmd
)

	)

67 
	#pgd_vÆ
(
x
Ë((x).
pgd
)

	)

68 
	#pg¥Ÿ_vÆ
(
x
Ë((x).
pg¥Ÿ
)

	)

70 
	#__±e
(
x
Ë((
±e_t
Ë{ (xË} )

	)

71 
	#__pmd
(
x
Ë((
pmd_t
Ë{ (xË} )

	)

72 
	#__pgd
(
x
Ë((
pgd_t
Ë{ (xË} )

	)

73 
	#__pg¥Ÿ
(
x
Ë((
pg¥Ÿ_t
Ë{ (xË} )

	)

78 
	#PAGE_ALIGN
(
addr
Ë((◊ddr)+
PAGE_SIZE
-1)&
PAGE_MASK
)

	)

97 
	#__VMALLOC_RESERVE
 (128 << 20)

	)

99 #i‚de‡
__ASSEMBLY__


102 
__ölöe__
 
	$gë_‹dî
(
size
)

104 
‹dî
;

106 
size
 = (size-1Ë>> (
PAGE_SHIFT
-1);

107 
‹dî
 = -1;

109 
size
 >>= 1;

110 
‹dî
++;

111 } 
size
);

112  
‹dî
;

113 
	}
}

117 #ifde‡
__ASSEMBLY__


118 
	#__PAGE_OFFSET
 (0xC0000000)

	)

120 
	#__PAGE_OFFSET
 (0xC0000000UL)

	)

124 
	#PAGE_OFFSET
 (()
__PAGE_OFFSET
)

	)

125 
	#VMALLOC_RESERVE
 (()
__VMALLOC_RESERVE
)

	)

126 
	#MAXMEM
 (-
__PAGE_OFFSET
-
__VMALLOC_RESERVE
)

	)

127 
	#__∑
(
x
Ë(()(x)-
PAGE_OFFSET
)

	)

128 
	#__va
(
x
Ë((*)(()(x)+
PAGE_OFFSET
))

	)

129 
	#p‚_to_kaddr
(
p‚
Ë
	`__va
(’‚Ë<< 
PAGE_SHIFT
)

	)

130 #i‚de‡
CONFIG_DISCONTIGMEM


131 
	#p‚_to_∑ge
(
p‚
Ë(
mem_m≠
 + (p‚))

	)

132 
	#∑ge_to_p‚
(
∑ge
Ë(()(’ageË- 
mem_m≠
))

	)

133 
	#p‚_vÆid
(
p‚
Ë(’‚Ë< 
max_m≠ƒ
)

	)

135 
	#vút_to_∑ge
(
kaddr
Ë
	`p‚_to_∑ge
(
	`__∑
(kaddrË>> 
PAGE_SHIFT
)

	)

137 
	#vút_addr_vÆid
(
kaddr
Ë
	`p‚_vÆid
(
	`__∑
(kaddrË>> 
PAGE_SHIFT
)

	)

139 
	#VM_DATA_DEFAULT_FLAGS
 (
VM_READ
 | 
VM_WRITE
 | 
VM_EXEC
 | \

140 
VM_MAYREAD
 | 
VM_MAYWRITE
 | 
VM_MAYEXEC
)

	)

	@/usr/include/assert.h

23 #ifdef 
_ASSERT_H


25 #unde‡
_ASSERT_H


26 #unde‡
as£π


27 #unde‡
__ASSERT_VOID_CAST


29 #ifdef 
__USE_GNU


30 #unde‡
as£π_≥º‹


35 
	#_ASSERT_H
 1

	)

36 
	~<„©uªs.h
>

38 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,95)

39 
	#__ASSERT_VOID_CAST
 
°©ic_ˇ°
<>

	)

41 
	#__ASSERT_VOID_CAST
 ()

	)

49 #ifdef 
NDEBUG


51 
	#as£π
(
ex¥
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

59 #ifdef 
__USE_GNU


60 
	#as£π_≥º‹
(
î∫um
Ë(
	`__ASSERT_VOID_CAST
 (0))

	)

65 #i‚de‡
_ASSERT_H_DECLS


66 
	#_ASSERT_H_DECLS


	)

67 
__BEGIN_DECLS


70 
	$__as£π_Áû
 (
__c⁄°
 *
__as£πi⁄
, __c⁄° *
__fûe
,

71 
__löe
, 
__c⁄°
 *
__fun˘i⁄
)

72 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

75 
	$__as£π_≥º‹_Áû
 (
__î∫um
, 
__c⁄°
 *
__fûe
,

76 
__löe
,

77 
__c⁄°
 *
__fun˘i⁄
)

78 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

83 
	$__as£π
 (c⁄° *
__as£πi⁄
, c⁄° *
__fûe
, 
__löe
)

84 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

87 
__END_DECLS


93 #i‡
	`__GNUC_PREREQ
 (3, 0)

94 
	#as£π
(
ex¥
) \

95 (
	`__ASSERT_VOID_CAST
 (
	`__buûtö_ex≥˘
 (!!(
ex¥
), 1) ? 0 : \

96 (
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, \

97 
__ASSERT_FUNCTION
), 0)))

	)

99 
	#as£π
(
ex¥
) \

100 (
	`__ASSERT_VOID_CAST
 ((
ex¥
) ? 0 : \

101 (
	`__as£π_Áû
 (
	`__STRING
(
ex¥
), 
__FILE__
, 
__LINE__
, \

102 
__ASSERT_FUNCTION
), 0)))

	)

105 #ifdef 
__USE_GNU


106 #i‡
	`__GNUC_PREREQ
 (3, 0)

107 
	#as£π_≥º‹
(
î∫um
) \

108 (
	`__ASSERT_VOID_CAST
 (
	`__buûtö_ex≥˘
 (!(
î∫um
), 1) ? 0 : \

109 (
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, \

110 
__ASSERT_FUNCTION
), 0)))

	)

112 
	#as£π_≥º‹
(
î∫um
) \

113 (
	`__ASSERT_VOID_CAST
 (!(
î∫um
) ? 0 : \

114 (
	`__as£π_≥º‹_Áû
 ((
î∫um
), 
__FILE__
, 
__LINE__
, \

115 
__ASSERT_FUNCTION
), 0)))

	)

124 #i‡
deföed
 
__˝lu•lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

125 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

127 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

128 
	#__ASSERT_FUNCTION
 
__func__


	)

130 
	#__ASSERT_FUNCTION
 ((
__c⁄°
 *Ë0)

	)

	@/usr/include/byteswap.h

19 #i‚de‡
_BYTESWAP_H


20 
	#_BYTESWAP_H
 1

	)

23 
	~<bôs/byãsw≠.h
>

30 
	#bsw≠_16
(
x
Ë
	`__bsw≠_16
 (x)

	)

33 
	#bsw≠_32
(
x
Ë
	`__bsw≠_32
 (x)

	)

35 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

37 
	#bsw≠_64
(
x
Ë
	`__bsw≠_64
 (x)

	)

	@/usr/include/ctype.h

24 #i‚def 
_CTYPE_H


25 
	#_CTYPE_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 
	g__BEGIN_DECLS


32 #i‚de‡
_ISbô


41 
	~<ídün.h
>

42 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


43 
	#_ISbô
(
bô
Ë(1 << (bô))

	)

45 
	#_ISbô
(
bô
Ë((bôË< 8 ? ((1 << (bô)Ë<< 8Ë: ((1 << (bô)Ë>> 8))

	)

50 
	m_ISuµî
 = 
_ISbô
 (0),

51 
	m_ISlowî
 = 
_ISbô
 (1),

52 
	m_ISÆpha
 = 
_ISbô
 (2),

53 
	m_ISdigô
 = 
_ISbô
 (3),

54 
	m_ISxdigô
 = 
_ISbô
 (4),

55 
	m_IS•a˚
 = 
_ISbô
 (5),

56 
	m_IS¥öt
 = 
_ISbô
 (6),

57 
	m_ISgøph
 = 
_ISbô
 (7),

58 
	m_ISbœnk
 = 
_ISbô
 (8),

59 
	m_IS˙ål
 = 
_ISbô
 (9),

60 
	m_ISpun˘
 = 
_ISbô
 (10),

61 
	m_ISÆnum
 = 
_ISbô
 (11)

81 
__c⁄°
 **
	$__˘y≥_b_loc
 ()

82 
	`__©åibuã__
 ((
__c⁄°
));

83 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_tﬁowî_loc
 ()

84 
	`__©åibuã__
 ((
__c⁄°
));

85 
__c⁄°
 
__öt32_t
 **
	$__˘y≥_touµî_loc
 ()

86 
	`__©åibuã__
 ((
__c⁄°
));

88 
	#__is˘y≥
(
c
, 
ty≥
) \

89 ((*
	`__˘y≥_b_loc
 ())[(Ë(
c
)] & (Ë
ty≥
)

	)

91 
	#__ißscii
(
c
Ë(((cË& ~0x7fË=0Ë

	)

92 
	#__tﬂscii
(
c
Ë((cË& 0x7fË

	)

94 
	#__ex˘y≥
(
«me
Ë
	`«me
 (Ë
__THROW


	)

96 
__BEGIN_NAMESPACE_STD


102 
	`__ex˘y≥
 (
iß um
);

103 
	`__ex˘y≥
 (
ißÕha
);

104 
	`__ex˘y≥
 (
is˙ål
);

105 
	`__ex˘y≥
 (
isdigô
);

106 
	`__ex˘y≥
 (
i¶owî
);

107 
	`__ex˘y≥
 (
isgøph
);

108 
	`__ex˘y≥
 (
i•röt
);

109 
	`__ex˘y≥
 (
i•un˘
);

110 
	`__ex˘y≥
 (
is•a˚
);

111 
	`__ex˘y≥
 (
isuµî
);

112 
	`__ex˘y≥
 (
isxdigô
);

116 
	$tﬁowî
 (
__c
Ë
__THROW
;

119 
	$touµî
 (
__c
Ë
__THROW
;

121 
__END_NAMESPACE_STD


125 #ifdef 
__USE_ISOC99


126 
__BEGIN_NAMESPACE_C99


128 
	`__ex˘y≥
 (
isbœnk
);

130 
__END_NAMESPACE_C99


133 #ifde‡
__USE_GNU


135 
	$is˘y≥
 (
__c
, 
__mask
Ë
__THROW
;

138 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


142 
	$ißscii
 (
__c
Ë
__THROW
;

146 
	$tﬂscii
 (
__c
Ë
__THROW
;

150 
	`__ex˘y≥
 (
_touµî
);

151 
	`__ex˘y≥
 (
_tﬁowî
);

155 
	#__tobody
(
c
, 
f
, 
a
, 
¨gs
) \

156 (
__exãnsi⁄__
 \

157 ({ 
__ªs
; \

158 i‡( (
c
) > 1) \

160 i‡(
	`__buûtö_c⁄°™t_p
 (
c
)) \

162 
__c
 = (
c
); \

163 
__ªs
 = 
__c
 < -128 || __¯> 255 ? __¯: (
a
)[__c]; \

166 
__ªs
 = 
f
 
¨gs
; \

169 
__ªs
 = (
a
)[(Ë(
c
)]; \

170 
__ªs
; 
	}
}))

	)

172 #i‡!
deföed
 
__NO_CTYPE
 && !deföed 
__˝lu•lus


173 
	#iß um
(
c
Ë
	`__is˘y≥
((c), 
_ISÆnum
)

	)

174 
	#ißÕha
(
c
Ë
	`__is˘y≥
((c), 
_ISÆpha
)

	)

175 
	#is˙ål
(
c
Ë
	`__is˘y≥
((c), 
_IS˙ål
)

	)

176 
	#isdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISdigô
)

	)

177 
	#i¶owî
(
c
Ë
	`__is˘y≥
((c), 
_ISlowî
)

	)

178 
	#isgøph
(
c
Ë
	`__is˘y≥
((c), 
_ISgøph
)

	)

179 
	#i•röt
(
c
Ë
	`__is˘y≥
((c), 
_IS¥öt
)

	)

180 
	#i•un˘
(
c
Ë
	`__is˘y≥
((c), 
_ISpun˘
)

	)

181 
	#is•a˚
(
c
Ë
	`__is˘y≥
((c), 
_IS•a˚
)

	)

182 
	#isuµî
(
c
Ë
	`__is˘y≥
((c), 
_ISuµî
)

	)

183 
	#isxdigô
(
c
Ë
	`__is˘y≥
((c), 
_ISxdigô
)

	)

185 #ifde‡
__USE_ISOC99


186 
	#isbœnk
(
c
Ë
	`__is˘y≥
((c), 
_ISbœnk
)

	)

189 #ifde‡
__USE_EXTERN_INLINES


190 
__ölöe
 

191 
	$tﬁowî
 (
__c
Ë
__THROW


193  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_tﬁowî_loc
 ())[__c] : __c;

194 
	}
}

196 
__ölöe
 

197 
	$touµî
 (
__c
Ë
__THROW


199  
__c
 >-128 && __¯< 256 ? (*
	`__˘y≥_touµî_loc
 ())[__c] : __c;

200 
	}
}

203 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


204 
	#tﬁowî
(
c
Ë
	`__tobody
 (c, 
tﬁowî
, *
	`__˘y≥_tﬁowî_loc
 (), (c))

	)

205 
	#touµî
(
c
Ë
	`__tobody
 (c, 
touµî
, *
	`__˘y≥_touµî_loc
 (), (c))

	)

208 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


209 
	#ißscii
(
c
Ë
	`__ißscii
 (c)

	)

210 
	#tﬂscii
(
c
Ë
	`__tﬂscii
 (c)

	)

212 
	#_tﬁowî
(
c
Ë((Ë(*
	`__˘y≥_tﬁowî_loc
 ())[(Ë(c)])

	)

213 
	#_touµî
(
c
Ë((Ë(*
	`__˘y≥_touµî_loc
 ())[(Ë(c)])

	)

219 #ifde‡
__USE_GNU


233 
	~<xloˇÀ.h
>

237 
	#__is˘y≥_l
(
c
, 
ty≥
, 
loˇÀ
) \

238 ((
loˇÀ
)->
__˘y≥_b
[(Ë(
c
)] & (Ë
ty≥
)

	)

240 
	#__ex˘y≥_l
(
«me
) \

241 
	`«me
 (, 
__loˇÀ_t
Ë
__THROW


	)

247 
__ex˘y≥_l
 (
iß um_l
);

248 
__ex˘y≥_l
 (
ißÕha_l
);

249 
__ex˘y≥_l
 (
is˙ål_l
);

250 
__ex˘y≥_l
 (
isdigô_l
);

251 
__ex˘y≥_l
 (
i¶owî_l
);

252 
__ex˘y≥_l
 (
isgøph_l
);

253 
__ex˘y≥_l
 (
i•röt_l
);

254 
__ex˘y≥_l
 (
i•un˘_l
);

255 
__ex˘y≥_l
 (
is•a˚_l
);

256 
__ex˘y≥_l
 (
isuµî_l
);

257 
__ex˘y≥_l
 (
isxdigô_l
);

259 
__ex˘y≥_l
 (
isbœnk_l
);

263 
	$__tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

264 
	$tﬁowî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

267 
	$__touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

268 
	$touµî_l
 (
__c
, 
__loˇÀ_t
 
__l
Ë
__THROW
;

270 #i‡
__GNUC__
 >2 && 
deföed
 
__OPTIMIZE__
 && !deföed 
__˝lu•lus


271 
	#__tﬁowî_l
(
c
, 
loˇÀ
) \

272 
	`__tobody
 (
c
, 
__tﬁowî_l
, (
loˇÀ
)->
__˘y≥_tﬁowî
, (c,ÜoˇÀ))

	)

273 
	#__touµî_l
(
c
, 
loˇÀ
) \

274 
	`__tobody
 (
c
, 
__touµî_l
, (
loˇÀ
)->
__˘y≥_touµî
, (c,ÜoˇÀ))

	)

275 
	#tﬁowî_l
(
c
, 
loˇÀ
Ë
	`__tﬁowî_l
 ((c), (loˇÀ))

	)

276 
	#touµî_l
(
c
, 
loˇÀ
Ë
	`__touµî_l
 ((c), (loˇÀ))

	)

280 #i‚de‡
__NO_CTYPE


281 
	#__iß um_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆnum
, (l))

	)

282 
	#__ißÕha_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISÆpha
, (l))

	)

283 
	#__is˙ål_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS˙ål
, (l))

	)

284 
	#__isdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISdigô
, (l))

	)

285 
	#__i¶owî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISlowî
, (l))

	)

286 
	#__isgøph_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISgøph
, (l))

	)

287 
	#__i•röt_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS¥öt
, (l))

	)

288 
	#__i•un˘_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISpun˘
, (l))

	)

289 
	#__is•a˚_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_IS•a˚
, (l))

	)

290 
	#__isuµî_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISuµî
, (l))

	)

291 
	#__isxdigô_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISxdigô
, (l))

	)

293 
	#__isbœnk_l
(
c
,
l
Ë
	`__is˘y≥_l
((c), 
_ISbœnk
, (l))

	)

295 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


296 
	#__ißscii_l
(
c
,
l
Ë(÷), 
	`__ißscii
 (c))

	)

297 
	#__tﬂscii_l
(
c
,
l
Ë(÷), 
	`__tﬂscii
 (c))

	)

300 
	#iß um_l
(
c
,
l
Ë
	`__iß um_l
 ((c), (l))

	)

301 
	#ißÕha_l
(
c
,
l
Ë
	`__ißÕha_l
 ((c), (l))

	)

302 
	#is˙ål_l
(
c
,
l
Ë
	`__is˙ål_l
 ((c), (l))

	)

303 
	#isdigô_l
(
c
,
l
Ë
	`__isdigô_l
 ((c), (l))

	)

304 
	#i¶owî_l
(
c
,
l
Ë
	`__i¶owî_l
 ((c), (l))

	)

305 
	#isgøph_l
(
c
,
l
Ë
	`__isgøph_l
 ((c), (l))

	)

306 
	#i•röt_l
(
c
,
l
Ë
	`__i•röt_l
 ((c), (l))

	)

307 
	#i•un˘_l
(
c
,
l
Ë
	`__i•un˘_l
 ((c), (l))

	)

308 
	#is•a˚_l
(
c
,
l
Ë
	`__is•a˚_l
 ((c), (l))

	)

309 
	#isuµî_l
(
c
,
l
Ë
	`__isuµî_l
 ((c), (l))

	)

310 
	#isxdigô_l
(
c
,
l
Ë
	`__isxdigô_l
 ((c), (l))

	)

312 
	#isbœnk_l
(
c
,
l
Ë
	`__isbœnk_l
 ((c), (l))

	)

314 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


315 
	#ißscii_l
(
c
,
l
Ë
	`__ißscii_l
 ((c), (l))

	)

316 
	#tﬂscii_l
(
c
,
l
Ë
	`__tﬂscii_l
 ((c), (l))

	)

323 
__END_DECLS


	@/usr/include/dirent.h

23 #i‚def 
_DIRENT_H


24 
	#_DIRENT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ty≥s.h
>

32 #ifde‡
__USE_XOPEN


33 #i‚de‡
__öo_t_deföed


34 #i‚de‡
__USE_FILE_OFFSET64


35 
__öo_t
 
	töo_t
;

37 
__öo64_t
 
	töo_t
;

39 
	#__öo_t_deföed


	)

41 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


42 
__öo64_t
 
	töo64_t
;

43 
	#__öo64_t_deföed


	)

62 
	~<bôs/dúít.h
>

64 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
Ë&& !deföed 
d_fûío


65 
	#d_öo
 
d_fûío


	)

82 #ifde‡
_DIRENT_HAVE_D_NAMLEN


83 
	#_D_EXACT_NAMLEN
(
d
Ë((d)->
d_«mÀn
)

	)

84 
	#_D_ALLOC_NAMLEN
(
d
Ë(
	`_D_EXACT_NAMLEN
 (dË+ 1)

	)

86 
	#_D_EXACT_NAMLEN
(
d
Ë(
	`°æí
 ((d)->
d_«me
))

	)

87 #ifde‡
_DIRENT_HAVE_D_RECLEN


88 
	#_D_ALLOC_NAMLEN
(
d
Ë(((*Ë(dË+ (d)->
d_ª˛í
Ë- &(d)->
d_«me
[0])

	)

90 
	#_D_ALLOC_NAMLEN
(
d
Ë( (d)->
d_«me
 > 1 ?  (d)->d_name : \

91 
	`_D_EXACT_NAMLEN
 (
d
Ë+ 1)

	)

96 #ifde‡
__USE_BSD


100 
	mDT_UNKNOWN
 = 0,

101 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

102 
	mDT_FIFO
 = 1,

103 
	#DT_FIFO
 
DT_FIFO


	)

104 
	mDT_CHR
 = 2,

105 
	#DT_CHR
 
DT_CHR


	)

106 
	mDT_DIR
 = 4,

107 
	#DT_DIR
 
DT_DIR


	)

108 
	mDT_BLK
 = 6,

109 
	#DT_BLK
 
DT_BLK


	)

110 
	mDT_REG
 = 8,

111 
	#DT_REG
 
DT_REG


	)

112 
	mDT_LNK
 = 10,

113 
	#DT_LNK
 
DT_LNK


	)

114 
	mDT_SOCK
 = 12,

115 
	#DT_SOCK
 
DT_SOCK


	)

116 
	mDT_WHT
 = 14

117 
	#DT_WHT
 
DT_WHT


	)

121 
	#IFTODT
(
mode
Ë(((modeË& 0170000Ë>> 12)

	)

122 
	#DTTOIF
(
dúty≥
Ë((dúty≥Ë<< 12)

	)

128 
__dú°ªam
 
	tDIR
;

135 
DIR
 *
›ídú
 (
__c⁄°
 *
__«me
);

142 
˛o£dú
 (
DIR
 *
__dúp
);

154 #i‚de‡
__USE_FILE_OFFSET64


155 
dúít
 *
ªaddú
 (
DIR
 *
__dúp
);

157 #ifde‡
__REDIRECT


158 
dúít
 *
__REDIRECT
 (
ªaddú
, (
DIR
 *
__dúp
), 
ªaddú64
);

160 
	#ªaddú
 
ªaddú64


	)

164 #ifde‡
__USE_LARGEFILE64


165 
dúít64
 *
ªaddú64
 (
DIR
 *
__dúp
);

168 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


174 #i‚de‡
__USE_FILE_OFFSET64


175 
ªaddú_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

176 
dúít
 *
__ª°ri˘
 
__íåy
,

177 
dúít
 **
__ª°ri˘
 
__ªsu…
);

179 #ifde‡
__REDIRECT


180 
__REDIRECT
 (
ªaddú_r
,

181 (
DIR
 *
__ª°ri˘
 
__dúp
,

182 
dúít
 *
__ª°ri˘
 
__íåy
,

183 
dúít
 **
__ª°ri˘
 
__ªsu…
),

184 
ªaddú64_r
);

186 
	#ªaddú_r
 
ªaddú64_r


	)

190 #ifde‡
__USE_LARGEFILE64


191 
ªaddú64_r
 (
DIR
 *
__ª°ri˘
 
__dúp
,

192 
dúít64
 *
__ª°ri˘
 
__íåy
,

193 
dúít64
 **
__ª°ri˘
 
__ªsu…
);

198 
	$ªwöddú
 (
DIR
 *
__dúp
Ë
__THROW
;

200 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


201 
	~<bôs/ty≥s.h
>

204 
	$£ekdú
 (
DIR
 *
__dúp
, 
__pos
Ë
__THROW
;

207 
	$ãŒdú
 (
DIR
 *
__dúp
Ë
__THROW
;

210 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC


213 
	$dúfd
 (
DIR
 *
__dúp
Ë
__THROW
;

215 #i‡
deföed
 
__OPTIMIZE__
 && deföed 
_DIR_dúfd


216 
	#dúfd
(
dúp
Ë
	`_DIR_dúfd
 (dúp)

	)

219 #i‚de‡
MAXNAMLEN


221 
	~<bôs/posix1_lim.h
>

224 #ifde‡
NAME_MAX


225 
	#MAXNAMLEN
 
NAME_MAX


	)

227 
	#MAXNAMLEN
 255

	)

231 
	#__√ed_size_t


	)

232 
	~<°ddef.h
>

238 #i‚de‡
__USE_FILE_OFFSET64


239 
	`sˇndú
 (
__c⁄°
 *
__ª°ri˘
 
__dú
,

240 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

241 (*
__£À˘‹
Ë(
__c⁄°
 
dúít
 *),

242 (*
__cmp
Ë(
__c⁄°
 *, __const *));

244 #ifde‡
__REDIRECT


245 
	`__REDIRECT
 (
sˇndú
,

246 (
__c⁄°
 *
__ª°ri˘
 
__dú
,

247 
dúít
 ***
__ª°ri˘
 
__«mñi°
,

248 (*
__£À˘‹
Ë(
__c⁄°
 
dúít
 *),

249 (*
__cmp
Ë(
__c⁄°
 *, __const *)),

250 
sˇndú64
);

252 
	#sˇndú
 
sˇndú64


	)

256 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


259 
	`sˇndú64
 (
__c⁄°
 *
__ª°ri˘
 
__dú
,

260 
dúít64
 ***
__ª°ri˘
 
__«mñi°
,

261 (*
__£À˘‹
Ë(
__c⁄°
 
dúít64
 *),

262 (*
__cmp
Ë(
__c⁄°
 *, __const *));

266 #i‚de‡
__USE_FILE_OFFSET64


267 
	$Æphas‹t
 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
)

268 
__THROW
 
__©åibuã_puª__
;

270 #ifde‡
__REDIRECT


271 
	`__REDIRECT
 (
Æphas‹t
,

272 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
Ë
__THROW
,

273 
Æphas‹t64
Ë
__©åibuã_puª__
;

275 
	#Æphas‹t
 
Æphas‹t64


	)

279 #i‡
deföed
 
__USE_GNU
 && deföed 
__USE_LARGEFILE64


280 
	$Æphas‹t64
 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
)

281 
__THROW
 
__©åibuã_puª__
;

284 #ifde‡
__USE_GNU


286 #i‚de‡
__USE_FILE_OFFSET64


287 
	$vîsi⁄s‹t
 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
)

288 
__THROW
 
__©åibuã_puª__
;

290 #ifde‡
__REDIRECT


291 
	`__REDIRECT
 (
vîsi⁄s‹t
,

292 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
Ë
__THROW
,

293 
vîsi⁄s‹t64
Ë
__©åibuã_puª__
;

295 
	#vîsi⁄s‹t
 
vîsi⁄s‹t64


	)

299 #ifde‡
__USE_LARGEFILE64


300 
	$vîsi⁄s‹t64
 (
__c⁄°
 *
__e1
, __c⁄° *
__e2
)

301 
__THROW
 
__©åibuã_puª__
;

309 #i‚de‡
__USE_FILE_OFFSET64


310 
__ssize_t
 
	$gëdúíåõs
 (
__fd
, *
__ª°ri˘
 
__buf
,

311 
size_t
 
__nbyãs
,

312 
__off_t
 *
__ª°ri˘
 
__ba£p
Ë
__THROW
;

314 #ifde‡
__REDIRECT


315 
__ssize_t
 
	`__REDIRECT
 (
gëdúíåõs
,

316 (
__fd
, *
__ª°ri˘
 
__buf
,

317 
size_t
 
__nbyãs
,

318 
__off64_t
 *
__ª°ri˘
 
__ba£p
Ë
__THROW
,

319 
gëdúíåõs64
);

321 
	#gëdúíåõs
 
gëdúíåõs64


	)

325 #ifde‡
__USE_LARGEFILE64


326 
__ssize_t
 
	$gëdúíåõs64
 (
__fd
, *
__ª°ri˘
 
__buf
,

327 
size_t
 
__nbyãs
,

328 
__off64_t
 *
__ª°ri˘
 
__ba£p
Ë
__THROW
;

333 
__END_DECLS


	@/usr/include/endian.h

19 #i‚def 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<„©uªs.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<bôs/ídün.h
>

41 #i‚de‡
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËLO, 
	)
HI

54 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
ËHI, 
	)
LO

	@/usr/include/errno.h

23 #i‚def 
_ERRNO_H


27 #i‚def 
__√ed_Em©h


28 
	#_ERRNO_H
 1

	)

29 
	~<„©uªs.h
>

32 
	g__BEGIN_DECLS


36 
	~<bôs/î∫o.h
>

37 #unde‡
__√ed_Em©h


39 #ifdef 
_ERRNO_H


46 #i‚def 
î∫o


47 
î∫o
;

50 #ifde‡
__USE_GNU


55 *
¥ogøm_övoˇti⁄_«me
, *
¥ogøm_övoˇti⁄_sh‹t_«me
;

59 
	g__END_DECLS


67 #i‡
deföed
 
__USE_GNU
 || deföed 
__√ed_îr‹_t


68 #i‚de‡
__îr‹_t_deföed


69 
	tîr‹_t
;

70 
	#__îr‹_t_deföed
 1

	)

72 #unde‡
__√ed_îr‹_t


	@/usr/include/fcntl.h

23 #i‚def 
_FCNTL_H


24 
	#_FCNTL_H
 1

	)

26 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 
	~<bôs/f˙é.h
>

36 #ifde‡
__USE_XOPEN


37 
	~<sys/°©.h
>

40 #ifdef 
__USE_MISC


41 #i‚de‡
R_OK


44 
	#R_OK
 4

	)

45 
	#W_OK
 2

	)

46 
	#X_OK
 1

	)

47 
	#F_OK
 0

	)

52 #ifde‡
__USE_XOPEN


53 
	#SEEK_SET
 0

	)

54 
	#SEEK_CUR
 1

	)

55 
	#SEEK_END
 2

	)

63 
f˙é
 (
__fd
, 
__cmd
, ...);

71 #i‚de‡
__USE_FILE_OFFSET64


72 
›í
 (
__c⁄°
 *
__fûe
, 
__oÊag
, ...);

74 #ifde‡
__REDIRECT


75 
__REDIRECT
 (
›í
, (
__c⁄°
 *
__fûe
, 
__oÊag
, ...), 
›í64
);

77 
	#›í
 
›í64


	)

80 #ifde‡
__USE_LARGEFILE64


81 
›í64
 (
__c⁄°
 *
__fûe
, 
__oÊag
, ...);

89 #i‚de‡
__USE_FILE_OFFSET64


90 
¸ót
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
);

92 #ifde‡
__REDIRECT


93 
__REDIRECT
 (
¸ót
, (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
),

94 
¸ót64
);

96 
	#¸ót
 
¸ót64


	)

99 #ifde‡
__USE_LARGEFILE64


100 
¸ót64
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
);

103 #i‡!
deföed
 
F_LOCK
 && (deföed 
__USE_MISC
 || (deföed 
__USE_XOPEN_EXTENDED
 \

104 && !
deföed
 
	g__USE_POSIX
))

113 
	#F_ULOCK
 0

	)

114 
	#F_LOCK
 1

	)

115 
	#F_TLOCK
 2

	)

116 
	#F_TEST
 3

	)

118 #i‚de‡
__USE_FILE_OFFSET64


119 
lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
);

121 #ifde‡
__REDIRECT


122 
__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
), 
lockf64
);

124 
	#lockf
 
lockf64


	)

127 #ifde‡
__USE_LARGEFILE64


128 
lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
);

132 #ifde‡
__USE_XOPEN2K


135 #i‚de‡
__USE_FILE_OFFSET64


136 
	$posix_Ádvi£
 (
__fd
, 
__off_t
 
__off£t
, __off_à
__Àn
,

137 
__advi£
Ë
__THROW
;

139 #ifde‡
__REDIRECT


140 
	`__REDIRECT
 (
posix_Ádvi£
, (
__fd
, 
__off64_t
 
__off£t
,

141 
__off64_t
 
__Àn
, 
__advi£
Ë
__THROW
,

142 
posix_Ádvi£64
);

144 
	#posix_Ádvi£
 
posix_Ádvi£64


	)

147 #ifde‡
__USE_LARGEFILE64


148 
	$posix_Ádvi£64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__Àn
,

149 
__advi£
Ë
__THROW
;

157 #i‚de‡
__USE_FILE_OFFSET64


158 
	`posix_ÁŒoˇã
 (
__fd
, 
__off_t
 
__off£t
, __off_à
__Àn
);

160 #ifde‡
__REDIRECT


161 
	`__REDIRECT
 (
posix_ÁŒoˇã
, (
__fd
, 
__off64_t
 
__off£t
,

162 
__off64_t
 
__Àn
),

163 
posix_ÁŒoˇã64
);

165 
	#posix_ÁŒoˇã
 
posix_ÁŒoˇã64


	)

168 #ifde‡
__USE_LARGEFILE64


169 
	`posix_ÁŒoˇã64
 (
__fd
, 
__off64_t
 
__off£t
, __off64_à
__Àn
);

173 
__END_DECLS


	@/usr/include/getopt.h

20 #i‚de‡
_GETOPT_H


22 #i‚de‡
__√ed_gë›t


23 
	#_GETOPT_H
 1

	)

33 #i‡!
deföed
 
__GNU_LIBRARY__


34 
	~<˘y≥.h
>

37 #i‚de‡
__THROW


38 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

39 
	#__THROW
 
	`throw
 ()

	)

41 
	#__THROW


	)

45 #ifdef 
__˝lu•lus


55 *
›èrg
;

69 
›töd
;

74 
›ãº
;

78 
›t›t
;

80 #i‚de‡
__√ed_gë›t


102 
	s›ti⁄


104 #i‡(
deföed
 
__STDC__
 && __STDC__Ë|| deföed 
__˝lu•lus


105 c⁄° *
	g«me
;

107 *
	g«me
;

111 
	ghas_¨g
;

112 *
	gÊag
;

113 
	gvÆ
;

118 
	#no_¨gumít
 0

	)

119 
	#ªquúed_¨gumít
 1

	)

120 
	#›ti⁄Æ_¨gumít
 2

	)

148 #i‡(
deföed
 
__STDC__
 && __STDC__Ë|| deföed 
__˝lu•lus


149 #ifde‡
__GNU_LIBRARY__


153 
gë›t
 (
___¨gc
, *c⁄° *
___¨gv
, c⁄° *
__sh‹t›ts
)

154 
__THROW
;

156 
gë›t
 ();

159 #i‚de‡
__√ed_gë›t


160 
gë›t_l⁄g
 (
___¨gc
, *c⁄° *
___¨gv
,

161 c⁄° *
__sh‹t›ts
,

162 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

163 
__THROW
;

164 
gë›t_l⁄g_⁄ly
 (
___¨gc
, *c⁄° *
___¨gv
,

165 c⁄° *
__sh‹t›ts
,

166 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
)

167 
__THROW
;

170 
_gë›t_öã∫Æ
 (
___¨gc
, *c⁄° *
___¨gv
,

171 c⁄° *
__sh‹t›ts
,

172 c⁄° 
›ti⁄
 *
__l⁄g›ts
, *
__l⁄göd
,

173 
__l⁄g_⁄ly
);

176 
gë›t
 ();

177 #i‚de‡
__√ed_gë›t


178 
gë›t_l⁄g
 ();

179 
gë›t_l⁄g_⁄ly
 ();

181 
_gë›t_öã∫Æ
 ();

185 #ifdef 
__˝lu•lus


190 #unde‡
__√ed_gë›t


	@/usr/include/limits.h

23 #i‚de‡
_LIBC_LIMITS_H_


24 
	#_LIBC_LIMITS_H_
 1

	)

26 
	~<„©uªs.h
>

32 
	#MB_LEN_MAX
 16

	)

37 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

42 #i‚de‡
_LIMITS_H


43 
	#_LIMITS_H
 1

	)

45 
	~<bôs/w‹dsize.h
>

54 
	#CHAR_BIT
 8

	)

57 
	#SCHAR_MIN
 (-128)

	)

58 
	#SCHAR_MAX
 127

	)

61 
	#UCHAR_MAX
 255

	)

64 #ifde‡
__CHAR_UNSIGNED__


65 
	#CHAR_MIN
 0

	)

66 
	#CHAR_MAX
 
UCHAR_MAX


	)

68 
	#CHAR_MIN
 
SCHAR_MIN


	)

69 
	#CHAR_MAX
 
SCHAR_MAX


	)

73 
	#SHRT_MIN
 (-32768)

	)

74 
	#SHRT_MAX
 32767

	)

77 
	#USHRT_MAX
 65535

	)

80 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

81 
	#INT_MAX
 2147483647

	)

84 
	#UINT_MAX
 4294967295U

	)

87 #i‡
__WORDSIZE
 == 64

88 
	#LONG_MAX
 9223372036854775807L

	)

90 
	#LONG_MAX
 2147483647L

	)

92 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

95 #i‡
__WORDSIZE
 == 64

96 
	#ULONG_MAX
 18446744073709551615UL

	)

98 
	#ULONG_MAX
 4294967295UL

	)

101 #ifde‡
__USE_ISOC99


104 
	#LLONG_MAX
 9223372036854775807LL

	)

105 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

108 
	#ULLONG_MAX
 18446744073709551615ULL

	)

122 #i‡
deföed
 
__GNUC__
 && !deföed 
_GCC_LIMITS_H_


124 #ö˛ude_√xà<
limôs
.
h
>

129 #ifde‡
__USE_ISOC99


130 #i‚de‡
LLONG_MIN


131 
	#LLONG_MIN
 
LONG_LONG_MIN


	)

133 #i‚de‡
LLONG_MAX


134 
	#LLONG_MAX
 
LONG_LONG_MAX


	)

136 #i‚de‡
ULLONG_MAX


137 
	#ULLONG_MAX
 
ULONG_LONG_MAX


	)

142 #ifdef 
__USE_POSIX


144 
	~<bôs/posix1_lim.h
>

147 #ifdef 
__USE_POSIX2


148 
	~<bôs/posix2_lim.h
>

151 #ifdef 
__USE_XOPEN


152 
	~<bôs/x›í_lim.h
>

	@/usr/include/linux/fb.h

1 #i‚de‡
_LINUX_FB_H


2 
	#_LINUX_FB_H


	)

4 
	~<löux/ây.h
>

5 
	~<asm/ty≥s.h
>

9 
	#FB_MAJOR
 29

	)

10 
	#FB_MAX
 32

	)

14 
	#FBIOGET_VSCREENINFO
 0x4600

	)

15 
	#FBIOPUT_VSCREENINFO
 0x4601

	)

16 
	#FBIOGET_FSCREENINFO
 0x4602

	)

17 
	#FBIOGETCMAP
 0x4604

	)

18 
	#FBIOPUTCMAP
 0x4605

	)

19 
	#FBIOPAN_DISPLAY
 0x4606

	)

20 
	#FBIO_CURSOR
 
	`_IOWR
('F', 0x08, 
fb_curs‹
)

	)

25 
	#FBIOGET_CON2FBMAP
 0x460F

	)

26 
	#FBIOPUT_CON2FBMAP
 0x4610

	)

27 
	#FBIOBLANK
 0x4611

	)

28 
	#FBIOGET_VBLANK
 
	`_IOR
('F', 0x12, 
fb_vbœnk
)

	)

29 
	#FBIO_ALLOC
 0x4613

	)

30 
	#FBIO_FREE
 0x4614

	)

31 
	#FBIOGET_GLYPH
 0x4615

	)

32 
	#FBIOGET_HWCINFO
 0x4616

	)

33 
	#FBIOPUT_MODEINFO
 0x4617

	)

34 
	#FBIOGET_DISPINFO
 0x4618

	)

37 
	#FB_TYPE_PACKED_PIXELS
 0

	)

38 
	#FB_TYPE_PLANES
 1

	)

39 
	#FB_TYPE_INTERLEAVED_PLANES
 2

	)

40 
	#FB_TYPE_TEXT
 3

	)

41 
	#FB_TYPE_VGA_PLANES
 4

	)

43 
	#FB_AUX_TEXT_MDA
 0

	)

44 
	#FB_AUX_TEXT_CGA
 1

	)

45 
	#FB_AUX_TEXT_S3_MMIO
 2

	)

46 
	#FB_AUX_TEXT_MGA_STEP16
 3

	)

47 
	#FB_AUX_TEXT_MGA_STEP8
 4

	)

49 
	#FB_AUX_VGA_PLANES_VGA4
 0

	)

50 
	#FB_AUX_VGA_PLANES_CFB4
 1

	)

51 
	#FB_AUX_VGA_PLANES_CFB8
 2

	)

53 
	#FB_VISUAL_MONO01
 0

	)

54 
	#FB_VISUAL_MONO10
 1

	)

55 
	#FB_VISUAL_TRUECOLOR
 2

	)

56 
	#FB_VISUAL_PSEUDOCOLOR
 3

	)

57 
	#FB_VISUAL_DIRECTCOLOR
 4

	)

58 
	#FB_VISUAL_STATIC_PSEUDOCOLOR
 5

	)

60 
	#FB_ACCEL_NONE
 0

	)

61 
	#FB_ACCEL_ATARIBLITT
 1

	)

62 
	#FB_ACCEL_AMIGABLITT
 2

	)

63 
	#FB_ACCEL_S3_TRIO64
 3

	)

64 
	#FB_ACCEL_NCR_77C32BLT
 4

	)

65 
	#FB_ACCEL_S3_VIRGE
 5

	)

66 
	#FB_ACCEL_ATI_MACH64GX
 6

	)

67 
	#FB_ACCEL_DEC_TGA
 7

	)

68 
	#FB_ACCEL_ATI_MACH64CT
 8

	)

69 
	#FB_ACCEL_ATI_MACH64VT
 9

	)

70 
	#FB_ACCEL_ATI_MACH64GT
 10

	)

71 
	#FB_ACCEL_SUN_CREATOR
 11

	)

72 
	#FB_ACCEL_SUN_CGSIX
 12

	)

73 
	#FB_ACCEL_SUN_LEO
 13

	)

74 
	#FB_ACCEL_IMS_TWINTURBO
 14

	)

75 
	#FB_ACCEL_3DLABS_PERMEDIA2
 15

	)

76 
	#FB_ACCEL_MATROX_MGA2064W
 16

	)

77 
	#FB_ACCEL_MATROX_MGA1064SG
 17

	)

78 
	#FB_ACCEL_MATROX_MGA2164W
 18

	)

79 
	#FB_ACCEL_MATROX_MGA2164W_AGP
 19

	)

80 
	#FB_ACCEL_MATROX_MGAG100
 20

	)

81 
	#FB_ACCEL_MATROX_MGAG200
 21

	)

82 
	#FB_ACCEL_SUN_CG14
 22

	)

83 
	#FB_ACCEL_SUN_BWTWO
 23

	)

84 
	#FB_ACCEL_SUN_CGTHREE
 24

	)

85 
	#FB_ACCEL_SUN_TCX
 25

	)

86 
	#FB_ACCEL_MATROX_MGAG400
 26

	)

87 
	#FB_ACCEL_NV3
 27

	)

88 
	#FB_ACCEL_NV4
 28

	)

89 
	#FB_ACCEL_NV5
 29

	)

90 
	#FB_ACCEL_CT_6555x
 30

	)

91 
	#FB_ACCEL_3DFX_BANSHEE
 31

	)

92 
	#FB_ACCEL_ATI_RAGE128
 32

	)

93 
	#FB_ACCEL_IGS_CYBER2000
 33

	)

94 
	#FB_ACCEL_IGS_CYBER2010
 34

	)

95 
	#FB_ACCEL_IGS_CYBER5000
 35

	)

96 
	#FB_ACCEL_SIS_GLAMOUR
 36

	)

97 
	#FB_ACCEL_3DLABS_PERMEDIA3
 37

	)

98 
	#FB_ACCEL_ATI_RADEON
 38

	)

99 
	#FB_ACCEL_I810
 39

	)

100 
	#FB_ACCEL_SIS_GLAMOUR_2
 40

	)

101 
	#FB_ACCEL_SIS_XABRE
 41

	)

103 
	#FB_ACCEL_NEOMAGIC_NM2070
 90

	)

104 
	#FB_ACCEL_NEOMAGIC_NM2090
 91

	)

105 
	#FB_ACCEL_NEOMAGIC_NM2093
 92

	)

106 
	#FB_ACCEL_NEOMAGIC_NM2097
 93

	)

107 
	#FB_ACCEL_NEOMAGIC_NM2160
 94

	)

108 
	#FB_ACCEL_NEOMAGIC_NM2200
 95

	)

109 
	#FB_ACCEL_NEOMAGIC_NM2230
 96

	)

110 
	#FB_ACCEL_NEOMAGIC_NM2360
 97

	)

111 
	#FB_ACCEL_NEOMAGIC_NM2380
 98

	)

114 
	sfb_fix_s¸ìnöfo
 {

115 
	mid
[16];

116 
	msmem_°¨t
;

118 
__u32
 
	msmem_Àn
;

119 
__u32
 
	mty≥
;

120 
__u32
 
	mty≥_aux
;

121 
__u32
 
	mvisuÆ
;

122 
__u16
 
	mx∑n°ï
;

123 
__u16
 
	my∑n°ï
;

124 
__u16
 
	mywøp°ï
;

125 
__u32
 
	mlöe_Àngth
;

126 
	mmmio_°¨t
;

128 
__u32
 
	mmmio_Àn
;

129 
__u32
 
	mac˚l
;

130 
__u16
 
	mª£rved
[3];

139 
	sfb_bôfõld
 {

140 
__u32
 
	moff£t
;

141 
__u32
 
	mÀngth
;

142 
__u32
 
	mmsb_right
;

146 
	#FB_NONSTD_HAM
 1

	)

148 
	#FB_ACTIVATE_NOW
 0

	)

149 
	#FB_ACTIVATE_NXTOPEN
 1

	)

150 
	#FB_ACTIVATE_TEST
 2

	)

151 
	#FB_ACTIVATE_MASK
 15

	)

153 
	#FB_ACTIVATE_VBL
 16

	)

154 
	#FB_CHANGE_CMAP_VBL
 32

	)

155 
	#FB_ACTIVATE_ALL
 64

	)

157 
	#FB_ACCELF_TEXT
 1

	)

159 
	#FB_SYNC_HOR_HIGH_ACT
 1

	)

160 
	#FB_SYNC_VERT_HIGH_ACT
 2

	)

161 
	#FB_SYNC_EXT
 4

	)

162 
	#FB_SYNC_COMP_HIGH_ACT
 8

	)

163 
	#FB_SYNC_BROADCAST
 16

	)

166 
	#FB_SYNC_ON_GREEN
 32

	)

168 
	#FB_VMODE_NONINTERLACED
 0

	)

169 
	#FB_VMODE_INTERLACED
 1

	)

170 
	#FB_VMODE_DOUBLE
 2

	)

171 
	#FB_VMODE_MASK
 255

	)

173 
	#FB_VMODE_YWRAP
 256

	)

174 
	#FB_VMODE_SMOOTH_XPAN
 512

	)

175 
	#FB_VMODE_CONUPDATE
 512

	)

177 
	#PICOS2KHZ
(
a
Ë(1000000000UL/◊))

	)

178 
	#KHZ2PICOS
(
a
Ë(1000000000UL/◊))

	)

180 
	sfb_v¨_s¸ìnöfo
 {

181 
__u32
 
	mxªs
;

182 
__u32
 
	myªs
;

183 
__u32
 
	mxªs_vútuÆ
;

184 
__u32
 
	myªs_vútuÆ
;

185 
__u32
 
	mxoff£t
;

186 
__u32
 
	myoff£t
;

188 
__u32
 
	mbôs_≥r_pixñ
;

189 
__u32
 
	mgøysˇÀ
;

191 
fb_bôfõld
 
	mªd
;

192 
fb_bôfõld
 
	mgªí
;

193 
fb_bôfõld
 
	mblue
;

194 
fb_bôfõld
 
	må™•
;

196 
__u32
 
	mn⁄°d
;

198 
__u32
 
	ma˘iv©e
;

200 
__u32
 
	mheight
;

201 
__u32
 
	mwidth
;

203 
__u32
 
	mac˚l_Êags
;

206 
__u32
 
	mpix˛ock
;

207 
__u32
 
	mÀ·_m¨gö
;

208 
__u32
 
	mright_m¨gö
;

209 
__u32
 
	muµî_m¨gö
;

210 
__u32
 
	mlowî_m¨gö
;

211 
__u32
 
	mhsync_Àn
;

212 
__u32
 
	mvsync_Àn
;

213 
__u32
 
	msync
;

214 
__u32
 
	mvmode
;

215 
__u32
 
	mrŸ©e
;

216 
__u32
 
	mª£rved
[5];

219 
	sfb_cm≠
 {

220 
__u32
 
	m°¨t
;

221 
__u32
 
	mÀn
;

222 
__u16
 *
	mªd
;

223 
__u16
 *
	mgªí
;

224 
__u16
 *
	mblue
;

225 
__u16
 *
	må™•
;

228 
	sfb_c⁄2fbm≠
 {

229 
__u32
 
	mc⁄sﬁe
;

230 
__u32
 
	m‰amebuf„r
;

234 
	#VESA_NO_BLANKING
 0

	)

235 
	#VESA_VSYNC_SUSPEND
 1

	)

236 
	#VESA_HSYNC_SUSPEND
 2

	)

237 
	#VESA_POWERDOWN
 3

	)

239 
	sfb_m⁄•ecs
 {

240 
__u32
 
	mhfmö
;

241 
__u32
 
	mhfmax
;

242 
__u16
 
	mvfmö
;

243 
__u16
 
	mvfmax
;

244 
__u32
 
	md˛kmö
;

245 
__u32
 
	md˛kmax
;

246 
	mgtf
 : 1;

247 
	mdpms
 : 1;

250 
	#FB_VBLANK_VBLANKING
 0x001

	)

251 
	#FB_VBLANK_HBLANKING
 0x002

	)

252 
	#FB_VBLANK_HAVE_VBLANK
 0x004

	)

253 
	#FB_VBLANK_HAVE_HBLANK
 0x008

	)

254 
	#FB_VBLANK_HAVE_COUNT
 0x010

	)

255 
	#FB_VBLANK_HAVE_VCOUNT
 0x020

	)

256 
	#FB_VBLANK_HAVE_HCOUNT
 0x040

	)

257 
	#FB_VBLANK_VSYNCING
 0x080

	)

258 
	#FB_VBLANK_HAVE_VSYNC
 0x100

	)

260 
	sfb_vbœnk
 {

261 
__u32
 
	mÊags
;

262 
__u32
 
	mcou¡
;

263 
__u32
 
	mvcou¡
;

264 
__u32
 
	mhcou¡
;

265 
__u32
 
	mª£rved
[4];

269 
	#ROP_COPY
 0

	)

270 
	#ROP_XOR
 1

	)

272 
	sfb_c›y¨ó
 {

273 
__u32
 
	mdx
;

274 
__u32
 
	mdy
;

275 
__u32
 
	mwidth
;

276 
__u32
 
	mheight
;

277 
__u32
 
	msx
;

278 
__u32
 
	msy
;

281 
	sfb_fûÃe˘
 {

282 
__u32
 
	mdx
;

283 
__u32
 
	mdy
;

284 
__u32
 
	mwidth
;

285 
__u32
 
	mheight
;

286 
__u32
 
	mcﬁ‹
;

287 
__u32
 
	mr›
;

290 
	sfb_image
 {

291 
__u32
 
	mdx
;

292 
__u32
 
	mdy
;

293 
__u32
 
	mwidth
;

294 
__u32
 
	mheight
;

295 
__u32
 
	mfg_cﬁ‹
;

296 
__u32
 
	mbg_cﬁ‹
;

297 
__u8
 
	mdïth
;

298 c⁄° *
	md©a
;

299 
fb_cm≠
 
	mcm≠
;

306 
	#FB_CUR_SETCUR
 0x01

	)

307 
	#FB_CUR_SETPOS
 0x02

	)

308 
	#FB_CUR_SETHOT
 0x04

	)

309 
	#FB_CUR_SETCMAP
 0x08

	)

310 
	#FB_CUR_SETSHAPE
 0x10

	)

311 
	#FB_CUR_SETSIZE
 0x20

	)

312 
	#FB_CUR_SETALL
 0xFF

	)

314 
	sfbcuΩos
 {

315 
__u16
 
	mx
, 
	my
;

318 
	sfb_curs‹
 {

319 
__u16
 
	m£t
;

320 
__u16
 
	míabÀ
;

321 
__u16
 
	mr›
;

322 *
	mmask
;

323 
fbcuΩos
 
	mhŸ
;

324 
fb_image
 
	mimage
;

327 
	#FB_PIXMAP_DEFAULT
 1

	)

328 
	#FB_PIXMAP_SYSTEM
 2

	)

329 
	#FB_PIXMAP_IO
 4

	)

330 
	#FB_PIXMAP_SYNC
 256

	)

332 #ifde‡
__KERNEL__


334 
	~<löux/fs.h
>

335 
	~<löux/öô.h
>

336 
	~<löux/w‹kqueue.h
>

337 
	~<asm/io.h
>

339 
	gfb_öfo
;

340 
	gvm_¨ó_°ru˘
;

341 
	gfûe
;

347 
	sfb_›s
 {

349 
moduÀ
 *
	mow√r
;

350 (*
	mfb_›í
)(
fb_öfo
 *
	möfo
, 
	mu£r
);

351 (*
	mfb_ªÀa£
)(
fb_öfo
 *
	möfo
, 
	mu£r
);

353 
ssize_t
 (*
fb_ªad
)(
fûe
 *
	mfûe
, *
	mbuf
, 
size_t
 
	mcou¡
, 
loff_t
 *
	mµos
);

354 
ssize_t
 (*
fb_wrôe
)(
fûe
 *
	mfûe
, c⁄° *
	mbuf
, 
size_t
 
	mcou¡
, 
loff_t
 *
	mµos
);

356 (*
	mfb_check_v¨
)(
fb_v¨_s¸ìnöfo
 *
	mv¨
, 
fb_öfo
 *
	möfo
);

358 (*
	mfb_£t_∑r
)(
fb_öfo
 *
	möfo
);

360 (*
	mfb_£tcﬁªg
)(
	mªgno
, 
	mªd
, 
	mgªí
,

361 
	mblue
, 
	må™•
, 
fb_öfo
 *
	möfo
);

363 (*
	mfb_bœnk
)(
	mbœnk
, 
fb_öfo
 *
	möfo
);

365 (*
	mfb_∑n_di•œy
)(
fb_v¨_s¸ìnöfo
 *
	mv¨
, 
fb_öfo
 *
	möfo
);

367 (*
	mfb_fûÃe˘
)(
fb_öfo
 *
	möfo
, c⁄° 
fb_fûÃe˘
 *
	mª˘
);

369 (*
	mfb_c›y¨ó
)(
fb_öfo
 *
	möfo
,c⁄° 
fb_c›y¨ó
 *
	mªgi⁄
);

371 (*
	mfb_imageblô
)(
fb_öfo
 *
	möfo
, c⁄° 
fb_image
 *
	mimage
);

373 (*
	mfb_curs‹
)(
fb_öfo
 *
	möfo
, 
fb_curs‹
 *
	mcurs‹
);

375 (*
	mfb_rŸ©e
)(
fb_öfo
 *
	möfo
, 
	m™gÀ
);

377 (*
	mfb_sync
)(
fb_öfo
 *
	möfo
);

379 (*
	mfb_io˘l
)(
öode
 *
	möode
, 
fûe
 *
	mfûe
, 
	mcmd
,

380 
	m¨g
, 
fb_öfo
 *
	möfo
);

382 (*
	mfb_mm≠
)(
fb_öfo
 *
	möfo
, 
fûe
 *
	mfûe
, 
vm_¨ó_°ru˘
 *
	mvma
);

385 
	sfb_pixm≠
 {

386 
__u8
 *
	maddr
;

387 
__u32
 
	msize
;

388 
__u32
 
	moff£t
;

389 
__u32
 
	mbuf_Æign
;

390 
__u32
 
	msˇn_Æign
;

391 
__u32
 
	mÊags
;

393 (*
	moutbuf
)(
u8
 *
	md°
, u8 *
	maddr
, 
	msize
);

394 
u8
 (*
öbuf
Ë(u8 *
	maddr
);

395 
•ölock_t
 
	mlock
;

396 
©omic_t
 
	mcou¡
;

399 
	sfb_öfo
 {

400 
	mnode
;

401 
	mÊags
;

402 
	m›í
;

403 
	#FBINFO_FLAG_MODULE
 1

	)

404 
fb_v¨_s¸ìnöfo
 
	mv¨
;

405 
fb_fix_s¸ìnöfo
 
	mfix
;

406 
fb_m⁄•ecs
 
	mm⁄•ecs
;

407 
fb_curs‹
 
	mcurs‹
;

408 
w‹k_°ru˘
 
	mqueue
;

409 
fb_pixm≠
 
	mpixm≠
;

410 
fb_cm≠
 
	mcm≠
;

411 
fb_›s
 *
	mfb›s
;

412 *
	ms¸ìn_ba£
;

413 
vc_d©a
 *
	mdi•œy_fg
;

414 
	mcuºc⁄
;

415 *
	mp£udo_∑Àâe
;

417 *
	m∑r
;

420 #ifde‡
MODULE


421 
	#FBINFO_FLAG_DEFAULT
 
FBINFO_FLAG_MODULE


	)

423 
	#FBINFO_FLAG_DEFAULT
 0

	)

426 #i‡
deföed
(
__•¨c__
)

432 
	#fb_ªadb
 
sbus_ªadb


	)

433 
	#fb_ªadw
 
sbus_ªadw


	)

434 
	#fb_ªadl
 
sbus_ªadl


	)

435 
	#fb_ªadq
 
sbus_ªadq


	)

436 
	#fb_wrôeb
 
sbus_wrôeb


	)

437 
	#fb_wrôew
 
sbus_wrôew


	)

438 
	#fb_wrôñ
 
sbus_wrôñ


	)

439 
	#fb_wrôeq
 
sbus_wrôeq


	)

440 
	#fb_mem£t
 
sbus_mem£t_io


	)

442 #ñi‡
deföed
(
__i386__
Ë|| deföed(
__Æpha__
Ë|| deföed(
__x86_64__
Ë|| deföed(
__hµa__
)

444 
	#fb_ªadb
 
__øw_ªadb


	)

445 
	#fb_ªadw
 
__øw_ªadw


	)

446 
	#fb_ªadl
 
__øw_ªadl


	)

447 
	#fb_ªadq
 
__øw_ªadq


	)

448 
	#fb_wrôeb
 
__øw_wrôeb


	)

449 
	#fb_wrôew
 
__øw_wrôew


	)

450 
	#fb_wrôñ
 
__øw_wrôñ


	)

451 
	#fb_wrôeq
 
__øw_wrôeq


	)

452 
	#fb_mem£t
 
mem£t_io


	)

456 
	#fb_ªadb
(
addr
Ë(*(vﬁ©ûê
u8
 *Ë◊ddr))

	)

457 
	#fb_ªadw
(
addr
Ë(*(vﬁ©ûê
u16
 *Ë◊ddr))

	)

458 
	#fb_ªadl
(
addr
Ë(*(vﬁ©ûê
u32
 *Ë◊ddr))

	)

459 
	#fb_ªadq
(
addr
Ë(*(vﬁ©ûê
u64
 *Ë◊ddr))

	)

460 
	#fb_wrôeb
(
b
,
addr
Ë(*(vﬁ©ûê
u8
 *Ë◊ddrË(b))

	)

461 
	#fb_wrôew
(
b
,
addr
Ë(*(vﬁ©ûê
u16
 *Ë◊ddrË(b))

	)

462 
	#fb_wrôñ
(
b
,
addr
Ë(*(vﬁ©ûê
u32
 *Ë◊ddrË(b))

	)

463 
	#fb_wrôeq
(
b
,
addr
Ë(*(vﬁ©ûê
u64
 *Ë◊ddrË(b))

	)

464 
	#fb_mem£t
 
mem£t


	)

472 
fb_£t_v¨
(
fb_öfo
 *
öfo
, 
fb_v¨_s¸ìnöfo
 *
v¨
);

473 
fb_∑n_di•œy
(
fb_öfo
 *
öfo
, 
fb_v¨_s¸ìnöfo
 *
v¨
);

474 
fb_bœnk
(
fb_öfo
 *
öfo
, 
bœnk
);

475 
so·_curs‹
(
fb_öfo
 *
öfo
, 
fb_curs‹
 *
curs‹
);

476 
cfb_fûÃe˘
(
fb_öfo
 *
öfo
, c⁄° 
fb_fûÃe˘
 *
ª˘
);

477 
cfb_c›y¨ó
(
fb_öfo
 *
öfo
, c⁄° 
fb_c›y¨ó
 *
¨ó
);

478 
cfb_imageblô
(
fb_öfo
 *
öfo
, c⁄° 
fb_image
 *
image
);

481 
ªgi°î_‰amebuf„r
(
fb_öfo
 *fb_info);

482 
uƒegi°î_‰amebuf„r
(
fb_öfo
 *fb_info);

483 
fb_¥ï¨e_logo
(
fb_öfo
 *fb_info);

484 
fb_show_logo
(
fb_öfo
 *fb_info);

485 
u32
 
fb_gë_buf„r_off£t
(
fb_öfo
 *
öfo
, u32 
size
);

486 
move_buf_u«lig√d
(
fb_öfo
 *
öfo
, 
u8
 *
d°
, u8 *
§c
, 
u32
 
d_pôch
,

487 
u32
 
height
, u32 
mask
, u32 
shi·_high
, u32 
shi·_low
,

488 
u32
 
mod
, u32 
idx
);

489 
move_buf_Æig√d
(
fb_öfo
 *
öfo
, 
u8
 *
d°
, u8 *
§c
, 
u32
 
d_pôch
,

490 
u32
 
s_pôch
, u32 
height
);

491 
fb_öfo
 *
ªgi°îed_fb
[
FB_MAX
];

492 
num_ªgi°îed_fb
;

495 
	#FB_MAXTIMINGS
 0

	)

496 
	#FB_VSYNCTIMINGS
 1

	)

497 
	#FB_HSYNCTIMINGS
 2

	)

498 
	#FB_DCLKTIMINGS
 3

	)

499 
	#FB_IGNOREMON
 0x100

	)

501 
fbm⁄_vÆid_timögs
(
u_öt
 
pix˛ock
, u_öà
htŸÆ
, u_öà
vtŸÆ
,

502 c⁄° 
fb_öfo
 *fb_info);

503 
fbm⁄_dpms
(c⁄° 
fb_öfo
 *fb_info);

504 
fb_gë_mode
(
Êags
, 
u32
 
vÆ
, 
fb_v¨_s¸ìnöfo
 *
v¨
,

505 
fb_öfo
 *
öfo
);

506 
fb_vÆid©e_mode
(
fb_v¨_s¸ìnöfo
 *
v¨
,

507 
fb_öfo
 *
öfo
);

508 
∑r£_edid
(*
edid
, 
fb_v¨_s¸ìnöfo
 *
v¨
);

509 
fb_gë_m⁄ô‹_limôs
(*
edid
, 
fb_m⁄•ecs
 *
•ecs
);

510 
fb_videomode
 *
fb_¸óã_modedb
(*
edid
, *
dbsize
);

511 
fb_de°roy_modedb
(
fb_videomode
 *
modedb
);

512 
show_edid
(*
edid
);

515 
	#VESA_MODEDB_SIZE
 34

	)

516 c⁄° 
fb_videomode
 
veß_modes
[];

519 
fb_Æloc_cm≠
(
fb_cm≠
 *
cm≠
, 
Àn
, 
å™•
);

520 
fb_dóŒoc_cm≠
(
fb_cm≠
 *
cm≠
);

521 
fb_c›y_cm≠
(
fb_cm≠
 *
‰om
, fb_cm≠ *
to
,

522 
fs‰omto
);

523 
fb_£t_cm≠
(
fb_cm≠
 *
cm≠
, 
k•c
, 
fb_öfo
 *fb_info);

524 
fb_cm≠
 *
fb_deÁu…_cm≠
(
Àn
);

525 
fb_övît_cm≠s
();

527 
	sfb_videomode
 {

528 c⁄° *
	m«me
;

529 
u32
 
	mª‰esh
;

530 
u32
 
	mxªs
;

531 
u32
 
	myªs
;

532 
u32
 
	mpix˛ock
;

533 
u32
 
	mÀ·_m¨gö
;

534 
u32
 
	mright_m¨gö
;

535 
u32
 
	muµî_m¨gö
;

536 
u32
 
	mlowî_m¨gö
;

537 
u32
 
	mhsync_Àn
;

538 
u32
 
	mvsync_Àn
;

539 
u32
 
	msync
;

540 
u32
 
	mvmode
;

543 #ifde‡
MODULE


544 
ölöe
 
	$fb_föd_mode
(
fb_v¨_s¸ìnöfo
 *
v¨
,

545 
fb_öfo
 *
öfo
, c⁄° *
mode_›ti⁄
,

546 c⁄° 
fb_videomode
 *
db
,

547 
dbsize
,

548 c⁄° 
fb_videomode
 *
deÁu…_mode
,

549 
deÁu…_bµ
)

551 
	`__fb_åy_mode
(
fb_v¨_s¸ìnöfo
 *
v¨
,

552 
fb_öfo
 *
öfo
,

553 c⁄° 
fb_videomode
 *
mode
,

554 
bµ
);

559 c⁄° 
fb_videomode
 
vga640x400
 = {

561 
NULL
, 70, 640, 400, 39721, 40, 24, 39, 9, 96, 2,

562 0, 
FB_VMODE_NONINTERLACED


564 i‡(!
deÁu…_mode
)

565 
deÁu…_mode
 = &
vga640x400
;

566 i‡(!
deÁu…_bµ
)

567 
deÁu…_bµ
 = 8;

568  
	`__fb_åy_mode
(
v¨
, 
öfo
, 
deÁu…_mode
, 
deÁu…_bµ
);

569 
	}
}

571 
__öô
 
fb_föd_mode
(
fb_v¨_s¸ìnöfo
 *
v¨
,

572 
fb_öfo
 *
öfo
, c⁄° *
mode_›ti⁄
,

573 c⁄° 
fb_videomode
 *
db
,

574 
dbsize
,

575 c⁄° 
fb_videomode
 *
deÁu…_mode
,

576 
deÁu…_bµ
);

	@/usr/include/linux/kd.h

1 #i‚de‡
_LINUX_KD_H


2 
	#_LINUX_KD_H


	)

3 
	~<löux/ty≥s.h
>

7 
	#GIO_FONT
 0x4B60

	)

8 
	#PIO_FONT
 0x4B61

	)

10 
	#GIO_FONTX
 0x4B6B

	)

11 
	#PIO_FONTX
 0x4B6C

	)

12 
	sc⁄sﬁef⁄tdesc
 {

13 
	mch¨cou¡
;

14 
	mch¨height
;

15 *
	mch¨d©a
;

18 
	#PIO_FONTRESET
 0x4B6D

	)

20 
	#GIO_CMAP
 0x4B70

	)

21 
	#PIO_CMAP
 0x4B71

	)

23 
	#KIOCSOUND
 0x4B2F

	)

24 
	#KDMKTONE
 0x4B30

	)

26 
	#KDGETLED
 0x4B31

	)

27 
	#KDSETLED
 0x4B32

	)

28 
	#LED_SCR
 0x01

	)

29 
	#LED_NUM
 0x02

	)

30 
	#LED_CAP
 0x04

	)

32 
	#KDGKBTYPE
 0x4B33

	)

33 
	#KB_84
 0x01

	)

34 
	#KB_101
 0x02

	)

35 
	#KB_OTHER
 0x03

	)

37 
	#KDADDIO
 0x4B34

	)

38 
	#KDDELIO
 0x4B35

	)

39 
	#KDENABIO
 0x4B36

	)

40 
	#KDDISABIO
 0x4B37

	)

42 
	#KDSETMODE
 0x4B3A

	)

43 
	#KD_TEXT
 0x00

	)

44 
	#KD_GRAPHICS
 0x01

	)

45 
	#KD_TEXT0
 0x02

	)

46 
	#KD_TEXT1
 0x03

	)

47 
	#KDGETMODE
 0x4B3B

	)

49 
	#KDMAPDISP
 0x4B3C

	)

50 
	#KDUNMAPDISP
 0x4B3D

	)

52 
	ts¸nm≠_t
;

53 
	#E_TABSZ
 256

	)

54 
	#GIO_SCRNMAP
 0x4B40

	)

55 
	#PIO_SCRNMAP
 0x4B41

	)

56 
	#GIO_UNISCRNMAP
 0x4B69

	)

57 
	#PIO_UNISCRNMAP
 0x4B6A

	)

59 
	#GIO_UNIMAP
 0x4B66

	)

60 
	sunùaú
 {

61 
	municode
;

62 
	mf⁄ços
;

64 
	sunim≠desc
 {

65 
	míåy_˘
;

66 
unùaú
 *
	míåõs
;

68 
	#PIO_UNIMAP
 0x4B67

	)

69 
	#PIO_UNIMAPCLR
 0x4B68

	)

70 
	sunim≠öô
 {

71 
	madvi£d_hashsize
;

72 
	madvi£d_hash°ï
;

73 
	madvi£d_hashÀvñ
;

76 
	#UNI_DIRECT_BASE
 0xF000

	)

77 
	#UNI_DIRECT_MASK
 0x01FF

	)

79 
	#K_RAW
 0x00

	)

80 
	#K_XLATE
 0x01

	)

81 
	#K_MEDIUMRAW
 0x02

	)

82 
	#K_UNICODE
 0x03

	)

83 
	#KDGKBMODE
 0x4B44

	)

84 
	#KDSKBMODE
 0x4B45

	)

86 
	#K_METABIT
 0x03

	)

87 
	#K_ESCPREFIX
 0x04

	)

88 
	#KDGKBMETA
 0x4B62

	)

89 
	#KDSKBMETA
 0x4B63

	)

91 
	#K_SCROLLLOCK
 0x01

	)

92 
	#K_NUMLOCK
 0x02

	)

93 
	#K_CAPSLOCK
 0x04

	)

94 
	#KDGKBLED
 0x4B64

	)

95 
	#KDSKBLED
 0x4B65

	)

97 
	skbíåy
 {

98 
	mkb_èbÀ
;

99 
	mkb_ödex
;

100 
	mkb_vÆue
;

102 
	#K_NORMTAB
 0x00

	)

103 
	#K_SHIFTTAB
 0x01

	)

104 
	#K_ALTTAB
 0x02

	)

105 
	#K_ALTSHIFTTAB
 0x03

	)

107 
	#KDGKBENT
 0x4B46

	)

108 
	#KDSKBENT
 0x4B47

	)

110 
	skb£¡ry
 {

111 
	mkb_func
;

112 
	mkb_°rög
[512];

114 
	#KDGKBSENT
 0x4B48

	)

115 
	#KDSKBSENT
 0x4B49

	)

117 
	skbdü¸
 {

118 
	mdü¸
, 
	mba£
, 
	mªsu…
;

120 
	skbdü¸s
 {

121 
	mkb_˙t
;

122 
kbdü¸
 
	mkbdü¸
[256];

124 
	#KDGKBDIACR
 0x4B4A

	)

125 
	#KDSKBDIACR
 0x4B4B

	)

127 
	skbkeycode
 {

128 
	msˇncode
, 
	mkeycode
;

130 
	#KDGETKEYCODE
 0x4B4C

	)

131 
	#KDSETKEYCODE
 0x4B4D

	)

133 
	#KDSIGACCEPT
 0x4B4E

	)

135 
	skbd_ª≥©
 {

136 
	mdñay
;

137 
	m≥riod
;

141 
	#KDKBDREP
 0x4B52

	)

144 
	#KDFONTOP
 0x4B72

	)

146 
	sc⁄sﬁe_f⁄t_›
 {

147 
	m›
;

148 
	mÊags
;

149 
	mwidth
, 
	mheight
;

150 
	mch¨cou¡
;

151 *
	md©a
;

154 
	#KD_FONT_OP_SET
 0

	)

155 
	#KD_FONT_OP_GET
 1

	)

156 
	#KD_FONT_OP_SET_DEFAULT
 2

	)

157 
	#KD_FONT_OP_COPY
 3

	)

159 
	#KD_FONT_FLAG_DONT_RECALC
 1

	)

160 #ifde‡
__KERNEL__


161 
	#KD_FONT_FLAG_OLD
 0x80000000

	)

	@/usr/include/linux/keyboard.h

1 #i‚de‡
__LINUX_KEYBOARD_H


2 
	#__LINUX_KEYBOARD_H


	)

4 
	~<löux/waô.h
>

5 
	~<löux/öput.h
>

7 
	#KG_SHIFT
 0

	)

8 
	#KG_CTRL
 2

	)

9 
	#KG_ALT
 3

	)

10 
	#KG_ALTGR
 1

	)

11 
	#KG_SHIFTL
 4

	)

12 
	#KG_KANASHIFT
 4

	)

13 
	#KG_SHIFTR
 5

	)

14 
	#KG_CTRLL
 6

	)

15 
	#KG_CTRLR
 7

	)

16 
	#KG_CAPSSHIFT
 8

	)

18 
	#NR_SHIFT
 9

	)

20 
	#NR_KEYS
 (
KEY_MAX
+1)

	)

21 
	#MAX_NR_KEYMAPS
 256

	)

24 
	#MAX_NR_OF_USER_KEYMAPS
 256

	)

26 #ifde‡
__KERNEL__


27 c⁄° 
NR_TYPES
;

28 c⁄° 
max_vÆs
[];

29 *
key_m≠s
[
MAX_NR_KEYMAPS
];

30 
∂aö_m≠
[
NR_KEYS
];

31 
keybﬂrd_ty≥
;

34 
	#MAX_NR_FUNC
 256

	)

36 
	#KT_LATIN
 0

	)

37 
	#KT_LETTER
 11

	)

38 
	#KT_FN
 1

	)

39 
	#KT_SPEC
 2

	)

40 
	#KT_PAD
 3

	)

41 
	#KT_DEAD
 4

	)

42 
	#KT_CONS
 5

	)

43 
	#KT_CUR
 6

	)

44 
	#KT_SHIFT
 7

	)

45 
	#KT_META
 8

	)

46 
	#KT_ASCII
 9

	)

47 
	#KT_LOCK
 10

	)

48 
	#KT_SLOCK
 12

	)

50 
	#K
(
t
,
v
Ë((—)<<8)|(v))

	)

51 
	#KTYP
(
x
Ë((xË>> 8)

	)

52 
	#KVAL
(
x
Ë((xË& 0xff)

	)

54 
	#K_F1
 
	`K
(
KT_FN
,0)

	)

55 
	#K_F2
 
	`K
(
KT_FN
,1)

	)

56 
	#K_F3
 
	`K
(
KT_FN
,2)

	)

57 
	#K_F4
 
	`K
(
KT_FN
,3)

	)

58 
	#K_F5
 
	`K
(
KT_FN
,4)

	)

59 
	#K_F6
 
	`K
(
KT_FN
,5)

	)

60 
	#K_F7
 
	`K
(
KT_FN
,6)

	)

61 
	#K_F8
 
	`K
(
KT_FN
,7)

	)

62 
	#K_F9
 
	`K
(
KT_FN
,8)

	)

63 
	#K_F10
 
	`K
(
KT_FN
,9)

	)

64 
	#K_F11
 
	`K
(
KT_FN
,10)

	)

65 
	#K_F12
 
	`K
(
KT_FN
,11)

	)

66 
	#K_F13
 
	`K
(
KT_FN
,12)

	)

67 
	#K_F14
 
	`K
(
KT_FN
,13)

	)

68 
	#K_F15
 
	`K
(
KT_FN
,14)

	)

69 
	#K_F16
 
	`K
(
KT_FN
,15)

	)

70 
	#K_F17
 
	`K
(
KT_FN
,16)

	)

71 
	#K_F18
 
	`K
(
KT_FN
,17)

	)

72 
	#K_F19
 
	`K
(
KT_FN
,18)

	)

73 
	#K_F20
 
	`K
(
KT_FN
,19)

	)

74 
	#K_FIND
 
	`K
(
KT_FN
,20)

	)

75 
	#K_INSERT
 
	`K
(
KT_FN
,21)

	)

76 
	#K_REMOVE
 
	`K
(
KT_FN
,22)

	)

77 
	#K_SELECT
 
	`K
(
KT_FN
,23)

	)

78 
	#K_PGUP
 
	`K
(
KT_FN
,24Ë

	)

79 
	#K_PGDN
 
	`K
(
KT_FN
,25Ë

	)

80 
	#K_MACRO
 
	`K
(
KT_FN
,26)

	)

81 
	#K_HELP
 
	`K
(
KT_FN
,27)

	)

82 
	#K_DO
 
	`K
(
KT_FN
,28)

	)

83 
	#K_PAUSE
 
	`K
(
KT_FN
,29)

	)

84 
	#K_F21
 
	`K
(
KT_FN
,30)

	)

85 
	#K_F22
 
	`K
(
KT_FN
,31)

	)

86 
	#K_F23
 
	`K
(
KT_FN
,32)

	)

87 
	#K_F24
 
	`K
(
KT_FN
,33)

	)

88 
	#K_F25
 
	`K
(
KT_FN
,34)

	)

89 
	#K_F26
 
	`K
(
KT_FN
,35)

	)

90 
	#K_F27
 
	`K
(
KT_FN
,36)

	)

91 
	#K_F28
 
	`K
(
KT_FN
,37)

	)

92 
	#K_F29
 
	`K
(
KT_FN
,38)

	)

93 
	#K_F30
 
	`K
(
KT_FN
,39)

	)

94 
	#K_F31
 
	`K
(
KT_FN
,40)

	)

95 
	#K_F32
 
	`K
(
KT_FN
,41)

	)

96 
	#K_F33
 
	`K
(
KT_FN
,42)

	)

97 
	#K_F34
 
	`K
(
KT_FN
,43)

	)

98 
	#K_F35
 
	`K
(
KT_FN
,44)

	)

99 
	#K_F36
 
	`K
(
KT_FN
,45)

	)

100 
	#K_F37
 
	`K
(
KT_FN
,46)

	)

101 
	#K_F38
 
	`K
(
KT_FN
,47)

	)

102 
	#K_F39
 
	`K
(
KT_FN
,48)

	)

103 
	#K_F40
 
	`K
(
KT_FN
,49)

	)

104 
	#K_F41
 
	`K
(
KT_FN
,50)

	)

105 
	#K_F42
 
	`K
(
KT_FN
,51)

	)

106 
	#K_F43
 
	`K
(
KT_FN
,52)

	)

107 
	#K_F44
 
	`K
(
KT_FN
,53)

	)

108 
	#K_F45
 
	`K
(
KT_FN
,54)

	)

109 
	#K_F46
 
	`K
(
KT_FN
,55)

	)

110 
	#K_F47
 
	`K
(
KT_FN
,56)

	)

111 
	#K_F48
 
	`K
(
KT_FN
,57)

	)

112 
	#K_F49
 
	`K
(
KT_FN
,58)

	)

113 
	#K_F50
 
	`K
(
KT_FN
,59)

	)

114 
	#K_F51
 
	`K
(
KT_FN
,60)

	)

115 
	#K_F52
 
	`K
(
KT_FN
,61)

	)

116 
	#K_F53
 
	`K
(
KT_FN
,62)

	)

117 
	#K_F54
 
	`K
(
KT_FN
,63)

	)

118 
	#K_F55
 
	`K
(
KT_FN
,64)

	)

119 
	#K_F56
 
	`K
(
KT_FN
,65)

	)

120 
	#K_F57
 
	`K
(
KT_FN
,66)

	)

121 
	#K_F58
 
	`K
(
KT_FN
,67)

	)

122 
	#K_F59
 
	`K
(
KT_FN
,68)

	)

123 
	#K_F60
 
	`K
(
KT_FN
,69)

	)

124 
	#K_F61
 
	`K
(
KT_FN
,70)

	)

125 
	#K_F62
 
	`K
(
KT_FN
,71)

	)

126 
	#K_F63
 
	`K
(
KT_FN
,72)

	)

127 
	#K_F64
 
	`K
(
KT_FN
,73)

	)

128 
	#K_F65
 
	`K
(
KT_FN
,74)

	)

129 
	#K_F66
 
	`K
(
KT_FN
,75)

	)

130 
	#K_F67
 
	`K
(
KT_FN
,76)

	)

131 
	#K_F68
 
	`K
(
KT_FN
,77)

	)

132 
	#K_F69
 
	`K
(
KT_FN
,78)

	)

133 
	#K_F70
 
	`K
(
KT_FN
,79)

	)

134 
	#K_F71
 
	`K
(
KT_FN
,80)

	)

135 
	#K_F72
 
	`K
(
KT_FN
,81)

	)

136 
	#K_F73
 
	`K
(
KT_FN
,82)

	)

137 
	#K_F74
 
	`K
(
KT_FN
,83)

	)

138 
	#K_F75
 
	`K
(
KT_FN
,84)

	)

139 
	#K_F76
 
	`K
(
KT_FN
,85)

	)

140 
	#K_F77
 
	`K
(
KT_FN
,86)

	)

141 
	#K_F78
 
	`K
(
KT_FN
,87)

	)

142 
	#K_F79
 
	`K
(
KT_FN
,88)

	)

143 
	#K_F80
 
	`K
(
KT_FN
,89)

	)

144 
	#K_F81
 
	`K
(
KT_FN
,90)

	)

145 
	#K_F82
 
	`K
(
KT_FN
,91)

	)

146 
	#K_F83
 
	`K
(
KT_FN
,92)

	)

147 
	#K_F84
 
	`K
(
KT_FN
,93)

	)

148 
	#K_F85
 
	`K
(
KT_FN
,94)

	)

149 
	#K_F86
 
	`K
(
KT_FN
,95)

	)

150 
	#K_F87
 
	`K
(
KT_FN
,96)

	)

151 
	#K_F88
 
	`K
(
KT_FN
,97)

	)

152 
	#K_F89
 
	`K
(
KT_FN
,98)

	)

153 
	#K_F90
 
	`K
(
KT_FN
,99)

	)

154 
	#K_F91
 
	`K
(
KT_FN
,100)

	)

155 
	#K_F92
 
	`K
(
KT_FN
,101)

	)

156 
	#K_F93
 
	`K
(
KT_FN
,102)

	)

157 
	#K_F94
 
	`K
(
KT_FN
,103)

	)

158 
	#K_F95
 
	`K
(
KT_FN
,104)

	)

159 
	#K_F96
 
	`K
(
KT_FN
,105)

	)

160 
	#K_F97
 
	`K
(
KT_FN
,106)

	)

161 
	#K_F98
 
	`K
(
KT_FN
,107)

	)

162 
	#K_F99
 
	`K
(
KT_FN
,108)

	)

163 
	#K_F100
 
	`K
(
KT_FN
,109)

	)

164 
	#K_F101
 
	`K
(
KT_FN
,110)

	)

165 
	#K_F102
 
	`K
(
KT_FN
,111)

	)

166 
	#K_F103
 
	`K
(
KT_FN
,112)

	)

167 
	#K_F104
 
	`K
(
KT_FN
,113)

	)

168 
	#K_F105
 
	`K
(
KT_FN
,114)

	)

169 
	#K_F106
 
	`K
(
KT_FN
,115)

	)

170 
	#K_F107
 
	`K
(
KT_FN
,116)

	)

171 
	#K_F108
 
	`K
(
KT_FN
,117)

	)

172 
	#K_F109
 
	`K
(
KT_FN
,118)

	)

173 
	#K_F110
 
	`K
(
KT_FN
,119)

	)

174 
	#K_F111
 
	`K
(
KT_FN
,120)

	)

175 
	#K_F112
 
	`K
(
KT_FN
,121)

	)

176 
	#K_F113
 
	`K
(
KT_FN
,122)

	)

177 
	#K_F114
 
	`K
(
KT_FN
,123)

	)

178 
	#K_F115
 
	`K
(
KT_FN
,124)

	)

179 
	#K_F116
 
	`K
(
KT_FN
,125)

	)

180 
	#K_F117
 
	`K
(
KT_FN
,126)

	)

181 
	#K_F118
 
	`K
(
KT_FN
,127)

	)

182 
	#K_F119
 
	`K
(
KT_FN
,128)

	)

183 
	#K_F120
 
	`K
(
KT_FN
,129)

	)

184 
	#K_F121
 
	`K
(
KT_FN
,130)

	)

185 
	#K_F122
 
	`K
(
KT_FN
,131)

	)

186 
	#K_F123
 
	`K
(
KT_FN
,132)

	)

187 
	#K_F124
 
	`K
(
KT_FN
,133)

	)

188 
	#K_F125
 
	`K
(
KT_FN
,134)

	)

189 
	#K_F126
 
	`K
(
KT_FN
,135)

	)

190 
	#K_F127
 
	`K
(
KT_FN
,136)

	)

191 
	#K_F128
 
	`K
(
KT_FN
,137)

	)

192 
	#K_F129
 
	`K
(
KT_FN
,138)

	)

193 
	#K_F130
 
	`K
(
KT_FN
,139)

	)

194 
	#K_F131
 
	`K
(
KT_FN
,140)

	)

195 
	#K_F132
 
	`K
(
KT_FN
,141)

	)

196 
	#K_F133
 
	`K
(
KT_FN
,142)

	)

197 
	#K_F134
 
	`K
(
KT_FN
,143)

	)

198 
	#K_F135
 
	`K
(
KT_FN
,144)

	)

199 
	#K_F136
 
	`K
(
KT_FN
,145)

	)

200 
	#K_F137
 
	`K
(
KT_FN
,146)

	)

201 
	#K_F138
 
	`K
(
KT_FN
,147)

	)

202 
	#K_F139
 
	`K
(
KT_FN
,148)

	)

203 
	#K_F140
 
	`K
(
KT_FN
,149)

	)

204 
	#K_F141
 
	`K
(
KT_FN
,150)

	)

205 
	#K_F142
 
	`K
(
KT_FN
,151)

	)

206 
	#K_F143
 
	`K
(
KT_FN
,152)

	)

207 
	#K_F144
 
	`K
(
KT_FN
,153)

	)

208 
	#K_F145
 
	`K
(
KT_FN
,154)

	)

209 
	#K_F146
 
	`K
(
KT_FN
,155)

	)

210 
	#K_F147
 
	`K
(
KT_FN
,156)

	)

211 
	#K_F148
 
	`K
(
KT_FN
,157)

	)

212 
	#K_F149
 
	`K
(
KT_FN
,158)

	)

213 
	#K_F150
 
	`K
(
KT_FN
,159)

	)

214 
	#K_F151
 
	`K
(
KT_FN
,160)

	)

215 
	#K_F152
 
	`K
(
KT_FN
,161)

	)

216 
	#K_F153
 
	`K
(
KT_FN
,162)

	)

217 
	#K_F154
 
	`K
(
KT_FN
,163)

	)

218 
	#K_F155
 
	`K
(
KT_FN
,164)

	)

219 
	#K_F156
 
	`K
(
KT_FN
,165)

	)

220 
	#K_F157
 
	`K
(
KT_FN
,166)

	)

221 
	#K_F158
 
	`K
(
KT_FN
,167)

	)

222 
	#K_F159
 
	`K
(
KT_FN
,168)

	)

223 
	#K_F160
 
	`K
(
KT_FN
,169)

	)

224 
	#K_F161
 
	`K
(
KT_FN
,170)

	)

225 
	#K_F162
 
	`K
(
KT_FN
,171)

	)

226 
	#K_F163
 
	`K
(
KT_FN
,172)

	)

227 
	#K_F164
 
	`K
(
KT_FN
,173)

	)

228 
	#K_F165
 
	`K
(
KT_FN
,174)

	)

229 
	#K_F166
 
	`K
(
KT_FN
,175)

	)

230 
	#K_F167
 
	`K
(
KT_FN
,176)

	)

231 
	#K_F168
 
	`K
(
KT_FN
,177)

	)

232 
	#K_F169
 
	`K
(
KT_FN
,178)

	)

233 
	#K_F170
 
	`K
(
KT_FN
,179)

	)

234 
	#K_F171
 
	`K
(
KT_FN
,180)

	)

235 
	#K_F172
 
	`K
(
KT_FN
,181)

	)

236 
	#K_F173
 
	`K
(
KT_FN
,182)

	)

237 
	#K_F174
 
	`K
(
KT_FN
,183)

	)

238 
	#K_F175
 
	`K
(
KT_FN
,184)

	)

239 
	#K_F176
 
	`K
(
KT_FN
,185)

	)

240 
	#K_F177
 
	`K
(
KT_FN
,186)

	)

241 
	#K_F178
 
	`K
(
KT_FN
,187)

	)

242 
	#K_F179
 
	`K
(
KT_FN
,188)

	)

243 
	#K_F180
 
	`K
(
KT_FN
,189)

	)

244 
	#K_F181
 
	`K
(
KT_FN
,190)

	)

245 
	#K_F182
 
	`K
(
KT_FN
,191)

	)

246 
	#K_F183
 
	`K
(
KT_FN
,192)

	)

247 
	#K_F184
 
	`K
(
KT_FN
,193)

	)

248 
	#K_F185
 
	`K
(
KT_FN
,194)

	)

249 
	#K_F186
 
	`K
(
KT_FN
,195)

	)

250 
	#K_F187
 
	`K
(
KT_FN
,196)

	)

251 
	#K_F188
 
	`K
(
KT_FN
,197)

	)

252 
	#K_F189
 
	`K
(
KT_FN
,198)

	)

253 
	#K_F190
 
	`K
(
KT_FN
,199)

	)

254 
	#K_F191
 
	`K
(
KT_FN
,200)

	)

255 
	#K_F192
 
	`K
(
KT_FN
,201)

	)

256 
	#K_F193
 
	`K
(
KT_FN
,202)

	)

257 
	#K_F194
 
	`K
(
KT_FN
,203)

	)

258 
	#K_F195
 
	`K
(
KT_FN
,204)

	)

259 
	#K_F196
 
	`K
(
KT_FN
,205)

	)

260 
	#K_F197
 
	`K
(
KT_FN
,206)

	)

261 
	#K_F198
 
	`K
(
KT_FN
,207)

	)

262 
	#K_F199
 
	`K
(
KT_FN
,208)

	)

263 
	#K_F200
 
	`K
(
KT_FN
,209)

	)

264 
	#K_F201
 
	`K
(
KT_FN
,210)

	)

265 
	#K_F202
 
	`K
(
KT_FN
,211)

	)

266 
	#K_F203
 
	`K
(
KT_FN
,212)

	)

267 
	#K_F204
 
	`K
(
KT_FN
,213)

	)

268 
	#K_F205
 
	`K
(
KT_FN
,214)

	)

269 
	#K_F206
 
	`K
(
KT_FN
,215)

	)

270 
	#K_F207
 
	`K
(
KT_FN
,216)

	)

271 
	#K_F208
 
	`K
(
KT_FN
,217)

	)

272 
	#K_F209
 
	`K
(
KT_FN
,218)

	)

273 
	#K_F210
 
	`K
(
KT_FN
,219)

	)

274 
	#K_F211
 
	`K
(
KT_FN
,220)

	)

275 
	#K_F212
 
	`K
(
KT_FN
,221)

	)

276 
	#K_F213
 
	`K
(
KT_FN
,222)

	)

277 
	#K_F214
 
	`K
(
KT_FN
,223)

	)

278 
	#K_F215
 
	`K
(
KT_FN
,224)

	)

279 
	#K_F216
 
	`K
(
KT_FN
,225)

	)

280 
	#K_F217
 
	`K
(
KT_FN
,226)

	)

281 
	#K_F218
 
	`K
(
KT_FN
,227)

	)

282 
	#K_F219
 
	`K
(
KT_FN
,228)

	)

283 
	#K_F220
 
	`K
(
KT_FN
,229)

	)

284 
	#K_F221
 
	`K
(
KT_FN
,230)

	)

285 
	#K_F222
 
	`K
(
KT_FN
,231)

	)

286 
	#K_F223
 
	`K
(
KT_FN
,232)

	)

287 
	#K_F224
 
	`K
(
KT_FN
,233)

	)

288 
	#K_F225
 
	`K
(
KT_FN
,234)

	)

289 
	#K_F226
 
	`K
(
KT_FN
,235)

	)

290 
	#K_F227
 
	`K
(
KT_FN
,236)

	)

291 
	#K_F228
 
	`K
(
KT_FN
,237)

	)

292 
	#K_F229
 
	`K
(
KT_FN
,238)

	)

293 
	#K_F230
 
	`K
(
KT_FN
,239)

	)

294 
	#K_F231
 
	`K
(
KT_FN
,240)

	)

295 
	#K_F232
 
	`K
(
KT_FN
,241)

	)

296 
	#K_F233
 
	`K
(
KT_FN
,242)

	)

297 
	#K_F234
 
	`K
(
KT_FN
,243)

	)

298 
	#K_F235
 
	`K
(
KT_FN
,244)

	)

299 
	#K_F236
 
	`K
(
KT_FN
,245)

	)

300 
	#K_F237
 
	`K
(
KT_FN
,246)

	)

301 
	#K_F238
 
	`K
(
KT_FN
,247)

	)

302 
	#K_F239
 
	`K
(
KT_FN
,248)

	)

303 
	#K_F240
 
	`K
(
KT_FN
,249)

	)

304 
	#K_F241
 
	`K
(
KT_FN
,250)

	)

305 
	#K_F242
 
	`K
(
KT_FN
,251)

	)

306 
	#K_F243
 
	`K
(
KT_FN
,252)

	)

307 
	#K_F244
 
	`K
(
KT_FN
,253)

	)

308 
	#K_F245
 
	`K
(
KT_FN
,254)

	)

309 
	#K_UNDO
 
	`K
(
KT_FN
,255)

	)

312 
	#K_HOLE
 
	`K
(
KT_SPEC
,0)

	)

313 
	#K_ENTER
 
	`K
(
KT_SPEC
,1)

	)

314 
	#K_SH_REGS
 
	`K
(
KT_SPEC
,2)

	)

315 
	#K_SH_MEM
 
	`K
(
KT_SPEC
,3)

	)

316 
	#K_SH_STAT
 
	`K
(
KT_SPEC
,4)

	)

317 
	#K_BREAK
 
	`K
(
KT_SPEC
,5)

	)

318 
	#K_CONS
 
	`K
(
KT_SPEC
,6)

	)

319 
	#K_CAPS
 
	`K
(
KT_SPEC
,7)

	)

320 
	#K_NUM
 
	`K
(
KT_SPEC
,8)

	)

321 
	#K_HOLD
 
	`K
(
KT_SPEC
,9)

	)

322 
	#K_SCROLLFORW
 
	`K
(
KT_SPEC
,10)

	)

323 
	#K_SCROLLBACK
 
	`K
(
KT_SPEC
,11)

	)

324 
	#K_BOOT
 
	`K
(
KT_SPEC
,12)

	)

325 
	#K_CAPSON
 
	`K
(
KT_SPEC
,13)

	)

326 
	#K_COMPOSE
 
	`K
(
KT_SPEC
,14)

	)

327 
	#K_SAK
 
	`K
(
KT_SPEC
,15)

	)

328 
	#K_DECRCONSOLE
 
	`K
(
KT_SPEC
,16)

	)

329 
	#K_INCRCONSOLE
 
	`K
(
KT_SPEC
,17)

	)

330 
	#K_SPAWNCONSOLE
 
	`K
(
KT_SPEC
,18)

	)

331 
	#K_BARENUMLOCK
 
	`K
(
KT_SPEC
,19)

	)

333 
	#K_ALLOCATED
 
	`K
(
KT_SPEC
,126Ë

	)

334 
	#K_NOSUCHMAP
 
	`K
(
KT_SPEC
,127Ë

	)

336 
	#K_P0
 
	`K
(
KT_PAD
,0)

	)

337 
	#K_P1
 
	`K
(
KT_PAD
,1)

	)

338 
	#K_P2
 
	`K
(
KT_PAD
,2)

	)

339 
	#K_P3
 
	`K
(
KT_PAD
,3)

	)

340 
	#K_P4
 
	`K
(
KT_PAD
,4)

	)

341 
	#K_P5
 
	`K
(
KT_PAD
,5)

	)

342 
	#K_P6
 
	`K
(
KT_PAD
,6)

	)

343 
	#K_P7
 
	`K
(
KT_PAD
,7)

	)

344 
	#K_P8
 
	`K
(
KT_PAD
,8)

	)

345 
	#K_P9
 
	`K
(
KT_PAD
,9)

	)

346 
	#K_PPLUS
 
	`K
(
KT_PAD
,10Ë

	)

347 
	#K_PMINUS
 
	`K
(
KT_PAD
,11Ë

	)

348 
	#K_PSTAR
 
	`K
(
KT_PAD
,12Ë

	)

349 
	#K_PSLASH
 
	`K
(
KT_PAD
,13Ë

	)

350 
	#K_PENTER
 
	`K
(
KT_PAD
,14Ë

	)

351 
	#K_PCOMMA
 
	`K
(
KT_PAD
,15Ë

	)

352 
	#K_PDOT
 
	`K
(
KT_PAD
,16Ë

	)

353 
	#K_PPLUSMINUS
 
	`K
(
KT_PAD
,17Ë

	)

354 
	#K_PPARENL
 
	`K
(
KT_PAD
,18Ë

	)

355 
	#K_PPARENR
 
	`K
(
KT_PAD
,19Ë

	)

357 
	#NR_PAD
 20

	)

359 
	#K_DGRAVE
 
	`K
(
KT_DEAD
,0)

	)

360 
	#K_DACUTE
 
	`K
(
KT_DEAD
,1)

	)

361 
	#K_DCIRCM
 
	`K
(
KT_DEAD
,2)

	)

362 
	#K_DTILDE
 
	`K
(
KT_DEAD
,3)

	)

363 
	#K_DDIERE
 
	`K
(
KT_DEAD
,4)

	)

364 
	#K_DCEDIL
 
	`K
(
KT_DEAD
,5)

	)

366 
	#NR_DEAD
 6

	)

368 
	#K_DOWN
 
	`K
(
KT_CUR
,0)

	)

369 
	#K_LEFT
 
	`K
(
KT_CUR
,1)

	)

370 
	#K_RIGHT
 
	`K
(
KT_CUR
,2)

	)

371 
	#K_UP
 
	`K
(
KT_CUR
,3)

	)

373 
	#K_SHIFT
 
	`K
(
KT_SHIFT
,
KG_SHIFT
)

	)

374 
	#K_CTRL
 
	`K
(
KT_SHIFT
,
KG_CTRL
)

	)

375 
	#K_ALT
 
	`K
(
KT_SHIFT
,
KG_ALT
)

	)

376 
	#K_ALTGR
 
	`K
(
KT_SHIFT
,
KG_ALTGR
)

	)

377 
	#K_SHIFTL
 
	`K
(
KT_SHIFT
,
KG_SHIFTL
)

	)

378 
	#K_SHIFTR
 
	`K
(
KT_SHIFT
,
KG_SHIFTR
)

	)

379 
	#K_CTRLL
 
	`K
(
KT_SHIFT
,
KG_CTRLL
)

	)

380 
	#K_CTRLR
 
	`K
(
KT_SHIFT
,
KG_CTRLR
)

	)

381 
	#K_CAPSSHIFT
 
	`K
(
KT_SHIFT
,
KG_CAPSSHIFT
)

	)

383 
	#K_ASC0
 
	`K
(
KT_ASCII
,0)

	)

384 
	#K_ASC1
 
	`K
(
KT_ASCII
,1)

	)

385 
	#K_ASC2
 
	`K
(
KT_ASCII
,2)

	)

386 
	#K_ASC3
 
	`K
(
KT_ASCII
,3)

	)

387 
	#K_ASC4
 
	`K
(
KT_ASCII
,4)

	)

388 
	#K_ASC5
 
	`K
(
KT_ASCII
,5)

	)

389 
	#K_ASC6
 
	`K
(
KT_ASCII
,6)

	)

390 
	#K_ASC7
 
	`K
(
KT_ASCII
,7)

	)

391 
	#K_ASC8
 
	`K
(
KT_ASCII
,8)

	)

392 
	#K_ASC9
 
	`K
(
KT_ASCII
,9)

	)

393 
	#K_HEX0
 
	`K
(
KT_ASCII
,10)

	)

394 
	#K_HEX1
 
	`K
(
KT_ASCII
,11)

	)

395 
	#K_HEX2
 
	`K
(
KT_ASCII
,12)

	)

396 
	#K_HEX3
 
	`K
(
KT_ASCII
,13)

	)

397 
	#K_HEX4
 
	`K
(
KT_ASCII
,14)

	)

398 
	#K_HEX5
 
	`K
(
KT_ASCII
,15)

	)

399 
	#K_HEX6
 
	`K
(
KT_ASCII
,16)

	)

400 
	#K_HEX7
 
	`K
(
KT_ASCII
,17)

	)

401 
	#K_HEX8
 
	`K
(
KT_ASCII
,18)

	)

402 
	#K_HEX9
 
	`K
(
KT_ASCII
,19)

	)

403 
	#K_HEXa
 
	`K
(
KT_ASCII
,20)

	)

404 
	#K_HEXb
 
	`K
(
KT_ASCII
,21)

	)

405 
	#K_HEXc
 
	`K
(
KT_ASCII
,22)

	)

406 
	#K_HEXd
 
	`K
(
KT_ASCII
,23)

	)

407 
	#K_HEXe
 
	`K
(
KT_ASCII
,24)

	)

408 
	#K_HEXf
 
	`K
(
KT_ASCII
,25)

	)

410 
	#NR_ASCII
 26

	)

412 
	#K_SHIFTLOCK
 
	`K
(
KT_LOCK
,
KG_SHIFT
)

	)

413 
	#K_CTRLLOCK
 
	`K
(
KT_LOCK
,
KG_CTRL
)

	)

414 
	#K_ALTLOCK
 
	`K
(
KT_LOCK
,
KG_ALT
)

	)

415 
	#K_ALTGRLOCK
 
	`K
(
KT_LOCK
,
KG_ALTGR
)

	)

416 
	#K_SHIFTLLOCK
 
	`K
(
KT_LOCK
,
KG_SHIFTL
)

	)

417 
	#K_SHIFTRLOCK
 
	`K
(
KT_LOCK
,
KG_SHIFTR
)

	)

418 
	#K_CTRLLLOCK
 
	`K
(
KT_LOCK
,
KG_CTRLL
)

	)

419 
	#K_CTRLRLOCK
 
	`K
(
KT_LOCK
,
KG_CTRLR
)

	)

421 
	#K_SHIFT_SLOCK
 
	`K
(
KT_SLOCK
,
KG_SHIFT
)

	)

422 
	#K_CTRL_SLOCK
 
	`K
(
KT_SLOCK
,
KG_CTRL
)

	)

423 
	#K_ALT_SLOCK
 
	`K
(
KT_SLOCK
,
KG_ALT
)

	)

424 
	#K_ALTGR_SLOCK
 
	`K
(
KT_SLOCK
,
KG_ALTGR
)

	)

425 
	#K_SHIFTL_SLOCK
 
	`K
(
KT_SLOCK
,
KG_SHIFTL
)

	)

426 
	#K_SHIFTR_SLOCK
 
	`K
(
KT_SLOCK
,
KG_SHIFTR
)

	)

427 
	#K_CTRLL_SLOCK
 
	`K
(
KT_SLOCK
,
KG_CTRLL
)

	)

428 
	#K_CTRLR_SLOCK
 
	`K
(
KT_SLOCK
,
KG_CTRLR
)

	)

430 
	#NR_LOCK
 8

	)

432 
	#MAX_DIACR
 256

	)

	@/usr/include/linux/vt.h

1 #i‚de‡
_LINUX_VT_H


2 
	#_LINUX_VT_H


	)

6 
	#VT_OPENQRY
 0x5600

	)

8 
	svt_mode
 {

9 
	mmode
;

10 
	mwaôv
;

11 
	mªlsig
;

12 
	macqsig
;

13 
	m‰sig
;

15 
	#VT_GETMODE
 0x5601

	)

16 
	#VT_SETMODE
 0x5602

	)

17 
	#VT_AUTO
 0x00

	)

18 
	#VT_PROCESS
 0x01

	)

19 
	#VT_ACKACQ
 0x02

	)

21 
	svt_°©
 {

22 
	mv_a˘ive
;

23 
	mv_sig«l
;

24 
	mv_°©e
;

26 
	#VT_GETSTATE
 0x5603

	)

27 
	#VT_SENDSIG
 0x5604

	)

29 
	#VT_RELDISP
 0x5605

	)

31 
	#VT_ACTIVATE
 0x5606

	)

32 
	#VT_WAITACTIVE
 0x5607

	)

33 
	#VT_DISALLOCATE
 0x5608

	)

35 
	svt_sizes
 {

36 
	mv_rows
;

37 
	mv_cﬁs
;

38 
	mv_s¸ﬁlsize
;

40 
	#VT_RESIZE
 0x5609

	)

42 
	svt_c⁄size
 {

43 
	mv_rows
;

44 
	mv_cﬁs
;

45 
	mv_vlö
;

46 
	mv_˛ö
;

47 
	mv_vcﬁ
;

48 
	mv_ccﬁ
;

50 
	#VT_RESIZEX
 0x560A

	)

51 
	#VT_LOCKSWITCH
 0x560B

	)

52 
	#VT_UNLOCKSWITCH
 0x560C

	)

	@/usr/include/locale.h

23 #i‚def 
_LOCALE_H


24 
	#_LOCALE_H
 1

	)

26 
	~<„©uªs.h
>

28 
	#__√ed_NULL


	)

29 
	~<°ddef.h
>

30 
	~<bôs/loˇÀ.h
>

32 
	g__BEGIN_DECLS


36 
	#LC_CTYPE
 
__LC_CTYPE


	)

37 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

38 
	#LC_TIME
 
__LC_TIME


	)

39 
	#LC_COLLATE
 
__LC_COLLATE


	)

40 
	#LC_MONETARY
 
__LC_MONETARY


	)

41 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

42 
	#LC_ALL
 
__LC_ALL


	)

43 
	#LC_PAPER
 
__LC_PAPER


	)

44 
	#LC_NAME
 
__LC_NAME


	)

45 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

46 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

47 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

48 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

52 
	slc⁄v


56 *
	mdecimÆ_poöt
;

57 *
	mthoußnds_£p
;

63 *
	mgroupög
;

69 *
	möt_cuº_symbﬁ
;

70 *
	mcuºícy_symbﬁ
;

71 *
	mm⁄_decimÆ_poöt
;

72 *
	mm⁄_thoußnds_£p
;

73 *
	mm⁄_groupög
;

74 *
	mposôive_sign
;

75 *
	m√g©ive_sign
;

76 
	möt_‰ac_digôs
;

77 
	m‰ac_digôs
;

79 
	mp_cs_¥e˚des
;

81 
	mp_£p_by_•a˚
;

83 
	mn_cs_¥e˚des
;

85 
	mn_£p_by_•a˚
;

92 
	mp_sign_po¢
;

93 
	mn_sign_po¢
;

94 #ifde‡
__USE_ISOC99


96 
	möt_p_cs_¥e˚des
;

98 
	möt_p_£p_by_•a˚
;

100 
	möt_n_cs_¥e˚des
;

102 
	möt_n_£p_by_•a˚
;

109 
	möt_p_sign_po¢
;

110 
	möt_n_sign_po¢
;

112 
	m__öt_p_cs_¥e˚des
;

113 
	m__öt_p_£p_by_•a˚
;

114 
	m__öt_n_cs_¥e˚des
;

115 
	m__öt_n_£p_by_•a˚
;

116 
	m__öt_p_sign_po¢
;

117 
	m__öt_n_sign_po¢
;

122 
__BEGIN_NAMESPACE_STD


125 *
	$£éoˇÀ
 (
__ˇãg‹y
, 
__c⁄°
 *
__loˇÀ
Ë
__THROW
;

128 
lc⁄v
 *
	$loˇÀc⁄v
 (Ë
__THROW
;

130 
__END_NAMESPACE_STD


133 #ifdef 
__USE_GNU


146 
	~<xloˇÀ.h
>

148 
__loˇÀ_t
 
	tloˇÀ_t
;

154 
__loˇÀ_t
 
	$√wloˇÀ
 (
__ˇãg‹y_mask
, 
__c⁄°
 *
__loˇÀ
,

155 
__loˇÀ_t
 
__ba£
Ë
__THROW
;

161 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

162 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

163 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

164 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

165 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

166 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

167 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

168 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

169 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

170 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

171 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

172 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

173 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

174 | 
LC_NUMERIC_MASK
 \

175 | 
LC_TIME_MASK
 \

176 | 
LC_COLLATE_MASK
 \

177 | 
LC_MONETARY_MASK
 \

178 | 
LC_MESSAGES_MASK
 \

179 | 
LC_PAPER_MASK
 \

180 | 
LC_NAME_MASK
 \

181 | 
LC_ADDRESS_MASK
 \

182 | 
LC_TELEPHONE_MASK
 \

183 | 
LC_MEASUREMENT_MASK
 \

184 | 
LC_IDENTIFICATION_MASK
 \

185 )

	)

189 
__loˇÀ_t
 
	$du∂oˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

193 
	$‰ìloˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

200 
__loˇÀ_t
 
	$u£loˇÀ
 (
__loˇÀ_t
 
__d©a£t
Ë
__THROW
;

204 
	#LC_GLOBAL_LOCALE
 ((
__loˇÀ_t
Ë-1L)

	)

208 
__END_DECLS


	@/usr/include/malloc.h

20 #i‚de‡
_MALLOC_H


21 
	#_MALLOC_H
 1

	)

23 #ifde‡
_LIBC


24 
	~<„©uªs.h
>

45 #i‡
deföed
(
__STDC__
Ë|| deföed (
__˝lu•lus
)

46 
	~<°ddef.h
>

47 
	#__mÆloc_±r_t
 *

	)

49 #unde‡
size_t


50 
	#size_t
 

	)

51 #unde‡
±rdiff_t


52 
	#±rdiff_t
 

	)

53 
	#__mÆloc_±r_t
 *

	)

56 #ifde‡
_LIBC


58 
	#__mÆloc_size_t
 
size_t


	)

59 
	#__mÆloc_±rdiff_t
 
±rdiff_t


	)

60 #ñi‡!
deföed
 
__©åibuã_mÆloc__


61 
	#__©åibuã_mÆloc__


	)

64 #ifde‡
__GNUC__


69 #i‡
deföed
 
__˝lu•lus
 && (
__GNUC__
 >3 || 
__GNUC_MINOR__
 >= 8)

70 
	#__THROW
 
	`throw
 ()

	)

72 
	#__THROW


	)

74 
	#__MALLOC_P
(
¨gs
Ë¨g†
__THROW


	)

77 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

81 
	#__THROW


	)

83 #i‡(
deföed
 
__STDC__
 && __STDC__Ë|| deföed 
__˝lu•lus


85 
	#__MALLOC_P
(
¨gs
Ë
	)
args

86 
	#__MALLOC_PMT
(
¨gs
Ë
	)
args

88 #i‚de‡
__c⁄°


89 
	#__c⁄°
 c⁄°

	)

94 
	#__MALLOC_P
(
¨gs
Ë(Ë

	)

95 
	#__MALLOC_PMT
(
¨gs
Ë()

	)

97 #i‚de‡
__c⁄°


98 
	#__c⁄°


	)

105 #i‚de‡
NULL


106 #ifde‡
__˝lu•lus


107 
	#NULL
 0

	)

109 
	#NULL
 ((
__mÆloc_±r_t
Ë0)

	)

113 #ifde‡
__˝lu•lus


118 
__mÆloc_±r_t
 
mÆloc
 
__MALLOC_P
 ((
size_t
 
__size
)Ë
__©åibuã_mÆloc__
;

121 
__mÆloc_±r_t
 
ˇŒoc
 
__MALLOC_P
 ((
size_t
 
__nmemb
, size_à
__size
))

122 
__©åibuã_mÆloc__
;

126 
__mÆloc_±r_t
 
ªÆloc
 
__MALLOC_P
 ((__mÆloc_±r_à
__±r
,

127 
size_t
 
__size
))

128 
__©åibuã_mÆloc__
;

131 
‰ì
 
__MALLOC_P
 ((
__mÆloc_±r_t
 
__±r
));

134 
c‰ì
 
__MALLOC_P
 ((
__mÆloc_±r_t
 
__±r
));

137 
__mÆloc_±r_t
 
memÆign
 
__MALLOC_P
 ((
size_t
 
__Æignmít
, size_à
__size
));

140 
__mÆloc_±r_t
 
vÆloc
 
__MALLOC_P
 ((
size_t
 
__size
)Ë
__©åibuã_mÆloc__
;

144 
__mÆloc_±r_t
 
pvÆloc
 
__MALLOC_P
 ((
size_t
 
__size
))

145 
__©åibuã_mÆloc__
;

149 
__mÆloc_±r_t
 (*
__m‹ec‹e
Ë
__MALLOC_PMT
 ((
±rdiff_t
 
__size
));

152 
__mÆloc_±r_t
 
__deÁu…_m‹ec‹e
 
__MALLOC_P
 ((
±rdiff_t
 
__size
))

153 
__©åibuã_mÆloc__
;

157 
	smÆlöfo
 {

158 
	g¨ía
;

159 
	g‹dblks
;

160 
	gsmblks
;

161 
	ghblks
;

162 
	ghblkhd
;

163 
	gusmblks
;

164 
	gfsmblks
;

165 
	gu‹dblks
;

166 
	gf‹dblks
;

167 
	gkìpco°
;

171 
mÆlöfo
 mÆlöfÿ
__MALLOC_P
 (());

174 #i‚de‡
M_MXFAST


175 
	#M_MXFAST
 1

	)

177 #i‚de‡
M_NLBLKS


178 
	#M_NLBLKS
 2

	)

180 #i‚de‡
M_GRAIN


181 
	#M_GRAIN
 3

	)

183 #i‚de‡
M_KEEP


184 
	#M_KEEP
 4

	)

188 
	#M_TRIM_THRESHOLD
 -1

	)

189 
	#M_TOP_PAD
 -2

	)

190 
	#M_MMAP_THRESHOLD
 -3

	)

191 
	#M_MMAP_MAX
 -4

	)

192 
	#M_CHECK_ACTION
 -5

	)

195 
mÆl›t
 
__MALLOC_P
 ((
__∑øm
, 
__vÆ
));

199 
mÆloc_åim
 
__MALLOC_P
 ((
size_t
 
__∑d
));

203 
size_t
 
mÆloc_ußbÀ_size
 
__MALLOC_P
 ((
__mÆloc_±r_t
 
__±r
));

206 
mÆloc_°©s
 
__MALLOC_P
 (());

209 
__mÆloc_±r_t
 
mÆloc_gë_°©e
 
__MALLOC_P
 (());

213 
mÆloc_£t_°©e
 
__MALLOC_P
 ((
__mÆloc_±r_t
 
__±r
));

218 (*
__mÆloc_öôülize_hook
Ë
__MALLOC_PMT
 (());

220 (*
__‰ì_hook
Ë
__MALLOC_PMT
 ((
__mÆloc_±r_t
 
__±r
,

221 
__c⁄°
 
__mÆloc_±r_t
));

222 
__mÆloc_±r_t
 (*
__mÆloc_hook
Ë
__MALLOC_PMT
 ((
size_t
 
__size
,

223 
__c⁄°
 
__mÆloc_±r_t
));

224 
__mÆloc_±r_t
 (*
__ªÆloc_hook
Ë
__MALLOC_PMT
 ((__mÆloc_±r_à
__±r
,

225 
size_t
 
__size
,

226 
__c⁄°
 
__mÆloc_±r_t
));

227 
__mÆloc_±r_t
 (*
__memÆign_hook
Ë
__MALLOC_PMT
 ((
size_t
 
__Æignmít
,

228 
size_t
 
__size
,

229 
__c⁄°
 
__mÆloc_±r_t
));

230 (*
__a·î_m‹ec‹e_hook
Ë
__MALLOC_PMT
 (());

233 
__mÆloc_check_öô
 
__MALLOC_P
 (());

236 #ifde‡
__˝lu•lus


	@/usr/include/math.h

24 #i‚def 
_MATH_H


25 
	#_MATH_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


33 
	~<bôs/huge_vÆ.h
>

36 #ifdef 
__USE_ISOC99


37 
	~<bôs/«n.h
>

40 
	~<bôs/m©hdef.h
>

48 
	#__MATHCALL
(
fun˘i⁄
,
suffix
, 
¨gs
) \

49 
	`__MATHDECL
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
)

	)

50 
	#__MATHDECL
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

51 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
); \

52 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
)

	)

53 
	#__MATHCALLX
(
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

54 
	`__MATHDECLX
 (
_MdoubÀ_
,
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
)

	)

55 
	#__MATHDECLX
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
, 
©åib
) \

56 
	`__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
); \

57 
	`__MATHDECL_1
(
ty≥
, 
	`__CONCAT
(
__
,
fun˘i⁄
),
suffix
, 
¨gs
Ë
	`__©åibuã__
 (
©åib
)

	)

58 
	#__MATHDECL_1
(
ty≥
, 
fun˘i⁄
,
suffix
, 
¨gs
) \

59 
ty≥
 
	`__MATH_PRECNAME
(
fun˘i⁄
,
suffix
Ë
¨gs
 
__THROW


	)

61 
	#_MdoubÀ_
 

	)

62 
	#__MATH_PRECNAME
(
«me
,
r
Ë
	`__CONCAT
“ame,r)

	)

63 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

64 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

65 
	~<bôs/m©hˇŒs.h
>

66 #unde‡
_MdoubÀ_


67 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


68 #unde‡
_MdoubÀ_END_NAMESPACE


69 #unde‡
__MATH_PRECNAME


71 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


77 #i‚de‡
_MÊﬂt_


78 
	#_MÊﬂt_
 

	)

80 
	#_MdoubÀ_
 
_MÊﬂt_


	)

81 #ifde‡
__STDC__


82 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
f
##
	)
r

84 
	#__MATH_PRECNAME
(
«me
,
r
Ë«mê
f
 
	)
r

86 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<bôs/m©hˇŒs.h
>

89 #unde‡
_MdoubÀ_


90 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


91 #unde‡
_MdoubÀ_END_NAMESPACE


92 #unde‡
__MATH_PRECNAME


94 #i‡(
__STDC__
 - 0 || 
__GNUC__
 - 0Ë&& !
deföed
 
__NO_LONG_DOUBLE_MATH


98 #i‚de‡
_Ml⁄g_doubÀ_


99 
	#_Ml⁄g_doubÀ_
 

	)

101 
	#_MdoubÀ_
 
_Ml⁄g_doubÀ_


	)

102 #ifde‡
__STDC__


103 
	#__MATH_PRECNAME
(
«me
,
r
Ë«me##
l
##
	)
r

105 
	#__MATH_PRECNAME
(
«me
,
r
Ë«mê
l
 
	)
r

107 
	#_MdoubÀ_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

108 
	#_MdoubÀ_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

109 
	~<bôs/m©hˇŒs.h
>

110 #unde‡
_MdoubÀ_


111 #unde‡
_MdoubÀ_BEGIN_NAMESPACE


112 #unde‡
_MdoubÀ_END_NAMESPACE


113 #unde‡
__MATH_PRECNAME


118 #unde‡
__MATHDECL_1


119 #unde‡
__MATHDECL


120 #unde‡
__MATHCALL


123 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


125 
signgam
;

130 #i‡
__USE_ISOC99


168 
	mFP_NAN
,

169 
	#FP_NAN
 
FP_NAN


	)

170 
	mFP_INFINITE
,

171 
	#FP_INFINITE
 
FP_INFINITE


	)

172 
	mFP_ZERO
,

173 
	#FP_ZERO
 
FP_ZERO


	)

174 
	mFP_SUBNORMAL
,

175 
	#FP_SUBNORMAL
 
FP_SUBNORMAL


	)

176 
	mFP_NORMAL


177 
	#FP_NORMAL
 
FP_NORMAL


	)

181 #ifde‡
__NO_LONG_DOUBLE_MATH


182 
	#Â˛assify
(
x
) \

183 ( (
x
Ë= (Ë? 
	`__Â˛assifyf
 (xË: 
	`__Â˛assify
 (x))

	)

185 
	#Â˛assify
(
x
) \

186 ( (
x
) ==  () \

187 ? 
	`__Â˛assifyf
 (
x
) \

188 :  (
x
) ==  () \

189 ? 
	`__Â˛assify
 (
x
Ë: 
	`__Â˛assifyl
 (x))

	)

193 #ifde‡
__NO_LONG_DOUBLE_MATH


194 
	#signbô
(
x
) \

195 ( (
x
Ë= (Ë? 
	`__signbôf
 (xË: 
	`__signbô
 (x))

	)

197 
	#signbô
(
x
) \

198 ( (
x
) ==  () \

199 ? 
	`__signbôf
 (
x
) \

200 :  (
x
) ==  () \

201 ? 
	`__signbô
 (
x
Ë: 
	`__signbôl
 (x))

	)

205 #ifde‡
__NO_LONG_DOUBLE_MATH


206 
	#isföôe
(
x
) \

207 ( (
x
Ë= (Ë? 
	`__föôef
 (xË: 
	`__föôe
 (x))

	)

209 
	#isföôe
(
x
) \

210 ( (
x
) ==  () \

211 ? 
	`__föôef
 (
x
) \

212 :  (
x
) ==  () \

213 ? 
	`__föôe
 (
x
Ë: 
	`__föôñ
 (x))

	)

217 
	#i¢‹mÆ
(
x
Ë(
	`Â˛assify
 (xË=
FP_NORMAL
)

	)

221 #ifde‡
__NO_LONG_DOUBLE_MATH


222 
	#i¢™
(
x
) \

223 ( (
x
Ë= (Ë? 
	`__i¢™f
 (xË: 
	`__i¢™
 (x))

	)

225 
	#i¢™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__i¢™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__i¢™
 (
x
Ë: 
	`__i¢™l
 (x))

	)

233 #ifde‡
__NO_LONG_DOUBLE_MATH


234 
	#isöf
(
x
) \

235 ( (
x
Ë= (Ë? 
	`__isöff
 (xË: 
	`__isöf
 (x))

	)

237 
	#isöf
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__isöff
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__isöf
 (
x
Ë: 
	`__isöÊ
 (x))

	)

245 
	#MATH_ERRNO
 1

	)

246 
	#MATH_ERREXCEPT
 2

	)

250 #ifdef 
__USE_MISC


254 
	m_IEEE_
 = -1,

255 
	m_SVID_
,

256 
	m_XOPEN_
,

257 
	m_POSIX_
,

258 
	m_ISOC_


259 } 
	t_LIB_VERSION_TYPE
;

264 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

268 #ifde‡
__USE_SVID


274 #ifde‡
__˝lu•lus


275 
	g__ex˚±i⁄


277 
	gex˚±i⁄


280 
	gty≥
;

281 *
	g«me
;

282 
	g¨g1
;

283 
	g¨g2
;

284 
	gªtvÆ
;

287 #ifde‡
__˝lu•lus


288 
	$m©hîr
 (
__ex˚±i⁄
 *
__exc
Ë
	`throw
 ();

290 
	`m©hîr
 (
ex˚±i⁄
 *
__exc
);

293 
	#X_TLOSS
 1.41484755040568800000e+16

	)

296 
	#DOMAIN
 1

	)

297 
	#SING
 2

	)

298 
	#OVERFLOW
 3

	)

299 
	#UNDERFLOW
 4

	)

300 
	#TLOSS
 5

	)

301 
	#PLOSS
 6

	)

304 
	#HUGE
 3.40282347e+38F

	)

308 #ifde‡
__USE_XOPEN


310 
	#MAXFLOAT
 3.40282347e+38F

	)

317 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


318 
	#M_E
 2.7182818284590452354

	)

319 
	#M_LOG2E
 1.4426950408889634074

	)

320 
	#M_LOG10E
 0.43429448190325182765

	)

321 
	#M_LN2
 0.69314718055994530942

	)

322 
	#M_LN10
 2.30258509299404568402

	)

323 
	#M_PI
 3.14159265358979323846

	)

324 
	#M_PI_2
 1.57079632679489661923

	)

325 
	#M_PI_4
 0.78539816339744830962

	)

326 
	#M_1_PI
 0.31830988618379067154

	)

327 
	#M_2_PI
 0.63661977236758134308

	)

328 
	#M_2_SQRTPI
 1.12837916709551257390

	)

329 
	#M_SQRT2
 1.41421356237309504880

	)

330 
	#M_SQRT1_2
 0.70710678118654752440

	)

336 #ifde‡
__USE_GNU


337 
	#M_El
 2.7182818284590452353602874713526625L

	)

338 
	#M_LOG2El
 1.4426950408889634073599246810018921L

	)

339 
	#M_LOG10El
 0.4342944819032518276511289189166051L

	)

340 
	#M_LN2l
 0.6931471805599453094172321214581766L

	)

341 
	#M_LN10l
 2.3025850929940456840179914546843642L

	)

342 
	#M_PIl
 3.1415926535897932384626433832795029L

	)

343 
	#M_PI_2l
 1.5707963267948966192313216916397514L

	)

344 
	#M_PI_4l
 0.7853981633974483096156608458198757L

	)

345 
	#M_1_PIl
 0.3183098861837906715377675267450287L

	)

346 
	#M_2_PIl
 0.6366197723675813430755350534900574L

	)

347 
	#M_2_SQRTPIl
 1.1283791670955125738961589031215452L

	)

348 
	#M_SQRT2l
 1.4142135623730950488016887242096981L

	)

349 
	#M_SQRT1_2l
 0.7071067811865475244008443621048490L

	)

356 #i‡
deföed
 
__STRICT_ANSI__
 && !deföed 
__NO_MATH_INLINES


357 
	#__NO_MATH_INLINES
 1

	)

361 #ifde‡
__USE_EXTERN_INLINES


362 
	~<bôs/m©hölöe.h
>

366 #i‡
__USE_ISOC99


374 #i‚de‡
isgª©î


375 
	#isgª©î
(
x
, 
y
) \

376 (
__exãnsi⁄__
 \

377 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

378 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x > __y; 
	}
}))

	)

382 #i‚de‡
isgª©îequÆ


383 
	#isgª©îequÆ
(
x
, 
y
) \

384 (
__exãnsi⁄__
 \

385 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

386 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x >__y; }))

	)

390 #i‚de‡
i¶ess


391 
	#i¶ess
(
x
, 
y
) \

392 (
__exãnsi⁄__
 \

393 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

394 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x < __y; }))

	)

398 #i‚de‡
i¶es£quÆ


399 
	#i¶es£quÆ
(
x
, 
y
) \

400 (
__exãnsi⁄__
 \

401 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

402 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& __x <__y; }))

	)

406 #i‚de‡
i¶essgª©î


407 
	#i¶essgª©î
(
x
, 
y
) \

408 (
__exãnsi⁄__
 \

409 ({ 
	`__ty≥of__
(
x
Ë
__x
 = (x); __ty≥of__(
y
Ë
__y
 = (y); \

410 !
	`isun‹dîed
 (
__x
, 
__y
Ë&& (__x < __y || __y < __x); }))

	)

414 #i‚de‡
isun‹dîed


415 
	#isun‹dîed
(
u
, 
v
) \

416 (
__exãnsi⁄__
 \

417 ({ 
	`__ty≥of__
(
u
Ë
__u
 = (u); __ty≥of__(
v
Ë
__v
 = (v); \

418 
	`Â˛assify
 (
__u
Ë=
FP_NAN
 || fp˛assify (
__v
Ë=FP_NAN; }))

	)

423 
	g__END_DECLS


	@/usr/include/netdb.h

23 #i‚def 
_NETDB_H


24 
	#_NETDB_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<√töë/ö.h
>

29 
	~<°döt.h
>

30 #ifde‡
__USE_MISC


33 
	~<Ωc/√tdb.h
>

36 #ifde‡
__USE_GNU


37 
	#__√ed_sigevít_t


	)

38 
	~<bôs/sigöfo.h
>

39 
	#__√ed_time•ec


	)

40 
	~<time.h
>

43 
	~<bôs/√tdb.h
>

46 
	#_PATH_HEQUIV
 "/ëc/ho°s.equiv"

	)

47 
	#_PATH_HOSTS
 "/ëc/ho°s"

	)

48 
	#_PATH_NETWORKS
 "/ëc/√tw‹ks"

	)

49 
	#_PATH_NSSWITCH_CONF
 "/ëc/nsswôch.c⁄f"

	)

50 
	#_PATH_PROTOCOLS
 "/ëc/¥Ÿocﬁs"

	)

51 
	#_PATH_SERVICES
 "/ëc/£rvi˚s"

	)

54 
	g__BEGIN_DECLS


58 
	#h_î∫o
 (*
	`__h_î∫o_loˇti⁄
 ())

	)

61 *
	$__h_î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

65 
	#NETDB_INTERNAL
 -1

	)

66 
	#NETDB_SUCCESS
 0

	)

67 
	#HOST_NOT_FOUND
 1

	)

68 
	#TRY_AGAIN
 2

	)

70 
	#NO_RECOVERY
 3

	)

72 
	#NO_DATA
 4

	)

74 
	#NO_ADDRESS
 
NO_DATA


	)

76 #ifde‡
__USE_XOPEN2K


78 
	#IPPORT_RESERVED
 1024

	)

81 #ifde‡
__USE_GNU


83 
	#SCOPE_DELIMITER
 '%'

	)

88 
	$hîr‹
 (
__c⁄°
 *
__°r
Ë
__THROW
;

91 
__c⁄°
 *
	$h°ªº‹
 (
__îr_num
Ë
__THROW
;

96 
	sho°ít


98 *
h_«me
;

99 **
h_Æü£s
;

100 
h_addπy≥
;

101 
h_Àngth
;

102 **
h_addr_li°
;

103 
	#h_addr
 
h_addr_li°
[0]

	)

111 
	`£tho°ít
 (
__°ay_›í
);

117 
	`ídho°ít
 ();

124 
ho°ít
 *
	`gëho°ít
 ();

131 
ho°ít
 *
	`gëho°byaddr
 (
__c⁄°
 *
__addr
, 
__sockÀn_t
 
__Àn
,

132 
__ty≥
);

138 
ho°ít
 *
	`gëho°by«me
 (
__c⁄°
 *
__«me
);

140 #ifde‡
__USE_MISC


149 
ho°ít
 *
	`gëho°by«me2
 (
__c⁄°
 *
__«me
, 
__af
);

161 
	`gëho°ít_r
 (
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

162 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

163 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

164 *
__ª°ri˘
 
__h_î∫›
);

166 
	`gëho°byaddr_r
 (
__c⁄°
 *
__ª°ri˘
 
__addr
, 
__sockÀn_t
 
__Àn
,

167 
__ty≥
,

168 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

169 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

170 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

171 *
__ª°ri˘
 
__h_î∫›
);

173 
	`gëho°by«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

174 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

175 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

176 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

177 *
__ª°ri˘
 
__h_î∫›
);

179 
	`gëho°by«me2_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
, 
__af
,

180 
ho°ít
 *
__ª°ri˘
 
__ªsu…_buf
,

181 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

182 
ho°ít
 **
__ª°ri˘
 
__ªsu…
,

183 *
__ª°ri˘
 
__h_î∫›
);

192 
	`£äëít
 (
__°ay_›í
);

198 
	`íd√ã¡
 ();

205 
√ã¡
 *
	`gë√ã¡
 ();

212 
√ã¡
 *
	`gë√tbyaddr
 (
uöt32_t
 
__√t
, 
__ty≥
);

218 
√ã¡
 *
	`gë√tby«me
 (
__c⁄°
 *
__«me
);

220 #ifdef 
__USE_MISC


231 
	`gë√ã¡_r
 (
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

232 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

233 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

234 *
__ª°ri˘
 
__h_î∫›
);

236 
	`gë√tbyaddr_r
 (
uöt32_t
 
__√t
, 
__ty≥
,

237 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

238 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

239 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

240 *
__ª°ri˘
 
__h_î∫›
);

242 
	`gë√tby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

243 
√ã¡
 *
__ª°ri˘
 
__ªsu…_buf
,

244 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

245 
√ã¡
 **
__ª°ri˘
 
__ªsu…
,

246 *
__ª°ri˘
 
__h_î∫›
);

251 
	s£rvít


253 *
s_«me
;

254 **
s_Æü£s
;

255 
s_p‹t
;

256 *
s_¥Ÿo
;

264 
	`£t£rvít
 (
__°ay_›í
);

270 
	`íd£rvít
 ();

277 
£rvít
 *
	`gë£rvít
 ();

284 
£rvít
 *
	`gë£rvby«me
 (
__c⁄°
 *
__«me
,

285 
__c⁄°
 *
__¥Ÿo
);

292 
£rvít
 *
	`gë£rvbyp‹t
 (
__p‹t
, 
__c⁄°
 *
__¥Ÿo
);

295 #ifdef 
__USE_MISC


303 
	`gë£rvít_r
 (
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

304 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

305 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

307 
	`gë£rvby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

308 
__c⁄°
 *
__ª°ri˘
 
__¥Ÿo
,

309 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

310 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

311 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

313 
	`gë£rvbyp‹t_r
 (
__p‹t
, 
__c⁄°
 *
__ª°ri˘
 
__¥Ÿo
,

314 
£rvít
 *
__ª°ri˘
 
__ªsu…_buf
,

315 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

316 
£rvít
 **
__ª°ri˘
 
__ªsu…
);

321 
	s¥Ÿ€¡


323 *
p_«me
;

324 **
p_Æü£s
;

325 
p_¥Ÿo
;

333 
	`£çrŸ€¡
 (
__°ay_›í
);

339 
	`íd¥Ÿ€¡
 ();

346 
¥Ÿ€¡
 *
	`gë¥Ÿ€¡
 ();

352 
¥Ÿ€¡
 *
	`gë¥Ÿoby«me
 (
__c⁄°
 *
__«me
);

358 
¥Ÿ€¡
 *
	`gë¥Ÿobynumbî
 (
__¥Ÿo
);

361 #ifdef 
__USE_MISC


369 
	`gë¥Ÿ€¡_r
 (
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

370 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

371 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

373 
	`gë¥Ÿoby«me_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

374 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

375 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

376 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

378 
	`gë¥Ÿobynumbî_r
 (
__¥Ÿo
,

379 
¥Ÿ€¡
 *
__ª°ri˘
 
__ªsu…_buf
,

380 *
__ª°ri˘
 
__buf
, 
size_t
 
__buÊí
,

381 
¥Ÿ€¡
 **
__ª°ri˘
 
__ªsu…
);

390 
	`£äëgª¡
 (
__c⁄°
 *
__√tgroup
);

398 
	`íd√tgª¡
 ();

407 
	`gë√tgª¡
 (**
__ª°ri˘
 
__ho°p
,

408 **
__ª°ri˘
 
__u£Ω
,

409 **
__ª°ri˘
 
__domaöp
);

418 
	`ö√tgr
 (
__c⁄°
 *
__√tgroup
, __c⁄° *
__ho°
,

419 
__c⁄°
 *
__u£r
, __c⁄° *
domaö
);

427 
	`gë√tgª¡_r
 (**
__ª°ri˘
 
__ho°p
,

428 **
__ª°ri˘
 
__u£Ω
,

429 **
__ª°ri˘
 
__domaöp
,

430 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
);

434 #ifde‡
__USE_BSD


446 
	`rcmd
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

447 
__c⁄°
 *
__ª°ri˘
 
__locu£r
,

448 
__c⁄°
 *
__ª°ri˘
 
__ªmu£r
,

449 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

458 
	`rcmd_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

459 
__c⁄°
 *
__ª°ri˘
 
__locu£r
,

460 
__c⁄°
 *
__ª°ri˘
 
__ªmu£r
,

461 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

462 
ß_Ámûy_t
 
__af
);

474 
	`ªxec
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

475 
__c⁄°
 *
__ª°ri˘
 
__«me
,

476 
__c⁄°
 *
__ª°ri˘
 
__∑ss
,

477 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
);

486 
	`ªxec_af
 (**
__ª°ri˘
 
__aho°
, 
__Ω‹t
,

487 
__c⁄°
 *
__ª°ri˘
 
__«me
,

488 
__c⁄°
 *
__ª°ri˘
 
__∑ss
,

489 
__c⁄°
 *
__ª°ri˘
 
__cmd
, *__ª°ri˘ 
__fd2p
,

490 
ß_Ámûy_t
 
__af
);

500 
	`ru£rok
 (
__c⁄°
 *
__rho°
, 
__su£r
,

501 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
);

510 
	`ru£rok_af
 (
__c⁄°
 *
__rho°
, 
__su£r
,

511 
__c⁄°
 *
__ªmu£r
, __c⁄° *
__locu£r
,

512 
ß_Ámûy_t
 
__af
);

522 
	`ºesvp‹t
 (*
__Æp‹t
);

531 
	`ºesvp‹t_af
 (*
__Æp‹t
, 
ß_Ámûy_t
 
__af
);

536 #ifdef 
__USE_POSIX


538 
	saddröfo


540 
ai_Êags
;

541 
ai_Ámûy
;

542 
ai_sockty≥
;

543 
ai_¥Ÿocﬁ
;

544 
sockÀn_t
 
ai_addæí
;

545 
sockaddr
 *
ai_addr
;

546 *
ai_ˇn⁄«me
;

547 
addröfo
 *
ai_√xt
;

550 #ifde‡
__USE_GNU


552 
	sgaicb


554 c⁄° *
¨_«me
;

555 c⁄° *
¨_£rvi˚
;

556 c⁄° 
addröfo
 *
¨_ªque°
;

557 
addröfo
 *
¨_ªsu…
;

559 
__ªtu∫
;

560 
__unu£d
[5];

564 
	#GAI_WAIT
 0

	)

565 
	#GAI_NOWAIT
 1

	)

569 
	#AI_PASSIVE
 0x0001

	)

570 
	#AI_CANONNAME
 0x0002

	)

571 
	#AI_NUMERICHOST
 0x0004

	)

572 
	#AI_V4MAPPED
 0x0008

	)

573 
	#AI_ALL
 0x0010

	)

574 
	#AI_ADDRCONFIG
 0x0020

	)

578 
	#EAI_BADFLAGS
 -1

	)

579 
	#EAI_NONAME
 -2

	)

580 
	#EAI_AGAIN
 -3

	)

581 
	#EAI_FAIL
 -4

	)

582 
	#EAI_NODATA
 -5

	)

583 
	#EAI_FAMILY
 -6

	)

584 
	#EAI_SOCKTYPE
 -7

	)

585 
	#EAI_SERVICE
 -8

	)

586 
	#EAI_ADDRFAMILY
 -9

	)

587 
	#EAI_MEMORY
 -10

	)

588 
	#EAI_SYSTEM
 -11

	)

589 #ifde‡
__USE_GNU


590 
	#EAI_INPROGRESS
 -100

	)

591 
	#EAI_CANCELED
 -101

	)

592 
	#EAI_NOTCANCELED
 -102

	)

593 
	#EAI_ALLDONE
 -103

	)

594 
	#EAI_INTR
 -104

	)

597 
	#NI_MAXHOST
 1025

	)

598 
	#NI_MAXSERV
 32

	)

600 
	#NI_NUMERICHOST
 1

	)

601 
	#NI_NUMERICSERV
 2

	)

602 
	#NI_NOFQDN
 4

	)

603 
	#NI_NAMEREQD
 8

	)

604 
	#NI_DGRAM
 16

	)

611 
	`gëaddröfo
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

612 
__c⁄°
 *
__ª°ri˘
 
__£rvi˚
,

613 
__c⁄°
 
addröfo
 *
__ª°ri˘
 
__ªq
,

614 
addröfo
 **
__ª°ri˘
 
__∑i
);

617 
	$‰ìaddröfo
 (
addröfo
 *
__ai
Ë
__THROW
;

620 
__c⁄°
 *
	$gai_°ªº‹
 (
__ecode
Ë
__THROW
;

626 
	`gë«meöfo
 (
__c⁄°
 
sockaddr
 *
__ª°ri˘
 
__ß
,

627 
sockÀn_t
 
__ßÀn
, *
__ª°ri˘
 
__ho°
,

628 
sockÀn_t
 
__ho°Àn
, *
__ª°ri˘
 
__£rv
,

629 
sockÀn_t
 
__£rvÀn
, 
__Êags
);

632 #ifde‡
__USE_GNU


641 
	`gëaddröfo_a
 (
__mode
, 
gaicb
 *
__li°
[
__ª°ri˘_¨r
],

642 
__ít
, 
sigevít
 *
__ª°ri˘
 
__sig
);

652 
	`gai_su•íd
 (
__c⁄°
 
gaicb
 *__c⁄° 
__li°
[], 
__ít
,

653 
__c⁄°
 
time•ec
 *
__timeout
);

656 
	$gai_îr‹
 (
gaicb
 *
__ªq
Ë
__THROW
;

659 
	$gai_ˇn˚l
 (
gaicb
 *
__gaicbp
Ë
__THROW
;

662 
__END_DECLS


	@/usr/include/netinet/in.h

19 #i‚def 
_NETINET_IN_H


20 
	#_NETINET_IN_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<°döt.h
>

24 
	~<sys/sockë.h
>

25 
	~<bôs/ty≥s.h
>

28 
__BEGIN_DECLS


33 
	mIPPROTO_IP
 = 0,

34 
	#IPPROTO_IP
 
IPPROTO_IP


	)

35 
	mIPPROTO_HOPOPTS
 = 0,

36 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

37 
	mIPPROTO_ICMP
 = 1,

38 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

39 
	mIPPROTO_IGMP
 = 2,

40 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

41 
	mIPPROTO_IPIP
 = 4,

42 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

43 
	mIPPROTO_TCP
 = 6,

44 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

45 
	mIPPROTO_EGP
 = 8,

46 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

47 
	mIPPROTO_PUP
 = 12,

48 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

49 
	mIPPROTO_UDP
 = 17,

50 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

51 
	mIPPROTO_IDP
 = 22,

52 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

53 
	mIPPROTO_TP
 = 29,

54 
	#IPPROTO_TP
 
IPPROTO_TP


	)

55 
	mIPPROTO_IPV6
 = 41,

56 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

57 
	mIPPROTO_ROUTING
 = 43,

58 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

59 
	mIPPROTO_FRAGMENT
 = 44,

60 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

61 
	mIPPROTO_RSVP
 = 46,

62 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

63 
	mIPPROTO_GRE
 = 47,

64 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

65 
	mIPPROTO_ESP
 = 50,

66 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

67 
	mIPPROTO_AH
 = 51,

68 
	#IPPROTO_AH
 
IPPROTO_AH


	)

69 
	mIPPROTO_ICMPV6
 = 58,

70 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

71 
	mIPPROTO_NONE
 = 59,

72 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

73 
	mIPPROTO_DSTOPTS
 = 60,

74 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

75 
	mIPPROTO_MTP
 = 92,

76 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

77 
	mIPPROTO_ENCAP
 = 98,

78 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

79 
	mIPPROTO_PIM
 = 103,

80 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

81 
	mIPPROTO_COMP
 = 108,

82 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

83 
	mIPPROTO_SCTP
 = 132,

84 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

85 
	mIPPROTO_RAW
 = 255,

86 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

87 
	mIPPROTO_MAX


92 
uöt16_t
 
	tö_p‹t_t
;

97 
	mIPPORT_ECHO
 = 7,

98 
	mIPPORT_DISCARD
 = 9,

99 
	mIPPORT_SYSTAT
 = 11,

100 
	mIPPORT_DAYTIME
 = 13,

101 
	mIPPORT_NETSTAT
 = 15,

102 
	mIPPORT_FTP
 = 21,

103 
	mIPPORT_TELNET
 = 23,

104 
	mIPPORT_SMTP
 = 25,

105 
	mIPPORT_TIMESERVER
 = 37,

106 
	mIPPORT_NAMESERVER
 = 42,

107 
	mIPPORT_WHOIS
 = 43,

108 
	mIPPORT_MTP
 = 57,

110 
	mIPPORT_TFTP
 = 69,

111 
	mIPPORT_RJE
 = 77,

112 
	mIPPORT_FINGER
 = 79,

113 
	mIPPORT_TTYLINK
 = 87,

114 
	mIPPORT_SUPDUP
 = 95,

117 
	mIPPORT_EXECSERVER
 = 512,

118 
	mIPPORT_LOGINSERVER
 = 513,

119 
	mIPPORT_CMDSERVER
 = 514,

120 
	mIPPORT_EFSSERVER
 = 520,

123 
	mIPPORT_BIFFUDP
 = 512,

124 
	mIPPORT_WHOSERVER
 = 513,

125 
	mIPPORT_ROUTESERVER
 = 520,

128 
	mIPPORT_RESERVED
 = 1024,

131 
	mIPPORT_USERRESERVED
 = 5000

136 
uöt32_t
 
	tö_addr_t
;

137 
	sö_addr


139 
ö_addr_t
 
	ms_addr
;

148 
	#IN_CLASSA
(
a
Ë((((
ö_addr_t
)◊)Ë& 0x80000000Ë=0)

	)

149 
	#IN_CLASSA_NET
 0xff000000

	)

150 
	#IN_CLASSA_NSHIFT
 24

	)

151 
	#IN_CLASSA_HOST
 (0xfffffff‡& ~
IN_CLASSA_NET
)

	)

152 
	#IN_CLASSA_MAX
 128

	)

154 
	#IN_CLASSB
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xc0000000Ë=0x80000000)

	)

155 
	#IN_CLASSB_NET
 0xffff0000

	)

156 
	#IN_CLASSB_NSHIFT
 16

	)

157 
	#IN_CLASSB_HOST
 (0xfffffff‡& ~
IN_CLASSB_NET
)

	)

158 
	#IN_CLASSB_MAX
 65536

	)

160 
	#IN_CLASSC
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xc0000000)

	)

161 
	#IN_CLASSC_NET
 0xffffff00

	)

162 
	#IN_CLASSC_NSHIFT
 8

	)

163 
	#IN_CLASSC_HOST
 (0xfffffff‡& ~
IN_CLASSC_NET
)

	)

165 
	#IN_CLASSD
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xe0000000)

	)

166 
	#IN_MULTICAST
(
a
Ë
	`IN_CLASSD
◊)

	)

168 
	#IN_EXPERIMENTAL
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xe0000000Ë=0xe0000000)

	)

169 
	#IN_BADCLASS
(
a
Ë((((
ö_addr_t
)◊)Ë& 0xf0000000Ë=0xf0000000)

	)

172 
	#INADDR_ANY
 ((
ö_addr_t
Ë0x00000000)

	)

174 
	#INADDR_BROADCAST
 ((
ö_addr_t
Ë0xffffffff)

	)

176 
	#INADDR_NONE
 ((
ö_addr_t
Ë0xffffffff)

	)

179 
	#IN_LOOPBACKNET
 127

	)

181 #i‚de‡
INADDR_LOOPBACK


182 
	#INADDR_LOOPBACK
 ((
ö_addr_t
Ë0x7f000001Ë

	)

186 
	#INADDR_UNSPEC_GROUP
 ((
ö_addr_t
Ë0xe0000000Ë

	)

187 
	#INADDR_ALLHOSTS_GROUP
 ((
ö_addr_t
Ë0xe0000001Ë

	)

188 
	#INADDR_ALLRTRS_GROUP
 ((
ö_addr_t
Ë0xe0000002Ë

	)

189 
	#INADDR_MAX_LOCAL_GROUP
 ((
ö_addr_t
Ë0xe00000ffË

	)

193 
	sö6_addr


197 
uöt8_t
 
	mu6_addr8
[16];

198 
uöt16_t
 
	mu6_addr16
[8];

199 
uöt32_t
 
	mu6_addr32
[4];

200 } 
	mö6_u
;

201 
	#s6_addr
 
ö6_u
.
u6_addr8


	)

202 
	#s6_addr16
 
ö6_u
.
u6_addr16


	)

203 
	#s6_addr32
 
ö6_u
.
u6_addr32


	)

206 c⁄° 
ö6_addr
 
ö6addr_™y
;

207 c⁄° 
ö6_addr
 
ö6addr_lo›back
;

208 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

209 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

211 
	#INET_ADDRSTRLEN
 16

	)

212 
	#INET6_ADDRSTRLEN
 46

	)

215 
	~<bôs/sockë.h
>

219 
	ssockaddr_ö


221 
__SOCKADDR_COMMON
 (
sö_
);

222 
ö_p‹t_t
 
	msö_p‹t
;

223 
ö_addr
 
	msö_addr
;

226 
	msö_zîo
[ (
sockaddr
) -

227 
__SOCKADDR_COMMON_SIZE
 -

228  (
ö_p‹t_t
) -

229  (
ö_addr
)];

233 
	ssockaddr_ö6


235 
__SOCKADDR_COMMON
 (
sö6_
);

236 
ö_p‹t_t
 
	msö6_p‹t
;

237 
uöt32_t
 
	msö6_Êowöfo
;

238 
ö6_addr
 
	msö6_addr
;

239 
uöt32_t
 
	msö6_sc›e_id
;

243 
	sùv6_mªq


246 
ö6_addr
 
	mùv6mr_mu…üddr
;

249 
	mùv6mr_öãrÁ˚
;

253 
	~<bôs/ö.h
>

262 
uöt32_t
 
	$¡ohl
 (
uöt32_t
 
__√é⁄g
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

263 
uöt16_t
 
	$¡ohs
 (
uöt16_t
 
__√tsh‹t
)

264 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

265 
uöt32_t
 
	$ht⁄l
 (
uöt32_t
 
__ho°l⁄g
)

266 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

267 
uöt16_t
 
	$ht⁄s
 (
uöt16_t
 
__ho°sh‹t
)

268 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

270 
	~<ídün.h
>

273 
	~<bôs/byãsw≠.h
>

275 #ifde‡
__OPTIMIZE__


279 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


282 
	#¡ohl
(
x
Ë(x)

	)

283 
	#¡ohs
(
x
Ë(x)

	)

284 
	#ht⁄l
(
x
Ë(x)

	)

285 
	#ht⁄s
(
x
Ë(x)

	)

287 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


288 
	#¡ohl
(
x
Ë
	`__bsw≠_32
 (x)

	)

289 
	#¡ohs
(
x
Ë
	`__bsw≠_16
 (x)

	)

290 
	#ht⁄l
(
x
Ë
	`__bsw≠_32
 (x)

	)

291 
	#ht⁄s
(
x
Ë
	`__bsw≠_16
 (x)

	)

296 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

297 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0 \

298 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0 \

299 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0 \

300 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =0)

	)

302 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

303 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0 \

304 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0 \

305 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0 \

306 && ((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =
	`ht⁄l
 (1))

	)

308 
	#IN6_IS_ADDR_MULTICAST
(
a
Ë(((
__c⁄°
 
uöt8_t
 *Ë◊))[0] =0xff)

	)

310 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

311 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

312 =
	`ht⁄l
 (0x„800000))

	)

314 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

315 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] & 
	`ht⁄l
 (0xffc00000)) \

316 =
	`ht⁄l
 (0x„c00000))

	)

318 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

319 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0) \

320 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0) \

321 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] =
	`ht⁄l
 (0xffff)))

	)

323 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

324 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] == 0) \

325 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] == 0) \

326 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] == 0) \

327 && (
	`¡ohl
 (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3]Ë> 1))

	)

329 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

330 ((((
__c⁄°
 
uöt32_t
 *Ë(
a
))[0] =((__c⁄° uöt32_à*Ë(
b
))[0]) \

331 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[1] =((__c⁄° uöt32_à*Ë(
b
))[1]) \

332 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[2] =((__c⁄° uöt32_à*Ë(
b
))[2]) \

333 && (((
__c⁄°
 
uöt32_t
 *Ë(
a
))[3] =((__c⁄° uöt32_à*Ë(
b
))[3]))

	)

336 
	$bödªsvp‹t
 (
__sockfd
, 
sockaddr_ö
 *
__sock_ö
Ë
__THROW
;

339 
	$bödªsvp‹t6
 (
__sockfd
, 
sockaddr_ö6
 *
__sock_ö
)

340 
__THROW
;

343 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

344 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

345 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x1))

	)

347 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

348 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

349 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x2))

	)

351 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

352 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

353 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x5))

	)

355 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

356 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

357 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0x8))

	)

359 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

360 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

361 && ((((
__c⁄°
 
uöt8_t
 *Ë(
a
))[1] & 0xfË=0xe))

	)

364 
	sö6_pktöfo


366 
ö6_addr
 
ùi6_addr
;

367 
ùi6_ifödex
;

371 #ifde‡
__USE_GNU


373 
	`öë6_›ti⁄_•a˚
 (
__nbyãs
);

374 
	`öë6_›ti⁄_öô
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

375 
__ty≥
);

376 
	`öë6_›ti⁄_≠≥nd
 (
cmsghdr
 *
__cmsg
,

377 
__c⁄°
 
uöt8_t
 *
__ty≥p
, 
__mu…x
,

378 
__∂usy
);

379 
uöt8_t
 *
	`öë6_›ti⁄_Æloc
 (
cmsghdr
 *
__cmsg
, 
__d©Æí
,

380 
__mu…x
, 
__∂usy
);

381 
	`öë6_›ti⁄_√xt
 (
__c⁄°
 
cmsghdr
 *
__cmsg
,

382 
uöt8_t
 **
__çåp
);

383 
	`öë6_›ti⁄_föd
 (
__c⁄°
 
cmsghdr
 *
__cmsg
,

384 
uöt8_t
 **
__çåp
, 
__ty≥
);

387 
__END_DECLS


	@/usr/include/netinet/tcp.h

32 #i‚de‡
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<„©uªs.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

53 #ifde‡
__USE_MISC


54 
	~<sys/ty≥s.h
>

56 #ifde‡
__FAVOR_BSD


57 
u_öt32_t
 
	tt˝_£q
;

62 
	st˝hdr


64 
u_öt16_t
 
	mth_•‹t
;

65 
u_öt16_t
 
	mth_dp‹t
;

66 
t˝_£q
 
	mth_£q
;

67 
t˝_£q
 
	mth_ack
;

68 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


69 
u_öt8_t
 
	mth_x2
:4;

70 
u_öt8_t
 
	mth_off
:4;

72 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


73 
u_öt8_t
 
	mth_off
:4;

74 
u_öt8_t
 
	mth_x2
:4;

76 
u_öt8_t
 
	mth_Êags
;

77 
	#TH_FIN
 0x01

	)

78 
	#TH_SYN
 0x02

	)

79 
	#TH_RST
 0x04

	)

80 
	#TH_PUSH
 0x08

	)

81 
	#TH_ACK
 0x10

	)

82 
	#TH_URG
 0x20

	)

83 
u_öt16_t
 
	mth_wö
;

84 
u_öt16_t
 
	mth_sum
;

85 
u_öt16_t
 
	mth_uΩ
;

89 
	st˝hdr


91 
u_öt16_t
 
	msour˚
;

92 
u_öt16_t
 
	mde°
;

93 
u_öt32_t
 
	m£q
;

94 
u_öt32_t
 
	mack_£q
;

95 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


96 
u_öt16_t
 
	mªs1
:4;

97 
u_öt16_t
 
	mdoff
:4;

98 
u_öt16_t
 
	mfö
:1;

99 
u_öt16_t
 
	msyn
:1;

100 
u_öt16_t
 
	mr°
:1;

101 
u_öt16_t
 
	mpsh
:1;

102 
u_öt16_t
 
	mack
:1;

103 
u_öt16_t
 
	murg
:1;

104 
u_öt16_t
 
	mªs2
:2;

105 #ñi‡
__BYTE_ORDER
 =
__BIG_ENDIAN


106 
u_öt16_t
 
	mdoff
:4;

107 
u_öt16_t
 
	mªs1
:4;

108 
u_öt16_t
 
	mªs2
:2;

109 
u_öt16_t
 
	murg
:1;

110 
u_öt16_t
 
	mack
:1;

111 
u_öt16_t
 
	mpsh
:1;

112 
u_öt16_t
 
	mr°
:1;

113 
u_öt16_t
 
	msyn
:1;

114 
u_öt16_t
 
	mfö
:1;

118 
u_öt16_t
 
	mwödow
;

119 
u_öt16_t
 
	mcheck
;

120 
u_öt16_t
 
	murg_±r
;

126 
	mTCP_ESTABLISHED
 = 1,

127 
	mTCP_SYN_SENT
,

128 
	mTCP_SYN_RECV
,

129 
	mTCP_FIN_WAIT1
,

130 
	mTCP_FIN_WAIT2
,

131 
	mTCP_TIME_WAIT
,

132 
	mTCP_CLOSE
,

133 
	mTCP_CLOSE_WAIT
,

134 
	mTCP_LAST_ACK
,

135 
	mTCP_LISTEN
,

136 
	mTCP_CLOSING


139 
	#TCPOPT_EOL
 0

	)

140 
	#TCPOPT_NOP
 1

	)

141 
	#TCPOPT_MAXSEG
 2

	)

142 
	#TCPOLEN_MAXSEG
 4

	)

143 
	#TCPOPT_WINDOW
 3

	)

144 
	#TCPOLEN_WINDOW
 3

	)

145 
	#TCPOPT_SACK_PERMITTED
 4

	)

146 
	#TCPOLEN_SACK_PERMITTED
 2

	)

147 
	#TCPOPT_SACK
 5

	)

148 
	#TCPOPT_TIMESTAMP
 8

	)

149 
	#TCPOLEN_TIMESTAMP
 10

	)

150 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2Ë

	)

152 
	#TCPOPT_TSTAMP_HDR
 \

153 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

161 
	#TCP_MSS
 512

	)

163 
	#TCP_MAXWIN
 65535

	)

165 
	#TCP_MAX_WINSHIFT
 14

	)

167 
	#SOL_TCP
 6

	)

170 
	#TCPI_OPT_TIMESTAMPS
 1

	)

171 
	#TCPI_OPT_SACK
 2

	)

172 
	#TCPI_OPT_WSCALE
 4

	)

173 
	#TCPI_OPT_ECN
 8

	)

176 
	et˝_ˇ_°©e


178 
	mTCP_CA_O≥n
 = 0,

179 
	mTCP_CA_Dis‹dî
 = 1,

180 
	mTCP_CA_CWR
 = 2,

181 
	mTCP_CA_Recovîy
 = 3,

182 
	mTCP_CA_Loss
 = 4

185 
	st˝_öfo


187 
u_öt8_t
 
	mt˝i_°©e
;

188 
u_öt8_t
 
	mt˝i_ˇ_°©e
;

189 
u_öt8_t
 
	mt˝i_ªå™smôs
;

190 
u_öt8_t
 
	mt˝i_¥obes
;

191 
u_öt8_t
 
	mt˝i_backoff
;

192 
u_öt8_t
 
	mt˝i_›ti⁄s
;

193 
u_öt8_t
 
	mt˝i_¢d_wsˇÀ
 : 4, 
	mt˝i_rcv_wsˇÀ
 : 4;

195 
u_öt32_t
 
	mt˝i_πo
;

196 
u_öt32_t
 
	mt˝i_©o
;

197 
u_öt32_t
 
	mt˝i_¢d_mss
;

198 
u_öt32_t
 
	mt˝i_rcv_mss
;

200 
u_öt32_t
 
	mt˝i_u«cked
;

201 
u_öt32_t
 
	mt˝i_ßcked
;

202 
u_öt32_t
 
	mt˝i_lo°
;

203 
u_öt32_t
 
	mt˝i_ªå™s
;

204 
u_öt32_t
 
	mt˝i_Áckës
;

207 
u_öt32_t
 
	mt˝i_œ°_d©a_£¡
;

208 
u_öt32_t
 
	mt˝i_œ°_ack_£¡
;

209 
u_öt32_t
 
	mt˝i_œ°_d©a_ªcv
;

210 
u_öt32_t
 
	mt˝i_œ°_ack_ªcv
;

213 
u_öt32_t
 
	mt˝i_pmtu
;

214 
u_öt32_t
 
	mt˝i_rcv_s°hªsh
;

215 
u_öt32_t
 
	mt˝i_πt
;

216 
u_öt32_t
 
	mt˝i_πtv¨
;

217 
u_öt32_t
 
	mt˝i_¢d_s°hªsh
;

218 
u_öt32_t
 
	mt˝i_¢d_cwnd
;

219 
u_öt32_t
 
	mt˝i_advmss
;

220 
u_öt32_t
 
	mt˝i_ª‹dîög
;

	@/usr/include/pthread.h

15 #i‚de‡
_PTHREAD_H


16 
	#_PTHREAD_H
 1

	)

18 
	~<„©uªs.h
>

20 
	~<sched.h
>

21 
	~<time.h
>

23 
	#__√ed_sig£t_t


	)

24 
	~<sig«l.h
>

25 
	~<bôs/±hªadty≥s.h
>

26 
	~<bôs/öô•ö.h
>

29 
	g__BEGIN_DECLS


33 
	#PTHREAD_MUTEX_INITIALIZER
 \

34 {0, 0, 0, 
PTHREAD_MUTEX_TIMED_NP
, 
__LOCK_INITIALIZER
}

	)

35 #ifde‡
__USE_GNU


36 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

37 {0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__LOCK_INITIALIZER
}

	)

38 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

39 {0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__LOCK_INITIALIZER
}

	)

40 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

41 {0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__LOCK_INITIALIZER
}

	)

44 
	#PTHREAD_COND_INITIALIZER
 {
__LOCK_INITIALIZER
, 0, "", 0}

	)

46 #ifde‡
__USE_UNIX98


47 
	#PTHREAD_RWLOCK_INITIALIZER
 \

48 { 
__LOCK_INITIALIZER
, 0, 
NULL
, NULL, NULL, \

49 
PTHREAD_RWLOCK_DEFAULT_NP
, 
PTHREAD_PROCESS_PRIVATE
 }

	)

51 #ifde‡
__USE_GNU


52 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

53 { 
__LOCK_INITIALIZER
, 0, 
NULL
, NULL, NULL, \

54 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, 
PTHREAD_PROCESS_PRIVATE
 }

	)

61 
	mPTHREAD_CREATE_JOINABLE
,

62 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

63 
	mPTHREAD_CREATE_DETACHED


64 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

69 
	mPTHREAD_INHERIT_SCHED
,

70 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

71 
	mPTHREAD_EXPLICIT_SCHED


72 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

77 
	mPTHREAD_SCOPE_SYSTEM
,

78 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

79 
	mPTHREAD_SCOPE_PROCESS


80 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

85 
	mPTHREAD_MUTEX_TIMED_NP
,

86 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

87 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

88 
	mPTHREAD_MUTEX_ADAPTIVE_NP


89 #ifde‡
__USE_UNIX98


91 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

92 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

93 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

94 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


96 #ifde‡
__USE_GNU


98 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_ADAPTIVE_NP


104 
	mPTHREAD_PROCESS_PRIVATE
,

105 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

106 
	mPTHREAD_PROCESS_SHARED


107 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

110 #ifde‡
__USE_UNIX98


113 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

114 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

115 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

116 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_WRITER_NP


120 
	#PTHREAD_ONCE_INIT
 0

	)

124 #ifde‡
__USE_XOPEN2K


126 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

131 
	s_±hªad_˛ónup_buf„r


133 (*
	m__routöe
) (*);

134 *
	m__¨g
;

135 
	m__ˇn˚…y≥
;

136 
_±hªad_˛ónup_buf„r
 *
	m__¥ev
;

143 
	mPTHREAD_CANCEL_ENABLE
,

144 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

145 
	mPTHREAD_CANCEL_DISABLE


146 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

150 
	mPTHREAD_CANCEL_DEFERRED
,

151 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

152 
	mPTHREAD_CANCEL_ASYNCHRONOUS


153 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

155 
	#PTHREAD_CANCELED
 ((*Ë-1)

	)

163 
±hªad_¸óã
 (
±hªad_t
 *
__ª°ri˘
 
__thªadp
,

164 
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

165 *(*
__°¨t_routöe
) (*),

166 *
__ª°ri˘
 
__¨g
Ë
__THROW
;

169 
±hªad_t
 
	$±hªad_£lf
 (Ë
__THROW
;

172 
	$±hªad_equÆ
 (
±hªad_t
 
__thªad1
,Öthªad_à
__thªad2
Ë
__THROW
;

175 
	$±hªad_exô
 (*
__ªtvÆ
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

180 
	`±hªad_joö
 (
±hªad_t
 
__th
, **
__thªad_ªtu∫
);

186 
	$±hªad_dëach
 (
±hªad_t
 
__th
Ë
__THROW
;

194 
	$±hªad_©å_öô
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
;

197 
	$±hªad_©å_de°roy
 (
±hªad_©å_t
 *
__©å
Ë
__THROW
;

200 
	$±hªad_©å_£tdëach°©e
 (
±hªad_©å_t
 *
__©å
,

201 
__dëach°©e
Ë
__THROW
;

204 
	$±hªad_©å_gëdëach°©e
 (
__c⁄°
 
±hªad_©å_t
 *
__©å
,

205 *
__dëach°©e
Ë
__THROW
;

208 
	$±hªad_©å_£tsched∑øm
 (
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

209 
__c⁄°
 
sched_∑øm
 *
__ª°ri˘


210 
__∑øm
Ë
__THROW
;

213 
	$±hªad_©å_gësched∑øm
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


214 
__©å
,

215 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

216 
__THROW
;

219 
	$±hªad_©å_£tschedpﬁicy
 (
±hªad_©å_t
 *
__©å
, 
__pﬁicy
)

220 
__THROW
;

223 
	$±hªad_©å_gëschedpﬁicy
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


224 
__©å
, *
__ª°ri˘
 
__pﬁicy
)

225 
__THROW
;

228 
	$±hªad_©å_£töhîôsched
 (
±hªad_©å_t
 *
__©å
,

229 
__öhîô
Ë
__THROW
;

232 
	$±hªad_©å_gëöhîôsched
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


233 
__©å
, *
__ª°ri˘
 
__öhîô
)

234 
__THROW
;

237 
	$±hªad_©å_£tsc›e
 (
±hªad_©å_t
 *
__©å
, 
__sc›e
)

238 
__THROW
;

241 
	$±hªad_©å_gësc›e
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

242 *
__ª°ri˘
 
__sc›e
Ë
__THROW
;

244 #ifde‡
__USE_UNIX98


246 
	$±hªad_©å_£tgu¨dsize
 (
±hªad_©å_t
 *
__©å
,

247 
size_t
 
__gu¨dsize
Ë
__THROW
;

250 
	$±hªad_©å_gëgu¨dsize
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


251 
__©å
, 
size_t
 *
__ª°ri˘
 
__gu¨dsize
)

252 
__THROW
;

259 
	$±hªad_©å_£t°ackaddr
 (
±hªad_©å_t
 *
__©å
,

260 *
__°ackaddr
Ë
__THROW
;

263 
	$±hªad_©å_gë°ackaddr
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


264 
__©å
, **
__ª°ri˘
 
__°ackaddr
)

265 
__THROW
;

267 #ifde‡
__USE_XOPEN2K


271 
	$±hªad_©å_£t°ack
 (
±hªad_©å_t
 *
__©å
, *
__°ackaddr
,

272 
size_t
 
__°acksize
Ë
__THROW
;

275 
	$±hªad_©å_gë°ack
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘
 
__©å
,

276 **
__ª°ri˘
 
__°ackaddr
,

277 
size_t
 *
__ª°ri˘
 
__°acksize
Ë
__THROW
;

283 
	$±hªad_©å_£t°acksize
 (
±hªad_©å_t
 *
__©å
,

284 
size_t
 
__°acksize
Ë
__THROW
;

287 
	$±hªad_©å_gë°acksize
 (
__c⁄°
 
±hªad_©å_t
 *
__ª°ri˘


288 
__©å
, 
size_t
 *
__ª°ri˘
 
__°acksize
)

289 
__THROW
;

291 #ifde‡
__USE_GNU


295 
	$±hªad_gë©å_≈
 (
±hªad_t
 
__th
, 
±hªad_©å_t
 *
__©å
Ë
__THROW
;

302 
	$±hªad_£tsched∑øm
 (
±hªad_t
 
__èrgë_thªad
, 
__pﬁicy
,

303 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

304 
__THROW
;

307 
	$±hªad_gësched∑øm
 (
±hªad_t
 
__èrgë_thªad
,

308 *
__ª°ri˘
 
__pﬁicy
,

309 
sched_∑øm
 *
__ª°ri˘
 
__∑øm
)

310 
__THROW
;

312 #ifde‡
__USE_UNIX98


314 
	$±hªad_gëc⁄cuºícy
 (Ë
__THROW
;

317 
	$±hªad_£tc⁄cuºícy
 (
__Àvñ
Ë
__THROW
;

320 #ifde‡
__USE_GNU


325 
	$±hªad_yõld
 (Ë
__THROW
;

332 
	$±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

333 
__c⁄°
 
±hªad_muãx©å_t
 *
__ª°ri˘


334 
__muãx_©å
Ë
__THROW
;

337 
	$±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
Ë
__THROW
;

340 
	$±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
Ë
__THROW
;

343 
	$±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
Ë
__THROW
;

345 #ifde‡
__USE_XOPEN2K


347 
	$±hªad_muãx_timedlock
 (
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

348 
__c⁄°
 
time•ec
 *
__ª°ri˘


349 
__ab°ime
Ë
__THROW
;

353 
	$±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
Ë
__THROW
;

360 
	$±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
Ë
__THROW
;

363 
	$±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
Ë
__THROW
;

366 
	$±hªad_muãx©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_muãx©å_t
 *

367 
__ª°ri˘
 
__©å
,

368 *
__ª°ri˘
 
__psh¨ed
Ë
__THROW
;

371 
	$±hªad_muãx©å_£çsh¨ed
 (
±hªad_muãx©å_t
 *
__©å
,

372 
__psh¨ed
Ë
__THROW
;

374 #ifde‡
__USE_UNIX98


378 
	$±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
, 
__köd
)

379 
__THROW
;

382 
	$±hªad_muãx©å_gëty≥
 (
__c⁄°
 
±hªad_muãx©å_t
 *
__ª°ri˘


383 
__©å
, *
__ª°ri˘
 
__köd
Ë
__THROW
;

391 
	$±hªad_c⁄d_öô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

392 
__c⁄°
 
±hªad_c⁄d©å_t
 *
__ª°ri˘


393 
__c⁄d_©å
Ë
__THROW
;

396 
	$±hªad_c⁄d_de°roy
 (
±hªad_c⁄d_t
 *
__c⁄d
Ë
__THROW
;

399 
	$±hªad_c⁄d_sig«l
 (
±hªad_c⁄d_t
 *
__c⁄d
Ë
__THROW
;

402 
	$±hªad_c⁄d_brﬂdˇ°
 (
±hªad_c⁄d_t
 *
__c⁄d
Ë
__THROW
;

406 
	`±hªad_c⁄d_waô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

407 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
);

413 
	`±hªad_c⁄d_timedwaô
 (
±hªad_c⁄d_t
 *
__ª°ri˘
 
__c⁄d
,

414 
±hªad_muãx_t
 *
__ª°ri˘
 
__muãx
,

415 
__c⁄°
 
time•ec
 *
__ª°ri˘


416 
__ab°ime
);

421 
	$±hªad_c⁄d©å_öô
 (
±hªad_c⁄d©å_t
 *
__©å
Ë
__THROW
;

424 
	$±hªad_c⁄d©å_de°roy
 (
±hªad_c⁄d©å_t
 *
__©å
Ë
__THROW
;

427 
	$±hªad_c⁄d©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_c⁄d©å_t
 *

428 
__ª°ri˘
 
__©å
,

429 *
__ª°ri˘
 
__psh¨ed
Ë
__THROW
;

432 
	$±hªad_c⁄d©å_£çsh¨ed
 (
±hªad_c⁄d©å_t
 *
__©å
,

433 
__psh¨ed
Ë
__THROW
;

436 #ifde‡
__USE_UNIX98


441 
	$±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

442 
__c⁄°
 
±hªad_rwlock©å_t
 *
__ª°ri˘


443 
__©å
Ë
__THROW
;

446 
	$±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

449 
	$±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

452 
	$±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

454 #ifde‡
__USE_XOPEN2K


456 
	$±hªad_rwlock_timedrdlock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

457 
__c⁄°
 
time•ec
 *
__ª°ri˘


458 
__ab°ime
Ë
__THROW
;

462 
	$±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

465 
	$±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

467 #ifde‡
__USE_XOPEN2K


469 
	$±hªad_rwlock_timedwæock
 (
±hªad_rwlock_t
 *
__ª°ri˘
 
__rwlock
,

470 
__c⁄°
 
time•ec
 *
__ª°ri˘


471 
__ab°ime
Ë
__THROW
;

475 
	$±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
Ë
__THROW
;

481 
	$±hªad_rwlock©å_öô
 (
±hªad_rwlock©å_t
 *
__©å
Ë
__THROW
;

484 
	$±hªad_rwlock©å_de°roy
 (
±hªad_rwlock©å_t
 *
__©å
Ë
__THROW
;

487 
	$±hªad_rwlock©å_gëpsh¨ed
 (
__c⁄°
 
±hªad_rwlock©å_t
 *

488 
__ª°ri˘
 
__©å
,

489 *
__ª°ri˘
 
__psh¨ed
Ë
__THROW
;

492 
	$±hªad_rwlock©å_£çsh¨ed
 (
±hªad_rwlock©å_t
 *
__©å
,

493 
__psh¨ed
Ë
__THROW
;

496 
	$±hªad_rwlock©å_gëköd_≈
 (
__c⁄°
 
±hªad_rwlock©å_t
 *
__©å
,

497 *
__¥ef
Ë
__THROW
;

500 
	$±hªad_rwlock©å_£tköd_≈
 (
±hªad_rwlock©å_t
 *
__©å
,

501 
__¥ef
Ë
__THROW
;

504 #ifde‡
__USE_XOPEN2K


510 
	$±hªad_•ö_öô
 (
±hªad_•ölock_t
 *
__lock
, 
__psh¨ed
)

511 
__THROW
;

514 
	$±hªad_•ö_de°roy
 (
±hªad_•ölock_t
 *
__lock
Ë
__THROW
;

517 
	$±hªad_•ö_lock
 (
±hªad_•ölock_t
 *
__lock
Ë
__THROW
;

520 
	$±hªad_•ö_åylock
 (
±hªad_•ölock_t
 *
__lock
Ë
__THROW
;

523 
	$±hªad_•ö_u∆ock
 (
±hªad_•ölock_t
 *
__lock
Ë
__THROW
;

528 
	$±hªad_b¨rõr_öô
 (
±hªad_b¨rõr_t
 *
__ª°ri˘
 
__b¨rõr
,

529 
__c⁄°
 
±hªad_b¨rõøâr_t
 *
__ª°ri˘


530 
__©å
, 
__cou¡
Ë
__THROW
;

532 
	$±hªad_b¨rõr_de°roy
 (
±hªad_b¨rõr_t
 *
__b¨rõr
Ë
__THROW
;

534 
	$±hªad_b¨rõøâr_öô
 (
±hªad_b¨rõøâr_t
 *
__©å
Ë
__THROW
;

536 
	$±hªad_b¨rõøâr_de°roy
 (
±hªad_b¨rõøâr_t
 *
__©å
Ë
__THROW
;

538 
	$±hªad_b¨rõøâr_gëpsh¨ed
 (
__c⁄°
 
±hªad_b¨rõøâr_t
 *

539 
__ª°ri˘
 
__©å
,

540 *
__ª°ri˘
 
__psh¨ed
Ë
__THROW
;

542 
	$±hªad_b¨rõøâr_£çsh¨ed
 (
±hªad_b¨rõøâr_t
 *
__©å
,

543 
__psh¨ed
Ë
__THROW
;

545 
	$±hªad_b¨rõr_waô
 (
±hªad_b¨rõr_t
 *
__b¨rõr
Ë
__THROW
;

557 
	`±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

558 (*
__de°r_fun˘i⁄
Ë(*)Ë
__THROW
;

561 
	$±hªad_key_dñëe
 (
±hªad_key_t
 
__key
Ë
__THROW
;

564 
	$±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

565 
__c⁄°
 *
__poöãr
Ë
__THROW
;

568 *
	$±hªad_gë•ecific
 (
±hªad_key_t
 
__key
Ë
__THROW
;

577 
	`±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

578 (*
__öô_routöe
Ë()Ë
__THROW
;

585 
	$±hªad_£tˇn˚l°©e
 (
__°©e
, *
__ﬁd°©e
Ë
__THROW
;

589 
	$±hªad_£tˇn˚…y≥
 (
__ty≥
, *
__ﬁdty≥
Ë
__THROW
;

592 
	$±hªad_ˇn˚l
 (
±hªad_t
 
__ˇn˚…hªad
Ë
__THROW
;

597 
	$±hªad_ã°ˇn˚l
 (Ë
__THROW
;

607 
	#±hªad_˛ónup_push
(
routöe
,
¨g
) \

608 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

609 
	`_±hªad_˛ónup_push
 (&
_buf„r
, (
routöe
), (
¨g
));

	)

611 
	`_±hªad_˛ónup_push
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

612 (*
__routöe
) (*),

613 *
__¨g
Ë
__THROW
;

618 
	#±hªad_˛ónup_p›
(
execuã
) \

619 
	`_±hªad_˛ónup_p›
 (&
_buf„r
, (
execuã
)); 
	}

	)
}

621 
	$_±hªad_˛ónup_p›
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

622 
__execuã
Ë
__THROW
;

627 #ifde‡
__USE_GNU


628 
	#±hªad_˛ónup_push_de„r_≈
(
routöe
,
¨g
) \

629 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

630 
	`_±hªad_˛ónup_push_de„r
 (&
_buf„r
, (
routöe
), (
¨g
));

	)

632 
	`_±hªad_˛ónup_push_de„r
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

633 (*
__routöe
) (*),

634 *
__¨g
Ë
__THROW
;

640 
	#±hªad_˛ónup_p›_ª°‹e_≈
(
execuã
) \

641 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
execuã
)); 
	}

	)
}

643 
	$_±hªad_˛ónup_p›_ª°‹e
 (
_±hªad_˛ónup_buf„r
 *
__buf„r
,

644 
__execuã
Ë
__THROW
;

648 #ifde‡
__USE_XOPEN2K


650 
	$±hªad_gë˝u˛ockid
 (
±hªad_t
 
__thªad_id
,

651 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

656 
	~<bôs/sigthªad.h
>

672 
	`±hªad_©f‹k
 ((*
__¥ï¨e
) (),

673 (*
__∑ª¡
) (),

674 (*
__chûd
Ë()Ë
__THROW
;

679 
	$±hªad_kûl_Ÿhî_thªads_≈
 (Ë
__THROW
;

681 
__END_DECLS


	@/usr/include/pwd.h

23 #i‚def 
_PWD_H


24 
	#_PWD_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ty≥s.h
>

32 
	#__√ed_size_t


	)

33 
	~<°ddef.h
>

35 #ifde‡
__USE_XOPEN


38 #i‚de‡
__gid_t_deföed


39 
__gid_t
 
	tgid_t
;

40 
	#__gid_t_deföed


	)

43 #i‚de‡
__uid_t_deföed


44 
__uid_t
 
	tuid_t
;

45 
	#__uid_t_deföed


	)

50 
	s∑sswd


52 *
	mpw_«me
;

53 *
	mpw_∑sswd
;

54 
__uid_t
 
	mpw_uid
;

55 
__gid_t
 
	mpw_gid
;

56 *
	mpw_gecos
;

57 *
	mpw_dú
;

58 *
	mpw_shñl
;

62 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_GNU


63 
	#__√ed_FILE


	)

64 
	~<°dio.h
>

68 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


73 
£çwít
 ();

79 
ídpwít
 ();

85 
∑sswd
 *
gëpwít
 ();

88 #ifdef 
__USE_SVID


95 
∑sswd
 *
fgëpwít
 (
FILE
 *
__°ªam
);

103 
puçwít
 (
__c⁄°
 
∑sswd
 *
__ª°ri˘
 
__p
,

104 
FILE
 *
__ª°ri˘
 
__f
);

111 
∑sswd
 *
gëpwuid
 (
__uid_t
 
__uid
);

117 
∑sswd
 *
gëpw«m
 (
__c⁄°
 *
__«me
);

119 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


121 #ifde‡
__USE_MISC


124 
	#NSS_BUFLEN_PASSWD
 1024

	)

135 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC


140 
gëpwít_r
 (
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

141 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

142 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

145 
gëpwuid_r
 (
__uid_t
 
__uid
,

146 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

147 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

148 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

150 
gëpw«m_r
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

151 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

152 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

153 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

156 #ifdef 
__USE_SVID


164 
fgëpwít_r
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

165 
∑sswd
 *
__ª°ri˘
 
__ªsu…buf
,

166 *
__ª°ri˘
 
__buf„r
, 
size_t
 
__buÊí
,

167 
∑sswd
 **
__ª°ri˘
 
__ªsu…
);

172 #ifde‡
__USE_GNU


181 
gëpw
 (
__uid_t
 
__uid
, *
__buf„r
);

184 
	g__END_DECLS


	@/usr/include/setjmp.h

23 #i‚def 
_SETJMP_H


24 
	#_SETJMP_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/£tjmp.h
>

31 
	~<bôs/sig£t.h
>

33 
__BEGIN_NAMESPACE_STD


36 
	s__jmp_buf_èg


42 
__jmp_buf
 
	m__jmpbuf
;

43 
	m__mask_was_ßved
;

44 
__sig£t_t
 
	m__ßved_mask
;

45 } 
	tjmp_buf
[1];

50 
	$£tjmp
 (
jmp_buf
 
__ív
Ë
__THROW
;

52 
__END_NAMESPACE_STD


53 
	$__USING_NAMESPACE_STD
(
__jmp_buf_èg
)

58 
	`__sig£tjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__ßvemask
Ë
__THROW
;

60 #i‚def 
__FAVOR_BSD


63 
	`_£tjmp
 (
__jmp_buf_èg
 
__ív
[1]Ë
__THROW
;

67 
	#£tjmp
(
ív
Ë
	`_£tjmp
 (ív)

	)

72 
	#£tjmp
(
ív
Ë
	`£tjmp
 (ív)

	)

76 
__BEGIN_NAMESPACE_STD


80 
	`l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

81 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

83 
__END_NAMESPACE_STD


85 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


89 
	`_l⁄gjmp
 (
__jmp_buf_èg
 
__ív
[1], 
__vÆ
)

90 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

94 #ifdef 
__USE_POSIX


98 
__jmp_buf_èg
 
	tsigjmp_buf
[1];

102 
	#sig£tjmp
(
ív
, 
ßvemask
Ë
	`__sig£tjmp
 (ív, savemask)

	)

108 
	$sigl⁄gjmp
 (
sigjmp_buf
 
__ív
, 
__vÆ
)

109 
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

112 
__END_DECLS


	@/usr/include/sgtty.h

19 #i‚def 
_SGTTY_H


20 
	#_SGTTY_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<sys/io˘l.h
>

28 
	gsgâyb
;

30 
__BEGIN_DECLS


33 
	$gây
 (
__fd
, 
sgâyb
 *
__∑øms
Ë
__THROW
;

36 
	$°ty
 (
__fd
, 
__c⁄°
 
sgâyb
 *
__∑øms
Ë
__THROW
;

39 
__END_DECLS


	@/usr/include/signal.h

23 #i‚def 
_SIGNAL_H


25 #i‡!
deföed
 
__√ed_sig_©omic_t
 && !deföed 
__√ed_sig£t_t


26 
	#_SIGNAL_H


	)

29 
	~<„©uªs.h
>

31 
	g__BEGIN_DECLS


33 
	~<bôs/sig£t.h
>

37 #i‡
deföed
 
__√ed_sig_©omic_t
 || deföed 
_SIGNAL_H


38 #i‚de‡
__sig_©omic_t_deföed


39 
	#__sig_©omic_t_deföed


	)

40 
__BEGIN_NAMESPACE_STD


41 
__sig_©omic_t
 
	tsig_©omic_t
;

42 
	g__END_NAMESPACE_STD


44 #unde‡
__√ed_sig_©omic_t


47 #i‡
deföed
 
__√ed_sig£t_t
 || (deföed 
_SIGNAL_H
 && deföed 
__USE_POSIX
)

48 #i‚de‡
__sig£t_t_deföed


49 
	#__sig£t_t_deföed


	)

50 
__sig£t_t
 
	tsig£t_t
;

52 #unde‡
__√ed_sig£t_t


55 #ifde‡
_SIGNAL_H


57 
	~<bôs/ty≥s.h
>

58 
	~<bôs/signum.h
>

60 #ifde‡
__USE_XOPEN


61 #i‚de‡
__pid_t_deföed


62 
__pid_t
 
	tpid_t
;

63 
	#__pid_t_deföed


	)

65 #i‚de‡
__uid_t_deföed


66 
__uid_t
 
	tuid_t
;

67 
	#__uid_t_deföed


	)

73 (*
	t__sigh™dÀr_t
) ();

78 
__sigh™dÀr_t
 
	$__sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

79 
__THROW
;

80 #ifde‡
__USE_GNU


81 
__sigh™dÀr_t
 
	$sysv_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
)

82 
__THROW
;

88 
__BEGIN_NAMESPACE_STD


89 #ifde‡
__USE_BSD


90 
__sigh™dÀr_t
 
	$sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
Ë
__THROW
;

93 #ifde‡
__REDIRECT


94 
__sigh™dÀr_t
 
	`__REDIRECT
 (
sig«l
,

95 (
__sig
,

96 
__sigh™dÀr_t
 
__h™dÀr
Ë
__THROW
,

97 
__sysv_sig«l
);

99 
	#sig«l
 
__sysv_sig«l


	)

102 
__END_NAMESPACE_STD


104 #ifde‡
__USE_XOPEN


107 
__sigh™dÀr_t
 
	$bsd_sig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
Ë
__THROW
;

113 #ifde‡
__USE_POSIX


114 
	$kûl
 (
__pid_t
 
__pid
, 
__sig
Ë
__THROW
;

117 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


121 
	$kûÕg
 (
__pid_t
 
__pgΩ
, 
__sig
Ë
__THROW
;

124 
__BEGIN_NAMESPACE_STD


126 
	$øi£
 (
__sig
Ë
__THROW
;

127 
__END_NAMESPACE_STD


129 #ifde‡
__USE_SVID


131 
__sigh™dÀr_t
 
	$ssig«l
 (
__sig
, 
__sigh™dÀr_t
 
__h™dÀr
Ë
__THROW
;

132 
	$gsig«l
 (
__sig
Ë
__THROW
;

135 #ifde‡
__USE_MISC


137 
	`psig«l
 (
__sig
, 
__c⁄°
 *
__s
);

149 
	`__sig∑u£
 (
__sig_‹_mask
, 
__is_sig
);

151 #ifde‡
__USE_BSD


154 
	$sig∑u£
 (
__mask
Ë
__THROW
;

155 
	#sig∑u£
(
mask
Ë
	`__sig∑u£
 ((mask), 0)

	)

157 #ifde‡
__USE_XOPEN


158 #ifde‡
__GNUC__


159 
	$sig∑u£
 (
__sig
Ë
	`__asm__
 ("__xpg_sigpause");

162 
	#sig∑u£
(
sig
Ë
	`__sig∑u£
 ((sig), 1)

	)

167 #ifde‡
__USE_BSD


174 
	#sigmask
(
sig
Ë
	`__sigmask
(sig)

	)

177 
	$sigblock
 (
__mask
Ë
__THROW
;

180 
	$sig£tmask
 (
__mask
Ë
__THROW
;

183 
	$siggëmask
 (Ë
__THROW
;

187 #ifde‡
__USE_MISC


188 
	#NSIG
 
_NSIG


	)

191 #ifde‡
__USE_GNU


192 
__sigh™dÀr_t
 
	tsigh™dÀr_t
;

196 #ifde‡
__USE_BSD


197 
__sigh™dÀr_t
 
	tsig_t
;

200 #ifde‡
__USE_POSIX


202 #ifde‡
__USE_POSIX199309


204 
	#__√ed_time•ec


	)

205 
	~<time.h
>

208 
	~<bôs/sigöfo.h
>

212 
	$sigem±y£t
 (
sig£t_t
 *
__£t
Ë
__THROW
;

215 
	$sigfûl£t
 (
sig£t_t
 *
__£t
Ë
__THROW
;

218 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
;

221 
	$sigdñ£t
 (
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
;

224 
	$sigismembî
 (
__c⁄°
 
sig£t_t
 *
__£t
, 
__signo
Ë
__THROW
;

226 #ifde‡
__USE_GNU


228 
	$sigi£m±y£t
 (
__c⁄°
 
sig£t_t
 *
__£t
Ë
__THROW
;

231 
	$sig™d£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

232 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
;

235 
	$sig‹£t
 (
sig£t_t
 *
__£t
, 
__c⁄°
 sig£t_à*
__À·
,

236 
__c⁄°
 
sig£t_t
 *
__right
Ë
__THROW
;

241 
	~<bôs/siga˘i⁄.h
>

244 
	$sig¥ocmask
 (
__how
, 
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

245 
sig£t_t
 *
__ª°ri˘
 
__o£t
Ë
__THROW
;

252 
	`sigsu•íd
 (
__c⁄°
 
sig£t_t
 *
__£t
);

255 
	$siga˘i⁄
 (
__sig
, 
__c⁄°
 
siga˘i⁄
 *
__ª°ri˘
 
__a˘
,

256 
siga˘i⁄
 *
__ª°ri˘
 
__ﬂ˘
Ë
__THROW
;

259 
	$sig≥ndög
 (
sig£t_t
 *
__£t
Ë
__THROW
;

266 
	`sigwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
, *__ª°ri˘ 
__sig
);

268 #ifde‡
__USE_POSIX199309


273 
	`sigwaôöfo
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

274 
sigöfo_t
 *
__ª°ri˘
 
__öfo
);

281 
	`sigtimedwaô
 (
__c⁄°
 
sig£t_t
 *
__ª°ri˘
 
__£t
,

282 
sigöfo_t
 *
__ª°ri˘
 
__öfo
,

283 
__c⁄°
 
time•ec
 *
__ª°ri˘
 
__timeout
);

287 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, 
__c⁄°
 
sigvÆ
 
__vÆ
)

288 
__THROW
;

293 #ifde‡
__USE_BSD


297 
__c⁄°
 *__c⁄° 
_sys_sigli°
[
_NSIG
];

298 
__c⁄°
 *__c⁄° 
sys_sigli°
[
_NSIG
];

301 
	ssigvec


303 
__sigh™dÀr_t
 
sv_h™dÀr
;

304 
sv_mask
;

306 
sv_Êags
;

307 
	#sv_⁄°ack
 
sv_Êags


	)

311 
	#SV_ONSTACK
 (1 << 0)

	)

312 
	#SV_INTERRUPT
 (1 << 1)

	)

313 
	#SV_RESETHAND
 (1 << 2)

	)

321 
	$sigvec
 (
__sig
, 
__c⁄°
 
sigvec
 *
__vec
,

322 
sigvec
 *
__ovec
Ë
__THROW
;

326 
	~<bôs/sigc⁄ãxt.h
>

329 
	$sigªtu∫
 (
sigc⁄ãxt
 *
__s˝
Ë
__THROW
;

334 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


339 
	$sigöãºu±
 (
__sig
, 
__öãºu±
Ë
__THROW
;

341 
	~<bôs/sig°ack.h
>

342 #ifde‡
__USE_XOPEN


344 
	~<sys/uc⁄ãxt.h
>

350 
	$sig°ack
 (
sig°ack
 *
__ss
, sig°ack *
__oss
Ë
__THROW
;

354 
	$sigÆt°ack
 (
__c⁄°
 
sigÆt°ack
 *
__ª°ri˘
 
__ss
,

355 
sigÆt°ack
 *
__ª°ri˘
 
__oss
Ë
__THROW
;

359 #ifde‡
__USE_XOPEN_EXTENDED


363 
	$sighﬁd
 (
__sig
Ë
__THROW
;

366 
	$sigªl£
 (
__sig
Ë
__THROW
;

369 
	$sigign‹e
 (
__sig
Ë
__THROW
;

372 
__sigh™dÀr_t
 
	$sig£t
 (
__sig
, 
__sigh™dÀr_t
 
__di•
Ë
__THROW
;

375 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


378 
	~<bôs/±hªadty≥s.h
>

379 
	~<bôs/sigthªad.h
>

386 
	$__libc_cuºít_sigπmö
 (Ë
__THROW
;

388 
	$__libc_cuºít_sigπmax
 (Ë
__THROW
;

392 
__END_DECLS


	@/usr/include/stdio.h

24 #i‚de‡
_STDIO_H


26 #i‡!
deföed
 
__√ed_FILE
 && !deföed 
__√ed___FILE


27 
	#_STDIO_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


32 
	#__√ed_size_t


	)

33 
	#__√ed_NULL


	)

34 
	~<°ddef.h
>

36 
	~<bôs/ty≥s.h
>

37 
	#__√ed_FILE


	)

38 
	#__√ed___FILE


	)

42 #i‡!
deföed
 
__FILE_deföed
 && deföed 
__√ed_FILE


44 
__BEGIN_NAMESPACE_STD


46 
_IO_FILE
 
	tFILE
;

47 
	g__END_NAMESPACE_STD


48 #i‡
deföed
 
__USE_LARGEFILE64
 || deföed 
__USE_SVID
 || deföed 
__USE_POSIX
 \

49 || 
deföed
 
	g__USE_BSD
 || deföed 
	g__USE_ISOC99
 || deföed 
	g__USE_XOPEN
 \

50 || 
deföed
 
__USE_POSIX2


51 
	$__USING_NAMESPACE_STD
(
FILE
)

54 
	#__FILE_deföed
 1

	)

56 #unde‡
__√ed_FILE


59 #i‡!
deföed
 
____FILE_deföed
 && deföed 
__√ed___FILE


62 
_IO_FILE
 
	t__FILE
;

64 
	#____FILE_deföed
 1

	)

66 #unde‡
__√ed___FILE


69 #ifdef 
_STDIO_H


70 
	#_STDIO_USES_IOSTREAM


	)

72 
	~<libio.h
>

74 #ifde‡
__USE_XOPEN


75 #ifde‡
__GNUC__


76 #i‚de‡
_VA_LIST_DEFINED


77 
_G_va_li°
 
	tva_li°
;

78 
	#_VA_LIST_DEFINED


	)

81 
	~<°d¨g.h
>

86 
__BEGIN_NAMESPACE_STD


87 #i‚de‡
__USE_FILE_OFFSET64


88 
_G_Âos_t
 
	tÂos_t
;

90 
_G_Âos64_t
 
	tÂos_t
;

92 
__END_NAMESPACE_STD


93 #ifde‡
__USE_LARGEFILE64


94 
_G_Âos64_t
 
	tÂos64_t
;

98 
	#_IOFBF
 0

	)

99 
	#_IOLBF
 1

	)

100 
	#_IONBF
 2

	)

104 #i‚de‡
BUFSIZ


105 
	#BUFSIZ
 
_IO_BUFSIZ


	)

111 #i‚de‡
EOF


112 
	#EOF
 (-1)

	)

118 
	#SEEK_SET
 0

	)

119 
	#SEEK_CUR
 1

	)

120 
	#SEEK_END
 2

	)

123 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


125 
	#P_tmpdú
 "/tmp"

	)

138 
	~<bôs/°dio_lim.h
>

142 
_IO_FILE
 *
°dö
;

143 
_IO_FILE
 *
°dout
;

144 
_IO_FILE
 *
°dîr
;

146 
	#°dö
 
°dö


	)

147 
	#°dout
 
°dout


	)

148 
	#°dîr
 
°dîr


	)

150 
__BEGIN_NAMESPACE_STD


152 
	$ªmove
 (
__c⁄°
 *
__fûíame
Ë
__THROW
;

154 
	$ª«me
 (
__c⁄°
 *
__ﬁd
, __c⁄° *
__√w
Ë
__THROW
;

155 
__END_NAMESPACE_STD


158 
__BEGIN_NAMESPACE_STD


163 #i‚de‡
__USE_FILE_OFFSET64


164 
FILE
 *
	`tmpfûe
 ();

166 #ifde‡
__REDIRECT


167 
FILE
 *
	`__REDIRECT
 (
tmpfûe
, (), 
tmpfûe64
);

169 
	#tmpfûe
 
tmpfûe64


	)

173 #ifde‡
__USE_LARGEFILE64


174 
FILE
 *
	`tmpfûe64
 ();

178 *
	$tm≤am
 (*
__s
Ë
__THROW
;

179 
__END_NAMESPACE_STD


181 #ifde‡
__USE_MISC


184 *
	$tm≤am_r
 (*
__s
Ë
__THROW
;

188 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


196 *
	$ãm≤am
 (
__c⁄°
 *
__dú
, __c⁄° *
__pfx
)

197 
__THROW
 
__©åibuã_mÆloc__
;

201 
__BEGIN_NAMESPACE_STD


206 
	`f˛o£
 (
FILE
 *
__°ªam
);

211 
	`fÊush
 (
FILE
 *
__°ªam
);

212 
__END_NAMESPACE_STD


214 #ifde‡
__USE_MISC


221 
	`fÊush_u∆ocked
 (
FILE
 *
__°ªam
);

224 #ifde‡
__USE_GNU


231 
	`f˛o£Æl
 ();

235 
__BEGIN_NAMESPACE_STD


236 #i‚de‡
__USE_FILE_OFFSET64


241 
FILE
 *
	`f›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

242 
__c⁄°
 *
__ª°ri˘
 
__modes
);

247 
FILE
 *
	`‰e›í
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

248 
__c⁄°
 *
__ª°ri˘
 
__modes
,

249 
FILE
 *
__ª°ri˘
 
__°ªam
);

251 #ifde‡
__REDIRECT


252 
FILE
 *
	`__REDIRECT
 (
f›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

253 
__c⁄°
 *
__ª°ri˘
 
__modes
), 
f›í64
);

254 
FILE
 *
	`__REDIRECT
 (
‰e›í
, (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

255 
__c⁄°
 *
__ª°ri˘
 
__modes
,

256 
FILE
 *
__ª°ri˘
 
__°ªam
), 
‰e›í64
);

258 
	#f›í
 
f›í64


	)

259 
	#‰e›í
 
‰e›í64


	)

262 
__END_NAMESPACE_STD


263 #ifde‡
__USE_LARGEFILE64


264 
FILE
 *
	`f›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

265 
__c⁄°
 *
__ª°ri˘
 
__modes
);

266 
FILE
 *
	`‰e›í64
 (
__c⁄°
 *
__ª°ri˘
 
__fûíame
,

267 
__c⁄°
 *
__ª°ri˘
 
__modes
,

268 
FILE
 *
__ª°ri˘
 
__°ªam
);

271 #ifdef 
__USE_POSIX


273 
FILE
 *
	$fd›í
 (
__fd
, 
__c⁄°
 *
__modes
Ë
__THROW
;

276 #ifdef 
__USE_GNU


279 
FILE
 *
	$f›ícookõ
 (*
__ª°ri˘
 
__magic_cookõ
,

280 
__c⁄°
 *
__ª°ri˘
 
__modes
,

281 
_IO_cookõ_io_fun˘i⁄s_t
 
__io_funcs
Ë
__THROW
;

284 
FILE
 *
	$fmem›í
 (*
__s
, 
size_t
 
__Àn
, 
__c⁄°
 *
__modes
Ë
__THROW
;

289 
FILE
 *
	$›í_mem°ªam
 (**
__ª°ri˘
 
__buÊoc
,

290 
size_t
 *
__ª°ri˘
 
__sizñoc
Ë
__THROW
;

294 
__BEGIN_NAMESPACE_STD


297 
	$£tbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
Ë
__THROW
;

301 
	$£tvbuf
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

302 
__modes
, 
size_t
 
__n
Ë
__THROW
;

303 
__END_NAMESPACE_STD


305 #ifdef 
__USE_BSD


308 
	$£tbuf„r
 (
FILE
 *
__ª°ri˘
 
__°ªam
, *__ª°ri˘ 
__buf
,

309 
size_t
 
__size
Ë
__THROW
;

312 
	$£éöebuf
 (
FILE
 *
__°ªam
Ë
__THROW
;

316 
__BEGIN_NAMESPACE_STD


321 
	`Ârötf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

322 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

327 
	`¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

329 
	$•rötf
 (*
__ª°ri˘
 
__s
,

330 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

336 
	`vÂrötf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

337 
_G_va_li°
 
__¨g
);

342 
	`v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
);

344 
	$v•rötf
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

345 
_G_va_li°
 
__¨g
Ë
__THROW
;

346 
__END_NAMESPACE_STD


348 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_ISOC99
 || deföed 
__USE_UNIX98


349 
__BEGIN_NAMESPACE_C99


351 
	$¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

352 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

353 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 4)));

355 
	$v¢¥ötf
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxÀn
,

356 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

357 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 3, 0)));

358 
__END_NAMESPACE_C99


361 #ifde‡
__USE_GNU


364 
	$va•rötf
 (**
__ª°ri˘
 
__±r
, 
__c⁄°
 *__ª°ri˘ 
__f
,

365 
_G_va_li°
 
__¨g
)

366 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

367 
	$__a•rötf
 (**
__ª°ri˘
 
__±r
,

368 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

369 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

370 
	$a•rötf
 (**
__ª°ri˘
 
__±r
,

371 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

372 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

380 
	$vd¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
,

381 
_G_va_li°
 
__¨g
)

382 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

383 
	$d¥ötf
 (
__fd
, 
__c⁄°
 *
__ª°ri˘
 
__fmt
, ...)

384 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

388 
__BEGIN_NAMESPACE_STD


393 
	`fsˇnf
 (
FILE
 *
__ª°ri˘
 
__°ªam
,

394 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

399 
	`sˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...);

401 
	$ssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

402 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...Ë
__THROW
;

403 
__END_NAMESPACE_STD


405 #ifdef 
__USE_ISOC99


406 
__BEGIN_NAMESPACE_C99


411 
	$vfsˇnf
 (
FILE
 *
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__f‹m©
,

412 
_G_va_li°
 
__¨g
)

413 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

419 
	$vsˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

420 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 1, 0)));

423 
	$vssˇnf
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

424 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, 
_G_va_li°
 
__¨g
)

425 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__sˇnf__
, 2, 0)));

426 
__END_NAMESPACE_C99


430 
__BEGIN_NAMESPACE_STD


435 
	`fgëc
 (
FILE
 *
__°ªam
);

436 
	`gëc
 (
FILE
 *
__°ªam
);

442 
	`gëch¨
 ();

443 
__END_NAMESPACE_STD


447 
	#gëc
(
_Â
Ë
	`_IO_gëc
 (_Â)

	)

449 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


454 
	`gëc_u∆ocked
 (
FILE
 *
__°ªam
);

455 
	`gëch¨_u∆ocked
 ();

458 #ifde‡
__USE_MISC


465 
	`fgëc_u∆ocked
 (
FILE
 *
__°ªam
);

469 
__BEGIN_NAMESPACE_STD


477 
	`Âutc
 (
__c
, 
FILE
 *
__°ªam
);

478 
	`putc
 (
__c
, 
FILE
 *
__°ªam
);

484 
	`putch¨
 (
__c
);

485 
__END_NAMESPACE_STD


489 
	#putc
(
_ch
, 
_Â
Ë
	`_IO_putc
 (_ch, _Â)

	)

491 #ifde‡
__USE_MISC


498 
	`Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

501 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


506 
	`putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
);

507 
	`putch¨_u∆ocked
 (
__c
);

511 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_MISC
 \

512 || (
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

514 
	`gëw
 (
FILE
 *
__°ªam
);

517 
	`putw
 (
__w
, 
FILE
 *
__°ªam
);

521 
__BEGIN_NAMESPACE_STD


526 *
	`fgës
 (*
__ª°ri˘
 
__s
, 
__n
, 
FILE
 *__ª°ri˘ 
__°ªam
);

533 *
	`gës
 (*
__s
);

534 
__END_NAMESPACE_STD


536 #ifde‡
__USE_GNU


543 *
	`fgës_u∆ocked
 (*
__ª°ri˘
 
__s
, 
__n
,

544 
FILE
 *
__ª°ri˘
 
__°ªam
);

548 #ifdef 
__USE_GNU


559 
_IO_ssize_t
 
	`__gëdñim
 (**
__ª°ri˘
 
__löïå
,

560 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

561 
FILE
 *
__ª°ri˘
 
__°ªam
);

562 
_IO_ssize_t
 
	`gëdñim
 (**
__ª°ri˘
 
__löïå
,

563 
size_t
 *
__ª°ri˘
 
__n
, 
__dñimôî
,

564 
FILE
 *
__ª°ri˘
 
__°ªam
);

572 
_IO_ssize_t
 
	`gëlöe
 (**
__ª°ri˘
 
__löïå
,

573 
size_t
 *
__ª°ri˘
 
__n
,

574 
FILE
 *
__ª°ri˘
 
__°ªam
);

578 
__BEGIN_NAMESPACE_STD


583 
	`Âuts
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
FILE
 *__ª°ri˘ 
__°ªam
);

589 
	`puts
 (
__c⁄°
 *
__s
);

596 
	`ungëc
 (
__c
, 
FILE
 *
__°ªam
);

603 
size_t
 
	`‰ód
 (*
__ª°ri˘
 
__±r
, size_à
__size
,

604 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

609 
size_t
 
	`fwrôe
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

610 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__s
);

611 
__END_NAMESPACE_STD


613 #ifde‡
__USE_GNU


620 
	`Âuts_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

621 
FILE
 *
__ª°ri˘
 
__°ªam
);

624 #ifde‡
__USE_MISC


631 
size_t
 
	`‰ód_u∆ocked
 (*
__ª°ri˘
 
__±r
, size_à
__size
,

632 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

633 
size_t
 
	`fwrôe_u∆ocked
 (
__c⁄°
 *
__ª°ri˘
 
__±r
, size_à
__size
,

634 
size_t
 
__n
, 
FILE
 *
__ª°ri˘
 
__°ªam
);

638 
__BEGIN_NAMESPACE_STD


643 
	`f£ek
 (
FILE
 *
__°ªam
, 
__off
, 
__whí˚
);

648 
	`·ñl
 (
FILE
 *
__°ªam
);

653 
	`ªwöd
 (
FILE
 *
__°ªam
);

654 
__END_NAMESPACE_STD


661 #ifde‡
__USE_LARGEFILE


662 #i‚de‡
__USE_FILE_OFFSET64


667 
	`f£eko
 (
FILE
 *
__°ªam
, 
__off_t
 
__off
, 
__whí˚
);

672 
__off_t
 
	`·ñlo
 (
FILE
 *
__°ªam
);

674 #ifde‡
__REDIRECT


675 
	`__REDIRECT
 (
f£eko
,

676 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
),

677 
f£eko64
);

678 
__off64_t
 
	`__REDIRECT
 (
·ñlo
, (
FILE
 *
__°ªam
), 
·ñlo64
);

680 
	#f£eko
 
f£eko64


	)

681 
	#·ñlo
 
·ñlo64


	)

686 
__BEGIN_NAMESPACE_STD


687 #i‚de‡
__USE_FILE_OFFSET64


692 
	`fgëpos
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos_t
 *__ª°ri˘ 
__pos
);

697 
	`f£ços
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
);

699 #ifde‡
__REDIRECT


700 
	`__REDIRECT
 (
fgëpos
, (
FILE
 *
__ª°ri˘
 
__°ªam
,

701 
Âos_t
 *
__ª°ri˘
 
__pos
), 
fgëpos64
);

702 
	`__REDIRECT
 (
f£ços
,

703 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos_t
 *
__pos
), 
f£ços64
);

705 
	#fgëpos
 
fgëpos64


	)

706 
	#f£ços
 
f£ços64


	)

709 
__END_NAMESPACE_STD


711 #ifde‡
__USE_LARGEFILE64


712 
	`f£eko64
 (
FILE
 *
__°ªam
, 
__off64_t
 
__off
, 
__whí˚
);

713 
__off64_t
 
	`·ñlo64
 (
FILE
 *
__°ªam
);

714 
	`fgëpos64
 (
FILE
 *
__ª°ri˘
 
__°ªam
, 
Âos64_t
 *__ª°ri˘ 
__pos
);

715 
	`f£ços64
 (
FILE
 *
__°ªam
, 
__c⁄°
 
Âos64_t
 *
__pos
);

718 
__BEGIN_NAMESPACE_STD


720 
	$˛óªº
 (
FILE
 *
__°ªam
Ë
__THROW
;

722 
	$„of
 (
FILE
 *
__°ªam
Ë
__THROW
;

724 
	$„º‹
 (
FILE
 *
__°ªam
Ë
__THROW
;

725 
__END_NAMESPACE_STD


727 #ifde‡
__USE_MISC


729 
	$˛óªº_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

730 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

731 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

735 
__BEGIN_NAMESPACE_STD


740 
	`≥º‹
 (
__c⁄°
 *
__s
);

741 
__END_NAMESPACE_STD


747 
	~<bôs/sys_îæi°.h
>

750 #ifdef 
__USE_POSIX


752 
	$fûío
 (
FILE
 *
__°ªam
Ë
__THROW
;

755 #ifde‡
__USE_MISC


757 
	$fûío_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW
;

761 #i‡(
deföed
 
__USE_POSIX2
 || deföed 
__USE_SVID
 || deföed 
__USE_BSD
 || \

762 
deföed
 
__USE_MISC
)

767 
FILE
 *
	`p›í
 (
__c⁄°
 *
__comm™d
, __c⁄° *
__modes
);

773 
	`p˛o£
 (
FILE
 *
__°ªam
);

777 #ifdef 
__USE_POSIX


779 *
	$˘îmid
 (*
__s
Ë
__THROW
;

783 #ifde‡
__USE_XOPEN


785 *
	`cu£rid
 (*
__s
);

789 #ifdef 
__USE_GNU


790 
ob°ack
;

793 
	$ob°ack_¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

794 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
, ...)

795 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 3)));

796 
	$ob°ack_v¥ötf
 (
ob°ack
 *
__ª°ri˘
 
__ob°ack
,

797 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

798 
_G_va_li°
 
__¨gs
)

799 
__THROW
 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__¥ötf__
, 2, 0)));

803 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


807 
	$Êockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

811 
	$·rylockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

814 
	$fu∆ockfûe
 (
FILE
 *
__°ªam
Ë
__THROW
;

817 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
 && !deföed 
__USE_GNU


821 
	#__√ed_gë›t


	)

822 
	~<gë›t.h
>

827 #ifde‡
__USE_EXTERN_INLINES


828 
	~<bôs/°dio.h
>

831 
__END_DECLS


	@/usr/include/stdlib.h

23 #i‚def 
_STDLIB_H


25 
	~<„©uªs.h
>

28 
	#__√ed_size_t


	)

29 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


30 
	#__√ed_wch¨_t


	)

31 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

35 
	g__BEGIN_DECLS


37 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


38 
	#_STDLIB_H
 1

	)

40 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
_SYS_WAIT_H


42 
	~<bôs/waôÊags.h
>

43 
	~<bôs/waô°©us.h
>

45 #ifde‡
__USE_BSD


50 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


51 
	#__WAIT_INT
(
°©us
) \

52 (
	`__exãnsi⁄__
 ({ uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; } 
__u
; \

53 
__u
.
__ö
 = (
°©us
); __u.
__i
; }))

	)

55 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

63 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


64 
	#__WAIT_STATUS
 *

	)

65 
	#__WAIT_STATUS_DEFN
 *

	)

70 
waô
 *
	m__u±r
;

71 *
	m__ùå
;

72 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

73 
	#__WAIT_STATUS_DEFN
 *

	)

78 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

79 
	#__WAIT_STATUS
 *

	)

80 
	#__WAIT_STATUS_DEFN
 *

	)

85 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
(
	`__WAIT_INT
(°©us))

	)

86 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
(
	`__WAIT_INT
(°©us))

	)

87 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
(
	`__WAIT_INT
(°©us))

	)

88 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
(
	`__WAIT_INT
(°©us))

	)

89 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
(
	`__WAIT_INT
(°©us))

	)

90 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
(
	`__WAIT_INT
(°©us))

	)

93 
__BEGIN_NAMESPACE_STD


97 
	mquŸ
;

98 
	mªm
;

99 } 
	tdiv_t
;

102 #i‚de‡
__ldiv_t_deföed


105 
	mquŸ
;

106 
	mªm
;

107 } 
	tldiv_t
;

108 
	#__ldiv_t_deföed
 1

	)

110 
	g__END_NAMESPACE_STD


112 #i‡
deföed
 
__USE_ISOC99
 && !deföed 
__Œdiv_t_deföed


113 
__BEGIN_NAMESPACE_C99


115 
__exãnsi⁄__
 struct

117 
	mquŸ
;

118 
	mªm
;

119 } 
	tŒdiv_t
;

120 
	#__Œdiv_t_deföed
 1

	)

121 
	g__END_NAMESPACE_C99


126 
	#RAND_MAX
 2147483647

	)

131 
	#EXIT_FAILURE
 1

	)

132 
	#EXIT_SUCCESS
 0

	)

136 
	#MB_CUR_MAX
 (
	`__˘y≥_gë_mb_cur_max
 ())

	)

137 
size_t
 
	$__˘y≥_gë_mb_cur_max
 (Ë
__THROW
;

140 
__BEGIN_NAMESPACE_STD


142 
	$©of
 (
__c⁄°
 *
__≈å
Ë
__THROW
 
__©åibuã_puª__
;

144 
	$©oi
 (
__c⁄°
 *
__≈å
Ë
__THROW
 
__©åibuã_puª__
;

146 
	$©ﬁ
 (
__c⁄°
 *
__≈å
Ë
__THROW
 
__©åibuã_puª__
;

147 
__END_NAMESPACE_STD


149 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

150 
__BEGIN_NAMESPACE_C99


152 
__exãnsi⁄__
 
	$©ﬁl
 (
__c⁄°
 *
__≈å
)

153 
__THROW
 
__©åibuã_puª__
;

154 
__END_NAMESPACE_C99


157 
__BEGIN_NAMESPACE_STD


159 
	$°πod
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

160 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

161 
__END_NAMESPACE_STD


163 #ifdef 
__USE_ISOC99


164 
__BEGIN_NAMESPACE_C99


166 
	$°πof
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

167 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

169 
	$°πﬁd
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

170 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

171 
__END_NAMESPACE_C99


174 
__BEGIN_NAMESPACE_STD


176 
	$°πﬁ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

177 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

179 
	$°πoul
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

180 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

181 
__THROW
;

182 
__END_NAMESPACE_C99


184 #i‡
deföed
 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_BSD


186 
__exãnsi⁄__


187 
	$°πoq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

188 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

190 
__exãnsi⁄__


191 
	$°πouq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

192 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

193 
__THROW
;

196 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GLIBC_HAVE_LONG_LONG
 && deföed 
__USE_MISC
)

197 
__BEGIN_NAMESPACE_C99


199 
__exãnsi⁄__


200 
	$°πﬁl
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

201 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

203 
__exãnsi⁄__


204 
	$°πouŒ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

205 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

206 
__THROW
;

207 
__END_NAMESPACE_C99


211 #ifde‡
__USE_GNU


225 
	~<xloˇÀ.h
>

229 
	$°πﬁ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

230 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

231 
__loˇÀ_t
 
__loc
Ë
__THROW
;

233 
	$°πoul_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

234 **
__ª°ri˘
 
__íd±r
,

235 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

237 
__exãnsi⁄__


238 
	$°πﬁl_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

239 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

240 
__loˇÀ_t
 
__loc
Ë
__THROW
;

242 
__exãnsi⁄__


243 
	$°πouŒ_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

244 **
__ª°ri˘
 
__íd±r
,

245 
__ba£
, 
__loˇÀ_t
 
__loc
)

246 
__THROW
;

248 
	$°πod_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

249 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

250 
__THROW
;

252 
	$°πof_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

253 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

255 
	$°πﬁd_l
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

256 **
__ª°ri˘
 
__íd±r
,

257 
__loˇÀ_t
 
__loc
Ë
__THROW
;

264 
	$__°πod_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

265 **
__ª°ri˘
 
__íd±r
, 
__group
)

266 
__THROW
;

267 
	$__°πof_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

268 **
__ª°ri˘
 
__íd±r
, 
__group
)

269 
__THROW
;

270 
	$__°πﬁd_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

271 **
__ª°ri˘
 
__íd±r
,

272 
__group
Ë
__THROW
;

273 #i‚de‡
__°πﬁ_öã∫Æ_deföed


274 
	$__°πﬁ_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

275 **
__ª°ri˘
 
__íd±r
,

276 
__ba£
, 
__group
Ë
__THROW
;

277 
	#__°πﬁ_öã∫Æ_deföed
 1

	)

279 #i‚de‡
__°πoul_öã∫Æ_deföed


280 
	$__°πoul_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

281 **
__ª°ri˘
 
__íd±r
,

282 
__ba£
, 
__group
Ë
__THROW
;

283 
	#__°πoul_öã∫Æ_deföed
 1

	)

285 #i‡
deföed
 
__GNUC__
 || deföed 
__USE_ISOC99


286 #i‚de‡
__°πﬁl_öã∫Æ_deföed


287 
__exãnsi⁄__


288 
	$__°πﬁl_öã∫Æ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
,

289 **
__ª°ri˘
 
__íd±r
,

290 
__ba£
, 
__group
Ë
__THROW
;

291 
	#__°πﬁl_öã∫Æ_deföed
 1

	)

293 #i‚de‡
__°πouŒ_öã∫Æ_deföed


294 
__exãnsi⁄__


295 
	$__°πouŒ_öã∫Æ
 (
__c⁄°
 *

296 
__ª°ri˘
 
__≈å
,

297 **
__ª°ri˘
 
__íd±r
,

298 
__ba£
, 
__group
)

299 
__THROW
;

300 
	#__°πouŒ_öã∫Æ_deföed
 1

	)

304 #ifde‡
__USE_EXTERN_INLINES


307 
__BEGIN_NAMESPACE_STD


308 
__ölöe
 

309 
	$°πod
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
Ë
__THROW


311  
	`__°πod_öã∫Æ
 (
__≈å
, 
__íd±r
, 0);

312 
	}
}

313 
__ölöe
 

314 
	$°πﬁ
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

315 
__ba£
Ë
__THROW


317  
	`__°πﬁ_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

318 
	}
}

319 
__ölöe
 

320 
	$°πoul
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

321 
__ba£
Ë
__THROW


323  
	`__°πoul_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

324 
	}
}

325 
__END_NAMESPACE_STD


327 #ifde‡
__USE_ISOC99


328 
__BEGIN_NAMESPACE_C99


329 
__ölöe
 

330 
	$°πof
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
Ë
__THROW


332  
	`__°πof_öã∫Æ
 (
__≈å
, 
__íd±r
, 0);

333 
	}
}

334 
__ölöe
 

335 
	$°πﬁd
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
Ë
__THROW


337  
	`__°πﬁd_öã∫Æ
 (
__≈å
, 
__íd±r
, 0);

338 
	}
}

339 
__END_NAMESPACE_C99


342 #ifde‡
__USE_BSD


343 
__exãnsi⁄__
 
__ölöe
 

344 
	$°πoq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

345 
__ba£
Ë
__THROW


347  
	`__°πﬁl_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

348 
	}
}

349 
__exãnsi⁄__
 
__ölöe
 

350 
	$°πouq
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

351 
__ba£
Ë
__THROW


353  
	`__°πouŒ_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

354 
	}
}

357 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


358 
__BEGIN_NAMESPACE_C99


359 
__exãnsi⁄__
 
__ölöe
 

360 
	$°πﬁl
 (
__c⁄°
 *
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

361 
__ba£
Ë
__THROW


363  
	`__°πﬁl_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

364 
	}
}

365 
__exãnsi⁄__
 
__ölöe
 

366 
	$°πouŒ
 (
__c⁄°
 * 
__ª°ri˘
 
__≈å
, **__ª°ri˘ 
__íd±r
,

367 
__ba£
Ë
__THROW


369  
	`__°πouŒ_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0);

370 
	}
}

371 
__END_NAMESPACE_C99


374 
__BEGIN_NAMESPACE_STD


375 
__ölöe
 

376 
	$©of
 (
__c⁄°
 *
__≈å
Ë
__THROW


378  
	`°πod
 (
__≈å
, (**Ë
NULL
);

379 
	}
}

380 
__ölöe
 

381 
	$©oi
 (
__c⁄°
 *
__≈å
Ë
__THROW


383  (Ë
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

384 
	}
}

385 
__ölöe
 

386 
	$©ﬁ
 (
__c⁄°
 *
__≈å
Ë
__THROW


388  
	`°πﬁ
 (
__≈å
, (**Ë
NULL
, 10);

389 
	}
}

390 
__END_NAMESPACE_STD


392 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


393 
__BEGIN_NAMESPACE_C99


394 
__exãnsi⁄__
 
__ölöe
 

395 
	$©ﬁl
 (
__c⁄°
 *
__≈å
Ë
__THROW


397  
	`°πﬁl
 (
__≈å
, (**Ë
NULL
, 10);

398 
	}
}

399 
__END_NAMESPACE_C99


404 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


408 *
	$l64a
 (
__n
Ë
__THROW
;

411 
	$a64l
 (
__c⁄°
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

415 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_BSD


416 
	~<sys/ty≥s.h
>

423 
	$øndom
 (Ë
__THROW
;

426 
	$§™dom
 (
__£ed
Ë
__THROW
;

432 *
	$öô°©e
 (
__£ed
, *
__°©ebuf
,

433 
size_t
 
__°©ñí
Ë
__THROW
;

437 *
	$£t°©e
 (*
__°©ebuf
Ë
__THROW
;

440 #ifde‡
__USE_MISC


445 
	søndom_d©a


447 
öt32_t
 *
Âå
;

448 
öt32_t
 *
Ωå
;

449 
öt32_t
 *
°©e
;

450 
ønd_ty≥
;

451 
ønd_deg
;

452 
ønd_£p
;

453 
öt32_t
 *
íd_±r
;

456 
	$øndom_r
 (
øndom_d©a
 *
__ª°ri˘
 
__buf
,

457 
öt32_t
 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

459 
	$§™dom_r
 (
__£ed
, 
øndom_d©a
 *
__buf
Ë
__THROW
;

461 
	$öô°©e_r
 (
__£ed
, *
__ª°ri˘
 
__°©ebuf
,

462 
size_t
 
__°©ñí
,

463 
øndom_d©a
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

465 
	$£t°©e_r
 (*
__ª°ri˘
 
__°©ebuf
,

466 
øndom_d©a
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

471 
__BEGIN_NAMESPACE_STD


473 
	$ønd
 (Ë
__THROW
;

475 
	$§™d
 (
__£ed
Ë
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifde‡
__USE_POSIX


480 
	$ønd_r
 (*
__£ed
Ë
__THROW
;

484 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


488 
	$dønd48
 (Ë
__THROW
;

489 
	`î™d48
 (
__xsubi
[3]Ë
__THROW
;

492 
	$Ã™d48
 (Ë
__THROW
;

493 
	`ƒ™d48
 (
__xsubi
[3]Ë
__THROW
;

496 
	$mønd48
 (Ë
__THROW
;

497 
	`jønd48
 (
__xsubi
[3]Ë
__THROW
;

500 
	$§™d48
 (
__£edvÆ
Ë
__THROW
;

501 *
	`£ed48
 (
__£ed16v
[3]Ë
__THROW
;

502 
	`lc⁄g48
 (
__∑øm
[7]Ë
__THROW
;

504 #ifde‡
__USE_MISC


508 
	sdønd48_d©a


510 
__x
[3];

511 
__ﬁd_x
[3];

512 
__c
;

513 
__öô
;

514 
__a
;

518 
	$dønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

519 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

520 
	`î™d48_r
 (
__xsubi
[3],

521 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

522 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

525 
	$Ã™d48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

526 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

527 
	`ƒ™d48_r
 (
__xsubi
[3],

528 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

529 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

532 
	$mønd48_r
 (
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

533 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

534 
	`jønd48_r
 (
__xsubi
[3],

535 
dønd48_d©a
 *
__ª°ri˘
 
__buf„r
,

536 *
__ª°ri˘
 
__ªsu…
Ë
__THROW
;

539 
	$§™d48_r
 (
__£edvÆ
, 
dønd48_d©a
 *
__buf„r
)

540 
__THROW
;

542 
	`£ed48_r
 (
__£ed16v
[3],

543 
dønd48_d©a
 *
__buf„r
Ë
__THROW
;

545 
	`lc⁄g48_r
 (
__∑øm
[7],

546 
dønd48_d©a
 *
__buf„r
Ë
__THROW
;

552 #i‚de‡
__mÆloc_™d_ˇŒoc_deföed


553 
	#__mÆloc_™d_ˇŒoc_deföed


	)

554 
__BEGIN_NAMESPACE_STD


556 *
	$mÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
;

558 *
	$ˇŒoc
 (
size_t
 
__nmemb
, size_à
__size
)

559 
__THROW
 
__©åibuã_mÆloc__
;

560 
__END_NAMESPACE_STD


563 #i‚de‡
__√ed_mÆloc_™d_ˇŒoc


564 
__BEGIN_NAMESPACE_STD


567 *
	$ªÆloc
 (*
__±r
, 
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
;

569 
	$‰ì
 (*
__±r
Ë
__THROW
;

570 
__END_NAMESPACE_STD


572 #ifdef 
__USE_MISC


574 
	$c‰ì
 (*
__±r
Ë
__THROW
;

577 #i‡
deföed
 
__USE_GNU
 || deföed 
__USE_BSD
 || deföed 
__USE_MISC


578 
	~<Æloˇ.h
>

581 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


583 *
	$vÆloc
 (
size_t
 
__size
Ë
__THROW
 
__©åibuã_mÆloc__
;

586 #ifde‡
__USE_XOPEN2K


588 
	$posix_memÆign
 (**
__mem±r
, 
size_t
 
__Æignmít
, size_à
__size
)

589 
__THROW
 
__©åibuã_mÆloc__
;

592 
__BEGIN_NAMESPACE_STD


594 
	$ab‹t
 (Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

598 
	`©exô
 ((*
__func
Ë()Ë
__THROW
;

599 
__END_NAMESPACE_STD


601 #ifdef 
__USE_MISC


604 
	`⁄_exô
 ((*
__func
Ë(
__°©us
, *
__¨g
), *__arg)

605 
__THROW
;

608 
__BEGIN_NAMESPACE_STD


612 
	$exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

613 
__END_NAMESPACE_STD


615 #ifde‡
__USE_ISOC99


616 
__BEGIN_NAMESPACE_C99


619 
	$_Exô
 (
__°©us
Ë
__THROW
 
	`__©åibuã__
 ((
__n‹ëu∫__
));

620 
__END_NAMESPACE_C99


624 
__BEGIN_NAMESPACE_STD


626 *
	$gëív
 (
__c⁄°
 *
__«me
Ë
__THROW
;

627 
__END_NAMESPACE_STD


631 *
	$__£cuª_gëív
 (
__c⁄°
 *
__«me
Ë
__THROW
;

633 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


637 
	$puãnv
 (*
__°rög
Ë
__THROW
;

640 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


643 
	$£ãnv
 (
__c⁄°
 *
__«me
, __c⁄° *
__vÆue
, 
__ª∂a˚
)

644 
__THROW
;

647 
	$un£ãnv
 (
__c⁄°
 *
__«me
Ë
__THROW
;

650 #ifdef 
__USE_MISC


654 
	$˛óªnv
 (Ë
__THROW
;

658 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


663 *
	$mkãmp
 (*
__ãm∂©e
Ë
__THROW
;

673 #i‚de‡
__USE_FILE_OFFSET64


674 
	`mk°emp
 (*
__ãm∂©e
);

676 #ifde‡
__REDIRECT


677 
	`__REDIRECT
 (
mk°emp
, (*
__ãm∂©e
), 
mk°emp64
);

679 
	#mk°emp
 
mk°emp64


	)

682 #ifde‡
__USE_LARGEFILE64


683 
	`mk°emp64
 (*
__ãm∂©e
);

687 #ifde‡
__USE_BSD


693 *
	$mkdãmp
 (*
__ãm∂©e
Ë
__THROW
;

697 
__BEGIN_NAMESPACE_STD


702 
	`sy°em
 (
__c⁄°
 *
__comm™d
);

703 
__END_NAMESPACE_STD


706 #ifdef 
__USE_GNU


710 *
	$ˇn⁄iˇlize_fûe_«me
 (
__c⁄°
 *
__«me
Ë
__THROW
;

713 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


720 *
	$ªÆ∑th
 (
__c⁄°
 *
__ª°ri˘
 
__«me
,

721 *
__ª°ri˘
 
__ªsﬁved
Ë
__THROW
;

726 #i‚de‡
__COMPAR_FN_T


727 
	#__COMPAR_FN_T


	)

728 (*
	t__com∑r_‚_t
Ë(
	t__c⁄°
 *, __const *);

730 #ifdef 
__USE_GNU


731 
__com∑r_‚_t
 
	tcom∑ris⁄_‚_t
;

735 
__BEGIN_NAMESPACE_STD


738 *
	`b£¨ch
 (
__c⁄°
 *
__key
, __c⁄° *
__ba£
,

739 
size_t
 
__nmemb
, size_à
__size
, 
__com∑r_‚_t
 
__com∑r
);

743 
	`qs‹t
 (*
__ba£
, 
size_t
 
__nmemb
, size_à
__size
,

744 
__com∑r_‚_t
 
__com∑r
);

748 
	$abs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

749 
	$œbs
 (
__x
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

750 
__END_NAMESPACE_STD


752 #ifde‡
__USE_ISOC99


753 
__exãnsi⁄__
 
	$Œabs
 (
__x
)

754 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

758 
__BEGIN_NAMESPACE_STD


762 
div_t
 
	$div
 (
__numî
, 
__díom
)

763 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

764 
ldiv_t
 
	$ldiv
 (
__numî
, 
__díom
)

765 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

766 
__END_NAMESPACE_STD


768 #ifde‡
__USE_ISOC99


769 
__BEGIN_NAMESPACE_C99


770 
__exãnsi⁄__
 
Œdiv_t
 
	$Œdiv
 (
__numî
,

771 
__díom
)

772 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

773 
__END_NAMESPACE_C99


777 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN_EXTENDED


784 *
	$ecvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

785 *
__ª°ri˘
 
__sign
Ë
__THROW
;

790 *
	$fcvt
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

791 *
__ª°ri˘
 
__sign
Ë
__THROW
;

796 *
	$gcvt
 (
__vÆue
, 
__ndigô
, *
__buf
Ë
__THROW
;

799 #ifde‡
__USE_MISC


801 *
	$qecvt
 (
__vÆue
, 
__ndigô
,

802 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
Ë
__THROW
;

803 *
	$qfcvt
 (
__vÆue
, 
__ndigô
,

804 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
Ë
__THROW
;

805 *
	$qgcvt
 (
__vÆue
, 
__ndigô
, *
__buf
Ë
__THROW
;

810 
	$ecvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

811 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

812 
size_t
 
__Àn
Ë
__THROW
;

813 
	$fcvt_r
 (
__vÆue
, 
__ndigô
, *
__ª°ri˘
 
__de˝t
,

814 *
__ª°ri˘
 
__sign
, *__ª°ri˘ 
__buf
,

815 
size_t
 
__Àn
Ë
__THROW
;

817 
	$qecvt_r
 (
__vÆue
, 
__ndigô
,

818 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

819 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

820 
	$qfcvt_r
 (
__vÆue
, 
__ndigô
,

821 *
__ª°ri˘
 
__de˝t
, *__ª°ri˘ 
__sign
,

822 *
__ª°ri˘
 
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

827 
__BEGIN_NAMESPACE_STD


830 
	$mbÀn
 (
__c⁄°
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

833 
	$mbtowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

834 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

837 
	$w˘omb
 (*
__s
, 
wch¨_t
 
__wch¨
Ë
__THROW
;

841 
size_t
 
	$mb°owcs
 (
wch¨_t
 *
__ª°ri˘
 
__pwcs
,

842 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
Ë
__THROW
;

844 
size_t
 
	$wc°ombs
 (*
__ª°ri˘
 
__s
,

845 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__pwcs
, 
size_t
 
__n
)

846 
__THROW
;

847 
__END_NAMESPACE_STD


850 #ifde‡
__USE_SVID


855 
	$Ωm©ch
 (
__c⁄°
 *
__ª•⁄£
Ë
__THROW
;

859 #ifde‡
__USE_XOPEN_EXTENDED


866 
	$gësub›t
 (**
__ª°ri˘
 
__›ti⁄p
,

867 *
__c⁄°
 *
__ª°ri˘
 
__tokís
,

868 **
__ª°ri˘
 
__vÆuï
Ë
__THROW
;

872 #ifde‡
__USE_XOPEN


874 
	$£tkey
 (
__c⁄°
 *
__key
Ë
__THROW
;

880 #ifde‡
__USE_XOPEN2K


882 
	`posix_›í±
 (
__oÊag
);

885 #ifde‡
__USE_XOPEN


890 
	$gø¡±
 (
__fd
Ë
__THROW
;

894 
	$u∆ock±
 (
__fd
Ë
__THROW
;

899 *
	$±¢ame
 (
__fd
Ë
__THROW
;

902 #ifde‡
__USE_GNU


906 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
Ë
__THROW
;

909 
	`gë±
 ();

912 #ifde‡
__USE_BSD


916 
	$gëlﬂdavg
 (
__lﬂdavg
[], 
__√Àm
Ë
__THROW
;

920 #unde‡
__√ed_mÆloc_™d_ˇŒoc


922 
__END_DECLS


	@/usr/include/string.h

23 #i‚def 
_STRING_H


24 
	#_STRING_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


31 
	#__√ed_size_t


	)

32 
	#__√ed_NULL


	)

33 
	~<°ddef.h
>

36 
__BEGIN_NAMESPACE_STD


38 *
	$mem˝y
 (*
__ª°ri˘
 
__de°
,

39 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

42 *
	$memmove
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

43 
__THROW
;

44 
__END_NAMESPACE_STD


49 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN


50 *
	$memc˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

51 
__c
, 
size_t
 
__n
)

52 
__THROW
;

56 
__BEGIN_NAMESPACE_STD


58 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
Ë
__THROW
;

61 
	$memcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

62 
__THROW
 
__©åibuã_puª__
;

65 *
	$memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

66 
__THROW
 
__©åibuã_puª__
;

67 
__END_NAMESPACE_STD


69 #ifde‡
__USE_GNU


72 *
	$øwmemchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

75 *
	$memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

76 
__THROW
 
__©åibuã_puª__
;

80 
__BEGIN_NAMESPACE_STD


82 *
	$°r˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

83 
__THROW
;

85 *
	$°∫˝y
 (*
__ª°ri˘
 
__de°
,

86 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

89 *
	$°rˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

90 
__THROW
;

92 *
	$°∫ˇt
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
,

93 
size_t
 
__n
Ë
__THROW
;

96 
	$°rcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

97 
__THROW
 
__©åibuã_puª__
;

99 
	$°∫cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

100 
__THROW
 
__©åibuã_puª__
;

103 
	$°rcﬁl
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

104 
__THROW
 
__©åibuã_puª__
;

106 
size_t
 
	$°rx‰m
 (*
__ª°ri˘
 
__de°
,

107 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

108 
__END_NAMESPACE_STD


110 #ifde‡
__USE_GNU


114 
	~<xloˇÀ.h
>

117 
	$°rcﬁl_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
__loˇÀ_t
 
__l
)

118 
__THROW
 
__©åibuã_puª__
;

120 
size_t
 
	$°rx‰m_l
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
,

121 
__loˇÀ_t
 
__l
Ë
__THROW
;

124 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


126 *
	$°rdup
 (
__c⁄°
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

132 #i‡
deföed
 
__USE_GNU


133 *
	$°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

134 
__THROW
 
__©åibuã_mÆloc__
;

137 #i‡
deföed
 
__USE_GNU
 && deföed 
__GNUC__


139 
	#°rdu∑
(
s
) \

140 (
__exãnsi⁄__
 \

142 
__c⁄°
 *
__ﬁd
 = (
s
); \

143 
size_t
 
__Àn
 = 
	`°æí
 (
__ﬁd
) + 1; \

144 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
); \

145 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

146 
	}
}))

	)

149 
	#°∫du∑
(
s
, 
n
) \

150 (
__exãnsi⁄__
 \

152 
__c⁄°
 *
__ﬁd
 = (
s
); \

153 
size_t
 
__Àn
 = 
	`°∫Àn
 (
__ﬁd
, (
n
)); \

154 *
__√w
 = (*Ë
	`__buûtö_Æloˇ
 (
__Àn
 + 1); \

155 
__√w
[
__Àn
] = '\0'; \

156 (*Ë
	`mem˝y
 (
__√w
, 
__ﬁd
, 
__Àn
); \

157 }))

	)

160 
__BEGIN_NAMESPACE_STD


162 *
	$°rchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

164 *
	$°ºchr
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

165 
__END_NAMESPACE_STD


167 #ifde‡
__USE_GNU


170 *
	$°rch∫ul
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

173 
__BEGIN_NAMESPACE_STD


176 
size_t
 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

177 
__THROW
 
__©åibuã_puª__
;

180 
size_t
 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

181 
__THROW
 
__©åibuã_puª__
;

183 *
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

184 
__THROW
 
__©åibuã_puª__
;

186 *
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

187 
__THROW
 
__©åibuã_puª__
;

191 *
	$°πok
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
)

192 
__THROW
;

193 
__END_NAMESPACE_STD


197 *
	$__°πok_r
 (*
__ª°ri˘
 
__s
,

198 
__c⁄°
 *
__ª°ri˘
 
__dñim
,

199 **
__ª°ri˘
 
__ßve_±r
Ë
__THROW
;

200 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


201 *
	$°πok_r
 (*
__ª°ri˘
 
__s
, 
__c⁄°
 *__ª°ri˘ 
__dñim
,

202 **
__ª°ri˘
 
__ßve_±r
Ë
__THROW
;

205 #ifde‡
__USE_GNU


207 *
	$°rˇ£°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

208 
__THROW
 
__©åibuã_puª__
;

211 #ifde‡
__USE_GNU


215 *
	$memmem
 (
__c⁄°
 *
__hay°ack
, 
size_t
 
__hay°ackÀn
,

216 
__c⁄°
 *
__√edÀ
, 
size_t
 
__√edÀÀn
)

217 
__THROW
 
__©åibuã_puª__
;

221 *
	$__memp˝y
 (*
__ª°ri˘
 
__de°
,

222 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

223 *
	$memp˝y
 (*
__ª°ri˘
 
__de°
,

224 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

228 
__BEGIN_NAMESPACE_STD


230 
size_t
 
	$°æí
 (
__c⁄°
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

231 
__END_NAMESPACE_STD


233 #ifdef 
__USE_GNU


236 
size_t
 
	$°∫Àn
 (
__c⁄°
 *
__°rög
, 
size_t
 
__maxÀn
)

237 
__THROW
 
__©åibuã_puª__
;

241 
__BEGIN_NAMESPACE_STD


243 *
	$°ªº‹
 (
__î∫um
Ë
__THROW
;

244 
__END_NAMESPACE_STD


245 #i‡
deföed
 
__USE_XOPEN2K
 || deföed 
__USE_MISC


248 *
	$°ªº‹_r
 (
__î∫um
, *
__buf
, 
size_t
 
__buÊí
Ë
__THROW
;

253 
	$__bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
;

255 #ifde‡
__USE_BSD


257 
	$bc›y
 (
__c⁄°
 *
__§c
, *
__de°
, 
size_t
 
__n
Ë
__THROW
;

260 
	$bzîo
 (*
__s
, 
size_t
 
__n
Ë
__THROW
;

263 
	$bcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

264 
__THROW
 
__©åibuã_puª__
;

267 *
	$ödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

270 *
	$rödex
 (
__c⁄°
 *
__s
, 
__c
Ë
__THROW
 
__©åibuã_puª__
;

274 
	$ffs
 (
__i
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

278 #ifdef 
__USE_GNU


279 
	$ff¶
 (
__l
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

280 #ifde‡
__GNUC__


281 
__exãnsi⁄__
 
	$ff¶l
 (
__Œ
)

282 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

287 
	$°rˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

288 
__THROW
 
__©åibuã_puª__
;

291 
	$°∫ˇ£cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

292 
__THROW
 
__©åibuã_puª__
;

295 #ifdef 
__USE_GNU


298 
	$°rˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

299 
__loˇÀ_t
 
__loc
Ë
__THROW
 
__©åibuã_puª__
;

301 
	$°∫ˇ£cmp_l
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
,

302 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
)

303 
__THROW
 
__©åibuã_puª__
;

306 #ifdef 
__USE_BSD


309 *
	$°r£p
 (**
__ª°ri˘
 
__°rögp
,

310 
__c⁄°
 *
__ª°ri˘
 
__dñim
Ë
__THROW
;

313 #ifdef 
__USE_GNU


315 
	$°rvîscmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

316 
__THROW
 
__©åibuã_puª__
;

319 *
	$°rsig«l
 (
__sig
Ë
__THROW
;

322 *
	$__°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

323 
__THROW
;

324 *
	$°p˝y
 (*
__ª°ri˘
 
__de°
, 
__c⁄°
 *__ª°ri˘ 
__§c
)

325 
__THROW
;

329 *
	$__°≤˝y
 (*
__ª°ri˘
 
__de°
,

330 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

331 *
	$°≤˝y
 (*
__ª°ri˘
 
__de°
,

332 
__c⁄°
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
Ë
__THROW
;

335 *
	$°r‰y
 (*
__°rög
Ë
__THROW
;

338 *
	$mem‰ob
 (*
__s
, 
size_t
 
__n
Ë
__THROW
;

340 #i‚de‡
ba£«me


345 *
	$ba£«me
 (
__c⁄°
 *
__fûíame
Ë
__THROW
;

350 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

351 #i‡
deföed
 
__OPTIMIZE__
 && !deföed 
__OPTIMIZE_SIZE__
 \

352 && !
deföed
 
__NO_INLINE__
 && !deföed 
__˝lu•lus


372 
	~<bôs/°rög.h
>

375 
	~<bôs/°rög2.h
>

379 
__END_DECLS


	@/usr/include/sys/io.h

19 #i‚def 
_SYS_IO_H


20 
	#_SYS_IO_H
 1

	)

22 
	~<„©uªs.h
>

24 
__BEGIN_DECLS


33 
	$i›îm
 (
__‰om
, 
__num
,

34 
__tu∫_⁄
Ë
__THROW
;

39 
	$i›l
 (
__Àvñ
Ë
__THROW
;

41 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

43 
__ölöe
 

44 
	$öb
 (
p‹t
)

46 
_v
;

48 
__asm__
 
	`__vﬁ©ûe__
 ("öb %w1,%0":"˜" (
_v
):"Nd" (
p‹t
));

49  
_v
;

50 
	}
}

52 
__ölöe
 

53 
	$öb_p
 (
p‹t
)

55 
_v
;

57 
__asm__
 
	`__vﬁ©ûe__
 ("öb %w1,%0\noutb %%Æ,$0x80":"˜" (
_v
):"Nd" (
p‹t
));

58  
_v
;

59 
	}
}

61 
__ölöe
 

62 
	$öw
 (
p‹t
)

64 
_v
;

66 
__asm__
 
	`__vﬁ©ûe__
 ("öw %w1,%0":"˜" (
_v
):"Nd" (
p‹t
));

67  
_v
;

68 
	}
}

70 
__ölöe
 

71 
	$öw_p
 (
p‹t
)

73 
_v
;

75 
__asm__
 
	`__vﬁ©ûe__
 ("öw %w1,%0\noutb %%Æ,$0x80":"˜" (
_v
):"Nd" (
p‹t
));

76  
_v
;

77 
	}
}

79 
__ölöe
 

80 
	$öl
 (
p‹t
)

82 
_v
;

84 
__asm__
 
	`__vﬁ©ûe__
 ("ö»%w1,%0":"˜" (
_v
):"Nd" (
p‹t
));

85  
_v
;

86 
	}
}

88 
__ölöe
 

89 
	$öl_p
 (
p‹t
)

91 
_v
;

92 
__asm__
 
	`__vﬁ©ûe__
 ("ö»%w1,%0\noutb %%Æ,$0x80":"˜" (
_v
):"Nd" (
p‹t
));

93  
_v
;

94 
	}
}

96 
__ölöe
 

97 
	$outb
 (
vÆue
, 
p‹t
)

99 
__asm__
 
	`__vﬁ©ûe__
 ("outb %b0,%w1": :"a" (
vÆue
), "Nd" (
p‹t
));

100 
	}
}

102 
__ölöe
 

103 
	$outb_p
 (
vÆue
, 
p‹t
)

105 
__asm__
 
	`__vﬁ©ûe__
 ("outb %b0,%w1\noutb %%Æ,$0x80": :"a" (
vÆue
),

106 "Nd" (
p‹t
));

107 
	}
}

109 
__ölöe
 

110 
	$outw
 (
vÆue
, 
p‹t
)

112 
__asm__
 
	`__vﬁ©ûe__
 ("outw %w0,%w1": :"a" (
vÆue
), "Nd" (
p‹t
));

114 
	}
}

116 
__ölöe
 

117 
	$outw_p
 (
vÆue
, 
p‹t
)

119 
__asm__
 
	`__vﬁ©ûe__
 ("outw %w0,%w1\noutb %%Æ,$0x80": :"a" (
vÆue
),

120 "Nd" (
p‹t
));

121 
	}
}

123 
__ölöe
 

124 
	$oué
 (
vÆue
, 
p‹t
)

126 
__asm__
 
	`__vﬁ©ûe__
 ("oué %0,%w1": :"a" (
vÆue
), "Nd" (
p‹t
));

127 
	}
}

129 
__ölöe
 

130 
	$oué_p
 (
vÆue
, 
p‹t
)

132 
__asm__
 
	`__vﬁ©ûe__
 ("oué %0,%w1\noutb %%Æ,$0x80": :"a" (
vÆue
),

133 "Nd" (
p‹t
));

134 
	}
}

136 
__ölöe
 

137 
	$ösb
 (
p‹t
, *
addr
, 
cou¡
)

139 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; insb":"=D" (
addr
),

140 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

141 
	}
}

143 
__ölöe
 

144 
	$ösw
 (
p‹t
, *
addr
, 
cou¡
)

146 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; insw":"=D" (
addr
),

147 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

148 
	}
}

150 
__ölöe
 

151 
	$ö¶
 (
p‹t
, *
addr
, 
cou¡
)

153 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; in¶":"=D" (
addr
),

154 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

155 
	}
}

157 
__ölöe
 

158 
	$outsb
 (
p‹t
, c⁄° *
addr
, 
cou¡
)

160 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; outsb":"=S" (
addr
),

161 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

162 
	}
}

164 
__ölöe
 

165 
	$outsw
 (
p‹t
, c⁄° *
addr
, 
cou¡
)

167 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; outsw":"=S" (
addr
),

168 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

169 
	}
}

171 
__ölöe
 

172 
	$out¶
 (
p‹t
, c⁄° *
addr
, 
cou¡
)

174 
__asm__
 
	`__vﬁ©ûe__
 ("˛d ;Ñï ; out¶":"=S" (
addr
),

175 "=c" (
cou¡
):"d" (
p‹t
), "0" (
addr
), "1" (count));

176 
	}
}

180 
	g__END_DECLS


	@/usr/include/sys/ioctl.h

19 #i‚def 
_SYS_IOCTL_H


20 
	#_SYS_IOCTL_H
 1

	)

22 
	~<„©uªs.h
>

24 
	g__BEGIN_DECLS


27 
	~<bôs/io˘ls.h
>

30 
	~<bôs/io˘l-ty≥s.h
>

37 
	~<sys/âydeÁu…s.h
>

42 
	$io˘l
 (
__fd
, 
__ªque°
, ...Ë
__THROW
;

44 
__END_DECLS


	@/usr/include/sys/ipc.h

19 #i‚de‡
_SYS_IPC_H


20 
	#_SYS_IPC_H
 1

	)

22 
	~<„©uªs.h
>

24 #i‡!
deföed
 
__USE_SVID
 && !deföed 
__USE_XOPEN
 && 
__GNUC__
 >= 2

29 
	~<bôs/ù˘y≥s.h
>

30 
	~<bôs/ùc.h
>

32 #i‚de‡
__uid_t_deföed


33 
__uid_t
 
	tuid_t
;

34 
	#__uid_t_deföed


	)

37 #i‚de‡
__gid_t_deföed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_deföed


	)

42 #i‚de‡
__mode_t_deföed


43 
__mode_t
 
	tmode_t
;

44 
	#__mode_t_deföed


	)

47 #i‚de‡
__key_t_deföed


48 
__key_t
 
	tkey_t
;

49 
	#__key_t_deföed


	)

52 
__BEGIN_DECLS


55 
key_t
 
	$·ok
 (
__c⁄°
 *
__∑th«me
, 
__¥oj_id
Ë
__THROW
;

57 
__END_DECLS


	@/usr/include/sys/mman.h

20 #i‚def 
_SYS_MMAN_H


21 
	#_SYS_MMAN_H
 1

	)

23 
	~<„©uªs.h
>

24 
	~<bôs/ty≥s.h
>

25 
	#__√ed_size_t


	)

26 
	~<°ddef.h
>

28 #i‚de‡
__off_t_deföed


29 #i‚de‡
__USE_FILE_OFFSET64


30 
__off_t
 
	toff_t
;

32 
__off64_t
 
	toff_t
;

34 
	#__off_t_deföed


	)

37 #i‚de‡
__mode_t_deföed


38 
__mode_t
 
	tmode_t
;

39 
	#__mode_t_deföed


	)

42 
	~<bôs/mm™.h
>

45 
	#MAP_FAILED
 ((*Ë-1)

	)

47 
	g__BEGIN_DECLS


57 #i‚de‡
__USE_FILE_OFFSET64


58 *
	$mm≠
 (*
__addr
, 
size_t
 
__Àn
, 
__¥Ÿ
,

59 
__Êags
, 
__fd
, 
__off_t
 
__off£t
Ë
__THROW
;

61 #ifde‡
__REDIRECT


62 * 
	`__REDIRECT
 (
mm≠
,

63 (*
__addr
, 
size_t
 
__Àn
, 
__¥Ÿ
,

64 
__Êags
, 
__fd
, 
__off64_t
 
__off£t
Ë
__THROW
,

65 
mm≠64
);

67 
	#mm≠
 
mm≠64


	)

70 #ifde‡
__USE_LARGEFILE64


71 *
	$mm≠64
 (*
__addr
, 
size_t
 
__Àn
, 
__¥Ÿ
,

72 
__Êags
, 
__fd
, 
__off64_t
 
__off£t
Ë
__THROW
;

77 
	$munm≠
 (*
__addr
, 
size_t
 
__Àn
Ë
__THROW
;

82 
	$m¥Ÿe˘
 (*
__addr
, 
size_t
 
__Àn
, 
__¥Ÿ
Ë
__THROW
;

90 
	`msync
 (*
__addr
, 
size_t
 
__Àn
, 
__Êags
);

92 #ifde‡
__USE_BSD


95 
	$madvi£
 (*
__addr
, 
size_t
 
__Àn
, 
__advi˚
Ë
__THROW
;

97 #ifde‡
__USE_XOPEN2K


99 
	$posix_madvi£
 (*
__addr
, 
size_t
 
__Àn
, 
__advi˚
Ë
__THROW
;

104 
	$mlock
 (
__c⁄°
 *
__addr
, 
size_t
 
__Àn
Ë
__THROW
;

107 
	$mu∆ock
 (
__c⁄°
 *
__addr
, 
size_t
 
__Àn
Ë
__THROW
;

112 
	$mlockÆl
 (
__Êags
Ë
__THROW
;

116 
	$mu∆ockÆl
 (Ë
__THROW
;

118 #ifde‡
__USE_MISC


122 *
	$mªm≠
 (*
__addr
, 
size_t
 
__ﬁd_Àn
, size_à
__√w_Àn
,

123 
__may_move
Ë
__THROW
;

130 
	$möc‹e
 (*
__°¨t
, 
size_t
 
__Àn
, *
__vec
)

131 
__THROW
;

135 
	$ªm≠_fûe_∑ges
 (*
__°¨t
, 
size_t
 
__size
, 
__¥Ÿ
,

136 
size_t
 
__pgoff
, 
__Êags
Ë
__THROW
;

141 
	`shm_›í
 (
__c⁄°
 *
__«me
, 
__oÊag
, 
mode_t
 
__mode
);

144 
	`shm_u∆ök
 (
__c⁄°
 *
__«me
);

146 
__END_DECLS


	@/usr/include/sys/select.h

22 #i‚de‡
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

31 
	~<bôs/£À˘.h
>

34 
	~<bôs/sig£t.h
>

36 #i‚de‡
__sig£t_t_deföed


37 
	#__sig£t_t_deföed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__√ed_time_t


	)

43 
	#__√ed_time•ec


	)

44 
	~<time.h
>

45 
	#__√ed_timevÆ


	)

46 
	~<bôs/time.h
>

48 #i‚de‡
__su£c⁄ds_t_deföed


49 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

50 
	#__su£c⁄ds_t_deföed


	)

55 
	t__fd_mask
;

58 #unde‡
__NFDBITS


59 #unde‡
__FDELT


60 #unde‡
__FDMASK


62 
	#__NFDBITS
 (8 *  (
__fd_mask
))

	)

63 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
Ë((
__fd_mask
Ë1 << ((dË% 
__NFDBITS
))

	)

71 #ifde‡
__USE_XOPEN


72 
__fd_mask
 
	mfds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
Ë((£t)->
fds_bôs
)

	)

75 
__fd_mask
 
	m__fds_bôs
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
Ë((£t)->
__fds_bôs
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifde‡
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£ç
Ë
	`__FD_SET
 (fd, fd£ç)

	)

94 
	#FD_CLR
(
fd
, 
fd£ç
Ë
	`__FD_CLR
 (fd, fd£ç)

	)

95 
	#FD_ISSET
(
fd
, 
fd£ç
Ë
	`__FD_ISSET
 (fd, fd£ç)

	)

96 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
 (fd£ç)

	)

99 
__BEGIN_DECLS


109 
£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

110 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

111 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

112 
timevÆ
 *
__ª°ri˘
 
__timeout
);

114 #ifde‡
__USE_XOPEN2K


121 
p£À˘
 (
__nfds
, 
fd_£t
 *
__ª°ri˘
 
__ªadfds
,

122 
fd_£t
 *
__ª°ri˘
 
__wrôefds
,

123 
fd_£t
 *
__ª°ri˘
 
__ex˚±fds
,

124 c⁄° 
time•ec
 *
__ª°ri˘
 
__timeout
,

125 c⁄° 
__sig£t_t
 *
__ª°ri˘
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/shm.h

19 #i‚de‡
_SYS_SHM_H


20 
	#_SYS_SHM_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

28 
	~<sys/ùc.h
>

31 
	~<bôs/shm.h
>

34 
	#__√ed_time_t


	)

35 
	~<time.h
>

37 #ifde‡
__USE_XOPEN


38 #i‚de‡
__pid_t_deföed


39 
__pid_t
 
	tpid_t
;

40 
	#__pid_t_deföed


	)

45 
__BEGIN_DECLS


51 
	$shm˘l
 (
__shmid
, 
__cmd
, 
shmid_ds
 *
__buf
Ë
__THROW
;

54 
	$shmgë
 (
key_t
 
__key
, 
size_t
 
__size
, 
__shmÊg
Ë
__THROW
;

57 *
	$shm©
 (
__shmid
, 
__c⁄°
 *
__shmaddr
, 
__shmÊg
)

58 
__THROW
;

61 
	$shmdt
 (
__c⁄°
 *
__shmaddr
Ë
__THROW
;

63 
__END_DECLS


	@/usr/include/sys/socket.h

20 #i‚def 
_SYS_SOCKET_H


21 
	#_SYS_SOCKET_H
 1

	)

23 
	~<„©uªs.h
>

25 
	g__BEGIN_DECLS


27 
	~<sys/uio.h
>

28 
	#__√ed_size_t


	)

29 
	~<°ddef.h
>

35 
	~<bôs/sockë.h
>

37 #ifde‡
__USE_BSD


40 
	sosockaddr


42 
	mß_Ámûy
;

43 
	mß_d©a
[14];

51 
	mSHUT_RD
 = 0,

52 
	#SHUT_RD
 
SHUT_RD


	)

53 
	mSHUT_WR
,

54 
	#SHUT_WR
 
SHUT_WR


	)

55 
	mSHUT_RDWR


56 
	#SHUT_RDWR
 
SHUT_RDWR


	)

65 #i‡
deföed
 
__˝lu•lus
 || !
__GNUC_PREREQ
 (2, 7Ë|| !deföed 
__USE_GNU


66 
	#__SOCKADDR_ARG
 
sockaddr
 *
__ª°ri˘


	)

67 
	#__CONST_SOCKADDR_ARG
 
__c⁄°
 
sockaddr
 *

	)

71 
	#__SOCKADDR_ALLTYPES
 \

72 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

73 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

74 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

75 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

76 
	`__SOCKADDR_ONETYPE
 (
sockaddr_e⁄
) \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö6
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ö¨p
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ùx
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

86 
	#__SOCKADDR_ONETYPE
(
ty≥
Ëty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

87 uni⁄ { 
	m__SOCKADDR_ALLTYPES


88 } 
	t__SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

89 #unde‡
__SOCKADDR_ONETYPE


90 
	#__SOCKADDR_ONETYPE
(
ty≥
Ë
__c⁄°
 ty≥ *
__ª°ri˘
 
__
##ty≥##__;

	)

91 uni⁄ { 
	m__SOCKADDR_ALLTYPES


92 } 
	t__CONST_SOCKADDR_ARG
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

93 #unde‡
__SOCKADDR_ONETYPE


100 
	$sockë
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
Ë
__THROW
;

106 
	`sockë∑ú
 (
__domaö
, 
__ty≥
, 
__¥Ÿocﬁ
,

107 
__fds
[2]Ë
__THROW
;

110 
	$böd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
)

111 
__THROW
;

114 
	$gësock«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

115 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

124 
	`c⁄√˘
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockÀn_t
 
__Àn
);

128 
	$gë≥î«me
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

129 
sockÀn_t
 *
__ª°ri˘
 
__Àn
Ë
__THROW
;

136 
ssize_t
 
	`£nd
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
, 
__Êags
);

143 
ssize_t
 
	`ªcv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__Êags
);

150 
ssize_t
 
	`£ndto
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

151 
__Êags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

152 
sockÀn_t
 
__addr_Àn
);

161 
ssize_t
 
	`ªcv‰om
 (
__fd
, *
__ª°ri˘
 
__buf
, 
size_t
 
__n
,

162 
__Êags
, 
__SOCKADDR_ARG
 
__addr
,

163 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

171 
ssize_t
 
	`£ndmsg
 (
__fd
, 
__c⁄°
 
msghdr
 *
__mesßge
,

172 
__Êags
);

179 
ssize_t
 
	`ªcvmsg
 (
__fd
, 
msghdr
 *
__mesßge
, 
__Êags
);

185 
	$gësock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

186 *
__ª°ri˘
 
__›tvÆ
,

187 
sockÀn_t
 *
__ª°ri˘
 
__›éí
Ë
__THROW
;

192 
	$£tsock›t
 (
__fd
, 
__Àvñ
, 
__›äame
,

193 
__c⁄°
 *
__›tvÆ
, 
sockÀn_t
 
__›éí
Ë
__THROW
;

199 
	$li°í
 (
__fd
, 
__n
Ë
__THROW
;

209 
	`ac˚±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

210 
sockÀn_t
 *
__ª°ri˘
 
__addr_Àn
);

218 
	$shutdown
 (
__fd
, 
__how
Ë
__THROW
;

221 #ifde‡
__USE_XOPEN2K


223 
	$sock©m¨k
 (
__fd
Ë
__THROW
;

227 #ifde‡
__USE_MISC


231 
	$isfdty≥
 (
__fd
, 
__fdty≥
Ë
__THROW
;

234 
__END_DECLS


	@/usr/include/sys/stat.h

23 #i‚def 
_SYS_STAT_H


24 
	#_SYS_STAT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<bôs/ty≥s.h
>

30 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_MISC


31 #ifde‡
__USE_XOPEN


32 
	#__√ed_time_t


	)

34 #ifde‡
__USE_MISC


35 
	#__√ed_time•ec


	)

37 
	~<time.h
>

40 #ifde‡
__USE_XOPEN


43 #i‚de‡
__dev_t_deföed


44 
__dev_t
 
	tdev_t
;

45 
	#__dev_t_deföed


	)

48 #i‚de‡
__gid_t_deföed


49 
__gid_t
 
	tgid_t
;

50 
	#__gid_t_deföed


	)

53 #i‚de‡
__öo_t_deföed


54 #i‚de‡
__USE_FILE_OFFSET64


55 
__öo_t
 
	töo_t
;

57 
__öo64_t
 
	töo_t
;

59 
	#__öo_t_deföed


	)

62 #i‚de‡
__mode_t_deföed


63 
__mode_t
 
	tmode_t
;

64 
	#__mode_t_deföed


	)

67 #i‚de‡
__∆ök_t_deföed


68 
__∆ök_t
 
	t∆ök_t
;

69 
	#__∆ök_t_deföed


	)

72 #i‚de‡
__off_t_deföed


73 #i‚de‡
__USE_FILE_OFFSET64


74 
__off_t
 
	toff_t
;

76 
__off64_t
 
	toff_t
;

78 
	#__off_t_deföed


	)

81 #i‚de‡
__uid_t_deföed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_deföed


	)

87 #ifde‡
__USE_UNIX98


88 #i‚de‡
__blk˙t_t_deföed


89 #i‚de‡
__USE_FILE_OFFSET64


90 
__blk˙t_t
 
	tblk˙t_t
;

92 
__blk˙t64_t
 
	tblk˙t_t
;

94 
	#__blk˙t_t_deföed


	)

97 #i‚de‡
__blksize_t_deföed


98 
__blksize_t
 
	tblksize_t
;

99 
	#__blksize_t_deföed


	)

103 
	g__BEGIN_DECLS


105 
	~<bôs/°©.h
>

107 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


108 
	#S_IFMT
 
__S_IFMT


	)

109 
	#S_IFDIR
 
__S_IFDIR


	)

110 
	#S_IFCHR
 
__S_IFCHR


	)

111 
	#S_IFBLK
 
__S_IFBLK


	)

112 
	#S_IFREG
 
__S_IFREG


	)

113 #ifde‡
__S_IFIFO


114 
	#S_IFIFO
 
__S_IFIFO


	)

116 #ifde‡
__S_IFLNK


117 
	#S_IFLNK
 
__S_IFLNK


	)

119 #i‡(
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN2K
) \

120 && 
deföed
 
	g__S_IFSOCK


121 
	#S_IFSOCK
 
__S_IFSOCK


	)

127 
	#__S_ISTYPE
(
mode
, 
mask
Ë(((modeË& 
__S_IFMT
Ë=(mask))

	)

129 
	#S_ISDIR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFDIR
)

	)

130 
	#S_ISCHR
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFCHR
)

	)

131 
	#S_ISBLK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFBLK
)

	)

132 
	#S_ISREG
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFREG
)

	)

133 #ifde‡
__S_IFIFO


134 
	#S_ISFIFO
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFIFO
)

	)

136 #ifde‡
__S_IFLNK


137 
	#S_ISLNK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFLNK
)

	)

140 #ifdef 
__USE_BSD


141 #i‚de‡
__S_IFLNK


142 
	#S_ISLNK
(
mode
Ë0

	)

144 #ifde‡
__S_IFSOCK


145 
	#S_ISSOCK
(
mode
Ë
	`__S_ISTYPE
((mode), 
__S_IFSOCK
)

	)

153 #ifdef 
__USE_POSIX199309


154 
	#S_TYPEISMQ
(
buf
Ë
	`__S_TYPEISMQ
(buf)

	)

155 
	#S_TYPEISSEM
(
buf
Ë
	`__S_TYPEISSEM
(buf)

	)

156 
	#S_TYPEISSHM
(
buf
Ë
	`__S_TYPEISSHM
(buf)

	)

162 
	#S_ISUID
 
__S_ISUID


	)

163 
	#S_ISGID
 
__S_ISGID


	)

165 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_MISC
 || deföed 
__USE_XOPEN


167 
	#S_ISVTX
 
__S_ISVTX


	)

170 
	#S_IRUSR
 
__S_IREAD


	)

171 
	#S_IWUSR
 
__S_IWRITE


	)

172 
	#S_IXUSR
 
__S_IEXEC


	)

174 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

176 #i‡
deföed
 
__USE_MISC
 && deföed 
__USE_BSD


177 
	#S_IREAD
 
S_IRUSR


	)

178 
	#S_IWRITE
 
S_IWUSR


	)

179 
	#S_IEXEC
 
S_IXUSR


	)

182 
	#S_IRGRP
 (
S_IRUSR
 >> 3Ë

	)

183 
	#S_IWGRP
 (
S_IWUSR
 >> 3Ë

	)

184 
	#S_IXGRP
 (
S_IXUSR
 >> 3Ë

	)

186 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

188 
	#S_IROTH
 (
S_IRGRP
 >> 3Ë

	)

189 
	#S_IWOTH
 (
S_IWGRP
 >> 3Ë

	)

190 
	#S_IXOTH
 (
S_IXGRP
 >> 3Ë

	)

192 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

195 #ifdef 
__USE_BSD


197 
	#ACCESSPERMS
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
Ë

	)

198 
	#ALLPERMS
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

199 
	#DEFFILEMODE
 (
S_IRUSR
|
S_IWUSR
|
S_IRGRP
|
S_IWGRP
|
S_IROTH
|
S_IWOTH
)

	)

201 
	#S_BLKSIZE
 512

	)

205 #i‚de‡
__USE_FILE_OFFSET64


207 
	$°©
 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

208 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

212 
	$f°©
 (
__fd
, 
°©
 *
__buf
Ë
__THROW
;

214 #ifde‡
__REDIRECT


215 
	`__REDIRECT
 (
°©
,

216 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

217 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
,

218 
°©64
);

219 
	`__REDIRECT
 (
f°©
, (
__fd
, 
°©
 *
__buf
Ë
__THROW
, 
f°©64
);

221 
	#°©
 
°©64


	)

222 
	#f°©
 
f°©64


	)

225 #ifde‡
__USE_LARGEFILE64


226 
	$°©64
 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

227 
°©64
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

228 
	$f°©64
 (
__fd
, 
°©64
 *
__buf
Ë
__THROW
;

231 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


232 #i‚de‡
__USE_FILE_OFFSET64


235 
	$l°©
 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

236 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

238 #ifde‡
__REDIRECT


239 
	`__REDIRECT
 (
l°©
,

240 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

241 
°©
 *
__ª°ri˘
 
__buf
Ë
__THROW
,

242 
l°©64
);

244 
	#l°©
 
l°©64


	)

247 #ifde‡
__USE_LARGEFILE64


248 
	$l°©64
 (
__c⁄°
 *
__ª°ri˘
 
__fûe
,

249 
°©64
 *
__ª°ri˘
 
__buf
Ë
__THROW
;

255 
	$chmod
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
Ë
__THROW
;

257 #ifde‡
__USE_BSD


261 
	$lchmod
 (
__c⁄°
 *
__fûe
, 
__mode_t
 
__mode
Ë
__THROW
;

265 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


266 
	$fchmod
 (
__fd
, 
__mode_t
 
__mode
Ë
__THROW
;

272 
__mode_t
 
	$umask
 (
__mode_t
 
__mask
Ë
__THROW
;

274 #ifdef 
__USE_GNU


277 
__mode_t
 
	$gëumask
 (Ë
__THROW
;

281 
	$mkdú
 (
__c⁄°
 *
__∑th
, 
__mode_t
 
__mode
Ë
__THROW
;

286 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


287 
	$mknod
 (
__c⁄°
 *
__∑th
, 
__mode_t
 
__mode
, 
__dev_t
 
__dev
)

288 
__THROW
;

293 
	$mkfifo
 (
__c⁄°
 *
__∑th
, 
__mode_t
 
__mode
Ë
__THROW
;

310 #i‚de‡
_STAT_VER


311 
	#_STAT_VER
 0

	)

313 #i‚de‡
_MKNOD_VER


314 
	#_MKNOD_VER
 0

	)

318 #i‚de‡
__USE_FILE_OFFSET64


319 
	$__fx°©
 (
__vî
, 
__fûdes
, 
°©
 *
__°©_buf
Ë
__THROW
;

320 
	$__x°©
 (
__vî
, 
__c⁄°
 *
__fûíame
,

321 
°©
 *
__°©_buf
Ë
__THROW
;

322 
	$__lx°©
 (
__vî
, 
__c⁄°
 *
__fûíame
,

323 
°©
 *
__°©_buf
Ë
__THROW
;

325 #ifde‡
__REDIRECT


326 
	`__REDIRECT
 (
__fx°©
, (
__vî
, 
__fûdes
,

327 
°©
 *
__°©_buf
Ë
__THROW
,

328 
__fx°©64
);

329 
	`__REDIRECT
 (
__x°©
, (
__vî
, 
__c⁄°
 *
__fûíame
,

330 
°©
 *
__°©_buf
Ë
__THROW
, 
__x°©64
);

331 
	`__REDIRECT
 (
__lx°©
, (
__vî
, 
__c⁄°
 *
__fûíame
,

332 
°©
 *
__°©_buf
Ë
__THROW
,

333 
__lx°©64
);

336 
	#__fx°©
 
__fx°©64


	)

337 
	#__x°©
 
__x°©64


	)

338 
	#__lx°©
 
__lx°©64


	)

342 #ifde‡
__USE_LARGEFILE64


343 
	$__fx°©64
 (
__vî
, 
__fûdes
, 
°©64
 *
__°©_buf
)

344 
__THROW
;

345 
	$__x°©64
 (
__vî
, 
__c⁄°
 *
__fûíame
,

346 
°©64
 *
__°©_buf
Ë
__THROW
;

347 
	$__lx°©64
 (
__vî
, 
__c⁄°
 *
__fûíame
,

348 
°©64
 *
__°©_buf
Ë
__THROW
;

350 
	$__xmknod
 (
__vî
, 
__c⁄°
 *
__∑th
, 
__mode_t
 
__mode
,

351 
__dev_t
 *
__dev
Ë
__THROW
;

353 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

356 
__ölöe__
 
	$°©
 (
__c⁄°
 *
__∑th
,

357 
°©
 *
__°©buf
Ë
__THROW


359  
	`__x°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

360 
	}
}

362 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


363 
__ölöe__
 
	$l°©
 (
__c⁄°
 *
__∑th
,

364 
°©
 *
__°©buf
Ë
__THROW


366  
	`__lx°©
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

367 
	}
}

370 
__ölöe__
 
	$f°©
 (
__fd
, 
°©
 *
__°©buf
Ë
__THROW


372  
	`__fx°©
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

373 
	}
}

375 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_BSD


376 
__ölöe__
 
	$mknod
 (
__c⁄°
 *
__∑th
, 
__mode_t
 
__mode
,

377 
__dev_t
 
__dev
Ë
__THROW


379  
	`__xmknod
 (
_MKNOD_VER
, 
__∑th
, 
__mode
, &
__dev
);

380 
	}
}

383 #i‡
deföed
 
__USE_LARGEFILE64
 \

384 && (! 
deföed
 
__USE_FILE_OFFSET64
 \

385 || (
deföed
 
__REDIRECT
 && deföed 
__OPTIMIZE__
))

386 
__ölöe__
 
	$°©64
 (
__c⁄°
 *
__∑th
,

387 
°©64
 *
__°©buf
Ë
__THROW


389  
	`__x°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

390 
	}
}

392 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


393 
__ölöe__
 
	$l°©64
 (
__c⁄°
 *
__∑th
,

394 
°©64
 *
__°©buf
Ë
__THROW


396  
	`__lx°©64
 (
_STAT_VER
, 
__∑th
, 
__°©buf
);

397 
	}
}

400 
__ölöe__
 
	$f°©64
 (
__fd
, 
°©64
 *
__°©buf
Ë
__THROW


402  
	`__fx°©64
 (
_STAT_VER
, 
__fd
, 
__°©buf
);

403 
	}
}

408 
__END_DECLS


	@/usr/include/sys/termios.h

1 #i‚de‡
_SYS_TERMIOS_H


2 
	#_SYS_TERMIOS_H


	)

3 
	~<ãrmios.h
>

	@/usr/include/sys/time.h

19 #i‚de‡
_SYS_TIME_H


20 
	#_SYS_TIME_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<bôs/ty≥s.h
>

25 
	#__√ed_time_t


	)

26 
	~<time.h
>

27 
	#__√ed_timevÆ


	)

28 
	~<bôs/time.h
>

30 
	~<sys/£À˘.h
>

32 #i‚de‡
__su£c⁄ds_t_deföed


33 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

34 
	#__su£c⁄ds_t_deföed


	)

38 
	g__BEGIN_DECLS


40 #ifde‡
__USE_GNU


42 
	#TIMEVAL_TO_TIMESPEC
(
tv
, 
ts
) { \

43 (
ts
)->
tv_£c
 = (
tv
)->tv_sec; \

44 (
ts
)->
tv_n£c
 = (
tv
)->
tv_u£c
 * 1000; \

45 }

	)

46 
	#TIMESPEC_TO_TIMEVAL
(
tv
, 
ts
) { \

47 (
tv
)->
tv_£c
 = (
ts
)->tv_sec; \

48 (
tv
)->
tv_u£c
 = (
ts
)->
tv_n£c
 / 1000; \

49 }

	)

53 #ifde‡
__USE_BSD


56 
	stimez⁄e


58 
	mtz_möuãswe°
;

59 
	mtz_d°time
;

62 
timez⁄e
 *
	t__ª°ri˘
 
	t__timez⁄e_±r_t
;

64 *
	t__ª°ri˘
 
	t__timez⁄e_±r_t
;

72 
	$gëtimeofday
 (
timevÆ
 *
__ª°ri˘
 
__tv
,

73 
__timez⁄e_±r_t
 
__tz
Ë
__THROW
;

75 #ifde‡
__USE_BSD


78 
	$£âimeofday
 (
__c⁄°
 
timevÆ
 *
__tv
,

79 
__c⁄°
 
timez⁄e
 *
__tz
Ë
__THROW
;

85 
	$adjtime
 (
__c⁄°
 
timevÆ
 *
__dñè
,

86 
timevÆ
 *
__ﬁddñè
Ë
__THROW
;

91 
	e__ôimî_which


94 
ITIMER_REAL
 = 0,

95 
	#ITIMER_REAL
 
ITIMER_REAL


	)

97 
ITIMER_VIRTUAL
 = 1,

98 
	#ITIMER_VIRTUAL
 
ITIMER_VIRTUAL


	)

101 
ITIMER_PROF
 = 2

102 
	#ITIMER_PROF
 
ITIMER_PROF


	)

107 
	sôimîvÆ


110 
timevÆ
 
ô_öãrvÆ
;

112 
timevÆ
 
ô_vÆue
;

115 #i‡
deföed
 
__USE_GNU
 && !deföed 
__˝lu•lus


118 
__ôimî_which
 
	t__ôimî_which_t
;

120 
	t__ôimî_which_t
;

125 
	$gëôimî
 (
__ôimî_which_t
 
__which
,

126 
ôimîvÆ
 *
__vÆue
Ë
__THROW
;

131 
	$£tôimî
 (
__ôimî_which_t
 
__which
,

132 
__c⁄°
 
ôimîvÆ
 *
__ª°ri˘
 
__√w
,

133 
ôimîvÆ
 *
__ª°ri˘
 
__ﬁd
Ë
__THROW
;

138 
	`utimes
 (
__c⁄°
 *
__fûe
, __c⁄° 
timevÆ
 
__tvp
[2])

139 
__THROW
;

141 #ifde‡
__USE_BSD


143 
	`lutimes
 (
__c⁄°
 *
__fûe
, __c⁄° 
timevÆ
 
__tvp
[2])

144 
__THROW
;

147 
	`futimes
 (
__fd
, 
__c⁄°
 
timevÆ
 
__tvp
[2]Ë
__THROW
;

151 #ifde‡
__USE_BSD


154 
	#timîis£t
(
tvp
Ë(—vp)->
tv_£c
 || (tvp)->
tv_u£c
)

	)

155 
	#timî˛ór
(
tvp
Ë(—vp)->
tv_£c
 = (tvp)->
tv_u£c
 = 0)

	)

156 
	#timîcmp
(
a
, 
b
, 
CMP
) \

157 (((
a
)->
tv_£c
 =(
b
)->tv_sec) ? \

158 ((
a
)->
tv_u£c
 
	`CMP
 (
b
)->tv_usec) : \

159 ((
a
)->
tv_£c
 
	`CMP
 (
b
)->tv_£c))

	)

160 
	#timîadd
(
a
, 
b
, 
ªsu…
) \

162 (
ªsu…
)->
tv_£c
 = (
a
)->tv_£¯+ (
b
)->tv_sec; \

163 (
ªsu…
)->
tv_u£c
 = (
a
)->tv_u£¯+ (
b
)->tv_usec; \

164 i‡((
ªsu…
)->
tv_u£c
 >= 1000000) \

166 ++(
ªsu…
)->
tv_£c
; \

167 (
ªsu…
)->
tv_u£c
 -= 1000000; \

169 
	}
} 0)

	)

170 
	#timîsub
(
a
, 
b
, 
ªsu…
) \

172 (
ªsu…
)->
tv_£c
 = (
a
)->tv_£¯- (
b
)->tv_sec; \

173 (
ªsu…
)->
tv_u£c
 = (
a
)->tv_u£¯- (
b
)->tv_usec; \

174 i‡((
ªsu…
)->
tv_u£c
 < 0) { \

175 --(
ªsu…
)->
tv_£c
; \

176 (
ªsu…
)->
tv_u£c
 += 1000000; \

178 } 0)

	)

181 
	g__END_DECLS


	@/usr/include/sys/timeb.h

19 #i‚de‡
_SYS_TIMEB_H


20 
	#_SYS_TIMEB_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_time_t


	)

25 
	~<time.h
>

28 
__BEGIN_DECLS


32 
	stimeb


34 
time_t
 
	mtime
;

35 
	mmûlôm
;

36 
	mtimez⁄e
;

37 
	md°Êag
;

42 
·ime
 (
timeb
 *
__timebuf
);

44 
	g__END_DECLS


	@/usr/include/sys/times.h

23 #i‚def 
_SYS_TIMES_H


24 
	#_SYS_TIMES_H
 1

	)

26 
	~<„©uªs.h
>

28 
	#__√ed_˛ock_t


	)

29 
	~<time.h
>

32 
__BEGIN_DECLS


35 
	stms


37 
˛ock_t
 
	mtms_utime
;

38 
˛ock_t
 
	mtms_°ime
;

40 
˛ock_t
 
	mtms_cutime
;

41 
˛ock_t
 
	mtms_c°ime
;

49 
˛ock_t
 
	$times
 (
tms
 *
__buf„r
Ë
__THROW
;

51 
__END_DECLS


	@/usr/include/sys/types.h

24 #i‚def 
_SYS_TYPES_H


25 
	#_SYS_TYPES_H
 1

	)

27 
	~<„©uªs.h
>

29 
	g__BEGIN_DECLS


31 
	~<bôs/ty≥s.h
>

33 #ifdef 
__USE_BSD


34 #i‚de‡
__u_ch¨_deföed


35 
__u_ch¨
 
	tu_ch¨
;

36 
__u_sh‹t
 
	tu_sh‹t
;

37 
__u_öt
 
	tu_öt
;

38 
__u_l⁄g
 
	tu_l⁄g
;

39 
__quad_t
 
	tquad_t
;

40 
__u_quad_t
 
	tu_quad_t
;

41 
__fsid_t
 
	tfsid_t
;

42 
	#__u_ch¨_deföed


	)

46 
__loff_t
 
	tloff_t
;

48 #i‚de‡
__öo_t_deföed


49 #i‚de‡
__USE_FILE_OFFSET64


50 
__öo_t
 
	töo_t
;

52 
__öo64_t
 
	töo_t
;

54 
	#__öo_t_deföed


	)

56 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__öo64_t_deföed


57 
__öo64_t
 
	töo64_t
;

58 
	#__öo64_t_deföed


	)

61 #i‚de‡
__dev_t_deföed


62 
__dev_t
 
	tdev_t
;

63 
	#__dev_t_deföed


	)

66 #i‚de‡
__gid_t_deföed


67 
__gid_t
 
	tgid_t
;

68 
	#__gid_t_deföed


	)

71 #i‚de‡
__mode_t_deföed


72 
__mode_t
 
	tmode_t
;

73 
	#__mode_t_deföed


	)

76 #i‚de‡
__∆ök_t_deföed


77 
__∆ök_t
 
	t∆ök_t
;

78 
	#__∆ök_t_deföed


	)

81 #i‚de‡
__uid_t_deföed


82 
__uid_t
 
	tuid_t
;

83 
	#__uid_t_deföed


	)

86 #i‚de‡
__off_t_deföed


87 #i‚de‡
__USE_FILE_OFFSET64


88 
__off_t
 
	toff_t
;

90 
__off64_t
 
	toff_t
;

92 
	#__off_t_deföed


	)

94 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


95 
__off64_t
 
	toff64_t
;

96 
	#__off64_t_deföed


	)

99 #i‚de‡
__pid_t_deföed


100 
__pid_t
 
	tpid_t
;

101 
	#__pid_t_deföed


	)

104 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__id_t_deföed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_deföed


	)

109 #i‚de‡
__ssize_t_deföed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_deföed


	)

114 #ifdef 
__USE_BSD


115 #i‚de‡
__daddr_t_deföed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ˇddr_t
 
	tˇddr_t
;

118 
	#__daddr_t_deföed


	)

122 #i‡(
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN
Ë&& !deföed 
__key_t_deföed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_deföed


	)

127 #ifde‡
__USE_XOPEN


128 
	#__√ed_˛ock_t


	)

130 
	#__√ed_time_t


	)

131 
	#__√ed_timî_t


	)

132 
	#__√ed_˛ockid_t


	)

133 
	~<time.h
>

135 #ifde‡
__USE_XOPEN


136 #i‚de‡
__u£c⁄ds_t_deföed


137 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

138 
	#__u£c⁄ds_t_deföed


	)

140 #i‚de‡
__su£c⁄ds_t_deföed


141 
__su£c⁄ds_t
 
	tsu£c⁄ds_t
;

142 
	#__su£c⁄ds_t_deföed


	)

146 
	#__√ed_size_t


	)

147 
	~<°ddef.h
>

149 #ifde‡
__USE_MISC


151 
	tul⁄g
;

152 
	tush‹t
;

153 
	tuöt
;

158 #i‡!
__GNUC_PREREQ
 (2, 7)

161 #i‚de‡
__öt8_t_deföed


162 
	#__öt8_t_deföed


	)

163 
	töt8_t
;

164 
	töt16_t
;

165 
	töt32_t
;

166 #i‡
__GLIBC_HAVE_LONG_LONG


167 
__exãnsi⁄__
 
	töt64_t
;

172 
	tu_öt8_t
;

173 
	tu_öt16_t
;

174 
	tu_öt32_t
;

175 #i‡
__GLIBC_HAVE_LONG_LONG


176 
__exãnsi⁄__
 
	tu_öt64_t
;

179 
	tªgi°î_t
;

184 
	#__ötN_t
(
N
, 
MODE
) \

185 ##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

186 
	t__u_ötN_t
(
	tN
, 
	tMODE
) \

187 
	tu_öt
##
	tN
##
	t_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	tMODE
)))

	)

189 #i‚de‡
	t__öt8_t_deföed


190 
	t__öt8_t_deföed


	)

191 
	t__ötN_t
 (8, 
	t__QI__
);

192 
__ötN_t
 (16, 
__HI__
);

193 
__ötN_t
 (32, 
__SI__
);

194 
__ötN_t
 (64, 
__DI__
);

197 
__u_ötN_t
 (8, 
__QI__
);

198 
__u_ötN_t
 (16, 
__HI__
);

199 
__u_ötN_t
 (32, 
__SI__
);

200 
__u_ötN_t
 (64, 
__DI__
);

202 
	tªgi°î_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__w‹d__
)));

208 
	#__BIT_TYPES_DEFINED__
 1

	)

211 #ifdef 
__USE_BSD


213 
	~<ídün.h
>

216 
	~<sys/£À˘.h
>

219 
	~<sys/sysma¸os.h
>

223 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__blksize_t_deföed


224 
__blksize_t
 
	tblksize_t
;

225 
	#__blksize_t_deföed


	)

229 #i‚de‡
__USE_FILE_OFFSET64


230 #i‚de‡
__blk˙t_t_deföed


231 
__blk˙t_t
 
	tblk˙t_t
;

232 
	#__blk˙t_t_deföed


	)

234 #i‚de‡
__fsblk˙t_t_deföed


235 
__fsblk˙t_t
 
	tfsblk˙t_t
;

236 
	#__fsblk˙t_t_deföed


	)

238 #i‚de‡
__fsfû˙t_t_deföed


239 
__fsfû˙t_t
 
	tfsfû˙t_t
;

240 
	#__fsfû˙t_t_deföed


	)

243 #i‚de‡
__blk˙t_t_deföed


244 
__blk˙t64_t
 
	tblk˙t_t
;

245 
	#__blk˙t_t_deföed


	)

247 #i‚de‡
__fsblk˙t_t_deföed


248 
__fsblk˙t64_t
 
	tfsblk˙t_t
;

249 
	#__fsblk˙t_t_deföed


	)

251 #i‚de‡
__fsfû˙t_t_deföed


252 
__fsfû˙t64_t
 
	tfsfû˙t_t
;

253 
	#__fsfû˙t_t_deföed


	)

257 #ifde‡
__USE_LARGEFILE64


258 
__blk˙t64_t
 
	tblk˙t64_t
;

259 
__fsblk˙t64_t
 
	tfsblk˙t64_t
;

260 
__fsfû˙t64_t
 
	tfsfû˙t64_t
;

265 #i‡
deföed
 
__USE_POSIX199506
 || deföed 
__USE_UNIX98


266 
	~<bôs/±hªadty≥s.h
>

269 
	g__END_DECLS


	@/usr/include/sys/uio.h

19 #i‚de‡
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<sys/ty≥s.h
>

26 
	g__BEGIN_DECLS


29 
	~<bôs/uio.h
>

40 
ssize_t
 
ªadv
 (
__fd
, 
__c⁄°
 
iovec
 *
__ve˘‹
, 
__cou¡
);

50 
ssize_t
 
wrôev
 (
__fd
, 
__c⁄°
 
iovec
 *
__ve˘‹
, 
__cou¡
);

52 
	g__END_DECLS


	@/usr/include/sys/un.h

19 #i‚def 
_SYS_UN_H


20 
	#_SYS_UN_H
 1

	)

22 
	~<sys/cdefs.h
>

25 
	~<bôs/sockaddr.h
>

27 
__BEGIN_DECLS


30 
	ssockaddr_un


32 
__SOCKADDR_COMMON
 (
sun_
);

33 
	msun_∑th
[108];

37 #ifde‡
__USE_MISC


38 
	~<°rög.h
>

41 
	#SUN_LEN
(
±r
Ë((
size_t
Ë(((
sockaddr_un
 *Ë0)->
sun_∑th
) \

42 + 
	`°æí
 ((
±r
)->
sun_∑th
))

	)

45 
	g__END_DECLS


	@/usr/include/sys/utsname.h

23 #i‚def 
_SYS_UTSNAME_H


24 
	#_SYS_UTSNAME_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<bôs/ut¢ame.h
>

32 #i‚de‡
_UTSNAME_SYSNAME_LENGTH


33 
	#_UTSNAME_SYSNAME_LENGTH
 
_UTSNAME_LENGTH


	)

35 #i‚de‡
_UTSNAME_NODENAME_LENGTH


36 
	#_UTSNAME_NODENAME_LENGTH
 
_UTSNAME_LENGTH


	)

38 #i‚de‡
_UTSNAME_RELEASE_LENGTH


39 
	#_UTSNAME_RELEASE_LENGTH
 
_UTSNAME_LENGTH


	)

41 #i‚de‡
_UTSNAME_VERSION_LENGTH


42 
	#_UTSNAME_VERSION_LENGTH
 
_UTSNAME_LENGTH


	)

44 #i‚de‡
_UTSNAME_MACHINE_LENGTH


45 
	#_UTSNAME_MACHINE_LENGTH
 
_UTSNAME_LENGTH


	)

49 
	sut¢ame


52 
	msy¢ame
[
_UTSNAME_SYSNAME_LENGTH
];

55 
	mnodíame
[
_UTSNAME_NODENAME_LENGTH
];

58 
	mªÀa£
[
_UTSNAME_RELEASE_LENGTH
];

60 
	mvîsi⁄
[
_UTSNAME_VERSION_LENGTH
];

63 
	mmachöe
[
_UTSNAME_MACHINE_LENGTH
];

65 #i‡
_UTSNAME_DOMAIN_LENGTH
 - 0

67 #ifde‡
__USE_GNU


68 
	mdomaö«me
[
_UTSNAME_DOMAIN_LENGTH
];

70 
	m__domaö«me
[
_UTSNAME_DOMAIN_LENGTH
];

75 #ifde‡
__USE_SVID


77 
	#SYS_NMLN
 
_UTSNAME_LENGTH


	)

82 
	$u«me
 (
ut¢ame
 *
__«me
Ë
__THROW
;

85 
__END_DECLS


	@/usr/include/sys/wait.h

23 #i‚def 
_SYS_WAIT_H


24 
	#_SYS_WAIT_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


30 
	~<sig«l.h
>

31 
	~<sys/ªsour˚.h
>

34 #i‡!
deföed
 
_STDLIB_H
 || !deföed 
__USE_XOPEN


37 
	~<bôs/waôÊags.h
>

39 #ifdef 
__USE_BSD


44 #i‡
deföed
 
__GNUC__
 && !deföed 
__˝lu•lus


45 
	#__WAIT_INT
(
°©us
) \

46 (
	`__exãnsi⁄__
 ({ uni⁄ { 
	`__ty≥of
(
°©us
Ë
__ö
; 
__i
; } 
__u
; \

47 
__u
.
__ö
 = (
°©us
); __u.
__i
; }))

	)

49 
	#__WAIT_INT
(
°©us
Ë(*(*Ë&(°©us))

	)

57 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2 || deföed 
__˝lu•lus


58 
	#__WAIT_STATUS
 *

	)

59 
	#__WAIT_STATUS_DEFN
 *

	)

64 
waô
 *
	m__u±r
;

65 *
	m__ùå
;

66 } 
	t__WAIT_STATUS
 
	t__©åibuã__
 ((
	t__å™•¨ít_uni⁄__
));

67 
	#__WAIT_STATUS_DEFN
 *

	)

72 
	#__WAIT_INT
(
°©us
Ë(°©us)

	)

73 
	#__WAIT_STATUS
 *

	)

74 
	#__WAIT_STATUS_DEFN
 *

	)

79 
	~<bôs/waô°©us.h
>

81 
	#WEXITSTATUS
(
°©us
Ë
	`__WEXITSTATUS
(
	`__WAIT_INT
(°©us))

	)

82 
	#WTERMSIG
(
°©us
Ë
	`__WTERMSIG
(
	`__WAIT_INT
(°©us))

	)

83 
	#WSTOPSIG
(
°©us
Ë
	`__WSTOPSIG
(
	`__WAIT_INT
(°©us))

	)

84 
	#WIFEXITED
(
°©us
Ë
	`__WIFEXITED
(
	`__WAIT_INT
(°©us))

	)

85 
	#WIFSIGNALED
(
°©us
Ë
	`__WIFSIGNALED
(
	`__WAIT_INT
(°©us))

	)

86 
	#WIFSTOPPED
(
°©us
Ë
	`__WIFSTOPPED
(
	`__WAIT_INT
(°©us))

	)

89 #ifdef 
__USE_BSD


90 
	#WCOREFLAG
 
__WCOREFLAG


	)

91 
	#WCOREDUMP
(
°©us
Ë
	`__WCOREDUMP
(
	`__WAIT_INT
(°©us))

	)

92 
	#W_EXITCODE
(
ªt
, 
sig
Ë
	`__W_EXITCODE
‘ë, sig)

	)

93 
	#W_STOPCODE
(
sig
Ë
	`__W_STOPCODE
(sig)

	)

97 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


100 
	mP_ALL
,

101 
	mP_PID
,

102 
	mP_PGID


103 } 
	tidty≥_t
;

112 
__pid_t
 
waô
 (
__WAIT_STATUS
 
__°©_loc
);

114 #ifdef 
__USE_BSD


116 
	#WAIT_ANY
 (-1Ë

	)

117 
	#WAIT_MYPGRP
 0

	)

135 
__pid_t
 
waôpid
 (__pid_à
__pid
, *
__°©_loc
, 
__›ti⁄s
);

137 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


138 
	#__√ed_sigöfo_t


	)

139 
	~<bôs/sigöfo.h
>

151 
waôid
 (
idty≥_t
 
__idty≥
, 
__id_t
 
__id
, 
sigöfo_t
 *
__öf›
,

152 
__›ti⁄s
);

155 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


158 
	grußge
;

165 
__pid_t
 
	$waô3
 (
__WAIT_STATUS
 
__°©_loc
, 
__›ti⁄s
,

166 
rußge
 * 
__ußge
Ë
__THROW
;

169 #ifde‡
__USE_BSD


172 
rußge
;

175 
__pid_t
 
	$waô4
 (
__pid_t
 
__pid
, 
__WAIT_STATUS
 
__°©_loc
, 
__›ti⁄s
,

176 
rußge
 *
__ußge
Ë
__THROW
;

180 
__END_DECLS


	@/usr/include/termios.h

23 #i‚def 
_TERMIOS_H


24 
	#_TERMIOS_H
 1

	)

26 
	~<„©uªs.h
>

27 #ifde‡
__USE_UNIX98


29 
	~<bôs/ty≥s.h
>

30 #i‚de‡
__pid_t_deföed


31 
__pid_t
 
	tpid_t
;

32 
	#__pid_t_deföed


	)

36 
	g__BEGIN_DECLS


40 
	~<bôs/ãrmios.h
>

42 #ifde‡
__USE_BSD


45 
	#CCEQ
(
vÆ
, 
c
Ë((cË=(vÆË&& (vÆË!
_POSIX_VDISABLE
)

	)

49 
•ìd_t
 
	$cfgëo•ìd
 (
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

52 
•ìd_t
 
	$cfgëi•ìd
 (
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

55 
	$cf£to•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

58 
	$cf£ti•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

60 #ifdef 
__USE_BSD


62 
	$cf£t•ìd
 (
ãrmios
 *
__ãrmios_p
, 
•ìd_t
 
__•ìd
Ë
__THROW
;

67 
	$tcgë©å
 (
__fd
, 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

71 
	$tc£èâr
 (
__fd
, 
__›ti⁄Æ_a˘i⁄s
,

72 
__c⁄°
 
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

75 #ifdef 
__USE_BSD


77 
	$cfmakîaw
 (
ãrmios
 *
__ãrmios_p
Ë
__THROW
;

81 
	$tc£ndbªak
 (
__fd
, 
__duøti⁄
Ë
__THROW
;

87 
	`tcdøö
 (
__fd
);

91 
	$tcÊush
 (
__fd
, 
__queue_£À˘‹
Ë
__THROW
;

95 
	$tcÊow
 (
__fd
, 
__a˘i⁄
Ë
__THROW
;

98 #ifde‡
__USE_UNIX98


100 
__pid_t
 
	$tcgësid
 (
__fd
Ë
__THROW
;

104 #ifde‡
__USE_BSD


105 
	~<sys/âydeÁu…s.h
>

108 
__END_DECLS


	@/usr/include/time.h

23 #i‚def 
_TIME_H


25 #i‡(! 
deföed
 
__√ed_time_t
 && !deföed 
__√ed_˛ock_t
 && \

26 ! 
deföed
 
	g__√ed_time•ec
)

27 
	#_TIME_H
 1

	)

28 
	~<„©uªs.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__√ed_size_t


	)

37 
	#__√ed_NULL


	)

38 
	~<°ddef.h
>

42 
	~<bôs/time.h
>

45 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


46 #i‚de‡
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #i‡!
deföed
 
__˛ock_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_˛ock_t
)

54 
	#__˛ock_t_deföed
 1

	)

56 
	~<bôs/ty≥s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__˛ock_t
 
	t˛ock_t
;

61 
	g__END_NAMESPACE_STD


62 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
˛ock_t
)

67 #unde‡
__√ed_˛ock_t


69 #i‡!
deföed
 
__time_t_deföed
 && (deföed 
_TIME_H
 || deföed 
__√ed_time_t
)

70 
	#__time_t_deföed
 1

	)

72 
	~<bôs/ty≥s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC
 || deföed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #unde‡
__√ed_time_t


85 #i‡!
deföed
 
__˛ockid_t_deföed
 && \

86 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_˛ockid_t
)

87 
	#__˛ockid_t_deföed
 1

	)

89 
	~<bôs/ty≥s.h
>

92 
__˛ockid_t
 
	t˛ockid_t
;

95 #unde‡
__˛ockid_time_t


97 #i‡!
deföed
 
__timî_t_deföed
 && \

98 ((
deföed
 
_TIME_H
 && deföed 
__USE_POSIX199309
Ë|| deföed 
__√ed_timî_t
)

99 
	#__timî_t_deföed
 1

	)

101 
	~<bôs/ty≥s.h
>

104 
__timî_t
 
	ttimî_t
;

107 #unde‡
__√ed_timî_t


110 #i‡!
deföed
 
__time•ec_deföed
 && \

111 ((
deföed
 
_TIME_H
 && \

112 (
deföed
 
__USE_POSIX199309
 || deföed 
__USE_MISC
)) || \

113 
deföed
 
__√ed_time•ec
)

114 
	#__time•ec_deföed
 1

	)

118 
	stime•ec


120 
__time_t
 
tv_£c
;

121 
tv_n£c
;

125 #unde‡
__√ed_time•ec


128 #ifdef 
_TIME_H


129 
__BEGIN_NAMESPACE_STD


131 
	stm


133 
tm_£c
;

134 
tm_mö
;

135 
tm_hour
;

136 
tm_mday
;

137 
tm_m⁄
;

138 
tm_yór
;

139 
tm_wday
;

140 
tm_yday
;

141 
tm_isd°
;

143 #ifdef 
__USE_BSD


144 
tm_gmtoff
;

145 
__c⁄°
 *
tm_z⁄e
;

147 
__tm_gmtoff
;

148 
__c⁄°
 *
__tm_z⁄e
;

151 
__END_NAMESPACE_STD


152 #i‡
deföed
 
__USE_XOPEN
 || deföed 
__USE_POSIX
 || deföed 
__USE_MISC


153 
	$__USING_NAMESPACE_STD
(
tm
)

157 #ifde‡
__USE_POSIX199309


159 
	sôimî•ec


161 
time•ec
 
ô_öãrvÆ
;

162 
time•ec
 
ô_vÆue
;

166 
sigevít
;

170 #ifde‡
__USE_XOPEN2K


171 #i‚de‡
__pid_t_deföed


172 
__pid_t
 
	tpid_t
;

173 
	#__pid_t_deföed


	)

178 
__BEGIN_NAMESPACE_STD


181 
˛ock_t
 
	$˛ock
 (Ë
__THROW
;

184 
time_t
 
	$time
 (
time_t
 *
__timî
Ë
__THROW
;

187 
	$dif·ime
 (
time_t
 
__time1
,Åime_à
__time0
)

188 
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

191 
time_t
 
	$mktime
 (
tm
 *
__ç
Ë
__THROW
;

197 
size_t
 
	$°r·ime
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

198 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

199 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

200 
__END_NAMESPACE_STD


202 #ifde‡
__USE_XOPEN


205 *
	$°Ωtime
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

206 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
)

207 
__THROW
;

210 #ifde‡
__USE_GNU


213 
	~<xloˇÀ.h
>

215 
size_t
 
	$°r·ime_l
 (*
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

216 
__c⁄°
 *
__ª°ri˘
 
__f‹m©
,

217 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

218 
__loˇÀ_t
 
__loc
Ë
__THROW
;

220 *
	$°Ωtime_l
 (
__c⁄°
 *
__ª°ri˘
 
__s
,

221 
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
tm
 *
__ç
,

222 
__loˇÀ_t
 
__loc
Ë
__THROW
;

226 
__BEGIN_NAMESPACE_STD


229 
tm
 *
	$gmtime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

233 
tm
 *
	$loˇ…ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

234 
__END_NAMESPACE_STD


236 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


239 
tm
 *
	$gmtime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

240 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

244 
tm
 *
	$loˇ…ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

245 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

248 
__BEGIN_NAMESPACE_STD


251 *
	$as˘ime
 (
__c⁄°
 
tm
 *
__ç
Ë
__THROW
;

254 *
	$˘ime
 (
__c⁄°
 
time_t
 *
__timî
Ë
__THROW
;

255 
__END_NAMESPACE_STD


257 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


262 *
	$as˘ime_r
 (
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

263 *
__ª°ri˘
 
__buf
Ë
__THROW
;

266 *
	$˘ime_r
 (
__c⁄°
 
time_t
 *
__ª°ri˘
 
__timî
,

267 *
__ª°ri˘
 
__buf
Ë
__THROW
;

272 *
__tz«me
[2];

273 
__daylight
;

274 
__timez⁄e
;

277 #ifdef 
__USE_POSIX


279 *
tz«me
[2];

283 
	$tz£t
 (Ë
__THROW
;

286 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_XOPEN


287 
daylight
;

288 
timez⁄e
;

291 #ifde‡
__USE_SVID


294 
	$°ime
 (
__c⁄°
 
time_t
 *
__whí
Ë
__THROW
;

300 
	#__i¶óp
(
yór
) \

301 ((
yór
Ë% 4 =0 && ((yórË% 100 !0 || (yórË% 400 =0))

	)

304 #ifde‡
__USE_MISC


309 
time_t
 
	$timegm
 (
tm
 *
__ç
Ë
__THROW
;

312 
time_t
 
	$timñoˇl
 (
tm
 *
__ç
Ë
__THROW
;

315 
	$dysize
 (
__yór
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

319 #ifde‡
__USE_POSIX199309


324 
	`«no¶ìp
 (
__c⁄°
 
time•ec
 *
__ªque°ed_time
,

325 
time•ec
 *
__ªmaöög
);

329 
	$˛ock_gëªs
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ªs
Ë
__THROW
;

332 
	$˛ock_gëtime
 (
˛ockid_t
 
__˛ock_id
, 
time•ec
 *
__ç
Ë
__THROW
;

335 
	$˛ock_£âime
 (
˛ockid_t
 
__˛ock_id
, 
__c⁄°
 
time•ec
 *
__ç
)

336 
__THROW
;

338 #ifde‡
__USE_XOPEN2K


343 
	`˛ock_«no¶ìp
 (
˛ockid_t
 
__˛ock_id
, 
__Êags
,

344 
__c⁄°
 
time•ec
 *
__ªq
,

345 
time•ec
 *
__ªm
);

348 
	$˛ock_gë˝u˛ockid
 (
pid_t
 
__pid
, 
˛ockid_t
 *
__˛ock_id
Ë
__THROW
;

353 
	$timî_¸óã
 (
˛ockid_t
 
__˛ock_id
,

354 
sigevít
 *
__ª°ri˘
 
__evp
,

355 
timî_t
 *
__ª°ri˘
 
__timîid
Ë
__THROW
;

358 
	$timî_dñëe
 (
timî_t
 
__timîid
Ë
__THROW
;

361 
	$timî_£âime
 (
timî_t
 
__timîid
, 
__Êags
,

362 
__c⁄°
 
ôimî•ec
 *
__ª°ri˘
 
__vÆue
,

363 
ôimî•ec
 *
__ª°ri˘
 
__ovÆue
Ë
__THROW
;

366 
	$timî_gëtime
 (
timî_t
 
__timîid
, 
ôimî•ec
 *
__vÆue
)

367 
__THROW
;

370 
	$timî_gëovîrun
 (
timî_t
 
__timîid
Ë
__THROW
;

374 #ifde‡
__USE_XOPEN_EXTENDED


386 
gëd©e_îr
;

395 
tm
 *
	`gëd©e
 (
__c⁄°
 *
__°rög
);

398 #ifde‡
__USE_GNU


409 
	`gëd©e_r
 (
__c⁄°
 *
__ª°ri˘
 
__°rög
,

410 
tm
 *
__ª°ri˘
 
__ªsbuÂ
);

413 
__END_DECLS


	@/usr/include/unistd.h

23 #i‚def 
_UNISTD_H


24 
	#_UNISTD_H
 1

	)

26 
	~<„©uªs.h
>

28 
	g__BEGIN_DECLS


34 
	#_POSIX_VERSION
 200112L

	)

40 
	#_POSIX2_VERSION
 200112L

	)

44 
	#_POSIX2_C_BIND
 200112L

	)

48 
	#_POSIX2_C_DEV
 200112L

	)

52 
	#_POSIX2_SW_DEV
 200112L

	)

56 
	#_POSIX2_LOCALEDEF
 200112L

	)

59 #ifde‡
__USE_UNIX98


60 
	#_XOPEN_VERSION
 500

	)

62 
	#_XOPEN_VERSION
 4

	)

66 
	#_XOPEN_XCU_VERSION
 4

	)

69 
	#_XOPEN_XPG2
 1

	)

70 
	#_XOPEN_XPG3
 1

	)

71 
	#_XOPEN_XPG4
 1

	)

74 
	#_XOPEN_UNIX
 1

	)

77 
	#_XOPEN_CRYPT
 1

	)

81 
	#_XOPEN_ENH_I18N
 1

	)

84 
	#_XOPEN_LEGACY
 1

	)

171 
	~<bôs/posix_›t.h
>

174 #ifde‡
__USE_UNIX98


175 
	~<bôs/ívú⁄míts.h
>

179 
	#STDIN_FILENO
 0

	)

180 
	#STDOUT_FILENO
 1

	)

181 
	#STDERR_FILENO
 2

	)

186 
	~<bôs/ty≥s.h
>

188 #i‚def 
__ssize_t_deföed


189 
__ssize_t
 
	tssize_t
;

190 
	#__ssize_t_deföed


	)

193 
	#__√ed_size_t


	)

194 
	#__√ed_NULL


	)

195 
	~<°ddef.h
>

197 #ifde‡
__USE_XOPEN


200 #i‚de‡
__gid_t_deföed


201 
__gid_t
 
	tgid_t
;

202 
	#__gid_t_deföed


	)

205 #i‚de‡
__uid_t_deföed


206 
__uid_t
 
	tuid_t
;

207 
	#__uid_t_deföed


	)

210 #i‚de‡
__off_t_deföed


211 #i‚de‡
__USE_FILE_OFFSET64


212 
__off_t
 
	toff_t
;

214 
__off64_t
 
	toff_t
;

216 
	#__off_t_deföed


	)

218 #i‡
deföed
 
__USE_LARGEFILE64
 && !deföed 
__off64_t_deföed


219 
__off64_t
 
	toff64_t
;

220 
	#__off64_t_deföed


	)

223 #i‚de‡
__u£c⁄ds_t_deföed


224 
__u£c⁄ds_t
 
	tu£c⁄ds_t
;

225 
	#__u£c⁄ds_t_deföed


	)

228 #i‚de‡
__pid_t_deföed


229 
__pid_t
 
	tpid_t
;

230 
	#__pid_t_deföed


	)

234 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


235 #i‚de‡
__öçå_t_deföed


236 
__öçå_t
 
	töçå_t
;

237 
	#__öçå_t_deföed


	)

241 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


242 #i‚de‡
__sockÀn_t_deföed


243 
__sockÀn_t
 
	tsockÀn_t
;

244 
	#__sockÀn_t_deföed


	)

250 
	#R_OK
 4

	)

251 
	#W_OK
 2

	)

252 
	#X_OK
 1

	)

253 
	#F_OK
 0

	)

256 
	$ac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
Ë
__THROW
;

258 #ifde‡
__USE_GNU


261 
	$euidac˚ss
 (
__c⁄°
 *
__«me
, 
__ty≥
Ë
__THROW
;

266 #i‚def 
_STDIO_H


267 
	#SEEK_SET
 0

	)

268 
	#SEEK_CUR
 1

	)

269 
	#SEEK_END
 2

	)

272 #i‡
deföed
 
__USE_BSD
 && !deföed 
L_SET


274 
	#L_SET
 
SEEK_SET


	)

275 
	#L_INCR
 
SEEK_CUR


	)

276 
	#L_XTND
 
SEEK_END


	)

285 #i‚de‡
__USE_FILE_OFFSET64


286 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

288 #ifde‡
__REDIRECT


289 
__off64_t
 
	`__REDIRECT
 (
l£ek
,

290 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
)

291 
__THROW
,

292 
l£ek64
);

294 
	#l£ek
 
l£ek64


	)

297 #ifde‡
__USE_LARGEFILE64


298 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__whí˚
Ë
__THROW
;

305 
	`˛o£
 (
__fd
);

312 
ssize_t
 
	`ªad
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
);

318 
ssize_t
 
	`wrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
);

320 #ifde‡
__USE_UNIX98


321 #i‚de‡
__USE_FILE_OFFSET64


328 
ssize_t
 
	`¥ód
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

329 
__off_t
 
__off£t
);

336 
ssize_t
 
	`pwrôe
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

337 
__off_t
 
__off£t
);

339 #ifde‡
__REDIRECT


340 
ssize_t
 
	`__REDIRECT
 (
¥ód
, (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

341 
__off64_t
 
__off£t
),

342 
¥ód64
);

343 
ssize_t
 
	`__REDIRECT
 (
pwrôe
, (
__fd
, 
__c⁄°
 *
__buf
,

344 
size_t
 
__nbyãs
, 
__off64_t
 
__off£t
),

345 
pwrôe64
);

347 
	#¥ód
 
¥ód64


	)

348 
	#pwrôe
 
pwrôe64


	)

352 #ifde‡
__USE_LARGEFILE64


356 
ssize_t
 
	`¥ód64
 (
__fd
, *
__buf
, 
size_t
 
__nbyãs
,

357 
__off64_t
 
__off£t
);

360 
ssize_t
 
	`pwrôe64
 (
__fd
, 
__c⁄°
 *
__buf
, 
size_t
 
__n
,

361 
__off64_t
 
__off£t
);

369 
	`pùe
 (
__pùedes
[2]Ë
__THROW
;

378 
	$Æ¨m
 (
__£c⁄ds
Ë
__THROW
;

390 
	`¶ìp
 (
__£c⁄ds
);

392 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


397 
__u£c⁄ds_t
 
	$uÆ¨m
 (
__u£c⁄ds_t
 
__vÆue
, __u£c⁄ds_à
__öãrvÆ
)

398 
__THROW
;

405 
	`u¶ìp
 (
__u£c⁄ds_t
 
__u£c⁄ds
);

414 
	`∑u£
 ();

418 
	$chown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

419 
__THROW
;

421 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


423 
	$fchown
 (
__fd
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
Ë
__THROW
;

428 
	$lchown
 (
__c⁄°
 *
__fûe
, 
__uid_t
 
__ow√r
, 
__gid_t
 
__group
)

429 
__THROW
;

434 
	$chdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
;

436 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


438 
	$fchdú
 (
__fd
Ë
__THROW
;

448 *
	$gëcwd
 (*
__buf
, 
size_t
 
__size
Ë
__THROW
;

450 #ifdef 
__USE_GNU


454 *
	$gë_cuºít_dú_«me
 (Ë
__THROW
;

457 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


461 *
	$gëwd
 (*
__buf
Ë
__THROW
;

466 
	$dup
 (
__fd
Ë
__THROW
;

469 
	$dup2
 (
__fd
, 
__fd2
Ë
__THROW
;

472 **
__ívú⁄
;

473 #ifde‡
__USE_GNU


474 **
ívú⁄
;

480 
	$execve
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[],

481 *
__c⁄°
 
__ívp
[]Ë
__THROW
;

483 #ifde‡
__USE_GNU


486 
	$„xecve
 (
__fd
, *
__c⁄°
 
__¨gv
[], *__c⁄° 
__ívp
[])

487 
__THROW
;

492 
	$execv
 (
__c⁄°
 *
__∑th
, *__c⁄° 
__¨gv
[]Ë
__THROW
;

496 
	$exe˛e
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...Ë
__THROW
;

500 
	$exe˛
 (
__c⁄°
 *
__∑th
, __c⁄° *
__¨g
, ...Ë
__THROW
;

504 
	$execvp
 (
__c⁄°
 *
__fûe
, *__c⁄° 
__¨gv
[]Ë
__THROW
;

509 
	$exe˛p
 (
__c⁄°
 *
__fûe
, __c⁄° *
__¨g
, ...Ë
__THROW
;

512 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


514 
	$ni˚
 (
__öc
Ë
__THROW
;

519 
	$_exô
 (
__°©us
Ë
	`__©åibuã__
 ((
__n‹ëu∫__
));

525 
	~<bôs/c⁄‚ame.h
>

528 
	$∑thc⁄f
 (
__c⁄°
 *
__∑th
, 
__«me
Ë
__THROW
;

531 
	$Â©hc⁄f
 (
__fd
, 
__«me
Ë
__THROW
;

534 
	$sysc⁄f
 (
__«me
Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

536 #ifdef 
__USE_POSIX2


538 
size_t
 
	$c⁄f°r
 (
__«me
, *
__buf
, 
size_t
 
__Àn
Ë
__THROW
;

543 
__pid_t
 
	$gëpid
 (Ë
__THROW
;

546 
__pid_t
 
	$gëµid
 (Ë
__THROW
;

550 #i‚de‡
__FAVOR_BSD


551 
__pid_t
 
	$gëpgΩ
 (Ë
__THROW
;

553 #ifde‡
__REDIRECT


554 
__pid_t
 
	`__REDIRECT
 (
gëpgΩ
, (__pid_à
__pid
Ë
__THROW
, 
__gëpgid
);

556 
	#gëpgΩ
 
__gëpgid


	)

561 
__pid_t
 
	$__gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

562 #ifde‡
__USE_XOPEN_EXTENDED


563 
__pid_t
 
	$gëpgid
 (
__pid_t
 
__pid
Ë
__THROW
;

570 
	$£çgid
 (
__pid_t
 
__pid
, __pid_à
__pgid
Ë
__THROW
;

572 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


583 #i‚de‡
__FAVOR_BSD


587 
	$£çgΩ
 (Ë
__THROW
;

592 #ifde‡
__REDIRECT


593 
	`__REDIRECT
 (
£çgΩ
, (
__pid_t
 
__pid
, __pid_à
__pgΩ
Ë
__THROW
,

594 
£çgid
);

596 
	#£çgΩ
 
£çgid


	)

605 
__pid_t
 
	$£tsid
 (Ë
__THROW
;

607 #ifde‡
__USE_XOPEN_EXTENDED


609 
__pid_t
 
	$gësid
 (
__pid_t
 
__pid
Ë
__THROW
;

613 
__uid_t
 
	$gëuid
 (Ë
__THROW
;

616 
__uid_t
 
	$gëeuid
 (Ë
__THROW
;

619 
__gid_t
 
	$gëgid
 (Ë
__THROW
;

622 
__gid_t
 
	$gëegid
 (Ë
__THROW
;

627 
	$gëgroups
 (
__size
, 
__gid_t
 
__li°
[]Ë
__THROW
;

629 #ifdef 
__USE_GNU


631 
	$group_membî
 (
__gid_t
 
__gid
Ë
__THROW
;

638 
	$£tuid
 (
__uid_t
 
__uid
Ë
__THROW
;

640 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


643 
	$£åeuid
 (
__uid_t
 
__ruid
, __uid_à
__euid
Ë
__THROW
;

646 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


648 
	$£ãuid
 (
__uid_t
 
__uid
Ë
__THROW
;

655 
	$£tgid
 (
__gid_t
 
__gid
Ë
__THROW
;

657 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


660 
	$£åegid
 (
__gid_t
 
__rgid
, __gid_à
__egid
Ë
__THROW
;

663 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


665 
	$£ãgid
 (
__gid_t
 
__gid
Ë
__THROW
;

668 #ifde‡
__USE_GNU


671 
	`gëªsuid
 (
__uid_t
 *
__euid
, __uid_à*
__ruid
, __uid_à*
__suid
);

675 
	`gëªsgid
 (
__gid_t
 *
__egid
, __gid_à*
__rgid
, __gid_à*
__sgid
);

679 
	`£åesuid
 (
__uid_t
 
__euid
, __uid_à
__ruid
, __uid_à
__suid
);

683 
	`£åesgid
 (
__gid_t
 
__egid
, __gid_à
__rgid
, __gid_à
__sgid
);

690 
__pid_t
 
	$f‹k
 (Ë
__THROW
;

692 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


697 
__pid_t
 
	$vf‹k
 (Ë
__THROW
;

703 *
	$ây«me
 (
__fd
Ë
__THROW
;

707 
	$ây«me_r
 (
__fd
, *
__buf
, 
size_t
 
__buÊí
Ë
__THROW
;

711 
	$ißây
 (
__fd
Ë
__THROW
;

713 #i‡
deföed
 
__USE_BSD
 \

714 || (
deföed
 
__USE_XOPEN_EXTENDED
 && !deföed 
__USE_UNIX98
)

717 
	$ây¶Ÿ
 (Ë
__THROW
;

722 
	$lök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
Ë
__THROW
;

724 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


726 
	$symlök
 (
__c⁄°
 *
__‰om
, __c⁄° *
__to
Ë
__THROW
;

731 
	$ªadlök
 (
__c⁄°
 *
__ª°ri˘
 
__∑th
, *__ª°ri˘ 
__buf
,

732 
size_t
 
__Àn
Ë
__THROW
;

736 
	$u∆ök
 (
__c⁄°
 *
__«me
Ë
__THROW
;

739 
	$rmdú
 (
__c⁄°
 *
__∑th
Ë
__THROW
;

743 
__pid_t
 
	$tcgëpgΩ
 (
__fd
Ë
__THROW
;

746 
	$tc£çgΩ
 (
__fd
, 
__pid_t
 
__pgΩ_id
Ë
__THROW
;

753 *
	`gëlogö
 ();

754 #i‡
deföed
 
__USE_REENTRANT
 || deföed 
__USE_UNIX98


761 
	`gëlogö_r
 (*
__«me
, 
size_t
 
__«me_Àn
);

764 #ifdef 
__USE_BSD


766 
	$£éogö
 (
__c⁄°
 *
__«me
Ë
__THROW
;

770 #ifdef 
__USE_POSIX2


774 
	#__√ed_gë›t


	)

775 
	~<gë›t.h
>

779 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_UNIX98


783 
	$gëho°«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
;

787 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_UNIX98
)

790 
	$£tho°«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
Ë
__THROW
;

794 
	$£tho°id
 (
__id
Ë
__THROW
;

800 
	$gëdomaö«me
 (*
__«me
, 
size_t
 
__Àn
Ë
__THROW
;

801 
	$£tdomaö«me
 (
__c⁄°
 *
__«me
, 
size_t
 
__Àn
Ë
__THROW
;

807 
	$vh™gup
 (Ë
__THROW
;

810 
	$ªvoke
 (
__c⁄°
 *
__fûe
Ë
__THROW
;

818 
	$¥ofû
 (*
__ßm∂e_buf„r
, 
size_t
 
__size
,

819 
size_t
 
__off£t
, 
__sˇÀ
Ë
__THROW
;

825 
	$ac˘
 (
__c⁄°
 *
__«me
Ë
__THROW
;

829 *
	$gëu£rshñl
 (Ë
__THROW
;

830 
	$ídu£rshñl
 (Ë
__THROW
;

831 
	$£tu£rshñl
 (Ë
__THROW
;

837 
	$d´m⁄
 (
__nochdú
, 
__no˛o£
Ë
__THROW
;

841 #i‡
deföed
 
__USE_BSD
 || (deföed 
__USE_XOPEN
 && !deföed 
__USE_XOPEN2K
)

844 
	$chroŸ
 (
__c⁄°
 *
__∑th
Ë
__THROW
;

848 *
	`gë∑ss
 (
__c⁄°
 *
__¥om±
);

852 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN


857 
	`fsync
 (
__fd
);

861 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


864 
	`gëho°id
 ();

867 
	$sync
 (Ë
__THROW
;

872 
	$gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

876 #i‚de‡
__USE_FILE_OFFSET64


877 
	$åunˇã
 (
__c⁄°
 *
__fûe
, 
__off_t
 
__Àngth
Ë
__THROW
;

879 #ifde‡
__REDIRECT


880 
	`__REDIRECT
 (
åunˇã
,

881 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
Ë
__THROW
,

882 
åunˇã64
);

884 
	#åunˇã
 
åunˇã64


	)

887 #ifde‡
__USE_LARGEFILE64


888 
	$åunˇã64
 (
__c⁄°
 *
__fûe
, 
__off64_t
 
__Àngth
Ë
__THROW
;

892 #i‚de‡
__USE_FILE_OFFSET64


893 
	$·runˇã
 (
__fd
, 
__off_t
 
__Àngth
Ë
__THROW
;

895 #ifde‡
__REDIRECT


896 
	`__REDIRECT
 (
·runˇã
, (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
,

897 
·runˇã64
);

899 
	#·runˇã
 
·runˇã64


	)

902 #ifde‡
__USE_LARGEFILE64


903 
	$·runˇã64
 (
__fd
, 
__off64_t
 
__Àngth
Ë
__THROW
;

909 
	$gëdèbÀsize
 (Ë
__THROW
;

914 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


918 
	$brk
 (*
__addr
Ë
__THROW
;

924 *
	$sbrk
 (
öçå_t
 
__dñè
Ë
__THROW
;

928 #ifde‡
__USE_MISC


939 
	$sysˇŒ
 (
__sy¢o
, ...Ë
__THROW
;

944 #i‡(
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
Ë&& !deföed 
F_LOCK


956 
	#F_ULOCK
 0

	)

957 
	#F_LOCK
 1

	)

958 
	#F_TLOCK
 2

	)

959 
	#F_TEST
 3

	)

961 #i‚de‡
__USE_FILE_OFFSET64


962 
	`lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Àn
);

964 #ifde‡
__REDIRECT


965 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
),

966 
lockf64
);

968 
	#lockf
 
lockf64


	)

971 #ifde‡
__USE_LARGEFILE64


972 
	`lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Àn
);

977 #ifde‡
__USE_GNU


982 
	#TEMP_FAILURE_RETRY
(
ex¥essi⁄
) \

983 (
__exãnsi⁄__
 \

984 ({ 
__ªsu…
; \

985 dÿ
__ªsu…
 = (Ë(
ex¥essi⁄
); \

986 
__ªsu…
 =-1L && 
î∫o
 =
EINTR
); \

987 
__ªsu…
; 
	}
}))

	)

990 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


993 
	$fd©async
 (
__fûdes
Ë
__THROW
;

999 #ifdef 
__USE_XOPEN


1001 *
	$¸y±
 (
__c⁄°
 *
__key
, __c⁄° *
__ß…
Ë
__THROW
;

1005 
	$í¸y±
 (*
__block
, 
__edÊag
Ë
__THROW
;

1012 
	$swab
 (
__c⁄°
 *
__ª°ri˘
 
__‰om
, *__ª°ri˘ 
__to
,

1013 
ssize_t
 
__n
Ë
__THROW
;

1019 #ifde‡
__USE_XOPEN


1021 *
	$˘îmid
 (*
__s
Ë
__THROW
;

1024 
__END_DECLS


	@/usr/include/utmp.h

19 #i‚def 
_UTMP_H


20 
	#_UTMP_H
 1

	)

22 
	~<„©uªs.h
>

24 
	~<sys/ty≥s.h
>

27 
	g__BEGIN_DECLS


30 
	~<bôs/utmp.h
>

33 
	#UTMP_FILE
 
_PATH_UTMP


	)

34 
	#UTMP_FILENAME
 
_PATH_UTMP


	)

35 
	#WTMP_FILE
 
_PATH_WTMP


	)

36 
	#WTMP_FILENAME
 
_PATH_WTMP


	)

42 
	$logö_ây
 (
__fd
Ë
__THROW
;

46 
	$logö
 (
__c⁄°
 
utmp
 *
__íåy
Ë
__THROW
;

49 
	$logout
 (
__c⁄°
 *
__ut_löe
Ë
__THROW
;

52 
	$logwtmp
 (
__c⁄°
 *
__ut_löe
, __c⁄° *
__ut_«me
,

53 
__c⁄°
 *
__ut_ho°
Ë
__THROW
;

56 
	$updwtmp
 (
__c⁄°
 *
__wtmp_fûe
, __c⁄° 
utmp
 *
__utmp
)

57 
__THROW
;

60 
	$utm≤ame
 (
__c⁄°
 *
__fûe
Ë
__THROW
;

63 
utmp
 *
	$gëuã¡
 (Ë
__THROW
;

66 
	$£tuã¡
 (Ë
__THROW
;

69 
	$íduã¡
 (Ë
__THROW
;

73 
utmp
 *
	$gëutid
 (
__c⁄°
 
utmp
 *
__id
Ë
__THROW
;

77 
utmp
 *
	$gëuéöe
 (
__c⁄°
 
utmp
 *
__löe
Ë
__THROW
;

80 
utmp
 *
	$putuéöe
 (
__c⁄°
 
utmp
 *
__utmp_±r
Ë
__THROW
;

83 #ifdef 
__USE_MISC


85 
	$gëuã¡_r
 (
utmp
 *
__buf„r
, utm∞**
__ªsu…
Ë
__THROW
;

87 
	$gëutid_r
 (
__c⁄°
 
utmp
 *
__id
, utm∞*
__buf„r
,

88 
utmp
 **
__ªsu…
Ë
__THROW
;

90 
	$gëuéöe_r
 (
__c⁄°
 
utmp
 *
__löe
,

91 
utmp
 *
__buf„r
, utm∞**
__ªsu…
Ë
__THROW
;

95 
__END_DECLS


	@/usr/include/values.h

23 #i‚def 
_VALUES_H


24 
	#_VALUES_H
 1

	)

26 
	~<„©uªs.h
>

28 
	~<limôs.h
>

30 
	#_TYPEBITS
(
ty≥
Ë( (ty≥Ë* 
CHAR_BIT
)

	)

32 
	#CHARBITS
 
	`_TYPEBITS
 ()

	)

33 
	#SHORTBITS
 
	`_TYPEBITS
 ()

	)

34 
	#INTBITS
 
	`_TYPEBITS
 ()

	)

35 
	#LONGBITS
 
	`_TYPEBITS
 ()

	)

36 
	#PTRBITS
 
	`_TYPEBITS
 (*)

	)

37 
	#DOUBLEBITS
 
	`_TYPEBITS
 ()

	)

38 
	#FLOATBITS
 
	`_TYPEBITS
 ()

	)

40 
	#MINSHORT
 
SHRT_MIN


	)

41 
	#MININT
 
INT_MIN


	)

42 
	#MINLONG
 
LONG_MIN


	)

44 
	#MAXSHORT
 
SHRT_MAX


	)

45 
	#MAXINT
 
INT_MAX


	)

46 
	#MAXLONG
 
LONG_MAX


	)

48 
	#HIBITS
 
MINSHORT


	)

49 
	#HIBITL
 
MINLONG


	)

52 
	~<Êﬂt.h
>

54 
	#MAXDOUBLE
 
DBL_MAX


	)

55 
	#MAXFLOAT
 
FLT_MAX


	)

56 
	#MINDOUBLE
 
DBL_MIN


	)

57 
	#MINFLOAT
 
FLT_MIN


	)

58 
	#DMINEXP
 
DBL_MIN_EXP


	)

59 
	#FMINEXP
 
FLT_MIN_EXP


	)

60 
	#DMAXEXP
 
DBL_MAX_EXP


	)

61 
	#FMAXEXP
 
FLT_MAX_EXP


	)

64 #ifde‡
__USE_MISC


66 
	#BITSPERBYTE
 
CHAR_BIT


	)

	@/usr/include/alloca.h

19 #i‚def 
_ALLOCA_H


20 
	#_ALLOCA_H
 1

	)

22 
	~<„©uªs.h
>

24 
	#__√ed_size_t


	)

25 
	~<°ddef.h
>

27 
	g__BEGIN_DECLS


30 #unde‡
Æloˇ


33 *
	$Æloˇ
 (
size_t
 
__size
Ë
__THROW
;

35 #ifdef 
__GNUC__


36 
	#Æloˇ
(
size
Ë
	`__buûtö_Æloˇ
 (size)

	)

39 
__END_DECLS


	@/usr/include/asm/mmx.h

1 #i‚de‡
_ASM_MMX_H


2 
	#_ASM_MMX_H


	)

8 
	~<löux/ty≥s.h
>

10 *
_mmx_mem˝y
(*
to
, c⁄° *
‰om
, 
size_t
 
size
);

11 
mmx_˛ór_∑ge
(*
∑ge
);

12 
mmx_c›y_∑ge
(*
to
, *
‰om
);

	@/usr/include/asm/types.h

1 #i‚de‡
_I386_TYPES_H


2 
	#_I386_TYPES_H


	)

4 #i‚de‡
__ASSEMBLY__


6 
	tumode_t
;

13 
__sig√d__
 
	t__s8
;

14 
	t__u8
;

16 
__sig√d__
 
	t__s16
;

17 
	t__u16
;

19 
__sig√d__
 
	t__s32
;

20 
	t__u32
;

22 #i‡
deföed
(
__GNUC__
)

23 
__exãnsi⁄__
 
__sig√d__
 
	t__s64
;

24 
__exãnsi⁄__
 
	t__u64
;

32 #ifde‡
__KERNEL__


34 
	#BITS_PER_LONG
 32

	)

36 #i‚de‡
__ASSEMBLY__


38 
	~<löux/c⁄fig.h
>

40 sig√d 
	ts8
;

41 
	tu8
;

43 sig√d 
	ts16
;

44 
	tu16
;

46 sig√d 
	ts32
;

47 
	tu32
;

49 sig√d 
	ts64
;

50 
	tu64
;

54 #ifde‡
CONFIG_HIGHMEM64G


55 
u64
 
	tdma_addr_t
;

57 
u32
 
	tdma_addr_t
;

59 
u64
 
	tdma64_addr_t
;

61 #ifde‡
CONFIG_LBD


62 
u64
 
	t£˘‹_t
;

63 
	#HAVE_SECTOR_T


	)

	@/usr/include/bits/byteswap.h

20 #i‡!
deföed
 
_BYTESWAP_H
 && !deföed 
_NETINET_IN_H


24 #i‚de‡
_BITS_BYTESWAP_H


25 
	#_BITS_BYTESWAP_H
 1

	)

28 
	#__bsw≠_c⁄°™t_16
(
x
) \

29 ((((
x
Ë>> 8Ë& 0xffË| (((xË& 0xffË<< 8))

	)

31 #ifde‡
__GNUC__


32 #i‡
__GNUC__
 >= 2

33 
	#__bsw≠_16
(
x
) \

34 (
__exãnsi⁄__
 \

35 ({ 
__v
, 
__x
 = (
x
); \

36 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

37 
__v
 = 
	`__bsw≠_c⁄°™t_16
 (
__x
); \

39 
	`__asm__
 ("rorw $8, %w0" \

40 : "Ù" (
__v
) \

41 : "0" (
__x
) \

43 
__v
; }))

	)

46 
	#__bsw≠_16
(
x
) \

47 (
__exãnsi⁄__
 \

48 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_16
 (__x); }))

	)

51 
__ölöe
 

52 
	$__bsw≠_16
 (
__bsx
)

54  
	`__bsw≠_c⁄°™t_16
 (
__bsx
);

55 
	}
}

59 
	#__bsw≠_c⁄°™t_32
(
x
) \

60 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

61 (((
x
Ë& 0x0000ff00Ë<< 8Ë| (((xË& 0x000000ffË<< 24))

	)

63 #ifde‡
__GNUC__


64 #i‡
__GNUC__
 >= 2

67 #i‡!
deföed
 
__i486__
 && !deföed 
__≥¡ium__
 && !deföed 
__≥¡ium¥o__
 \

68 && !
deföed
 
	g__≥¡ium4__


69 
	#__bsw≠_32
(
x
) \

70 (
__exãnsi⁄__
 \

71 ({ 
__v
, 
__x
 = (
x
); \

72 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

73 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

75 
	`__asm__
 ("rorw $8, %w0;" \

78 : "Ù" (
__v
) \

79 : "0" (
__x
) \

81 
__v
; }))

	)

83 
	#__bsw≠_32
(
x
) \

84 (
__exãnsi⁄__
 \

85 ({ 
__v
, 
__x
 = (
x
); \

86 i‡(
	`__buûtö_c⁄°™t_p
 (
__x
)) \

87 
__v
 = 
	`__bsw≠_c⁄°™t_32
 (
__x
); \

89 
	`__asm__
 ("bsw≠ %0" : "Ù" (
__v
Ë: "0" (
__x
)); \

90 
__v
; }))

	)

93 
	#__bsw≠_32
(
x
) \

94 (
__exãnsi⁄__
 \

95 ({ 
__x
 = (
x
); 
	`__bsw≠_c⁄°™t_32
 (__x); }))

	)

98 
__ölöe
 

99 
	$__bsw≠_32
 (
__bsx
)

101  
	`__bsw≠_c⁄°™t_32
 (
__bsx
);

102 
	}
}

106 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

108 
	#__bsw≠_c⁄°™t_64
(
x
) \

109 ((((
x
) & 0xff00000000000000ull) >> 56) \

110 | (((
x
) & 0x00ff000000000000ull) >> 40) \

111 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

112 | (((
x
) & 0x000000ff00000000ull) >> 8) \

113 | (((
x
) & 0x00000000ff000000ull) << 8) \

114 | (((
x
) & 0x0000000000ff0000ull) << 24) \

115 | (((
x
) & 0x000000000000ff00ull) << 40) \

116 | (((
x
Ë& 0x00000000000000ffuŒË<< 56))

	)

118 
	#__bsw≠_64
(
x
) \

119 (
__exãnsi⁄__
 \

120 ({ uni⁄ { 
__exãnsi⁄__
 
__Œ
; \

121 
__l
[2]; } 
__w
, 
__r
; \

122 i‡(
	`__buûtö_c⁄°™t_p
 (
x
)) \

123 
__r
.
__Œ
 = 
	`__bsw≠_c⁄°™t_64
 (
x
); \

126 
__w
.
__Œ
 = (
x
); \

127 
__r
.
__l
[0] = 
	`__bsw≠_32
 (
__w
.__l[1]); \

128 
__r
.
__l
[1] = 
	`__bsw≠_32
 (
__w
.__l[0]); \

130 
__r
.
__Œ
; }))

	)

	@/usr/include/bits/confname.h

20 #i‚de‡
_UNISTD_H


27 
	m_PC_LINK_MAX
,

28 
	#_PC_LINK_MAX
 
_PC_LINK_MAX


	)

29 
	m_PC_MAX_CANON
,

30 
	#_PC_MAX_CANON
 
_PC_MAX_CANON


	)

31 
	m_PC_MAX_INPUT
,

32 
	#_PC_MAX_INPUT
 
_PC_MAX_INPUT


	)

33 
	m_PC_NAME_MAX
,

34 
	#_PC_NAME_MAX
 
_PC_NAME_MAX


	)

35 
	m_PC_PATH_MAX
,

36 
	#_PC_PATH_MAX
 
_PC_PATH_MAX


	)

37 
	m_PC_PIPE_BUF
,

38 
	#_PC_PIPE_BUF
 
_PC_PIPE_BUF


	)

39 
	m_PC_CHOWN_RESTRICTED
,

40 
	#_PC_CHOWN_RESTRICTED
 
_PC_CHOWN_RESTRICTED


	)

41 
	m_PC_NO_TRUNC
,

42 
	#_PC_NO_TRUNC
 
_PC_NO_TRUNC


	)

43 
	m_PC_VDISABLE
,

44 
	#_PC_VDISABLE
 
_PC_VDISABLE


	)

45 
	m_PC_SYNC_IO
,

46 
	#_PC_SYNC_IO
 
_PC_SYNC_IO


	)

47 
	m_PC_ASYNC_IO
,

48 
	#_PC_ASYNC_IO
 
_PC_ASYNC_IO


	)

49 
	m_PC_PRIO_IO
,

50 
	#_PC_PRIO_IO
 
_PC_PRIO_IO


	)

51 
	m_PC_SOCK_MAXBUF
,

52 
	#_PC_SOCK_MAXBUF
 
_PC_SOCK_MAXBUF


	)

53 
	m_PC_FILESIZEBITS
,

54 
	#_PC_FILESIZEBITS
 
_PC_FILESIZEBITS


	)

55 
	m_PC_REC_INCR_XFER_SIZE
,

56 
	#_PC_REC_INCR_XFER_SIZE
 
_PC_REC_INCR_XFER_SIZE


	)

57 
	m_PC_REC_MAX_XFER_SIZE
,

58 
	#_PC_REC_MAX_XFER_SIZE
 
_PC_REC_MAX_XFER_SIZE


	)

59 
	m_PC_REC_MIN_XFER_SIZE
,

60 
	#_PC_REC_MIN_XFER_SIZE
 
_PC_REC_MIN_XFER_SIZE


	)

61 
	m_PC_REC_XFER_ALIGN
,

62 
	#_PC_REC_XFER_ALIGN
 
_PC_REC_XFER_ALIGN


	)

63 
	m_PC_ALLOC_SIZE_MIN
,

64 
	#_PC_ALLOC_SIZE_MIN
 
_PC_ALLOC_SIZE_MIN


	)

65 
	m_PC_SYMLINK_MAX
,

66 
	#_PC_SYMLINK_MAX
 
_PC_SYMLINK_MAX


	)

67 
	m_PC_2_SYMLINKS


68 
	#_PC_2_SYMLINKS
 
_PC_2_SYMLINKS


	)

74 
	m_SC_ARG_MAX
,

75 
	#_SC_ARG_MAX
 
_SC_ARG_MAX


	)

76 
	m_SC_CHILD_MAX
,

77 
	#_SC_CHILD_MAX
 
_SC_CHILD_MAX


	)

78 
	m_SC_CLK_TCK
,

79 
	#_SC_CLK_TCK
 
_SC_CLK_TCK


	)

80 
	m_SC_NGROUPS_MAX
,

81 
	#_SC_NGROUPS_MAX
 
_SC_NGROUPS_MAX


	)

82 
	m_SC_OPEN_MAX
,

83 
	#_SC_OPEN_MAX
 
_SC_OPEN_MAX


	)

84 
	m_SC_STREAM_MAX
,

85 
	#_SC_STREAM_MAX
 
_SC_STREAM_MAX


	)

86 
	m_SC_TZNAME_MAX
,

87 
	#_SC_TZNAME_MAX
 
_SC_TZNAME_MAX


	)

88 
	m_SC_JOB_CONTROL
,

89 
	#_SC_JOB_CONTROL
 
_SC_JOB_CONTROL


	)

90 
	m_SC_SAVED_IDS
,

91 
	#_SC_SAVED_IDS
 
_SC_SAVED_IDS


	)

92 
	m_SC_REALTIME_SIGNALS
,

93 
	#_SC_REALTIME_SIGNALS
 
_SC_REALTIME_SIGNALS


	)

94 
	m_SC_PRIORITY_SCHEDULING
,

95 
	#_SC_PRIORITY_SCHEDULING
 
_SC_PRIORITY_SCHEDULING


	)

96 
	m_SC_TIMERS
,

97 
	#_SC_TIMERS
 
_SC_TIMERS


	)

98 
	m_SC_ASYNCHRONOUS_IO
,

99 
	#_SC_ASYNCHRONOUS_IO
 
_SC_ASYNCHRONOUS_IO


	)

100 
	m_SC_PRIORITIZED_IO
,

101 
	#_SC_PRIORITIZED_IO
 
_SC_PRIORITIZED_IO


	)

102 
	m_SC_SYNCHRONIZED_IO
,

103 
	#_SC_SYNCHRONIZED_IO
 
_SC_SYNCHRONIZED_IO


	)

104 
	m_SC_FSYNC
,

105 
	#_SC_FSYNC
 
_SC_FSYNC


	)

106 
	m_SC_MAPPED_FILES
,

107 
	#_SC_MAPPED_FILES
 
_SC_MAPPED_FILES


	)

108 
	m_SC_MEMLOCK
,

109 
	#_SC_MEMLOCK
 
_SC_MEMLOCK


	)

110 
	m_SC_MEMLOCK_RANGE
,

111 
	#_SC_MEMLOCK_RANGE
 
_SC_MEMLOCK_RANGE


	)

112 
	m_SC_MEMORY_PROTECTION
,

113 
	#_SC_MEMORY_PROTECTION
 
_SC_MEMORY_PROTECTION


	)

114 
	m_SC_MESSAGE_PASSING
,

115 
	#_SC_MESSAGE_PASSING
 
_SC_MESSAGE_PASSING


	)

116 
	m_SC_SEMAPHORES
,

117 
	#_SC_SEMAPHORES
 
_SC_SEMAPHORES


	)

118 
	m_SC_SHARED_MEMORY_OBJECTS
,

119 
	#_SC_SHARED_MEMORY_OBJECTS
 
_SC_SHARED_MEMORY_OBJECTS


	)

120 
	m_SC_AIO_LISTIO_MAX
,

121 
	#_SC_AIO_LISTIO_MAX
 
_SC_AIO_LISTIO_MAX


	)

122 
	m_SC_AIO_MAX
,

123 
	#_SC_AIO_MAX
 
_SC_AIO_MAX


	)

124 
	m_SC_AIO_PRIO_DELTA_MAX
,

125 
	#_SC_AIO_PRIO_DELTA_MAX
 
_SC_AIO_PRIO_DELTA_MAX


	)

126 
	m_SC_DELAYTIMER_MAX
,

127 
	#_SC_DELAYTIMER_MAX
 
_SC_DELAYTIMER_MAX


	)

128 
	m_SC_MQ_OPEN_MAX
,

129 
	#_SC_MQ_OPEN_MAX
 
_SC_MQ_OPEN_MAX


	)

130 
	m_SC_MQ_PRIO_MAX
,

131 
	#_SC_MQ_PRIO_MAX
 
_SC_MQ_PRIO_MAX


	)

132 
	m_SC_VERSION
,

133 
	#_SC_VERSION
 
_SC_VERSION


	)

134 
	m_SC_PAGESIZE
,

135 
	#_SC_PAGESIZE
 
_SC_PAGESIZE


	)

136 
	#_SC_PAGE_SIZE
 
_SC_PAGESIZE


	)

137 
	m_SC_RTSIG_MAX
,

138 
	#_SC_RTSIG_MAX
 
_SC_RTSIG_MAX


	)

139 
	m_SC_SEM_NSEMS_MAX
,

140 
	#_SC_SEM_NSEMS_MAX
 
_SC_SEM_NSEMS_MAX


	)

141 
	m_SC_SEM_VALUE_MAX
,

142 
	#_SC_SEM_VALUE_MAX
 
_SC_SEM_VALUE_MAX


	)

143 
	m_SC_SIGQUEUE_MAX
,

144 
	#_SC_SIGQUEUE_MAX
 
_SC_SIGQUEUE_MAX


	)

145 
	m_SC_TIMER_MAX
,

146 
	#_SC_TIMER_MAX
 
_SC_TIMER_MAX


	)

150 
	m_SC_BC_BASE_MAX
,

151 
	#_SC_BC_BASE_MAX
 
_SC_BC_BASE_MAX


	)

152 
	m_SC_BC_DIM_MAX
,

153 
	#_SC_BC_DIM_MAX
 
_SC_BC_DIM_MAX


	)

154 
	m_SC_BC_SCALE_MAX
,

155 
	#_SC_BC_SCALE_MAX
 
_SC_BC_SCALE_MAX


	)

156 
	m_SC_BC_STRING_MAX
,

157 
	#_SC_BC_STRING_MAX
 
_SC_BC_STRING_MAX


	)

158 
	m_SC_COLL_WEIGHTS_MAX
,

159 
	#_SC_COLL_WEIGHTS_MAX
 
_SC_COLL_WEIGHTS_MAX


	)

160 
	m_SC_EQUIV_CLASS_MAX
,

161 
	#_SC_EQUIV_CLASS_MAX
 
_SC_EQUIV_CLASS_MAX


	)

162 
	m_SC_EXPR_NEST_MAX
,

163 
	#_SC_EXPR_NEST_MAX
 
_SC_EXPR_NEST_MAX


	)

164 
	m_SC_LINE_MAX
,

165 
	#_SC_LINE_MAX
 
_SC_LINE_MAX


	)

166 
	m_SC_RE_DUP_MAX
,

167 
	#_SC_RE_DUP_MAX
 
_SC_RE_DUP_MAX


	)

168 
	m_SC_CHARCLASS_NAME_MAX
,

169 
	#_SC_CHARCLASS_NAME_MAX
 
_SC_CHARCLASS_NAME_MAX


	)

171 
	m_SC_2_VERSION
,

172 
	#_SC_2_VERSION
 
_SC_2_VERSION


	)

173 
	m_SC_2_C_BIND
,

174 
	#_SC_2_C_BIND
 
_SC_2_C_BIND


	)

175 
	m_SC_2_C_DEV
,

176 
	#_SC_2_C_DEV
 
_SC_2_C_DEV


	)

177 
	m_SC_2_FORT_DEV
,

178 
	#_SC_2_FORT_DEV
 
_SC_2_FORT_DEV


	)

179 
	m_SC_2_FORT_RUN
,

180 
	#_SC_2_FORT_RUN
 
_SC_2_FORT_RUN


	)

181 
	m_SC_2_SW_DEV
,

182 
	#_SC_2_SW_DEV
 
_SC_2_SW_DEV


	)

183 
	m_SC_2_LOCALEDEF
,

184 
	#_SC_2_LOCALEDEF
 
_SC_2_LOCALEDEF


	)

186 
	m_SC_PII
,

187 
	#_SC_PII
 
_SC_PII


	)

188 
	m_SC_PII_XTI
,

189 
	#_SC_PII_XTI
 
_SC_PII_XTI


	)

190 
	m_SC_PII_SOCKET
,

191 
	#_SC_PII_SOCKET
 
_SC_PII_SOCKET


	)

192 
	m_SC_PII_INTERNET
,

193 
	#_SC_PII_INTERNET
 
_SC_PII_INTERNET


	)

194 
	m_SC_PII_OSI
,

195 
	#_SC_PII_OSI
 
_SC_PII_OSI


	)

196 
	m_SC_POLL
,

197 
	#_SC_POLL
 
_SC_POLL


	)

198 
	m_SC_SELECT
,

199 
	#_SC_SELECT
 
_SC_SELECT


	)

200 
	m_SC_UIO_MAXIOV
,

201 
	#_SC_UIO_MAXIOV
 
_SC_UIO_MAXIOV


	)

202 
	m_SC_IOV_MAX
 = 
_SC_UIO_MAXIOV
,

203 
	#_SC_IOV_MAX
 
_SC_IOV_MAX


	)

204 
	m_SC_PII_INTERNET_STREAM
,

205 
	#_SC_PII_INTERNET_STREAM
 
_SC_PII_INTERNET_STREAM


	)

206 
	m_SC_PII_INTERNET_DGRAM
,

207 
	#_SC_PII_INTERNET_DGRAM
 
_SC_PII_INTERNET_DGRAM


	)

208 
	m_SC_PII_OSI_COTS
,

209 
	#_SC_PII_OSI_COTS
 
_SC_PII_OSI_COTS


	)

210 
	m_SC_PII_OSI_CLTS
,

211 
	#_SC_PII_OSI_CLTS
 
_SC_PII_OSI_CLTS


	)

212 
	m_SC_PII_OSI_M
,

213 
	#_SC_PII_OSI_M
 
_SC_PII_OSI_M


	)

214 
	m_SC_T_IOV_MAX
,

215 
	#_SC_T_IOV_MAX
 
_SC_T_IOV_MAX


	)

218 
	m_SC_THREADS
,

219 
	#_SC_THREADS
 
_SC_THREADS


	)

220 
	m_SC_THREAD_SAFE_FUNCTIONS
,

221 
	#_SC_THREAD_SAFE_FUNCTIONS
 
_SC_THREAD_SAFE_FUNCTIONS


	)

222 
	m_SC_GETGR_R_SIZE_MAX
,

223 
	#_SC_GETGR_R_SIZE_MAX
 
_SC_GETGR_R_SIZE_MAX


	)

224 
	m_SC_GETPW_R_SIZE_MAX
,

225 
	#_SC_GETPW_R_SIZE_MAX
 
_SC_GETPW_R_SIZE_MAX


	)

226 
	m_SC_LOGIN_NAME_MAX
,

227 
	#_SC_LOGIN_NAME_MAX
 
_SC_LOGIN_NAME_MAX


	)

228 
	m_SC_TTY_NAME_MAX
,

229 
	#_SC_TTY_NAME_MAX
 
_SC_TTY_NAME_MAX


	)

230 
	m_SC_THREAD_DESTRUCTOR_ITERATIONS
,

231 
	#_SC_THREAD_DESTRUCTOR_ITERATIONS
 
_SC_THREAD_DESTRUCTOR_ITERATIONS


	)

232 
	m_SC_THREAD_KEYS_MAX
,

233 
	#_SC_THREAD_KEYS_MAX
 
_SC_THREAD_KEYS_MAX


	)

234 
	m_SC_THREAD_STACK_MIN
,

235 
	#_SC_THREAD_STACK_MIN
 
_SC_THREAD_STACK_MIN


	)

236 
	m_SC_THREAD_THREADS_MAX
,

237 
	#_SC_THREAD_THREADS_MAX
 
_SC_THREAD_THREADS_MAX


	)

238 
	m_SC_THREAD_ATTR_STACKADDR
,

239 
	#_SC_THREAD_ATTR_STACKADDR
 
_SC_THREAD_ATTR_STACKADDR


	)

240 
	m_SC_THREAD_ATTR_STACKSIZE
,

241 
	#_SC_THREAD_ATTR_STACKSIZE
 
_SC_THREAD_ATTR_STACKSIZE


	)

242 
	m_SC_THREAD_PRIORITY_SCHEDULING
,

243 
	#_SC_THREAD_PRIORITY_SCHEDULING
 
_SC_THREAD_PRIORITY_SCHEDULING


	)

244 
	m_SC_THREAD_PRIO_INHERIT
,

245 
	#_SC_THREAD_PRIO_INHERIT
 
_SC_THREAD_PRIO_INHERIT


	)

246 
	m_SC_THREAD_PRIO_PROTECT
,

247 
	#_SC_THREAD_PRIO_PROTECT
 
_SC_THREAD_PRIO_PROTECT


	)

248 
	m_SC_THREAD_PROCESS_SHARED
,

249 
	#_SC_THREAD_PROCESS_SHARED
 
_SC_THREAD_PROCESS_SHARED


	)

251 
	m_SC_NPROCESSORS_CONF
,

252 
	#_SC_NPROCESSORS_CONF
 
_SC_NPROCESSORS_CONF


	)

253 
	m_SC_NPROCESSORS_ONLN
,

254 
	#_SC_NPROCESSORS_ONLN
 
_SC_NPROCESSORS_ONLN


	)

255 
	m_SC_PHYS_PAGES
,

256 
	#_SC_PHYS_PAGES
 
_SC_PHYS_PAGES


	)

257 
	m_SC_AVPHYS_PAGES
,

258 
	#_SC_AVPHYS_PAGES
 
_SC_AVPHYS_PAGES


	)

259 
	m_SC_ATEXIT_MAX
,

260 
	#_SC_ATEXIT_MAX
 
_SC_ATEXIT_MAX


	)

261 
	m_SC_PASS_MAX
,

262 
	#_SC_PASS_MAX
 
_SC_PASS_MAX


	)

264 
	m_SC_XOPEN_VERSION
,

265 
	#_SC_XOPEN_VERSION
 
_SC_XOPEN_VERSION


	)

266 
	m_SC_XOPEN_XCU_VERSION
,

267 
	#_SC_XOPEN_XCU_VERSION
 
_SC_XOPEN_XCU_VERSION


	)

268 
	m_SC_XOPEN_UNIX
,

269 
	#_SC_XOPEN_UNIX
 
_SC_XOPEN_UNIX


	)

270 
	m_SC_XOPEN_CRYPT
,

271 
	#_SC_XOPEN_CRYPT
 
_SC_XOPEN_CRYPT


	)

272 
	m_SC_XOPEN_ENH_I18N
,

273 
	#_SC_XOPEN_ENH_I18N
 
_SC_XOPEN_ENH_I18N


	)

274 
	m_SC_XOPEN_SHM
,

275 
	#_SC_XOPEN_SHM
 
_SC_XOPEN_SHM


	)

277 
	m_SC_2_CHAR_TERM
,

278 
	#_SC_2_CHAR_TERM
 
_SC_2_CHAR_TERM


	)

279 
	m_SC_2_C_VERSION
,

280 
	#_SC_2_C_VERSION
 
_SC_2_C_VERSION


	)

281 
	m_SC_2_UPE
,

282 
	#_SC_2_UPE
 
_SC_2_UPE


	)

284 
	m_SC_XOPEN_XPG2
,

285 
	#_SC_XOPEN_XPG2
 
_SC_XOPEN_XPG2


	)

286 
	m_SC_XOPEN_XPG3
,

287 
	#_SC_XOPEN_XPG3
 
_SC_XOPEN_XPG3


	)

288 
	m_SC_XOPEN_XPG4
,

289 
	#_SC_XOPEN_XPG4
 
_SC_XOPEN_XPG4


	)

291 
	m_SC_CHAR_BIT
,

292 
	#_SC_CHAR_BIT
 
_SC_CHAR_BIT


	)

293 
	m_SC_CHAR_MAX
,

294 
	#_SC_CHAR_MAX
 
_SC_CHAR_MAX


	)

295 
	m_SC_CHAR_MIN
,

296 
	#_SC_CHAR_MIN
 
_SC_CHAR_MIN


	)

297 
	m_SC_INT_MAX
,

298 
	#_SC_INT_MAX
 
_SC_INT_MAX


	)

299 
	m_SC_INT_MIN
,

300 
	#_SC_INT_MIN
 
_SC_INT_MIN


	)

301 
	m_SC_LONG_BIT
,

302 
	#_SC_LONG_BIT
 
_SC_LONG_BIT


	)

303 
	m_SC_WORD_BIT
,

304 
	#_SC_WORD_BIT
 
_SC_WORD_BIT


	)

305 
	m_SC_MB_LEN_MAX
,

306 
	#_SC_MB_LEN_MAX
 
_SC_MB_LEN_MAX


	)

307 
	m_SC_NZERO
,

308 
	#_SC_NZERO
 
_SC_NZERO


	)

309 
	m_SC_SSIZE_MAX
,

310 
	#_SC_SSIZE_MAX
 
_SC_SSIZE_MAX


	)

311 
	m_SC_SCHAR_MAX
,

312 
	#_SC_SCHAR_MAX
 
_SC_SCHAR_MAX


	)

313 
	m_SC_SCHAR_MIN
,

314 
	#_SC_SCHAR_MIN
 
_SC_SCHAR_MIN


	)

315 
	m_SC_SHRT_MAX
,

316 
	#_SC_SHRT_MAX
 
_SC_SHRT_MAX


	)

317 
	m_SC_SHRT_MIN
,

318 
	#_SC_SHRT_MIN
 
_SC_SHRT_MIN


	)

319 
	m_SC_UCHAR_MAX
,

320 
	#_SC_UCHAR_MAX
 
_SC_UCHAR_MAX


	)

321 
	m_SC_UINT_MAX
,

322 
	#_SC_UINT_MAX
 
_SC_UINT_MAX


	)

323 
	m_SC_ULONG_MAX
,

324 
	#_SC_ULONG_MAX
 
_SC_ULONG_MAX


	)

325 
	m_SC_USHRT_MAX
,

326 
	#_SC_USHRT_MAX
 
_SC_USHRT_MAX


	)

328 
	m_SC_NL_ARGMAX
,

329 
	#_SC_NL_ARGMAX
 
_SC_NL_ARGMAX


	)

330 
	m_SC_NL_LANGMAX
,

331 
	#_SC_NL_LANGMAX
 
_SC_NL_LANGMAX


	)

332 
	m_SC_NL_MSGMAX
,

333 
	#_SC_NL_MSGMAX
 
_SC_NL_MSGMAX


	)

334 
	m_SC_NL_NMAX
,

335 
	#_SC_NL_NMAX
 
_SC_NL_NMAX


	)

336 
	m_SC_NL_SETMAX
,

337 
	#_SC_NL_SETMAX
 
_SC_NL_SETMAX


	)

338 
	m_SC_NL_TEXTMAX
,

339 
	#_SC_NL_TEXTMAX
 
_SC_NL_TEXTMAX


	)

341 
	m_SC_XBS5_ILP32_OFF32
,

342 
	#_SC_XBS5_ILP32_OFF32
 
_SC_XBS5_ILP32_OFF32


	)

343 
	m_SC_XBS5_ILP32_OFFBIG
,

344 
	#_SC_XBS5_ILP32_OFFBIG
 
_SC_XBS5_ILP32_OFFBIG


	)

345 
	m_SC_XBS5_LP64_OFF64
,

346 
	#_SC_XBS5_LP64_OFF64
 
_SC_XBS5_LP64_OFF64


	)

347 
	m_SC_XBS5_LPBIG_OFFBIG
,

348 
	#_SC_XBS5_LPBIG_OFFBIG
 
_SC_XBS5_LPBIG_OFFBIG


	)

350 
	m_SC_XOPEN_LEGACY
,

351 
	#_SC_XOPEN_LEGACY
 
_SC_XOPEN_LEGACY


	)

352 
	m_SC_XOPEN_REALTIME
,

353 
	#_SC_XOPEN_REALTIME
 
_SC_XOPEN_REALTIME


	)

354 
	m_SC_XOPEN_REALTIME_THREADS
,

355 
	#_SC_XOPEN_REALTIME_THREADS
 
_SC_XOPEN_REALTIME_THREADS


	)

357 
	m_SC_ADVISORY_INFO
,

358 
	#_SC_ADVISORY_INFO
 
_SC_ADVISORY_INFO


	)

359 
	m_SC_BARRIERS
,

360 
	#_SC_BARRIERS
 
_SC_BARRIERS


	)

361 
	m_SC_BASE
,

362 
	#_SC_BASE
 
_SC_BASE


	)

363 
	m_SC_C_LANG_SUPPORT
,

364 
	#_SC_C_LANG_SUPPORT
 
_SC_C_LANG_SUPPORT


	)

365 
	m_SC_C_LANG_SUPPORT_R
,

366 
	#_SC_C_LANG_SUPPORT_R
 
_SC_C_LANG_SUPPORT_R


	)

367 
	m_SC_CLOCK_SELECTION
,

368 
	#_SC_CLOCK_SELECTION
 
_SC_CLOCK_SELECTION


	)

369 
	m_SC_CPUTIME
,

370 
	#_SC_CPUTIME
 
_SC_CPUTIME


	)

371 
	m_SC_THREAD_CPUTIME
,

372 
	#_SC_THREAD_CPUTIME
 
_SC_THREAD_CPUTIME


	)

373 
	m_SC_DEVICE_IO
,

374 
	#_SC_DEVICE_IO
 
_SC_DEVICE_IO


	)

375 
	m_SC_DEVICE_SPECIFIC
,

376 
	#_SC_DEVICE_SPECIFIC
 
_SC_DEVICE_SPECIFIC


	)

377 
	m_SC_DEVICE_SPECIFIC_R
,

378 
	#_SC_DEVICE_SPECIFIC_R
 
_SC_DEVICE_SPECIFIC_R


	)

379 
	m_SC_FD_MGMT
,

380 
	#_SC_FD_MGMT
 
_SC_FD_MGMT


	)

381 
	m_SC_FIFO
,

382 
	#_SC_FIFO
 
_SC_FIFO


	)

383 
	m_SC_PIPE
,

384 
	#_SC_PIPE
 
_SC_PIPE


	)

385 
	m_SC_FILE_ATTRIBUTES
,

386 
	#_SC_FILE_ATTRIBUTES
 
_SC_FILE_ATTRIBUTES


	)

387 
	m_SC_FILE_LOCKING
,

388 
	#_SC_FILE_LOCKING
 
_SC_FILE_LOCKING


	)

389 
	m_SC_FILE_SYSTEM
,

390 
	#_SC_FILE_SYSTEM
 
_SC_FILE_SYSTEM


	)

391 
	m_SC_MONOTONIC_CLOCK
,

392 
	#_SC_MONOTONIC_CLOCK
 
_SC_MONOTONIC_CLOCK


	)

393 
	m_SC_MULTI_PROCESS
,

394 
	#_SC_MULTI_PROCESS
 
_SC_MULTI_PROCESS


	)

395 
	m_SC_SINGLE_PROCESS
,

396 
	#_SC_SINGLE_PROCESS
 
_SC_SINGLE_PROCESS


	)

397 
	m_SC_NETWORKING
,

398 
	#_SC_NETWORKING
 
_SC_NETWORKING


	)

399 
	m_SC_READER_WRITER_LOCKS
,

400 
	#_SC_READER_WRITER_LOCKS
 
_SC_READER_WRITER_LOCKS


	)

401 
	m_SC_SPIN_LOCKS
,

402 
	#_SC_SPIN_LOCKS
 
_SC_SPIN_LOCKS


	)

403 
	m_SC_REGEXP
,

404 
	#_SC_REGEXP
 
_SC_REGEXP


	)

405 
	m_SC_REGEX_VERSION
,

406 
	#_SC_REGEX_VERSION
 
_SC_REGEX_VERSION


	)

407 
	m_SC_SHELL
,

408 
	#_SC_SHELL
 
_SC_SHELL


	)

409 
	m_SC_SIGNALS
,

410 
	#_SC_SIGNALS
 
_SC_SIGNALS


	)

411 
	m_SC_SPAWN
,

412 
	#_SC_SPAWN
 
_SC_SPAWN


	)

413 
	m_SC_SPORADIC_SERVER
,

414 
	#_SC_SPORADIC_SERVER
 
_SC_SPORADIC_SERVER


	)

415 
	m_SC_THREAD_SPORADIC_SERVER
,

416 
	#_SC_THREAD_SPORADIC_SERVER
 
_SC_THREAD_SPORADIC_SERVER


	)

417 
	m_SC_SYSTEM_DATABASE
,

418 
	#_SC_SYSTEM_DATABASE
 
_SC_SYSTEM_DATABASE


	)

419 
	m_SC_SYSTEM_DATABASE_R
,

420 
	#_SC_SYSTEM_DATABASE_R
 
_SC_SYSTEM_DATABASE_R


	)

421 
	m_SC_TIMEOUTS
,

422 
	#_SC_TIMEOUTS
 
_SC_TIMEOUTS


	)

423 
	m_SC_TYPED_MEMORY_OBJECTS
,

424 
	#_SC_TYPED_MEMORY_OBJECTS
 
_SC_TYPED_MEMORY_OBJECTS


	)

425 
	m_SC_USER_GROUPS
,

426 
	#_SC_USER_GROUPS
 
_SC_USER_GROUPS


	)

427 
	m_SC_USER_GROUPS_R
,

428 
	#_SC_USER_GROUPS_R
 
_SC_USER_GROUPS_R


	)

429 
	m_SC_2_PBS
,

430 
	#_SC_2_PBS
 
_SC_2_PBS


	)

431 
	m_SC_2_PBS_ACCOUNTING
,

432 
	#_SC_2_PBS_ACCOUNTING
 
_SC_2_PBS_ACCOUNTING


	)

433 
	m_SC_2_PBS_LOCATE
,

434 
	#_SC_2_PBS_LOCATE
 
_SC_2_PBS_LOCATE


	)

435 
	m_SC_2_PBS_MESSAGE
,

436 
	#_SC_2_PBS_MESSAGE
 
_SC_2_PBS_MESSAGE


	)

437 
	m_SC_2_PBS_TRACK
,

438 
	#_SC_2_PBS_TRACK
 
_SC_2_PBS_TRACK


	)

439 
	m_SC_SYMLOOP_MAX
,

440 
	#_SC_SYMLOOP_MAX
 
_SC_SYMLOOP_MAX


	)

441 
	m_SC_STREAMS
,

442 
	#_SC_STREAMS
 
_SC_STREAMS


	)

443 
	m_SC_2_PBS_CHECKPOINT
,

444 
	#_SC_2_PBS_CHECKPOINT
 
_SC_2_PBS_CHECKPOINT


	)

446 
	m_SC_V6_ILP32_OFF32
,

447 
	#_SC_V6_ILP32_OFF32
 
_SC_V6_ILP32_OFF32


	)

448 
	m_SC_V6_ILP32_OFFBIG
,

449 
	#_SC_V6_ILP32_OFFBIG
 
_SC_V6_ILP32_OFFBIG


	)

450 
	m_SC_V6_LP64_OFF64
,

451 
	#_SC_V6_LP64_OFF64
 
_SC_V6_LP64_OFF64


	)

452 
	m_SC_V6_LPBIG_OFFBIG
,

453 
	#_SC_V6_LPBIG_OFFBIG
 
_SC_V6_LPBIG_OFFBIG


	)

455 
	m_SC_HOST_NAME_MAX
,

456 
	#_SC_HOST_NAME_MAX
 
_SC_HOST_NAME_MAX


	)

457 
	m_SC_TRACE
,

458 
	#_SC_TRACE
 
_SC_TRACE


	)

459 
	m_SC_TRACE_EVENT_FILTER
,

460 
	#_SC_TRACE_EVENT_FILTER
 
_SC_TRACE_EVENT_FILTER


	)

461 
	m_SC_TRACE_INHERIT
,

462 
	#_SC_TRACE_INHERIT
 
_SC_TRACE_INHERIT


	)

463 
	m_SC_TRACE_LOG


464 
	#_SC_TRACE_LOG
 
_SC_TRACE_LOG


	)

470 
	m_CS_PATH
,

471 
	#_CS_PATH
 
_CS_PATH


	)

473 
	m_CS_V6_WIDTH_RESTRICTED_ENVS
,

474 
	#_CS_V6_WIDTH_RESTRICTED_ENVS
 
_CS_V6_WIDTH_RESTRICTED_ENVS


	)

476 
	m_CS_GNU_LIBC_VERSION
,

477 
	#_CS_GNU_LIBC_VERSION
 
_CS_GNU_LIBC_VERSION


	)

478 
	m_CS_GNU_LIBPTHREAD_VERSION
,

479 
	#_CS_GNU_LIBPTHREAD_VERSION
 
_CS_GNU_LIBPTHREAD_VERSION


	)

481 
	m_CS_LFS_CFLAGS
 = 1000,

482 
	#_CS_LFS_CFLAGS
 
_CS_LFS_CFLAGS


	)

483 
	m_CS_LFS_LDFLAGS
,

484 
	#_CS_LFS_LDFLAGS
 
_CS_LFS_LDFLAGS


	)

485 
	m_CS_LFS_LIBS
,

486 
	#_CS_LFS_LIBS
 
_CS_LFS_LIBS


	)

487 
	m_CS_LFS_LINTFLAGS
,

488 
	#_CS_LFS_LINTFLAGS
 
_CS_LFS_LINTFLAGS


	)

489 
	m_CS_LFS64_CFLAGS
,

490 
	#_CS_LFS64_CFLAGS
 
_CS_LFS64_CFLAGS


	)

491 
	m_CS_LFS64_LDFLAGS
,

492 
	#_CS_LFS64_LDFLAGS
 
_CS_LFS64_LDFLAGS


	)

493 
	m_CS_LFS64_LIBS
,

494 
	#_CS_LFS64_LIBS
 
_CS_LFS64_LIBS


	)

495 
	m_CS_LFS64_LINTFLAGS
,

496 
	#_CS_LFS64_LINTFLAGS
 
_CS_LFS64_LINTFLAGS


	)

498 
	m_CS_XBS5_ILP32_OFF32_CFLAGS
 = 1100,

499 
	#_CS_XBS5_ILP32_OFF32_CFLAGS
 
_CS_XBS5_ILP32_OFF32_CFLAGS


	)

500 
	m_CS_XBS5_ILP32_OFF32_LDFLAGS
,

501 
	#_CS_XBS5_ILP32_OFF32_LDFLAGS
 
_CS_XBS5_ILP32_OFF32_LDFLAGS


	)

502 
	m_CS_XBS5_ILP32_OFF32_LIBS
,

503 
	#_CS_XBS5_ILP32_OFF32_LIBS
 
_CS_XBS5_ILP32_OFF32_LIBS


	)

504 
	m_CS_XBS5_ILP32_OFF32_LINTFLAGS
,

505 
	#_CS_XBS5_ILP32_OFF32_LINTFLAGS
 
_CS_XBS5_ILP32_OFF32_LINTFLAGS


	)

506 
	m_CS_XBS5_ILP32_OFFBIG_CFLAGS
,

507 
	#_CS_XBS5_ILP32_OFFBIG_CFLAGS
 
_CS_XBS5_ILP32_OFFBIG_CFLAGS


	)

508 
	m_CS_XBS5_ILP32_OFFBIG_LDFLAGS
,

509 
	#_CS_XBS5_ILP32_OFFBIG_LDFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LDFLAGS


	)

510 
	m_CS_XBS5_ILP32_OFFBIG_LIBS
,

511 
	#_CS_XBS5_ILP32_OFFBIG_LIBS
 
_CS_XBS5_ILP32_OFFBIG_LIBS


	)

512 
	m_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
,

513 
	#_CS_XBS5_ILP32_OFFBIG_LINTFLAGS
 
_CS_XBS5_ILP32_OFFBIG_LINTFLAGS


	)

514 
	m_CS_XBS5_LP64_OFF64_CFLAGS
,

515 
	#_CS_XBS5_LP64_OFF64_CFLAGS
 
_CS_XBS5_LP64_OFF64_CFLAGS


	)

516 
	m_CS_XBS5_LP64_OFF64_LDFLAGS
,

517 
	#_CS_XBS5_LP64_OFF64_LDFLAGS
 
_CS_XBS5_LP64_OFF64_LDFLAGS


	)

518 
	m_CS_XBS5_LP64_OFF64_LIBS
,

519 
	#_CS_XBS5_LP64_OFF64_LIBS
 
_CS_XBS5_LP64_OFF64_LIBS


	)

520 
	m_CS_XBS5_LP64_OFF64_LINTFLAGS
,

521 
	#_CS_XBS5_LP64_OFF64_LINTFLAGS
 
_CS_XBS5_LP64_OFF64_LINTFLAGS


	)

522 
	m_CS_XBS5_LPBIG_OFFBIG_CFLAGS
,

523 
	#_CS_XBS5_LPBIG_OFFBIG_CFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_CFLAGS


	)

524 
	m_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
,

525 
	#_CS_XBS5_LPBIG_OFFBIG_LDFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LDFLAGS


	)

526 
	m_CS_XBS5_LPBIG_OFFBIG_LIBS
,

527 
	#_CS_XBS5_LPBIG_OFFBIG_LIBS
 
_CS_XBS5_LPBIG_OFFBIG_LIBS


	)

528 
	m_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
,

529 
	#_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS
 
_CS_XBS5_LPBIG_OFFBIG_LINTFLAGS


	)

531 
	m_CS_POSIX_V6_ILP32_OFF32_CFLAGS
,

532 
	#_CS_POSIX_V6_ILP32_OFF32_CFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_CFLAGS


	)

533 
	m_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
,

534 
	#_CS_POSIX_V6_ILP32_OFF32_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LDFLAGS


	)

535 
	m_CS_POSIX_V6_ILP32_OFF32_LIBS
,

536 
	#_CS_POSIX_V6_ILP32_OFF32_LIBS
 
_CS_POSIX_V6_ILP32_OFF32_LIBS


	)

537 
	m_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
,

538 
	#_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFF32_LINTFLAGS


	)

539 
	m_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
,

540 
	#_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_CFLAGS


	)

541 
	m_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
,

542 
	#_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LDFLAGS


	)

543 
	m_CS_POSIX_V6_ILP32_OFFBIG_LIBS
,

544 
	#_CS_POSIX_V6_ILP32_OFFBIG_LIBS
 
_CS_POSIX_V6_ILP32_OFFBIG_LIBS


	)

545 
	m_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
,

546 
	#_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_ILP32_OFFBIG_LINTFLAGS


	)

547 
	m_CS_POSIX_V6_LP64_OFF64_CFLAGS
,

548 
	#_CS_POSIX_V6_LP64_OFF64_CFLAGS
 
_CS_POSIX_V6_LP64_OFF64_CFLAGS


	)

549 
	m_CS_POSIX_V6_LP64_OFF64_LDFLAGS
,

550 
	#_CS_POSIX_V6_LP64_OFF64_LDFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LDFLAGS


	)

551 
	m_CS_POSIX_V6_LP64_OFF64_LIBS
,

552 
	#_CS_POSIX_V6_LP64_OFF64_LIBS
 
_CS_POSIX_V6_LP64_OFF64_LIBS


	)

553 
	m_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
,

554 
	#_CS_POSIX_V6_LP64_OFF64_LINTFLAGS
 
_CS_POSIX_V6_LP64_OFF64_LINTFLAGS


	)

555 
	m_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
,

556 
	#_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_CFLAGS


	)

557 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
,

558 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LDFLAGS


	)

559 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
,

560 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LIBS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LIBS


	)

561 
	m_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


562 
	#_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS
 
_CS_POSIX_V6_LPBIG_OFFBIG_LINTFLAGS


	)

	@/usr/include/bits/dirent.h

19 #i‚de‡
_DIRENT_H


23 
	sdúít


25 #i‚de‡
__USE_FILE_OFFSET64


26 
__öo_t
 
	md_öo
;

27 
__off_t
 
	md_off
;

29 
__öo64_t
 
	md_öo
;

30 
__off64_t
 
	md_off
;

32 
	md_ª˛í
;

33 
	md_ty≥
;

34 
	md_«me
[256];

37 #ifde‡
__USE_LARGEFILE64


38 
	sdúít64


40 
__öo64_t
 
	md_öo
;

41 
__off64_t
 
	md_off
;

42 
	md_ª˛í
;

43 
	md_ty≥
;

44 
	md_«me
[256];

48 
	#d_fûío
 
d_öo


	)

50 #unde‡
_DIRENT_HAVE_D_NAMLEN


51 
	#_DIRENT_HAVE_D_RECLEN


	)

52 
	#_DIRENT_HAVE_D_OFF


	)

53 
	#_DIRENT_HAVE_D_TYPE


	)

	@/usr/include/bits/endian.h

3 #i‚de‡
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/environments.h

19 #i‚de‡
_UNISTD_H


23 
	~<bôs/w‹dsize.h
>

41 #i‡
__WORDSIZE
 == 64

44 
	#_POSIX_V6_ILP32_OFF32
 -1

	)

45 
	#_POSIX_V6_ILP32_OFFBIG
 -1

	)

46 
	#_XBS5_ILP32_OFF32
 -1

	)

47 
	#_XBS5_ILP32_OFFBIG
 -1

	)

50 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

51 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

54 
	#_POSIX_V6_LP64_OFF64
 1

	)

55 
	#_XBS5_LP64_OFF64
 1

	)

61 
	#_POSIX_V6_ILP32_OFF32
 1

	)

62 
	#_POSIX_V6_ILP32_OFFBIG
 1

	)

63 
	#_XBS5_ILP32_OFF32
 1

	)

64 
	#_XBS5_ILP32_OFFBIG
 1

	)

70 
	#_POSIX_V6_LP64_OFF64
 -1

	)

71 
	#_POSIX_V6_LPBIG_OFFBIG
 -1

	)

72 
	#_XBS5_LP64_OFF64
 -1

	)

73 
	#_XBS5_LPBIG_OFFBIG
 -1

	)

	@/usr/include/bits/errno.h

20 #ifde‡
_ERRNO_H


22 #unde‡
EDOM


23 #unde‡
EILSEQ


24 #unde‡
ERANGE


25 
	~<löux/î∫o.h
>

28 
	#ENOTSUP
 
EOPNOTSUPP


	)

32 #i‚de‡
ECANCELED


33 
	#ECANCELED
 125

	)

36 #i‚de‡
__ASSEMBLER__


38 *
	$__î∫o_loˇti⁄
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

40 #i‡!
deföed
 
_LIBC
 || deföed 
_LIBC_REENTRANT


42 
	#î∫o
 (*
	`__î∫o_loˇti⁄
 ())

	)

47 #i‡!
deföed
 
_ERRNO_H
 && deföed 
__√ed_Em©h


51 
	#EDOM
 33

	)

52 
	#EILSEQ
 84

	)

53 
	#ERANGE
 34

	)

	@/usr/include/bits/fcntl.h

20 #i‚def 
_FCNTL_H


25 
	~<sys/ty≥s.h
>

29 
	#O_ACCMODE
 0003

	)

30 
	#O_RDONLY
 00

	)

31 
	#O_WRONLY
 01

	)

32 
	#O_RDWR
 02

	)

33 
	#O_CREAT
 0100

	)

34 
	#O_EXCL
 0200

	)

35 
	#O_NOCTTY
 0400

	)

36 
	#O_TRUNC
 01000

	)

37 
	#O_APPEND
 02000

	)

38 
	#O_NONBLOCK
 04000

	)

39 
	#O_NDELAY
 
O_NONBLOCK


	)

40 
	#O_SYNC
 010000

	)

41 
	#O_FSYNC
 
O_SYNC


	)

42 
	#O_ASYNC
 020000

	)

44 #ifde‡
__USE_GNU


45 
	#O_DIRECT
 040000

	)

46 
	#O_DIRECTORY
 0200000

	)

47 
	#O_NOFOLLOW
 0400000

	)

53 #i‡
deföed
 
__USE_POSIX199309
 || deföed 
__USE_UNIX98


54 
	#O_DSYNC
 
O_SYNC


	)

55 
	#O_RSYNC
 
O_SYNC


	)

58 #ifde‡
__USE_LARGEFILE64


59 
	#O_LARGEFILE
 0100000

	)

63 
	#F_DUPFD
 0

	)

64 
	#F_GETFD
 1

	)

65 
	#F_SETFD
 2

	)

66 
	#F_GETFL
 3

	)

67 
	#F_SETFL
 4

	)

68 #i‚de‡
__USE_FILE_OFFSET64


69 
	#F_GETLK
 5

	)

70 
	#F_SETLK
 6

	)

71 
	#F_SETLKW
 7

	)

73 
	#F_GETLK
 
F_GETLK64


	)

74 
	#F_SETLK
 
F_SETLK64


	)

75 
	#F_SETLKW
 
F_SETLKW64


	)

77 
	#F_GETLK64
 12

	)

78 
	#F_SETLK64
 13

	)

79 
	#F_SETLKW64
 14

	)

81 #i‡
deföed
 
__USE_BSD
 || deföed 
__USE_XOPEN2K


82 
	#F_SETOWN
 8

	)

83 
	#F_GETOWN
 9

	)

86 #ifde‡
__USE_GNU


87 
	#F_SETSIG
 10

	)

88 
	#F_GETSIG
 11

	)

91 #ifde‡
__USE_GNU


92 
	#F_SETLEASE
 1024

	)

93 
	#F_GETLEASE
 1025

	)

94 
	#F_NOTIFY
 1026

	)

98 
	#FD_CLOEXEC
 1

	)

101 
	#F_RDLCK
 0

	)

102 
	#F_WRLCK
 1

	)

103 
	#F_UNLCK
 2

	)

106 
	#F_EXLCK
 4

	)

107 
	#F_SHLCK
 8

	)

109 #ifde‡
__USE_BSD


111 
	#LOCK_SH
 1

	)

112 
	#LOCK_EX
 2

	)

113 
	#LOCK_NB
 4

	)

115 
	#LOCK_UN
 8

	)

118 #ifde‡
__USE_GNU


119 
	#LOCK_MAND
 32

	)

120 
	#LOCK_READ
 64

	)

121 
	#LOCK_WRITE
 128

	)

122 
	#LOCK_RW
 192

	)

125 #ifde‡
__USE_GNU


127 
	#DN_ACCESS
 0x00000001

	)

128 
	#DN_MODIFY
 0x00000002

	)

129 
	#DN_CREATE
 0x00000004

	)

130 
	#DN_DELETE
 0x00000008

	)

131 
	#DN_RENAME
 0x00000010

	)

132 
	#DN_ATTRIB
 0x00000020

	)

133 
	#DN_MULTISHOT
 0x80000000

	)

136 
	sÊock


138 
	ml_ty≥
;

139 
	ml_whí˚
;

140 #i‚de‡
__USE_FILE_OFFSET64


141 
__off_t
 
	ml_°¨t
;

142 
__off_t
 
	ml_Àn
;

144 
__off64_t
 
	ml_°¨t
;

145 
__off64_t
 
	ml_Àn
;

147 
__pid_t
 
	ml_pid
;

150 #ifde‡
__USE_LARGEFILE64


151 
	sÊock64


153 
	ml_ty≥
;

154 
	ml_whí˚
;

155 
__off64_t
 
	ml_°¨t
;

156 
__off64_t
 
	ml_Àn
;

157 
__pid_t
 
	ml_pid
;

163 #ifdef 
__USE_BSD


164 
	#FAPPEND
 
O_APPEND


	)

165 
	#FFSYNC
 
O_FSYNC


	)

166 
	#FASYNC
 
O_ASYNC


	)

167 
	#FNONBLOCK
 
O_NONBLOCK


	)

168 
	#FNDELAY
 
O_NDELAY


	)

172 #ifde‡
__USE_XOPEN2K


173 
	#POSIX_FADV_NORMAL
 0

	)

174 
	#POSIX_FADV_RANDOM
 1

	)

175 
	#POSIX_FADV_SEQUENTIAL
 2

	)

176 
	#POSIX_FADV_WILLNEED
 3

	)

177 
	#POSIX_FADV_DONTNEED
 4

	)

178 
	#POSIX_FADV_NOREUSE
 5

	)

	@/usr/include/bits/huge_val.h

21 #i‚de‡
_MATH_H


25 
	~<„©uªs.h
>

29 #i‡
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VAL
 (
__exãnsi⁄__
 0x1.0
p2047
)

	)

32 
	#__HUGE_VAL_byãs
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7‡}

	)

34 
	#__huge_vÆ_t
 uni⁄ { 
__c
[8]; 
__d
; }

	)

35 #ifdef 
__GNUC__


36 
	#HUGE_VAL
 (
__exãnsi⁄__
 \

37 ((
__huge_vÆ_t
Ë{ 
__c
: 
__HUGE_VAL_byãs
 }).
__d
)

	)

39 
__huge_vÆ_t
 
	g__huge_vÆ
 = { 
__HUGE_VAL_byãs
 };

40 
	#HUGE_VAL
 (
__huge_vÆ
.
__d
)

	)

47 #ifde‡
__USE_ISOC99


49 #i‡
__GNUC_PREREQ
(2,96)

51 
	#HUGE_VALF
 (
__exãnsi⁄__
 0x1.0
p255f
)

	)

52 
	#HUGE_VALL
 (
__exãnsi⁄__
 0x1.0
p32767L
)

	)

56 
	#__HUGE_VALF_byãs
 { 0, 0, 0x80, 0x7‡}

	)

58 
	#__huge_vÆf_t
 uni⁄ { 
__c
[4]; 
__f
; }

	)

59 #ifdef 
__GNUC__


60 
	#HUGE_VALF
 (
__exãnsi⁄__
 \

61 ((
__huge_vÆf_t
Ë{ 
__c
: 
__HUGE_VALF_byãs
 }).
__f
)

	)

63 
__huge_vÆf_t
 
	g__huge_vÆf
 = { 
__HUGE_VALF_byãs
 };

64 
	#HUGE_VALF
 (
__huge_vÆf
.
__f
)

	)

68 
	#__HUGE_VALL_byãs
 { 0, 0, 0, 0, 0, 0, 0, 0x80, 0xff, 0x7f, 0, 0 }

	)

70 
	#__huge_vÆl_t
 uni⁄ { 
__c
[12]; 
__ld
; }

	)

71 #ifde‡
__GNUC__


72 
	#HUGE_VALL
 (
__exãnsi⁄__
 \

73 ((
__huge_vÆl_t
Ë{ 
__c
: 
__HUGE_VALL_byãs
 }).
__ld
)

	)

75 
__huge_vÆl_t
 
	g__huge_vÆl
 = { 
__HUGE_VALL_byãs
 };

76 
	#HUGE_VALL
 (
__huge_vÆl
.
__ld
)

	)

	@/usr/include/bits/in.h

21 #i‚de‡
_NETINET_IN_H


28 
	#IP_TOS
 1

	)

29 
	#IP_TTL
 2

	)

30 
	#IP_HDRINCL
 3

	)

31 
	#IP_OPTIONS
 4

	)

32 
	#IP_ROUTER_ALERT
 5

	)

33 
	#IP_RECVOPTS
 6

	)

34 
	#IP_RETOPTS
 7

	)

35 
	#IP_PKTINFO
 8

	)

36 
	#IP_PKTOPTIONS
 9

	)

37 
	#IP_PMTUDISC
 10

	)

38 
	#IP_MTU_DISCOVER
 10

	)

39 
	#IP_RECVERR
 11

	)

40 
	#IP_RECVTTL
 12

	)

41 
	#IP_RECVTOS
 13

	)

42 
	#IP_MULTICAST_IF
 32

	)

43 
	#IP_MULTICAST_TTL
 33

	)

44 
	#IP_MULTICAST_LOOP
 34

	)

45 
	#IP_ADD_MEMBERSHIP
 35

	)

46 
	#IP_DROP_MEMBERSHIP
 36

	)

49 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

52 
	#IP_PMTUDISC_DONT
 0

	)

53 
	#IP_PMTUDISC_WANT
 1

	)

54 
	#IP_PMTUDISC_DO
 2

	)

57 
	#SOL_IP
 0

	)

59 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

60 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

61 
	#IP_MAX_MEMBERSHIPS
 20

	)

66 
	sù_›ts


68 
ö_addr
 
	mù_d°
;

69 
	mù_›ts
[40];

73 
	sù_mªq


75 
ö_addr
 
	mimr_mu…üddr
;

76 
ö_addr
 
	mimr_öãrÁ˚
;

80 
	sù_mªqn


82 
ö_addr
 
	mimr_mu…üddr
;

83 
ö_addr
 
	mimr_addªss
;

84 
	mimr_ifödex
;

88 
	sö_pktöfo


90 
	mùi_ifödex
;

91 
ö_addr
 
	mùi_•ec_d°
;

92 
ö_addr
 
	mùi_addr
;

98 
	#IPV6_ADDRFORM
 1

	)

99 
	#IPV6_PKTINFO
 2

	)

100 
	#IPV6_HOPOPTS
 3

	)

101 
	#IPV6_DSTOPTS
 4

	)

102 
	#IPV6_RTHDR
 5

	)

103 
	#IPV6_PKTOPTIONS
 6

	)

104 
	#IPV6_CHECKSUM
 7

	)

105 
	#IPV6_HOPLIMIT
 8

	)

106 
	#IPV6_NEXTHOP
 9

	)

107 
	#IPV6_AUTHHDR
 10

	)

108 
	#IPV6_UNICAST_HOPS
 16

	)

109 
	#IPV6_MULTICAST_IF
 17

	)

110 
	#IPV6_MULTICAST_HOPS
 18

	)

111 
	#IPV6_MULTICAST_LOOP
 19

	)

112 
	#IPV6_JOIN_GROUP
 20

	)

113 
	#IPV6_LEAVE_GROUP
 21

	)

114 
	#IPV6_ROUTER_ALERT
 22

	)

115 
	#IPV6_MTU_DISCOVER
 23

	)

116 
	#IPV6_MTU
 24

	)

117 
	#IPV6_RECVERR
 25

	)

118 
	#IPV6_V6ONLY
 26

	)

119 
	#IPV6_JOIN_ANYCAST
 27

	)

120 
	#IPV6_LEAVE_ANYCAST
 28

	)

121 
	#IPV6_IPSEC_POLICY
 34

	)

122 
	#IPV6_XFRM_POLICY
 35

	)

124 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

127 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

128 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

129 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

130 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

134 
	#IPV6_PMTUDISC_DONT
 0

	)

135 
	#IPV6_PMTUDISC_WANT
 1

	)

136 
	#IPV6_PMTUDISC_DO
 2

	)

139 
	#SOL_IPV6
 41

	)

140 
	#SOL_ICMPV6
 58

	)

143 
	#IPV6_RTHDR_LOOSE
 0

	)

144 
	#IPV6_RTHDR_STRICT
 1

	)

146 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/initspin.h

23 
	#__LT_SPINLOCK_INIT
 0

	)

26 
	#__LOCK_INITIALIZER
 { 0, 
__LT_SPINLOCK_INIT
 }

	)

27 
	#__ALT_LOCK_INITIALIZER
 { 0, 
__LT_SPINLOCK_INIT
 }

	)

28 
	#__ATOMIC_INITIALIZER
 { 0, 
__LT_SPINLOCK_INIT
 }

	)

	@/usr/include/bits/ioctl-types.h

20 #i‚de‡
_SYS_IOCTL_H


25 
	~<asm/io˘ls.h
>

28 
	swösize


30 
	mws_row
;

31 
	mws_cﬁ
;

32 
	mws_xpixñ
;

33 
	mws_ypixñ
;

36 
	#NCC
 8

	)

37 
	sãrmio


39 
	mc_iÊag
;

40 
	mc_oÊag
;

41 
	mc_cÊag
;

42 
	mc_lÊag
;

43 
	mc_löe
;

44 
	mc_cc
[
NCC
];

48 
	#TIOCM_LE
 0x001

	)

49 
	#TIOCM_DTR
 0x002

	)

50 
	#TIOCM_RTS
 0x004

	)

51 
	#TIOCM_ST
 0x008

	)

52 
	#TIOCM_SR
 0x010

	)

53 
	#TIOCM_CTS
 0x020

	)

54 
	#TIOCM_CAR
 0x040

	)

55 
	#TIOCM_RNG
 0x080

	)

56 
	#TIOCM_DSR
 0x100

	)

57 
	#TIOCM_CD
 
TIOCM_CAR


	)

58 
	#TIOCM_RI
 
TIOCM_RNG


	)

63 
	#N_TTY
 0

	)

64 
	#N_SLIP
 1

	)

65 
	#N_MOUSE
 2

	)

66 
	#N_PPP
 3

	)

67 
	#N_STRIP
 4

	)

68 
	#N_AX25
 5

	)

69 
	#N_X25
 6

	)

70 
	#N_6PACK
 7

	)

71 
	#N_MASC
 8

	)

72 
	#N_R3964
 9

	)

73 
	#N_PROFIBUS_FDL
 10

	)

74 
	#N_IRDA
 11

	)

75 
	#N_SMSBLOCK
 12

	)

76 
	#N_HDLC
 13

	)

77 
	#N_SYNC_PPP
 14

	)

78 
	#N_HCI
 15

	)

	@/usr/include/bits/ioctls.h

19 #i‚de‡
_SYS_IOCTL_H


24 
	~<asm/io˘ls.h
>

27 
	#SIOCADDRT
 0x890B

	)

28 
	#SIOCDELRT
 0x890C

	)

29 
	#SIOCRTMSG
 0x890D

	)

32 
	#SIOCGIFNAME
 0x8910

	)

33 
	#SIOCSIFLINK
 0x8911

	)

34 
	#SIOCGIFCONF
 0x8912

	)

35 
	#SIOCGIFFLAGS
 0x8913

	)

36 
	#SIOCSIFFLAGS
 0x8914

	)

37 
	#SIOCGIFADDR
 0x8915

	)

38 
	#SIOCSIFADDR
 0x8916

	)

39 
	#SIOCGIFDSTADDR
 0x8917

	)

40 
	#SIOCSIFDSTADDR
 0x8918

	)

41 
	#SIOCGIFBRDADDR
 0x8919

	)

42 
	#SIOCSIFBRDADDR
 0x891®

	)

43 
	#SIOCGIFNETMASK
 0x891b

	)

44 
	#SIOCSIFNETMASK
 0x891¯

	)

45 
	#SIOCGIFMETRIC
 0x891d

	)

46 
	#SIOCSIFMETRIC
 0x891ê

	)

47 
	#SIOCGIFMEM
 0x891‡

	)

48 
	#SIOCSIFMEM
 0x8920

	)

49 
	#SIOCGIFMTU
 0x8921

	)

50 
	#SIOCSIFMTU
 0x8922

	)

51 
	#SIOCSIFNAME
 0x8923

	)

52 
	#SIOCSIFHWADDR
 0x8924

	)

53 
	#SIOCGIFENCAP
 0x8925

	)

54 
	#SIOCSIFENCAP
 0x8926

	)

55 
	#SIOCGIFHWADDR
 0x8927

	)

56 
	#SIOCGIFSLAVE
 0x8929

	)

57 
	#SIOCSIFSLAVE
 0x8930

	)

58 
	#SIOCADDMULTI
 0x8931

	)

59 
	#SIOCDELMULTI
 0x8932

	)

60 
	#SIOCGIFINDEX
 0x8933

	)

61 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

62 
	#SIOCSIFPFLAGS
 0x8934

	)

63 
	#SIOCGIFPFLAGS
 0x8935

	)

64 
	#SIOCDIFADDR
 0x8936

	)

65 
	#SIOCSIFHWBROADCAST
 0x8937

	)

66 
	#SIOCGIFCOUNT
 0x8938

	)

68 
	#SIOCGIFBR
 0x8940

	)

69 
	#SIOCSIFBR
 0x8941

	)

71 
	#SIOCGIFTXQLEN
 0x8942

	)

72 
	#SIOCSIFTXQLEN
 0x8943

	)

77 
	#SIOCDARP
 0x8953

	)

78 
	#SIOCGARP
 0x8954

	)

79 
	#SIOCSARP
 0x8955

	)

82 
	#SIOCDRARP
 0x8960

	)

83 
	#SIOCGRARP
 0x8961

	)

84 
	#SIOCSRARP
 0x8962

	)

88 
	#SIOCGIFMAP
 0x8970

	)

89 
	#SIOCSIFMAP
 0x8971

	)

93 
	#SIOCADDDLCI
 0x8980

	)

94 
	#SIOCDELDLCI
 0x8981

	)

103 
	#SIOCDEVPRIVATE
 0x89F0

	)

109 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/bits/ipc.h

19 #i‚de‡
_SYS_IPC_H


23 
	~<bôs/ty≥s.h
>

26 
	#IPC_CREAT
 01000

	)

27 
	#IPC_EXCL
 02000

	)

28 
	#IPC_NOWAIT
 04000

	)

31 
	#IPC_RMID
 0

	)

32 
	#IPC_SET
 1

	)

33 
	#IPC_STAT
 2

	)

34 #ifde‡
__USE_GNU


35 
	#IPC_INFO
 3

	)

39 
	#IPC_PRIVATE
 ((
__key_t
Ë0Ë

	)

43 
	sùc_≥rm


45 
__key_t
 
	m__key
;

46 
__uid_t
 
	muid
;

47 
__gid_t
 
	mgid
;

48 
__uid_t
 
	mcuid
;

49 
__gid_t
 
	mcgid
;

50 
	mmode
;

51 
	m__∑d1
;

52 
	m__£q
;

53 
	m__∑d2
;

54 
	m__unu£d1
;

55 
	m__unu£d2
;

	@/usr/include/bits/ipctypes.h

24 #i‚de‡
_BITS_IPCTYPES_H


25 
	#_BITS_IPCTYPES_H
 1

	)

27 
	~<bôs/ty≥s.h
>

30 #i‡
__WORDSIZE
 == 32

31 
	t__ùc_pid_t
;

33 
	t__ùc_pid_t
;

	@/usr/include/bits/locale.h

20 #i‡!
deföed
 
_LOCALE_H
 && !deföed 
_LANGINFO_H


24 #i‚de‡
_BITS_LOCALE_H


25 
	#_BITS_LOCALE_H
 1

	)

29 
	m__LC_CTYPE
 = 0,

30 
	m__LC_NUMERIC
 = 1,

31 
	m__LC_TIME
 = 2,

32 
	m__LC_COLLATE
 = 3,

33 
	m__LC_MONETARY
 = 4,

34 
	m__LC_MESSAGES
 = 5,

35 
	m__LC_ALL
 = 6,

36 
	m__LC_PAPER
 = 7,

37 
	m__LC_NAME
 = 8,

38 
	m__LC_ADDRESS
 = 9,

39 
	m__LC_TELEPHONE
 = 10,

40 
	m__LC_MEASUREMENT
 = 11,

41 
	m__LC_IDENTIFICATION
 = 12

	@/usr/include/bits/mathcalls.h

46 #i‚de‡
_MATH_H


53 
_MdoubÀ_BEGIN_NAMESPACE


55 
__MATHCALL
 (
acos
,, (
_MdoubÀ_
 
__x
));

57 
__MATHCALL
 (
asö
,, (
_MdoubÀ_
 
__x
));

59 
__MATHCALL
 (
©™
,, (
_MdoubÀ_
 
__x
));

61 
__MATHCALL
 (
©™2
,, (
_MdoubÀ_
 
__y
, _MdoubÀ_ 
__x
));

64 
__MATHCALL
 (
cos
,, (
_MdoubÀ_
 
__x
));

66 
__MATHCALL
 (
sö
,, (
_MdoubÀ_
 
__x
));

68 
__MATHCALL
 (
èn
,, (
_MdoubÀ_
 
__x
));

73 
__MATHCALL
 (
cosh
,, (
_MdoubÀ_
 
__x
));

75 
__MATHCALL
 (
söh
,, (
_MdoubÀ_
 
__x
));

77 
__MATHCALL
 (
ènh
,, (
_MdoubÀ_
 
__x
));

78 
	g_MdoubÀ_END_NAMESPACE


80 #ifde‡
__USE_GNU


82 
__MATHDECL
 (,
söcos
,,

83 (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__söx
, _MdoubÀ_ *
__cosx
));

86 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


87 
__BEGIN_NAMESPACE_C99


89 
__MATHCALL
 (
acosh
,, (
_MdoubÀ_
 
__x
));

91 
__MATHCALL
 (
asöh
,, (
_MdoubÀ_
 
__x
));

93 
__MATHCALL
 (
©™h
,, (
_MdoubÀ_
 
__x
));

94 
	g__END_NAMESPACE_C99


99 
_MdoubÀ_BEGIN_NAMESPACE


101 
__MATHCALL
 (
exp
,, (
_MdoubÀ_
 
__x
));

104 
__MATHCALL
 (
‰exp
,, (
_MdoubÀ_
 
__x
, *
__exp⁄ít
));

107 
__MATHCALL
 (
ldexp
,, (
_MdoubÀ_
 
__x
, 
__exp⁄ít
));

110 
__MATHCALL
 (
log
,, (
_MdoubÀ_
 
__x
));

113 
__MATHCALL
 (
log10
,, (
_MdoubÀ_
 
__x
));

116 
__MATHCALL
 (
modf
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ *
__ùå
));

117 
	g_MdoubÀ_END_NAMESPACE


119 #ifde‡
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_MdoubÀ_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_MdoubÀ_
 
__x
));

126 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_MdoubÀ_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_MdoubÀ_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_MdoubÀ_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifde‡
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_MdoubÀ_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_MdoubÀ_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_MdoubÀ_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

157 
__MATHCALL
 (
sqπ
,, (
_MdoubÀ_
 
__x
));

158 
	g_MdoubÀ_END_NAMESPACE


160 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hypŸ
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cbπ
,, (
_MdoubÀ_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_MdoubÀ_BEGIN_NAMESPACE


179 
__MATHCALLX
 (
˚û
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

182 
__MATHCALLX
 (
Ábs
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

185 
__MATHCALLX
 (
Êo‹
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

188 
__MATHCALL
 (
fmod
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

193 
__MATHDECL_1
 (,
__isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

196 
__MATHDECL_1
 (,
__föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

197 
	g_MdoubÀ_END_NAMESPACE


199 #ifde‡
__USE_MISC


202 
__MATHDECL_1
 (,
isöf
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

205 
__MATHDECL_1
 (,
föôe
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

208 
__MATHCALL
 (
dªm
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

212 
__MATHCALL
 (
signifiˇnd
,, (
_MdoubÀ_
 
__x
));

215 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
c›ysign
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

219 
	g__END_NAMESPACE_C99


222 #ifde‡
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
«n
,, (
__c⁄°
 *
__ègb
), (
__c⁄°__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

233 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i¢™
,, (
_MdoubÀ_
 
__vÆue
)Ë
__©åibuã__
 ((
__c⁄°__
));

238 
__MATHCALL
 (
j0
,, (
_MdoubÀ_
));

239 
__MATHCALL
 (
j1
,, (
_MdoubÀ_
));

240 
__MATHCALL
 (
jn
,, (, 
_MdoubÀ_
));

241 
__MATHCALL
 (
y0
,, (
_MdoubÀ_
));

242 
__MATHCALL
 (
y1
,, (
_MdoubÀ_
));

243 
__MATHCALL
 (
yn
,, (, 
_MdoubÀ_
));

247 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN
 || deföed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
îf
,, (
_MdoubÀ_
));

251 
__MATHCALL
 (
îfc
,, (
_MdoubÀ_
));

252 
__MATHCALL
 (
lgamma
,, (
_MdoubÀ_
));

253 
	g__END_NAMESPACE_C99


256 #ifde‡
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_MdoubÀ_
));

260 
	g__END_NAMESPACE_C99


263 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_MdoubÀ_
));

268 #ifde‡
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_MdoubÀ_
, *
__signgamp
));

276 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED
 || deföed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
röt
,, (
_MdoubÀ_
 
__x
));

283 
__MATHCALLX
 (
√xè·î
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
), (
__c⁄°__
));

284 #ifde‡
__USE_ISOC99


285 
__MATHCALLX
 (
√xâow¨d
,, (
_MdoubÀ_
 
__x
, 
__y
), (
__c⁄°__
));

289 
__MATHCALL
 (
ªmaödî
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

291 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


293 
__MATHCALL
 (
sˇlbn
,, (
_MdoubÀ_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ûogb
,, (
_MdoubÀ_
 
__x
));

300 #ifde‡
__USE_ISOC99


302 
__MATHCALL
 (
sˇlb 
,, (
_MdoubÀ_
 
__x
, 
__n
));

306 
__MATHCALL
 (
√¨byöt
,, (
_MdoubÀ_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

314 
__MATHCALLX
 (
åunc
,, (
_MdoubÀ_
 
__x
), (
__c⁄°__
));

319 
__MATHCALL
 (
ªmquo
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
Ãöt
,, (
_MdoubÀ_
 
__x
));

327 
__MATHDECL
 (,
Œröt
,, (
_MdoubÀ_
 
__x
));

331 
__MATHDECL
 (,
Ãound
,, (
_MdoubÀ_
 
__x
));

332 
__MATHDECL
 (,
Œround
,, (
_MdoubÀ_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

339 
__MATHCALL
 (
fmax
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

342 
__MATHCALL
 (
fmö
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
));

346 
__MATHDECL_1
 (, 
__Â˛assify
,, (
_MdoubÀ_
 
__vÆue
))

347 
__©åibuã__
 ((
__c⁄°__
));

350 
__MATHDECL_1
 (, 
__signbô
,, (
_MdoubÀ_
 
__vÆue
))

351 
__©åibuã__
 ((
__c⁄°__
));

355 
__MATHCALL
 (
fma
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__y
, _MdoubÀ_ 
__z
));

356 
	g__END_NAMESPACE_C99


358 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN_EXTENDED


360 
__MATHCALL
 (
sˇlb
,, (
_MdoubÀ_
 
__x
, _MdoubÀ_ 
__n
));

	@/usr/include/bits/mathdef.h

19 #i‡!
deföed
 
_MATH_H
 && !deföed 
_COMPLEX_H


23 #i‡
deföed
 
__USE_ISOC99
 && deföed 
_MATH_H
 && !deföed 
_MATH_H_MATHDEF


24 
	#_MATH_H_MATHDEF
 1

	)

29 
	tÊﬂt_t
;

31 
	tdoubÀ_t
;

35 
	#INFINITY
 
HUGE_VALF


	)

38 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

39 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

	@/usr/include/bits/mathinline.h

21 #i‚de‡
_MATH_H


25 #ifde‡
__˝lu•lus


26 
	#__MATH_INLINE
 
__ölöe


	)

28 
	#__MATH_INLINE
 
__ölöe


	)

32 #i‡
deföed
 
__USE_ISOC99
 && deföed 
__GNUC__
 && __GNUC__ >= 2

33 #i‡
__GNUC_PREREQ
 (2,97)

35 
	#isgª©î
(
x
, 
y
Ë
	`__buûtö_isgª©î
 (x, y)

	)

36 
	#isgª©îequÆ
(
x
, 
y
Ë
	`__buûtö_isgª©îequÆ
 (x, y)

	)

37 
	#i¶ess
(
x
, 
y
Ë
	`__buûtö_i¶ess
 (x, y)

	)

38 
	#i¶es£quÆ
(
x
, 
y
Ë
	`__buûtö_i¶es£quÆ
 (x, y)

	)

39 
	#i¶essgª©î
(
x
, 
y
Ë
	`__buûtö_i¶essgª©î
 (x, y)

	)

40 
	#isun‹dîed
(
x
, 
y
Ë
	`__buûtö_isun‹dîed
 (x, y)

	)

46 #ifde‡
__i686__


49 
	#isgª©î
(
x
, 
y
) \

50 ({ 
__ªsu…
; \

51 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

52 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

53 
__ªsu…
; })

	)

54 
	#isgª©îequÆ
(
x
, 
y
) \

55 ({ 
__ªsu…
; \

56 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

57 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

58 
__ªsu…
; })

	)

60 
	#i¶ess
(
x
, 
y
) \

61 ({ 
__ªsu…
; \

62 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

63 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

64 
__ªsu…
; })

	)

66 
	#i¶es£quÆ
(
x
, 
y
) \

67 ({ 
__ªsu…
; \

68 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

69 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st"); \

70 
__ªsu…
; })

	)

72 
	#i¶essgª©î
(
x
, 
y
) \

73 ({ 
__ªsu…
; \

74 
	`__asm__
 ("fucomip %%st(1), %%st; setne %%al" \

75 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

76 
__ªsu…
; })

	)

78 
	#isun‹dîed
(
x
, 
y
) \

79 ({ 
__ªsu…
; \

80 
	`__asm__
 ("fucomip %%st(1), %%st; setp %%al" \

81 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st"); \

82 
__ªsu…
; })

	)

85 
	#isgª©î
(
x
, 
y
) \

86 ({ 
__ªsu…
; \

87 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

88 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

89 
__ªsu…
; })

	)

91 
	#isgª©îequÆ
(
x
, 
y
) \

92 ({ 
__ªsu…
; \

93 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

94 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

95 
__ªsu…
; })

	)

97 
	#i¶ess
(
x
, 
y
) \

98 ({ 
__ªsu…
; \

99 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x45, %%ah; setz %%al" \

100 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

101 
__ªsu…
; })

	)

103 
	#i¶es£quÆ
(
x
, 
y
) \

104 ({ 
__ªsu…
; \

105 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x05, %%ah; setz %%al" \

106 : "˜" (
__ªsu…
Ë: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

107 
__ªsu…
; })

	)

109 
	#i¶essgª©î
(
x
, 
y
) \

110 ({ 
__ªsu…
; \

111 
	`__asm__
 ("fucompp; fnstsw;Åestb $0x44, %%ah; setz %%al" \

112 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

113 
__ªsu…
; })

	)

115 
	#isun‹dîed
(
x
, 
y
) \

116 ({ 
__ªsu…
; \

117 
	`__asm__
 ("fucompp; fnstsw; sahf; setp %%al" \

118 : "˜" (
__ªsu…
Ë: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

119 
__ªsu…
; })

	)

125 #i‡
__GNUC_PREREQ
 (2, 8)

127 
__MATH_INLINE
 

128 
	$__signbôf
 (
__x
Ë
__THROW


130 
__exãnsi⁄__
 uni⁄ { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

131  
__u
.
__i
 < 0;

132 
	}
}

133 
__MATH_INLINE
 

134 
	$__signbô
 (
__x
Ë
__THROW


136 
__exãnsi⁄__
 uni⁄ { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

137  
__u
.
__i
[1] < 0;

138 
	}
}

139 
__MATH_INLINE
 

140 
	$__signbôl
 (
__x
Ë
__THROW


142 
__exãnsi⁄__
 uni⁄ { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

143  (
__u
.
__i
[2] & 0x8000) != 0;

144 
	}
}

151 #i‡
__GNUC_PREREQ
 (2, 8)

153 #i‡((!
deföed
 
__NO_MATH_INLINES
 || deföed 
__LIBC_INTERNAL_MATH_INLINES
) \

154 && 
deföed
 
__OPTIMIZE__
)

163 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


164 
	#__ölöe_m©h›
(
func
, 
›
) \

165 
	`__ölöe_m©h›_
 (, 
func
, 
›
) \

166 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

167 
	`__ölöe_m©h›_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

168 
	#__ölöe_m©h›NP
(
func
, 
›
) \

169 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
) \

170 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
) \

171 
	`__ölöe_m©h›NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
)

	)

173 
	#__ölöe_m©h›
(
func
, 
›
) \

174 
	`__ölöe_m©h›_
 (, 
func
, 
›
)

	)

175 
	#__ölöe_m©h›NP
(
func
, 
›
) \

176 
	`__ölöe_m©h›NP_
 (, 
func
, 
›
)

	)

179 
	#__ölöe_m©h›_
(
Êﬂt_ty≥
, 
func
, 
›
) \

180 
	`__ölöe_m©h›_de˛_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

181 
	#__ölöe_m©h›NP_
(
Êﬂt_ty≥
, 
func
, 
›
) \

182 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, "0" (
__x
))

	)

185 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


186 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

187 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
) \

188 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

189 
	`__ölöe_m©h›_de˛_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

190 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

191 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
) \

192 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
f
), 
›
, 
∑øms
) \

193 
	`__ölöe_m©h›_de˛NP_
 (, 
	`__CONCAT
(
func
,
l
), 
›
, 
∑øms
)

	)

195 
	#__ölöe_m©h›_de˛
(
func
, 
›
, 
∑øms
...) \

196 
	`__ölöe_m©h›_de˛_
 (, 
func
, 
›
, 
∑øms
)

	)

197 
	#__ölöe_m©h›_de˛NP
(
func
, 
›
, 
∑øms
...) \

198 
	`__ölöe_m©h›_de˛NP_
 (, 
func
, 
›
, 
∑øms
)

	)

201 
	#__ölöe_m©h›_de˛_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

202 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

203 
	`__ölöe_m©h›_de˛NP_
 (
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
)

	)

205 
	#__ölöe_m©h›_de˛NP_
(
Êﬂt_ty≥
, 
func
, 
›
, 
∑øms
...) \

206 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥ 
__x
Ë
__THROW
 \

208 
Êﬂt_ty≥
 
__ªsu…
; \

209 
__asm
 
	`__vﬁ©ûe__
 (
›
 : "Ò" (
__ªsu…
Ë: 
∑øms
); \

210  
__ªsu…
; \

211 }

	)

214 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_ISOC99


215 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

216 
	`__ölöe_m©hcode_
 (, 
func
, 
¨g
, 
code
) \

217 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

218 
	`__ölöe_m©hcode_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

219 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

220 
	`__ölöe_m©hcodeNP_
 (, 
func
, 
¨g
, 
code
) \

221 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g
, 
code
) \

222 
	`__ölöe_m©hcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g
, 
code
)

	)

223 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

224 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

225 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

226 
	`__ölöe_m©hcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

227 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

228 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
) \

229 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
code
) \

230 
	`__ölöe_m©hcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
code
)

	)

231 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

232 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

233 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

234 
	`__ölöe_m©hcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

235 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

236 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

237 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

238 
	`__ölöe_m©hcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

240 
	#__ölöe_m©hcode
(
func
, 
¨g
, 
code
) \

241 
	`__ölöe_m©hcode_
 (, 
func
, (
¨g
), 
code
)

	)

242 
	#__ölöe_m©hcodeNP
(
func
, 
¨g
, 
code
) \

243 
	`__ölöe_m©hcodeNP_
 (, 
func
, (
¨g
), 
code
)

	)

244 
	#__ölöe_m©hcode2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

245 
	`__ölöe_m©hcode2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

246 
	#__ölöe_m©hcodeNP2
(
func
, 
¨g1
, 
¨g2
, 
code
) \

247 
	`__ölöe_m©hcodeNP2_
 (, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

248 
	#__ölöe_m©hcode3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

249 
	`__ölöe_m©hcode3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

250 
	#__ölöe_m©hcodeNP3
(
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

251 
	`__ölöe_m©hcodeNP3_
 (, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

254 
	#__ölöe_m©hcode_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

255 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥Ë
__THROW
; \

256 
	`__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
)

	)

258 
	#__ölöe_m©hcodeNP_
(
Êﬂt_ty≥
, 
func
, 
¨g
, 
code
) \

259 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥ 
¨g
Ë
__THROW
 \

261 
code
; \

262 }

	)

265 
	#__ölöe_m©hcode2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

266 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

267 
	`__ölöe_m©hcodeNP2_
 (
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
)

	)

269 
	#__ölöe_m©hcodeNP2_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
code
) \

270 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
Ë
__THROW
 \

272 
code
; \

273 }

	)

275 
	#__ölöe_m©hcode3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

276 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥, flﬂt_ty≥, flﬂt_ty≥Ë
__THROW
; \

277 
	`__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
)

	)

279 
	#__ölöe_m©hcodeNP3_
(
Êﬂt_ty≥
, 
func
, 
¨g1
, 
¨g2
, 
¨g3
, 
code
) \

280 
__MATH_INLINE
 
Êﬂt_ty≥
 
	`func
 (Êﬂt_ty≥ 
¨g1
, flﬂt_ty≥ 
¨g2
, \

281 
Êﬂt_ty≥
 
¨g3
Ë
__THROW
 \

283 
code
; \

284 }

	)

288 #i‡!
deföed
 
__NO_MATH_INLINES
 && deföed 
__OPTIMIZE__


291 
__ölöe_m©hcode
 (
__sgn
, 
__x
, \

292  
__x
 == 0.0 ? 0.0 : (__x > 0.0 ? 1.0 : -1.0))

295 #ifde‡
__FAST_MATH__


296 
__ölöe_m©hcode
 (
__pow2
, 
__x
, \

297 
__vÆue
; \

298 
__exp⁄ít
; \

299 
__exãnsi⁄__
 
__p
 = (Ë
__x
; \

300 i‡(
__x
 =(Ë
__p
) \

302 
__asm
 
__vﬁ©ûe__
 \

304 : "Ò" (
__vÆue
Ë: "0" (1.0), "u" (
__x
)); \

305  
__vÆue
; \

307 
__asm
 
__vﬁ©ûe__
 \

313 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

314 
__vÆue
 += 1.0; \

315 
__asm
 
__vﬁ©ûe__
 \

317 : "Ò" (
__vÆue
Ë: "0" (__vÆue), "u" (
__exp⁄ít
)); \

318  
__vÆue
)

320 #ifde‡
__USE_GNU


321 
	#__söcos_code
 \

322 
__co§
; \

323 
__sör
; \

324 
__asm
 
__vﬁ©ûe__
 \

339 : "Ò" (
__co§
), "=u" (
__sör
Ë: "0" (
__x
)); \

340 *
__söx
 = 
__sör
; \

341 *
__cosx
 = 
__co§


	)

343 
__MATH_INLINE
 

344 
	$__söcos
 (
__x
, *
__söx
, *
__cosx
Ë
__THROW


346 
__söcos_code
;

347 
	}
}

349 
__MATH_INLINE
 

350 
	$__söcosf
 (
__x
, *
__söx
, *
__cosx
Ë
__THROW


352 
__söcos_code
;

353 
	}
}

355 
__MATH_INLINE
 

356 
	$__söco¶
 (
__x
, *
__söx
, *
__cosx
Ë
__THROW


358 
__söcos_code
;

359 
	}
}

366 
	#__expm1_code
 \

367 
__vÆue
; \

368 
__exp⁄ít
; \

369 
__ãmp
; \

370 
__asm
 
__vﬁ©ûe__
 \

379 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

380 
__asm
 
__vﬁ©ûe__
 \

382 : "Ò" (
__ãmp
Ë: "0" (1.0), "u" (
__exp⁄ít
)); \

383 
__ãmp
 -= 1.0; \

384  
__ãmp
 + 
__vÆue
 ?: 
__x


	)

385 
	$__ölöe_m©hcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

388 
	#__exp_code
 \

389 
__vÆue
; \

390 
__exp⁄ít
; \

391 
__asm
 
__vﬁ©ûe__
 \

399 : "Ò" (
__vÆue
), "=u" (
__exp⁄ít
Ë: "0" (
__x
)); \

400 
__vÆue
 += 1.0; \

401 
__asm
 
__vﬁ©ûe__
 \

403 : "Ò" (
__vÆue
Ë: "0" (__vÆue), "u" (
__exp⁄ít
)); \

404  
__vÆue


	)

405 
	$__ölöe_m©hcodeNP
 (
exp
, 
__x
, 
__exp_code
)

406 
	$__ölöe_m©hcodeNP_
 (, 
__ex∂
, 
__x
, 
__exp_code
)

409 
	`__ölöe_m©hcodeNP
 (
èn
, 
__x
, \

410 
__vÆue
; \

411 
__vÆue2
 
	`__©åibuã__
 ((
__unu£d__
)); \

412 
__asm
 
__vﬁ©ûe__
 \

414 : "Ò" (
__vÆue2
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

415  
__vÆue
)

419 
	#__©™2_code
 \

420 
__vÆue
; \

421 
__asm
 
__vﬁ©ûe__
 \

423 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "st(1)"); \

424  
__vÆue


	)

425 
	$__ölöe_m©hcodeNP2
 (
©™2
, 
__y
, 
__x
, 
__©™2_code
)

426 
	$__ölöe_m©hcodeNP2_
 (, 
__©™2l
, 
__y
, 
__x
, 
__©™2_code
)

429 
	`__ölöe_m©hcodeNP2
 (
fmod
, 
__x
, 
__y
, \

430 
__vÆue
; \

431 
__asm
 
__vﬁ©ûe__
 \

436 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

437  
__vÆue
)

440 #ifde‡
__FAST_MATH__


441 
	`__ölöe_m©h›NP
 (
sqπ
, "fsqrt")

442 
	`__ölöe_m©h›NP_
 (, 
__sqπl
, "fsqrt")

445 #i‡
	`__GNUC_PREREQ
 (2, 8)

446 
	`__ölöe_m©hcodeNP_
 (, 
Ábs
, 
__x
,  
	$__buûtö_Ábs
 (
__x
))

447 
	`__ölöe_m©hcodeNP_
 (, 
Ábsf
, 
__x
,  
	$__buûtö_Ábsf
 (
__x
))

448 
	`__ölöe_m©hcodeNP_
 (, 
Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

449 
	`__ölöe_m©hcodeNP_
 (, 
__Áb¶
, 
__x
,  
	$__buûtö_Áb¶
 (
__x
))

451 
	`__ölöe_m©h›
 (
Ábs
, "fabs")

452 
	`__ölöe_m©h›_
 (, 
__Áb¶
, "fabs")

455 #ifde‡
__FAST_MATH__


457 
	`__ölöe_m©h›NP
 (
sö
, "fsin")

459 
	`__ölöe_m©h›NP
 (
cos
, "fcos")

461 
	`__ölöe_m©h›_de˛NP
 (
log
, "Êd 2; fxch; fyl2x", "0" (
__x
) : "st(1)")

462 
	`__ölöe_m©h›_de˛NP
 (
log10
, "Êdlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

464 
	`__ölöe_m©hcodeNP
 (
asö
, 
__x
,  
	`__©™2l
 (__x, 
	`__sqπl
 (1.0 - __x * __x)))

465 
	`__ölöe_m©hcodeNP
 (
acos
, 
__x
,  
	`__©™2l
 (
	`__sqπl
 (1.0 - __x * __x), __x))

468 
	`__ölöe_m©h›_de˛NP
 (
©™
, "Êd1; f∑èn", "0" (
__x
) : "st(1)")

470 
	`__ölöe_m©hcode_
 (, 
__sgn1l
, 
__x
, \

471 
__exãnsi⁄__
 uni⁄ { 
__xld
; 
__xi
[3]; } 
__n
 = \

472 { 
__xld
: 
__x
 
	}
}; \

473 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

474 
	g__n
.
	g__xi
[1] = 0x80000000; \

475 
	g__n
.
	g__xi
[0] = 0; \

476  
	g__n
.
	g__xld
)

479 #ifde‡
__FAST_MATH__


481 
__ölöe_m©hcodeNP
 (
söh
, 
__x
, \

482 
__exm1
 = 
__expm1l
 (
__Áb¶
 (
__x
)); \

483  0.5 * (
__exm1
 / (__exm1 + 1.0Ë+ __exm1Ë* 
	$__sgn1l
 (
__x
))

485 
	`__ölöe_m©hcodeNP
 (
cosh
, 
__x
, \

486 
__ex
 = 
	`__ex∂
 (
__x
); \

487  0.5 * (
__ex
 + 1.0 / __ex))

489 
	`__ölöe_m©hcodeNP
 (
ènh
, 
__x
, \

490 
__exm1
 = 
	`__expm1l
 (-
	`__Áb¶
 (
__x
 + __x)); \

491  
__exm1
 / (__exm1 + 2.0Ë* 
	`__sgn1l
 (-
__x
))

494 
	`__ölöe_m©hcodeNP
 (
Êo‹
, 
__x
, \

495 
__vÆue
; \

496 
__vﬁ©ûe
 
__cw
; \

497 
__vﬁ©ûe
 
__cwtmp
; \

498 
__asm
 
	`__vﬁ©ûe
 ("‚°cw %0" : "=m" (
__cw
)); \

499 
__cwtmp
 = (
__cw
 & 0xf3ff) | 0x0400; \

500 
__asm
 
	`__vﬁ©ûe
 ("Êdcw %0" : : "m" (
__cwtmp
)); \

501 
__asm
 
	`__vﬁ©ûe
 ("‰ndöt" : "Ò" (
__vÆue
Ë: "0" (
__x
)); \

502 
__asm
 
	`__vﬁ©ûe
 ("Êdcw %0" : : "m" (
__cw
)); \

503  
__vÆue
)

505 
	`__ölöe_m©hcodeNP
 (
˚û
, 
__x
, \

506 
__vÆue
; \

507 
__vﬁ©ûe
 
__cw
; \

508 
__vﬁ©ûe
 
__cwtmp
; \

509 
__asm
 
	`__vﬁ©ûe
 ("‚°cw %0" : "=m" (
__cw
)); \

510 
__cwtmp
 = (
__cw
 & 0xf3ff) | 0x0800; \

511 
__asm
 
	`__vﬁ©ûe
 ("Êdcw %0" : : "m" (
__cwtmp
)); \

512 
__asm
 
	`__vﬁ©ûe
 ("‰ndöt" : "Ò" (
__vÆue
Ë: "0" (
__x
)); \

513 
__asm
 
	`__vﬁ©ûe
 ("Êdcw %0" : : "m" (
__cw
)); \

514  
__vÆue
)

516 #ifde‡
__FAST_MATH__


517 
	#__ldexp_code
 \

518 
__vÆue
; \

519 
__asm
 
__vﬁ©ûe__
 \

521 : "Ò" (
__vÆue
Ë: "0" (
__x
), "u" ((Ë
__y
)); \

522  
__vÆue


	)

524 
__MATH_INLINE
 

525 
	$ldexp
 (
__x
, 
__y
Ë
__THROW


527 
__ldexp_code
;

528 
	}
}

533 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_MISC


535 #ifde‡
__FAST_MATH__


536 
	$__ölöe_m©hcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

540 
	#__M_SQRT2
 1.41421356237309504880L

	)

542 
	`__ölöe_m©hcodeNP
 (
log1p
, 
__x
, \

543 
__vÆue
; \

544 i‡(
	`__Áb¶
 (
__x
Ë>1.0 - 0.5 * 
__M_SQRT2
) \

545 
__vÆue
 = 
	`logl
 (1.0 + 
__x
); \

547 
__asm
 
__vﬁ©ûe__
 \

551 : "Ò" (
__vÆue
Ë: "0" (
__x
) : "st(1)"); \

552  
__vÆue
)

556 
	`__ölöe_m©hcodeNP
 (
asöh
, 
__x
, \

557 
__y
 = 
	`__Áb¶
 (
__x
); \

558  (
	`log1∂
 (
__y
 * __y / (
	`__sqπl
 (__y * __y + 1.0) + 1.0) + __y) \

559 * 
	$__sgn1l
 (
__x
)))

561 
	`__ölöe_m©hcodeNP
 (
acosh
, 
__x
, \

562  
	`logl
 (
__x
 + 
	`__sqπl
 (__x - 1.0) * __sqrtl (__x + 1.0)))

564 
	`__ölöe_m©hcodeNP
 (
©™h
, 
__x
, \

565 
__y
 = 
	`__Áb¶
 (
__x
); \

566  -0.5 * 
	`log1∂
 (-(
__y
 + __yË/ (1.0 + __y)Ë* 
	$__sgn1l
 (
__x
))

569 
	`__ölöe_m©hcodeNP2
 (
hypŸ
, 
__x
, 
__y
,  
	`__sqπl
 (__x * __x + __y * __y))

571 
	`__ölöe_m©hcodeNP
(
logb
, 
__x
, \

572 
__vÆue
; \

573 
__junk
; \

574 
__asm
 
__vﬁ©ûe__
 \

576 : "Ò" (
__junk
), "=u" (
__vÆue
Ë: "0" (
__x
)); \

577  
__vÆue
)

582 #ifde‡
__USE_ISOC99


583 #ifde‡
__FAST_MATH__


584 
	`__ölöe_m©h›_de˛NP
 (
log2
, "Êd1; fxch; fyl2x", "0" (
__x
) : "st(1)")

586 
__MATH_INLINE
 

587 
	$ldexpf
 (
__x
, 
__y
Ë
__THROW


589 
__ldexp_code
;

590 
	}
}

592 
__MATH_INLINE
 

593 
	$ldex∂
 (
__x
, 
__y
Ë
__THROW


595 
__ldexp_code
;

596 
	}
}

598 
__ölöe_m©hcodeNP3
 (
fma
, 
__x
, 
__y
, 
__z
,  (__x * __y) + __z)

600 
__ölöe_m©h›NP
 (
röt
, "frndint")

603 
	#__Ãöt_code
 \

604 
__Ãöåes
; \

605 
__asm__
 
__vﬁ©ûe__
 \

607 : "=m" (
__Ãöåes
Ë: "t" (
__x
) : "st"); \

608  
__Ãöåes


	)

609 
__MATH_INLINE
 

610 
	$Ãötf
 (
__x
Ë
__THROW


612 
__Ãöt_code
;

613 
	}
}

614 
__MATH_INLINE
 

615 
	$Ãöt
 (
__x
Ë
__THROW


617 
__Ãöt_code
;

618 
	}
}

619 
__MATH_INLINE
 

620 
	$Ãöé
 (
__x
Ë
__THROW


622 
__Ãöt_code
;

623 
	}
}

624 #unde‡
__Ãöt_code


626 
	#__Œröt_code
 \

627 
__Œröåes
; \

628 
__asm__
 
__vﬁ©ûe__
 \

630 : "=m" (
__Œröåes
Ë: "t" (
__x
) : "st"); \

631  
__Œröåes


	)

632 
__MATH_INLINE
 

633 
	$Œrötf
 (
__x
Ë
__THROW


635 
__Œröt_code
;

636 
	}
}

637 
__MATH_INLINE
 

638 
	$Œröt
 (
__x
Ë
__THROW


640 
__Œröt_code
;

641 
	}
}

642 
__MATH_INLINE
 

643 
	$Œröé
 (
__x
Ë
__THROW


645 
__Œröt_code
;

646 
	}
}

647 #unde‡
__Œröt_code


652 #ifde‡
__USE_MISC


654 
__ölöe_m©hcodeNP2
 (
dªm
, 
__x
, 
__y
, \

655 
__vÆue
; \

656 
__˛obbîed
; \

657 
__asm
 
__vﬁ©ûe__
 \

662 : "Ò" (
__vÆue
), "=&a" (
__˛obbîed
Ë: "0" (
__x
), "u" (
__y
) : "cc"); \

663  
__vÆue
)

667 
__MATH_INLINE
 

668 
	$__föôe
 (
__x
Ë
__THROW


670  (
__exãnsi⁄__


671 (((((uni⁄ { 
__d
; 
__i
[2]; }Ë{__d: 
__x
}).__i[1]

673 
	}
}

676 #ifde‡
__FAST_MATH__


677 
__ölöe_m©hcode
 (
__coshm1
, 
__x
, \

678 
__exm1
 = 
__expm1l
 (
__Áb¶
 (
__x
)); \

679  0.5 * (
__exm1
 / (__exm1 + 1.0)) * __exm1)

681 
__ölöe_m©hcode
 (
__acosh1p
, 
__x
, \

682  
log1∂
 (
__x
 + 
__sqπl
 (__x) * __sqrtl (__x + 2.0)))

688 #unde‡
__©™2_code


689 #ifde‡
__FAST_MATH__


690 #unde‡
__expm1_code


691 #unde‡
__exp_code


692 #unde‡
__söcos_code


699 #ifde‡
__LIBC_INTERNAL_MATH_INLINES


700 
__ölöe_m©h›
 (
__õì754_sqπ
, "fsqrt")

701 
__ölöe_m©hcode2
 (
__õì754_©™2
, 
__y
, 
__x
,

702 
__vÆue
;

703 
__asm
 
__vﬁ©ûe__
 ("fpatan\n\t"

704 : "Ò" (
__vÆue
)

705 : "0" (
__x
), "u" (
__y
) : "st(1)");

706  
__vÆue
;)

	@/usr/include/bits/mman.h

20 #i‚de‡
_SYS_MMAN_H


33 
	#PROT_READ
 0x1

	)

34 
	#PROT_WRITE
 0x2

	)

35 
	#PROT_EXEC
 0x4

	)

36 
	#PROT_NONE
 0x0

	)

39 
	#MAP_SHARED
 0x01

	)

40 
	#MAP_PRIVATE
 0x02

	)

41 #ifde‡
__USE_MISC


42 
	#MAP_TYPE
 0x0‡

	)

46 
	#MAP_FIXED
 0x10

	)

47 #ifde‡
__USE_MISC


48 
	#MAP_FILE
 0

	)

49 
	#MAP_ANONYMOUS
 0x20

	)

50 
	#MAP_ANON
 
MAP_ANONYMOUS


	)

54 #ifde‡
__USE_MISC


55 
	#MAP_GROWSDOWN
 0x00100

	)

56 
	#MAP_DENYWRITE
 0x00800

	)

57 
	#MAP_EXECUTABLE
 0x01000

	)

58 
	#MAP_LOCKED
 0x02000

	)

59 
	#MAP_NORESERVE
 0x04000

	)

60 
	#MAP_POPULATE
 0x08000

	)

61 
	#MAP_NONBLOCK
 0x10000

	)

65 
	#MS_ASYNC
 1

	)

66 
	#MS_SYNC
 4

	)

67 
	#MS_INVALIDATE
 2

	)

70 
	#MCL_CURRENT
 1

	)

71 
	#MCL_FUTURE
 2

	)

75 #ifde‡
__USE_GNU


76 
	#MREMAP_MAYMOVE
 1

	)

80 #ifde‡
__USE_BSD


81 
	#MADV_NORMAL
 0

	)

82 
	#MADV_RANDOM
 1

	)

83 
	#MADV_SEQUENTIAL
 2

	)

84 
	#MADV_WILLNEED
 3

	)

85 
	#MADV_DONTNEED
 4

	)

89 #ifde‡
__USE_XOPEN2K


90 
	#POSIX_MADV_NORMAL
 0

	)

91 
	#POSIX_MADV_RANDOM
 1

	)

92 
	#POSIX_MADV_SEQUENTIAL
 2

	)

93 
	#POSIX_MADV_WILLNEED
 3

	)

94 
	#POSIX_MADV_DONTNEED
 4

	)

	@/usr/include/bits/nan.h

20 #i‚de‡
_MATH_H


27 #ifdef 
__GNUC__


29 
	#NAN
 \

30 (
__exãnsi⁄__
 \

31 ((uni⁄ { 
__l
 
	`__©åibuã__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

32 { 
__l
: 0x7fc00000UL }).
__d
)

	)

36 
	~<ídün.h
>

38 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


39 
	#__«n_byãs
 { 0x7f, 0xc0, 0, 0 }

	)

41 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


42 
	#__«n_byãs
 { 0, 0, 0xc0, 0x7‡}

	)

45 uni⁄ { 
	m__c
[4]; 
	m__d
; } 
	g__«n_uni⁄
 = { 
__«n_byãs
 };

46 
	#NAN
 (
__«n_uni⁄
.
__d
)

	)

	@/usr/include/bits/netdb.h

19 #i‚de‡
_NETDB_H


27 
	s√ã¡


29 *
	mn_«me
;

30 **
	mn_Æü£s
;

31 
	mn_addπy≥
;

32 
uöt32_t
 
	mn_√t
;

	@/usr/include/bits/posix1_lim.h

25 #i‚def 
_BITS_POSIX1_LIM_H


26 
	#_BITS_POSIX1_LIM_H
 1

	)

32 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

35 
	#_POSIX_AIO_MAX
 1

	)

38 
	#_POSIX_ARG_MAX
 4096

	)

41 
	#_POSIX_CHILD_MAX
 6

	)

44 
	#_POSIX_DELAYTIMER_MAX
 32

	)

47 
	#_POSIX_LINK_MAX
 8

	)

50 
	#_POSIX_MAX_CANON
 255

	)

54 
	#_POSIX_MAX_INPUT
 255

	)

57 
	#_POSIX_MQ_OPEN_MAX
 8

	)

60 
	#_POSIX_MQ_PRIO_MAX
 32

	)

63 #ifde‡
__USE_XOPEN2K


64 
	#_POSIX_NGROUPS_MAX
 8

	)

66 
	#_POSIX_NGROUPS_MAX
 0

	)

70 
	#_POSIX_OPEN_MAX
 16

	)

74 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

77 
	#_POSIX_NAME_MAX
 14

	)

80 
	#_POSIX_PATH_MAX
 256

	)

83 
	#_POSIX_PIPE_BUF
 512

	)

86 
	#_POSIX_RTSIG_MAX
 8

	)

89 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

92 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

95 
	#_POSIX_SIGQUEUE_MAX
 32

	)

98 
	#_POSIX_SSIZE_MAX
 32767

	)

101 
	#_POSIX_STREAM_MAX
 8

	)

104 
	#_POSIX_TZNAME_MAX
 6

	)

107 
	#_POSIX_QLIMIT
 1

	)

111 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

114 
	#_POSIX_UIO_MAXIOV
 16

	)

117 
	#_POSIX_TTY_NAME_MAX
 9

	)

120 
	#_POSIX_TIMER_MAX
 32

	)

123 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

126 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

130 
	~<bôs/loˇl_lim.h
>

133 #i‚def 
SSIZE_MAX


134 
	#SSIZE_MAX
 
LONG_MAX


	)

141 #i‚def 
NGROUPS_MAX


142 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

23 #i‚def 
_BITS_POSIX2_LIM_H


24 
	#_BITS_POSIX2_LIM_H
 1

	)

28 
	#_POSIX2_BC_BASE_MAX
 99

	)

31 
	#_POSIX2_BC_DIM_MAX
 2048

	)

34 
	#_POSIX2_BC_SCALE_MAX
 99

	)

37 
	#_POSIX2_BC_STRING_MAX
 1000

	)

41 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

45 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

48 
	#_POSIX2_LINE_MAX
 2048

	)

52 
	#_POSIX2_RE_DUP_MAX
 255

	)

56 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

63 #i‚def 
BC_BASE_MAX


64 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

66 #i‚def 
BC_DIM_MAX


67 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

69 #i‚def 
BC_SCALE_MAX


70 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

72 #i‚def 
BC_STRING_MAX


73 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

75 #i‚def 
COLL_WEIGHTS_MAX


76 
	#COLL_WEIGHTS_MAX
 255

	)

78 #i‚def 
EXPR_NEST_MAX


79 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

81 #i‚def 
LINE_MAX


82 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

84 #i‚def 
CHARCLASS_NAME_MAX


85 
	#CHARCLASS_NAME_MAX
 2048

	)

89 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/posix_opt.h

20 #i‚def 
_POSIX_OPT_H


21 
	#_POSIX_OPT_H
 1

	)

24 
	#_POSIX_JOB_CONTROL
 1

	)

27 
	#_POSIX_SAVED_IDS
 1

	)

30 
	#_POSIX_PRIORITY_SCHEDULING
 200112L

	)

33 
	#_POSIX_SYNCHRONIZED_IO
 200112L

	)

36 
	#_POSIX_FSYNC
 200112L

	)

39 
	#_POSIX_MAPPED_FILES
 200112L

	)

42 
	#_POSIX_MEMLOCK
 200112L

	)

45 
	#_POSIX_MEMLOCK_RANGE
 200112L

	)

48 
	#_POSIX_MEMORY_PROTECTION
 200112L

	)

51 
	#_POSIX_CHOWN_RESTRICTED
 1

	)

55 
	#_POSIX_VDISABLE
 '\0'

	)

58 
	#_POSIX_NO_TRUNC
 1

	)

61 
	#_XOPEN_REALTIME
 1

	)

64 
	#_XOPEN_REALTIME_THREADS
 1

	)

67 
	#_XOPEN_SHM
 1

	)

70 
	#_POSIX_THREADS
 200112L

	)

73 
	#_POSIX_REENTRANT_FUNCTIONS
 1

	)

74 
	#_POSIX_THREAD_SAFE_FUNCTIONS
 200112L

	)

77 
	#_POSIX_THREAD_PRIORITY_SCHEDULING
 200112L

	)

80 
	#_POSIX_THREAD_ATTR_STACKSIZE
 200112L

	)

83 
	#_POSIX_THREAD_ATTR_STACKADDR
 200112L

	)

86 
	#_POSIX_SEMAPHORES
 200112L

	)

89 
	#_POSIX_REALTIME_SIGNALS
 200112L

	)

92 
	#_POSIX_ASYNCHRONOUS_IO
 200112L

	)

93 
	#_POSIX_ASYNC_IO
 1

	)

95 
	#_LFS_ASYNCHRONOUS_IO
 1

	)

98 
	#_LFS64_ASYNCHRONOUS_IO
 1

	)

101 
	#_LFS_LARGEFILE
 1

	)

102 
	#_LFS64_LARGEFILE
 1

	)

103 
	#_LFS64_STDIO
 1

	)

106 
	#_POSIX_SHARED_MEMORY_OBJECTS
 200112L

	)

109 
	#_POSIX_CPUTIME
 200112L

	)

112 
	#_POSIX_THREAD_CPUTIME
 200112L

	)

115 
	#_POSIX_REGEXP
 1

	)

118 
	#_POSIX_READER_WRITER_LOCKS
 200112L

	)

121 
	#_POSIX_SHELL
 1

	)

124 
	#_POSIX_TIMEOUTS
 200112L

	)

127 
	#_POSIX_SPIN_LOCKS
 200112L

	)

130 
	#_POSIX_SPAWN
 200112L

	)

133 
	#_POSIX_TIMERS
 200112L

	)

136 
	#_POSIX_BARRIERS
 200112L

	)

139 #unde‡
_POSIX_MESSAGE_PASSING


142 
	#_POSIX_MONOTONIC_CLOCK
 0

	)

	@/usr/include/bits/pthreadtypes.h

15 #i‡!
deföed
 
_BITS_TYPES_H
 && !deföed 
_PTHREAD_H


19 #i‚de‡
_BITS_PTHREADTYPES_H


20 
	#_BITS_PTHREADTYPES_H
 1

	)

22 
	#__√ed_sched∑øm


	)

23 
	~<bôs/sched.h
>

25 
	t__©omic_lock_t
;

28 
	s_±hªad_Á°lock


30 
	m__°©us
;

31 
__©omic_lock_t
 
	m__•ölock
;

35 #i‚de‡
_PTHREAD_DESCR_DEFINED


37 
_±hªad_des¸_°ru˘
 *
	t_±hªad_des¸
;

38 
	#_PTHREAD_DESCR_DEFINED


	)

43 
	s__±hªad_©å_s


45 
	m__dëach°©e
;

46 
	m__schedpﬁicy
;

47 
__sched_∑øm
 
	m__sched∑øm
;

48 
	m__öhîôsched
;

49 
	m__sc›e
;

50 
size_t
 
	m__gu¨dsize
;

51 
	m__°ackaddr_£t
;

52 *
	m__°ackaddr
;

53 
size_t
 
	m__°acksize
;

54 } 
	t±hªad_©å_t
;

59 #ifde‡
__GLIBC_HAVE_LONG_LONG


60 
__exãnsi⁄__
 
	t__±hªad_c⁄d_Æign_t
;

62 
	t__±hªad_c⁄d_Æign_t
;

67 
_±hªad_Á°lock
 
	m__c_lock
;

68 
_±hªad_des¸
 
	m__c_waôög
;

69 
	m__∑ddög
[48 -  (
_±hªad_Á°lock
)

70 -  (
_±hªad_des¸
Ë-  (
__±hªad_c⁄d_Æign_t
)];

71 
__±hªad_c⁄d_Æign_t
 
	m__Æign
;

72 } 
	t±hªad_c⁄d_t
;

78 
	m__dummy
;

79 } 
	t±hªad_c⁄d©å_t
;

82 
	t±hªad_key_t
;

90 
	m__m_ª£rved
;

91 
	m__m_cou¡
;

92 
_±hªad_des¸
 
	m__m_ow√r
;

93 
	m__m_köd
;

94 
_±hªad_Á°lock
 
	m__m_lock
;

95 } 
	t±hªad_muãx_t
;

101 
	m__muãxköd
;

102 } 
	t±hªad_muãx©å_t
;

106 
	t±hªad_⁄˚_t
;

109 #ifde‡
__USE_UNIX98


111 
	s_±hªad_rwlock_t


113 
_±hªad_Á°lock
 
	m__rw_lock
;

114 
	m__rw_ªadîs
;

115 
_±hªad_des¸
 
	m__rw_wrôî
;

116 
_±hªad_des¸
 
	m__rw_ªad_waôög
;

117 
_±hªad_des¸
 
	m__rw_wrôe_waôög
;

118 
	m__rw_köd
;

119 
	m__rw_psh¨ed
;

120 } 
	t±hªad_rwlock_t
;

126 
	m__lockköd
;

127 
	m__psh¨ed
;

128 } 
	t±hªad_rwlock©å_t
;

131 #ifde‡
__USE_XOPEN2K


133 vﬁ©ûê
	t±hªad_•ölock_t
;

137 
_±hªad_Á°lock
 
	m__ba_lock
;

138 
	m__ba_ªquúed
;

139 
	m__ba_¥e£¡
;

140 
_±hªad_des¸
 
	m__ba_waôög
;

141 } 
	t±hªad_b¨rõr_t
;

145 
	m__psh¨ed
;

146 } 
	t±hªad_b¨rõøâr_t
;

152 
	t±hªad_t
;

	@/usr/include/bits/select.h

19 #i‚de‡
_SYS_SELECT_H


24 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

26 
	#__FD_ZERO
(
fd•
) \

28 
__d0
, 
__d1
; \

29 
__asm__
 
	`__vﬁ©ûe__
 ("cld;Ñep; stosl" \

30 : "=c" (
__d0
), "=D" (
__d1
) \

31 : "a" (0), "0" ( (
fd_£t
) \

32 /  (
__fd_mask
)), \

33 "1" (&
	`__FDS_BITS
 (
fd•
)[0]) \

35 } 0)

	)

37 
	#__FD_SET
(
fd
, 
fd•
) \

38 
__asm__
 
	`__vﬁ©ûe__
 ("btsl %1,%0" \

39 : "=m" (
	`__FDS_BITS
 (
fd•
)[
	`__FDELT
 (
fd
)]) \

40 : "r" (((Ë(
fd
)Ë% 
__NFDBITS
) \

41 : "cc","mem‹y")

	)

42 
	#__FD_CLR
(
fd
, 
fd•
) \

43 
__asm__
 
	`__vﬁ©ûe__
 ("btrl %1,%0" \

44 : "=m" (
	`__FDS_BITS
 (
fd•
)[
	`__FDELT
 (
fd
)]) \

45 : "r" (((Ë(
fd
)Ë% 
__NFDBITS
) \

46 : "cc","mem‹y")

	)

47 
	#__FD_ISSET
(
fd
, 
fd•
) \

48 (
__exãnsi⁄__
 \

49 ({
__ªsu…
; \

50 
__asm__
 
	`__vﬁ©ûe__
 ("btl %1,%2 ; setcb %b0" \

51 : "=q" (
__ªsu…
) \

52 : "r" (((Ë(
fd
)Ë% 
__NFDBITS
), \

53 "m" (
	`__FDS_BITS
 (
fd•
)[
	`__FDELT
 (
fd
)]) \

55 
__ªsu…
; }))

	)

61 
	#__FD_ZERO
(
£t
) \

63 
__i
; \

64 
fd_£t
 *
__¨r
 = (
£t
); \

65 
__i
 = 0; __ò<  (
fd_£t
Ë/  (
__fd_mask
); ++__i) \

66 
	`__FDS_BITS
 (
__¨r
)[
__i
] = 0; \

67 } 0)

	)

68 
	#__FD_SET
(
d
, 
£t
Ë(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] |
	`__FDMASK
 (d))

	)

69 
	#__FD_CLR
(
d
, 
£t
Ë(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] &~
	`__FDMASK
 (d))

	)

70 
	#__FD_ISSET
(
d
, 
£t
Ë(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] & 
	`__FDMASK
 (d))

	)

	@/usr/include/bits/setjmp.h

20 #i‚de‡
_BITS_SETJMP_H


21 
	#_BITS_SETJMP_H
 1

	)

23 #i‡!
deföed
 
_SETJMP_H
 && !deföed 
_PTHREAD_H


27 #i‡
deföed
 
__USE_MISC
 || deföed 
_ASM


28 
	#JB_BX
 0

	)

29 
	#JB_SI
 1

	)

30 
	#JB_DI
 2

	)

31 
	#JB_BP
 3

	)

32 
	#JB_SP
 4

	)

33 
	#JB_PC
 5

	)

34 
	#JB_SIZE
 24

	)

37 #i‚def 
_ASM


38 
	t__jmp_buf
[6];

43 
	#_JMPBUF_UNWINDS
(
jmpbuf
, 
addªss
) \

44 ((*Ë(
addªss
Ë< (*Ë(
jmpbuf
)[
JB_SP
])

	)

	@/usr/include/bits/shm.h

19 #i‚de‡
_SYS_SHM_H


23 
	~<bôs/ty≥s.h
>

26 
	#SHM_R
 0400

	)

27 
	#SHM_W
 0200

	)

30 
	#SHM_RDONLY
 010000

	)

31 
	#SHM_RND
 020000

	)

32 
	#SHM_REMAP
 040000

	)

35 
	#SHM_LOCK
 11

	)

36 
	#SHM_UNLOCK
 12

	)

39 
	#SHMLBA
 (
	`__gë∑gesize
 ())

	)

40 
	$__gë∑gesize
 (Ë
__THROW
 
	`__©åibuã__
 ((
__c⁄°__
));

44 
	tshm©t_t
;

47 
	sshmid_ds


49 
ùc_≥rm
 
shm_≥rm
;

50 
size_t
 
shm_£gsz
;

51 
__time_t
 
shm_©ime
;

52 
__unu£d1
;

53 
__time_t
 
shm_dtime
;

54 
__unu£d2
;

55 
__time_t
 
shm_˘ime
;

56 
__unu£d3
;

57 
__pid_t
 
shm_˝id
;

58 
__pid_t
 
shm_Õid
;

59 
shm©t_t
 
shm_«âch
;

60 
__unu£d4
;

61 
__unu£d5
;

64 #ifde‡
__USE_MISC


67 
	#SHM_STAT
 13

	)

68 
	#SHM_INFO
 14

	)

71 
	#SHM_DEST
 01000

	)

72 
	#SHM_LOCKED
 02000

	)

73 
	#SHM_HUGETLB
 04000

	)

75 
	sshmöfo


77 
shmmax
;

78 
shmmö
;

79 
shmmni
;

80 
shm£g
;

81 
shmÆl
;

82 
__unu£d1
;

83 
__unu£d2
;

84 
__unu£d3
;

85 
__unu£d4
;

88 
	sshm_öfo


90 
u£d_ids
;

91 
shm_tŸ
;

92 
shm_rss
;

93 
shm_swp
;

94 
sw≠_©ãm±s
;

95 
sw≠_suc˚s£s
;

	@/usr/include/bits/sigaction.h

20 #i‚de‡
_SIGNAL_H


25 
	ssiga˘i⁄


28 #ifde‡
__USE_POSIX199309


32 
__sigh™dÀr_t
 
	mß_h™dÀr
;

34 (*
	mß_siga˘i⁄
Ë(, 
	msigöfo_t
 *, *);

36 
	m__siga˘i⁄_h™dÀr
;

37 
	#ß_h™dÀr
 
__siga˘i⁄_h™dÀr
.
ß_h™dÀr


	)

38 
	#ß_siga˘i⁄
 
__siga˘i⁄_h™dÀr
.
ß_siga˘i⁄


	)

40 
__sigh™dÀr_t
 
	mß_h™dÀr
;

44 
__sig£t_t
 
	mß_mask
;

47 
	mß_Êags
;

50 (*
	mß_ª°‹î
) ();

54 
	#SA_NOCLDSTOP
 1

	)

55 
	#SA_NOCLDWAIT
 2

	)

56 
	#SA_SIGINFO
 4

	)

58 #i‡
deföed
 
__USE_UNIX98
 || deföed 
__USE_MISC


59 
	#SA_ONSTACK
 0x08000000

	)

60 
	#SA_RESTART
 0x10000000

	)

61 
	#SA_NODEFER
 0x40000000

	)

63 
	#SA_RESETHAND
 0x80000000

	)

65 #ifde‡
__USE_MISC


66 
	#SA_INTERRUPT
 0x20000000

	)

69 
	#SA_NOMASK
 
SA_NODEFER


	)

70 
	#SA_ONESHOT
 
SA_RESETHAND


	)

71 
	#SA_STACK
 
SA_ONSTACK


	)

75 
	#SIG_BLOCK
 0

	)

76 
	#SIG_UNBLOCK
 1

	)

77 
	#SIG_SETMASK
 2

	)

	@/usr/include/bits/sigcontext.h

19 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_SYS_UCONTEXT_H


23 #i‚de‡
sigc⁄ãxt_°ru˘


26 
	#sigc⁄ãxt_°ru˘
 
sigc⁄ãxt


	)

28 
	~<asm/sigc⁄ãxt.h
>

	@/usr/include/bits/siginfo.h

20 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
__√ed_sigöfo_t
 \

21 && !
deföed
 
	g__√ed_sigevít_t


25 
	~<bôs/w‹dsize.h
>

27 #i‡(!
deföed
 
__have_sigvÆ_t
 \

28 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
 \

29 || 
deföed
 
	g__√ed_sigevít_t
))

30 
	#__have_sigvÆ_t
 1

	)

33 
	usigvÆ


35 
	msivÆ_öt
;

36 *
	msivÆ_±r
;

37 } 
	tsigvÆ_t
;

40 #i‡(!
deföed
 
__have_sigöfo_t
 \

41 && (
deföed
 
	g_SIGNAL_H
 || deföed 
	g__√ed_sigöfo_t
))

42 
	#__have_sigöfo_t
 1

	)

44 
	#__SI_MAX_SIZE
 128

	)

45 #i‡
__WORDSIZE
 == 64

46 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 4)

	)

48 
	#__SI_PAD_SIZE
 ((
__SI_MAX_SIZE
 /  ()Ë- 3)

	)

51 
	ssigöfo


53 
	msi_signo
;

54 
	msi_î∫o
;

56 
	msi_code
;

60 
	m_∑d
[
__SI_PAD_SIZE
];

65 
__pid_t
 
	msi_pid
;

66 
__uid_t
 
	msi_uid
;

67 } 
	m_kûl
;

72 
	msi_tid
;

73 
	msi_ovîrun
;

74 
sigvÆ_t
 
	msi_sigvÆ
;

75 } 
	m_timî
;

80 
__pid_t
 
	msi_pid
;

81 
__uid_t
 
	msi_uid
;

82 
sigvÆ_t
 
	msi_sigvÆ
;

83 } 
	m_π
;

88 
__pid_t
 
	msi_pid
;

89 
__uid_t
 
	msi_uid
;

90 
	msi_°©us
;

91 
__˛ock_t
 
	msi_utime
;

92 
__˛ock_t
 
	msi_°ime
;

93 } 
	m_sigchld
;

98 *
	msi_addr
;

99 } 
	m_sigÁu…
;

104 
	msi_b™d
;

105 
	msi_fd
;

106 } 
	m_sigpﬁl
;

107 } 
	m_sifõlds
;

108 } 
	tsigöfo_t
;

112 
	#si_pid
 
_sifõlds
.
_kûl
.
si_pid


	)

113 
	#si_uid
 
_sifõlds
.
_kûl
.
si_uid


	)

114 
	#si_timîid
 
_sifõlds
.
_timî
.
si_tid


	)

115 
	#si_ovîrun
 
_sifõlds
.
_timî
.
si_ovîrun


	)

116 
	#si_°©us
 
_sifõlds
.
_sigchld
.
si_°©us


	)

117 
	#si_utime
 
_sifõlds
.
_sigchld
.
si_utime


	)

118 
	#si_°ime
 
_sifõlds
.
_sigchld
.
si_°ime


	)

119 
	#si_vÆue
 
_sifõlds
.
_π
.
si_sigvÆ


	)

120 
	#si_öt
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_öt


	)

121 
	#si_±r
 
_sifõlds
.
_π
.
si_sigvÆ
.
sivÆ_±r


	)

122 
	#si_addr
 
_sifõlds
.
_sigÁu…
.
si_addr


	)

123 
	#si_b™d
 
_sifõlds
.
_sigpﬁl
.
si_b™d


	)

124 
	#si_fd
 
_sifõlds
.
_sigpﬁl
.
si_fd


	)

131 
	mSI_ASYNCNL
 = -60,

132 
	#SI_ASYNCNL
 
SI_ASYNCNL


	)

133 
	mSI_TKILL
 = -6,

134 
	#SI_TKILL
 
SI_TKILL


	)

135 
	mSI_SIGIO
,

136 
	#SI_SIGIO
 
SI_SIGIO


	)

137 
	mSI_ASYNCIO
,

138 
	#SI_ASYNCIO
 
SI_ASYNCIO


	)

139 
	mSI_MESGQ
,

140 
	#SI_MESGQ
 
SI_MESGQ


	)

141 
	mSI_TIMER
,

142 
	#SI_TIMER
 
SI_TIMER


	)

143 
	mSI_QUEUE
,

144 
	#SI_QUEUE
 
SI_QUEUE


	)

145 
	mSI_USER
,

146 
	#SI_USER
 
SI_USER


	)

147 
	mSI_KERNEL
 = 0x80

148 
	#SI_KERNEL
 
SI_KERNEL


	)

155 
	mILL_ILLOPC
 = 1,

156 
	#ILL_ILLOPC
 
ILL_ILLOPC


	)

157 
	mILL_ILLOPN
,

158 
	#ILL_ILLOPN
 
ILL_ILLOPN


	)

159 
	mILL_ILLADR
,

160 
	#ILL_ILLADR
 
ILL_ILLADR


	)

161 
	mILL_ILLTRP
,

162 
	#ILL_ILLTRP
 
ILL_ILLTRP


	)

163 
	mILL_PRVOPC
,

164 
	#ILL_PRVOPC
 
ILL_PRVOPC


	)

165 
	mILL_PRVREG
,

166 
	#ILL_PRVREG
 
ILL_PRVREG


	)

167 
	mILL_COPROC
,

168 
	#ILL_COPROC
 
ILL_COPROC


	)

169 
	mILL_BADSTK


170 
	#ILL_BADSTK
 
ILL_BADSTK


	)

176 
	mFPE_INTDIV
 = 1,

177 
	#FPE_INTDIV
 
FPE_INTDIV


	)

178 
	mFPE_INTOVF
,

179 
	#FPE_INTOVF
 
FPE_INTOVF


	)

180 
	mFPE_FLTDIV
,

181 
	#FPE_FLTDIV
 
FPE_FLTDIV


	)

182 
	mFPE_FLTOVF
,

183 
	#FPE_FLTOVF
 
FPE_FLTOVF


	)

184 
	mFPE_FLTUND
,

185 
	#FPE_FLTUND
 
FPE_FLTUND


	)

186 
	mFPE_FLTRES
,

187 
	#FPE_FLTRES
 
FPE_FLTRES


	)

188 
	mFPE_FLTINV
,

189 
	#FPE_FLTINV
 
FPE_FLTINV


	)

190 
	mFPE_FLTSUB


191 
	#FPE_FLTSUB
 
FPE_FLTSUB


	)

197 
	mSEGV_MAPERR
 = 1,

198 
	#SEGV_MAPERR
 
SEGV_MAPERR


	)

199 
	mSEGV_ACCERR


200 
	#SEGV_ACCERR
 
SEGV_ACCERR


	)

206 
	mBUS_ADRALN
 = 1,

207 
	#BUS_ADRALN
 
BUS_ADRALN


	)

208 
	mBUS_ADRERR
,

209 
	#BUS_ADRERR
 
BUS_ADRERR


	)

210 
	mBUS_OBJERR


211 
	#BUS_OBJERR
 
BUS_OBJERR


	)

217 
	mTRAP_BRKPT
 = 1,

218 
	#TRAP_BRKPT
 
TRAP_BRKPT


	)

219 
	mTRAP_TRACE


220 
	#TRAP_TRACE
 
TRAP_TRACE


	)

226 
	mCLD_EXITED
 = 1,

227 
	#CLD_EXITED
 
CLD_EXITED


	)

228 
	mCLD_KILLED
,

229 
	#CLD_KILLED
 
CLD_KILLED


	)

230 
	mCLD_DUMPED
,

231 
	#CLD_DUMPED
 
CLD_DUMPED


	)

232 
	mCLD_TRAPPED
,

233 
	#CLD_TRAPPED
 
CLD_TRAPPED


	)

234 
	mCLD_STOPPED
,

235 
	#CLD_STOPPED
 
CLD_STOPPED


	)

236 
	mCLD_CONTINUED


237 
	#CLD_CONTINUED
 
CLD_CONTINUED


	)

243 
	mPOLL_IN
 = 1,

244 
	#POLL_IN
 
POLL_IN


	)

245 
	mPOLL_OUT
,

246 
	#POLL_OUT
 
POLL_OUT


	)

247 
	mPOLL_MSG
,

248 
	#POLL_MSG
 
POLL_MSG


	)

249 
	mPOLL_ERR
,

250 
	#POLL_ERR
 
POLL_ERR


	)

251 
	mPOLL_PRI
,

252 
	#POLL_PRI
 
POLL_PRI


	)

253 
	mPOLL_HUP


254 
	#POLL_HUP
 
POLL_HUP


	)

257 #unde‡
__√ed_sigöfo_t


261 #i‡(
deföed
 
_SIGNAL_H
 || deföed 
__√ed_sigevít_t
) \

262 && !
deföed
 
	g__have_sigevít_t


263 
	#__have_sigevít_t
 1

	)

266 
	#__SIGEV_MAX_SIZE
 64

	)

267 #i‡
__WORDSIZE
 == 64

268 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 4)

	)

270 
	#__SIGEV_PAD_SIZE
 ((
__SIGEV_MAX_SIZE
 /  ()Ë- 3)

	)

273 
	ssigevít


275 
sigvÆ_t
 
	msigev_vÆue
;

276 
	msigev_signo
;

277 
	msigev_nŸify
;

281 
	m_∑d
[
__SIGEV_PAD_SIZE
];

285 
__pid_t
 
	m_tid
;

289 (*
	m_fun˘i⁄
Ë(
	msigvÆ_t
);

290 *
	m_©åibuã
;

291 } 
	m_sigev_thªad
;

292 } 
	m_sigev_un
;

293 } 
	tsigevít_t
;

296 
	#sigev_nŸify_fun˘i⁄
 
_sigev_un
.
_sigev_thªad
.
_fun˘i⁄


	)

297 
	#sigev_nŸify_©åibuãs
 
_sigev_un
.
_sigev_thªad
.
_©åibuã


	)

302 
	mSIGEV_SIGNAL
 = 0,

303 
	#SIGEV_SIGNAL
 
SIGEV_SIGNAL


	)

304 
	mSIGEV_NONE
,

305 
	#SIGEV_NONE
 
SIGEV_NONE


	)

306 
	mSIGEV_THREAD
,

307 
	#SIGEV_THREAD
 
SIGEV_THREAD


	)

309 
	mSIGEV_THREAD_ID
 = 4

310 
	#SIGEV_THREAD_ID
 
SIGEV_THREAD_ID


	)

	@/usr/include/bits/signum.h

20 #ifdef 
_SIGNAL_H


23 
	#SIG_ERR
 ((
__sigh™dÀr_t
Ë-1Ë

	)

24 
	#SIG_DFL
 ((
__sigh™dÀr_t
Ë0Ë

	)

25 
	#SIG_IGN
 ((
__sigh™dÀr_t
Ë1Ë

	)

27 #ifde‡
__USE_UNIX98


28 
	#SIG_HOLD
 ((
__sigh™dÀr_t
Ë2Ë

	)

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCLD
 
SIGCHLD


	)

51 
	#SIGCHLD
 17

	)

52 
	#SIGCONT
 18

	)

53 
	#SIGSTOP
 19

	)

54 
	#SIGTSTP
 20

	)

55 
	#SIGTTIN
 21

	)

56 
	#SIGTTOU
 22

	)

57 
	#SIGURG
 23

	)

58 
	#SIGXCPU
 24

	)

59 
	#SIGXFSZ
 25

	)

60 
	#SIGVTALRM
 26

	)

61 
	#SIGPROF
 27

	)

62 
	#SIGWINCH
 28

	)

63 
	#SIGPOLL
 
SIGIO


	)

64 
	#SIGIO
 29

	)

65 
	#SIGPWR
 30

	)

66 
	#SIGSYS
 31

	)

67 
	#SIGUNUSED
 31

	)

69 
	#_NSIG
 65

	)

72 
	#SIGRTMIN
 (
	`__libc_cuºít_sigπmö
 ())

	)

73 
	#SIGRTMAX
 (
	`__libc_cuºít_sigπmax
 ())

	)

77 
	#__SIGRTMIN
 32

	)

78 
	#__SIGRTMAX
 (
_NSIG
 - 1)

	)

	@/usr/include/bits/sigset.h

20 #i‚def 
_SIGSET_H_ty≥s


21 
	#_SIGSET_H_ty≥s
 1

	)

23 
	t__sig_©omic_t
;

27 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

30 
	m__vÆ
[
_SIGSET_NWORDS
];

31 } 
	t__sig£t_t
;

42 #i‡!
deföed
 
_SIGSET_H_‚s
 && deföed 
_SIGNAL_H


43 
	#_SIGSET_H_‚s
 1

	)

45 #i‚de‡
_EXTERN_INLINE


46 
	#_EXTERN_INLINE
 
__ölöe


	)

50 
	#__sigmask
(
sig
) \

51 (((Ë1Ë<< (((
sig
Ë- 1Ë% (8 *  ())))

	)

54 
	#__sigw‹d
(
sig
Ë(((sigË- 1Ë/ (8 *  ()))

	)

56 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

57 
	#__sigem±y£t
(
£t
) \

58 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

59 
sig£t_t
 *
__£t
 = (
£t
); \

60 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = 0; \

61 0; }))

	)

62 
	#__sigfûl£t
(
£t
) \

63 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

64 
sig£t_t
 *
__£t
 = (
£t
); \

65 --
__˙t
 >0Ë
__£t
->
__vÆ
[__cnt] = ~0UL; \

66 0; }))

	)

68 #ifde‡
__USE_GNU


72 
	#__sigi£m±y£t
(
£t
) \

73 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

74 c⁄° 
sig£t_t
 *
__£t
 = (
£t
); \

75 
__ªt
 = 
__£t
->
__vÆ
[--
__˙t
]; \

76 !
__ªt
 && --
__˙t
 >= 0) \

77 
__ªt
 = 
__£t
->
__vÆ
[
__˙t
]; \

78 
__ªt
 =0; }))

	)

79 
	#__sig™d£t
(
de°
, 
À·
, 
right
) \

80 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

81 
sig£t_t
 *
__de°
 = (
de°
); \

82 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

83 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

84 --
__˙t
 >= 0) \

85 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

86 & 
__right
->
__vÆ
[
__˙t
]); \

87 0; }))

	)

88 
	#__sig‹£t
(
de°
, 
À·
, 
right
) \

89 (
	`__exãnsi⁄__
 ({ 
__˙t
 = 
_SIGSET_NWORDS
; \

90 
sig£t_t
 *
__de°
 = (
de°
); \

91 c⁄° 
sig£t_t
 *
__À·
 = (
À·
); \

92 c⁄° 
sig£t_t
 *
__right
 = (
right
); \

93 --
__˙t
 >= 0) \

94 
__de°
->
__vÆ
[
__˙t
] = (
__À·
->__val[__cnt] \

95 | 
__right
->
__vÆ
[
__˙t
]); \

96 0; }))

	)

103 
__sigismembî
 (
__c⁄°
 
__sig£t_t
 *, );

104 
__sigadd£t
 (
__sig£t_t
 *, );

105 
__sigdñ£t
 (
__sig£t_t
 *, );

107 #ifde‡
__USE_EXTERN_INLINES


108 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

109 
_EXTERN_INLINE
 \

110 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

112 
__mask
 = 
	`__sigmask
 (
__sig
); \

113 
__w‹d
 = 
	`__sigw‹d
 (
__sig
); \

114  
BODY
; \

115 }

	)

117 
__SIGSETFN
 (
__sigismembî
, (
__£t
->
__vÆ
[
__w‹d
] & 
__mask
Ë? 1 : 0, 
__c⁄°
)

118 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__vÆ
[
__w‹d
] |
__mask
), 0), )

119 
__SIGSETFN
 (
__sigdñ£t
, ((
__£t
->
__vÆ
[
__w‹d
] &~
__mask
), 0), )

121 #unde‡
__SIGSETFN


	@/usr/include/bits/sigstack.h

20 #i‚de‡
_SIGNAL_H


26 
	ssig°ack


28 *
	mss_•
;

29 
	mss_⁄°ack
;

36 
	mSS_ONSTACK
 = 1,

37 
	#SS_ONSTACK
 
SS_ONSTACK


	)

38 
	mSS_DISABLE


39 
	#SS_DISABLE
 
SS_DISABLE


	)

43 
	#MINSIGSTKSZ
 2048

	)

46 
	#SIGSTKSZ
 8192

	)

50 
	ssigÆt°ack


52 *
	mss_•
;

53 
	mss_Êags
;

54 
size_t
 
	mss_size
;

55 } 
	t°ack_t
;

	@/usr/include/bits/sigthread.h

20 #i‚de‡
_BITS_SIGTHREAD_H


21 
	#_BITS_SIGTHREAD_H
 1

	)

23 #i‡!
deföed
 
_SIGNAL_H
 && !deföed 
_PTHREAD_H


31 
	$±hªad_sigmask
 (
__how
,

32 
__c⁄°
 
__sig£t_t
 *
__ª°ri˘
 
__√wmask
,

33 
__sig£t_t
 *
__ª°ri˘
 
__ﬁdmask
)
__THROW
;

36 
	$±hªad_kûl
 (
±hªad_t
 
__thªadid
, 
__signo
Ë
__THROW
;

	@/usr/include/bits/sockaddr.h

24 #i‚de‡
_BITS_SOCKADDR_H


25 
	#_BITS_SOCKADDR_H
 1

	)

29 
	tß_Ámûy_t
;

35 
	#__SOCKADDR_COMMON
(
ß_¥efix
) \

36 
ß_Ámûy_t
 
ß_¥efix
##
Ámûy


	)

38 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/socket.h

20 #i‚de‡
__BITS_SOCKET_H


21 
	#__BITS_SOCKET_H


	)

23 #i‡!
deföed
 
_SYS_SOCKET_H
 && !deföed 
_NETINET_IN_H


27 
	#__√ed_size_t


	)

28 
	#__√ed_NULL


	)

29 
	~<°ddef.h
>

31 
	~<limôs.h
>

32 
	~<sys/ty≥s.h
>

35 #i‚de‡
__sockÀn_t_deföed


36 
__sockÀn_t
 
	tsockÀn_t
;

37 
	#__sockÀn_t_deföed


	)

41 
	e__sockë_ty≥


43 
	mSOCK_STREAM
 = 1,

45 
	#SOCK_STREAM
 
SOCK_STREAM


	)

46 
	mSOCK_DGRAM
 = 2,

48 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

49 
	mSOCK_RAW
 = 3,

50 
	#SOCK_RAW
 
SOCK_RAW


	)

51 
	mSOCK_RDM
 = 4,

52 
	#SOCK_RDM
 
SOCK_RDM


	)

53 
	mSOCK_SEQPACKET
 = 5,

55 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

56 
	mSOCK_PACKET
 = 10

59 
	#SOCK_PACKET
 
SOCK_PACKET


	)

63 
	#PF_UNSPEC
 0

	)

64 
	#PF_LOCAL
 1

	)

65 
	#PF_UNIX
 
PF_LOCAL


	)

66 
	#PF_FILE
 
PF_LOCAL


	)

67 
	#PF_INET
 2

	)

68 
	#PF_AX25
 3

	)

69 
	#PF_IPX
 4

	)

70 
	#PF_APPLETALK
 5

	)

71 
	#PF_NETROM
 6

	)

72 
	#PF_BRIDGE
 7

	)

73 
	#PF_ATMPVC
 8

	)

74 
	#PF_X25
 9

	)

75 
	#PF_INET6
 10

	)

76 
	#PF_ROSE
 11

	)

77 
	#PF_DEC√t
 12

	)

78 
	#PF_NETBEUI
 13

	)

79 
	#PF_SECURITY
 14

	)

80 
	#PF_KEY
 15

	)

81 
	#PF_NETLINK
 16

	)

82 
	#PF_ROUTE
 
PF_NETLINK


	)

83 
	#PF_PACKET
 17

	)

84 
	#PF_ASH
 18

	)

85 
	#PF_ECONET
 19

	)

86 
	#PF_ATMSVC
 20

	)

87 
	#PF_SNA
 22

	)

88 
	#PF_IRDA
 23

	)

89 
	#PF_PPPOX
 24

	)

90 
	#PF_WANPIPE
 25

	)

91 
	#PF_BLUETOOTH
 31

	)

92 
	#PF_MAX
 32

	)

95 
	#AF_UNSPEC
 
PF_UNSPEC


	)

96 
	#AF_LOCAL
 
PF_LOCAL


	)

97 
	#AF_UNIX
 
PF_UNIX


	)

98 
	#AF_FILE
 
PF_FILE


	)

99 
	#AF_INET
 
PF_INET


	)

100 
	#AF_AX25
 
PF_AX25


	)

101 
	#AF_IPX
 
PF_IPX


	)

102 
	#AF_APPLETALK
 
PF_APPLETALK


	)

103 
	#AF_NETROM
 
PF_NETROM


	)

104 
	#AF_BRIDGE
 
PF_BRIDGE


	)

105 
	#AF_ATMPVC
 
PF_ATMPVC


	)

106 
	#AF_X25
 
PF_X25


	)

107 
	#AF_INET6
 
PF_INET6


	)

108 
	#AF_ROSE
 
PF_ROSE


	)

109 
	#AF_DEC√t
 
PF_DEC√t


	)

110 
	#AF_NETBEUI
 
PF_NETBEUI


	)

111 
	#AF_SECURITY
 
PF_SECURITY


	)

112 
	#AF_KEY
 
PF_KEY


	)

113 
	#AF_NETLINK
 
PF_NETLINK


	)

114 
	#AF_ROUTE
 
PF_ROUTE


	)

115 
	#AF_PACKET
 
PF_PACKET


	)

116 
	#AF_ASH
 
PF_ASH


	)

117 
	#AF_ECONET
 
PF_ECONET


	)

118 
	#AF_ATMSVC
 
PF_ATMSVC


	)

119 
	#AF_SNA
 
PF_SNA


	)

120 
	#AF_IRDA
 
PF_IRDA


	)

121 
	#AF_PPPOX
 
PF_PPPOX


	)

122 
	#AF_WANPIPE
 
PF_WANPIPE


	)

123 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

124 
	#AF_MAX
 
PF_MAX


	)

130 
	#SOL_RAW
 255

	)

131 
	#SOL_DECNET
 261

	)

132 
	#SOL_X25
 262

	)

133 
	#SOL_PACKET
 263

	)

134 
	#SOL_ATM
 264

	)

135 
	#SOL_AAL
 265

	)

136 
	#SOL_IRDA
 266

	)

139 
	#SOMAXCONN
 128

	)

142 
	~<bôs/sockaddr.h
>

145 
	ssockaddr


147 
__SOCKADDR_COMMON
 (
ß_
);

148 
	mß_d©a
[14];

154 #i‡
ULONG_MAX
 > 0xffffffff

155 
	#__ss_Æig¡y≥
 
__uöt64_t


	)

157 
	#__ss_Æig¡y≥
 
__uöt32_t


	)

159 
	#_SS_SIZE
 128

	)

160 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_Æig¡y≥
)))

	)

162 
	ssockaddr_°‹age


164 
__SOCKADDR_COMMON
 (
ss_
);

165 
__ss_Æig¡y≥
 
	m__ss_Æign
;

166 
	m__ss_∑ddög
[
_SS_PADSIZE
];

173 
	mMSG_OOB
 = 0x01,

174 
	#MSG_OOB
 
MSG_OOB


	)

175 
	mMSG_PEEK
 = 0x02,

176 
	#MSG_PEEK
 
MSG_PEEK


	)

177 
	mMSG_DONTROUTE
 = 0x04,

178 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

179 #ifde‡
__USE_GNU


181 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

182 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

184 
	mMSG_CTRUNC
 = 0x08,

185 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

186 
	mMSG_PROXY
 = 0x10,

187 
	#MSG_PROXY
 
MSG_PROXY


	)

188 
	mMSG_TRUNC
 = 0x20,

189 
	#MSG_TRUNC
 
MSG_TRUNC


	)

190 
	mMSG_DONTWAIT
 = 0x40,

191 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

192 
	mMSG_EOR
 = 0x80,

193 
	#MSG_EOR
 
MSG_EOR


	)

194 
	mMSG_WAITALL
 = 0x100,

195 
	#MSG_WAITALL
 
MSG_WAITALL


	)

196 
	mMSG_FIN
 = 0x200,

197 
	#MSG_FIN
 
MSG_FIN


	)

198 
	mMSG_SYN
 = 0x400,

199 
	#MSG_SYN
 
MSG_SYN


	)

200 
	mMSG_CONFIRM
 = 0x800,

201 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

202 
	mMSG_RST
 = 0x1000,

203 
	#MSG_RST
 
MSG_RST


	)

204 
	mMSG_ERRQUEUE
 = 0x2000,

205 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

206 
	mMSG_NOSIGNAL
 = 0x4000,

207 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

208 
	mMSG_MORE
 = 0x8000

209 
	#MSG_MORE
 
MSG_MORE


	)

215 
	smsghdr


217 *
	mmsg_«me
;

218 
sockÀn_t
 
	mmsg_«mñí
;

220 
iovec
 *
	mmsg_iov
;

221 
size_t
 
	mmsg_iovÀn
;

223 *
	mmsg_c⁄åﬁ
;

224 
size_t
 
	mmsg_c⁄åﬁÀn
;

226 
	mmsg_Êags
;

230 
	scmsghdr


232 
size_t
 
	mcmsg_Àn
;

234 
	mcmsg_Àvñ
;

235 
	mcmsg_ty≥
;

236 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

237 
__exãnsi⁄__
 
__cmsg_d©a
 
	m__Êex¨r
;

242 #i‡(!
deföed
 
__STRICT_ANSI__
 && 
__GNUC__
 >2Ë|| 
__STDC_VERSION__
 >= 199901L

243 
	#CMSG_DATA
(
cmsg
Ë((cmsg)->
__cmsg_d©a
)

	)

245 
	#CMSG_DATA
(
cmsg
Ë((*Ë((
cmsghdr
 *Ë(cmsgË+ 1))

	)

247 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
Ë
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

248 
	#CMSG_FIRSTHDR
(
mhdr
) \

249 ((
size_t
Ë(
mhdr
)->
msg_c⁄åﬁÀn
 > (
cmsghdr
) \

250 ? (
cmsghdr
 *Ë(
mhdr
)->
msg_c⁄åﬁ
 : (cmsghd∏*Ë
NULL
)

	)

251 
	#CMSG_ALIGN
(
Àn
Ë((÷íË+  (
size_t
) - 1) \

252 & (
size_t
Ë~( (size_tË- 1))

	)

253 
	#CMSG_SPACE
(
Àn
Ë(
	`CMSG_ALIGN
 (len) \

254 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

255 
	#CMSG_LEN
(
Àn
Ë(
	`CMSG_ALIGN
 ( (
cmsghdr
)Ë+ (Àn))

	)

257 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

258 
cmsghdr
 *
__cmsg
Ë
__THROW
;

259 #ifde‡
__USE_EXTERN_INLINES


260 #i‚de‡
_EXTERN_INLINE


261 
	#_EXTERN_INLINE
 
__ölöe


	)

263 
_EXTERN_INLINE
 
cmsghdr
 *

264 
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
Ë
__THROW


266 i‡((
size_t
Ë
__cmsg
->
cmsg_Àn
 <  (
cmsghdr
))

270 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

271 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Àn
));

272 i‡((*Ë(
__cmsg
 + 1Ë> ((*Ë
__mhdr
->
msg_c⁄åﬁ


273 + 
__mhdr
->
msg_c⁄åﬁÀn
)

274 || ((*Ë
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Àn
)

275 > ((*Ë
__mhdr
->
msg_c⁄åﬁ
 + __mhdr->
msg_c⁄åﬁÀn
)))

278  
__cmsg
;

279 
	}
}

286 
SCM_RIGHTS
 = 0x01,

287 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

288 #ifde‡
__USE_BSD


289 
SCM_CREDENTIALS
 = 0x02,

290 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

292 
__SCM_CONNECT
 = 0x03

297 
	su¸ed


299 
pid_t
 
	mpid
;

300 
uid_t
 
	muid
;

301 
gid_t
 
	mgid
;

305 
	~<asm/sockë.h
>

309 
	slögî


311 
	ml_⁄off
;

312 
	ml_lögî
;

	@/usr/include/bits/stat.h

19 #i‚de‡
_SYS_STAT_H


24 
	#_STAT_VER_LINUX_OLD
 1

	)

25 
	#_STAT_VER_KERNEL
 1

	)

26 
	#_STAT_VER_SVR4
 2

	)

27 
	#_STAT_VER_LINUX
 3

	)

28 
	#_STAT_VER
 
_STAT_VER_LINUX


	)

31 
	#_MKNOD_VER_LINUX
 1

	)

32 
	#_MKNOD_VER_SVR4
 2

	)

33 
	#_MKNOD_VER
 
_MKNOD_VER_LINUX


	)

36 
	s°©


38 
__dev_t
 
	m°_dev
;

39 
	m__∑d1
;

40 #i‚de‡
__USE_FILE_OFFSET64


41 
__öo_t
 
	m°_öo
;

43 
__öo_t
 
	m__°_öo
;

45 
__mode_t
 
	m°_mode
;

46 
__∆ök_t
 
	m°_∆ök
;

47 
__uid_t
 
	m°_uid
;

48 
__gid_t
 
	m°_gid
;

49 
__dev_t
 
	m°_rdev
;

50 
	m__∑d2
;

51 #i‚de‡
__USE_FILE_OFFSET64


52 
__off_t
 
	m°_size
;

54 
__off64_t
 
	m°_size
;

56 
__blksize_t
 
	m°_blksize
;

58 #i‚de‡
__USE_FILE_OFFSET64


59 
__blk˙t_t
 
	m°_blocks
;

61 
__blk˙t64_t
 
	m°_blocks
;

63 #ifde‡
__USE_MISC


70 
time•ec
 
	m°_©im
;

71 
time•ec
 
	m°_mtim
;

72 
time•ec
 
	m°_˘im
;

73 
	#°_©ime
 
°_©im
.
tv_£c


	)

74 
	#°_mtime
 
°_mtim
.
tv_£c


	)

75 
	#°_˘ime
 
°_˘im
.
tv_£c


	)

77 
__time_t
 
	m°_©ime
;

78 
	m°_©imí£c
;

79 
__time_t
 
	m°_mtime
;

80 
	m°_mtimí£c
;

81 
__time_t
 
	m°_˘ime
;

82 
	m°_˘imí£c
;

84 #i‚de‡
__USE_FILE_OFFSET64


85 
	m__unu£d4
;

86 
	m__unu£d5
;

88 
__öo64_t
 
	m°_öo
;

92 #ifde‡
__USE_LARGEFILE64


93 
	s°©64


95 
__dev_t
 
	m°_dev
;

96 
	m__∑d1
;

98 
__öo_t
 
	m__°_öo
;

99 
__mode_t
 
	m°_mode
;

100 
__∆ök_t
 
	m°_∆ök
;

101 
__uid_t
 
	m°_uid
;

102 
__gid_t
 
	m°_gid
;

103 
__dev_t
 
	m°_rdev
;

104 
	m__∑d2
;

105 
__off64_t
 
	m°_size
;

106 
__blksize_t
 
	m°_blksize
;

108 
__blk˙t64_t
 
	m°_blocks
;

109 #ifde‡
__USE_MISC


116 
time•ec
 
	m°_©im
;

117 
time•ec
 
	m°_mtim
;

118 
time•ec
 
	m°_˘im
;

120 
__time_t
 
	m°_©ime
;

121 
	m°_©imí£c
;

122 
__time_t
 
	m°_mtime
;

123 
	m°_mtimí£c
;

124 
__time_t
 
	m°_˘ime
;

125 
	m°_˘imí£c
;

127 
__öo64_t
 
	m°_öo
;

132 
	#_STATBUF_ST_BLKSIZE


	)

133 
	#_STATBUF_ST_RDEV


	)

135 
	#_STATBUF_ST_NSEC


	)

139 
	#__S_IFMT
 0170000

	)

142 
	#__S_IFDIR
 0040000

	)

143 
	#__S_IFCHR
 0020000

	)

144 
	#__S_IFBLK
 0060000

	)

145 
	#__S_IFREG
 0100000

	)

146 
	#__S_IFIFO
 0010000

	)

147 
	#__S_IFLNK
 0120000

	)

148 
	#__S_IFSOCK
 0140000

	)

152 
	#__S_TYPEISMQ
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

153 
	#__S_TYPEISSEM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

154 
	#__S_TYPEISSHM
(
buf
Ë((buf)->
°_mode
 - (buf)->°_mode)

	)

158 
	#__S_ISUID
 04000

	)

159 
	#__S_ISGID
 02000

	)

160 
	#__S_ISVTX
 01000

	)

161 
	#__S_IREAD
 0400

	)

162 
	#__S_IWRITE
 0200

	)

163 
	#__S_IEXEC
 0100

	)

	@/usr/include/bits/stdio.h

20 #i‚de‡
_STDIO_H


24 #ifde‡
__˝lu•lus


25 
	#__STDIO_INLINE
 
ölöe


	)

27 
	#__STDIO_INLINE
 
__ölöe


	)

31 #ifde‡
__USE_EXTERN_INLINES


33 
__STDIO_INLINE
 

34 
	$v¥ötf
 (
__c⁄°
 *
__ª°ri˘
 
__fmt
, 
_G_va_li°
 
__¨g
)

36  
	`vÂrötf
 (
°dout
, 
__fmt
, 
__¨g
);

37 
	}
}

40 
__STDIO_INLINE
 

41 
	$gëch¨
 ()

43  
	`_IO_gëc
 (
°dö
);

44 
	}
}

47 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


49 
__STDIO_INLINE
 

50 
	$gëc_u∆ocked
 (
FILE
 *
__Â
)

52  
	`_IO_gëc_u∆ocked
 (
__Â
);

53 
	}
}

56 
__STDIO_INLINE
 

57 
	$gëch¨_u∆ocked
 ()

59  
	`_IO_gëc_u∆ocked
 (
°dö
);

60 
	}
}

65 
__STDIO_INLINE
 

66 
	$putch¨
 (
__c
)

68  
	`_IO_putc
 (
__c
, 
°dout
);

69 
	}
}

72 #ifde‡
__USE_MISC


74 
__STDIO_INLINE
 

75 
	$Âutc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

77  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

78 
	}
}

82 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


84 
__STDIO_INLINE
 

85 
	$putc_u∆ocked
 (
__c
, 
FILE
 *
__°ªam
)

87  
	`_IO_putc_u∆ocked
 (
__c
, 
__°ªam
);

88 
	}
}

91 
__STDIO_INLINE
 

92 
	$putch¨_u∆ocked
 (
__c
)

94  
	`_IO_putc_u∆ocked
 (
__c
, 
°dout
);

95 
	}
}

99 #ifdef 
__USE_GNU


101 
__STDIO_INLINE
 
_IO_ssize_t


102 
	$gëlöe
 (**
__löïå
, 
size_t
 *
__n
, 
FILE
 *
__°ªam
)

104  
	`__gëdñim
 (
__löïå
, 
__n
, '\n', 
__°ªam
);

105 
	}
}

109 #ifde‡
__USE_MISC


111 
__STDIO_INLINE
 

112 
	$„of_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW


114  
	`_IO_„of_u∆ocked
 (
__°ªam
);

115 
	}
}

118 
__STDIO_INLINE
 

119 
	$„º‹_u∆ocked
 (
FILE
 *
__°ªam
Ë
__THROW


121  
	`_IO_„º‹_u∆ocked
 (
__°ªam
);

122 
	}
}

128 #i‡
deföed
 
__USE_MISC
 && deföed 
__GNUC__
 && deföed 
__OPTIMIZE__


130 
	#‰ód_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

131 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

132 && (
size_t
Ë((
size
Ë* (
n
)) <= 8 && (size) != 0) \

133 ? ({ *
__±r
 = (*Ë(
±r
); \

134 
FILE
 *
__°ªam
 = (
°ªam
); \

135 
size_t
 
__˙t
; \

136 
__˙t
 = (
size
Ë* (
n
); __cnt > 0; --__cnt) \

138 
__c
 = 
	`_IO_gëc_u∆ocked
 (
__°ªam
); \

139 i‡(
__c
 =
EOF
) \

141 *
__±r
++ = 
__c
; \

143 ((
size_t
Ë((
size
Ë* (
n
)Ë- 
__˙t
) / (size); }) \

144 : (((
	`__buûtö_c⁄°™t_p
 (
size
) && (size) == 0) \

145 || (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) == 0)) \

147 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), \

148 (Ë(
n
), 0) \

149 : 
	`‰ód_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

151 
	#fwrôe_u∆ocked
(
±r
, 
size
, 
n
, 
°ªam
) \

152 (
	`__exãnsi⁄__
 ((
	`__buûtö_c⁄°™t_p
 (
size
Ë&& __buûtö_c⁄°™t_∞(
n
) \

153 && (
size_t
Ë((
size
Ë* (
n
)) <= 8 && (size) != 0) \

154 ? ({ c⁄° *
__±r
 = (c⁄° *Ë(
±r
); \

155 
FILE
 *
__°ªam
 = (
°ªam
); \

156 
size_t
 
__˙t
; \

157 
__˙t
 = (
size
Ë* (
n
); __cnt > 0; --__cnt) \

158 i‡(
	`_IO_putc_u∆ocked
 (*
__±r
++, 
__°ªam
Ë=
EOF
) \

160 ((
size_t
Ë((
size
Ë* (
n
)Ë- 
__˙t
) / (size); }) \

161 : (((
	`__buûtö_c⁄°™t_p
 (
size
) && (size) == 0) \

162 || (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) == 0)) \

164 ? ((Ë(
±r
), (Ë(
°ªam
), (Ë(
size
), 
n
) \

165 : 
	`fwrôe_u∆ocked
 (
±r
, 
size
, 
n
, 
°ªam
))))

	)

169 #unde‡
__STDIO_INLINE


	@/usr/include/bits/stdio_lim.h

19 #i‡!
deföed
 
_STDIO_H
 && !deföed 
__√ed_FOPEN_MAX
 && !deföed 
__√ed_IOV_MAX


23 #ifde‡
_STDIO_H


24 
	#L_tm≤am
 20

	)

25 
	#TMP_MAX
 238328

	)

26 
	#FILENAME_MAX
 4096

	)

28 #ifde‡
__USE_POSIX


29 
	#L_˘îmid
 9

	)

30 
	#L_cu£rid
 9

	)

34 #i‡
deföed
 
__√ed_FOPEN_MAX
 || deföed 
_STDIO_H


35 #unde‡
FOPEN_MAX


36 
	#FOPEN_MAX
 16

	)

39 #i‡
deföed
 
__√ed_IOV_MAX
 && !deföed 
IOV_MAX


40 
	#IOV_MAX
 1024

	)

	@/usr/include/bits/string.h

20 #i‚de‡
_STRING_H


25 
	#_STRING_ARCH_u«lig√d
 1

	)

30 #i‡!
deföed
 
__NO_STRING_INLINES
 && deföed 
__USE_STRING_INLINES
 \

31 && 
deföed
 
	g__GNUC__
 && __GNUC__ >2 && !
__BOUNDED_POINTERS__


33 #i‚de‡
__STRING_INLINE


34 #ifde‡
__˝lu•lus


35 
	#__STRING_INLINE
 
ölöe


	)

37 
	#__STRING_INLINE
 
__ölöe


	)

43 
	#_HAVE_STRING_ARCH_mem˝y
 1

	)

44 
	#mem˝y
(
de°
, 
§c
, 
n
) \

45 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

46 ? 
	`__mem˝y_c
 (
de°
, 
§c
, 
n
) \

47 : 
	`mem˝y
 (
de°
, 
§c
, 
n
)))

	)

50 
__STRING_INLINE
 *
__mem˝y_c
 (*
__de°
, 
__c⁄°
 *
__§c
,

51 
size_t
 
__n
);

53 
__STRING_INLINE
 *

54 
	$__mem˝y_c
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

56 
__d0
, 
__d1
, 
__d2
;

58 
__ui
;

59 
__usi
;

60 
__uc
;

61 } *
__u
 = 
__de°
;

62 
__n
)

65  
__de°
;

67 
__u
->
__uc
 = *(c⁄° *Ë
__§c
;

68  
__de°
;

70 
__u
->
__usi
 = *(c⁄° *Ë
__§c
;

71  
__de°
;

73 
__u
->
__usi
 = *(c⁄° *Ë
__§c
;

74 
__u
 = (*) __u + 2;

75 
__u
->
__uc
 = *(2 + (c⁄° *Ë
__§c
);

76  
__de°
;

78 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

79  
__de°
;

81 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

82 
__u
 = (*) __u + 4;

83 
__u
->
__usi
 = *(2 + (c⁄° *Ë
__§c
);

84  
__de°
;

86 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

87 
__u
 = (*) __u + 4;

88 
__u
->
__ui
 = *(1 + (c⁄° *Ë
__§c
);

89  
__de°
;

91 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

92 
__u
 = (*) __u + 4;

93 
__u
->
__ui
 = *(1 + (c⁄° *Ë
__§c
);

94 
__u
 = (*) __u + 4;

95 
__u
->
__ui
 = *(2 + (c⁄° *Ë
__§c
);

96  
__de°
;

98 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

99 
__u
 = (*) __u + 4;

100 
__u
->
__ui
 = *(1 + (c⁄° *Ë
__§c
);

101 
__u
 = (*) __u + 4;

102 
__u
->
__ui
 = *(2 + (c⁄° *Ë
__§c
);

103 
__u
 = (*) __u + 4;

104 
__u
->
__ui
 = *(3 + (c⁄° *Ë
__§c
);

105  
__de°
;

107 
__u
->
__ui
 = *(c⁄° *Ë
__§c
;

108 
__u
 = (*) __u + 4;

109 
__u
->
__ui
 = *(1 + (c⁄° *Ë
__§c
);

110 
__u
 = (*) __u + 4;

111 
__u
->
__ui
 = *(2 + (c⁄° *Ë
__§c
);

112 
__u
 = (*) __u + 4;

113 
__u
->
__ui
 = *(3 + (c⁄° *Ë
__§c
);

114 
__u
 = (*) __u + 4;

115 
__u
->
__ui
 = *(4 + (c⁄° *Ë
__§c
);

116  
__de°
;

118 
	#__COMMON_CODE
(
x
) \

119 
__asm__
 
__vﬁ©ûe__
 \

122 
x
 \

123 : "=&c" (
__d0
), "=&D" (
__d1
), "=&S" (
__d2
) \

124 : "0" (
__n
 / 4), "1" (&
__u
->
__uc
), "2" (
__§c
) \

125 : "mem‹y");

	)

127 
__n
 % 4)

130 
	`__COMMON_CODE
 ("");

133 
	`__COMMON_CODE
 ("\n\tmovsb");

136 
	`__COMMON_CODE
 ("\n\tmovsw");

139 
	`__COMMON_CODE
 ("\n\tmovsw\n\tmovsb");

142  
__de°
;

143 #unde‡
__COMMON_CODE


144 
	}
}

149 
	#_HAVE_STRING_ARCH_memmove
 1

	)

150 #i‚de‡
_FORCE_INLINES


151 
__STRING_INLINE
 *

152 
	$memmove
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

154 
__d0
, 
__d1
, 
__d2
;

155 i‡(
__de°
 < 
__§c
)

156 
__asm__
 
__vﬁ©ûe__


160 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

161 : "0" (
__n
), "1" (
__§c
), "2" (
__de°
)

164 
__asm__
 
__vﬁ©ûe__


169 : "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

170 : "0" (
__n
), "1" (__¿- 1 + (c⁄° *Ë
__§c
),

171 "2" (
__n
 - 1 + (*Ë
__de°
)

173  
__de°
;

174 
	}
}

178 
	#_HAVE_STRING_ARCH_mem£t
 1

	)

179 
	#_USE_STRING_ARCH_mem£t
 1

	)

180 
	#mem£t
(
s
, 
c
, 
n
) \

181 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

182 ? (
	`__buûtö_c⁄°™t_p
 (
n
) \

183 ? 
	`__mem£t_cc
 (
s
, 0x01010101UL * (Ë(
c
), 
n
) \

184 : 
	`__mem£t_cg
 (
s
, 0x01010101UL * (Ë(
c
), 
n
))\

185 : 
	`__mem£t_gg
 (
s
, 
c
, 
n
)))

	)

187 
__STRING_INLINE
 *
__mem£t_cc
 (*
__s
, 
__∑âîn
,

188 
size_t
 
__n
);

190 
__STRING_INLINE
 *

191 
	$__mem£t_cc
 (*
__s
, 
__∑âîn
, 
size_t
 
__n
)

193 
__d0
, 
__d1
;

195 
__ui
;

196 
__usi
;

197 
__uc
;

198 } *
__u
 = 
__s
;

199 
__n
)

202  
__s
;

204 
__u
->
__uc
 = 
__∑âîn
;

205  
__s
;

207 
__u
->
__usi
 = 
__∑âîn
;

208  
__s
;

210 
__u
->
__usi
 = 
__∑âîn
;

211 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

212 
__u
->
__uc
 = 
__∑âîn
;

213  
__s
;

215 
__u
->
__ui
 = 
__∑âîn
;

216  
__s
;

218 
	#__COMMON_CODE
(
x
) \

219 
__asm__
 
__vﬁ©ûe__
 \

222 
x
 \

223 : "=&c" (
__d0
), "=&D" (
__d1
) \

224 : "a" (
__∑âîn
), "0" (
__n
 / 4), "1" (&
__u
->
__uc
) \

225 : "mem‹y")

	)

227 
__n
 % 4)

230 
	`__COMMON_CODE
 ("");

233 
	`__COMMON_CODE
 ("\n\tstosb");

236 
	`__COMMON_CODE
 ("\n\tstosw");

239 
	`__COMMON_CODE
 ("\n\tstosw\n\tstosb");

242  
__s
;

243 #unde‡
__COMMON_CODE


244 
	}
}

246 
__STRING_INLINE
 *
__mem£t_cg
 (*
__s
, 
__c
, 
size_t
 
__n
);

248 
__STRING_INLINE
 *

249 
	$__mem£t_cg
 (*
__s
, 
__c
, 
size_t
 
__n
)

251 
__d0
, 
__d1
;

252 
__asm__
 
__vﬁ©ûe__


263 : "=&c" (
__d0
), "=&D" (
__d1
)

264 : "a" (
__c
), "q" (
__n
), "0" (__¿/ 4), "1" (
__s
)

266  
__s
;

267 
	}
}

269 
__STRING_INLINE
 *
__mem£t_gg
 (*
__s
, 
__c
, 
size_t
 
__n
);

271 
__STRING_INLINE
 *

272 
	$__mem£t_gg
 (*
__s
, 
__c
, 
size_t
 
__n
)

274 
__d0
, 
__d1
;

275 
__asm__
 
__vﬁ©ûe__


278 : "=&D" (
__d0
), "=&c" (
__d1
)

279 : "a" (
__c
), "0" (
__s
), "1" (
__n
)

281  
__s
;

282 
	}
}

288 
	#_HAVE_STRING_ARCH_memchr
 1

	)

289 #i‚de‡
_FORCE_INLINES


290 
__STRING_INLINE
 *

291 
	$memchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

293 
__d0
;

294 *
__ªs
;

295 i‡(
__n
 == 0)

296  
NULL
;

297 
__asm__
 
__vﬁ©ûe__


303 : "=D" (
__ªs
), "=&c" (
__d0
)

304 : "a" (
__c
), "0" (
__s
), "1" (
__n
)

306  
__ªs
 - 1;

307 
	}
}

310 
	#_HAVE_STRING_ARCH_memrchr
 1

	)

311 #i‚de‡
_FORCE_INLINES


312 
__STRING_INLINE
 *

313 
	$__memrchr
 (
__c⁄°
 *
__s
, 
__c
, 
size_t
 
__n
)

315 
__d0
;

316 *
__ªs
;

317 i‡(
__n
 == 0)

318  
NULL
;

319 
__asm__
 
__vﬁ©ûe__


326 : "=D" (
__ªs
), "=&c" (
__d0
)

327 : "a" (
__c
), "0" (
__s
 + 
__n
 - 1), "1" (__n)

329  
__ªs
;

330 
	}
}

331 #ifde‡
__USE_GNU


332 
	#memrchr
(
s
, 
c
, 
n
Ë
	`__memrchr
 (s, c,Ç)

	)

337 
	#_HAVE_STRING_ARCH_°æí
 1

	)

338 #i‚de‡
_FORCE_INLINES


339 
__STRING_INLINE
 
size_t


340 
	$°æí
 (
__c⁄°
 *
__°r
)

342 
__d0
;

343 
size_t
 
__ªs
;

344 
__asm__
 
__vﬁ©ûe__


348 : "=c" (
__ªs
), "=&D" (
__d0
)

349 : "1" (
__°r
), "a" (0), "0" (0xffffffff)

351  
__ªs
 - 1;

352 
	}
}

356 
	#_HAVE_STRING_ARCH_°r˝y
 1

	)

357 #i‚de‡
_FORCE_INLINES


358 
__STRING_INLINE
 *

359 
	$°r˝y
 (*
__de°
, 
__c⁄°
 *
__§c
)

361 
__d0
, 
__d1
;

362 
__asm__
 
__vﬁ©ûe__


369 : "=&S" (
__d0
), "=&D" (
__d1
)

370 : "0" (
__§c
), "1" (
__de°
)

372  
__de°
;

373 
	}
}

377 
	#_HAVE_STRING_ARCH_°∫˝y
 1

	)

378 #i‚de‡
_FORCE_INLINES


379 
__STRING_INLINE
 *

380 
	$°∫˝y
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

382 
__d0
, 
__d1
, 
__d2
;

383 
__asm__
 
__vﬁ©ûe__


394 : "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

395 : "0" (
__§c
), "1" (
__de°
), "2" (
__n
)

397  
__de°
;

398 
	}
}

402 
	#_HAVE_STRING_ARCH_°rˇt
 1

	)

403 #i‚de‡
_FORCE_INLINES


404 
__STRING_INLINE
 *

405 
	$°rˇt
 (*
__de°
, 
__c⁄°
 *
__§c
)

407 
__d0
, 
__d1
, 
__d2
, 
__d3
;

408 
__asm__
 
__vﬁ©ûe__


417 : "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
), "=&a" (
__d3
)

418 : "0" (
__§c
), "1" (
__de°
), "2" (0xffffffff), "3" (0)

420  
__de°
;

421 
	}
}

425 
	#_HAVE_STRING_ARCH_°∫ˇt
 1

	)

426 #i‚de‡
_FORCE_INLINES


427 
__STRING_INLINE
 *

428 
	$°∫ˇt
 (*
__de°
, 
__c⁄°
 *
__§c
, 
size_t
 
__n
)

430 
__d0
, 
__d1
, 
__d2
, 
__d3
;

431 
__asm__
 
__vﬁ©ûe__


448 : "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
), "=&a" (
__d3
)

449 : "g" (
__n
), "0" (
__§c
), "1" (
__de°
), "2" (0xffffffff), "3" (0)

451  
__de°
;

452 
	}
}

456 
	#_HAVE_STRING_ARCH_°rcmp
 1

	)

457 #i‚de‡
_FORCE_INLINES


458 
__STRING_INLINE
 

459 
	$°rcmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
)

461 
__d0
, 
__d1
;

462 
__ªs
;

463 
__asm__
 
__vﬁ©ûe__


477 : "˜" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
)

478 : "1" (
__s1
), "2" (
__s2
)

480  
__ªs
;

481 
	}
}

485 
	#_HAVE_STRING_ARCH_°∫cmp
 1

	)

486 #i‚de‡
_FORCE_INLINES


487 
__STRING_INLINE
 

488 
	$°∫cmp
 (
__c⁄°
 *
__s1
, __c⁄° *
__s2
, 
size_t
 
__n
)

490 
__d0
, 
__d1
, 
__d2
;

491 
__ªs
;

492 
__asm__
 
__vﬁ©ûe__


509 : "˜" (
__ªs
), "=&S" (
__d0
), "=&D" (
__d1
), "=&c" (
__d2
)

510 : "1" (
__s1
), "2" (
__s2
), "3" (
__n
)

512  
__ªs
;

513 
	}
}

517 
	#_HAVE_STRING_ARCH_°rchr
 1

	)

518 
	#_USE_STRING_ARCH_°rchr
 1

	)

519 
	#°rchr
(
s
, 
c
) \

520 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

521 ? 
	`__°rchr_c
 (
s
, ((
c
) & 0xff) << 8) \

522 : 
	`__°rchr_g
 (
s
, 
c
)))

	)

524 
__STRING_INLINE
 *
__°rchr_g
 (
__c⁄°
 *
__s
, 
__c
);

526 
__STRING_INLINE
 *

527 
	$__°rchr_g
 (
__c⁄°
 *
__s
, 
__c
)

529 
__d0
;

530 *
__ªs
;

531 
__asm__
 
__vﬁ©ûe__


543 : "˜" (
__ªs
), "=&S" (
__d0
)

544 : "0" (
__c
), "1" (
__s
)

546  
__ªs
 - 1;

547 
	}
}

549 
__STRING_INLINE
 *
__°rchr_c
 (
__c⁄°
 *
__s
, 
__c
);

551 
__STRING_INLINE
 *

552 
	$__°rchr_c
 (
__c⁄°
 *
__s
, 
__c
)

554 
__d0
;

555 *
__ªs
;

556 
__asm__
 
__vﬁ©ûe__


567 : "˜" (
__ªs
), "=&S" (
__d0
)

568 : "0" (
__c
), "1" (
__s
)

570  
__ªs
 - 1;

571 
	}
}

575 
	#_HAVE_STRING_ARCH_°rch∫ul
 1

	)

576 
	#__°rch∫ul
(
s
, 
c
) \

577 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) \

578 ? ((
c
) == '\0' \

579 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

580 : 
	`__°rch∫ul_c
 (
s
, ((
c
) & 0xff) << 8)) \

581 : 
	`__°rch∫ul_g
 (
s
, 
c
)))

	)

583 
__STRING_INLINE
 *
__°rch∫ul_g
 (
__c⁄°
 *
__s
, 
__c
);

585 
__STRING_INLINE
 *

586 
	$__°rch∫ul_g
 (
__c⁄°
 *
__s
, 
__c
)

588 
__d0
;

589 *
__ªs
;

590 
__asm__
 
__vﬁ©ûe__


601 : "˜" (
__ªs
), "=&S" (
__d0
)

602 : "0" (
__c
), "1" (
__s
)

604  
__ªs
 - 1;

605 
	}
}

607 
__STRING_INLINE
 *
__°rch∫ul_c
 (
__c⁄°
 *
__s
, 
__c
);

609 
__STRING_INLINE
 *

610 
	$__°rch∫ul_c
 (
__c⁄°
 *
__s
, 
__c
)

612 
__d0
;

613 *
__ªs
;

614 
__asm__
 
__vﬁ©ûe__


624 : "˜" (
__ªs
), "=&S" (
__d0
)

625 : "0" (
__c
), "1" (
__s
)

627  
__ªs
 - 1;

628 
	}
}

629 #ifde‡
__USE_GNU


630 
	#°rch∫ul
(
s
, 
c
Ë
	`__°rch∫ul
 (s, c)

	)

636 
	#_HAVE_STRING_ARCH_°rc•n
 1

	)

637 #i‚de‡
_FORCE_INLINES


638 #ifde‡
__PIC__


639 
__STRING_INLINE
 
size_t


640 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

642 
__d0
, 
__d1
, 
__d2
;

643 *
__ªs
;

644 
__asm__
 
__vﬁ©ûe__


662 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

663 : "d" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

665  (
__ªs
 - 1Ë- 
__s
;

666 
	}
}

668 
__STRING_INLINE
 
size_t


669 
	$°rc•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ªje˘
)

671 
__d0
, 
__d1
, 
__d2
, 
__d3
;

672 *
__ªs
;

673 
__asm__
 
__vﬁ©ûe__


689 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

690 : "g" (
__ªje˘
), "0" (
__s
), "1" (0), "2" (0xffffffff)

692  (
__ªs
 - 1Ë- 
__s
;

693 
	}
}

700 
	#_HAVE_STRING_ARCH_°r•n
 1

	)

701 #i‚de‡
_FORCE_INLINES


702 #ifde‡
__PIC__


703 
__STRING_INLINE
 
size_t


704 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

706 
__d0
, 
__d1
, 
__d2
;

707 *
__ªs
;

708 
__asm__
 
__vﬁ©ûe__


726 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

727 : "r" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

729  (
__ªs
 - 1Ë- 
__s
;

730 
	}
}

732 
__STRING_INLINE
 
size_t


733 
	$°r•n
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

735 
__d0
, 
__d1
, 
__d2
, 
__d3
;

736 *
__ªs
;

737 
__asm__
 
__vﬁ©ûe__


753 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

754 : "g" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

756  (
__ªs
 - 1Ë- 
__s
;

757 
	}
}

763 
	#_HAVE_STRING_ARCH_°Ωbrk
 1

	)

764 #i‚de‡
_FORCE_INLINES


765 #ifde‡
__PIC__


766 
__STRING_INLINE
 *

767 
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

769 
__d0
, 
__d1
, 
__d2
;

770 *
__ªs
;

771 
__asm__
 
__vﬁ©ûe__


793 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&D" (
__d2
)

794 : "r" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

796  
__ªs
;

797 
	}
}

799 
__STRING_INLINE
 *

800 
	$°Ωbrk
 (
__c⁄°
 *
__s
, __c⁄° *
__ac˚±
)

802 
__d0
, 
__d1
, 
__d2
, 
__d3
;

803 *
__ªs
;

804 
__asm__
 
__vﬁ©ûe__


824 : "=&S" (
__ªs
), "=&a" (
__d0
), "=&c" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

825 : "g" (
__ac˚±
), "0" (
__s
), "1" (0), "2" (0xffffffff)

827  
__ªs
;

828 
	}
}

834 
	#_HAVE_STRING_ARCH_°r°r
 1

	)

835 #i‚de‡
_FORCE_INLINES


836 #ifde‡
__PIC__


837 
__STRING_INLINE
 *

838 
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

840 
__d0
, 
__d1
, 
__d2
;

841 *
__ªs
;

842 
__asm__
 
__vﬁ©ûe__


863 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&D" (
__d2
)

864 : "r" (
__√edÀ
), "0" (0), "1" (0xffffffff), "2" (
__hay°ack
)

866  
__ªs
;

867 
	}
}

869 
__STRING_INLINE
 *

870 
	$°r°r
 (
__c⁄°
 *
__hay°ack
, __c⁄° *
__√edÀ
)

872 
__d0
, 
__d1
, 
__d2
, 
__d3
;

873 *
__ªs
;

874 
__asm__
 
__vﬁ©ûe__


893 : "=&a" (
__ªs
), "=&c" (
__d0
), "=&S" (
__d1
), "=&d" (
__d2
), "=&D" (
__d3
)

894 : "g" (
__√edÀ
), "0" (0), "1" (0xffffffff), "2" (
__hay°ack
)

896  
__ªs
;

897 
	}
}

901 #i‚de‡
_FORCE_INLINES


902 #unde‡
__STRING_INLINE


	@/usr/include/bits/string2.h

21 #i‚de‡
_STRING_H


25 #i‡!
deföed
 
__NO_STRING_INLINES
 && !deföed 
__BOUNDED_POINTERS__


42 #i‚de‡
__STRING_INLINE


43 #ifde‡
__˝lu•lus


44 
	#__STRING_INLINE
 
ölöe


	)

46 
	#__STRING_INLINE
 
__ölöe


	)

50 #i‡
_STRING_ARCH_u«lig√d


52 
	~<ídün.h
>

53 
	~<bôs/ty≥s.h
>

55 #i‡
__BYTE_ORDER
 =
__LITTLE_ENDIAN


56 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

57 (((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1] << 8 \

58 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
])

	)

59 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

60 (((((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 3] << 8 \

61 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

62 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

63 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
])

	)

65 
	#__STRING2_SMALL_GET16
(
§c
, 
idx
) \

66 (((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
] << 8 \

67 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1])

	)

68 
	#__STRING2_SMALL_GET32
(
§c
, 
idx
) \

69 (((((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
] << 8 \

70 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 1]) << 8 \

71 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 2]) << 8 \

72 | ((
__c⁄°
 *Ë(__c⁄° *Ë(
§c
))[
idx
 + 3])

	)

77 
	#__STRING2_COPY_TYPE
(
N
) \

78 °ru˘ { 
__¨r
[
N
]; } \

79 
	t__©åibuã__
 ((
	t__∑cked__
)Ë
	t__STRING2_COPY_ARR
##
	tN


	)

80 
	t__STRING2_COPY_TYPE
 (2);

81 
__STRING2_COPY_TYPE
 (3);

82 
__STRING2_COPY_TYPE
 (4);

83 
__STRING2_COPY_TYPE
 (5);

84 
__STRING2_COPY_TYPE
 (6);

85 
__STRING2_COPY_TYPE
 (7);

86 
__STRING2_COPY_TYPE
 (8);

87 #unde‡
__STRING2_COPY_TYPE


93 
	#__°rög2_1b±r_p
(
__x
) \

94 ((
size_t
)(c⁄° *)((
__x
Ë+ 1Ë- (size_t)(c⁄° *)(__xË=1)

	)

97 #i‚de‡
_HAVE_STRING_ARCH_mem£t


98 #i‡
_STRING_ARCH_u«lig√d


99 
	#mem£t
(
s
, 
c
, 
n
) \

100 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) && (n) <= 16 \

101 ? ((
n
) == 1 \

102 ? 
	`__mem£t_1
 (
s
, 
c
) \

103 : 
	`__mem£t_gc
 (
s
, 
c
, 
n
)) \

104 : (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

105 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

106 : 
	`mem£t
 (
s
, 
c
, 
n
))))

	)

108 
	#__mem£t_1
(
s
, 
c
Ë({ *
__s
 = (s); \

109 *((
__uöt8_t
 *Ë
__s
Ë(__uöt8_tË
c
; __s; })

	)

111 
	#__mem£t_gc
(
s
, 
c
, 
n
) \

112 ({ *
__s
 = (
s
); \

114 
__ui
; \

115 
__usi
; \

116 
__uc
; \

117 } *
__u
 = 
__s
; \

118 
__uöt8_t
 
__c
 = (__uöt8_tË(
c
); \

121 (Ë(
n
)) \

124 
__u
->
__ui
 = 
__c
 * 0x01010101; \

125 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

127 
__u
->
__ui
 = 
__c
 * 0x01010101; \

128 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

130 
__u
->
__ui
 = 
__c
 * 0x01010101; \

131 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

133 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

134 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2); \

135 
__u
->
__uc
 = (Ë
__c
; \

139 
__u
->
__ui
 = 
__c
 * 0x01010101; \

140 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

142 
__u
->
__ui
 = 
__c
 * 0x01010101; \

143 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

145 
__u
->
__ui
 = 
__c
 * 0x01010101; \

146 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

148 
__u
->
__usi
 = (Ë
__c
 * 0x0101; \

152 
__u
->
__ui
 = 
__c
 * 0x01010101; \

153 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

155 
__u
->
__ui
 = 
__c
 * 0x01010101; \

156 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

158 
__u
->
__ui
 = 
__c
 * 0x01010101; \

159 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

161 
__u
->
__uc
 = (Ë
__c
; \

165 
__u
->
__ui
 = 
__c
 * 0x01010101; \

166 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

168 
__u
->
__ui
 = 
__c
 * 0x01010101; \

169 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

171 
__u
->
__ui
 = 
__c
 * 0x01010101; \

172 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4); \

174 
__u
->
__ui
 = 
__c
 * 0x01010101; \

179 
__s
; })

	)

181 #i‡! 
__GNUC_PREREQ
 (3, 0)

182 
	#mem£t
(
s
, 
c
, 
n
) \

183 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

184 ? ({ *
__s
 = (
s
); 
	`__bzîo
 (__s, 
n
); __s; }) \

185 : 
	`mem£t
 (
s
, 
c
, 
n
)))

	)

191 #i‡
__GNUC_PREREQ
 (2, 91)

192 
	#__bzîo
(
s
, 
n
Ë
	`__buûtö_mem£t
 (s, '\0',Ç)

	)

200 #ifde‡
__USE_GNU


201 #i‡!
deföed
 
_HAVE_STRING_ARCH_memp˝y
 || deföed 
_FORCE_INLINES


202 #i‚de‡
_HAVE_STRING_ARCH_memp˝y


203 #i‡
__GNUC_PREREQ
 (3, 0)

204 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

205 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

206 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

207 ? 
	`__buûtö_mem˝y
 (
de°
, 
§c
, 
n
) + (n) \

208 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

210 
	#__memp˝y
(
de°
, 
§c
, 
n
) \

211 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

212 && 
	`__°rög2_1b±r_p
 (
§c
Ë&& 
n
 <= 8 \

213 ? 
	`__memp˝y_smÆl
 (
de°
, 
	`__memp˝y_¨gs
 (
§c
), 
n
) \

214 : 
	`__memp˝y
 (
de°
, 
§c
, 
n
)))

	)

218 
	#memp˝y
(
de°
, 
§c
, 
n
Ë
	`__memp˝y
 (de°, src,Ç)

	)

221 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


222 #i‡
_STRING_ARCH_u«lig√d


223 #i‚de‡
_FORCE_INLINES


224 
	#__memp˝y_¨gs
(
§c
) \

225 ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[2], \

226 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[6], \

227 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

228 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

229 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

230 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

232 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , , , ,

233 
__uöt16_t
, __uöt16_t, 
__uöt32_t
,

234 
__uöt32_t
, 
size_t
);

235 
__STRING_INLINE
 *

236 
	$__memp˝y_smÆl
 (*
__de°1
,

237 
__§c0_1
, 
__§c2_1
, 
__§c4_1
, 
__§c6_1
,

238 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

239 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

240 
size_t
 
__§˛í
)

243 
__uöt32_t
 
__ui
;

244 
__uöt16_t
 
__usi
;

245 
__uc
;

246 
__c
;

247 } *
__u
 = 
__de°1
;

248 (Ë
__§˛í
)

251 
__u
->
__c
 = 
__§c0_1
;

252 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

255 
__u
->
__usi
 = 
__§c0_2
;

256 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

259 
__u
->
__usi
 = 
__§c0_2
;

260 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

261 
__u
->
__c
 = 
__§c2_1
;

262 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

265 
__u
->
__ui
 = 
__§c0_4
;

266 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

269 
__u
->
__ui
 = 
__§c0_4
;

270 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

271 
__u
->
__c
 = 
__§c4_1
;

272 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

275 
__u
->
__ui
 = 
__§c0_4
;

276 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

277 
__u
->
__usi
 = 
__§c4_2
;

278 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

281 
__u
->
__ui
 = 
__§c0_4
;

282 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

283 
__u
->
__usi
 = 
__§c4_2
;

284 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

285 
__u
->
__c
 = 
__§c6_1
;

286 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

289 
__u
->
__ui
 = 
__§c0_4
;

290 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

291 
__u
->
__ui
 = 
__§c4_4
;

292 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

295  (*Ë
__u
;

296 
	}
}

298 #i‚de‡
_FORCE_INLINES


299 
	#__memp˝y_¨gs
(
§c
) \

300 ((
__c⁄°
 *Ë(
§c
))[0], \

301 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

302 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1] } }), \

303 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

304 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

305 ((
__c⁄°
 *Ë(
§c
))[2] } }), \

306 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

307 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

308 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3] } }), \

309 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

310 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

311 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

312 ((
__c⁄°
 *Ë(
§c
))[4] } }), \

313 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

314 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

315 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

316 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5] } }), \

317 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

318 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

319 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

320 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

321 ((
__c⁄°
 *Ë(
§c
))[6] } }), \

322 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

323 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

324 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

325 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

326 ((
__c⁄°
 *Ë(
§c
))[6], ((__c⁄° *Ë(§c))[7] } })

	)

328 
__STRING_INLINE
 *
__memp˝y_smÆl
 (*, , 
__STRING2_COPY_ARR2
,

329 
__STRING2_COPY_ARR3
,

330 
__STRING2_COPY_ARR4
,

331 
__STRING2_COPY_ARR5
,

332 
__STRING2_COPY_ARR6
,

333 
__STRING2_COPY_ARR7
,

334 
__STRING2_COPY_ARR8
, 
size_t
);

335 
__STRING_INLINE
 *

336 
	$__memp˝y_smÆl
 (*
__de°
, 
__§c1
,

337 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

338 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

339 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

340 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

343 
__c
;

344 
__STRING2_COPY_ARR2
 
__sˇ2
;

345 
__STRING2_COPY_ARR3
 
__sˇ3
;

346 
__STRING2_COPY_ARR4
 
__sˇ4
;

347 
__STRING2_COPY_ARR5
 
__sˇ5
;

348 
__STRING2_COPY_ARR6
 
__sˇ6
;

349 
__STRING2_COPY_ARR7
 
__sˇ7
;

350 
__STRING2_COPY_ARR8
 
__sˇ8
;

351 } *
__u
 = 
__de°
;

352 (Ë
__§˛í
)

355 
__u
->
__c
 = 
__§c1
;

358 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

361 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

364 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

367 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

370 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

373 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

376 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

379  
	`__exãnsi⁄__
 ((*Ë
__u
 + 
__§˛í
);

380 
	}
}

388 #i‚de‡
_HAVE_STRING_ARCH_°rchr


389 *
__øwmemchr
 (c⁄° *
__s
, 
__c
);

390 
	#°rchr
(
s
, 
c
) \

391 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
c
) && (c) == '\0' \

392 ? (*Ë
	`__øwmemchr
 (
s
, 
c
) \

393 : 
	`°rchr
 (
s
, 
c
)))

	)

398 #i‡(!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)) \

399 || 
deföed
 
	g_FORCE_INLINES


400 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r˝y
 && !
__GNUC_PREREQ
 (3, 0)

401 
	#°r˝y
(
de°
, 
§c
) \

402 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

403 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

404 ? 
	`__°r˝y_smÆl
 (
de°
, 
	`__°r˝y_¨gs
 (
§c
), \

405 
	`°æí
 (
§c
) + 1) \

406 : (*Ë
	`mem˝y
 (
de°
, 
§c
, 
	`°æí
 (src) + 1)) \

407 : 
	`°r˝y
 (
de°
, 
§c
)))

	)

410 #i‡
_STRING_ARCH_u«lig√d


411 #i‚de‡
_FORCE_INLINES


412 
	#__°r˝y_¨gs
(
§c
) \

413 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

414 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

415 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

416 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

418 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

419 
__uöt32_t
, __uöt32_t, 
size_t
);

420 
__STRING_INLINE
 *

421 
	$__°r˝y_smÆl
 (*
__de°
,

422 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

423 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

424 
size_t
 
__§˛í
)

427 
__uöt32_t
 
__ui
;

428 
__uöt16_t
 
__usi
;

429 
__uc
;

430 } *
__u
 = (*Ë
__de°
;

431 (Ë
__§˛í
)

434 
__u
->
__uc
 = '\0';

437 
__u
->
__usi
 = 
__§c0_2
;

440 
__u
->
__usi
 = 
__§c0_2
;

441 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

442 
__u
->
__uc
 = '\0';

445 
__u
->
__ui
 = 
__§c0_4
;

448 
__u
->
__ui
 = 
__§c0_4
;

449 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

450 
__u
->
__uc
 = '\0';

453 
__u
->
__ui
 = 
__§c0_4
;

454 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

455 
__u
->
__usi
 = 
__§c4_2
;

458 
__u
->
__ui
 = 
__§c0_4
;

459 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

460 
__u
->
__usi
 = 
__§c4_2
;

461 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

462 
__u
->
__uc
 = '\0';

465 
__u
->
__ui
 = 
__§c0_4
;

466 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

467 
__u
->
__ui
 = 
__§c4_4
;

470  
__de°
;

471 
	}
}

473 #i‚de‡
_FORCE_INLINES


474 
	#__°r˝y_¨gs
(
§c
) \

475 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

476 { { ((
__c⁄°
 *Ë(
§c
))[0], '\0' } }), \

477 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

478 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

480 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

481 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

482 ((
__c⁄°
 *Ë(
§c
))[2], '\0' } }), \

483 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

484 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

485 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

487 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

488 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

489 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

490 ((
__c⁄°
 *Ë(
§c
))[4], '\0' } }), \

491 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

492 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

493 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

494 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

496 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

497 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

498 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

499 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

500 ((
__c⁄°
 *Ë(
§c
))[6], '\0' } })

	)

502 
__STRING_INLINE
 *
__°r˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

503 
__STRING2_COPY_ARR3
,

504 
__STRING2_COPY_ARR4
,

505 
__STRING2_COPY_ARR5
,

506 
__STRING2_COPY_ARR6
,

507 
__STRING2_COPY_ARR7
,

508 
__STRING2_COPY_ARR8
, 
size_t
);

509 
__STRING_INLINE
 *

510 
	$__°r˝y_smÆl
 (*
__de°
,

511 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

512 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

513 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

514 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

517 
__c
;

518 
__STRING2_COPY_ARR2
 
__sˇ2
;

519 
__STRING2_COPY_ARR3
 
__sˇ3
;

520 
__STRING2_COPY_ARR4
 
__sˇ4
;

521 
__STRING2_COPY_ARR5
 
__sˇ5
;

522 
__STRING2_COPY_ARR6
 
__sˇ6
;

523 
__STRING2_COPY_ARR7
 
__sˇ7
;

524 
__STRING2_COPY_ARR8
 
__sˇ8
;

525 } *
__u
 = (*Ë
__de°
;

526 (Ë
__§˛í
)

529 
__u
->
__c
 = '\0';

532 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

535 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

538 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

541 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

544 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

547 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

550 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

553  
__de°
;

554 
	}
}

560 #ifde‡
__USE_GNU


561 #i‡!
deföed
 
_HAVE_STRING_ARCH_°p˝y
 || deföed 
_FORCE_INLINES


562 #i‚de‡
_HAVE_STRING_ARCH_°p˝y


563 #i‡
__GNUC_PREREQ
 (3, 0)

564 
	#__°p˝y
(
de°
, 
§c
) \

565 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

566 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

567 ? 
	`__buûtö_°r˝y
 (
de°
, 
§c
Ë+ 
	`°æí
 (src) \

568 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

570 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

572 
	#__°p˝y
(
de°
, 
§c
) \

573 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
) \

574 ? (
	`__°rög2_1b±r_p
 (
§c
Ë&& 
	`°æí
 (src) + 1 <= 8 \

575 ? 
	`__°p˝y_smÆl
 (
de°
, 
	`__°p˝y_¨gs
 (
§c
), \

576 
	`°æí
 (
§c
) + 1) \

577 : ((*Ë(
__memp˝y
Ë(
de°
, 
§c
, 
	`°æí
 (src) + 1) \

579 : 
	`__°p˝y
 (
de°
, 
§c
)))

	)

583 
	#°p˝y
(
de°
, 
§c
Ë
	`__°p˝y
 (de°, src)

	)

586 #i‡!
__GNUC_PREREQ
 (3, 0Ë|| 
deföed
 
_FORCE_INLINES


587 #i‡
_STRING_ARCH_u«lig√d


588 #i‚de‡
_FORCE_INLINES


589 
	#__°p˝y_¨gs
(
§c
) \

590 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 0), \

591 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET16
 (
§c
, 4), \

592 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 0), \

593 
__exãnsi⁄__
 
	`__STRING2_SMALL_GET32
 (
§c
, 4)

	)

595 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__uöt16_t
, __uint16_t,

596 
__uöt32_t
, __uöt32_t, 
size_t
);

597 
__STRING_INLINE
 *

598 
	$__°p˝y_smÆl
 (*
__de°
,

599 
__uöt16_t
 
__§c0_2
, __uöt16_à
__§c4_2
,

600 
__uöt32_t
 
__§c0_4
, __uöt32_à
__§c4_4
,

601 
size_t
 
__§˛í
)

604 
__ui
;

605 
__usi
;

606 
__uc
;

607 
__c
;

608 } *
__u
 = (*Ë
__de°
;

609 (Ë
__§˛í
)

612 
__u
->
__uc
 = '\0';

615 
__u
->
__usi
 = 
__§c0_2
;

616 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

619 
__u
->
__usi
 = 
__§c0_2
;

620 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

621 
__u
->
__uc
 = '\0';

624 
__u
->
__ui
 = 
__§c0_4
;

625 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

628 
__u
->
__ui
 = 
__§c0_4
;

629 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

630 
__u
->
__uc
 = '\0';

633 
__u
->
__ui
 = 
__§c0_4
;

634 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

635 
__u
->
__usi
 = 
__§c4_2
;

636 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 1);

639 
__u
->
__ui
 = 
__§c0_4
;

640 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

641 
__u
->
__usi
 = 
__§c4_2
;

642 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 2);

643 
__u
->
__uc
 = '\0';

646 
__u
->
__ui
 = 
__§c0_4
;

647 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 4);

648 
__u
->
__ui
 = 
__§c4_4
;

649 
__u
 = 
	`__exãnsi⁄__
 ((*) __u + 3);

652  &
__u
->
__c
;

653 
	}
}

655 #i‚de‡
_FORCE_INLINES


656 
	#__°p˝y_¨gs
(
§c
) \

657 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR2
) \

658 { { ((
__c⁄°
 *Ë(
§c
))[0], '\0' } }), \

659 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR3
) \

660 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

662 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR4
) \

663 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

664 ((
__c⁄°
 *Ë(
§c
))[2], '\0' } }), \

665 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR5
) \

666 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

667 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

669 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR6
) \

670 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

671 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

672 ((
__c⁄°
 *Ë(
§c
))[4], '\0' } }), \

673 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR7
) \

674 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

675 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

676 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

678 
	`__exãnsi⁄__
 ((
__STRING2_COPY_ARR8
) \

679 { { ((
__c⁄°
 *Ë(
§c
))[0], ((__const *) (src))[1], \

680 ((
__c⁄°
 *Ë(
§c
))[2], ((__const *) (src))[3], \

681 ((
__c⁄°
 *Ë(
§c
))[4], ((__const *) (src))[5], \

682 ((
__c⁄°
 *Ë(
§c
))[6], '\0' } })

	)

684 
__STRING_INLINE
 *
__°p˝y_smÆl
 (*, 
__STRING2_COPY_ARR2
,

685 
__STRING2_COPY_ARR3
,

686 
__STRING2_COPY_ARR4
,

687 
__STRING2_COPY_ARR5
,

688 
__STRING2_COPY_ARR6
,

689 
__STRING2_COPY_ARR7
,

690 
__STRING2_COPY_ARR8
, 
size_t
);

691 
__STRING_INLINE
 *

692 
	$__°p˝y_smÆl
 (*
__de°
,

693 
__STRING2_COPY_ARR2
 
__§c2
, 
__STRING2_COPY_ARR3
 
__§c3
,

694 
__STRING2_COPY_ARR4
 
__§c4
, 
__STRING2_COPY_ARR5
 
__§c5
,

695 
__STRING2_COPY_ARR6
 
__§c6
, 
__STRING2_COPY_ARR7
 
__§c7
,

696 
__STRING2_COPY_ARR8
 
__§c8
, 
size_t
 
__§˛í
)

699 
__c
;

700 
__STRING2_COPY_ARR2
 
__sˇ2
;

701 
__STRING2_COPY_ARR3
 
__sˇ3
;

702 
__STRING2_COPY_ARR4
 
__sˇ4
;

703 
__STRING2_COPY_ARR5
 
__sˇ5
;

704 
__STRING2_COPY_ARR6
 
__sˇ6
;

705 
__STRING2_COPY_ARR7
 
__sˇ7
;

706 
__STRING2_COPY_ARR8
 
__sˇ8
;

707 } *
__u
 = (*Ë
__de°
;

708 (Ë
__§˛í
)

711 
__u
->
__c
 = '\0';

714 
__exãnsi⁄__
 
__u
->
__sˇ2
 = 
__§c2
;

717 
__exãnsi⁄__
 
__u
->
__sˇ3
 = 
__§c3
;

720 
__exãnsi⁄__
 
__u
->
__sˇ4
 = 
__§c4
;

723 
__exãnsi⁄__
 
__u
->
__sˇ5
 = 
__§c5
;

726 
__exãnsi⁄__
 
__u
->
__sˇ6
 = 
__§c6
;

729 
__exãnsi⁄__
 
__u
->
__sˇ7
 = 
__§c7
;

732 
__exãnsi⁄__
 
__u
->
__sˇ8
 = 
__§c8
;

735  
__de°
 + 
__§˛í
 - 1;

736 
	}
}

744 #i‚de‡
_HAVE_STRING_ARCH_°∫˝y


745 #i‡
deföed
 
_USE_STRING_ARCH_mem£t
 && deföed 
_USE_STRING_ARCH_memp˝y


746 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

747 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

748 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

749 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

750 ? (*Ë
	`mem˝y
 (
__de°
, 
§c
, 
n
) \

751 : (
	`mem£t
 (
	`__memp˝y
 (
__de°
, 
§c
, 
	`°æí
 (src)), \

752 '\0', 
n
 - 
	`°æí
 (
§c
)), \

753 
__de°
)) \

754 : 
	`°∫˝y
 (
__de°
, 
§c
, 
n
); }))

	)

756 
	#°∫˝y
(
de°
, 
§c
, 
n
) \

757 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

758 ? (
	`°æí
 (
§c
Ë+ 1 >((
size_t
Ë(
n
)) \

759 ? (*Ë
	`mem˝y
 (
de°
, 
§c
, 
n
) \

760 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)) \

761 : 
	`°∫˝y
 (
de°
, 
§c
, 
n
)))

	)

767 #i‚de‡
_HAVE_STRING_ARCH_°∫ˇt


768 #ifde‡
_USE_STRING_ARCH_°rchr


769 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

770 (
	`__exãnsi⁄__
 ({ *
__de°
 = (
de°
); \

771 
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

772 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

773 ? 
	`°rˇt
 (
__de°
, 
§c
) \

774 : (*((*Ë
	`__memp˝y
 (
	`°rchr
 (
__de°
, '\0'), \

775 
§c
, 
n
)Ë'\0', 
__de°
)) \

776 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
); }))

	)

778 
	#°∫ˇt
(
de°
, 
§c
, 
n
) \

779 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
§c
Ë&& __buûtö_c⁄°™t_∞(
n
) \

780 ? (
	`°æí
 (
§c
Ë< ((
size_t
Ë(
n
)) \

781 ? 
	`°rˇt
 (
de°
, 
§c
) \

782 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)) \

783 : 
	`°∫ˇt
 (
de°
, 
§c
, 
n
)))

	)

789 #i‚de‡
_HAVE_STRING_ARCH_°rcmp


790 
	#°rcmp
(
s1
, 
s2
) \

791 
__exãnsi⁄__
 \

792 ({ 
size_t
 
__s1_Àn
, 
__s2_Àn
; \

793 (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& __buûtö_c⁄°™t_∞(
s2
) \

794 && (
__s1_Àn
 = 
	`°æí
 (
s1
), 
__s2_Àn
 = såÀ¿(
s2
), \

795 (!
	`__°rög2_1b±r_p
 (
s1
Ë|| 
__s1_Àn
 >= 4) \

796 && (!
	`__°rög2_1b±r_p
 (
s2
Ë|| 
__s2_Àn
 >= 4)) \

797 ? 
	`memcmp
 ((
__c⁄°
 *Ë(
s1
), (__c⁄° *Ë(
s2
), \

798 (
__s1_Àn
 < 
__s2_Àn
 ? __s1_len : __s2_len) + 1) \

799 : (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

800 && (
__s1_Àn
 = 
	`°æí
 (
s1
), __s1_len < 4) \

801 ? (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

802 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s1_Àn
) \

803 : 
	`__°rcmp_cg
 (
s1
, 
s2
, 
__s1_Àn
)) \

804 : (
	`__buûtö_c⁄°™t_p
 (
s2
Ë&& 
	`__°rög2_1b±r_p
 (s2) \

805 && (
__s2_Àn
 = 
	`°æí
 (
s2
), __s2_len < 4) \

806 ? (
	`__buûtö_c⁄°™t_p
 (
s1
Ë&& 
	`__°rög2_1b±r_p
 (s1) \

807 ? 
	`__°rcmp_cc
 (
s1
, 
s2
, 
__s2_Àn
) \

808 : 
	`__°rcmp_gc
 (
s1
, 
s2
, 
__s2_Àn
)) \

809 : 
	`°rcmp
 (
s1
, 
s2
)))); })

	)

811 
	#__°rcmp_cc
(
s1
, 
s2
, 
l
) \

812 (
	`__exãnsi⁄__
 ({ 
__ªsu…
 = \

813 (((
__c⁄°
 *Ë(__c⁄° *Ë(
s1
))[0] \

814 - ((
__c⁄°
 *Ë(__c⁄° *)(
s2
))[0]);\

815 i‡(
l
 > 0 && 
__ªsu…
 == 0) \

817 
__ªsu…
 = (((
__c⁄°
 *) \

818 (
__c⁄°
 *Ë(
s1
))[1] \

819 - ((
__c⁄°
 *) \

820 (
__c⁄°
 *Ë(
s2
))[1]); \

821 i‡(
l
 > 1 && 
__ªsu…
 == 0) \

823 
__ªsu…
 = \

824 (((
__c⁄°
 *) \

825 (
__c⁄°
 *Ë(
s1
))[2] \

826 - ((
__c⁄°
 *) \

827 (
__c⁄°
 *Ë(
s2
))[2]); \

828 i‡(
l
 > 2 && 
__ªsu…
 == 0) \

829 
__ªsu…
 = \

830 (((
__c⁄°
 *) \

831 (
__c⁄°
 *Ë(
s1
))[3] \

832 - ((
__c⁄°
 *) \

833 (
__c⁄°
 *Ë(
s2
))[3]); \

836 
__ªsu…
; }))

	)

838 
	#__°rcmp_cg
(
s1
, 
s2
, 
l1
) \

839 (
	`__exãnsi⁄__
 ({ 
__c⁄°
 *
__s2
 = \

840 (
__c⁄°
 *Ë(__c⁄° *Ë(
s2
); \

841 
__ªsu…
 = \

842 (((
__c⁄°
 *Ë(__c⁄° *Ë(
s1
))[0] \

843 - 
__s2
[0]); \

844 i‡(
l1
 > 0 && 
__ªsu…
 == 0) \

846 
__ªsu…
 = (((
__c⁄°
 *) \

847 (
__c⁄°
 *Ë(
s1
))[1] - 
__s2
[1]); \

848 i‡(
l1
 > 1 && 
__ªsu…
 == 0) \

850 
__ªsu…
 = (((
__c⁄°
 *) \

851 (
__c⁄°
 *Ë(
s1
))[2] - 
__s2
[2]);\

852 i‡(
l1
 > 2 && 
__ªsu…
 == 0) \

853 
__ªsu…
 = (((
__c⁄°
 *) \

854 (
__c⁄°
 *Ë(
s1
))[3] \

855 - 
__s2
[3]); \

858 
__ªsu…
; }))

	)

860 
	#__°rcmp_gc
(
s1
, 
s2
, 
l2
) \

861 (
	`__exãnsi⁄__
 ({ 
__c⁄°
 *
__s1
 = \

862 (
__c⁄°
 *Ë(__c⁄° *Ë(
s1
); \

863 
__ªsu…
 = \

864 
__s1
[0] - ((
__c⁄°
 *) \

865 (
__c⁄°
 *Ë(
s2
))[0]; \

866 i‡(
l2
 > 0 && 
__ªsu…
 == 0) \

868 
__ªsu…
 = (
__s1
[1] \

869 - ((
__c⁄°
 *) \

870 (
__c⁄°
 *Ë(
s2
))[1]); \

871 i‡(
l2
 > 1 && 
__ªsu…
 == 0) \

873 
__ªsu…
 = \

874 (
__s1
[2] - ((
__c⁄°
 *) \

875 (
__c⁄°
 *Ë(
s2
))[2]); \

876 i‡(
l2
 > 2 && 
__ªsu…
 == 0) \

877 
__ªsu…
 = \

878 (
__s1
[3] \

879 - ((
__c⁄°
 *) \

880 (
__c⁄°
 *Ë(
s2
))[3]); \

883 
__ªsu…
; }))

	)

888 #i‚de‡
_HAVE_STRING_ARCH_°∫cmp


889 
	#°∫cmp
(
s1
, 
s2
, 
n
) \

890 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
n
) \

891 && ((
	`__buûtö_c⁄°™t_p
 (
s1
) \

892 && 
	`°æí
 (
s1
Ë< ((
size_t
Ë(
n
))) \

893 || (
	`__buûtö_c⁄°™t_p
 (
s2
) \

894 && 
	`°æí
 (
s2
Ë< ((
size_t
Ë(
n
)))) \

895 ? 
	`°rcmp
 (
s1
, 
s2
Ë: 
	`°∫cmp
 (s1, s2, 
n
)))

	)

901 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rc•n
 || deföed 
_FORCE_INLINES


902 #i‚de‡
_HAVE_STRING_ARCH_°rc•n


903 
	#°rc•n
(
s
, 
ªje˘
) \

904 
__exãnsi⁄__
 \

905 ({ 
__r0
, 
__r1
, 
__r2
; \

906 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

907 ? ((
__r0
 = ((
__c⁄°
 *Ë(
ªje˘
))[0], __r0 == '\0') \

908 ? 
	`°æí
 (
s
) \

909 : ((
__r1
 = ((
__c⁄°
 *Ë(
ªje˘
))[1], __r1 == '\0') \

910 ? 
	`__°rc•n_c1
 (
s
, 
__r0
) \

911 : ((
__r2
 = ((
__c⁄°
 *Ë(
ªje˘
))[2], __r2 == '\0') \

912 ? 
	`__°rc•n_c2
 (
s
, 
__r0
, 
__r1
) \

913 : (((
__c⁄°
 *Ë(
ªje˘
))[3] == '\0' \

914 ? 
	`__°rc•n_c3
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

915 : 
	`°rc•n
 (
s
, 
ªje˘
))))) \

916 : 
	`°rc•n
 (
s
, 
ªje˘
)); })

	)

919 
__STRING_INLINE
 
size_t
 
__°rc•n_c1
 (
__c⁄°
 *
__s
, 
__ªje˘
);

920 
__STRING_INLINE
 
size_t


921 
	$__°rc•n_c1
 (
__c⁄°
 *
__s
, 
__ªje˘
)

923 
size_t
 
__ªsu…
 = 0;

924 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘
)

925 ++
__ªsu…
;

926  
__ªsu…
;

927 
	}
}

929 
__STRING_INLINE
 
size_t
 
__°rc•n_c2
 (
__c⁄°
 *
__s
, 
__ªje˘1
,

930 
__ªje˘2
);

931 
__STRING_INLINE
 
size_t


932 
	$__°rc•n_c2
 (
__c⁄°
 *
__s
, 
__ªje˘1
, 
__ªje˘2
)

934 
size_t
 
__ªsu…
 = 0;

935 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


936 && 
__s
[
__ªsu…
] !
__ªje˘2
)

937 ++
__ªsu…
;

938  
__ªsu…
;

939 
	}
}

941 
__STRING_INLINE
 
size_t
 
__°rc•n_c3
 (
__c⁄°
 *
__s
, 
__ªje˘1
,

942 
__ªje˘2
, 
__ªje˘3
);

943 
__STRING_INLINE
 
size_t


944 
	$__°rc•n_c3
 (
__c⁄°
 *
__s
, 
__ªje˘1
, 
__ªje˘2
,

945 
__ªje˘3
)

947 
size_t
 
__ªsu…
 = 0;

948 
__s
[
__ªsu…
] !'\0' && __s[__ªsu…] !
__ªje˘1


949 && 
__s
[
__ªsu…
] !
__ªje˘2
 && __s[__ªsu…] !
__ªje˘3
)

950 ++
__ªsu…
;

951  
__ªsu…
;

952 
	}
}

958 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r•n
 || deföed 
_FORCE_INLINES


959 #i‚de‡
_HAVE_STRING_ARCH_°r•n


960 
	#°r•n
(
s
, 
ac˚±
) \

961 
__exãnsi⁄__
 \

962 ({ 
__a0
, 
__a1
, 
__a2
; \

963 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

964 ? ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

965 ? ((Ë(
s
), 0) \

966 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

967 ? 
	`__°r•n_c1
 (
s
, 
__a0
) \

968 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

969 ? 
	`__°r•n_c2
 (
s
, 
__a0
, 
__a1
) \

970 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

971 ? 
	`__°r•n_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

972 : 
	`°r•n
 (
s
, 
ac˚±
))))) \

973 : 
	`°r•n
 (
s
, 
ac˚±
)); })

	)

976 
__STRING_INLINE
 
size_t
 
__°r•n_c1
 (
__c⁄°
 *
__s
, 
__ac˚±
);

977 
__STRING_INLINE
 
size_t


978 
	$__°r•n_c1
 (
__c⁄°
 *
__s
, 
__ac˚±
)

980 
size_t
 
__ªsu…
 = 0;

982 
__s
[
__ªsu…
] =
__ac˚±
)

983 ++
__ªsu…
;

984  
__ªsu…
;

985 
	}
}

987 
__STRING_INLINE
 
size_t
 
__°r•n_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

988 
__ac˚±2
);

989 
__STRING_INLINE
 
size_t


990 
	$__°r•n_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
)

992 
size_t
 
__ªsu…
 = 0;

994 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2
)

995 ++
__ªsu…
;

996  
__ªsu…
;

997 
	}
}

999 
__STRING_INLINE
 
size_t
 
__°r•n_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1000 
__ac˚±2
, 
__ac˚±3
);

1001 
__STRING_INLINE
 
size_t


1002 
	$__°r•n_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
, 
__ac˚±3
)

1004 
size_t
 
__ªsu…
 = 0;

1006 
__s
[
__ªsu…
] =
__ac˚±1
 || __s[__ªsu…] =
__ac˚±2


1007 || 
__s
[
__ªsu…
] =
__ac˚±3
)

1008 ++
__ªsu…
;

1009  
__ªsu…
;

1010 
	}
}

1015 #i‡!
deföed
 
_HAVE_STRING_ARCH_°Ωbrk
 || deföed 
_FORCE_INLINES


1016 #i‚de‡
_HAVE_STRING_ARCH_°Ωbrk


1017 
	#°Ωbrk
(
s
, 
ac˚±
) \

1018 
__exãnsi⁄__
 \

1019 ({ 
__a0
, 
__a1
, 
__a2
; \

1020 (
	`__buûtö_c⁄°™t_p
 (
ac˚±
Ë&& 
	`__°rög2_1b±r_p
 (accept) \

1021 ? ((
__a0
 = ((
__c⁄°
 *Ë(
ac˚±
))[0], __a0 == '\0') \

1022 ? ((Ë(
s
), 
NULL
) \

1023 : ((
__a1
 = ((
__c⁄°
 *Ë(
ac˚±
))[1], __a1 == '\0') \

1024 ? 
	`°rchr
 (
s
, 
__a0
) \

1025 : ((
__a2
 = ((
__c⁄°
 *Ë(
ac˚±
))[2], __a2 == '\0') \

1026 ? 
	`__°Ωbrk_c2
 (
s
, 
__a0
, 
__a1
) \

1027 : (((
__c⁄°
 *Ë(
ac˚±
))[3] == '\0' \

1028 ? 
	`__°Ωbrk_c3
 (
s
, 
__a0
, 
__a1
, 
__a2
) \

1029 : 
	`°Ωbrk
 (
s
, 
ac˚±
))))) \

1030 : 
	`°Ωbrk
 (
s
, 
ac˚±
)); })

	)

1033 
__STRING_INLINE
 *
__°Ωbrk_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1034 
__ac˚±2
);

1035 
__STRING_INLINE
 *

1036 
	$__°Ωbrk_c2
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
)

1039 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2
)

1040 ++
__s
;

1041  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1042 
	}
}

1044 
__STRING_INLINE
 *
__°Ωbrk_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
,

1045 
__ac˚±2
, 
__ac˚±3
);

1046 
__STRING_INLINE
 *

1047 
	$__°Ωbrk_c3
 (
__c⁄°
 *
__s
, 
__ac˚±1
, 
__ac˚±2
,

1048 
__ac˚±3
)

1051 *
__s
 !'\0' && *__†!
__ac˚±1
 && *__†!
__ac˚±2


1052 && *
__s
 !
__ac˚±3
)

1053 ++
__s
;

1054  *
__s
 ='\0' ? 
NULL
 : (*Ë(
size_t
) __s;

1055 
	}
}

1061 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r°r
 && !
__GNUC_PREREQ
 (2, 97)

1062 
	#°r°r
(
hay°ack
, 
√edÀ
) \

1063 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
√edÀ
Ë&& 
	`__°rög2_1b±r_p
 (needle) \

1064 ? (((
__c⁄°
 *Ë(
√edÀ
))[0] == '\0' \

1065 ? (*Ë(
size_t
Ë(
hay°ack
) \

1066 : (((
__c⁄°
 *Ë(
√edÀ
))[1] == '\0' \

1067 ? 
	`°rchr
 (
hay°ack
, \

1068 ((
__c⁄°
 *Ë(
√edÀ
))[0]) \

1069 : 
	`°r°r
 (
hay°ack
, 
√edÀ
))) \

1070 : 
	`°r°r
 (
hay°ack
, 
√edÀ
)))

	)

1074 #i‡!
deföed
 
_HAVE_STRING_ARCH_°πok_r
 || deföed 
_FORCE_INLINES


1075 #i‚de‡
_HAVE_STRING_ARCH_°πok_r


1076 
	#__°πok_r
(
s
, 
£p
, 
√xç
) \

1077 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
£p
Ë&& 
	`__°rög2_1b±r_p
 (sep) \

1078 ? (((
__c⁄°
 *Ë(
£p
))[0] != '\0' \

1079 && ((
__c⁄°
 *Ë(
£p
))[1] == '\0' \

1080 ? 
	`__°πok_r_1c
 (
s
, ((
__c⁄°
 *Ë(
£p
))[0], 
√xç
) \

1081 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)) \

1082 : 
	`__°πok_r
 (
s
, 
£p
, 
√xç
)))

	)

1085 
__STRING_INLINE
 *
__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
);

1086 
__STRING_INLINE
 *

1087 
	$__°πok_r_1c
 (*
__s
, 
__£p
, **
__√xç
)

1089 *
__ªsu…
;

1090 i‡(
__s
 =
NULL
)

1091 
__s
 = *
__√xç
;

1092 *
__s
 =
__£p
)

1093 ++
__s
;

1094 
__ªsu…
 = 
NULL
;

1095 i‡(*
__s
 != '\0')

1097 
__ªsu…
 = 
__s
++;

1098 *
__s
 != '\0')

1099 i‡(*
__s
++ =
__£p
)

1101 
__s
[-1] = '\0';

1104 *
__√xç
 = 
__s
;

1106  
__ªsu…
;

1107 
	}
}

1108 #i‡
deföed
 
__USE_POSIX
 || deföed 
__USE_MISC


1109 
	#°πok_r
(
s
, 
£p
, 
√xç
Ë
	`__°πok_r
 (s, sï,Çexç)

	)

1114 #i‡!
deföed
 
_HAVE_STRING_ARCH_°r£p
 || deföed 
_FORCE_INLINES


1115 #i‚de‡
_HAVE_STRING_ARCH_°r£p


1117 *
__°r£p_g
 (**
__°rögp
, 
__c⁄°
 *
__dñim
);

1118 
	#__°r£p
(
s
, 
ªje˘
) \

1119 
__exãnsi⁄__
 \

1120 ({ 
__r0
, 
__r1
, 
__r2
; \

1121 (
	`__buûtö_c⁄°™t_p
 (
ªje˘
Ë&& 
	`__°rög2_1b±r_p
 (reject) \

1122 && (
__r0
 = ((
__c⁄°
 *Ë(
ªje˘
))[0], \

1123 ((
__c⁄°
 *Ë(
ªje˘
))[0] != '\0') \

1124 ? ((
__r1
 = ((
__c⁄°
 *Ë(
ªje˘
))[1], \

1125 ((
__c⁄°
 *Ë(
ªje˘
))[1] == '\0') \

1126 ? 
	`__°r£p_1c
 (
s
, 
__r0
) \

1127 : ((
__r2
 = ((
__c⁄°
 *Ë(
ªje˘
))[2], __r2 == '\0') \

1128 ? 
	`__°r£p_2c
 (
s
, 
__r0
, 
__r1
) \

1129 : (((
__c⁄°
 *Ë(
ªje˘
))[3] == '\0' \

1130 ? 
	`__°r£p_3c
 (
s
, 
__r0
, 
__r1
, 
__r2
) \

1131 : 
	`__°r£p_g
 (
s
, 
ªje˘
)))) \

1132 : 
	`__°r£p_g
 (
s
, 
ªje˘
)); })

	)

1135 
__STRING_INLINE
 *
__°r£p_1c
 (**
__s
, 
__ªje˘
);

1136 
__STRING_INLINE
 *

1137 
	$__°r£p_1c
 (**
__s
, 
__ªje˘
)

1139 *
__ªtvÆ
 = *
__s
;

1140 i‡(
__ªtvÆ
 !
NULL
 && (*
__s
 = 
	`°rchr
 (__ªtvÆ, 
__ªje˘
)) != NULL)

1141 *(*
__s
)++ = '\0';

1142  
__ªtvÆ
;

1143 
	}
}

1145 
__STRING_INLINE
 *
__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
);

1146 
__STRING_INLINE
 *

1147 
	$__°r£p_2c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
)

1149 *
__ªtvÆ
 = *
__s
;

1150 i‡(
__ªtvÆ
 !
NULL
)

1152 *
__˝
 = 
__ªtvÆ
;

1155 i‡(*
__˝
 == '\0')

1157 
__˝
 = 
NULL
;

1160 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
)

1162 *
__˝
++ = '\0';

1165 ++
__˝
;

1167 *
__s
 = 
__˝
;

1169  
__ªtvÆ
;

1170 
	}
}

1172 
__STRING_INLINE
 *
__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
,

1173 
__ªje˘3
);

1174 
__STRING_INLINE
 *

1175 
	$__°r£p_3c
 (**
__s
, 
__ªje˘1
, 
__ªje˘2
, 
__ªje˘3
)

1177 *
__ªtvÆ
 = *
__s
;

1178 i‡(
__ªtvÆ
 !
NULL
)

1180 *
__˝
 = 
__ªtvÆ
;

1183 i‡(*
__˝
 == '\0')

1185 
__˝
 = 
NULL
;

1188 i‡(*
__˝
 =
__ªje˘1
 || *__˝ =
__ªje˘2
 || *__˝ =
__ªje˘3
)

1190 *
__˝
++ = '\0';

1193 ++
__˝
;

1195 *
__s
 = 
__˝
;

1197  
__ªtvÆ
;

1198 
	}
}

1199 #ifde‡
__USE_BSD


1200 
	#°r£p
(
s
, 
ªje˘
Ë
	`__°r£p
 (s,Ñeje˘)

	)

1207 #ifde‡
__USE_MISC


1209 #i‡!
deföed
 
_HAVE_STRING_ARCH_°rdup
 || !deföed 
_HAVE_STRING_ARCH_°∫dup


1210 
	#__√ed_mÆloc_™d_ˇŒoc


	)

1211 
	~<°dlib.h
>

1214 #i‚de‡
_HAVE_STRING_ARCH_°rdup


1216 *
	$__°rdup
 (
__c⁄°
 *
__°rög
Ë
__THROW
 
__©åibuã_mÆloc__
;

1217 
	#__°rdup
(
s
) \

1218 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1219 ? (((
__c⁄°
 *Ë(
s
))[0] == '\0' \

1220 ? (*Ë
	`ˇŒoc
 (1, 1) \

1221 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1222 *
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1223 i‡(
__ªtvÆ
 !
NULL
) \

1224 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, 
__Àn
); \

1225 
__ªtvÆ
; 
	}
})) \

1226 : 
	`__°rdup
 (
s
)))

	)

1228 #i‡
deföed
 
__USE_SVID
 || deföed 
__USE_BSD
 || deföed 
__USE_XOPEN_EXTENDED


1229 
	#°rdup
(
s
Ë
	`__°rdup
 (s)

	)

1233 #i‚de‡
_HAVE_STRING_ARCH_°∫dup


1235 *
	$__°∫dup
 (
__c⁄°
 *
__°rög
, 
size_t
 
__n
)

1236 
__THROW
 
__©åibuã_mÆloc__
;

1237 
	#__°∫dup
(
s
, 
n
) \

1238 (
	`__exãnsi⁄__
 (
	`__buûtö_c⁄°™t_p
 (
s
Ë&& 
	`__°rög2_1b±r_p
 (s) \

1239 ? (((
__c⁄°
 *Ë(
s
))[0] == '\0' \

1240 ? (*Ë
	`ˇŒoc
 (1, 1) \

1241 : ({ 
size_t
 
__Àn
 = 
	`°æí
 (
s
) + 1; \

1242 
size_t
 
__n
 = (
n
); \

1243 *
__ªtvÆ
; \

1244 i‡(
__n
 < 
__Àn
) \

1245 
__Àn
 = 
__n
 + 1; \

1246 
__ªtvÆ
 = (*Ë
	`mÆloc
 (
__Àn
); \

1247 i‡(
__ªtvÆ
 !
NULL
) \

1249 
__ªtvÆ
[
__Àn
 - 1] = '\0'; \

1250 
__ªtvÆ
 = (*Ë
	`mem˝y
 (__ªtvÆ, 
s
, \

1251 
__Àn
 - 1); \

1253 
__ªtvÆ
; 
	}
})) \

1254 : 
	`__°∫dup
 (
s
, 
n
)))

	)

1256 #ifde‡
__USE_GNU


1257 
	#°∫dup
(
s
, 
n
Ë
	`__°∫dup
 (s,Ç)

	)

1263 #i‚de‡
_FORCE_INLINES


1264 #unde‡
__STRING_INLINE


	@/usr/include/bits/sys_errlist.h

20 #i‚de‡
_STDIO_H


26 #ifde‡ 
__USE_BSD


27 
sys_√º
;

28 
__c⁄°
 *__c⁄° 
sys_îæi°
[];

30 #ifde‡ 
__USE_GNU


31 
_sys_√º
;

32 
__c⁄°
 *__c⁄° 
_sys_îæi°
[];

	@/usr/include/bits/termios.h

21 #i‚de‡
_TERMIOS_H


25 
	tcc_t
;

26 
	t•ìd_t
;

27 
	ttcÊag_t
;

29 
	#NCCS
 32

	)

30 
	sãrmios


32 
tcÊag_t
 
	mc_iÊag
;

33 
tcÊag_t
 
	mc_oÊag
;

34 
tcÊag_t
 
	mc_cÊag
;

35 
tcÊag_t
 
	mc_lÊag
;

36 
cc_t
 
	mc_löe
;

37 
cc_t
 
	mc_cc
[
NCCS
];

38 
•ìd_t
 
	mc_i•ìd
;

39 
•ìd_t
 
	mc_o•ìd
;

40 
	#_HAVE_STRUCT_TERMIOS_C_ISPEED
 1

	)

41 
	#_HAVE_STRUCT_TERMIOS_C_OSPEED
 1

	)

45 
	#VINTR
 0

	)

46 
	#VQUIT
 1

	)

47 
	#VERASE
 2

	)

48 
	#VKILL
 3

	)

49 
	#VEOF
 4

	)

50 
	#VTIME
 5

	)

51 
	#VMIN
 6

	)

52 
	#VSWTC
 7

	)

53 
	#VSTART
 8

	)

54 
	#VSTOP
 9

	)

55 
	#VSUSP
 10

	)

56 
	#VEOL
 11

	)

57 
	#VREPRINT
 12

	)

58 
	#VDISCARD
 13

	)

59 
	#VWERASE
 14

	)

60 
	#VLNEXT
 15

	)

61 
	#VEOL2
 16

	)

64 
	#IGNBRK
 0000001

	)

65 
	#BRKINT
 0000002

	)

66 
	#IGNPAR
 0000004

	)

67 
	#PARMRK
 0000010

	)

68 
	#INPCK
 0000020

	)

69 
	#ISTRIP
 0000040

	)

70 
	#INLCR
 0000100

	)

71 
	#IGNCR
 0000200

	)

72 
	#ICRNL
 0000400

	)

73 
	#IUCLC
 0001000

	)

74 
	#IXON
 0002000

	)

75 
	#IXANY
 0004000

	)

76 
	#IXOFF
 0010000

	)

77 
	#IMAXBEL
 0020000

	)

80 
	#OPOST
 0000001

	)

81 
	#OLCUC
 0000002

	)

82 
	#ONLCR
 0000004

	)

83 
	#OCRNL
 0000010

	)

84 
	#ONOCR
 0000020

	)

85 
	#ONLRET
 0000040

	)

86 
	#OFILL
 0000100

	)

87 
	#OFDEL
 0000200

	)

88 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


89 
	#NLDLY
 0000400

	)

90 
	#NL0
 0000000

	)

91 
	#NL1
 0000400

	)

92 
	#CRDLY
 0003000

	)

93 
	#CR0
 0000000

	)

94 
	#CR1
 0001000

	)

95 
	#CR2
 0002000

	)

96 
	#CR3
 0003000

	)

97 
	#TABDLY
 0014000

	)

98 
	#TAB0
 0000000

	)

99 
	#TAB1
 0004000

	)

100 
	#TAB2
 0010000

	)

101 
	#TAB3
 0014000

	)

102 
	#BSDLY
 0020000

	)

103 
	#BS0
 0000000

	)

104 
	#BS1
 0020000

	)

105 
	#FFDLY
 0100000

	)

106 
	#FF0
 0000000

	)

107 
	#FF1
 0100000

	)

110 
	#VTDLY
 0040000

	)

111 
	#VT0
 0000000

	)

112 
	#VT1
 0040000

	)

114 #ifde‡
__USE_MISC


115 
	#XTABS
 0014000

	)

119 #ifde‡
__USE_MISC


120 
	#CBAUD
 0010017

	)

122 
	#B0
 0000000

	)

123 
	#B50
 0000001

	)

124 
	#B75
 0000002

	)

125 
	#B110
 0000003

	)

126 
	#B134
 0000004

	)

127 
	#B150
 0000005

	)

128 
	#B200
 0000006

	)

129 
	#B300
 0000007

	)

130 
	#B600
 0000010

	)

131 
	#B1200
 0000011

	)

132 
	#B1800
 0000012

	)

133 
	#B2400
 0000013

	)

134 
	#B4800
 0000014

	)

135 
	#B9600
 0000015

	)

136 
	#B19200
 0000016

	)

137 
	#B38400
 0000017

	)

138 #ifde‡
__USE_MISC


139 
	#EXTA
 
B19200


	)

140 
	#EXTB
 
B38400


	)

142 
	#CSIZE
 0000060

	)

143 
	#CS5
 0000000

	)

144 
	#CS6
 0000020

	)

145 
	#CS7
 0000040

	)

146 
	#CS8
 0000060

	)

147 
	#CSTOPB
 0000100

	)

148 
	#CREAD
 0000200

	)

149 
	#PARENB
 0000400

	)

150 
	#PARODD
 0001000

	)

151 
	#HUPCL
 0002000

	)

152 
	#CLOCAL
 0004000

	)

153 #ifde‡
__USE_MISC


154 
	#CBAUDEX
 0010000

	)

156 
	#B57600
 0010001

	)

157 
	#B115200
 0010002

	)

158 
	#B230400
 0010003

	)

159 
	#B460800
 0010004

	)

160 
	#B500000
 0010005

	)

161 
	#B576000
 0010006

	)

162 
	#B921600
 0010007

	)

163 
	#B1000000
 0010010

	)

164 
	#B1152000
 0010011

	)

165 
	#B1500000
 0010012

	)

166 
	#B2000000
 0010013

	)

167 
	#B2500000
 0010014

	)

168 
	#B3000000
 0010015

	)

169 
	#B3500000
 0010016

	)

170 
	#B4000000
 0010017

	)

171 
	#__MAX_BAUD
 
B4000000


	)

172 #ifde‡
__USE_MISC


173 
	#CIBAUD
 002003600000

	)

174 
	#CRTSCTS
 020000000000

	)

178 
	#ISIG
 0000001

	)

179 
	#ICANON
 0000002

	)

180 #i‡
deföed
 
__USE_MISC
 || deföed 
__USE_XOPEN


181 
	#XCASE
 0000004

	)

183 
	#ECHO
 0000010

	)

184 
	#ECHOE
 0000020

	)

185 
	#ECHOK
 0000040

	)

186 
	#ECHONL
 0000100

	)

187 
	#NOFLSH
 0000200

	)

188 
	#TOSTOP
 0000400

	)

189 #ifde‡
__USE_MISC


190 
	#ECHOCTL
 0001000

	)

191 
	#ECHOPRT
 0002000

	)

192 
	#ECHOKE
 0004000

	)

193 
	#FLUSHO
 0010000

	)

194 
	#PENDIN
 0040000

	)

196 
	#IEXTEN
 0100000

	)

199 
	#TCOOFF
 0

	)

200 
	#TCOON
 1

	)

201 
	#TCIOFF
 2

	)

202 
	#TCION
 3

	)

205 
	#TCIFLUSH
 0

	)

206 
	#TCOFLUSH
 1

	)

207 
	#TCIOFLUSH
 2

	)

210 
	#TCSANOW
 0

	)

211 
	#TCSADRAIN
 1

	)

212 
	#TCSAFLUSH
 2

	)

215 
	#_IOT_ãrmios
 \

216 
	`_IOT
 (
	`_IOTS
 (
cÊag_t
), 4, _IOTS (
cc_t
), 
NCCS
, _IOTS (
•ìd_t
), 2)

	)

	@/usr/include/bits/time.h

24 #i‚de‡
__√ed_timevÆ


25 #i‚de‡
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #i‡!
deföed
 
__STRICT_ANSI__
 && !deföed 
__USE_XOPEN2K


39 
	~<bôs/ty≥s.h
>

40 
__sysc⁄f
 ();

41 
	#CLK_TCK
 ((
__˛ock_t
Ë
	`__sysc⁄f
 (2)Ë

	)

44 #ifde‡
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

55 
	#TIMER_ABSTIME
 1

	)

61 #ifde‡
__√ed_timevÆ


62 #unde‡
__√ed_timevÆ


63 #i‚de‡
_STRUCT_TIMEVAL


64 
	#_STRUCT_TIMEVAL
 1

	)

65 
	~<bôs/ty≥s.h
>

69 
	stimevÆ


71 
__time_t
 
	mtv_£c
;

72 
__su£c⁄ds_t
 
	mtv_u£c
;

	@/usr/include/bits/types.h

24 #i‚def 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<„©uªs.h
>

28 
	~<bôs/w‹dsize.h
>

30 
	#__√ed_size_t


	)

31 
	~<°ddef.h
>

34 
	t__u_ch¨
;

35 
	t__u_sh‹t
;

36 
	t__u_öt
;

37 
	t__u_l⁄g
;

40 sig√d 
	t__öt8_t
;

41 
	t__uöt8_t
;

42 sig√d 
	t__öt16_t
;

43 
	t__uöt16_t
;

44 sig√d 
	t__öt32_t
;

45 
	t__uöt32_t
;

46 #i‡
__WORDSIZE
 == 64

47 sig√d 
	t__öt64_t
;

48 
	t__uöt64_t
;

49 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


50 
__exãnsi⁄__
 sig√d 
	t__öt64_t
;

51 
__exãnsi⁄__
 
	t__uöt64_t
;

55 #i‡
__WORDSIZE
 == 64

56 
	t__quad_t
;

57 
	t__u_quad_t
;

58 #ñi‡
deföed
 
__GLIBC_HAVE_LONG_LONG


59 
__exãnsi⁄__
 
	t__quad_t
;

60 
__exãnsi⁄__
 
	t__u_quad_t
;

64 
	m__vÆ
[2];

65 } 
	t__quad_t
;

68 
__u_l⁄g
 
	m__vÆ
[2];

69 } 
	t__u_quad_t
;

102 
	#__S16_TYPE
 

	)

103 
	#__U16_TYPE
 

	)

104 
	#__S32_TYPE
 

	)

105 
	#__U32_TYPE
 

	)

106 
	#__SLONGWORD_TYPE
 

	)

107 
	#__ULONGWORD_TYPE
 

	)

108 #i‡
__WORDSIZE
 == 32

109 
	#__SQUAD_TYPE
 

	)

110 
	#__UQUAD_TYPE
 

	)

111 
	#__SWORD_TYPE
 

	)

112 
	#__UWORD_TYPE
 

	)

113 
	#__SLONG32_TYPE
 

	)

114 
	#__ULONG32_TYPE
 

	)

115 
	#__S64_TYPE
 
__quad_t


	)

116 
	#__U64_TYPE
 
__u_quad_t


	)

117 #ñi‡
__WORDSIZE
 == 64

118 
	#__SQUAD_TYPE
 

	)

119 
	#__UQUAD_TYPE
 

	)

120 
	#__SWORD_TYPE
 

	)

121 
	#__UWORD_TYPE
 

	)

122 
	#__SLONG32_TYPE
 

	)

123 
	#__ULONG32_TYPE
 

	)

124 
	#__S64_TYPE
 

	)

125 
	#__U64_TYPE
 

	)

129 
	~<bôs/ty≥sizes.h
>

133 
	#__STD_TYPE
 
__exãnsi⁄__
 

	)

136 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

137 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

138 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

139 
__STD_TYPE
 
__INO_T_TYPE
 
	g__öo_t
;

140 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__öo64_t
;

141 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

142 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__∆ök_t
;

143 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

144 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

145 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

146 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

147 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__˛ock_t
;

148 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__æim_t
;

149 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__æim64_t
;

150 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

151 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

152 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£c⁄ds_t
;

153 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£c⁄ds_t
;

155 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

156 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

157 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

160 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__˛ockid_t
;

163 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__timî_t
;

166 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

171 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blk˙t_t
;

172 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blk˙t64_t
;

175 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblk˙t_t
;

176 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblk˙t64_t
;

179 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfû˙t_t
;

180 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfû˙t64_t
;

182 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

186 
__off64_t
 
	t__loff_t
;

187 
__quad_t
 *
	t__qaddr_t
;

188 *
	t__ˇddr_t
;

191 
__STD_TYPE
 
__SWORD_TYPE
 
	g__öçå_t
;

194 
__STD_TYPE
 
__U32_TYPE
 
	g__sockÀn_t
;

197 #unde‡
__STD_TYPE


	@/usr/include/bits/uio.h

19 #i‚de‡
_SYS_UIO_H


24 
	~<sys/ty≥s.h
>

38 
	#UIO_MAXIOV
 1024

	)

42 
	siovec


44 *
	miov_ba£
;

45 
size_t
 
	miov_Àn
;

	@/usr/include/bits/utmp.h

21 #i‚de‡
_UTMP_H


25 
	~<∑ths.h
>

26 
	~<sys/time.h
>

27 
	~<sys/ty≥s.h
>

28 
	~<bôs/w‹dsize.h
>

31 
	#UT_LINESIZE
 32

	)

32 
	#UT_NAMESIZE
 32

	)

33 
	#UT_HOSTSIZE
 256

	)

38 
	sœ°log


40 #i‡
__WORDSIZE
 =64 && 
deföed
 
__WORDSIZE_COMPAT32


41 
öt32_t
 
	mŒ_time
;

43 
__time_t
 
	mŒ_time
;

45 
	mŒ_löe
[
UT_LINESIZE
];

46 
	mŒ_ho°
[
UT_HOSTSIZE
];

52 
	sexô_°©us


54 
	me_ãrmö©i⁄
;

55 
	me_exô
;

60 
	sutmp


62 
	mut_ty≥
;

63 
pid_t
 
	mut_pid
;

64 
	mut_löe
[
UT_LINESIZE
];

65 
	mut_id
[4];

66 
	mut_u£r
[
UT_NAMESIZE
];

67 
	mut_ho°
[
UT_HOSTSIZE
];

68 
exô_°©us
 
	mut_exô
;

73 #i‡
__WORDSIZE
 =64 && 
deföed
 
__WORDSIZE_COMPAT32


74 
öt32_t
 
	mut_£ssi⁄
;

77 
öt32_t
 
	mtv_£c
;

78 
öt32_t
 
	mtv_u£c
;

79 } 
	mut_tv
;

81 
	mut_£ssi⁄
;

82 
timevÆ
 
	mut_tv
;

85 
öt32_t
 
	mut_addr_v6
[4];

86 
	m__unu£d
[20];

90 
	#ut_«me
 
ut_u£r


	)

91 #i‚de‡
_NO_UT_TIME


94 
	#ut_time
 
ut_tv
.
tv_£c


	)

96 
	#ut_xtime
 
ut_tv
.
tv_£c


	)

97 
	#ut_addr
 
ut_addr_v6
[0]

	)

101 
	#EMPTY
 0

	)

103 
	#RUN_LVL
 1

	)

104 
	#BOOT_TIME
 2

	)

105 
	#NEW_TIME
 3

	)

106 
	#OLD_TIME
 4

	)

108 
	#INIT_PROCESS
 5

	)

109 
	#LOGIN_PROCESS
 6

	)

110 
	#USER_PROCESS
 7

	)

111 
	#DEAD_PROCESS
 8

	)

113 
	#ACCOUNTING
 9

	)

116 
	#UT_UNKNOWN
 
EMPTY


	)

121 
	#_HAVE_UT_TYPE
 1

	)

122 
	#_HAVE_UT_PID
 1

	)

123 
	#_HAVE_UT_ID
 1

	)

124 
	#_HAVE_UT_TV
 1

	)

125 
	#_HAVE_UT_HOST
 1

	)

	@/usr/include/bits/utsname.h

19 #i‚de‡
_SYS_UTSNAME_H


24 
	#_UTSNAME_LENGTH
 65

	)

29 
	#_UTSNAME_DOMAIN_LENGTH
 
_UTSNAME_LENGTH


	)

	@/usr/include/bits/waitflags.h

20 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


26 
	#WNOHANG
 1

	)

27 
	#WUNTRACED
 2

	)

29 
	#__WALL
 0x40000000

	)

30 
	#__WCLONE
 0x80000000

	)

	@/usr/include/bits/waitstatus.h

20 #i‡!
deföed
 
_SYS_WAIT_H
 && !deföed 
_STDLIB_H


29 
	#__WEXITSTATUS
(
°©us
Ë(((°©usË& 0xff00Ë>> 8)

	)

32 
	#__WTERMSIG
(
°©us
Ë((°©usË& 0x7f)

	)

35 
	#__WSTOPSIG
(
°©us
Ë
	`__WEXITSTATUS
(°©us)

	)

38 
	#__WIFEXITED
(
°©us
Ë(
	`__WTERMSIG
(°©usË=0)

	)

41 #ifdef 
__GNUC__


42 
	#__WIFSIGNALED
(
°©us
) \

43 (
	`__exãnsi⁄__
 ({ 
__°©us
 = (
°©us
); \

44 !
	`__WIFSTOPPED
(
__°©us
Ë&& !
	`__WIFEXITED
(__°©us); }))

	)

46 
	#__WIFSIGNALED
(
°©us
Ë(!
	`__WIFSTOPPED
(°©usË&& !
	`__WIFEXITED
(°©us))

	)

50 
	#__WIFSTOPPED
(
°©us
Ë(((°©usË& 0xffË=0x7f)

	)

53 
	#__WCOREDUMP
(
°©us
Ë((°©usË& 
__WCOREFLAG
)

	)

56 
	#__W_EXITCODE
(
ªt
, 
sig
Ë(‘ëË<< 8 | (sig))

	)

57 
	#__W_STOPCODE
(
sig
Ë((sigË<< 8 | 0x7f)

	)

58 
	#__WCOREFLAG
 0x80

	)

61 #ifdef 
__USE_BSD


63 
	~<ídün.h
>

65 
	uwaô


67 
	mw_°©us
;

70 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


71 
	m__w_ãrmsig
:7;

72 
	m__w_c‹edump
:1;

73 
	m__w_ªtcode
:8;

76 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


78 
	m__w_ªtcode
:8;

79 
	m__w_c‹edump
:1;

80 
	m__w_ãrmsig
:7;

82 } 
	m__waô_ãrmö©ed
;

85 #if 
__BYTE_ORDER
 =
__LITTLE_ENDIAN


86 
	m__w_°›vÆ
:8;

87 
	m__w_°›sig
:8;

90 #if 
__BYTE_ORDER
 =
__BIG_ENDIAN


92 
	m__w_°›sig
:8;

93 
	m__w_°›vÆ
:8;

95 } 
	m__waô_°›≥d
;

98 
	#w_ãrmsig
 
__waô_ãrmö©ed
.
__w_ãrmsig


	)

99 
	#w_c‹edump
 
__waô_ãrmö©ed
.
__w_c‹edump


	)

100 
	#w_ªtcode
 
__waô_ãrmö©ed
.
__w_ªtcode


	)

101 
	#w_°›sig
 
__waô_°›≥d
.
__w_°›sig


	)

102 
	#w_°›vÆ
 
__waô_°›≥d
.
__w_°›vÆ


	)

	@/usr/include/bits/wordsize.h

19 
	#__WORDSIZE
 32

	)

	@/usr/include/bits/xopen_lim.h

30 #i‚de‡
_XOPEN_LIM_H


31 
	#_XOPEN_LIM_H
 1

	)

33 
	#__√ed_IOV_MAX


	)

34 
	~<bôs/°dio_lim.h
>

66 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

71 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

74 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

77 
	#NL_MSGMAX
 
INT_MAX


	)

81 
	#NL_NMAX
 
INT_MAX


	)

84 
	#NL_SETMAX
 
INT_MAX


	)

87 
	#NL_TEXTMAX
 
INT_MAX


	)

90 
	#NZERO
 20

	)

94 #ifde‡
INT_MAX


95 #i‡
INT_MAX
 == 32767

96 
	#WORD_BIT
 16

	)

98 #i‡
INT_MAX
 == 2147483647

99 
	#WORD_BIT
 32

	)

102 
	#WORD_BIT
 64

	)

105 #ñi‡
deföed
 
__INT_MAX__


106 #i‡
__INT_MAX__
 == 32767

107 
	#WORD_BIT
 16

	)

109 #i‡
__INT_MAX__
 == 2147483647

110 
	#WORD_BIT
 32

	)

113 
	#WORD_BIT
 64

	)

117 
	#WORD_BIT
 32

	)

121 #ifde‡
LONG_MAX


122 #i‡
LONG_MAX
 == 2147483647

123 
	#LONG_BIT
 32

	)

126 
	#LONG_BIT
 64

	)

128 #ñi‡
deföed
 
__LONG_MAX__


129 #i‡
__LONG_MAX__
 == 2147483647

130 
	#LONG_BIT
 32

	)

133 
	#LONG_BIT
 64

	)

136 
	~<bôs/w‹dsize.h
>

137 #i‡
__WORDSIZE
 == 64

138 
	#LONG_BIT
 64

	)

140 
	#LONG_BIT
 32

	)

	@/usr/include/features.h

19 #i‚def 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

86 #unde‡
__USE_ISOC99


87 #unde‡
__USE_POSIX


88 #unde‡
__USE_POSIX2


89 #unde‡
__USE_POSIX199309


90 #unde‡
__USE_POSIX199506


91 #unde‡
__USE_XOPEN


92 #unde‡
__USE_XOPEN_EXTENDED


93 #unde‡
__USE_UNIX98


94 #unde‡
__USE_XOPEN2K


95 #unde‡
__USE_LARGEFILE


96 #unde‡
__USE_LARGEFILE64


97 #unde‡
__USE_FILE_OFFSET64


98 #unde‡
__USE_BSD


99 #unde‡
__USE_SVID


100 #unde‡
__USE_MISC


101 #unde‡
__USE_GNU


102 #unde‡
__USE_REENTRANT


103 #unde‡
__FAVOR_BSD


104 #unde‡
__KERNEL_STRICT_NAMES


108 #i‚de‡
_LOOSE_KERNEL_NAMES


109 
	#__KERNEL_STRICT_NAMES


	)

113 
	#__USE_ANSI
 1

	)

117 #i‡
deföed
 
_BSD_SOURCE
 && \

118 !(
deföed
 
	g_POSIX_SOURCE
 || deföed 
	g_POSIX_C_SOURCE
 || \

119 
deföed
 
	g_XOPEN_SOURCE
 || deföed 
	g_XOPEN_SOURCE_EXTENDED
 || \

120 
deföed
 
	g_GNU_SOURCE
 || deföed 
	g_SVID_SOURCE
)

121 
	#__FAVOR_BSD
 1

	)

125 #ifde‡
_GNU_SOURCE


126 #unde‡
_ISOC99_SOURCE


127 
	#_ISOC99_SOURCE
 1

	)

128 #unde‡
_POSIX_SOURCE


129 
	#_POSIX_SOURCE
 1

	)

130 #unde‡
_POSIX_C_SOURCE


131 
	#_POSIX_C_SOURCE
 199506L

	)

132 #unde‡
_XOPEN_SOURCE


133 
	#_XOPEN_SOURCE
 600

	)

134 #unde‡
_XOPEN_SOURCE_EXTENDED


135 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

136 #unde‡
_LARGEFILE64_SOURCE


137 
	#_LARGEFILE64_SOURCE
 1

	)

138 #unde‡
_BSD_SOURCE


139 
	#_BSD_SOURCE
 1

	)

140 #unde‡
_SVID_SOURCE


141 
	#_SVID_SOURCE
 1

	)

146 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_ISOC99_SOURCE
 && \

147 !
deföed
 
	g_POSIX_SOURCE
 && !deföed 
	g_POSIX_C_SOURCE
 && \

148 !
deföed
 
	g_XOPEN_SOURCE
 && !deföed 
	g_XOPEN_SOURCE_EXTENDED
 && \

149 !
deföed
 
	g_BSD_SOURCE
 && !deföed 
	g_SVID_SOURCE
)

150 
	#_BSD_SOURCE
 1

	)

151 
	#_SVID_SOURCE
 1

	)

158 #i‡(
deföed
 
_ISOC99_SOURCE
 || deföed 
_ISOC9X_SOURCE
 \

159 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

160 
	#__USE_ISOC99
 1

	)

165 #i‡(!
deföed
 
__STRICT_ANSI__
 && !deföed 
_POSIX_SOURCE
 && \

166 !
deföed
 
_POSIX_C_SOURCE
)

167 
	#_POSIX_SOURCE
 1

	)

168 #i‡
deföed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

169 
	#_POSIX_C_SOURCE
 2

	)

171 
	#_POSIX_C_SOURCE
 199506L

	)

175 #i‡
deföed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || deföed 
_XOPEN_SOURCE


176 
	#__USE_POSIX
 1

	)

179 #i‡
deföed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || deföed 
_XOPEN_SOURCE


180 
	#__USE_POSIX2
 1

	)

183 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199309L

184 
	#__USE_POSIX199309
 1

	)

187 #i‡(
_POSIX_C_SOURCE
 - 0) >= 199506L

188 
	#__USE_POSIX199506
 1

	)

191 #i‡(
_POSIX_C_SOURCE
 - 0) >= 200112L

192 
	#__USE_XOPEN2K
 1

	)

195 #ifdef 
_XOPEN_SOURCE


196 
	#__USE_XOPEN
 1

	)

197 #i‡(
_XOPEN_SOURCE
 - 0) >= 500

198 
	#__USE_XOPEN_EXTENDED
 1

	)

199 
	#__USE_UNIX98
 1

	)

200 #unde‡
_LARGEFILE_SOURCE


201 
	#_LARGEFILE_SOURCE
 1

	)

202 #i‡(
_XOPEN_SOURCE
 - 0) >= 600

203 
	#__USE_XOPEN2K
 1

	)

204 #unde‡
__USE_ISOC99


205 
	#__USE_ISOC99
 1

	)

208 #ifde‡
_XOPEN_SOURCE_EXTENDED


209 
	#__USE_XOPEN_EXTENDED
 1

	)

214 #ifde‡
_LARGEFILE_SOURCE


215 
	#__USE_LARGEFILE
 1

	)

218 #ifde‡
_LARGEFILE64_SOURCE


219 
	#__USE_LARGEFILE64
 1

	)

222 #i‡
deföed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

223 
	#__USE_FILE_OFFSET64
 1

	)

226 #i‡
deföed
 
_BSD_SOURCE
 || deföed 
_SVID_SOURCE


227 
	#__USE_MISC
 1

	)

230 #ifdef 
_BSD_SOURCE


231 
	#__USE_BSD
 1

	)

234 #ifdef 
_SVID_SOURCE


235 
	#__USE_SVID
 1

	)

238 #ifdef 
_GNU_SOURCE


239 
	#__USE_GNU
 1

	)

242 #i‡
deföed
 
_REENTRANT
 || deföed 
_THREAD_SAFE


243 
	#__USE_REENTRANT
 1

	)

247 
	#__STDC_IEC_559__
 1

	)

248 
	#__STDC_IEC_559_COMPLEX__
 1

	)

251 
	#__STDC_ISO_10646__
 200009L

	)

259 #unde‡
__GNU_LIBRARY__


260 
	#__GNU_LIBRARY__
 6

	)

264 
	#__GLIBC__
 2

	)

265 
	#__GLIBC_MINOR__
 3

	)

274 #i‡
deföed
 
__GNUC__
 && deföed 
__GNUC_MINOR__


275 
	#__GNUC_PREREQ
(
maj
, 
mö
) \

276 ((
__GNUC__
 << 16Ë+ 
__GNUC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

278 
	#__GNUC_PREREQ
(
maj
, 
mö
Ë0

	)

281 
	#__GLIBC_PREREQ
(
maj
, 
mö
) \

282 ((
__GLIBC__
 << 16Ë+ 
__GLIBC_MINOR__
 >((
maj
Ë<< 16Ë+ (
mö
))

	)

285 #i‡
deföed
 
__GNUC__
 \

286 || (
deföed
 
	g__PGI
 && deföed 
	g__i386__
 ) \

287 || (
deföed
 
	g__INTEL_COMPILER
 && (deföed 
	g__i386__
 || deföed 
	g__ü64__
)) \

288 || (
deföed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

289 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

293 #i‚de‡
__ASSEMBLER__


294 #i‚de‡
_SYS_CDEFS_H


295 
	~<sys/cdefs.h
>

300 #i‡
deföed
 
__USE_FILE_OFFSET64
 && !deföed 
__REDIRECT


301 
	#__USE_LARGEFILE
 1

	)

302 
	#__USE_LARGEFILE64
 1

	)

308 #i‡
__GNUC_PREREQ
 (2, 7Ë&& 
deföed
 
__OPTIMIZE__
 \

309 && !
deföed
 
	g__OPTIMIZE_SIZE__
 && !deföed 
	g__NO_INLINE__


310 
	#__USE_EXTERN_INLINES
 1

	)

318 
	~<gnu/°ubs.h
>

	@/usr/include/libio.h

29 #i‚de‡
_IO_STDIO_H


30 
	#_IO_STDIO_H


	)

32 
	~<_G_c⁄fig.h
>

34 
	#_IO_pos_t
 
_G_Âos_t


	)

35 
	#_IO_Âos_t
 
_G_Âos_t


	)

36 
	#_IO_Âos64_t
 
_G_Âos64_t


	)

37 
	#_IO_size_t
 
_G_size_t


	)

38 
	#_IO_ssize_t
 
_G_ssize_t


	)

39 
	#_IO_off_t
 
_G_off_t


	)

40 
	#_IO_off64_t
 
_G_off64_t


	)

41 
	#_IO_pid_t
 
_G_pid_t


	)

42 
	#_IO_uid_t
 
_G_uid_t


	)

43 
	#_IO_ic⁄v_t
 
_G_ic⁄v_t


	)

44 
	#_IO_HAVE_SYS_WAIT
 
_G_HAVE_SYS_WAIT


	)

45 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

46 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

47 
	#_IO_va_li°
 
_G_va_li°


	)

48 
	#_IO_wöt_t
 
_G_wöt_t


	)

50 #ifde‡
_G_NEED_STDARG_H


52 
	#__√ed___va_li°


	)

53 
	~<°d¨g.h
>

54 #ifde‡
__GNUC_VA_LIST


55 #unde‡
_IO_va_li°


56 
	#_IO_va_li°
 
__gnuc_va_li°


	)

60 #i‚de‡
__P


61 #i‡
_G_HAVE_SYS_CDEFS


62 
	~<sys/cdefs.h
>

64 #ifde‡
__STDC__


65 
	#__P
(
p
Ë
	)
p

66 
	#__PMT
(
p
Ë
	)
p

68 
	#__P
(
p
Ë()

	)

69 
	#__PMT
(
p
Ë()

	)

75 #i‚de‡
_PARAMS


76 
	#_PARAMS
(
¥Ÿos
Ë
	`__P
’rŸos)

	)

79 #i‚de‡
__STDC__


81 c⁄°

	)

84 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

85 #i‚de‡
_G_HAVE_PRINTF_FP


86 
	#_IO_USE_DTOA
 1

	)

89 #i‚de‡
EOF


90 
	#EOF
 (-1)

	)

92 #i‚de‡
NULL


93 #i‡
deföed
 
__GNUG__
 && \

94 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

95 
	#NULL
 (
__nuŒ
)

	)

97 #i‡!
deföed
(
__˝lu•lus
)

98 
	#NULL
 ((*)0)

	)

100 
	#NULL
 (0)

	)

105 
	#_IOS_INPUT
 1

	)

106 
	#_IOS_OUTPUT
 2

	)

107 
	#_IOS_ATEND
 4

	)

108 
	#_IOS_APPEND
 8

	)

109 
	#_IOS_TRUNC
 16

	)

110 
	#_IOS_NOCREATE
 32

	)

111 
	#_IOS_NOREPLACE
 64

	)

112 
	#_IOS_BIN
 128

	)

120 
	#_IO_MAGIC
 0xFBAD0000

	)

121 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

122 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

123 
	#_IO_USER_BUF
 1

	)

124 
	#_IO_UNBUFFERED
 2

	)

125 
	#_IO_NO_READS
 4

	)

126 
	#_IO_NO_WRITES
 8

	)

127 
	#_IO_EOF_SEEN
 0x10

	)

128 
	#_IO_ERR_SEEN
 0x20

	)

129 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

130 
	#_IO_LINKED
 0x80

	)

131 
	#_IO_IN_BACKUP
 0x100

	)

132 
	#_IO_LINE_BUF
 0x200

	)

133 
	#_IO_TIED_PUT_GET
 0x400

	)

134 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

135 
	#_IO_IS_APPENDING
 0x1000

	)

136 
	#_IO_IS_FILEBUF
 0x2000

	)

137 
	#_IO_BAD_SEEN
 0x4000

	)

138 
	#_IO_USER_LOCK
 0x8000

	)

140 
	#_IO_FLAGS2_MMAP
 1

	)

141 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

144 
	#_IO_SKIPWS
 01

	)

145 
	#_IO_LEFT
 02

	)

146 
	#_IO_RIGHT
 04

	)

147 
	#_IO_INTERNAL
 010

	)

148 
	#_IO_DEC
 020

	)

149 
	#_IO_OCT
 040

	)

150 
	#_IO_HEX
 0100

	)

151 
	#_IO_SHOWBASE
 0200

	)

152 
	#_IO_SHOWPOINT
 0400

	)

153 
	#_IO_UPPERCASE
 01000

	)

154 
	#_IO_SHOWPOS
 02000

	)

155 
	#_IO_SCIENTIFIC
 04000

	)

156 
	#_IO_FIXED
 010000

	)

157 
	#_IO_UNITBUF
 020000

	)

158 
	#_IO_STDIO
 040000

	)

159 
	#_IO_DONT_CLOSE
 0100000

	)

160 
	#_IO_BOOLALPHA
 0200000

	)

163 
_IO_jump_t
; 
	g_IO_FILE
;

166 #ifde‡
_IO_MTSAFE_IO


167 #i‡
deföed
 
__GLIBC__
 && __GLIBC__ >= 2

168 
	~<bôs/°dio-lock.h
>

173 
	t_IO_lock_t
;

179 
	s_IO_m¨kî
 {

180 
_IO_m¨kî
 *
	m_√xt
;

181 
_IO_FILE
 *
	m_sbuf
;

185 
	m_pos
;

187 
£t_°ªampos
(
°ªampos
 
•
Ë{ 
	m_•os
 = sp; }

188 
£t_off£t
(
off£t
Ë{ 
	m_pos
 = off£t; 
	m_•os
 = (
°ªampos
)(-2); }

189 
	mpublic
:

190 
°ªamm¨kî
(
°ªambuf
 *
sb
);

191 ~
°ªamm¨kî
();

192 
ßvög
(Ë{  
	m_•os
 == -2; }

193 
dñè
(
°ªamm¨kî
&);

194 
dñè
();

199 
	e__codecvt_ªsu…


201 
	m__codecvt_ok
,

202 
	m__codecvt_∑πül
,

203 
	m__codecvt_îr‹
,

204 
	m__codecvt_noc⁄v


207 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


210 
	s_IO_codecvt


212 (*
	m__codecvt_de°r
Ë(
	m_IO_codecvt
 *);

213 
__codecvt_ªsu…
 (*
__codecvt_do_out
Ë(
	m_IO_codecvt
 *,

214 
	m__mb°©e_t
 *,

215 c⁄° 
	mwch¨_t
 *,

216 c⁄° 
	mwch¨_t
 *,

217 c⁄° 
	mwch¨_t
 **, *,

219 
__codecvt_ªsu…
 (*
__codecvt_do_unshi·
Ë(
	m_IO_codecvt
 *,

220 
	m__mb°©e_t
 *, *,

222 
__codecvt_ªsu…
 (*
__codecvt_do_ö
Ë(
	m_IO_codecvt
 *,

223 
	m__mb°©e_t
 *,

225 c⁄° **, 
	mwch¨_t
 *,

226 
	mwch¨_t
 *, wchar_t **);

227 (*
	m__codecvt_do_ícodög
Ë(
	m_IO_codecvt
 *);

228 (*
	m__codecvt_do_Æways_noc⁄v
Ë(
	m_IO_codecvt
 *);

229 (*
	m__codecvt_do_Àngth
Ë(
	m_IO_codecvt
 *, 
	m__mb°©e_t
 *,

230 c⁄° *, c⁄° *, 
	m_IO_size_t
);

231 (*
	m__codecvt_do_max_Àngth
Ë(
	m_IO_codecvt
 *);

233 
_IO_ic⁄v_t
 
	m__cd_ö
;

234 
_IO_ic⁄v_t
 
	m__cd_out
;

238 
	s_IO_wide_d©a


240 
wch¨_t
 *
	m_IO_ªad_±r
;

241 
wch¨_t
 *
	m_IO_ªad_íd
;

242 
wch¨_t
 *
	m_IO_ªad_ba£
;

243 
wch¨_t
 *
	m_IO_wrôe_ba£
;

244 
wch¨_t
 *
	m_IO_wrôe_±r
;

245 
wch¨_t
 *
	m_IO_wrôe_íd
;

246 
wch¨_t
 *
	m_IO_buf_ba£
;

247 
wch¨_t
 *
	m_IO_buf_íd
;

249 
wch¨_t
 *
	m_IO_ßve_ba£
;

250 
wch¨_t
 *
	m_IO_backup_ba£
;

252 
wch¨_t
 *
	m_IO_ßve_íd
;

254 
__mb°©e_t
 
	m_IO_°©e
;

255 
__mb°©e_t
 
	m_IO_œ°_°©e
;

256 
_IO_codecvt
 
	m_codecvt
;

258 
wch¨_t
 
	m_sh‹tbuf
[1];

260 
_IO_jump_t
 *
	m_wide_vèbÀ
;

264 
	s_IO_FILE
 {

265 
	m_Êags
;

266 
	#_IO_fûe_Êags
 
_Êags


	)

270 * 
	m_IO_ªad_±r
;

271 * 
	m_IO_ªad_íd
;

272 * 
	m_IO_ªad_ba£
;

273 * 
	m_IO_wrôe_ba£
;

274 * 
	m_IO_wrôe_±r
;

275 * 
	m_IO_wrôe_íd
;

276 * 
	m_IO_buf_ba£
;

277 * 
	m_IO_buf_íd
;

279 *
	m_IO_ßve_ba£
;

280 *
	m_IO_backup_ba£
;

281 *
	m_IO_ßve_íd
;

283 
_IO_m¨kî
 *
	m_m¨kîs
;

285 
_IO_FILE
 *
	m_chaö
;

287 
	m_fûío
;

289 
	m_blksize
;

291 
	m_Êags2
;

293 
_IO_off_t
 
	m_ﬁd_off£t
;

295 
	#__HAVE_COLUMN


	)

297 
	m_cur_cﬁumn
;

298 sig√d 
	m_vèbÀ_off£t
;

299 
	m_sh‹tbuf
[1];

303 
_IO_lock_t
 *
	m_lock
;

304 #ifde‡
_IO_USE_OLD_IO_FILE


307 
	s_IO_FILE_com∂ëe


309 
_IO_FILE
 
	m_fûe
;

311 #i‡
deföed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

312 
_IO_off64_t
 
	m_off£t
;

313 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


315 
_IO_codecvt
 *
	m_codecvt
;

316 
_IO_wide_d©a
 *
	m_wide_d©a
;

318 *
	m__∑d1
;

319 *
	m__∑d2
;

321 
	m_mode
;

323 
	m_unu£d2
[15 *  () - 2 *  (*)];

327 #i‚de‡
__˝lu•lus


328 
_IO_FILE
 
	t_IO_FILE
;

331 
	g_IO_FILE_∂us
;

333 
_IO_FILE_∂us
 
_IO_2_1_°dö_
;

334 
_IO_FILE_∂us
 
_IO_2_1_°dout_
;

335 
_IO_FILE_∂us
 
_IO_2_1_°dîr_
;

336 #i‚de‡
_LIBC


337 
	#_IO_°dö
 ((
_IO_FILE
*)(&
_IO_2_1_°dö_
))

	)

338 
	#_IO_°dout
 ((
_IO_FILE
*)(&
_IO_2_1_°dout_
))

	)

339 
	#_IO_°dîr
 ((
_IO_FILE
*)(&
_IO_2_1_°dîr_
))

	)

341 
_IO_FILE
 *
_IO_°dö
 
©åibuã_hiddí
;

342 
_IO_FILE
 *
_IO_°dout
 
©åibuã_hiddí
;

343 
_IO_FILE
 *
_IO_°dîr
 
©åibuã_hiddí
;

351 
__ssize_t
 
	t__io_ªad_‚
 (*
	t__cookõ
, *
	t__buf
, 
	tsize_t
 
	t__nbyãs
);

359 
__ssize_t
 
	t__io_wrôe_‚
 (*
	t__cookõ
, 
	t__c⁄°
 *
	t__buf
,

360 
	tsize_t
 
	t__n
);

368 
	t__io_£ek_‚
 (*
	t__cookõ
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

371 
	t__io_˛o£_‚
 (*
	t__cookõ
);

374 #ifde‡
_GNU_SOURCE


376 
__io_ªad_‚
 
	tcookõ_ªad_fun˘i⁄_t
;

377 
__io_wrôe_‚
 
	tcookõ_wrôe_fun˘i⁄_t
;

378 
__io_£ek_‚
 
	tcookõ_£ek_fun˘i⁄_t
;

379 
__io_˛o£_‚
 
	tcookõ_˛o£_fun˘i⁄_t
;

384 
__io_ªad_‚
 *
	mªad
;

385 
__io_wrôe_‚
 *
	mwrôe
;

386 
__io_£ek_‚
 *
	m£ek
;

387 
__io_˛o£_‚
 *
	m˛o£
;

388 } 
	t_IO_cookõ_io_fun˘i⁄s_t
;

389 
_IO_cookõ_io_fun˘i⁄s_t
 
	tcookõ_io_fun˘i⁄s_t
;

391 
	g_IO_cookõ_fûe
;

394 
_IO_cookõ_öô
 (
_IO_cookõ_fûe
 *
__cfûe
, 
__ªad_wrôe
,

395 *
__cookõ
, 
_IO_cookõ_io_fun˘i⁄s_t
 
__‚s
);

399 #ifde‡
__˝lu•lus


403 
__undîÊow
 (
_IO_FILE
 *Ë
__THROW
;

404 
__uÊow
 (
_IO_FILE
 *Ë
__THROW
;

405 
__ovîÊow
 (
_IO_FILE
 *, Ë
__THROW
;

406 
_IO_wöt_t
 
__wundîÊow
 (
_IO_FILE
 *Ë
__THROW
;

407 
_IO_wöt_t
 
__wuÊow
 (
_IO_FILE
 *Ë
__THROW
;

408 
_IO_wöt_t
 
__wovîÊow
 (
_IO_FILE
 *, _IO_wöt_tË
__THROW
;

410 
	#_IO_gëc_u∆ocked
(
_Â
) \

411 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
 ? 
	`__uÊow
 (_fp) \

412 : *(*Ë(
_Â
)->
_IO_ªad_±r
++)

	)

413 
	#_IO_≥ekc_u∆ocked
(
_Â
) \

414 ((
_Â
)->
_IO_ªad_±r
 >(_Â)->
_IO_ªad_íd
 \

415 && 
	`__undîÊow
 (
_Â
Ë=
EOF
 ? EOF \

416 : *(*Ë(
_Â
)->
_IO_ªad_±r
)

	)

417 
	#_IO_putc_u∆ocked
(
_ch
, 
_Â
) \

418 (((
_Â
)->
_IO_wrôe_±r
 >(_Â)->
_IO_wrôe_íd
) \

419 ? 
	`__ovîÊow
 (
_Â
, (Ë(
_ch
)) \

420 : (Ë(*(
_Â
)->
_IO_wrôe_±r
++ = (
_ch
)))

	)

422 
	#_IO_gëwc_u∆ocked
(
_Â
) \

423 ((
_Â
)->
_wide_d©a
->
_IO_ªad_±r
 >(_Â)->_wide_d©a->
_IO_ªad_íd
 \

424 ? 
	`__wuÊow
 (
_Â
Ë: (
_IO_wöt_t
Ë*(_Â)->
_wide_d©a
->
_IO_ªad_±r
++)

	)

425 
	#_IO_putwc_u∆ocked
(
_wch
, 
_Â
) \

426 ((
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
 >(_Â)->_wide_d©a->
_IO_wrôe_íd
 \

427 ? 
	`__wovîÊow
 (
_Â
, 
_wch
) \

428 : (
_IO_wöt_t
Ë(*(
_Â
)->
_wide_d©a
->
_IO_wrôe_±r
++ = (
_wch
)))

	)

430 
	#_IO_„of_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_EOF_SEEN
Ë!0)

	)

431 
	#_IO_„º‹_u∆ocked
(
__Â
Ë(((__Â)->
_Êags
 & 
_IO_ERR_SEEN
Ë!0)

	)

433 
_IO_gëc
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

434 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__Â
Ë
__THROW
;

435 
_IO_„of
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

436 
_IO_„º‹
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

438 
_IO_≥ekc_locked
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

441 
	#_IO_PENDING_OUTPUT_COUNT
(
_Â
) \

442 ((
_Â
)->
_IO_wrôe_±r
 - (_Â)->
_IO_wrôe_ba£
)

	)

444 
_IO_Êockfûe
 (
_IO_FILE
 *Ë
__THROW
;

445 
_IO_fu∆ockfûe
 (
_IO_FILE
 *Ë
__THROW
;

446 
_IO_·rylockfûe
 (
_IO_FILE
 *Ë
__THROW
;

448 #ifde‡
_IO_MTSAFE_IO


449 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_locked
 (_Â)

	)

450 
	#_IO_Êockfûe
(
_Â
) \

451 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_Êockfûe
 (_Â)

	)

452 
	#_IO_fu∆ockfûe
(
_Â
) \

453 i‡(((
_Â
)->
_Êags
 & 
_IO_USER_LOCK
Ë=0Ë
	`_IO_fu∆ockfûe
 (_Â)

	)

455 
	#_IO_≥ekc
(
_Â
Ë
	`_IO_≥ekc_u∆ocked
 (_Â)

	)

456 
	#_IO_Êockfûe
(
_Â
Ë

	)

457 
	#_IO_fu∆ockfûe
(
_Â
Ë

	)

458 
	#_IO_·rylockfûe
(
_Â
Ë

	)

459 
	#_IO_˛ónup_ªgi⁄_°¨t
(
_f˘
, 
_Â
Ë

	)

460 
	#_IO_˛ónup_ªgi⁄_íd
(
_Doô
Ë

	)

463 
_IO_vfsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, const * __restrict,

464 
_IO_va_li°
, *
__ª°ri˘
Ë
__THROW
;

465 
_IO_vÂrötf
 (
_IO_FILE
 *
__ª°ri˘
, const *__restrict,

466 
_IO_va_li°
Ë
__THROW
;

467 
_IO_ssize_t
 
_IO_∑dn
 (
_IO_FILE
 *, , _IO_ssize_tË
__THROW
;

468 
_IO_size_t
 
_IO_sgën
 (
_IO_FILE
 *, *, _IO_size_tË
__THROW
;

470 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , Ë
__THROW
;

471 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, Ë
__THROW
;

473 
_IO_‰ì_backup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

475 #i‡
deföed
 
_LIBC
 || deföed 
_GLIBCPP_USE_WCHAR_T


476 
_IO_wöt_t
 
_IO_gëwc
 (
_IO_FILE
 *
__Â
Ë
__THROW
;

477 
_IO_wöt_t
 
_IO_putwc
 (
wch¨_t
 
__wc
, 
_IO_FILE
 *
__Â
Ë
__THROW
;

478 
_IO_fwide
 (
_IO_FILE
 *
__Â
, 
__mode
Ë
__THROW
;

479 #i‡
__GNUC__
 >= 2

482 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


483 
	~<shlib-com∑t.h
>

484 #i‡
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

485 
	#_IO_fwide_maybe_öcom∑tibÀ
 \

486 (
	`__buûtö_ex≥˘
 (&
_IO_°dö_u£d
 =
NULL
, 0))

	)

487 c⁄° 
_IO_°dö_u£d
;

488 
wók_exã∫
 (
_IO_°dö_u£d
);

491 #i‚de‡
_IO_fwide_maybe_öcom∑tibÀ


492 
	#_IO_fwide_maybe_öcom∑tibÀ
 (0)

	)

496 
	#_IO_fwide
(
__Â
, 
__mode
) \

497 ({ 
__ªsu…
 = (
__mode
); \

498 i‡(
__ªsu…
 < 0 && ! 
_IO_fwide_maybe_öcom∑tibÀ
) \

500 i‡((
__Â
)->
_mode
 == 0) \

502 (
__Â
)->
_mode
 = -1; \

503 
__ªsu…
 = (
__Â
)->
_mode
; \

505 i‡(
	`__buûtö_c⁄°™t_p
 (
__mode
) && (__mode) == 0) \

506 
__ªsu…
 = 
_IO_fwide_maybe_öcom∑tibÀ
 ? -1 : (
__Â
)->
_mode
; \

508 
__ªsu…
 = 
	`_IO_fwide
 (
__Â
, __result); \

509 
__ªsu…
; })

	)

512 
_IO_vfwsˇnf
 (
_IO_FILE
 * 
__ª°ri˘
, c⁄° 
wch¨_t
 * __restrict,

513 
_IO_va_li°
, *
__ª°ri˘
Ë
__THROW
;

514 
_IO_vfw¥ötf
 (
_IO_FILE
 *
__ª°ri˘
, c⁄° 
wch¨_t
 *__restrict,

515 
_IO_va_li°
Ë
__THROW
;

516 
_IO_ssize_t
 
_IO_w∑dn
 (
_IO_FILE
 *, 
wöt_t
, _IO_ssize_tË
__THROW
;

517 
_IO_‰ì_wbackup_¨ó
 (
_IO_FILE
 *Ë
__THROW
;

520 #ifde‡
__˝lu•lus


	@/usr/include/linux/config.h

1 #i‚de‡
_LINUX_CONFIG_H


2 
	#_LINUX_CONFIG_H


	)

4 
	~<löux/autoc⁄f.h
>

	@/usr/include/linux/fs.h

1 #i‚de‡
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

9 
	~<löux/c⁄fig.h
>

10 
	~<löux/lökage.h
>

11 
	~<löux/limôs.h
>

12 
	~<löux/waô.h
>

13 
	~<löux/ty≥s.h
>

14 
	~<löux/kdev_t.h
>

15 
	~<löux/io˘l.h
>

16 
	~<löux/li°.h
>

17 
	~<löux/dˇche.h
>

18 
	~<löux/°©.h
>

19 
	~<löux/ˇche.h
>

20 
	~<löux/ødix-åì.h
>

21 
	~<löux/kobje˘.h
>

22 
	~<asm/©omic.h
>

24 
	giovec
;

25 
	g«meid©a
;

26 
	gpùe_öode_öfo
;

27 
	gpﬁl_èbÀ_°ru˘
;

28 
	gk°©fs
;

29 
	gvm_¨ó_°ru˘
;

30 
	gvfsmou¡
;

43 #unde‡
NR_OPEN


44 
	#NR_OPEN
 (1024*1024Ë

	)

45 
	#INR_OPEN
 1024

	)

47 
	#BLOCK_SIZE_BITS
 10

	)

48 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

51 
	sfûes_°©_°ru˘
 {

52 
	mƒ_fûes
;

53 
	mƒ_‰ì_fûes
;

54 
	mmax_fûes
;

56 
fûes_°©_°ru˘
 
fûes_°©
;

58 
	söodes_°©_t
 {

59 
	mƒ_öodes
;

60 
	mƒ_unu£d
;

61 
	mdummy
[5];

63 
öodes_°©_t
 
öodes_°©
;

65 
Àa£s_íabÀ
, 
dú_nŸify_íabÀ
, 
Àa£_bªak_time
;

67 
	#NR_FILE
 8192

	)

68 
	#NR_RESERVED_FILES
 10

	)

69 
	#NR_SUPER
 256

	)

71 
	#MAY_EXEC
 1

	)

72 
	#MAY_WRITE
 2

	)

73 
	#MAY_READ
 4

	)

74 
	#MAY_APPEND
 8

	)

76 
	#FMODE_READ
 1

	)

77 
	#FMODE_WRITE
 2

	)

79 
	#RW_MASK
 1

	)

80 
	#RWA_MASK
 2

	)

81 
	#READ
 0

	)

82 
	#WRITE
 1

	)

83 
	#READA
 2

	)

84 
	#SPECIAL
 4

	)

86 
	#SEL_IN
 1

	)

87 
	#SEL_OUT
 2

	)

88 
	#SEL_EX
 4

	)

91 
	#FS_REQUIRES_DEV
 1

	)

92 
	#FS_REVAL_DOT
 16384

	)

93 
	#FS_ODD_RENAME
 32768

	)

99 
	#MS_RDONLY
 1

	)

100 
	#MS_NOSUID
 2

	)

101 
	#MS_NODEV
 4

	)

102 
	#MS_NOEXEC
 8

	)

103 
	#MS_SYNCHRONOUS
 16

	)

104 
	#MS_REMOUNT
 32

	)

105 
	#MS_MANDLOCK
 64

	)

106 
	#MS_DIRSYNC
 128

	)

107 
	#MS_NOATIME
 1024

	)

108 
	#MS_NODIRATIME
 2048

	)

109 
	#MS_BIND
 4096

	)

110 
	#MS_MOVE
 8192

	)

111 
	#MS_REC
 16384

	)

112 
	#MS_VERBOSE
 32768

	)

113 
	#MS_POSIXACL
 (1<<16Ë

	)

114 
	#MS_ONE_SECOND
 (1<<17Ë

	)

115 
	#MS_ACTIVE
 (1<<30)

	)

116 
	#MS_NOUSER
 (1<<31)

	)

121 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_NOATIME
|\

122 
MS_NODIRATIME
)

	)

127 
	#MS_MGC_VAL
 0xC0ED0000

	)

128 
	#MS_MGC_MSK
 0xffff0000

	)

132 
	#S_SYNC
 1

	)

133 
	#S_NOATIME
 2

	)

134 
	#S_QUOTA
 4

	)

135 
	#S_APPEND
 8

	)

136 
	#S_IMMUTABLE
 16

	)

137 
	#S_DEAD
 32

	)

138 
	#S_NOQUOTA
 64

	)

139 
	#S_DIRSYNC
 128

	)

154 
	#__IS_FLG
(
öode
,
Êg
Ë((öode)->
i_sb
->
s_Êags
 & (Êg))

	)

156 
	#IS_RDONLY
(
öode
Ë((öode)->
i_sb
->
s_Êags
 & 
MS_RDONLY
)

	)

157 
	#IS_SYNC
(
öode
Ë(
	`__IS_FLG
(öode, 
MS_SYNCHRONOUS
) || \

158 ((
öode
)->
i_Êags
 & 
S_SYNC
))

	)

159 
	#IS_DIRSYNC
(
öode
Ë(
	`__IS_FLG
(öode, 
MS_SYNCHRONOUS
|
MS_DIRSYNC
) || \

160 ((
öode
)->
i_Êags
 & (
S_SYNC
|
S_DIRSYNC
)))

	)

161 
	#IS_MANDLOCK
(
öode
Ë
	`__IS_FLG
(öode, 
MS_MANDLOCK
)

	)

163 
	#IS_QUOTAINIT
(
öode
Ë((öode)->
i_Êags
 & 
S_QUOTA
)

	)

164 
	#IS_NOQUOTA
(
öode
Ë((öode)->
i_Êags
 & 
S_NOQUOTA
)

	)

165 
	#IS_APPEND
(
öode
Ë((öode)->
i_Êags
 & 
S_APPEND
)

	)

166 
	#IS_IMMUTABLE
(
öode
Ë((öode)->
i_Êags
 & 
S_IMMUTABLE
)

	)

167 
	#IS_NOATIME
(
öode
Ë(
	`__IS_FLG
(öode, 
MS_NOATIME
Ë|| ((öode)->
i_Êags
 & 
S_NOATIME
))

	)

168 
	#IS_NODIRATIME
(
öode
Ë
	`__IS_FLG
(öode, 
MS_NODIRATIME
)

	)

169 
	#IS_POSIXACL
(
öode
Ë
	`__IS_FLG
(öode, 
MS_POSIXACL
)

	)

170 
	#IS_ONE_SECOND
(
öode
Ë
	`__IS_FLG
(öode, 
MS_ONE_SECOND
)

	)

172 
	#IS_DEADDIR
(
öode
Ë((öode)->
i_Êags
 & 
S_DEAD
)

	)

177 
	#BLKROSET
 
	`_IO
(0x12,93Ë

	)

178 
	#BLKROGET
 
	`_IO
(0x12,94Ë

	)

179 
	#BLKRRPART
 
	`_IO
(0x12,95Ë

	)

180 
	#BLKGETSIZE
 
	`_IO
(0x12,96Ë

	)

181 
	#BLKFLSBUF
 
	`_IO
(0x12,97Ë

	)

182 
	#BLKRASET
 
	`_IO
(0x12,98Ë

	)

183 
	#BLKRAGET
 
	`_IO
(0x12,99Ë

	)

184 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

185 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

186 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

187 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

188 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

190 
	#BLKPG
 
	`_IO
(0x12,105)

	)

194 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

195 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

200 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

201 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

202 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
Ë

	)

204 
	#BMAP_IOCTL
 1

	)

205 
	#FIBMAP
 
	`_IO
(0x00,1Ë

	)

206 
	#FIGETBSZ
 
	`_IO
(0x00,2Ë

	)

208 #ifde‡
__KERNEL__


210 
	~<asm/£m≠h‹e.h
>

211 
	~<asm/byã‹dî.h
>

214 
upd©e_©ime
 (
öode
 *);

216 
öode_öô
();

217 
m¡_öô
();

218 
fûes_öô
();

220 
	gbuf„r_hód
;

221 (
	tgë_block_t
)(
	töode
 *öode, 
	t£˘‹_t
 
	tiblock
,

222 
	tbuf„r_hód
 *
	tbh_ªsu…
, 
	t¸óã
);

223 (
	tgë_blocks_t
)(
	töode
 *öode, 
	t£˘‹_t
 
	tiblock
,

224 
	tmax_blocks
,

225 
	tbuf„r_hód
 *
	tbh_ªsu…
, 
	t¸óã
);

226 (
	tdio_iod⁄e_t
)(
	töode
 *öode, 
	tloff_t
 
	toff£t
,

227 
	tssize_t
 
	tbyãs
, *
	t¥iv©e
);

233 
	#ATTR_MODE
 1

	)

234 
	#ATTR_UID
 2

	)

235 
	#ATTR_GID
 4

	)

236 
	#ATTR_SIZE
 8

	)

237 
	#ATTR_ATIME
 16

	)

238 
	#ATTR_MTIME
 32

	)

239 
	#ATTR_CTIME
 64

	)

240 
	#ATTR_ATIME_SET
 128

	)

241 
	#ATTR_MTIME_SET
 256

	)

242 
	#ATTR_FORCE
 512

	)

243 
	#ATTR_ATTR_FLAG
 1024

	)

244 
	#ATTR_KILL_SUID
 2048

	)

245 
	#ATTR_KILL_SGID
 4096

	)

256 
	süâr
 {

257 
ü_vÆid
;

258 
umode_t
 
ü_mode
;

259 
uid_t
 
ü_uid
;

260 
gid_t
 
ü_gid
;

261 
loff_t
 
ü_size
;

262 
time•ec
 
ü_©ime
;

263 
time•ec
 
ü_mtime
;

264 
time•ec
 
ü_˘ime
;

265 
ü_©å_Êags
;

271 
	#ATTR_FLAG_SYNCRONOUS
 1

	)

272 
	#ATTR_FLAG_NOATIME
 2

	)

273 
	#ATTR_FLAG_APPEND
 4

	)

274 
	#ATTR_FLAG_IMMUTABLE
 8

	)

275 
	#ATTR_FLAG_NODIRATIME
 16

	)

280 
	~<löux/quŸa.h
>

285 
∑ge
;

286 
addªss_•a˚
;

287 
wrôeback_c⁄åﬁ
;

288 
kiocb
;

290 
	saddªss_•a˚_›î©i⁄s
 {

291 (*
wrôïage
)(
∑ge
 *∑ge, 
wrôeback_c⁄åﬁ
 *
wbc
);

292 (*
ªad∑ge
)(
fûe
 *, 
∑ge
 *);

293 (*
sync_∑ge
)(
∑ge
 *);

296 (*
wrôïages
)(
addªss_•a˚
 *, 
wrôeback_c⁄åﬁ
 *);

299 (*
£t_∑ge_dúty
)(
∑ge
 *page);

301 (*
ªad∑ges
)(
fûe
 *
fûp
, 
addªss_•a˚
 *
m≠pög
,

302 
li°_hód
 *
∑ges
, 
ƒ_∑ges
);

308 (*
¥ï¨e_wrôe
)(
fûe
 *, 
∑ge
 *, , );

309 (*
commô_wrôe
)(
fûe
 *, 
∑ge
 *, , );

311 
	`£˘‹_t
 (*
bm≠
)(
addªss_•a˚
 *, 
£˘‹_t
);

312 (*
övÆid©ïage
Ë(
∑ge
 *, );

313 (*
ªÀa£∑ge
Ë(
∑ge
 *, );

314 (*
dúe˘_IO
)(, 
kiocb
 *, c⁄° 
iovec
 *
iov
,

315 
loff_t
 
off£t
, 
ƒ_£gs
);

318 
backög_dev_öfo
;

319 
	saddªss_•a˚
 {

320 
öode
 *
ho°
;

321 
ødix_åì_roŸ
 
∑ge_åì
;

322 
•ölock_t
 
∑ge_lock
;

323 
li°_hód
 
˛ón_∑ges
;

324 
li°_hód
 
dúty_∑ges
;

325 
li°_hód
 
locked_∑ges
;

326 
li°_hód
 
io_∑ges
;

327 
ƒ∑ges
;

328 
addªss_•a˚_›î©i⁄s
 *
a_›s
;

329 
li°_hód
 
i_mm≠
;

330 
li°_hód
 
i_mm≠_sh¨ed
;

331 
£m≠h‹e
 
i_sh¨ed_£m
;

332 
©omic_t
 
åunˇã_cou¡
;

333 
dútõd_whí
;

334 
Êags
;

335 
backög_dev_öfo
 *backing_dev_info;

336 
•ölock_t
 
¥iv©e_lock
;

337 
li°_hód
 
¥iv©e_li°
;

338 
addªss_•a˚
 *
assoc_m≠pög
;

341 
	sblock_devi˚
 {

342 
dev_t
 
bd_dev
;

343 
öode
 * 
bd_öode
;

344 
bd_›íîs
;

345 
£m≠h‹e
 
bd_£m
;

346 
li°_hód
 
bd_öodes
;

347 * 
bd_hﬁdî
;

348 
bd_hﬁdîs
;

349 
block_devi˚
 * 
bd_c⁄èös
;

350 
bd_block_size
;

351 
hd_°ru˘
 * 
bd_∑π
;

352 
bd_∑π_cou¡
;

353 
bd_övÆid©ed
;

354 
gídisk
 * 
bd_disk
;

355 
li°_hód
 
bd_li°
;

361 #i‡
BITS_PER_LONG
==32 && 
	`deföed
(
CONFIG_SMP
)

362 
	~<löux/£qlock.h
>

363 
	#__NEED_I_SIZE_ORDERED


	)

364 
	#i_size_‹dîed_öô
(
öode
Ë
	`£qcou¡_öô
(&öode->
i_size_£qcou¡
)

	)

366 
	#i_size_‹dîed_öô
(
öode
Ëdÿ{ 
	}
} 0)

	)

369 
	söode
 {

370 
hli°_node
 
	mi_hash
;

371 
li°_hód
 
	mi_li°
;

372 
li°_hód
 
	mi_díåy
;

373 
	mi_öo
;

374 
©omic_t
 
	mi_cou¡
;

375 
umode_t
 
	mi_mode
;

376 
	mi_∆ök
;

377 
uid_t
 
	mi_uid
;

378 
gid_t
 
	mi_gid
;

379 
dev_t
 
	mi_rdev
;

380 
loff_t
 
	mi_size
;

381 
time•ec
 
	mi_©ime
;

382 
time•ec
 
	mi_mtime
;

383 
time•ec
 
	mi_˘ime
;

384 
	mi_blkbôs
;

385 
	mi_blksize
;

386 
	mi_vîsi⁄
;

387 
	mi_blocks
;

388 
	mi_byãs
;

389 
•ölock_t
 
	mi_lock
;

390 
£m≠h‹e
 
	mi_£m
;

391 
öode_›î©i⁄s
 *
	mi_›
;

392 
fûe_›î©i⁄s
 *
	mi_f›
;

393 
su≥r_block
 *
	mi_sb
;

394 
fûe_lock
 *
	mi_Êock
;

395 
addªss_•a˚
 *
	mi_m≠pög
;

396 
addªss_•a˚
 
	mi_d©a
;

397 
dquŸ
 *
	mi_dquŸ
[
MAXQUOTAS
];

399 
li°_hód
 
	mi_devi˚s
;

400 
pùe_öode_öfo
 *
	mi_pùe
;

401 
block_devi˚
 *
	mi_bdev
;

402 
cdev
 *
	mi_cdev
;

403 
	mi_cödex
;

405 
	mi_dnŸify_mask
;

406 
dnŸify_°ru˘
 *
	mi_dnŸify
;

408 
	mi_°©e
;

410 
	mi_Êags
;

411 
	mi_sock
;

413 
©omic_t
 
	mi_wrôecou¡
;

414 *
	mi_£curôy
;

415 
__u32
 
	mi_gíî©i⁄
;

417 *
	mgíîic_ù
;

418 } 
	mu
;

419 #ifde‡
__NEED_I_SIZE_ORDERED


420 
£qcou¡_t
 
	mi_size_£qcou¡
;

434 
ölöe
 
loff_t
 
	$i_size_ªad
(
öode
 *inode)

436 #i‡
BITS_PER_LONG
==32 && 
	`deföed
(
CONFIG_SMP
)

437 
loff_t
 
i_size
;

438 
£q
;

441 
£q
 = 
	`ªad_£qcou¡_begö
(&
öode
->
i_size_£qcou¡
);

442 
i_size
 = 
öode
->i_size;

443 } 
	`ªad_£qcou¡_ªåy
(&
öode
->
i_size_£qcou¡
, 
£q
));

444  
i_size
;

445 #ñi‡
BITS_PER_LONG
==32 && 
	`deföed
(
CONFIG_PREEMPT
)

446 
loff_t
 
i_size
;

448 
	`¥ìm±_dißbÀ
();

449 
i_size
 = 
öode
->i_size;

450 
	`¥ìm±_íabÀ
();

451  
i_size
;

453  
öode
->
i_size
;

455 
	}
}

458 
ölöe
 
	$i_size_wrôe
(
öode
 *öode, 
loff_t
 
i_size
)

460 #i‡
BITS_PER_LONG
==32 && 
	`deföed
(
CONFIG_SMP
)

461 
	`wrôe_£qcou¡_begö
(&
öode
->
i_size_£qcou¡
);

462 
öode
->
i_size
 = i_size;

463 
	`wrôe_£qcou¡_íd
(&
öode
->
i_size_£qcou¡
);

464 #ñi‡
BITS_PER_LONG
==32 && 
	`deföed
(
CONFIG_PREEMPT
)

465 
	`¥ìm±_dißbÀ
();

466 
öode
->
i_size
 = i_size;

467 
	`¥ìm±_íabÀ
();

469 
öode
->
i_size
 = i_size;

471 
	}
}

473 
ölöe
 
	$imö‹
(
öode
 *inode)

475  
	`MINOR
(
öode
->
i_rdev
);

476 
	}
}

478 
ölöe
 
	$imaj‹
(
öode
 *inode)

480  
	`MAJOR
(
öode
->
i_rdev
);

481 
	}
}

483 
	sfown_°ru˘
 {

484 
rwlock_t
 
	mlock
;

485 
	mpid
;

486 
uid_t
 
	muid
, 
	meuid
;

487 
	msignum
;

488 *
	m£curôy
;

494 
	sfûe_ø_°©e
 {

495 
	m°¨t
;

496 
	msize
;

497 
	m√xt_size
;

498 
	m¥ev_∑ge
;

499 
	mahód_°¨t
;

500 
	mahód_size
;

501 
	mø_∑ges
;

502 
	mmm≠_hô
;

503 
	mmm≠_miss
;

506 
	sfûe
 {

507 
li°_hód
 
	mf_li°
;

508 
díåy
 *
	mf_díåy
;

509 
vfsmou¡
 *
	mf_vfsm¡
;

510 
fûe_›î©i⁄s
 *
	mf_›
;

511 
©omic_t
 
	mf_cou¡
;

512 
	mf_Êags
;

513 
mode_t
 
	mf_mode
;

514 
loff_t
 
	mf_pos
;

515 
fown_°ru˘
 
	mf_ow√r
;

516 
	mf_uid
, 
	mf_gid
;

517 
	mf_îr‹
;

518 
fûe_ø_°©e
 
	mf_ø
;

520 
	mf_vîsi⁄
;

521 *
	mf_£curôy
;

524 *
	m¥iv©e_d©a
;

527 
li°_hód
 
	mf_ï_löks
;

528 
•ölock_t
 
	mf_ï_lock
;

530 
•ölock_t
 
fûes_lock
;

531 
	#fûe_li°_lock
(Ë
	`•ö_lock
(&
fûes_lock
);

	)

532 
	#fûe_li°_u∆ock
(Ë
	`•ö_u∆ock
(&
fûes_lock
);

	)

534 
	#gë_fûe
(
x
Ë
	`©omic_öc
(&(x)->
f_cou¡
)

	)

535 
	#fûe_cou¡
(
x
Ë
	`©omic_ªad
(&(x)->
f_cou¡
)

	)

538 
›í_¥iv©e_fûe
(
fûe
 *, 
díåy
 *, );

540 
˛o£_¥iv©e_fûe
(
fûe
 *file);

542 
	#MAX_NON_LFS
 ((1UL<<31Ë- 1)

	)

546 #i‡
BITS_PER_LONG
==32

547 
	#MAX_LFS_FILESIZE
 (((
u64
)
PAGE_CACHE_SIZE
 << (
BITS_PER_LONG
-1))-1)

	)

548 #ñi‡
BITS_PER_LONG
==64

549 
	#MAX_LFS_FILESIZE
 0x7fffffffffffffff

	)

552 
	#FL_POSIX
 1

	)

553 
	#FL_FLOCK
 2

	)

554 
	#FL_ACCESS
 8

	)

555 
	#FL_LOCKD
 16

	)

556 
	#FL_LEASE
 32

	)

557 
	#FL_SLEEP
 128

	)

566 
fûes_°ru˘
 *
	tÊ_ow√r_t
;

569 
	~<löux/nfs_fs_i.h
>

571 
	sfûe_lock
 {

572 
fûe_lock
 *
	mÊ_√xt
;

573 
li°_hód
 
	mÊ_lök
;

574 
li°_hód
 
	mÊ_block
;

575 
Ê_ow√r_t
 
	mÊ_ow√r
;

576 
	mÊ_pid
;

577 
waô_queue_hód_t
 
	mÊ_waô
;

578 
fûe
 *
	mÊ_fûe
;

579 
	mÊ_Êags
;

580 
	mÊ_ty≥
;

581 
loff_t
 
	mÊ_°¨t
;

582 
loff_t
 
	mÊ_íd
;

584 (*
	mÊ_nŸify
)(
	mfûe_lock
 *);

585 (*
	mÊ_ö£π
)(
	mfûe_lock
 *);

586 (*
	mÊ_ªmove
)(
	mfûe_lock
 *);

588 
Ásync_°ru˘
 * 
	mÊ_Ásync
;

589 
	mÊ_bªak_time
;

592 
nfs_lock_öfo
 
	mnfs_Ê
;

593 } 
	mÊ_u
;

597 #i‚de‡
OFFSET_MAX


598 
	#INT_LIMIT
(
x
Ë(~((x)1 << ((x)*8 - 1)))

	)

599 
	#OFFSET_MAX
 
	`INT_LIMIT
(
loff_t
)

	)

600 
	#OFFT_OFFSET_MAX
 
	`INT_LIMIT
(
off_t
)

	)

603 
li°_hód
 
fûe_lock_li°
;

605 
	~<löux/f˙é.h
>

607 
f˙é_gëlk
(
fûe
 *, 
Êock
 
__u£r
 *);

608 
f˙é_£ék
(
fûe
 *, , 
Êock
 
__u£r
 *);

610 #i‡
BITS_PER_LONG
 == 32

611 
f˙é_gëlk64
(
fûe
 *, 
Êock64
 
__u£r
 *);

612 
f˙é_£ék64
(
fûe
 *, , 
Êock64
 
__u£r
 *);

615 
£nd_sigio
(
fown_°ru˘
 *
fown
, 
fd
, 
b™d
);

616 
f˙é_£éó£
(
fd
, 
fûe
 *
fûp
, 
¨g
);

617 
f˙é_gëÀa£
(
fûe
 *
fûp
);

620 
locks_öô_lock
(
fûe_lock
 *);

621 
locks_c›y_lock
(
fûe_lock
 *, file_lock *);

622 
locks_ªmove_posix
(
fûe
 *, 
Ê_ow√r_t
);

623 
locks_ªmove_Êock
(
fûe
 *);

624 
fûe_lock
 *
posix_ã°_lock
(
fûe
 *, file_lock *);

625 
posix_lock_fûe
(
fûe
 *, 
fûe_lock
 *);

626 
posix_block_lock
(
fûe_lock
 *, file_lock *);

627 
posix_unblock_lock
(
fûe
 *, 
fûe_lock
 *);

628 
posix_locks_dódlock
(
fûe_lock
 *, file_lock *);

629 
__bªak_Àa£
(
öode
 *öode, 
Êags
);

630 
Àa£_gë_mtime
(
öode
 *, 
time•ec
 *
time
);

631 
lock_may_ªad
(
öode
 *, 
loff_t
 
°¨t
, 
cou¡
);

632 
lock_may_wrôe
(
öode
 *, 
loff_t
 
°¨t
, 
cou¡
);

634 
	sÁsync_°ru˘
 {

635 
	mmagic
;

636 
	mÁ_fd
;

637 
Ásync_°ru˘
 *
	mÁ_√xt
;

638 
fûe
 *
	mÁ_fûe
;

641 
	#FASYNC_MAGIC
 0x4601

	)

644 
Ásync_hñ≥r
(, 
fûe
 *, , 
Ásync_°ru˘
 **);

646 
kûl_Ásync
(
Ásync_°ru˘
 **, , );

648 
__kûl_Ásync
(
Ásync_°ru˘
 *, , );

650 
f_£town
(
fûe
 *
fûp
, 
¨g
, 
f‹˚
);

651 
f_dñown
(
fûe
 *
fûp
);

652 
£nd_sigurg
(
fown_°ru˘
 *
fown
);

658 
	#MNT_FORCE
 0x00000001

	)

659 
	#MNT_DETACH
 0x00000002

	)

661 
li°_hód
 
su≥r_blocks
;

662 
•ölock_t
 
sb_lock
;

664 
	#sb_íåy
(
li°
Ë
	`li°_íåy
(÷i°), 
su≥r_block
, 
s_li°
)

	)

665 
	#S_BIAS
 (1<<30)

	)

666 
	ssu≥r_block
 {

667 
li°_hód
 
	ms_li°
;

668 
dev_t
 
	ms_dev
;

669 
	ms_blocksize
;

670 
	ms_ﬁd_blocksize
;

671 
	ms_blocksize_bôs
;

672 
	ms_dút
;

673 
	ms_maxbyãs
;

674 
fûe_sy°em_ty≥
 *
	ms_ty≥
;

675 
su≥r_›î©i⁄s
 *
	ms_›
;

676 
dquŸ_›î©i⁄s
 *
	mdq_›
;

677 
quŸa˘l_›s
 *
	ms_qc›
;

678 
exp‹t_›î©i⁄s
 *
	ms_exp‹t_›
;

679 
	ms_Êags
;

680 
	ms_magic
;

681 
díåy
 *
	ms_roŸ
;

682 
rw_£m≠h‹e
 
	ms_umou¡
;

683 
£m≠h‹e
 
	ms_lock
;

684 
	ms_cou¡
;

685 
	ms_syncög
;

686 
	ms_√ed_sync_fs
;

687 
©omic_t
 
	ms_a˘ive
;

688 *
	ms_£curôy
;

690 
li°_hód
 
	ms_dúty
;

691 
li°_hód
 
	ms_io
;

692 
hli°_hód
 
	ms_™⁄
;

693 
li°_hód
 
	ms_fûes
;

695 
block_devi˚
 *
	ms_bdev
;

696 
li°_hód
 
	ms_ö°™˚s
;

697 
quŸa_öfo
 
	ms_dquŸ
;

699 
	ms_id
[32];

701 
kobje˘
 
	mkobj
;

702 *
	ms_fs_öfo
;

708 
£m≠h‹e
 
	ms_vfs_ª«me_£m
;

714 
ölöe
 
	$lock_su≥r
(
su≥r_block
 * 
sb
)

716 
	`down
(&
sb
->
s_lock
);

717 
	}
}

719 
ölöe
 
	$u∆ock_su≥r
(
su≥r_block
 * 
sb
)

721 
	`up
(&
sb
->
s_lock
);

722 
	}
}

727 
vfs_¸óã
(
öode
 *, 
díåy
 *, , 
«meid©a
 *);

728 
vfs_mkdú
(
öode
 *, 
díåy
 *, );

729 
vfs_mknod
(
öode
 *, 
díåy
 *, , 
dev_t
);

730 
vfs_symlök
(
öode
 *, 
díåy
 *, const *);

731 
vfs_lök
(
díåy
 *, 
öode
 *, dentry *);

732 
vfs_rmdú
(
öode
 *, 
díåy
 *);

733 
vfs_u∆ök
(
öode
 *, 
díåy
 *);

734 
vfs_ª«me
(
öode
 *, 
díåy
 *, inode *, dentry *);

742 
	#DT_UNKNOWN
 0

	)

743 
	#DT_FIFO
 1

	)

744 
	#DT_CHR
 2

	)

745 
	#DT_DIR
 4

	)

746 
	#DT_BLK
 6

	)

747 
	#DT_REG
 8

	)

748 
	#DT_LNK
 10

	)

749 
	#DT_SOCK
 12

	)

750 
	#DT_WHT
 14

	)

758 (*
	tfûldú_t
)(*, c⁄° *, , 
	tloff_t
, 
	töo_t
, );

760 
	sblock_devi˚_›î©i⁄s
 {

761 (*
›í
Ë(
öode
 *, 
fûe
 *);

762 (*
ªÀa£
Ë(
öode
 *, 
fûe
 *);

763 (*
io˘l
Ë(
öode
 *, 
fûe
 *, , );

764 (*
medü_ch™ged
Ë(
gídisk
 *);

765 (*
ªvÆid©e_disk
Ë(
gídisk
 *);

766 
moduÀ
 *
ow√r
;

779 
size_t
 
wrôãn
;

780 
size_t
 
cou¡
;

781 
__u£r
 * 
buf
;

782 
îr‹
;

783 } 
	tªad_des¸ùt‹_t
;

785 (*
	tªad_a˘‹_t
)(
	tªad_des¸ùt‹_t
 *, 
	t∑ge
 *, , );

792 
	sfûe_›î©i⁄s
 {

793 
moduÀ
 *
ow√r
;

794 
	`loff_t
 (*
Œ£ek
Ë(
fûe
 *, 
loff_t
, );

795 
	`ssize_t
 (*
ªad
Ë(
fûe
 *, 
__u£r
 *, 
size_t
, 
loff_t
 *);

796 
	`ssize_t
 (*
aio_ªad
Ë(
kiocb
 *, 
__u£r
 *, 
size_t
, 
loff_t
);

797 
	`ssize_t
 (*
wrôe
Ë(
fûe
 *, c⁄° 
__u£r
 *, 
size_t
, 
loff_t
 *);

798 
	`ssize_t
 (*
aio_wrôe
Ë(
kiocb
 *, c⁄° 
__u£r
 *, 
size_t
, 
loff_t
);

799 (*
ªaddú
Ë(
fûe
 *, *, 
fûldú_t
);

800 (*
pﬁl
Ë(
fûe
 *, 
pﬁl_èbÀ_°ru˘
 *);

801 (*
io˘l
Ë(
öode
 *, 
fûe
 *, , );

802 (*
mm≠
Ë(
fûe
 *, 
vm_¨ó_°ru˘
 *);

803 (*
›í
Ë(
öode
 *, 
fûe
 *);

804 (*
Êush
Ë(
fûe
 *);

805 (*
ªÀa£
Ë(
öode
 *, 
fûe
 *);

806 (*
fsync
Ë(
fûe
 *, 
díåy
 *, 
d©async
);

807 (*
aio_fsync
Ë(
kiocb
 *, 
d©async
);

808 (*
Ásync
Ë(, 
fûe
 *, );

809 (*
lock
Ë(
fûe
 *, , 
fûe_lock
 *);

810 
	`ssize_t
 (*
ªadv
Ë(
fûe
 *, c⁄° 
iovec
 *, , 
loff_t
 *);

811 
	`ssize_t
 (*
wrôev
Ë(
fûe
 *, c⁄° 
iovec
 *, , 
loff_t
 *);

812 
	`ssize_t
 (*
£ndfûe
Ë(
fûe
 *, 
loff_t
 *, 
size_t
, 
ªad_a˘‹_t
, 
__u£r
 *);

813 
	`ssize_t
 (*
£nd∑ge
Ë(
fûe
 *, 
∑ge
 *, , 
size_t
, 
loff_t
 *, );

814 (*
gë_unm≠≥d_¨ó
)(
fûe
 *, , , , );

817 
	söode_›î©i⁄s
 {

818 (*
¸óã
Ë(
öode
 *,
díåy
 *,, 
«meid©a
 *);

819 
díåy
 * (*
lookup
Ë(
öode
 *,díåy *, 
«meid©a
 *);

820 (*
lök
Ë(
díåy
 *,
öode
 *,dentry *);

821 (*
u∆ök
Ë(
öode
 *,
díåy
 *);

822 (*
symlök
Ë(
öode
 *,
díåy
 *,const *);

823 (*
mkdú
Ë(
öode
 *,
díåy
 *,);

824 (*
rmdú
Ë(
öode
 *,
díåy
 *);

825 (*
mknod
Ë(
öode
 *,
díåy
 *,,
dev_t
);

826 (*
ª«me
Ë(
öode
 *, 
díåy
 *,

827 
öode
 *, 
díåy
 *);

828 (*
ªadlök
Ë(
díåy
 *, 
__u£r
 *,);

829 (*
fﬁlow_lök
Ë(
díåy
 *, 
«meid©a
 *);

830 (*
åunˇã
Ë(
öode
 *);

831 (*
≥rmissi⁄
Ë(
öode
 *, , 
«meid©a
 *);

832 (*
£èâr
Ë(
díåy
 *, 
üâr
 *);

833 (*
gë©å
Ë(
vfsmou¡
 *
m¡
, 
díåy
 *, 
k°©
 *);

834 (*
£tx©å
Ë(
díåy
 *, c⁄° *,c⁄° *,
size_t
,);

835 
	`ssize_t
 (*
gëx©å
Ë(
díåy
 *, c⁄° *, *, 
size_t
);

836 
	`ssize_t
 (*
li°x©å
Ë(
díåy
 *, *, 
size_t
);

837 (*
ªmovex©å
Ë(
díåy
 *, const *);

840 
£q_fûe
;

842 
ssize_t
 
	`vfs_ªad
(
fûe
 *, 
__u£r
 *, 
size_t
, 
loff_t
 *);

843 
ssize_t
 
	`vfs_wrôe
(
fûe
 *, c⁄° 
__u£r
 *, 
size_t
, 
loff_t
 *);

844 
ssize_t
 
	`vfs_ªadv
(
fûe
 *, c⁄° 
iovec
 
__u£r
 *,

845 , 
loff_t
 *);

846 
ssize_t
 
	`vfs_wrôev
(
fûe
 *, c⁄° 
iovec
 
__u£r
 *,

847 , 
loff_t
 *);

853 
	ssu≥r_›î©i⁄s
 {

854 
öode
 *(*
Æloc_öode
)(
su≥r_block
 *
sb
);

855 (*
de°roy_öode
)(
öode
 *);

857 (*
ªad_öode
Ë(
öode
 *);

859 (*
dúty_öode
Ë(
öode
 *);

860 (*
wrôe_öode
Ë(
öode
 *, );

861 (*
put_öode
Ë(
öode
 *);

862 (*
dr›_öode
Ë(
öode
 *);

863 (*
dñëe_öode
Ë(
öode
 *);

864 (*
put_su≥r
Ë(
su≥r_block
 *);

865 (*
wrôe_su≥r
Ë(
su≥r_block
 *);

866 (*
sync_fs
)(
su≥r_block
 *
sb
, 
waô
);

867 (*
wrôe_su≥r_lockfs
Ë(
su≥r_block
 *);

868 (*
u∆ockfs
Ë(
su≥r_block
 *);

869 (*
°©fs
Ë(
su≥r_block
 *, 
k°©fs
 *);

870 (*
ªmou¡_fs
Ë(
su≥r_block
 *, *, *);

871 (*
˛ór_öode
Ë(
öode
 *);

872 (*
umou¡_begö
Ë(
su≥r_block
 *);

874 (*
show_›ti⁄s
)(
£q_fûe
 *, 
vfsmou¡
 *);

878 
	#I_DIRTY_SYNC
 1

	)

879 
	#I_DIRTY_DATASYNC
 2

	)

880 
	#I_DIRTY_PAGES
 4

	)

881 
	#I_LOCK
 8

	)

882 
	#I_FREEING
 16

	)

883 
	#I_CLEAR
 32

	)

884 
	#I_NEW
 64

	)

886 
	#I_DIRTY
 (
I_DIRTY_SYNC
 | 
I_DIRTY_DATASYNC
 | 
I_DIRTY_PAGES
)

	)

888 
	`__m¨k_öode_dúty
(
öode
 *, );

889 
ölöe
 
	$m¨k_öode_dúty
(
öode
 *inode)

891 
	`__m¨k_öode_dúty
(
öode
, 
I_DIRTY
);

892 
	}
}

894 
ölöe
 
	$m¨k_öode_dúty_sync
(
öode
 *inode)

896 
	`__m¨k_öode_dúty
(
öode
, 
I_DIRTY_SYNC
);

897 
	}
}

980 
	sexp‹t_›î©i⁄s
 {

981 
	mdíåy
 *(*
	mdecode_fh
)(
su≥r_block
 *
	msb
, 
__u32
 *
	mfh
, 
	mfh_Àn
, 
	mfh_ty≥
,

982 (*
	mac˚±abÀ
)(*
	mc⁄ãxt
, 
díåy
 *
	mde
),

983 *
	mc⁄ãxt
);

984 (*
	mícode_fh
)(
díåy
 *
	mde
, 
__u32
 *
	mfh
, *
	mmax_Àn
,

985 
	mc⁄√˘abÀ
);

988 (*
	mgë_«me
)(
díåy
 *
	m∑ª¡
, *
	m«me
,

989 
díåy
 *
	mchûd
);

990 
	mdíåy
 * (*
	mgë_∑ª¡
)(
díåy
 *
	mchûd
);

991 
	mdíåy
 * (*
	mgë_díåy
)(
su≥r_block
 *
	msb
, *
	möump
);

994 
	mdíåy
 * (*
	mföd_exp‹ãd_díåy
)(

995 
su≥r_block
 *
	msb
, *
	mobj
, *
	m∑ª¡
,

996 (*
	mac˚±abÀ
)(*
	mc⁄ãxt
, 
díåy
 *
	mde
),

997 *
	mc⁄ãxt
);

1003 
	sfûe_sy°em_ty≥
 {

1004 c⁄° *
	m«me
;

1005 
	mfs_Êags
;

1006 
	msu≥r_block
 *(*
	mgë_sb
Ë(
	mfûe_sy°em_ty≥
 *, ,

1008 (*
	mkûl_sb
Ë(
	msu≥r_block
 *);

1009 
moduÀ
 *
	mow√r
;

1010 
fûe_sy°em_ty≥
 * 
	m√xt
;

1011 
li°_hód
 
	mfs_su≥rs
;

1014 
su≥r_block
 *
gë_sb_bdev
(
fûe_sy°em_ty≥
 *
fs_ty≥
,

1015 
Êags
, c⁄° *
dev_«me
, *
d©a
,

1016 (*
fûl_su≥r
)(
su≥r_block
 *, *, ));

1017 
su≥r_block
 *
	`gë_sb_sögÀ
(
fûe_sy°em_ty≥
 *
fs_ty≥
,

1018 
Êags
, *
d©a
,

1019 (*
fûl_su≥r
)(
su≥r_block
 *, *, ));

1020 
su≥r_block
 *
	`gë_sb_nodev
(
fûe_sy°em_ty≥
 *
fs_ty≥
,

1021 
Êags
, *
d©a
,

1022 (*
fûl_su≥r
)(
su≥r_block
 *, *, ));

1023 
	`gíîic_shutdown_su≥r
(
su≥r_block
 *
sb
);

1024 
	`kûl_block_su≥r
(
su≥r_block
 *
sb
);

1025 
	`kûl_™⁄_su≥r
(
su≥r_block
 *
sb
);

1026 
	`kûl_lôãr_su≥r
(
su≥r_block
 *
sb
);

1027 
	`dó˘iv©e_su≥r
(
su≥r_block
 *
sb
);

1028 
	`£t_™⁄_su≥r
(
su≥r_block
 *
s
, *
d©a
);

1029 
su≥r_block
 *
	`sgë
(
fûe_sy°em_ty≥
 *
ty≥
,

1030 (*
ã°
)(
su≥r_block
 *,*),

1031 (*
£t
)(
su≥r_block
 *,*),

1032 *
d©a
);

1033 
su≥r_block
 *
	`gë_sb_p£udo
(
fûe_sy°em_ty≥
 *, *,

1034 
su≥r_›î©i⁄s
 *
›s
, );

1037 
	#f›s_gë
(
f›s
) \

1038 (((
f›s
Ë&& 
	`åy_moduÀ_gë
((f›s)->
ow√r
Ë? (f›sË: 
NULL
))

	)

1039 
	#f›s_put
(
f›s
) \

1040 dÿ{ i‡(
f›s
Ë
	`moduÀ_put
((f›s)->
ow√r
); 
	}
} 0)

	)

1042 
ªgi°î_fûesy°em
(
fûe_sy°em_ty≥
 *);

1043 
uƒegi°î_fûesy°em
(
fûe_sy°em_ty≥
 *);

1044 
vfsmou¡
 *
kîn_mou¡
(
fûe_sy°em_ty≥
 *);

1045 
may_umou¡
(
vfsmou¡
 *);

1046 
do_mou¡
(*, *, *, , *);

1048 
vfs_°©fs
(
su≥r_block
 *, 
k°©fs
 *);

1053 
	#LOCK_USE_CLNT
 1

	)

1055 
	#FLOCK_VERIFY_READ
 1

	)

1056 
	#FLOCK_VERIFY_WRITE
 2

	)

1058 
locks_m™d©‹y_locked
(
öode
 *);

1059 
locks_m™d©‹y_¨ó
(, 
öode
 *, 
fûe
 *, 
loff_t
, 
size_t
);

1065 
	#MANDATORY_LOCK
(
öode
) \

1066 (
	`IS_MANDLOCK
(
öode
Ë&& ((öode)->
i_mode
 & (
S_ISGID
 | 
S_IXGRP
)Ë=S_ISGID)

	)

1068 
ölöe
 
	$locks_vîify_locked
(
öode
 *inode)

1070 i‡(
	`MANDATORY_LOCK
(
öode
))

1071  
	`locks_m™d©‹y_locked
(
öode
);

1073 
	}
}

1075 
ölöe
 
	$locks_vîify_¨ó
(
ªad_wrôe
, 
öode
 *inode,

1076 
fûe
 *
fûp
, 
loff_t
 
off£t
,

1077 
size_t
 
cou¡
)

1079 i‡(
öode
->
i_Êock
 && 
	`MANDATORY_LOCK
(inode))

1080  
	`locks_m™d©‹y_¨ó
(
ªad_wrôe
, 
öode
, 
fûp
, 
off£t
, 
cou¡
);

1082 
	}
}

1084 
ölöe
 
	$locks_vîify_åunˇã
(
öode
 *inode,

1085 
fûe
 *
fûp
,

1086 
loff_t
 
size
)

1088 i‡(
öode
->
i_Êock
 && 
	`MANDATORY_LOCK
(inode))

1089  
	`locks_m™d©‹y_¨ó
(

1090 
FLOCK_VERIFY_WRITE
, 
öode
, 
fûp
,

1091 
size
 < 
öode
->
i_size
 ? size : inode->i_size,

1092 (
size
 < 
öode
->
i_size
 ? inode->i_size - size

1093 : 
size
 - 
öode
->
i_size
)

1096 
	}
}

1098 
ölöe
 
	$bªak_Àa£
(
öode
 *öode, 
mode
)

1100 i‡(
öode
->
i_Êock
)

1101  
	`__bªak_Àa£
(
öode
, 
mode
);

1103 
	}
}

1107 
asmlökage
 
sys_›í
(c⁄° 
__u£r
 *, , );

1108 
asmlökage
 
sys_˛o£
();

1109 
do_åunˇã
(
díåy
 *, 
loff_t
 
°¨t
);

1111 
fûe
 *
fûp_›í
(const *, , );

1112 
fûe
 * 
díåy_›í
(
díåy
 *, 
vfsmou¡
 *, );

1113 
fûp_˛o£
(
fûe
 *, 
Ê_ow√r_t
 
id
);

1114 * 
gë«me
(c⁄° 
__u£r
 *);

1117 
vfs_ˇches_öô
();

1119 
	#__gë«me
(Ë
	`kmem_ˇche_Æloc
(
«mes_ˇchï
, 
SLAB_KERNEL
)

	)

1120 
	#puäame
(
«me
Ë
	`kmem_ˇche_‰ì
(
«mes_ˇchï
, (*)“ame))

	)

1122 íum {
	mBDEV_FILE
, 
	mBDEV_SWAP
, 
	mBDEV_FS
, 
	mBDEV_RAW
};

1123 
ªgi°î_blkdev
(, const *);

1124 
uƒegi°î_blkdev
(, const *);

1125 
block_devi˚
 *
bdgë
(
dev_t
);

1126 
bd_acquúe
(
öode
 *inode);

1127 
bd_f‹gë
(
öode
 *inode);

1128 
bdput
(
block_devi˚
 *);

1129 
blkdev_›í
(
öode
 *, 
fûe
 *);

1130 
blkdev_˛o£
(
öode
 *, 
fûe
 *);

1131 
block_devi˚
 *
›í_by_devnum
(
dev_t
, , );

1132 
fûe_›î©i⁄s
 
def_blk_f›s
;

1133 
addªss_•a˚_›î©i⁄s
 
def_blk_a›s
;

1134 
fûe_›î©i⁄s
 
def_chr_f›s
;

1135 
fûe_›î©i⁄s
 
bad_sock_f›s
;

1136 
fûe_›î©i⁄s
 
def_fifo_f›s
;

1137 
io˘l_by_bdev
(
block_devi˚
 *, , );

1138 
blkdev_io˘l
(
öode
 *, 
fûe
 *, , );

1139 
blkdev_gë
(
block_devi˚
 *, 
mode_t
, , );

1140 
blkdev_put
(
block_devi˚
 *, );

1141 
bd_˛aim
(
block_devi˚
 *, *);

1142 
bd_ªÀa£
(
block_devi˚
 *);

1143 
blk_run_queues
();

1146 
Æloc_chrdev_ªgi⁄
(
dev_t
 *, , , *);

1147 
ªgi°î_chrdev_ªgi⁄
(
dev_t
, , *);

1148 
ªgi°î_chrdev
(, const *,

1149 
fûe_›î©i⁄s
 *);

1150 
uƒegi°î_chrdev
(, const *);

1151 
uƒegi°î_chrdev_ªgi⁄
(
dev_t
, );

1152 
chrdev_›í
(
öode
 *, 
fûe
 *);

1155 
	#BDEVNAME_SIZE
 32

	)

1156 c⁄° *
__bdev«me
(
dev_t
, *
buf„r
);

1157 c⁄° *
bdev«me
(
block_devi˚
 *
bdev
, *
buf„r
);

1158 
block_devi˚
 *
lookup_bdev
(const *);

1159 
block_devi˚
 *
›í_bdev_ex˛
(const *, , , *);

1160 
˛o£_bdev_ex˛
(
block_devi˚
 *, );

1162 
öô_•ecül_öode
(
öode
 *, 
umode_t
, 
dev_t
);

1165 
make_bad_öode
(
öode
 *);

1166 
is_bad_öode
(
öode
 *);

1168 
fûe_›î©i⁄s
 
ªad_fifo_f›s
;

1169 
fûe_›î©i⁄s
 
wrôe_fifo_f›s
;

1170 
fûe_›î©i⁄s
 
rdwr_fifo_f›s
;

1171 
fûe_›î©i⁄s
 
ªad_pùe_f›s
;

1172 
fûe_›î©i⁄s
 
wrôe_pùe_f›s
;

1173 
fûe_›î©i⁄s
 
rdwr_pùe_f›s
;

1175 
fs_may_ªmou¡_ro
(
su≥r_block
 *);

1180 
	#bio_rw
(
bio
Ë((bio)->
bi_rw
 & (
RW_MASK
 | 
RWA_MASK
))

	)

1185 
	#bio_d©a_dú
(
bio
Ë((bio)->
bi_rw
 & 1)

	)

1187 
check_disk_ch™ge
(
block_devi˚
 *);

1188 
övÆid©e_öodes
(
su≥r_block
 *);

1189 
__övÆid©e_devi˚
(
block_devi˚
 *, );

1190 
övÆid©e_∑πôi⁄
(
gídisk
 *, );

1191 
övÆid©e_m≠pög_∑ges
(
addªss_•a˚
 *
m≠pög
,

1192 
pgoff_t
 
°¨t
,Ögoff_à
íd
);

1193 
övÆid©e_öode_∑ges
(
addªss_•a˚
 *
m≠pög
);

1194 
ölöe
 
	$övÆid©e_ªmŸe_öode
(
öode
 *inode)

1196 i‡(
	`S_ISREG
(
öode
->
i_mode
Ë|| 
	`S_ISDIR
(inode->i_mode) ||

1197 
	`S_ISLNK
(
öode
->
i_mode
))

1198 
	`övÆid©e_öode_∑ges
(
öode
->
i_m≠pög
);

1199 
	}
}

1200 
övÆid©e_öode_∑ges2
(
addªss_•a˚
 *
m≠pög
);

1201 
wrôe_öode_now
(
öode
 *, );

1202 
fûem≠_fd©awrôe
(
addªss_•a˚
 *);

1203 
fûem≠_Êush
(
addªss_•a˚
 *);

1204 
fûem≠_fd©awaô
(
addªss_•a˚
 *);

1205 
sync_su≥rs
();

1206 
sync_fûesy°ems
(
waô
);

1207 
emîgícy_sync
();

1208 
emîgícy_ªmou¡
();

1209 
do_ªmou¡_sb
(
su≥r_block
 *
sb
, 
Êags
,

1210 *
d©a
, 
f‹˚
);

1211 
£˘‹_t
 
bm≠
(
öode
 *, sector_t);

1212 
£èâr_mask
();

1213 
nŸify_ch™ge
(
díåy
 *, 
üâr
 *);

1214 
≥rmissi⁄
(
öode
 *, , 
«meid©a
 *);

1215 
vfs_≥rmissi⁄
(
öode
 *, );

1216 
gë_wrôe_ac˚ss
(
öode
 *);

1217 
díy_wrôe_ac˚ss
(
fûe
 *);

1218 
ölöe
 
	$put_wrôe_ac˚ss
(
öode
 * inode)

1220 
	`©omic_dec
(&
öode
->
i_wrôecou¡
);

1221 
	}
}

1222 
ölöe
 
	$Ælow_wrôe_ac˚ss
(
fûe
 *file)

1224 i‡(
fûe
)

1225 
	`©omic_öc
(&
fûe
->
f_díåy
->
d_öode
->
i_wrôecou¡
);

1226 
	}
}

1227 
do_pùe
(*);

1229 
›í_«mei
(c⁄° *, , , 
«meid©a
 *);

1230 
may_›í
(
«meid©a
 *, , );

1232 
kî√l_ªad
(
fûe
 *, , *, );

1233 
fûe
 * 
›í_exec
(const *);

1236 
is_subdú
(
díåy
 *, dentry *);

1237 
öo_t
 
föd_öode_numbî
(
díåy
 *, 
q°r
 *);

1239 
	~<löux/îr.h
>

1242 
loff_t
 
deÁu…_Œ£ek
(
fûe
 *fûe,Üoff_à
off£t
, 
‹igö
);

1244 
öode_öô_⁄˚
(
öode
 *);

1245 
ùut
(
öode
 *);

1246 
öode
 * 
igøb
(inode *);

1247 
öo_t
 
iunique
(
su≥r_block
 *, ino_t);

1248 
öode_√eds_sync
(
öode
 *inode);

1249 
gíîic_dñëe_öode
(
öode
 *inode);

1251 
öode
 *
ûookup5
(
su≥r_block
 *
sb
, 
hashvÆ
,

1252 (*
ã°
)(
öode
 *, *), *
d©a
);

1253 
öode
 *
	`ûookup
(
su≥r_block
 *
sb
, 
öo
);

1255 
öode
 * 
	`igë5_locked
(
su≥r_block
 *, , (*
ã°
)(öodê*, *), (*
£t
)(inode *, *), *);

1256 
öode
 * 
	`igë_locked
(
su≥r_block
 *, );

1257 
	`u∆ock_√w_öode
(
öode
 *);

1259 
ölöe
 
öode
 *
	$igë
(
su≥r_block
 *
sb
, 
öo
)

1261 
öode
 *öodê
	`igë_locked
(
sb
, 
öo
);

1263 i‡(
öode
 && (öode->
i_°©e
 & 
I_NEW
)) {

1264 
sb
->
s_›
->
	`ªad_öode
(
öode
);

1265 
	`u∆ock_√w_öode
(
öode
);

1268  
öode
;

1269 
	}
}

1271 
__igë
(
öode
 * inode);

1272 
˛ór_öode
(
öode
 *);

1273 
de°roy_öode
(
öode
 *);

1274 
öode
 *
√w_öode
(
su≥r_block
 *);

1275 
ªmove_suid
(
díåy
 *);

1277 
__ö£π_öode_hash
(
öode
 *, 
hashvÆ
);

1278 
ªmove_öode_hash
(
öode
 *);

1279 
ölöe
 
	$ö£π_öode_hash
(
öode
 *inode) {

1280 
	`__ö£π_öode_hash
(
öode
, inode->
i_öo
);

1281 
	}
}

1283 
fûe
 * 
gë_em±y_fûp
();

1284 
fûe_move
(
fûe
 *
f
, 
li°_hód
 *
li°
);

1285 
fûe_kûl
(
fûe
 *
f
);

1286 
	gbio
;

1287 
submô_bio
(, 
bio
 *);

1288 
bdev_ªad_⁄ly
(
block_devi˚
 *);

1289 
£t_blocksize
(
block_devi˚
 *, );

1290 
sb_£t_blocksize
(
su≥r_block
 *, );

1291 
sb_mö_blocksize
(
su≥r_block
 *, );

1293 
gíîic_fûe_mm≠
(
fûe
 *, 
vm_¨ó_°ru˘
 *);

1294 
gíîic_fûe_ªad⁄ly_mm≠
(
fûe
 *, 
vm_¨ó_°ru˘
 *);

1295 
fûe_ªad_a˘‹
(
ªad_des¸ùt‹_t
 * 
desc
, 
∑ge
 *∑ge, 
off£t
, 
size
);

1296 
fûe_£nd_a˘‹
(
ªad_des¸ùt‹_t
 * 
desc
, 
∑ge
 *∑ge, 
off£t
, 
size
);

1297 
ssize_t
 
gíîic_fûe_ªad
(
fûe
 *, 
__u£r
 *, 
size_t
, 
loff_t
 *);

1298 
gíîic_wrôe_checks
(
öode
 *öode, 
fûe
 *file,

1299 
loff_t
 *
pos
, 
size_t
 *
cou¡
, 
isblk
);

1300 
ssize_t
 
gíîic_fûe_wrôe
(
fûe
 *, c⁄° 
__u£r
 *, 
size_t
, 
loff_t
 *);

1301 
ssize_t
 
gíîic_fûe_aio_ªad
(
kiocb
 *, 
__u£r
 *, 
size_t
, 
loff_t
);

1302 
ssize_t
 
__gíîic_fûe_aio_ªad
(
kiocb
 *, c⁄° 
iovec
 *, , 
loff_t
 *);

1303 
ssize_t
 
gíîic_fûe_aio_wrôe
(
kiocb
 *, c⁄° 
__u£r
 *, 
size_t
, 
loff_t
);

1304 
ssize_t
 
gíîic_fûe_aio_wrôe_nﬁock
(
kiocb
 *, c⁄° 
iovec
 *,

1305 , 
loff_t
 *);

1306 
ssize_t
 
do_sync_ªad
(
fûe
 *
fûp
, 
__u£r
 *
buf
, 
size_t
 
Àn
, 
loff_t
 *
µos
);

1307 
ssize_t
 
do_sync_wrôe
(
fûe
 *
fûp
, c⁄° 
__u£r
 *
buf
, 
size_t
 
Àn
, 
loff_t
 *
µos
);

1308 
ssize_t
 
gíîic_fûe_wrôe_nﬁock
(
fûe
 *fûe, c⁄° 
iovec
 *
iov
,

1309 
ƒ_£gs
, 
loff_t
 *
µos
);

1310 
ssize_t
 
gíîic_fûe_£ndfûe
(
fûe
 *, 
loff_t
 *, 
size_t
, 
ªad_a˘‹_t
, 
__u£r
 *);

1311 
do_gíîic_m≠pög_ªad
(
addªss_•a˚
 *, 
fûe_ø_°©e
 *, 
fûe
 *,

1312 
loff_t
 *, 
ªad_des¸ùt‹_t
 *, 
ªad_a˘‹_t
);

1314 
fûe_ø_°©e_öô
(
fûe_ø_°©e
 *
ø
, 
addªss_•a˚
 *
m≠pög
);

1315 
ssize_t
 
gíîic_fûe_dúe˘_IO
(
rw
, 
kiocb
 *
iocb
,

1316 c⁄° 
iovec
 *
iov
, 
loff_t
 
off£t
, 
ƒ_£gs
);

1317 
blockdev_dúe˘_IO
(
rw
, 
kiocb
 *
iocb
, 
öode
 *inode,

1318 
block_devi˚
 *
bdev
, c⁄° 
iovec
 *
iov
, 
loff_t
 
off£t
,

1319 
ƒ_£gs
, 
gë_blocks_t
 *
gë_blocks
, 
dio_iod⁄e_t
 *
íd_io
);

1320 
ssize_t
 
gíîic_fûe_ªadv
(
fûe
 *
fûp
, c⁄° 
iovec
 *
iov
,

1321 
ƒ_£gs
, 
loff_t
 *
µos
);

1322 
ssize_t
 
gíîic_fûe_wrôev
(
fûe
 *
fûp
, c⁄° 
iovec
 *
iov
,

1323 
ƒ_£gs
, 
loff_t
 *
µos
);

1324 
loff_t
 
no_Œ£ek
(
fûe
 *fûe,Üoff_à
off£t
, 
‹igö
);

1325 
loff_t
 
gíîic_fûe_Œ£ek
(
fûe
 *fûe,Üoff_à
off£t
, 
‹igö
);

1326 
loff_t
 
ªmŸe_Œ£ek
(
fûe
 *fûe,Üoff_à
off£t
, 
‹igö
);

1327 
gíîic_fûe_›í
(
öode
 * inode, 
fûe
 * 
fûp
);

1329 
ölöe
 
	$do_gíîic_fûe_ªad
(
fûe
 * 
fûp
, 
loff_t
 *
µos
,

1330 
ªad_des¸ùt‹_t
 * 
desc
,

1331 
ªad_a˘‹_t
 
a˘‹
)

1333 
	`do_gíîic_m≠pög_ªad
(
fûp
->
f_díåy
->
d_öode
->
i_m≠pög
,

1334 &
fûp
->
f_ø
,

1335 
fûp
,

1336 
µos
,

1337 
desc
,

1338 
a˘‹
);

1339 
	}
}

1341 
fûe_›î©i⁄s
 
gíîic_ro_f›s
;

1343 
	#•ecül_fûe
(
m
Ë(
	`S_ISCHR
(m)||
	`S_ISBLK
(m)||
	`S_ISFIFO
(m)||
	`S_ISSOCK
(m))

	)

1345 
vfs_ªadlök
(
díåy
 *, 
__u£r
 *, , const *);

1346 
vfs_fﬁlow_lök
(
«meid©a
 *, const *);

1347 
∑ge_ªadlök
(
díåy
 *, 
__u£r
 *, );

1348 
∑ge_fﬁlow_lök
(
díåy
 *, 
«meid©a
 *);

1349 
∑ge_symlök
(
öode
 *öode, c⁄° *
sym«me
, 
Àn
);

1350 
öode_›î©i⁄s
 
∑ge_symlök_öode_›î©i⁄s
;

1351 
gíîic_fûœâr
(
öode
 *, 
k°©
 *);

1352 
vfs_gë©å
(
vfsmou¡
 *, 
díåy
 *, 
k°©
 *);

1353 
öode_add_byãs
(
öode
 *öode, 
loff_t
 
byãs
);

1354 
öode_sub_byãs
(
öode
 *öode, 
loff_t
 
byãs
);

1355 
loff_t
 
öode_gë_byãs
(
öode
 *inode);

1356 
öode_£t_byãs
(
öode
 *öode, 
loff_t
 
byãs
);

1358 
vfs_ªaddú
(
fûe
 *, 
fûldú_t
, *);

1360 
vfs_°©
(
__u£r
 *, 
k°©
 *);

1361 
vfs_l°©
(
__u£r
 *, 
k°©
 *);

1362 
vfs_f°©
(, 
k°©
 *);

1364 
fûe_sy°em_ty≥
 *
gë_fs_ty≥
(c⁄° *
«me
);

1365 
su≥r_block
 *
gë_su≥r
(
block_devi˚
 *);

1366 
su≥r_block
 *
u£r_gë_su≥r
(
dev_t
);

1367 
dr›_su≥r
(
su≥r_block
 *
sb
);

1369 
dˇche_dú_›í
(
öode
 *, 
fûe
 *);

1370 
dˇche_dú_˛o£
(
öode
 *, 
fûe
 *);

1371 
loff_t
 
dˇche_dú_l£ek
(
fûe
 *,Üoff_t, );

1372 
dˇche_ªaddú
(
fûe
 *, *, 
fûldú_t
);

1373 
sim∂e_gë©å
(
vfsmou¡
 *, 
díåy
 *, 
k°©
 *);

1374 
sim∂e_°©fs
(
su≥r_block
 *, 
k°©fs
 *);

1375 
sim∂e_lök
(
díåy
 *, 
öode
 *, dentry *);

1376 
sim∂e_u∆ök
(
öode
 *, 
díåy
 *);

1377 
sim∂e_rmdú
(
öode
 *, 
díåy
 *);

1378 
sim∂e_ª«me
(
öode
 *, 
díåy
 *, inode *, dentry *);

1379 
sim∂e_sync_fûe
(
fûe
 *, 
díåy
 *, );

1380 
sim∂e_em±y
(
díåy
 *);

1381 
sim∂e_ªad∑ge
(
fûe
 *fûe, 
∑ge
 *page);

1382 
sim∂e_¥ï¨e_wrôe
(
fûe
 *fûe, 
∑ge
 *page,

1383 
off£t
, 
to
);

1384 
sim∂e_commô_wrôe
(
fûe
 *fûe, 
∑ge
 *page,

1385 
off£t
, 
to
);

1387 
díåy
 *
sim∂e_lookup
(
öode
 *, díåy *, 
«meid©a
 *);

1388 
ssize_t
 
gíîic_ªad_dú
(
fûe
 *, 
__u£r
 *, 
size_t
, 
loff_t
 *);

1389 
fûe_›î©i⁄s
 
sim∂e_dú_›î©i⁄s
;

1390 
öode_›î©i⁄s
 
sim∂e_dú_öode_›î©i⁄s
;

1391 
	såì_des¸
 { *
	m«me
; 
fûe_›î©i⁄s
 *
	m›s
; 
	mmode
; };

1392 
sim∂e_fûl_su≥r
(
su≥r_block
 *, , 
åì_des¸
 *);

1393 
sim∂e_pö_fs
(*
«me
, 
vfsmou¡
 **
mou¡
, *
cou¡
);

1394 
sim∂e_ªÀa£_fs
(
vfsmou¡
 **
mou¡
, *
cou¡
);

1396 
öode_ch™ge_ok
(
öode
 *, 
üâr
 *);

1397 
öode_£èâr
(
öode
 *, 
üâr
 *);

1399 
öode_upd©e_time
(
öode
 *öode, 
˘ime_too
);

1401 
ölöe
 
öo_t
 
	$∑ª¡_öo
(
díåy
 *dentry)

1403 
öo_t
 
ªs
;

1405 
	`•ö_lock
(&
díåy
->
d_lock
);

1406 
ªs
 = 
díåy
->
d_∑ª¡
->
d_öode
->
i_öo
;

1407 
	`•ö_u∆ock
(&
díåy
->
d_lock
);

1408  
ªs
;

1409 
	}
}

	@/usr/include/linux/init.h

1 #i‚de‡
_LINUX_INIT_H


2 
	#_LINUX_INIT_H


	)

4 
	~<löux/c⁄fig.h
>

43 
	#__öô
 
	`__©åibuã__
 ((
	`__£˘i⁄__
 (".öô.ãxt")))

	)

44 
	#__öôd©a
 
	`__©åibuã__
 ((
	`__£˘i⁄__
 (".öô.d©a")))

	)

45 
	#__exôd©a
 
	`__©åibuã__
 ((
	`__£˘i⁄__
(".exô.d©a")))

	)

46 
	#__exô_ˇŒ
 
__©åibuã_u£d__
 
	`__©åibuã__
 ((
	`__£˘i⁄__
 (".exôˇŒ.exô")))

	)

48 #ifde‡
MODULE


49 
	#__exô
 
	`__©åibuã__
 ((
	`__£˘i⁄__
(".exô.ãxt")))

	)

51 
	#__exô
 
__©åibuã_u£d__
 
	`__©åibuã__
 ((
	`__£˘i⁄__
(".exô.ãxt")))

	)

55 
	#__INIT
 .
£˘i⁄
 ".öô.ãxt","ax"

	)

56 
	#__FINIT
 .
¥evious


	)

57 
	#__INITDATA
 .
£˘i⁄
 ".öô.d©a","aw"

	)

59 #i‚de‡
__ASSEMBLY__


63 (*
	töôˇŒ_t
)();

64 (*
	texôˇŒ_t
)();

66 
öôˇŒ_t
 
__c⁄_öôˇŒ_°¨t
, 
__c⁄_öôˇŒ_íd
;

67 
öôˇŒ_t
 
__£curôy_öôˇŒ_°¨t
, 
__£curôy_öôˇŒ_íd
;

70 #i‚de‡
MODULE


72 #i‚de‡
__ASSEMBLY__


81 
	#__deföe_öôˇŒ
(
Àvñ
,
‚
) \

82 
öôˇŒ_t
 
__öôˇŒ_
##
‚
 
__©åibuã_u£d__
 \

83 
	`__©åibuã__
((
	`__£˘i⁄__
(".öôˇŒ" 
Àvñ
 ".öô"))Ë
‚


	)

85 
	#c‹e_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("1",‚)

	)

86 
	#po°c‹e_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("2",‚)

	)

87 
	#¨ch_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("3",‚)

	)

88 
	#subsys_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("4",‚)

	)

89 
	#fs_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("5",‚)

	)

90 
	#devi˚_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("6",‚)

	)

91 
	#œã_öôˇŒ
(
‚
Ë
	`__deföe_öôˇŒ
("7",‚)

	)

93 
	#__öôˇŒ
(
‚
Ë
	`devi˚_öôˇŒ
(‚)

	)

95 
	#__exôˇŒ
(
‚
) \

96 
exôˇŒ_t
 
__exôˇŒ_
##
‚
 
__exô_ˇŒ
 = 
	)
fn

98 
	#c⁄sﬁe_öôˇŒ
(
‚
) \

99 
öôˇŒ_t
 
__öôˇŒ_
##
‚
 \

100 
__©åibuã_u£d__
 
	`__©åibuã__
((
	`__£˘i⁄__
(".c⁄_öôˇŒ.öô")))=
‚


	)

102 
	#£curôy_öôˇŒ
(
‚
) \

103 
öôˇŒ_t
 
__öôˇŒ_
##
‚
 \

104 
__©åibuã_u£d__
 
	`__©åibuã__
((
	`__£˘i⁄__
(".£curôy_öôˇŒ.öô"))Ë
‚


	)

106 
	sobs_kî√l_∑øm
 {

107 c⁄° *
°r
;

108 (*
£tup_func
)(*);

112 
	#__£tup
(
°r
, 
‚
) \

113 
__£tup_°r_
##
‚
[] 
__öôd©a
 = 
°r
; \

114 
obs_kî√l_∑øm
 
__£tup_
##
‚
 \

115 
__©åibuã_u£d__
 \

116 
	`__©åibuã__
((
	`__£˘i⁄__
(".init.setup"))) \

117 { 
__£tup_°r_
##
‚
, f¿
	}

	)
}

129 
	#moduÀ_öô
(
x
Ë
	`__öôˇŒ
(x);

	)

141 
	#moduÀ_exô
(
x
Ë
	`__exôˇŒ
(x);

	)

146 
	#c‹e_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

147 
	#po°c‹e_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

148 
	#¨ch_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

149 
	#subsys_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

150 
	#fs_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

151 
	#devi˚_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

152 
	#œã_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

154 
	#£curôy_öôˇŒ
(
‚
Ë
	`moduÀ_öô
(‚)

	)

163 
	#moduÀ_öô
(
öô‚
) \

164 
ölöe
 
öôˇŒ_t
 
	`__öôã°
() \

165 {  
öô‚
; } \

166 
	`öô_moduÀ
(Ë
	`__©åibuã__
((
	`Æüs
(#öô‚)));

	)

169 
	#moduÀ_exô
(
exô‚
) \

170 
ölöe
 
exôˇŒ_t
 
	`__exôã°
() \

171 {  
exô‚
; } \

172 
	`˛ónup_moduÀ
(Ë
	`__©åibuã__
((
	`Æüs
(#exô‚)));

	)

174 
	#__£tup
(
°r
,
func
Ë

	)

178 
	#__noßved©a
 
	`__©åibuã__
 ((
	`__£˘i⁄__
 (".d©a.noßve")))

	)

182 #ifde‡
CONFIG_MODULES


183 
	#__öô_‹_moduÀ


	)

184 
	#__öôd©a_‹_moduÀ


	)

186 
	#__öô_‹_moduÀ
 
__öô


	)

187 
	#__öôd©a_‹_moduÀ
 
__öôd©a


	)

190 #ifde‡
CONFIG_HOTPLUG


191 
	#__devöô


	)

192 
	#__devöôd©a


	)

193 
	#__devexô


	)

194 
	#__devexôd©a


	)

196 
	#__devöô
 
__öô


	)

197 
	#__devöôd©a
 
__öôd©a


	)

198 
	#__devexô
 
__exô


	)

199 
	#__devexôd©a
 
__exôd©a


	)

208 #i‡
deföed
(
MODULE
Ë|| deföed(
CONFIG_HOTPLUG
)

209 
	#__devexô_p
(
x
Ë
	)
x

211 
	#__devexô_p
(
x
Ë
NULL


	)

214 #ifde‡
MODULE


215 
	#__exô_p
(
x
Ë
	)
x

217 
	#__exô_p
(
x
Ë
NULL


	)

	@/usr/include/linux/input.h

1 #i‚de‡
_INPUT_H


2 
	#_INPUT_H


	)

12 #ifde‡
__KERNEL__


13 
	~<löux/time.h
>

14 
	~<löux/li°.h
>

16 
	~<sys/time.h
>

17 
	~<sys/io˘l.h
>

18 
	~<asm/ty≥s.h
>

25 
	söput_evít
 {

26 
timevÆ
 
	mtime
;

27 
__u16
 
	mty≥
;

28 
__u16
 
	mcode
;

29 
__s32
 
	mvÆue
;

36 
	#EV_VERSION
 0x010000

	)

42 
	söput_id
 {

43 
__u16
 
	mbu°y≥
;

44 
__u16
 
	mvíd‹
;

45 
__u16
 
	m¥odu˘
;

46 
__u16
 
	mvîsi⁄
;

49 
	söput_absöfo
 {

50 
__s32
 
	mvÆue
;

51 
__s32
 
	mmöimum
;

52 
__s32
 
	mmaximum
;

53 
__s32
 
	mfuzz
;

54 
__s32
 
	mÊ©
;

57 
	#EVIOCGVERSION
 
	`_IOR
('E', 0x01, Ë

	)

58 
	#EVIOCGID
 
	`_IOR
('E', 0x02, 
öput_id
Ë

	)

59 
	#EVIOCGKEYCODE
 
	`_IOR
('E', 0x04, [2]Ë

	)

60 
	#EVIOCSKEYCODE
 
	`_IOW
('E', 0x04, [2]Ë

	)

62 
	#EVIOCGNAME
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x06,ÜíË

	)

63 
	#EVIOCGPHYS
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x07,ÜíË

	)

64 
	#EVIOCGUNIQ
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x08,ÜíË

	)

66 
	#EVIOCGKEY
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x18,ÜíË

	)

67 
	#EVIOCGLED
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x19,ÜíË

	)

68 
	#EVIOCGSND
(
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x1a,ÜíË

	)

70 
	#EVIOCGBIT
(
ev
,
Àn
Ë
	`_IOC
(
_IOC_READ
, 'E', 0x20 +Év,ÜíË

	)

71 
	#EVIOCGABS
(
abs
Ë
	`_IOR
('E', 0x40 +ábs, 
öput_absöfo
Ë

	)

72 
	#EVIOCSABS
(
abs
Ë
	`_IOW
('E', 0xc0 +ábs, 
öput_absöfo
Ë

	)

74 
	#EVIOCSFF
 
	`_IOC
(
_IOC_WRITE
, 'E', 0x80, (
ff_ef„˘
)Ë

	)

75 
	#EVIOCRMFF
 
	`_IOW
('E', 0x81, Ë

	)

76 
	#EVIOCGEFFECTS
 
	`_IOR
('E', 0x84, Ë

	)

78 
	#EVIOCGRAB
 
	`_IOW
('E', 0x90, Ë

	)

84 
	#EV_SYN
 0x00

	)

85 
	#EV_KEY
 0x01

	)

86 
	#EV_REL
 0x02

	)

87 
	#EV_ABS
 0x03

	)

88 
	#EV_MSC
 0x04

	)

89 
	#EV_LED
 0x11

	)

90 
	#EV_SND
 0x12

	)

91 
	#EV_REP
 0x14

	)

92 
	#EV_FF
 0x15

	)

93 
	#EV_PWR
 0x16

	)

94 
	#EV_FF_STATUS
 0x17

	)

95 
	#EV_MAX
 0x1f

	)

101 
	#SYN_REPORT
 0

	)

102 
	#SYN_CONFIG
 1

	)

108 
	#KEY_RESERVED
 0

	)

109 
	#KEY_ESC
 1

	)

110 
	#KEY_1
 2

	)

111 
	#KEY_2
 3

	)

112 
	#KEY_3
 4

	)

113 
	#KEY_4
 5

	)

114 
	#KEY_5
 6

	)

115 
	#KEY_6
 7

	)

116 
	#KEY_7
 8

	)

117 
	#KEY_8
 9

	)

118 
	#KEY_9
 10

	)

119 
	#KEY_0
 11

	)

120 
	#KEY_MINUS
 12

	)

121 
	#KEY_EQUAL
 13

	)

122 
	#KEY_BACKSPACE
 14

	)

123 
	#KEY_TAB
 15

	)

124 
	#KEY_Q
 16

	)

125 
	#KEY_W
 17

	)

126 
	#KEY_E
 18

	)

127 
	#KEY_R
 19

	)

128 
	#KEY_T
 20

	)

129 
	#KEY_Y
 21

	)

130 
	#KEY_U
 22

	)

131 
	#KEY_I
 23

	)

132 
	#KEY_O
 24

	)

133 
	#KEY_P
 25

	)

134 
	#KEY_LEFTBRACE
 26

	)

135 
	#KEY_RIGHTBRACE
 27

	)

136 
	#KEY_ENTER
 28

	)

137 
	#KEY_LEFTCTRL
 29

	)

138 
	#KEY_A
 30

	)

139 
	#KEY_S
 31

	)

140 
	#KEY_D
 32

	)

141 
	#KEY_F
 33

	)

142 
	#KEY_G
 34

	)

143 
	#KEY_H
 35

	)

144 
	#KEY_J
 36

	)

145 
	#KEY_K
 37

	)

146 
	#KEY_L
 38

	)

147 
	#KEY_SEMICOLON
 39

	)

148 
	#KEY_APOSTROPHE
 40

	)

149 
	#KEY_GRAVE
 41

	)

150 
	#KEY_LEFTSHIFT
 42

	)

151 
	#KEY_BACKSLASH
 43

	)

152 
	#KEY_Z
 44

	)

153 
	#KEY_X
 45

	)

154 
	#KEY_C
 46

	)

155 
	#KEY_V
 47

	)

156 
	#KEY_B
 48

	)

157 
	#KEY_N
 49

	)

158 
	#KEY_M
 50

	)

159 
	#KEY_COMMA
 51

	)

160 
	#KEY_DOT
 52

	)

161 
	#KEY_SLASH
 53

	)

162 
	#KEY_RIGHTSHIFT
 54

	)

163 
	#KEY_KPASTERISK
 55

	)

164 
	#KEY_LEFTALT
 56

	)

165 
	#KEY_SPACE
 57

	)

166 
	#KEY_CAPSLOCK
 58

	)

167 
	#KEY_F1
 59

	)

168 
	#KEY_F2
 60

	)

169 
	#KEY_F3
 61

	)

170 
	#KEY_F4
 62

	)

171 
	#KEY_F5
 63

	)

172 
	#KEY_F6
 64

	)

173 
	#KEY_F7
 65

	)

174 
	#KEY_F8
 66

	)

175 
	#KEY_F9
 67

	)

176 
	#KEY_F10
 68

	)

177 
	#KEY_NUMLOCK
 69

	)

178 
	#KEY_SCROLLLOCK
 70

	)

179 
	#KEY_KP7
 71

	)

180 
	#KEY_KP8
 72

	)

181 
	#KEY_KP9
 73

	)

182 
	#KEY_KPMINUS
 74

	)

183 
	#KEY_KP4
 75

	)

184 
	#KEY_KP5
 76

	)

185 
	#KEY_KP6
 77

	)

186 
	#KEY_KPPLUS
 78

	)

187 
	#KEY_KP1
 79

	)

188 
	#KEY_KP2
 80

	)

189 
	#KEY_KP3
 81

	)

190 
	#KEY_KP0
 82

	)

191 
	#KEY_KPDOT
 83

	)

192 
	#KEY_103RD
 84

	)

193 
	#KEY_F13
 85

	)

194 
	#KEY_102ND
 86

	)

195 
	#KEY_F11
 87

	)

196 
	#KEY_F12
 88

	)

197 
	#KEY_F14
 89

	)

198 
	#KEY_F15
 90

	)

199 
	#KEY_F16
 91

	)

200 
	#KEY_F17
 92

	)

201 
	#KEY_F18
 93

	)

202 
	#KEY_F19
 94

	)

203 
	#KEY_F20
 95

	)

204 
	#KEY_KPENTER
 96

	)

205 
	#KEY_RIGHTCTRL
 97

	)

206 
	#KEY_KPSLASH
 98

	)

207 
	#KEY_SYSRQ
 99

	)

208 
	#KEY_RIGHTALT
 100

	)

209 
	#KEY_LINEFEED
 101

	)

210 
	#KEY_HOME
 102

	)

211 
	#KEY_UP
 103

	)

212 
	#KEY_PAGEUP
 104

	)

213 
	#KEY_LEFT
 105

	)

214 
	#KEY_RIGHT
 106

	)

215 
	#KEY_END
 107

	)

216 
	#KEY_DOWN
 108

	)

217 
	#KEY_PAGEDOWN
 109

	)

218 
	#KEY_INSERT
 110

	)

219 
	#KEY_DELETE
 111

	)

220 
	#KEY_MACRO
 112

	)

221 
	#KEY_MUTE
 113

	)

222 
	#KEY_VOLUMEDOWN
 114

	)

223 
	#KEY_VOLUMEUP
 115

	)

224 
	#KEY_POWER
 116

	)

225 
	#KEY_KPEQUAL
 117

	)

226 
	#KEY_KPPLUSMINUS
 118

	)

227 
	#KEY_PAUSE
 119

	)

228 
	#KEY_F21
 120

	)

229 
	#KEY_F22
 121

	)

230 
	#KEY_F23
 122

	)

231 
	#KEY_F24
 123

	)

232 
	#KEY_KPCOMMA
 124

	)

233 
	#KEY_LEFTMETA
 125

	)

234 
	#KEY_RIGHTMETA
 126

	)

235 
	#KEY_COMPOSE
 127

	)

237 
	#KEY_STOP
 128

	)

238 
	#KEY_AGAIN
 129

	)

239 
	#KEY_PROPS
 130

	)

240 
	#KEY_UNDO
 131

	)

241 
	#KEY_FRONT
 132

	)

242 
	#KEY_COPY
 133

	)

243 
	#KEY_OPEN
 134

	)

244 
	#KEY_PASTE
 135

	)

245 
	#KEY_FIND
 136

	)

246 
	#KEY_CUT
 137

	)

247 
	#KEY_HELP
 138

	)

248 
	#KEY_MENU
 139

	)

249 
	#KEY_CALC
 140

	)

250 
	#KEY_SETUP
 141

	)

251 
	#KEY_SLEEP
 142

	)

252 
	#KEY_WAKEUP
 143

	)

253 
	#KEY_FILE
 144

	)

254 
	#KEY_SENDFILE
 145

	)

255 
	#KEY_DELETEFILE
 146

	)

256 
	#KEY_XFER
 147

	)

257 
	#KEY_PROG1
 148

	)

258 
	#KEY_PROG2
 149

	)

259 
	#KEY_WWW
 150

	)

260 
	#KEY_MSDOS
 151

	)

261 
	#KEY_COFFEE
 152

	)

262 
	#KEY_DIRECTION
 153

	)

263 
	#KEY_CYCLEWINDOWS
 154

	)

264 
	#KEY_MAIL
 155

	)

265 
	#KEY_BOOKMARKS
 156

	)

266 
	#KEY_COMPUTER
 157

	)

267 
	#KEY_BACK
 158

	)

268 
	#KEY_FORWARD
 159

	)

269 
	#KEY_CLOSECD
 160

	)

270 
	#KEY_EJECTCD
 161

	)

271 
	#KEY_EJECTCLOSECD
 162

	)

272 
	#KEY_NEXTSONG
 163

	)

273 
	#KEY_PLAYPAUSE
 164

	)

274 
	#KEY_PREVIOUSSONG
 165

	)

275 
	#KEY_STOPCD
 166

	)

276 
	#KEY_RECORD
 167

	)

277 
	#KEY_REWIND
 168

	)

278 
	#KEY_PHONE
 169

	)

279 
	#KEY_ISO
 170

	)

280 
	#KEY_CONFIG
 171

	)

281 
	#KEY_HOMEPAGE
 172

	)

282 
	#KEY_REFRESH
 173

	)

283 
	#KEY_EXIT
 174

	)

284 
	#KEY_MOVE
 175

	)

285 
	#KEY_EDIT
 176

	)

286 
	#KEY_SCROLLUP
 177

	)

287 
	#KEY_SCROLLDOWN
 178

	)

288 
	#KEY_KPLEFTPAREN
 179

	)

289 
	#KEY_KPRIGHTPAREN
 180

	)

291 
	#KEY_INTL1
 181

	)

292 
	#KEY_INTL2
 182

	)

293 
	#KEY_INTL3
 183

	)

294 
	#KEY_INTL4
 184

	)

295 
	#KEY_INTL5
 185

	)

296 
	#KEY_INTL6
 186

	)

297 
	#KEY_INTL7
 187

	)

298 
	#KEY_INTL8
 188

	)

299 
	#KEY_INTL9
 189

	)

300 
	#KEY_LANG1
 190

	)

301 
	#KEY_LANG2
 191

	)

302 
	#KEY_LANG3
 192

	)

303 
	#KEY_LANG4
 193

	)

304 
	#KEY_LANG5
 194

	)

305 
	#KEY_LANG6
 195

	)

306 
	#KEY_LANG7
 196

	)

307 
	#KEY_LANG8
 197

	)

308 
	#KEY_LANG9
 198

	)

310 
	#KEY_PLAYCD
 200

	)

311 
	#KEY_PAUSECD
 201

	)

312 
	#KEY_PROG3
 202

	)

313 
	#KEY_PROG4
 203

	)

314 
	#KEY_SUSPEND
 205

	)

315 
	#KEY_CLOSE
 206

	)

316 
	#KEY_PLAY
 207

	)

317 
	#KEY_FASTFORWARD
 208

	)

318 
	#KEY_BASSBOOST
 209

	)

319 
	#KEY_PRINT
 210

	)

320 
	#KEY_HP
 211

	)

321 
	#KEY_CAMERA
 212

	)

322 
	#KEY_SOUND
 213

	)

323 
	#KEY_QUESTION
 214

	)

324 
	#KEY_EMAIL
 215

	)

325 
	#KEY_CHAT
 216

	)

326 
	#KEY_SEARCH
 217

	)

327 
	#KEY_CONNECT
 218

	)

328 
	#KEY_FINANCE
 219

	)

329 
	#KEY_SPORT
 220

	)

330 
	#KEY_SHOP
 221

	)

331 
	#KEY_ALTERASE
 222

	)

332 
	#KEY_CANCEL
 223

	)

333 
	#KEY_BRIGHTNESSDOWN
 224

	)

334 
	#KEY_BRIGHTNESSUP
 225

	)

335 
	#KEY_MEDIA
 226

	)

337 
	#KEY_UNKNOWN
 240

	)

339 
	#BTN_MISC
 0x100

	)

340 
	#BTN_0
 0x100

	)

341 
	#BTN_1
 0x101

	)

342 
	#BTN_2
 0x102

	)

343 
	#BTN_3
 0x103

	)

344 
	#BTN_4
 0x104

	)

345 
	#BTN_5
 0x105

	)

346 
	#BTN_6
 0x106

	)

347 
	#BTN_7
 0x107

	)

348 
	#BTN_8
 0x108

	)

349 
	#BTN_9
 0x109

	)

351 
	#BTN_MOUSE
 0x110

	)

352 
	#BTN_LEFT
 0x110

	)

353 
	#BTN_RIGHT
 0x111

	)

354 
	#BTN_MIDDLE
 0x112

	)

355 
	#BTN_SIDE
 0x113

	)

356 
	#BTN_EXTRA
 0x114

	)

357 
	#BTN_FORWARD
 0x115

	)

358 
	#BTN_BACK
 0x116

	)

359 
	#BTN_TASK
 0x117

	)

361 
	#BTN_JOYSTICK
 0x120

	)

362 
	#BTN_TRIGGER
 0x120

	)

363 
	#BTN_THUMB
 0x121

	)

364 
	#BTN_THUMB2
 0x122

	)

365 
	#BTN_TOP
 0x123

	)

366 
	#BTN_TOP2
 0x124

	)

367 
	#BTN_PINKIE
 0x125

	)

368 
	#BTN_BASE
 0x126

	)

369 
	#BTN_BASE2
 0x127

	)

370 
	#BTN_BASE3
 0x128

	)

371 
	#BTN_BASE4
 0x129

	)

372 
	#BTN_BASE5
 0x12a

	)

373 
	#BTN_BASE6
 0x12b

	)

374 
	#BTN_DEAD
 0x12f

	)

376 
	#BTN_GAMEPAD
 0x130

	)

377 
	#BTN_A
 0x130

	)

378 
	#BTN_B
 0x131

	)

379 
	#BTN_C
 0x132

	)

380 
	#BTN_X
 0x133

	)

381 
	#BTN_Y
 0x134

	)

382 
	#BTN_Z
 0x135

	)

383 
	#BTN_TL
 0x136

	)

384 
	#BTN_TR
 0x137

	)

385 
	#BTN_TL2
 0x138

	)

386 
	#BTN_TR2
 0x139

	)

387 
	#BTN_SELECT
 0x13a

	)

388 
	#BTN_START
 0x13b

	)

389 
	#BTN_MODE
 0x13c

	)

390 
	#BTN_THUMBL
 0x13d

	)

391 
	#BTN_THUMBR
 0x13e

	)

393 
	#BTN_DIGI
 0x140

	)

394 
	#BTN_TOOL_PEN
 0x140

	)

395 
	#BTN_TOOL_RUBBER
 0x141

	)

396 
	#BTN_TOOL_BRUSH
 0x142

	)

397 
	#BTN_TOOL_PENCIL
 0x143

	)

398 
	#BTN_TOOL_AIRBRUSH
 0x144

	)

399 
	#BTN_TOOL_FINGER
 0x145

	)

400 
	#BTN_TOOL_MOUSE
 0x146

	)

401 
	#BTN_TOOL_LENS
 0x147

	)

402 
	#BTN_TOUCH
 0x14a

	)

403 
	#BTN_STYLUS
 0x14b

	)

404 
	#BTN_STYLUS2
 0x14c

	)

405 
	#BTN_TOOL_DOUBLETAP
 0x14d

	)

406 
	#BTN_TOOL_TRIPLETAP
 0x14e

	)

408 
	#BTN_WHEEL
 0x150

	)

409 
	#BTN_GEAR_DOWN
 0x150

	)

410 
	#BTN_GEAR_UP
 0x151

	)

412 
	#KEY_OK
 0x160

	)

413 
	#KEY_SELECT
 0x161

	)

414 
	#KEY_GOTO
 0x162

	)

415 
	#KEY_CLEAR
 0x163

	)

416 
	#KEY_POWER2
 0x164

	)

417 
	#KEY_OPTION
 0x165

	)

418 
	#KEY_INFO
 0x166

	)

419 
	#KEY_TIME
 0x167

	)

420 
	#KEY_VENDOR
 0x168

	)

421 
	#KEY_ARCHIVE
 0x169

	)

422 
	#KEY_PROGRAM
 0x16a

	)

423 
	#KEY_CHANNEL
 0x16b

	)

424 
	#KEY_FAVORITES
 0x16c

	)

425 
	#KEY_EPG
 0x16d

	)

426 
	#KEY_PVR
 0x16e

	)

427 
	#KEY_MHP
 0x16f

	)

428 
	#KEY_LANGUAGE
 0x170

	)

429 
	#KEY_TITLE
 0x171

	)

430 
	#KEY_SUBTITLE
 0x172

	)

431 
	#KEY_ANGLE
 0x173

	)

432 
	#KEY_ZOOM
 0x174

	)

433 
	#KEY_MODE
 0x175

	)

434 
	#KEY_KEYBOARD
 0x176

	)

435 
	#KEY_SCREEN
 0x177

	)

436 
	#KEY_PC
 0x178

	)

437 
	#KEY_TV
 0x179

	)

438 
	#KEY_TV2
 0x17a

	)

439 
	#KEY_VCR
 0x17b

	)

440 
	#KEY_VCR2
 0x17c

	)

441 
	#KEY_SAT
 0x17d

	)

442 
	#KEY_SAT2
 0x17e

	)

443 
	#KEY_CD
 0x17f

	)

444 
	#KEY_TAPE
 0x180

	)

445 
	#KEY_RADIO
 0x181

	)

446 
	#KEY_TUNER
 0x182

	)

447 
	#KEY_PLAYER
 0x183

	)

448 
	#KEY_TEXT
 0x184

	)

449 
	#KEY_DVD
 0x185

	)

450 
	#KEY_AUX
 0x186

	)

451 
	#KEY_MP3
 0x187

	)

452 
	#KEY_AUDIO
 0x188

	)

453 
	#KEY_VIDEO
 0x189

	)

454 
	#KEY_DIRECTORY
 0x18a

	)

455 
	#KEY_LIST
 0x18b

	)

456 
	#KEY_MEMO
 0x18c

	)

457 
	#KEY_CALENDAR
 0x18d

	)

458 
	#KEY_RED
 0x18e

	)

459 
	#KEY_GREEN
 0x18f

	)

460 
	#KEY_YELLOW
 0x190

	)

461 
	#KEY_BLUE
 0x191

	)

462 
	#KEY_CHANNELUP
 0x192

	)

463 
	#KEY_CHANNELDOWN
 0x193

	)

464 
	#KEY_FIRST
 0x194

	)

465 
	#KEY_LAST
 0x195

	)

466 
	#KEY_AB
 0x196

	)

467 
	#KEY_NEXT
 0x197

	)

468 
	#KEY_RESTART
 0x198

	)

469 
	#KEY_SLOW
 0x199

	)

470 
	#KEY_SHUFFLE
 0x19a

	)

471 
	#KEY_BREAK
 0x19b

	)

472 
	#KEY_PREVIOUS
 0x19c

	)

473 
	#KEY_DIGITS
 0x19d

	)

474 
	#KEY_TEEN
 0x19e

	)

475 
	#KEY_TWEN
 0x19f

	)

477 
	#KEY_DEL_EOL
 0x1c0

	)

478 
	#KEY_DEL_EOS
 0x1c1

	)

479 
	#KEY_INS_LINE
 0x1c2

	)

480 
	#KEY_DEL_LINE
 0x1c3

	)

482 
	#KEY_MAX
 0x1ff

	)

488 
	#REL_X
 0x00

	)

489 
	#REL_Y
 0x01

	)

490 
	#REL_Z
 0x02

	)

491 
	#REL_HWHEEL
 0x06

	)

492 
	#REL_DIAL
 0x07

	)

493 
	#REL_WHEEL
 0x08

	)

494 
	#REL_MISC
 0x09

	)

495 
	#REL_MAX
 0x0f

	)

501 
	#ABS_X
 0x00

	)

502 
	#ABS_Y
 0x01

	)

503 
	#ABS_Z
 0x02

	)

504 
	#ABS_RX
 0x03

	)

505 
	#ABS_RY
 0x04

	)

506 
	#ABS_RZ
 0x05

	)

507 
	#ABS_THROTTLE
 0x06

	)

508 
	#ABS_RUDDER
 0x07

	)

509 
	#ABS_WHEEL
 0x08

	)

510 
	#ABS_GAS
 0x09

	)

511 
	#ABS_BRAKE
 0x0a

	)

512 
	#ABS_HAT0X
 0x10

	)

513 
	#ABS_HAT0Y
 0x11

	)

514 
	#ABS_HAT1X
 0x12

	)

515 
	#ABS_HAT1Y
 0x13

	)

516 
	#ABS_HAT2X
 0x14

	)

517 
	#ABS_HAT2Y
 0x15

	)

518 
	#ABS_HAT3X
 0x16

	)

519 
	#ABS_HAT3Y
 0x17

	)

520 
	#ABS_PRESSURE
 0x18

	)

521 
	#ABS_DISTANCE
 0x19

	)

522 
	#ABS_TILT_X
 0x1a

	)

523 
	#ABS_TILT_Y
 0x1b

	)

524 
	#ABS_TOOL_WIDTH
 0x1c

	)

525 
	#ABS_VOLUME
 0x20

	)

526 
	#ABS_MISC
 0x28

	)

527 
	#ABS_MAX
 0x3f

	)

533 
	#MSC_SERIAL
 0x00

	)

534 
	#MSC_PULSELED
 0x01

	)

535 
	#MSC_GESTURE
 0x02

	)

536 
	#MSC_MAX
 0x07

	)

542 
	#LED_NUML
 0x00

	)

543 
	#LED_CAPSL
 0x01

	)

544 
	#LED_SCROLLL
 0x02

	)

545 
	#LED_COMPOSE
 0x03

	)

546 
	#LED_KANA
 0x04

	)

547 
	#LED_SLEEP
 0x05

	)

548 
	#LED_SUSPEND
 0x06

	)

549 
	#LED_MUTE
 0x07

	)

550 
	#LED_MISC
 0x08

	)

551 
	#LED_MAX
 0x0f

	)

557 
	#REP_DELAY
 0x00

	)

558 
	#REP_PERIOD
 0x01

	)

559 
	#REP_MAX
 0x01

	)

565 
	#SND_CLICK
 0x00

	)

566 
	#SND_BELL
 0x01

	)

567 
	#SND_TONE
 0x02

	)

568 
	#SND_MAX
 0x07

	)

574 
	#ID_BUS
 0

	)

575 
	#ID_VENDOR
 1

	)

576 
	#ID_PRODUCT
 2

	)

577 
	#ID_VERSION
 3

	)

579 
	#BUS_PCI
 0x01

	)

580 
	#BUS_ISAPNP
 0x02

	)

581 
	#BUS_USB
 0x03

	)

582 
	#BUS_HIL
 0x04

	)

584 
	#BUS_ISA
 0x10

	)

585 
	#BUS_I8042
 0x11

	)

586 
	#BUS_XTKBD
 0x12

	)

587 
	#BUS_RS232
 0x13

	)

588 
	#BUS_GAMEPORT
 0x14

	)

589 
	#BUS_PARPORT
 0x15

	)

590 
	#BUS_AMIGA
 0x16

	)

591 
	#BUS_ADB
 0x17

	)

592 
	#BUS_I2C
 0x18

	)

593 
	#BUS_HOST
 0x19

	)

598 
	#FF_STATUS_STOPPED
 0x00

	)

599 
	#FF_STATUS_PLAYING
 0x01

	)

600 
	#FF_STATUS_MAX
 0x01

	)

608 
	sff_ª∂ay
 {

609 
__u16
 
	mÀngth
;

610 
__u16
 
	mdñay
;

613 
	sff_åiggî
 {

614 
__u16
 
	mbuâ⁄
;

615 
__u16
 
	möãrvÆ
;

618 
	sff_ívñ›e
 {

619 
__u16
 
	m©èck_Àngth
;

620 
__u16
 
	m©èck_Àvñ
;

621 
__u16
 
	mÁde_Àngth
;

622 
__u16
 
	mÁde_Àvñ
;

626 
	sff_c⁄°™t_ef„˘
 {

627 
__s16
 
	mÀvñ
;

628 
ff_ívñ›e
 
	mívñ›e
;

632 
	sff_ømp_ef„˘
 {

633 
__s16
 
	m°¨t_Àvñ
;

634 
__s16
 
	míd_Àvñ
;

635 
ff_ívñ›e
 
	mívñ›e
;

639 
	sff_c⁄dôi⁄_ef„˘
 {

640 
__u16
 
	mright_ßtuøti⁄
;

641 
__u16
 
	mÀ·_ßtuøti⁄
;

643 
__s16
 
	mright_c€ff
;

645 
__s16
 
	mÀ·_c€ff
;

647 
__u16
 
	mdódb™d
;

648 
__s16
 
	m˚¡î
;

653 
	sff_≥riodic_ef„˘
 {

654 
__u16
 
	mwavef‹m
;

655 
__u16
 
	m≥riod
;

656 
__s16
 
	mmagnôude
;

657 
__s16
 
	moff£t
;

658 
__u16
 
	mpha£
;

660 
ff_ívñ›e
 
	mívñ›e
;

663 
__u32
 
	mcu°om_Àn
;

664 
__s16
 *
	mcu°om_d©a
;

674 
	sff_rumbÀ_ef„˘
 {

675 
__u16
 
	m°r⁄g_magnôude
;

676 
__u16
 
	mwók_magnôude
;

682 
	sff_ef„˘
 {

683 
__u16
 
	mty≥
;

688 
__s16
 
	mid
;

690 
__u16
 
	mdúe˘i⁄
;

696 
ff_åiggî
 
	måiggî
;

697 
ff_ª∂ay
 
	mª∂ay
;

700 
ff_c⁄°™t_ef„˘
 
	mc⁄°™t
;

701 
ff_ømp_ef„˘
 
	mømp
;

702 
ff_≥riodic_ef„˘
 
	m≥riodic
;

703 
ff_c⁄dôi⁄_ef„˘
 
	mc⁄dôi⁄
[2];

704 
ff_rumbÀ_ef„˘
 
	mrumbÀ
;

705 } 
	mu
;

712 
	#FF_RUMBLE
 0x50

	)

713 
	#FF_PERIODIC
 0x51

	)

714 
	#FF_CONSTANT
 0x52

	)

715 
	#FF_SPRING
 0x53

	)

716 
	#FF_FRICTION
 0x54

	)

717 
	#FF_DAMPER
 0x55

	)

718 
	#FF_INERTIA
 0x56

	)

719 
	#FF_RAMP
 0x57

	)

725 
	#FF_SQUARE
 0x58

	)

726 
	#FF_TRIANGLE
 0x59

	)

727 
	#FF_SINE
 0x5a

	)

728 
	#FF_SAW_UP
 0x5b

	)

729 
	#FF_SAW_DOWN
 0x5c

	)

730 
	#FF_CUSTOM
 0x5d

	)

736 
	#FF_GAIN
 0x60

	)

737 
	#FF_AUTOCENTER
 0x61

	)

739 
	#FF_MAX
 0x7f

	)

741 #ifde‡
__KERNEL__


747 
	~<löux/fs.h
>

748 
	~<löux/timî.h
>

750 
	#NBITS
(
x
Ë((((x)-1)/
BITS_PER_LONG
)+1)

	)

751 
	#BIT
(
x
Ë(1UL<<((x)%
BITS_PER_LONG
))

	)

752 
	#LONG
(
x
Ë((x)/
BITS_PER_LONG
)

	)

754 
	#INPUT_KEYCODE
(
dev
, 
sˇncode
Ë((dev->
keycodesize
 =1Ë? ((
u8
*)dev->
keycode
)[scancode] : \

755 ((
dev
->
keycodesize
 =2Ë? ((
u16
*)dev->
keycode
)[
sˇncode
] : (((
u32
*)dev->keycode)[sˇncode])))

	)

757 
	#öô_öput_dev
(
dev
Ëdÿ{ 
	`INIT_LIST_HEAD
(&((dev)->
h_li°
)); INIT_LIST_HEAD(&((dev)->
node
)); } 0)

	)

759 
	söput_dev
 {

761 *
	m¥iv©e
;

763 *
	m«me
;

764 *
	mphys
;

765 *
	muniq
;

766 
öput_id
 
	mid
;

768 
	mevbô
[
NBITS
(
EV_MAX
)];

769 
	mkeybô
[
NBITS
(
KEY_MAX
)];

770 
	mªlbô
[
NBITS
(
REL_MAX
)];

771 
	mabsbô
[
NBITS
(
ABS_MAX
)];

772 
	mmscbô
[
NBITS
(
MSC_MAX
)];

773 
	mÀdbô
[
NBITS
(
LED_MAX
)];

774 
	m¢dbô
[
NBITS
(
SND_MAX
)];

775 
	mffbô
[
NBITS
(
FF_MAX
)];

776 
	mff_ef„˘s_max
;

778 
	mkeycodemax
;

779 
	mkeycodesize
;

780 *
	mkeycode
;

782 
	mª≥©_key
;

783 
timî_li°
 
	mtimî
;

785 
pm_dev
 *
	mpm_dev
;

786 
±_ªgs
 *
	mªgs
;

787 
	m°©e
;

789 
	msync
;

791 
	mabs
[
ABS_MAX
 + 1];

792 
	mªp
[
REP_MAX
 + 1];

794 
	mkey
[
NBITS
(
KEY_MAX
)];

795 
	mÀd
[
NBITS
(
LED_MAX
)];

796 
	m¢d
[
NBITS
(
SND_MAX
)];

798 
	mabsmax
[
ABS_MAX
 + 1];

799 
	mabsmö
[
ABS_MAX
 + 1];

800 
	mabsfuzz
[
ABS_MAX
 + 1];

801 
	mabsÊ©
[
ABS_MAX
 + 1];

803 (*
	m›í
)(
öput_dev
 *
	mdev
);

804 (*
	m˛o£
)(
öput_dev
 *
	mdev
);

805 (*
	mac˚±
)(
öput_dev
 *
	mdev
, 
fûe
 *
	mfûe
);

806 (*
	mÊush
)(
öput_dev
 *
	mdev
, 
fûe
 *
	mfûe
);

807 (*
	mevít
)(
öput_dev
 *
	mdev
, 
	mty≥
, 
	mcode
, 
	mvÆue
);

808 (*
	mu∂ﬂd_ef„˘
)(
öput_dev
 *
	mdev
, 
ff_ef„˘
 *
	mef„˘
);

809 (*
	mîa£_ef„˘
)(
öput_dev
 *
	mdev
, 
	mef„˘_id
);

811 
öput_h™dÀ
 *
	mgøb
;

813 
li°_hód
 
	mh_li°
;

814 
li°_hód
 
	mnode
;

821 
	#INPUT_DEVICE_ID_MATCH_BUS
 1

	)

822 
	#INPUT_DEVICE_ID_MATCH_VENDOR
 2

	)

823 
	#INPUT_DEVICE_ID_MATCH_PRODUCT
 4

	)

824 
	#INPUT_DEVICE_ID_MATCH_VERSION
 8

	)

826 
	#INPUT_DEVICE_ID_MATCH_EVBIT
 0x010

	)

827 
	#INPUT_DEVICE_ID_MATCH_KEYBIT
 0x020

	)

828 
	#INPUT_DEVICE_ID_MATCH_RELBIT
 0x040

	)

829 
	#INPUT_DEVICE_ID_MATCH_ABSBIT
 0x080

	)

830 
	#INPUT_DEVICE_ID_MATCH_MSCIT
 0x100

	)

831 
	#INPUT_DEVICE_ID_MATCH_LEDBIT
 0x200

	)

832 
	#INPUT_DEVICE_ID_MATCH_SNDBIT
 0x400

	)

833 
	#INPUT_DEVICE_ID_MATCH_FFBIT
 0x800

	)

835 
	#INPUT_DEVICE_ID_MATCH_DEVICE
\

836 (
INPUT_DEVICE_ID_MATCH_BUS
 | 
INPUT_DEVICE_ID_MATCH_VENDOR
 | 
INPUT_DEVICE_ID_MATCH_PRODUCT
)

	)

837 
	#INPUT_DEVICE_ID_MATCH_DEVICE_AND_VERSION
\

838 (
INPUT_DEVICE_ID_MATCH_DEVICE
 | 
INPUT_DEVICE_ID_MATCH_VERSION
)

	)

840 
	söput_devi˚_id
 {

842 
	mÊags
;

844 
öput_id
 
	mid
;

846 
	mevbô
[
NBITS
(
EV_MAX
)];

847 
	mkeybô
[
NBITS
(
KEY_MAX
)];

848 
	mªlbô
[
NBITS
(
REL_MAX
)];

849 
	mabsbô
[
NBITS
(
ABS_MAX
)];

850 
	mmscbô
[
NBITS
(
MSC_MAX
)];

851 
	mÀdbô
[
NBITS
(
LED_MAX
)];

852 
	m¢dbô
[
NBITS
(
SND_MAX
)];

853 
	mffbô
[
NBITS
(
FF_MAX
)];

855 
	mdrivî_öfo
;

858 
	göput_h™dÀ
;

860 
	söput_h™dÀr
 {

862 *
	m¥iv©e
;

864 (*
	mevít
)(
öput_h™dÀ
 *
	mh™dÀ
, 
	mty≥
, 
	mcode
, 
	mvÆue
);

865 
	möput_h™dÀ
* (*
	mc⁄√˘
)(
öput_h™dÀr
 *
	mh™dÀr
, 
öput_dev
 *
	mdev
, 
öput_devi˚_id
 *
	mid
);

866 (*
	mdisc⁄√˘
)(
öput_h™dÀ
 *
	mh™dÀ
);

868 
fûe_›î©i⁄s
 *
	mf›s
;

869 
	mmö‹
;

870 *
	m«me
;

872 
öput_devi˚_id
 *
	mid_èbÀ
;

874 
li°_hód
 
	mh_li°
;

875 
li°_hód
 
	mnode
;

878 
	söput_h™dÀ
 {

880 *
	m¥iv©e
;

882 
	m›í
;

883 *
	m«me
;

885 
öput_dev
 *
	mdev
;

886 
öput_h™dÀr
 *
	mh™dÀr
;

888 
li°_hód
 
	md_node
;

889 
li°_hód
 
	mh_node
;

892 
	#to_dev
(
n
Ë
	`c⁄èöî_of
“,
öput_dev
,
node
)

	)

893 
	#to_h™dÀr
(
n
Ë
	`c⁄èöî_of
“,
öput_h™dÀr
,
node
);

	)

894 
	#to_h™dÀ
(
n
Ë
	`c⁄èöî_of
“,
öput_h™dÀ
,
d_node
)

	)

895 
	#to_h™dÀ_h
(
n
Ë
	`c⁄èöî_of
“,
öput_h™dÀ
,
h_node
)

	)

897 
öput_ªgi°î_devi˚
(
öput_dev
 *);

898 
öput_uƒegi°î_devi˚
(
öput_dev
 *);

900 
öput_ªgi°î_h™dÀr
(
öput_h™dÀr
 *);

901 
öput_uƒegi°î_h™dÀr
(
öput_h™dÀr
 *);

903 
öput_gøb_devi˚
(
öput_h™dÀ
 *);

904 
öput_ªÀa£_devi˚
(
öput_h™dÀ
 *);

906 
öput_›í_devi˚
(
öput_h™dÀ
 *);

907 
öput_˛o£_devi˚
(
öput_h™dÀ
 *);

909 
öput_ac˚±_¥o˚ss
(
öput_h™dÀ
 *
h™dÀ
, 
fûe
 *file);

910 
öput_Êush_devi˚
(
öput_h™dÀ
* 
h™dÀ
, 
fûe
* file);

912 
öput_evít
(
öput_dev
 *
dev
, 
ty≥
, 
code
, 
vÆue
);

914 
	#öput_ªp‹t_key
(
a
,
b
,
c
Ë
	`öput_evít
◊, 
EV_KEY
, b, !!(c))

	)

915 
	#öput_ªp‹t_ªl
(
a
,
b
,
c
Ë
	`öput_evít
◊, 
EV_REL
, b, c)

	)

916 
	#öput_ªp‹t_abs
(
a
,
b
,
c
Ë
	`öput_evít
◊, 
EV_ABS
, b, c)

	)

917 
	#öput_ªp‹t_ff
(
a
,
b
,
c
Ë
	`öput_evít
◊, 
EV_FF
, b, c)

	)

918 
	#öput_ªp‹t_ff_°©us
(
a
,
b
,
c
Ë
	`öput_evít
◊, 
EV_FF_STATUS
, b, c)

	)

920 
	#öput_ªgs
(
a
,
b
Ëdÿ{ (a)->
ªgs
 = (b); } 0)

	)

921 
	#öput_sync
(
a
Ëdÿ{ 
	`öput_evít
◊, 
EV_SYN
, 
SYN_REPORT
, 0); (a)->
ªgs
 = 
NULL
; } 0)

	)

923 
˛ass
 
öput_˛ass
;

	@/usr/include/linux/tty.h

1 #i‚de‡
_LINUX_TTY_H


2 
	#_LINUX_TTY_H


	)

12 
	#MIN_NR_CONSOLES
 1

	)

13 
	#MAX_NR_CONSOLES
 63

	)

14 
	#MAX_NR_USER_CONSOLES
 63

	)

18 #ifde‡
__KERNEL__


19 
	~<löux/c⁄fig.h
>

20 
	~<löux/fs.h
>

21 
	~<löux/maj‹.h
>

22 
	~<löux/ãrmios.h
>

23 
	~<löux/w‹kqueue.h
>

24 
	~<löux/ây_drivî.h
>

25 
	~<löux/ây_ldisc.h
>

27 
	~<asm/sy°em.h
>

36 
	#NR_PTYS
 256

	)

37 
	#NR_LDISCS
 16

	)

44 #ifde‡
CONFIG_UNIX98_PTYS


45 
	#UNIX98_NR_MAJORS
 ((
CONFIG_UNIX98_PTY_COUNT
+
NR_PTYS
-1)/NR_PTYS)

	)

46 #i‡
UNIX98_NR_MAJORS
 <= 0

47 #unde‡
CONFIG_UNIX98_PTYS


48 #ñi‡
UNIX98_NR_MAJORS
 > 
UNIX98_PTY_MAJOR_COUNT


49 #îr‹ 
Too
 
m™y
 
Unix98
 
±ys
 
deföed


50 #unde‡
UNIX98_NR_MAJORS


51 
	#UNIX98_NR_MAJORS
 
UNIX98_PTY_MAJOR_COUNT


	)

59 
	ss¸ìn_öfo
 {

60 
u8
 
	m‹ig_x
;

61 
u8
 
	m‹ig_y
;

62 
u16
 
	md⁄tu£1
;

63 
u16
 
	m‹ig_video_∑ge
;

64 
u8
 
	m‹ig_video_mode
;

65 
u8
 
	m‹ig_video_cﬁs
;

66 
u16
 
	munu£d2
;

67 
u16
 
	m‹ig_video_ega_bx
;

68 
u16
 
	munu£d3
;

69 
u8
 
	m‹ig_video_löes
;

70 
u8
 
	m‹ig_video_isVGA
;

71 
u16
 
	m‹ig_video_poöts
;

74 
u16
 
	mlfb_width
;

75 
u16
 
	mlfb_height
;

76 
u16
 
	mlfb_dïth
;

77 
u32
 
	mlfb_ba£
;

78 
u32
 
	mlfb_size
;

79 
u16
 
	md⁄tu£2
, 
	md⁄tu£3
;

80 
u16
 
	mlfb_löñígth
;

81 
u8
 
	mªd_size
;

82 
u8
 
	mªd_pos
;

83 
u8
 
	mgªí_size
;

84 
u8
 
	mgªí_pos
;

85 
u8
 
	mblue_size
;

86 
u8
 
	mblue_pos
;

87 
u8
 
	mrsvd_size
;

88 
u8
 
	mrsvd_pos
;

89 
u16
 
	mveßpm_£g
;

90 
u16
 
	mveßpm_off
;

91 
u16
 
	m∑ges
;

92 
u16
 
	mveß_©åibuãs
;

96 
s¸ìn_öfo
 screen_info;

98 
	#ORIG_X
 (
s¸ìn_öfo
.
‹ig_x
)

	)

99 
	#ORIG_Y
 (
s¸ìn_öfo
.
‹ig_y
)

	)

100 
	#ORIG_VIDEO_MODE
 (
s¸ìn_öfo
.
‹ig_video_mode
)

	)

101 
	#ORIG_VIDEO_COLS
 (
s¸ìn_öfo
.
‹ig_video_cﬁs
)

	)

102 
	#ORIG_VIDEO_EGA_BX
 (
s¸ìn_öfo
.
‹ig_video_ega_bx
)

	)

103 
	#ORIG_VIDEO_LINES
 (
s¸ìn_öfo
.
‹ig_video_löes
)

	)

104 
	#ORIG_VIDEO_ISVGA
 (
s¸ìn_öfo
.
‹ig_video_isVGA
)

	)

105 
	#ORIG_VIDEO_POINTS
 (
s¸ìn_öfo
.
‹ig_video_poöts
)

	)

107 
	#VIDEO_TYPE_MDA
 0x10

	)

108 
	#VIDEO_TYPE_CGA
 0x11

	)

109 
	#VIDEO_TYPE_EGAM
 0x20

	)

110 
	#VIDEO_TYPE_EGAC
 0x21

	)

111 
	#VIDEO_TYPE_VGAC
 0x22

	)

112 
	#VIDEO_TYPE_VLFB
 0x23

	)

114 
	#VIDEO_TYPE_PICA_S3
 0x30

	)

115 
	#VIDEO_TYPE_MIPS_G364
 0x31

	)

116 
	#VIDEO_TYPE_SNI_RM
 0x32

	)

117 
	#VIDEO_TYPE_SGI
 0x33

	)

119 
	#VIDEO_TYPE_TGAC
 0x40

	)

121 
	#VIDEO_TYPE_SUN
 0x50

	)

122 
	#VIDEO_TYPE_SUNPCI
 0x51

	)

124 
	#VIDEO_TYPE_PMAC
 0x60

	)

131 
	#__DISABLED_CHAR
 '\0'

	)

138 
	#TTY_FLIPBUF_SIZE
 512

	)

140 
	sây_Êù_buf„r
 {

141 
w‹k_°ru˘
 
	mw‹k
;

142 
£m≠h‹e
 
	m±y_£m
;

143 *
	mch¨_buf_±r
;

144 *
	mÊag_buf_±r
;

145 
	mcou¡
;

146 
	mbuf_num
;

147 
	mch¨_buf
[2*
TTY_FLIPBUF_SIZE
];

148 
	mÊag_buf
[2*
TTY_FLIPBUF_SIZE
];

149 
	m¶›
[4];

154 
	#PTY_BUF_SIZE
 4*
TTY_FLIPBUF_SIZE


	)

160 
	#TTY_NORMAL
 0

	)

161 
	#TTY_BREAK
 1

	)

162 
	#TTY_FRAME
 2

	)

163 
	#TTY_PARITY
 3

	)

164 
	#TTY_OVERRUN
 4

	)

166 
	#INTR_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VINTR
])

	)

167 
	#QUIT_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VQUIT
])

	)

168 
	#ERASE_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VERASE
])

	)

169 
	#KILL_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VKILL
])

	)

170 
	#EOF_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VEOF
])

	)

171 
	#TIME_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VTIME
])

	)

172 
	#MIN_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VMIN
])

	)

173 
	#SWTC_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VSWTC
])

	)

174 
	#START_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VSTART
])

	)

175 
	#STOP_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VSTOP
])

	)

176 
	#SUSP_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VSUSP
])

	)

177 
	#EOL_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VEOL
])

	)

178 
	#REPRINT_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VREPRINT
])

	)

179 
	#DISCARD_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VDISCARD
])

	)

180 
	#WERASE_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VWERASE
])

	)

181 
	#LNEXT_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VLNEXT
])

	)

182 
	#EOL2_CHAR
(
ây
Ë(—ty)->
ãrmios
->
c_cc
[
VEOL2
])

	)

184 
	#_I_FLAG
(
ây
,
f
Ë(—ty)->
ãrmios
->
c_iÊag
 & (f))

	)

185 
	#_O_FLAG
(
ây
,
f
Ë(—ty)->
ãrmios
->
c_oÊag
 & (f))

	)

186 
	#_C_FLAG
(
ây
,
f
Ë(—ty)->
ãrmios
->
c_cÊag
 & (f))

	)

187 
	#_L_FLAG
(
ây
,
f
Ë(—ty)->
ãrmios
->
c_lÊag
 & (f))

	)

189 
	#I_IGNBRK
(
ây
Ë
	`_I_FLAG
(—ty),
IGNBRK
)

	)

190 
	#I_BRKINT
(
ây
Ë
	`_I_FLAG
(—ty),
BRKINT
)

	)

191 
	#I_IGNPAR
(
ây
Ë
	`_I_FLAG
(—ty),
IGNPAR
)

	)

192 
	#I_PARMRK
(
ây
Ë
	`_I_FLAG
(—ty),
PARMRK
)

	)

193 
	#I_INPCK
(
ây
Ë
	`_I_FLAG
(—ty),
INPCK
)

	)

194 
	#I_ISTRIP
(
ây
Ë
	`_I_FLAG
(—ty),
ISTRIP
)

	)

195 
	#I_INLCR
(
ây
Ë
	`_I_FLAG
(—ty),
INLCR
)

	)

196 
	#I_IGNCR
(
ây
Ë
	`_I_FLAG
(—ty),
IGNCR
)

	)

197 
	#I_ICRNL
(
ây
Ë
	`_I_FLAG
(—ty),
ICRNL
)

	)

198 
	#I_IUCLC
(
ây
Ë
	`_I_FLAG
(—ty),
IUCLC
)

	)

199 
	#I_IXON
(
ây
Ë
	`_I_FLAG
(—ty),
IXON
)

	)

200 
	#I_IXANY
(
ây
Ë
	`_I_FLAG
(—ty),
IXANY
)

	)

201 
	#I_IXOFF
(
ây
Ë
	`_I_FLAG
(—ty),
IXOFF
)

	)

202 
	#I_IMAXBEL
(
ây
Ë
	`_I_FLAG
(—ty),
IMAXBEL
)

	)

204 
	#O_OPOST
(
ây
Ë
	`_O_FLAG
(—ty),
OPOST
)

	)

205 
	#O_OLCUC
(
ây
Ë
	`_O_FLAG
(—ty),
OLCUC
)

	)

206 
	#O_ONLCR
(
ây
Ë
	`_O_FLAG
(—ty),
ONLCR
)

	)

207 
	#O_OCRNL
(
ây
Ë
	`_O_FLAG
(—ty),
OCRNL
)

	)

208 
	#O_ONOCR
(
ây
Ë
	`_O_FLAG
(—ty),
ONOCR
)

	)

209 
	#O_ONLRET
(
ây
Ë
	`_O_FLAG
(—ty),
ONLRET
)

	)

210 
	#O_OFILL
(
ây
Ë
	`_O_FLAG
(—ty),
OFILL
)

	)

211 
	#O_OFDEL
(
ây
Ë
	`_O_FLAG
(—ty),
OFDEL
)

	)

212 
	#O_NLDLY
(
ây
Ë
	`_O_FLAG
(—ty),
NLDLY
)

	)

213 
	#O_CRDLY
(
ây
Ë
	`_O_FLAG
(—ty),
CRDLY
)

	)

214 
	#O_TABDLY
(
ây
Ë
	`_O_FLAG
(—ty),
TABDLY
)

	)

215 
	#O_BSDLY
(
ây
Ë
	`_O_FLAG
(—ty),
BSDLY
)

	)

216 
	#O_VTDLY
(
ây
Ë
	`_O_FLAG
(—ty),
VTDLY
)

	)

217 
	#O_FFDLY
(
ây
Ë
	`_O_FLAG
(—ty),
FFDLY
)

	)

219 
	#C_BAUD
(
ây
Ë
	`_C_FLAG
(—ty),
CBAUD
)

	)

220 
	#C_CSIZE
(
ây
Ë
	`_C_FLAG
(—ty),
CSIZE
)

	)

221 
	#C_CSTOPB
(
ây
Ë
	`_C_FLAG
(—ty),
CSTOPB
)

	)

222 
	#C_CREAD
(
ây
Ë
	`_C_FLAG
(—ty),
CREAD
)

	)

223 
	#C_PARENB
(
ây
Ë
	`_C_FLAG
(—ty),
PARENB
)

	)

224 
	#C_PARODD
(
ây
Ë
	`_C_FLAG
(—ty),
PARODD
)

	)

225 
	#C_HUPCL
(
ây
Ë
	`_C_FLAG
(—ty),
HUPCL
)

	)

226 
	#C_CLOCAL
(
ây
Ë
	`_C_FLAG
(—ty),
CLOCAL
)

	)

227 
	#C_CIBAUD
(
ây
Ë
	`_C_FLAG
(—ty),
CIBAUD
)

	)

228 
	#C_CRTSCTS
(
ây
Ë
	`_C_FLAG
(—ty),
CRTSCTS
)

	)

230 
	#L_ISIG
(
ây
Ë
	`_L_FLAG
(—ty),
ISIG
)

	)

231 
	#L_ICANON
(
ây
Ë
	`_L_FLAG
(—ty),
ICANON
)

	)

232 
	#L_XCASE
(
ây
Ë
	`_L_FLAG
(—ty),
XCASE
)

	)

233 
	#L_ECHO
(
ây
Ë
	`_L_FLAG
(—ty),
ECHO
)

	)

234 
	#L_ECHOE
(
ây
Ë
	`_L_FLAG
(—ty),
ECHOE
)

	)

235 
	#L_ECHOK
(
ây
Ë
	`_L_FLAG
(—ty),
ECHOK
)

	)

236 
	#L_ECHONL
(
ây
Ë
	`_L_FLAG
(—ty),
ECHONL
)

	)

237 
	#L_NOFLSH
(
ây
Ë
	`_L_FLAG
(—ty),
NOFLSH
)

	)

238 
	#L_TOSTOP
(
ây
Ë
	`_L_FLAG
(—ty),
TOSTOP
)

	)

239 
	#L_ECHOCTL
(
ây
Ë
	`_L_FLAG
(—ty),
ECHOCTL
)

	)

240 
	#L_ECHOPRT
(
ây
Ë
	`_L_FLAG
(—ty),
ECHOPRT
)

	)

241 
	#L_ECHOKE
(
ây
Ë
	`_L_FLAG
(—ty),
ECHOKE
)

	)

242 
	#L_FLUSHO
(
ây
Ë
	`_L_FLAG
(—ty),
FLUSHO
)

	)

243 
	#L_PENDIN
(
ây
Ë
	`_L_FLAG
(—ty),
PENDIN
)

	)

244 
	#L_IEXTEN
(
ây
Ë
	`_L_FLAG
(—ty),
IEXTEN
)

	)

246 
	gdevi˚
;

258 
	sây_°ru˘
 {

259 
	mmagic
;

260 
ây_drivî
 *
	mdrivî
;

261 
	mödex
;

262 
ây_ldisc
 
	mldisc
;

263 
ãrmios
 *
	mãrmios
, *
	mãrmios_locked
;

264 
	m«me
[64];

265 
	mpgΩ
;

266 
	m£ssi⁄
;

267 
	mÊags
;

268 
	mcou¡
;

269 
wösize
 
	mwösize
;

270 
	m°›≥d
:1, 
	mhw_°›≥d
:1, 
	mÊow_°›≥d
:1, 
	m∑ckë
:1;

271 
	mlow_œãncy
:1, 
	mw¨√d
:1;

272 
	m˘æ_°©us
;

274 
ây_°ru˘
 *
	mlök
;

275 
Ásync_°ru˘
 *
	mÁsync
;

276 
ây_Êù_buf„r
 
	mÊù
;

277 
	mmax_Êù_˙t
;

278 
	mÆt_•ìd
;

279 
waô_queue_hód_t
 
	mwrôe_waô
;

280 
waô_queue_hód_t
 
	mªad_waô
;

281 
w‹k_°ru˘
 
	mh™gup_w‹k
;

282 *
	mdisc_d©a
;

283 *
	mdrivî_d©a
;

284 
li°_hód
 
	mây_fûes
;

286 
	#N_TTY_BUF_SIZE
 4096

	)

292 
	mcﬁumn
;

293 
	m ext
:1, 
	mîasög
:1, 
	møw
:1, 
	mªÆ_øw
:1, 
	miˇn⁄
:1;

294 
	m˛osög
:1;

295 
	mmöimum_to_wake
;

296 
	movîrun_time
;

297 
	mnum_ovîrun
;

298 
	m¥o˚ss_ch¨_m≠
[256/(8*())];

299 *
	mªad_buf
;

300 
	mªad_hód
;

301 
	mªad_èû
;

302 
	mªad_˙t
;

303 
	mªad_Êags
[
N_TTY_BUF_SIZE
/(8*())];

304 
	mˇn⁄_d©a
;

305 
	mˇn⁄_hód
;

306 
	mˇn⁄_cﬁumn
;

307 
£m≠h‹e
 
	m©omic_ªad
;

308 
£m≠h‹e
 
	m©omic_wrôe
;

309 
•ölock_t
 
	mªad_lock
;

311 
w‹k_°ru˘
 
	mSAK_w‹k
;

315 
	#TTY_MAGIC
 0x5401

	)

325 
	#TTY_THROTTLED
 0

	)

326 
	#TTY_IO_ERROR
 1

	)

327 
	#TTY_OTHER_CLOSED
 2

	)

328 
	#TTY_EXCLUSIVE
 3

	)

329 
	#TTY_DEBUG
 4

	)

330 
	#TTY_DO_WRITE_WAKEUP
 5

	)

331 
	#TTY_PUSH
 6

	)

332 
	#TTY_CLOSING
 7

	)

333 
	#TTY_DONT_FLIP
 8

	)

334 
	#TTY_HW_COOK_OUT
 14

	)

335 
	#TTY_HW_COOK_IN
 15

	)

336 
	#TTY_PTY_LOCK
 16

	)

337 
	#TTY_NO_WRITE_SPLIT
 17

	)

339 
	#TTY_WRITE_FLUSH
(
ây
Ë
	`ây_wrôe_Êush
(—ty))

	)

341 
ây_wrôe_Êush
(
ây_°ru˘
 *);

343 
ãrmios
 
ây_°d_ãrmios
;

344 
ây_ldisc
 
ldiscs
[];

345 
fg_c⁄sﬁe
, 
œ°_c⁄sﬁe
, 
w™t_c⁄sﬁe
;

347 
kmsg_ªdúe˘
;

349 
c⁄sﬁe_öô
();

350 
vcs_öô
();

352 
ây_∑ønoü_check
(
ây_°ru˘
 *
ây
, 
öode
 *inode,

353 c⁄° *
routöe
);

354 *
ây_«me
(
ây_°ru˘
 *
ây
, *
buf
);

355 
ây_waô_u¡û_£¡
(
ây_°ru˘
 * 
ây
, 
timeout
);

356 
ây_check_ch™ge
(
ây_°ru˘
 * 
ây
);

357 
°›_ây
(
ây_°ru˘
 * 
ây
);

358 
°¨t_ây
(
ây_°ru˘
 * 
ây
);

359 
ây_ªgi°î_ldisc
(
disc
, 
ây_ldisc
 *
√w_ldisc
);

360 
ây_ªgi°î_drivî
(
ây_drivî
 *
drivî
);

361 
ây_uƒegi°î_drivî
(
ây_drivî
 *
drivî
);

362 
ây_ªgi°î_devi˚
(
ây_drivî
 *
drivî
, 
ödex
, 
devi˚
 *
dev
);

363 
ây_uƒegi°î_devi˚
(
ây_drivî
 *
drivî
, 
ödex
);

364 
ây_ªad_øw_d©a
(
ây_°ru˘
 *
ây
, *
buÂ
,

365 
buÊí
);

366 
ây_wrôe_mesßge
(
ây_°ru˘
 *
ây
, *
msg
);

368 
is_‹ph™ed_pgΩ
(
pgΩ
);

369 
is_ign‹ed
(
sig
);

370 
ây_sig«l
(
sig
, 
ây_°ru˘
 *
ây
);

371 
ây_h™gup
(
ây_°ru˘
 * 
ây
);

372 
ây_vh™gup
(
ây_°ru˘
 * 
ây
);

373 
ây_unh™gup
(
fûe
 *
fûp
);

374 
ây_hung_up_p
(
fûe
 * 
fûp
);

375 
do_SAK
(
ây_°ru˘
 *
ây
);

376 
dißssocüã_˘ty
(
¥iv
);

377 
ây_Êù_buf„r_push
(
ây_°ru˘
 *
ây
);

378 
ây_gë_baud_øã
(
ây_°ru˘
 *
ây
);

379 
ây_ãrmios_baud_øã
(
ãrmios
 *termios);

382 
ây_ldisc
 
ây_ldisc_N_TTY
;

385 
n_ây_io˘l
(
ây_°ru˘
 * 
ây
, 
fûe
 * file,

386 
cmd
, 
¨g
);

390 
£rül_c⁄sﬁe_öô
();

394 
pcxe_›í
(
ây_°ru˘
 *
ây
, 
fûe
 *
fûp
);

398 
c⁄sﬁe_¥öt
(const *);

402 
vt_io˘l
(
ây_°ru˘
 *
ây
, 
fûe
 * file,

403 
cmd
, 
¨g
);

405 
ölöe
 
dev_t
 
	$ây_devnum
(
ây_°ru˘
 *
ây
)

407  
	`MKDEV
(
ây
->
drivî
->
maj‹
,Åty->drivî->
mö‹_°¨t
Ë+Åty->
ödex
;

408 
	}
}

	@/usr/include/linux/types.h

1 #i‚de‡
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

5 #i‚de‡
__KERNEL__


6 
	~<sys/ty≥s.h
>

8 
	~<löux/posix_ty≥s.h
>

9 
	~<asm/ty≥s.h
>

11 
__u32
 
	t__kî√l_dev_t
;

14 #ifdef 
__KERNEL__


15 
	~<löux/c⁄fig.h
>

17 
	#BITS_TO_LONGS
(
bôs
) \

18 (((
bôs
)+
BITS_PER_LONG
-1)/BITS_PER_LONG)

	)

19 
	#DECLARE_BITMAP
(
«me
,
bôs
) \

20 
«me
[
	`BITS_TO_LONGS
(
bôs
)]

	)

21 
	#CLEAR_BITMAP
(
«me
,
bôs
) \

22 
	`mem£t
(
«me
, 0, 
	`BITS_TO_LONGS
(
bôs
)*())

	)

25 
	~<löux/posix_ty≥s.h
>

26 
	~<asm/ty≥s.h
>

28 #i‚de‡
__KERNEL_STRICT_NAMES


30 
__u32
 
	t__kî√l_dev_t
;

32 
__kî√l_fd_£t
 
	tfd_£t
;

33 
__kî√l_dev_t
 
	tdev_t
;

34 
__kî√l_öo_t
 
	töo_t
;

35 
__kî√l_mode_t
 
	tmode_t
;

36 
__kî√l_∆ök_t
 
	t∆ök_t
;

37 
__kî√l_off_t
 
	toff_t
;

38 
__kî√l_pid_t
 
	tpid_t
;

39 
__kî√l_daddr_t
 
	tdaddr_t
;

40 
__kî√l_key_t
 
	tkey_t
;

41 
__kî√l_su£c⁄ds_t
 
	tsu£c⁄ds_t
;

42 
__kî√l_timî_t
 
	ttimî_t
;

43 
__kî√l_˛ockid_t
 
	t˛ockid_t
;

45 #ifde‡
__KERNEL__


46 
__kî√l_uid32_t
 
	tuid_t
;

47 
__kî√l_gid32_t
 
	tgid_t
;

48 
__kî√l_uid16_t
 
	tuid16_t
;

49 
__kî√l_gid16_t
 
	tgid16_t
;

51 #ifde‡
CONFIG_UID16


53 
__kî√l_ﬁd_uid_t
 
	tﬁd_uid_t
;

54 
__kî√l_ﬁd_gid_t
 
	tﬁd_gid_t
;

61 
__kî√l_uid_t
 
	tuid_t
;

62 
__kî√l_gid_t
 
	tgid_t
;

65 #i‡
deföed
(
__GNUC__
Ë&& !deföed(
__STRICT_ANSI__
)

66 
__kî√l_loff_t
 
	tloff_t
;

73 #i‚de‡
_SIZE_T


74 
	#_SIZE_T


	)

75 
__kî√l_size_t
 
	tsize_t
;

78 #i‚de‡
_SSIZE_T


79 
	#_SSIZE_T


	)

80 
__kî√l_ssize_t
 
	tssize_t
;

83 #i‚de‡
_PTRDIFF_T


84 
	#_PTRDIFF_T


	)

85 
__kî√l_±rdiff_t
 
	t±rdiff_t
;

88 #i‚de‡
_TIME_T


89 
	#_TIME_T


	)

90 
__kî√l_time_t
 
	ttime_t
;

93 #i‚de‡
_CLOCK_T


94 
	#_CLOCK_T


	)

95 
__kî√l_˛ock_t
 
	t˛ock_t
;

98 #i‚de‡
_CADDR_T


99 
	#_CADDR_T


	)

100 
__kî√l_ˇddr_t
 
	tˇddr_t
;

104 
	tu_ch¨
;

105 
	tu_sh‹t
;

106 
	tu_öt
;

107 
	tu_l⁄g
;

110 
	tunch¨
;

111 
	tush‹t
;

112 
	tuöt
;

113 
	tul⁄g
;

115 #i‚de‡
__BIT_TYPES_DEFINED__


116 
	#__BIT_TYPES_DEFINED__


	)

118 
__u8
 
	tu_öt8_t
;

119 
__s8
 
	töt8_t
;

120 
__u16
 
	tu_öt16_t
;

121 
__s16
 
	töt16_t
;

122 
__u32
 
	tu_öt32_t
;

123 
__s32
 
	töt32_t
;

127 
__u8
 
	tuöt8_t
;

128 
__u16
 
	tuöt16_t
;

129 
__u32
 
	tuöt32_t
;

131 #i‡
deföed
(
__GNUC__
Ë&& !deföed(
__STRICT_ANSI__
)

132 
__u64
 
	tuöt64_t
;

133 
__u64
 
	tu_öt64_t
;

134 
__s64
 
	töt64_t
;

142 #i‚de‡
HAVE_SECTOR_T


143 
	t£˘‹_t
;

150 #i‚de‡
pgoff_t


151 
	#pgoff_t
 

	)

163 
	su°©
 {

164 
__kî√l_daddr_t
 
	mf_t‰ì
;

165 
__kî√l_öo_t
 
	mf_töode
;

166 
	mf_‚ame
[6];

167 
	mf_Âack
[6];

	@/usr/include/linux/vmalloc.h

1 #i‚de‡
_LINUX_VMALLOC_H


2 
	#_LINUX_VMALLOC_H


	)

4 
	~<löux/•ölock.h
>

5 
	~<asm/∑ge.h
>

8 
	#VM_IOREMAP
 0x00000001

	)

9 
	#VM_ALLOC
 0x00000002

	)

10 
	#VM_MAP
 0x00000004

	)

12 
	svm_°ru˘
 {

13 *
	maddr
;

14 
	msize
;

15 
	mÊags
;

16 
∑ge
 **
	m∑ges
;

17 
	mƒ_∑ges
;

18 
	mphys_addr
;

19 
vm_°ru˘
 *
	m√xt
;

25 *
vmÆloc
(
size
);

26 *
vmÆloc_32
(
size
);

27 *
__vmÆloc
(
size
, 
gÂ_mask
, 
pg¥Ÿ_t
 
¥Ÿ
);

28 
v‰ì
(*
addr
);

30 *
vm≠
(
∑ge
 **
∑ges
, 
cou¡
,

31 
Êags
, 
pg¥Ÿ_t
 
¥Ÿ
);

32 
vunm≠
(*
addr
);

37 
vm_°ru˘
 *
gë_vm_¨ó
(
size
, 
Êags
);

38 
vm_°ru˘
 *
ªmove_vm_¨ó
(*
addr
);

39 
m≠_vm_¨ó
(
vm_°ru˘
 *
¨ó
, 
pg¥Ÿ_t
 
¥Ÿ
,

40 
∑ge
 ***
∑ges
);

41 
unm≠_vm_¨ó
(
vm_°ru˘
 *
¨ó
);

46 
rwlock_t
 
vmli°_lock
;

47 
vm_°ru˘
 *
vmli°
;

	@/usr/include/linux/wait.h

1 #i‚de‡
_LINUX_WAIT_H


2 
	#_LINUX_WAIT_H


	)

4 
	#WNOHANG
 0x00000001

	)

5 
	#WUNTRACED
 0x00000002

	)

7 
	#__WNOTHREAD
 0x20000000

	)

8 
	#__WALL
 0x40000000

	)

9 
	#__WCLONE
 0x80000000

	)

11 #ifde‡
__KERNEL__


13 
	~<löux/c⁄fig.h
>

14 
	~<löux/li°.h
>

15 
	~<löux/°ddef.h
>

16 
	~<löux/•ölock.h
>

17 
	~<asm/sy°em.h
>

19 
__waô_queue
 
	twaô_queue_t
;

20 (*
	twaô_queue_func_t
)(
	twaô_queue_t
 *
	twaô
, 
	tmode
, 
	tsync
);

21 
	`deÁu…_wake_fun˘i⁄
(
waô_queue_t
 *
waô
, 
mode
, 
sync
);

23 
	s__waô_queue
 {

24 
Êags
;

25 
	#WQ_FLAG_EXCLUSIVE
 0x01

	)

26 
èsk_°ru˘
 * 
èsk
;

27 
waô_queue_func_t
 
func
;

28 
li°_hód
 
èsk_li°
;

31 
	s__waô_queue_hód
 {

32 
•ölock_t
 
lock
;

33 
li°_hód
 
èsk_li°
;

35 
__waô_queue_hód
 
	twaô_queue_hód_t
;

42 
	#__WAITQUEUE_INITIALIZER
(
«me
, 
tsk
) { \

43 .
èsk
 = 
tsk
, \

44 .
func
 = 
deÁu…_wake_fun˘i⁄
, \

45 .
èsk_li°
 = { 
NULL
, NULL } 
	}

	)
}

47 
	#DECLARE_WAITQUEUE
(
«me
, 
tsk
) \

48 
waô_queue_t
 
«me
 = 
	`__WAITQUEUE_INITIALIZER
“ame, 
tsk
)

	)

50 
	#__WAIT_QUEUE_HEAD_INITIALIZER
(
«me
) { \

51 .
lock
 = 
SPIN_LOCK_UNLOCKED
, \

52 .
èsk_li°
 = { &(
«me
).èsk_li°, &“ame).èsk_li° } }

	)

54 
	#DECLARE_WAIT_QUEUE_HEAD
(
«me
) \

55 
waô_queue_hód_t
 
«me
 = 
	`__WAIT_QUEUE_HEAD_INITIALIZER
“ame)

	)

57 
ölöe
 
	$öô_waôqueue_hód
(
waô_queue_hód_t
 *
q
)

59 
q
->
lock
 = 
SPIN_LOCK_UNLOCKED
;

60 
	`INIT_LIST_HEAD
(&
q
->
èsk_li°
);

61 
	}
}

63 
ölöe
 
	$öô_waôqueue_íåy
(
waô_queue_t
 *
q
, 
èsk_°ru˘
 *
p
)

65 
q
->
Êags
 = 0;

66 
q
->
èsk
 = 
p
;

67 
q
->
func
 = 
deÁu…_wake_fun˘i⁄
;

68 
	}
}

70 
ölöe
 
	$öô_waôqueue_func_íåy
(
waô_queue_t
 *
q
,

71 
waô_queue_func_t
 
func
)

73 
q
->
Êags
 = 0;

74 
q
->
èsk
 = 
NULL
;

75 
q
->
func
 = func;

76 
	}
}

78 
ölöe
 
	$waôqueue_a˘ive
(
waô_queue_hód_t
 *
q
)

80  !
	`li°_em±y
(&
q
->
èsk_li°
);

81 
	}
}

83 
FASTCALL
(
add_waô_queue
(
waô_queue_hód_t
 *
q
, 
waô_queue_t
 * 
waô
));

84 
FASTCALL
(
add_waô_queue_ex˛usive
(
waô_queue_hód_t
 *
q
, 
waô_queue_t
 * 
waô
));

85 
FASTCALL
(
ªmove_waô_queue
(
waô_queue_hód_t
 *
q
, 
waô_queue_t
 * 
waô
));

87 
ölöe
 
	$__add_waô_queue
(
waô_queue_hód_t
 *
hód
, 
waô_queue_t
 *
√w
)

89 
	`li°_add
(&
√w
->
èsk_li°
, &
hód
->task_list);

90 
	}
}

95 
ölöe
 
	$__add_waô_queue_èû
(
waô_queue_hód_t
 *
hód
,

96 
waô_queue_t
 *
√w
)

98 
	`li°_add_èû
(&
√w
->
èsk_li°
, &
hód
->task_list);

99 
	}
}

101 
ölöe
 
	$__ªmove_waô_queue
(
waô_queue_hód_t
 *
hód
,

102 
waô_queue_t
 *
ﬁd
)

104 
	`li°_dñ
(&
ﬁd
->
èsk_li°
);

105 
	}
}

107 
FASTCALL
(
__wake_up
(
waô_queue_hód_t
 *
q
, 
mode
, 
ƒ
));

108 
FASTCALL
(
__wake_up_locked
(
waô_queue_hód_t
 *
q
, 
mode
));

109 
FASTCALL
(
__wake_up_sync
(
waô_queue_hód_t
 *
q
, 
mode
, 
ƒ
));

111 
	#wake_up
(
x
Ë
	`__wake_up
((x),
TASK_UNINTERRUPTIBLE
 | 
TASK_INTERRUPTIBLE
, 1)

	)

112 
	#wake_up_ƒ
(
x
, 
ƒ
Ë
	`__wake_up
((x),
TASK_UNINTERRUPTIBLE
 | 
TASK_INTERRUPTIBLE
,Çr)

	)

113 
	#wake_up_Æl
(
x
Ë
	`__wake_up
((x),
TASK_UNINTERRUPTIBLE
 | 
TASK_INTERRUPTIBLE
, 0)

	)

114 
	#wake_up_Æl_sync
(
x
Ë
	`__wake_up_sync
((x),
TASK_UNINTERRUPTIBLE
 | 
TASK_INTERRUPTIBLE
, 0)

	)

115 
	#wake_up_öãºu±ibÀ
(
x
Ë
	`__wake_up
((x),
TASK_INTERRUPTIBLE
, 1)

	)

116 
	#wake_up_öãºu±ibÀ_ƒ
(
x
, 
ƒ
Ë
	`__wake_up
((x),
TASK_INTERRUPTIBLE
,Çr)

	)

117 
	#wake_up_öãºu±ibÀ_Æl
(
x
Ë
	`__wake_up
((x),
TASK_INTERRUPTIBLE
, 0)

	)

118 
	#wake_up_locked
(
x
Ë
	`__wake_up_locked
((x), 
TASK_UNINTERRUPTIBLE
 | 
TASK_INTERRUPTIBLE
)

	)

119 
	#wake_up_öãºu±ibÀ_sync
(
x
Ë
	`__wake_up_sync
((x),
TASK_INTERRUPTIBLE
, 1)

	)

121 
	#__waô_evít
(
wq
, 
c⁄dôi⁄
) \

123 
waô_queue_t
 
__waô
; \

124 
	`öô_waôqueue_íåy
(&
__waô
, 
cuºít
); \

126 
	`add_waô_queue
(&
wq
, &
__waô
); \

128 
	`£t_cuºít_°©e
(
TASK_UNINTERRUPTIBLE
); \

129 i‡(
c⁄dôi⁄
) \

131 
	`scheduÀ
(); \

133 
cuºít
->
°©e
 = 
TASK_RUNNING
; \

134 
	`ªmove_waô_queue
(&
wq
, &
__waô
); \

135 } 0)

	)

137 
	#waô_evít
(
wq
, 
c⁄dôi⁄
) \

139 i‡(
c⁄dôi⁄
) \

141 
	`__waô_evít
(
wq
, 
c⁄dôi⁄
); \

142 } 0)

	)

144 
	#__waô_evít_öãºu±ibÀ
(
wq
, 
c⁄dôi⁄
, 
ªt
) \

146 
waô_queue_t
 
__waô
; \

147 
	`öô_waôqueue_íåy
(&
__waô
, 
cuºít
); \

149 
	`add_waô_queue
(&
wq
, &
__waô
); \

151 
	`£t_cuºít_°©e
(
TASK_INTERRUPTIBLE
); \

152 i‡(
c⁄dôi⁄
) \

154 i‡(!
	`sig«l_≥ndög
(
cuºít
)) { \

155 
	`scheduÀ
(); \

158 
ªt
 = -
ERESTARTSYS
; \

161 
cuºít
->
°©e
 = 
TASK_RUNNING
; \

162 
	`ªmove_waô_queue
(&
wq
, &
__waô
); \

163 } 0)

	)

165 
	#waô_evít_öãºu±ibÀ
(
wq
, 
c⁄dôi⁄
) \

167 
__ªt
 = 0; \

168 i‡(!(
c⁄dôi⁄
)) \

169 
	`__waô_evít_öãºu±ibÀ
(
wq
, 
c⁄dôi⁄
, 
__ªt
); \

170 
__ªt
; \

171 })

	)

173 
	#__waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
ªt
) \

175 
waô_queue_t
 
__waô
; \

176 
	`öô_waôqueue_íåy
(&
__waô
, 
cuºít
); \

178 
	`add_waô_queue
(&
wq
, &
__waô
); \

180 
	`£t_cuºít_°©e
(
TASK_INTERRUPTIBLE
); \

181 i‡(
c⁄dôi⁄
) \

183 i‡(!
	`sig«l_≥ndög
(
cuºít
)) { \

184 
ªt
 = 
	`scheduÀ_timeout
(ret); \

185 i‡(!
ªt
) \

189 
ªt
 = -
ERESTARTSYS
; \

192 
cuºít
->
°©e
 = 
TASK_RUNNING
; \

193 
	`ªmove_waô_queue
(&
wq
, &
__waô
); \

194 } 0)

	)

196 
	#waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
timeout
) \

198 
__ªt
 = 
timeout
; \

199 i‡(!(
c⁄dôi⁄
)) \

200 
	`__waô_evít_öãºu±ibÀ_timeout
(
wq
, 
c⁄dôi⁄
, 
__ªt
); \

201 
__ªt
; \

202 })

	)

207 
ölöe
 
	$add_waô_queue_ex˛usive_locked
(
waô_queue_hód_t
 *
q
,

208 
waô_queue_t
 * 
waô
)

210 
waô
->
Êags
 |
WQ_FLAG_EXCLUSIVE
;

211 
	`__add_waô_queue_èû
(
q
, 
waô
);

212 
	}
}

217 
ölöe
 
	$ªmove_waô_queue_locked
(
waô_queue_hód_t
 *
q
,

218 
waô_queue_t
 * 
waô
)

220 
	`__ªmove_waô_queue
(
q
, 
waô
);

221 
	}
}

228 
FASTCALL
(
¶ìp_⁄
(
waô_queue_hód_t
 *
q
));

229 
FASTCALL
(
¶ìp_⁄_timeout
(
waô_queue_hód_t
 *
q
,

230 sig√d 
timeout
));

231 
FASTCALL
(
öãºu±ibÀ_¶ìp_⁄
(
waô_queue_hód_t
 *
q
));

232 
FASTCALL
(
öãºu±ibÀ_¶ìp_⁄_timeout
(
waô_queue_hód_t
 *
q
,

233 sig√d 
timeout
));

238 
FASTCALL
(
¥ï¨e_to_waô
(
waô_queue_hód_t
 *
q
,

239 
waô_queue_t
 *
waô
, 
°©e
));

240 
FASTCALL
(
¥ï¨e_to_waô_ex˛usive
(
waô_queue_hód_t
 *
q
,

241 
waô_queue_t
 *
waô
, 
°©e
));

242 
FASTCALL
(
föish_waô
(
waô_queue_hód_t
 *
q
, 
waô_queue_t
 *
waô
));

243 
aut‹emove_wake_fun˘i⁄
(
waô_queue_t
 *
waô
, 
mode
, 
sync
);

245 
	#DEFINE_WAIT
(
«me
) \

246 
waô_queue_t
 
«me
 = { \

247 .
èsk
 = 
cuºít
, \

248 .
func
 = 
aut‹emove_wake_fun˘i⁄
, \

249 .
èsk_li°
 = { .
√xt
 = &
«me
.task_list, \

250 .
¥ev
 = &
«me
.
èsk_li°
, \

252 }

	)

254 
	#öô_waô
(
waô
) \

256 
waô
->
èsk
 = 
cuºít
; \

257 
waô
->
func
 = 
aut‹emove_wake_fun˘i⁄
; \

258 
	`INIT_LIST_HEAD
(&
waô
->
èsk_li°
); \

259 } 0)

	)

	@/usr/include/linux/workqueue.h

5 #i‚de‡
_LINUX_WORKQUEUE_H


6 
	#_LINUX_WORKQUEUE_H


	)

8 
	~<löux/timî.h
>

9 
	~<löux/lökage.h
>

11 
	gw‹kqueue_°ru˘
;

13 
	sw‹k_°ru˘
 {

14 
	m≥ndög
;

15 
li°_hód
 
	míåy
;

16 (*
	mfunc
)(*);

17 *
	md©a
;

18 *
	mwq_d©a
;

19 
timî_li°
 
	mtimî
;

22 
	#__WORK_INITIALIZER
(
n
, 
f
, 
d
) { \

23 .
íåy
 = { &(
n
).entry, &(n).entry }, \

24 .
func
 = (
f
), \

25 .
d©a
 = (
d
), \

26 .
timî
 = 
	`TIMER_INITIALIZER
(
NULL
, 0, 0), \

27 }

	)

29 
	#DECLARE_WORK
(
n
, 
f
, 
d
) \

30 
w‹k_°ru˘
 
n
 = 
	`__WORK_INITIALIZER
“, 
f
, 
d
)

	)

35 
	#PREPARE_WORK
(
_w‹k
, 
_func
, 
_d©a
) \

37 (
_w‹k
)->
func
 = 
_func
; \

38 (
_w‹k
)->
d©a
 = 
_d©a
; \

39 } 0)

	)

44 
	#INIT_WORK
(
_w‹k
, 
_func
, 
_d©a
) \

46 
	`INIT_LIST_HEAD
(&(
_w‹k
)->
íåy
); \

47 (
_w‹k
)->
≥ndög
 = 0; \

48 
	`PREPARE_WORK
((
_w‹k
), (
_func
), (
_d©a
)); \

49 
	`öô_timî
(&(
_w‹k
)->
timî
); \

50 } 0)

	)

52 
w‹kqueue_°ru˘
 *
¸óã_w‹kqueue
(c⁄° *
«me
);

53 
de°roy_w‹kqueue
(
w‹kqueue_°ru˘
 *
wq
);

55 
FASTCALL
(
queue_w‹k
(
w‹kqueue_°ru˘
 *
wq
, 
w‹k_°ru˘
 *
w‹k
));

56 
FASTCALL
(
queue_dñayed_w‹k
(
w‹kqueue_°ru˘
 *
wq
, 
w‹k_°ru˘
 *
w‹k
, 
dñay
));

57 
FASTCALL
(
Êush_w‹kqueue
(
w‹kqueue_°ru˘
 *
wq
));

59 
FASTCALL
(
scheduÀ_w‹k
(
w‹k_°ru˘
 *
w‹k
));

60 
FASTCALL
(
scheduÀ_dñayed_w‹k
(
w‹k_°ru˘
 *
w‹k
, 
dñay
));

61 
Êush_scheduÀd_w‹k
();

62 
cuºít_is_kevítd
();

64 
öô_w‹kqueues
();

71 
ölöe
 
	$ˇn˚l_dñayed_w‹k
(
w‹k_°ru˘
 *
w‹k
)

73  
	`dñ_timî_sync
(&
w‹k
->
timî
);

74 
	}
}

	@/usr/include/rpc/netdb.h

36 #i‚de‡
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<„©uªs.h
>

41 
	#__√ed_size_t


	)

42 
	~<°ddef.h
>

44 
__BEGIN_DECLS


46 
	sΩ˚¡


48 *
	mr_«me
;

49 **
	mr_Æü£s
;

50 
	mr_numbî
;

53 
	$£åp˚¡
 (
__°ay›í
Ë
__THROW
;

54 
	$ídΩ˚¡
 (Ë
__THROW
;

55 
Ω˚¡
 *
	$gëΩcby«me
 (
__c⁄°
 *
__«me
Ë
__THROW
;

56 
Ω˚¡
 *
	$gëΩcbynumbî
 (
__numbî
Ë
__THROW
;

57 
Ω˚¡
 *
	$gëΩ˚¡
 (Ë
__THROW
;

59 #ifde‡
__USE_MISC


60 
	$gëΩcby«me_r
 (
__c⁄°
 *
__«me
, 
Ω˚¡
 *
__ªsu…_buf
,

61 *
__buf„r
, 
size_t
 
__buÊí
,

62 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

64 
	$gëΩcbynumbî_r
 (
__numbî
, 
Ω˚¡
 *
__ªsu…_buf
,

65 *
__buf„r
, 
size_t
 
__buÊí
,

66 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

68 
	$gëΩ˚¡_r
 (
Ω˚¡
 *
__ªsu…_buf
, *
__buf„r
,

69 
size_t
 
__buÊí
, 
Ω˚¡
 **
__ªsu…
Ë
__THROW
;

72 
__END_DECLS


	@/usr/include/sched.h

20 #i‚def 
_SCHED_H


21 
	#_SCHED_H
 1

	)

23 
	~<„©uªs.h
>

26 
	~<bôs/ty≥s.h
>

28 
	#__√ed_time•ec


	)

29 
	~<time.h
>

32 
	~<bôs/sched.h
>

34 
	#sched_¥i‹ôy
 
__sched_¥i‹ôy


	)

37 
__BEGIN_DECLS


40 
	$sched_£ç¨am
 (
__pid_t
 
__pid
, 
__c⁄°
 
sched_∑øm
 *
__∑øm
)

41 
__THROW
;

44 
	$sched_gë∑øm
 (
__pid_t
 
__pid
, 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

47 
	$sched_£tscheduÀr
 (
__pid_t
 
__pid
, 
__pﬁicy
,

48 
__c⁄°
 
sched_∑øm
 *
__∑øm
Ë
__THROW
;

51 
	$sched_gëscheduÀr
 (
__pid_t
 
__pid
Ë
__THROW
;

54 
	$sched_yõld
 (Ë
__THROW
;

57 
	$sched_gë_¥i‹ôy_max
 (
__Æg‹ôhm
Ë
__THROW
;

60 
	$sched_gë_¥i‹ôy_mö
 (
__Æg‹ôhm
Ë
__THROW
;

63 
	$sched_º_gë_öãrvÆ
 (
__pid_t
 
__pid
, 
time•ec
 *
__t
Ë
__THROW
;

66 #ifde‡
__USE_GNU


68 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

69 
	#CPU_SET
(
˝u
, 
˝u£ç
Ë
	`__CPU_SET
 (˝u, cpu£ç)

	)

70 
	#CPU_CLR
(
˝u
, 
˝u£ç
Ë
	`__CPU_CLR
 (˝u, cpu£ç)

	)

71 
	#CPU_ISSET
(
˝u
, 
˝u£ç
Ë
	`__CPU_ISSET
 (˝u, cpu£ç)

	)

72 
	#CPU_ZERO
(
˝u£ç
Ë
	`__CPU_ZERO
 (˝u£ç)

	)

76 
	$sched_£èfföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

77 
__c⁄°
 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

80 
	$sched_gëafföôy
 (
__pid_t
 
__pid
, 
size_t
 
__˝u£tsize
,

81 
˝u_£t_t
 *
__˝u£t
Ë
__THROW
;

84 
__END_DECLS


	@/usr/include/stdint.h

23 #i‚de‡
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<„©uªs.h
>

27 
	~<bôs/wch¨.h
>

28 
	~<bôs/w‹dsize.h
>

35 #i‚de‡
__öt8_t_deföed


36 
	#__öt8_t_deföed


	)

37 sig√d 
	töt8_t
;

38 
	töt16_t
;

39 
	töt32_t
;

40 #i‡
__WORDSIZE
 == 64

41 
	töt64_t
;

43 
__exãnsi⁄__


44 
	töt64_t
;

49 
	tuöt8_t
;

50 
	tuöt16_t
;

51 #i‚de‡
__uöt32_t_deföed


52 
	tuöt32_t
;

53 
	#__uöt32_t_deföed


	)

55 #i‡
__WORDSIZE
 == 64

56 
	tuöt64_t
;

58 
__exãnsi⁄__


59 
	tuöt64_t
;

66 sig√d 
	töt_Àa°8_t
;

67 
	töt_Àa°16_t
;

68 
	töt_Àa°32_t
;

69 #i‡
__WORDSIZE
 == 64

70 
	töt_Àa°64_t
;

72 
__exãnsi⁄__


73 
	töt_Àa°64_t
;

77 
	tuöt_Àa°8_t
;

78 
	tuöt_Àa°16_t
;

79 
	tuöt_Àa°32_t
;

80 #i‡
__WORDSIZE
 == 64

81 
	tuöt_Àa°64_t
;

83 
__exãnsi⁄__


84 
	tuöt_Àa°64_t
;

91 sig√d 
	töt_Á°8_t
;

92 #i‡
__WORDSIZE
 == 64

93 
	töt_Á°16_t
;

94 
	töt_Á°32_t
;

95 
	töt_Á°64_t
;

97 
	töt_Á°16_t
;

98 
	töt_Á°32_t
;

99 
__exãnsi⁄__


100 
	töt_Á°64_t
;

104 
	tuöt_Á°8_t
;

105 #i‡
__WORDSIZE
 == 64

106 
	tuöt_Á°16_t
;

107 
	tuöt_Á°32_t
;

108 
	tuöt_Á°64_t
;

110 
	tuöt_Á°16_t
;

111 
	tuöt_Á°32_t
;

112 
__exãnsi⁄__


113 
	tuöt_Á°64_t
;

118 #i‡
__WORDSIZE
 == 64

119 #i‚de‡
__öçå_t_deföed


120 
	töçå_t
;

121 
	#__öçå_t_deföed


	)

123 
	tuöçå_t
;

125 #i‚de‡
__öçå_t_deföed


126 
	töçå_t
;

127 
	#__öçå_t_deföed


	)

129 
	tuöçå_t
;

134 #i‡
__WORDSIZE
 == 64

135 
	tötmax_t
;

136 
	tuötmax_t
;

138 
__exãnsi⁄__


139 
	tötmax_t
;

140 
__exãnsi⁄__


141 
	tuötmax_t
;

147 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_LIMIT_MACROS


149 #i‡
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
Ë¯## 
L


	)

151 
	#__UINT64_C
(
c
Ë¯## 
UL


	)

153 
	#__INT64_C
(
c
Ë¯## 
LL


	)

154 
	#__UINT64_C
(
c
Ë¯## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #i‡
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #i‡
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #i‡
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #i‡
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #i‡
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #i‡
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #i‚de‡
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #i‡!
deföed
 
__˝lu•lus
 || deföed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
Ë
	)
c

291 
	#INT16_C
(
c
Ë
	)
c

292 
	#INT32_C
(
c
Ë
	)
c

293 #i‡
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
Ë¯## 
L


	)

296 
	#INT64_C
(
c
Ë¯## 
LL


	)

300 
	#UINT8_C
(
c
Ë¯## 
U


	)

301 
	#UINT16_C
(
c
Ë¯## 
U


	)

302 
	#UINT32_C
(
c
Ë¯## 
U


	)

303 #i‡
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
Ë¯## 
UL


	)

306 
	#UINT64_C
(
c
Ë¯## 
ULL


	)

310 #i‡
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
Ë¯## 
L


	)

312 
	#UINTMAX_C
(
c
Ë¯## 
UL


	)

314 
	#INTMAX_C
(
c
Ë¯## 
LL


	)

315 
	#UINTMAX_C
(
c
Ë¯## 
ULL


	)

	@/usr/include/sys/cdefs.h

19 #i‚def 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #i‚de‡
_FEATURES_H


24 
	~<„©uªs.h
>

30 #i‡
deföed
 
__GNUC__
 && !deföed 
__STDC__


35 #unde‡
__P


36 #unde‡
__PMT


38 #ifde‡
__GNUC__


43 #i‡
deföed
 
__˝lu•lus
 && 
__GNUC_PREREQ
 (2,8)

44 
	#__THROW
 
	`throw
 ()

	)

46 
	#__THROW


	)

48 
	#__P
(
¨gs
Ë¨g†
__THROW


	)

51 
	#__PMT
(
¨gs
Ë
	)
args

55 
	#__ölöe


	)

57 
	#__THROW


	)

58 
	#__P
(
¨gs
Ë
	)
args

59 
	#__PMT
(
¨gs
Ë
	)
args

61 
	#__c⁄°
 c⁄°

	)

62 
	#__sig√d
 sig√d

	)

63 
	#__vﬁ©ûe
 vﬁ©ûe

	)

70 
	#__CONCAT
(
x
,
y
Ëx ## 
	)
y

71 
	#__STRING
(
x
Ë#x

	)

74 
	#__±r_t
 *

	)

75 
	#__l⁄g_doubÀ_t
 

	)

79 #ifdef 
__˝lu•lus


80 
	#__BEGIN_DECLS
 "C" {

	)

81 
	#__END_DECLS
 }

	)

83 
	#__BEGIN_DECLS


	)

84 
	#__END_DECLS


	)

93 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES


94 
	#__BEGIN_NAMESPACE_STD
 
«me•a˚
 
°d
 {

	)

95 
	#__END_NAMESPACE_STD
 }

	)

96 
	#__USING_NAMESPACE_STD
(
«me
Ë
usög
 
°d
::«me;

	)

97 
	#__BEGIN_NAMESPACE_C99
 
«me•a˚
 
__c99
 {

	)

98 
	#__END_NAMESPACE_C99
 }

	)

99 
	#__USING_NAMESPACE_C99
(
«me
Ë
usög
 
__c99
::«me;

	)

104 
	#__BEGIN_NAMESPACE_STD


	)

105 
	#__END_NAMESPACE_STD


	)

106 
	#__USING_NAMESPACE_STD
(
«me
)

	)

107 
	#__BEGIN_NAMESPACE_C99


	)

108 
	#__END_NAMESPACE_C99


	)

109 
	#__USING_NAMESPACE_C99
(
«me
)

	)

114 #i‚de‡
__BOUNDED_POINTERS__


115 
	#__bounded


	)

116 
	#__unbounded


	)

117 
	#__±rvÆue


	)

122 #i‡
__GNUC_PREREQ
 (2,97)

124 
	#__Êex¨r
 []

	)

126 #ifde‡
__GNUC__


127 
	#__Êex¨r
 [0]

	)

129 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

130 
	#__Êex¨r
 []

	)

133 
	#__Êex¨r
 [1]

	)

149 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

151 
	#__REDIRECT
(
«me
, 
¥Ÿo
, 
Æüs
Ë«mê¥Ÿÿ
	`__asm__
 (
	`__ASMNAME
 (#Æüs))

	)

152 
	#__ASMNAME
(
˙ame
Ë
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, c«me)

	)

153 
	#__ASMNAME2
(
¥efix
, 
˙ame
Ë
	`__STRING
 (¥efixË
	)
cname

166 #i‡!
deföed
 
__GNUC__
 || __GNUC__ < 2

167 
	#__©åibuã__
(
xyz
Ë

	)

173 #i‡
__GNUC_PREREQ
 (2,96)

174 
	#__©åibuã_mÆloc__
 
	`__©åibuã__
 ((
__mÆloc__
))

	)

176 
	#__©åibuã_mÆloc__


	)

182 #i‡
__GNUC_PREREQ
 (2,96)

183 
	#__©åibuã_puª__
 
	`__©åibuã__
 ((
__puª__
))

	)

185 
	#__©åibuã_puª__


	)

191 #i‡
__GNUC_PREREQ
 (3,1)

192 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__u£d__
))

	)

193 
	#__©åibuã_noölöe__
 
	`__©åibuã__
 ((
__noölöe__
))

	)

195 
	#__©åibuã_u£d__
 
	`__©åibuã__
 ((
__unu£d__
))

	)

196 
	#__©åibuã_noölöe__


	)

200 #i‡
__GNUC_PREREQ
 (3,2)

201 
	#__©åibuã_dïªˇãd__
 
	`__©åibuã__
 ((
__dïªˇãd__
))

	)

203 
	#__©åibuã_dïªˇãd__


	)

212 #i‡
__GNUC_PREREQ
 (2,8)

213 
	#__©åibuã_f‹m©_¨g__
(
x
Ë
	`__©åibuã__
 ((
	`__f‹m©_¨g__
 (x)))

	)

215 
	#__©åibuã_f‹m©_¨g__
(
x
Ë

	)

222 #i‡
__GNUC_PREREQ
 (2,97)

223 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
) \

224 
	`__©åibuã__
 ((
	`__f‹m©__
 (
__°rfm⁄__
, 
a
, 
b
)))

	)

226 
	#__©åibuã_f‹m©_°rfm⁄__
(
a
,
b
Ë

	)

233 #i‡!
__GNUC_PREREQ
 (2,8)

234 
	#__exãnsi⁄__


	)

238 #i‡!
__GNUC_PREREQ
 (2,92)

239 
	#__ª°ri˘


	)

245 #i‡
__GNUC_PREREQ
 (3,1Ë&& !
deföed
 
__GNUG__


246 
	#__ª°ri˘_¨r
 
__ª°ri˘


	)

248 #ifde‡
__GNUC__


249 
	#__ª°ri˘_¨r


	)

251 #i‡
deföed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

252 
	#__ª°ri˘_¨r
 
ª°ri˘


	)

255 
	#__ª°ri˘_¨r


	)

	@/usr/include/sys/resource.h

19 #i‚def 
_SYS_RESOURCE_H


20 
	#_SYS_RESOURCE_H
 1

	)

22 
	~<„©uªs.h
>

25 
	~<bôs/ªsour˚.h
>

27 #i‚de‡
__id_t_deföed


28 
__id_t
 
	tid_t
;

29 
	#__id_t_deföed


	)

32 
	g__BEGIN_DECLS


38 #i‡
deföed
 
__USE_GNU
 && !deföed 
__˝lu•lus


39 
__æimô_ªsour˚
 
	t__æimô_ªsour˚_t
;

40 
__rußge_who
 
	t__rußge_who_t
;

41 
__¥i‹ôy_which
 
	t__¥i‹ôy_which_t
;

43 
	t__æimô_ªsour˚_t
;

44 
	t__rußge_who_t
;

45 
	t__¥i‹ôy_which_t
;

50 #i‚de‡
__USE_FILE_OFFSET64


51 
	$gëæimô
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

52 
æimô
 *
__æimôs
Ë
__THROW
;

54 #ifde‡
__REDIRECT


55 
	`__REDIRECT
 (
gëæimô
, (
__æimô_ªsour˚_t
 
__ªsour˚
,

56 
æimô
 *
__æimôs
Ë
__THROW
,

57 
gëæimô64
);

59 
	#gëæimô
 
gëæimô64


	)

62 #ifde‡
__USE_LARGEFILE64


63 
	$gëæimô64
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

64 
æimô64
 *
__æimôs
Ë
__THROW
;

70 #i‚de‡
__USE_FILE_OFFSET64


71 
	$£ålimô
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

72 
__c⁄°
 
æimô
 *
__æimôs
Ë
__THROW
;

74 #ifde‡
__REDIRECT


75 
	`__REDIRECT
 (
£ålimô
, (
__æimô_ªsour˚_t
 
__ªsour˚
,

76 
__c⁄°
 
æimô
 *
__æimôs
Ë
__THROW
,

77 
£ålimô64
);

79 
	#£ålimô
 
£ålimô64


	)

82 #ifde‡
__USE_LARGEFILE64


83 
	$£ålimô64
 (
__æimô_ªsour˚_t
 
__ªsour˚
,

84 
__c⁄°
 
æimô64
 *
__æimôs
Ë
__THROW
;

89 
	$gërußge
 (
__rußge_who_t
 
__who
, 
rußge
 *
__ußge
Ë
__THROW
;

95 
	$gë¥i‹ôy
 (
__¥i‹ôy_which_t
 
__which
, 
id_t
 
__who
Ë
__THROW
;

99 
	$£çri‹ôy
 (
__¥i‹ôy_which_t
 
__which
, 
id_t
 
__who
, 
__¥io
)

100 
__THROW
;

102 
__END_DECLS


	@/usr/include/sys/sysmacros.h

20 #i‚de‡
_SYS_SYSMACROS_H


21 
	#_SYS_SYSMACROS_H
 1

	)

27 #i‡
deföed
 
__GNUC__
 && __GNUC__ >= 2

28 
	#maj‹
(
dev
Ë(()(((devË>> 8Ë& 0xff))

	)

29 
	#mö‹
(
dev
Ë(()((devË& 0xff))

	)

30 
	#makedev
(
maj‹
, 
mö‹
) (((() (major)) << 8) \

31 | ((Ë(
mö‹
)))

	)

35 
	~<ídün.h
>

36 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


37 
	#maj‹
(
dev
Ë(((dev).
__vÆ
[1] >> 8Ë& 0xff)

	)

38 
	#mö‹
(
dev
Ë((dev).
__vÆ
[1] & 0xff)

	)

39 
	#makedev
(
maj‹
, 
mö‹
) { 0, (((() (major)) << 8) \

40 | ((Ë(
mö‹
))Ë}

	)

42 
	#maj‹
(
dev
Ë(((dev).
__vÆ
[0] >> 8Ë& 0xff)

	)

43 
	#mö‹
(
dev
Ë((dev).
__vÆ
[0] & 0xff)

	)

44 
	#makedev
(
maj‹
, 
mö‹
) { (((() (major)) << 8) \

45 | ((Ë(
mö‹
))), 0 }

	)

	@/usr/include/sys/ttydefaults.h

40 #i‚de‡
_SYS_TTYDEFAULTS_H_


41 
	#_SYS_TTYDEFAULTS_H_


	)

46 
	#TTYDEF_IFLAG
 (
BRKINT
 | 
ISTRIP
 | 
ICRNL
 | 
IMAXBEL
 | 
IXON
 | 
IXANY
)

	)

47 
	#TTYDEF_OFLAG
 (
OPOST
 | 
ONLCR
 | 
XTABS
)

	)

48 
	#TTYDEF_LFLAG
 (
ECHO
 | 
ICANON
 | 
ISIG
 | 
IEXTEN
 | 
ECHOE
|
ECHOKE
|
ECHOCTL
)

	)

49 
	#TTYDEF_CFLAG
 (
CREAD
 | 
CS7
 | 
PARENB
 | 
HUPCL
)

	)

50 
	#TTYDEF_SPEED
 (
B9600
)

	)

55 
	#CTRL
(
x
Ë(x&037)

	)

56 
	#CEOF
 
	`CTRL
('d')

	)

57 #ifde‡
_POSIX_VDISABLE


58 
	#CEOL
 
_POSIX_VDISABLE


	)

60 
	#CEOL
 '\0'

	)

62 
	#CERASE
 0177

	)

63 
	#CINTR
 
	`CTRL
('c')

	)

64 #ifde‡
_POSIX_VDISABLE


65 
	#CSTATUS
 
_POSIX_VDISABLE


	)

67 
	#CSTATUS
 '\0'

	)

69 
	#CKILL
 
	`CTRL
('u')

	)

70 
	#CMIN
 1

	)

71 
	#CQUIT
 034

	)

72 
	#CSUSP
 
	`CTRL
('z')

	)

73 
	#CTIME
 0

	)

74 
	#CDSUSP
 
	`CTRL
('y')

	)

75 
	#CSTART
 
	`CTRL
('q')

	)

76 
	#CSTOP
 
	`CTRL
('s')

	)

77 
	#CLNEXT
 
	`CTRL
('v')

	)

78 
	#CDISCARD
 
	`CTRL
('o')

	)

79 
	#CWERASE
 
	`CTRL
('w')

	)

80 
	#CREPRINT
 
	`CTRL
('r')

	)

81 
	#CEOT
 
CEOF


	)

83 
	#CBRK
 
CEOL


	)

84 
	#CRPRNT
 
CREPRINT


	)

85 
	#CFLUSH
 
CDISCARD


	)

93 #ifde‡
TTYDEFCHARS


94 
cc_t
 
	gâydefch¨s
[
NCCS
] = {

95 
CEOF
, 
CEOL
, CEOL, 
CERASE
, 
CWERASE
, 
CKILL
, 
CREPRINT
,

96 
_POSIX_VDISABLE
, 
CINTR
, 
CQUIT
, 
CSUSP
, 
CDSUSP
, 
CSTART
, 
CSTOP
, 
CLNEXT
,

97 
CDISCARD
, 
CMIN
, 
CTIME
, 
CSTATUS
, 
_POSIX_VDISABLE


99 #unde‡
TTYDEFCHARS


	@/usr/include/sys/ucontext.h

19 #i‚de‡
_SYS_UCONTEXT_H


20 
	#_SYS_UCONTEXT_H
 1

	)

22 
	~<„©uªs.h
>

23 
	~<sig«l.h
>

27 
	~<bôs/sigc⁄ãxt.h
>

31 
	tgªg_t
;

34 
	#NGREG
 19

	)

37 
gªg_t
 
	tgªg£t_t
[
NGREG
];

39 #ifde‡
__USE_GNU


43 
	mREG_GS
 = 0,

44 
	#REG_GS
 
REG_GS


	)

45 
	mREG_FS
,

46 
	#REG_FS
 
REG_FS


	)

47 
	mREG_ES
,

48 
	#REG_ES
 
REG_ES


	)

49 
	mREG_DS
,

50 
	#REG_DS
 
REG_DS


	)

51 
	mREG_EDI
,

52 
	#REG_EDI
 
REG_EDI


	)

53 
	mREG_ESI
,

54 
	#REG_ESI
 
REG_ESI


	)

55 
	mREG_EBP
,

56 
	#REG_EBP
 
REG_EBP


	)

57 
	mREG_ESP
,

58 
	#REG_ESP
 
REG_ESP


	)

59 
	mREG_EBX
,

60 
	#REG_EBX
 
REG_EBX


	)

61 
	mREG_EDX
,

62 
	#REG_EDX
 
REG_EDX


	)

63 
	mREG_ECX
,

64 
	#REG_ECX
 
REG_ECX


	)

65 
	mREG_EAX
,

66 
	#REG_EAX
 
REG_EAX


	)

67 
	mREG_TRAPNO
,

68 
	#REG_TRAPNO
 
REG_TRAPNO


	)

69 
	mREG_ERR
,

70 
	#REG_ERR
 
REG_ERR


	)

71 
	mREG_EIP
,

72 
	#REG_EIP
 
REG_EIP


	)

73 
	mREG_CS
,

74 
	#REG_CS
 
REG_CS


	)

75 
	mREG_EFL
,

76 
	#REG_EFL
 
REG_EFL


	)

77 
	mREG_UESP
,

78 
	#REG_UESP
 
REG_UESP


	)

79 
	mREG_SS


80 
	#REG_SS
 
REG_SS


	)

85 
	s_libc_Âªg


87 
	msignifiˇnd
[4];

88 
	mexp⁄ít
;

91 
	s_libc_Â°©e


93 
	mcw
;

94 
	msw
;

95 
	mèg
;

96 
	mùoff
;

97 
	mcs£l
;

98 
	md©aoff
;

99 
	md©a£l
;

100 
_libc_Âªg
 
	m_°
[8];

101 
	m°©us
;

105 
_libc_Â°©e
 *
	tÂªg£t_t
;

110 
gªg£t_t
 
	mgªgs
;

113 
Âªg£t_t
 
	mÂªgs
;

114 
	mﬁdmask
;

115 
	m¸2
;

116 } 
	tmc⁄ãxt_t
;

119 
	suc⁄ãxt


121 
	muc_Êags
;

122 
uc⁄ãxt
 *
	muc_lök
;

123 
°ack_t
 
	muc_°ack
;

124 
mc⁄ãxt_t
 
	muc_mc⁄ãxt
;

125 
__sig£t_t
 
	muc_sigmask
;

126 
_libc_Â°©e
 
	m__Âªgs_mem
;

127 } 
	tuc⁄ãxt_t
;

	@/usr/include/xlocale.h

21 #i‚de‡
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loˇÀ_°ru˘


31 
loˇÀ_d©a
 *
	m__loˇÀs
[13];

34 c⁄° *
	m__˘y≥_b
;

35 c⁄° *
	m__˘y≥_tﬁowî
;

36 c⁄° *
	m__˘y≥_touµî
;

39 c⁄° *
	m__«mes
[13];

40 } *
	t__loˇÀ_t
;

	@/usr/include/_G_config.h

4 #i‚de‡
_G_c⁄fig_h


5 
	#_G_c⁄fig_h
 1

	)

9 
	~<bôs/ty≥s.h
>

10 
	#__√ed_size_t


	)

11 
	#__√ed_wch¨_t


	)

12 
	#__√ed_wöt_t


	)

13 
	#__√ed_NULL


	)

14 
	~<°ddef.h
>

15 #i‚de‡
_WINT_T


20 
	#_WINT_T


	)

21 
	twöt_t
;

23 
	#__√ed_mb°©e_t


	)

24 
	~<wch¨.h
>

25 
	#_G_size_t
 
size_t


	)

28 
__off_t
 
	m__pos
;

29 
__mb°©e_t
 
	m__°©e
;

30 } 
	t_G_Âos_t
;

33 
__off64_t
 
	m__pos
;

34 
__mb°©e_t
 
	m__°©e
;

35 } 
	t_G_Âos64_t
;

36 
	#_G_ssize_t
 
__ssize_t


	)

37 
	#_G_off_t
 
__off_t


	)

38 
	#_G_off64_t
 
__off64_t


	)

39 
	#_G_pid_t
 
__pid_t


	)

40 
	#_G_uid_t
 
__uid_t


	)

41 
	#_G_wch¨_t
 
wch¨_t


	)

42 
	#_G_wöt_t
 
wöt_t


	)

43 
	#_G_°©64
 
°©64


	)

44 
	~<gc⁄v.h
>

47 
__gc⁄v_öfo
 
	m__cd
;

50 
__gc⁄v_öfo
 
	m__cd
;

51 
__gc⁄v_°ï_d©a
 
	m__d©a
;

52 } 
	m__comböed
;

53 } 
	t_G_ic⁄v_t
;

55 
	t_G_öt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

56 
	t_G_öt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

57 
	t_G_uöt16_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__HI__
)));

58 
	t_G_uöt32_t
 
	t__©åibuã__
 ((
	t__mode__
 (
	t__SI__
)));

60 
	#_G_HAVE_BOOL
 1

	)

64 
	#_G_HAVE_ATEXIT
 1

	)

65 
	#_G_HAVE_SYS_CDEFS
 1

	)

66 
	#_G_HAVE_SYS_WAIT
 1

	)

67 
	#_G_NEED_STDARG_H
 1

	)

68 
	#_G_va_li°
 
__gnuc_va_li°


	)

70 
	#_G_HAVE_PRINTF_FP
 1

	)

71 
	#_G_HAVE_MMAP
 1

	)

72 
	#_G_HAVE_LONG_DOUBLE_IO
 1

	)

73 
	#_G_HAVE_IO_FILE_OPEN
 1

	)

74 
	#_G_HAVE_IO_GETLINE_INFO
 1

	)

76 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

78 
	#_G_OPEN64
 
__›í64


	)

79 
	#_G_LSEEK64
 
__l£ek64


	)

80 
	#_G_MMAP64
 
__mm≠64


	)

81 
	#_G_FSTAT64
(
fd
,
buf
Ë
	`__fx°©64
 (
_STAT_VER
, fd, buf)

	)

84 
	#_G_HAVE_ST_BLKSIZE
 
	`deföed
 (
_STATBUF_ST_BLKSIZE
)

	)

86 
	#_G_BUFSIZ
 8192

	)

89 
	#_G_NAMES_HAVE_UNDERSCORE
 0

	)

90 
	#_G_VTABLE_LABEL_HAS_LENGTH
 1

	)

91 
	#_G_USING_THUNKS
 1

	)

92 
	#_G_VTABLE_LABEL_PREFIX
 "__vt_"

	)

93 
	#_G_VTABLE_LABEL_PREFIX_ID
 
__vt_


	)

96 #i‡
deföed
 
__˝lu•lus
 || deföed 
__STDC__


97 
	#_G_ARGS
(
ARGLIST
Ë
	)
ARGLIST

99 
	#_G_ARGS
(
ARGLIST
Ë()

	)

	@/usr/include/asm/atomic.h

1 #i‚de‡
__ARCH_I386_ATOMIC__


2 
	#__ARCH_I386_ATOMIC__


	)

4 
	~<löux/c⁄fig.h
>

11 #ifde‡
CONFIG_SMP


12 
	#LOCK
 "lock ; "

	)

14 
	#LOCK
 ""

	)

22 °ru˘ { vﬁ©ûê
	mcou¡î
; } 
	t©omic_t
;

24 
	#ATOMIC_INIT
(
i
Ë{ (iË}

	)

33 
	#©omic_ªad
(
v
Ë((v)->
cou¡î
)

	)

43 
	#©omic_£t
(
v
,
i
Ë(((v)->
cou¡î
Ë(i))

	)

53 
__ölöe__
 
	$©omic_add
(
i
, 
©omic_t
 *
v
)

55 
__asm__
 
	`__vﬁ©ûe__
(

56 
LOCK
 "addl %1,%0"

57 :"=m" (
v
->
cou¡î
)

58 :"ú" (
i
), "m" (
v
->
cou¡î
));

59 
	}
}

69 
__ölöe__
 
	$©omic_sub
(
i
, 
©omic_t
 *
v
)

71 
__asm__
 
	`__vﬁ©ûe__
(

72 
LOCK
 "subl %1,%0"

73 :"=m" (
v
->
cou¡î
)

74 :"ú" (
i
), "m" (
v
->
cou¡î
));

75 
	}
}

87 
__ölöe__
 
	$©omic_sub_™d_ã°
(
i
, 
©omic_t
 *
v
)

89 
c
;

91 
__asm__
 
	`__vﬁ©ûe__
(

92 
LOCK
 "subl %2,%0; sete %1"

93 :"=m" (
v
->
cou¡î
), "=qm" (
c
)

94 :"ú" (
i
), "m" (
v
->
cou¡î
) : "memory");

95  
c
;

96 
	}
}

105 
__ölöe__
 
	$©omic_öc
(
©omic_t
 *
v
)

107 
__asm__
 
	`__vﬁ©ûe__
(

108 
LOCK
 "incl %0"

109 :"=m" (
v
->
cou¡î
)

110 :"m" (
v
->
cou¡î
));

111 
	}
}

120 
__ölöe__
 
	$©omic_dec
(
©omic_t
 *
v
)

122 
__asm__
 
	`__vﬁ©ûe__
(

123 
LOCK
 "decl %0"

124 :"=m" (
v
->
cou¡î
)

125 :"m" (
v
->
cou¡î
));

126 
	}
}

137 
__ölöe__
 
	$©omic_dec_™d_ã°
(
©omic_t
 *
v
)

139 
c
;

141 
__asm__
 
	`__vﬁ©ûe__
(

142 
LOCK
 "decl %0; sete %1"

143 :"=m" (
v
->
cou¡î
), "=qm" (
c
)

144 :"m" (
v
->
cou¡î
) : "memory");

145  
c
 != 0;

146 
	}
}

157 
__ölöe__
 
	$©omic_öc_™d_ã°
(
©omic_t
 *
v
)

159 
c
;

161 
__asm__
 
	`__vﬁ©ûe__
(

162 
LOCK
 "incl %0; sete %1"

163 :"=m" (
v
->
cou¡î
), "=qm" (
c
)

164 :"m" (
v
->
cou¡î
) : "memory");

165  
c
 != 0;

166 
	}
}

178 
__ölöe__
 
	$©omic_add_√g©ive
(
i
, 
©omic_t
 *
v
)

180 
c
;

182 
__asm__
 
	`__vﬁ©ûe__
(

183 
LOCK
 "addl %2,%0; sets %1"

184 :"=m" (
v
->
cou¡î
), "=qm" (
c
)

185 :"ú" (
i
), "m" (
v
->
cou¡î
) : "memory");

186  
c
;

187 
	}
}

190 
	#©omic_˛ór_mask
(
mask
, 
addr
) \

191 
__asm__
 
	`__vﬁ©ûe__
(
LOCK
 "andl %0,%1" \

192 : : "r" (~(
mask
)),"m" (*
addr
Ë: "mem‹y")

	)

194 
	#©omic_£t_mask
(
mask
, 
addr
) \

195 
__asm__
 
	`__vﬁ©ûe__
(
LOCK
 "orl %0,%1" \

196 : : "r" (
mask
),"m" (*(
addr
)Ë: "mem‹y")

	)

199 
	#smp_mb__bef‹e_©omic_dec
(Ë
	`b¨rõr
()

	)

200 
	#smp_mb__a·î_©omic_dec
(Ë
	`b¨rõr
()

	)

201 
	#smp_mb__bef‹e_©omic_öc
(Ë
	`b¨rõr
()

	)

202 
	#smp_mb__a·î_©omic_öc
(Ë
	`b¨rõr
()

	)

	@/usr/include/asm/byteorder.h

1 #i‚de‡
_I386_BYTEORDER_H


2 
	#_I386_BYTEORDER_H


	)

4 
	~<asm/ty≥s.h
>

6 #ifde‡
__GNUC__


9 #ifde‡
__KERNEL__


10 
	~<löux/c⁄fig.h
>

13 
__ölöe__
 
__u32
 
	$___¨ch__swab32
(
__u32
 
x
)

15 #ifde‡
CONFIG_X86_BSWAP


16 
	`__asm__
("bsw≠ %0" : "Ù" (
x
) : "0" (x));

18 
	`__asm__
("xchgb %b0,%h0\n\t"

21 :"=q" (
x
)

22 : "0" (
x
));

24  
x
;

25 
	}
}

29 
__ölöe__
 
__u16
 
	$___¨ch__swab16
(
__u16
 
x
)

31 
	`__asm__
("xchgb %b0,%h0"

32 : "=q" (
x
)

33 : "0" (
x
));

34  
x
;

35 
	}
}

37 
	#__¨ch__swab32
(
x
Ë
	`___¨ch__swab32
(x)

	)

38 
	#__¨ch__swab16
(
x
Ë
	`___¨ch__swab16
(x)

	)

40 #i‡!
deföed
 (
__STRICT_ANSI__
)

42 
ölöe
 
__u64
 
	$___¨ch__swab64
(
__u64
 
vÆ
)

45 °ru˘ { 
__u32
 
a
,
b
; } 
s
;

46 
__u64
 
u
;

47 } 
v
;

48 
v
.
u
 = 
vÆ
;

49 #ifde‡
CONFIG_X86_BSWAP


50 
	`asm
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

51 : "Ù" (
v
.
s
.
a
), "Ù" (v.s.
b
)

52 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

54 
v
.
s
.
a
 = 
	`___¨ch__swab32
(v.s.a);

55 
v
.
s
.
b
 = 
	`___¨ch__swab32
(v.s.b);

56 
	`asm
("xchg»%0,%1" : "Ù" (
v
.
s
.
a
), "Ù" (v.s.
b
) : "0" (v.s.a), "1" (v.s.b));

58  
v
.
u
;

59 
	}
}

61 
	#__¨ch__swab64
(
x
Ë
	`___¨ch__swab64
(x)

	)

63 
	#__BYTEORDER_HAS_U64__


	)

68 
	~<löux/byã‹dî/lôée_ídün.h
>

	@/usr/include/asm/ioctls.h

1 #i‚de‡
__ARCH_I386_IOCTLS_H__


2 
	#__ARCH_I386_IOCTLS_H__


	)

4 
	~<asm/io˘l.h
>

8 
	#TCGETS
 0x5401

	)

9 
	#TCSETS
 0x5402

	)

10 
	#TCSETSW
 0x5403

	)

11 
	#TCSETSF
 0x5404

	)

12 
	#TCGETA
 0x5405

	)

13 
	#TCSETA
 0x5406

	)

14 
	#TCSETAW
 0x5407

	)

15 
	#TCSETAF
 0x5408

	)

16 
	#TCSBRK
 0x5409

	)

17 
	#TCXONC
 0x540A

	)

18 
	#TCFLSH
 0x540B

	)

19 
	#TIOCEXCL
 0x540C

	)

20 
	#TIOCNXCL
 0x540D

	)

21 
	#TIOCSCTTY
 0x540E

	)

22 
	#TIOCGPGRP
 0x540F

	)

23 
	#TIOCSPGRP
 0x5410

	)

24 
	#TIOCOUTQ
 0x5411

	)

25 
	#TIOCSTI
 0x5412

	)

26 
	#TIOCGWINSZ
 0x5413

	)

27 
	#TIOCSWINSZ
 0x5414

	)

28 
	#TIOCMGET
 0x5415

	)

29 
	#TIOCMBIS
 0x5416

	)

30 
	#TIOCMBIC
 0x5417

	)

31 
	#TIOCMSET
 0x5418

	)

32 
	#TIOCGSOFTCAR
 0x5419

	)

33 
	#TIOCSSOFTCAR
 0x541A

	)

34 
	#FIONREAD
 0x541B

	)

35 
	#TIOCINQ
 
FIONREAD


	)

36 
	#TIOCLINUX
 0x541C

	)

37 
	#TIOCCONS
 0x541D

	)

38 
	#TIOCGSERIAL
 0x541E

	)

39 
	#TIOCSSERIAL
 0x541F

	)

40 
	#TIOCPKT
 0x5420

	)

41 
	#FIONBIO
 0x5421

	)

42 
	#TIOCNOTTY
 0x5422

	)

43 
	#TIOCSETD
 0x5423

	)

44 
	#TIOCGETD
 0x5424

	)

45 
	#TCSBRKP
 0x5425

	)

47 
	#TIOCSBRK
 0x5427

	)

48 
	#TIOCCBRK
 0x5428

	)

49 
	#TIOCGSID
 0x5429

	)

50 
	#TIOCGPTN
 
	`_IOR
('T',0x30, Ë

	)

51 
	#TIOCSPTLCK
 
	`_IOW
('T',0x31, Ë

	)

53 
	#FIONCLEX
 0x5450

	)

54 
	#FIOCLEX
 0x5451

	)

55 
	#FIOASYNC
 0x5452

	)

56 
	#TIOCSERCONFIG
 0x5453

	)

57 
	#TIOCSERGWILD
 0x5454

	)

58 
	#TIOCSERSWILD
 0x5455

	)

59 
	#TIOCGLCKTRMIOS
 0x5456

	)

60 
	#TIOCSLCKTRMIOS
 0x5457

	)

61 
	#TIOCSERGSTRUCT
 0x5458

	)

62 
	#TIOCSERGETLSR
 0x5459

	)

63 
	#TIOCSERGETMULTI
 0x545A

	)

64 
	#TIOCSERSETMULTI
 0x545B

	)

66 
	#TIOCMIWAIT
 0x545C

	)

67 
	#TIOCGICOUNT
 0x545D

	)

68 
	#TIOCGHAYESESP
 0x545E

	)

69 
	#TIOCSHAYESESP
 0x545F

	)

70 
	#FIOQSIZE
 0x5460

	)

73 
	#TIOCPKT_DATA
 0

	)

74 
	#TIOCPKT_FLUSHREAD
 1

	)

75 
	#TIOCPKT_FLUSHWRITE
 2

	)

76 
	#TIOCPKT_STOP
 4

	)

77 
	#TIOCPKT_START
 8

	)

78 
	#TIOCPKT_NOSTOP
 16

	)

79 
	#TIOCPKT_DOSTOP
 32

	)

81 
	#TIOCSER_TEMT
 0x01

	)

	@/usr/include/asm/semaphore.h

1 #i‚de‡
_I386_SEMAPHORE_H


2 
	#_I386_SEMAPHORE_H


	)

4 
	~<löux/lökage.h
>

6 #ifde‡
__KERNEL__


39 
	~<asm/sy°em.h
>

40 
	~<asm/©omic.h
>

41 
	~<löux/waô.h
>

42 
	~<löux/rw£m.h
>

44 
	s£m≠h‹e
 {

45 
©omic_t
 
	mcou¡
;

46 
	m¶ì≥rs
;

47 
waô_queue_hód_t
 
	mwaô
;

48 #ifde‡
WAITQUEUE_DEBUG


49 
	m__magic
;

53 #ifde‡
WAITQUEUE_DEBUG


54 
	#__SEM_DEBUG_INIT
(
«me
) \

55 , ()&(
«me
).
__magic


	)

57 
	#__SEM_DEBUG_INIT
(
«me
)

	)

60 
	#__SEMAPHORE_INITIALIZER
(
«me
,
cou¡
) \

61 { 
	`ATOMIC_INIT
(
cou¡
), 0, 
	`__WAIT_QUEUE_HEAD_INITIALIZER
((
«me
).
waô
) \

62 
	`__SEM_DEBUG_INIT
(
«me
Ë}

	)

64 
	#__MUTEX_INITIALIZER
(
«me
) \

65 
	`__SEMAPHORE_INITIALIZER
(
«me
,1)

	)

67 
	#__DECLARE_SEMAPHORE_GENERIC
(
«me
,
cou¡
) \

68 
£m≠h‹e
 
«me
 = 
	`__SEMAPHORE_INITIALIZER
“ame,
cou¡
)

	)

70 
	#DECLARE_MUTEX
(
«me
Ë
	`__DECLARE_SEMAPHORE_GENERIC
“ame,1)

	)

71 
	#DECLARE_MUTEX_LOCKED
(
«me
Ë
	`__DECLARE_SEMAPHORE_GENERIC
“ame,0)

	)

73 
ölöe
 
	$£ma_öô
 (
£m≠h‹e
 *
£m
, 
vÆ
)

81 
	`©omic_£t
(&
£m
->
cou¡
, 
vÆ
);

82 
£m
->
¶ì≥rs
 = 0;

83 
	`öô_waôqueue_hód
(&
£m
->
waô
);

84 #ifde‡
WAITQUEUE_DEBUG


85 
£m
->
__magic
 = ()&sem->__magic;

87 
	}
}

89 
ölöe
 
	$öô_MUTEX
 (
£m≠h‹e
 *
£m
)

91 
	`£ma_öô
(
£m
, 1);

92 
	}
}

94 
ölöe
 
	$öô_MUTEX_LOCKED
 (
£m≠h‹e
 *
£m
)

96 
	`£ma_öô
(
£m
, 0);

97 
	}
}

99 
asmlökage
 
__down_Áûed
();

100 
asmlökage
 
__down_Áûed_öãºu±ibÀ
();

101 
asmlökage
 
__down_Áûed_åylock
();

102 
asmlökage
 
__up_wakeup
();

104 
asmlökage
 
__down
(
£m≠h‹e
 * 
£m
);

105 
asmlökage
 
__down_öãºu±ibÀ
(
£m≠h‹e
 * 
£m
);

106 
asmlökage
 
__down_åylock
(
£m≠h‹e
 * 
£m
);

107 
asmlökage
 
__up
(
£m≠h‹e
 * 
£m
);

114 
ölöe
 
	$down
(
£m≠h‹e
 * 
£m
)

116 #ifde‡
WAITQUEUE_DEBUG


117 
	`CHECK_MAGIC
(
£m
->
__magic
);

119 
	`might_¶ìp
();

120 
__asm__
 
	`__vﬁ©ûe__
(

122 
LOCK
 "decl %0\n\t"

125 
	`LOCK_SECTION_START
("")

128 
LOCK_SECTION_END


129 :"=m" (
£m
->
cou¡
)

130 :"c" (
£m
)

132 
	}
}

138 
ölöe
 
	$down_öãºu±ibÀ
(
£m≠h‹e
 * 
£m
)

140 
ªsu…
;

142 #ifde‡
WAITQUEUE_DEBUG


143 
	`CHECK_MAGIC
(
£m
->
__magic
);

145 
	`might_¶ìp
();

146 
__asm__
 
	`__vﬁ©ûe__
(

148 
LOCK
 "decl %1\n\t"

152 
	`LOCK_SECTION_START
("")

155 
LOCK_SECTION_END


156 :"˜" (
ªsu…
), "=m" (
£m
->
cou¡
)

157 :"c" (
£m
)

159  
ªsu…
;

160 
	}
}

166 
ölöe
 
	$down_åylock
(
£m≠h‹e
 * 
£m
)

168 
ªsu…
;

170 #ifde‡
WAITQUEUE_DEBUG


171 
	`CHECK_MAGIC
(
£m
->
__magic
);

174 
__asm__
 
	`__vﬁ©ûe__
(

176 
LOCK
 "decl %1\n\t"

180 
	`LOCK_SECTION_START
("")

183 
LOCK_SECTION_END


184 :"˜" (
ªsu…
), "=m" (
£m
->
cou¡
)

185 :"c" (
£m
)

187  
ªsu…
;

188 
	}
}

196 
ölöe
 
	$up
(
£m≠h‹e
 * 
£m
)

198 #ifde‡
WAITQUEUE_DEBUG


199 
	`CHECK_MAGIC
(
£m
->
__magic
);

201 
__asm__
 
	`__vﬁ©ûe__
(

203 
LOCK
 "incl %0\n\t"

206 
	`LOCK_SECTION_START
("")

209 
LOCK_SECTION_END


211 :"=m" (
£m
->
cou¡
)

212 :"c" (
£m
)

214 
	}
}

	@/usr/include/asm/sigcontext.h

1 #i‚de‡
_ASMi386_SIGCONTEXT_H


2 
	#_ASMi386_SIGCONTEXT_H


	)

4 
	~<löux/compûî.h
>

20 
	s_Âªg
 {

21 
	msignifiˇnd
[4];

22 
	mexp⁄ít
;

25 
	s_Âxªg
 {

26 
	msignifiˇnd
[4];

27 
	mexp⁄ít
;

28 
	m∑ddög
[3];

31 
	s_xmmªg
 {

32 
	mñemít
[4];

35 
	s_Â°©e
 {

37 
	mcw
;

38 
	msw
;

39 
	mèg
;

40 
	mùoff
;

41 
	mcs£l
;

42 
	md©aoff
;

43 
	md©a£l
;

44 
_Âªg
 
	m_°
[8];

45 
	m°©us
;

46 
	mmagic
;

49 
	m_fx§_ív
[6];

50 
	mmxc§
;

51 
	mª£rved
;

52 
_Âxªg
 
	m_fx§_°
[8];

53 
_xmmªg
 
	m_xmm
[8];

54 
	m∑ddög
[56];

57 
	#X86_FXSR_MAGIC
 0x0000

	)

59 
	ssigc⁄ãxt
 {

60 
	mgs
, 
	m__gsh
;

61 
	mfs
, 
	m__fsh
;

62 
	mes
, 
	m__esh
;

63 
	mds
, 
	m__dsh
;

64 
	medi
;

65 
	mesi
;

66 
	mebp
;

67 
	me•
;

68 
	mebx
;

69 
	medx
;

70 
	mecx
;

71 
	móx
;

72 
	må≠no
;

73 
	mîr
;

74 
	meù
;

75 
	mcs
, 
	m__csh
;

76 
	meÊags
;

77 
	me•_©_sig«l
;

78 
	mss
, 
	m__ssh
;

79 
_Â°©e
 
__u£r
 * 
	mÂ°©e
;

80 
	mﬁdmask
;

81 
	m¸2
;

	@/usr/include/asm/socket.h

1 #i‚de‡
_ASM_SOCKET_H


2 
	#_ASM_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_KEEPALIVE
 9

	)

18 
	#SO_OOBINLINE
 10

	)

19 
	#SO_NO_CHECK
 11

	)

20 
	#SO_PRIORITY
 12

	)

21 
	#SO_LINGER
 13

	)

22 
	#SO_BSDCOMPAT
 14

	)

24 
	#SO_PASSCRED
 16

	)

25 
	#SO_PEERCRED
 17

	)

26 
	#SO_RCVLOWAT
 18

	)

27 
	#SO_SNDLOWAT
 19

	)

28 
	#SO_RCVTIMEO
 20

	)

29 
	#SO_SNDTIMEO
 21

	)

32 
	#SO_SECURITY_AUTHENTICATION
 22

	)

33 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

34 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

36 
	#SO_BINDTODEVICE
 25

	)

39 
	#SO_ATTACH_FILTER
 26

	)

40 
	#SO_DETACH_FILTER
 27

	)

42 
	#SO_PEERNAME
 28

	)

43 
	#SO_TIMESTAMP
 29

	)

44 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

46 
	#SO_ACCEPTCONN
 30

	)

49 #i‡
deföed
(
__KERNEL__
Ë|| !deföed(
__GLIBC__
) || (__GLIBC__ < 2)

51 
	#SOCK_STREAM
 1

	)

52 
	#SOCK_DGRAM
 2

	)

53 
	#SOCK_RAW
 3

	)

54 
	#SOCK_RDM
 4

	)

55 
	#SOCK_SEQPACKET
 5

	)

56 
	#SOCK_PACKET
 10

	)

61 
	#SOCK_MAX
 (
SOCK_PACKET
+1)

	)

	@/usr/include/asm/system.h

1 #i‚de‡
__ASM_SYSTEM_H


2 
	#__ASM_SYSTEM_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<löux/kî√l.h
>

6 
	~<asm/£gmít.h
>

7 
	~<asm/˝u„©uª.h
>

8 
	~<löux/bô›s.h
>

10 #ifde‡
__KERNEL__


12 
	gèsk_°ru˘
;

13 
èsk_°ru˘
 * 
FASTCALL
(
__swôch_to
(èsk_°ru˘ *
¥ev
, èsk_°ru˘ *
√xt
));

15 
	#swôch_to
(
¥ev
,
√xt
,
œ°
) do { \

16 
esi
,
edi
; \

17 
asm
 volatile("pushfl\n\t" \

27 :"=m" (
¥ev
->
thªad
.
e•
),"=m" (¥ev->thªad.
eù
), \

28 "˜" (
œ°
),"=S" (
esi
),"=D" (
edi
) \

29 :"m" (
√xt
->
thªad
.
e•
),"m" (√xt->thªad.
eù
), \

30 "2" (
¥ev
), "d" (
√xt
)); \

31 } 0)

	)

33 
	#_£t_ba£
(
addr
,
ba£
Ëdÿ{ 
__¥
; \

34 
__asm__
 
	`__vﬁ©ûe__
 ("movw %%dx,%1\n\t" \

38 :"=&d" (
__¥
) \

39 :"m" (*((
addr
)+2)), \

40 "m" (*((
addr
)+4)), \

41 "m" (*((
addr
)+7)), \

42 "0" (
ba£
) \

43 ); } 0)

	)

45 
	#_£t_limô
(
addr
,
limô
Ëdÿ{ 
__Ã
; \

46 
__asm__
 
	`__vﬁ©ûe__
 ("movw %%dx,%1\n\t" \

52 :"=&d" (
__Ã
) \

53 :"m" (*(
addr
)), \

54 "m" (*((
addr
)+6)), \

55 "0" (
limô
) \

56 ); } 0)

	)

58 
	#£t_ba£
(
ldt
,
ba£
Ë
	`_£t_ba£
–((*)&÷dt)Ë, (ba£Ë)

	)

59 
	#£t_limô
(
ldt
,
limô
Ë
	`_£t_limô
–((*)&÷dt)Ë, (÷imô)-1)>>12 )

	)

61 
ölöe
 
	$_gë_ba£
(* 
addr
)

63 
__ba£
;

64 
	`__asm__
("movb %3,%%dh\n\t"

68 :"=&d" (
__ba£
)

69 :"m" (*((
addr
)+2)),

70 "m" (*((
addr
)+4)),

71 "m" (*((
addr
)+7)));

72  
__ba£
;

73 
	}
}

75 
	#gë_ba£
(
ldt
Ë
	`_gë_ba£
–((*)&÷dt)Ë)

	)

81 
	#lﬂd£gmít
(
£g
,
vÆue
) \

82 
asm
 volatile("\n" \

96 : :"m" (*(*)&(
vÆue
)))

	)

101 
	#ßve£gmít
(
£g
, 
vÆue
) \

102 
asm
 vﬁ©ûe("mov»%%" #£g ",%0":"=m" (*(*)&(
vÆue
)))

	)

107 
	#˛ts
(Ë
__asm__
 
	`__vﬁ©ûe__
 ("˛ts")

	)

108 
	#ªad_¸0
() ({ \

109 
__dummy
; \

110 
	`__asm__
( \

112 :"Ù" (
__dummy
)); \

113 
__dummy
; \

114 })

	)

115 
	#wrôe_¸0
(
x
) \

116 
	`__asm__
("mov»%0,%%¸0": :"r" (
x
));

	)

118 
	#ªad_¸4
() ({ \

119 
__dummy
; \

120 
	`__asm__
( \

122 :"Ù" (
__dummy
)); \

123 
__dummy
; \

124 })

	)

125 
	#wrôe_¸4
(
x
) \

126 
	`__asm__
("mov»%0,%%¸4": :"r" (
x
));

	)

127 
	#°ts
(Ë
	`wrôe_¸0
(8 | 
	`ªad_¸0
())

	)

131 
	#wbövd
() \

132 
__asm__
 
	`__vﬁ©ûe__
 ("wbövd": : :"mem‹y");

	)

134 
ölöe
 
	$gë_limô
(
£gmít
)

136 
__limô
;

137 
	`__asm__
("lsll %1,%0"

138 :"Ù" (
__limô
):"r" (
£gmít
));

139  
__limô
+1;

140 
	}
}

142 
	#n›
(Ë
__asm__
 
	`__vﬁ©ûe__
 ("n›")

	)

144 
	#xchg
(
±r
,
v
Ë((
	`__ty≥of__
(*’å)))
	`__xchg
(()(v),’å),(*’å))))

	)

146 
	#ès
(
±r
Ë(
	`xchg
(’å),1))

	)

148 
	s__xchg_dummy
 { 
	ma
[100]; };

149 
	#__xg
(
x
Ë((
__xchg_dummy
 *)(x))

	)

166 
ölöe
 
	$__£t_64bô
 (* 
±r
,

167 
low
, 
high
)

169 
__asm__
 
	`__vﬁ©ûe__
 (

176 : "D"(
±r
),

177 "b"(
low
),

178 "c"(
high
)

180 
	}
}

182 
ölöe
 
	$__£t_64bô_c⁄°™t
 (*
±r
,

183 
vÆue
)

185 
	`__£t_64bô
(
±r
,()(
vÆue
), ()((value)>>32ULL));

186 
	}
}

187 
	#Œ_low
(
x
Ë*(((*)&(x))+0)

	)

188 
	#Œ_high
(
x
Ë*(((*)&(x))+1)

	)

190 
ölöe
 
	$__£t_64bô_v¨
 (*
±r
,

191 
vÆue
)

193 
	`__£t_64bô
(
±r
,
	`Œ_low
(
vÆue
), 
	`Œ_high
(value));

194 
	}
}

196 
	#£t_64bô
(
±r
,
vÆue
) \

197 (
	`__buûtö_c⁄°™t_p
(
vÆue
) ? \

198 
	`__£t_64bô_c⁄°™t
(
±r
, 
vÆue
) : \

199 
	`__£t_64bô_v¨
(
±r
, 
vÆue
Ë)

	)

201 
	#_£t_64bô
(
±r
,
vÆue
) \

202 (
	`__buûtö_c⁄°™t_p
(
vÆue
) ? \

203 
	`__£t_64bô
(
±r
, ()(
vÆue
), ()((value)>>32ULL) ) : \

204 
	`__£t_64bô
(
±r
, 
	`Œ_low
(
vÆue
), 
	`Œ_high
(vÆue)Ë)

	)

211 
ölöe
 
	$__xchg
(
x
, vﬁ©ûê* 
±r
, 
size
)

213 
size
) {

215 
__asm__
 
	`__vﬁ©ûe__
("xchgb %b0,%1"

216 :"=q" (
x
)

217 :"m" (*
	`__xg
(
±r
)), "0" (
x
)

221 
__asm__
 
	`__vﬁ©ûe__
("xchgw %w0,%1"

222 :"Ù" (
x
)

223 :"m" (*
	`__xg
(
±r
)), "0" (
x
)

227 
__asm__
 
	`__vﬁ©ûe__
("xchgl %0,%1"

228 :"Ù" (
x
)

229 :"m" (*
	`__xg
(
±r
)), "0" (
x
)

233  
x
;

234 
	}
}

242 #ifde‡
CONFIG_X86_CMPXCHG


243 
	#__HAVE_ARCH_CMPXCHG
 1

	)

245 
ölöe
 
	$__cmpxchg
(vﬁ©ûê*
±r
, 
ﬁd
,

246 
√w
, 
size
)

248 
¥ev
;

249 
size
) {

251 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgb %b1,%2"

252 : "˜"(
¥ev
)

253 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

255  
¥ev
;

257 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgw %w1,%2"

258 : "˜"(
¥ev
)

259 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

261  
¥ev
;

263 
__asm__
 
	`__vﬁ©ûe__
(
LOCK_PREFIX
 "cmpxchgl %1,%2"

264 : "˜"(
¥ev
)

265 : "q"(
√w
), "m"(*
	`__xg
(
±r
)), "0"(
ﬁd
)

267  
¥ev
;

269  
ﬁd
;

270 
	}
}

272 
	#cmpxchg
(
±r
,
o
,
n
)\

273 ((
	`__ty≥of__
(*(
±r
)))
	`__cmpxchg
(’å),()(
o
),\

274 ()(
n
),(*(
±r
))))

	)

280 #ifde‡
__KERNEL__


281 
	sÆt_ö°r
 {

282 
__u8
 *
	mö°r
;

283 
__u8
 *
	mª∂a˚mít
;

284 
__u8
 
	m˝uid
;

285 
__u8
 
	mö°æí
;

286 
__u8
 
	mª∂a˚míéí
;

287 
__u8
 
	m∑d
;

303 
	#Æã∫©ive
(
ﬁdö°r
, 
√wö°r
, 
„©uª
) \

304 
asm
 vﬁ©ûê("661:\n\t" 
ﬁdö°r
 "\n662:\n" \

314 "663:\n\t" 
√wö°r
 "\n664:\n" \

315 ".¥evious" :: "i" (
„©uª
Ë: "mem‹y")

	)

327 
	#Æã∫©ive_öput
(
ﬁdö°r
, 
√wö°r
, 
„©uª
, 
öput
) \

328 
asm
 vﬁ©ûê("661:\n\t" 
ﬁdö°r
 "\n662:\n" \

338 "663:\n\t" 
√wö°r
 "\n664:\n" \

339 ".¥evious" :: "i" (
„©uª
), 
öput
)

	)

365 
	#mb
(Ë
	`Æã∫©ive
("lock;ádd»$0,0(%%e•)", "m„n˚", 
X86_FEATURE_XMM2
)

	)

366 
	#rmb
(Ë
	`Æã∫©ive
("lock;ádd»$0,0(%%e•)", "l„n˚", 
X86_FEATURE_XMM2
)

	)

420 
	#ªad_b¨rõr_dïíds
(Ëdÿ{ } 0)

	)

422 #ifde‡
CONFIG_X86_OOSTORE


425 
	#wmb
(Ë
	`Æã∫©ive
("lock;ádd»$0,0(%%e•)", "s„n˚", 
X86_FEATURE_XMM
)

	)

427 
	#wmb
(Ë
__asm__
 
	`__vﬁ©ûe__
 ("": : :"mem‹y")

	)

430 #ifde‡
CONFIG_SMP


431 
	#smp_mb
(Ë
	`mb
()

	)

432 
	#smp_rmb
(Ë
	`rmb
()

	)

433 
	#smp_wmb
(Ë
	`wmb
()

	)

434 
	#smp_ªad_b¨rõr_dïíds
(Ë
	`ªad_b¨rõr_dïíds
()

	)

435 
	#£t_mb
(
v¨
, 
vÆue
Ëdÿ{ 
	`xchg
(&v¨, vÆue); } 0)

	)

437 
	#smp_mb
(Ë
	`b¨rõr
()

	)

438 
	#smp_rmb
(Ë
	`b¨rõr
()

	)

439 
	#smp_wmb
(Ë
	`b¨rõr
()

	)

440 
	#smp_ªad_b¨rõr_dïíds
(Ëdÿ{ } 0)

	)

441 
	#£t_mb
(
v¨
, 
vÆue
Ëdÿ{ v¨ = vÆue; 
	`b¨rõr
(); } 0)

	)

444 
	#£t_wmb
(
v¨
, 
vÆue
Ëdÿ{ v¨ = vÆue; 
	`wmb
(); } 0)

	)

447 
	#loˇl_ßve_Êags
(
x
Ëdÿ{ 
	`ty≥check
(,x); 
__asm__
 
	`__vﬁ©ûe__
("pushÊ ;Ö›»%0":"=g" (x): ); } 0)

	)

448 
	#loˇl_úq_ª°‹e
(
x
Ëdÿ{ 
	`ty≥check
(,x); 
__asm__
 
	`__vﬁ©ûe__
("push»%0 ;Ö›Ê": :"g" (x):"mem‹y", "cc"); } 0)

	)

449 
	#loˇl_úq_dißbÀ
(Ë
__asm__
 
	`__vﬁ©ûe__
("˛i": : :"mem‹y")

	)

450 
	#loˇl_úq_íabÀ
(Ë
__asm__
 
	`__vﬁ©ûe__
("°i": : :"mem‹y")

	)

452 
	#ß„_hÆt
(Ë
__asm__
 
	`__vﬁ©ûe__
("°i; h…": : :"mem‹y")

	)

454 
	#úqs_dißbÀd
() \

456 
Êags
; \

457 
	`loˇl_ßve_Êags
(
Êags
); \

458 !(
Êags
 & (1<<9)); \

459 })

	)

462 
	#loˇl_úq_ßve
(
x
Ë
__asm__
 
	`__vﬁ©ûe__
("pushÊ ;Ö›»%0 ; cli":"=g" (x): :"mem‹y")

	)

467 
	#HAVE_DISABLE_HLT


	)

468 
dißbÀ_h…
();

469 
íabÀ_h…
();

471 
dmi_brokí
;

472 
is_s⁄y_vaio_œ±›
;

474 
	#BROKEN_ACPI_Sx
 0x0001

	)

475 
	#BROKEN_INIT_AFTER_S1
 0x0002

	)

476 
	#BROKEN_PNP_BIOS
 0x0004

	)

477 
	#BROKEN_CPUFREQ
 0x0008

	)

	@/usr/include/bits/local_lim.h

25 #i‚de‡
NR_OPEN


26 
	#__undef_NR_OPEN


	)

28 #i‚de‡
LINK_MAX


29 
	#__undef_LINK_MAX


	)

31 #i‚de‡
OPEN_MAX


32 
	#__undef_OPEN_MAX


	)

36 
	~<löux/limôs.h
>

39 #ifde‡
__undef_NR_OPEN


40 #unde‡
NR_OPEN


41 #unde‡
__undef_NR_OPEN


44 #ifde‡
__undef_LINK_MAX


45 #unde‡
LINK_MAX


46 #unde‡
__undef_LINK_MAX


49 #ifde‡
__undef_OPEN_MAX


50 #unde‡
OPEN_MAX


51 #unde‡
__undef_OPEN_MAX


55 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

57 
	#PTHREAD_KEYS_MAX
 1024

	)

60 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

62 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

65 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

67 
	#PTHREAD_THREADS_MAX
 16384

	)

71 
	#AIO_PRIO_DELTA_MAX
 20

	)

74 
	#PTHREAD_STACK_MIN
 16384

	)

77 
	#TIMER_MAX
 256

	)

80 
	#DELAYTIMER_MAX
 2147483647

	)

83 
	#TTY_NAME_MAX
 32

	)

86 
	#LOGIN_NAME_MAX
 256

	)

	@/usr/include/bits/resource.h

20 #i‚de‡
_SYS_RESOURCE_H


24 
	~<bôs/ty≥s.h
>

32 
	e__æimô_ªsour˚


35 
	mRLIMIT_CPU
 = 0,

36 
	#RLIMIT_CPU
 
RLIMIT_CPU


	)

39 
	mRLIMIT_FSIZE
 = 1,

40 
	#RLIMIT_FSIZE
 
RLIMIT_FSIZE


	)

43 
	mRLIMIT_DATA
 = 2,

44 
	#RLIMIT_DATA
 
RLIMIT_DATA


	)

47 
	mRLIMIT_STACK
 = 3,

48 
	#RLIMIT_STACK
 
RLIMIT_STACK


	)

51 
	mRLIMIT_CORE
 = 4,

52 
	#RLIMIT_CORE
 
RLIMIT_CORE


	)

58 
	mRLIMIT_RSS
 = 5,

59 
	#RLIMIT_RSS
 
RLIMIT_RSS


	)

62 
	mRLIMIT_NOFILE
 = 7,

63 
	mRLIMIT_OFILE
 = 
RLIMIT_NOFILE
,

64 
	#RLIMIT_NOFILE
 
RLIMIT_NOFILE


	)

65 
	#RLIMIT_OFILE
 
RLIMIT_OFILE


	)

68 
	mRLIMIT_AS
 = 9,

69 
	#RLIMIT_AS
 
RLIMIT_AS


	)

72 
	mRLIMIT_NPROC
 = 6,

73 
	#RLIMIT_NPROC
 
RLIMIT_NPROC


	)

76 
	mRLIMIT_MEMLOCK
 = 8,

77 
	#RLIMIT_MEMLOCK
 
RLIMIT_MEMLOCK


	)

80 
	mRLIMIT_LOCKS
 = 10,

81 
	#RLIMIT_LOCKS
 
RLIMIT_LOCKS


	)

83 
	mRLIMIT_NLIMITS
 = 11,

84 
	mRLIM_NLIMITS
 = 
RLIMIT_NLIMITS


85 
	#RLIMIT_NLIMITS
 
RLIMIT_NLIMITS


	)

86 
	#RLIM_NLIMITS
 
RLIM_NLIMITS


	)

90 #i‚de‡
__USE_FILE_OFFSET64


91 
	#RLIM_INFINITY
 (()(~0UL))

	)

93 
	#RLIM_INFINITY
 0xffffffffffffffffuLL

	)

96 #ifde‡
__USE_LARGEFILE64


97 
	#RLIM64_INFINITY
 0xffffffffffffffffuLL

	)

101 
	#RLIM_SAVED_MAX
 
RLIM_INFINITY


	)

102 
	#RLIM_SAVED_CUR
 
RLIM_INFINITY


	)

106 #i‚de‡
__USE_FILE_OFFSET64


107 
__æim_t
 
	tæim_t
;

109 
__æim64_t
 
	tæim_t
;

111 #ifde‡
__USE_LARGEFILE64


112 
__æim64_t
 
	tæim64_t
;

115 
	sæimô


118 
æim_t
 
	mæim_cur
;

120 
æim_t
 
	mæim_max
;

123 #ifde‡
__USE_LARGEFILE64


124 
	sæimô64


127 
æim64_t
 
	mæim_cur
;

129 
æim64_t
 
	mæim_max
;

134 
	e__rußge_who


137 
	mRUSAGE_SELF
 = 0,

138 
	#RUSAGE_SELF
 
RUSAGE_SELF


	)

141 
	mRUSAGE_CHILDREN
 = -1,

142 
	#RUSAGE_CHILDREN
 
RUSAGE_CHILDREN


	)

145 
	mRUSAGE_BOTH
 = -2

146 
	#RUSAGE_BOTH
 
RUSAGE_BOTH


	)

149 
	#__√ed_timevÆ


	)

150 
	~<bôs/time.h
>

153 
	srußge


156 
timevÆ
 
	mru_utime
;

158 
timevÆ
 
	mru_°ime
;

160 
	mru_maxrss
;

163 
	mru_ixrss
;

165 
	mru_idrss
;

167 
	mru_i§ss
;

170 
	mru_möÊt
;

172 
	mru_majÊt
;

174 
	mru_nsw≠
;

177 
	mru_öblock
;

179 
	mru_oublock
;

181 
	mru_msg¢d
;

183 
	mru_msgrcv
;

185 
	mru_nsig«ls
;

189 
	mru_nvcsw
;

192 
	mru_nivcsw
;

196 
	#PRIO_MIN
 -20

	)

197 
	#PRIO_MAX
 20

	)

201 
	e__¥i‹ôy_which


203 
	mPRIO_PROCESS
 = 0,

204 
	#PRIO_PROCESS
 
PRIO_PROCESS


	)

205 
	mPRIO_PGRP
 = 1,

206 
	#PRIO_PGRP
 
PRIO_PGRP


	)

207 
	mPRIO_USER
 = 2

208 
	#PRIO_USER
 
PRIO_USER


	)

	@/usr/include/bits/sched.h

21 #i‚de‡
__√ed_sched∑øm


23 #i‚de‡
_SCHED_H


29 
	#SCHED_OTHER
 0

	)

30 
	#SCHED_FIFO
 1

	)

31 
	#SCHED_RR
 2

	)

33 #ifde‡
__USE_MISC


35 
	#CSIGNAL
 0x000000f‡

	)

36 
	#CLONE_VM
 0x00000100

	)

37 
	#CLONE_FS
 0x00000200

	)

38 
	#CLONE_FILES
 0x00000400

	)

39 
	#CLONE_SIGHAND
 0x00000800

	)

40 
	#CLONE_PTRACE
 0x00002000

	)

41 
	#CLONE_VFORK
 0x00004000

	)

43 
	#CLONE_PARENT
 0x00008000

	)

45 
	#CLONE_THREAD
 0x00010000

	)

46 
	#CLONE_NEWNS
 0x00020000

	)

47 
	#CLONE_SYSVSEM
 0x00040000

	)

48 
	#CLONE_SETTLS
 0x00080000

	)

49 
	#CLONE_PARENT_SETTID
 0x00100000

	)

51 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

53 
	#CLONE_DETACHED
 0x00400000

	)

54 
	#CLONE_UNTRACED
 0x00800000

	)

56 
	#CLONE_CHILD_SETTID
 0x01000000

	)

58 
	#CLONE_STOPPED
 0x02000000

	)

62 
	ssched_∑øm


64 
	m__sched_¥i‹ôy
;

67 
	g__BEGIN_DECLS


70 #ifde‡
__USE_MISC


71 
˛⁄e
 ((*
__‚
Ë(*
__¨g
), *
__chûd_°ack
,

72 
__Êags
, *
__¨g
Ë
__THROW
;

75 
__END_DECLS


79 #i‡!
deföed
 
__deföed_sched∑øm
 \

80 && (
deföed
 
__√ed_sched∑øm
 || deföed 
_SCHED_H
)

81 
	#__deföed_sched∑øm
 1

	)

83 
	s__sched_∑øm


85 
__sched_¥i‹ôy
;

87 #unde‡
__√ed_sched∑øm


91 #i‡
deföed
 
_SCHED_H
 && !deföed 
__˝u_£t_t_deföed


92 
	#__˝u_£t_t_deföed


	)

94 
	#__CPU_SETSIZE
 1024

	)

95 
	#__NCPUBITS
 (8 *  (
__˝u_mask
))

	)

98 
	t__˝u_mask
;

101 
	#__CPUELT
(
˝u
Ë((˝uË/ 
__NCPUBITS
)

	)

102 
	#__CPUMASK
(
˝u
Ë((
__˝u_mask
Ë1 << ((˝uË% 
__NCPUBITS
))

	)

107 
__˝u_mask
 
__bôs
[
__CPU_SETSIZE
 / 
__NCPUBITS
];

108 } 
	t˝u_£t_t
;

111 
	#__CPU_ZERO
(
˝u£ç
) \

113 
__i
; \

114 
˝u_£t_t
 *
__¨r
 = (
˝u£ç
); \

115 
__i
 = 0; __ò<  (
˝u_£t_t
Ë/  (
__˝u_mask
); ++__i) \

116 
__¨r
->
__bôs
[
__i
] = 0; \

117 
	}
} 0)

	)

118 
	#__CPU_SET
(
˝u
, 
˝u£ç
) \

119 ((
˝u£ç
)->
__bôs
[
	`__CPUELT
 (
˝u
)] |
	`__CPUMASK
 (˝u))

	)

120 
	#__CPU_CLR
(
˝u
, 
˝u£ç
) \

121 ((
˝u£ç
)->
__bôs
[
	`__CPUELT
 (
˝u
)] &~
	`__CPUMASK
 (˝u))

	)

122 
	#__CPU_ISSET
(
˝u
, 
˝u£ç
) \

123 (((
˝u£ç
)->
__bôs
[
	`__CPUELT
 (
˝u
)] & 
	`__CPUMASK
 (˝u)Ë!0)

	)

	@/usr/include/bits/stdio-lock.h

20 #i‚de‡
_BITS_STDIO_LOCK_H


21 
	#_BITS_STDIO_LOCK_H
 1

	)

23 
	~<bôs/libc-lock.h
>

25 
	$__libc_lock_deföe_ªcursive
 (, 
_IO_lock_t
)

28 #ifde‡
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


29 
	t_IO_lock_öôülizî
 
	t_LIBC_LOCK_RECURSIVE_INITIALIZER


	)

30 #ñi‡
	t_IO_MTSAFE_IO


31 #îr‹ 
	tlibio
 
	t√eds
 
	tªcursive
 
	tmuãxes
 
	t_IO_MTSAFE_IO


34 
	t_IO_lock_öô
(
	t_«me
Ë
	t__libc_lock_öô_ªcursive
 (_«me)

	)

35 
	t_IO_lock_föi
(
	t_«me
Ë
	t__libc_lock_föi_ªcursive
 (_«me)

	)

36 
	t_IO_lock_lock
(
	t_«me
Ë
	t__libc_lock_lock_ªcursive
 (_«me)

	)

37 
	t_IO_lock_åylock
(
	t_«me
Ë
	t__libc_lock_åylock_ªcursive
 (_«me)

	)

38 
	t_IO_lock_u∆ock
(
	t_«me
Ë
	t__libc_lock_u∆ock_ªcursive
 (_«me)

	)

41 
	t_IO_˛ónup_ªgi⁄_°¨t
(
	t_f˘
, 
	t_Â
) \

42 
	t__libc_˛ónup_ªgi⁄_°¨t
 (((
	t_Â
)->
	t_Êags
 & 
	t_IO_USER_LOCK
Ë=0, 
	t_f˘
, _Â)

	)

43 
	t_IO_˛ónup_ªgi⁄_°¨t_nﬂrg
(
	t_f˘
) \

44 
	t__libc_˛ónup_ªgi⁄_°¨t
 (1, 
	t_f˘
, 
	tNULL
)

	)

45 
	t_IO_˛ónup_ªgi⁄_íd
(
	t_doô
) \

46 
	t__libc_˛ónup_ªgi⁄_íd
 (
	t_doô
)

	)

48 #i‡
	tdeföed
 
	t_LIBC
 && !deföed 
	tNOT_IN_libc


49 
	t_IO_acquúe_lock
(
	t_Â
) \

50 
	t_IO_˛ónup_ªgi⁄_°¨t
 (((*Ë(*)Ë
	t_IO_fu∆ockfûe
, (
	t_Â
)); \

51 
	`_IO_Êockfûe
 (
_Â
)

	)

53 
	#_IO_ªÀa£_lock
(
_Â
) \

54 
	`_IO_fu∆ockfûe
 (
_Â
); \

55 
	`_IO_˛ónup_ªgi⁄_íd
 (0)

	)

	@/usr/include/bits/typesizes.h

20 #i‚de‡
_BITS_TYPES_H


24 #i‚def 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 
__S32_TYPE


	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 såu˘ { 
__vÆ
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/wchar.h

20 #i‚de‡
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

23 
	#__WCHAR_MIN
 (-2147483647»- 1l)

	)

24 
	#__WCHAR_MAX
 (2147483647l)

	)

	@/usr/include/gnu/stubs.h

6 #ifde‡
_LIBC


7 #îr‹ 
Aµliˇti⁄s
 
may
 
nŸ
 
deföe
 
the
 
ma¸o
 
_LIBC


10 
	#__°ub___kî√l_co¶


	)

11 
	#__°ub___kî√l_söl


	)

12 
	#__°ub___kî√l_è∆


	)

13 
	#__°ub_chÊags


	)

14 
	#__°ub_Áâach


	)

15 
	#__°ub_fchÊags


	)

16 
	#__°ub_fdëach


	)

17 
	#__°ub_gây


	)

18 
	#__°ub_lchmod


	)

19 
	#__°ub_lutimes


	)

20 
	#__°ub_ªvoke


	)

21 
	#__°ub_£éogö


	)

22 
	#__°ub_s°k


	)

23 
	#__°ub_°ty


	)

	@/usr/include/linux/autoconf.h

4 
	#AUTOCONF_INCLUDED


	)

5 
	#CONFIG_X86
 1

	)

6 
	#CONFIG_MMU
 1

	)

7 
	#CONFIG_UID16
 1

	)

8 
	#CONFIG_GENERIC_ISA_DMA
 1

	)

13 
	#CONFIG_EXPERIMENTAL
 1

	)

14 
	#CONFIG_CLEAN_COMPILE
 1

	)

15 
	#CONFIG_STANDALONE
 1

	)

20 
	#CONFIG_SWAP
 1

	)

21 
	#CONFIG_SYSVIPC
 1

	)

22 #unde‡
CONFIG_BSD_PROCESS_ACCT


23 
	#CONFIG_SYSCTL
 1

	)

24 
	#CONFIG_LOG_BUF_SHIFT
 15

	)

25 #unde‡
CONFIG_IKCONFIG


26 #unde‡
CONFIG_EMBEDDED


27 
	#CONFIG_KALLSYMS
 1

	)

28 
	#CONFIG_FUTEX
 1

	)

29 
	#CONFIG_EPOLL
 1

	)

30 
	#CONFIG_IOSCHED_NOOP
 1

	)

31 
	#CONFIG_IOSCHED_AS
 1

	)

32 
	#CONFIG_IOSCHED_DEADLINE
 1

	)

37 
	#CONFIG_MODULES
 1

	)

38 #unde‡
CONFIG_MODULE_UNLOAD


39 
	#CONFIG_OBSOLETE_MODPARM
 1

	)

40 #unde‡
CONFIG_MODVERSIONS


41 
	#CONFIG_KMOD
 1

	)

46 
	#CONFIG_X86_PC
 1

	)

47 #unde‡
CONFIG_X86_VOYAGER


48 #unde‡
CONFIG_X86_NUMAQ


49 #unde‡
CONFIG_X86_SUMMIT


50 #unde‡
CONFIG_X86_BIGSMP


51 #unde‡
CONFIG_X86_VISWS


52 #unde‡
CONFIG_X86_GENERICARCH


53 #unde‡
CONFIG_X86_ES7000


54 #unde‡
CONFIG_M386


55 #unde‡
CONFIG_M486


56 #unde‡
CONFIG_M586


57 #unde‡
CONFIG_M586TSC


58 #unde‡
CONFIG_M586MMX


59 #unde‡
CONFIG_M686


60 #unde‡
CONFIG_MPENTIUMII


61 #unde‡
CONFIG_MPENTIUMIII


62 
	#CONFIG_MPENTIUM4
 1

	)

63 #unde‡
CONFIG_MK6


64 #unde‡
CONFIG_MK7


65 #unde‡
CONFIG_MK8


66 #unde‡
CONFIG_MELAN


67 #unde‡
CONFIG_MCRUSOE


68 #unde‡
CONFIG_MWINCHIPC6


69 #unde‡
CONFIG_MWINCHIP2


70 #unde‡
CONFIG_MWINCHIP3D


71 #unde‡
CONFIG_MCYRIXIII


72 #unde‡
CONFIG_MVIAC3_2


73 #unde‡
CONFIG_X86_GENERIC


74 
	#CONFIG_X86_CMPXCHG
 1

	)

75 
	#CONFIG_X86_XADD
 1

	)

76 
	#CONFIG_X86_L1_CACHE_SHIFT
 7

	)

77 
	#CONFIG_RWSEM_XCHGADD_ALGORITHM
 1

	)

78 
	#CONFIG_X86_WP_WORKS_OK
 1

	)

79 
	#CONFIG_X86_INVLPG
 1

	)

80 
	#CONFIG_X86_BSWAP
 1

	)

81 
	#CONFIG_X86_POPAD_OK
 1

	)

82 
	#CONFIG_X86_GOOD_APIC
 1

	)

83 
	#CONFIG_X86_INTEL_USERCOPY
 1

	)

84 
	#CONFIG_X86_USE_PPRO_CHECKSUM
 1

	)

85 #unde‡
CONFIG_HPET_TIMER


86 #unde‡
CONFIG_HPET_EMULATE_RTC


87 
	#CONFIG_SMP
 1

	)

88 
	#CONFIG_NR_CPUS
 8

	)

89 
	#CONFIG_PREEMPT
 1

	)

90 
	#CONFIG_X86_LOCAL_APIC
 1

	)

91 
	#CONFIG_X86_IO_APIC
 1

	)

92 
	#CONFIG_X86_TSC
 1

	)

93 
	#CONFIG_X86_MCE
 1

	)

94 
	#CONFIG_X86_MCE_NONFATAL
 1

	)

95 
	#CONFIG_X86_MCE_P4THERMAL
 1

	)

96 #unde‡
CONFIG_TOSHIBA


97 #unde‡
CONFIG_I8K


98 #unde‡
CONFIG_MICROCODE


99 #unde‡
CONFIG_X86_MSR


100 #unde‡
CONFIG_X86_CPUID


101 #unde‡
CONFIG_EDD


102 
	#CONFIG_NOHIGHMEM
 1

	)

103 #unde‡
CONFIG_HIGHMEM4G


104 #unde‡
CONFIG_HIGHMEM64G


105 #unde‡
CONFIG_MATH_EMULATION


106 
	#CONFIG_MTRR
 1

	)

107 
	#CONFIG_HAVE_DEC_LOCK
 1

	)

112 
	#CONFIG_PM
 1

	)

113 #unde‡
CONFIG_SOFTWARE_SUSPEND


114 #unde‡
CONFIG_PM_DISK


119 
	#CONFIG_ACPI
 1

	)

120 
	#CONFIG_ACPI_BOOT
 1

	)

121 
	#CONFIG_ACPI_INTERPRETER
 1

	)

122 
	#CONFIG_ACPI_SLEEP
 1

	)

123 
	#CONFIG_ACPI_SLEEP_PROC_FS
 1

	)

124 
	#CONFIG_ACPI_AC
 1

	)

125 
	#CONFIG_ACPI_BATTERY
 1

	)

126 
	#CONFIG_ACPI_BUTTON
 1

	)

127 
	#CONFIG_ACPI_FAN
 1

	)

128 
	#CONFIG_ACPI_PROCESSOR
 1

	)

129 
	#CONFIG_ACPI_THERMAL
 1

	)

130 #unde‡
CONFIG_ACPI_ASUS


131 #unde‡
CONFIG_ACPI_TOSHIBA


132 #unde‡
CONFIG_ACPI_DEBUG


133 
	#CONFIG_ACPI_BUS
 1

	)

134 
	#CONFIG_ACPI_EC
 1

	)

135 
	#CONFIG_ACPI_POWER
 1

	)

136 
	#CONFIG_ACPI_PCI
 1

	)

137 
	#CONFIG_ACPI_SYSTEM
 1

	)

138 #unde‡
CONFIG_ACPI_RELAXED_AML


143 #unde‡
CONFIG_APM


148 #unde‡
CONFIG_CPU_FREQ


153 
	#CONFIG_PCI
 1

	)

154 #unde‡
CONFIG_PCI_GOBIOS


155 #unde‡
CONFIG_PCI_GODIRECT


156 
	#CONFIG_PCI_GOANY
 1

	)

157 
	#CONFIG_PCI_BIOS
 1

	)

158 
	#CONFIG_PCI_DIRECT
 1

	)

159 
	#CONFIG_PCI_LEGACY_PROC
 1

	)

160 
	#CONFIG_PCI_NAMES
 1

	)

161 
	#CONFIG_ISA
 1

	)

162 #unde‡
CONFIG_EISA


163 #unde‡
CONFIG_MCA


164 #unde‡
CONFIG_SCx200


165 
	#CONFIG_HOTPLUG
 1

	)

170 #unde‡
CONFIG_PCMCIA


171 
	#CONFIG_PCMCIA_PROBE
 1

	)

176 #unde‡
CONFIG_HOTPLUG_PCI


181 
	#CONFIG_BINFMT_ELF
 1

	)

182 
	#CONFIG_BINFMT_AOUT
 1

	)

183 
	#CONFIG_BINFMT_MISC
 1

	)

192 #unde‡
CONFIG_FW_LOADER


197 #unde‡
CONFIG_MTD


202 
	#CONFIG_PARPORT
 1

	)

203 
	#CONFIG_PARPORT_PC
 1

	)

204 
	#CONFIG_PARPORT_PC_CML1
 1

	)

205 #unde‡
CONFIG_PARPORT_SERIAL


206 #unde‡
CONFIG_PARPORT_PC_FIFO


207 #unde‡
CONFIG_PARPORT_PC_SUPERIO


208 #unde‡
CONFIG_PARPORT_OTHER


209 #unde‡
CONFIG_PARPORT_1284


214 
	#CONFIG_PNP
 1

	)

215 #unde‡
CONFIG_PNP_DEBUG


220 #unde‡
CONFIG_ISAPNP


221 #unde‡
CONFIG_PNPBIOS


226 
	#CONFIG_BLK_DEV_FD
 1

	)

227 #unde‡
CONFIG_BLK_DEV_XD


228 #unde‡
CONFIG_PARIDE


229 #unde‡
CONFIG_BLK_CPQ_DA


230 #unde‡
CONFIG_BLK_CPQ_CISS_DA


231 #unde‡
CONFIG_BLK_DEV_DAC960


232 #unde‡
CONFIG_BLK_DEV_UMEM


233 #unde‡
CONFIG_BLK_DEV_LOOP


234 #unde‡
CONFIG_BLK_DEV_NBD


235 #unde‡
CONFIG_BLK_DEV_RAM


236 #unde‡
CONFIG_BLK_DEV_INITRD


237 
	#CONFIG_LBD
 1

	)

242 
	#CONFIG_IDE
 1

	)

243 
	#CONFIG_BLK_DEV_IDE
 1

	)

248 #unde‡
CONFIG_BLK_DEV_HD_IDE


249 
	#CONFIG_BLK_DEV_IDEDISK
 1

	)

250 
	#CONFIG_IDEDISK_MULTI_MODE
 1

	)

251 #unde‡
CONFIG_IDEDISK_STROKE


252 
	#CONFIG_BLK_DEV_IDECD
 1

	)

253 #unde‡
CONFIG_BLK_DEV_IDETAPE


254 #unde‡
CONFIG_BLK_DEV_IDEFLOPPY


255 #unde‡
CONFIG_BLK_DEV_IDESCSI


256 #unde‡
CONFIG_IDE_TASK_IOCTL


257 
	#CONFIG_IDE_TASKFILE_IO
 1

	)

262 
	#CONFIG_BLK_DEV_CMD640
 1

	)

263 #unde‡
CONFIG_BLK_DEV_CMD640_ENHANCED


264 #unde‡
CONFIG_BLK_DEV_IDEPNP


265 
	#CONFIG_BLK_DEV_IDEPCI
 1

	)

266 
	#CONFIG_IDEPCI_SHARE_IRQ
 1

	)

267 #unde‡
CONFIG_BLK_DEV_OFFBOARD


268 
	#CONFIG_BLK_DEV_GENERIC
 1

	)

269 #unde‡
CONFIG_BLK_DEV_OPTI621


270 
	#CONFIG_BLK_DEV_RZ1000
 1

	)

271 
	#CONFIG_BLK_DEV_IDEDMA_PCI
 1

	)

272 #unde‡
CONFIG_BLK_DEV_IDE_TCQ


273 #unde‡
CONFIG_BLK_DEV_IDEDMA_FORCED


274 
	#CONFIG_IDEDMA_PCI_AUTO
 1

	)

275 #unde‡
CONFIG_IDEDMA_ONLYDISK


276 #unde‡
CONFIG_IDEDMA_PCI_WIP


277 
	#CONFIG_BLK_DEV_ADMA
 1

	)

278 #unde‡
CONFIG_BLK_DEV_AEC62XX


279 #unde‡
CONFIG_BLK_DEV_ALI15X3


280 #unde‡
CONFIG_BLK_DEV_AMD74XX


281 #unde‡
CONFIG_BLK_DEV_CMD64X


282 #unde‡
CONFIG_BLK_DEV_TRIFLEX


283 #unde‡
CONFIG_BLK_DEV_CY82C693


284 #unde‡
CONFIG_BLK_DEV_CS5520


285 #unde‡
CONFIG_BLK_DEV_CS5530


286 #unde‡
CONFIG_BLK_DEV_HPT34X


287 #unde‡
CONFIG_BLK_DEV_HPT366


288 #unde‡
CONFIG_BLK_DEV_SC1200


289 
	#CONFIG_BLK_DEV_PIIX
 1

	)

290 #unde‡
CONFIG_BLK_DEV_NS87415


291 #unde‡
CONFIG_BLK_DEV_PDC202XX_OLD


292 #unde‡
CONFIG_BLK_DEV_PDC202XX_NEW


293 #unde‡
CONFIG_BLK_DEV_SVWKS


294 #unde‡
CONFIG_BLK_DEV_SIIMAGE


295 #unde‡
CONFIG_BLK_DEV_SIS5513


296 #unde‡
CONFIG_BLK_DEV_SLC90E66


297 #unde‡
CONFIG_BLK_DEV_TRM290


298 #unde‡
CONFIG_BLK_DEV_VIA82CXXX


299 #unde‡
CONFIG_IDE_CHIPSETS


300 
	#CONFIG_BLK_DEV_IDEDMA
 1

	)

301 #unde‡
CONFIG_IDEDMA_IVB


302 
	#CONFIG_IDEDMA_AUTO
 1

	)

303 #unde‡
CONFIG_DMA_NONPCI


304 #unde‡
CONFIG_BLK_DEV_HD


309 
	#CONFIG_SCSI
 1

	)

310 
	#CONFIG_SCSI_PROC_FS
 1

	)

315 
	#CONFIG_BLK_DEV_SD
 1

	)

316 #unde‡
CONFIG_CHR_DEV_ST


317 #unde‡
CONFIG_CHR_DEV_OSST


318 #unde‡
CONFIG_BLK_DEV_SR


319 
	#CONFIG_CHR_DEV_SG
 1

	)

324 #unde‡
CONFIG_SCSI_MULTI_LUN


325 
	#CONFIG_SCSI_REPORT_LUNS
 1

	)

326 #unde‡
CONFIG_SCSI_CONSTANTS


327 #unde‡
CONFIG_SCSI_LOGGING


332 #unde‡
CONFIG_BLK_DEV_3W_XXXX_RAID


333 #unde‡
CONFIG_SCSI_7000FASST


334 #unde‡
CONFIG_SCSI_ACARD


335 #unde‡
CONFIG_SCSI_AHA152X


336 #unde‡
CONFIG_SCSI_AHA1542


337 #unde‡
CONFIG_SCSI_AACRAID


338 #unde‡
CONFIG_SCSI_AIC7XXX


339 #unde‡
CONFIG_SCSI_AIC7XXX_OLD


340 #unde‡
CONFIG_SCSI_AIC79XX


341 #unde‡
CONFIG_SCSI_ADVANSYS


342 #unde‡
CONFIG_SCSI_IN2000


343 #unde‡
CONFIG_SCSI_MEGARAID


344 #unde‡
CONFIG_SCSI_BUSLOGIC


345 #unde‡
CONFIG_SCSI_CPQFCTS


346 #unde‡
CONFIG_SCSI_DMX3191D


347 #unde‡
CONFIG_SCSI_DTC3280


348 #unde‡
CONFIG_SCSI_EATA


349 #unde‡
CONFIG_SCSI_EATA_PIO


350 #unde‡
CONFIG_SCSI_FUTURE_DOMAIN


351 #unde‡
CONFIG_SCSI_GDTH


352 #unde‡
CONFIG_SCSI_GENERIC_NCR5380


353 #unde‡
CONFIG_SCSI_GENERIC_NCR5380_MMIO


354 #unde‡
CONFIG_SCSI_IPS


355 #unde‡
CONFIG_SCSI_INIA100


356 #unde‡
CONFIG_SCSI_PPA


357 #unde‡
CONFIG_SCSI_IMM


358 #unde‡
CONFIG_SCSI_NCR53C406A


359 #unde‡
CONFIG_SCSI_SYM53C8XX_2


360 #unde‡
CONFIG_SCSI_PAS16


361 #unde‡
CONFIG_SCSI_PSI240I


362 #unde‡
CONFIG_SCSI_QLOGIC_FAS


363 #unde‡
CONFIG_SCSI_QLOGIC_ISP


364 #unde‡
CONFIG_SCSI_QLOGIC_FC


365 #unde‡
CONFIG_SCSI_QLOGIC_1280


366 #unde‡
CONFIG_SCSI_SYM53C416


367 #unde‡
CONFIG_SCSI_DC395x


368 #unde‡
CONFIG_SCSI_T128


369 #unde‡
CONFIG_SCSI_U14_34F


370 #unde‡
CONFIG_SCSI_ULTRASTOR


371 #unde‡
CONFIG_SCSI_NSP32


372 #unde‡
CONFIG_SCSI_DEBUG


377 #unde‡
CONFIG_CD_NO_IDESCSI


382 #unde‡
CONFIG_MD


387 #unde‡
CONFIG_FUSION


392 
	#CONFIG_IEEE1394
 1

	)

397 #unde‡
CONFIG_IEEE1394_VERBOSEDEBUG


398 #unde‡
CONFIG_IEEE1394_OUI_DB


407 
	#CONFIG_IEEE1394_OHCI1394
 1

	)

412 #unde‡
CONFIG_IEEE1394_VIDEO1394


413 #unde‡
CONFIG_IEEE1394_SBP2


414 #unde‡
CONFIG_IEEE1394_ETH1394


415 #unde‡
CONFIG_IEEE1394_DV1394


416 #unde‡
CONFIG_IEEE1394_RAWIO


417 #unde‡
CONFIG_IEEE1394_CMP


422 #unde‡
CONFIG_I2O


427 
	#CONFIG_NET
 1

	)

432 
	#CONFIG_PACKET
 1

	)

433 #unde‡
CONFIG_PACKET_MMAP


434 #unde‡
CONFIG_NETLINK_DEV


435 
	#CONFIG_UNIX
 1

	)

436 #unde‡
CONFIG_NET_KEY


437 
	#CONFIG_INET
 1

	)

438 
	#CONFIG_IP_MULTICAST
 1

	)

439 #unde‡
CONFIG_IP_ADVANCED_ROUTER


440 #unde‡
CONFIG_IP_PNP


441 #unde‡
CONFIG_NET_IPIP


442 #unde‡
CONFIG_NET_IPGRE


443 #unde‡
CONFIG_IP_MROUTE


444 #unde‡
CONFIG_ARPD


445 #unde‡
CONFIG_INET_ECN


446 #unde‡
CONFIG_SYN_COOKIES


447 #unde‡
CONFIG_INET_AH


448 #unde‡
CONFIG_INET_ESP


449 #unde‡
CONFIG_INET_IPCOMP


450 #unde‡
CONFIG_IPV6


451 #unde‡
CONFIG_DECNET


452 #unde‡
CONFIG_BRIDGE


453 #unde‡
CONFIG_NETFILTER


458 
	#CONFIG_IPV6_SCTP__
 1

	)

459 #unde‡
CONFIG_IP_SCTP


460 #unde‡
CONFIG_ATM


461 #unde‡
CONFIG_VLAN_8021Q


462 #unde‡
CONFIG_LLC2


463 #unde‡
CONFIG_IPX


464 #unde‡
CONFIG_ATALK


465 #unde‡
CONFIG_X25


466 #unde‡
CONFIG_LAPB


467 #unde‡
CONFIG_NET_DIVERT


468 #unde‡
CONFIG_ECONET


469 #unde‡
CONFIG_WAN_ROUTER


470 #unde‡
CONFIG_NET_FASTROUTE


471 #unde‡
CONFIG_NET_HW_FLOWCONTROL


476 #unde‡
CONFIG_NET_SCHED


481 #unde‡
CONFIG_NET_PKTGEN


482 
	#CONFIG_NETDEVICES
 1

	)

487 #unde‡
CONFIG_ARCNET


488 
	#CONFIG_DUMMY_MODULE
 1

	)

489 #unde‡
CONFIG_BONDING


490 #unde‡
CONFIG_EQUALIZER


491 #unde‡
CONFIG_TUN


492 #unde‡
CONFIG_NET_SB1000


497 
	#CONFIG_NET_ETHERNET
 1

	)

498 
	#CONFIG_MII
 1

	)

499 #unde‡
CONFIG_HAPPYMEAL


500 #unde‡
CONFIG_SUNGEM


501 #unde‡
CONFIG_NET_VENDOR_3COM


502 #unde‡
CONFIG_LANCE


503 #unde‡
CONFIG_NET_VENDOR_SMC


504 #unde‡
CONFIG_NET_VENDOR_RACAL


509 #unde‡
CONFIG_NET_TULIP


510 #unde‡
CONFIG_AT1700


511 #unde‡
CONFIG_DEPCA


512 #unde‡
CONFIG_HP100


513 #unde‡
CONFIG_NET_ISA


514 
	#CONFIG_NET_PCI
 1

	)

515 #unde‡
CONFIG_PCNET32


516 #unde‡
CONFIG_AMD8111_ETH


517 #unde‡
CONFIG_ADAPTEC_STARFIRE


518 #unde‡
CONFIG_AC3200


519 #unde‡
CONFIG_APRICOT


520 #unde‡
CONFIG_B44


521 #unde‡
CONFIG_CS89x0


522 #unde‡
CONFIG_DGRS


523 #unde‡
CONFIG_EEPRO100


524 #unde‡
CONFIG_E100


525 #unde‡
CONFIG_FEALNX


526 #unde‡
CONFIG_NATSEMI


527 #unde‡
CONFIG_NE2K_PCI


528 #unde‡
CONFIG_8139CP


529 
	#CONFIG_8139TOO
 1

	)

530 #unde‡
CONFIG_8139TOO_PIO


531 #unde‡
CONFIG_8139TOO_TUNE_TWISTER


532 #unde‡
CONFIG_8139TOO_8129


533 #unde‡
CONFIG_8139_OLD_RX_RESET


534 #unde‡
CONFIG_SIS900


535 #unde‡
CONFIG_EPIC100


536 #unde‡
CONFIG_SUNDANCE


537 #unde‡
CONFIG_TLAN


538 #unde‡
CONFIG_VIA_RHINE


539 #unde‡
CONFIG_NET_POCKET


544 #unde‡
CONFIG_ACENIC


545 #unde‡
CONFIG_DL2K


546 #unde‡
CONFIG_E1000


547 #unde‡
CONFIG_NS83820


548 #unde‡
CONFIG_HAMACHI


549 #unde‡
CONFIG_YELLOWFIN


550 #unde‡
CONFIG_R8169


551 #unde‡
CONFIG_SIS190


552 #unde‡
CONFIG_SK98LIN


553 #unde‡
CONFIG_TIGON3


558 #unde‡
CONFIG_IXGB


559 #unde‡
CONFIG_FDDI


560 #unde‡
CONFIG_HIPPI


561 #unde‡
CONFIG_PLIP


562 #unde‡
CONFIG_PPP


563 #unde‡
CONFIG_SLIP


568 #unde‡
CONFIG_NET_RADIO


573 #unde‡
CONFIG_TR


574 #unde‡
CONFIG_NET_FC


575 #unde‡
CONFIG_RCPCI


576 #unde‡
CONFIG_SHAPER


581 #unde‡
CONFIG_WAN


586 #unde‡
CONFIG_HAMRADIO


591 #unde‡
CONFIG_IRDA


596 #unde‡
CONFIG_BT


601 #unde‡
CONFIG_ISDN_BOOL


606 #unde‡
CONFIG_PHONE


611 
	#CONFIG_INPUT
 1

	)

616 
	#CONFIG_INPUT_MOUSEDEV
 1

	)

617 
	#CONFIG_INPUT_MOUSEDEV_PSAUX
 1

	)

618 
	#CONFIG_INPUT_MOUSEDEV_SCREEN_X
 1024

	)

619 
	#CONFIG_INPUT_MOUSEDEV_SCREEN_Y
 768

	)

620 #unde‡
CONFIG_INPUT_JOYDEV


621 #unde‡
CONFIG_INPUT_TSDEV


622 #unde‡
CONFIG_INPUT_EVDEV


623 #unde‡
CONFIG_INPUT_EVBUG


628 #unde‡
CONFIG_GAMEPORT


629 
	#CONFIG_SOUND_GAMEPORT
 1

	)

630 
	#CONFIG_SERIO
 1

	)

631 
	#CONFIG_SERIO_I8042
 1

	)

632 #unde‡
CONFIG_SERIO_SERPORT


633 #unde‡
CONFIG_SERIO_CT82C710


634 #unde‡
CONFIG_SERIO_PARKBD


635 #unde‡
CONFIG_SERIO_PCIPS2


640 
	#CONFIG_INPUT_KEYBOARD
 1

	)

641 
	#CONFIG_KEYBOARD_ATKBD
 1

	)

642 #unde‡
CONFIG_KEYBOARD_SUNKBD


643 #unde‡
CONFIG_KEYBOARD_XTKBD


644 #unde‡
CONFIG_KEYBOARD_NEWTON


645 
	#CONFIG_INPUT_MOUSE
 1

	)

646 
	#CONFIG_MOUSE_PS2
 1

	)

647 #unde‡
CONFIG_MOUSE_PS2_SYNAPTICS


648 #unde‡
CONFIG_MOUSE_SERIAL


649 #unde‡
CONFIG_MOUSE_INPORT


650 #unde‡
CONFIG_MOUSE_LOGIBM


651 #unde‡
CONFIG_MOUSE_PC110PAD


652 #unde‡
CONFIG_INPUT_JOYSTICK


653 #unde‡
CONFIG_INPUT_TOUCHSCREEN


654 #unde‡
CONFIG_INPUT_MISC


659 
	#CONFIG_VT
 1

	)

660 
	#CONFIG_VT_CONSOLE
 1

	)

661 
	#CONFIG_HW_CONSOLE
 1

	)

662 #unde‡
CONFIG_SERIAL_NONSTANDARD


667 
	#CONFIG_SERIAL_8250
 1

	)

668 #unde‡
CONFIG_SERIAL_8250_CONSOLE


669 #unde‡
CONFIG_SERIAL_8250_ACPI


670 
	#CONFIG_SERIAL_8250_NR_UARTS
 4

	)

671 #unde‡
CONFIG_SERIAL_8250_EXTENDED


676 
	#CONFIG_SERIAL_CORE
 1

	)

677 
	#CONFIG_UNIX98_PTYS
 1

	)

678 
	#CONFIG_UNIX98_PTY_COUNT
 256

	)

679 
	#CONFIG_PRINTER
 1

	)

680 #unde‡
CONFIG_LP_CONSOLE


681 #unde‡
CONFIG_PPDEV


682 #unde‡
CONFIG_TIPAR


687 #unde‡
CONFIG_I2C


700 #unde‡
CONFIG_I2C_SENSOR


705 #unde‡
CONFIG_BUSMOUSE


706 #unde‡
CONFIG_QIC02_TAPE


711 #unde‡
CONFIG_IPMI_HANDLER


716 #unde‡
CONFIG_WATCHDOG


717 #unde‡
CONFIG_HW_RANDOM


718 #unde‡
CONFIG_NVRAM


719 #unde‡
CONFIG_RTC


720 #unde‡
CONFIG_GEN_RTC


721 #unde‡
CONFIG_DTLK


722 #unde‡
CONFIG_R3964


723 #unde‡
CONFIG_APPLICOM


724 #unde‡
CONFIG_SONYPI


729 
	#CONFIG_AGP
 1

	)

730 #unde‡
CONFIG_AGP_ALI


731 #unde‡
CONFIG_AGP_ATI


732 #unde‡
CONFIG_AGP_AMD


733 #unde‡
CONFIG_AGP_AMD64


734 
	#CONFIG_AGP_INTEL
 1

	)

735 #unde‡
CONFIG_AGP_NVIDIA


736 #unde‡
CONFIG_AGP_SIS


737 #unde‡
CONFIG_AGP_SWORKS


738 #unde‡
CONFIG_AGP_VIA


739 
	#CONFIG_DRM
 1

	)

740 #unde‡
CONFIG_DRM_TDFX


741 #unde‡
CONFIG_DRM_GAMMA


742 #unde‡
CONFIG_DRM_R128


743 #unde‡
CONFIG_DRM_RADEON


744 #unde‡
CONFIG_DRM_I810


745 
	#CONFIG_DRM_I830
 1

	)

746 #unde‡
CONFIG_DRM_MGA


747 #unde‡
CONFIG_DRM_SIS


748 #unde‡
CONFIG_MWAVE


749 #unde‡
CONFIG_RAW_DRIVER


750 #unde‡
CONFIG_HANGCHECK_TIMER


755 #unde‡
CONFIG_VIDEO_DEV


760 #unde‡
CONFIG_DVB


765 #unde‡
CONFIG_FB


766 #unde‡
CONFIG_VIDEO_SELECT


771 
	#CONFIG_VGA_CONSOLE
 1

	)

772 #unde‡
CONFIG_MDA_CONSOLE


773 
	#CONFIG_DUMMY_CONSOLE
 1

	)

778 
	#CONFIG_SOUND
 1

	)

783 
	#CONFIG_SND
 1

	)

784 
	#CONFIG_SND_SEQUENCER
 1

	)

785 #unde‡
CONFIG_SND_SEQ_DUMMY


786 
	#CONFIG_SND_OSSEMUL
 1

	)

787 
	#CONFIG_SND_MIXER_OSS
 1

	)

788 
	#CONFIG_SND_PCM_OSS
 1

	)

789 
	#CONFIG_SND_SEQUENCER_OSS
 1

	)

790 #unde‡
CONFIG_SND_VERBOSE_PRINTK


791 #unde‡
CONFIG_SND_DEBUG


796 #unde‡
CONFIG_SND_DUMMY


797 #unde‡
CONFIG_SND_VIRMIDI


798 #unde‡
CONFIG_SND_MTPAV


799 #unde‡
CONFIG_SND_SERIAL_U16550


800 #unde‡
CONFIG_SND_MPU401


805 #unde‡
CONFIG_SND_AD1848


806 #unde‡
CONFIG_SND_CS4231


807 #unde‡
CONFIG_SND_CS4232


808 #unde‡
CONFIG_SND_CS4236


809 #unde‡
CONFIG_SND_ES1688


810 #unde‡
CONFIG_SND_ES18XX


811 #unde‡
CONFIG_SND_GUSCLASSIC


812 #unde‡
CONFIG_SND_GUSEXTREME


813 #unde‡
CONFIG_SND_GUSMAX


814 #unde‡
CONFIG_SND_INTERWAVE


815 #unde‡
CONFIG_SND_INTERWAVE_STB


816 #unde‡
CONFIG_SND_OPTI92X_AD1848


817 #unde‡
CONFIG_SND_OPTI92X_CS4231


818 #unde‡
CONFIG_SND_OPTI93X


819 #unde‡
CONFIG_SND_SB8


820 #unde‡
CONFIG_SND_SB16


821 #unde‡
CONFIG_SND_SBAWE


822 #unde‡
CONFIG_SND_WAVEFRONT


823 #unde‡
CONFIG_SND_CMI8330


824 #unde‡
CONFIG_SND_OPL3SA2


825 #unde‡
CONFIG_SND_SGALAXY


826 #unde‡
CONFIG_SND_SSCAPE


831 #unde‡
CONFIG_SND_ALI5451


832 #unde‡
CONFIG_SND_AZT3328


833 #unde‡
CONFIG_SND_CS46XX


834 #unde‡
CONFIG_SND_CS4281


835 #unde‡
CONFIG_SND_EMU10K1


836 #unde‡
CONFIG_SND_KORG1212


837 #unde‡
CONFIG_SND_NM256


838 #unde‡
CONFIG_SND_RME32


839 #unde‡
CONFIG_SND_RME96


840 #unde‡
CONFIG_SND_RME9652


841 #unde‡
CONFIG_SND_HDSP


842 #unde‡
CONFIG_SND_TRIDENT


843 #unde‡
CONFIG_SND_YMFPCI


844 #unde‡
CONFIG_SND_ALS4000


845 #unde‡
CONFIG_SND_CMIPCI


846 #unde‡
CONFIG_SND_ENS1370


847 #unde‡
CONFIG_SND_ENS1371


848 #unde‡
CONFIG_SND_ES1938


849 #unde‡
CONFIG_SND_ES1968


850 #unde‡
CONFIG_SND_MAESTRO3


851 #unde‡
CONFIG_SND_FM801


852 #unde‡
CONFIG_SND_ICE1712


853 #unde‡
CONFIG_SND_ICE1724


854 
	#CONFIG_SND_INTEL8X0
 1

	)

855 #unde‡
CONFIG_SND_SONICVIBES


856 #unde‡
CONFIG_SND_VIA82XX


857 #unde‡
CONFIG_SND_VX222


862 #unde‡
CONFIG_SND_USB_AUDIO


867 #unde‡
CONFIG_SOUND_PRIME


872 
	#CONFIG_USB
 1

	)

873 #unde‡
CONFIG_USB_DEBUG


878 
	#CONFIG_USB_DEVICEFS
 1

	)

879 #unde‡
CONFIG_USB_BANDWIDTH


880 #unde‡
CONFIG_USB_DYNAMIC_MINORS


885 
	#CONFIG_USB_EHCI_HCD
 1

	)

886 #unde‡
CONFIG_USB_OHCI_HCD


887 
	#CONFIG_USB_UHCI_HCD
 1

	)

892 #unde‡
CONFIG_USB_AUDIO


893 #unde‡
CONFIG_USB_BLUETOOTH_TTY


894 #unde‡
CONFIG_USB_MIDI


895 #unde‡
CONFIG_USB_ACM


896 
	#CONFIG_USB_PRINTER
 1

	)

897 
	#CONFIG_USB_STORAGE
 1

	)

898 #unde‡
CONFIG_USB_STORAGE_DEBUG


899 #unde‡
CONFIG_USB_STORAGE_DATAFAB


900 #unde‡
CONFIG_USB_STORAGE_FREECOM


901 #unde‡
CONFIG_USB_STORAGE_ISD200


902 #unde‡
CONFIG_USB_STORAGE_DPCM


903 #unde‡
CONFIG_USB_STORAGE_HP8200e


904 #unde‡
CONFIG_USB_STORAGE_SDDR09


905 #unde‡
CONFIG_USB_STORAGE_SDDR55


906 #unde‡
CONFIG_USB_STORAGE_JUMPSHOT


911 
	#CONFIG_USB_HID
 1

	)

912 
	#CONFIG_USB_HIDINPUT
 1

	)

913 #unde‡
CONFIG_HID_FF


914 #unde‡
CONFIG_USB_HIDDEV


915 #unde‡
CONFIG_USB_AIPTEK


916 #unde‡
CONFIG_USB_WACOM


917 #unde‡
CONFIG_USB_KBTAB


918 #unde‡
CONFIG_USB_POWERMATE


919 #unde‡
CONFIG_USB_XPAD


924 #unde‡
CONFIG_USB_MDC800


925 #unde‡
CONFIG_USB_SCANNER


926 #unde‡
CONFIG_USB_MICROTEK


927 #unde‡
CONFIG_USB_HPUSBSCSI


932 #unde‡
CONFIG_USB_DABUSB


941 #unde‡
CONFIG_USB_CATC


942 #unde‡
CONFIG_USB_KAWETH


943 #unde‡
CONFIG_USB_PEGASUS


944 #unde‡
CONFIG_USB_RTL8150


945 #unde‡
CONFIG_USB_USBNET


950 #unde‡
CONFIG_USB_USS720


955 #unde‡
CONFIG_USB_SERIAL


960 #unde‡
CONFIG_USB_TIGL


961 #unde‡
CONFIG_USB_AUERSWALD


962 #unde‡
CONFIG_USB_RIO500


963 #unde‡
CONFIG_USB_BRLVGER


964 #unde‡
CONFIG_USB_LCD


965 #unde‡
CONFIG_USB_TEST


966 #unde‡
CONFIG_USB_GADGET


971 
	#CONFIG_EXT2_FS
 1

	)

972 #unde‡
CONFIG_EXT2_FS_XATTR


973 
	#CONFIG_EXT3_FS
 1

	)

974 
	#CONFIG_EXT3_FS_XATTR
 1

	)

975 #unde‡
CONFIG_EXT3_FS_POSIX_ACL


976 #unde‡
CONFIG_EXT3_FS_SECURITY


977 
	#CONFIG_JBD
 1

	)

978 #unde‡
CONFIG_JBD_DEBUG


979 
	#CONFIG_FS_MBCACHE
 1

	)

980 #unde‡
CONFIG_REISERFS_FS


981 #unde‡
CONFIG_JFS_FS


982 #unde‡
CONFIG_XFS_FS


983 #unde‡
CONFIG_MINIX_FS


984 #unde‡
CONFIG_ROMFS_FS


985 #unde‡
CONFIG_QUOTA


986 #unde‡
CONFIG_AUTOFS_FS


987 
	#CONFIG_AUTOFS4_FS
 1

	)

992 
	#CONFIG_ISO9660_FS
 1

	)

993 
	#CONFIG_JOLIET
 1

	)

994 #unde‡
CONFIG_ZISOFS


995 
	#CONFIG_UDF_FS
 1

	)

1000 
	#CONFIG_FAT_FS
 1

	)

1001 
	#CONFIG_MSDOS_FS
 1

	)

1002 
	#CONFIG_VFAT_FS
 1

	)

1003 #unde‡
CONFIG_NTFS_FS


1008 
	#CONFIG_PROC_FS
 1

	)

1009 
	#CONFIG_PROC_KCORE
 1

	)

1010 #unde‡
CONFIG_DEVFS_FS


1011 
	#CONFIG_DEVPTS_FS
 1

	)

1012 #unde‡
CONFIG_DEVPTS_FS_XATTR


1013 
	#CONFIG_TMPFS
 1

	)

1014 #unde‡
CONFIG_HUGETLBFS


1015 #unde‡
CONFIG_HUGETLB_PAGE


1016 
	#CONFIG_RAMFS
 1

	)

1021 #unde‡
CONFIG_ADFS_FS


1022 #unde‡
CONFIG_AFFS_FS


1023 #unde‡
CONFIG_HFS_FS


1024 #unde‡
CONFIG_BEFS_FS


1025 #unde‡
CONFIG_BFS_FS


1026 #unde‡
CONFIG_EFS_FS


1027 #unde‡
CONFIG_CRAMFS


1028 #unde‡
CONFIG_VXFS_FS


1029 #unde‡
CONFIG_HPFS_FS


1030 #unde‡
CONFIG_QNX4FS_FS


1031 #unde‡
CONFIG_SYSV_FS


1032 #unde‡
CONFIG_UFS_FS


1037 
	#CONFIG_NFS_FS
 1

	)

1038 #unde‡
CONFIG_NFS_V3


1039 #unde‡
CONFIG_NFS_V4


1040 #unde‡
CONFIG_NFS_DIRECTIO


1041 
	#CONFIG_NFSD
 1

	)

1042 #unde‡
CONFIG_NFSD_V3


1043 #unde‡
CONFIG_NFSD_TCP


1044 
	#CONFIG_LOCKD
 1

	)

1045 
	#CONFIG_EXPORTFS
 1

	)

1046 
	#CONFIG_SUNRPC
 1

	)

1047 #unde‡
CONFIG_SUNRPC_GSS


1048 #unde‡
CONFIG_SMB_FS


1049 #unde‡
CONFIG_CIFS


1050 #unde‡
CONFIG_NCP_FS


1051 #unde‡
CONFIG_CODA_FS


1052 #unde‡
CONFIG_INTERMEZZO_FS


1053 #unde‡
CONFIG_AFS_FS


1058 #unde‡
CONFIG_PARTITION_ADVANCED


1059 
	#CONFIG_MSDOS_PARTITION
 1

	)

1060 
	#CONFIG_NLS
 1

	)

1065 
	#CONFIG_NLS_DEFAULT
 "iso8859-1"

	)

1066 
	#CONFIG_NLS_CODEPAGE_437
 1

	)

1067 #unde‡
CONFIG_NLS_CODEPAGE_737


1068 #unde‡
CONFIG_NLS_CODEPAGE_775


1069 #unde‡
CONFIG_NLS_CODEPAGE_850


1070 #unde‡
CONFIG_NLS_CODEPAGE_852


1071 #unde‡
CONFIG_NLS_CODEPAGE_855


1072 #unde‡
CONFIG_NLS_CODEPAGE_857


1073 #unde‡
CONFIG_NLS_CODEPAGE_860


1074 #unde‡
CONFIG_NLS_CODEPAGE_861


1075 #unde‡
CONFIG_NLS_CODEPAGE_862


1076 #unde‡
CONFIG_NLS_CODEPAGE_863


1077 #unde‡
CONFIG_NLS_CODEPAGE_864


1078 #unde‡
CONFIG_NLS_CODEPAGE_865


1079 #unde‡
CONFIG_NLS_CODEPAGE_866


1080 #unde‡
CONFIG_NLS_CODEPAGE_869


1081 #unde‡
CONFIG_NLS_CODEPAGE_936


1082 #unde‡
CONFIG_NLS_CODEPAGE_950


1083 #unde‡
CONFIG_NLS_CODEPAGE_932


1084 #unde‡
CONFIG_NLS_CODEPAGE_949


1085 #unde‡
CONFIG_NLS_CODEPAGE_874


1086 #unde‡
CONFIG_NLS_ISO8859_8


1087 #unde‡
CONFIG_NLS_CODEPAGE_1250


1088 #unde‡
CONFIG_NLS_CODEPAGE_1251


1089 
	#CONFIG_NLS_ISO8859_1
 1

	)

1090 #unde‡
CONFIG_NLS_ISO8859_2


1091 #unde‡
CONFIG_NLS_ISO8859_3


1092 #unde‡
CONFIG_NLS_ISO8859_4


1093 #unde‡
CONFIG_NLS_ISO8859_5


1094 #unde‡
CONFIG_NLS_ISO8859_6


1095 #unde‡
CONFIG_NLS_ISO8859_7


1096 #unde‡
CONFIG_NLS_ISO8859_9


1097 #unde‡
CONFIG_NLS_ISO8859_13


1098 #unde‡
CONFIG_NLS_ISO8859_14


1099 #unde‡
CONFIG_NLS_ISO8859_15


1100 #unde‡
CONFIG_NLS_KOI8_R


1101 #unde‡
CONFIG_NLS_KOI8_U


1102 #unde‡
CONFIG_NLS_UTF8


1107 #unde‡
CONFIG_PROFILING


1112 #unde‡
CONFIG_DEBUG_KERNEL


1113 
	#CONFIG_DEBUG_SPINLOCK_SLEEP
 1

	)

1114 
	#CONFIG_FRAME_POINTER
 1

	)

1115 
	#CONFIG_X86_EXTRA_IRQS
 1

	)

1116 
	#CONFIG_X86_FIND_SMP_CONFIG
 1

	)

1117 
	#CONFIG_X86_MPPARSE
 1

	)

1122 #unde‡
CONFIG_SECURITY


1127 #unde‡
CONFIG_CRYPTO


1132 
	#CONFIG_CRC32
 1

	)

1133 
	#CONFIG_X86_SMP
 1

	)

1134 
	#CONFIG_X86_HT
 1

	)

1135 
	#CONFIG_X86_BIOS_REBOOT
 1

	)

1136 
	#CONFIG_X86_TRAMPOLINE
 1

	)

1137 
	#CONFIG_PC
 1

	)

	@/usr/include/linux/cache.h

1 #i‚de‡
__LINUX_CACHE_H


2 
	#__LINUX_CACHE_H


	)

4 
	~<löux/kî√l.h
>

5 
	~<löux/c⁄fig.h
>

6 
	~<asm/ˇche.h
>

8 #i‚de‡
L1_CACHE_ALIGN


9 
	#L1_CACHE_ALIGN
(
x
Ë
	`ALIGN
(x, 
L1_CACHE_BYTES
)

	)

12 #i‚de‡
SMP_CACHE_BYTES


13 
	#SMP_CACHE_BYTES
 
L1_CACHE_BYTES


	)

16 #i‚de‡
____ˇchñöe_Æig√d


17 
	#____ˇchñöe_Æig√d
 
	`__©åibuã__
((
	`__Æig√d__
(
SMP_CACHE_BYTES
)))

	)

20 #i‚de‡
____ˇchñöe_Æig√d_ö_smp


21 #ifde‡
CONFIG_SMP


22 
	#____ˇchñöe_Æig√d_ö_smp
 
____ˇchñöe_Æig√d


	)

24 
	#____ˇchñöe_Æig√d_ö_smp


	)

28 #i‚de‡
__ˇchñöe_Æig√d


29 #ifde‡
MODULE


30 
	#__ˇchñöe_Æig√d
 
____ˇchñöe_Æig√d


	)

32 
	#__ˇchñöe_Æig√d
 \

33 
	`__©åibuã__
((
	`__Æig√d__
(
SMP_CACHE_BYTES
), \

34 
	`__£˘i⁄__
(".d©a.ˇchñöe_Æig√d")))

	)

38 #i‚de‡
__ˇchñöe_Æig√d_ö_smp


39 #ifde‡
CONFIG_SMP


40 
	#__ˇchñöe_Æig√d_ö_smp
 
__ˇchñöe_Æig√d


	)

42 
	#__ˇchñöe_Æig√d_ö_smp


	)

46 #i‡!
deföed
(
____ˇchñöe_maxÆig√d_ö_smp
)

47 #i‡
deföed
(
CONFIG_SMP
)

48 
	#____ˇchñöe_maxÆig√d_ö_smp
 \

49 
	`__©åibuã__
((
	`__Æig√d__
(1 << (
L1_CACHE_SHIFT_MAX
))))

	)

51 
	#____ˇchñöe_maxÆig√d_ö_smp


	)

	@/usr/include/linux/dcache.h

1 #i‚de‡
__LINUX_DCACHE_H


2 
	#__LINUX_DCACHE_H


	)

4 #ifde‡
__KERNEL__


6 
	~<asm/©omic.h
>

7 
	~<löux/li°.h
>

8 
	~<löux/•ölock.h
>

9 
	~<löux/ˇche.h
>

10 
	~<löux/rcupd©e.h
>

11 
	~<asm/bug.h
>

13 
	g«meid©a
;

14 
	gvfsmou¡
;

25 
	#IS_ROOT
(
x
Ë((xË=(x)->
d_∑ª¡
)

	)

31 
	sq°r
 {

32 c⁄° * 
	m«me
;

33 
	mÀn
;

34 
	mhash
;

35 
	m«me_°r
[0];

38 
	sdíåy_°©_t
 {

39 
	mƒ_díåy
;

40 
	mƒ_unu£d
;

41 
	mage_limô
;

42 
	mw™t_∑ges
;

43 
	mdummy
[2];

45 
díåy_°©_t
 
díåy_°©
;

49 
	#öô_«me_hash
(Ë0

	)

52 
ölöe
 

53 
	$∑πül_«me_hash
(
c
, 
¥evhash
)

55  (
¥evhash
 + (
c
 << 4) + (c >> 4)) * 11;

56 
	}
}

62 
ölöe
 
	$íd_«me_hash
(
hash
)

64  (Ë
hash
;

65 
	}
}

68 
ölöe
 

69 
	$fuŒ_«me_hash
(c⁄° *
«me
, 
Àn
)

71 
hash
 = 
	`öô_«me_hash
();

72 
Àn
--)

73 
hash
 = 
	`∑πül_«me_hash
(*
«me
++, hash);

74  
	`íd_«me_hash
(
hash
);

75 
	}
}

77 
	#DNAME_INLINE_LEN_MIN
 16

	)

79 
	gdcookõ_°ru˘
;

81 
	sdíåy
 {

82 
©omic_t
 
	md_cou¡
;

83 
	md_vfs_Êags
;

84 
•ölock_t
 
	md_lock
;

85 
öode
 * 
	md_öode
;

86 
li°_hód
 
	md_Ãu
;

87 
li°_hód
 
	md_chûd
;

88 
li°_hód
 
	md_subdús
;

89 
li°_hód
 
	md_Æüs
;

90 
	md_time
;

91 
díåy_›î©i⁄s
 *
	md_›
;

92 
su≥r_block
 * 
	md_sb
;

93 
	md_Êags
;

94 
	md_mou¡ed
;

95 * 
	md_fsd©a
;

96 
rcu_hód
 
	md_rcu
;

97 
dcookõ_°ru˘
 * 
	md_cookõ
;

98 
	md_move_cou¡
;

99 
q°r
 * 
	md_q°r
;

100 
díåy
 * 
	md_∑ª¡
;

101 
q°r
 
	md_«me
;

102 
hli°_node
 
	md_hash
;

103 
hli°_hód
 * 
	md_buckë
;

104 
	md_öame
[
DNAME_INLINE_LEN_MIN
];

105 } 
	g____ˇchñöe_Æig√d
;

107 
	#DNAME_INLINE_LEN
 ((
díåy
)-
	`off£tof
(díåy,
d_öame
))

	)

109 
	sdíåy_›î©i⁄s
 {

110 (*
	md_ªvÆid©e
)(
	mdíåy
 *, 
	m«meid©a
 *);

111 (*
	md_hash
Ë(
	mdíåy
 *, 
	mq°r
 *);

112 (*
	md_com∑ª
Ë(
	mdíåy
 *, 
	mq°r
 *, qstr *);

113 (*
	md_dñëe
)(
	mdíåy
 *);

114 (*
	md_ªÀa£
)(
	mdíåy
 *);

115 (*
	md_ùut
)(
	mdíåy
 *, 
	möode
 *);

137 
	#DCACHE_AUTOFS_PENDING
 0x0001

	)

138 
	#DCACHE_NFSFS_RENAMED
 0x0002

	)

142 
	#DCACHE_DISCONNECTED
 0x0004

	)

154 
	#DCACHE_REFERENCED
 0x0008

	)

155 
	#DCACHE_UNHASHED
 0x0010

	)

157 
•ölock_t
 
dˇche_lock
;

176 
ölöe
 
	$__d_dr›
(
díåy
 *dentry)

178 i‡(!(
díåy
->
d_vfs_Êags
 & 
DCACHE_UNHASHED
)) {

179 
díåy
->
d_vfs_Êags
 |
DCACHE_UNHASHED
;

180 
	`hli°_dñ_rcu
(&
díåy
->
d_hash
);

182 
	}
}

184 
ölöe
 
	$d_dr›
(
díåy
 *dentry)

186 
	`•ö_lock
(&
dˇche_lock
);

187 
	`__d_dr›
(
díåy
);

188 
	`•ö_u∆ock
(&
dˇche_lock
);

189 
	}
}

191 
ölöe
 
	$d«me_exã∫Æ
(
díåy
 *
d
)

193  
d
->
d_«me
.
«me
 !d->
d_öame
;

194 
	}
}

199 
d_ö°™tüã
(
díåy
 *, 
öode
 *);

200 
d_dñëe
(
díåy
 *);

203 
díåy
 * 
d_Æloc
(díåy *, c⁄° 
q°r
 *);

204 
díåy
 * 
d_Æloc_™⁄
(
öode
 *);

205 
díåy
 * 
d_•li˚_Æüs
(
öode
 *, dentry *);

206 
shrök_dˇche_sb
(
su≥r_block
 *);

207 
shrök_dˇche_∑ª¡
(
díåy
 *);

208 
shrök_dˇche_™⁄
(
hli°_hód
 *);

209 
d_övÆid©e
(
díåy
 *);

212 
díåy
 * 
d_Æloc_roŸ
(
öode
 *);

215 
d_gíocide
(
díåy
 *);

217 
díåy
 *
d_föd_Æüs
(
öode
 *);

218 
d_¥u√_Æü£s
(
öode
 *);

221 
have_submou¡s
(
díåy
 *);

226 
d_ªhash
(
díåy
 *);

237 
ölöe
 
	$d_add
(
díåy
 *
íåy
, 
öode
 *inode)

239 
	`d_ö°™tüã
(
íåy
, 
öode
);

240 
	`d_ªhash
(
íåy
);

241 
	}
}

244 
d_move
(
díåy
 *, dentry *);

247 
díåy
 * 
d_lookup
(díåy *, 
q°r
 *);

248 
díåy
 * 
__d_lookup
(díåy *, 
q°r
 *);

251 
d_vÆid©e
(
díåy
 *, dentry *);

253 * 
d_∑th
(
díåy
 *, 
vfsmou¡
 *, *, );

270 
ölöe
 
díåy
 *
	$dgë
(
díåy
 *dentry)

272 i‡(
díåy
) {

273 i‡(!
	`©omic_ªad
(&
díåy
->
d_cou¡
))

274 
	`BUG
();

275 
	`©omic_öc
(&
díåy
->
d_cou¡
);

277  
díåy
;

278 
	}
}

280 
díåy
 * 
dgë_locked
(dentry *);

289 
ölöe
 
	$d_unhashed
(
díåy
 *dentry)

291  (
díåy
->
d_vfs_Êags
 & 
DCACHE_UNHASHED
);

292 
	}
}

294 
ölöe
 
díåy
 *
	$dgë_∑ª¡
(
díåy
 *dentry)

296 
díåy
 *
ªt
;

298 
	`•ö_lock
(&
díåy
->
d_lock
);

299 
ªt
 = 
	`dgë
(
díåy
->
d_∑ª¡
);

300 
	`•ö_u∆ock
(&
díåy
->
d_lock
);

301  
ªt
;

302 
	}
}

304 
dput
(
díåy
 *);

306 
ölöe
 
	$d_mou¡poöt
(
díåy
 *dentry)

308  
díåy
->
d_mou¡ed
;

309 
	}
}

311 
vfsmou¡
 *
lookup_m¡
(vfsmou¡ *, 
díåy
 *);

312 
díåy
 *
lookup_¸óã
(
«meid©a
 *
nd
, 
is_dú
);

	@/usr/include/linux/err.h

1 #i‚de‡
_LINUX_ERR_H


2 
	#_LINUX_ERR_H


	)

4 
	~<asm/î∫o.h
>

14 
ölöe
 *
	$ERR_PTR
(
îr‹
)

16  (*Ë
îr‹
;

17 
	}
}

19 
ölöe
 
	$PTR_ERR
(c⁄° *
±r
)

21  (Ë
±r
;

22 
	}
}

24 
ölöe
 
	$IS_ERR
(c⁄° *
±r
)

26  ()
±r
 > ()-1000L;

27 
	}
}

	@/usr/include/linux/errno.h

1 #i‚de‡
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/î∫o.h
>

6 #ifde‡
__KERNEL__


9 
	#ERESTARTSYS
 512

	)

10 
	#ERESTARTNOINTR
 513

	)

11 
	#ERESTARTNOHAND
 514

	)

12 
	#ENOIOCTLCMD
 515

	)

13 
	#ERESTART_RESTARTBLOCK
 516

	)

16 
	#EBADHANDLE
 521

	)

17 
	#ENOTSYNC
 522

	)

18 
	#EBADCOOKIE
 523

	)

19 
	#ENOTSUPP
 524

	)

20 
	#ETOOSMALL
 525

	)

21 
	#ESERVERFAULT
 526

	)

22 
	#EBADTYPE
 527

	)

23 
	#EJUKEBOX
 528

	)

24 
	#EIOCBQUEUED
 529

	)

	@/usr/include/linux/fcntl.h

1 #i‚de‡
_LINUX_FCNTL_H


2 
	#_LINUX_FCNTL_H


	)

4 
	~<asm/f˙é.h
>

6 
	#F_SETLEASE
 (
F_LINUX_SPECIFIC_BASE
+0)

	)

7 
	#F_GETLEASE
 (
F_LINUX_SPECIFIC_BASE
+1)

	)

13 
	#F_NOTIFY
 (
F_LINUX_SPECIFIC_BASE
+2)

	)

18 
	#DN_ACCESS
 0x00000001

	)

19 
	#DN_MODIFY
 0x00000002

	)

20 
	#DN_CREATE
 0x00000004

	)

21 
	#DN_DELETE
 0x00000008

	)

22 
	#DN_RENAME
 0x00000010

	)

23 
	#DN_ATTRIB
 0x00000020

	)

24 
	#DN_MULTISHOT
 0x80000000

	)

26 #ifde‡
__KERNEL__


28 #i‡
BITS_PER_LONG
 == 32

29 
	#IS_GETLK32
(
cmd
Ë((cmdË=
F_GETLK
)

	)

30 
	#IS_SETLK32
(
cmd
Ë((cmdË=
F_SETLK
)

	)

31 
	#IS_SETLKW32
(
cmd
Ë((cmdË=
F_SETLKW
)

	)

32 
	#IS_GETLK64
(
cmd
Ë((cmdË=
F_GETLK64
)

	)

33 
	#IS_SETLK64
(
cmd
Ë((cmdË=
F_SETLK64
)

	)

34 
	#IS_SETLKW64
(
cmd
Ë((cmdË=
F_SETLKW64
)

	)

36 
	#IS_GETLK32
(
cmd
Ë(0)

	)

37 
	#IS_SETLK32
(
cmd
Ë(0)

	)

38 
	#IS_SETLKW32
(
cmd
Ë(0)

	)

39 
	#IS_GETLK64
(
cmd
Ë((cmdË=
F_GETLK
)

	)

40 
	#IS_SETLK64
(
cmd
Ë((cmdË=
F_SETLK
)

	)

41 
	#IS_SETLKW64
(
cmd
Ë((cmdË=
F_SETLKW
)

	)

44 
	#IS_GETLK
(
cmd
Ë(
	`IS_GETLK32
(cmdË|| 
	`IS_GETLK64
(cmd))

	)

45 
	#IS_SETLK
(
cmd
Ë(
	`IS_SETLK32
(cmdË|| 
	`IS_SETLK64
(cmd))

	)

46 
	#IS_SETLKW
(
cmd
Ë(
	`IS_SETLKW32
(cmdË|| 
	`IS_SETLKW64
(cmd))

	)

	@/usr/include/linux/ioctl.h

1 #i‚de‡
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/io˘l.h
>

	@/usr/include/linux/kdev_t.h

1 #i‚de‡
_LINUX_KDEV_T_H


2 
	#_LINUX_KDEV_T_H


	)

3 #ifde‡
__KERNEL__


4 
	#MINORBITS
 20

	)

5 
	#MINORMASK
 ((1U << 
MINORBITS
Ë- 1)

	)

7 
	#MAJOR
(
dev
Ë((Ë((devË>> 
MINORBITS
))

	)

8 
	#MINOR
(
dev
Ë((Ë((devË& 
MINORMASK
))

	)

9 
	#MKDEV
(
ma
,
mi
Ë(((maË<< 
MINORBITS
Ë| (mi))

	)

11 
	#¥öt_dev_t
(
buf„r
, 
dev
) \

12 
	`•rötf
((
buf„r
), "%u:%u\n", 
	`MAJOR
(
dev
), 
	`MINOR
(dev))

	)

14 
	#f‹m©_dev_t
(
buf„r
, 
dev
) \

16 
	`•rötf
(
buf„r
, "%u:%u", 
	`MAJOR
(
dev
), 
	`MINOR
(dev)); \

17 
buf„r
; \

18 })

	)

21 
ölöe
 
	$ﬁd_vÆid_dev
(
dev_t
 
dev
)

23  
	`MAJOR
(
dev
Ë< 256 && 
	`MINOR
(dev) < 256;

24 
	}
}

26 
ölöe
 
u16
 
	$ﬁd_ícode_dev
(
dev_t
 
dev
)

28  (
	`MAJOR
(
dev
Ë<< 8Ë| 
	`MINOR
(dev);

29 
	}
}

31 
ölöe
 
dev_t
 
	$ﬁd_decode_dev
(
u16
 
vÆ
)

33  
	`MKDEV
((
vÆ
 >> 8) & 255, val & 255);

34 
	}
}

36 
ölöe
 
	$√w_vÆid_dev
(
dev_t
 
dev
)

39 
	}
}

41 
ölöe
 
u32
 
	$√w_ícode_dev
(
dev_t
 
dev
)

43 
maj‹
 = 
	`MAJOR
(
dev
);

44 
mö‹
 = 
	`MINOR
(
dev
);

45  (
mö‹
 & 0xffË| (
maj‹
 << 8) | ((minor & ~0xff) << 12);

46 
	}
}

48 
ölöe
 
dev_t
 
	$√w_decode_dev
(
u32
 
dev
)

50 
maj‹
 = (
dev
 & 0xfff00) >> 8;

51 
mö‹
 = (
dev
 & 0xff) | ((dev >> 12) & 0xfff00);

52  
	`MKDEV
(
maj‹
, 
mö‹
);

53 
	}
}

55 
ölöe
 
	$huge_vÆid_dev
(
dev_t
 
dev
)

58 
	}
}

60 
ölöe
 
u64
 
	$huge_ícode_dev
(
dev_t
 
dev
)

62  
	`√w_ícode_dev
(
dev
);

63 
	}
}

65 
ölöe
 
dev_t
 
	$huge_decode_dev
(
u64
 
dev
)

67  
	`√w_decode_dev
(
dev
);

68 
	}
}

70 
ölöe
 
	$sysv_vÆid_dev
(
dev_t
 
dev
)

72  
	`MAJOR
(
dev
Ë< (1<<14Ë&& 
	`MINOR
(dev) < (1<<18);

73 
	}
}

75 
ölöe
 
u32
 
	$sysv_ícode_dev
(
dev_t
 
dev
)

77  
	`MINOR
(
dev
Ë| (
	`MAJOR
(dev) << 18);

78 
	}
}

80 
ölöe
 
	$sysv_maj‹
(
u32
 
dev
)

82  (
dev
 >> 18) & 0x3fff;

83 
	}
}

85 
ölöe
 
	$sysv_mö‹
(
u32
 
dev
)

87  
dev
 & 0x3ffff;

88 
	}
}

97 
	#MAJOR
(
dev
Ë((dev)>>8)

	)

98 
	#MINOR
(
dev
Ë((devË& 0xff)

	)

99 
	#MKDEV
(
ma
,
mi
Ë((ma)<<8 | (mi))

	)

	@/usr/include/linux/kobject.h

15 #i‡
deföed
(
__KERNEL__
Ë&& !deföed(
_KOBJECT_H_
)

16 
	#_KOBJECT_H_


	)

18 
	~<löux/ty≥s.h
>

19 
	~<löux/li°.h
>

20 
	~<löux/sysfs.h
>

21 
	~<löux/rw£m.h
>

22 
	~<asm/©omic.h
>

24 
	#KOBJ_NAME_LEN
 20

	)

26 
	skobje˘
 {

27 * 
	mk_«me
;

28 
	m«me
[
KOBJ_NAME_LEN
];

29 
©omic_t
 
	mªfcou¡
;

30 
li°_hód
 
	míåy
;

31 
kobje˘
 * 
	m∑ª¡
;

32 
k£t
 * 
	mk£t
;

33 
kobj_ty≥
 * 
	mkty≥
;

34 
díåy
 * 
	mdíåy
;

37 
	$kobje˘_£t_«me
(
kobje˘
 *, const *, ...)

38 
	`__©åibuã__
((
	`f‹m©
(
¥ötf
,2,3)));

40 
ölöe
 * 
	$kobje˘_«me
(
kobje˘
 * 
kobj
)

42  
kobj
->
k_«me
;

43 
	}
}

45 
kobje˘_öô
(
kobje˘
 *);

46 
kobje˘_˛ónup
(
kobje˘
 *);

48 
kobje˘_add
(
kobje˘
 *);

49 
kobje˘_dñ
(
kobje˘
 *);

51 
kobje˘_ª«me
(
kobje˘
 *, *
√w_«me
);

53 
kobje˘_ªgi°î
(
kobje˘
 *);

54 
kobje˘_uƒegi°î
(
kobje˘
 *);

56 
kobje˘
 * 
kobje˘_gë
(kobject *);

57 
kobje˘_put
(
kobje˘
 *);

60 
	skobj_ty≥
 {

61 (*
	mªÀa£
)(
	mkobje˘
 *);

62 
sysfs_›s
 * 
	msysfs_›s
;

63 
©åibuã
 ** 
	mdeÁu…_©ås
;

85 
	sk£t_hŸ∂ug_›s
 {

86 (*
	mfûãr
)(
k£t
 *
	mk£t
, 
kobje˘
 *
	mkobj
);

87 *(*
	m«me
)(
k£t
 *
	mk£t
, 
kobje˘
 *
	mkobj
);

88 (*
	mhŸ∂ug
)(
k£t
 *
	mk£t
, 
kobje˘
 *
	mkobj
, **
	mívp
,

89 
	mnum_ívp
, *
	mbuf„r
, 
	mbuf„r_size
);

92 
	sk£t
 {

93 
subsy°em
 * 
	msubsys
;

94 
kobj_ty≥
 * 
	mkty≥
;

95 
li°_hód
 
	mli°
;

96 
kobje˘
 
	mkobj
;

97 
k£t_hŸ∂ug_›s
 * 
	mhŸ∂ug_›s
;

101 
k£t_öô
(
k£t
 * 
k
);

102 
k£t_add
(
k£t
 * 
k
);

103 
k£t_ªgi°î
(
k£t
 * 
k
);

104 
k£t_uƒegi°î
(
k£t
 * 
k
);

106 
ölöe
 
k£t
 * 
	$to_k£t
(
kobje˘
 * 
kobj
)

108  
kobj
 ? 
	`c⁄èöî_of
(kobj,
k£t
,kobjË: 
NULL
;

109 
	}
}

111 
ölöe
 
k£t
 * 
	$k£t_gë
(
k£t
 * 
k
)

113  
k
 ? 
	`to_k£t
(
	`kobje˘_gë
(&k->
kobj
)Ë: 
NULL
;

114 
	}
}

116 
ölöe
 
	$k£t_put
(
k£t
 * 
k
)

118 
	`kobje˘_put
(&
k
->
kobj
);

119 
	}
}

121 
ölöe
 
kobj_ty≥
 * 
	$gë_kty≥
(
kobje˘
 * 
k
)

123 i‡(
k
->
k£t
 && k->k£t->
kty≥
)

124  
k
->
k£t
->
kty≥
;

126  
k
->
kty≥
;

127 
	}
}

129 
kobje˘
 * 
k£t_föd_obj
(
k£t
 *, const *);

136 
	#£t_k£t_«me
(
°r
Ë.
k£t
 = { .
kobj
 = { .
«me
 = så } }

	)

140 
	ssubsy°em
 {

141 
k£t
 
	mk£t
;

142 
rw_£m≠h‹e
 
	mrw£m
;

145 
	#de˛_subsys
(
_«me
,
_ty≥
,
_hŸ∂ug_›s
) \

146 
subsy°em
 
_«me
##
_subsys
 = { \

147 .
k£t
 = { \

148 .
kobj
 = { .
«me
 = 
	`__°rögify
(
_«me
) }, \

149 .
kty≥
 = 
_ty≥
, \

150 .
hŸ∂ug_›s
 =
_hŸ∂ug_›s
, \

152 }

	)

170 
	#kobj_£t_k£t_s
(
obj
,
subsys
) \

171 (
obj
)->
kobj
.
k£t
 = &(
subsys
).
	)
kset

184 
	#k£t_£t_k£t_s
(
obj
,
subsys
) \

185 (
obj
)->
k£t
.
kobj
.k£à&(
subsys
).
	)
kset

197 
	#subsys_£t_k£t
(
obj
,
_subsys
) \

198 (
obj
)->
subsys
.
k£t
.
kobj
.k£à&(
_subsys
).
	)
kset

200 
subsy°em_öô
(
subsy°em
 *);

201 
subsy°em_ªgi°î
(
subsy°em
 *);

202 
subsy°em_uƒegi°î
(
subsy°em
 *);

204 
ölöe
 
subsy°em
 * 
	$subsys_gë
(
subsy°em
 * 
s
)

206  
s
 ? 
	`c⁄èöî_of
(
	`k£t_gë
(&s->
k£t
),
subsy°em
,k£tË: 
NULL
;

207 
	}
}

209 
ölöe
 
	$subsys_put
(
subsy°em
 * 
s
)

211 
	`k£t_put
(&
s
->
k£t
);

212 
	}
}

214 
	ssubsys_©åibuã
 {

215 
©åibuã
 
	m©å
;

216 
ssize_t
 (*
show
)(
	msubsy°em
 *, *);

217 
ssize_t
 (*
°‹e
)(
	msubsy°em
 *, c⁄° *, 
	msize_t
);

220 
subsys_¸óã_fûe
(
subsy°em
 * , 
subsys_©åibuã
 *);

221 
subsys_ªmove_fûe
(
subsy°em
 * , 
subsys_©åibuã
 *);

	@/usr/include/linux/limits.h

1 #i‚de‡
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 32

	)

7 
	#ARG_MAX
 131072

	)

8 
	#CHILD_MAX
 999

	)

9 
	#OPEN_MAX
 256

	)

10 
	#LINK_MAX
 127

	)

11 
	#MAX_CANON
 255

	)

12 
	#MAX_INPUT
 255

	)

13 
	#NAME_MAX
 255

	)

14 
	#PATH_MAX
 4096

	)

15 
	#PIPE_BUF
 4096

	)

16 
	#XATTR_NAME_MAX
 255

	)

17 
	#XATTR_SIZE_MAX
 65536

	)

18 
	#XATTR_LIST_MAX
 65536

	)

20 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/linkage.h

1 #i‚de‡
_LINUX_LINKAGE_H


2 
	#_LINUX_LINKAGE_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<asm/lökage.h
>

7 #ifde‡
__˝lu•lus


8 
	#CPP_ASMLINKAGE
 "C"

	)

10 
	#CPP_ASMLINKAGE


	)

13 #i‚de‡
asmlökage


14 
	#asmlökage
 
CPP_ASMLINKAGE


	)

17 #i‚de‡
__ALIGN


18 
	#__ALIGN
 .
Æign
 4,0x90

	)

19 
	#__ALIGN_STR
 ".Æig¿4,0x90"

	)

22 #ifde‡
__ASSEMBLY__


24 
	#ALIGN
 
__ALIGN


	)

25 
	#ALIGN_STR
 
__ALIGN_STR


	)

27 
	#ENTRY
(
«me
) \

28 .
globl
 
«me
; \

29 
ALIGN
; \

30 
«me
:

	)

34 
	#NORET_TYPE


	)

35 
	#ATTRIB_NORET
 
	`__©åibuã__
((
n‹ëu∫
))

	)

36 
	#NORET_AND
 
n‹ëu∫
,

	)

38 #i‚de‡
FASTCALL


39 
	#FASTCALL
(
x
Ë
	)
x

	@/usr/include/linux/list.h

1 #i‚de‡
_LINUX_LIST_H


2 
	#_LINUX_LIST_H


	)

4 #ifde‡
__KERNEL__


6 
	~<löux/°ddef.h
>

7 
	~<löux/¥e„tch.h
>

8 
	~<asm/sy°em.h
>

15 
	#LIST_POISON1
 ((*Ë0x00100100)

	)

16 
	#LIST_POISON2
 ((*Ë0x00200200)

	)

28 
	sli°_hód
 {

29 
li°_hód
 *
	m√xt
, *
	m¥ev
;

32 
	#LIST_HEAD_INIT
(
«me
Ë{ &“ame), &“ameË}

	)

34 
	#LIST_HEAD
(
«me
) \

35 
li°_hód
 
«me
 = 
	`LIST_HEAD_INIT
“ame)

	)

37 
	#INIT_LIST_HEAD
(
±r
) do { \

38 (
±r
)->
√xt
 = (±r); (±r)->
¥ev
 = (ptr); \

39 } 0)

	)

47 
ölöe
 
	$__li°_add
(
li°_hód
 *
√w
,

48 
li°_hód
 *
¥ev
,

49 
li°_hód
 *
√xt
)

51 
√xt
->
¥ev
 = 
√w
;

52 
√w
->
√xt
 =Çext;

53 
√w
->
¥ev
 =Örev;

54 
¥ev
->
√xt
 = 
√w
;

55 
	}
}

65 
ölöe
 
	$li°_add
(
li°_hód
 *
√w
, li°_hód *
hód
)

67 
	`__li°_add
(
√w
, 
hód
, hód->
√xt
);

68 
	}
}

78 
ölöe
 
	$li°_add_èû
(
li°_hód
 *
√w
, li°_hód *
hód
)

80 
	`__li°_add
(
√w
, 
hód
->
¥ev
, head);

81 
	}
}

89 
__ölöe__
 
	$__li°_add_rcu
(
li°_hód
 * 
√w
,

90 
li°_hód
 * 
¥ev
,

91 
li°_hód
 * 
√xt
)

93 
√w
->
√xt
 =Çext;

94 
√w
->
¥ev
 =Örev;

95 
	`smp_wmb
();

96 
√xt
->
¥ev
 = 
√w
;

97 
¥ev
->
√xt
 = 
√w
;

98 
	}
}

108 
__ölöe__
 
	$li°_add_rcu
(
li°_hód
 *
√w
, li°_hód *
hód
)

110 
	`__li°_add_rcu
(
√w
, 
hód
, hód->
√xt
);

111 
	}
}

121 
__ölöe__
 
	$li°_add_èû_rcu
(
li°_hód
 *
√w
, li°_hód *
hód
)

123 
	`__li°_add_rcu
(
√w
, 
hód
->
¥ev
, head);

124 
	}
}

133 
ölöe
 
	$__li°_dñ
(
li°_hód
 * 
¥ev
, li°_hód * 
√xt
)

135 
√xt
->
¥ev
 =Örev;

136 
¥ev
->
√xt
 =Çext;

137 
	}
}

145 
ölöe
 
	$li°_dñ
(
li°_hód
 *
íåy
)

147 
	`__li°_dñ
(
íåy
->
¥ev
,É¡ry->
√xt
);

148 
íåy
->
√xt
 = 
LIST_POISON1
;

149 
íåy
->
¥ev
 = 
LIST_POISON2
;

150 
	}
}

163 
ölöe
 
	$li°_dñ_rcu
(
li°_hód
 *
íåy
)

165 
	`__li°_dñ
(
íåy
->
¥ev
,É¡ry->
√xt
);

166 
íåy
->
¥ev
 = 
LIST_POISON2
;

167 
	}
}

173 
ölöe
 
	$li°_dñ_öô
(
li°_hód
 *
íåy
)

175 
	`__li°_dñ
(
íåy
->
¥ev
,É¡ry->
√xt
);

176 
	`INIT_LIST_HEAD
(
íåy
);

177 
	}
}

184 
ölöe
 
	$li°_move
(
li°_hód
 *
li°
, li°_hód *
hód
)

186 
	`__li°_dñ
(
li°
->
¥ev
,Üi°->
√xt
);

187 
	`li°_add
(
li°
, 
hód
);

188 
	}
}

195 
ölöe
 
	$li°_move_èû
(
li°_hód
 *
li°
,

196 
li°_hód
 *
hód
)

198 
	`__li°_dñ
(
li°
->
¥ev
,Üi°->
√xt
);

199 
	`li°_add_èû
(
li°
, 
hód
);

200 
	}
}

206 
ölöe
 
	$li°_em±y
(c⁄° 
li°_hód
 *
hód
)

208  
hód
->
√xt
 == head;

209 
	}
}

211 
ölöe
 
	$__li°_•li˚
(
li°_hód
 *
li°
,

212 
li°_hód
 *
hód
)

214 
li°_hód
 *
fú°
 = 
li°
->
√xt
;

215 
li°_hód
 *
œ°
 = 
li°
->
¥ev
;

216 
li°_hód
 *
©
 = 
hód
->
√xt
;

218 
fú°
->
¥ev
 = 
hód
;

219 
hód
->
√xt
 = 
fú°
;

221 
œ°
->
√xt
 = 
©
;

222 
©
->
¥ev
 = 
œ°
;

223 
	}
}

230 
ölöe
 
	$li°_•li˚
(
li°_hód
 *
li°
, li°_hód *
hód
)

232 i‡(!
	`li°_em±y
(
li°
))

233 
	`__li°_•li˚
(
li°
, 
hód
);

234 
	}
}

243 
ölöe
 
	$li°_•li˚_öô
(
li°_hód
 *
li°
,

244 
li°_hód
 *
hód
)

246 i‡(!
	`li°_em±y
(
li°
)) {

247 
	`__li°_•li˚
(
li°
, 
hód
);

248 
	`INIT_LIST_HEAD
(
li°
);

250 
	}
}

258 
	#li°_íåy
(
±r
, 
ty≥
, 
membî
) \

259 
	`c⁄èöî_of
(
±r
, 
ty≥
, 
membî
)

	)

266 
	#li°_f‹_óch
(
pos
, 
hód
) \

267 
pos
 = (
hód
)->
√xt
, 
	`¥e„tch
(pos->next);Öos != (head); \

268 
pos
 =Öos->
√xt
, 
	`¥e„tch
’os->√xt))

	)

280 
	#__li°_f‹_óch
(
pos
, 
hód
) \

281 
pos
 = (
hód
)->
√xt
;Öo†!(hód);Öo†pos->√xt)

	)

288 
	#li°_f‹_óch_¥ev
(
pos
, 
hód
) \

289 
pos
 = (
hód
)->
¥ev
, 
	`¥e„tch
(pos->prev);Öos != (head); \

290 
pos
 =Öos->
¥ev
, 
	`¥e„tch
’os->¥ev))

	)

298 
	#li°_f‹_óch_ß„
(
pos
, 
n
, 
hód
) \

299 
pos
 = (
hód
)->
√xt
, 
n
 =Öos->next;Öos != (head); \

300 
pos
 = 
n
,Ç =Öos->
√xt
)

	)

308 
	#li°_f‹_óch_íåy
(
pos
, 
hód
, 
membî
) \

309 
pos
 = 
	`li°_íåy
((
hód
)->
√xt
, 
	`ty≥of
(*pos), 
membî
), \

310 
	`¥e„tch
(
pos
->
membî
.
√xt
); \

311 &
pos
->
membî
 !(
hód
); \

312 
pos
 = 
	`li°_íåy
’os->
membî
.
√xt
, 
	`ty≥of
(*pos), member), \

313 
	`¥e„tch
(
pos
->
membî
.
√xt
))

	)

321 
	#li°_f‹_óch_íåy_ªvî£
(
pos
, 
hód
, 
membî
) \

322 
pos
 = 
	`li°_íåy
((
hód
)->
¥ev
, 
	`ty≥of
(*pos), 
membî
), \

323 
	`¥e„tch
(
pos
->
membî
.
¥ev
); \

324 &
pos
->
membî
 !(
hód
); \

325 
pos
 = 
	`li°_íåy
’os->
membî
.
¥ev
, 
	`ty≥of
(*pos), member), \

326 
	`¥e„tch
(
pos
->
membî
.
¥ev
))

	)

335 
	#li°_f‹_óch_íåy_c⁄töue
(
pos
, 
hód
, 
membî
) \

336 
pos
 = 
	`li°_íåy
’os->
membî
.
√xt
, 
	`ty≥of
(*pos), member), \

337 
	`¥e„tch
(
pos
->
membî
.
√xt
); \

338 &
pos
->
membî
 !(
hód
); \

339 
pos
 = 
	`li°_íåy
’os->
membî
.
√xt
, 
	`ty≥of
(*pos), member), \

340 
	`¥e„tch
(
pos
->
membî
.
√xt
))

	)

349 
	#li°_f‹_óch_íåy_ß„
(
pos
, 
n
, 
hód
, 
membî
) \

350 
pos
 = 
	`li°_íåy
((
hód
)->
√xt
, 
	`ty≥of
(*pos), 
membî
), \

351 
n
 = 
	`li°_íåy
(
pos
->
membî
.
√xt
, 
	`ty≥of
(*pos), member); \

352 &
pos
->
membî
 !(
hód
); \

353 
pos
 = 
n
,Ç = 
	`li°_íåy
“->
membî
.
√xt
, 
	`ty≥of
(*n), membî))

	)

360 
	#li°_f‹_óch_rcu
(
pos
, 
hód
) \

361 
pos
 = (
hód
)->
√xt
, 
	`¥e„tch
(pos->next);Öos != (head); \

362 
pos
 =Öos->
√xt
, ({ 
	`smp_ªad_b¨rõr_dïíds
(); 0;}), 
	`¥e„tch
’os->√xt))

	)

364 
	#__li°_f‹_óch_rcu
(
pos
, 
hód
) \

365 
pos
 = (
hód
)->
√xt
;Öos != (head); \

366 
pos
 =Öos->
√xt
, ({ 
	`smp_ªad_b¨rõr_dïíds
(); 0;}))

	)

375 
	#li°_f‹_óch_ß„_rcu
(
pos
, 
n
, 
hód
) \

376 
pos
 = (
hód
)->
√xt
, 
n
 =Öos->next;Öos != (head); \

377 
pos
 = 
n
, ({ 
	`smp_ªad_b¨rõr_dïíds
(); 0;}),Ç =Öos->
√xt
)

	)

385 
	#li°_f‹_óch_íåy_rcu
(
pos
, 
hód
, 
membî
) \

386 
pos
 = 
	`li°_íåy
((
hód
)->
√xt
, 
	`ty≥of
(*pos), 
membî
), \

387 
	`¥e„tch
(
pos
->
membî
.
√xt
); \

388 &
pos
->
membî
 !(
hód
); \

389 
pos
 = 
	`li°_íåy
’os->
membî
.
√xt
, 
	`ty≥of
(*pos), member), \

390 ({ 
	`smp_ªad_b¨rõr_dïíds
(); 0;}), \

391 
	`¥e„tch
(
pos
->
membî
.
√xt
))

	)

400 
	#li°_f‹_óch_c⁄töue_rcu
(
pos
, 
hód
) \

401 (
pos
Ë’os)->
√xt
, 
	`¥e„tch
(’os)->√xt); (posË!(
hód
); \

402 (
pos
Ë’os)->
√xt
, ({ 
	`smp_ªad_b¨rõr_dïíds
(); 0;}), 
	`¥e„tch
(’os)->√xt))

	)

411 
	shli°_hód
 {

412 
hli°_node
 *
	mfú°
;

415 
	shli°_node
 {

416 
hli°_node
 *
	m√xt
, **
	mµªv
;

419 
	#HLIST_HEAD_INIT
 { .
fú°
 = 
NULL
 }

	)

420 
	#HLIST_HEAD
(
«me
Ë
hli°_hód
Çamê{ .
fú°
 = 
NULL
 }

	)

421 
	#INIT_HLIST_HEAD
(
±r
Ë(’å)->
fú°
 = 
NULL
)

	)

422 
	#INIT_HLIST_NODE
(
±r
Ë(’å)->
√xt
 = 
NULL
, (±r)->
µªv
 = NULL)

	)

424 
__ölöe__
 
	$hli°_unhashed
(c⁄° 
hli°_node
 *
h
)

426  !
h
->
µªv
;

427 
	}
}

429 
__ölöe__
 
	$hli°_em±y
(c⁄° 
hli°_hód
 *
h
)

431  !
h
->
fú°
;

432 
	}
}

434 
__ölöe__
 
	$__hli°_dñ
(
hli°_node
 *
n
)

436 
hli°_node
 *
√xt
 = 
n
->next;

437 
hli°_node
 **
µªv
 = 
n
->pprev;

438 *
µªv
 = 
√xt
;

439 i‡(
√xt
)

440 
√xt
->
µªv
 =Öprev;

441 
	}
}

443 
__ölöe__
 
	$hli°_dñ
(
hli°_node
 *
n
)

445 
	`__hli°_dñ
(
n
);

446 
n
->
√xt
 = 
LIST_POISON1
;

447 
n
->
µªv
 = 
LIST_POISON2
;

448 
	}
}

461 
ölöe
 
	$hli°_dñ_rcu
(
hli°_node
 *
n
)

463 
	`__hli°_dñ
(
n
);

464 
n
->
µªv
 = 
LIST_POISON2
;

465 
	}
}

467 
__ölöe__
 
	$hli°_dñ_öô
(
hli°_node
 *
n
)

469 i‡(
n
->
µªv
) {

470 
	`__hli°_dñ
(
n
);

471 
	`INIT_HLIST_NODE
(
n
);

473 
	}
}

475 
	#hli°_dñ_rcu_öô
 
hli°_dñ_öô


	)

477 
__ölöe__
 
	$hli°_add_hód
(
hli°_node
 *
n
, 
hli°_hód
 *
h
)

479 
hli°_node
 *
fú°
 = 
h
->first;

480 
n
->
√xt
 = 
fú°
;

481 i‡(
fú°
)

482 
fú°
->
µªv
 = &
n
->
√xt
;

483 
h
->
fú°
 = 
n
;

484 
n
->
µªv
 = &
h
->
fú°
;

485 
	}
}

487 
__ölöe__
 
	$hli°_add_hód_rcu
(
hli°_node
 *
n
, 
hli°_hód
 *
h
)

489 
hli°_node
 *
fú°
 = 
h
->first;

490 
n
->
√xt
 = 
fú°
;

491 
n
->
µªv
 = &
h
->
fú°
;

492 
	`smp_wmb
();

493 i‡(
fú°
)

494 
fú°
->
µªv
 = &
n
->
√xt
;

495 
h
->
fú°
 = 
n
;

496 
	}
}

499 
__ölöe__
 
	$hli°_add_bef‹e
(
hli°_node
 *
n
, hli°_nodê*
√xt
)

501 
n
->
µªv
 = 
√xt
->pprev;

502 
n
->
√xt
 =Çext;

503 
√xt
->
µªv
 = &
n
->next;

504 *(
n
->
µªv
) =Ç;

505 
	}
}

507 
__ölöe__
 
	$hli°_add_a·î
(
hli°_node
 *
n
,

508 
hli°_node
 *
√xt
)

510 
√xt
->√xà
n
->next;

511 *(
√xt
->
µªv
Ë
n
;

512 
n
->
√xt
 =Çext;

513 
	}
}

515 
	#hli°_íåy
(
±r
, 
ty≥
, 
membî
Ë
	`c⁄èöî_of
’å,ty≥,membî)

	)

518 
	#hli°_f‹_óch
(
pos
, 
hód
) \

519 
pos
 = (
hód
)->
fú°
;Öo†&& ({ 
	`¥e„tch
’os->
√xt
); 1; }); \

520 
pos
 =Öos->
√xt
)

	)

522 
	#hli°_f‹_óch_ß„
(
pos
, 
n
, 
hód
) \

523 
pos
 = (
hód
)->
fú°
; 
n
 =Öo†?Öos->
√xt
 : 0,Öos; \

524 
pos
 = 
n
)

	)

533 
	#hli°_f‹_óch_íåy
(
ços
, 
pos
, 
hód
, 
membî
) \

534 
pos
 = (
hód
)->
fú°
; \

535 
pos
 && ({ 
	`¥e„tch
’os->
√xt
); 1;}) && \

536 ({ 
ços
 = 
	`hli°_íåy
(
pos
, 
	`ty≥of
(*ços), 
membî
); 1;}); \

537 
pos
 =Öos->
√xt
)

	)

545 
	#hli°_f‹_óch_íåy_c⁄töue
(
ços
, 
pos
, 
membî
) \

546 
pos
 = (pos)->
√xt
; \

547 
pos
 && ({ 
	`¥e„tch
’os->
√xt
); 1;}) && \

548 ({ 
ços
 = 
	`hli°_íåy
(
pos
, 
	`ty≥of
(*ços), 
membî
); 1;}); \

549 
pos
 =Öos->
√xt
)

	)

557 
	#hli°_f‹_óch_íåy_‰om
(
ços
, 
pos
, 
membî
) \

558 ; 
pos
 && ({ 
	`¥e„tch
’os->
√xt
); 1;}) && \

559 ({ 
ços
 = 
	`hli°_íåy
(
pos
, 
	`ty≥of
(*ços), 
membî
); 1;}); \

560 
pos
 =Öos->
√xt
)

	)

570 
	#hli°_f‹_óch_íåy_ß„
(
ços
, 
pos
, 
n
, 
hód
, 
membî
) \

571 
pos
 = (
hód
)->
fú°
; \

572 
pos
 && ({ 
n
 =Öos->
√xt
; 1; }) && \

573 ({ 
ços
 = 
	`hli°_íåy
(
pos
, 
	`ty≥of
(*ços), 
membî
); 1;}); \

574 
pos
 = 
n
)

	)

	@/usr/include/linux/major.h

1 #i‚de‡
_LINUX_MAJOR_H


2 
	#_LINUX_MAJOR_H


	)

9 
	#UNNAMED_MAJOR
 0

	)

10 
	#MEM_MAJOR
 1

	)

11 
	#RAMDISK_MAJOR
 1

	)

12 
	#FLOPPY_MAJOR
 2

	)

13 
	#PTY_MASTER_MAJOR
 2

	)

14 
	#IDE0_MAJOR
 3

	)

15 
	#HD_MAJOR
 
IDE0_MAJOR


	)

16 
	#PTY_SLAVE_MAJOR
 3

	)

17 
	#TTY_MAJOR
 4

	)

18 
	#TTYAUX_MAJOR
 5

	)

19 
	#LP_MAJOR
 6

	)

20 
	#VCS_MAJOR
 7

	)

21 
	#LOOP_MAJOR
 7

	)

22 
	#SCSI_DISK0_MAJOR
 8

	)

23 
	#SCSI_TAPE_MAJOR
 9

	)

24 
	#MD_MAJOR
 9

	)

25 
	#MISC_MAJOR
 10

	)

26 
	#SCSI_CDROM_MAJOR
 11

	)

27 
	#MUX_MAJOR
 11

	)

28 
	#QIC02_TAPE_MAJOR
 12

	)

29 
	#XT_DISK_MAJOR
 13

	)

30 
	#INPUT_MAJOR
 13

	)

31 
	#SOUND_MAJOR
 14

	)

32 
	#CDU31A_CDROM_MAJOR
 15

	)

33 
	#JOYSTICK_MAJOR
 15

	)

34 
	#GOLDSTAR_CDROM_MAJOR
 16

	)

35 
	#OPTICS_CDROM_MAJOR
 17

	)

36 
	#SANYO_CDROM_MAJOR
 18

	)

37 
	#CYCLADES_MAJOR
 19

	)

38 
	#CYCLADESAUX_MAJOR
 20

	)

39 
	#MITSUMI_X_CDROM_MAJOR
 20

	)

40 
	#MFM_ACORN_MAJOR
 21

	)

41 
	#SCSI_GENERIC_MAJOR
 21

	)

42 
	#IDE1_MAJOR
 22

	)

43 
	#DIGICU_MAJOR
 22

	)

44 
	#DIGI_MAJOR
 23

	)

45 
	#MITSUMI_CDROM_MAJOR
 23

	)

46 
	#CDU535_CDROM_MAJOR
 24

	)

47 
	#STL_SERIALMAJOR
 24

	)

48 
	#MATSUSHITA_CDROM_MAJOR
 25

	)

49 
	#STL_CALLOUTMAJOR
 25

	)

50 
	#MATSUSHITA_CDROM2_MAJOR
 26

	)

51 
	#QIC117_TAPE_MAJOR
 27

	)

52 
	#MATSUSHITA_CDROM3_MAJOR
 27

	)

53 
	#MATSUSHITA_CDROM4_MAJOR
 28

	)

54 
	#STL_SIOMEMMAJOR
 28

	)

55 
	#ACSI_MAJOR
 28

	)

56 
	#AZTECH_CDROM_MAJOR
 29

	)

57 
	#GRAPHDEV_MAJOR
 29

	)

58 
	#CM206_CDROM_MAJOR
 32

	)

59 
	#IDE2_MAJOR
 33

	)

60 
	#IDE3_MAJOR
 34

	)

61 
	#Z8530_MAJOR
 34

	)

62 
	#XPRAM_MAJOR
 35

	)

63 
	#NETLINK_MAJOR
 36

	)

64 
	#PS2ESDI_MAJOR
 36

	)

65 
	#IDETAPE_MAJOR
 37

	)

66 
	#Z2RAM_MAJOR
 37

	)

67 
	#APBLOCK_MAJOR
 38

	)

68 
	#DDV_MAJOR
 39

	)

69 
	#NBD_MAJOR
 43

	)

70 
	#RISCOM8_NORMAL_MAJOR
 48

	)

71 
	#DAC960_MAJOR
 48

	)

72 
	#RISCOM8_CALLOUT_MAJOR
 49

	)

73 
	#MKISS_MAJOR
 55

	)

74 
	#DSP56K_MAJOR
 55

	)

76 
	#IDE4_MAJOR
 56

	)

77 
	#IDE5_MAJOR
 57

	)

79 
	#SCSI_DISK1_MAJOR
 65

	)

80 
	#SCSI_DISK2_MAJOR
 66

	)

81 
	#SCSI_DISK3_MAJOR
 67

	)

82 
	#SCSI_DISK4_MAJOR
 68

	)

83 
	#SCSI_DISK5_MAJOR
 69

	)

84 
	#SCSI_DISK6_MAJOR
 70

	)

85 
	#SCSI_DISK7_MAJOR
 71

	)

87 
	#COMPAQ_SMART2_MAJOR
 72

	)

88 
	#COMPAQ_SMART2_MAJOR1
 73

	)

89 
	#COMPAQ_SMART2_MAJOR2
 74

	)

90 
	#COMPAQ_SMART2_MAJOR3
 75

	)

91 
	#COMPAQ_SMART2_MAJOR4
 76

	)

92 
	#COMPAQ_SMART2_MAJOR5
 77

	)

93 
	#COMPAQ_SMART2_MAJOR6
 78

	)

94 
	#COMPAQ_SMART2_MAJOR7
 79

	)

96 
	#SPECIALIX_NORMAL_MAJOR
 75

	)

97 
	#SPECIALIX_CALLOUT_MAJOR
 76

	)

99 
	#AURORA_MAJOR
 79

	)

101 
	#I2O_MAJOR
 80

	)

103 
	#SHMIQ_MAJOR
 85

	)

105 
	#IDE6_MAJOR
 88

	)

106 
	#IDE7_MAJOR
 89

	)

107 
	#IDE8_MAJOR
 90

	)

108 
	#IDE9_MAJOR
 91

	)

110 
	#DASD_MAJOR
 94

	)

112 
	#MDISK_MAJOR
 95

	)

114 
	#UBD_MAJOR
 98

	)

116 
	#JSFD_MAJOR
 99

	)

118 
	#PHONE_MAJOR
 100

	)

120 
	#COMPAQ_CISS_MAJOR
 104

	)

121 
	#COMPAQ_CISS_MAJOR1
 105

	)

122 
	#COMPAQ_CISS_MAJOR2
 106

	)

123 
	#COMPAQ_CISS_MAJOR3
 107

	)

124 
	#COMPAQ_CISS_MAJOR4
 108

	)

125 
	#COMPAQ_CISS_MAJOR5
 109

	)

126 
	#COMPAQ_CISS_MAJOR6
 110

	)

127 
	#COMPAQ_CISS_MAJOR7
 111

	)

129 
	#ATARAID_MAJOR
 114

	)

131 
	#SCSI_DISK8_MAJOR
 128

	)

132 
	#SCSI_DISK9_MAJOR
 129

	)

133 
	#SCSI_DISK10_MAJOR
 130

	)

134 
	#SCSI_DISK11_MAJOR
 131

	)

135 
	#SCSI_DISK12_MAJOR
 132

	)

136 
	#SCSI_DISK13_MAJOR
 133

	)

137 
	#SCSI_DISK14_MAJOR
 134

	)

138 
	#SCSI_DISK15_MAJOR
 135

	)

140 
	#UNIX98_PTY_MASTER_MAJOR
 128

	)

141 
	#UNIX98_PTY_MAJOR_COUNT
 8

	)

142 
	#UNIX98_PTY_SLAVE_MAJOR
 (
UNIX98_PTY_MASTER_MAJOR
+
UNIX98_PTY_MAJOR_COUNT
)

	)

144 
	#RTF_MAJOR
 150

	)

145 
	#RAW_MAJOR
 162

	)

147 
	#USB_ACM_MAJOR
 166

	)

148 
	#USB_ACM_AUX_MAJOR
 167

	)

149 
	#USB_CHAR_MAJOR
 180

	)

151 
	#VXVM_MAJOR
 199

	)

152 
	#VXSPEC_MAJOR
 200

	)

153 
	#VXDMP_MAJOR
 201

	)

155 
	#MSR_MAJOR
 202

	)

156 
	#CPUID_MAJOR
 203

	)

158 
	#OSST_MAJOR
 206

	)

160 
	#IBM_TTY3270_MAJOR
 227

	)

161 
	#IBM_FS3270_MAJOR
 228

	)

	@/usr/include/linux/nfs_fs_i.h

1 #i‚de‡
_NFS_FS_I


2 
	#_NFS_FS_I


	)

4 
	~<asm/ty≥s.h
>

5 
	~<löux/li°.h
>

6 
	~<löux/nfs.h
>

11 
	snfs_lock_öfo
 {

12 
u32
 
	m°©e
;

13 
u32
 
	mÊags
;

14 
∆m_ho°
 *
	mho°
;

20 
	#NFS_LCK_GRANTED
 0x0001

	)

21 
	#NFS_LCK_RECLAIM
 0x0002

	)

	@/usr/include/linux/posix_types.h

1 #i‚de‡
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<löux/°ddef.h
>

21 #unde‡
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #unde‡
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #unde‡
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #unde‡
__FDELT


31 
	#__FDELT
(
d
Ë((dË/ 
__NFDBITS
)

	)

33 #unde‡
__FDMASK


34 
	#__FDMASK
(
d
Ë(1UL << ((dË% 
__NFDBITS
))

	)

37 
	mfds_bôs
 [
__FDSET_LONGS
];

38 } 
	t__kî√l_fd_£t
;

41 (*
	t__kî√l_sigh™dÀr_t
)();

44 
	t__kî√l_key_t
;

46 
	~<asm/posix_ty≥s.h
>

	@/usr/include/linux/quota.h

35 #i‚de‡
_LINUX_QUOTA_


36 
	#_LINUX_QUOTA_


	)

38 
	~<löux/î∫o.h
>

39 
	~<löux/ty≥s.h
>

40 
	~<löux/•ölock.h
>

42 
	#__DQUOT_VERSION__
 "dquŸ_6.5.1"

	)

43 
	#__DQUOT_NUM_VERSION__
 6*10000+5*100+1

	)

45 
__kî√l_uid32_t
 
	tqid_t
;

46 
__u64
 
	tqsize_t
;

48 
•ölock_t
 
dq_li°_lock
;

49 
•ölock_t
 
dq_d©a_lock
;

52 
	#QUOTABLOCK_BITS
 10

	)

53 
	#QUOTABLOCK_SIZE
 (1 << 
QUOTABLOCK_BITS
)

	)

56 
	#qb2kb
(
x
Ë((xË<< (
QUOTABLOCK_BITS
-10))

	)

57 
	#kb2qb
(
x
Ë((xË>> (
QUOTABLOCK_BITS
-10))

	)

58 
	#toqb
(
x
Ë(((xË+ 
QUOTABLOCK_SIZE
 - 1Ë>> 
QUOTABLOCK_BITS
)

	)

60 
	#MAXQUOTAS
 2

	)

61 
	#USRQUOTA
 0

	)

62 
	#GRPQUOTA
 1

	)

67 
	#INITQFNAMES
 { \

71 };

	)

79 
	#SUBCMDMASK
 0x00ff

	)

80 
	#SUBCMDSHIFT
 8

	)

81 
	#QCMD
(
cmd
, 
ty≥
Ë(((cmdË<< 
SUBCMDSHIFT
Ë| (—y≥Ë& 
SUBCMDMASK
))

	)

83 
	#Q_SYNC
 0x800001

	)

84 
	#Q_QUOTAON
 0x800002

	)

85 
	#Q_QUOTAOFF
 0x800003

	)

86 
	#Q_GETFMT
 0x800004

	)

87 
	#Q_GETINFO
 0x800005

	)

88 
	#Q_SETINFO
 0x800006

	)

89 
	#Q_GETQUOTA
 0x800007

	)

90 
	#Q_SETQUOTA
 0x800008

	)

96 
	#QIF_BLIMITS
 1

	)

97 
	#QIF_SPACE
 2

	)

98 
	#QIF_ILIMITS
 4

	)

99 
	#QIF_INODES
 8

	)

100 
	#QIF_BTIME
 16

	)

101 
	#QIF_ITIME
 32

	)

102 
	#QIF_LIMITS
 (
QIF_BLIMITS
 | 
QIF_ILIMITS
)

	)

103 
	#QIF_USAGE
 (
QIF_SPACE
 | 
QIF_INODES
)

	)

104 
	#QIF_TIMES
 (
QIF_BTIME
 | 
QIF_ITIME
)

	)

105 
	#QIF_ALL
 (
QIF_LIMITS
 | 
QIF_USAGE
 | 
QIF_TIMES
)

	)

107 
	sif_dqblk
 {

108 
__u64
 
	mdqb_bh¨dlimô
;

109 
__u64
 
	mdqb_bso·limô
;

110 
__u64
 
	mdqb_cur•a˚
;

111 
__u64
 
	mdqb_ih¨dlimô
;

112 
__u64
 
	mdqb_iso·limô
;

113 
__u64
 
	mdqb_curöodes
;

114 
__u64
 
	mdqb_btime
;

115 
__u64
 
	mdqb_ôime
;

116 
__u32
 
	mdqb_vÆid
;

123 
	#IIF_BGRACE
 1

	)

124 
	#IIF_IGRACE
 2

	)

125 
	#IIF_FLAGS
 4

	)

126 
	#IIF_ALL
 (
IIF_BGRACE
 | 
IIF_IGRACE
 | 
IIF_FLAGS
)

	)

128 
	sif_dqöfo
 {

129 
__u64
 
	mdqi_bgø˚
;

130 
__u64
 
	mdqi_igø˚
;

131 
__u32
 
	mdqi_Êags
;

132 
__u32
 
	mdqi_vÆid
;

135 #ifde‡
__KERNEL__


137 
	~<löux/dqblk_xfs.h
>

138 
	~<löux/dqblk_v1.h
>

139 
	~<löux/dqblk_v2.h
>

144 
	smem_dqblk
 {

145 
__u32
 
	mdqb_bh¨dlimô
;

146 
__u32
 
	mdqb_bso·limô
;

147 
qsize_t
 
	mdqb_cur•a˚
;

148 
__u32
 
	mdqb_ih¨dlimô
;

149 
__u32
 
	mdqb_iso·limô
;

150 
__u32
 
	mdqb_curöodes
;

151 
time_t
 
	mdqb_btime
;

152 
time_t
 
	mdqb_ôime
;

158 
	gquŸa_f‹m©_ty≥
;

160 
	smem_dqöfo
 {

161 
quŸa_f‹m©_ty≥
 *
	mdqi_f‹m©
;

162 
	mdqi_Êags
;

163 
	mdqi_bgø˚
;

164 
	mdqi_igø˚
;

166 
v1_mem_dqöfo
 
	mv1_i
;

167 
v2_mem_dqöfo
 
	mv2_i
;

168 } 
	mu
;

171 
	#DQF_MASK
 0xfff‡

	)

172 
	#DQF_INFO_DIRTY_B
 16

	)

173 
	#DQF_ANY_DQUOT_DIRTY_B
 17

	)

174 
	#DQF_INFO_DIRTY
 (1 << 
DQF_INFO_DIRTY_B
Ë

	)

175 
	#DQF_ANY_DQUOT_DIRTY
 (1 << 
DQF_ANY_DQUOT_DIRTY_B
Ë

	)

177 
ölöe
 
	$m¨k_öfo_dúty
(
mem_dqöfo
 *
öfo
)

179 
	`£t_bô
(
DQF_INFO_DIRTY_B
, &
öfo
->
dqi_Êags
);

180 
	}
}

182 
	#öfo_dúty
(
öfo
Ë
	`ã°_bô
(
DQF_INFO_DIRTY_B
, &(öfo)->
dqi_Êags
)

	)

183 
	#öfo_™y_dquŸ_dúty
(
öfo
Ë
	`ã°_bô
(
DQF_ANY_DQUOT_DIRTY_B
, &(öfo)->
dqi_Êags
)

	)

184 
	#öfo_™y_dúty
(
öfo
Ë(
	`öfo_dúty
(öfoË|| 
	`öfo_™y_dquŸ_dúty
(öfo))

	)

186 
	#sb_dq›t
(
sb
Ë(&(sb)->
s_dquŸ
)

	)

188 
	sdq°©s
 {

189 
lookups
;

190 
dr›s
;

191 
ªads
;

192 
wrôes
;

193 
ˇche_hôs
;

194 
Æloˇãd_dquŸs
;

195 
‰ì_dquŸs
;

196 
syncs
;

199 
dq°©s
 dqstats;

201 
	#NR_DQHASH
 43

	)

203 
	#DQ_MOD_B
 0

	)

204 
	#DQ_BLKS_B
 1

	)

205 
	#DQ_INODES_B
 2

	)

206 
	#DQ_FAKE_B
 3

	)

208 
	#DQ_MOD
 (1 << 
DQ_MOD_B
Ë

	)

209 
	#DQ_BLKS
 (1 << 
DQ_BLKS_B
Ë

	)

210 
	#DQ_INODES
 (1 << 
DQ_INODES_B
Ë

	)

211 
	#DQ_FAKE
 (1 << 
DQ_FAKE_B
Ë

	)

213 
	sdquŸ
 {

214 
li°_hód
 
	mdq_hash
;

215 
li°_hód
 
	mdq_öu£
;

216 
li°_hód
 
	mdq_‰ì
;

217 
£m≠h‹e
 
	mdq_lock
;

218 
©omic_t
 
	mdq_cou¡
;

221 
su≥r_block
 *
	mdq_sb
;

222 
	mdq_id
;

223 
loff_t
 
	mdq_off
;

224 
	mdq_Êags
;

225 
	mdq_ty≥
;

226 
mem_dqblk
 
	mdq_dqb
;

229 
	#NODQUOT
 (
dquŸ
 *)
NULL


	)

231 
	#QUOTA_OK
 0

	)

232 
	#NO_QUOTA
 1

	)

235 
	squŸa_f‹m©_›s
 {

236 (*
	mcheck_quŸa_fûe
)(
su≥r_block
 *
	msb
, 
	mty≥
);

237 (*
	mªad_fûe_öfo
)(
su≥r_block
 *
	msb
, 
	mty≥
);

238 (*
	mwrôe_fûe_öfo
)(
su≥r_block
 *
	msb
, 
	mty≥
);

239 (*
	m‰ì_fûe_öfo
)(
su≥r_block
 *
	msb
, 
	mty≥
);

240 (*
	mªad_dqblk
)(
dquŸ
 *
	mdquŸ
);

241 (*
	mcommô_dqblk
)(
dquŸ
 *
	mdquŸ
);

245 
	sdquŸ_›î©i⁄s
 {

246 (*
	möôülize
Ë(
	möode
 *, );

247 (*
	mdr›
Ë(
	möode
 *);

248 (*
	mÆloc_•a˚
Ë(
	möode
 *, 
	mqsize_t
, );

249 (*
	mÆloc_öode
Ë(c⁄° 
	möode
 *, );

250 (*
	m‰ì_•a˚
Ë(
	möode
 *, 
	mqsize_t
);

251 (*
	m‰ì_öode
Ë(c⁄° 
	möode
 *, );

252 (*
	må™s„r
Ë(
	möode
 *, 
	müâr
 *);

253 (*
	msync_dquŸ
Ë(
	mdquŸ
 *);

257 
	squŸa˘l_›s
 {

258 (*
	mquŸa_⁄
)(
	msu≥r_block
 *, , , *);

259 (*
	mquŸa_off
)(
	msu≥r_block
 *, );

260 (*
	mquŸa_sync
)(
	msu≥r_block
 *, );

261 (*
	mgë_öfo
)(
	msu≥r_block
 *, , 
	mif_dqöfo
 *);

262 (*
	m£t_öfo
)(
	msu≥r_block
 *, , 
	mif_dqöfo
 *);

263 (*
	mgë_dqblk
)(
	msu≥r_block
 *, , 
	mqid_t
, 
	mif_dqblk
 *);

264 (*
	m£t_dqblk
)(
	msu≥r_block
 *, , 
	mqid_t
, 
	mif_dqblk
 *);

265 (*
	mgë_x°©e
)(
	msu≥r_block
 *, 
	mfs_quŸa_°©
 *);

266 (*
	m£t_x°©e
)(
	msu≥r_block
 *, , );

267 (*
	mgë_xquŸa
)(
	msu≥r_block
 *, , 
	mqid_t
, 
	mfs_disk_quŸa
 *);

268 (*
	m£t_xquŸa
)(
	msu≥r_block
 *, , 
	mqid_t
, 
	mfs_disk_quŸa
 *);

271 
	squŸa_f‹m©_ty≥
 {

272 
	mqf_fmt_id
;

273 
quŸa_f‹m©_›s
 *
	mqf_›s
;

274 
moduÀ
 *
	mqf_ow√r
;

275 
quŸa_f‹m©_ty≥
 *
	mqf_√xt
;

278 
	#DQUOT_USR_ENABLED
 0x01

	)

279 
	#DQUOT_GRP_ENABLED
 0x02

	)

281 
	squŸa_öfo
 {

282 
	mÊags
;

283 
£m≠h‹e
 
	mdqio_£m
;

284 
£m≠h‹e
 
	mdq⁄off_£m
;

285 
rw_£m≠h‹e
 
	mdq±r_£m
;

286 
fûe
 *
	mfûes
[
MAXQUOTAS
];

287 
mem_dqöfo
 
	möfo
[
MAXQUOTAS
];

288 
quŸa_f‹m©_›s
 *
	m›s
[
MAXQUOTAS
];

292 
	#m¨k_dquŸ_dúty
(
dquŸ
) do {\

293 
	`£t_bô
(
DQF_ANY_DQUOT_DIRTY_B
, &(
	`sb_dq›t
((
dquŸ
)->
dq_sb
)->
öfo
[(dquŸ)->
dq_ty≥
].
dqi_Êags
));\

294 
	`£t_bô
(
DQ_MOD_B
, &(
dquŸ
)->
dq_Êags
);\

295 } 0)

	)

297 
	#dquŸ_dúty
(
dquŸ
Ë
	`ã°_bô
(
DQ_MOD_B
, &(dquŸ)->
dq_Êags
)

	)

299 
	#sb_has_quŸa_íabÀd
(
sb
, 
ty≥
Ë(—y≥)==
USRQUOTA
 ? \

300 (
	`sb_dq›t
(
sb
)->
Êags
 & 
DQUOT_USR_ENABLED
Ë: (sb_dq›t(sb)->Êag†& 
DQUOT_GRP_ENABLED
))

	)

302 
	#sb_™y_quŸa_íabÀd
(
sb
Ë(
	`sb_has_quŸa_íabÀd
(sb, 
USRQUOTA
) | \

303 
	`sb_has_quŸa_íabÀd
(
sb
, 
GRPQUOTA
))

	)

305 
ªgi°î_quŸa_f‹m©
(
quŸa_f‹m©_ty≥
 *
fmt
);

306 
uƒegi°î_quŸa_f‹m©
(
quŸa_f‹m©_ty≥
 *
fmt
);

307 
öô_dquŸ_›î©i⁄s
(
dquŸ_›î©i⁄s
 *
fsdq›s
);

309 
	squŸa_moduÀ_«me
 {

310 
	mqm_fmt_id
;

311 *
	mqm_mod_«me
;

314 
	#INIT_QUOTA_MODULE_NAMES
 {\

315 {
QFMT_VFS_OLD
, "quota_v1"},\

316 {
QFMT_VFS_V0
, "quota_v2"},\

317 {0, 
NULL
}}

	)

321 #/* 
nodï
 */ 
ö˛ude
 <
sys
/
cdefs
.
h
>

323 
__BEGIN_DECLS


324 
quŸa˘l
 
__P
 ((, c⁄° *, , 
ˇddr_t
));

325 
	g__END_DECLS


	@/usr/include/linux/radix-tree.h

19 #i‚de‡
_LINUX_RADIX_TREE_H


20 
	#_LINUX_RADIX_TREE_H


	)

22 #ifde‡
__KERNEL__


24 
	~<löux/¥ìm±.h
>

26 
	gødix_åì_node
;

28 
	sødix_åì_roŸ
 {

29 
	mheight
;

30 
	mgÂ_mask
;

31 
ødix_åì_node
 *
	m∫ode
;

34 
	#RADIX_TREE_INIT
(
mask
Ë{0, (mask), 
NULL
}

	)

36 
	#RADIX_TREE
(
«me
, 
mask
) \

37 
ødix_åì_roŸ
 
«me
 = 
	`RADIX_TREE_INIT
(
mask
)

	)

39 
	#INIT_RADIX_TREE
(
roŸ
, 
mask
) \

41 (
roŸ
)->
height
 = 0; \

42 (
roŸ
)->
gÂ_mask
 = (
mask
); \

43 (
roŸ
)->
∫ode
 = 
NULL
; \

44 } 0)

	)

46 
ødix_åì_ö£π
(
ødix_åì_roŸ
 *, , *);

47 *
ødix_åì_lookup
(
ødix_åì_roŸ
 *, );

48 *
ødix_åì_dñëe
(
ødix_åì_roŸ
 *, );

50 
ødix_åì_g™g_lookup
(
ødix_åì_roŸ
 *
roŸ
, **
ªsu…s
,

51 
fú°_ödex
, 
max_ôems
);

52 
ødix_åì_¥ñﬂd
(
gÂ_mask
);

54 
ölöe
 
	$ødix_åì_¥ñﬂd_íd
()

56 
	`¥ìm±_íabÀ
();

57 
	}
}

	@/usr/include/linux/seqlock.h

1 #i‚de‡
__LINUX_SEQLOCK_H


2 
	#__LINUX_SEQLOCK_H


	)

29 
	~<löux/c⁄fig.h
>

30 
	~<löux/•ölock.h
>

31 
	~<löux/¥ìm±.h
>

34 
	m£quí˚
;

35 
•ölock_t
 
	mlock
;

36 } 
	t£qlock_t
;

42 
	#SEQLOCK_UNLOCKED
 { 0, 
SPIN_LOCK_UNLOCKED
 }

	)

43 
	#£qlock_öô
(
x
Ëdÿ{ *(xË(
£qlock_t
Ë
SEQLOCK_UNLOCKED
; } 0)

	)

50 
ölöe
 
	$wrôe_£qlock
(
£qlock_t
 *
¶
)

52 
	`•ö_lock
(&
¶
->
lock
);

53 ++
¶
->
£quí˚
;

54 
	`smp_wmb
();

55 
	}
}

57 
ölöe
 
	$wrôe_£qu∆ock
(
£qlock_t
 *
¶
)

59 
	`smp_wmb
();

60 
¶
->
£quí˚
++;

61 
	`•ö_u∆ock
(&
¶
->
lock
);

62 
	}
}

64 
ölöe
 
	$wrôe_åy£qlock
(
£qlock_t
 *
¶
)

66 
ªt
 = 
	`•ö_åylock
(&
¶
->
lock
);

68 i‡(
ªt
) {

69 ++
¶
->
£quí˚
;

70 
	`smp_wmb
();

72  
ªt
;

73 
	}
}

76 
ölöe
 
	$ªad_£qbegö
(c⁄° 
£qlock_t
 *
¶
)

78 
ªt
 = 
¶
->
£quí˚
;

79 
	`smp_rmb
();

80  
ªt
;

81 
	}
}

91 
ölöe
 
	$ªad_£qªåy
(c⁄° 
£qlock_t
 *
¶
, 
iv
)

93 
	`smp_rmb
();

94  (
iv
 & 1Ë| (
¶
->
£quí˚
 ^ iv);

95 
	}
}

105 
	s£qcou¡
 {

106 
	m£quí˚
;

107 } 
	t£qcou¡_t
;

109 
	#SEQCNT_ZERO
 { 0 }

	)

110 
	#£qcou¡_öô
(
x
Ëdÿ{ *(xË(
£qcou¡_t
Ë
SEQCNT_ZERO
; } 0)

	)

113 
ölöe
 
	$ªad_£qcou¡_begö
(c⁄° 
£qcou¡_t
 *
s
)

115 
ªt
 = 
s
->
£quí˚
;

116 
	`smp_rmb
();

117  
ªt
;

118 
	}
}

125 
ölöe
 
	$ªad_£qcou¡_ªåy
(c⁄° 
£qcou¡_t
 *
s
, 
iv
)

127 
	`smp_rmb
();

128  (
iv
 & 1Ë| (
s
->
£quí˚
 ^ iv);

129 
	}
}

136 
ölöe
 
	$wrôe_£qcou¡_begö
(
£qcou¡_t
 *
s
)

138 
s
->
£quí˚
++;

139 
	`smp_wmb
();

140 
	}
}

142 
ölöe
 
	$wrôe_£qcou¡_íd
(
£qcou¡_t
 *
s
)

144 
	`smp_wmb
();

145 
s
->
£quí˚
++;

146 
	}
}

151 
	#wrôe_£qlock_úqßve
(
lock
, 
Êags
) \

152 dÿ{ 
	`loˇl_úq_ßve
(
Êags
); 
	`wrôe_£qlock
(
lock
); } 0)

	)

153 
	#wrôe_£qlock_úq
(
lock
) \

154 dÿ{ 
	`loˇl_úq_dißbÀ
(); 
	`wrôe_£qlock
(
lock
); } 0)

	)

155 
	#wrôe_£qlock_bh
(
lock
) \

156 dÿ{ 
	`loˇl_bh_dißbÀ
(); 
	`wrôe_£qlock
(
lock
); } 0)

	)

158 
	#wrôe_£qu∆ock_úqª°‹e
(
lock
, 
Êags
) \

159 dÿ{ 
	`wrôe_£qu∆ock
(
lock
); 
	`loˇl_úq_ª°‹e
(
Êags
); } 0)

	)

160 
	#wrôe_£qu∆ock_úq
(
lock
) \

161 dÿ{ 
	`wrôe_£qu∆ock
(
lock
); 
	`loˇl_úq_íabÀ
(); } 0)

	)

162 
	#wrôe_£qu∆ock_bh
(
lock
) \

163 dÿ{ 
	`wrôe_£qu∆ock
(
lock
); 
	`loˇl_bh_íabÀ
(); } 0)

	)

165 
	#ªad_£qbegö_úqßve
(
lock
, 
Êags
) \

166 ({ 
	`loˇl_úq_ßve
(
Êags
); 
	`ªad_£qbegö
(
lock
); })

	)

168 
	#ªad_£qªåy_úqª°‹e
(
lock
, 
iv
, 
Êags
) \

170 
ªt
 = 
	`ªad_£qªåy
(
lock
, 
iv
); \

171 
	`loˇl_úq_ª°‹e
(
Êags
); \

172 
ªt
; \

173 })

	)

	@/usr/include/linux/spinlock.h

1 #i‚de‡
__LINUX_SPINLOCK_H


2 
	#__LINUX_SPINLOCK_H


	)

4 #i‚de‡
__KERNEL__


6 °ru˘ { 
	mem±y
; } 
	t•ölock_t
;

7 °ru˘ { 
	mem±y
; } 
	trwlock_t
;

15 
	~<löux/c⁄fig.h
>

16 
	~<löux/¥ìm±.h
>

17 
	~<löux/lökage.h
>

18 
	~<löux/compûî.h
>

19 
	~<löux/thªad_öfo.h
>

20 
	~<löux/kî√l.h
>

21 
	~<löux/°rögify.h
>

23 
	~<asm/¥o˚ss‹.h
>

24 
	~<asm/sy°em.h
>

29 
	#LOCK_SECTION_NAME
 \

30 ".ãxt.lock." 
	`__°rögify
(
KBUILD_BASENAME
)

	)

32 
	#LOCK_SECTION_START
(
exåa
) \

34 
exåa
 \

35 ".i‚de‡" 
LOCK_SECTION_NAME
 "\n\t" \

36 
LOCK_SECTION_NAME
 ":\n\t" \

37 ".ídif\n\t"

	)

39 
	#LOCK_SECTION_END
 \

40 ".¥evious\n\t"

	)

45 #ifde‡
CONFIG_SMP


46 
	~<asm/•ölock.h
>

50 #i‡!
deföed
(
CONFIG_PREEMPT
Ë&& !deföed(
CONFIG_DEBUG_SPINLOCK
)

51 
	#©omic_dec_™d_lock
(
©omic
,
lock
Ë
	`©omic_dec_™d_ã°
◊tomic)

	)

52 
	#ATOMIC_DEC_AND_LOCK


	)

55 #ifde‡
CONFIG_DEBUG_SPINLOCK


57 
	#SPINLOCK_MAGIC
 0x1D244B3C

	)

59 
	mmagic
;

60 vﬁ©ûê
	mlock
;

61 vﬁ©ûê
	mbabbÀ
;

62 c⁄° *
	mmoduÀ
;

63 *
	mow√r
;

64 
	mﬁöe
;

65 } 
	t•ölock_t
;

66 
	#SPIN_LOCK_UNLOCKED
 (
•ölock_t
Ë{ 
SPINLOCK_MAGIC
, 0, 10, 
__FILE__
 , 
NULL
, 0}

	)

68 
	#•ö_lock_öô
(
x
) \

70 (
x
)->
magic
 = 
SPINLOCK_MAGIC
; \

71 (
x
)->
lock
 = 0; \

72 (
x
)->
babbÀ
 = 5; \

73 (
x
)->
moduÀ
 = 
__FILE__
; \

74 (
x
)->
ow√r
 = 
NULL
; \

75 (
x
)->
ﬁöe
 = 0; \

76 } 0)

	)

78 
	#CHECK_LOCK
(
x
) \

80 i‡((
x
)->
magic
 !
SPINLOCK_MAGIC
) { \

81 
	`¥ötk
(
KERN_ERR
 "%s:%d: spin_is_locked on uninitialized spinlock %p.\n", \

82 
__FILE__
, 
__LINE__
, (
x
)); \

84 } 0)

	)

86 
	#_øw_•ö_lock
(
x
) \

88 
	`CHECK_LOCK
(
x
); \

89 i‡((
x
)->
lock
&&(x)->
babbÀ
) { \

90 (
x
)->
babbÀ
--; \

91 
	`¥ötk
("%s:%d: spin_lock(%s:%p)álreadyÜocked by %s/%d\n", \

92 
__FILE__
,
__LINE__
, (
x
)->
moduÀ
, \

93 (
x
), (x)->
ow√r
, (x)->
ﬁöe
); \

95 (
x
)->
lock
 = 1; \

96 (
x
)->
ow√r
 = 
__FILE__
; \

97 (
x
)->
ﬁöe
 = 
__LINE__
; \

98 } 0)

	)

102 
	#•ö_is_locked
(
x
) \

104 
	`CHECK_LOCK
(
x
); \

105 i‡((
x
)->
lock
&&(x)->
babbÀ
) { \

106 (
x
)->
babbÀ
--; \

107 
	`¥ötk
("%s:%d: spin_is_locked(%s:%p)álreadyÜocked by %s/%d\n", \

108 
__FILE__
,
__LINE__
, (
x
)->
moduÀ
, \

109 (
x
), (x)->
ow√r
, (x)->
ﬁöe
); \

112 })

	)

116 
	#_øw_•ö_åylock
(
x
) \

118 
	`CHECK_LOCK
(
x
); \

119 i‡((
x
)->
lock
&&(x)->
babbÀ
) { \

120 (
x
)->
babbÀ
--; \

121 
	`¥ötk
("%s:%d: spin_trylock(%s:%p)álreadyÜocked by %s/%d\n", \

122 
__FILE__
,
__LINE__
, (
x
)->
moduÀ
, \

123 (
x
), (x)->
ow√r
, (x)->
ﬁöe
); \

125 (
x
)->
lock
 = 1; \

126 (
x
)->
ow√r
 = 
__FILE__
; \

127 (
x
)->
ﬁöe
 = 
__LINE__
; \

129 })

	)

131 
	#•ö_u∆ock_waô
(
x
) \

133 
	`CHECK_LOCK
(
x
); \

134 i‡((
x
)->
lock
&&(x)->
babbÀ
) { \

135 (
x
)->
babbÀ
--; \

136 
	`¥ötk
("%s:%d: spin_unlock_wait(%s:%p) owned by %s/%d\n", \

137 
__FILE__
,
__LINE__
, (
x
)->
moduÀ
, (x), \

138 (
x
)->
ow√r
, (x)->
ﬁöe
); \

140 } 0)

	)

142 
	#_øw_•ö_u∆ock
(
x
) \

144 
	`CHECK_LOCK
(
x
); \

145 i‡(!(
x
)->
lock
&&(x)->
babbÀ
) { \

146 (
x
)->
babbÀ
--; \

147 
	`¥ötk
("%s:%d: spin_unlock(%s:%p)ÇotÜocked\n", \

148 
__FILE__
,
__LINE__
, (
x
)->
moduÀ
, (x));\

150 (
x
)->
lock
 = 0; \

151 } 0)

	)

156 #i‡(
__GNUC__
 > 2)

157 °ru˘ { } 
	g•ölock_t
;

158 
	#SPIN_LOCK_UNLOCKED
 (
•ölock_t
Ë{ }

	)

160 °ru˘ { 
	mgcc_is_buggy
; } 
	t•ölock_t
;

161 
	#SPIN_LOCK_UNLOCKED
 (
•ölock_t
Ë{ 0 }

	)

167 
	#•ö_lock_öô
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

168 
	#_øw_•ö_lock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

169 
	#•ö_is_locked
(
lock
Ë(()÷ock), 0)

	)

170 
	#_øw_•ö_åylock
(
lock
Ë(()÷ock), 1)

	)

171 
	#•ö_u∆ock_waô
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

172 
	#_øw_•ö_u∆ock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

177 #i‡(
__GNUC__
 > 2)

178 °ru˘ { } 
	grwlock_t
;

179 
	#RW_LOCK_UNLOCKED
 (
rwlock_t
Ë{ }

	)

181 °ru˘ { 
	mgcc_is_buggy
; } 
	trwlock_t
;

182 
	#RW_LOCK_UNLOCKED
 (
rwlock_t
Ë{ 0 }

	)

185 
	#rwlock_öô
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

186 
	#_øw_ªad_lock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

187 
	#_øw_ªad_u∆ock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

188 
	#_øw_wrôe_lock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

189 
	#_øw_wrôe_u∆ock
(
lock
Ëdÿ{ ()÷ock); } 0)

	)

190 
	#_øw_wrôe_åylock
(
lock
Ë({ ()÷ock); (1); })

	)

199 
	#•ö_åylock
(
lock
Ë({
	`¥ìm±_dißbÀ
(); 
	`_øw_•ö_åylock
(lock) ? \

200 1 : ({
	`¥ìm±_íabÀ
(); 0;});})

	)

202 
	#wrôe_åylock
(
lock
Ë({
	`¥ìm±_dißbÀ
();
	`_øw_wrôe_åylock
(lock) ? \

203 1 : ({
	`¥ìm±_íabÀ
(); 0;});})

	)

207 #i‡
deföed
(
CONFIG_SMP
Ë&& deföed(
CONFIG_PREEMPT
)

208 
__¥ìm±_•ö_lock
(
•ölock_t
 *
lock
);

209 
__¥ìm±_wrôe_lock
(
rwlock_t
 *
lock
);

211 
	#•ö_lock
(
lock
) \

213 
	`¥ìm±_dißbÀ
(); \

214 i‡(
	`u∆ikñy
(!
	`_øw_•ö_åylock
(
lock
))) \

215 
	`__¥ìm±_•ö_lock
(
lock
); \

216 } 0)

	)

218 
	#wrôe_lock
(
lock
) \

220 
	`¥ìm±_dißbÀ
(); \

221 i‡(
	`u∆ikñy
(!
	`_øw_wrôe_åylock
(
lock
))) \

222 
	`__¥ìm±_wrôe_lock
(
lock
); \

223 } 0)

	)

226 
	#•ö_lock
(
lock
) \

228 
	`¥ìm±_dißbÀ
(); \

229 
	`_øw_•ö_lock
(
lock
); \

230 } 0)

	)

232 
	#wrôe_lock
(
lock
) \

234 
	`¥ìm±_dißbÀ
(); \

235 
	`_øw_wrôe_lock
(
lock
); \

236 } 0)

	)

239 
	#ªad_lock
(
lock
) \

241 
	`¥ìm±_dißbÀ
(); \

242 
	`_øw_ªad_lock
(
lock
); \

243 } 0)

	)

245 
	#•ö_u∆ock
(
lock
) \

247 
	`_øw_•ö_u∆ock
(
lock
); \

248 
	`¥ìm±_íabÀ
(); \

249 } 0)

	)

251 
	#wrôe_u∆ock
(
lock
) \

253 
	`_øw_wrôe_u∆ock
(
lock
); \

254 
	`¥ìm±_íabÀ
(); \

255 } 0)

	)

257 
	#ªad_u∆ock
(
lock
) \

259 
	`_øw_ªad_u∆ock
(
lock
); \

260 
	`¥ìm±_íabÀ
(); \

261 } 0)

	)

263 
	#•ö_lock_úqßve
(
lock
, 
Êags
) \

265 
	`loˇl_úq_ßve
(
Êags
); \

266 
	`¥ìm±_dißbÀ
(); \

267 
	`_øw_•ö_lock
(
lock
); \

268 } 0)

	)

270 
	#•ö_lock_úq
(
lock
) \

272 
	`loˇl_úq_dißbÀ
(); \

273 
	`¥ìm±_dißbÀ
(); \

274 
	`_øw_•ö_lock
(
lock
); \

275 } 0)

	)

277 
	#•ö_lock_bh
(
lock
) \

279 
	`loˇl_bh_dißbÀ
(); \

280 
	`¥ìm±_dißbÀ
(); \

281 
	`_øw_•ö_lock
(
lock
); \

282 } 0)

	)

284 
	#ªad_lock_úqßve
(
lock
, 
Êags
) \

286 
	`loˇl_úq_ßve
(
Êags
); \

287 
	`¥ìm±_dißbÀ
(); \

288 
	`_øw_ªad_lock
(
lock
); \

289 } 0)

	)

291 
	#ªad_lock_úq
(
lock
) \

293 
	`loˇl_úq_dißbÀ
(); \

294 
	`¥ìm±_dißbÀ
(); \

295 
	`_øw_ªad_lock
(
lock
); \

296 } 0)

	)

298 
	#ªad_lock_bh
(
lock
) \

300 
	`loˇl_bh_dißbÀ
(); \

301 
	`¥ìm±_dißbÀ
(); \

302 
	`_øw_ªad_lock
(
lock
); \

303 } 0)

	)

305 
	#wrôe_lock_úqßve
(
lock
, 
Êags
) \

307 
	`loˇl_úq_ßve
(
Êags
); \

308 
	`¥ìm±_dißbÀ
(); \

309 
	`_øw_wrôe_lock
(
lock
); \

310 } 0)

	)

312 
	#wrôe_lock_úq
(
lock
) \

314 
	`loˇl_úq_dißbÀ
(); \

315 
	`¥ìm±_dißbÀ
(); \

316 
	`_øw_wrôe_lock
(
lock
); \

317 } 0)

	)

319 
	#wrôe_lock_bh
(
lock
) \

321 
	`loˇl_bh_dißbÀ
(); \

322 
	`¥ìm±_dißbÀ
(); \

323 
	`_øw_wrôe_lock
(
lock
); \

324 } 0)

	)

326 
	#•ö_u∆ock_úqª°‹e
(
lock
, 
Êags
) \

328 
	`_øw_•ö_u∆ock
(
lock
); \

329 
	`loˇl_úq_ª°‹e
(
Êags
); \

330 
	`¥ìm±_íabÀ
(); \

331 } 0)

	)

333 
	#_øw_•ö_u∆ock_úqª°‹e
(
lock
, 
Êags
) \

335 
	`_øw_•ö_u∆ock
(
lock
); \

336 
	`loˇl_úq_ª°‹e
(
Êags
); \

337 } 0)

	)

339 
	#•ö_u∆ock_úq
(
lock
) \

341 
	`_øw_•ö_u∆ock
(
lock
); \

342 
	`loˇl_úq_íabÀ
(); \

343 
	`¥ìm±_íabÀ
(); \

344 } 0)

	)

346 
	#•ö_u∆ock_bh
(
lock
) \

348 
	`_øw_•ö_u∆ock
(
lock
); \

349 
	`¥ìm±_íabÀ
(); \

350 
	`loˇl_bh_íabÀ
(); \

351 } 0)

	)

353 
	#ªad_u∆ock_úqª°‹e
(
lock
, 
Êags
) \

355 
	`_øw_ªad_u∆ock
(
lock
); \

356 
	`loˇl_úq_ª°‹e
(
Êags
); \

357 
	`¥ìm±_íabÀ
(); \

358 } 0)

	)

360 
	#ªad_u∆ock_úq
(
lock
) \

362 
	`_øw_ªad_u∆ock
(
lock
); \

363 
	`loˇl_úq_íabÀ
(); \

364 
	`¥ìm±_íabÀ
(); \

365 } 0)

	)

367 
	#ªad_u∆ock_bh
(
lock
) \

369 
	`_øw_ªad_u∆ock
(
lock
); \

370 
	`¥ìm±_íabÀ
(); \

371 
	`loˇl_bh_íabÀ
(); \

372 } 0)

	)

374 
	#wrôe_u∆ock_úqª°‹e
(
lock
, 
Êags
) \

376 
	`_øw_wrôe_u∆ock
(
lock
); \

377 
	`loˇl_úq_ª°‹e
(
Êags
); \

378 
	`¥ìm±_íabÀ
(); \

379 } 0)

	)

381 
	#wrôe_u∆ock_úq
(
lock
) \

383 
	`_øw_wrôe_u∆ock
(
lock
); \

384 
	`loˇl_úq_íabÀ
(); \

385 
	`¥ìm±_íabÀ
(); \

386 } 0)

	)

388 
	#wrôe_u∆ock_bh
(
lock
) \

390 
	`_øw_wrôe_u∆ock
(
lock
); \

391 
	`¥ìm±_íabÀ
(); \

392 
	`loˇl_bh_íabÀ
(); \

393 } 0)

	)

395 
	#•ö_åylock_bh
(
lock
Ë({ 
	`loˇl_bh_dißbÀ
(); 
	`¥ìm±_dißbÀ
(); \

396 
	`_øw_•ö_åylock
(
lock
) ? 1 : \

397 ({
	`¥ìm±_íabÀ
(); 
	`loˇl_bh_íabÀ
(); 0;});})

	)

400 #i‚de‡
ATOMIC_DEC_AND_LOCK


401 
	~<asm/©omic.h
>

402 
©omic_dec_™d_lock
(
©omic_t
 *
©omic
, 
•ölock_t
 *
lock
);

411 
ölöe
 
	$bô_•ö_lock
(
bônum
, *
addr
)

420 
	`¥ìm±_dißbÀ
();

421 #i‡
	`deföed
(
CONFIG_SMP
Ë|| deföed(
CONFIG_DEBUG_SPINLOCK
)

422 
	`ã°_™d_£t_bô
(
bônum
, 
addr
)) {

423 
	`ã°_bô
(
bônum
, 
addr
))

424 
	`˝u_ªœx
();

427 
	}
}

432 
ölöe
 
	$bô_•ö_åylock
(
bônum
, *
addr
)

434 #i‡
	`deföed
(
CONFIG_SMP
Ë|| deföed(
CONFIG_DEBUG_SPINLOCK
)

435 
ªt
;

437 
	`¥ìm±_dißbÀ
();

438 
ªt
 = !
	`ã°_™d_£t_bô
(
bônum
, 
addr
);

439 i‡(!
ªt
)

440 
	`¥ìm±_íabÀ
();

441  
ªt
;

443 
	`¥ìm±_dißbÀ
();

446 
	}
}

451 
ölöe
 
	$bô_•ö_u∆ock
(
bônum
, *
addr
)

453 #i‡
	`deföed
(
CONFIG_SMP
Ë|| deföed(
CONFIG_DEBUG_SPINLOCK
)

454 
	`BUG_ON
(!
	`ã°_bô
(
bônum
, 
addr
));

455 
	`smp_mb__bef‹e_˛ór_bô
();

456 
	`˛ór_bô
(
bônum
, 
addr
);

458 
	`¥ìm±_íabÀ
();

459 
	}
}

464 
ölöe
 
	$bô_•ö_is_locked
(
bônum
, *
addr
)

466 #i‡
	`deföed
(
CONFIG_SMP
Ë|| deföed(
CONFIG_DEBUG_SPINLOCK
)

467  
	`ã°_bô
(
bônum
, 
addr
);

468 #ñi‡
deföed
 
CONFIG_PREEMPT


469  
	`¥ìm±_cou¡
();

473 
	}
}

	@/usr/include/linux/stat.h

1 #i‚de‡
_LINUX_STAT_H


2 
	#_LINUX_STAT_H


	)

4 #ifde‡
__KERNEL__


6 
	~<asm/°©.h
>

10 #i‡
deföed
(
__KERNEL__
Ë|| !deföed(
__GLIBC__
) || (__GLIBC__ < 2)

12 
	#S_IFMT
 00170000

	)

13 
	#S_IFSOCK
 0140000

	)

14 
	#S_IFLNK
 0120000

	)

15 
	#S_IFREG
 0100000

	)

16 
	#S_IFBLK
 0060000

	)

17 
	#S_IFDIR
 0040000

	)

18 
	#S_IFCHR
 0020000

	)

19 
	#S_IFIFO
 0010000

	)

20 
	#S_ISUID
 0004000

	)

21 
	#S_ISGID
 0002000

	)

22 
	#S_ISVTX
 0001000

	)

24 
	#S_ISLNK
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFLNK
)

	)

25 
	#S_ISREG
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFREG
)

	)

26 
	#S_ISDIR
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFDIR
)

	)

27 
	#S_ISCHR
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFCHR
)

	)

28 
	#S_ISBLK
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFBLK
)

	)

29 
	#S_ISFIFO
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFIFO
)

	)

30 
	#S_ISSOCK
(
m
Ë(((mË& 
S_IFMT
Ë=
S_IFSOCK
)

	)

32 
	#S_IRWXU
 00700

	)

33 
	#S_IRUSR
 00400

	)

34 
	#S_IWUSR
 00200

	)

35 
	#S_IXUSR
 00100

	)

37 
	#S_IRWXG
 00070

	)

38 
	#S_IRGRP
 00040

	)

39 
	#S_IWGRP
 00020

	)

40 
	#S_IXGRP
 00010

	)

42 
	#S_IRWXO
 00007

	)

43 
	#S_IROTH
 00004

	)

44 
	#S_IWOTH
 00002

	)

45 
	#S_IXOTH
 00001

	)

49 #ifde‡
__KERNEL__


50 
	#S_IRWXUGO
 (
S_IRWXU
|
S_IRWXG
|
S_IRWXO
)

	)

51 
	#S_IALLUGO
 (
S_ISUID
|
S_ISGID
|
S_ISVTX
|
S_IRWXUGO
)

	)

52 
	#S_IRUGO
 (
S_IRUSR
|
S_IRGRP
|
S_IROTH
)

	)

53 
	#S_IWUGO
 (
S_IWUSR
|
S_IWGRP
|
S_IWOTH
)

	)

54 
	#S_IXUGO
 (
S_IXUSR
|
S_IXGRP
|
S_IXOTH
)

	)

56 
	~<löux/ty≥s.h
>

57 
	~<löux/time.h
>

59 
	sk°©
 {

60 
	möo
;

61 
dev_t
 
	mdev
;

62 
umode_t
 
	mmode
;

63 
∆ök_t
 
	m∆ök
;

64 
uid_t
 
	muid
;

65 
gid_t
 
	mgid
;

66 
dev_t
 
	mrdev
;

67 
loff_t
 
	msize
;

68 
time•ec
 
	m©ime
;

69 
time•ec
 
	mmtime
;

70 
time•ec
 
	m˘ime
;

71 
	mblksize
;

72 
	mblocks
;

	@/usr/include/linux/stddef.h

1 #i‚de‡
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

4 #unde‡
NULL


5 #i‡
deföed
(
__˝lu•lus
)

6 
	#NULL
 0

	)

8 
	#NULL
 ((*)0)

	)

11 #unde‡
off£tof


12 
	#off£tof
(
TYPE
, 
MEMBER
Ë((
size_t
Ë&((TYPE *)0)->MEMBER)

	)

	@/usr/include/linux/termios.h

1 #i‚de‡
_LINUX_TERMIOS_H


2 
	#_LINUX_TERMIOS_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<asm/ãrmios.h
>

	@/usr/include/linux/time.h

1 #i‚de‡
_LINUX_TIME_H


2 
	#_LINUX_TIME_H


	)

4 #i‚de‡
__KERNEL__


5 
	~<time.h
>

8 
	~<asm/∑øm.h
>

9 
	~<löux/ty≥s.h
>

11 #i‚de‡
_STRUCT_TIMESPEC


12 
	#_STRUCT_TIMESPEC


	)

13 
	stime•ec
 {

14 
time_t
 
	mtv_£c
;

15 
	mtv_n£c
;

19 
	stimevÆ
 {

20 
time_t
 
	mtv_£c
;

21 
su£c⁄ds_t
 
	mtv_u£c
;

24 
	stimez⁄e
 {

25 
	mtz_möuãswe°
;

26 
	mtz_d°time
;

29 #ifde‡
__KERNEL__


31 
	~<löux/•ölock.h
>

32 
	~<löux/£qlock.h
>

33 
	~<löux/timex.h
>

34 
	~<asm/div64.h
>

35 #i‚de‡
div_l⁄g_l⁄g_ªm


37 
	#div_l⁄g_l⁄g_ªm
(
dividíd
,
divis‹
,
ªmaödî
) ({ \

38 
u64
 
ªsu…
 = 
dividíd
; \

39 *
ªmaödî
 = 
	`do_div
(
ªsu…
,
divis‹
); \

40 
ªsu…
; })

	)

48 
	#INITIAL_JIFFIES
 (()(Ë(-300*
HZ
))

	)

62 
	#MAX_JIFFY_OFFSET
 ((~0UL >> 1)-1)

	)

65 #i‚de‡
USEC_PER_SEC


66 
	#USEC_PER_SEC
 (1000000L)

	)

69 #i‚de‡
NSEC_PER_SEC


70 
	#NSEC_PER_SEC
 (1000000000L)

	)

73 #i‚de‡
NSEC_PER_USEC


74 
	#NSEC_PER_USEC
 (1000L)

	)

148 
	#SEC_JIFFIE_SC
 (31 - 
SHIFT_HZ
)

	)

149 #i‡!((((
NSEC_PER_SEC
 << 2Ë/ 
TICK_NSEC
Ë<< (
SEC_JIFFIE_SC
 - 2)) & 0x80000000)

150 #unde‡
SEC_JIFFIE_SC


151 
	#SEC_JIFFIE_SC
 (32 - 
SHIFT_HZ
)

	)

153 
	#NSEC_JIFFIE_SC
 (
SEC_JIFFIE_SC
 + 29)

	)

154 
	#USEC_JIFFIE_SC
 (
SEC_JIFFIE_SC
 + 19)

	)

155 
	#SEC_CONVERSION
 (()((((
u64
)
NSEC_PER_SEC
 << 
SEC_JIFFIE_SC
))\

156 / (
u64
)
TICK_NSEC
))

	)

158 
	#NSEC_CONVERSION
 (()((((
u64
)1 << 
NSEC_JIFFIE_SC
))\

159 / (
u64
)
TICK_NSEC
))

	)

160 
	#USEC_CONVERSION
 \

161 (()((((
u64
)
NSEC_PER_USEC
 << 
USEC_JIFFIE_SC
)) \

162 / (
u64
)
TICK_NSEC
))

	)

170 
	#USEC_ROUND
 (
u64
)(((u64)1 << 
USEC_JIFFIE_SC
Ë- 1)

	)

176 #i‡
BITS_PER_LONG
 < 64

177 
	#MAX_SEC_IN_JIFFIES
 \

178 ()((
u64
)((u64)
MAX_JIFFY_OFFSET
 * 
TICK_NSEC
Ë/ 
NSEC_PER_SEC
)

	)

180 
	#MAX_SEC_IN_JIFFIES
 \

181 (
	`SH_DIV
((
MAX_JIFFY_OFFSET
 >> 
SEC_JIFFIE_SC
Ë* 
TICK_NSEC
, 
NSEC_PER_SEC
, 1Ë- 1)

	)

195 
__ölöe__
 

196 
	$time•ec_to_jiffõs
(
time•ec
 *
vÆue
)

198 
£c
 = 
vÆue
->
tv_£c
;

199 
n£c
 = 
vÆue
->
tv_n£c
 + 
TICK_NSEC
 - 1;

201 i‡(
£c
 >
MAX_SEC_IN_JIFFIES
){

202 
£c
 = 
MAX_SEC_IN_JIFFIES
;

203 
n£c
 = 0;

205  (((
u64
)
£c
 * 
SEC_CONVERSION
) +

206 (((
u64
)
n£c
 * 
NSEC_CONVERSION
) >>

207 (
NSEC_JIFFIE_SC
 - 
SEC_JIFFIE_SC
))) >> SEC_JIFFIE_SC;

209 
	}
}

211 
__ölöe__
 

212 
	$jiffõs_to_time•ec
(
jiffõs
, 
time•ec
 *
vÆue
)

218 
u64
 
n£c
 = (u64)
jiffõs
 * 
TICK_NSEC
;

219 
vÆue
->
tv_£c
 = 
	`div_l⁄g_l⁄g_ªm
(
n£c
, 
NSEC_PER_SEC
, &vÆue->
tv_n£c
);

220 
	}
}

234 
__ölöe__
 

235 
	$timevÆ_to_jiffõs
(
timevÆ
 *
vÆue
)

237 
£c
 = 
vÆue
->
tv_£c
;

238 
u£c
 = 
vÆue
->
tv_u£c
;

240 i‡(
£c
 >
MAX_SEC_IN_JIFFIES
){

241 
£c
 = 
MAX_SEC_IN_JIFFIES
;

242 
u£c
 = 0;

244  (((
u64
)
£c
 * 
SEC_CONVERSION
) +

245 (((
u64
)
u£c
 * 
USEC_CONVERSION
 + 
USEC_ROUND
) >>

246 (
USEC_JIFFIE_SC
 - 
SEC_JIFFIE_SC
))) >> SEC_JIFFIE_SC;

247 
	}
}

249 
__ölöe__
 

250 
	$jiffõs_to_timevÆ
(
jiffõs
, 
timevÆ
 *
vÆue
)

256 
u64
 
n£c
 = (u64)
jiffõs
 * 
TICK_NSEC
;

257 
vÆue
->
tv_£c
 = 
	`div_l⁄g_l⁄g_ªm
(
n£c
, 
NSEC_PER_SEC
, &vÆue->
tv_u£c
);

258 
vÆue
->
tv_u£c
 /
NSEC_PER_USEC
;

259 
	}
}

261 
__ölöe__
 
	$time•ec_equÆ
(
time•ec
 *
a
, time•e¯*
b
)

263  (
a
->
tv_£c
 =
b
->tv_£cË&& (a->
tv_n£c
 == b->tv_nsec);

264 
	}
}

281 
ölöe
 

282 
	$mktime
 (
yór
, 
m⁄
,

283 
day
, 
hour
,

284 
mö
, 
£c
)

286 i‡(0 >(Ë(
m⁄
 -= 2)) {

287 
m⁄
 += 12;

288 
yór
 -= 1;

292 (Ë(
yór
/4 - yór/100 + yór/400 + 367*
m⁄
/12 + 
day
) +

293 
yór
*365 - 719499

294 )*24 + 
hour


295 )*60 + 
mö


296 )*60 + 
£c
;

297 
	}
}

299 
time•ec
 
xtime
;

300 
time•ec
 
wÆl_to_m⁄Ÿ⁄ic
;

301 
£qlock_t
 
xtime_lock
;

303 
ölöe
 
	$gë_£c⁄ds
()

305  
xtime
.
tv_£c
;

306 
	}
}

308 
time•ec
 
cuºít_kî√l_time
();

310 
	#CURRENT_TIME
 (
	`cuºít_kî√l_time
())

	)

314 
	#NFDBITS
 
__NFDBITS


	)

316 #ifde‡
__KERNEL__


317 
do_gëtimeofday
(
timevÆ
 *
tv
);

318 
do_£âimeofday
(
time•ec
 *
tv
);

319 
do_sys_£âimeofday
(
time•ec
 *
tv
, 
timez⁄e
 *
tz
);

320 
˛ock_was_£t
();

321 
do_posix_˛ock_m⁄Ÿ⁄ic_gëtime
(
time•ec
 *
ç
);

322 
do_«no¶ìp
(
time•ec
 *
t
);

323 
do_utimes
(
__u£r
 * 
fûíame
, 
timevÆ
 * 
times
);

324 
	gôimîvÆ
;

325 
do_£tôimî
(
which
, 
ôimîvÆ
 *
vÆue
, ôimîvÆ *
ovÆue
);

326 
do_gëôimî
(
which
, 
ôimîvÆ
 *
vÆue
);

328 
ölöe
 

329 
	$£t_n‹mÆized_time•ec
 (
time•ec
 *
ts
, 
time_t
 
£c
, 
n£c
)

331 
n£c
 > 
NSEC_PER_SEC
) {

332 
n£c
 -
NSEC_PER_SEC
;

333 ++
£c
;

335 
n£c
 < 0) {

336 
n£c
 +
NSEC_PER_SEC
;

337 --
£c
;

339 
ts
->
tv_£c
 = 
£c
;

340 
ts
->
tv_n£c
 = 
n£c
;

341 
	}
}

344 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

345 
	#FD_SET
(
fd
,
fd£ç
Ë
	`__FD_SET
(fd,fd£ç)

	)

346 
	#FD_CLR
(
fd
,
fd£ç
Ë
	`__FD_CLR
(fd,fd£ç)

	)

347 
	#FD_ISSET
(
fd
,
fd£ç
Ë
	`__FD_ISSET
(fd,fd£ç)

	)

348 
	#FD_ZERO
(
fd£ç
Ë
	`__FD_ZERO
(fd£ç)

	)

354 
	#ITIMER_REAL
 0

	)

355 
	#ITIMER_VIRTUAL
 1

	)

356 
	#ITIMER_PROF
 2

	)

358 
	sôimî•ec
 {

359 
time•ec
 
	mô_öãrvÆ
;

360 
time•ec
 
	mô_vÆue
;

363 
	sôimîvÆ
 {

364 
timevÆ
 
	mô_öãrvÆ
;

365 
timevÆ
 
	mô_vÆue
;

372 
	#CLOCK_REALTIME
 0

	)

373 
	#CLOCK_MONOTONIC
 1

	)

374 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

375 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

376 
	#CLOCK_REALTIME_HR
 4

	)

377 
	#CLOCK_MONOTONIC_HR
 5

	)

379 
	#MAX_CLOCKS
 6

	)

380 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
 | \

381 
CLOCK_REALTIME_HR
 | 
CLOCK_MONOTONIC_HR
)

	)

382 
	#CLOCKS_MONO
 (
CLOCK_MONOTONIC
 & 
CLOCK_MONOTONIC_HR
)

	)

388 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/timer.h

1 #i‚de‡
_LINUX_TIMER_H


2 
	#_LINUX_TIMER_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<löux/li°.h
>

6 
	~<löux/•ölock.h
>

8 
	gtvec_t_ba£_s
;

10 
	stimî_li°
 {

11 
li°_hód
 
	míåy
;

12 
	mexpúes
;

14 
•ölock_t
 
	mlock
;

15 
	mmagic
;

17 (*
	mfun˘i⁄
)();

18 
	md©a
;

20 
tvec_t_ba£_s
 *
	mba£
;

23 
	#TIMER_MAGIC
 0x4b87ad6e

	)

25 
	#TIMER_INITIALIZER
(
_fun˘i⁄
, 
_expúes
, 
_d©a
) { \

26 .
fun˘i⁄
 = (
_fun˘i⁄
), \

27 .
expúes
 = (
_expúes
), \

28 .
d©a
 = (
_d©a
), \

29 .
ba£
 = 
NULL
, \

30 .
magic
 = 
TIMER_MAGIC
, \

31 .
lock
 = 
SPIN_LOCK_UNLOCKED
, \

32 }

	)

41 
ölöe
 
	$öô_timî
(
timî_li°
 * 
timî
)

43 
timî
->
ba£
 = 
NULL
;

44 
timî
->
magic
 = 
TIMER_MAGIC
;

45 
	`•ö_lock_öô
(&
timî
->
lock
);

46 
	}
}

58 
ölöe
 
	$timî_≥ndög
(c⁄° 
timî_li°
 * 
timî
)

60  
timî
->
ba£
 !
NULL
;

61 
	}
}

63 
add_timî_⁄
(
timî_li°
 *
timî
, 
˝u
);

64 
dñ_timî
(
timî_li°
 * 
timî
);

65 
__mod_timî
(
timî_li°
 *
timî
, 
expúes
);

66 
mod_timî
(
timî_li°
 *
timî
, 
expúes
);

82 
ölöe
 
	$add_timî
(
timî_li°
 * 
timî
)

84 
	`__mod_timî
(
timî
,Åimî->
expúes
);

85 
	}
}

87 #ifde‡
CONFIG_SMP


88 
dñ_timî_sync
(
timî_li°
 * 
timî
);

90 
	#dñ_timî_sync
(
t
Ë
	`dñ_timî
—)

	)

93 
öô_timîs
();

94 
run_loˇl_timîs
();

95 
ô_ªÆ_‚
();

	@/usr/include/linux/tty_driver.h

1 #i‚de‡
_LINUX_TTY_DRIVER_H


2 
	#_LINUX_TTY_DRIVER_H


	)

118 
	~<löux/fs.h
>

119 
	~<löux/li°.h
>

120 
	~<löux/cdev.h
>

122 
	gây_°ru˘
;

124 
	sây_›î©i⁄s
 {

125 (*
	m›í
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûp
);

126 (*
	m˛o£
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûp
);

127 (*
	mwrôe
)(
ây_°ru˘
 * 
	mây
, 
	m‰om_u£r
,

128 c⁄° *
	mbuf
, 
	mcou¡
);

129 (*
	mput_ch¨
)(
ây_°ru˘
 *
	mây
, 
	mch
);

130 (*
	mÊush_ch¨s
)(
ây_°ru˘
 *
	mây
);

131 (*
	mwrôe_room
)(
ây_°ru˘
 *
	mây
);

132 (*
	mch¨s_ö_buf„r
)(
ây_°ru˘
 *
	mây
);

133 (*
	mio˘l
)(
ây_°ru˘
 *
	mây
, 
fûe
 * 
	mfûe
,

134 
	mcmd
, 
	m¨g
);

135 (*
	m£t_ãrmios
)(
ây_°ru˘
 *
	mây
, 
ãrmios
 * 
	mﬁd
);

136 (*
	mthrŸée
)(
ây_°ru˘
 * 
	mây
);

137 (*
	mu¡hrŸée
)(
ây_°ru˘
 * 
	mây
);

138 (*
	m°›
)(
ây_°ru˘
 *
	mây
);

139 (*
	m°¨t
)(
ây_°ru˘
 *
	mây
);

140 (*
	mh™gup
)(
ây_°ru˘
 *
	mây
);

141 (*
	mbªak_˘l
)(
ây_°ru˘
 *
	mây
, 
	m°©e
);

142 (*
	mÊush_buf„r
)(
ây_°ru˘
 *
	mây
);

143 (*
	m£t_ldisc
)(
ây_°ru˘
 *
	mây
);

144 (*
	mwaô_u¡û_£¡
)(
ây_°ru˘
 *
	mây
, 
	mtimeout
);

145 (*
	m£nd_xch¨
)(
ây_°ru˘
 *
	mây
, 
	mch
);

146 (*
	mªad_¥oc
)(*
	m∑ge
, **
	m°¨t
, 
off_t
 
	moff
,

147 
	mcou¡
, *
	meof
, *
	md©a
);

148 (*
	mwrôe_¥oc
)(
fûe
 *
	mfûe
, c⁄° *
	mbuf„r
,

149 
	mcou¡
, *
	md©a
);

150 (*
	mtiocmgë
)(
ây_°ru˘
 *
	mây
, 
fûe
 *
	mfûe
);

151 (*
	mtiocm£t
)(
ây_°ru˘
 *
	mây
, 
fûe
 *
	mfûe
,

152 
	m£t
, 
	m˛ór
);

155 
	sây_drivî
 {

156 
	mmagic
;

157 
cdev
 
	mcdev
;

158 
moduÀ
 *
	mow√r
;

159 c⁄° *
	mdrivî_«me
;

160 c⁄° *
	mdevfs_«me
;

161 c⁄° *
	m«me
;

162 
	m«me_ba£
;

163 
	mmaj‹
;

164 
	mmö‹_°¨t
;

165 
	mnum
;

166 
	mty≥
;

167 
	msubty≥
;

168 
ãrmios
 
	möô_ãrmios
;

169 
	mÊags
;

170 
	mªfcou¡
;

171 
¥oc_dú_íåy
 *
	m¥oc_íåy
;

172 
ây_drivî
 *
	mŸhî
;

177 
ây_°ru˘
 **
	mâys
;

178 
ãrmios
 **
	mãrmios
;

179 
ãrmios
 **
	mãrmios_locked
;

180 *
	mdrivî_°©e
;

186 (*
	m›í
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûp
);

187 (*
	m˛o£
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûp
);

188 (*
	mwrôe
)(
ây_°ru˘
 * 
	mây
, 
	m‰om_u£r
,

189 c⁄° *
	mbuf
, 
	mcou¡
);

190 (*
	mput_ch¨
)(
ây_°ru˘
 *
	mây
, 
	mch
);

191 (*
	mÊush_ch¨s
)(
ây_°ru˘
 *
	mây
);

192 (*
	mwrôe_room
)(
ây_°ru˘
 *
	mây
);

193 (*
	mch¨s_ö_buf„r
)(
ây_°ru˘
 *
	mây
);

194 (*
	mio˘l
)(
ây_°ru˘
 *
	mây
, 
fûe
 * 
	mfûe
,

195 
	mcmd
, 
	m¨g
);

196 (*
	m£t_ãrmios
)(
ây_°ru˘
 *
	mây
, 
ãrmios
 * 
	mﬁd
);

197 (*
	mthrŸée
)(
ây_°ru˘
 * 
	mây
);

198 (*
	mu¡hrŸée
)(
ây_°ru˘
 * 
	mây
);

199 (*
	m°›
)(
ây_°ru˘
 *
	mây
);

200 (*
	m°¨t
)(
ây_°ru˘
 *
	mây
);

201 (*
	mh™gup
)(
ây_°ru˘
 *
	mây
);

202 (*
	mbªak_˘l
)(
ây_°ru˘
 *
	mây
, 
	m°©e
);

203 (*
	mÊush_buf„r
)(
ây_°ru˘
 *
	mây
);

204 (*
	m£t_ldisc
)(
ây_°ru˘
 *
	mây
);

205 (*
	mwaô_u¡û_£¡
)(
ây_°ru˘
 *
	mây
, 
	mtimeout
);

206 (*
	m£nd_xch¨
)(
ây_°ru˘
 *
	mây
, 
	mch
);

207 (*
	mªad_¥oc
)(*
	m∑ge
, **
	m°¨t
, 
off_t
 
	moff
,

208 
	mcou¡
, *
	meof
, *
	md©a
);

209 (*
	mwrôe_¥oc
)(
fûe
 *
	mfûe
, c⁄° *
	mbuf„r
,

210 
	mcou¡
, *
	md©a
);

211 (*
	mtiocmgë
)(
ây_°ru˘
 *
	mây
, 
fûe
 *
	mfûe
);

212 (*
	mtiocm£t
)(
ây_°ru˘
 *
	mây
, 
fûe
 *
	mfûe
,

213 
	m£t
, 
	m˛ór
);

215 
li°_hód
 
	mây_drivîs
;

218 
li°_hód
 
ây_drivîs
;

220 
ây_drivî
 *
Æloc_ây_drivî
(
löes
);

221 
put_ây_drivî
(
ây_drivî
 *
drivî
);

222 
ây_£t_›î©i⁄s
(
ây_drivî
 *
drivî
, 
ây_›î©i⁄s
 *
›
);

225 
	#TTY_DRIVER_MAGIC
 0x5402

	)

248 
	#TTY_DRIVER_INSTALLED
 0x0001

	)

249 
	#TTY_DRIVER_RESET_TERMIOS
 0x0002

	)

250 
	#TTY_DRIVER_REAL_RAW
 0x0004

	)

251 
	#TTY_DRIVER_NO_DEVFS
 0x0008

	)

254 
	#TTY_DRIVER_TYPE_SYSTEM
 0x0001

	)

255 
	#TTY_DRIVER_TYPE_CONSOLE
 0x0002

	)

256 
	#TTY_DRIVER_TYPE_SERIAL
 0x0003

	)

257 
	#TTY_DRIVER_TYPE_PTY
 0x0004

	)

258 
	#TTY_DRIVER_TYPE_SCC
 0x0005

	)

259 
	#TTY_DRIVER_TYPE_SYSCONS
 0x0006

	)

262 
	#SYSTEM_TYPE_TTY
 0x0001

	)

263 
	#SYSTEM_TYPE_CONSOLE
 0x0002

	)

264 
	#SYSTEM_TYPE_SYSCONS
 0x0003

	)

265 
	#SYSTEM_TYPE_SYSPTMX
 0x0004

	)

268 
	#PTY_TYPE_MASTER
 0x0001

	)

269 
	#PTY_TYPE_SLAVE
 0x0002

	)

272 
	#SERIAL_TYPE_NORMAL
 1

	)

273 
	#SERIAL_TYPE_CALLOUT
 2

	)

	@/usr/include/linux/tty_ldisc.h

1 #i‚de‡
_LINUX_TTY_LDISC_H


2 
	#_LINUX_TTY_LDISC_H


	)

100 
	~<löux/fs.h
>

101 
	~<löux/waô.h
>

103 
	sây_ldisc
 {

104 
	mmagic
;

105 *
	m«me
;

106 
	mnum
;

107 
	mÊags
;

112 (*
	m›í
)(
	mây_°ru˘
 *);

113 (*
	m˛o£
)(
	mây_°ru˘
 *);

114 (*
	mÊush_buf„r
)(
ây_°ru˘
 *
	mây
);

115 
ssize_t
 (*
ch¨s_ö_buf„r
)(
ây_°ru˘
 *
	mây
);

116 
ssize_t
 (*
ªad
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûe
,

117 * 
	mbuf
, 
size_t
 
	mƒ
);

118 
ssize_t
 (*
wrôe
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûe
,

119 c⁄° * 
	mbuf
, 
size_t
 
	mƒ
);

120 (*
	mio˘l
)(
ây_°ru˘
 * 
	mây
, 
fûe
 * 
	mfûe
,

121 
	mcmd
, 
	m¨g
);

122 (*
	m£t_ãrmios
)(
ây_°ru˘
 *
	mây
, 
ãrmios
 * 
	mﬁd
);

123 (*
	mpﬁl
)(
	mây_°ru˘
 *, 
	mfûe
 *,

124 
	mpﬁl_èbÀ_°ru˘
 *);

129 (*
	mª˚ive_buf
)(
	mây_°ru˘
 *, c⁄° *
	m˝
,

130 *
	mÂ
, 
	mcou¡
);

131 (*
	mª˚ive_room
)(
	mây_°ru˘
 *);

132 (*
	mwrôe_wakeup
)(
	mây_°ru˘
 *);

134 
moduÀ
 *
	mow√r
;

137 
	#TTY_LDISC_MAGIC
 0x5403

	)

139 
	#LDISC_FLAG_DEFINED
 0x00000001

	)

141 
	#MODULE_ALIAS_LDISC
(
ldisc
) \

142 
	`MODULE_ALIAS
("ây-ldisc-" 
	`__°rögify
(
ldisc
))

	)

	@/usr/include/paths.h

32 #i‚de‡
_PATHS_H_


33 
	#_PATHS_H_


	)

36 
	#_PATH_DEFPATH
 "/u§/bö:/bö"

	)

38 
	#_PATH_STDPATH
 \

39 "/u§/bö:/bö:/u§/sbö:/sbö"

	)

41 
	#_PATH_BSHELL
 "/bö/sh"

	)

42 
	#_PATH_CONSOLE
 "/dev/c⁄sﬁe"

	)

43 
	#_PATH_CSHELL
 "/bö/csh"

	)

44 
	#_PATH_DEVDB
 "/v¨/run/dev.db"

	)

45 
	#_PATH_DEVNULL
 "/dev/nuŒ"

	)

46 
	#_PATH_DRUM
 "/dev/drum"

	)

47 
	#_PATH_KLOG
 "/¥oc/kmsg"

	)

48 
	#_PATH_KMEM
 "/dev/kmem"

	)

49 
	#_PATH_LASTLOG
 "/v¨/log/œ°log"

	)

50 
	#_PATH_MAILDIR
 "/v¨/maû"

	)

51 
	#_PATH_MAN
 "/u§/sh¨e/m™"

	)

52 
	#_PATH_MEM
 "/dev/mem"

	)

53 
	#_PATH_MNTTAB
 "/ëc/f°ab"

	)

54 
	#_PATH_MOUNTED
 "/ëc/mèb"

	)

55 
	#_PATH_NOLOGIN
 "/ëc/nﬁogö"

	)

56 
	#_PATH_PRESERVE
 "/v¨/lib"

	)

57 
	#_PATH_RWHODIR
 "/v¨/•oﬁ/rwho"

	)

58 
	#_PATH_SENDMAIL
 "/u§/sbö/£ndmaû"

	)

59 
	#_PATH_SHADOW
 "/ëc/shadow"

	)

60 
	#_PATH_SHELLS
 "/ëc/shñls"

	)

61 
	#_PATH_TTY
 "/dev/ây"

	)

62 
	#_PATH_UNIX
 "/boŸ/vmlöux"

	)

63 
	#_PATH_UTMP
 "/v¨/run/utmp"

	)

64 
	#_PATH_VI
 "/u§/bö/vi"

	)

65 
	#_PATH_WTMP
 "/v¨/log/wtmp"

	)

68 
	#_PATH_DEV
 "/dev/"

	)

69 
	#_PATH_TMP
 "/tmp/"

	)

70 
	#_PATH_VARDB
 "/v¨/lib/misc/"

	)

71 
	#_PATH_VARRUN
 "/v¨/run/"

	)

72 
	#_PATH_VARTMP
 "/v¨/tmp/"

	)

	@/usr/include/asm/bug.h

1 #i‚de‡
_I386_BUG_H


2 
	#_I386_BUG_H


	)

4 
	~<löux/c⁄fig.h
>

13 
	#BUG
() \

14 
__asm__
 
	`__vﬁ©ûe__
( "ud2\n" \

17 : : "i" (
__LINE__
), "i" (
__FILE__
))

	)

19 
	#BUG
(Ë
__asm__
 
	`__vﬁ©ûe__
("ud2\n")

	)

22 
	#BUG_ON
(
c⁄dôi⁄
Ëdÿ{ i‡(
	`u∆ikñy
((c⁄dôi⁄)!=0)Ë
	`BUG
(); } 0)

	)

24 
	#PAGE_BUG
(
∑ge
) do { \

25 
	`BUG
(); \

26 } 0)

	)

28 
	#WARN_ON
(
c⁄dôi⁄
) do { \

29 i‡(
	`u∆ikñy
((
c⁄dôi⁄
)!=0)) { \

30 
	`¥ötk
("Bad√s†ö %†© %s:%d\n", 
__FUNCTION__
, 
__FILE__
, 
__LINE__
); \

31 
	`dump_°ack
(); \

33 } 0)

	)

	@/usr/include/asm/cache.h

4 #i‚de‡
__ARCH_I386_CACHE_H


5 
	#__ARCH_I386_CACHE_H


	)

7 
	~<löux/c⁄fig.h
>

10 
	#L1_CACHE_SHIFT
 (
CONFIG_X86_L1_CACHE_SHIFT
)

	)

11 
	#L1_CACHE_BYTES
 (1 << 
L1_CACHE_SHIFT
)

	)

13 
	#L1_CACHE_SHIFT_MAX
 7

	)

	@/usr/include/asm/cpufeature.h

7 #i‚de‡
__ASM_I386_CPUFEATURE_H


8 
	#__ASM_I386_CPUFEATURE_H


	)

10 
	~<löux/bô›s.h
>

12 
	#NCAPINTS
 6

	)

15 
	#X86_FEATURE_FPU
 (0*32+ 0Ë

	)

16 
	#X86_FEATURE_VME
 (0*32+ 1Ë

	)

17 
	#X86_FEATURE_DE
 (0*32+ 2Ë

	)

18 
	#X86_FEATURE_PSE
 (0*32+ 3Ë

	)

19 
	#X86_FEATURE_TSC
 (0*32+ 4Ë

	)

20 
	#X86_FEATURE_MSR
 (0*32+ 5Ë

	)

21 
	#X86_FEATURE_PAE
 (0*32+ 6Ë

	)

22 
	#X86_FEATURE_MCE
 (0*32+ 7Ë

	)

23 
	#X86_FEATURE_CX8
 (0*32+ 8Ë

	)

24 
	#X86_FEATURE_APIC
 (0*32+ 9Ë

	)

25 
	#X86_FEATURE_SEP
 (0*32+11Ë

	)

26 
	#X86_FEATURE_MTRR
 (0*32+12Ë

	)

27 
	#X86_FEATURE_PGE
 (0*32+13Ë

	)

28 
	#X86_FEATURE_MCA
 (0*32+14Ë

	)

29 
	#X86_FEATURE_CMOV
 (0*32+15Ë

	)

30 
	#X86_FEATURE_PAT
 (0*32+16Ë

	)

31 
	#X86_FEATURE_PSE36
 (0*32+17Ë

	)

32 
	#X86_FEATURE_PN
 (0*32+18Ë

	)

33 
	#X86_FEATURE_CLFLSH
 (0*32+19Ë

	)

34 
	#X86_FEATURE_DTES
 (0*32+21Ë

	)

35 
	#X86_FEATURE_ACPI
 (0*32+22Ë

	)

36 
	#X86_FEATURE_MMX
 (0*32+23Ë

	)

37 
	#X86_FEATURE_FXSR
 (0*32+24Ë

	)

39 
	#X86_FEATURE_XMM
 (0*32+25Ë

	)

40 
	#X86_FEATURE_XMM2
 (0*32+26Ë

	)

41 
	#X86_FEATURE_SELFSNOOP
 (0*32+27Ë

	)

42 
	#X86_FEATURE_HT
 (0*32+28Ë

	)

43 
	#X86_FEATURE_ACC
 (0*32+29Ë

	)

44 
	#X86_FEATURE_IA64
 (0*32+30Ë

	)

48 
	#X86_FEATURE_SYSCALL
 (1*32+11Ë

	)

49 
	#X86_FEATURE_MP
 (1*32+19Ë

	)

50 
	#X86_FEATURE_MMXEXT
 (1*32+22Ë

	)

51 
	#X86_FEATURE_LM
 (1*32+29Ë

	)

52 
	#X86_FEATURE_3DNOWEXT
 (1*32+30Ë

	)

53 
	#X86_FEATURE_3DNOW
 (1*32+31Ë

	)

56 
	#X86_FEATURE_RECOVERY
 (2*32+ 0Ë

	)

57 
	#X86_FEATURE_LONGRUN
 (2*32+ 1Ë

	)

58 
	#X86_FEATURE_LRTI
 (2*32+ 3Ë

	)

62 
	#X86_FEATURE_CXMMX
 (3*32+ 0Ë

	)

63 
	#X86_FEATURE_K6_MTRR
 (3*32+ 1Ë

	)

64 
	#X86_FEATURE_CYRIX_ARR
 (3*32+ 2Ë

	)

65 
	#X86_FEATURE_CENTAUR_MCR
 (3*32+ 3Ë

	)

67 
	#X86_FEATURE_K8
 (3*32+ 4Ë

	)

68 
	#X86_FEATURE_K7
 (3*32+ 5Ë

	)

69 
	#X86_FEATURE_P3
 (3*32+ 6Ë

	)

70 
	#X86_FEATURE_P4
 (3*32+ 7Ë

	)

73 
	#X86_FEATURE_EST
 (4*32+ 7Ë

	)

74 
	#X86_FEATURE_MWAIT
 (4*32+ 3Ë

	)

78 
	#X86_FEATURE_XSTORE
 (5*32+ 2Ë

	)

81 
	#˝u_has
(
c
, 
bô
Ë
	`ã°_bô
(bô, (c)->
x86_ˇ∑bûôy
)

	)

82 
	#boŸ_˝u_has
(
bô
Ë
	`ã°_bô
(bô, 
boŸ_˝u_d©a
.
x86_ˇ∑bûôy
)

	)

84 
	#˝u_has_Âu
 
	`boŸ_˝u_has
(
X86_FEATURE_FPU
)

	)

85 
	#˝u_has_vme
 
	`boŸ_˝u_has
(
X86_FEATURE_VME
)

	)

86 
	#˝u_has_de
 
	`boŸ_˝u_has
(
X86_FEATURE_DE
)

	)

87 
	#˝u_has_p£
 
	`boŸ_˝u_has
(
X86_FEATURE_PSE
)

	)

88 
	#˝u_has_tsc
 
	`boŸ_˝u_has
(
X86_FEATURE_TSC
)

	)

89 
	#˝u_has_∑e
 
	`boŸ_˝u_has
(
X86_FEATURE_PAE
)

	)

90 
	#˝u_has_pge
 
	`boŸ_˝u_has
(
X86_FEATURE_PGE
)

	)

91 
	#˝u_has_s£2
 
	`boŸ_˝u_has
(
X86_FEATURE_XMM2
)

	)

92 
	#˝u_has_≠ic
 
	`boŸ_˝u_has
(
X86_FEATURE_APIC
)

	)

93 
	#˝u_has_£p
 
	`boŸ_˝u_has
(
X86_FEATURE_SEP
)

	)

94 
	#˝u_has_mår
 
	`boŸ_˝u_has
(
X86_FEATURE_MTRR
)

	)

95 
	#˝u_has_mmx
 
	`boŸ_˝u_has
(
X86_FEATURE_MMX
)

	)

96 
	#˝u_has_fx§
 
	`boŸ_˝u_has
(
X86_FEATURE_FXSR
)

	)

97 
	#˝u_has_xmm
 
	`boŸ_˝u_has
(
X86_FEATURE_XMM
)

	)

98 
	#˝u_has_ht
 
	`boŸ_˝u_has
(
X86_FEATURE_HT
)

	)

99 
	#˝u_has_mp
 
	`boŸ_˝u_has
(
X86_FEATURE_MP
)

	)

100 
	#˝u_has_k6_mår
 
	`boŸ_˝u_has
(
X86_FEATURE_K6_MTRR
)

	)

101 
	#˝u_has_cyrix_¨r
 
	`boŸ_˝u_has
(
X86_FEATURE_CYRIX_ARR
)

	)

102 
	#˝u_has_˚¡aur_m¸
 
	`boŸ_˝u_has
(
X86_FEATURE_CENTAUR_MCR
)

	)

103 
	#˝u_has_x°‹e
 
	`boŸ_˝u_has
(
X86_FEATURE_XSTORE
)

	)

	@/usr/include/asm/div64.h

1 #i‚de‡
__I386_DIV64


2 
	#__I386_DIV64


	)

16 
	#do_div
(
n
,
ba£
) ({ \

17 
__uµî
, 
__low
, 
__high
, 
__mod
, 
__ba£
; \

18 
__ba£
 = (
ba£
); \

19 
	`asm
("":"˜" (
__low
), "=d" (
__high
):"A" (
n
)); \

20 
__uµî
 = 
__high
; \

21 i‡(
__high
) { \

22 
__uµî
 = 
__high
 % (
__ba£
); \

23 
__high
 = __high / (
__ba£
); \

25 
	`asm
("div»%2":"˜" (
__low
), "=d" (
__mod
):"rm" (
__ba£
), "0" (__low), "1" (
__uµî
)); \

26 
	`asm
("":"=A" (
n
):"a" (
__low
),"d" (
__high
)); \

27 
__mod
; \

28 })

	)

36 
	#div_l⁄g_l⁄g_ªm
(
a
,
b
,
c
Ë
	`div_Œ_X_l_ªm
◊,b,c)

	)

38 
ölöe
 

39 
	$div_Œ_X_l_ªm
(
divs
, 
div
, *
ªm
)

41 
dum2
;

42 
	`__asm__
("div»%2":"˜"(
dum2
), "=d"(*
ªm
)

43 : "rm"(
div
), "A"(
divs
));

45  
dum2
;

47 
	}
}

	@/usr/include/asm/errno.h

1 #i‚de‡
_I386_ERRNO_H


2 
	#_I386_ERRNO_H


	)

4 
	~<asm-gíîic/î∫o.h
>

	@/usr/include/asm/fcntl.h

1 #i‚de‡
_I386_FCNTL_H


2 
	#_I386_FCNTL_H


	)

6 
	#O_ACCMODE
 0003

	)

7 
	#O_RDONLY
 00

	)

8 
	#O_WRONLY
 01

	)

9 
	#O_RDWR
 02

	)

10 
	#O_CREAT
 0100

	)

11 
	#O_EXCL
 0200

	)

12 
	#O_NOCTTY
 0400

	)

13 
	#O_TRUNC
 01000

	)

14 
	#O_APPEND
 02000

	)

15 
	#O_NONBLOCK
 04000

	)

16 
	#O_NDELAY
 
O_NONBLOCK


	)

17 
	#O_SYNC
 010000

	)

18 
	#FASYNC
 020000

	)

19 
	#O_DIRECT
 040000

	)

20 
	#O_LARGEFILE
 0100000

	)

21 
	#O_DIRECTORY
 0200000

	)

22 
	#O_NOFOLLOW
 0400000

	)

24 
	#F_DUPFD
 0

	)

25 
	#F_GETFD
 1

	)

26 
	#F_SETFD
 2

	)

27 
	#F_GETFL
 3

	)

28 
	#F_SETFL
 4

	)

29 
	#F_GETLK
 5

	)

30 
	#F_SETLK
 6

	)

31 
	#F_SETLKW
 7

	)

33 
	#F_SETOWN
 8

	)

34 
	#F_GETOWN
 9

	)

35 
	#F_SETSIG
 10

	)

36 
	#F_GETSIG
 11

	)

38 
	#F_GETLK64
 12

	)

39 
	#F_SETLK64
 13

	)

40 
	#F_SETLKW64
 14

	)

43 
	#FD_CLOEXEC
 1

	)

46 
	#F_RDLCK
 0

	)

47 
	#F_WRLCK
 1

	)

48 
	#F_UNLCK
 2

	)

51 
	#F_EXLCK
 4

	)

52 
	#F_SHLCK
 8

	)

55 
	#F_INPROGRESS
 16

	)

58 
	#LOCK_SH
 1

	)

59 
	#LOCK_EX
 2

	)

60 
	#LOCK_NB
 4

	)

62 
	#LOCK_UN
 8

	)

64 
	#LOCK_MAND
 32

	)

65 
	#LOCK_READ
 64

	)

66 
	#LOCK_WRITE
 128

	)

67 
	#LOCK_RW
 192

	)

69 
	sÊock
 {

70 
	ml_ty≥
;

71 
	ml_whí˚
;

72 
off_t
 
	ml_°¨t
;

73 
off_t
 
	ml_Àn
;

74 
pid_t
 
	ml_pid
;

77 
	sÊock64
 {

78 
	ml_ty≥
;

79 
	ml_whí˚
;

80 
loff_t
 
	ml_°¨t
;

81 
loff_t
 
	ml_Àn
;

82 
pid_t
 
	ml_pid
;

85 
	#F_LINUX_SPECIFIC_BASE
 1024

	)

	@/usr/include/asm/ioctl.h

6 #i‚de‡
_ASMI386_IOCTL_H


7 
	#_ASMI386_IOCTL_H


	)

27 
	#_IOC_NRBITS
 8

	)

28 
	#_IOC_TYPEBITS
 8

	)

29 
	#_IOC_SIZEBITS
 14

	)

30 
	#_IOC_DIRBITS
 2

	)

32 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

33 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

34 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

35 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

37 
	#_IOC_NRSHIFT
 0

	)

38 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

39 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

40 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

45 
	#_IOC_NONE
 0U

	)

46 
	#_IOC_WRITE
 1U

	)

47 
	#_IOC_READ
 2U

	)

49 
	#_IOC
(
dú
,
ty≥
,
ƒ
,
size
) \

50 (((
dú
Ë<< 
_IOC_DIRSHIFT
) | \

51 ((
ty≥
Ë<< 
_IOC_TYPESHIFT
) | \

52 ((
ƒ
Ë<< 
_IOC_NRSHIFT
) | \

53 ((
size
Ë<< 
_IOC_SIZESHIFT
))

	)

56 
__övÆid_size_¨gumít_f‹_IOC
;

57 
	#_IOC_TYPECHECK
(
t
) \

58 (((
t
) == (t[1]) && \

59 (
t
Ë< (1 << 
_IOC_SIZEBITS
)) ? \

60 (
t
Ë: 
__övÆid_size_¨gumít_f‹_IOC
)

	)

63 
	#_IO
(
ty≥
,
ƒ
Ë
	`_IOC
(
_IOC_NONE
,—y≥),“r),0)

	)

64 
	#_IOR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

65 
	#_IOW
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

66 
	#_IOWR
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(
	`_IOC_TYPECHECK
(size)))

	)

67 
	#_IOR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
,—y≥),“r),(size))

	)

68 
	#_IOW_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_WRITE
,—y≥),“r),(size))

	)

69 
	#_IOWR_BAD
(
ty≥
,
ƒ
,
size
Ë
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,—y≥),“r),(size))

	)

72 
	#_IOC_DIR
(
ƒ
Ë((“rË>> 
_IOC_DIRSHIFT
Ë& 
_IOC_DIRMASK
)

	)

73 
	#_IOC_TYPE
(
ƒ
Ë((“rË>> 
_IOC_TYPESHIFT
Ë& 
_IOC_TYPEMASK
)

	)

74 
	#_IOC_NR
(
ƒ
Ë((“rË>> 
_IOC_NRSHIFT
Ë& 
_IOC_NRMASK
)

	)

75 
	#_IOC_SIZE
(
ƒ
Ë((“rË>> 
_IOC_SIZESHIFT
Ë& 
_IOC_SIZEMASK
)

	)

79 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

80 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

81 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
Ë<< 
_IOC_DIRSHIFT
)

	)

82 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

83 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm/linkage.h

1 #i‚de‡
__ASM_LINKAGE_H


2 
	#__ASM_LINKAGE_H


	)

4 
	#asmlökage
 
CPP_ASMLINKAGE
 
	`__©åibuã__
((
	`ªg∑rm
(0)))

	)

5 
	#FASTCALL
(
x
Ëx 
	`__©åibuã__
((
	`ªg∑rm
(3)))

	)

7 #ifde‡
CONFIG_X86_ALIGNMENT_16


8 
	#__ALIGN
 .
Æign
 16,0x90

	)

9 
	#__ALIGN_STR
 ".Æig¿16,0x90"

	)

	@/usr/include/asm/param.h

1 #i‚de‡
_ASMi386_PARAM_H


2 
	#_ASMi386_PARAM_H


	)

4 #ifde‡
__KERNEL__


5 
	#HZ
 1000

	)

6 
	#USER_HZ
 100

	)

7 
	#CLOCKS_PER_SEC
 (
USER_HZ
Ë

	)

10 #i‚de‡
HZ


11 
	#HZ
 100

	)

14 
	#EXEC_PAGESIZE
 4096

	)

16 #i‚de‡
NGROUPS


17 
	#NGROUPS
 32

	)

20 #i‚de‡
NOGROUP


21 
	#NOGROUP
 (-1)

	)

24 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm/posix_types.h

1 #i‚de‡
__ARCH_I386_POSIX_TYPES_H


2 
	#__ARCH_I386_POSIX_TYPES_H


	)

10 
	t__kî√l_öo_t
;

11 
	t__kî√l_mode_t
;

12 
	t__kî√l_∆ök_t
;

13 
	t__kî√l_off_t
;

14 
	t__kî√l_pid_t
;

15 
	t__kî√l_ùc_pid_t
;

16 
	t__kî√l_uid_t
;

17 
	t__kî√l_gid_t
;

18 
	t__kî√l_size_t
;

19 
	t__kî√l_ssize_t
;

20 
	t__kî√l_±rdiff_t
;

21 
	t__kî√l_time_t
;

22 
	t__kî√l_su£c⁄ds_t
;

23 
	t__kî√l_˛ock_t
;

24 
	t__kî√l_timî_t
;

25 
	t__kî√l_˛ockid_t
;

26 
	t__kî√l_daddr_t
;

27 * 
	t__kî√l_ˇddr_t
;

28 
	t__kî√l_uid16_t
;

29 
	t__kî√l_gid16_t
;

30 
	t__kî√l_uid32_t
;

31 
	t__kî√l_gid32_t
;

33 
	t__kî√l_ﬁd_uid_t
;

34 
	t__kî√l_ﬁd_gid_t
;

35 
	t__kî√l_ﬁd_dev_t
;

37 #ifde‡
__GNUC__


38 
__exãnsi⁄__
 
	t__kî√l_loff_t
;

42 #i‡
deföed
(
__KERNEL__
Ë|| deföed(
__USE_ALL
)

43 
	mvÆ
[2];

45 
	m__vÆ
[2];

47 } 
	t__kî√l_fsid_t
;

49 #i‡
deföed
(
__KERNEL__
Ë|| !deföed(
__GLIBC__
) || (__GLIBC__ < 2)

51 #unde‡
__FD_SET


52 
	#__FD_SET
(
fd
,
fd£ç
) \

53 
__asm__
 
	`__vﬁ©ûe__
("btsl %1,%0": \

54 "=m" (*(
__kî√l_fd_£t
 *Ë(
fd£ç
)):"r" ((Ë(
fd
)))

	)

56 #unde‡
__FD_CLR


57 
	#__FD_CLR
(
fd
,
fd£ç
) \

58 
__asm__
 
	`__vﬁ©ûe__
("btrl %1,%0": \

59 "=m" (*(
__kî√l_fd_£t
 *Ë(
fd£ç
)):"r" ((Ë(
fd
)))

	)

61 #unde‡
__FD_ISSET


62 
	#__FD_ISSET
(
fd
,
fd£ç
Ë(
	`__exãnsi⁄__
 ({ \

63 
__ªsu…
; \

64 
__asm__
 
	`__vﬁ©ûe__
("btl %1,%2 ; setb %0" \

65 :"=q" (
__ªsu…
Ë:"r" ((Ë(
fd
)), \

66 "m" (*(
__kî√l_fd_£t
 *Ë(
fd£ç
))); \

67 
__ªsu…
; }))

	)

69 #unde‡
__FD_ZERO


70 
	#__FD_ZERO
(
fd£ç
) \

72 
__d0
, 
__d1
; \

73 
__asm__
 
	`__vﬁ©ûe__
("cld ;Ñep ; stosl" \

74 :"=m" (*(
__kî√l_fd_£t
 *Ë(
fd£ç
)), \

75 "=&c" (
__d0
), "=&D" (
__d1
) \

76 :"a" (0), "1" (
__FDSET_LONGS
), \

77 "2" ((
__kî√l_fd_£t
 *Ë(
fd£ç
)) : "memory"); \

78 } 0)

	)

	@/usr/include/asm/processor.h

7 #i‚de‡
__ASM_I386_PROCESSOR_H


8 
	#__ASM_I386_PROCESSOR_H


	)

10 
	~<asm/vm86.h
>

11 
	~<asm/m©h_emu.h
>

12 
	~<asm/£gmít.h
>

13 
	~<asm/∑ge.h
>

14 
	~<asm/ty≥s.h
>

15 
	~<asm/sigc⁄ãxt.h
>

16 
	~<asm/˝u„©uª.h
>

17 
	~<asm/m§.h
>

18 
	~<asm/sy°em.h
>

19 
	~<löux/ˇche.h
>

20 
	~<löux/c⁄fig.h
>

21 
	~<löux/thªads.h
>

24 
tsc_dißbÀ
;

26 
	sdesc_°ru˘
 {

27 
	ma
,
	mb
;

30 
	#desc_em±y
(
desc
) \

31 (!((
desc
)->
a
 + (desc)->
b
))

	)

33 
	#desc_equÆ
(
desc1
, 
desc2
) \

34 (((
desc1
)->
a
 =(
desc2
)->aË&& ((desc1)->
b
 =(desc2)->b))

	)

39 
	#cuºít_ãxt_addr
(Ë({ *
pc
; 
	`__asm__
("mov»$1f,%0\n1:":"=g" (pc));Öc; })

	)

47 
	s˝uöfo_x86
 {

48 
__u8
 
	mx86
;

49 
__u8
 
	mx86_víd‹
;

50 
__u8
 
	mx86_modñ
;

51 
__u8
 
	mx86_mask
;

52 
	mwp_w‹ks_ok
;

53 
	mh…_w‹ks_ok
;

54 
	mh¨d_m©h
;

55 
	mrfu
;

56 
	m˝uid_Àvñ
;

57 
	mx86_ˇ∑bûôy
[
NCAPINTS
];

58 
	mx86_víd‹_id
[16];

59 
	mx86_modñ_id
[64];

60 
	mx86_ˇche_size
;

62 
	mfdiv_bug
;

63 
	mf00f_bug
;

64 
	mcoma_bug
;

65 
	mlo›s_≥r_jiffy
;

66 } 
__©åibuã__
((
__Æig√d__
(
SMP_CACHE_BYTES
)));

68 
	#X86_VENDOR_INTEL
 0

	)

69 
	#X86_VENDOR_CYRIX
 1

	)

70 
	#X86_VENDOR_AMD
 2

	)

71 
	#X86_VENDOR_UMC
 3

	)

72 
	#X86_VENDOR_NEXGEN
 4

	)

73 
	#X86_VENDOR_CENTAUR
 5

	)

74 
	#X86_VENDOR_RISE
 6

	)

75 
	#X86_VENDOR_TRANSMETA
 7

	)

76 
	#X86_VENDOR_NSC
 8

	)

77 
	#X86_VENDOR_NUM
 9

	)

78 
	#X86_VENDOR_UNKNOWN
 0xff

	)

84 
˝uöfo_x86
 
boŸ_˝u_d©a
;

85 
˝uöfo_x86
 
√w_˝u_d©a
;

86 
tss_°ru˘
 
öô_tss
[
NR_CPUS
];

87 
tss_°ru˘
 
doubÀÁu…_tss
;

89 #ifde‡
CONFIG_SMP


90 
˝uöfo_x86
 
˝u_d©a
[];

91 
	#cuºít_˝u_d©a
 
˝u_d©a
[
	`smp_¥o˚ss‹_id
()]

	)

93 
	#˝u_d©a
 (&
boŸ_˝u_d©a
)

	)

94 
	#cuºít_˝u_d©a
 
boŸ_˝u_d©a


	)

97 
ign‹e_Âu_úq
;

99 
idítify_˝u
(
˝uöfo_x86
 *);

100 
¥öt_˝u_öfo
(
˝uöfo_x86
 *);

101 
dodgy_tsc
();

106 
	#X86_EFLAGS_CF
 0x00000001

	)

107 
	#X86_EFLAGS_PF
 0x00000004

	)

108 
	#X86_EFLAGS_AF
 0x00000010

	)

109 
	#X86_EFLAGS_ZF
 0x00000040

	)

110 
	#X86_EFLAGS_SF
 0x00000080

	)

111 
	#X86_EFLAGS_TF
 0x00000100

	)

112 
	#X86_EFLAGS_IF
 0x00000200

	)

113 
	#X86_EFLAGS_DF
 0x00000400

	)

114 
	#X86_EFLAGS_OF
 0x00000800

	)

115 
	#X86_EFLAGS_IOPL
 0x00003000

	)

116 
	#X86_EFLAGS_NT
 0x00004000

	)

117 
	#X86_EFLAGS_RF
 0x00010000

	)

118 
	#X86_EFLAGS_VM
 0x00020000

	)

119 
	#X86_EFLAGS_AC
 0x00040000

	)

120 
	#X86_EFLAGS_VIF
 0x00080000

	)

121 
	#X86_EFLAGS_VIP
 0x00100000

	)

122 
	#X86_EFLAGS_ID
 0x00200000

	)

127 
ölöe
 
	$˝uid
(
›
, *
óx
, *
ebx
, *
ecx
, *
edx
)

129 
	`__asm__
("cpuid"

130 : "˜" (*
óx
),

131 "=b" (*
ebx
),

132 "=c" (*
ecx
),

133 "=d" (*
edx
)

134 : "0" (
›
));

135 
	}
}

140 
ölöe
 
	$˝uid_óx
(
›
)

142 
óx
;

144 
	`__asm__
("cpuid"

145 : "˜" (
óx
)

146 : "0" (
›
)

148  
óx
;

149 
	}
}

150 
ölöe
 
	$˝uid_ebx
(
›
)

152 
óx
, 
ebx
;

154 
	`__asm__
("cpuid"

155 : "˜" (
óx
), "=b" (
ebx
)

156 : "0" (
›
)

158  
ebx
;

159 
	}
}

160 
ölöe
 
	$˝uid_ecx
(
›
)

162 
óx
, 
ecx
;

164 
	`__asm__
("cpuid"

165 : "˜" (
óx
), "=c" (
ecx
)

166 : "0" (
›
)

168  
ecx
;

169 
	}
}

170 
ölöe
 
	$˝uid_edx
(
›
)

172 
óx
, 
edx
;

174 
	`__asm__
("cpuid"

175 : "˜" (
óx
), "=d" (
edx
)

176 : "0" (
›
)

178  
edx
;

179 
	}
}

181 
	#lﬂd_¸3
(
pgdú
) \

182 
asm
 vﬁ©ûe("mov»%0,%%¸3": :"r" (
	`__∑
(
pgdú
)))

	)

188 
	#X86_CR4_VME
 0x0001

	)

189 
	#X86_CR4_PVI
 0x0002

	)

190 
	#X86_CR4_TSD
 0x0004

	)

191 
	#X86_CR4_DE
 0x0008

	)

192 
	#X86_CR4_PSE
 0x0010

	)

193 
	#X86_CR4_PAE
 0x0020

	)

194 
	#X86_CR4_MCE
 0x0040

	)

195 
	#X86_CR4_PGE
 0x0080

	)

196 
	#X86_CR4_PCE
 0x0100

	)

197 
	#X86_CR4_OSFXSR
 0x0200

	)

198 
	#X86_CR4_OSXMMEXCPT
 0x0400

	)

206 
mmu_¸4_„©uªs
;

208 
ölöe
 
	$£t_ö_¸4
 (
mask
)

210 
mmu_¸4_„©uªs
 |
mask
;

211 
	`__asm__
("movl %%cr4,%%eax\n\t"

214 : : "úg" (
mask
)

216 
	}
}

218 
ölöe
 
	$˛ór_ö_¸4
 (
mask
)

220 
mmu_¸4_„©uªs
 &~
mask
;

221 
	`__asm__
("movl %%cr4,%%eax\n\t"

224 : : "úg" (~
mask
)

226 
	}
}

232 
	#CX86_PCR0
 0x20

	)

233 
	#CX86_GCR
 0xb8

	)

234 
	#CX86_CCR0
 0xc0

	)

235 
	#CX86_CCR1
 0xc1

	)

236 
	#CX86_CCR2
 0xc2

	)

237 
	#CX86_CCR3
 0xc3

	)

238 
	#CX86_CCR4
 0xe8

	)

239 
	#CX86_CCR5
 0xe9

	)

240 
	#CX86_CCR6
 0xó

	)

241 
	#CX86_CCR7
 0xeb

	)

242 
	#CX86_PCR1
 0xf0

	)

243 
	#CX86_DIR0
 0x„

	)

244 
	#CX86_DIR1
 0xff

	)

245 
	#CX86_ARR_BASE
 0xc4

	)

246 
	#CX86_RCR_BASE
 0xdc

	)

252 
	#gëCx86
(
ªg
Ë({ 
	`outb
(‘eg), 0x22); 
	`öb
(0x23); })

	)

254 
	#£tCx86
(
ªg
, 
d©a
) do { \

255 
	`outb
((
ªg
), 0x22); \

256 
	`outb
((
d©a
), 0x23); \

257 } 0)

	)

263 
MCA_bus
;

264 #ifde‡
CONFIG_X86_PC9800


265 
	#pc98
 1

	)

267 
	#pc98
 0

	)

270 
ölöe
 
	$__m⁄ô‹
(c⁄° *
óx
, 
ecx
,

271 
edx
)

274 
asm
 volatile(

276 : :"a" (
óx
), "c" (
ecx
), "d"(
edx
));

277 
	}
}

279 
ölöe
 
	$__mwaô
(
óx
, 
ecx
)

282 
asm
 volatile(

284 : :"a" (
óx
), "c" (
ecx
));

285 
	}
}

289 
machöe_id
;

290 
machöe_submodñ_id
;

291 
BIOS_ªvisi⁄
;

292 
mˇ_≥¡ium_Êag
;

297 
	#TASK_SIZE
 (
PAGE_OFFSET
)

	)

302 
	#TASK_UNMAPPED_BASE
 (
	`PAGE_ALIGN
(
TASK_SIZE
 / 3))

	)

307 
	#IO_BITMAP_BITS
 1024

	)

308 
	#IO_BITMAP_BYTES
 (
IO_BITMAP_BITS
/8)

	)

309 
	#IO_BITMAP_LONGS
 (
IO_BITMAP_BYTES
/())

	)

310 
	#IO_BITMAP_OFFSET
 
	`off£tof
(
tss_°ru˘
,
io_bôm≠
)

	)

311 
	#INVALID_IO_BITMAP_OFFSET
 0x8000

	)

313 
	si387_fßve_°ru˘
 {

314 
	mcwd
;

315 
	mswd
;

316 
	mtwd
;

317 
	mfù
;

318 
	mfcs
;

319 
	mfoo
;

320 
	mfos
;

321 
	m°_•a˚
[20];

322 
	m°©us
;

325 
	si387_fxßve_°ru˘
 {

326 
	mcwd
;

327 
	mswd
;

328 
	mtwd
;

329 
	mf›
;

330 
	mfù
;

331 
	mfcs
;

332 
	mfoo
;

333 
	mfos
;

334 
	mmxc§
;

335 
	mª£rved
;

336 
	m°_•a˚
[32];

337 
	mxmm_•a˚
[32];

338 
	m∑ddög
[56];

339 } 
__©åibuã__
 ((
Æig√d
 (16)));

341 
	si387_so·_°ru˘
 {

342 
	mcwd
;

343 
	mswd
;

344 
	mtwd
;

345 
	mfù
;

346 
	mfcs
;

347 
	mfoo
;

348 
	mfos
;

349 
	m°_•a˚
[20];

350 
	m·›
, 
	mch™ged
, 
	mlookahód
, 
	mno_upd©e
, 
	mrm
, 
	mÆimô
;

351 
öfo
 *
	möfo
;

352 
	míåy_eù
;

355 
	ui387_uni⁄
 {

356 
i387_fßve_°ru˘
 
	mfßve
;

357 
i387_fxßve_°ru˘
 
	mfxßve
;

358 
i387_so·_°ru˘
 
	mso·
;

362 
	m£g
;

363 } 
	tmm_£gmít_t
;

365 
	stss_°ru˘
 {

366 
	mback_lök
,
	m__blh
;

367 
	me•0
;

368 
	mss0
,
	m__ss0h
;

369 
	me•1
;

370 
	mss1
,
	m__ss1h
;

371 
	me•2
;

372 
	mss2
,
	m__ss2h
;

373 
	m__¸3
;

374 
	meù
;

375 
	meÊags
;

376 
	móx
,
	mecx
,
	medx
,
	mebx
;

377 
	me•
;

378 
	mebp
;

379 
	mesi
;

380 
	medi
;

381 
	mes
, 
	m__esh
;

382 
	mcs
, 
	m__csh
;

383 
	mss
, 
	m__ssh
;

384 
	mds
, 
	m__dsh
;

385 
	mfs
, 
	m__fsh
;

386 
	mgs
, 
	m__gsh
;

387 
	mldt
, 
	m__ldth
;

388 
	måa˚
, 
	mio_bôm≠_ba£
;

395 
	mio_bôm≠
[
IO_BITMAP_LONGS
 + 1];

399 
	m__ˇchñöe_fûÀr
[5];

403 
	m°ack
[64];

404 } 
__©åibuã__
((
∑cked
));

406 
	sthªad_°ru˘
 {

408 
desc_°ru˘
 
	més_¨øy
[
GDT_ENTRY_TLS_ENTRIES
];

409 
	me•0
;

410 
	meù
;

411 
	me•
;

412 
	mfs
;

413 
	mgs
;

415 
	mdebugªg
[8];

417 
	m¸2
, 
	må≠_no
, 
	mîr‹_code
;

419 
i387_uni⁄
 
	mi387
;

421 
vm86_°ru˘
 
__u£r
 * 
	mvm86_öfo
;

422 
	ms¸ìn_bôm≠
;

423 
	mv86Êags
, 
	mv86mask
, 
	mßved_e•0
;

424 
	mßved_fs
, 
	mßved_gs
;

426 *
	mio_bôm≠_±r
;

429 
	#INIT_THREAD
 { \

430 .
vm86_öfo
 = 
NULL
, \

431 .
io_bôm≠_±r
 = 
NULL
, \

432 }

	)

440 
	#INIT_TSS
 { \

441 .
e•0
 = (
öô_°ack
) + ()&init_stack, \

442 .
ss0
 = 
__KERNEL_DS
, \

443 .
e•1
 = (
öô_tss
[0]) + ()&init_tss[0], \

444 .
ss1
 = 
__KERNEL_CS
, \

445 .
ldt
 = 
GDT_ENTRY_LDT
, \

446 .
io_bôm≠_ba£
 = 
INVALID_IO_BITMAP_OFFSET
, \

447 .
io_bôm≠
 = { [ 0 ... 
IO_BITMAP_LONGS
] = ~0 }, \

448 }

	)

450 
ölöe
 
	$lﬂd_e•0
(
tss_°ru˘
 *
tss
, 
e•0
)

452 
tss
->
e•0
 =Ésp0;

454 i‡((
	`u∆ikñy
(
tss
->
ss1
 !
__KERNEL_CS
))) {

455 
tss
->
ss1
 = 
__KERNEL_CS
;

456 
	`wrm§
(
MSR_IA32_SYSENTER_CS
, 
__KERNEL_CS
, 0);

458 
	}
}

460 
ölöe
 
	$dißbÀ_sy£¡î
(
tss_°ru˘
 *
tss
)

462 i‡(
˝u_has_£p
) {

463 
tss
->
ss1
 = 0;

464 
	`wrm§
(
MSR_IA32_SYSENTER_CS
, 0, 0);

466 
	}
}

468 
	#°¨t_thªad
(
ªgs
, 
√w_eù
, 
√w_e•
) do { \

469 
	`__asm__
("movl %0,%%fs ; movl %0,%%gs": :"r" (0)); \

470 
	`£t_fs
(
USER_DS
); \

471 
ªgs
->
xds
 = 
__USER_DS
; \

472 
ªgs
->
xes
 = 
__USER_DS
; \

473 
ªgs
->
xss
 = 
__USER_DS
; \

474 
ªgs
->
xcs
 = 
__USER_CS
; \

475 
ªgs
->
eù
 = 
√w_eù
; \

476 
ªgs
->
e•
 = 
√w_e•
; \

477 } 0)

	)

480 
	gèsk_°ru˘
;

481 
	gmm_°ru˘
;

484 
ªÀa£_thªad
(
èsk_°ru˘
 *);

487 
¥ï¨e_to_c›y
(
èsk_°ru˘
 *
tsk
);

492 
kî√l_thªad
((*
‚
)(*), * 
¨g
, 
Êags
);

494 
	`thªad_ßved_pc
(
èsk_°ru˘
 *
tsk
);

495 
	`show_åa˚
(
èsk_°ru˘
 *
èsk
, *
°ack
);

497 
	`gë_wch™
(
èsk_°ru˘
 *
p
);

498 
	#KSTK_EIP
(
tsk
Ë(((*)(4096+()—sk)->
thªad_öfo
))[1019])

	)

499 
	#KSTK_ESP
(
tsk
Ë(((*)(4096+()—sk)->
thªad_öfo
))[1022])

	)

501 
	smi¸ocode
 {

502 
hdrvî
;

503 
ªv
;

504 
d©e
;

505 
sig
;

506 
cksum
;

507 
ldrvî
;

508 
pf
;

509 
ª£rved
[5];

510 
bôs
[500];

514 
	#MICROCODE_IOCFREE
 
	`_IO
('6',0)

	)

517 
ölöe
 
	$ªp_n›
()

519 
__asm__
 
	`__vﬁ©ûe__
("rep;nop": : :"memory");

520 
	}
}

522 
	#˝u_ªœx
(Ë
	`ªp_n›
()

	)

525 
	#GENERIC_NOP1
 ".byã 0x90\n"

	)

526 
	#GENERIC_NOP2
 ".byã 0x89,0xf6\n"

	)

527 
	#GENERIC_NOP3
 ".byã 0x8d,0x76,0x00\n"

	)

528 
	#GENERIC_NOP4
 ".byã 0x8d,0x74,0x26,0x00\n"

	)

529 
	#GENERIC_NOP5
 
GENERIC_NOP1
 
GENERIC_NOP4


	)

530 
	#GENERIC_NOP6
 ".byã 0x8d,0xb6,0x00,0x00,0x00,0x00\n"

	)

531 
	#GENERIC_NOP7
 ".byã 0x8d,0xb4,0x26,0x00,0x00,0x00,0x00\n"

	)

532 
	#GENERIC_NOP8
 
GENERIC_NOP1
 
GENERIC_NOP7


	)

535 
	#K8_NOP1
 
GENERIC_NOP1


	)

536 
	#K8_NOP2
 ".byã 0x66,0x90\n"

	)

537 
	#K8_NOP3
 ".byã 0x66,0x66,0x90\n"

	)

538 
	#K8_NOP4
 ".byã 0x66,0x66,0x66,0x90\n"

	)

539 
	#K8_NOP5
 
K8_NOP3
 
K8_NOP2


	)

540 
	#K8_NOP6
 
K8_NOP3
 
	)
K8_NOP3

541 
	#K8_NOP7
 
K8_NOP4
 
K8_NOP3


	)

542 
	#K8_NOP8
 
K8_NOP4
 
	)
K8_NOP4

546 
	#K7_NOP1
 
GENERIC_NOP1


	)

547 
	#K7_NOP2
 ".byã 0x8b,0xc0\n"

	)

548 
	#K7_NOP3
 ".byã 0x8d,0x04,0x20\n"

	)

549 
	#K7_NOP4
 ".byã 0x8d,0x44,0x20,0x00\n"

	)

550 
	#K7_NOP5
 
K7_NOP4
 
ASM_NOP1


	)

551 
	#K7_NOP6
 ".byã 0x8d,0x80,0,0,0,0\n"

	)

552 
	#K7_NOP7
 ".byã 0x8D,0x04,0x05,0,0,0,0\n"

	)

553 
	#K7_NOP8
 
K7_NOP7
 
ASM_NOP1


	)

555 #ifde‡
CONFIG_MK8


556 
	#ASM_NOP1
 
K8_NOP1


	)

557 
	#ASM_NOP2
 
K8_NOP2


	)

558 
	#ASM_NOP3
 
K8_NOP3


	)

559 
	#ASM_NOP4
 
K8_NOP4


	)

560 
	#ASM_NOP5
 
K8_NOP5


	)

561 
	#ASM_NOP6
 
K8_NOP6


	)

562 
	#ASM_NOP7
 
K8_NOP7


	)

563 
	#ASM_NOP8
 
K8_NOP8


	)

564 #ñi‡
deföed
(
CONFIG_MK7
)

565 
	#ASM_NOP1
 
K7_NOP1


	)

566 
	#ASM_NOP2
 
K7_NOP2


	)

567 
	#ASM_NOP3
 
K7_NOP3


	)

568 
	#ASM_NOP4
 
K7_NOP4


	)

569 
	#ASM_NOP5
 
K7_NOP5


	)

570 
	#ASM_NOP6
 
K7_NOP6


	)

571 
	#ASM_NOP7
 
K7_NOP7


	)

572 
	#ASM_NOP8
 
K7_NOP8


	)

574 
	#ASM_NOP1
 
GENERIC_NOP1


	)

575 
	#ASM_NOP2
 
GENERIC_NOP2


	)

576 
	#ASM_NOP3
 
GENERIC_NOP3


	)

577 
	#ASM_NOP4
 
GENERIC_NOP4


	)

578 
	#ASM_NOP5
 
GENERIC_NOP5


	)

579 
	#ASM_NOP6
 
GENERIC_NOP6


	)

580 
	#ASM_NOP7
 
GENERIC_NOP7


	)

581 
	#ASM_NOP8
 
GENERIC_NOP8


	)

584 
	#ASM_NOP_MAX
 8

	)

591 
	#ARCH_HAS_PREFETCH


	)

592 
ölöe
 
	$¥e„tch
(c⁄° *
x
)

594 
	`Æã∫©ive_öput
(
ASM_NOP4
,

596 
X86_FEATURE_XMM
,

597 "r" (
x
));

598 
	}
}

600 
	#ARCH_HAS_PREFETCH


	)

601 
	#ARCH_HAS_PREFETCHW


	)

602 
	#ARCH_HAS_SPINLOCK_PREFETCH


	)

606 
ölöe
 
	$¥e„tchw
(c⁄° *
x
)

608 
	`Æã∫©ive_öput
(
ASM_NOP4
,

610 
X86_FEATURE_3DNOW
,

611 "r" (
x
));

612 
	}
}

613 
	#•ö_lock_¥e„tch
(
x
Ë
	`¥e„tchw
(x)

	)

615 
£À˘_idÀ_routöe
(c⁄° 
˝uöfo_x86
 *
c
);

	@/usr/include/asm/segment.h

1 #i‚de‡
_ASM_SEGMENT_H


2 
	#_ASM_SEGMENT_H


	)

48 
	#GDT_ENTRY_TLS_ENTRIES
 3

	)

49 
	#GDT_ENTRY_TLS_MIN
 6

	)

50 
	#GDT_ENTRY_TLS_MAX
 (
GDT_ENTRY_TLS_MIN
 + 
GDT_ENTRY_TLS_ENTRIES
 - 1)

	)

52 
	#TLS_SIZE
 (
GDT_ENTRY_TLS_ENTRIES
 * 8)

	)

54 
	#GDT_ENTRY_DEFAULT_USER_CS
 14

	)

55 
	#__USER_CS
 (
GDT_ENTRY_DEFAULT_USER_CS
 * 8 + 3)

	)

57 
	#GDT_ENTRY_DEFAULT_USER_DS
 15

	)

58 
	#__USER_DS
 (
GDT_ENTRY_DEFAULT_USER_DS
 * 8 + 3)

	)

60 
	#GDT_ENTRY_KERNEL_BASE
 12

	)

62 
	#GDT_ENTRY_KERNEL_CS
 (
GDT_ENTRY_KERNEL_BASE
 + 0)

	)

63 
	#__KERNEL_CS
 (
GDT_ENTRY_KERNEL_CS
 * 8)

	)

65 
	#GDT_ENTRY_KERNEL_DS
 (
GDT_ENTRY_KERNEL_BASE
 + 1)

	)

66 
	#__KERNEL_DS
 (
GDT_ENTRY_KERNEL_DS
 * 8)

	)

68 
	#GDT_ENTRY_TSS
 (
GDT_ENTRY_KERNEL_BASE
 + 4)

	)

69 
	#GDT_ENTRY_LDT
 (
GDT_ENTRY_KERNEL_BASE
 + 5)

	)

71 
	#GDT_ENTRY_PNPBIOS_BASE
 (
GDT_ENTRY_KERNEL_BASE
 + 6)

	)

72 
	#GDT_ENTRY_APMBIOS_BASE
 (
GDT_ENTRY_KERNEL_BASE
 + 11)

	)

74 
	#GDT_ENTRY_DOUBLEFAULT_TSS
 31

	)

79 
	#GDT_ENTRIES
 32

	)

81 
	#GDT_SIZE
 (
GDT_ENTRIES
 * 8)

	)

85 
	#GDT_ENTRY_BOOT_CS
 2

	)

86 
	#__BOOT_CS
 (
GDT_ENTRY_BOOT_CS
 * 8)

	)

88 
	#GDT_ENTRY_BOOT_DS
 (
GDT_ENTRY_BOOT_CS
 + 1)

	)

89 
	#__BOOT_DS
 (
GDT_ENTRY_BOOT_DS
 * 8)

	)

96 
	#IDT_ENTRIES
 256

	)

	@/usr/include/asm/sockios.h

1 #i‚de‡
__ARCH_I386_SOCKIOS__


2 
	#__ARCH_I386_SOCKIOS__


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

	@/usr/include/asm/spinlock.h

1 #i‚de‡
__ASM_SPINLOCK_H


2 
	#__ASM_SPINLOCK_H


	)

4 
	~<asm/©omic.h
>

5 
	~<asm/rwlock.h
>

6 
	~<asm/∑ge.h
>

7 
	~<löux/c⁄fig.h
>

8 
	~<löux/compûî.h
>

10 
	$¥ötk
(c⁄° * 
fmt
, ...)

11 
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 1, 2)));

18 vﬁ©ûê
lock
;

19 #ifde‡
CONFIG_DEBUG_SPINLOCK


20 
magic
;

22 } 
	t•ölock_t
;

24 
	#SPINLOCK_MAGIC
 0xdód4ód

	)

26 #ifde‡
CONFIG_DEBUG_SPINLOCK


27 
	#SPINLOCK_MAGIC_INIT
 , 
SPINLOCK_MAGIC


	)

29 
	#SPINLOCK_MAGIC_INIT


	)

32 
	#SPIN_LOCK_UNLOCKED
 (
•ölock_t
Ë{ 1 
SPINLOCK_MAGIC_INIT
 
	}

	)
}

34 
	#•ö_lock_öô
(
x
Ëdÿ{ *(xË
SPIN_LOCK_UNLOCKED
; } 0)

	)

43 
	#•ö_is_locked
(
x
Ë(*(vﬁ©ûêsig√d *)(&(x)->
lock
Ë<0)

	)

44 
	#•ö_u∆ock_waô
(
x
Ëdÿ{ 
	`b¨rõr
(); } 
	`•ö_is_locked
(x))

	)

46 
	#•ö_lock_°rög
 \

50 
	`LOCK_SECTION_START
("") \

56 
LOCK_SECTION_END


	)

64 #i‡!
deföed
(
CONFIG_X86_OOSTORE
Ë&& !deföed(
CONFIG_X86_PPRO_FENCE
)

66 
	#•ö_u∆ock_°rög
 \

68 :"=m" (
lock
->lockË: : "mem‹y"

	)

71 
ölöe
 
	$_øw_•ö_u∆ock
(
•ölock_t
 *
lock
)

73 #ifde‡
CONFIG_DEBUG_SPINLOCK


74 
	`BUG_ON
(
lock
->
magic
 !
SPINLOCK_MAGIC
);

75 
	`BUG_ON
(!
	`•ö_is_locked
(
lock
));

77 
__asm__
 
	`__vﬁ©ûe__
(

78 
•ö_u∆ock_°rög


80 
	}
}

84 
	#•ö_u∆ock_°rög
 \

86 :"=q" (
ﬁdvÆ
), "=m" (
lock
->lock) \

87 :"0" (
ﬁdvÆ
Ë: "mem‹y"

	)

89 
ölöe
 
	$_øw_•ö_u∆ock
(
•ölock_t
 *
lock
)

91 
ﬁdvÆ
 = 1;

92 #ifde‡
CONFIG_DEBUG_SPINLOCK


93 
	`BUG_ON
(
lock
->
magic
 !
SPINLOCK_MAGIC
);

94 
	`BUG_ON
(!
	`•ö_is_locked
(
lock
));

96 
__asm__
 
	`__vﬁ©ûe__
(

97 
•ö_u∆ock_°rög


99 
	}
}

103 
ölöe
 
	$_øw_•ö_åylock
(
•ölock_t
 *
lock
)

105 
ﬁdvÆ
;

106 
__asm__
 
	`__vﬁ©ûe__
(

108 :"=q" (
ﬁdvÆ
), "=m" (
lock
->lock)

110  
ﬁdvÆ
 > 0;

111 
	}
}

113 
ölöe
 
	$_øw_•ö_lock
(
•ölock_t
 *
lock
)

115 #ifde‡
CONFIG_DEBUG_SPINLOCK


116 
__œbñ__
 
hîe
;

117 
hîe
:

118 i‡(
	`u∆ikñy
(
lock
->
magic
 !
SPINLOCK_MAGIC
)) {

119 
	`¥ötk
("eù: %p\n", &&
hîe
);

120 
	`BUG
();

123 
__asm__
 
	`__vﬁ©ûe__
(

124 
•ö_lock_°rög


125 :"=m" (
lock
->lock) : : "memory");

126 
	}
}

140 vﬁ©ûê
	mlock
;

141 #ifde‡
CONFIG_DEBUG_SPINLOCK


142 
	mmagic
;

144 } 
	trwlock_t
;

146 
	#RWLOCK_MAGIC
 0xdóf1ìd

	)

148 #ifde‡
CONFIG_DEBUG_SPINLOCK


149 
	#RWLOCK_MAGIC_INIT
 , 
RWLOCK_MAGIC


	)

151 
	#RWLOCK_MAGIC_INIT


	)

154 
	#RW_LOCK_UNLOCKED
 (
rwlock_t
Ë{ 
RW_LOCK_BIAS
 
RWLOCK_MAGIC_INIT
 }

	)

156 
	#rwlock_öô
(
x
Ëdÿ{ *(xË
RW_LOCK_UNLOCKED
; } 0)

	)

158 
	#rwlock_is_locked
(
x
Ë((x)->
lock
 !
RW_LOCK_BIAS
)

	)

171 
ölöe
 
	$_øw_ªad_lock
(
rwlock_t
 *
rw
)

173 #ifde‡
CONFIG_DEBUG_SPINLOCK


174 
	`BUG_ON
(
rw
->
magic
 !
RWLOCK_MAGIC
);

176 
	`__buûd_ªad_lock
(
rw
, "__read_lock_failed");

177 
	}
}

179 
ölöe
 
	$_øw_wrôe_lock
(
rwlock_t
 *
rw
)

181 #ifde‡
CONFIG_DEBUG_SPINLOCK


182 
	`BUG_ON
(
rw
->
magic
 !
RWLOCK_MAGIC
);

184 
	`__buûd_wrôe_lock
(
rw
, "__write_lock_failed");

185 
	}
}

187 
	#_øw_ªad_u∆ock
(
rw
Ë
asm
 vﬁ©ûe("lock ; in˛ %0" :"=m" (‘w)->
lock
Ë: : "mem‹y")

	)

188 
	#_øw_wrôe_u∆ock
(
rw
Ë
asm
 vﬁ©ûe("lock ;ádd»$" 
RW_LOCK_BIAS_STR
 ",%0":"=m" (‘w)->
lock
Ë: : "mem‹y")

	)

190 
ölöe
 
	$_øw_wrôe_åylock
(
rwlock_t
 *
lock
)

192 
©omic_t
 *
cou¡
 = (©omic_à*)
lock
;

193 i‡(
	`©omic_sub_™d_ã°
(
RW_LOCK_BIAS
, 
cou¡
))

195 
	`©omic_add
(
RW_LOCK_BIAS
, 
cou¡
);

197 
	}
}

	@/usr/include/asm/stat.h

1 #i‚de‡
_I386_STAT_H


2 
	#_I386_STAT_H


	)

4 
	s__ﬁd_kî√l_°©
 {

5 
	m°_dev
;

6 
	m°_öo
;

7 
	m°_mode
;

8 
	m°_∆ök
;

9 
	m°_uid
;

10 
	m°_gid
;

11 
	m°_rdev
;

12 
	m°_size
;

13 
	m°_©ime
;

14 
	m°_mtime
;

15 
	m°_˘ime
;

18 
	s°©
 {

19 
	m°_dev
;

20 
	m°_öo
;

21 
	m°_mode
;

22 
	m°_∆ök
;

23 
	m°_uid
;

24 
	m°_gid
;

25 
	m°_rdev
;

26 
	m°_size
;

27 
	m°_blksize
;

28 
	m°_blocks
;

29 
	m°_©ime
;

30 
	m°_©ime_n£c
;

31 
	m°_mtime
;

32 
	m°_mtime_n£c
;

33 
	m°_˘ime
;

34 
	m°_˘ime_n£c
;

35 
	m__unu£d4
;

36 
	m__unu£d5
;

42 
	s°©64
 {

43 
	m°_dev
;

44 
	m__∑d0
[4];

46 
	#STAT64_HAS_BROKEN_ST_INO
 1

	)

47 
	m__°_öo
;

49 
	m°_mode
;

50 
	m°_∆ök
;

52 
	m°_uid
;

53 
	m°_gid
;

55 
	m°_rdev
;

56 
	m__∑d3
[4];

58 
	m°_size
;

59 
	m°_blksize
;

61 
	m°_blocks
;

62 
	m__∑d4
;

64 
	m°_©ime
;

65 
	m°_©ime_n£c
;

67 
	m°_mtime
;

68 
	m°_mtime_n£c
;

70 
	m°_˘ime
;

71 
	m°_˘ime_n£c
;

73 
	m°_öo
;

76 
	#STAT_HAVE_NSEC
 1

	)

	@/usr/include/asm/termios.h

1 #i‚de‡
_I386_TERMIOS_H


2 
	#_I386_TERMIOS_H


	)

4 
	~<asm/ãrmbôs.h
>

5 
	~<asm/io˘ls.h
>

7 
	swösize
 {

8 
	mws_row
;

9 
	mws_cﬁ
;

10 
	mws_xpixñ
;

11 
	mws_ypixñ
;

14 
	#NCC
 8

	)

15 
	sãrmio
 {

16 
	mc_iÊag
;

17 
	mc_oÊag
;

18 
	mc_cÊag
;

19 
	mc_lÊag
;

20 
	mc_löe
;

21 
	mc_cc
[
NCC
];

25 
	#TIOCM_LE
 0x001

	)

26 
	#TIOCM_DTR
 0x002

	)

27 
	#TIOCM_RTS
 0x004

	)

28 
	#TIOCM_ST
 0x008

	)

29 
	#TIOCM_SR
 0x010

	)

30 
	#TIOCM_CTS
 0x020

	)

31 
	#TIOCM_CAR
 0x040

	)

32 
	#TIOCM_RNG
 0x080

	)

33 
	#TIOCM_DSR
 0x100

	)

34 
	#TIOCM_CD
 
TIOCM_CAR


	)

35 
	#TIOCM_RI
 
TIOCM_RNG


	)

36 
	#TIOCM_OUT1
 0x2000

	)

37 
	#TIOCM_OUT2
 0x4000

	)

38 
	#TIOCM_LOOP
 0x8000

	)

43 
	#N_TTY
 0

	)

44 
	#N_SLIP
 1

	)

45 
	#N_MOUSE
 2

	)

46 
	#N_PPP
 3

	)

47 
	#N_STRIP
 4

	)

48 
	#N_AX25
 5

	)

49 
	#N_X25
 6

	)

50 
	#N_6PACK
 7

	)

51 
	#N_MASC
 8

	)

52 
	#N_R3964
 9

	)

53 
	#N_PROFIBUS_FDL
 10

	)

54 
	#N_IRDA
 11

	)

55 
	#N_SMSBLOCK
 12

	)

56 
	#N_HDLC
 13

	)

57 
	#N_SYNC_PPP
 14

	)

58 
	#N_HCI
 15

	)

60 #ifde‡
__KERNEL__


61 
	~<löux/moduÀ.h
>

69 
	#INIT_C_CC
 "\003\034\177\025\004\0\1\0\021\023\032\0\022\017\027\026\0"

	)

74 
	#SET_LOW_TERMIOS_BITS
(
ãrmios
, 
ãrmio
, 
x
) { \

75 
__tmp
; \

76 
	`gë_u£r
(
__tmp
,&(
ãrmio
)->
x
); \

77 *(*Ë&(
ãrmios
)->
x
 = 
__tmp
; \

78 }

	)

80 
	#u£r_ãrmio_to_kî√l_ãrmios
(
ãrmios
, 
ãrmio
) \

82 
	`SET_LOW_TERMIOS_BITS
(
ãrmios
, 
ãrmio
, 
c_iÊag
); \

83 
	`SET_LOW_TERMIOS_BITS
(
ãrmios
, 
ãrmio
, 
c_oÊag
); \

84 
	`SET_LOW_TERMIOS_BITS
(
ãrmios
, 
ãrmio
, 
c_cÊag
); \

85 
	`SET_LOW_TERMIOS_BITS
(
ãrmios
, 
ãrmio
, 
c_lÊag
); \

86 
	`c›y_‰om_u£r
((
ãrmios
)->
c_cc
, (
ãrmio
)->c_cc, 
NCC
); \

87 })

	)

92 
	#kî√l_ãrmios_to_u£r_ãrmio
(
ãrmio
, 
ãrmios
) \

94 
	`put_u£r
((
ãrmios
)->
c_iÊag
, &(
ãrmio
)->c_iflag); \

95 
	`put_u£r
((
ãrmios
)->
c_oÊag
, &(
ãrmio
)->c_oflag); \

96 
	`put_u£r
((
ãrmios
)->
c_cÊag
, &(
ãrmio
)->c_cflag); \

97 
	`put_u£r
((
ãrmios
)->
c_lÊag
, &(
ãrmio
)->c_lflag); \

98 
	`put_u£r
((
ãrmios
)->
c_löe
, &(
ãrmio
)->c_line); \

99 
	`c›y_to_u£r
((
ãrmio
)->
c_cc
, (
ãrmios
)->c_cc, 
NCC
); \

100 })

	)

102 
	#u£r_ãrmios_to_kî√l_ãrmios
(
k
, 
u
Ë
	`c›y_‰om_u£r
(k, u, (
ãrmios
))

	)

103 
	#kî√l_ãrmios_to_u£r_ãrmios
(
u
, 
k
Ë
	`c›y_to_u£r
(u, k, (
ãrmios
))

	)

	@/usr/include/bits/libc-lock.h

21 #i‚de‡
_BITS_LIBC_LOCK_H


22 
	#_BITS_LIBC_LOCK_H
 1

	)

24 
	~<±hªad.h
>

26 #i‡
deföed
 
_LIBC
 && !deföed 
NOT_IN_libc


27 
	~<löuxthªads/öã∫Æs.h
>

31 #i‡
deföed
(
_LIBC
Ë|| deföed(
_IO_MTSAFE_IO
)

32 
±hªad_muãx_t
 
	t__libc_lock_t
;

33 °ru˘ { 
±hªad_muãx_t
 
	mmuãx
; } 
	t__libc_lock_ªcursive_t
;

34 #ifde‡
__USE_UNIX98


35 
±hªad_rwlock_t
 
	t__libc_rwlock_t
;

37 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

39 
__libc_lock_ªcursive_t
 
	t__πld_lock_ªcursive_t
;

41 
__libc_lock_›aque__
 
	t__libc_lock_t
;

42 
__libc_lock_ªcursive_›aque__
 
	t__libc_lock_ªcursive_t
;

43 
__libc_rwlock_›aque__
 
	t__libc_rwlock_t
;

47 
±hªad_key_t
 
	t__libc_key_t
;

56 
	#__libc_lock_deföe
(
CLASS
,
NAME
) \

57 
CLASS
 
__libc_lock_t
 
NAME
;

	)

58 
	#__libc_rwlock_deföe
(
CLASS
,
NAME
) \

59 
CLASS
 
__libc_rwlock_t
 
NAME
;

	)

60 
	#__libc_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

61 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
;

	)

62 
	#__πld_lock_deföe_ªcursive
(
CLASS
,
NAME
) \

63 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
;

	)

74 #ifde‡
__LT_INITIALIZER_NOT_ZERO


75 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

76 
CLASS
 
__libc_lock_t
 
NAME
 = 
PTHREAD_MUTEX_INITIALIZER
;

	)

78 
	#__libc_lock_deföe_öôülized
(
CLASS
,
NAME
) \

79 
CLASS
 
__libc_lock_t
 
NAME
;

	)

82 
	#__libc_rwlock_deföe_öôülized
(
CLASS
,
NAME
) \

83 
CLASS
 
__libc_rwlock_t
 
NAME
 = 
PTHREAD_RWLOCK_INITIALIZER
;

	)

87 
	#__libc_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

88 
CLASS
 
__libc_lock_ªcursive_t
 
NAME
 = 
_LIBC_LOCK_RECURSIVE_INITIALIZER
;

	)

89 
	#_LIBC_LOCK_RECURSIVE_INITIALIZER
 \

90 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

92 
	#__πld_lock_deföe_öôülized_ªcursive
(
CLASS
,
NAME
) \

93 
CLASS
 
__πld_lock_ªcursive_t
 
NAME
 = 
_RTLD_LOCK_RECURSIVE_INITIALIZER
;

	)

94 
	#_RTLD_LOCK_RECURSIVE_INITIALIZER
 \

95 {
PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
}

	)

97 #i‡
deföed
 
_LIBC
 && deföed 
IS_IN_lib±hªad


98 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
ËFUNC 
	)
ARGS

100 #i‡
deföed
 
__PIC__
 || (deföed 
_LIBC
 && deföed 
SHARED
)

101 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

102 (
	`__exãnsi⁄__
 ({ 
	`__ty≥of
 (
FUNC
Ë*
_‚
 = (FUNC); \

103 
_‚
 !
NULL
 ? (*_‚Ë
ARGS
 : 
ELSE
; }))

	)

105 
	#__libc_maybe_ˇŒ
(
FUNC
, 
ARGS
, 
ELSE
) \

106 (
FUNC
 !
NULL
 ? FUNC 
ARGS
 : 
ELSE
)

	)

109 #i‡
deföed
 
_LIBC
 && !deföed 
NOT_IN_libc
 && deföed 
SHARED


110 
	#__libc_maybe_ˇŒ2
(
FUNC
, 
ARGS
, 
ELSE
) \

111 ({
	`__buûtö_ex≥˘
 (
__libc_±hªad_fun˘i⁄s
.
±r_
##
FUNC
 !
NULL
, 0) \

112 ? 
__libc_±hªad_fun˘i⁄s
.
±r_
##
FUNC
 
ARGS
 : 
ELSE
; })

	)

114 
	#__libc_maybe_ˇŒ2
(
FUNC
, 
ARGS
, 
ELSE
Ë
	`__libc_maybe_ˇŒ
 (
__
##FUNC, ARGS, ELSE)

	)

119 #i‡
deföed
 
_LIBC
 && !deföed 
NOT_IN_libc
 && deföed 
SHARED


120 
	#__libc_lock_öô
(
NAME
) \

122 (
NAME
).
__m_cou¡
 = 0; \

123 (
NAME
).
__m_ow√r
 = 
NULL
; \

124 (
NAME
).
__m_köd
 = 
PTHREAD_MUTEX_TIMED_NP
; \

125 (
NAME
).
__m_lock
.
__°©us
 = 0; \

126 (
NAME
).
__m_lock
.
__•ölock
 = 
__LT_SPINLOCK_INIT
; \

127 0; })

	)

129 
	#__libc_lock_öô
(
NAME
) \

130 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_öô
, (&(
NAME
), 
NULL
), 0))

	)

132 
	#__libc_rwlock_öô
(
NAME
) \

133 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_öô
, (&(
NAME
), 
NULL
), 0));

	)

136 #i‡
deföed
 
_LIBC
 && !deföed 
NOT_IN_libc
 && deföed 
SHARED


137 
	#__libc_lock_öô_ªcursive
(
NAME
) \

139 (
NAME
).
muãx
.
__m_cou¡
 = 0; \

140 (
NAME
).
muãx
.
__m_ow√r
 = 
NULL
; \

141 (
NAME
).
muãx
.
__m_köd
 = 
PTHREAD_MUTEX_RECURSIVE_NP
; \

142 (
NAME
).
muãx
.
__m_lock
.
__°©us
 = 0; \

143 (
NAME
).
muãx
.
__m_lock
.
__•ölock
 = 
__LT_SPINLOCK_INIT
; \

144 0; })

	)

146 
	#__libc_lock_öô_ªcursive
(
NAME
) \

148 i‡(
__±hªad_muãx_öô
 !
NULL
) \

150 
±hªad_muãx©å_t
 
__©å
; \

151 
	`__±hªad_muãx©å_öô
 (&
__©å
); \

152 
	`__±hªad_muãx©å_£ây≥
 (&
__©å
, 
PTHREAD_MUTEX_RECURSIVE_NP
); \

153 
	`__±hªad_muãx_öô
 (&(
NAME
).
muãx
, &
__©å
); \

154 
	`__±hªad_muãx©å_de°roy
 (&
__©å
); \

156 } 0);

	)

158 
	#__πld_lock_öô_ªcursive
(
NAME
) \

159 
	`__libc_lock_öô_ªcursive
 (
NAME
)

	)

164 
	#__libc_lock_föi
(
NAME
) \

165 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_de°roy
, (&(
NAME
)), 0));

	)

166 
	#__libc_rwlock_föi
(
NAME
) \

167 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_de°roy
, (&(
NAME
)), 0));

	)

170 
	#__libc_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi
 ((NAME).
muãx
)

	)

171 
	#__πld_lock_föi_ªcursive
(
NAME
Ë
	`__libc_lock_föi_ªcursive
 (NAME)

	)

174 
	#__libc_lock_lock
(
NAME
) \

175 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_lock
, (&(
NAME
)), 0));

	)

176 
	#__libc_rwlock_rdlock
(
NAME
) \

177 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_rdlock
, (&(
NAME
)), 0));

	)

178 
	#__libc_rwlock_wæock
(
NAME
) \

179 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_wæock
, (&(
NAME
)), 0));

	)

182 
	#__libc_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock
 ((NAME).
muãx
)

	)

185 
	#__libc_lock_åylock
(
NAME
) \

186 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_åylock
, (&(
NAME
)), 0))

	)

187 
	#__libc_rwlock_åyrdlock
(
NAME
) \

188 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åyrdlock
, (&(
NAME
)), 0))

	)

189 
	#__libc_rwlock_åywæock
(
NAME
) \

190 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_åywæock
, (&(
NAME
)), 0))

	)

193 
	#__libc_lock_åylock_ªcursive
(
NAME
Ë
	`__libc_lock_åylock
 ((NAME).
muãx
)

	)

194 
	#__πld_lock_åylock_ªcursive
(
NAME
) \

195 
	`__libc_lock_åylock_ªcursive
 (
NAME
)

	)

198 
	#__libc_lock_u∆ock
(
NAME
) \

199 (
	`__libc_maybe_ˇŒ2
 (
±hªad_muãx_u∆ock
, (&(
NAME
)), 0));

	)

200 
	#__libc_rwlock_u∆ock
(
NAME
) \

201 (
	`__libc_maybe_ˇŒ
 (
__±hªad_rwlock_u∆ock
, (&(
NAME
)), 0));

	)

204 
	#__libc_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock
 ((NAME).
muãx
)

	)

206 #i‡
deföed
 
_LIBC
 && deföed 
SHARED


207 
	#__πld_lock_deÁu…_lock_ªcursive
(
lock
) \

208 ++((
±hªad_muãx_t
 *)(
lock
))->
__m_cou¡
;

	)

210 
	#__πld_lock_deÁu…_u∆ock_ªcursive
(
lock
) \

211 --((
±hªad_muãx_t
 *)(
lock
))->
__m_cou¡
;

	)

213 
	#__πld_lock_lock_ªcursive
(
NAME
) \

214 
	`GL
(
dl_πld_lock_ªcursive
Ë(&(
NAME
).
muãx
)

	)

216 
	#__πld_lock_u∆ock_ªcursive
(
NAME
) \

217 
	`GL
(
dl_πld_u∆ock_ªcursive
Ë(&(
NAME
).
muãx
)

	)

219 
	#__πld_lock_lock_ªcursive
(
NAME
Ë
	`__libc_lock_lock_ªcursive
 (NAME)

	)

220 
	#__πld_lock_u∆ock_ªcursive
(
NAME
Ë
	`__libc_lock_u∆ock_ªcursive
 (NAME)

	)

224 #i‡
PTHREAD_ONCE_INIT
 == 0

227 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

228 
CLASS
 
±hªad_⁄˚_t
 
NAME


	)

230 
	#__libc_⁄˚_deföe
(
CLASS
, 
NAME
) \

231 
CLASS
 
±hªad_⁄˚_t
 
NAME
 = 
PTHREAD_ONCE_INIT


	)

235 
	#__libc_⁄˚
(
ONCE_CONTROL
, 
INIT_FUNCTION
) \

237 i‡(
__±hªad_⁄˚
 !
NULL
) \

238 
	`__±hªad_⁄˚
 (&(
ONCE_CONTROL
), (
INIT_FUNCTION
)); \

239 i‡((
ONCE_CONTROL
Ë=
PTHREAD_ONCE_INIT
) { \

240 
	`INIT_FUNCTION
 (); \

241 (
ONCE_CONTROL
) = 2; \

243 } 0)

	)

247 
	#__libc_˛ónup_ªgi⁄_°¨t
(
DOIT
, 
FCT
, 
ARG
) \

248 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

249 
_avaû
 = (
DOIT
Ë&& 
_±hªad_˛ónup_push_de„r
 !
NULL
; \

250 i‡(
_avaû
) { \

251 
	`_±hªad_˛ónup_push_de„r
 (&
_buf„r
, (
FCT
), (
ARG
)); \

252 }

	)

255 
	#__libc_˛ónup_ªgi⁄_íd
(
DOIT
) \

256 i‡(
_avaû
) { \

257 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

259 }

	)

262 
	#__libc_˛ónup_íd
(
DOIT
) \

263 i‡(
_avaû
) { \

264 
	`_±hªad_˛ónup_p›_ª°‹e
 (&
_buf„r
, (
DOIT
)); \

265 }

	)

267 
	#__libc_˛ónup_push
(
f˘
, 
¨g
) \

268 { 
_±hªad_˛ónup_buf„r
 
_buf„r
; \

269 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_push
, (&
_buf„r
, (
f˘
), (
¨g
)), 0)

	)

271 
	#__libc_˛ónup_p›
(
execuã
) \

272 
	`__libc_maybe_ˇŒ
 (
_±hªad_˛ónup_p›
, (&
_buf„r
, 
execuã
), 0); \

273 }

	)

276 
	#__libc_key_¸óã
(
KEY
, 
DESTRUCTOR
) \

277 (
	`__libc_maybe_ˇŒ
 (
__±hªad_key_¸óã
, (
KEY
, 
DESTRUCTOR
), 1))

	)

280 
	#__libc_gë•ecific
(
KEY
) \

281 (
	`__libc_maybe_ˇŒ
 (
__±hªad_gë•ecific
, (
KEY
), 
NULL
))

	)

284 
	#__libc_£t•ecific
(
KEY
, 
VALUE
) \

285 (
	`__libc_maybe_ˇŒ
 (
__±hªad_£t•ecific
, (
KEY
, 
VALUE
), 0))

	)

289 
	#__libc_©f‹k
(
PREPARE
, 
PARENT
, 
CHILD
) \

290 (
	`__libc_maybe_ˇŒ
 (
__±hªad_©f‹k
, (
PREPARE
, 
PARENT
, 
CHILD
), 0))

	)

295 
__±hªad_muãx_öô
 (
±hªad_muãx_t
 *
__muãx
,

296 
__c⁄°
 
±hªad_muãx©å_t
 *
__muãx_©å
);

298 
__±hªad_muãx_de°roy
 (
±hªad_muãx_t
 *
__muãx
);

300 
__±hªad_muãx_åylock
 (
±hªad_muãx_t
 *
__muãx
);

302 
__±hªad_muãx_lock
 (
±hªad_muãx_t
 *
__muãx
);

304 
__±hªad_muãx_u∆ock
 (
±hªad_muãx_t
 *
__muãx
);

306 
__±hªad_muãx©å_öô
 (
±hªad_muãx©å_t
 *
__©å
);

308 
__±hªad_muãx©å_de°roy
 (
±hªad_muãx©å_t
 *
__©å
);

310 
__±hªad_muãx©å_£ây≥
 (
±hªad_muãx©å_t
 *
__©å
,

311 
__köd
);

313 #ifde‡
__USE_UNIX98


314 
__±hªad_rwlock_öô
 (
±hªad_rwlock_t
 *
__rwlock
,

315 
__c⁄°
 
±hªad_rwlock©å_t
 *
__©å
);

317 
__±hªad_rwlock_de°roy
 (
±hªad_rwlock_t
 *
__rwlock
);

319 
__±hªad_rwlock_rdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

321 
__±hªad_rwlock_åyrdlock
 (
±hªad_rwlock_t
 *
__rwlock
);

323 
__±hªad_rwlock_wæock
 (
±hªad_rwlock_t
 *
__rwlock
);

325 
__±hªad_rwlock_åywæock
 (
±hªad_rwlock_t
 *
__rwlock
);

327 
__±hªad_rwlock_u∆ock
 (
±hªad_rwlock_t
 *
__rwlock
);

330 
__±hªad_key_¸óã
 (
±hªad_key_t
 *
__key
,

331 (*
__de°r_fun˘i⁄
) (*));

333 
	`__±hªad_£t•ecific
 (
±hªad_key_t
 
__key
,

334 
__c⁄°
 *
__poöãr
);

336 *
	`__±hªad_gë•ecific
 (
±hªad_key_t
 
__key
);

338 
	`__±hªad_⁄˚
 (
±hªad_⁄˚_t
 *
__⁄˚_c⁄åﬁ
,

339 (*
__öô_routöe
) ());

341 
	`__±hªad_©f‹k
 ((*
__¥ï¨e
) (),

342 (*
__∑ª¡
) (),

343 (*
__chûd
) ());

349 #i‚de‡
__NO_WEAK_PTHREAD_ALIASES


350 #ifde‡
wók_exã∫


351 #i‡
_LIBC


352 
	~<bp-sym.h
>

354 
	#BP_SYM
 (
sym
Ë
	)
sym

356 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_öô
))

357 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_de°roy
))

358 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_lock
))

359 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_åylock
))

360 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx_u∆ock
))

361 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_öô
))

362 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_de°roy
))

363 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_muãx©å_£ây≥
))

364 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_öô
))

365 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_de°roy
))

366 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_rdlock
))

367 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_åyrdlock
))

368 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_wæock
))

369 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_åywæock
))

370 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_rwlock_u∆ock
))

371 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_key_¸óã
))

372 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_£t•ecific
))

373 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_gë•ecific
))

374 
	`wók_exã∫
 (
	$BP_SYM
 (
__±hªad_⁄˚
))

375 
	$wók_exã∫
 (
__±hªad_öôülize
)

376 
	$wók_exã∫
 (
__±hªad_©f‹k
)

377 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_push
))

378 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_p›
))

379 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_push_de„r
))

380 
	`wók_exã∫
 (
	$BP_SYM
 (
_±hªad_˛ónup_p›_ª°‹e
))

382 #¥agm®
wók
 
__±hªad_muãx_öô


383 #¥agm®
wók
 
__±hªad_muãx_de°roy


384 #¥agm®
wók
 
__±hªad_muãx_lock


385 #¥agm®
wók
 
__±hªad_muãx_åylock


386 #¥agm®
wók
 
__±hªad_muãx_u∆ock


387 #¥agm®
wók
 
__±hªad_muãx©å_öô


388 #¥agm®
wók
 
__±hªad_muãx©å_de°roy


389 #¥agm®
wók
 
__±hªad_muãx©å_£ây≥


390 #¥agm®
wók
 
__±hªad_rwlock_de°roy


391 #¥agm®
wók
 
__±hªad_rwlock_rdlock


392 #¥agm®
wók
 
__±hªad_rwlock_åyrdlock


393 #¥agm®
wók
 
__±hªad_rwlock_wæock


394 #¥agm®
wók
 
__±hªad_rwlock_åywæock


395 #¥agm®
wók
 
__±hªad_rwlock_u∆ock


396 #¥agm®
wók
 
__±hªad_key_¸óã


397 #¥agm®
wók
 
__±hªad_£t•ecific


398 #¥agm®
wók
 
__±hªad_gë•ecific


399 #¥agm®
wók
 
__±hªad_⁄˚


400 #¥agm®
wók
 
__±hªad_öôülize


401 #¥agm®
wók
 
__±hªad_©f‹k


402 #¥agm®
wók
 
_±hªad_˛ónup_push_de„r


403 #¥agm®
wók
 
_±hªad_˛ónup_p›_ª°‹e


404 #¥agm®
wók
 
_±hªad_˛ónup_push


405 #¥agm®
wók
 
_±hªad_˛ónup_p›


411 
	#__libc_muãx_u∆ock
 
__±hªad_muãx_u∆ock


	)

	@/usr/include/gconv.h

23 #i‚de‡
_GCONV_H


24 
	#_GCONV_H
 1

	)

26 
	~<„©uªs.h
>

27 
	#__√ed_mb°©e_t


	)

28 
	~<wch¨.h
>

29 
	#__√ed_size_t


	)

30 
	#__√ed_wch¨_t


	)

31 
	~<°ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¨_t
Ë0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002

63 
	g__gc⁄v_°ï
;

64 
	g__gc⁄v_°ï_d©a
;

65 
	g__gc⁄v_lﬂded_obje˘
;

66 
	g__gc⁄v_å™s_d©a
;

70 (*
	t__gc⁄v_f˘
Ë(
	t__gc⁄v_°ï
 *, 
	t__gc⁄v_°ï_d©a
 *,

71 
	t__c⁄°
 **, __const *,

72 **, 
	tsize_t
 *, , );

75 
	$wöt_t
 (*
	t__gc⁄v_btowc_f˘
Ë(
	t__gc⁄v_°ï
 *, );

78 (*
	t__gc⁄v_öô_f˘
Ë(
	t__gc⁄v_°ï
 *);

79 (*
	t__gc⁄v_íd_f˘
Ë(
	t__gc⁄v_°ï
 *);

83 (*
	t__gc⁄v_å™s_f˘
Ë(
	t__gc⁄v_°ï
 *,

84 
	t__gc⁄v_°ï_d©a
 *, *,

85 
	t__c⁄°
 *,

86 
	t__c⁄°
 **,

87 
	t__c⁄°
 *, **,

88 
	tsize_t
 *);

91 (*
	t__gc⁄v_å™s_c⁄ãxt_f˘
Ë(*, 
	t__c⁄°
 *,

92 
	t__c⁄°
 *,

96 (*
	t__gc⁄v_å™s_quîy_f˘
Ë(
	t__c⁄°
 *, __const ***,

97 
	tsize_t
 *);

100 (*
	t__gc⁄v_å™s_öô_f˘
) (**, const *);

101 (*
	t__gc⁄v_å™s_íd_f˘
) (*);

103 
	s__gc⁄v_å™s_d©a


106 
__gc⁄v_å™s_f˘
 
__å™s_f˘
;

107 
__gc⁄v_å™s_c⁄ãxt_f˘
 
__å™s_c⁄ãxt_f˘
;

108 
__gc⁄v_å™s_íd_f˘
 
__å™s_íd_f˘
;

109 *
__d©a
;

110 
__gc⁄v_å™s_d©a
 *
__√xt
;

115 
	s__gc⁄v_°ï


117 
__gc⁄v_lﬂded_obje˘
 *
__shlib_h™dÀ
;

118 
__c⁄°
 *
__mod«me
;

120 
__cou¡î
;

122 *
__‰om_«me
;

123 *
__to_«me
;

125 
__gc⁄v_f˘
 
__f˘
;

126 
__gc⁄v_btowc_f˘
 
__btowc_f˘
;

127 
__gc⁄v_öô_f˘
 
__öô_f˘
;

128 
__gc⁄v_íd_f˘
 
__íd_f˘
;

132 
__mö_√eded_‰om
;

133 
__max_√eded_‰om
;

134 
__mö_√eded_to
;

135 
__max_√eded_to
;

138 
__°©eful
;

140 *
__d©a
;

145 
	s__gc⁄v_°ï_d©a


147 *
__outbuf
;

148 *
__outbu„nd
;

152 
__Êags
;

156 
__övoˇti⁄_cou¡î
;

160 
__öã∫Æ_u£
;

162 
__mb°©e_t
 *
__°©ï
;

163 
__mb°©e_t
 
__°©e
;

167 
__gc⁄v_å™s_d©a
 *
__å™s
;

172 
	s__gc⁄v_öfo


174 
size_t
 
__n°ïs
;

175 
__gc⁄v_°ï
 *
__°ïs
;

176 
__exãnsi⁄__
 
__gc⁄v_°ï_d©a
 
__d©a
 
__Êex¨r
;

177 } *
	t__gc⁄v_t
;

	@/usr/include/linux/bitops.h

1 #i‚de‡
_LINUX_BITOPS_H


2 
	#_LINUX_BITOPS_H


	)

3 
	~<asm/ty≥s.h
>

4 
	~<asm/bô›s.h
>

12 
ölöe
 
	$gíîic_ffs
(
x
)

14 
r
 = 1;

16 i‡(!
x
)

18 i‡(!(
x
 & 0xffff)) {

19 
x
 >>= 16;

20 
r
 += 16;

22 i‡(!(
x
 & 0xff)) {

23 
x
 >>= 8;

24 
r
 += 8;

26 i‡(!(
x
 & 0xf)) {

27 
x
 >>= 4;

28 
r
 += 4;

30 i‡(!(
x
 & 3)) {

31 
x
 >>= 2;

32 
r
 += 2;

34 i‡(!(
x
 & 1)) {

35 
x
 >>= 1;

36 
r
 += 1;

38  
r
;

39 
	}
}

45 
__ölöe__
 
	$gíîic_Ês
(
x
)

47 
r
 = 32;

49 i‡(!
x
)

51 i‡(!(
x
 & 0xffff0000u)) {

52 
x
 <<= 16;

53 
r
 -= 16;

55 i‡(!(
x
 & 0xff000000u)) {

56 
x
 <<= 8;

57 
r
 -= 8;

59 i‡(!(
x
 & 0xf0000000u)) {

60 
x
 <<= 4;

61 
r
 -= 4;

63 i‡(!(
x
 & 0xc0000000u)) {

64 
x
 <<= 2;

65 
r
 -= 2;

67 i‡(!(
x
 & 0x80000000u)) {

68 
x
 <<= 1;

69 
r
 -= 1;

71  
r
;

72 
	}
}

74 
__ölöe__
 
	$gë_bômask_‹dî
(
cou¡
)

76 
‹dî
;

78 
‹dî
 = 
	`Ês
(
cou¡
);

79  
‹dî
;

80 
	}
}

87 
ölöe
 
	$gíîic_hweight32
(
w
)

89 
ªs
 = (
w
 & 0x55555555) + ((w >> 1) & 0x55555555);

90 
ªs
 = (res & 0x33333333) + ((res >> 2) & 0x33333333);

91 
ªs
 = (res & 0x0F0F0F0F) + ((res >> 4) & 0x0F0F0F0F);

92 
ªs
 = (res & 0x00FF00FF) + ((res >> 8) & 0x00FF00FF);

93  (
ªs
 & 0x0000FFFF) + ((res >> 16) & 0x0000FFFF);

94 
	}
}

96 
ölöe
 
	$gíîic_hweight16
(
w
)

98 
ªs
 = (
w
 & 0x5555) + ((w >> 1) & 0x5555);

99 
ªs
 = (res & 0x3333) + ((res >> 2) & 0x3333);

100 
ªs
 = (res & 0x0F0F) + ((res >> 4) & 0x0F0F);

101  (
ªs
 & 0x00FF) + ((res >> 8) & 0x00FF);

102 
	}
}

104 
ölöe
 
	$gíîic_hweight8
(
w
)

106 
ªs
 = (
w
 & 0x55) + ((w >> 1) & 0x55);

107 
ªs
 = (res & 0x33) + ((res >> 2) & 0x33);

108  (
ªs
 & 0x0F) + ((res >> 4) & 0x0F);

109 
	}
}

111 
ölöe
 
	$gíîic_hweight64
(
__u64
 
w
)

113 #i‡
BITS_PER_LONG
 < 64

114  
	`gíîic_hweight32
(()(
w
 >> 32)) +

115 
	`gíîic_hweight32
(()
w
);

117 
u64
 
ªs
;

118 
ªs
 = (
w
 & 0x5555555555555555) + ((w >> 1) & 0x5555555555555555);

119 
ªs
 = (res & 0x3333333333333333) + ((res >> 2) & 0x3333333333333333);

120 
ªs
 = (res & 0x0F0F0F0F0F0F0F0F) + ((res >> 4) & 0x0F0F0F0F0F0F0F0F);

121 
ªs
 = (res & 0x00FF00FF00FF00FF) + ((res >> 8) & 0x00FF00FF00FF00FF);

122 
ªs
 = (res & 0x0000FFFF0000FFFF) + ((res >> 16) & 0x0000FFFF0000FFFF);

123  (
ªs
 & 0x00000000FFFFFFFF) + ((res >> 32) & 0x00000000FFFFFFFF);

125 
	}
}

127 
ölöe
 
	$hweight_l⁄g
(
w
)

129  (
w
Ë=4 ? 
	`gíîic_hweight32
(wË: 
	`gíîic_hweight64
(w);

130 
	}
}

	@/usr/include/linux/byteorder/little_endian.h

1 #i‚de‡
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #i‚de‡
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #i‚de‡
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<löux/byã‹dî/swab.h
>

13 
	#__c⁄°™t_ht⁄l
(
x
Ë
	`___c⁄°™t_swab32
((x))

	)

14 
	#__c⁄°™t_¡ohl
(
x
Ë
	`___c⁄°™t_swab32
((x))

	)

15 
	#__c⁄°™t_ht⁄s
(
x
Ë
	`___c⁄°™t_swab16
((x))

	)

16 
	#__c⁄°™t_¡ohs
(
x
Ë
	`___c⁄°™t_swab16
((x))

	)

17 
	#__c⁄°™t_˝u_to_À64
(
x
Ë((
__u64
)(x))

	)

18 
	#__c⁄°™t_À64_to_˝u
(
x
Ë((
__u64
)(x))

	)

19 
	#__c⁄°™t_˝u_to_À32
(
x
Ë((
__u32
)(x))

	)

20 
	#__c⁄°™t_À32_to_˝u
(
x
Ë((
__u32
)(x))

	)

21 
	#__c⁄°™t_˝u_to_À16
(
x
Ë((
__u16
)(x))

	)

22 
	#__c⁄°™t_À16_to_˝u
(
x
Ë((
__u16
)(x))

	)

23 
	#__c⁄°™t_˝u_to_be64
(
x
Ë
	`___c⁄°™t_swab64
((x))

	)

24 
	#__c⁄°™t_be64_to_˝u
(
x
Ë
	`___c⁄°™t_swab64
((x))

	)

25 
	#__c⁄°™t_˝u_to_be32
(
x
Ë
	`___c⁄°™t_swab32
((x))

	)

26 
	#__c⁄°™t_be32_to_˝u
(
x
Ë
	`___c⁄°™t_swab32
((x))

	)

27 
	#__c⁄°™t_˝u_to_be16
(
x
Ë
	`___c⁄°™t_swab16
((x))

	)

28 
	#__c⁄°™t_be16_to_˝u
(
x
Ë
	`___c⁄°™t_swab16
((x))

	)

29 
	#__˝u_to_À64
(
x
Ë((
__u64
)(x))

	)

30 
	#__À64_to_˝u
(
x
Ë((
__u64
)(x))

	)

31 
	#__˝u_to_À32
(
x
Ë((
__u32
)(x))

	)

32 
	#__À32_to_˝u
(
x
Ë((
__u32
)(x))

	)

33 
	#__˝u_to_À16
(
x
Ë((
__u16
)(x))

	)

34 
	#__À16_to_˝u
(
x
Ë((
__u16
)(x))

	)

35 
	#__˝u_to_be64
(
x
Ë
	`__swab64
((x))

	)

36 
	#__be64_to_˝u
(
x
Ë
	`__swab64
((x))

	)

37 
	#__˝u_to_be32
(
x
Ë
	`__swab32
((x))

	)

38 
	#__be32_to_˝u
(
x
Ë
	`__swab32
((x))

	)

39 
	#__˝u_to_be16
(
x
Ë
	`__swab16
((x))

	)

40 
	#__be16_to_˝u
(
x
Ë
	`__swab16
((x))

	)

41 
	#__˝u_to_À64p
(
x
Ë(*(
__u64
*)(x))

	)

42 
	#__À64_to_˝up
(
x
Ë(*(
__u64
*)(x))

	)

43 
	#__˝u_to_À32p
(
x
Ë(*(
__u32
*)(x))

	)

44 
	#__À32_to_˝up
(
x
Ë(*(
__u32
*)(x))

	)

45 
	#__˝u_to_À16p
(
x
Ë(*(
__u16
*)(x))

	)

46 
	#__À16_to_˝up
(
x
Ë(*(
__u16
*)(x))

	)

47 
	#__˝u_to_be64p
(
x
Ë
	`__swab64p
((x))

	)

48 
	#__be64_to_˝up
(
x
Ë
	`__swab64p
((x))

	)

49 
	#__˝u_to_be32p
(
x
Ë
	`__swab32p
((x))

	)

50 
	#__be32_to_˝up
(
x
Ë
	`__swab32p
((x))

	)

51 
	#__˝u_to_be16p
(
x
Ë
	`__swab16p
((x))

	)

52 
	#__be16_to_˝up
(
x
Ë
	`__swab16p
((x))

	)

53 
	#__˝u_to_À64s
(
x
Ëdÿ{} 0)

	)

54 
	#__À64_to_˝us
(
x
Ëdÿ{} 0)

	)

55 
	#__˝u_to_À32s
(
x
Ëdÿ{} 0)

	)

56 
	#__À32_to_˝us
(
x
Ëdÿ{} 0)

	)

57 
	#__˝u_to_À16s
(
x
Ëdÿ{} 0)

	)

58 
	#__À16_to_˝us
(
x
Ëdÿ{} 0)

	)

59 
	#__˝u_to_be64s
(
x
Ë
	`__swab64s
((x))

	)

60 
	#__be64_to_˝us
(
x
Ë
	`__swab64s
((x))

	)

61 
	#__˝u_to_be32s
(
x
Ë
	`__swab32s
((x))

	)

62 
	#__be32_to_˝us
(
x
Ë
	`__swab32s
((x))

	)

63 
	#__˝u_to_be16s
(
x
Ë
	`__swab16s
((x))

	)

64 
	#__be16_to_˝us
(
x
Ë
	`__swab16s
((x))

	)

66 
	~<löux/byã‹dî/gíîic.h
>

	@/usr/include/linux/cdev.h

1 #i‚de‡
_LINUX_CDEV_H


2 
	#_LINUX_CDEV_H


	)

3 #ifde‡
__KERNEL__


5 
	scdev
 {

6 
kobje˘
 
	mkobj
;

7 
moduÀ
 *
	mow√r
;

8 
fûe_›î©i⁄s
 *
	m›s
;

9 
li°_hód
 
	mli°
;

12 
cdev_öô
(
cdev
 *, 
fûe_›î©i⁄s
 *);

14 
cdev
 *
cdev_Æloc
();

16 
cdev_put
(
cdev
 *
p
);

18 
kobje˘
 *
cdev_gë
(
cdev
 *);

20 
cdev_add
(
cdev
 *, 
dev_t
, );

22 
cdev_dñ
(
cdev
 *);

24 
cdev_unm≠
(
dev_t
, );

26 
cd_f‹gë
(
öode
 *);

	@/usr/include/linux/compiler.h

1 #i‚de‡
__LINUX_COMPILER_H


2 
	#__LINUX_COMPILER_H


	)

4 #ifde‡
__CHECKER__


5 
	#__u£r
 
	`__©åibuã__
((
nodîef
, 
	`addªss_•a˚
(1)))

	)

6 
	#__kî√l


	)

8 
	#__u£r


	)

9 
	#__kî√l


	)

12 #i‡!
deföed
(
__KERNEL__
)

17 
	~<sys/cdefs.h
>

18 
	#__dïªˇãd


	)

21 #i‡
__GNUC__
 > 3

22 
	~<löux/compûî-gcc+.h
>

23 #ñi‡
__GNUC__
 == 3

24 
	~<löux/compûî-gcc3.h
>

25 #ñi‡
__GNUC__
 == 2

26 
	~<löux/compûî-gcc2.h
>

28 #îr‹ 
S‹ry
, 
your
 
compûî
 
is
 
too
 
ﬁd
/
nŸ
 
ªcognized
.

34 #ifde‡
__INTEL_COMPILER


35 
	~<löux/compûî-öãl.h
>

44 
	#likñy
(
x
Ë
	`__buûtö_ex≥˘
(!!(x), 1)

	)

45 
	#u∆ikñy
(
x
Ë
	`__buûtö_ex≥˘
(!!(x), 0)

	)

53 #i‚de‡
__dïªˇãd


54 
	#__dïªˇãd


	)

68 #i‚de‡
__©åibuã_u£d__


69 
	#__©åibuã_u£d__


	)

82 #i‚de‡
__©åibuã_puª__


83 
	#__©åibuã_puª__


	)

87 #i‚de‡
b¨rõr


88 
	#b¨rõr
(Ë
	`__mem‹y_b¨rõr
()

	)

91 #i‚de‡
RELOC_HIDE


92 
	#RELOC_HIDE
(
±r
, 
off
) \

93 ({ 
__±r
; \

94 
__±r
 = (Ë(
±r
); \

95 (
	`ty≥of
(
±r
)Ë(
__±r
 + (
off
)); })

	)

	@/usr/include/linux/dqblk_v1.h

5 #i‚de‡
_LINUX_DQBLK_V1_H


6 
	#_LINUX_DQBLK_V1_H


	)

9 
	#QFMT_VFS_OLD
 1

	)

12 
	#V1_DQF_RSQUASH
 1

	)

15 
	sv1_mem_dqöfo
 {

	@/usr/include/linux/dqblk_v2.h

5 #i‚de‡
_LINUX_DQBLK_V2_H


6 
	#_LINUX_DQBLK_V2_H


	)

8 
	~<löux/ty≥s.h
>

11 
	#QFMT_VFS_V0
 2

	)

14 
	sv2_mem_dqöfo
 {

15 
	mdqi_blocks
;

16 
	mdqi_‰ì_blk
;

17 
	mdqi_‰ì_íåy
;

	@/usr/include/linux/dqblk_xfs.h

33 #i‚de‡
_LINUX_DQBLK_XFS_H


34 
	#_LINUX_DQBLK_XFS_H


	)

36 
	~<löux/ty≥s.h
>

42 
	#XQM_CMD
(
x
Ë(('X'<<8)+(x)Ë

	)

43 
	#Q_XQUOTAON
 
	`XQM_CMD
(0x1Ë

	)

44 
	#Q_XQUOTAOFF
 
	`XQM_CMD
(0x2Ë

	)

45 
	#Q_XGETQUOTA
 
	`XQM_CMD
(0x3Ë

	)

46 
	#Q_XSETQLIM
 
	`XQM_CMD
(0x4Ë

	)

47 
	#Q_XGETQSTAT
 
	`XQM_CMD
(0x5Ë

	)

48 
	#Q_XQUOTARM
 
	`XQM_CMD
(0x6Ë

	)

57 
	#FS_DQUOT_VERSION
 1

	)

58 
	sfs_disk_quŸa
 {

59 
__s8
 
	md_vîsi⁄
;

60 
__s8
 
	md_Êags
;

61 
__u16
 
	md_fõldmask
;

62 
__u32
 
	md_id
;

63 
__u64
 
	md_blk_h¨dlimô
;

64 
__u64
 
	md_blk_so·limô
;

65 
__u64
 
	md_öo_h¨dlimô
;

66 
__u64
 
	md_öo_so·limô
;

67 
__u64
 
	md_bcou¡
;

68 
__u64
 
	md_icou¡
;

69 
__s32
 
	md_ôimî
;

71 
__s32
 
	md_btimî
;

72 
__u16
 
	md_iw¨ns
;

73 
__u16
 
	md_bw¨ns
;

74 
__s32
 
	md_∑ddög2
;

75 
__u64
 
	md_πb_h¨dlimô
;

76 
__u64
 
	md_πb_so·limô
;

77 
__u64
 
	md_πbcou¡
;

78 
__s32
 
	md_πbtimî
;

79 
__u16
 
	md_πbw¨ns
;

80 
__s16
 
	md_∑ddög3
;

81 
	md_∑ddög4
[8];

82 } 
	tfs_disk_quŸa_t
;

87 
	#FS_DQ_ISOFT
 (1<<0)

	)

88 
	#FS_DQ_IHARD
 (1<<1)

	)

89 
	#FS_DQ_BSOFT
 (1<<2)

	)

90 
	#FS_DQ_BHARD
 (1<<3)

	)

91 
	#FS_DQ_RTBSOFT
 (1<<4)

	)

92 
	#FS_DQ_RTBHARD
 (1<<5)

	)

93 
	#FS_DQ_LIMIT_MASK
 (
FS_DQ_ISOFT
 | 
FS_DQ_IHARD
 | 
FS_DQ_BSOFT
 | \

94 
FS_DQ_BHARD
 | 
FS_DQ_RTBSOFT
 | 
FS_DQ_RTBHARD
)

	)

102 
	#FS_DQ_BTIMER
 (1<<6)

	)

103 
	#FS_DQ_ITIMER
 (1<<7)

	)

104 
	#FS_DQ_RTBTIMER
 (1<<8)

	)

105 
	#FS_DQ_TIMER_MASK
 (
FS_DQ_BTIMER
 | 
FS_DQ_ITIMER
 | 
FS_DQ_RTBTIMER
)

	)

110 
	#XFS_QUOTA_UDQ_ACCT
 (1<<0Ë

	)

111 
	#XFS_QUOTA_UDQ_ENFD
 (1<<1Ë

	)

112 
	#XFS_QUOTA_GDQ_ACCT
 (1<<2Ë

	)

113 
	#XFS_QUOTA_GDQ_ENFD
 (1<<3Ë

	)

115 
	#XFS_USER_QUOTA
 (1<<0Ë

	)

116 
	#XFS_PROJ_QUOTA
 (1<<1Ë

	)

117 
	#XFS_GROUP_QUOTA
 (1<<2Ë

	)

125 
	#FS_QSTAT_VERSION
 1

	)

130 
	sfs_qfûe°©
 {

131 
__u64
 
	mqfs_öo
;

132 
__u64
 
	mqfs_nblks
;

133 
__u32
 
	mqfs_√xã¡s
;

134 } 
	tfs_qfûe°©_t
;

136 
	sfs_quŸa_°©
 {

137 
__s8
 
	mqs_vîsi⁄
;

138 
__u16
 
	mqs_Êags
;

139 
__s8
 
	mqs_∑d
;

140 
fs_qfûe°©_t
 
	mqs_uquŸa
;

141 
fs_qfûe°©_t
 
	mqs_gquŸa
;

142 
__u32
 
	mqs_öc‹edqs
;

143 
__s32
 
	mqs_btimñimô
;

144 
__s32
 
	mqs_ôimñimô
;

145 
__s32
 
	mqs_πbtimñimô
;

146 
__u16
 
	mqs_bw¨∆imô
;

147 
__u16
 
	mqs_iw¨∆imô
;

148 } 
	tfs_quŸa_°©_t
;

	@/usr/include/linux/kernel.h

1 #i‚de‡
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

8 #ifde‡
__KERNEL__


10 
	~<°d¨g.h
>

11 
	~<löux/lökage.h
>

12 
	~<löux/°ddef.h
>

13 
	~<löux/ty≥s.h
>

14 
	~<löux/compûî.h
>

15 
	~<asm/byã‹dî.h
>

16 
	~<asm/bug.h
>

18 
	#INT_MAX
 (()(~0U>>1))

	)

19 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

20 
	#UINT_MAX
 (~0U)

	)

21 
	#LONG_MAX
 (()(~0UL>>1))

	)

22 
	#LONG_MIN
 (-
LONG_MAX
 - 1)

	)

23 
	#ULONG_MAX
 (~0UL)

	)

25 
	#STACK_MAGIC
 0xdódbìf

	)

27 
	#ARRAY_SIZE
(
x
Ë((xË/ ((x)[0]))

	)

28 
	#ALIGN
(
x
,
a
Ë(((x)+◊)-1)&~(◊)-1))

	)

30 
	#KERN_EMERG
 "<0>"

	)

31 
	#KERN_ALERT
 "<1>"

	)

32 
	#KERN_CRIT
 "<2>"

	)

33 
	#KERN_ERR
 "<3>"

	)

34 
	#KERN_WARNING
 "<4>"

	)

35 
	#KERN_NOTICE
 "<5>"

	)

36 
	#KERN_INFO
 "<6>"

	)

37 
	#KERN_DEBUG
 "<7>"

	)

39 
c⁄sﬁe_¥ötk
[];

41 
	#c⁄sﬁe_logÀvñ
 (
c⁄sﬁe_¥ötk
[0])

	)

42 
	#deÁu…_mesßge_logÀvñ
 (
c⁄sﬁe_¥ötk
[1])

	)

43 
	#möimum_c⁄sﬁe_logÀvñ
 (
c⁄sﬁe_¥ötk
[2])

	)

44 
	#deÁu…_c⁄sﬁe_logÀvñ
 (
c⁄sﬁe_¥ötk
[3])

	)

46 
	gcom∂ëi⁄
;

48 #ifde‡
CONFIG_DEBUG_SPINLOCK_SLEEP


49 
__might_¶ìp
(*
fûe
, 
löe
);

50 
	#might_¶ìp
(Ë
	`__might_¶ìp
(
__FILE__
, 
__LINE__
)

	)

51 
	#might_¶ìp_if
(
c⁄d
Ëdÿ{ i‡(
	`u∆ikñy
(c⁄d)Ë
	`might_¶ìp
(); } 0)

	)

53 
	#might_¶ìp
(Ëdÿ{} 0)

	)

54 
	#might_¶ìp_if
(
c⁄d
Ëdÿ{} 0)

	)

57 
nŸifõr_block
 *
∑nic_nŸifõr_li°
;

58 
NORET_TYPE
 
	$∑nic
(c⁄° * 
fmt
, ...)

59 
	`__©åibuã__
 ((
NORET_AND
 
	`f‹m©
 (
¥ötf
, 1, 2)));

60 
asmlökage
 
NORET_TYPE
 
	$do_exô
(
îr‹_code
)

61 
ATTRIB_NORET
;

62 
NORET_TYPE
 
	$com∂ëe_™d_exô
(
com∂ëi⁄
 *, )

63 
ATTRIB_NORET
;

64 
	`abs
();

65 
	`sim∂e_°πoul
(const *,**,);

66 
	`sim∂e_°πﬁ
(const *,**,);

67 
	`sim∂e_°πouŒ
(const *,**,);

68 
	`sim∂e_°πﬁl
(const *,**,);

69 
	$•rötf
(* 
buf
, c⁄° * 
fmt
, ...)

70 
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 2, 3)));

71 
	`v•rötf
(*
buf
, c⁄° *, 
va_li°
);

72 
	$¢¥ötf
(* 
buf
, 
size_t
 
size
, c⁄° * 
fmt
, ...)

73 
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 3, 4)));

74 
	`v¢¥ötf
(*
buf
, 
size_t
 
size
, c⁄° *
fmt
, 
va_li°
 
¨gs
);

76 
	$ssˇnf
(const *, const *, ...)

77 
	`__©åibuã__
 ((
	`f‹m©
 (
sˇnf
,2,3)));

78 
	`vssˇnf
(c⁄° *, c⁄° *, 
va_li°
);

80 
	`gë_›ti⁄
(**
°r
, *
pöt
);

81 *
	`gë_›ti⁄s
(c⁄° *
°r
, 
nöts
, *
öts
);

82 
	`mem∑r£
(*
±r
, **
ªçå
);

84 
	`kî√l_ãxt_addªss
(
addr
);

85 
	`£ssi⁄_of_pgΩ
(
pgΩ
);

87 
asmlökage
 
	$¥ötk
(c⁄° * 
fmt
, ...)

88 
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 1, 2)));

90 
ölöe
 
	$c⁄sﬁe_sûít
()

92 
c⁄sﬁe_logÀvñ
 = 0;

93 
	}
}

95 
ölöe
 
	$c⁄sﬁe_vîbo£
()

97 i‡(
c⁄sﬁe_logÀvñ
)

98 
c⁄sﬁe_logÀvñ
 = 15;

99 
	}
}

101 
bu°_•ölocks
(
yes
);

102 
o›s_ö_¥ogªss
;

103 
∑nic_⁄_o›s
;

105 
èöãd
;

106 c⁄° *
¥öt_èöãd
();

107 
	#TAINT_PROPRIETARY_MODULE
 (1<<0)

	)

108 
	#TAINT_FORCED_MODULE
 (1<<1)

	)

109 
	#TAINT_UNSAFE_SMP
 (1<<2)

	)

110 
	#TAINT_FORCED_RMMOD
 (1<<3)

	)

112 
dump_°ack
();

114 #ifde‡
DEBUG


115 
	#¥_debug
(
fmt
,
¨g
...) \

116 
	`¥ötk
(
KERN_DEBUG
 
fmt
,##
¨g
)

	)

118 
	#¥_debug
(
fmt
,
¨g
...) \

119 dÿ{ } 0)

	)

122 
	#¥_öfo
(
fmt
,
¨g
...) \

123 
	`¥ötk
(
KERN_INFO
 
fmt
,##
¨g
)

	)

129 
	#NIPQUAD
(
addr
) \

130 ((*)&
addr
)[0], \

131 ((*)&
addr
)[1], \

132 ((*)&
addr
)[2], \

133 ((*)&
addr
)[3]

	)

135 
	#NIP6
(
addr
) \

136 
	`¡ohs
((
addr
).
s6_addr16
[0]), \

137 
	`¡ohs
((
addr
).
s6_addr16
[1]), \

138 
	`¡ohs
((
addr
).
s6_addr16
[2]), \

139 
	`¡ohs
((
addr
).
s6_addr16
[3]), \

140 
	`¡ohs
((
addr
).
s6_addr16
[4]), \

141 
	`¡ohs
((
addr
).
s6_addr16
[5]), \

142 
	`¡ohs
((
addr
).
s6_addr16
[6]), \

143 
	`¡ohs
((
addr
).
s6_addr16
[7])

	)

145 #i‡
deföed
(
__LITTLE_ENDIAN
)

146 
	#HIPQUAD
(
addr
) \

147 ((*)&
addr
)[3], \

148 ((*)&
addr
)[2], \

149 ((*)&
addr
)[1], \

150 ((*)&
addr
)[0]

	)

151 #ñi‡
deföed
(
__BIG_ENDIAN
)

152 
	#HIPQUAD
 
NIPQUAD


	)

162 
	#mö
(
x
,
y
) ({ \

163 c⁄° 
	`ty≥of
(
x
Ë
_x
 = (x); \

164 c⁄° 
	`ty≥of
(
y
Ë
_y
 = (y); \

165 (Ë(&
_x
 =&
_y
); \

166 
_x
 < 
_y
 ? _x : _y; })

	)

168 
	#max
(
x
,
y
) ({ \

169 c⁄° 
	`ty≥of
(
x
Ë
_x
 = (x); \

170 c⁄° 
	`ty≥of
(
y
Ë
_y
 = (y); \

171 (Ë(&
_x
 =&
_y
); \

172 
_x
 > 
_y
 ? _x : _y; })

	)

180 
	#mö_t
(
ty≥
,
x
,
y
) \

181 ({ 
ty≥
 
__x
 = (
x
);Åy≥ 
__y
 = (
y
); __x < __y ? __x: __y; })

	)

182 
	#max_t
(
ty≥
,
x
,
y
) \

183 ({ 
ty≥
 
__x
 = (
x
);Åy≥ 
__y
 = (
y
); __x > __y ? __x: __y; })

	)

194 
	#c⁄èöî_of
(
±r
, 
ty≥
, 
membî
) ({ \

195 c⁄° 
	`ty≥of
–((
ty≥
 *)0)->
membî
 ) *
__m±r
 = (
±r
); \

196 (
ty≥
 *)–(*)
__m±r
 - 
	`off£tof
—y≥,
membî
Ë);})

	)

202 
	#ty≥check
(
ty≥
,
x
) \

203 ({ 
ty≥
 
__dummy
; \

204 
	`ty≥of
(
x
Ë
__dummy2
; \

205 ()(&
__dummy
 =&
__dummy2
); \

207 })

	)

211 
	#SI_LOAD_SHIFT
 16

	)

212 
	ssysöfo
 {

213 
	mu±ime
;

214 
	mlﬂds
[3];

215 
	mtŸÆøm
;

216 
	m‰ìøm
;

217 
	msh¨edøm
;

218 
	mbuf„ºam
;

219 
	mtŸÆsw≠
;

220 
	m‰ìsw≠
;

221 
	m¥ocs
;

222 
	m∑d
;

223 
	mtŸÆhigh
;

224 
	m‰ìhigh
;

225 
	mmem_unô
;

226 #i‡!
deföed
(
_LP64
Ë&& !deföed(
__ü64__
Ë&& !deföed(
__s390x__
Ë&& !deföed(
__Æpha__
)

227 
	m_f
[20-2*()-()];

231 
BUILD_BUG
();

232 
	#BUILD_BUG_ON
(
c⁄dôi⁄
Ëdÿ{ i‡(c⁄dôi⁄Ë
	`BUILD_BUG
(); } 0)

	)

235 #i‡
__GNUC__
 > 2 || 
__GNUC_MINOR__
 >= 95

236 
	#__FUNCTION__
 (
__func__
)

	)

	@/usr/include/linux/nfs.h

7 #i‚de‡
_LINUX_NFS_H


8 
	#_LINUX_NFS_H


	)

10 
	~<löux/suƒpc/msg_¥Ÿ.h
>

12 
	#NFS_PROGRAM
 100003

	)

13 
	#NFS_PORT
 2049

	)

14 
	#NFS_MAXDATA
 8192

	)

15 
	#NFS_MAXPATHLEN
 1024

	)

16 
	#NFS_MAXNAMLEN
 255

	)

17 
	#NFS_MAXGROUPS
 16

	)

18 
	#NFS_FHSIZE
 32

	)

19 
	#NFS_COOKIESIZE
 4

	)

20 
	#NFS_FIFO_DEV
 (-1)

	)

21 
	#NFSMODE_FMT
 0170000

	)

22 
	#NFSMODE_DIR
 0040000

	)

23 
	#NFSMODE_CHR
 0020000

	)

24 
	#NFSMODE_BLK
 0060000

	)

25 
	#NFSMODE_REG
 0100000

	)

26 
	#NFSMODE_LNK
 0120000

	)

27 
	#NFSMODE_SOCK
 0140000

	)

28 
	#NFSMODE_FIFO
 0010000

	)

30 
	#NFS_MNT_PROGRAM
 100005

	)

31 
	#NFS_MNT_PORT
 627

	)

41 
	enfs_°©
 {

42 
	mNFS_OK
 = 0,

43 
	mNFSERR_PERM
 = 1,

44 
	mNFSERR_NOENT
 = 2,

45 
	mNFSERR_IO
 = 5,

46 
	mNFSERR_NXIO
 = 6,

47 
	mNFSERR_EAGAIN
 = 11,

48 
	mNFSERR_ACCES
 = 13,

49 
	mNFSERR_EXIST
 = 17,

50 
	mNFSERR_XDEV
 = 18,

51 
	mNFSERR_NODEV
 = 19,

52 
	mNFSERR_NOTDIR
 = 20,

53 
	mNFSERR_ISDIR
 = 21,

54 
	mNFSERR_INVAL
 = 22,

55 
	mNFSERR_FBIG
 = 27,

56 
	mNFSERR_NOSPC
 = 28,

57 
	mNFSERR_ROFS
 = 30,

58 
	mNFSERR_MLINK
 = 31,

59 
	mNFSERR_OPNOTSUPP
 = 45,

60 
	mNFSERR_NAMETOOLONG
 = 63,

61 
	mNFSERR_NOTEMPTY
 = 66,

62 
	mNFSERR_DQUOT
 = 69,

63 
	mNFSERR_STALE
 = 70,

64 
	mNFSERR_REMOTE
 = 71,

65 
	mNFSERR_WFLUSH
 = 99,

66 
	mNFSERR_BADHANDLE
 = 10001,

67 
	mNFSERR_NOT_SYNC
 = 10002,

68 
	mNFSERR_BAD_COOKIE
 = 10003,

69 
	mNFSERR_NOTSUPP
 = 10004,

70 
	mNFSERR_TOOSMALL
 = 10005,

71 
	mNFSERR_SERVERFAULT
 = 10006,

72 
	mNFSERR_BADTYPE
 = 10007,

73 
	mNFSERR_JUKEBOX
 = 10008,

74 
	mNFSERR_SAME
 = 10009,

75 
	mNFSERR_DENIED
 = 10010,

76 
	mNFSERR_EXPIRED
 = 10011,

77 
	mNFSERR_LOCKED
 = 10012,

78 
	mNFSERR_GRACE
 = 10013,

79 
	mNFSERR_FHEXPIRED
 = 10014,

80 
	mNFSERR_SHARE_DENIED
 = 10015,

81 
	mNFSERR_WRONGSEC
 = 10016,

82 
	mNFSERR_CLID_INUSE
 = 10017,

83 
	mNFSERR_RESOURCE
 = 10018,

84 
	mNFSERR_MOVED
 = 10019,

85 
	mNFSERR_NOFILEHANDLE
 = 10020,

86 
	mNFSERR_MINOR_VERS_MISMATCH
 = 10021,

87 
	mNFSERR_STALE_CLIENTID
 = 10022,

88 
	mNFSERR_STALE_STATEID
 = 10023,

89 
	mNFSERR_OLD_STATEID
 = 10024,

90 
	mNFSERR_BAD_STATEID
 = 10025,

91 
	mNFSERR_BAD_SEQID
 = 10026,

92 
	mNFSERR_NOT_SAME
 = 10027,

93 
	mNFSERR_LOCK_RANGE
 = 10028,

94 
	mNFSERR_SYMLINK
 = 10029,

95 
	mNFSERR_READDIR_NOSPC
 = 10030,

96 
	mNFSERR_LEASE_MOVED
 = 10031,

97 
	mNFSERR_ATTRNOTSUPP
 = 10032,

98 
	mNFSERR_NO_GRACE
 = 10033,

99 
	mNFSERR_RECLAIM_BAD
 = 10034,

100 
	mNFSERR_RECLAIM_CONFLICT
 = 10035,

101 
	mNFSERR_BAD_XDR
 = 10036,

102 
	mNFSERR_LOCKS_HELD
 = 10037,

103 
	mNFSERR_OPENMODE
 = 10038,

104 
	mNFSERR_BADOWNER
 = 10039,

105 
	mNFSERR_BADCHAR
 = 10040,

106 
	mNFSERR_BADNAME
 = 10041,

107 
	mNFSERR_BAD_RANGE
 = 10042,

108 
	mNFSERR_LOCK_NOTSUPP
 = 10043,

109 
	mNFSERR_OP_ILLEGAL
 = 10044,

110 
	mNFSERR_DEADLOCK
 = 10045,

111 
	mNFSERR_FILE_OPEN
 = 10046,

112 
	mNFSERR_ADMIN_REVOKED
 = 10047,

113 
	mNFSERR_CB_PATH_DOWN
 = 10048,

114 
	mNFSERR_REPLAY_ME
 = 10049

119 
	enfs_·y≥
 {

120 
	mNFNON
 = 0,

121 
	mNFREG
 = 1,

122 
	mNFDIR
 = 2,

123 
	mNFBLK
 = 3,

124 
	mNFCHR
 = 4,

125 
	mNFLNK
 = 5,

126 
	mNFSOCK
 = 6,

127 
	mNFBAD
 = 7,

128 
	mNFFIFO
 = 8

131 #i‡
deföed
(
__KERNEL__
)

135 
	#NFS_MAXFHSIZE
 128

	)

136 
	snfs_fh
 {

137 
	msize
;

138 
	md©a
[
NFS_MAXFHSIZE
];

145 
	#NFS_OFFSET_MAX
 ((
__s64
)((~(
__u64
)0Ë>> 1))

	)

148 
	enfs3_°abÀ_how
 {

149 
	mNFS_UNSTABLE
 = 0,

150 
	mNFS_DATA_SYNC
 = 1,

151 
	mNFS_FILE_SYNC
 = 2

	@/usr/include/linux/preempt.h

1 #i‚de‡
__LINUX_PREEMPT_H


2 
	#__LINUX_PREEMPT_H


	)

9 
	~<löux/c⁄fig.h
>

11 
	#¥ìm±_cou¡
(Ë(
	`cuºít_thªad_öfo
()->
¥ìm±_cou¡
)

	)

13 
	#öc_¥ìm±_cou¡
() \

15 
	`¥ìm±_cou¡
()++; \

16 } 0)

	)

18 
	#dec_¥ìm±_cou¡
() \

20 
	`¥ìm±_cou¡
()--; \

21 } 0)

	)

23 #ifde‡
CONFIG_PREEMPT


25 
¥ìm±_scheduÀ
();

27 
	#¥ìm±_dißbÀ
() \

29 
	`öc_¥ìm±_cou¡
(); \

30 
	`b¨rõr
(); \

31 } 0)

	)

33 
	#¥ìm±_íabÀ_no_ªsched
() \

35 
	`dec_¥ìm±_cou¡
(); \

36 
	`b¨rõr
(); \

37 } 0)

	)

39 
	#¥ìm±_check_ªsched
() \

41 i‡(
	`u∆ikñy
(
	`ã°_thªad_Êag
(
TIF_NEED_RESCHED
))) \

42 
	`¥ìm±_scheduÀ
(); \

43 } 0)

	)

45 
	#¥ìm±_íabÀ
() \

47 
	`¥ìm±_íabÀ_no_ªsched
(); \

48 
	`¥ìm±_check_ªsched
(); \

49 } 0)

	)

53 
	#¥ìm±_dißbÀ
(Ëdÿ{ } 0)

	)

54 
	#¥ìm±_íabÀ_no_ªsched
(Ëdÿ{ } 0)

	)

55 
	#¥ìm±_íabÀ
(Ëdÿ{ } 0)

	)

56 
	#¥ìm±_check_ªsched
(Ëdÿ{ } 0)

	)

	@/usr/include/linux/prefetch.h

10 #i‚de‡
_LINUX_PREFETCH_H


11 
	#_LINUX_PREFETCH_H


	)

13 
	~<asm/¥o˚ss‹.h
>

14 
	~<asm/ˇche.h
>

41 #i‚de‡
ARCH_HAS_PREFETCH


42 
ölöe
 
	$¥e„tch
(c⁄° *
x
Ë{;
	}
}

45 #i‚de‡
ARCH_HAS_PREFETCHW


46 
ölöe
 
	$¥e„tchw
(c⁄° *
x
Ë{;
	}
}

49 #i‚de‡
ARCH_HAS_SPINLOCK_PREFETCH


50 
	#•ö_lock_¥e„tch
(
x
Ë
	`¥e„tchw
(x)

	)

53 #i‚de‡
PREFETCH_STRIDE


54 
	#PREFETCH_STRIDE
 (4*
L1_CACHE_BYTES
)

	)

	@/usr/include/linux/rcupdate.h

33 #i‚de‡
__LINUX_RCUPDATE_H


34 
	#__LINUX_RCUPDATE_H


	)

36 #ifde‡
__KERNEL__


38 
	~<löux/ˇche.h
>

39 
	~<löux/li°.h
>

40 
	~<löux/•ölock.h
>

41 
	~<löux/thªads.h
>

42 
	~<löux/≥r˝u.h
>

43 
	~<löux/˝umask.h
>

51 
	srcu_hód
 {

52 
li°_hód
 
	mli°
;

53 (*
	mfunc
)(*
	mobj
);

54 *
	m¨g
;

57 
	#RCU_HEAD_INIT
(
hód
) \

58 { 
li°
: 
	`LIST_HEAD_INIT
(
hód
.li°), 
func
: 
NULL
, 
¨g
: NULL }

	)

59 
	#RCU_HEAD
(
hód
Ë
rcu_hód
 hód = 
	`RCU_HEAD_INIT
(hód)

	)

60 
	#INIT_RCU_HEAD
(
±r
) do { \

61 
	`INIT_LIST_HEAD
(&(
±r
)->
li°
); (±r)->
func
 = 
NULL
; (±r)->
¨g
 = NULL; \

62 } 0)

	)

67 
	srcu_˘æblk
 {

68 
•ölock_t
 
	mmuãx
;

69 
	mcurb©ch
;

70 
	mmaxb©ch
;

71 
˝umask_t
 
	mrcu_˝u_mask
;

76 
ölöe
 
	$rcu_b©ch_bef‹e
(
a
, 
b
)

78  (
a
 - 
b
) < 0;

79 
	}
}

82 
ölöe
 
	$rcu_b©ch_a·î
(
a
, 
b
)

84  (
a
 - 
b
) > 0;

85 
	}
}

92 
	srcu_d©a
 {

93 
	mqs˘r
;

94 
	mœ°_qs˘r
;

96 
	mb©ch
;

97 
li°_hód
 
	mnxéi°
;

98 
li°_hód
 
	mcuæi°
;

101 
DECLARE_PER_CPU
(
rcu_d©a
,Ñcu_data);

102 
rcu_˘æblk
Ñcu_ctrlblk;

104 
	#RCU_qs˘r
(
˝u
Ë(
	`≥r_˝u
(
rcu_d©a
, (˝u)).
qs˘r
)

	)

105 
	#RCU_œ°_qs˘r
(
˝u
Ë(
	`≥r_˝u
(
rcu_d©a
, (˝u)).
œ°_qs˘r
)

	)

106 
	#RCU_b©ch
(
˝u
Ë(
	`≥r_˝u
(
rcu_d©a
, (˝u)).
b©ch
)

	)

107 
	#RCU_nxéi°
(
˝u
Ë(
	`≥r_˝u
(
rcu_d©a
, (˝u)).
nxéi°
)

	)

108 
	#RCU_cuæi°
(
˝u
Ë(
	`≥r_˝u
(
rcu_d©a
, (˝u)).
cuæi°
)

	)

110 
	#RCU_QSCTR_INVALID
 0

	)

112 
ölöe
 
	$rcu_≥ndög
(
˝u
)

114 i‡((!
	`li°_em±y
(&
	`RCU_cuæi°
(
˝u
)) &&

115 
	`rcu_b©ch_bef‹e
(
	`RCU_b©ch
(
˝u
), 
rcu_˘æblk
.
curb©ch
)) ||

116 (
	`li°_em±y
(&
	`RCU_cuæi°
(
˝u
)) &&

117 !
	`li°_em±y
(&
	`RCU_nxéi°
(
˝u
))) ||

118 
	`˝u_is£t
(
˝u
, 
rcu_˘æblk
.
rcu_˝u_mask
))

122 
	}
}

124 
	#rcu_ªad_lock
(Ë
	`¥ìm±_dißbÀ
()

	)

125 
	#rcu_ªad_u∆ock
(Ë
	`¥ìm±_íabÀ
()

	)

127 
rcu_öô
();

128 
rcu_check_ˇŒbacks
(
˝u
, 
u£r
);

131 
FASTCALL
(
ˇŒ_rcu
(
rcu_hód
 *
hód
,

132 (*
func
)(*
¨g
), *arg));

133 
	`synchr⁄ize_kî√l
();

	@/usr/include/linux/rwsem.h

7 #i‚de‡
_LINUX_RWSEM_H


8 
	#_LINUX_RWSEM_H


	)

10 
	~<löux/lökage.h
>

12 
	#RWSEM_DEBUG
 0

	)

14 #ifde‡
__KERNEL__


16 
	~<löux/c⁄fig.h
>

17 
	~<löux/ty≥s.h
>

18 
	~<löux/kî√l.h
>

19 
	~<asm/sy°em.h
>

20 
	~<asm/©omic.h
>

22 
	grw_£m≠h‹e
;

24 #ifde‡
CONFIG_RWSEM_GENERIC_SPINLOCK


25 
	~<löux/rw£m-•ölock.h
>

27 
	~<asm/rw£m.h
>

30 #i‚de‡
rw£måa˚


31 #i‡
RWSEM_DEBUG


32 
FASTCALL
(
rw£måa˚
(
rw_£m≠h‹e
 *
£m
, c⁄° *
°r
));

34 
	#rw£måa˚
(
SEM
,
FMT
)

	)

41 
ölöe
 
	$down_ªad
(
rw_£m≠h‹e
 *
£m
)

43 
	`might_¶ìp
();

44 
	`rw£måa˚
(
£m
,"Entering down_read");

45 
	`__down_ªad
(
£m
);

46 
	`rw£måa˚
(
£m
,"Leaving down_read");

47 
	}
}

52 
ölöe
 
	$down_ªad_åylock
(
rw_£m≠h‹e
 *
£m
)

54 
ªt
;

55 
	`rw£måa˚
(
£m
,"Entering down_read_trylock");

56 
ªt
 = 
	`__down_ªad_åylock
(
£m
);

57 
	`rw£måa˚
(
£m
,"Leaving down_read_trylock");

58  
ªt
;

59 
	}
}

64 
ölöe
 
	$down_wrôe
(
rw_£m≠h‹e
 *
£m
)

66 
	`might_¶ìp
();

67 
	`rw£måa˚
(
£m
,"Entering down_write");

68 
	`__down_wrôe
(
£m
);

69 
	`rw£måa˚
(
£m
,"Leaving down_write");

70 
	}
}

75 
ölöe
 
	$down_wrôe_åylock
(
rw_£m≠h‹e
 *
£m
)

77 
ªt
;

78 
	`rw£måa˚
(
£m
,"Entering down_write_trylock");

79 
ªt
 = 
	`__down_wrôe_åylock
(
£m
);

80 
	`rw£måa˚
(
£m
,"Leaving down_write_trylock");

81  
ªt
;

82 
	}
}

87 
ölöe
 
	$up_ªad
(
rw_£m≠h‹e
 *
£m
)

89 
	`rw£måa˚
(
£m
,"Entering up_read");

90 
	`__up_ªad
(
£m
);

91 
	`rw£måa˚
(
£m
,"Leaving up_read");

92 
	}
}

97 
ölöe
 
	$up_wrôe
(
rw_£m≠h‹e
 *
£m
)

99 
	`rw£måa˚
(
£m
,"Entering up_write");

100 
	`__up_wrôe
(
£m
);

101 
	`rw£måa˚
(
£m
,"Leaving up_write");

102 
	}
}

107 
ölöe
 
	$downgøde_wrôe
(
rw_£m≠h‹e
 *
£m
)

109 
	`rw£måa˚
(
£m
,"Entering downgrade_write");

110 
	`__downgøde_wrôe
(
£m
);

111 
	`rw£måa˚
(
£m
,"Leaving downgrade_write");

112 
	}
}

	@/usr/include/linux/stringify.h

1 #i‚de‡
__LINUX_STRINGIFY_H


2 
	#__LINUX_STRINGIFY_H


	)

9 
	#__°rögify_1
(
x
Ë#x

	)

10 
	#__°rögify
(
x
Ë
	`__°rögify_1
(x)

	)

	@/usr/include/linux/sysfs.h

9 #i‚de‡
_SYSFS_H_


10 
	#_SYSFS_H_


	)

12 
	gkobje˘
;

13 
	gmoduÀ
;

15 
	s©åibuã
 {

16 * 
	m«me
;

17 
moduÀ
 * 
	mow√r
;

18 
mode_t
 
	mmode
;

21 
	sbö_©åibuã
 {

22 
©åibuã
 
	m©å
;

23 
size_t
 
	msize
;

24 
ssize_t
 (*
ªad
)(
	mkobje˘
 *, *, 
	mloff_t
, 
	msize_t
);

25 
ssize_t
 (*
wrôe
)(
	mkobje˘
 *, *, 
	mloff_t
, 
	msize_t
);

28 
sysfs_¸óã_bö_fûe
(
kobje˘
 * 
kobj
, 
bö_©åibuã
 * 
©å
);

29 
sysfs_ªmove_bö_fûe
(
kobje˘
 * 
kobj
, 
bö_©åibuã
 * 
©å
);

31 
	ssysfs_›s
 {

32 
ssize_t
 (*
show
)(
	mkobje˘
 *, 
	m©åibuã
 *,*);

33 
ssize_t
 (*
°‹e
)(
	mkobje˘
 *,
	m©åibuã
 *,c⁄° *, 
	msize_t
);

37 
sysfs_¸óã_dú
(
kobje˘
 *);

40 
sysfs_ªmove_dú
(
kobje˘
 *);

43 
sysfs_ª«me_dú
(
kobje˘
 *, c⁄° *
√w_«me
);

46 
sysfs_¸óã_fûe
(
kobje˘
 *, c⁄° 
©åibuã
 *);

49 
sysfs_upd©e_fûe
(
kobje˘
 *, c⁄° 
©åibuã
 *);

52 
sysfs_ªmove_fûe
(
kobje˘
 *, c⁄° 
©åibuã
 *);

55 
sysfs_¸óã_lök
(
kobje˘
 * 
kobj
, kobje˘ * 
èrgë
, * 
«me
);

58 
sysfs_ªmove_lök
(
kobje˘
 *, * 
«me
);

61 
	s©åibuã_group
 {

62 * 
	m«me
;

63 
©åibuã
 ** 
	m©ås
;

66 
sysfs_¸óã_group
(
kobje˘
 *, c⁄° 
©åibuã_group
 *);

67 
sysfs_ªmove_group
(
kobje˘
 *, c⁄° 
©åibuã_group
 *);

	@/usr/include/linux/thread_info.h

7 #i‚de‡
_LINUX_THREAD_INFO_H


8 
	#_LINUX_THREAD_INFO_H


	)

13 
	sª°¨t_block
 {

14 (*
	m‚
)(
	mª°¨t_block
 *);

15 
	m¨g0
, 
	m¨g1
, 
	m¨g2
, 
	m¨g3
;

18 
do_no_ª°¨t_sysˇŒ
(
ª°¨t_block
 *
∑rm
);

20 
	~<löux/bô›s.h
>

21 
	~<asm/thªad_öfo.h
>

23 #ifde‡
__KERNEL__


30 
ölöe
 
	$£t_thªad_Êag
(
Êag
)

32 
	`£t_bô
(
Êag
,&
	`cuºít_thªad_öfo
()->
Êags
);

33 
	}
}

35 
ölöe
 
	$˛ór_thªad_Êag
(
Êag
)

37 
	`˛ór_bô
(
Êag
,&
	`cuºít_thªad_öfo
()->
Êags
);

38 
	}
}

40 
ölöe
 
	$ã°_™d_£t_thªad_Êag
(
Êag
)

42  
	`ã°_™d_£t_bô
(
Êag
,&
	`cuºít_thªad_öfo
()->
Êags
);

43 
	}
}

45 
ölöe
 
	$ã°_™d_˛ór_thªad_Êag
(
Êag
)

47  
	`ã°_™d_˛ór_bô
(
Êag
,&
	`cuºít_thªad_öfo
()->
Êags
);

48 
	}
}

50 
ölöe
 
	$ã°_thªad_Êag
(
Êag
)

52  
	`ã°_bô
(
Êag
,&
	`cuºít_thªad_öfo
()->
Êags
);

53 
	}
}

55 
ölöe
 
	$£t_ti_thªad_Êag
(
thªad_öfo
 *
ti
, 
Êag
)

57 
	`£t_bô
(
Êag
,&
ti
->
Êags
);

58 
	}
}

60 
ölöe
 
	$˛ór_ti_thªad_Êag
(
thªad_öfo
 *
ti
, 
Êag
)

62 
	`˛ór_bô
(
Êag
,&
ti
->
Êags
);

63 
	}
}

65 
ölöe
 
	$ã°_™d_£t_ti_thªad_Êag
(
thªad_öfo
 *
ti
, 
Êag
)

67  
	`ã°_™d_£t_bô
(
Êag
,&
ti
->
Êags
);

68 
	}
}

70 
ölöe
 
	$ã°_™d_˛ór_ti_thªad_Êag
(
thªad_öfo
 *
ti
, 
Êag
)

72  
	`ã°_™d_˛ór_bô
(
Êag
,&
ti
->
Êags
);

73 
	}
}

75 
ölöe
 
	$ã°_ti_thªad_Êag
(
thªad_öfo
 *
ti
, 
Êag
)

77  
	`ã°_bô
(
Êag
,&
ti
->
Êags
);

78 
	}
}

80 
ölöe
 
	$£t_√ed_ªsched
()

82 
	`£t_thªad_Êag
(
TIF_NEED_RESCHED
);

83 
	}
}

85 
ölöe
 
	$˛ór_√ed_ªsched
()

87 
	`˛ór_thªad_Êag
(
TIF_NEED_RESCHED
);

88 
	}
}

	@/usr/include/linux/timex.h

51 #i‚de‡
_LINUX_TIMEX_H


52 
	#_LINUX_TIMEX_H


	)

54 
	~<löux/c⁄fig.h
>

55 
	~<löux/compûî.h
>

57 
	~<asm/∑øm.h
>

66 #i‡
HZ
 >= 12 && HZ < 24

67 
	#SHIFT_HZ
 4

	)

68 #ñi‡
HZ
 >= 24 && HZ < 48

69 
	#SHIFT_HZ
 5

	)

70 #ñi‡
HZ
 >= 48 && HZ < 96

71 
	#SHIFT_HZ
 6

	)

72 #ñi‡
HZ
 >= 96 && HZ < 192

73 
	#SHIFT_HZ
 7

	)

74 #ñi‡
HZ
 >= 192 && HZ < 384

75 
	#SHIFT_HZ
 8

	)

76 #ñi‡
HZ
 >= 384 && HZ < 768

77 
	#SHIFT_HZ
 9

	)

78 #ñi‡
HZ
 >= 768 && HZ < 1536

79 
	#SHIFT_HZ
 10

	)

81 #îr‹ 
You
 
lo£
.

95 
	#SHIFT_KG
 6

	)

96 
	#SHIFT_KF
 16

	)

97 
	#SHIFT_KH
 2

	)

98 
	#MAXTC
 6

	)

114 
	#SHIFT_SCALE
 22

	)

115 
	#SHIFT_UPDATE
 (
SHIFT_KG
 + 
MAXTC
Ë

	)

116 
	#SHIFT_USEC
 16

	)

117 
	#FINENSEC
 (1L << (
SHIFT_SCALE
 - 10)Ë

	)

119 
	#MAXPHASE
 512000L

	)

120 
	#MAXFREQ
 (512L << 
SHIFT_USEC
Ë

	)

121 
	#MAXTIME
 (200L << 
PPS_AVG
Ë

	)

122 
	#MINSEC
 16L

	)

123 
	#MAXSEC
 1200L

	)

124 
	#NTP_PHASE_LIMIT
 (
MAXPHASE
 << 5Ë

	)

146 
	#PPS_AVG
 2

	)

147 
	#PPS_SHIFT
 2

	)

148 
	#PPS_SHIFTMAX
 8

	)

149 
	#PPS_VALID
 120

	)

150 
	#MAXGLITCH
 30

	)

155 
	~<asm/timex.h
>

158 
	#LATCH
 ((
CLOCK_TICK_RATE
 + 
HZ
/2Ë/ HZË

	)

169 
	#SH_DIV
(
NOM
,
DEN
,
LSH
) ( ((NOM / DEN) << LSH) \

170 + (((
NOM
 % 
DEN
Ë<< 
LSH
Ë+ DEN / 2Ë/ DEN)

	)

173 
	#ACTHZ
 (
	`SH_DIV
 (
CLOCK_TICK_RATE
, 
LATCH
, 8))

	)

176 
	#TICK_NSEC
 (
	`SH_DIV
 (1000000UL * 1000, 
ACTHZ
, 8))

	)

179 
	#TICK_USEC
 ((1000000UL + 
USER_HZ
/2Ë/ USER_HZ)

	)

183 
	#TICK_USEC_TO_NSEC
(
TUSEC
Ë(
	`SH_DIV
 (TUSEC * 
USER_HZ
 * 1000, 
ACTHZ
, 8))

	)

186 
	~<löux/time.h
>

191 
	stimex
 {

192 
	mmodes
;

193 
	moff£t
;

194 
	m‰eq
;

195 
	mmaxîr‹
;

196 
	me°îr‹
;

197 
	m°©us
;

198 
	mc⁄°™t
;

199 
	m¥ecisi⁄
;

200 
	mtﬁî™˚
;

203 
timevÆ
 
	mtime
;

204 
	mtick
;

206 
	mµs‰eq
;

207 
	mjôãr
;

208 
	mshi·
;

209 
	m°abû
;

210 
	mjô˙t
;

211 
	mˇl˙t
;

212 
	mîr˙t
;

213 
	m°b˙t
;

223 
	#ADJ_OFFSET
 0x0001

	)

224 
	#ADJ_FREQUENCY
 0x0002

	)

225 
	#ADJ_MAXERROR
 0x0004

	)

226 
	#ADJ_ESTERROR
 0x0008

	)

227 
	#ADJ_STATUS
 0x0010

	)

228 
	#ADJ_TIMECONST
 0x0020

	)

229 
	#ADJ_TICK
 0x4000

	)

230 
	#ADJ_OFFSET_SINGLESHOT
 0x8001

	)

233 
	#MOD_OFFSET
 
ADJ_OFFSET


	)

234 
	#MOD_FREQUENCY
 
ADJ_FREQUENCY


	)

235 
	#MOD_MAXERROR
 
ADJ_MAXERROR


	)

236 
	#MOD_ESTERROR
 
ADJ_ESTERROR


	)

237 
	#MOD_STATUS
 
ADJ_STATUS


	)

238 
	#MOD_TIMECONST
 
ADJ_TIMECONST


	)

239 
	#MOD_CLKB
 
ADJ_TICK


	)

240 
	#MOD_CLKA
 
ADJ_OFFSET_SINGLESHOT


	)

246 
	#STA_PLL
 0x0001

	)

247 
	#STA_PPSFREQ
 0x0002

	)

248 
	#STA_PPSTIME
 0x0004

	)

249 
	#STA_FLL
 0x0008

	)

251 
	#STA_INS
 0x0010

	)

252 
	#STA_DEL
 0x0020

	)

253 
	#STA_UNSYNC
 0x0040

	)

254 
	#STA_FREQHOLD
 0x0080

	)

256 
	#STA_PPSSIGNAL
 0x0100

	)

257 
	#STA_PPSJITTER
 0x0200

	)

258 
	#STA_PPSWANDER
 0x0400

	)

259 
	#STA_PPSERROR
 0x0800

	)

261 
	#STA_CLOCKERR
 0x1000

	)

263 
	#STA_RONLY
 (
STA_PPSSIGNAL
 | 
STA_PPSJITTER
 | 
STA_PPSWANDER
 | \

264 
STA_PPSERROR
 | 
STA_CLOCKERR
Ë

	)

269 
	#TIME_OK
 0

	)

270 
	#TIME_INS
 1

	)

271 
	#TIME_DEL
 2

	)

272 
	#TIME_OOP
 3

	)

273 
	#TIME_WAIT
 4

	)

274 
	#TIME_ERROR
 5

	)

275 
	#TIME_BAD
 
TIME_ERROR


	)

277 #ifde‡
__KERNEL__


283 
tick_u£c
;

284 
tick_n£c
;

285 
tickadj
;

290 
time_°©e
;

291 
time_°©us
;

292 
time_off£t
;

293 
time_c⁄°™t
;

294 
time_tﬁî™˚
;

295 
time_¥ecisi⁄
;

296 
time_maxîr‹
;

297 
time_e°îr‹
;

299 
time_pha£
;

300 
time_‰eq
;

301 
time_adj
;

302 
time_ª·ime
;

304 
time_adju°
;

307 
µs_off£t
;

308 
µs_jôãr
;

309 
µs_‰eq
;

310 
µs_°abû
;

311 
µs_vÆid
;

314 
µs_shi·
;

315 
µs_jô˙t
;

316 
µs_ˇl˙t
;

317 
µs_îr˙t
;

318 
µs_°b˙t
;

320 #ifde‡
CONFIG_TIME_INTERPOLATION


322 
	stime_öãΩﬁ©‹
 {

324 (*
	mgë_off£t
) ();

325 (*
	mupd©e
) ();

326 (*
	mª£t
) ();

329 
time_öãΩﬁ©‹
 *
	m√xt
;

330 
	m‰equícy
;

331 
	mdri·
;

334 vﬁ©ûê
œ°_n£c_off£t
;

335 #i‚de‡
__HAVE_ARCH_CMPXCHG


336 
•ö_lock_t
 
œ°_n£c_off£t_lock
;

338 
time_öãΩﬁ©‹
 *time_interpolator;

340 
ªgi°î_time_öãΩﬁ©‹
(
time_öãΩﬁ©‹
 *);

341 
uƒegi°î_time_öãΩﬁ©‹
(
time_öãΩﬁ©‹
 *);

344 
ölöe
 

345 
	$time_öãΩﬁ©‹_upd©e
(
dñè_n£c
)

347 
time_öãΩﬁ©‹
 *
ti
 =Åime_interpolator;

349 i‡(
œ°_n£c_off£t
 > 0) {

350 #ifde‡
__HAVE_ARCH_CMPXCHG


351 
√w
, 
ﬁd
;

354 
ﬁd
 = 
œ°_n£c_off£t
;

355 i‡(
ﬁd
 > 
dñè_n£c
)

356 
√w
 = 
ﬁd
 - 
dñè_n£c
;

358 
√w
 = 0;

359 } 
	`cmpxchg
(&
œ°_n£c_off£t
, 
ﬁd
, 
√w
) != old);

366 
	`•ö_lock
(&
œ°_n£c_off£t_lock
);

368 
œ°_n£c_off£t
 -
	`mö
÷a°_n£c_off£t, 
dñè_n£c
);

370 
	`•ö_u∆ock
(&
œ°_n£c_off£t_lock
);

374 i‡(
ti
)

375 (*
ti
->
upd©e
)(
dñè_n£c
);

376 
	}
}

379 
ölöe
 

380 
	$time_öãΩﬁ©‹_ª£t
()

382 
time_öãΩﬁ©‹
 *
ti
 =Åime_interpolator;

384 
œ°_n£c_off£t
 = 0;

385 i‡(
ti
)

386 (*
ti
->
ª£t
)();

387 
	}
}

390 
ölöe
 

391 
	$time_öãΩﬁ©‹_gë_off£t
()

393 
time_öãΩﬁ©‹
 *
ti
 =Åime_interpolator;

394 i‡(
ti
)

395  (*
ti
->
gë_off£t
)();

396  
œ°_n£c_off£t
;

397 
	}
}

401 
ölöe
 

402 
	$time_öãΩﬁ©‹_upd©e
(
dñè_n£c
)

404 
	}
}

406 
ölöe
 

407 
	$time_öãΩﬁ©‹_ª£t
()

409 
	}
}

411 
ölöe
 

412 
	$time_öãΩﬁ©‹_gë_off£t
()

415 
	}
}

	@/usr/include/wchar.h

24 #i‚de‡
_WCHAR_H


26 #i‚de‡
__√ed_mb°©e_t


27 
	#_WCHAR_H
 1

	)

28 
	~<„©uªs.h
>

31 #ifde‡
_WCHAR_H


33 
	#__√ed___FILE


	)

34 #ifde‡
__USE_UNIX98


35 
	#__√ed_FILE


	)

37 
	~<°dio.h
>

39 
	#__√ed___va_li°


	)

40 
	~<°d¨g.h
>

43 
	#__√ed_size_t


	)

44 
	#__√ed_wch¨_t


	)

45 
	#__√ed_NULL


	)

47 
	#__√ed_wöt_t


	)

48 
	~<°ddef.h
>

50 
	~<bôs/wch¨.h
>

54 #i‚de‡
_WINT_T


59 
	#_WINT_T


	)

60 
	twöt_t
;

64 #i‡
deföed
 
__˝lu•lus
 && deföed 
_GLIBCPP_USE_NAMESPACES
 \

65 && 
deföed
 
__WINT_TYPE__


66 
__BEGIN_NAMESPACE_STD


67 
__WINT_TYPE__
 
	twöt_t
;

68 
	g__END_NAMESPACE_STD


73 #i‚de‡
__mb°©e_t_deföed


74 
	#__mb°©e_t_deföed
 1

	)

78 
	m__cou¡
;

81 
wöt_t
 
	m__wch
;

82 
	m__wchb
[4];

83 } 
	m__vÆue
;

84 } 
	t__mb°©e_t
;

86 #unde‡
__√ed_mb°©e_t


91 #ifde‡
_WCHAR_H


93 
__BEGIN_NAMESPACE_C99


95 
__mb°©e_t
 
	tmb°©e_t
;

96 
	g__END_NAMESPACE_C99


97 #ifde‡
__USE_GNU


98 
	$__USING_NAMESPACE_C99
(
mb°©e_t
)

101 #i‚de‡
WCHAR_MIN


103 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

104 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

107 #i‚de‡
WEOF


108 
	#WEOF
 (0xffffffffu)

	)

113 #i‡
deföed
 
__USE_XOPEN
 && !deföed 
__USE_UNIX98


114 
	~<w˘y≥.h
>

118 
__BEGIN_DECLS


120 
__BEGIN_NAMESPACE_STD


123 
tm
;

127 
	$__USING_NAMESPACE_STD
(
tm
)

128 
__END_NAMESPACE_STD


131 
__BEGIN_NAMESPACE_C99


133 
wch¨_t
 *
	$wcs˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

134 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

136 
wch¨_t
 *
	$wc¢˝y
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

137 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

138 
__THROW
;

141 
wch¨_t
 *
	$wcsˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

142 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
Ë
__THROW
;

144 
wch¨_t
 *
	$wc¢ˇt
 (
wch¨_t
 *
__ª°ri˘
 
__de°
,

145 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__§c
, 
size_t
 
__n
)

146 
__THROW
;

149 
	$wcscmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
)

150 
__THROW
 
__©åibuã_puª__
;

152 
	$wc¢cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
, 
size_t
 
__n
)

153 
__THROW
 
__©åibuã_puª__
;

154 
__END_NAMESPACE_C99


156 #ifde‡
__USE_GNU


158 
	$wcsˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

161 
	$wc¢ˇ£cmp
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

162 
size_t
 
__n
Ë
__THROW
;

166 
	~<xloˇÀ.h
>

168 
	$wcsˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

169 
__loˇÀ_t
 
__loc
Ë
__THROW
;

171 
	$wc¢ˇ£cmp_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

172 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

175 
__BEGIN_NAMESPACE_C99


178 
	$wcscﬁl
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
Ë
__THROW
;

182 
size_t
 
	$wcsx‰m
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

183 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

184 
__END_NAMESPACE_C99


186 #ifde‡
__USE_GNU


192 
	$wcscﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__s1
, __c⁄° wch¨_à*
__s2
,

193 
__loˇÀ_t
 
__loc
Ë
__THROW
;

198 
size_t
 
	$wcsx‰m_l
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
,

199 
size_t
 
__n
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

202 
wch¨_t
 *
	$wcsdup
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_mÆloc__
;

205 
__BEGIN_NAMESPACE_C99


207 
wch¨_t
 *
	$wcschr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

208 
__THROW
 
__©åibuã_puª__
;

210 
wch¨_t
 *
	$wc§chr
 (
__c⁄°
 
wch¨_t
 *
__wcs
, wch¨_à
__wc
)

211 
__THROW
 
__©åibuã_puª__
;

212 
__END_NAMESPACE_C99


214 #ifde‡
__USE_GNU


217 
wch¨_t
 *
	$wcsch∫ul
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__wc
)

218 
__THROW
 
__©åibuã_puª__
;

221 
__BEGIN_NAMESPACE_C99


224 
size_t
 
	$wcsc•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ªje˘
)

225 
__THROW
 
__©åibuã_puª__
;

228 
size_t
 
	$wcs•n
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

229 
__THROW
 
__©åibuã_puª__
;

231 
wch¨_t
 *
	$wc•brk
 (
__c⁄°
 
wch¨_t
 *
__wcs
, __c⁄° wch¨_à*
__ac˚±
)

232 
__THROW
 
__©åibuã_puª__
;

234 
wch¨_t
 *
	$wcs°r
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

235 
__THROW
 
__©åibuã_puª__
;

238 
wch¨_t
 *
	$wc°ok
 (
wch¨_t
 *
__ª°ri˘
 
__s
,

239 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__dñim
,

240 
wch¨_t
 **
__ª°ri˘
 
__±r
Ë
__THROW
;

243 
size_t
 
	$wc¶í
 (
__c⁄°
 
wch¨_t
 *
__s
Ë
__THROW
 
__©åibuã_puª__
;

244 
__END_NAMESPACE_C99


246 #ifde‡
__USE_XOPEN


248 
wch¨_t
 *
	$wcswcs
 (
__c⁄°
 
wch¨_t
 *
__hay°ack
, __c⁄° wch¨_à*
__√edÀ
)

249 
__THROW
 
__©åibuã_puª__
;

252 #ifde‡
__USE_GNU


254 
size_t
 
	$wc¢Àn
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__maxÀn
)

255 
__THROW
 
__©åibuã_puª__
;

259 
__BEGIN_NAMESPACE_C99


261 
wch¨_t
 *
	$wmemchr
 (
__c⁄°
 
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
)

262 
__THROW
 
__©åibuã_puª__
;

265 
	$wmemcmp
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s1
,

266 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

267 
__THROW
 
__©åibuã_puª__
;

270 
wch¨_t
 *
	$wmem˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

271 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
Ë
__THROW
;

275 
wch¨_t
 *
	$wmemmove
 (
wch¨_t
 *
__s1
, 
__c⁄°
 wch¨_à*
__s2
, 
size_t
 
__n
)

276 
__THROW
;

279 
wch¨_t
 *
	$wmem£t
 (
wch¨_t
 *
__s
, wch¨_à
__c
, 
size_t
 
__n
Ë
__THROW
;

280 
__END_NAMESPACE_C99


282 #ifde‡
__USE_GNU


285 
wch¨_t
 *
	$wmemp˝y
 (
wch¨_t
 *
__ª°ri˘
 
__s1
,

286 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s2
, 
size_t
 
__n
)

287 
__THROW
;

291 
__BEGIN_NAMESPACE_C99


294 
wöt_t
 
	$btowc
 (
__c
Ë
__THROW
;

298 
	$w˘ob
 (
wöt_t
 
__c
Ë
__THROW
;

302 
	$mbsöô
 (
__c⁄°
 
mb°©e_t
 *
__ps
Ë
__THROW
 
__©åibuã_puª__
;

306 
size_t
 
	$mbπowc
 (
wch¨_t
 *
__ª°ri˘
 
__pwc
,

307 
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

308 
mb°©e_t
 *
__p
Ë
__THROW
;

311 
size_t
 
	$w¸tomb
 (*
__ª°ri˘
 
__s
, 
wch¨_t
 
__wc
,

312 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

315 
size_t
 
	$__mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

316 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

317 
size_t
 
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

318 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

319 
__END_NAMESPACE_C99


321 #ifde‡
__USE_EXTERN_INLINES


323 
__ölöe
 
size_t
 
	$mbæí
 (
__c⁄°
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

324 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW


325 {  (
__ps
 !
NULL


326 ? 
	`mbπowc
 (
NULL
, 
__s
, 
__n
, 
__ps
Ë: 
	`__mbæí
 (__s, __n, NULL)); 
	}
}

329 
__BEGIN_NAMESPACE_C99


332 
size_t
 
	$mb§towcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

333 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

334 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

338 
size_t
 
	$wc§tombs
 (*
__ª°ri˘
 
__d°
,

339 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
, 
size_t
 
__Àn
,

340 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

341 
__END_NAMESPACE_C99


344 #ifdef 
__USE_GNU


347 
size_t
 
	$mb¢πowcs
 (
wch¨_t
 *
__ª°ri˘
 
__d°
,

348 
__c⁄°
 **
__ª°ri˘
 
__§c
, 
size_t
 
__nmc
,

349 
size_t
 
__Àn
, 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

353 
size_t
 
	$wc¢πombs
 (*
__ª°ri˘
 
__d°
,

354 
__c⁄°
 
wch¨_t
 **
__ª°ri˘
 
__§c
,

355 
size_t
 
__nwc
, size_à
__Àn
,

356 
mb°©e_t
 *
__ª°ri˘
 
__ps
Ë
__THROW
;

361 #ifde‡
__USE_XOPEN


363 
	$wcwidth
 (
wch¨_t
 
__c
Ë
__THROW
;

367 
	$wcswidth
 (
__c⁄°
 
wch¨_t
 *
__s
, 
size_t
 
__n
Ë
__THROW
;

371 
__BEGIN_NAMESPACE_C99


374 
	$wc°od
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

375 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

377 #ifde‡
__USE_ISOC99


379 
	$wc°of
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

380 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

381 
	$wc°ﬁd
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

382 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW
;

388 
	$wc°ﬁ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

389 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
Ë
__THROW
;

393 
	$wc°oul
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

394 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

395 
__THROW
;

397 #i‡
deföed
 
__USE_ISOC99
 || (deföed 
__GNUC__
 && deföed 
__USE_GNU
)

400 
__exãnsi⁄__


401 
	$wc°ﬁl
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

402 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

403 
__THROW
;

407 
__exãnsi⁄__


408 
	$wc°ouŒ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

409 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

410 
__ba£
Ë
__THROW
;

412 
__END_NAMESPACE_C99


414 #i‡
deföed
 
__GNUC__
 && deföed 
__USE_GNU


417 
__exãnsi⁄__


418 
	$wc°oq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

419 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
)

420 
__THROW
;

424 
__exãnsi⁄__


425 
	$wc°ouq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

426 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

427 
__ba£
Ë
__THROW
;

430 #ifde‡
__USE_GNU


444 
	~<xloˇÀ.h
>

448 
	$wc°ﬁ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

449 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__ba£
,

450 
__loˇÀ_t
 
__loc
Ë
__THROW
;

452 
	$wc°oul_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

453 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

454 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

456 
__exãnsi⁄__


457 
	$wc°ﬁl_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

458 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

459 
__ba£
, 
__loˇÀ_t
 
__loc
Ë
__THROW
;

461 
__exãnsi⁄__


462 
	$wc°ouŒ_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

463 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

464 
__ba£
, 
__loˇÀ_t
 
__loc
)

465 
__THROW
;

467 
	$wc°od_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

468 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

469 
__THROW
;

471 
	$wc°of_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

472 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__loˇÀ_t
 
__loc
)

473 
__THROW
;

475 
	$wc°ﬁd_l
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

476 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

477 
__loˇÀ_t
 
__loc
Ë
__THROW
;

483 
	$__wc°od_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

484 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__group
)

485 
__THROW
;

486 
	$__wc°of_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

487 
wch¨_t
 **
__ª°ri˘
 
__íd±r
, 
__group
)

488 
__THROW
;

489 
	$__wc°ﬁd_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

490 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

491 
__group
Ë
__THROW
;

493 #i‚de‡
__wc°ﬁ_öã∫Æ_deföed


494 
	$__wc°ﬁ_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

495 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

496 
__ba£
, 
__group
Ë
__THROW
;

497 
	#__wc°ﬁ_öã∫Æ_deföed
 1

	)

499 #i‚de‡
__wc°oul_öã∫Æ_deföed


500 
	$__wc°oul_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈t
,

501 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

502 
__ba£
, 
__group
Ë
__THROW
;

503 
	#__wc°oul_öã∫Æ_deföed
 1

	)

505 #i‚de‡
__wc°ﬁl_öã∫Æ_deföed


506 
__exãnsi⁄__


507 
	$__wc°ﬁl_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

508 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

509 
__ba£
, 
__group
Ë
__THROW
;

510 
	#__wc°ﬁl_öã∫Æ_deföed
 1

	)

512 #i‚de‡
__wc°ouŒ_öã∫Æ_deföed


513 
__exãnsi⁄__


514 
	$__wc°ouŒ_öã∫Æ
 (
__c⁄°
 
wch¨_t
 *

515 
__ª°ri˘
 
__≈å
,

516 
wch¨_t
 **

517 
__ª°ri˘
 
__íd±r
,

518 
__ba£
,

519 
__group
Ë
__THROW
;

520 
	#__wc°ouŒ_öã∫Æ_deföed
 1

	)

524 #i‡
deföed
 
__OPTIMIZE__
 && 
__GNUC__
 >= 2

526 
__BEGIN_NAMESPACE_C99


528 
__ölöe
 
	$wc°od
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

529 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW


530 {  
	`__wc°od_öã∫Æ
 (
__≈å
, 
__íd±r
, 0); 
	}
}

531 
__ölöe
 
	$wc°ﬁ
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

532 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

533 
__ba£
Ë
__THROW


534 {  
	`__wc°ﬁ_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0); 
	}
}

535 
__ölöe
 
	$wc°oul
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

536 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

537 
__ba£
Ë
__THROW


538 {  
	`__wc°oul_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0); 
	}
}

539 
__END_NAMESPACE_C99


541 #ifde‡
__USE_GNU


542 
__ölöe
 
	$wc°of
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

543 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW


544 {  
	`__wc°of_öã∫Æ
 (
__≈å
, 
__íd±r
, 0); 
	}
}

545 
__ölöe
 
	$wc°ﬁd
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

546 
wch¨_t
 **
__ª°ri˘
 
__íd±r
Ë
__THROW


547 {  
	`__wc°ﬁd_öã∫Æ
 (
__≈å
, 
__íd±r
, 0); 
	}
}

550 
__exãnsi⁄__


551 
__ölöe
 
	$wc°oq
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__≈å
,

552 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

553 
__ba£
Ë
__THROW


554 {  
	`__wc°ﬁl_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0); 
	}
}

555 
__exãnsi⁄__


556 
__ölöe
 
	$wc°ouq
 (
__c⁄°
 
wch¨_t
 *

557 
__ª°ri˘
 
__≈å
,

558 
wch¨_t
 **
__ª°ri˘
 
__íd±r
,

559 
__ba£
Ë
__THROW


560 {  
	`__wc°ouŒ_öã∫Æ
 (
__≈å
, 
__íd±r
, 
__ba£
, 0); 
	}
}

565 #ifdef 
__USE_GNU


568 
wch¨_t
 *
	$w˝˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
Ë
__THROW
;

572 
wch¨_t
 *
	$w˝n˝y
 (
wch¨_t
 *
__de°
, 
__c⁄°
 wch¨_à*
__§c
, 
size_t
 
__n
)

573 
__THROW
;

578 #i‡
deföed
 
__USE_ISOC99
 || deföed 
__USE_UNIX98


579 
__BEGIN_NAMESPACE_C99


582 
	$fwide
 (
__FILE
 *
__Â
, 
__mode
Ë
__THROW
;

589 
	`fw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

590 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

596 
	`w¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

599 
	$sw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

600 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

601 
__THROW
 ;

607 
	`vfw¥ötf
 (
__FILE
 *
__ª°ri˘
 
__s
,

608 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

609 
__gnuc_va_li°
 
__¨g
)

615 
	`vw¥ötf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

616 
__gnuc_va_li°
 
__¨g
)

620 
	$vsw¥ötf
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__n
,

621 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

622 
__gnuc_va_li°
 
__¨g
)

623 
__THROW
 ;

630 
	`fwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__°ªam
,

631 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

637 
	`wsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

640 
	$swsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

641 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
, ...)

642 
__THROW
 ;

644 
__END_NAMESPACE_C99


647 #ifde‡
__USE_ISOC99


648 
__BEGIN_NAMESPACE_C99


654 
	`vfwsˇnf
 (
__FILE
 *
__ª°ri˘
 
__s
,

655 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

656 
__gnuc_va_li°
 
__¨g
)

662 
	`vwsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

663 
__gnuc_va_li°
 
__¨g
)

666 
	$vswsˇnf
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__s
,

667 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

668 
__gnuc_va_li°
 
__¨g
)

669 
__THROW
 ;

671 
__END_NAMESPACE_C99


675 
__BEGIN_NAMESPACE_C99


680 
wöt_t
 
	`fgëwc
 (
__FILE
 *
__°ªam
);

681 
wöt_t
 
	`gëwc
 (
__FILE
 *
__°ªam
);

687 
wöt_t
 
	`gëwch¨
 ();

694 
wöt_t
 
	`Âutwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

695 
wöt_t
 
	`putwc
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

701 
wöt_t
 
	`putwch¨
 (
wch¨_t
 
__wc
);

709 
wch¨_t
 *
	`fgëws
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

710 
__FILE
 *
__ª°ri˘
 
__°ªam
);

716 
	`Âutws
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

717 
__FILE
 *
__ª°ri˘
 
__°ªam
);

724 
wöt_t
 
	`ungëwc
 (wöt_à
__wc
, 
__FILE
 *
__°ªam
);

725 
__END_NAMESPACE_C99


728 #ifde‡
__USE_GNU


736 
wöt_t
 
	`gëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

737 
wöt_t
 
	`gëwch¨_u∆ocked
 ();

745 
wöt_t
 
	`fgëwc_u∆ocked
 (
__FILE
 *
__°ªam
);

753 
wöt_t
 
	`Âutwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

762 
wöt_t
 
	`putwc_u∆ocked
 (
wch¨_t
 
__wc
, 
__FILE
 *
__°ªam
);

763 
wöt_t
 
	`putwch¨_u∆ocked
 (
wch¨_t
 
__wc
);

772 
wch¨_t
 *
	`fgëws_u∆ocked
 (wch¨_à*
__ª°ri˘
 
__ws
, 
__n
,

773 
__FILE
 *
__ª°ri˘
 
__°ªam
);

781 
	`Âutws_u∆ocked
 (
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__ws
,

782 
__FILE
 *
__ª°ri˘
 
__°ªam
);

786 
__BEGIN_NAMESPACE_C99


790 
size_t
 
	$wcs·ime
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

791 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

792 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
Ë
__THROW
;

793 
__END_NAMESPACE_C99


795 #ifde‡
__USE_GNU


796 
	~<xloˇÀ.h
>

800 
size_t
 
	$wcs·ime_l
 (
wch¨_t
 *
__ª°ri˘
 
__s
, 
size_t
 
__maxsize
,

801 
__c⁄°
 
wch¨_t
 *
__ª°ri˘
 
__f‹m©
,

802 
__c⁄°
 
tm
 *
__ª°ri˘
 
__ç
,

803 
__loˇÀ_t
 
__loc
Ë
__THROW
;

812 #i‡
deföed
 
__USE_UNIX98
 && !deföed 
__USE_GNU


813 
	#__√ed_iswxxx


	)

814 
	~<w˘y≥.h
>

817 
__END_DECLS


	@/usr/include/asm-generic/errno.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-gíîic/î∫o-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

	@/usr/include/asm/bitops.h

1 #i‚de‡
_I386_BITOPS_H


2 
	#_I386_BITOPS_H


	)

8 
	~<löux/c⁄fig.h
>

9 
	~<löux/compûî.h
>

19 #ifde‡
CONFIG_SMP


20 
	#LOCK_PREFIX
 "lock ; "

	)

22 
	#LOCK_PREFIX
 ""

	)

25 
	#ADDR
 (*(vﬁ©ûê*Ë
addr
)

	)

37 
__ölöe__
 
	$£t_bô
(
ƒ
, vﬁ©ûê* 
addr
)

39 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


41 :"=m" (
ADDR
)

42 :"Ir" (
ƒ
));

43 
	}
}

54 
__ölöe__
 
	$__£t_bô
(
ƒ
, vﬁ©ûê* 
addr
)

56 
	`__asm__
(

58 :"=m" (
ADDR
)

59 :"Ir" (
ƒ
));

60 
	}
}

72 
__ölöe__
 
	$˛ór_bô
(
ƒ
, vﬁ©ûê* 
addr
)

74 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


76 :"=m" (
ADDR
)

77 :"Ir" (
ƒ
));

78 
	}
}

80 
__ölöe__
 
	$__˛ór_bô
(
ƒ
, vﬁ©ûê* 
addr
)

82 
__asm__
 
	`__vﬁ©ûe__
(

84 :"=m" (
ADDR
)

85 :"Ir" (
ƒ
));

86 
	}
}

87 
	#smp_mb__bef‹e_˛ór_bô
(Ë
	`b¨rõr
()

	)

88 
	#smp_mb__a·î_˛ór_bô
(Ë
	`b¨rõr
()

	)

99 
__ölöe__
 
	$__ch™ge_bô
(
ƒ
, vﬁ©ûê* 
addr
)

101 
__asm__
 
	`__vﬁ©ûe__
(

103 :"=m" (
ADDR
)

104 :"Ir" (
ƒ
));

105 
	}
}

116 
__ölöe__
 
	$ch™ge_bô
(
ƒ
, vﬁ©ûê* 
addr
)

118 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


120 :"=m" (
ADDR
)

121 :"Ir" (
ƒ
));

122 
	}
}

132 
__ölöe__
 
	$ã°_™d_£t_bô
(
ƒ
, vﬁ©ûê* 
addr
)

134 
ﬁdbô
;

136 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


138 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

139 :"Ir" (
ƒ
) : "memory");

140  
ﬁdbô
;

141 
	}
}

152 
__ölöe__
 
	$__ã°_™d_£t_bô
(
ƒ
, vﬁ©ûê* 
addr
)

154 
ﬁdbô
;

156 
	`__asm__
(

158 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

159 :"Ir" (
ƒ
));

160  
ﬁdbô
;

161 
	}
}

171 
__ölöe__
 
	$ã°_™d_˛ór_bô
(
ƒ
, vﬁ©ûê* 
addr
)

173 
ﬁdbô
;

175 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


177 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

178 :"Ir" (
ƒ
) : "memory");

179  
ﬁdbô
;

180 
	}
}

191 
__ölöe__
 
	$__ã°_™d_˛ór_bô
(
ƒ
, vﬁ©ûê*
addr
)

193 
ﬁdbô
;

195 
	`__asm__
(

197 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

198 :"Ir" (
ƒ
));

199  
ﬁdbô
;

200 
	}
}

203 
__ölöe__
 
	$__ã°_™d_ch™ge_bô
(
ƒ
, vﬁ©ûê*
addr
)

205 
ﬁdbô
;

207 
__asm__
 
	`__vﬁ©ûe__
(

209 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

210 :"Ir" (
ƒ
) : "memory");

211  
ﬁdbô
;

212 
	}
}

222 
__ölöe__
 
	$ã°_™d_ch™ge_bô
(
ƒ
, vﬁ©ûê* 
addr
)

224 
ﬁdbô
;

226 
__asm__
 
	`__vﬁ©ûe__
–
LOCK_PREFIX


228 :"Ù" (
ﬁdbô
),"=m" (
ADDR
)

229 :"Ir" (
ƒ
) : "memory");

230  
ﬁdbô
;

231 
	}
}

239 
ã°_bô
(
ƒ
, c⁄° vﬁ©ûê* 
addr
);

242 
__ölöe__
 
	$c⁄°™t_ã°_bô
(
ƒ
, c⁄° vﬁ©ûê* 
addr
)

244  ((1UL << (
ƒ
 & 31)Ë& (((c⁄° vﬁ©ûê*Ë
addr
)[nr >> 5])) != 0;

245 
	}
}

247 
__ölöe__
 
	$v¨übÀ_ã°_bô
(
ƒ
, c⁄° vﬁ©ûê* 
addr
)

249 
ﬁdbô
;

251 
__asm__
 
	`__vﬁ©ûe__
(

253 :"Ù" (
ﬁdbô
)

254 :"m" (
ADDR
),"Ir" (
ƒ
));

255  
ﬁdbô
;

256 
	}
}

258 
	#ã°_bô
(
ƒ
,
addr
) \

259 (
	`__buûtö_c⁄°™t_p
(
ƒ
) ? \

260 
	`c⁄°™t_ã°_bô
((
ƒ
),(
addr
)) : \

261 
	`v¨übÀ_ã°_bô
((
ƒ
),(
addr
)))

	)

263 #unde‡
ADDR


273 
__ölöe__
 
	$föd_fú°_zîo_bô
(c⁄° *
addr
, 
size
)

275 
d0
, 
d1
, 
d2
;

276 
ªs
;

278 i‡(!
size
)

281 
__asm__
 
	`__vﬁ©ûe__
(

292 :"=d" (
ªs
), "=&c" (
d0
), "=&D" (
d1
), "=&a" (
d2
)

293 :"1" ((
size
 + 31Ë>> 5), "2" (
addr
), "b" (addr));

294  
ªs
;

295 
	}
}

305 
__ölöe__
 
	$föd_fú°_bô
(c⁄° *
addr
, 
size
)

307 
d0
, 
d1
;

308 
ªs
;

311 
__asm__
 
	`__vﬁ©ûe__
(

320 :"˜" (
ªs
), "=&c" (
d0
), "=&D" (
d1
)

321 :"1" ((
size
 + 31Ë>> 5), "2" (
addr
), "b" (addr));

322  
ªs
;

323 
	}
}

331 
__ölöe__
 
	$föd_√xt_zîo_bô
(c⁄° *
addr
, 
size
, 
off£t
)

333 * 
p
 = ((*Ë
addr
Ë+ (
off£t
 >> 5);

334 
£t
 = 0, 
bô
 = 
off£t
 & 31, 
ªs
;

336 i‡(
bô
) {

340 
	`__asm__
("bsfl %1,%0\n\t"

344 : "Ù" (
£t
)

345 : "r" (~(*
p
 >> 
bô
)));

346 i‡(
£t
 < (32 - 
bô
))

347  
£t
 + 
off£t
;

348 
£t
 = 32 - 
bô
;

349 
p
++;

354 
ªs
 = 
	`föd_fú°_zîo_bô
 (
p
, 
size
 - 32 * (∞- (*Ë
addr
));

355  (
off£t
 + 
£t
 + 
ªs
);

356 
	}
}

364 
__ölöe__
 
	$föd_√xt_bô
(c⁄° *
addr
, 
size
, 
off£t
)

366 c⁄° *
p
 = 
addr
 + (
off£t
 >> 5);

367 
£t
 = 0, 
bô
 = 
off£t
 & 31, 
ªs
;

369 i‡(
bô
) {

373 
	`__asm__
("bsfl %1,%0\n\t"

377 : "Ù" (
£t
)

378 : "r" (*
p
 >> 
bô
));

379 i‡(
£t
 < (32 - 
bô
))

380  
£t
 + 
off£t
;

381 
£t
 = 32 - 
bô
;

382 
p
++;

387 
ªs
 = 
	`föd_fú°_bô
 (
p
, 
size
 - 32 * (∞- 
addr
));

388  (
off£t
 + 
£t
 + 
ªs
);

389 
	}
}

397 
__ölöe__
 
	$ffz
(
w‹d
)

399 
	`__asm__
("bsfl %1,%0"

400 :"Ù" (
w‹d
)

401 :"r" (~
w‹d
));

402  
w‹d
;

403 
	}
}

411 
__ölöe__
 
	$__ffs
(
w‹d
)

413 
	`__asm__
("bsfl %1,%0"

414 :"Ù" (
w‹d
)

415 :"rm" (
w‹d
));

416  
w‹d
;

417 
	}
}

423 
	#Ês
(
x
Ë
	`gíîic_Ês
(x)

	)

425 #ifde‡
__KERNEL__


433 
ölöe
 
	$sched_föd_fú°_bô
(c⁄° *
b
)

435 i‡(
	`u∆ikñy
(
b
[0]))

436  
	`__ffs
(
b
[0]);

437 i‡(
	`u∆ikñy
(
b
[1]))

438  
	`__ffs
(
b
[1]) + 32;

439 i‡(
	`u∆ikñy
(
b
[2]))

440  
	`__ffs
(
b
[2]) + 64;

441 i‡(
b
[3])

442  
	`__ffs
(
b
[3]) + 96;

443  
	`__ffs
(
b
[4]) + 128;

444 
	}
}

454 
__ölöe__
 
	$ffs
(
x
)

456 
r
;

458 
	`__asm__
("bsfl %1,%0\n\t"

461 "1:" : "Ù" (
r
Ë: "rm" (
x
));

462  
r
+1;

463 
	}
}

472 
	#hweight32
(
x
Ë
	`gíîic_hweight32
(x)

	)

473 
	#hweight16
(
x
Ë
	`gíîic_hweight16
(x)

	)

474 
	#hweight8
(
x
Ë
	`gíîic_hweight8
(x)

	)

478 #ifde‡
__KERNEL__


480 
	#ext2_£t_bô
(
ƒ
,
addr
) \

481 
	`__ã°_™d_£t_bô
((
ƒ
),(*)
addr
)

	)

482 
	#ext2_£t_bô_©omic
(
lock
,
ƒ
,
addr
) \

483 
	`ã°_™d_£t_bô
((
ƒ
),(*)
addr
)

	)

484 
	#ext2_˛ór_bô
(
ƒ
, 
addr
) \

485 
	`__ã°_™d_˛ór_bô
((
ƒ
),(*)
addr
)

	)

486 
	#ext2_˛ór_bô_©omic
(
lock
,
ƒ
, 
addr
) \

487 
	`ã°_™d_˛ór_bô
((
ƒ
),(*)
addr
)

	)

488 
	#ext2_ã°_bô
(
ƒ
, 
addr
Ë
	`ã°_bô
(“r),(*Ôddr)

	)

489 
	#ext2_föd_fú°_zîo_bô
(
addr
, 
size
) \

490 
	`föd_fú°_zîo_bô
((*)
addr
, 
size
)

	)

491 
	#ext2_föd_√xt_zîo_bô
(
addr
, 
size
, 
off
) \

492 
	`föd_√xt_zîo_bô
((*)
addr
, 
size
, 
off
)

	)

495 
	#möix_ã°_™d_£t_bô
(
ƒ
,
addr
Ë
	`__ã°_™d_£t_bô
“r,(*Ôddr)

	)

496 
	#möix_£t_bô
(
ƒ
,
addr
Ë
	`__£t_bô
“r,(*Ôddr)

	)

497 
	#möix_ã°_™d_˛ór_bô
(
ƒ
,
addr
Ë
	`__ã°_™d_˛ór_bô
“r,(*Ôddr)

	)

498 
	#möix_ã°_bô
(
ƒ
,
addr
Ë
	`ã°_bô
“r,(*Ôddr)

	)

499 
	#möix_föd_fú°_zîo_bô
(
addr
,
size
) \

500 
	`föd_fú°_zîo_bô
((*)
addr
,
size
)

	)

	@/usr/include/asm/math_emu.h

1 #i‚de‡
_I386_MATH_EMU_H


2 
	#_I386_MATH_EMU_H


	)

4 
	~<asm/sigc⁄ãxt.h
>

6 
ª°‹e_i387_so·
(*
s387
, 
_Â°©e
 
__u£r
 *
buf
);

7 
ßve_i387_so·
(*
s387
, 
_Â°©e
 
__u£r
 *
buf
);

13 
	söfo
 {

14 
	m___‹ig_eù
;

15 
	m___ebx
;

16 
	m___ecx
;

17 
	m___edx
;

18 
	m___esi
;

19 
	m___edi
;

20 
	m___ebp
;

21 
	m___óx
;

22 
	m___ds
;

23 
	m___es
;

24 
	m___‹ig_óx
;

25 
	m___eù
;

26 
	m___cs
;

27 
	m___eÊags
;

28 
	m___e•
;

29 
	m___ss
;

30 
	m___vm86_es
;

31 
	m___vm86_ds
;

32 
	m___vm86_fs
;

33 
	m___vm86_gs
;

	@/usr/include/asm/msr.h

1 #i‚de‡
__ASM_MSR_H


2 
	#__ASM_MSR_H


	)

10 
	#rdm§
(
m§
,
vÆ1
,
vÆ2
) \

11 
__asm__
 
	`__vﬁ©ûe__
("rdmsr" \

12 : "˜" (
vÆ1
), "=d" (
vÆ2
) \

13 : "c" (
m§
))

	)

15 
	#wrm§
(
m§
,
vÆ1
,
vÆ2
) \

16 
__asm__
 
	`__vﬁ©ûe__
("wrmsr" \

18 : "c" (
m§
), "a" (
vÆ1
), "d" (
vÆ2
))

	)

20 
	#rdm§l
(
m§
,
vÆ
) do { \

21 
l__
,
h__
; \

22 
	`rdm§
 (
m§
, 
l__
, 
h__
); \

23 
vÆ
 = 
l__
; \

24 
vÆ
 |((
u64
)
h__
<<32); \

25 } 0)

	)

27 
ölöe
 
	$wrm§l
 (
m§
, 
vÆ
)

29 
lo
, 
hi
;

30 
lo
 = (Ë
vÆ
;

31 
hi
 = 
vÆ
 >> 32;

32 
	`wrm§
 (
m§
, 
lo
, 
hi
);

33 
	}
}

35 
	#rdtsc
(
low
,
high
) \

36 
__asm__
 
	`__vﬁ©ûe__
("rdtsc" : "˜" (
low
), "=d" (
high
))

	)

38 
	#rdts˛
(
low
) \

39 
__asm__
 
	`__vﬁ©ûe__
("rdtsc" : "˜" (
low
Ë: : "edx")

	)

41 
	#rdts˛l
(
vÆ
) \

42 
__asm__
 
	`__vﬁ©ûe__
("rdtsc" : "=A" (
vÆ
))

	)

44 
	#wrôe_tsc
(
vÆ1
,
vÆ2
Ë
	`wrm§
(0x10, vÆ1, vÆ2)

	)

46 
	#rdpmc
(
cou¡î
,
low
,
high
) \

47 
__asm__
 
	`__vﬁ©ûe__
("rdpmc" \

48 : "˜" (
low
), "=d" (
high
) \

49 : "c" (
cou¡î
))

	)

53 
	#MSR_IA32_P5_MC_ADDR
 0

	)

54 
	#MSR_IA32_P5_MC_TYPE
 1

	)

55 
	#MSR_IA32_PLATFORM_ID
 0x17

	)

56 
	#MSR_IA32_EBL_CR_POWERON
 0x2a

	)

58 
	#MSR_IA32_APICBASE
 0x1b

	)

59 
	#MSR_IA32_APICBASE_BSP
 (1<<8)

	)

60 
	#MSR_IA32_APICBASE_ENABLE
 (1<<11)

	)

61 
	#MSR_IA32_APICBASE_BASE
 (0xfffff<<12)

	)

63 
	#MSR_IA32_UCODE_WRITE
 0x79

	)

64 
	#MSR_IA32_UCODE_REV
 0x8b

	)

66 
	#MSR_P6_PERFCTR0
 0xc1

	)

67 
	#MSR_P6_PERFCTR1
 0xc2

	)

69 
	#MSR_IA32_BBL_CR_CTL
 0x119

	)

71 
	#MSR_IA32_SYSENTER_CS
 0x174

	)

72 
	#MSR_IA32_SYSENTER_ESP
 0x175

	)

73 
	#MSR_IA32_SYSENTER_EIP
 0x176

	)

75 
	#MSR_IA32_MCG_CAP
 0x179

	)

76 
	#MSR_IA32_MCG_STATUS
 0x17a

	)

77 
	#MSR_IA32_MCG_CTL
 0x17b

	)

80 
	#MSR_IA32_MCG_EAX
 0x180

	)

81 
	#MSR_IA32_MCG_EBX
 0x181

	)

82 
	#MSR_IA32_MCG_ECX
 0x182

	)

83 
	#MSR_IA32_MCG_EDX
 0x183

	)

84 
	#MSR_IA32_MCG_ESI
 0x184

	)

85 
	#MSR_IA32_MCG_EDI
 0x185

	)

86 
	#MSR_IA32_MCG_EBP
 0x186

	)

87 
	#MSR_IA32_MCG_ESP
 0x187

	)

88 
	#MSR_IA32_MCG_EFLAGS
 0x188

	)

89 
	#MSR_IA32_MCG_EIP
 0x189

	)

90 
	#MSR_IA32_MCG_RESERVED
 0x18A

	)

92 
	#MSR_P6_EVNTSEL0
 0x186

	)

93 
	#MSR_P6_EVNTSEL1
 0x187

	)

95 
	#MSR_IA32_PERF_STATUS
 0x198

	)

96 
	#MSR_IA32_PERF_CTL
 0x199

	)

98 
	#MSR_IA32_THERM_CONTROL
 0x19a

	)

99 
	#MSR_IA32_THERM_INTERRUPT
 0x19b

	)

100 
	#MSR_IA32_THERM_STATUS
 0x19c

	)

101 
	#MSR_IA32_MISC_ENABLE
 0x1a0

	)

103 
	#MSR_IA32_DEBUGCTLMSR
 0x1d9

	)

104 
	#MSR_IA32_LASTBRANCHFROMIP
 0x1db

	)

105 
	#MSR_IA32_LASTBRANCHTOIP
 0x1dc

	)

106 
	#MSR_IA32_LASTINTFROMIP
 0x1dd

	)

107 
	#MSR_IA32_LASTINTTOIP
 0x1de

	)

109 
	#MSR_IA32_MC0_CTL
 0x400

	)

110 
	#MSR_IA32_MC0_STATUS
 0x401

	)

111 
	#MSR_IA32_MC0_ADDR
 0x402

	)

112 
	#MSR_IA32_MC0_MISC
 0x403

	)

115 
	#MSR_P4_BPU_PERFCTR0
 0x300

	)

116 
	#MSR_P4_BPU_PERFCTR1
 0x301

	)

117 
	#MSR_P4_BPU_PERFCTR2
 0x302

	)

118 
	#MSR_P4_BPU_PERFCTR3
 0x303

	)

119 
	#MSR_P4_MS_PERFCTR0
 0x304

	)

120 
	#MSR_P4_MS_PERFCTR1
 0x305

	)

121 
	#MSR_P4_MS_PERFCTR2
 0x306

	)

122 
	#MSR_P4_MS_PERFCTR3
 0x307

	)

123 
	#MSR_P4_FLAME_PERFCTR0
 0x308

	)

124 
	#MSR_P4_FLAME_PERFCTR1
 0x309

	)

125 
	#MSR_P4_FLAME_PERFCTR2
 0x30a

	)

126 
	#MSR_P4_FLAME_PERFCTR3
 0x30b

	)

127 
	#MSR_P4_IQ_PERFCTR0
 0x30c

	)

128 
	#MSR_P4_IQ_PERFCTR1
 0x30d

	)

129 
	#MSR_P4_IQ_PERFCTR2
 0x30e

	)

130 
	#MSR_P4_IQ_PERFCTR3
 0x30f

	)

131 
	#MSR_P4_IQ_PERFCTR4
 0x310

	)

132 
	#MSR_P4_IQ_PERFCTR5
 0x311

	)

133 
	#MSR_P4_BPU_CCCR0
 0x360

	)

134 
	#MSR_P4_BPU_CCCR1
 0x361

	)

135 
	#MSR_P4_BPU_CCCR2
 0x362

	)

136 
	#MSR_P4_BPU_CCCR3
 0x363

	)

137 
	#MSR_P4_MS_CCCR0
 0x364

	)

138 
	#MSR_P4_MS_CCCR1
 0x365

	)

139 
	#MSR_P4_MS_CCCR2
 0x366

	)

140 
	#MSR_P4_MS_CCCR3
 0x367

	)

141 
	#MSR_P4_FLAME_CCCR0
 0x368

	)

142 
	#MSR_P4_FLAME_CCCR1
 0x369

	)

143 
	#MSR_P4_FLAME_CCCR2
 0x36a

	)

144 
	#MSR_P4_FLAME_CCCR3
 0x36b

	)

145 
	#MSR_P4_IQ_CCCR0
 0x36c

	)

146 
	#MSR_P4_IQ_CCCR1
 0x36d

	)

147 
	#MSR_P4_IQ_CCCR2
 0x36e

	)

148 
	#MSR_P4_IQ_CCCR3
 0x36f

	)

149 
	#MSR_P4_IQ_CCCR4
 0x370

	)

150 
	#MSR_P4_IQ_CCCR5
 0x371

	)

151 
	#MSR_P4_ALF_ESCR0
 0x3ˇ

	)

152 
	#MSR_P4_ALF_ESCR1
 0x3cb

	)

153 
	#MSR_P4_BPU_ESCR0
 0x3b2

	)

154 
	#MSR_P4_BPU_ESCR1
 0x3b3

	)

155 
	#MSR_P4_BSU_ESCR0
 0x3a0

	)

156 
	#MSR_P4_BSU_ESCR1
 0x3a1

	)

157 
	#MSR_P4_CRU_ESCR0
 0x3b8

	)

158 
	#MSR_P4_CRU_ESCR1
 0x3b9

	)

159 
	#MSR_P4_CRU_ESCR2
 0x3cc

	)

160 
	#MSR_P4_CRU_ESCR3
 0x3cd

	)

161 
	#MSR_P4_CRU_ESCR4
 0x3e0

	)

162 
	#MSR_P4_CRU_ESCR5
 0x3e1

	)

163 
	#MSR_P4_DAC_ESCR0
 0x3a8

	)

164 
	#MSR_P4_DAC_ESCR1
 0x3a9

	)

165 
	#MSR_P4_FIRM_ESCR0
 0x3a4

	)

166 
	#MSR_P4_FIRM_ESCR1
 0x3a5

	)

167 
	#MSR_P4_FLAME_ESCR0
 0x3a6

	)

168 
	#MSR_P4_FLAME_ESCR1
 0x3a7

	)

169 
	#MSR_P4_FSB_ESCR0
 0x3a2

	)

170 
	#MSR_P4_FSB_ESCR1
 0x3a3

	)

171 
	#MSR_P4_IQ_ESCR0
 0x3ba

	)

172 
	#MSR_P4_IQ_ESCR1
 0x3bb

	)

173 
	#MSR_P4_IS_ESCR0
 0x3b4

	)

174 
	#MSR_P4_IS_ESCR1
 0x3b5

	)

175 
	#MSR_P4_ITLB_ESCR0
 0x3b6

	)

176 
	#MSR_P4_ITLB_ESCR1
 0x3b7

	)

177 
	#MSR_P4_IX_ESCR0
 0x3c8

	)

178 
	#MSR_P4_IX_ESCR1
 0x3c9

	)

179 
	#MSR_P4_MOB_ESCR0
 0x3Ø

	)

180 
	#MSR_P4_MOB_ESCR1
 0x3ab

	)

181 
	#MSR_P4_MS_ESCR0
 0x3c0

	)

182 
	#MSR_P4_MS_ESCR1
 0x3c1

	)

183 
	#MSR_P4_PMH_ESCR0
 0x3ac

	)

184 
	#MSR_P4_PMH_ESCR1
 0x3ad

	)

185 
	#MSR_P4_RAT_ESCR0
 0x3bc

	)

186 
	#MSR_P4_RAT_ESCR1
 0x3bd

	)

187 
	#MSR_P4_SAAT_ESCR0
 0x3´

	)

188 
	#MSR_P4_SAAT_ESCR1
 0x3af

	)

189 
	#MSR_P4_SSU_ESCR0
 0x3be

	)

190 
	#MSR_P4_SSU_ESCR1
 0x3b‡

	)

191 
	#MSR_P4_TBPU_ESCR0
 0x3c2

	)

192 
	#MSR_P4_TBPU_ESCR1
 0x3c3

	)

193 
	#MSR_P4_TC_ESCR0
 0x3c4

	)

194 
	#MSR_P4_TC_ESCR1
 0x3c5

	)

195 
	#MSR_P4_U2L_ESCR0
 0x3b0

	)

196 
	#MSR_P4_U2L_ESCR1
 0x3b1

	)

199 
	#MSR_K6_EFER
 0xC0000080

	)

200 
	#MSR_K6_STAR
 0xC0000081

	)

201 
	#MSR_K6_WHCR
 0xC0000082

	)

202 
	#MSR_K6_UWCCR
 0xC0000085

	)

203 
	#MSR_K6_EPMR
 0xC0000086

	)

204 
	#MSR_K6_PSOR
 0xC0000087

	)

205 
	#MSR_K6_PFIR
 0xC0000088

	)

207 
	#MSR_K7_EVNTSEL0
 0xC0010000

	)

208 
	#MSR_K7_EVNTSEL1
 0xC0010001

	)

209 
	#MSR_K7_EVNTSEL2
 0xC0010002

	)

210 
	#MSR_K7_EVNTSEL3
 0xC0010003

	)

211 
	#MSR_K7_PERFCTR0
 0xC0010004

	)

212 
	#MSR_K7_PERFCTR1
 0xC0010005

	)

213 
	#MSR_K7_PERFCTR2
 0xC0010006

	)

214 
	#MSR_K7_PERFCTR3
 0xC0010007

	)

215 
	#MSR_K7_HWCR
 0xC0010015

	)

216 
	#MSR_K7_CLK_CTL
 0xC001001b

	)

217 
	#MSR_K7_FID_VID_CTL
 0xC0010041

	)

218 
	#MSR_K7_FID_VID_STATUS
 0xC0010042

	)

221 
	#MSR_IDT_FCR1
 0x107

	)

222 
	#MSR_IDT_FCR2
 0x108

	)

223 
	#MSR_IDT_FCR3
 0x109

	)

224 
	#MSR_IDT_FCR4
 0x10a

	)

226 
	#MSR_IDT_MCR0
 0x110

	)

227 
	#MSR_IDT_MCR1
 0x111

	)

228 
	#MSR_IDT_MCR2
 0x112

	)

229 
	#MSR_IDT_MCR3
 0x113

	)

230 
	#MSR_IDT_MCR4
 0x114

	)

231 
	#MSR_IDT_MCR5
 0x115

	)

232 
	#MSR_IDT_MCR6
 0x116

	)

233 
	#MSR_IDT_MCR7
 0x117

	)

234 
	#MSR_IDT_MCR_CTRL
 0x120

	)

237 
	#MSR_VIA_FCR
 0x1107

	)

238 
	#MSR_VIA_LONGHAUL
 0x110a

	)

239 
	#MSR_VIA_RNG
 0x110b

	)

240 
	#MSR_VIA_BCR2
 0x1147

	)

243 
	#MSR_TMTA_LONGRUN_CTRL
 0x80868010

	)

244 
	#MSR_TMTA_LONGRUN_FLAGS
 0x80868011

	)

245 
	#MSR_TMTA_LRTI_READOUT
 0x80868018

	)

246 
	#MSR_TMTA_LRTI_VOLT_MHZ
 0x8086801a

	)

	@/usr/include/asm/rwlock.h

17 #i‚de‡
_ASM_I386_RWLOCK_H


18 
	#_ASM_I386_RWLOCK_H


	)

20 
	#RW_LOCK_BIAS
 0x01000000

	)

21 
	#RW_LOCK_BIAS_STR
 "0x01000000"

	)

23 
	#__buûd_ªad_lock_±r
(
rw
, 
hñ≥r
) \

24 
asm
 vﬁ©ûe(
LOCK
 "subl $1,(%0)\n\t" \

27 
	`LOCK_SECTION_START
("") \

28 "2:\tˇŒ " 
hñ≥r
 "\n\t" \

30 
LOCK_SECTION_END
 \

31 ::"a" (
rw
Ë: "mem‹y")

	)

33 
	#__buûd_ªad_lock_c⁄°
(
rw
, 
hñ≥r
) \

34 
asm
 vﬁ©ûe(
LOCK
 "subl $1,%0\n\t" \

37 
	`LOCK_SECTION_START
("") \

40 "ˇŒ " 
hñ≥r
 "\n\t" \

43 
LOCK_SECTION_END
 \

44 :"=m" (*(vﬁ©ûê*)
rw
Ë: : "mem‹y")

	)

46 
	#__buûd_ªad_lock
(
rw
, 
hñ≥r
) do { \

47 i‡(
	`__buûtö_c⁄°™t_p
(
rw
)) \

48 
	`__buûd_ªad_lock_c⁄°
(
rw
, 
hñ≥r
); \

50 
	`__buûd_ªad_lock_±r
(
rw
, 
hñ≥r
); \

51 } 0)

	)

53 
	#__buûd_wrôe_lock_±r
(
rw
, 
hñ≥r
) \

54 
asm
 vﬁ©ûe(
LOCK
 "sub»$" 
RW_LOCK_BIAS_STR
 ",(%0)\n\t" \

57 
	`LOCK_SECTION_START
("") \

58 "2:\tˇŒ " 
hñ≥r
 "\n\t" \

60 
LOCK_SECTION_END
 \

61 ::"a" (
rw
Ë: "mem‹y")

	)

63 
	#__buûd_wrôe_lock_c⁄°
(
rw
, 
hñ≥r
) \

64 
asm
 vﬁ©ûe(
LOCK
 "sub»$" 
RW_LOCK_BIAS_STR
 ",%0\n\t" \

67 
	`LOCK_SECTION_START
("") \

70 "ˇŒ " 
hñ≥r
 "\n\t" \

73 
LOCK_SECTION_END
 \

74 :"=m" (*(vﬁ©ûê*)
rw
Ë: : "mem‹y")

	)

76 
	#__buûd_wrôe_lock
(
rw
, 
hñ≥r
) do { \

77 i‡(
	`__buûtö_c⁄°™t_p
(
rw
)) \

78 
	`__buûd_wrôe_lock_c⁄°
(
rw
, 
hñ≥r
); \

80 
	`__buûd_wrôe_lock_±r
(
rw
, 
hñ≥r
); \

81 } 0)

	)

	@/usr/include/asm/rwsem.h

32 #i‚de‡
_I386_RWSEM_H


33 
	#_I386_RWSEM_H


	)

35 #i‚de‡
_LINUX_RWSEM_H


39 #ifde‡
__KERNEL__


41 
	~<löux/li°.h
>

42 
	~<löux/•ölock.h
>

44 
	grw£m_waôî
;

46 
rw_£m≠h‹e
 *
FASTCALL
(
rw£m_down_ªad_Áûed
(rw_£m≠h‹ê*
£m
));

47 
rw_£m≠h‹e
 *
FASTCALL
(
rw£m_down_wrôe_Áûed
(rw_£m≠h‹ê*
£m
));

48 
rw_£m≠h‹e
 *
FASTCALL
(
rw£m_wake
(rw_semaphore *));

49 
rw_£m≠h‹e
 *
FASTCALL
(
rw£m_downgøde_wake
(rw_£m≠h‹ê*
£m
));

54 
	srw_£m≠h‹e
 {

55 sig√d 
	mcou¡
;

56 
	#RWSEM_UNLOCKED_VALUE
 0x00000000

	)

57 
	#RWSEM_ACTIVE_BIAS
 0x00000001

	)

58 
	#RWSEM_ACTIVE_MASK
 0x0000ffff

	)

59 
	#RWSEM_WAITING_BIAS
 (-0x00010000)

	)

60 
	#RWSEM_ACTIVE_READ_BIAS
 
RWSEM_ACTIVE_BIAS


	)

61 
	#RWSEM_ACTIVE_WRITE_BIAS
 (
RWSEM_WAITING_BIAS
 + 
RWSEM_ACTIVE_BIAS
)

	)

62 
•ölock_t
 
	mwaô_lock
;

63 
li°_hód
 
	mwaô_li°
;

64 #i‡
RWSEM_DEBUG


65 
	mdebug
;

72 #i‡
RWSEM_DEBUG


73 
	#__RWSEM_DEBUG_INIT
 , 0

	)

75 
	#__RWSEM_DEBUG_INIT


	)

78 
	#__RWSEM_INITIALIZER
(
«me
) \

79 { 
RWSEM_UNLOCKED_VALUE
, 
SPIN_LOCK_UNLOCKED
, 
	`LIST_HEAD_INIT
((
«me
).
waô_li°
) \

80 
__RWSEM_DEBUG_INIT
 }

	)

82 
	#DECLARE_RWSEM
(
«me
) \

83 
rw_£m≠h‹e
 
«me
 = 
	`__RWSEM_INITIALIZER
“ame)

	)

85 
ölöe
 
	$öô_rw£m
(
rw_£m≠h‹e
 *
£m
)

87 
£m
->
cou¡
 = 
RWSEM_UNLOCKED_VALUE
;

88 
	`•ö_lock_öô
(&
£m
->
waô_lock
);

89 
	`INIT_LIST_HEAD
(&
£m
->
waô_li°
);

90 #i‡
RWSEM_DEBUG


91 
£m
->
debug
 = 0;

93 
	}
}

98 
ölöe
 
	$__down_ªad
(
rw_£m≠h‹e
 *
£m
)

100 
__asm__
 
	`__vﬁ©ûe__
(

102 
LOCK_PREFIX
 " incl (%%eax)\n\t"

105 
	`LOCK_SECTION_START
("")

113 
LOCK_SECTION_END


115 : "=m"(
£m
->
cou¡
)

116 : "a"(
£m
), "m"(£m->
cou¡
)

118 
	}
}

123 
ölöe
 
	$__down_ªad_åylock
(
rw_£m≠h‹e
 *
£m
)

125 
__s32
 
ªsu…
, 
tmp
;

126 
__asm__
 
	`__vﬁ©ûe__
(

133 
LOCK_PREFIX
 " cmpxchgl %2,%0\n\t"

137 : "+m"(
£m
->
cou¡
), "=&a"(
ªsu…
), "=&r"(
tmp
)

138 : "i"(
RWSEM_ACTIVE_READ_BIAS
)

140  
ªsu…
>=0 ? 1 : 0;

141 
	}
}

146 
ölöe
 
	$__down_wrôe
(
rw_£m≠h‹e
 *
£m
)

148 
tmp
;

150 
tmp
 = 
RWSEM_ACTIVE_WRITE_BIAS
;

151 
__asm__
 
	`__vﬁ©ûe__
(

153 
LOCK_PREFIX
 " xadd %%edx,(%%eax)\n\t"

157 
	`LOCK_SECTION_START
("")

163 
LOCK_SECTION_END


165 : "=m"(
£m
->
cou¡
), "=d"(
tmp
)

166 : "a"(
£m
), "1"(
tmp
), "m"(£m->
cou¡
)

168 
	}
}

173 
ölöe
 
	$__down_wrôe_åylock
(
rw_£m≠h‹e
 *
£m
)

175 sig√d 
ªt
 = 
	`cmpxchg
(&
£m
->
cou¡
,

176 
RWSEM_UNLOCKED_VALUE
,

177 
RWSEM_ACTIVE_WRITE_BIAS
);

178 i‡(
ªt
 =
RWSEM_UNLOCKED_VALUE
)

181 
	}
}

186 
ölöe
 
	$__up_ªad
(
rw_£m≠h‹e
 *
£m
)

188 
__s32
 
tmp
 = -
RWSEM_ACTIVE_READ_BIAS
;

189 
__asm__
 
	`__vﬁ©ûe__
(

191 
LOCK_PREFIX
 " xadd %%edx,(%%eax)\n\t"

194 
	`LOCK_SECTION_START
("")

202 
LOCK_SECTION_END


204 : "=m"(
£m
->
cou¡
), "=d"(
tmp
)

205 : "a"(
£m
), "1"(
tmp
), "m"(£m->
cou¡
)

207 
	}
}

212 
ölöe
 
	$__up_wrôe
(
rw_£m≠h‹e
 *
£m
)

214 
__asm__
 
	`__vﬁ©ûe__
(

217 
LOCK_PREFIX
 " xaddl %%edx,(%%eax)\n\t"

220 
	`LOCK_SECTION_START
("")

228 
LOCK_SECTION_END


230 : "=m"(
£m
->
cou¡
)

231 : "a"(
£m
), "i"(-
RWSEM_ACTIVE_WRITE_BIAS
), "m"(£m->
cou¡
)

233 
	}
}

238 
ölöe
 
	$__downgøde_wrôe
(
rw_£m≠h‹e
 *
£m
)

240 
__asm__
 
	`__vﬁ©ûe__
(

242 
LOCK_PREFIX
 "áddl %2,(%%eax)\n\t"

245 
	`LOCK_SECTION_START
("")

253 
LOCK_SECTION_END


255 : "=m"(
£m
->
cou¡
)

256 : "a"(
£m
), "i"(-
RWSEM_WAITING_BIAS
), "m"(£m->
cou¡
)

258 
	}
}

263 
ölöe
 
	$rw£m_©omic_add
(
dñè
, 
rw_£m≠h‹e
 *
£m
)

265 
__asm__
 
	`__vﬁ©ûe__
(

266 
LOCK_PREFIX
 "addl %1,%0"

267 : "=m"(
£m
->
cou¡
)

268 : "ú"(
dñè
), "m"(
£m
->
cou¡
));

269 
	}
}

274 
ölöe
 
	$rw£m_©omic_upd©e
(
dñè
, 
rw_£m≠h‹e
 *
£m
)

276 
tmp
 = 
dñè
;

278 
__asm__
 
	`__vﬁ©ûe__
(

279 
LOCK_PREFIX
 "xadd %0,(%2)"

280 : "+r"(
tmp
), "=m"(
£m
->
cou¡
)

281 : "r"(
£m
), "m"(£m->
cou¡
)

284  
tmp
+
dñè
;

285 
	}
}

	@/usr/include/asm/termbits.h

1 #i‚de‡
__ARCH_I386_TERMBITS_H__


2 
	#__ARCH_I386_TERMBITS_H__


	)

4 
	~<löux/posix_ty≥s.h
>

6 
	tcc_t
;

7 
	t•ìd_t
;

8 
	ttcÊag_t
;

10 
	#NCCS
 19

	)

11 
	sãrmios
 {

12 
tcÊag_t
 
	mc_iÊag
;

13 
tcÊag_t
 
	mc_oÊag
;

14 
tcÊag_t
 
	mc_cÊag
;

15 
tcÊag_t
 
	mc_lÊag
;

16 
cc_t
 
	mc_löe
;

17 
cc_t
 
	mc_cc
[
NCCS
];

21 
	#VINTR
 0

	)

22 
	#VQUIT
 1

	)

23 
	#VERASE
 2

	)

24 
	#VKILL
 3

	)

25 
	#VEOF
 4

	)

26 
	#VTIME
 5

	)

27 
	#VMIN
 6

	)

28 
	#VSWTC
 7

	)

29 
	#VSTART
 8

	)

30 
	#VSTOP
 9

	)

31 
	#VSUSP
 10

	)

32 
	#VEOL
 11

	)

33 
	#VREPRINT
 12

	)

34 
	#VDISCARD
 13

	)

35 
	#VWERASE
 14

	)

36 
	#VLNEXT
 15

	)

37 
	#VEOL2
 16

	)

40 
	#IGNBRK
 0000001

	)

41 
	#BRKINT
 0000002

	)

42 
	#IGNPAR
 0000004

	)

43 
	#PARMRK
 0000010

	)

44 
	#INPCK
 0000020

	)

45 
	#ISTRIP
 0000040

	)

46 
	#INLCR
 0000100

	)

47 
	#IGNCR
 0000200

	)

48 
	#ICRNL
 0000400

	)

49 
	#IUCLC
 0001000

	)

50 
	#IXON
 0002000

	)

51 
	#IXANY
 0004000

	)

52 
	#IXOFF
 0010000

	)

53 
	#IMAXBEL
 0020000

	)

56 
	#OPOST
 0000001

	)

57 
	#OLCUC
 0000002

	)

58 
	#ONLCR
 0000004

	)

59 
	#OCRNL
 0000010

	)

60 
	#ONOCR
 0000020

	)

61 
	#ONLRET
 0000040

	)

62 
	#OFILL
 0000100

	)

63 
	#OFDEL
 0000200

	)

64 
	#NLDLY
 0000400

	)

65 
	#NL0
 0000000

	)

66 
	#NL1
 0000400

	)

67 
	#CRDLY
 0003000

	)

68 
	#CR0
 0000000

	)

69 
	#CR1
 0001000

	)

70 
	#CR2
 0002000

	)

71 
	#CR3
 0003000

	)

72 
	#TABDLY
 0014000

	)

73 
	#TAB0
 0000000

	)

74 
	#TAB1
 0004000

	)

75 
	#TAB2
 0010000

	)

76 
	#TAB3
 0014000

	)

77 
	#XTABS
 0014000

	)

78 
	#BSDLY
 0020000

	)

79 
	#BS0
 0000000

	)

80 
	#BS1
 0020000

	)

81 
	#VTDLY
 0040000

	)

82 
	#VT0
 0000000

	)

83 
	#VT1
 0040000

	)

84 
	#FFDLY
 0100000

	)

85 
	#FF0
 0000000

	)

86 
	#FF1
 0100000

	)

89 
	#CBAUD
 0010017

	)

90 
	#B0
 0000000

	)

91 
	#B50
 0000001

	)

92 
	#B75
 0000002

	)

93 
	#B110
 0000003

	)

94 
	#B134
 0000004

	)

95 
	#B150
 0000005

	)

96 
	#B200
 0000006

	)

97 
	#B300
 0000007

	)

98 
	#B600
 0000010

	)

99 
	#B1200
 0000011

	)

100 
	#B1800
 0000012

	)

101 
	#B2400
 0000013

	)

102 
	#B4800
 0000014

	)

103 
	#B9600
 0000015

	)

104 
	#B19200
 0000016

	)

105 
	#B38400
 0000017

	)

106 
	#EXTA
 
B19200


	)

107 
	#EXTB
 
B38400


	)

108 
	#CSIZE
 0000060

	)

109 
	#CS5
 0000000

	)

110 
	#CS6
 0000020

	)

111 
	#CS7
 0000040

	)

112 
	#CS8
 0000060

	)

113 
	#CSTOPB
 0000100

	)

114 
	#CREAD
 0000200

	)

115 
	#PARENB
 0000400

	)

116 
	#PARODD
 0001000

	)

117 
	#HUPCL
 0002000

	)

118 
	#CLOCAL
 0004000

	)

119 
	#CBAUDEX
 0010000

	)

120 
	#B57600
 0010001

	)

121 
	#B115200
 0010002

	)

122 
	#B230400
 0010003

	)

123 
	#B460800
 0010004

	)

124 
	#B500000
 0010005

	)

125 
	#B576000
 0010006

	)

126 
	#B921600
 0010007

	)

127 
	#B1000000
 0010010

	)

128 
	#B1152000
 0010011

	)

129 
	#B1500000
 0010012

	)

130 
	#B2000000
 0010013

	)

131 
	#B2500000
 0010014

	)

132 
	#B3000000
 0010015

	)

133 
	#B3500000
 0010016

	)

134 
	#B4000000
 0010017

	)

135 
	#CIBAUD
 002003600000

	)

136 
	#CMSPAR
 010000000000

	)

137 
	#CRTSCTS
 020000000000

	)

140 
	#ISIG
 0000001

	)

141 
	#ICANON
 0000002

	)

142 
	#XCASE
 0000004

	)

143 
	#ECHO
 0000010

	)

144 
	#ECHOE
 0000020

	)

145 
	#ECHOK
 0000040

	)

146 
	#ECHONL
 0000100

	)

147 
	#NOFLSH
 0000200

	)

148 
	#TOSTOP
 0000400

	)

149 
	#ECHOCTL
 0001000

	)

150 
	#ECHOPRT
 0002000

	)

151 
	#ECHOKE
 0004000

	)

152 
	#FLUSHO
 0010000

	)

153 
	#PENDIN
 0040000

	)

154 
	#IEXTEN
 0100000

	)

157 
	#TCOOFF
 0

	)

158 
	#TCOON
 1

	)

159 
	#TCIOFF
 2

	)

160 
	#TCION
 3

	)

163 
	#TCIFLUSH
 0

	)

164 
	#TCOFLUSH
 1

	)

165 
	#TCIOFLUSH
 2

	)

168 
	#TCSANOW
 0

	)

169 
	#TCSADRAIN
 1

	)

170 
	#TCSAFLUSH
 2

	)

	@/usr/include/asm/thread_info.h

7 #i‚de‡
_ASM_THREAD_INFO_H


8 
	#_ASM_THREAD_INFO_H


	)

10 #ifde‡
__KERNEL__


12 #i‚de‡
__ASSEMBLY__


13 
	~<asm/¥o˚ss‹.h
>

22 #i‚de‡
__ASSEMBLY__


24 
	sthªad_öfo
 {

25 
èsk_°ru˘
 *
	mèsk
;

26 
exec_domaö
 *
	mexec_domaö
;

27 
	mÊags
;

28 
	m°©us
;

29 
__u32
 
	m˝u
;

30 
__s32
 
	m¥ìm±_cou¡
;

32 
mm_£gmít_t
 
	maddr_limô
;

36 
ª°¨t_block
 
	mª°¨t_block
;

38 
__u8
 
	msu≥rvis‹_°ack
[0];

44 
	#TI_TASK
 0x00000000

	)

45 
	#TI_EXEC_DOMAIN
 0x00000004

	)

46 
	#TI_FLAGS
 0x00000008

	)

47 
	#TI_STATUS
 0x0000000C

	)

48 
	#TI_CPU
 0x00000010

	)

49 
	#TI_PRE_COUNT
 0x00000014

	)

50 
	#TI_ADDR_LIMIT
 0x00000018

	)

51 
	#TI_RESTART_BLOCK
 0x000001C

	)

55 
	#PREEMPT_ACTIVE
 0x4000000

	)

62 #i‚de‡
__ASSEMBLY__


64 
	#INIT_THREAD_INFO
(
tsk
) \

66 .
èsk
 = &
tsk
, \

67 .
exec_domaö
 = &
deÁu…_exec_domaö
, \

68 .
Êags
 = 0, \

69 .
˝u
 = 0, \

70 .
¥ìm±_cou¡
 = 1, \

71 .
addr_limô
 = 
KERNEL_DS
, \

72 .
ª°¨t_block
 = { \

73 .
‚
 = 
do_no_ª°¨t_sysˇŒ
, \

75 }

	)

77 
	#öô_thªad_öfo
 (
öô_thªad_uni⁄
.
thªad_öfo
)

	)

78 
	#öô_°ack
 (
öô_thªad_uni⁄
.
°ack
)

	)

81 
ölöe
 
thªad_öfo
 *
	$cuºít_thªad_öfo
()

83 
thªad_öfo
 *
ti
;

84 
	`__asm__
("™d»%%e•,%0; ":"Ù" (
ti
) : "0" (~8191UL));

85  
ti
;

86 
	}
}

89 
	#THREAD_SIZE
 (2*
PAGE_SIZE
)

	)

90 
	#Æloc_thªad_öfo
(
èsk
Ë((
thªad_öfo
 *)
	`kmÆloc
(
THREAD_SIZE
, 
GFP_KERNEL
))

	)

91 
	#‰ì_thªad_öfo
(
öfo
Ë
	`k‰ì
(öfo)

	)

92 
	#gë_thªad_öfo
(
ti
Ë
	`gë_èsk_°ru˘
(—i)->
èsk
)

	)

93 
	#put_thªad_öfo
(
ti
Ë
	`put_èsk_°ru˘
(—i)->
èsk
)

	)

98 
	#GET_THREAD_INFO
(
ªg
) \

99 
movl
 
$
-8192, 
ªg
; \

100 
™dl
 %
e•
, 
ªg


	)

110 
	#TIF_SYSCALL_TRACE
 0

	)

111 
	#TIF_NOTIFY_RESUME
 1

	)

112 
	#TIF_SIGPENDING
 2

	)

113 
	#TIF_NEED_RESCHED
 3

	)

114 
	#TIF_SINGLESTEP
 4

	)

115 
	#TIF_IRET
 5

	)

116 
	#TIF_POLLING_NRFLAG
 16

	)

118 
	#_TIF_SYSCALL_TRACE
 (1<<
TIF_SYSCALL_TRACE
)

	)

119 
	#_TIF_NOTIFY_RESUME
 (1<<
TIF_NOTIFY_RESUME
)

	)

120 
	#_TIF_SIGPENDING
 (1<<
TIF_SIGPENDING
)

	)

121 
	#_TIF_NEED_RESCHED
 (1<<
TIF_NEED_RESCHED
)

	)

122 
	#_TIF_SINGLESTEP
 (1<<
TIF_SINGLESTEP
)

	)

123 
	#_TIF_IRET
 (1<<
TIF_IRET
)

	)

124 
	#_TIF_POLLING_NRFLAG
 (1<<
TIF_POLLING_NRFLAG
)

	)

126 
	#_TIF_WORK_MASK
 0x0000FFFE

	)

127 
	#_TIF_ALLWORK_MASK
 0x0000FFFF

	)

136 
	#TS_USEDFPU
 0x0001

	)

	@/usr/include/asm/timex.h

6 #i‚de‡
_ASMi386_TIMEX_H


7 
	#_ASMi386_TIMEX_H


	)

9 
	~<löux/c⁄fig.h
>

10 
	~<asm/m§.h
>

12 #ifde‡
CONFIG_X86_PC9800


13 
CLOCK_TICK_RATE
;

15 #ifde‡
CONFIG_MELAN


16 
	#CLOCK_TICK_RATE
 1189200

	)

18 
	#CLOCK_TICK_RATE
 1193182

	)

22 
	#CLOCK_TICK_FACTOR
 20

	)

23 
	#FINETUNE
 (((((()
LATCH
 * 
HZ
 - 
CLOCK_TICK_RATE
Ë<< 
SHIFT_HZ
) * \

24 (1000000/
CLOCK_TICK_FACTOR
Ë/ (
CLOCK_TICK_RATE
/CLOCK_TICK_FACTOR)) \

25 << (
SHIFT_SCALE
-
SHIFT_HZ
)Ë/ 
HZ
)

	)

41 
	tcy˛es_t
;

43 
cy˛es_t
 
ˇcheÊush_time
;

45 
ölöe
 
cy˛es_t
 
	$gë_cy˛es
 ()

47 #i‚de‡
CONFIG_X86_TSC


50 
ªt
;

52 
	`rdts˛l
(
ªt
);

53  
ªt
;

55 
	}
}

57 
˝u_khz
;

	@/usr/include/asm/vm86.h

1 #i‚de‡
_LINUX_VM86_H


2 
	#_LINUX_VM86_H


	)

15 
	#TF_MASK
 0x00000100

	)

16 
	#IF_MASK
 0x00000200

	)

17 
	#IOPL_MASK
 0x00003000

	)

18 
	#NT_MASK
 0x00004000

	)

19 
	#VM_MASK
 0x00020000

	)

20 
	#AC_MASK
 0x00040000

	)

21 
	#VIF_MASK
 0x00080000

	)

22 
	#VIP_MASK
 0x00100000

	)

23 
	#ID_MASK
 0x00200000

	)

25 
	#BIOSSEG
 0x0f000

	)

27 
	#CPU_086
 0

	)

28 
	#CPU_186
 1

	)

29 
	#CPU_286
 2

	)

30 
	#CPU_386
 3

	)

31 
	#CPU_486
 4

	)

32 
	#CPU_586
 5

	)

37 
	#VM86_TYPE
(
ªtvÆ
Ë(‘ëvÆË& 0xff)

	)

38 
	#VM86_ARG
(
ªtvÆ
Ë(‘ëvÆË>> 8)

	)

40 
	#VM86_SIGNAL
 0

	)

41 
	#VM86_UNKNOWN
 1

	)

42 
	#VM86_INTx
 2

	)

43 
	#VM86_STI
 3

	)

48 
	#VM86_PICRETURN
 4

	)

49 
	#VM86_TRAP
 6

	)

54 
	#VM86_PLUS_INSTALL_CHECK
 0

	)

55 
	#VM86_ENTER
 1

	)

56 
	#VM86_ENTER_NO_BYPASS
 2

	)

57 
	#VM86_REQUEST_IRQ
 3

	)

58 
	#VM86_FREE_IRQ
 4

	)

59 
	#VM86_GET_IRQ_BITS
 5

	)

60 
	#VM86_GET_AND_RESET_IRQ
 6

	)

68 
	svm86_ªgs
 {

72 
	mebx
;

73 
	mecx
;

74 
	medx
;

75 
	mesi
;

76 
	medi
;

77 
	mebp
;

78 
	móx
;

79 
	m__nuŒ_ds
;

80 
	m__nuŒ_es
;

81 
	m__nuŒ_fs
;

82 
	m__nuŒ_gs
;

83 
	m‹ig_óx
;

84 
	meù
;

85 
	mcs
, 
	m__csh
;

86 
	meÊags
;

87 
	me•
;

88 
	mss
, 
	m__ssh
;

92 
	mes
, 
	m__esh
;

93 
	mds
, 
	m__dsh
;

94 
	mfs
, 
	m__fsh
;

95 
	mgs
, 
	m__gsh
;

98 
	sªve˘‹ed_°ru˘
 {

99 
	m__m≠
[8];

102 
	svm86_°ru˘
 {

103 
vm86_ªgs
 
	mªgs
;

104 
	mÊags
;

105 
	ms¸ìn_bôm≠
;

106 
	m˝u_ty≥
;

107 
ªve˘‹ed_°ru˘
 
	möt_ªve˘‹ed
;

108 
ªve˘‹ed_°ru˘
 
	möt21_ªve˘‹ed
;

114 
	#VM86_SCREEN_BITMAP
 0x0001

	)

116 
	svm86∂us_öfo_°ru˘
 {

117 
	mf‹˚_ªtu∫_f‹_pic
:1;

118 
	mvm86dbg_a˘ive
:1;

119 
	mvm86dbg_TF≥ndig
:1;

120 
	munu£d
:28;

121 
	mis_vm86pus
:1;

122 
	mvm86dbg_ötxxèb
[32];

125 
	svm86∂us_°ru˘
 {

126 
vm86_ªgs
 
	mªgs
;

127 
	mÊags
;

128 
	ms¸ìn_bôm≠
;

129 
	m˝u_ty≥
;

130 
ªve˘‹ed_°ru˘
 
	möt_ªve˘‹ed
;

131 
ªve˘‹ed_°ru˘
 
	möt21_ªve˘‹ed
;

132 
vm86∂us_öfo_°ru˘
 
	mvm86∂us
;

135 #ifde‡
__KERNEL__


145 
	skî√l_vm86_ªgs
 {

149 
	mebx
;

150 
	mecx
;

151 
	medx
;

152 
	mesi
;

153 
	medi
;

154 
	mebp
;

155 
	móx
;

156 
	m__nuŒ_ds
;

157 
	m__nuŒ_es
;

158 
	m‹ig_óx
;

159 
	meù
;

160 
	mcs
, 
	m__csh
;

161 
	meÊags
;

162 
	me•
;

163 
	mss
, 
	m__ssh
;

167 
	mes
, 
	m__esh
;

168 
	mds
, 
	m__dsh
;

169 
	mfs
, 
	m__fsh
;

170 
	mgs
, 
	m__gsh
;

173 
	skî√l_vm86_°ru˘
 {

174 
kî√l_vm86_ªgs
 
	mªgs
;

183 
	#VM86_TSS_ESP0
 
Êags


	)

184 
	mÊags
;

185 
	ms¸ìn_bôm≠
;

186 
	m˝u_ty≥
;

187 
ªve˘‹ed_°ru˘
 
	möt_ªve˘‹ed
;

188 
ªve˘‹ed_°ru˘
 
	möt21_ªve˘‹ed
;

189 
vm86∂us_öfo_°ru˘
 
	mvm86∂us
;

190 
±_ªgs
 *
	mªgs32
;

203 
h™dÀ_vm86_Áu…
(
kî√l_vm86_ªgs
 *, );

204 
h™dÀ_vm86_å≠
(
kî√l_vm86_ªgs
 *, , );

	@/usr/include/linux/byteorder/generic.h

1 #i‚de‡
_LINUX_BYTEORDER_GENERIC_H


2 
	#_LINUX_BYTEORDER_GENERIC_H


	)

82 #i‡
deföed
(
__KERNEL__
)

87 
	#˝u_to_À64
 
__˝u_to_À64


	)

88 
	#À64_to_˝u
 
__À64_to_˝u


	)

89 
	#˝u_to_À32
 
__˝u_to_À32


	)

90 
	#À32_to_˝u
 
__À32_to_˝u


	)

91 
	#˝u_to_À16
 
__˝u_to_À16


	)

92 
	#À16_to_˝u
 
__À16_to_˝u


	)

93 
	#˝u_to_be64
 
__˝u_to_be64


	)

94 
	#be64_to_˝u
 
__be64_to_˝u


	)

95 
	#˝u_to_be32
 
__˝u_to_be32


	)

96 
	#be32_to_˝u
 
__be32_to_˝u


	)

97 
	#˝u_to_be16
 
__˝u_to_be16


	)

98 
	#be16_to_˝u
 
__be16_to_˝u


	)

99 
	#˝u_to_À64p
 
__˝u_to_À64p


	)

100 
	#À64_to_˝up
 
__À64_to_˝up


	)

101 
	#˝u_to_À32p
 
__˝u_to_À32p


	)

102 
	#À32_to_˝up
 
__À32_to_˝up


	)

103 
	#˝u_to_À16p
 
__˝u_to_À16p


	)

104 
	#À16_to_˝up
 
__À16_to_˝up


	)

105 
	#˝u_to_be64p
 
__˝u_to_be64p


	)

106 
	#be64_to_˝up
 
__be64_to_˝up


	)

107 
	#˝u_to_be32p
 
__˝u_to_be32p


	)

108 
	#be32_to_˝up
 
__be32_to_˝up


	)

109 
	#˝u_to_be16p
 
__˝u_to_be16p


	)

110 
	#be16_to_˝up
 
__be16_to_˝up


	)

111 
	#˝u_to_À64s
 
__˝u_to_À64s


	)

112 
	#À64_to_˝us
 
__À64_to_˝us


	)

113 
	#˝u_to_À32s
 
__˝u_to_À32s


	)

114 
	#À32_to_˝us
 
__À32_to_˝us


	)

115 
	#˝u_to_À16s
 
__˝u_to_À16s


	)

116 
	#À16_to_˝us
 
__À16_to_˝us


	)

117 
	#˝u_to_be64s
 
__˝u_to_be64s


	)

118 
	#be64_to_˝us
 
__be64_to_˝us


	)

119 
	#˝u_to_be32s
 
__˝u_to_be32s


	)

120 
	#be32_to_˝us
 
__be32_to_˝us


	)

121 
	#˝u_to_be16s
 
__˝u_to_be16s


	)

122 
	#be16_to_˝us
 
__be16_to_˝us


	)

126 #i‡
deföed
(
__KERNEL__
)

141 #unde‡
¡ohl


142 #unde‡
¡ohs


143 #unde‡
ht⁄l


144 #unde‡
ht⁄s


150 
__u32
 
¡ohl
(__u32);

151 
__u32
 
ht⁄l
(__u32);

152 
¡ohs
();

153 
ht⁄s
();

155 #i‡
deföed
(
__GNUC__
Ë&& (__GNUC__ >2Ë&& deföed(
__OPTIMIZE__
)

157 
	#___ht⁄l
(
x
Ë
	`__˝u_to_be32
(x)

	)

158 
	#___ht⁄s
(
x
Ë
	`__˝u_to_be16
(x)

	)

159 
	#___¡ohl
(
x
Ë
	`__be32_to_˝u
(x)

	)

160 
	#___¡ohs
(
x
Ë
	`__be16_to_˝u
(x)

	)

162 
	#ht⁄l
(
x
Ë
	`___ht⁄l
(x)

	)

163 
	#¡ohl
(
x
Ë
	`___¡ohl
(x)

	)

164 
	#ht⁄s
(
x
Ë
	`___ht⁄s
(x)

	)

165 
	#¡ohs
(
x
Ë
	`___¡ohs
(x)

	)

	@/usr/include/linux/byteorder/swab.h

1 #i‚de‡
_LINUX_BYTEORDER_SWAB_H


2 
	#_LINUX_BYTEORDER_SWAB_H


	)

21 
	#___swab16
(
x
) \

22 
	`__exãnsi⁄__
 ({ \

23 
__u16
 
__x
 = (
x
); \

24 ((
__u16
)( \

25 (((
__u16
)(
__x
) & (__u16)0x00ffU) << 8) | \

26 (((
__u16
)(
__x
) & (__u16)0xff00U) >> 8) )); \

27 })

	)

29 
	#___swab32
(
x
) \

30 
	`__exãnsi⁄__
 ({ \

31 
__u32
 
__x
 = (
x
); \

32 ((
__u32
)( \

33 (((
__u32
)(
__x
) & (__u32)0x000000ffUL) << 24) | \

34 (((
__u32
)(
__x
) & (__u32)0x0000ff00UL) << 8) | \

35 (((
__u32
)(
__x
) & (__u32)0x00ff0000UL) >> 8) | \

36 (((
__u32
)(
__x
) & (__u32)0xff000000UL) >> 24) )); \

37 })

	)

39 
	#___swab64
(
x
) \

40 
	`__exãnsi⁄__
 ({ \

41 
__u64
 
__x
 = (
x
); \

42 ((
__u64
)( \

43 (
__u64
)(((__u64)(
__x
) & (__u64)0x00000000000000ffULL) << 56) | \

44 (
__u64
)(((__u64)(
__x
) & (__u64)0x000000000000ff00ULL) << 40) | \

45 (
__u64
)(((__u64)(
__x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

46 (
__u64
)(((__u64)(
__x
) & (__u64)0x00000000ff000000ULL) << 8) | \

47 (
__u64
)(((__u64)(
__x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

48 (
__u64
)(((__u64)(
__x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

49 (
__u64
)(((__u64)(
__x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

50 (
__u64
)(((__u64)(
__x
) & (__u64)0xff00000000000000ULL) >> 56) )); \

51 })

	)

53 
	#___c⁄°™t_swab16
(
x
) \

54 ((
__u16
)( \

55 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

56 (((
__u16
)(
x
Ë& (__u16)0xff00UË>> 8Ë))

	)

57 
	#___c⁄°™t_swab32
(
x
) \

58 ((
__u32
)( \

59 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

60 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

61 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

62 (((
__u32
)(
x
Ë& (__u32)0xff000000ULË>> 24Ë))

	)

63 
	#___c⁄°™t_swab64
(
x
) \

64 ((
__u64
)( \

65 (
__u64
)(((__u64)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

66 (
__u64
)(((__u64)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

67 (
__u64
)(((__u64)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

68 (
__u64
)(((__u64)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

69 (
__u64
)(((__u64)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

70 (
__u64
)(((__u64)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

71 (
__u64
)(((__u64)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

72 (
__u64
)(((__u64)(
x
Ë& (__u64)0xff00000000000000ULLË>> 56Ë))

	)

77 #i‚de‡
__¨ch__swab16


78 
	#__¨ch__swab16
(
x
Ë
	`__exãnsi⁄__
 ({ 
__u16
 
__tmp
 = (xË; 
	`___swab16
(__tmp); })

	)

80 #i‚de‡
__¨ch__swab32


81 
	#__¨ch__swab32
(
x
Ë
	`__exãnsi⁄__
 ({ 
__u32
 
__tmp
 = (xË; 
	`___swab32
(__tmp); })

	)

83 #i‚de‡
__¨ch__swab64


84 
	#__¨ch__swab64
(
x
Ë
	`__exãnsi⁄__
 ({ 
__u64
 
__tmp
 = (xË; 
	`___swab64
(__tmp); })

	)

87 #i‚de‡
__¨ch__swab16p


88 
	#__¨ch__swab16p
(
x
Ë
	`__¨ch__swab16
(*(x))

	)

90 #i‚de‡
__¨ch__swab32p


91 
	#__¨ch__swab32p
(
x
Ë
	`__¨ch__swab32
(*(x))

	)

93 #i‚de‡
__¨ch__swab64p


94 
	#__¨ch__swab64p
(
x
Ë
	`__¨ch__swab64
(*(x))

	)

97 #i‚de‡
__¨ch__swab16s


98 
	#__¨ch__swab16s
(
x
Ëdÿ{ *(xË
	`__¨ch__swab16p
((x)); } 0)

	)

100 #i‚de‡
__¨ch__swab32s


101 
	#__¨ch__swab32s
(
x
Ëdÿ{ *(xË
	`__¨ch__swab32p
((x)); } 0)

	)

103 #i‚de‡
__¨ch__swab64s


104 
	#__¨ch__swab64s
(
x
Ëdÿ{ *(xË
	`__¨ch__swab64p
((x)); } 0)

	)

111 #i‡
deföed
(
__GNUC__
Ë&& (__GNUC__ >2Ë&& deföed(
__OPTIMIZE__
)

112 
	#__swab16
(
x
) \

113 (
	`__buûtö_c⁄°™t_p
((
__u16
)(
x
)) ? \

114 
	`___swab16
((
x
)) : \

115 
	`__fswab16
((
x
)))

	)

116 
	#__swab32
(
x
) \

117 (
	`__buûtö_c⁄°™t_p
((
__u32
)(
x
)) ? \

118 
	`___swab32
((
x
)) : \

119 
	`__fswab32
((
x
)))

	)

120 
	#__swab64
(
x
) \

121 (
	`__buûtö_c⁄°™t_p
((
__u64
)(
x
)) ? \

122 
	`___swab64
((
x
)) : \

123 
	`__fswab64
((
x
)))

	)

125 
	#__swab16
(
x
Ë
	`__fswab16
(x)

	)

126 
	#__swab32
(
x
Ë
	`__fswab32
(x)

	)

127 
	#__swab64
(
x
Ë
	`__fswab64
(x)

	)

131 
__ölöe__
 
__u16
 
	$__fswab16
(
__u16
 
x
)

133  
	`__¨ch__swab16
(
x
);

134 
	}
}

135 
__ölöe__
 
__u16
 
	$__swab16p
(
__u16
 *
x
)

137  
	`__¨ch__swab16p
(
x
);

138 
	}
}

139 
__ölöe__
 
	$__swab16s
(
__u16
 *
addr
)

141 
	`__¨ch__swab16s
(
addr
);

142 
	}
}

144 
__ölöe__
 
__u32
 
	$__fswab32
(
__u32
 
x
)

146  
	`__¨ch__swab32
(
x
);

147 
	}
}

148 
__ölöe__
 
__u32
 
	$__swab32p
(
__u32
 *
x
)

150  
	`__¨ch__swab32p
(
x
);

151 
	}
}

152 
__ölöe__
 
	$__swab32s
(
__u32
 *
addr
)

154 
	`__¨ch__swab32s
(
addr
);

155 
	}
}

157 #i‚de‡
__STRICT_ANSI__


158 #ifde‡
__BYTEORDER_HAS_U64__


159 
__ölöe__
 
__u64
 
	$__fswab64
(
__u64
 
x
)

161 #ifde‡
__SWAB_64_THRU_32__


162 
__u32
 
h
 = 
x
 >> 32;

163 
__u32
 
l
 = 
x
 & ((1ULL<<32)-1);

164  (((
__u64
)
	`__swab32
(
l
)Ë<< 32Ë| ((__u64)(__swab32(
h
)));

166  
	`__¨ch__swab64
(
x
);

168 
	}
}

169 
__ölöe__
 
__u64
 
	$__swab64p
(
__u64
 *
x
)

171  
	`__¨ch__swab64p
(
x
);

172 
	}
}

173 
__ölöe__
 
	$__swab64s
(
__u64
 *
addr
)

175 
	`__¨ch__swab64s
(
addr
);

176 
	}
}

180 #i‡
deföed
(
__KERNEL__
)

181 
	#swab16
 
__swab16


	)

182 
	#swab32
 
__swab32


	)

183 
	#swab64
 
__swab64


	)

184 
	#swab16p
 
__swab16p


	)

185 
	#swab32p
 
__swab32p


	)

186 
	#swab64p
 
__swab64p


	)

187 
	#swab16s
 
__swab16s


	)

188 
	#swab32s
 
__swab32s


	)

189 
	#swab64s
 
__swab64s


	)

	@/usr/include/linux/compiler-gcc+.h

7 
	~<löux/compûî-gcc.h
>

9 
	#ölöe
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

10 
	#__ölöe__
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

11 
	#__ölöe
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

12 
	#__dïªˇãd
 
	`__©åibuã__
((
dïªˇãd
))

	)

13 
	#__©åibuã_u£d__
 
	`__©åibuã__
((
__u£d__
))

	)

14 
	#__©åibuã_puª__
 
	`__©åibuã__
((
puª
))

	)

	@/usr/include/linux/compiler-gcc2.h

9 
	~<löux/compûî-gcc.h
>

11 #i‡
__GNUC_MINOR__
 < 96

12 
	#__buûtö_ex≥˘
(
x
, 
ex≥˘ed_vÆue
Ë(x)

	)

15 
	#__©åibuã_u£d__
 
	`__©åibuã__
((
__unu£d__
))

	)

21 #i‡
__GNUC_MINOR__
 >= 96

22 
	#__©åibuã_puª__
 
	`__©åibuã__
((
puª
))

	)

	@/usr/include/linux/compiler-gcc3.h

4 
	~<löux/compûî-gcc.h
>

6 #i‡
__GNUC_MINOR__
 >= 1

7 
	#ölöe
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

8 
	#__ölöe__
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

9 
	#__ölöe
 
__ölöe__
 
	`__©åibuã__
((
Æways_ölöe
))

	)

12 #i‡
__GNUC_MINOR__
 > 0

13 
	#__dïªˇãd
 
	`__©åibuã__
((
dïªˇãd
))

	)

16 #i‡
__GNUC_MINOR__
 >= 3

17 
	#__©åibuã_u£d__
 
	`__©åibuã__
((
__u£d__
))

	)

19 
	#__©åibuã_u£d__
 
	`__©åibuã__
((
__unu£d__
))

	)

22 
	#__©åibuã_puª__
 
	`__©åibuã__
((
puª
))

	)

	@/usr/include/linux/compiler-intel.h

3 #ifde‡
__ECC


9 
	~<asm/öåösics.h
>

14 #unde‡
b¨rõr


15 #unde‡
RELOC_HIDE


17 
	#b¨rõr
(Ë
	`__mem‹y_b¨rõr
()

	)

19 
	#RELOC_HIDE
(
±r
, 
off
) \

20 ({ 
__±r
; \

21 
__±r
 = (Ë(
±r
); \

22 (
	`ty≥of
(
±r
)Ë(
__±r
 + (
off
)); })

	)

	@/usr/include/linux/cpumask.h

1 #i‚de‡
__LINUX_CPUMASK_H


2 
	#__LINUX_CPUMASK_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<löux/kî√l.h
>

6 
	~<löux/thªads.h
>

7 
	~<löux/ty≥s.h
>

8 
	~<löux/bôm≠.h
>

10 #i‡
NR_CPUS
 > 
BITS_PER_LONG
 && NR_CPUS != 1

11 
	#CPU_ARRAY_SIZE
 
	`BITS_TO_LONGS
(
NR_CPUS
)

	)

13 
	s˝umask


15 
	mmask
[
CPU_ARRAY_SIZE
];

18 
˝umask
 
	t˝umask_t
;

21 
	t˝umask_t
;

24 #ifde‡
CONFIG_SMP


25 #i‡
NR_CPUS
 > 
BITS_PER_LONG


26 
	~<asm-gíîic/˝umask_¨øy.h
>

28 
	~<asm-gíîic/˝umask_¨ôh.h
>

31 
	~<asm-gíîic/˝umask_up.h
>

34 #i‡
NR_CPUS
 <4*
BITS_PER_LONG


35 
	~<asm-gíîic/˝umask_c⁄°_vÆue.h
>

37 
	~<asm-gíîic/˝umask_c⁄°_ª„ªn˚.h
>

41 #ifde‡
CONFIG_SMP


43 
˝umask_t
 
˝u_⁄löe_m≠
;

45 
	#num_⁄löe_˝us
(Ë
	`˝us_weight
(
˝u_⁄löe_m≠
)

	)

46 
	#˝u_⁄löe
(
˝u
Ë
	`˝u_is£t
(˝u, 
˝u_⁄löe_m≠
)

	)

48 
	#˝u_⁄löe_m≠
 
	`˝umask_of_˝u
(0)

	)

49 
	#num_⁄löe_˝us
(Ë1

	)

50 
	#˝u_⁄löe
(
˝u
Ë({ 
	`BUG_ON
((˝uË!0); 1; })

	)

53 
ölöe
 
	$√xt_⁄löe_˝u
(
˝u
, 
˝umask_t
 
m≠
)

56 
˝u
 = 
	`√xt_˝u_c⁄°
(˝u, 
m≠
);

57 
˝u
 < 
NR_CPUS
 && !
	`˝u_⁄löe
(cpu));

58  
˝u
;

59 
	}
}

61 
	#f‹_óch_˝u
(
˝u
, 
m≠
) \

62 
˝u
 = 
	`fú°_˝u_c⁄°
(
m≠
); \

63 
˝u
 < 
NR_CPUS
; \

64 
˝u
 = 
	`√xt_˝u_c⁄°
(˝u,
m≠
))

	)

66 
	#f‹_óch_⁄löe_˝u
(
˝u
, 
m≠
) \

67 
˝u
 = 
	`fú°_˝u_c⁄°
(
m≠
); \

68 
˝u
 < 
NR_CPUS
; \

69 
˝u
 = 
	`√xt_⁄löe_˝u
(˝u,
m≠
))

	)

	@/usr/include/linux/module.h

1 #i‚de‡
_LINUX_MODULE_H


2 
	#_LINUX_MODULE_H


	)

9 
	~<löux/c⁄fig.h
>

10 
	~<löux/sched.h
>

11 
	~<löux/•ölock.h
>

12 
	~<löux/li°.h
>

13 
	~<löux/°©.h
>

14 
	~<löux/compûî.h
>

15 
	~<löux/ˇche.h
>

16 
	~<löux/kmod.h
>

17 
	~<löux/ñf.h
>

18 
	~<löux/°rögify.h
>

19 
	~<asm/loˇl.h
>

21 
	~<asm/moduÀ.h
>

24 
	#MODULE_SUPPORTED_DEVICE
(
«me
)

	)

25 
	#¥öt_moduÀs
()

	)

28 #i‚de‡
MODULE_SYMBOL_PREFIX


29 
	#MODULE_SYMBOL_PREFIX
 ""

	)

32 
	#MODULE_NAME_LEN
 (64 - ())

	)

34 
	skî√l_symbﬁ


36 
	mvÆue
;

37 c⁄° *
	m«me
;

40 
	smodvîsi⁄_öfo


42 
	m¸c
;

43 
	m«me
[
MODULE_NAME_LEN
];

47 
öô_moduÀ
();

48 
˛ónup_moduÀ
();

51 
	gex˚±i⁄_èbÀ_íåy
;

53 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *

54 
£¨ch_exèbÀ
(c⁄° 
ex˚±i⁄_èbÀ_íåy
 *
fú°
,

55 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *
œ°
,

56 
vÆue
);

58 #ifde‡
MODULE


59 
	#___moduÀ_ˇt
(
a
,
b
Ë
__mod_
 ##á ## 
	)
b

60 
	#__moduÀ_ˇt
(
a
,
b
Ë
	`___moduÀ_ˇt
◊,b)

	)

61 
	#__MODULE_INFO
(
èg
, 
«me
, 
öfo
) \

62 c⁄° 
	`__moduÀ_ˇt
(
«me
,
__LINE__
)[] \

63 
	`__©åibuã__
((
	`£˘i⁄
(".modöfo"),
unu£d
)Ë
	`__°rögify
(
èg
Ë"=" 
öfo


	)

65 
	#MODULE_GENERIC_TABLE
(
gty≥
,
«me
) \

66 c⁄° 
gty≥
##
_id
 
__mod_
##gty≥##
_èbÀ
 \

67 
	`__©åibuã__
 ((
unu£d
, 
	`Æüs
(
	`__°rögify
(
«me
))))

	)

69 
	#THIS_MODULE
 (&
__this_moduÀ
)

	)

73 
	#MODULE_GENERIC_TABLE
(
gty≥
,
«me
)

	)

74 
	#__MODULE_INFO
(
èg
, 
«me
, 
öfo
)

	)

75 
	#THIS_MODULE
 ((
moduÀ
 *)0)

	)

79 
	#MODULE_INFO
(
èg
, 
öfo
Ë
	`__MODULE_INFO
—ag,Åag, info)

	)

82 
	#MODULE_ALIAS
(
_Æüs
Ë
	`MODULE_INFO
(
Æüs
, _Æüs)

	)

110 
	#MODULE_LICENSE
(
_li˚n£
Ë
	`MODULE_INFO
(
li˚n£
, _li˚n£)

	)

113 
	#MODULE_AUTHOR
(
_auth‹
Ë
	`MODULE_INFO
(
auth‹
, _auth‹)

	)

116 
	#MODULE_DESCRIPTION
(
_des¸ùti⁄
Ë
	`MODULE_INFO
(
des¸ùti⁄
, _des¸ùti⁄)

	)

120 
	#MODULE_PARM_DESC
(
_∑rm
, 
desc
) \

121 
	`__MODULE_INFO
(
∑rm
, 
_∑rm
, #_∑rm ":" 
desc
)

	)

123 
	#MODULE_DEVICE_TABLE
(
ty≥
,
«me
) \

124 
	`MODULE_GENERIC_TABLE
(
ty≥
##
_devi˚
,
«me
)

	)

127 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *
£¨ch_ex˚±i⁄_èbÀs
(
add
);

129 
	gnŸifõr_block
;

131 #ifde‡
CONFIG_MODULES


134 *
__symbﬁ_gë
(c⁄° *
symbﬁ
);

135 *
__symbﬁ_gë_g∂
(c⁄° *
symbﬁ
);

136 
	#symbﬁ_gë
(
x
Ë((
	`ty≥of
(&x))(
	`__symbﬁ_gë
(
MODULE_SYMBOL_PREFIX
 #x)))

	)

138 #i‚de‡
__GENKSYMS__


139 #ifde‡
CONFIG_MODVERSIONS


142 
	#__CRC_SYMBOL
(
sym
, 
£c
) \

143 *
__¸c_
##
sym
 
	`__©åibuã__
((
wók
)); \

144 c⁄° 
__k¸˘ab_
##
sym
 \

145 
	`__©åibuã__
((
	`£˘i⁄
("__k¸˘ab" 
£c
), 
unu£d
)) \

146 (Ë&
__¸c_
##
sym
;

	)

148 
	#__CRC_SYMBOL
(
sym
, 
£c
)

	)

152 
	#__EXPORT_SYMBOL
(
sym
, 
£c
) \

153 
	`__CRC_SYMBOL
(
sym
, 
£c
) \

154 c⁄° 
__k°πab_
##
sym
[] \

155 
	`__©åibuã__
((
	`£˘i⁄
("__ksymtab_strings"))) \

156 
MODULE_SYMBOL_PREFIX
 #sym; \

157 c⁄° 
kî√l_symbﬁ
 
__ksymèb_
##
sym
 \

158 
	`__©åibuã__
((
	`£˘i⁄
("__ksymèb" 
£c
), 
unu£d
)) \

159 { ()&
sym
, 
__k°πab_
##sym }

	)

161 
	#EXPORT_SYMBOL
(
sym
) \

162 
	`__EXPORT_SYMBOL
(
sym
, "")

	)

164 
	#EXPORT_SYMBOL_GPL
(
sym
) \

165 
	`__EXPORT_SYMBOL
(
sym
, "_g∂")

	)

171 
	#EXPORT_SYMBOL_NOVERS
(
sym
Ë
	`EXPORT_SYMBOL
(sym)

	)

173 
	smoduÀ_ªf


175 
loˇl_t
 
	mcou¡
;

176 } 
	g____ˇchñöe_Æig√d
;

178 
	emoduÀ_°©e


180 
	mMODULE_STATE_LIVE
,

181 
	mMODULE_STATE_COMING
,

182 
	mMODULE_STATE_GOING
,

185 
	smoduÀ


187 
moduÀ_°©e
 
	m°©e
;

190 
li°_hód
 
	mli°
;

193 
	m«me
[
MODULE_NAME_LEN
];

196 c⁄° 
kî√l_symbﬁ
 *
	msyms
;

197 
	mnum_syms
;

198 c⁄° *
	m¸cs
;

201 c⁄° 
kî√l_symbﬁ
 *
	mg∂_syms
;

202 
	mnum_g∂_syms
;

203 c⁄° *
	mg∂_¸cs
;

206 
	mnum_exíåõs
;

207 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *
	mexèbÀ
;

210 (*
	möô
)();

213 *
	mmoduÀ_öô
;

216 *
	mmoduÀ_c‹e
;

219 
	möô_size
, 
	mc‹e_size
;

222 
	möô_ãxt_size
, 
	mc‹e_ãxt_size
;

225 
mod_¨ch_•ecific
 
	m¨ch
;

228 
	munß„
;

231 
	mli˚n£_g∂ok
;

233 #ifde‡
CONFIG_MODULE_UNLOAD


235 
moduÀ_ªf
 
	mªf
[
NR_CPUS
];

238 
li°_hód
 
	mmoduÀs_which_u£_me
;

241 
èsk_°ru˘
 *
	mwaôî
;

244 (*
	mexô
)();

247 #ifde‡
CONFIG_KALLSYMS


249 
Elf_Sym
 *
	msymèb
;

250 
	mnum_symèb
;

251 *
	m°πab
;

255 *
	m≥r˝u
;

259 *
	m¨gs
;

265 
ölöe
 
	$moduÀ_is_live
(
moduÀ
 *
mod
)

267  
mod
->
°©e
 !
MODULE_STATE_GOING
;

268 
	}
}

271 
moduÀ
 *
moduÀ_ãxt_addªss
(
addr
);

275 
moduÀ
 *
moduÀ_gë_kÆlsym
(
symnum
,

276 *
vÆue
,

277 *
ty≥
,

278 
«mebuf
[128]);

279 
is_exp‹ãd
(c⁄° *
«me
, c⁄° 
moduÀ
 *
mod
);

281 
	$__moduÀ_put_™d_exô
(
moduÀ
 *
mod
, 
code
)

282 
	`__©åibuã__
((
n‹ëu∫
));

283 
	#moduÀ_put_™d_exô
(
code
Ë
	`__moduÀ_put_™d_exô
(
THIS_MODULE
, code);

	)

285 #ifde‡
CONFIG_MODULE_UNLOAD


286 
	`moduÀ_ªfcou¡
(
moduÀ
 *
mod
);

287 
	`__symbﬁ_put
(c⁄° *
symbﬁ
);

288 
	#symbﬁ_put
(
x
Ë
	`__symbﬁ_put
(
MODULE_SYMBOL_PREFIX
 #x)

	)

289 
	`symbﬁ_put_addr
(*
addr
);

293 
ölöe
 
	$__moduÀ_gë
(
moduÀ
 *module)

295 i‡(
moduÀ
) {

296 
	`BUG_ON
(
	`moduÀ_ªfcou¡
(
moduÀ
) == 0);

297 
	`loˇl_öc
(&
moduÀ
->
ªf
[
	`gë_˝u
()].
cou¡
);

298 
	`put_˝u
();

300 
	}
}

302 
ölöe
 
	$åy_moduÀ_gë
(
moduÀ
 *module)

304 
ªt
 = 1;

306 i‡(
moduÀ
) {

307 
˝u
 = 
	`gë_˝u
();

308 i‡(
	`likñy
(
	`moduÀ_is_live
(
moduÀ
)))

309 
	`loˇl_öc
(&
moduÀ
->
ªf
[
˝u
].
cou¡
);

311 
ªt
 = 0;

312 
	`put_˝u
();

314  
ªt
;

315 
	}
}

317 
ölöe
 
	$moduÀ_put
(
moduÀ
 *module)

319 i‡(
moduÀ
) {

320 
˝u
 = 
	`gë_˝u
();

321 
	`loˇl_dec
(&
moduÀ
->
ªf
[
˝u
].
cou¡
);

323 i‡(
	`u∆ikñy
(!
	`moduÀ_is_live
(
moduÀ
)))

324 
	`wake_up_¥o˚ss
(
moduÀ
->
waôî
);

325 
	`put_˝u
();

327 
	}
}

330 
ölöe
 
	$åy_moduÀ_gë
(
moduÀ
 *module)

332  !
moduÀ
 || 
	`moduÀ_is_live
(module);

333 
	}
}

334 
ölöe
 
	$moduÀ_put
(
moduÀ
 *module)

336 
	}
}

337 
ölöe
 
	$__moduÀ_gë
(
moduÀ
 *module)

339 
	}
}

340 
	#symbﬁ_put
(
x
Ëdÿ{ } 0)

	)

341 
	#symbﬁ_put_addr
(
p
Ëdÿ{ } 0)

	)

346 
	#moduÀ_«me
(
mod
) \

348 
moduÀ
 *
__mod
 = (
mod
); \

349 
__mod
 ? __mod->
«me
 : "kernel"; \

350 })

	)

352 
	#__unß„
(
mod
) \

354 i‡(
mod
 && !(mod)->
unß„
) { \

355 
	`¥ötk
(
KERN_WARNING
 \

357 " %s:%u\n", (
mod
)->
«me
, 
__FILE__
, 
__LINE__
); \

358 (
mod
)->
unß„
 = 1; \

360 } 0)

	)

363 c⁄° *
moduÀ_addªss_lookup
(
addr
,

364 *
symbﬁsize
,

365 *
off£t
,

366 **
mod«me
);

369 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *
£¨ch_moduÀ_exèbÀs
(
addr
);

371 
ªgi°î_moduÀ_nŸifõr
(
nŸifõr_block
 * 
nb
);

372 
uƒegi°î_moduÀ_nŸifõr
(
nŸifõr_block
 * 
nb
);

375 
	#EXPORT_SYMBOL
(
sym
)

	)

376 
	#EXPORT_SYMBOL_GPL
(
sym
)

	)

377 
	#EXPORT_SYMBOL_NOVERS
(
sym
)

	)

380 
ölöe
 c⁄° 
ex˚±i⁄_èbÀ_íåy
 *

381 
	$£¨ch_moduÀ_exèbÀs
(
addr
)

383  
NULL
;

384 
	}
}

387 
ölöe
 
moduÀ
 *
	$moduÀ_ãxt_addªss
(
addr
)

389  
NULL
;

390 
	}
}

393 
	#symbﬁ_gë
(
x
Ë({ 
	`ty≥of
(xËx 
	`__©åibuã__
((
wók
)); &(x); })

	)

394 
	#symbﬁ_put
(
x
Ëdÿ{ } 0)

	)

395 
	#symbﬁ_put_addr
(
x
Ëdÿ{ } 0)

	)

397 
ölöe
 
	$__moduÀ_gë
(
moduÀ
 *module)

399 
	}
}

401 
ölöe
 
	$åy_moduÀ_gë
(
moduÀ
 *module)

404 
	}
}

406 
ölöe
 
	$moduÀ_put
(
moduÀ
 *module)

408 
	}
}

410 
	#moduÀ_«me
(
mod
Ë"kî√l"

	)

412 
	#__unß„
(
mod
)

	)

415 
ölöe
 c⁄° *
	$moduÀ_addªss_lookup
(
addr
,

416 *
symbﬁsize
,

417 *
off£t
,

418 **
mod«me
)

420  
NULL
;

421 
	}
}

423 
ölöe
 
moduÀ
 *
moduÀ_gë_kÆlsym
(
symnum
,

424 *
vÆue
,

425 *
ty≥
,

426 
«mebuf
[128])

428  
	gNULL
;

431 
ölöe
 
	$is_exp‹ãd
(c⁄° *
«me
, c⁄° 
moduÀ
 *
mod
)

434 
	}
}

436 
ölöe
 
	$ªgi°î_moduÀ_nŸifõr
(
nŸifõr_block
 * 
nb
)

440 
	}
}

442 
ölöe
 
	$uƒegi°î_moduÀ_nŸifõr
(
nŸifõr_block
 * 
nb
)

445 
	}
}

447 
	#moduÀ_put_™d_exô
(
code
Ë
	`do_exô
(code)

	)

451 #ifde‡
MODULE


452 
moduÀ
 
__this_moduÀ
;

453 #ifde‡
KBUILD_MODNAME


455 
moduÀ
 
__this_moduÀ


456 
__©åibuã__
((
£˘i⁄
(".gnu.linkonce.this_module"))) = {

457 .
«me
 = 
__°rögify
(
KBUILD_MODNAME
),

458 .
	göô
 = 
öô_moduÀ
,

459 #ifde‡
CONFIG_MODULE_UNLOAD


460 .
	gexô
 = 
˛ónup_moduÀ
,

466 
	#symbﬁ_ªque°
(
x
Ë
	`åy_thí_ªque°_moduÀ
(
	`symbﬁ_gë
(x), "symbﬁ:" #x)

	)

470 
	sobsﬁëe_mod∑rm
 {

471 
	m«me
[64];

472 
	mty≥
[64-(*)];

473 *
	maddr
;

475 #ifde‡
MODULE


477 
	#MODULE_PARM
(
v¨
,
ty≥
) \

478 
obsﬁëe_mod∑rm
 
__∑rm_
##
v¨
 
	`__©åibuã__
((
	`£˘i⁄
("__obsparm"))) = \

479 { 
	`__°rögify
(
v¨
), 
ty≥
 };

	)

481 
ölöe
 
__dïªˇãd
 
	$MOD_INC_USE_COUNT
(
moduÀ
 *module)

483 
	`__unß„
(
moduÀ
);

485 #i‡
	`deföed
(
CONFIG_MODULE_UNLOAD
Ë&& deföed(
MODULE
)

486 
	`loˇl_öc
(&
moduÀ
->
ªf
[
	`gë_˝u
()].
cou¡
);

487 
	`put_˝u
();

489 ()
	`åy_moduÀ_gë
(
moduÀ
);

491 
	}
}

493 
ölöe
 
__dïªˇãd
 
	$MOD_DEC_USE_COUNT
(
moduÀ
 *module)

495 
	`moduÀ_put
(
moduÀ
);

496 
	}
}

498 
	#MOD_INC_USE_COUNT
 
	`MOD_INC_USE_COUNT
(
THIS_MODULE
)

	)

499 
	#MOD_DEC_USE_COUNT
 
	`MOD_DEC_USE_COUNT
(
THIS_MODULE
)

	)

501 
	#MODULE_PARM
(
v¨
,
ty≥
)

	)

502 
	#MOD_INC_USE_COUNT
 dÿ{ } 0)

	)

503 
	#MOD_DEC_USE_COUNT
 dÿ{ } 0)

	)

506 
	#__MODULE_STRING
(
x
Ë
	`__°rögify
(x)

	)

509 
	#HAVE_INTER_MODULE


	)

510 
öãr_moduÀ_ªgi°î
(c⁄° *, 
moduÀ
 *, const *);

511 
öãr_moduÀ_uƒegi°î
(const *);

512 c⁄° *
öãr_moduÀ_gë
(const *);

513 c⁄° *
öãr_moduÀ_gë_ªque°
(const *, const *);

514 
öãr_moduÀ_put
(const *);

	@/usr/include/linux/percpu.h

1 #i‚de‡
__LINUX_PERCPU_H


2 
	#__LINUX_PERCPU_H


	)

3 
	~<löux/•ölock.h
>

4 
	~<löux/¶ab.h
>

5 
	~<löux/smp.h
>

6 
	~<löux/°rög.h
>

7 
	~<asm/≥r˝u.h
>

10 #i‚de‡
PERCPU_ENOUGH_ROOM


11 
	#PERCPU_ENOUGH_ROOM
 32768

	)

15 
	#gë_˝u_v¨
(
v¨
Ë(*({ 
	`¥ìm±_dißbÀ
(); &
	`__gë_˝u_v¨
(v¨); }))

	)

16 
	#put_˝u_v¨
(
v¨
Ë
	`¥ìm±_íabÀ
()

	)

18 #ifde‡
CONFIG_SMP


20 
	s≥r˝u_d©a
 {

21 *
	m±rs
[
NR_CPUS
];

22 *
	mblkp
;

30 
	#≥r_˝u_±r
(
±r
, 
˝u
) \

32 
≥r˝u_d©a
 *
__p
 = (≥r˝u_d©®*)~()(
±r
); \

33 (
	`__ty≥of__
(
±r
))
__p
->
±rs
[(
˝u
)]; \

34 })

	)

36 *
__Æloc_≥r˝u
(
size_t
 
size
, size_à
Æign
);

37 
‰ì_≥r˝u
(const *);

38 
kmÆloc_≥r˝u_öô
();

42 
	#≥r_˝u_±r
(
±r
, 
˝u
Ë’å)

	)

44 
ölöe
 *
	$__Æloc_≥r˝u
(
size_t
 
size
, size_à
Æign
)

46 *
ªt
 = 
	`kmÆloc
(
size
, 
GFP_KERNEL
);

47 i‡(
ªt
)

48 
	`mem£t
(
ªt
, 0, 
size
);

49  
ªt
;

50 
	}
}

51 
ölöe
 
	$‰ì_≥r˝u
(c⁄° *
±r
)

53 
	`k‰ì
(
±r
);

54 
	}
}

55 
ölöe
 
	$kmÆloc_≥r˝u_öô
(Ë{ 
	}
}

60 
	#Æloc_≥r˝u
(
ty≥
) \

61 ((
ty≥
 *)(
	`__Æloc_≥r˝u
(—y≥), 
	`__Æignof__
—y≥))))

	)

82 
	#gë_˝u_±r
(
±r
Ë
	`≥r_˝u_±r
’å, 
	`gë_˝u
())

	)

83 
	#put_˝u_±r
(
±r
Ë
	`put_˝u
()

	)

	@/usr/include/linux/rwsem-spinlock.h

8 #i‚de‡
_LINUX_RWSEM_SPINLOCK_H


9 
	#_LINUX_RWSEM_SPINLOCK_H


	)

11 #i‚de‡
_LINUX_RWSEM_H


15 
	~<löux/•ölock.h
>

16 
	~<löux/li°.h
>

18 #ifde‡
__KERNEL__


20 
	~<löux/ty≥s.h
>

22 
	grw£m_waôî
;

31 
	srw_£m≠h‹e
 {

32 
__s32
 
	ma˘ivôy
;

33 
•ölock_t
 
	mwaô_lock
;

34 
li°_hód
 
	mwaô_li°
;

35 #i‡
RWSEM_DEBUG


36 
	mdebug
;

43 #i‡
RWSEM_DEBUG


44 
	#__RWSEM_DEBUG_INIT
 , 0

	)

46 
	#__RWSEM_DEBUG_INIT


	)

49 
	#__RWSEM_INITIALIZER
(
«me
) \

50 { 0, 
SPIN_LOCK_UNLOCKED
, 
	`LIST_HEAD_INIT
((
«me
).
waô_li°
Ë
__RWSEM_DEBUG_INIT
 }

	)

52 
	#DECLARE_RWSEM
(
«me
) \

53 
rw_£m≠h‹e
 
«me
 = 
	`__RWSEM_INITIALIZER
“ame)

	)

55 
FASTCALL
(
öô_rw£m
(
rw_£m≠h‹e
 *
£m
));

56 
FASTCALL
(
__down_ªad
(
rw_£m≠h‹e
 *
£m
));

57 
FASTCALL
(
__down_ªad_åylock
(
rw_£m≠h‹e
 *
£m
));

58 
FASTCALL
(
__down_wrôe
(
rw_£m≠h‹e
 *
£m
));

59 
FASTCALL
(
__down_wrôe_åylock
(
rw_£m≠h‹e
 *
£m
));

60 
FASTCALL
(
__up_ªad
(
rw_£m≠h‹e
 *
£m
));

61 
FASTCALL
(
__up_wrôe
(
rw_£m≠h‹e
 *
£m
));

62 
FASTCALL
(
__downgøde_wrôe
(
rw_£m≠h‹e
 *
£m
));

	@/usr/include/linux/sunrpc/msg_prot.h

7 #i‚de‡
_LINUX_SUNRPC_MSGPROT_H_


8 
	#_LINUX_SUNRPC_MSGPROT_H_


	)

10 #ifde‡
__KERNEL__


12 
	#RPC_VERSION
 2

	)

15 
u32
 
	tΩc_authÊav‹_t
;

17 
	eΩc_auth_Êav‹s
 {

18 
	mRPC_AUTH_NULL
 = 0,

19 
	mRPC_AUTH_UNIX
 = 1,

20 
	mRPC_AUTH_SHORT
 = 2,

21 
	mRPC_AUTH_DES
 = 3,

22 
	mRPC_AUTH_KRB
 = 4,

23 
	mRPC_AUTH_GSS
 = 6,

24 
	mRPC_AUTH_MAXFLAVOR
 = 8,

26 
	mRPC_AUTH_GSS_KRB5
 = 390003,

27 
	mRPC_AUTH_GSS_KRB5I
 = 390004,

28 
	mRPC_AUTH_GSS_KRB5P
 = 390005,

29 
	mRPC_AUTH_GSS_LKEY
 = 390006,

30 
	mRPC_AUTH_GSS_LKEYI
 = 390007,

31 
	mRPC_AUTH_GSS_LKEYP
 = 390008,

32 
	mRPC_AUTH_GSS_SPKM
 = 390009,

33 
	mRPC_AUTH_GSS_SPKMI
 = 390010,

34 
	mRPC_AUTH_GSS_SPKMP
 = 390011,

37 
	eΩc_msg_ty≥
 {

38 
	mRPC_CALL
 = 0,

39 
	mRPC_REPLY
 = 1

42 
	eΩc_ª∂y_°©
 {

43 
	mRPC_MSG_ACCEPTED
 = 0,

44 
	mRPC_MSG_DENIED
 = 1

47 
	eΩc_ac˚±_°©
 {

48 
	mRPC_SUCCESS
 = 0,

49 
	mRPC_PROG_UNAVAIL
 = 1,

50 
	mRPC_PROG_MISMATCH
 = 2,

51 
	mRPC_PROC_UNAVAIL
 = 3,

52 
	mRPC_GARBAGE_ARGS
 = 4,

53 
	mRPC_SYSTEM_ERR
 = 5

56 
	eΩc_ªje˘_°©
 {

57 
	mRPC_MISMATCH
 = 0,

58 
	mRPC_AUTH_ERROR
 = 1

61 
	eΩc_auth_°©
 {

62 
	mRPC_AUTH_OK
 = 0,

63 
	mRPC_AUTH_BADCRED
 = 1,

64 
	mRPC_AUTH_REJECTEDCRED
 = 2,

65 
	mRPC_AUTH_BADVERF
 = 3,

66 
	mRPC_AUTH_REJECTEDVERF
 = 4,

67 
	mRPC_AUTH_TOOWEAK
 = 5,

69 
	mRPCSEC_GSS_CREDPROBLEM
 = 13,

70 
	mRPCSEC_GSS_CTXPROBLEM
 = 14

73 
	#RPC_PMAP_PROGRAM
 100000

	)

74 
	#RPC_PMAP_VERSION
 2

	)

75 
	#RPC_PMAP_PORT
 111

	)

77 
	#RPC_MAXNETNAMELEN
 256

	)

	@/usr/include/linux/threads.h

1 #i‚de‡
_LINUX_THREADS_H


2 
	#_LINUX_THREADS_H


	)

4 
	~<löux/c⁄fig.h
>

17 #ifde‡
CONFIG_SMP


18 
	#NR_CPUS
 
CONFIG_NR_CPUS


	)

20 
	#NR_CPUS
 1

	)

23 
	#MIN_THREADS_LEFT_FOR_ROOT
 4

	)

28 
	#PID_MAX_DEFAULT
 0x8000

	)

33 
	#PID_MAX_LIMIT
 (4*1024*1024)

	)

	@/usr/include/wctype.h

24 #i‚de‡
_WCTYPE_H


26 
	~<„©uªs.h
>

27 
	~<bôs/ty≥s.h
>

29 #i‚de‡
__√ed_iswxxx


30 
	#_WCTYPE_H
 1

	)

34 
	#__√ed_wöt_t


	)

35 
	~<°ddef.h
>

36 #i‚de‡
_WINT_T


41 
	#_WINT_T


	)

42 
	twöt_t
;

44 #ifde‡
__USE_ISOC99


45 
	$__USING_NAMESPACE_C99
(
wöt_t
)

47 
__END_NAMESPACE_C99


52 #i‚de‡
WEOF


53 
	#WEOF
 (0xffffffffu)

	)

56 #unde‡
__√ed_iswxxx


61 #i‚de‡
__iswxxx_deföed


62 
	#__iswxxx_deföed
 1

	)

64 
__BEGIN_NAMESPACE_C99


67 
	tw˘y≥_t
;

68 
__END_NAMESPACE_C99


70 #i‚de‡
_ISwbô


75 
	~<ídün.h
>

76 #i‡
__BYTE_ORDER
 =
__BIG_ENDIAN


77 
	#_ISwbô
(
bô
Ë(1 << (bô))

	)

79 
	#_ISwbô
(
bô
) \

80 ((
bô
) < 8 ? () ((1UL << (bit)) << 24) \

81 : ((
bô
) < 16 ? () ((1UL << (bit)) << 8) \

82 : ((
bô
) < 24 ? () ((1UL << (bit)) >> 8) \

83 : (Ë((1UL << (
bô
)Ë>> 24))))

	)

88 
__ISwuµî
 = 0,

89 
__ISwlowî
 = 1,

90 
__ISwÆpha
 = 2,

91 
__ISwdigô
 = 3,

92 
__ISwxdigô
 = 4,

93 
__ISw•a˚
 = 5,

94 
__ISw¥öt
 = 6,

95 
__ISwgøph
 = 7,

96 
__ISwbœnk
 = 8,

97 
__ISw˙ål
 = 9,

98 
__ISwpun˘
 = 10,

99 
__ISwÆnum
 = 11,

101 
_ISwuµî
 = 
	`_ISwbô
 (
__ISwuµî
),

102 
_ISwlowî
 = 
	`_ISwbô
 (
__ISwlowî
),

103 
_ISwÆpha
 = 
	`_ISwbô
 (
__ISwÆpha
),

104 
_ISwdigô
 = 
	`_ISwbô
 (
__ISwdigô
),

105 
_ISwxdigô
 = 
	`_ISwbô
 (
__ISwxdigô
),

106 
_ISw•a˚
 = 
	`_ISwbô
 (
__ISw•a˚
),

107 
_ISw¥öt
 = 
	`_ISwbô
 (
__ISw¥öt
),

108 
_ISwgøph
 = 
	`_ISwbô
 (
__ISwgøph
),

109 
_ISwbœnk
 = 
	`_ISwbô
 (
__ISwbœnk
),

110 
_ISw˙ål
 = 
	`_ISwbô
 (
__ISw˙ål
),

111 
_ISwpun˘
 = 
	`_ISwbô
 (
__ISwpun˘
),

112 
_ISwÆnum
 = 
	`_ISwbô
 (
__ISwÆnum
)

117 
__BEGIN_DECLS


119 
__BEGIN_NAMESPACE_C99


126 
	$iswÆnum
 (
wöt_t
 
__wc
Ë
__THROW
;

132 
	$iswÆpha
 (
wöt_t
 
__wc
Ë
__THROW
;

135 
	$isw˙ål
 (
wöt_t
 
__wc
Ë
__THROW
;

139 
	$iswdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

143 
	$iswgøph
 (
wöt_t
 
__wc
Ë
__THROW
;

148 
	$iswlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

151 
	$isw¥öt
 (
wöt_t
 
__wc
Ë
__THROW
;

156 
	$iswpun˘
 (
wöt_t
 
__wc
Ë
__THROW
;

161 
	$isw•a˚
 (
wöt_t
 
__wc
Ë
__THROW
;

166 
	$iswuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

171 
	$iswxdigô
 (
wöt_t
 
__wc
Ë
__THROW
;

176 #ifde‡
__USE_ISOC99


177 
	$iswbœnk
 (
wöt_t
 
__wc
Ë
__THROW
;

186 
w˘y≥_t
 
	$w˘y≥
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

190 
	$isw˘y≥
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
Ë
__THROW
;

191 
__END_NAMESPACE_C99


198 
__BEGIN_NAMESPACE_C99


201 
__c⁄°
 
	t__öt32_t
 *
	tw˘øns_t
;

202 
__END_NAMESPACE_C99


203 #ifde‡
__USE_GNU


204 
	$__USING_NAMESPACE_C99
(
w˘øns_t
)

207 
__BEGIN_NAMESPACE_C99


209 
wöt_t
 
	$towlowî
 (
wöt_t
 
__wc
Ë
__THROW
;

212 
wöt_t
 
	$towuµî
 (
wöt_t
 
__wc
Ë
__THROW
;

213 
__END_NAMESPACE_C99


215 
__END_DECLS


222 #ifde‡
_WCTYPE_H


228 
__BEGIN_DECLS


230 
__BEGIN_NAMESPACE_C99


233 
w˘øns_t
 
	$w˘øns
 (
__c⁄°
 *
__¥›îty
Ë
__THROW
;

236 
wöt_t
 
	$tow˘øns
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
Ë
__THROW
;

237 
__END_NAMESPACE_C99


239 #ifde‡
__USE_GNU


241 
	~<xloˇÀ.h
>

245 
	$iswÆnum_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

251 
	$iswÆpha_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

254 
	$isw˙ål_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

258 
	$iswdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

262 
	$iswgøph_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

267 
	$iswlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

270 
	$isw¥öt_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

275 
	$iswpun˘_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

280 
	$isw•a˚_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

285 
	$iswuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

290 
	$iswxdigô_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

295 
	$iswbœnk_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

299 
w˘y≥_t
 
	$w˘y≥_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

300 
__THROW
;

304 
	$isw˘y≥_l
 (
wöt_t
 
__wc
, 
w˘y≥_t
 
__desc
, 
__loˇÀ_t
 
__loˇÀ
)

305 
__THROW
;

313 
wöt_t
 
	$towlowî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

316 
wöt_t
 
	$towuµî_l
 (
wöt_t
 
__wc
, 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

320 
w˘øns_t
 
	$w˘øns_l
 (
__c⁄°
 *
__¥›îty
, 
__loˇÀ_t
 
__loˇÀ
)

321 
__THROW
;

324 
wöt_t
 
	$tow˘øns_l
 (
wöt_t
 
__wc
, 
w˘øns_t
 
__desc
,

325 
__loˇÀ_t
 
__loˇÀ
Ë
__THROW
;

329 
__END_DECLS


	@/usr/include/asm-generic/cpumask_arith.h

1 #i‚de‡
__ASM_GENERIC_CPUMASK_ARITH_H


2 
	#__ASM_GENERIC_CPUMASK_ARITH_H


	)

9 
	#˝u_£t
(
˝u
, 
m≠
Ë
	`£t_bô
(˝u, &(m≠))

	)

10 
	#˝u_˛ór
(
˝u
, 
m≠
Ë
	`˛ór_bô
(˝u, &(m≠))

	)

11 
	#˝u_is£t
(
˝u
, 
m≠
Ë
	`ã°_bô
(˝u, &(m≠))

	)

12 
	#˝u_ã°_™d_£t
(
˝u
, 
m≠
Ë
	`ã°_™d_£t_bô
(˝u, &(m≠))

	)

14 
	#˝us_™d
(
d°
,
§c1
,
§c2
Ëdÿ{ d° = (§c1Ë& (§c2); } 0)

	)

15 
	#˝us_‹
(
d°
,
§c1
,
§c2
Ëdÿ{ d° = (§c1Ë| (§c2); } 0)

	)

16 
	#˝us_˛ór
(
m≠
Ëdÿ{ m≠ = 0; } 0)

	)

17 
	#˝us_com∂emít
(
m≠
Ëdÿ{ m≠ = ~(m≠); } 0)

	)

18 
	#˝us_equÆ
(
m≠1
, 
m≠2
Ë((m≠1Ë=(m≠2))

	)

19 
	#˝us_em±y
(
m≠
Ë((m≠Ë=0)

	)

21 #i‡
BITS_PER_LONG
 == 32

22 
	#˝us_weight
(
m≠
Ë
	`hweight32
(m≠)

	)

23 #ñi‡
BITS_PER_LONG
 == 64

24 
	#˝us_weight
(
m≠
Ë
	`hweight64
(m≠)

	)

27 
	#˝us_shi·_right
(
d°
, 
§c
, 
n
Ëdÿ{ d° = (§cË>> (n); } 0)

	)

28 
	#˝us_shi·_À·
(
d°
, 
§c
, 
n
Ëdÿ{ d° = (§cË<< (n); } 0)

	)

30 
	#™y_⁄löe_˝u
(
m≠
) \

32 
˝umask_t
 
__tmp__
; \

33 
	`˝us_™d
(
__tmp__
, 
m≠
, 
˝u_⁄löe_m≠
); \

34 
__tmp__
 ? 
	`fú°_˝u
(__tmp__Ë: 
NR_CPUS
; \

35 })

	)

37 
	#CPU_MASK_ALL
 (~((
˝umask_t
)0Ë>> (8*(˝umask_tË- 
NR_CPUS
))

	)

38 
	#CPU_MASK_NONE
 ((
˝umask_t
)0)

	)

41 
	#˝us_c€r˚
(
m≠
Ë(()(m≠))

	)

42 
	#˝us_¥omŸe
(
m≠
Ë({ m≠; })

	)

43 
	#˝umask_of_˝u
(
˝u
Ë({ ((
˝umask_t
)1Ë<< (˝u); })

	)

45 
	#fú°_˝u
(
m≠
Ë
	`__ffs
(m≠)

	)

46 
	#√xt_˝u
(
˝u
, 
m≠
Ë
	`föd_√xt_bô
(&(m≠), 
NR_CPUS
, cpu + 1)

	)

	@/usr/include/asm-generic/cpumask_array.h

1 #i‚de‡
__ASM_GENERIC_CPUMASK_ARRAY_H


2 
	#__ASM_GENERIC_CPUMASK_ARRAY_H


	)

10 
	#CPU_ARRAY_SIZE
 
	`BITS_TO_LONGS
(
NR_CPUS
)

	)

12 
	#˝u_£t
(
˝u
, 
m≠
Ë
	`£t_bô
(˝u, (m≠).
mask
)

	)

13 
	#˝u_˛ór
(
˝u
, 
m≠
Ë
	`˛ór_bô
(˝u, (m≠).
mask
)

	)

14 
	#˝u_is£t
(
˝u
, 
m≠
Ë
	`ã°_bô
(˝u, (m≠).
mask
)

	)

15 
	#˝u_ã°_™d_£t
(
˝u
, 
m≠
Ë
	`ã°_™d_£t_bô
(˝u, (m≠).
mask
)

	)

17 
	#˝us_™d
(
d°
,
§c1
,
§c2
Ë
	`bôm≠_™d
((d°).
mask
,(§c1).mask, (§c2).mask, 
NR_CPUS
)

	)

18 
	#˝us_‹
(
d°
,
§c1
,
§c2
Ë
	`bôm≠_‹
((d°).
mask
, (§c1).mask, (§c2).mask, 
NR_CPUS
)

	)

19 
	#˝us_˛ór
(
m≠
Ë
	`bôm≠_˛ór
((m≠).
mask
, 
NR_CPUS
)

	)

20 
	#˝us_com∂emít
(
m≠
Ë
	`bôm≠_com∂emít
((m≠).
mask
, 
NR_CPUS
)

	)

21 
	#˝us_equÆ
(
m≠1
, 
m≠2
Ë
	`bôm≠_equÆ
((m≠1).
mask
, (m≠2).mask, 
NR_CPUS
)

	)

22 
	#˝us_em±y
(
m≠
Ë
	`bôm≠_em±y
(m≠.
mask
, 
NR_CPUS
)

	)

23 
	#˝us_weight
(
m≠
Ë
	`bôm≠_weight
((m≠).
mask
, 
NR_CPUS
)

	)

24 
	#˝us_shi·_right
(
d
, 
s
, 
n
Ë
	`bôm≠_shi·_right
((d).
mask
, (s).mask,Ç, 
NR_CPUS
)

	)

25 
	#˝us_shi·_À·
(
d
, 
s
, 
n
Ë
	`bôm≠_shi·_À·
((d).
mask
, (s).mask,Ç, 
NR_CPUS
)

	)

26 
	#fú°_˝u
(
m≠
Ë
	`föd_fú°_bô
((m≠).
mask
, 
NR_CPUS
)

	)

27 
	#√xt_˝u
(
˝u
, 
m≠
Ë
	`föd_√xt_bô
((m≠).
mask
, 
NR_CPUS
, cpu + 1)

	)

30 
	#˝us_c€r˚
(
m≠
Ë((m≠).
mask
[0])

	)

31 
	#˝us_¥omŸe
(
m≠
Ë({ 
˝umask_t
 
__˝u_mask
 = 
CPU_MASK_NONE
;\

32 
__˝u_mask
.
mask
[0] = 
m≠
; \

33 
__˝u_mask
; \

34 })

	)

35 
	#˝umask_of_˝u
(
˝u
Ë({ 
˝umask_t
 
__˝u_mask
 = 
CPU_MASK_NONE
;\

36 
	`˝u_£t
(
˝u
, 
__˝u_mask
); \

37 
__˝u_mask
; \

38 })

	)

39 
	#™y_⁄löe_˝u
(
m≠
) \

41 
˝umask_t
 
__tmp__
; \

42 
	`˝us_™d
(
__tmp__
, 
m≠
, 
˝u_⁄löe_m≠
); \

43 
	`föd_fú°_bô
(
__tmp__
.
mask
, 
NR_CPUS
); \

44 })

	)

50 
	#CPU_MASK_ALL
 { {[0 ... 
CPU_ARRAY_SIZE
-1] = ~0UL} }

	)

51 
	#CPU_MASK_NONE
 { {[0 ... 
CPU_ARRAY_SIZE
-1] = 0UL} }

	)

	@/usr/include/asm-generic/cpumask_const_reference.h

1 #i‚de‡
__ASM_GENERIC_CPUMASK_CONST_REFERENCE_H


2 
	#__ASM_GENERIC_CPUMASK_CONST_REFERENCE_H


	)

4 
	s˝umask_ªf
 {

5 c⁄° 
˝umask_t
 *
	mvÆ
;

8 c⁄° 
	t˝umask_ªf
 
	t˝umask_c⁄°_t
;

10 
	#mk_˝umask_c⁄°
(
m≠
Ë((
˝umask_c⁄°_t
){ &(m≠Ë})

	)

11 
	#˝u_is£t_c⁄°
(
˝u
, 
m≠
Ë
	`˝u_is£t
(˝u, *(m≠).
vÆ
)

	)

13 
	#˝us_™d_c⁄°
(
d°
,
§c1
,
§c2
Ë
	`˝us_™d
(d°,*(§c1).
vÆ
,*(§c2).vÆ)

	)

14 
	#˝us_‹_c⁄°
(
d°
,
§c1
,
§c2
Ë
	`˝us_‹
(d°,*(§c1).
vÆ
,*(§c2).vÆ)

	)

16 
	#˝us_equÆ_c⁄°
(
m≠1
, 
m≠2
Ë
	`˝us_equÆ
(*(m≠1).
vÆ
, *(m≠2).vÆ)

	)

18 
	#˝us_c›y_c⁄°
(
m≠1
, 
m≠2
Ë
	`bôm≠_c›y
((m≠1).
mask
, (m≠2).
vÆ
->mask, 
NR_CPUS
)

	)

20 
	#˝us_em±y_c⁄°
(
m≠
Ë
	`˝us_em±y
(*(m≠).
vÆ
)

	)

21 
	#˝us_weight_c⁄°
(
m≠
Ë
	`˝us_weight
(*(m≠).
vÆ
)

	)

22 
	#fú°_˝u_c⁄°
(
m≠
Ë
	`fú°_˝u
(*(m≠).
vÆ
)

	)

23 
	#√xt_˝u_c⁄°
(
˝u
, 
m≠
Ë
	`√xt_˝u
(˝u, *(m≠).
vÆ
)

	)

26 
	#˝us_c€r˚_c⁄°
(
m≠
Ë
	`˝us_c€r˚
(*(m≠).
vÆ
)

	)

27 
	#™y_⁄löe_˝u_c⁄°
(
m≠
Ë
	`™y_⁄löe_˝u
(*(m≠).
vÆ
)

	)

	@/usr/include/asm-generic/cpumask_const_value.h

1 #i‚de‡
__ASM_GENERIC_CPUMASK_CONST_VALUE_H


2 
	#__ASM_GENERIC_CPUMASK_CONST_VALUE_H


	)

4 c⁄° 
	t˝umask_t
 
	t˝umask_c⁄°_t
;

6 
	#mk_˝umask_c⁄°
(
m≠
Ë((
˝umask_c⁄°_t
)(m≠))

	)

7 
	#˝u_is£t_c⁄°
(
˝u
, 
m≠
Ë
	`˝u_is£t
(˝u, m≠)

	)

8 
	#˝us_™d_c⁄°
(
d°
,
§c1
,
§c2
Ë
	`˝us_™d
(d°, src1, src2)

	)

9 
	#˝us_‹_c⁄°
(
d°
,
§c1
,
§c2
Ë
	`˝us_‹
(d°, src1, src2)

	)

10 
	#˝us_equÆ_c⁄°
(
m≠1
, 
m≠2
Ë
	`˝us_equÆ
(m≠1, m≠2)

	)

11 
	#˝us_em±y_c⁄°
(
m≠
Ë
	`˝us_em±y
(m≠)

	)

12 
	#˝us_c›y_c⁄°
(
m≠1
, 
m≠2
Ëdÿ{ m≠1 = (
˝umask_t
)m≠2; } 0)

	)

13 
	#˝us_weight_c⁄°
(
m≠
Ë
	`˝us_weight
(m≠)

	)

14 
	#fú°_˝u_c⁄°
(
m≠
Ë
	`fú°_˝u
(m≠)

	)

15 
	#√xt_˝u_c⁄°
(
˝u
, 
m≠
Ë
	`√xt_˝u
(˝u, m≠)

	)

18 
	#˝us_c€r˚_c⁄°
(
m≠
Ë
	`˝us_c€r˚
(m≠)

	)

19 
	#™y_⁄löe_˝u_c⁄°
(
m≠
Ë
	`™y_⁄löe_˝u
(m≠)

	)

	@/usr/include/asm-generic/cpumask_up.h

1 #i‚de‡
__ASM_GENERIC_CPUMASK_UP_H


2 
	#__ASM_GENERIC_CPUMASK_UP_H


	)

4 
	#˝us_c€r˚
(
m≠
Ë(m≠)

	)

6 
	#˝u_£t
(
˝u
, 
m≠
Ëdÿ{ ()(˝u); 
	`˝us_c€r˚
(m≠Ë1UL; } 0)

	)

7 
	#˝u_˛ór
(
˝u
, 
m≠
Ëdÿ{ ()(˝u); 
	`˝us_c€r˚
(m≠Ë0UL; } 0)

	)

8 
	#˝u_is£t
(
˝u
, 
m≠
Ë(()(˝u), 
	`˝us_c€r˚
(m≠Ë!0UL)

	)

9 
	#˝u_ã°_™d_£t
(
˝u
, 
m≠
Ë(()(˝u), 
	`ã°_™d_£t_bô
(0, &(m≠)))

	)

11 
	#˝us_™d
(
d°
, 
§c1
, 
§c2
) \

13 i‡(
	`˝us_c€r˚
(
§c1
Ë&& cpus_c€r˚(
§c2
)) \

14 
	`˝us_c€r˚
(
d°
) = 1UL; \

16 
	`˝us_c€r˚
(
d°
) = 0UL; \

17 } 0)

	)

19 
	#˝us_‹
(
d°
, 
§c1
, 
§c2
) \

21 i‡(
	`˝us_c€r˚
(
§c1
Ë|| cpus_c€r˚(
§c2
)) \

22 
	`˝us_c€r˚
(
d°
) = 1UL; \

24 
	`˝us_c€r˚
(
d°
) = 0UL; \

25 } 0)

	)

27 
	#˝us_˛ór
(
m≠
Ëdÿ{ 
	`˝us_c€r˚
(m≠Ë0UL; } 0)

	)

29 
	#˝us_com∂emít
(
m≠
) \

31 
	`˝us_c€r˚
(
m≠
) = !cpus_coerce(map); \

32 } 0)

	)

34 
	#˝us_equÆ
(
m≠1
, 
m≠2
Ë(
	`˝us_c€r˚
(m≠1Ë=˝us_c€r˚(m≠2))

	)

35 
	#˝us_em±y
(
m≠
Ë(
	`˝us_c€r˚
(m≠Ë=0UL)

	)

36 
	#˝us_weight
(
m≠
Ë(
	`˝us_c€r˚
(m≠Ë? 1UL : 0UL)

	)

37 
	#˝us_shi·_right
(
d
, 
s
, 
n
Ëdÿ{ 
	`˝us_c€r˚
(dË0UL; } 0)

	)

38 
	#˝us_shi·_À·
(
d
, 
s
, 
n
Ëdÿ{ 
	`˝us_c€r˚
(dË0UL; } 0)

	)

39 
	#fú°_˝u
(
m≠
Ë(
	`˝us_c€r˚
(m≠Ë? 0 : 1)

	)

40 
	#√xt_˝u
(
˝u
, 
m≠
Ë1

	)

43 
	#˝us_¥omŸe
(
m≠
) \

45 
˝umask_t
 
__tmp__
; \

46 
	`˝us_c€r˚
(
__tmp__
Ë
m≠
; \

47 
__tmp__
; \

48 })

	)

49 
	#˝umask_of_˝u
(
˝u
Ë(()(˝u), 
	`˝us_¥omŸe
(1))

	)

50 
	#™y_⁄löe_˝u
(
m≠
Ë(
	`˝us_c€r˚
(m≠Ë? 0 : 1)

	)

55 
	#CPU_MASK_ALL
 1UL

	)

56 
	#CPU_MASK_NONE
 0UL

	)

	@/usr/include/asm-generic/errno-base.h

1 #i‚de‡
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm/local.h

1 #i‚de‡
_ARCH_I386_LOCAL_H


2 
	#_ARCH_I386_LOCAL_H


	)

4 
	~<löux/≥r˝u.h
>

8 vﬁ©ûê
	mcou¡î
;

9 } 
	tloˇl_t
;

11 
	#LOCAL_INIT
(
i
Ë{ (iË}

	)

13 
	#loˇl_ªad
(
v
Ë((v)->
cou¡î
)

	)

14 
	#loˇl_£t
(
v
,
i
Ë(((v)->
cou¡î
Ë(i))

	)

16 
__ölöe__
 
	$loˇl_öc
(
loˇl_t
 *
v
)

18 
__asm__
 
	`__vﬁ©ûe__
(

20 :"=m" (
v
->
cou¡î
)

21 :"m" (
v
->
cou¡î
));

22 
	}
}

24 
__ölöe__
 
	$loˇl_dec
(
loˇl_t
 *
v
)

26 
__asm__
 
	`__vﬁ©ûe__
(

28 :"=m" (
v
->
cou¡î
)

29 :"m" (
v
->
cou¡î
));

30 
	}
}

32 
__ölöe__
 
	$loˇl_add
(
i
, 
loˇl_t
 *
v
)

34 
__asm__
 
	`__vﬁ©ûe__
(

36 :"=m" (
v
->
cou¡î
)

37 :"ú" (
i
), "m" (
v
->
cou¡î
));

38 
	}
}

40 
__ölöe__
 
	$loˇl_sub
(
i
, 
loˇl_t
 *
v
)

42 
__asm__
 
	`__vﬁ©ûe__
(

44 :"=m" (
v
->
cou¡î
)

45 :"ú" (
i
), "m" (
v
->
cou¡î
));

46 
	}
}

49 
	#__loˇl_öc
(
l
Ë
	`loˇl_öc
÷)

	)

50 
	#__loˇl_dec
(
l
Ë
	`loˇl_dec
÷)

	)

51 
	#__loˇl_add
(
i
,
l
Ë
	`loˇl_add
((i),÷))

	)

52 
	#__loˇl_sub
(
i
,
l
Ë
	`loˇl_sub
((i),÷))

	)

58 
	#˝u_loˇl_ªad
(
v
Ë
	`loˇl_ªad
(&
	`__gë_˝u_v¨
(v))

	)

59 
	#˝u_loˇl_£t
(
v
, 
i
Ë
	`loˇl_£t
(&
	`__gë_˝u_v¨
(v), (i))

	)

60 
	#˝u_loˇl_öc
(
v
Ë
	`loˇl_öc
(&
	`__gë_˝u_v¨
(v))

	)

61 
	#˝u_loˇl_dec
(
v
Ë
	`loˇl_dec
(&
	`__gë_˝u_v¨
(v))

	)

62 
	#˝u_loˇl_add
(
i
, 
v
Ë
	`loˇl_add
((i), &
	`__gë_˝u_v¨
(v))

	)

63 
	#˝u_loˇl_sub
(
i
, 
v
Ë
	`loˇl_sub
((i), &
	`__gë_˝u_v¨
(v))

	)

65 
	#__˝u_loˇl_öc
(
v
Ë
	`˝u_loˇl_öc
(v)

	)

66 
	#__˝u_loˇl_dec
(
v
Ë
	`˝u_loˇl_dec
(v)

	)

67 
	#__˝u_loˇl_add
(
i
, 
v
Ë
	`˝u_loˇl_add
((i), (v))

	)

68 
	#__˝u_loˇl_sub
(
i
, 
v
Ë
	`˝u_loˇl_sub
((i), (v))

	)

	@/usr/include/asm/module.h

1 #i‚de‡
_ASM_I386_MODULE_H


2 
	#_ASM_I386_MODULE_H


	)

5 
	smod_¨ch_•ecific


9 
	#Elf_Shdr
 
Elf32_Shdr


	)

10 
	#Elf_Sym
 
Elf32_Sym


	)

11 
	#Elf_Ehdr
 
Elf32_Ehdr


	)

13 #ifde‡
CONFIG_M386


14 
	#MODULE_PROC_FAMILY
 "386 "

	)

15 #ñi‡
deföed
 
CONFIG_M486


16 
	#MODULE_PROC_FAMILY
 "486 "

	)

17 #ñi‡
deföed
 
CONFIG_M586


18 
	#MODULE_PROC_FAMILY
 "586 "

	)

19 #ñi‡
deföed
 
CONFIG_M586TSC


20 
	#MODULE_PROC_FAMILY
 "586TSC "

	)

21 #ñi‡
deföed
 
CONFIG_M586MMX


22 
	#MODULE_PROC_FAMILY
 "586MMX "

	)

23 #ñi‡
deföed
 
CONFIG_M686


24 
	#MODULE_PROC_FAMILY
 "686 "

	)

25 #ñi‡
deföed
 
CONFIG_MPENTIUMII


26 
	#MODULE_PROC_FAMILY
 "PENTIUMII "

	)

27 #ñi‡
deföed
 
CONFIG_MPENTIUMIII


28 
	#MODULE_PROC_FAMILY
 "PENTIUMIII "

	)

29 #ñi‡
deföed
 
CONFIG_MPENTIUM4


30 
	#MODULE_PROC_FAMILY
 "PENTIUM4 "

	)

31 #ñi‡
deföed
 
CONFIG_MK6


32 
	#MODULE_PROC_FAMILY
 "K6 "

	)

33 #ñi‡
deföed
 
CONFIG_MK7


34 
	#MODULE_PROC_FAMILY
 "K7 "

	)

35 #ñi‡
deföed
 
CONFIG_MK8


36 
	#MODULE_PROC_FAMILY
 "K8 "

	)

37 #ñi‡
deföed
 
CONFIG_MELAN


38 
	#MODULE_PROC_FAMILY
 "ELAN "

	)

39 #ñi‡
deföed
 
CONFIG_MCRUSOE


40 
	#MODULE_PROC_FAMILY
 "CRUSOE "

	)

41 #ñi‡
deföed
 
CONFIG_MWINCHIPC6


42 
	#MODULE_PROC_FAMILY
 "WINCHIPC6 "

	)

43 #ñi‡
deföed
 
CONFIG_MWINCHIP2


44 
	#MODULE_PROC_FAMILY
 "WINCHIP2 "

	)

45 #ñi‡
deföed
 
CONFIG_MWINCHIP3D


46 
	#MODULE_PROC_FAMILY
 "WINCHIP3D "

	)

47 #ñi‡
deföed
 
CONFIG_MCYRIXIII


48 
	#MODULE_PROC_FAMILY
 "CYRIXIII "

	)

49 #ñi‡
CONFIG_MVIAC3_2


50 
	#MODULE_PROC_FAMILY
 "VIAC3-2 "

	)

52 #îr‹ 
unknown
 
¥o˚ss‹
 
Ámûy


55 
	#MODULE_ARCH_VERMAGIC
 
MODULE_PROC_FAMILY


	)

	@/usr/include/asm/percpu.h

1 #i‚de‡
__ARCH_I386_PERCPU__


2 
	#__ARCH_I386_PERCPU__


	)

4 
	~<asm-gíîic/≥r˝u.h
>

	@/usr/include/linux/bitmap.h

1 #i‚de‡
__LINUX_BITMAP_H


2 
	#__LINUX_BITMAP_H


	)

4 #i‚de‡
__ASSEMBLY__


6 
	~<löux/c⁄fig.h
>

7 
	~<löux/compûî.h
>

8 
	~<löux/ty≥s.h
>

9 
	~<löux/kî√l.h
>

10 
	~<löux/bô›s.h
>

11 
	~<löux/°rög.h
>

13 
ölöe
 
	$bôm≠_em±y
(c⁄° *
bôm≠
, 
bôs
)

15 
k
, 
lim
 = 
bôs
/
BITS_PER_LONG
;

16 
k
 = 0; k < 
lim
; ++k)

17 i‡(
bôm≠
[
k
])

20 i‡(
bôs
 % 
BITS_PER_LONG
)

21 i‡(
bôm≠
[
k
] & ((1UL << (
bôs
 % 
BITS_PER_LONG
)) - 1))

25 
	}
}

27 
ölöe
 
	$bôm≠_fuŒ
(c⁄° *
bôm≠
, 
bôs
)

29 
k
, 
lim
 = 
bôs
/
BITS_PER_LONG
;

30 
k
 = 0; k < 
lim
; ++k)

31 i‡(~
bôm≠
[
k
])

34 i‡(
bôs
 % 
BITS_PER_LONG
)

35 i‡(~
bôm≠
[
k
] & ((1UL << (
bôs
 % 
BITS_PER_LONG
)) - 1))

39 
	}
}

41 
ölöe
 
	$bôm≠_equÆ
(c⁄° *
bôm≠1
,

42 *
bôm≠2
, 
bôs
)

44 
k
, 
lim
 = 
bôs
/
BITS_PER_LONG
;;

45 
k
 = 0; k < 
lim
; ++k)

46 i‡(
bôm≠1
[
k
] !
bôm≠2
[k])

49 i‡(
bôs
 % 
BITS_PER_LONG
)

50 i‡((
bôm≠1
[
k
] ^ 
bôm≠2
[k]) &

51 ((1UL << (
bôs
 % 
BITS_PER_LONG
)) - 1))

55 
	}
}

57 
ölöe
 
	$bôm≠_com∂emít
(*
bôm≠
, 
bôs
)

59 
k
;

61 
k
 = 0; k < 
	`BITS_TO_LONGS
(
bôs
); ++k)

62 
bôm≠
[
k
] = ~bitmap[k];

63 
	}
}

65 
ölöe
 
	$bôm≠_˛ór
(*
bôm≠
, 
bôs
)

67 
	`CLEAR_BITMAP
((*)
bôm≠
, 
bôs
);

68 
	}
}

70 
ölöe
 
	$bôm≠_fûl
(*
bôm≠
, 
bôs
)

72 
	`mem£t
(
bôm≠
, 0xff, 
	`BITS_TO_LONGS
(
bôs
)*());

73 
	}
}

75 
ölöe
 
	$bôm≠_c›y
(*
d°
,

76 c⁄° *
§c
, 
bôs
)

78 
	`mem˝y
(
d°
, 
§c
, 
	`BITS_TO_LONGS
(
bôs
)*());

79 
	}
}

81 
ölöe
 
	$bôm≠_shi·_right
(*
d°
,

82 c⁄° *
§c
, 
shi·
, 
bôs
)

84 
k
;

85 
	`DECLARE_BITMAP
(
__shr_tmp
, 
bôs
);

87 
	`bôm≠_˛ór
(
__shr_tmp
, 
bôs
);

88 
k
 = 0; k < 
bôs
 - 
shi·
; ++k)

89 i‡(
	`ã°_bô
(
k
 + 
shi·
, 
§c
))

90 
	`£t_bô
(
k
, 
__shr_tmp
);

91 
	`bôm≠_c›y
(
d°
, 
__shr_tmp
, 
bôs
);

92 
	}
}

94 
ölöe
 
	$bôm≠_shi·_À·
(*
d°
,

95 c⁄° *
§c
, 
shi·
, 
bôs
)

97 
k
;

98 
	`DECLARE_BITMAP
(
__shl_tmp
, 
bôs
);

100 
	`bôm≠_˛ór
(
__shl_tmp
, 
bôs
);

101 
k
 = 
bôs
; k >
shi·
; --k)

102 i‡(
	`ã°_bô
(
k
 - 
shi·
, 
§c
))

103 
	`£t_bô
(
k
, 
__shl_tmp
);

104 
	`bôm≠_c›y
(
d°
, 
__shl_tmp
, 
bôs
);

105 
	}
}

107 
ölöe
 
	$bôm≠_™d
(*
d°
, c⁄° *
bôm≠1
,

108 c⁄° *
bôm≠2
, 
bôs
)

110 
k
;

111 
ƒ
 = 
	`BITS_TO_LONGS
(
bôs
);

113 
k
 = 0; k < 
ƒ
; k++)

114 
d°
[
k
] = 
bôm≠1
[k] & 
bôm≠2
[k];

115 
	}
}

117 
ölöe
 
	$bôm≠_‹
(*
d°
, c⁄° *
bôm≠1
,

118 c⁄° *
bôm≠2
, 
bôs
)

120 
k
;

121 
ƒ
 = 
	`BITS_TO_LONGS
(
bôs
);

123 
k
 = 0; k < 
ƒ
; k++)

124 
d°
[
k
] = 
bôm≠1
[k] | 
bôm≠2
[k];

125 
	}
}

127 #i‡
BITS_PER_LONG
 == 32

128 
ölöe
 
	$bôm≠_weight
(c⁄° *
bôm≠
, 
bôs
)

130 
k
, 
w
 = 0, 
lim
 = 
bôs
/
BITS_PER_LONG
;

132 
k
 = 0; k < 
lim
; k++)

133 
w
 +
	`hweight32
(
bôm≠
[
k
]);

135 i‡(
bôs
 % 
BITS_PER_LONG
)

136 
w
 +
	`hweight32
(
bôm≠
[
k
] &

137 ((1UL << (
bôs
 % 
BITS_PER_LONG
)) - 1));

139  
w
;

140 
	}
}

142 
ölöe
 
	$bôm≠_weight
(c⁄° *
bôm≠
, 
bôs
)

144 
k
, 
w
 = 0, 
lim
 = 
bôs
/
BITS_PER_LONG
;

146 
k
 = 0; k < 
lim
; k++)

147 
w
 +
	`hweight64
(
bôm≠
[
k
]);

149 i‡(
bôs
 % 
BITS_PER_LONG
)

150 
w
 +
	`hweight64
(
bôm≠
[
k
] &

151 ((1UL << (
bôs
 % 
BITS_PER_LONG
)) - 1));

153  
w
;

154 
	}
}

	@/usr/include/linux/compiler-gcc.h

10 
	#b¨rõr
(Ë
__asm__
 
	`__vﬁ©ûe__
("": : :"mem‹y")

	)

14 
	#RELOC_HIDE
(
±r
, 
off
) \

15 ({ 
__±r
; \

16 
	`__asm__
 ("" : "=g"(
__±r
Ë: "0"(
±r
)); \

17 (
	`ty≥of
(
±r
)Ë(
__±r
 + (
off
)); })

	)

	@/usr/include/linux/elf.h

1 #i‚de‡
_LINUX_ELF_H


2 
	#_LINUX_ELF_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<asm/ñf.h
>

8 
__u32
 
	tElf32_Addr
;

9 
__u16
 
	tElf32_HÆf
;

10 
__u32
 
	tElf32_Off
;

11 
__s32
 
	tElf32_Sw‹d
;

12 
__u32
 
	tElf32_W‹d
;

15 
__u64
 
	tElf64_Addr
;

16 
__u16
 
	tElf64_HÆf
;

17 
__s16
 
	tElf64_SHÆf
;

18 
__u64
 
	tElf64_Off
;

19 
__s32
 
	tElf64_Sw‹d
;

20 
__u32
 
	tElf64_W‹d
;

21 
__u64
 
	tElf64_Xw‹d
;

22 
__s64
 
	tElf64_Sxw‹d
;

25 
	#PT_NULL
 0

	)

26 
	#PT_LOAD
 1

	)

27 
	#PT_DYNAMIC
 2

	)

28 
	#PT_INTERP
 3

	)

29 
	#PT_NOTE
 4

	)

30 
	#PT_SHLIB
 5

	)

31 
	#PT_PHDR
 6

	)

32 
	#PT_LOOS
 0x60000000

	)

33 
	#PT_HIOS
 0x6fffffff

	)

34 
	#PT_LOPROC
 0x70000000

	)

35 
	#PT_HIPROC
 0x7fffffff

	)

36 
	#PT_GNU_EH_FRAME
 0x6474e550

	)

39 
	#ET_NONE
 0

	)

40 
	#ET_REL
 1

	)

41 
	#ET_EXEC
 2

	)

42 
	#ET_DYN
 3

	)

43 
	#ET_CORE
 4

	)

44 
	#ET_LOPROC
 0xff00

	)

45 
	#ET_HIPROC
 0xffff

	)

48 
	#EM_NONE
 0

	)

49 
	#EM_M32
 1

	)

50 
	#EM_SPARC
 2

	)

51 
	#EM_386
 3

	)

52 
	#EM_68K
 4

	)

53 
	#EM_88K
 5

	)

54 
	#EM_486
 6

	)

55 
	#EM_860
 7

	)

57 
	#EM_MIPS
 8

	)

59 
	#EM_MIPS_RS4_BE
 10

	)

61 
	#EM_PARISC
 15

	)

63 
	#EM_SPARC32PLUS
 18

	)

65 
	#EM_PPC
 20

	)

66 
	#EM_PPC64
 21

	)

68 
	#EM_SH
 42

	)

70 
	#EM_SPARCV9
 43

	)

72 
	#EM_IA_64
 50

	)

74 
	#EM_X86_64
 62

	)

76 
	#EM_S390
 22

	)

78 
	#EM_CRIS
 76

	)

80 
	#EM_V850
 87

	)

82 
	#EM_H8_300H
 47

	)

83 
	#EM_H8S
 48

	)

89 
	#EM_ALPHA
 0x9026

	)

92 
	#EM_CYGNUS_V850
 0x9080

	)

97 
	#EM_S390_OLD
 0xA390

	)

100 
	#DT_NULL
 0

	)

101 
	#DT_NEEDED
 1

	)

102 
	#DT_PLTRELSZ
 2

	)

103 
	#DT_PLTGOT
 3

	)

104 
	#DT_HASH
 4

	)

105 
	#DT_STRTAB
 5

	)

106 
	#DT_SYMTAB
 6

	)

107 
	#DT_RELA
 7

	)

108 
	#DT_RELASZ
 8

	)

109 
	#DT_RELAENT
 9

	)

110 
	#DT_STRSZ
 10

	)

111 
	#DT_SYMENT
 11

	)

112 
	#DT_INIT
 12

	)

113 
	#DT_FINI
 13

	)

114 
	#DT_SONAME
 14

	)

115 
	#DT_RPATH
 15

	)

116 
	#DT_SYMBOLIC
 16

	)

117 
	#DT_REL
 17

	)

118 
	#DT_RELSZ
 18

	)

119 
	#DT_RELENT
 19

	)

120 
	#DT_PLTREL
 20

	)

121 
	#DT_DEBUG
 21

	)

122 
	#DT_TEXTREL
 22

	)

123 
	#DT_JMPREL
 23

	)

124 
	#DT_LOPROC
 0x70000000

	)

125 
	#DT_HIPROC
 0x7fffffff

	)

128 
	#STB_LOCAL
 0

	)

129 
	#STB_GLOBAL
 1

	)

130 
	#STB_WEAK
 2

	)

132 
	#STT_NOTYPE
 0

	)

133 
	#STT_OBJECT
 1

	)

134 
	#STT_FUNC
 2

	)

135 
	#STT_SECTION
 3

	)

136 
	#STT_FILE
 4

	)

138 
	#ELF_ST_BIND
(
x
Ë((xË>> 4)

	)

139 
	#ELF_ST_TYPE
(
x
Ë(((ËxË& 0xf)

	)

140 
	#ELF32_ST_BIND
(
x
Ë
	`ELF_ST_BIND
(x)

	)

141 
	#ELF32_ST_TYPE
(
x
Ë
	`ELF_ST_TYPE
(x)

	)

142 
	#ELF64_ST_BIND
(
x
Ë
	`ELF_ST_BIND
(x)

	)

143 
	#ELF64_ST_TYPE
(
x
Ë
	`ELF_ST_TYPE
(x)

	)

147 
	#AT_NULL
 0

	)

148 
	#AT_IGNORE
 1

	)

149 
	#AT_EXECFD
 2

	)

150 
	#AT_PHDR
 3

	)

151 
	#AT_PHENT
 4

	)

152 
	#AT_PHNUM
 5

	)

153 
	#AT_PAGESZ
 6

	)

154 
	#AT_BASE
 7

	)

155 
	#AT_FLAGS
 8

	)

156 
	#AT_ENTRY
 9

	)

157 
	#AT_NOTELF
 10

	)

158 
	#AT_UID
 11

	)

159 
	#AT_EUID
 12

	)

160 
	#AT_GID
 13

	)

161 
	#AT_EGID
 14

	)

162 
	#AT_PLATFORM
 15

	)

163 
	#AT_HWCAP
 16

	)

164 
	#AT_CLKTCK
 17

	)

166 
	#AT_SECURE
 23

	)

168 
	sdy«mic
{

169 
Elf32_Sw‹d
 
	md_èg
;

171 
Elf32_Sw‹d
 
	md_vÆ
;

172 
Elf32_Addr
 
	md_±r
;

173 } 
	md_un
;

174 } 
	tElf32_Dyn
;

177 
Elf64_Sxw‹d
 
	md_èg
;

179 
Elf64_Xw‹d
 
	md_vÆ
;

180 
Elf64_Addr
 
	md_±r
;

181 } 
	md_un
;

182 } 
	tElf64_Dyn
;

185 
	#ELF32_R_SYM
(
x
Ë((xË>> 8)

	)

186 
	#ELF32_R_TYPE
(
x
Ë((xË& 0xff)

	)

188 
	#ELF64_R_SYM
(
i
Ë((iË>> 32)

	)

189 
	#ELF64_R_TYPE
(
i
Ë((iË& 0xffffffff)

	)

191 
	sñf32_ªl
 {

192 
Elf32_Addr
 
	mr_off£t
;

193 
Elf32_W‹d
 
	mr_öfo
;

194 } 
	tElf32_Rñ
;

196 
	sñf64_ªl
 {

197 
Elf64_Addr
 
	mr_off£t
;

198 
Elf64_Xw‹d
 
	mr_öfo
;

199 } 
	tElf64_Rñ
;

201 
	sñf32_ªœ
{

202 
Elf32_Addr
 
	mr_off£t
;

203 
Elf32_W‹d
 
	mr_öfo
;

204 
Elf32_Sw‹d
 
	mr_addíd
;

205 } 
	tElf32_Rña
;

207 
	sñf64_ªœ
 {

208 
Elf64_Addr
 
	mr_off£t
;

209 
Elf64_Xw‹d
 
	mr_öfo
;

210 
Elf64_Sxw‹d
 
	mr_addíd
;

211 } 
	tElf64_Rña
;

213 
	sñf32_sym
{

214 
Elf32_W‹d
 
	m°_«me
;

215 
Elf32_Addr
 
	m°_vÆue
;

216 
Elf32_W‹d
 
	m°_size
;

217 
	m°_öfo
;

218 
	m°_Ÿhî
;

219 
Elf32_HÆf
 
	m°_shndx
;

220 } 
	tElf32_Sym
;

222 
	sñf64_sym
 {

223 
Elf64_W‹d
 
	m°_«me
;

224 
	m°_öfo
;

225 
	m°_Ÿhî
;

226 
Elf64_HÆf
 
	m°_shndx
;

227 
Elf64_Addr
 
	m°_vÆue
;

228 
Elf64_Xw‹d
 
	m°_size
;

229 } 
	tElf64_Sym
;

232 
	#EI_NIDENT
 16

	)

234 
	sñf32_hdr
{

235 
	me_idít
[
EI_NIDENT
];

236 
Elf32_HÆf
 
	me_ty≥
;

237 
Elf32_HÆf
 
	me_machöe
;

238 
Elf32_W‹d
 
	me_vîsi⁄
;

239 
Elf32_Addr
 
	me_íåy
;

240 
Elf32_Off
 
	me_phoff
;

241 
Elf32_Off
 
	me_shoff
;

242 
Elf32_W‹d
 
	me_Êags
;

243 
Elf32_HÆf
 
	me_ehsize
;

244 
Elf32_HÆf
 
	me_phítsize
;

245 
Elf32_HÆf
 
	me_phnum
;

246 
Elf32_HÆf
 
	me_shítsize
;

247 
Elf32_HÆf
 
	me_shnum
;

248 
Elf32_HÆf
 
	me_sh°∫dx
;

249 } 
	tElf32_Ehdr
;

251 
	sñf64_hdr
 {

252 
	me_idít
[16];

253 
Elf64_HÆf
 
	me_ty≥
;

254 
Elf64_HÆf
 
	me_machöe
;

255 
Elf64_W‹d
 
	me_vîsi⁄
;

256 
Elf64_Addr
 
	me_íåy
;

257 
Elf64_Off
 
	me_phoff
;

258 
Elf64_Off
 
	me_shoff
;

259 
Elf64_W‹d
 
	me_Êags
;

260 
Elf64_HÆf
 
	me_ehsize
;

261 
Elf64_HÆf
 
	me_phítsize
;

262 
Elf64_HÆf
 
	me_phnum
;

263 
Elf64_HÆf
 
	me_shítsize
;

264 
Elf64_HÆf
 
	me_shnum
;

265 
Elf64_HÆf
 
	me_sh°∫dx
;

266 } 
	tElf64_Ehdr
;

270 
	#PF_R
 0x4

	)

271 
	#PF_W
 0x2

	)

272 
	#PF_X
 0x1

	)

274 
	sñf32_phdr
{

275 
Elf32_W‹d
 
	mp_ty≥
;

276 
Elf32_Off
 
	mp_off£t
;

277 
Elf32_Addr
 
	mp_vaddr
;

278 
Elf32_Addr
 
	mp_∑ddr
;

279 
Elf32_W‹d
 
	mp_fûesz
;

280 
Elf32_W‹d
 
	mp_memsz
;

281 
Elf32_W‹d
 
	mp_Êags
;

282 
Elf32_W‹d
 
	mp_Æign
;

283 } 
	tElf32_Phdr
;

285 
	sñf64_phdr
 {

286 
Elf64_W‹d
 
	mp_ty≥
;

287 
Elf64_W‹d
 
	mp_Êags
;

288 
Elf64_Off
 
	mp_off£t
;

289 
Elf64_Addr
 
	mp_vaddr
;

290 
Elf64_Addr
 
	mp_∑ddr
;

291 
Elf64_Xw‹d
 
	mp_fûesz
;

292 
Elf64_Xw‹d
 
	mp_memsz
;

293 
Elf64_Xw‹d
 
	mp_Æign
;

294 } 
	tElf64_Phdr
;

297 
	#SHT_NULL
 0

	)

298 
	#SHT_PROGBITS
 1

	)

299 
	#SHT_SYMTAB
 2

	)

300 
	#SHT_STRTAB
 3

	)

301 
	#SHT_RELA
 4

	)

302 
	#SHT_HASH
 5

	)

303 
	#SHT_DYNAMIC
 6

	)

304 
	#SHT_NOTE
 7

	)

305 
	#SHT_NOBITS
 8

	)

306 
	#SHT_REL
 9

	)

307 
	#SHT_SHLIB
 10

	)

308 
	#SHT_DYNSYM
 11

	)

309 
	#SHT_NUM
 12

	)

310 
	#SHT_LOPROC
 0x70000000

	)

311 
	#SHT_HIPROC
 0x7fffffff

	)

312 
	#SHT_LOUSER
 0x80000000

	)

313 
	#SHT_HIUSER
 0xffffffff

	)

316 
	#SHF_WRITE
 0x1

	)

317 
	#SHF_ALLOC
 0x2

	)

318 
	#SHF_EXECINSTR
 0x4

	)

319 
	#SHF_MASKPROC
 0xf0000000

	)

322 
	#SHN_UNDEF
 0

	)

323 
	#SHN_LORESERVE
 0xff00

	)

324 
	#SHN_LOPROC
 0xff00

	)

325 
	#SHN_HIPROC
 0xff1f

	)

326 
	#SHN_ABS
 0xfff1

	)

327 
	#SHN_COMMON
 0xfff2

	)

328 
	#SHN_HIRESERVE
 0xffff

	)

331 
Elf32_W‹d
 
	msh_«me
;

332 
Elf32_W‹d
 
	msh_ty≥
;

333 
Elf32_W‹d
 
	msh_Êags
;

334 
Elf32_Addr
 
	msh_addr
;

335 
Elf32_Off
 
	msh_off£t
;

336 
Elf32_W‹d
 
	msh_size
;

337 
Elf32_W‹d
 
	msh_lök
;

338 
Elf32_W‹d
 
	msh_öfo
;

339 
Elf32_W‹d
 
	msh_addølign
;

340 
Elf32_W‹d
 
	msh_ítsize
;

341 } 
	tElf32_Shdr
;

343 
	sñf64_shdr
 {

344 
Elf64_W‹d
 
	msh_«me
;

345 
Elf64_W‹d
 
	msh_ty≥
;

346 
Elf64_Xw‹d
 
	msh_Êags
;

347 
Elf64_Addr
 
	msh_addr
;

348 
Elf64_Off
 
	msh_off£t
;

349 
Elf64_Xw‹d
 
	msh_size
;

350 
Elf64_W‹d
 
	msh_lök
;

351 
Elf64_W‹d
 
	msh_öfo
;

352 
Elf64_Xw‹d
 
	msh_addølign
;

353 
Elf64_Xw‹d
 
	msh_ítsize
;

354 } 
	tElf64_Shdr
;

356 
	#EI_MAG0
 0

	)

357 
	#EI_MAG1
 1

	)

358 
	#EI_MAG2
 2

	)

359 
	#EI_MAG3
 3

	)

360 
	#EI_CLASS
 4

	)

361 
	#EI_DATA
 5

	)

362 
	#EI_VERSION
 6

	)

363 
	#EI_OSABI
 7

	)

364 
	#EI_PAD
 8

	)

366 
	#ELFMAG0
 0x7‡

	)

367 
	#ELFMAG1
 'E'

	)

368 
	#ELFMAG2
 'L'

	)

369 
	#ELFMAG3
 'F'

	)

370 
	#ELFMAG
 "\177ELF"

	)

371 
	#SELFMAG
 4

	)

373 
	#ELFCLASSNONE
 0

	)

374 
	#ELFCLASS32
 1

	)

375 
	#ELFCLASS64
 2

	)

376 
	#ELFCLASSNUM
 3

	)

378 
	#ELFDATANONE
 0

	)

379 
	#ELFDATA2LSB
 1

	)

380 
	#ELFDATA2MSB
 2

	)

382 
	#EV_NONE
 0

	)

383 
	#EV_CURRENT
 1

	)

384 
	#EV_NUM
 2

	)

386 
	#ELFOSABI_NONE
 0

	)

387 
	#ELFOSABI_LINUX
 3

	)

389 #i‚de‡
ELF_OSABI


390 
	#ELF_OSABI
 
ELFOSABI_NONE


	)

394 
	#NT_PRSTATUS
 1

	)

395 
	#NT_PRFPREG
 2

	)

396 
	#NT_PRPSINFO
 3

	)

397 
	#NT_TASKSTRUCT
 4

	)

398 
	#NT_AUXV
 6

	)

399 
	#NT_PRXFPREG
 0x46e62b7‡

	)

403 
	sñf32_nŸe
 {

404 
Elf32_W‹d
 
	mn_«mesz
;

405 
Elf32_W‹d
 
	mn_descsz
;

406 
Elf32_W‹d
 
	mn_ty≥
;

407 } 
	tElf32_Nhdr
;

410 
	sñf64_nŸe
 {

411 
Elf64_W‹d
 
	mn_«mesz
;

412 
Elf64_W‹d
 
	mn_descsz
;

413 
Elf64_W‹d
 
	mn_ty≥
;

414 } 
	tElf64_Nhdr
;

416 #i‡
ELF_CLASS
 =
ELFCLASS32


418 
Elf32_Dyn
 
_DYNAMIC
 [];

419 
	#ñfhdr
 
ñf32_hdr


	)

420 
	#ñf_phdr
 
ñf32_phdr


	)

421 
	#ñf_nŸe
 
ñf32_nŸe


	)

425 
Elf64_Dyn
 
_DYNAMIC
 [];

426 
	#ñfhdr
 
ñf64_hdr


	)

427 
	#ñf_phdr
 
ñf64_phdr


	)

428 
	#ñf_nŸe
 
ñf64_nŸe


	)

	@/usr/include/linux/kmod.h

1 #i‚de‡
__LINUX_KMOD_H__


2 
	#__LINUX_KMOD_H__


	)

22 
	~<löux/c⁄fig.h
>

23 
	~<löux/î∫o.h
>

24 
	~<löux/compûî.h
>

26 #ifde‡
CONFIG_KMOD


27 
	$ªque°_moduÀ
(c⁄° * 
«me
, ...Ë
	`__©åibuã__
 ((
	`f‹m©
 (
¥ötf
, 1, 2)));

29 
ölöe
 
	$ªque°_moduÀ
(c⁄° * 
«me
, ...Ë{  -
ENOSYS
; 
	}
}

32 
	#åy_thí_ªque°_moduÀ
(
x
, 
mod
...Ë((xË?: (
	`ªque°_moduÀ
(mod), (x)))

	)

33 
ˇŒ_u£rmodehñ≥r
(*
∑th
, *
¨gv
[], *
ívp
[], 
waô
);

35 #ifde‡
CONFIG_HOTPLUG


36 
hŸ∂ug_∑th
 [];

	@/usr/include/linux/sched.h

1 #i‚de‡
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

4 
	~<asm/∑øm.h
>

6 
	~<löux/c⁄fig.h
>

7 
	~<löux/ˇ∑bûôy.h
>

8 
	~<löux/thªads.h
>

9 
	~<löux/kî√l.h
>

10 
	~<löux/ty≥s.h
>

11 
	~<löux/timex.h
>

12 
	~<löux/jiffõs.h
>

13 
	~<löux/rbåì.h
>

14 
	~<löux/thªad_öfo.h
>

15 
	~<löux/˝umask.h
>

17 
	~<asm/sy°em.h
>

18 
	~<asm/£m≠h‹e.h
>

19 
	~<asm/∑ge.h
>

20 
	~<asm/±ø˚.h
>

21 
	~<asm/mmu.h
>

23 
	~<löux/smp.h
>

24 
	~<löux/£m.h
>

25 
	~<löux/sig«l.h
>

26 
	~<löux/£cuªbôs.h
>

27 
	~<löux/fs_°ru˘.h
>

28 
	~<löux/compûî.h
>

29 
	~<löux/com∂ëi⁄.h
>

30 
	~<löux/pid.h
>

31 
	~<löux/≥r˝u.h
>

33 
	gexec_domaö
;

38 
	#CSIGNAL
 0x000000f‡

	)

39 
	#CLONE_VM
 0x00000100

	)

40 
	#CLONE_FS
 0x00000200

	)

41 
	#CLONE_FILES
 0x00000400

	)

42 
	#CLONE_SIGHAND
 0x00000800

	)

43 
	#CLONE_IDLETASK
 0x00001000

	)

44 
	#CLONE_PTRACE
 0x00002000

	)

45 
	#CLONE_VFORK
 0x00004000

	)

46 
	#CLONE_PARENT
 0x00008000

	)

47 
	#CLONE_THREAD
 0x00010000

	)

48 
	#CLONE_NEWNS
 0x00020000

	)

49 
	#CLONE_SYSVSEM
 0x00040000

	)

50 
	#CLONE_SETTLS
 0x00080000

	)

51 
	#CLONE_PARENT_SETTID
 0x00100000

	)

52 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

53 
	#CLONE_DETACHED
 0x00400000

	)

54 
	#CLONE_UNTRACED
 0x00800000

	)

55 
	#CLONE_CHILD_SETTID
 0x01000000

	)

56 
	#CLONE_STOPPED
 0x02000000

	)

62 
	#CLONE_KERNEL
 (
CLONE_FS
 | 
CLONE_FILES
 | 
CLONE_SIGHAND
)

	)

74 
avírun
[];

76 
	#FSHIFT
 11

	)

77 
	#FIXED_1
 (1<<
FSHIFT
Ë

	)

78 
	#LOAD_FREQ
 (5*
HZ
Ë

	)

79 
	#EXP_1
 1884

	)

80 
	#EXP_5
 2014

	)

81 
	#EXP_15
 2037

	)

83 
	#CALC_LOAD
(
lﬂd
,
exp
,
n
) \

84 
lﬂd
 *
exp
; \

85 
lﬂd
 +
n
*(
FIXED_1
-
exp
); \

86 
lﬂd
 >>
FSHIFT
;

	)

88 
	#CT_TO_SECS
(
x
Ë((xË/ 
HZ
)

	)

89 
	#CT_TO_USECS
(
x
Ë(((xË% 
HZ
Ë* 1000000/HZ)

	)

91 
ƒ_thªads
;

92 
œ°_pid
;

93 
DECLARE_PER_CPU
(, 
¥o˚ss_cou¡s
);

94 
ƒ_¥o˚s£s
();

95 
ƒ_ru¬ög
();

96 
ƒ_unöãºu±ibÀ
();

97 
ƒ_iowaô
();

99 
	~<löux/time.h
>

100 
	~<löux/∑øm.h
>

101 
	~<löux/ªsour˚.h
>

102 
	~<löux/timî.h
>

104 
	~<asm/¥o˚ss‹.h
>

106 
	#TASK_RUNNING
 0

	)

107 
	#TASK_INTERRUPTIBLE
 1

	)

108 
	#TASK_UNINTERRUPTIBLE
 2

	)

109 
	#TASK_STOPPED
 4

	)

110 
	#TASK_ZOMBIE
 8

	)

111 
	#TASK_DEAD
 16

	)

113 
	#__£t_èsk_°©e
(
tsk
, 
°©e_vÆue
) \

114 dÿ{ (
tsk
)->
°©e
 = (
°©e_vÆue
); } 0)

	)

115 
	#£t_èsk_°©e
(
tsk
, 
°©e_vÆue
) \

116 
	`£t_mb
((
tsk
)->
°©e
, (
°©e_vÆue
))

	)

118 
	#__£t_cuºít_°©e
(
°©e_vÆue
) \

119 dÿ{ 
cuºít
->
°©e
 = (
°©e_vÆue
); } 0)

	)

120 
	#£t_cuºít_°©e
(
°©e_vÆue
) \

121 
	`£t_mb
(
cuºít
->
°©e
, (
°©e_vÆue
))

	)

126 
	#SCHED_NORMAL
 0

	)

127 
	#SCHED_FIFO
 1

	)

128 
	#SCHED_RR
 2

	)

130 
	ssched_∑øm
 {

131 
	msched_¥i‹ôy
;

134 #ifde‡
__KERNEL__


136 
	~<löux/•ölock.h
>

144 
rwlock_t
 
èskli°_lock
;

145 
•ölock_t
 
mmli°_lock
;

147 
èsk_°ru˘
 
	tèsk_t
;

149 
sched_öô
();

150 
öô_idÀ
(
èsk_t
 *
idÀ
, 
˝u
);

152 
show_°©e
();

153 
show_ªgs
(
±_ªgs
 *);

160 
show_°ack
(
èsk_°ru˘
 *
èsk
, *
•
);

162 
io_scheduÀ
();

163 
io_scheduÀ_timeout
(
timeout
);

165 
˝u_öô
 ();

166 
å≠_öô
();

167 
upd©e_¥o˚ss_times
(
u£r
);

168 
upd©e_⁄e_¥o˚ss
(
èsk_°ru˘
 *
p
, 
u£r
,

169 
sy°em
, 
˝u
);

170 
scheduÀr_tick
(
u£r_tick
, 
sy°em
);

171 
ˇche_deˇy_ticks
;

174 
	#MAX_SCHEDULE_TIMEOUT
 
LONG_MAX


	)

175 sig√d 
FASTCALL
(
scheduÀ_timeout
(sig√d 
timeout
));

176 
asmlökage
 
scheduÀ
();

178 
	g«me•a˚
;

181 
	#MAX_MAP_COUNT
 (65536)

	)

183 
	~<löux/aio.h
>

185 
	smm_°ru˘
 {

186 
vm_¨ó_°ru˘
 * 
	mmm≠
;

187 
rb_roŸ
 
	mmm_rb
;

188 
vm_¨ó_°ru˘
 * 
	mmm≠_ˇche
;

189 
	m‰ì_¨ó_ˇche
;

190 
pgd_t
 * 
	mpgd
;

191 
©omic_t
 
	mmm_u£rs
;

192 
©omic_t
 
	mmm_cou¡
;

193 
	mm≠_cou¡
;

194 
rw_£m≠h‹e
 
	mmm≠_£m
;

195 
•ölock_t
 
	m∑ge_èbÀ_lock
;

197 
li°_hód
 
	mmmli°
;

202 
	m°¨t_code
, 
	míd_code
, 
	m°¨t_d©a
, 
	míd_d©a
;

203 
	m°¨t_brk
, 
	mbrk
, 
	m°¨t_°ack
;

204 
	m¨g_°¨t
, 
	m¨g_íd
, 
	mív_°¨t
, 
	mív_íd
;

205 
	mrss
, 
	mtŸÆ_vm
, 
	mlocked_vm
;

206 
	mdef_Êags
;

207 
˝umask_t
 
	m˝u_vm_mask
;

208 
	msw≠_addªss
;

210 
	mßved_auxv
[40];

212 
	mdum∑bÀ
:1;

213 #ifde‡
CONFIG_HUGETLB_PAGE


214 
	mu£d_hugëlb
;

217 
mm_c⁄ãxt_t
 
	mc⁄ãxt
;

220 
	mc‹e_waôîs
;

221 
com∂ëi⁄
 *
	mc‹e_°¨tup_d⁄e
, 
	mc‹e_d⁄e
;

224 
rwlock_t
 
	mio˘x_li°_lock
;

225 
kio˘x
 *
	mio˘x_li°
;

227 
kio˘x
 
	mdeÁu…_kio˘x
;

230 
mmli°_ƒ
;

232 
	ssigh™d_°ru˘
 {

233 
©omic_t
 
	mcou¡
;

234 
k_siga˘i⁄
 
	ma˘i⁄
[
_NSIG
];

235 
•ölock_t
 
	msiglock
;

245 
	ssig«l_°ru˘
 {

246 
©omic_t
 
	mcou¡
;

249 
èsk_t
 *
	mcuº_èrgë
;

252 
sig≥ndög
 
	msh¨ed_≥ndög
;

255 
	mgroup_exô
;

256 
	mgroup_exô_code
;

262 
èsk_°ru˘
 *
	mgroup_exô_èsk
;

263 
	mnŸify_cou¡
;

266 
	mgroup_°›_cou¡
;

282 
	#MAX_USER_RT_PRIO
 100

	)

283 
	#MAX_RT_PRIO
 
MAX_USER_RT_PRIO


	)

285 
	#MAX_PRIO
 (
MAX_RT_PRIO
 + 40)

	)

287 
	#π_èsk
(
p
Ë(’)->
¥io
 < 
MAX_RT_PRIO
)

	)

292 
	su£r_°ru˘
 {

293 
©omic_t
 
	m__cou¡
;

294 
©omic_t
 
	m¥o˚s£s
;

295 
©omic_t
 
	mfûes
;

298 
li°_hód
 
	muidhash_li°
;

299 
uid_t
 
	muid
;

302 
u£r_°ru˘
 *
föd_u£r
(
uid_t
);

304 
u£r_°ru˘
 
roŸ_u£r
;

305 
	#INIT_USER
 (&
roŸ_u£r
)

	)

307 
¥io_¨øy
 
	t¥io_¨øy_t
;

308 
	gbackög_dev_öfo
;

309 
	gª˛aim_°©e
;

312 
	sk_ôimî
 {

313 
li°_hód
 
	mli°
;

314 
•ölock_t
 
	mô_lock
;

315 
˛ockid_t
 
	mô_˛ock
;

316 
timî_t
 
	mô_id
;

317 
	mô_ovîrun
;

318 
	mô_ovîrun_œ°
;

319 
	mô_ªqueue_≥ndög
;

320 
	mô_sigev_nŸify
;

321 
	mô_sigev_signo
;

322 
sigvÆ_t
 
	mô_sigev_vÆue
;

323 
	mô_ö¸
;

324 
èsk_°ru˘
 *
	mô_¥o˚ss
;

325 
timî_li°
 
	mô_timî
;

326 
sigqueue
 *
	msigq
;

330 
	gio_c⁄ãxt
;

331 
exô_io_c⁄ãxt
();

333 
	sèsk_°ru˘
 {

334 vﬁ©ûê
	m°©e
;

335 
thªad_öfo
 *
	mthªad_öfo
;

336 
©omic_t
 
	mußge
;

337 
	mÊags
;

338 
	m±ø˚
;

340 
	mlock_dïth
;

342 
	m¥io
, 
	m°©ic_¥io
;

343 
li°_hód
 
	mrun_li°
;

344 
¥io_¨øy_t
 *
	m¨øy
;

346 
	m¶ìp_avg
;

347 
	möãø˘ive_¸edô
;

348 
	mtime°amp
;

349 
	ma˘iv©ed
;

351 
	mpﬁicy
;

352 
˝umask_t
 
	m˝us_Ælowed
;

353 
	mtime_¶i˚
, 
	mfú°_time_¶i˚
;

355 
li°_hód
 
	mèsks
;

356 
li°_hód
 
	m±ø˚_chûdªn
;

357 
li°_hód
 
	m±ø˚_li°
;

359 
mm_°ru˘
 *
	mmm
, *
	ma˘ive_mm
;

362 
löux_böfmt
 *
	mböfmt
;

363 
	mexô_code
, 
	mexô_sig«l
;

364 
	mpdóth_sig«l
;

366 
	m≥rs⁄Æôy
;

367 
	mdid_exec
:1;

368 
pid_t
 
	mpid
;

369 
pid_t
 
	m__pgΩ
;

370 
pid_t
 
	mây_ﬁd_pgΩ
;

371 
pid_t
 
	m£ssi⁄
;

372 
pid_t
 
	mtgid
;

374 
	mÀadî
;

380 
èsk_°ru˘
 *
	mªÆ_∑ª¡
;

381 
èsk_°ru˘
 *
	m∑ª¡
;

382 
li°_hód
 
	mchûdªn
;

383 
li°_hód
 
	msiblög
;

384 
èsk_°ru˘
 *
	mgroup_Àadî
;

387 
pid_lök
 
	mpids
[
PIDTYPE_MAX
];

389 
waô_queue_hód_t
 
	mwaô_chldexô
;

390 
com∂ëi⁄
 *
	mvf‹k_d⁄e
;

391 
__u£r
 *
	m£t_chûd_tid
;

392 
__u£r
 *
	m˛ór_chûd_tid
;

394 
	mπ_¥i‹ôy
;

395 
	mô_ªÆ_vÆue
, 
	mô_¥of_vÆue
, 
	mô_vút_vÆue
;

396 
	mô_ªÆ_ö¸
, 
	mô_¥of_ö¸
, 
	mô_vút_ö¸
;

397 
timî_li°
 
	mªÆ_timî
;

398 
li°_hód
 
	mposix_timîs
;

399 
	mutime
, 
	m°ime
, 
	mcutime
, 
	mc°ime
;

400 
	mnvcsw
, 
	mnivcsw
, 
	m˙vcsw
, 
	m˙ivcsw
;

401 
u64
 
	m°¨t_time
;

403 
	mmö_Êt
, 
	mmaj_Êt
, 
	mnsw≠
, 
	mcmö_Êt
, 
	mcmaj_Êt
, 
	m˙sw≠
;

405 
uid_t
 
	muid
,
	meuid
,
	msuid
,
	mfsuid
;

406 
gid_t
 
	mgid
,
	megid
,
	msgid
,
	mfsgid
;

407 
	mngroups
;

408 
gid_t
 
	mgroups
[
NGROUPS
];

409 
kî√l_ˇp_t
 
	mˇp_ef„˘ive
, 
	mˇp_öhîôabÀ
, 
	mˇp_≥rmôãd
;

410 
	mkìp_ˇ∑bûôõs
:1;

411 
u£r_°ru˘
 *
	mu£r
;

413 
æimô
 
	mæim
[
RLIM_NLIMITS
];

414 
	mu£d_m©h
;

415 
	mcomm
[16];

417 
	mlök_cou¡
, 
	mtŸÆ_lök_cou¡
;

418 
ây_°ru˘
 *
	mây
;

420 
sysv_£m
 
	msysv£m
;

422 
thªad_°ru˘
 
	mthªad
;

424 
fs_°ru˘
 *
	mfs
;

426 
fûes_°ru˘
 *
	mfûes
;

428 
«me•a˚
 *
	m«me•a˚
;

430 
sig«l_°ru˘
 *
	msig«l
;

431 
sigh™d_°ru˘
 *
	msigh™d
;

433 
sig£t_t
 
	mblocked
, 
	mªÆ_blocked
;

434 
sig≥ndög
 
	m≥ndög
;

436 
	mßs_ss_•
;

437 
size_t
 
	mßs_ss_size
;

438 (*
	mnŸifõr
)(*
	m¥iv
);

439 *
	mnŸifõr_d©a
;

440 
sig£t_t
 *
	mnŸifõr_mask
;

442 *
	m£curôy
;

445 
u32
 
	m∑ª¡_exec_id
;

446 
u32
 
	m£lf_exec_id
;

448 
•ölock_t
 
	mÆloc_lock
;

450 
•ölock_t
 
	m¥oc_lock
;

452 
•ölock_t
 
	mswôch_lock
;

455 *
	mjou∫Æ_öfo
;

458 
ª˛aim_°©e
 *
	mª˛aim_°©e
;

460 
díåy
 *
	m¥oc_díåy
;

461 
backög_dev_öfo
 *
	mbackög_dev_öfo
;

463 
io_c⁄ãxt
 *
	mio_c⁄ãxt
;

465 
	m±ø˚_mesßge
;

466 
sigöfo_t
 *
	mœ°_sigöfo
;

469 
ölöe
 
pid_t
 
	$¥o˚ss_group
(
èsk_°ru˘
 *
tsk
)

471  
tsk
->
group_Àadî
->
__pgΩ
;

472 
	}
}

474 
__put_èsk_°ru˘
(
èsk_°ru˘
 *
tsk
);

475 
	#gë_èsk_°ru˘
(
tsk
Ëdÿ{ 
	`©omic_öc
(&—sk)->
ußge
); } 0)

	)

476 
	#put_èsk_°ru˘
(
tsk
) \

477 dÿ{ i‡(
	`©omic_dec_™d_ã°
(&(
tsk
)->
ußge
)Ë
	`__put_èsk_°ru˘
—sk); } 0)

	)

482 
	#PF_ALIGNWARN
 0x00000001

	)

484 
	#PF_STARTING
 0x00000002

	)

485 
	#PF_EXITING
 0x00000004

	)

486 
	#PF_FORKNOEXEC
 0x00000040

	)

487 
	#PF_SUPERPRIV
 0x00000100

	)

488 
	#PF_DUMPCORE
 0x00000200

	)

489 
	#PF_SIGNALED
 0x00000400

	)

490 
	#PF_MEMALLOC
 0x00000800

	)

491 
	#PF_MEMDIE
 0x00001000

	)

492 
	#PF_FLUSHER
 0x00002000

	)

494 
	#PF_FREEZE
 0x00004000

	)

495 
	#PF_IOTHREAD
 0x00008000

	)

496 
	#PF_FROZEN
 0x00010000

	)

497 
	#PF_FSTRANS
 0x00020000

	)

498 
	#PF_KSWAPD
 0x00040000

	)

499 
	#PF_SWAPOFF
 0x00080000

	)

500 
	#PF_LESS_THROTTLE
 0x00100000

	)

501 
	#PF_SYNCWRITE
 0x00200000

	)

503 #ifde‡
CONFIG_SMP


504 
£t_˝us_Ælowed
(
èsk_t
 *
p
, 
˝umask_t
 
√w_mask
);

506 
ölöe
 
	$£t_˝us_Ælowed
(
èsk_t
 *
p
, 
˝umask_t
 
√w_mask
)

509 
	}
}

512 
sched_˛ock
();

514 #ifde‡
CONFIG_NUMA


515 
sched_bÆ™˚_exec
();

516 
node_ƒ_ru¬ög_öô
();

518 
	#sched_bÆ™˚_exec
(Ë{}

	)

519 
	#node_ƒ_ru¬ög_öô
(Ë{}

	)

522 
£t_u£r_ni˚
(
èsk_t
 *
p
, 
ni˚
);

523 
èsk_¥io
(
èsk_t
 *
p
);

524 
èsk_ni˚
(
èsk_t
 *
p
);

525 
èsk_cuº
(
èsk_t
 *
p
);

526 
idÀ_˝u
(
˝u
);

528 
yõld
();

533 
exec_domaö
 
deÁu…_exec_domaö
;

535 #i‚de‡
INIT_THREAD_SIZE


536 
	#INIT_THREAD_SIZE
 2048*()

	)

539 
	uthªad_uni⁄
 {

540 
thªad_öfo
 
	mthªad_öfo
;

541 
	m°ack
[
INIT_THREAD_SIZE
/()];

544 #i‚de‡
__HAVE_ARCH_KSTACK_END


545 
ölöe
 
	$k°ack_íd
(*
addr
)

550  !((()
addr
+(*)-1Ë& (
THREAD_SIZE
-(*)));

551 
	}
}

554 
thªad_uni⁄
 
öô_thªad_uni⁄
;

555 
èsk_°ru˘
 
öô_èsk
;

557 
mm_°ru˘
 
öô_mm
;

559 
èsk_°ru˘
 *
föd_èsk_by_pid
(
pid
);

560 
£t_•ecül_pids
(
pid_t
 
£ssi⁄
,Öid_à
pgΩ
);

561 
__£t_•ecül_pids
(
pid_t
 
£ssi⁄
,Öid_à
pgΩ
);

564 
u£r_°ru˘
 * 
Æloc_uid
(
uid_t
);

565 
‰ì_uid
(
u£r_°ru˘
 *);

566 
swôch_uid
(
u£r_°ru˘
 *);

568 
	~<asm/cuºít.h
>

570 
ôimî_ticks
;

571 
ôimî_√xt
;

572 
do_timî
(
±_ªgs
 *);

574 
FASTCALL
(
wake_up_°©e
(
èsk_°ru˘
 * 
tsk
, 
°©e
));

575 
FASTCALL
(
wake_up_¥o˚ss
(
èsk_°ru˘
 * 
tsk
));

576 
FASTCALL
(
wake_up_¥o˚ss_kick
(
èsk_°ru˘
 * 
tsk
));

577 
FASTCALL
(
wake_up_f‹ked_¥o˚ss
(
èsk_°ru˘
 * 
tsk
));

578 
FASTCALL
(
sched_exô
(
èsk_t
 * 
p
));

580 
asmlökage
 
sys_waô4
(
pid_t
 
pid
,* 
°©_addr
, 
›ti⁄s
, 
rußge
 * 
ru
);

582 
ö_group_p
(
gid_t
);

583 
ö_egroup_p
(
gid_t
);

585 
¥oc_ˇches_öô
();

586 
Êush_sig«ls
(
èsk_°ru˘
 *);

587 
Êush_sig«l_h™dÀrs
(
èsk_°ru˘
 *, 
f‹˚_deÁu…
);

588 
dequeue_sig«l
(
èsk_°ru˘
 *
tsk
, 
sig£t_t
 *
mask
, 
sigöfo_t
 *
öfo
);

590 
ölöe
 
	$dequeue_sig«l_lock
(
èsk_°ru˘
 *
tsk
, 
sig£t_t
 *
mask
, 
sigöfo_t
 *
öfo
)

592 
Êags
;

593 
ªt
;

595 
	`•ö_lock_úqßve
(&
tsk
->
sigh™d
->
siglock
, 
Êags
);

596 
ªt
 = 
	`dequeue_sig«l
(
tsk
, 
mask
, 
öfo
);

597 
	`•ö_u∆ock_úqª°‹e
(&
tsk
->
sigh™d
->
siglock
, 
Êags
);

599  
ªt
;

600 
	}
}

602 
block_Æl_sig«ls
((*
nŸifõr
)(*
¥iv
), *priv,

603 
sig£t_t
 *
mask
);

604 
	`unblock_Æl_sig«ls
();

605 
	`ªÀa£_èsk
(
èsk_°ru˘
 * 
p
);

606 
	`£nd_sig_öfo
(, 
sigöfo
 *, 
èsk_°ru˘
 *);

607 
	`£nd_group_sig_öfo
(, 
sigöfo
 *, 
èsk_°ru˘
 *);

608 
	`f‹˚_sig_öfo
(, 
sigöfo
 *, 
èsk_°ru˘
 *);

609 
	`__kûl_pg_öfo
(
sig
, 
sigöfo
 *
öfo
, 
pid_t
 
pgΩ
);

610 
	`kûl_pg_öfo
(, 
sigöfo
 *, 
pid_t
);

611 
	`kûl_¶_öfo
(, 
sigöfo
 *, 
pid_t
);

612 
	`kûl_¥oc_öfo
(, 
sigöfo
 *, 
pid_t
);

613 
	`nŸify_∑ª¡
(
èsk_°ru˘
 *, );

614 
	`do_nŸify_∑ª¡
(
èsk_°ru˘
 *, );

615 
	`f‹˚_sig
(, 
èsk_°ru˘
 *);

616 
	`f‹˚_sig_•ecific
(, 
èsk_°ru˘
 *);

617 
	`£nd_sig
(, 
èsk_°ru˘
 *, );

618 
	`z≠_Ÿhî_thªads
(
èsk_°ru˘
 *
p
);

619 
	`kûl_pg
(
pid_t
, , );

620 
	`kûl_¶
(
pid_t
, , );

621 
	`kûl_¥oc
(
pid_t
, , );

622 
sigqueue
 *
	`sigqueue_Æloc
();

623 
	`sigqueue_‰ì
(
sigqueue
 *);

624 
	`£nd_sigqueue
(, 
sigqueue
 *, 
èsk_°ru˘
 *);

625 
	`£nd_group_sigqueue
(, 
sigqueue
 *, 
èsk_°ru˘
 *);

626 
	`do_siga˘i⁄
(, c⁄° 
k_siga˘i⁄
 *, k_sigaction *);

627 
	`do_sigÆt°ack
(c⁄° 
°ack_t
 
__u£r
 *, stack_t __user *, );

630 
	#SEND_SIG_NOINFO
 ((
sigöfo
 *Ë0)

	)

631 
	#SEND_SIG_PRIV
 ((
sigöfo
 *Ë1)

	)

632 
	#SEND_SIG_FORCED
 ((
sigöfo
 *Ë2)

	)

636 
ölöe
 
	$⁄_sig_°ack
(
•
)

638  (
•
 - 
cuºít
->
ßs_ss_•
 < cuºít->
ßs_ss_size
);

639 
	}
}

641 
ölöe
 
	$ßs_ss_Êags
(
•
)

643  (
cuºít
->
ßs_ss_size
 =0 ? 
SS_DISABLE


644 : 
	`⁄_sig_°ack
(
•
Ë? 
SS_ONSTACK
 : 0);

645 
	}
}

648 #ifde‡
CONFIG_SECURITY


650 
ˇ∑bÀ
(
ˇp
);

652 
ölöe
 
	$ˇ∑bÀ
(
ˇp
)

654 i‡(
	`ˇp_øi£d
(
cuºít
->
ˇp_ef„˘ive
, 
ˇp
)) {

655 
cuºít
->
Êags
 |
PF_SUPERPRIV
;

659 
	}
}

665 
mm_°ru˘
 * 
mm_Æloc
();

668 
ölöe
 
FASTCALL
(
__mmdr›
(
mm_°ru˘
 *));

669 
ölöe
 
	$mmdr›
(
mm_°ru˘
 * 
mm
)

671 i‡(
	`©omic_dec_™d_ã°
(&
mm
->
mm_cou¡
))

672 
	`__mmdr›
(
mm
);

673 
	}
}

676 
mmput
(
mm_°ru˘
 *);

678 
mm_°ru˘
 *
mmgøb
(mm_struct *);

680 
mm_ªÀa£
(
èsk_°ru˘
 *, 
mm_°ru˘
 *);

682 
c›y_thªad
(, , , , 
èsk_°ru˘
 *, 
±_ªgs
 *);

683 
Êush_thªad
();

684 
exô_thªad
();

686 
exô_mm
(
èsk_°ru˘
 *);

687 
exô_fûes
(
èsk_°ru˘
 *);

688 
exô_sig«l
(
èsk_°ru˘
 *);

689 
__exô_sig«l
(
èsk_°ru˘
 *);

690 
exô_sigh™d
(
èsk_°ru˘
 *);

691 
__exô_sigh™d
(
èsk_°ru˘
 *);

692 
exô_ôimîs
(
èsk_°ru˘
 *);

694 
NORET_TYPE
 
do_group_exô
();

696 
ª∑ª¡_to_öô
();

697 
d´m⁄ize
(const *, ...);

698 
Ælow_sig«l
();

699 
dißŒow_sig«l
();

700 
èsk_t
 *
chûd_ª≠î
;

702 
do_execve
(*, 
__u£r
 * __u£∏*, __u£∏* __u£∏*, 
±_ªgs
 *);

703 
do_f‹k
(, , 
±_ªgs
 *, , 
__u£r
 *, __user *);

704 
èsk_°ru˘
 * 
c›y_¥o˚ss
(, , 
±_ªgs
 *, , 
__u£r
 *, __user *);

706 #ifde‡
CONFIG_SMP


707 
waô_èsk_öa˘ive
(
èsk_t
 * 
p
);

709 
	#waô_èsk_öa˘ive
(
p
Ëdÿ{ } 0)

	)

712 
	#ªmove_∑ª¡
(
p
Ë
	`li°_dñ_öô
(&’)->
siblög
)

	)

713 
	#add_∑ª¡
(
p
, 
∑ª¡
Ë
	`li°_add_èû
(&’)->
siblög
,&’¨ít)->
chûdªn
)

	)

715 
	#REMOVE_LINKS
(
p
) do { \

716 i‡(
	`thªad_group_Àadî
(
p
)) \

717 
	`li°_dñ_öô
(&(
p
)->
èsks
); \

718 
	`ªmove_∑ª¡
(
p
); \

719 } 0)

	)

721 
	#SET_LINKS
(
p
) do { \

722 i‡(
	`thªad_group_Àadî
(
p
)) \

723 
	`li°_add_èû
(&(
p
)->
èsks
,&
öô_èsk
.tasks); \

724 
	`add_∑ª¡
(
p
, (p)->
∑ª¡
); \

725 } 0)

	)

727 
	#√xt_èsk
(
p
Ë
	`li°_íåy
(’)->
èsks
.
√xt
, 
èsk_°ru˘
,Åasks)

	)

728 
	#¥ev_èsk
(
p
Ë
	`li°_íåy
(’)->
èsks
.
¥ev
, 
èsk_°ru˘
,Åasks)

	)

730 
	#f‹_óch_¥o˚ss
(
p
) \

731 
p
 = &
öô_èsk
 ; (∞
	`√xt_èsk
’)Ë!&öô_èsk ; )

	)

737 
	#do_óch_thªad
(
g
, 
t
) \

738 
g
 = 
t
 = &
öô_èsk
 ; (g =Å = 
	`√xt_èsk
(g)Ë!&öô_èsk ; ) do

	)

740 
	#whûe_óch_thªad
(
g
, 
t
) \

741 (
t
 = 
	`√xt_thªad
—)Ë!
g
)

	)

743 
èsk_t
 * 
FASTCALL
(
√xt_thªad
—ask_à*
p
));

745 
	#thªad_group_Àadî
(
p
Ë’->
pid
 =p->
tgid
)

	)

747 
ölöe
 
	$thªad_group_em±y
(
èsk_t
 *
p
)

749 
pid
 *pid = 
p
->
pids
[
PIDTYPE_TGID
].
pid±r
;

751  
pid
->
èsk_li°
.
√xt
->next == &pid->task_list;

752 
	}
}

754 
	#dñay_group_Àadî
(
p
) \

755 (
	`thªad_group_Àadî
(
p
Ë&& !
	`thªad_group_em±y
’))

	)

757 
unhash_¥o˚ss
(
èsk_°ru˘
 *
p
);

764 
ölöe
 
	$èsk_lock
(
èsk_°ru˘
 *
p
)

766 
	`•ö_lock
(&
p
->
Æloc_lock
);

767 
	}
}

769 
ölöe
 
	$èsk_u∆ock
(
èsk_°ru˘
 *
p
)

771 
	`•ö_u∆ock
(&
p
->
Æloc_lock
);

772 
	}
}

780 
ölöe
 
mm_°ru˘
 * 
	$gë_èsk_mm
(
èsk_°ru˘
 * 
èsk
)

782 
mm_°ru˘
 * 
mm
;

784 
	`èsk_lock
(
èsk
);

785 
mm
 = 
èsk
->mm;

786 i‡(
mm
)

787 
mm
 = 
	`mmgøb
(mm);

788 
	`èsk_u∆ock
(
èsk
);

790  
mm
;

791 
	}
}

797 
ölöe
 
	$£t_tsk_thªad_Êag
(
èsk_°ru˘
 *
tsk
, 
Êag
)

799 
	`£t_ti_thªad_Êag
(
tsk
->
thªad_öfo
,
Êag
);

800 
	}
}

802 
ölöe
 
	$˛ór_tsk_thªad_Êag
(
èsk_°ru˘
 *
tsk
, 
Êag
)

804 
	`˛ór_ti_thªad_Êag
(
tsk
->
thªad_öfo
,
Êag
);

805 
	}
}

807 
ölöe
 
	$ã°_™d_£t_tsk_thªad_Êag
(
èsk_°ru˘
 *
tsk
, 
Êag
)

809  
	`ã°_™d_£t_ti_thªad_Êag
(
tsk
->
thªad_öfo
,
Êag
);

810 
	}
}

812 
ölöe
 
	$ã°_™d_˛ór_tsk_thªad_Êag
(
èsk_°ru˘
 *
tsk
, 
Êag
)

814  
	`ã°_™d_˛ór_ti_thªad_Êag
(
tsk
->
thªad_öfo
,
Êag
);

815 
	}
}

817 
ölöe
 
	$ã°_tsk_thªad_Êag
(
èsk_°ru˘
 *
tsk
, 
Êag
)

819  
	`ã°_ti_thªad_Êag
(
tsk
->
thªad_öfo
,
Êag
);

820 
	}
}

822 
ölöe
 
	$£t_tsk_√ed_ªsched
(
èsk_°ru˘
 *
tsk
)

824 
	`£t_tsk_thªad_Êag
(
tsk
,
TIF_NEED_RESCHED
);

825 
	}
}

827 
ölöe
 
	$˛ór_tsk_√ed_ªsched
(
èsk_°ru˘
 *
tsk
)

829 
	`˛ór_tsk_thªad_Êag
(
tsk
,
TIF_NEED_RESCHED
);

830 
	}
}

832 
ölöe
 
	$sig«l_≥ndög
(
èsk_°ru˘
 *
p
)

834  
	`u∆ikñy
(
	`ã°_tsk_thªad_Êag
(
p
,
TIF_SIGPENDING
));

835 
	}
}

837 
ölöe
 
	$√ed_ªsched
()

839  
	`u∆ikñy
(
	`ã°_thªad_Êag
(
TIF_NEED_RESCHED
));

840 
	}
}

842 
__c⁄d_ªsched
();

843 
ölöe
 
	$c⁄d_ªsched
()

845 i‡(
	`√ed_ªsched
())

846 
	`__c⁄d_ªsched
();

847 
	}
}

857 
ölöe
 
	$c⁄d_ªsched_lock
(
•ölock_t
 * 
lock
)

859 i‡(
	`√ed_ªsched
()) {

860 
	`_øw_•ö_u∆ock
(
lock
);

861 
	`¥ìm±_íabÀ_no_ªsched
();

862 
	`__c⁄d_ªsched
();

863 
	`•ö_lock
(
lock
);

865 
	}
}

871 
FASTCALL
(
ªˇlc_sig≥ndög_tsk
(
èsk_°ru˘
 *
t
));

872 
ªˇlc_sig≥ndög
();

874 
sig«l_wake_up
(
èsk_°ru˘
 *
t
, 
ªsume_°›≥d
);

879 #ifde‡
CONFIG_SMP


881 
ölöe
 
	$èsk_˝u
(
èsk_°ru˘
 *
p
)

883  
p
->
thªad_öfo
->
˝u
;

884 
	}
}

886 
ölöe
 
	$£t_èsk_˝u
(
èsk_°ru˘
 *
p
, 
˝u
)

888 
p
->
thªad_öfo
->
˝u
 = cpu;

889 
	}
}

893 
ölöe
 
	$èsk_˝u
(
èsk_°ru˘
 *
p
)

896 
	}
}

898 
ölöe
 
	$£t_èsk_˝u
(
èsk_°ru˘
 *
p
, 
˝u
)

900 
	}
}

	@/usr/include/linux/slab.h

7 #if !
deföed
(
_LINUX_SLAB_H
)

8 
	#_LINUX_SLAB_H


	)

10 #if 
deföed
(
__KERNEL__
)

12 
kmem_ˇche_s
 
	tkmem_ˇche_t
;

14 
	~<löux/c⁄fig.h
>

15 
	~<löux/gÂ.h
>

16 
	~<löux/ty≥s.h
>

17 
	~<asm/∑ge.h
>

18 
	~<asm/ˇche.h
>

21 
	#SLAB_NOFS
 
GFP_NOFS


	)

22 
	#SLAB_NOIO
 
GFP_NOIO


	)

23 
	#SLAB_ATOMIC
 
GFP_ATOMIC


	)

24 
	#SLAB_USER
 
GFP_USER


	)

25 
	#SLAB_KERNEL
 
GFP_KERNEL


	)

26 
	#SLAB_DMA
 
GFP_DMA


	)

28 
	#SLAB_LEVEL_MASK
 (
__GFP_WAIT
|
__GFP_HIGH
|
__GFP_IO
|
__GFP_FS
|\

29 
__GFP_COLD
|
__GFP_NOWARN
|
__GFP_REPEAT
|\

30 
__GFP_NOFAIL
|
__GFP_NORETRY
)

	)

32 
	#SLAB_NO_GROW
 
__GFP_NO_GROW


	)

38 
	#SLAB_DEBUG_FREE
 0x00000100UL

	)

39 
	#SLAB_DEBUG_INITIAL
 0x00000200UL

	)

40 
	#SLAB_RED_ZONE
 0x00000400UL

	)

41 
	#SLAB_POISON
 0x00000800UL

	)

42 
	#SLAB_NO_REAP
 0x00001000UL

	)

43 
	#SLAB_HWCACHE_ALIGN
 0x00002000UL

	)

44 
	#SLAB_CACHE_DMA
 0x00004000UL

	)

45 
	#SLAB_MUST_HWCACHE_ALIGN
 0x00008000UL

	)

46 
	#SLAB_STORE_USER
 0x00010000UL

	)

47 
	#SLAB_RECLAIM_ACCOUNT
 0x00020000UL

	)

51 
	#SLAB_CTOR_CONSTRUCTOR
 0x001UL

	)

52 
	#SLAB_CTOR_ATOMIC
 0x002UL

	)

53 
	#SLAB_CTOR_VERIFY
 0x004UL

	)

56 
kmem_ˇche_öô
();

58 
kmem_ˇche_t
 *
kmem_föd_gíîÆ_ˇchï
(
size_t
, 
gÂÊags
);

59 
kmem_ˇche_t
 *
kmem_ˇche_¸óã
(c⁄° *, 
size_t
, size_t, ,

60 (*)(*, 
kmem_ˇche_t
 *, ),

61 (*)(*, 
kmem_ˇche_t
 *, ));

62 
	`kmem_ˇche_de°roy
(
kmem_ˇche_t
 *);

63 
	`kmem_ˇche_shrök
(
kmem_ˇche_t
 *);

64 *
	`kmem_ˇche_Æloc
(
kmem_ˇche_t
 *, );

65 
	`kmem_ˇche_‰ì
(
kmem_ˇche_t
 *, *);

66 
	`kmem_ˇche_size
(
kmem_ˇche_t
 *);

69 
	sˇche_sizes
 {

70 
size_t
 
cs_size
;

71 
kmem_ˇche_t
 *
cs_ˇchï
;

72 
kmem_ˇche_t
 *
cs_dmaˇchï
;

74 
ˇche_sizes
 
mÆloc_sizes
[];

75 *
	`__kmÆloc
(
size_t
, );

77 
ölöe
 *
	$kmÆloc
(
size_t
 
size
, 
Êags
)

79 i‡(
	`__buûtö_c⁄°™t_p
(
size
)) {

80 
i
 = 0;

81 
	#CACHE
(
x
) \

82 i‡(
size
 <
x
) \

83 
found
; \

85 
i
++;

	)

86 
	~"kmÆloc_sizes.h
"

87 #unde‡
CACHE


89 
	`__you_ˇ¬Ÿ_kmÆloc_th©_much
();

90 
	`__you_ˇ¬Ÿ_kmÆloc_th©_much
();

92 
found
:

93  
	`kmem_ˇche_Æloc
((
Êags
 & 
GFP_DMA
) ?

94 
mÆloc_sizes
[
i
].
cs_dmaˇchï
 :

95 
mÆloc_sizes
[
i
].
cs_ˇchï
, 
Êags
);

97  
	`__kmÆloc
(
size
, 
Êags
);

98 
	}
}

100 
k‰ì
(const *);

101 
ksize
(const *);

103 
FASTCALL
(
kmem_ˇche_ª≠
());

106 
kmem_ˇche_t
 *
vm_¨ó_ˇchï
;

107 
kmem_ˇche_t
 *
mm_ˇchï
;

108 
kmem_ˇche_t
 *
«mes_ˇchï
;

109 
kmem_ˇche_t
 *
fûes_ˇchï
;

110 
kmem_ˇche_t
 *
fûp_ˇchï
;

111 
kmem_ˇche_t
 *
dquŸ_ˇchï
;

112 
kmem_ˇche_t
 *
fs_ˇchï
;

113 
kmem_ˇche_t
 *
sig«l_ˇchï
;

114 
kmem_ˇche_t
 *
sigh™d_ˇchï
;

115 
kmem_ˇche_t
 *
bio_ˇchï
;

117 
±röfo
(
addr
);

119 
©omic_t
 
¶ab_ª˛aim_∑ges
;

	@/usr/include/linux/smp.h

1 #i‚de‡
__LINUX_SMP_H


2 
	#__LINUX_SMP_H


	)

9 
	~<löux/c⁄fig.h
>

11 #ifde‡
CONFIG_SMP


13 
	~<löux/¥ìm±.h
>

14 
	~<löux/kî√l.h
>

15 
	~<löux/compûî.h
>

16 
	~<löux/thªad_öfo.h
>

17 
	~<asm/smp.h
>

18 
	~<asm/bug.h
>

28 
smp_£nd_°›
();

33 
FASTCALL
(
smp_£nd_ªscheduÀ
(
˝u
));

39 
smp_¥ï¨e_˝us
(
max_˝us
);

44 
__˝u_up
(
˝unum
);

49 
smp_˝us_d⁄e
(
max_˝us
);

54 
smp_ˇŒ_fun˘i⁄
 ((*
func
Ë(*
öfo
), *info,

55 
ªåy
, 
waô
);

60 
ölöe
 
	`⁄_óch_˝u
((*
func
Ë(*
öfo
), *info,

61 
ªåy
, 
waô
)

63 
ªt
 = 0;

65 
	`¥ìm±_dißbÀ
();

66 
ªt
 = 
	`smp_ˇŒ_fun˘i⁄
(
func
, 
öfo
, 
ªåy
, 
waô
);

67 
	`func
(
öfo
);

68 
	`¥ìm±_íabÀ
();

69  
ªt
;

70 
	}
}

75 
smp_thªads_ªady
;

77 
	#MSG_ALL_BUT_SELF
 0x8000

	)

78 
	#MSG_ALL
 0x8001

	)

80 
	#MSG_INVALIDATE_TLB
 0x0001

	)

81 
	#MSG_STOP_CPU
 0x0002

	)

84 
	#MSG_RESCHEDULE
 0x0003

	)

85 
	#MSG_CALL_FUNCTION
 0x0004

	)

91 
smp_¥ï¨e_boŸ_˝u
();

99 
	#smp_¥o˚ss‹_id
(Ë0

	)

100 
	#h¨d_smp_¥o˚ss‹_id
(Ë0

	)

101 
	#smp_thªads_ªady
 1

	)

102 
	#smp_ˇŒ_fun˘i⁄
(
func
,
öfo
,
ªåy
,
waô
Ë({ 0; })

	)

103 
	#⁄_óch_˝u
(
func
,
öfo
,
ªåy
,
waô
Ë({ 
	`func
(öfo); 0; })

	)

104 
ölöe
 
	$smp_£nd_ªscheduÀ
(
˝u
Ë{ 
	}
}

105 
	#num_boŸög_˝us
(Ë1

	)

106 
	#˝u_possibÀ
(
˝u
Ë({ 
	`BUG_ON
((˝uË!0); 1; })

	)

107 
	#smp_¥ï¨e_boŸ_˝u
(Ëdÿ{} 0)

	)

111 
	#gë_˝u
(Ë({ 
	`¥ìm±_dißbÀ
(); 
	`smp_¥o˚ss‹_id
(); })

	)

112 
	#put_˝u
(Ë
	`¥ìm±_íabÀ
()

	)

113 
	#put_˝u_no_ªsched
(Ë
	`¥ìm±_íabÀ_no_ªsched
()

	)

	@/usr/include/linux/string.h

1 #i‚de‡
_LINUX_STRING_H_


2 
	#_LINUX_STRING_H_


	)

6 #ifde‡
__KERNEL__


8 
	~<löux/ty≥s.h
>

9 
	~<löux/°ddef.h
>

11 #ifde‡
__˝lu•lus


15 * 
°Ωbrk
(const *,const *);

16 * 
°r£p
(**,const *);

17 
__kî√l_size_t
 
°r•n
(const *,const *);

18 
__kî√l_size_t
 
°rc•n
(const *,const *);

23 
	~<asm/°rög.h
>

25 #i‚de‡
__HAVE_ARCH_STRCPY


26 * 
°r˝y
(*,const *);

28 #i‚de‡
__HAVE_ARCH_STRNCPY


29 * 
°∫˝y
(*,c⁄° *, 
__kî√l_size_t
);

31 #i‚de‡
__HAVE_ARCH_STRLCPY


32 
size_t
 
°æ˝y
(*, const *, size_t);

34 #i‚de‡
__HAVE_ARCH_STRCAT


35 * 
°rˇt
(*, const *);

37 #i‚de‡
__HAVE_ARCH_STRNCAT


38 * 
°∫ˇt
(*, c⁄° *, 
__kî√l_size_t
);

40 #i‚de‡
__HAVE_ARCH_STRLCAT


41 
size_t
 
°æˇt
(*, c⁄° *, 
__kî√l_size_t
);

43 #i‚de‡
__HAVE_ARCH_STRCMP


44 
°rcmp
(const *,const *);

46 #i‚de‡
__HAVE_ARCH_STRNCMP


47 
°∫cmp
(c⁄° *,c⁄° *,
__kî√l_size_t
);

49 #i‚de‡
__HAVE_ARCH_STRNICMP


50 
°∫icmp
(c⁄° *, c⁄° *, 
__kî√l_size_t
);

52 #i‚de‡
__HAVE_ARCH_STRCHR


53 * 
°rchr
(const *,);

55 #i‚de‡
__HAVE_ARCH_STRRCHR


56 * 
°ºchr
(const *,);

58 #i‚de‡
__HAVE_ARCH_STRSTR


59 * 
°r°r
(const *,const *);

61 #i‚de‡
__HAVE_ARCH_STRLEN


62 
__kî√l_size_t
 
°æí
(const *);

64 #i‚de‡
__HAVE_ARCH_STRNLEN


65 
__kî√l_size_t
 
°∫Àn
(const *,__kernel_size_t);

68 #i‚de‡
__HAVE_ARCH_MEMSET


69 * 
mem£t
(*,,
__kî√l_size_t
);

71 #i‚de‡
__HAVE_ARCH_MEMCPY


72 * 
mem˝y
(*,c⁄° *,
__kî√l_size_t
);

74 #i‚de‡
__HAVE_ARCH_MEMMOVE


75 * 
memmove
(*,c⁄° *,
__kî√l_size_t
);

77 #i‚de‡
__HAVE_ARCH_MEMSCAN


78 * 
memsˇn
(*,,
__kî√l_size_t
);

80 #i‚de‡
__HAVE_ARCH_MEMCMP


81 
memcmp
(c⁄° *,c⁄° *,
__kî√l_size_t
);

83 #i‚de‡
__HAVE_ARCH_MEMCHR


84 * 
memchr
(c⁄° *,,
__kî√l_size_t
);

87 #ifde‡
__˝lu•lus


	@/usr/include/asm-generic/percpu.h

1 #i‚de‡
_ASM_GENERIC_PERCPU_H_


2 
	#_ASM_GENERIC_PERCPU_H_


	)

3 
	~<löux/compûî.h
>

5 
	#__GENERIC_PER_CPU


	)

6 #ifde‡
CONFIG_SMP


8 
__≥r_˝u_off£t
[
NR_CPUS
];

11 
	#DEFINE_PER_CPU
(
ty≥
, 
«me
) \

12 
	`__©åibuã__
((
	`__£˘i⁄__
(".d©a.≥r˝u"))Ë
	`__ty≥of__
(
ty≥
Ë
≥r_˝u__
##
«me


	)

15 
	#≥r_˝u
(
v¨
, 
˝u
Ë(*
	`RELOC_HIDE
(&
≥r_˝u__
##v¨, 
__≥r_˝u_off£t
[˝u]))

	)

16 
	#__gë_˝u_v¨
(
v¨
Ë
	`≥r_˝u
(v¨, 
	`smp_¥o˚ss‹_id
())

	)

19 
	#≥r˝u_modc›y
(
p˝ud°
, 
§c
, 
size
) \

21 
__i
; \

22 
__i
 = 0; __ò< 
NR_CPUS
; __i++) \

23 i‡(
	`˝u_possibÀ
(
__i
)) \

24 
	`mem˝y
((
p˝ud°
)+
__≥r_˝u_off£t
[
__i
], \

25 (
§c
), (
size
)); \

26 } 0)

	)

29 
	#DEFINE_PER_CPU
(
ty≥
, 
«me
) \

30 
	`__ty≥of__
(
ty≥
Ë
≥r_˝u__
##
«me


	)

32 
	#≥r_˝u
(
v¨
, 
˝u
Ë(()˝u, 
≥r_˝u__
##v¨)

	)

33 
	#__gë_˝u_v¨
(
v¨
Ë
≥r_˝u__
##
	)
var

37 
	#DECLARE_PER_CPU
(
ty≥
, 
«me
Ë
	`__ty≥of__
—y≥Ë
≥r_˝u__
##
	)
name

39 
	#EXPORT_PER_CPU_SYMBOL
(
v¨
Ë
	`EXPORT_SYMBOL
(
≥r_˝u__
##v¨)

	)

40 
	#EXPORT_PER_CPU_SYMBOL_GPL
(
v¨
Ë
	`EXPORT_SYMBOL_GPL
(
≥r_˝u__
##v¨)

	)

	@/usr/include/asm/current.h

1 #i‚de‡
_I386_CURRENT_H


2 
	#_I386_CURRENT_H


	)

4 
	~<löux/thªad_öfo.h
>

6 
	gèsk_°ru˘
;

8 
ölöe
 
èsk_°ru˘
 * 
	$gë_cuºít
()

10  
	`cuºít_thªad_öfo
()->
èsk
;

11 
	}
}

13 
	#cuºít
 
	`gë_cuºít
()

	)

	@/usr/include/asm/elf.h

1 #i‚de‡
__ASMi386_ELF_H


2 
	#__ASMi386_ELF_H


	)

8 
	~<asm/±ø˚.h
>

9 
	~<asm/u£r.h
>

10 
	~<asm/¥o˚ss‹.h
>

11 
	~<asm/sy°em.h
>

13 
	~<löux/ut¢ame.h
>

15 
	#R_386_NONE
 0

	)

16 
	#R_386_32
 1

	)

17 
	#R_386_PC32
 2

	)

18 
	#R_386_GOT32
 3

	)

19 
	#R_386_PLT32
 4

	)

20 
	#R_386_COPY
 5

	)

21 
	#R_386_GLOB_DAT
 6

	)

22 
	#R_386_JMP_SLOT
 7

	)

23 
	#R_386_RELATIVE
 8

	)

24 
	#R_386_GOTOFF
 9

	)

25 
	#R_386_GOTPC
 10

	)

26 
	#R_386_NUM
 11

	)

28 
	tñf_gªg_t
;

30 
	#ELF_NGREG
 ( (
u£r_ªgs_°ru˘
Ë/ (
ñf_gªg_t
))

	)

31 
ñf_gªg_t
 
	tñf_gªg£t_t
[
ELF_NGREG
];

33 
u£r_i387_°ru˘
 
	tñf_Âªg£t_t
;

34 
u£r_fx§_°ru˘
 
	tñf_Âxªg£t_t
;

39 
	#ñf_check_¨ch
(
x
) \

40 (((
x
)->
e_machöe
 =
EM_386
Ë|| ((x)->e_machöê=
EM_486
))

	)

45 
	#ELF_CLASS
 
ELFCLASS32


	)

46 
	#ELF_DATA
 
ELFDATA2LSB


	)

47 
	#ELF_ARCH
 
EM_386


	)

59 
	#ELF_PLAT_INIT
(
_r
, 
lﬂd_addr
) do { \

60 
_r
->
ebx
 = 0; _r->
ecx
 = 0; _r->
edx
 = 0; \

61 
_r
->
esi
 = 0; _r->
edi
 = 0; _r->
ebp
 = 0; \

62 
_r
->
óx
 = 0; \

63 } 0)

	)

65 
	#USE_ELF_CORE_DUMP


	)

66 
	#ELF_EXEC_PAGESIZE
 4096

	)

73 
	#ELF_ET_DYN_BASE
 (
TASK_SIZE
 / 3 * 2)

	)

78 
	#ELF_CORE_COPY_REGS
(
¥_ªg
, 
ªgs
) \

79 
¥_ªg
[0] = 
ªgs
->
ebx
; \

80 
¥_ªg
[1] = 
ªgs
->
ecx
; \

81 
¥_ªg
[2] = 
ªgs
->
edx
; \

82 
¥_ªg
[3] = 
ªgs
->
esi
; \

83 
¥_ªg
[4] = 
ªgs
->
edi
; \

84 
¥_ªg
[5] = 
ªgs
->
ebp
; \

85 
¥_ªg
[6] = 
ªgs
->
óx
; \

86 
¥_ªg
[7] = 
ªgs
->
xds
; \

87 
¥_ªg
[8] = 
ªgs
->
xes
; \

88 
	`ßve£gmít
(
fs
,
¥_ªg
[9]); \

89 
	`ßve£gmít
(
gs
,
¥_ªg
[10]); \

90 
¥_ªg
[11] = 
ªgs
->
‹ig_óx
; \

91 
¥_ªg
[12] = 
ªgs
->
eù
; \

92 
¥_ªg
[13] = 
ªgs
->
xcs
; \

93 
¥_ªg
[14] = 
ªgs
->
eÊags
; \

94 
¥_ªg
[15] = 
ªgs
->
e•
; \

95 
¥_ªg
[16] = 
ªgs
->
xss
;

	)

101 
	#ELF_HWCAP
 (
boŸ_˝u_d©a
.
x86_ˇ∑bûôy
[0])

	)

110 
	#ELF_PLATFORM
 (
sy°em_ut¢ame
.
machöe
)

	)

116 
	#AT_SYSINFO
 32

	)

117 
	#AT_SYSINFO_EHDR
 33

	)

119 #ifde‡
__KERNEL__


120 
	#SET_PERSONALITY
(
ex
, 
ibcs2
Ë
	`£t_≥rs⁄Æôy
((ibcs2)?
PER_SVR4
:
PER_LINUX
)

	)

122 
dump_èsk_ªgs
 (
èsk_°ru˘
 *, 
ñf_gªg£t_t
 *);

123 
dump_èsk_Âu
 (
èsk_°ru˘
 *, 
ñf_Âªg£t_t
 *);

124 
dump_èsk_exãnded_Âu
 (
èsk_°ru˘
 *, 
u£r_fx§_°ru˘
 *);

126 
	#ELF_CORE_COPY_TASK_REGS
(
tsk
, 
ñf_ªgs
Ë
	`dump_èsk_ªgs
—sk,Élf_ªgs)

	)

127 
	#ELF_CORE_COPY_FPREGS
(
tsk
, 
ñf_Âªgs
Ë
	`dump_èsk_Âu
—sk,Élf_Âªgs)

	)

128 
	#ELF_CORE_COPY_XFPREGS
(
tsk
, 
ñf_xÂªgs
Ë
	`dump_èsk_exãnded_Âu
—sk,Élf_xÂªgs)

	)

130 
	#VSYSCALL_BASE
 (
	`__fix_to_vút
(
FIX_VSYSCALL
))

	)

131 
	#VSYSCALL_EHDR
 ((c⁄° 
ñfhdr
 *Ë
VSYSCALL_BASE
)

	)

132 
	#VSYSCALL_ENTRY
 ((Ë&
__kî√l_vsysˇŒ
)

	)

133 
__kî√l_vsysˇŒ
;

135 
	#ARCH_DLINFO
 \

137 
	`NEW_AUX_ENT
(
AT_SYSINFO
, 
VSYSCALL_ENTRY
); \

138 
	`NEW_AUX_ENT
(
AT_SYSINFO_EHDR
, 
VSYSCALL_BASE
); \

139 } 0)

	)

149 
	#ELF_CORE_EXTRA_PHDRS
 (
VSYSCALL_EHDR
->
e_phnum
)

	)

150 
	#ELF_CORE_WRITE_EXTRA_PHDRS
 \

152 c⁄° 
ñf_phdr
 *c⁄° 
vsysˇŒ_phdrs
 = \

153 (c⁄° 
ñf_phdr
 *Ë(
VSYSCALL_BASE
 \

154 + 
VSYSCALL_EHDR
->
e_phoff
); \

155 
i
; \

156 
Elf32_Off
 
ofs
 = 0; \

157 
i
 = 0; i < 
VSYSCALL_EHDR
->
e_phnum
; ++i) { \

158 
ñf_phdr
 
phdr
 = 
vsysˇŒ_phdrs
[
i
]; \

159 i‡(
phdr
.
p_ty≥
 =
PT_LOAD
) { \

160 
	`BUG_ON
(
ofs
 != 0); \

161 
ofs
 = 
phdr
.
p_off£t
 = 
off£t
; \

162 
phdr
.
p_memsz
 = 
	`PAGE_ALIGN
(phdr.p_memsz); \

163 
phdr
.
p_fûesz
 =Öhdr.
p_memsz
; \

164 
off£t
 +
phdr
.
p_fûesz
; \

167 
phdr
.
p_off£t
 +
ofs
; \

168 
phdr
.
p_∑ddr
 = 0; \

169 
	`DUMP_WRITE
(&
phdr
, (phdr)); \

171 } 0)

	)

172 
	#ELF_CORE_WRITE_EXTRA_DATA
 \

174 c⁄° 
ñf_phdr
 *c⁄° 
vsysˇŒ_phdrs
 = \

175 (c⁄° 
ñf_phdr
 *Ë(
VSYSCALL_BASE
 \

176 + 
VSYSCALL_EHDR
->
e_phoff
); \

177 
i
; \

178 
i
 = 0; i < 
VSYSCALL_EHDR
->
e_phnum
; ++i) { \

179 i‡(
vsysˇŒ_phdrs
[
i
].
p_ty≥
 =
PT_LOAD
) \

180 
	`DUMP_WRITE
((*Ë
vsysˇŒ_phdrs
[
i
].
p_vaddr
, \

181 
	`PAGE_ALIGN
(
vsysˇŒ_phdrs
[
i
].
p_memsz
)); \

183 } 0)

	)

	@/usr/include/asm/mmu.h

1 #i‚de‡
__i386_MMU_H


2 
	#__i386_MMU_H


	)

4 
	~<asm/£m≠h‹e.h
>

12 
	msize
;

13 
£m≠h‹e
 
	m£m
;

14 *
	mldt
;

15 } 
	tmm_c⁄ãxt_t
;

	@/usr/include/asm/ptrace.h

1 #i‚de‡
_I386_PTRACE_H


2 
	#_I386_PTRACE_H


	)

4 
	#EBX
 0

	)

5 
	#ECX
 1

	)

6 
	#EDX
 2

	)

7 
	#ESI
 3

	)

8 
	#EDI
 4

	)

9 
	#EBP
 5

	)

10 
	#EAX
 6

	)

11 
	#DS
 7

	)

12 
	#ES
 8

	)

13 
	#FS
 9

	)

14 
	#GS
 10

	)

15 
	#ORIG_EAX
 11

	)

16 
	#EIP
 12

	)

17 
	#CS
 13

	)

18 
	#EFL
 14

	)

19 
	#UESP
 15

	)

20 
	#SS
 16

	)

21 
	#FRAME_SIZE
 17

	)

26 
	s±_ªgs
 {

27 
	mebx
;

28 
	mecx
;

29 
	medx
;

30 
	mesi
;

31 
	medi
;

32 
	mebp
;

33 
	móx
;

34 
	mxds
;

35 
	mxes
;

36 
	m‹ig_óx
;

37 
	meù
;

38 
	mxcs
;

39 
	meÊags
;

40 
	me•
;

41 
	mxss
;

45 
	#PTRACE_GETREGS
 12

	)

46 
	#PTRACE_SETREGS
 13

	)

47 
	#PTRACE_GETFPREGS
 14

	)

48 
	#PTRACE_SETFPREGS
 15

	)

49 
	#PTRACE_GETFPXREGS
 18

	)

50 
	#PTRACE_SETFPXREGS
 19

	)

52 
	#PTRACE_OLDSETOPTIONS
 21

	)

54 
	#PTRACE_GET_THREAD_AREA
 25

	)

55 
	#PTRACE_SET_THREAD_AREA
 26

	)

57 #ifde‡
__KERNEL__


58 
	#u£r_mode
(
ªgs
Ë((
VM_MASK
 & (ªgs)->
eÊags
Ë|| (3 & (ªgs)->
xcs
))

	)

59 
	#ö°ru˘i⁄_poöãr
(
ªgs
Ë(‘egs)->
eù
)

	)

	@/usr/include/asm/smp.h

1 #i‚de‡
__ASM_SMP_H


2 
	#__ASM_SMP_H


	)

7 #i‚de‡
__ASSEMBLY__


8 
	~<löux/c⁄fig.h
>

9 
	~<löux/kî√l.h
>

10 
	~<löux/thªads.h
>

11 
	~<löux/˝umask.h
>

14 #ifde‡
CONFIG_X86_LOCAL_APIC


15 #i‚de‡
__ASSEMBLY__


16 
	~<asm/fixm≠.h
>

17 
	~<asm/bô›s.h
>

18 
	~<asm/mp•ec.h
>

19 #ifde‡
CONFIG_X86_IO_APIC


20 
	~<asm/io_≠ic.h
>

22 
	~<asm/≠ic.h
>

26 
	#BAD_APICID
 0xFFu

	)

27 #ifde‡
CONFIG_SMP


28 #i‚de‡
__ASSEMBLY__


34 
smp_Æloc_mem‹y
();

35 
pic_mode
;

36 
smp_num_siblögs
;

37 
˝u_siblög_m≠
[];

39 
smp_Êush_éb
();

40 
smp_mesßge_úq
(
˝l
, *
dev_id
, 
±_ªgs
 *
ªgs
);

41 
smp_£nd_ªscheduÀ
(
˝u
);

42 
smp_övÆid©e_rcv
();

43 (*
mår_hook
) ();

44 
	`z≠_low_m≠pögs
 ();

46 
	#MAX_APICID
 256

	)

53 
	#smp_¥o˚ss‹_id
(Ë(
	`cuºít_thªad_öfo
()->
˝u
)

	)

55 
˝umask_t
 
˝u_ˇŒout_m≠
;

57 
	#˝u_possibÀ
(
˝u
Ë
	`˝u_is£t
(˝u, 
˝u_ˇŒout_m≠
)

	)

60 
ölöe
 
	$num_boŸög_˝us
()

62  
	`˝us_weight
(
˝u_ˇŒout_m≠
);

63 
	}
}

65 
m≠_˝u_to_logiˇl_≠icid
();

66 
unm≠_˝u_to_logiˇl_≠icid
(
˝u
);

68 #ifde‡
CONFIG_X86_LOCAL_APIC


70 #ifde‡
APIC_DEFINITION


71 
h¨d_smp_¥o˚ss‹_id
();

73 
	~<mach_≠icdef.h
>

74 
ölöe
 
	$h¨d_smp_¥o˚ss‹_id
()

77  
	`GET_APIC_ID
(*(*)(
APIC_BASE
+
APIC_ID
));

78 
	}
}

81 
__ölöe
 
	$logiˇl_smp_¥o˚ss‹_id
()

84  
	`GET_APIC_LOGICAL_ID
(*(*)(
APIC_BASE
+
APIC_LDR
));

85 
	}
}

90 
	#NO_PROC_ID
 0xFF

	)

	@/usr/include/asm/string.h

1 #i‚de‡
_I386_STRING_H_


2 
	#_I386_STRING_H_


	)

4 #ifde‡
__KERNEL__


5 
	~<löux/c⁄fig.h
>

26 
	#__HAVE_ARCH_STRCPY


	)

27 
ölöe
 * 
	$°r˝y
(* 
de°
,c⁄° *
§c
)

29 
d0
, 
d1
, 
d2
;

30 
__asm__
 
	`__vﬁ©ûe__
(

35 : "=&S" (
d0
), "=&D" (
d1
), "=&a" (
d2
)

36 :"0" (
§c
),"1" (
de°
) : "memory");

37  
de°
;

38 
	}
}

40 
	#__HAVE_ARCH_STRNCPY


	)

41 
ölöe
 * 
	$°∫˝y
(* 
de°
,c⁄° *
§c
,
size_t
 
cou¡
)

43 
d0
, 
d1
, 
d2
, 
d3
;

44 
__asm__
 
	`__vﬁ©ûe__
(

54 : "=&S" (
d0
), "=&D" (
d1
), "=&c" (
d2
), "=&a" (
d3
)

55 :"0" (
§c
),"1" (
de°
),"2" (
cou¡
) : "memory");

56  
de°
;

57 
	}
}

59 
	#__HAVE_ARCH_STRCAT


	)

60 
ölöe
 * 
	$°rˇt
(* 
de°
,c⁄° * 
§c
)

62 
d0
, 
d1
, 
d2
, 
d3
;

63 
__asm__
 
	`__vﬁ©ûe__
(

71 : "=&S" (
d0
), "=&D" (
d1
), "=&a" (
d2
), "=&c" (
d3
)

72 : "0" (
§c
), "1" (
de°
), "2" (0), "3" (0xffffffffu):"memory");

73  
de°
;

74 
	}
}

76 
	#__HAVE_ARCH_STRNCAT


	)

77 
ölöe
 * 
	$°∫ˇt
(* 
de°
,c⁄° * 
§c
,
size_t
 
cou¡
)

79 
d0
, 
d1
, 
d2
, 
d3
;

80 
__asm__
 
	`__vﬁ©ûe__
(

93 : "=&S" (
d0
), "=&D" (
d1
), "=&a" (
d2
), "=&c" (
d3
)

94 : "0" (
§c
),"1" (
de°
),"2" (0),"3" (0xffffffffu), "g" (
cou¡
)

96  
de°
;

97 
	}
}

99 
	#__HAVE_ARCH_STRCMP


	)

100 
ölöe
 
	$°rcmp
(c⁄° * 
cs
,c⁄° * 
˘
)

102 
d0
, 
d1
;

103 
__ªs
;

104 
__asm__
 
	`__vﬁ©ûe__
(

115 :"˜" (
__ªs
), "=&S" (
d0
), "=&D" (
d1
)

116 :"1" (
cs
),"2" (
˘
));

117  
__ªs
;

118 
	}
}

120 
	#__HAVE_ARCH_STRNCMP


	)

121 
ölöe
 
	$°∫cmp
(c⁄° * 
cs
,c⁄° * 
˘
,
size_t
 
cou¡
)

123 
__ªs
;

124 
d0
, 
d1
, 
d2
;

125 
__asm__
 
	`__vﬁ©ûe__
(

138 :"˜" (
__ªs
), "=&S" (
d0
), "=&D" (
d1
), "=&c" (
d2
)

139 :"1" (
cs
),"2" (
˘
),"3" (
cou¡
));

140  
__ªs
;

141 
	}
}

143 
	#__HAVE_ARCH_STRCHR


	)

144 
ölöe
 * 
	$°rchr
(c⁄° * 
s
, 
c
)

146 
d0
;

147 * 
__ªs
;

148 
__asm__
 
	`__vﬁ©ûe__
(

158 :"˜" (
__ªs
), "=&S" (
d0
Ë: "1" (
s
),"0" (
c
));

159  
__ªs
;

160 
	}
}

162 
	#__HAVE_ARCH_STRRCHR


	)

163 
ölöe
 * 
	$°ºchr
(c⁄° * 
s
, 
c
)

165 
d0
, 
d1
;

166 * 
__ªs
;

167 
__asm__
 
	`__vﬁ©ûe__
(

175 :"=g" (
__ªs
), "=&S" (
d0
), "=&a" (
d1
Ë:"0" (0),"1" (
s
),"2" (
c
));

176  
__ªs
;

177 
	}
}

179 
	#__HAVE_ARCH_STRLEN


	)

180 
ölöe
 
size_t
 
	$°æí
(c⁄° * 
s
)

182 
d0
;

183 
__ªs
;

184 
__asm__
 
	`__vﬁ©ûe__
(

189 :"=c" (
__ªs
), "=&D" (
d0
Ë:"1" (
s
),"a" (0), "0" (0xffffffffu));

190  
__ªs
;

191 
	}
}

193 
ölöe
 * 
	$__mem˝y
(* 
to
, c⁄° * 
‰om
, 
size_t
 
n
)

195 
d0
, 
d1
, 
d2
;

196 
__asm__
 
	`__vﬁ©ûe__
(

205 : "=&c" (
d0
), "=&D" (
d1
), "=&S" (
d2
)

206 :"0" (
n
/4), "q" (n),"1" ((Ë
to
),"2" ((Ë
‰om
)

208  (
to
);

209 
	}
}

215 
ölöe
 * 
	$__c⁄°™t_mem˝y
(* 
to
, c⁄° * 
‰om
, 
size_t
 
n
)

217 i‡(
n
 <= 128)

218  
	`__buûtö_mem˝y
(
to
, 
‰om
, 
n
);

220 
	#COMMON
(
x
) \

221 
__asm__
 
	`__vﬁ©ûe__
( \

223 
x
 \

224 : "=&c" (
d0
), "=&D" (
d1
), "=&S" (
d2
) \

225 : "0" (
n
/4),"1" ((Ë
to
),"2" ((Ë
‰om
) \

226 : "mem‹y");

	)

228 
d0
, 
d1
, 
d2
;

229 
n
 % 4) {

230 0: 
	`COMMON
("");  
to
;

231 1: 
	`COMMON
("\n\tmovsb");  
to
;

232 2: 
	`COMMON
("\n\tmovsw");  
to
;

233 : 
	`COMMON
("\n\tmovsw\n\tmovsb");  
to
;

237 #unde‡
COMMON


238 
	}
}

240 
	#__HAVE_ARCH_MEMCPY


	)

242 #ifde‡
CONFIG_X86_USE_3DNOW


244 
	~<asm/mmx.h
>

250 
ölöe
 * 
	$__c⁄°™t_mem˝y3d
(* 
to
, c⁄° * 
‰om
, 
size_t
 
Àn
)

252 i‡(
Àn
 < 512)

253  
	`__c⁄°™t_mem˝y
(
to
, 
‰om
, 
Àn
);

254  
	`_mmx_mem˝y
(
to
, 
‰om
, 
Àn
);

255 
	}
}

257 
__ölöe__
 *
	$__mem˝y3d
(*
to
, c⁄° *
‰om
, 
size_t
 
Àn
)

259 i‡(
Àn
 < 512)

260  
	`__mem˝y
(
to
, 
‰om
, 
Àn
);

261  
	`_mmx_mem˝y
(
to
, 
‰om
, 
Àn
);

262 
	}
}

264 
	#mem˝y
(
t
, 
f
, 
n
) \

265 (
	`__buûtö_c⁄°™t_p
(
n
) ? \

266 
	`__c⁄°™t_mem˝y3d
((
t
),(
f
),(
n
)) : \

267 
	`__mem˝y3d
((
t
),(
f
),(
n
)))

	)

275 
	#mem˝y
(
t
, 
f
, 
n
) \

276 (
	`__buûtö_c⁄°™t_p
(
n
) ? \

277 
	`__c⁄°™t_mem˝y
((
t
),(
f
),(
n
)) : \

278 
	`__mem˝y
((
t
),(
f
),(
n
)))

	)

289 
__°ru˘_˝y_bug
 ();

291 
	#°ru˘_˝y
(
x
,
y
) \

293 i‡((*(
x
)Ë!(*(
y
))) \

294 
__°ru˘_˝y_bug
; \

295 
	`mem˝y
(
x
, 
y
, (*(x))); \

296 })

	)

298 
	#__HAVE_ARCH_MEMMOVE


	)

299 
ölöe
 * 
	$memmove
(* 
de°
,c⁄° * 
§c
, 
size_t
 
n
)

301 
d0
, 
d1
, 
d2
;

302 i‡(
de°
<
§c
)

303 
__asm__
 
	`__vﬁ©ûe__
(

306 : "=&c" (
d0
), "=&S" (
d1
), "=&D" (
d2
)

307 :"0" (
n
),"1" (
§c
),"2" (
de°
)

310 
__asm__
 
	`__vﬁ©ûe__
(

315 : "=&c" (
d0
), "=&S" (
d1
), "=&D" (
d2
)

316 :"0" (
n
),

317 "1" (
n
-1+(c⁄° *)
§c
),

318 "2" (
n
-1+(*)
de°
)

320  
de°
;

321 
	}
}

323 
	#memcmp
 
__buûtö_memcmp


	)

325 
	#__HAVE_ARCH_MEMCHR


	)

326 
ölöe
 * 
	$memchr
(c⁄° * 
cs
,
c
,
size_t
 
cou¡
)

328 
d0
;

329 * 
__ªs
;

330 i‡(!
cou¡
)

331  
NULL
;

332 
__asm__
 
	`__vﬁ©ûe__
(

338 :"=D" (
__ªs
), "=&c" (
d0
Ë: "a" (
c
),"0" (
cs
),"1" (
cou¡
));

339  
__ªs
;

340 
	}
}

342 
ölöe
 * 
	$__mem£t_gíîic
(* 
s
, 
c
,
size_t
 
cou¡
)

344 
d0
, 
d1
;

345 
__asm__
 
	`__vﬁ©ûe__
(

348 : "=&c" (
d0
), "=&D" (
d1
)

349 :"a" (
c
),"1" (
s
),"0" (
cou¡
)

351  
s
;

352 
	}
}

355 
	#__c⁄°™t_cou¡_mem£t
(
s
,
c
,
cou¡
Ë
	`__mem£t_gíîic
((s),(c),(cou¡))

	)

362 
ölöe
 * 
	$__c⁄°™t_c_mem£t
(* 
s
, 
c
, 
size_t
 
cou¡
)

364 
d0
, 
d1
;

365 
__asm__
 
	`__vﬁ©ûe__
(

374 : "=&c" (
d0
), "=&D" (
d1
)

375 :"a" (
c
), "q" (
cou¡
), "0" (cou¡/4), "1" ((Ë
s
)

377  (
s
);

378 
	}
}

381 
	#__HAVE_ARCH_STRNLEN


	)

382 
ölöe
 
size_t
 
	$°∫Àn
(c⁄° * 
s
, 
size_t
 
cou¡
)

384 
d0
;

385 
__ªs
;

386 
__asm__
 
	`__vﬁ©ûe__
(

396 :"˜" (
__ªs
), "=&d" (
d0
)

397 :"c" (
s
),"1" (
cou¡
));

398  
__ªs
;

399 
	}
}

402 
	#__HAVE_ARCH_STRSTR


	)

404 *
°r°r
(c⁄° *
cs
, c⁄° *
˘
);

410 
ölöe
 * 
	$__c⁄°™t_c_™d_cou¡_mem£t
(* 
s
, 
∑âîn
, 
size_t
 
cou¡
)

412 
cou¡
) {

414  
s
;

416 *(*)
s
 = 
∑âîn
;

417  
s
;

419 *(*)
s
 = 
∑âîn
;

420  
s
;

422 *(*)
s
 = 
∑âîn
;

423 *(2+(*)
s
Ë
∑âîn
;

424  
s
;

426 *(*)
s
 = 
∑âîn
;

427  
s
;

429 
	#COMMON
(
x
) \

430 
__asm__
 
	`__vﬁ©ûe__
( \

432 
x
 \

433 : "=&c" (
d0
), "=&D" (
d1
) \

434 : "a" (
∑âîn
),"0" (
cou¡
/4),"1" ((Ë
s
) \

435 : "mem‹y")

	)

437 
d0
, 
d1
;

438 
cou¡
 % 4) {

439 0: 
	`COMMON
("");  
s
;

440 1: 
	`COMMON
("\n\t°osb");  
s
;

441 2: 
	`COMMON
("\n\t°osw");  
s
;

442 : 
	`COMMON
("\n\t°osw\n\t°osb");  
s
;

446 #unde‡
COMMON


447 
	}
}

449 
	#__c⁄°™t_c_x_mem£t
(
s
, 
c
, 
cou¡
) \

450 (
	`__buûtö_c⁄°™t_p
(
cou¡
) ? \

451 
	`__c⁄°™t_c_™d_cou¡_mem£t
((
s
),(
c
),(
cou¡
)) : \

452 
	`__c⁄°™t_c_mem£t
((
s
),(
c
),(
cou¡
)))

	)

454 
	#__mem£t
(
s
, 
c
, 
cou¡
) \

455 (
	`__buûtö_c⁄°™t_p
(
cou¡
) ? \

456 
	`__c⁄°™t_cou¡_mem£t
((
s
),(
c
),(
cou¡
)) : \

457 
	`__mem£t_gíîic
((
s
),(
c
),(
cou¡
)))

	)

459 
	#__HAVE_ARCH_MEMSET


	)

460 
	#mem£t
(
s
, 
c
, 
cou¡
) \

461 (
	`__buûtö_c⁄°™t_p
(
c
) ? \

462 
	`__c⁄°™t_c_x_mem£t
((
s
),(0x01010101UL*()(
c
)),(
cou¡
)) : \

463 
	`__mem£t
((
s
),(
c
),(
cou¡
)))

	)

468 
	#__HAVE_ARCH_MEMSCAN


	)

469 
ölöe
 * 
	$memsˇn
(* 
addr
, 
c
, 
size_t
 
size
)

471 i‡(!
size
)

472  
addr
;

473 
	`__asm__
("repnz; scasb\n\t"

477 : "=D" (
addr
), "=c" (
size
)

478 : "0" (
addr
), "1" (
size
), "a" (
c
));

479  
addr
;

480 
	}
}

	@/usr/include/linux/aio.h

1 #i‚de‡
__LINUX__AIO_H


2 
	#__LINUX__AIO_H


	)

4 
	~<löux/li°.h
>

5 
	~<löux/w‹kqueue.h
>

6 
	~<löux/aio_abi.h
>

8 
	~<asm/©omic.h
>

10 
	#AIO_MAXSEGS
 4

	)

11 
	#AIO_KIOGRP_NR_ATOMIC
 8

	)

13 
	gkio˘x
;

21 
	#KIOCB_C_CANCELLED
 0x01

	)

22 
	#KIOCB_C_COMPLETE
 0x02

	)

24 
	#KIOCB_SYNC_KEY
 (~0U)

	)

26 
	#KIOCB_PRIVATE_SIZE
 (24 * ())

	)

29 
	#KIF_LOCKED
 0

	)

30 
	#KIF_KICKED
 1

	)

31 
	#KIF_CANCELLED
 2

	)

33 
	#kiocbTryLock
(
iocb
Ë
	`ã°_™d_£t_bô
(
KIF_LOCKED
, &(iocb)->
ki_Êags
)

	)

34 
	#kiocbTryKick
(
iocb
Ë
	`ã°_™d_£t_bô
(
KIF_KICKED
, &(iocb)->
ki_Êags
)

	)

36 
	#kiocbSëLocked
(
iocb
Ë
	`£t_bô
(
KIF_LOCKED
, &(iocb)->
ki_Êags
)

	)

37 
	#kiocbSëKicked
(
iocb
Ë
	`£t_bô
(
KIF_KICKED
, &(iocb)->
ki_Êags
)

	)

38 
	#kiocbSëC™˚Œed
(
iocb
Ë
	`£t_bô
(
KIF_CANCELLED
, &(iocb)->
ki_Êags
)

	)

40 
	#kiocbCÀ¨Locked
(
iocb
Ë
	`˛ór_bô
(
KIF_LOCKED
, &(iocb)->
ki_Êags
)

	)

41 
	#kiocbCÀ¨Kicked
(
iocb
Ë
	`˛ór_bô
(
KIF_KICKED
, &(iocb)->
ki_Êags
)

	)

42 
	#kiocbCÀ¨C™˚Œed
(
iocb
Ë
	`˛ór_bô
(
KIF_CANCELLED
, &(iocb)->
ki_Êags
)

	)

44 
	#kiocbIsLocked
(
iocb
Ë
	`ã°_bô
(
KIF_LOCKED
, &(iocb)->
ki_Êags
)

	)

45 
	#kiocbIsKicked
(
iocb
Ë
	`ã°_bô
(
KIF_KICKED
, &(iocb)->
ki_Êags
)

	)

46 
	#kiocbIsC™˚Œed
(
iocb
Ë
	`ã°_bô
(
KIF_CANCELLED
, &(iocb)->
ki_Êags
)

	)

48 
	skiocb
 {

49 
li°_hód
 
	mki_run_li°
;

50 
	mki_Êags
;

51 
	mki_u£rs
;

52 
	mki_key
;

54 
fûe
 *
	mki_fûp
;

55 
kio˘x
 *
	mki_˘x
;

56 (*
	mki_ˇn˚l
)(
	mkiocb
 *, 
	mio_evít
 *);

57 (*
	mki_ªåy
)(
	mkiocb
 *);

59 
li°_hód
 
	mki_li°
;

62 *
	mki_u£r_obj
;

63 
__u64
 
	mki_u£r_d©a
;

64 
loff_t
 
	mki_pos
;

66 
	m¥iv©e
[
KIOCB_PRIVATE_SIZE
];

69 
	#is_sync_kiocb
(
iocb
Ë((iocb)->
ki_key
 =
KIOCB_SYNC_KEY
)

	)

70 
	#öô_sync_kiocb
(
x
, 
fûp
) \

72 
èsk_°ru˘
 *
tsk
 = 
cuºít
; \

73 (
x
)->
ki_Êags
 = 0; \

74 (
x
)->
ki_u£rs
 = 1; \

75 (
x
)->
ki_key
 = 
KIOCB_SYNC_KEY
; \

76 (
x
)->
ki_fûp
 = (
fûp
); \

77 (
x
)->
ki_˘x
 = &
tsk
->
a˘ive_mm
->
deÁu…_kio˘x
; \

78 (
x
)->
ki_ˇn˚l
 = 
NULL
; \

79 (
x
)->
ki_u£r_obj
 = 
tsk
; \

80 } 0)

	)

82 
	#AIO_RING_MAGIC
 0xa10a10a1

	)

83 
	#AIO_RING_COMPAT_FEATURES
 1

	)

84 
	#AIO_RING_INCOMPAT_FEATURES
 0

	)

85 
	saio_rög
 {

86 
	mid
;

87 
	mƒ
;

88 
	mhód
;

89 
	mèû
;

91 
	mmagic
;

92 
	mcom∑t_„©uªs
;

93 
	möcom∑t_„©uªs
;

94 
	mhódî_Àngth
;

97 
io_evít
 
	mio_evíts
[0];

100 
	#aio_rög_avaû
(
öfo
, 
rög
Ë((‘ög)->
hód
 + (öfo)->
ƒ
 - 1 - (rög)->
èû
Ë% (öfo)->ƒ)

	)

102 
	#AIO_RING_PAGES
 8

	)

103 
	saio_rög_öfo
 {

104 
	mmm≠_ba£
;

105 
	mmm≠_size
;

107 
∑ge
 **
	mrög_∑ges
;

108 
•ölock_t
 
	mrög_lock
;

109 
	mƒ_∑ges
;

111 
	mƒ
, 
	mèû
;

113 
∑ge
 *
	möã∫Æ_∑ges
[
AIO_RING_PAGES
];

116 
	skio˘x
 {

117 
©omic_t
 
	mu£rs
;

118 
	mdód
;

119 
mm_°ru˘
 *
	mmm
;

122 
	mu£r_id
;

123 
kio˘x
 *
	m√xt
;

125 
waô_queue_hód_t
 
	mwaô
;

127 
•ölock_t
 
	m˘x_lock
;

129 
	mªqs_a˘ive
;

130 
li°_hód
 
	ma˘ive_ªqs
;

131 
li°_hód
 
	mrun_li°
;

133 
	mmax_ªqs
;

135 
aio_rög_öfo
 
	mrög_öfo
;

137 
w‹k_°ru˘
 
	mwq
;

141 
aio_max_size
;

143 
ssize_t
 
FASTCALL
(
waô_⁄_sync_kiocb
(
kiocb
 *
iocb
));

144 
FASTCALL
(
aio_put_ªq
(
kiocb
 *
iocb
));

145 
FASTCALL
(
kick_iocb
(
kiocb
 *
iocb
));

146 
FASTCALL
(
aio_com∂ëe
(
kiocb
 *
iocb
, 
ªs
, 
ªs2
));

147 
FASTCALL
(
__put_io˘x
(
kio˘x
 *
˘x
));

148 
	gmm_°ru˘
;

149 
FASTCALL
(
exô_aio
(
mm_°ru˘
 *
mm
));

150 
kio˘x
 *
lookup_io˘x
(
˘x_id
);

151 
FASTCALL
(
io_submô_⁄e
(
kio˘x
 *
˘x
,

152 
iocb
 *
u£r_iocb
, iocb *iocb));

155 
kio˘x
 *
lookup_io˘x
(
˘x_id
);

156 
FASTCALL
(
io_submô_⁄e
(
kio˘x
 *
˘x
, 
iocb
 *
u£r_iocb
,

157 
iocb
 *iocb));

159 
	#gë_io˘x
(
kio˘x
Ëdÿ{ i‡(
	`u∆ikñy
(
	`©omic_ªad
(&(kio˘x)->
u£rs
Ë<0)Ë
	`BUG
(); 
	`©omic_öc
(&(kio˘x)->u£rs); } 0)

	)

160 
	#put_io˘x
(
kio˘x
Ëdÿ{ i‡(
	`u∆ikñy
(
	`©omic_dec_™d_ã°
(&(kio˘x)->
u£rs
))Ë
	`__put_io˘x
(kio˘x); i‡(u∆ikñy(
	`©omic_ªad
(&(kio˘x)->u£rsË< 0)Ë
	`BUG
(); } 0)

	)

162 
	~<löux/aio_abi.h
>

164 
ölöe
 
kiocb
 *
	$li°_kiocb
(
li°_hód
 *
h
)

166  
	`li°_íåy
(
h
, 
kiocb
, 
ki_li°
);

167 
	}
}

170 
aio_max_ƒ
, 
aio_max_size
, 
aio_max_pö√d
;

	@/usr/include/linux/capability.h

13 #i‚de‡
_LINUX_CAPABILITY_H


14 
	#_LINUX_CAPABILITY_H


	)

16 
	~<löux/ty≥s.h
>

17 
	~<löux/compûî.h
>

30 
	#_LINUX_CAPABILITY_VERSION
 0x19980330

	)

32 
	s__u£r_ˇp_hódî_°ru˘
 {

33 
__u32
 
	mvîsi⁄
;

34 
	mpid
;

35 } 
	t__u£r
 *
	tˇp_u£r_hódî_t
;

37 
	s__u£r_ˇp_d©a_°ru˘
 {

38 
__u32
 
	mef„˘ive
;

39 
__u32
 
	m≥rmôãd
;

40 
__u32
 
	möhîôabÀ
;

41 } 
	t__u£r
 *
	tˇp_u£r_d©a_t
;

43 #ifde‡
__KERNEL__


45 
	~<löux/•ölock.h
>

47 
•ölock_t
 
èsk_ˇ∑bûôy_lock
;

51 #ifde‡
STRICT_CAP_T_TYPECHECKS


53 
	skî√l_ˇp_°ru˘
 {

54 
__u32
 
	mˇp
;

55 } 
	tkî√l_ˇp_t
;

59 
__u32
 
	tkî√l_ˇp_t
;

63 
	#_USER_CAP_HEADER_SIZE
 (2*(
__u32
))

	)

64 
	#_KERNEL_CAP_T_SIZE
 ((
kî√l_ˇp_t
))

	)

77 
	#CAP_CHOWN
 0

	)

83 
	#CAP_DAC_OVERRIDE
 1

	)

89 
	#CAP_DAC_READ_SEARCH
 2

	)

95 
	#CAP_FOWNER
 3

	)

104 
	#CAP_FSETID
 4

	)

108 
	#CAP_FS_MASK
 0x1f

	)

114 
	#CAP_KILL
 5

	)

120 
	#CAP_SETGID
 6

	)

125 
	#CAP_SETUID
 7

	)

135 
	#CAP_SETPCAP
 8

	)

139 
	#CAP_LINUX_IMMUTABLE
 9

	)

144 
	#CAP_NET_BIND_SERVICE
 10

	)

148 
	#CAP_NET_BROADCAST
 11

	)

164 
	#CAP_NET_ADMIN
 12

	)

169 
	#CAP_NET_RAW
 13

	)

175 
	#CAP_IPC_LOCK
 14

	)

179 
	#CAP_IPC_OWNER
 15

	)

183 
	#CAP_SYS_MODULE
 16

	)

188 
	#CAP_SYS_RAWIO
 17

	)

192 
	#CAP_SYS_CHROOT
 18

	)

196 
	#CAP_SYS_PTRACE
 19

	)

200 
	#CAP_SYS_PACCT
 20

	)

239 
	#CAP_SYS_ADMIN
 21

	)

243 
	#CAP_SYS_BOOT
 22

	)

252 
	#CAP_SYS_NICE
 23

	)

266 
	#CAP_SYS_RESOURCE
 24

	)

272 
	#CAP_SYS_TIME
 25

	)

277 
	#CAP_SYS_TTY_CONFIG
 26

	)

281 
	#CAP_MKNOD
 27

	)

285 
	#CAP_LEASE
 28

	)

287 #ifde‡
__KERNEL__


291 
kî√l_ˇp_t
 
ˇp_b£t
;

297 #ifde‡
STRICT_CAP_T_TYPECHECKS


299 
	#to_ˇp_t
(
x
Ë{ x }

	)

300 
	#ˇp_t
(
x
Ë(x).
ˇp


	)

304 
	#to_ˇp_t
(
x
Ë(x)

	)

305 
	#ˇp_t
(
x
Ë(x)

	)

309 
	#CAP_EMPTY_SET
 
	`to_ˇp_t
(0)

	)

310 
	#CAP_FULL_SET
 
	`to_ˇp_t
(~0)

	)

311 
	#CAP_INIT_EFF_SET
 
	`to_ˇp_t
(~0 & ~
	`CAP_TO_MASK
(
CAP_SETPCAP
))

	)

312 
	#CAP_INIT_INH_SET
 
	`to_ˇp_t
(0)

	)

314 
	#CAP_TO_MASK
(
x
Ë(1 << (x))

	)

315 
	#ˇp_øi£
(
c
, 
Êag
Ë(
	`ˇp_t
(cË|
	`CAP_TO_MASK
(Êag))

	)

316 
	#ˇp_lowî
(
c
, 
Êag
Ë(
	`ˇp_t
(cË&~
	`CAP_TO_MASK
(Êag))

	)

317 
	#ˇp_øi£d
(
c
, 
Êag
Ë(
	`ˇp_t
(cË& 
	`CAP_TO_MASK
(Êag))

	)

319 
ölöe
 
kî√l_ˇp_t
 
	$ˇp_comböe
(
kî√l_ˇp_t
 
a
, kî√l_ˇp_à
b
)

321 
kî√l_ˇp_t
 
de°
;

322 
	`ˇp_t
(
de°
Ëˇp_t(
a
Ë| c≠_t(
b
);

323  
de°
;

324 
	}
}

326 
ölöe
 
kî√l_ˇp_t
 
	$ˇp_öãr£˘
(
kî√l_ˇp_t
 
a
, kî√l_ˇp_à
b
)

328 
kî√l_ˇp_t
 
de°
;

329 
	`ˇp_t
(
de°
Ëˇp_t(
a
Ë& c≠_t(
b
);

330  
de°
;

331 
	}
}

333 
ölöe
 
kî√l_ˇp_t
 
	$ˇp_dr›
(
kî√l_ˇp_t
 
a
, kî√l_ˇp_à
dr›
)

335 
kî√l_ˇp_t
 
de°
;

336 
	`ˇp_t
(
de°
Ëˇp_t(
a
Ë& ~ˇp_t(
dr›
);

337  
de°
;

338 
	}
}

340 
ölöe
 
kî√l_ˇp_t
 
	$ˇp_övît
(
kî√l_ˇp_t
 
c
)

342 
kî√l_ˇp_t
 
de°
;

343 
	`ˇp_t
(
de°
Ë~ˇp_t(
c
);

344  
de°
;

345 
	}
}

347 
	#ˇp_is˛ór
(
c
Ë(!
	`ˇp_t
(c))

	)

348 
	#ˇp_issub£t
(
a
,
£t
Ë(!(
	`ˇp_t
◊Ë& ~ˇp_t(£t)))

	)

350 
	#ˇp_˛ór
(
c
Ëdÿ{ 
	`ˇp_t
(cË0; } 0)

	)

351 
	#ˇp_£t_fuŒ
(
c
Ëdÿ{ 
	`ˇp_t
(cË~0; } 0)

	)

352 
	#ˇp_mask
(
c
,
mask
Ëdÿ{ 
	`ˇp_t
(cË&ˇp_t(mask); } 0)

	)

354 
	#ˇp_is_fs_ˇp
(
c
Ë(
	`CAP_TO_MASK
(cË& 
CAP_FS_MASK
)

	)

	@/usr/include/linux/completion.h

1 #i‚de‡
__LINUX_COMPLETION_H


2 
	#__LINUX_COMPLETION_H


	)

11 
	~<löux/waô.h
>

13 
	scom∂ëi⁄
 {

14 
	md⁄e
;

15 
waô_queue_hód_t
 
	mwaô
;

18 
	#COMPLETION_INITIALIZER
(
w‹k
) \

19 { 0, 
	`__WAIT_QUEUE_HEAD_INITIALIZER
((
w‹k
).
waô
Ë}

	)

21 
	#DECLARE_COMPLETION
(
w‹k
) \

22 
com∂ëi⁄
 
w‹k
 = 
	`COMPLETION_INITIALIZER
(w‹k)

	)

24 
ölöe
 
	$öô_com∂ëi⁄
(
com∂ëi⁄
 *
x
)

26 
x
->
d⁄e
 = 0;

27 
	`öô_waôqueue_hód
(&
x
->
waô
);

28 
	}
}

30 
FASTCALL
(
waô_f‹_com∂ëi⁄
(
com∂ëi⁄
 *));

31 
FASTCALL
(
com∂ëe
(
com∂ëi⁄
 *));

32 
FASTCALL
(
com∂ëe_Æl
(
com∂ëi⁄
 *));

34 
	#INIT_COMPLETION
(
x
Ë((x).
d⁄e
 = 0)

	)

	@/usr/include/linux/fs_struct.h

1 #i‚de‡
_LINUX_FS_STRUCT_H


2 
	#_LINUX_FS_STRUCT_H


	)

4 
	gdíåy
;

5 
	gvfsmou¡
;

7 
	sfs_°ru˘
 {

8 
©omic_t
 
	mcou¡
;

9 
rwlock_t
 
	mlock
;

10 
	mumask
;

11 
díåy
 * 
	mroŸ
, * 
	mpwd
, * 
	mÆåoŸ
;

12 
vfsmou¡
 * 
	mroŸm¡
, * 
	mpwdm¡
, * 
	mÆåoŸm¡
;

15 
	#INIT_FS
 { \

16 .
cou¡
 = 
	`ATOMIC_INIT
(1), \

17 .
lock
 = 
RW_LOCK_UNLOCKED
, \

18 .
umask
 = 0022, \

19 }

	)

21 
exô_fs
(
èsk_°ru˘
 *);

22 
£t_fs_ÆåoŸ
();

23 
£t_fs_roŸ
(
fs_°ru˘
 *, 
vfsmou¡
 *, 
díåy
 *);

24 
£t_fs_pwd
(
fs_°ru˘
 *, 
vfsmou¡
 *, 
díåy
 *);

25 
fs_°ru˘
 *
c›y_fs_°ru˘
(fs_struct *);

26 
put_fs_°ru˘
(
fs_°ru˘
 *);

	@/usr/include/linux/gfp.h

1 #i‚de‡
__LINUX_GFP_H


2 
	#__LINUX_GFP_H


	)

4 
	~<löux/mmz⁄e.h
>

5 
	~<löux/°ddef.h
>

6 
	~<löux/lökage.h
>

11 
	#__GFP_DMA
 0x01

	)

12 
	#__GFP_HIGHMEM
 0x02

	)

25 
	#__GFP_WAIT
 0x10

	)

26 
	#__GFP_HIGH
 0x20

	)

27 
	#__GFP_IO
 0x40

	)

28 
	#__GFP_FS
 0x80

	)

29 
	#__GFP_COLD
 0x100

	)

30 
	#__GFP_NOWARN
 0x200

	)

31 
	#__GFP_REPEAT
 0x400

	)

32 
	#__GFP_NOFAIL
 0x800

	)

33 
	#__GFP_NORETRY
 0x1000

	)

34 
	#__GFP_NO_GROW
 0x2000

	)

36 
	#__GFP_BITS_SHIFT
 16

	)

37 
	#__GFP_BITS_MASK
 ((1 << 
__GFP_BITS_SHIFT
Ë- 1)

	)

39 
	#GFP_ATOMIC
 (
__GFP_HIGH
)

	)

40 
	#GFP_NOIO
 (
__GFP_WAIT
)

	)

41 
	#GFP_NOFS
 (
__GFP_WAIT
 | 
__GFP_IO
)

	)

42 
	#GFP_KERNEL
 (
__GFP_WAIT
 | 
__GFP_IO
 | 
__GFP_FS
)

	)

43 
	#GFP_USER
 (
__GFP_WAIT
 | 
__GFP_IO
 | 
__GFP_FS
)

	)

44 
	#GFP_HIGHUSER
 (
__GFP_WAIT
 | 
__GFP_IO
 | 
__GFP_FS
 | 
__GFP_HIGHMEM
)

	)

49 
	#GFP_DMA
 
__GFP_DMA


	)

66 
∑ge
 * 
FASTCALL
(
__Æloc_∑ges
(, , 
z⁄ñi°
 *));

67 
ölöe
 
∑ge
 * 
	$Æloc_∑ges_node
(
nid
, 
gÂ_mask
, 
‹dî
)

69 i‡(
	`u∆ikñy
(
‹dî
 >
MAX_ORDER
))

70  
NULL
;

72  
	`__Æloc_∑ges
(
gÂ_mask
, 
‹dî
, 
	`NODE_DATA
(
nid
)->
node_z⁄ñi°s
 + (gÂ_mask & 
GFP_ZONEMASK
));

73 
	}
}

75 
	#Æloc_∑ges
(
gÂ_mask
, 
‹dî
) \

76 
	`Æloc_∑ges_node
(
	`numa_node_id
(), 
gÂ_mask
, 
‹dî
)

	)

77 
	#Æloc_∑ge
(
gÂ_mask
) \

78 
	`Æloc_∑ges_node
(
	`numa_node_id
(), 
gÂ_mask
, 0)

	)

80 
FASTCALL
(
__gë_‰ì_∑ges
(
gÂ_mask
, 
‹dî
));

81 
FASTCALL
(
gë_zî€d_∑ge
(
gÂ_mask
));

83 
	#__gë_‰ì_∑ge
(
gÂ_mask
) \

84 
	`__gë_‰ì_∑ges
((
gÂ_mask
),0)

	)

86 
	#__gë_dma_∑ges
(
gÂ_mask
, 
‹dî
) \

87 
	`__gë_‰ì_∑ges
((
gÂ_mask
Ë| 
GFP_DMA
,(
‹dî
))

	)

89 
FASTCALL
(
__‰ì_∑ges
(
∑ge
 *∑ge, 
‹dî
));

90 
FASTCALL
(
‰ì_∑ges
(
addr
, 
‹dî
));

91 
FASTCALL
(
‰ì_hŸ_∑ge
(
∑ge
 *page));

92 
FASTCALL
(
‰ì_cﬁd_∑ge
(
∑ge
 *page));

94 
	#__‰ì_∑ge
(
∑ge
Ë
	`__‰ì_∑ges
(’age), 0)

	)

95 
	#‰ì_∑ge
(
addr
Ë
	`‰ì_∑ges
(◊ddr),0)

	)

97 
∑ge_Æloc_öô
();

	@/usr/include/linux/jiffies.h

1 #i‚de‡
_LINUX_JIFFIES_H


2 
	#_LINUX_JIFFIES_H


	)

4 
	~<löux/kî√l.h
>

5 
	~<löux/ty≥s.h
>

6 
	~<löux/•ölock.h
>

7 
	~<löux/£qlock.h
>

8 
	~<asm/sy°em.h
>

9 
	~<asm/∑øm.h
>

16 
u64
 
jiffõs_64
;

17 vﬁ©ûê
jiffõs
;

19 #i‡(
BITS_PER_LONG
 < 64)

20 
u64
 
gë_jiffõs_64
();

22 
ölöe
 
u64
 
	$gë_jiffõs_64
()

24  (
u64
)
jiffõs
;

25 
	}
}

41 
	#time_a·î
(
a
,
b
) \

42 (
	`ty≥check
(, 
a
) && \

43 
	`ty≥check
(, 
b
) && \

44 (()(
b
Ë- ()(
a
Ë< 0))

	)

45 
	#time_bef‹e
(
a
,
b
Ë
	`time_a·î
(b,a)

	)

47 
	#time_a·î_eq
(
a
,
b
) \

48 (
	`ty≥check
(, 
a
) && \

49 
	`ty≥check
(, 
b
) && \

50 (()(
a
Ë- ()(
b
Ë>0))

	)

51 
	#time_bef‹e_eq
(
a
,
b
Ë
	`time_a·î_eq
(b,a)

	)

	@/usr/include/linux/param.h

1 #i‚de‡
_LINUX_PARAM_H


2 
	#_LINUX_PARAM_H


	)

4 
	~<asm/∑øm.h
>

	@/usr/include/linux/pid.h

1 #i‚de‡
_LINUX_PID_H


2 
	#_LINUX_PID_H


	)

4 
	epid_ty≥


6 
	mPIDTYPE_PID
,

7 
	mPIDTYPE_TGID
,

8 
	mPIDTYPE_PGID
,

9 
	mPIDTYPE_SID
,

10 
	mPIDTYPE_MAX


13 
	spid


15 
	mƒ
;

16 
©omic_t
 
	mcou¡
;

17 
èsk_°ru˘
 *
	mèsk
;

18 
li°_hód
 
	mèsk_li°
;

19 
li°_hód
 
	mhash_chaö
;

22 
	spid_lök


24 
li°_hód
 
	mpid_chaö
;

25 
pid
 *
	mpid±r
;

26 
pid
 
	mpid
;

29 
	#pid_èsk
(
ñem
, 
ty≥
) \

30 
	`li°_íåy
(
ñem
, 
èsk_°ru˘
, 
pids
[
ty≥
].
pid_chaö
)

	)

36 
FASTCALL
(
©èch_pid
(
èsk_°ru˘
 *
èsk
, 
pid_ty≥
 
ty≥
, 
ƒ
));

38 
FASTCALL
(
lök_pid
(
èsk_°ru˘
 *
èsk
, 
pid_lök
 *
lök
, 
pid
 *pid));

43 
FASTCALL
(
dëach_pid
(
èsk_°ru˘
 *
èsk
, 
pid_ty≥
));

49 
pid
 *
FASTCALL
(
föd_pid
(
pid_ty≥
, ));

51 
Æloc_pidm≠
();

52 
FASTCALL
(
‰ì_pidm≠
());

53 
swôch_exec_pids
(
èsk_°ru˘
 *
Àadî
, èsk_°ru˘ *
thªad
);

55 
	#f‹_óch_èsk_pid
(
who
, 
ty≥
, 
èsk
, 
ñem
, 
pid
) \

56 i‡((
pid
 = 
	`föd_pid
(
ty≥
, 
who
))) \

57 
ñem
 = 
pid
->
èsk_li°
.
√xt
, \

58 
	`¥e„tch
(
ñem
->
√xt
), \

59 
èsk
 = 
	`pid_èsk
(
ñem
, 
ty≥
); \

60 
ñem
 !&
pid
->
èsk_li°
; \

61 
ñem
 =ÉÀm->
√xt
, 
	`¥e„tch
(elem->next), \

62 
èsk
 = 
	`pid_èsk
(
ñem
, 
ty≥
))

	)

	@/usr/include/linux/rbtree.h

94 #i‚def 
_LINUX_RBTREE_H


95 
	#_LINUX_RBTREE_H


	)

97 
	~<löux/kî√l.h
>

98 
	~<löux/°ddef.h
>

100 
	srb_node


102 
rb_node
 *
	mrb_∑ª¡
;

103 
	mrb_cﬁ‹
;

104 
	#RB_RED
 0

	)

105 
	#RB_BLACK
 1

	)

106 
rb_node
 *
	mrb_right
;

107 
rb_node
 *
	mrb_À·
;

110 
	srb_roŸ


112 
rb_node
 *
	mrb_node
;

115 
	#RB_ROOT
 (
rb_roŸ
Ë{ 
NULL
, }

	)

116 
	#rb_íåy
(
±r
, 
ty≥
, 
membî
) \

117 ((
ty≥
 *)((*)(
±r
)-()(&(—y≥ *)0)->
membî
)))

	)

119 
rb_ö£π_cﬁ‹
(
rb_node
 *, 
rb_roŸ
 *);

120 
rb_îa£
(
rb_node
 *, 
rb_roŸ
 *);

123 
rb_node
 *
rb_√xt
(rb_node *);

124 
rb_node
 *
rb_¥ev
(rb_node *);

125 
rb_node
 *
rb_fú°
(
rb_roŸ
 *);

128 
rb_ª∂a˚_node
(
rb_node
 *
vi˘im
, rb_nodê*
√w
,

129 
rb_roŸ
 *
roŸ
);

131 
ölöe
 
	$rb_lök_node
(
rb_node
 * 
node
, rb_nodê* 
∑ª¡
,

132 
rb_node
 ** 
rb_lök
)

134 
node
->
rb_∑ª¡
 = 
∑ª¡
;

135 
node
->
rb_cﬁ‹
 = 
RB_RED
;

136 
node
->
rb_À·
 =Çode->
rb_right
 = 
NULL
;

138 *
rb_lök
 = 
node
;

139 
	}
}

	@/usr/include/linux/resource.h

1 #i‚de‡
_LINUX_RESOURCE_H


2 
	#_LINUX_RESOURCE_H


	)

4 
	~<löux/time.h
>

17 
	#RUSAGE_SELF
 0

	)

18 
	#RUSAGE_CHILDREN
 (-1)

	)

19 
	#RUSAGE_BOTH
 (-2Ë

	)

21 
	srußge
 {

22 
timevÆ
 
	mru_utime
;

23 
timevÆ
 
	mru_°ime
;

24 
	mru_maxrss
;

25 
	mru_ixrss
;

26 
	mru_idrss
;

27 
	mru_i§ss
;

28 
	mru_möÊt
;

29 
	mru_majÊt
;

30 
	mru_nsw≠
;

31 
	mru_öblock
;

32 
	mru_oublock
;

33 
	mru_msg¢d
;

34 
	mru_msgrcv
;

35 
	mru_nsig«ls
;

36 
	mru_nvcsw
;

37 
	mru_nivcsw
;

40 
	sæimô
 {

41 
	mæim_cur
;

42 
	mæim_max
;

45 
	#PRIO_MIN
 (-20)

	)

46 
	#PRIO_MAX
 20

	)

48 
	#PRIO_PROCESS
 0

	)

49 
	#PRIO_PGRP
 1

	)

50 
	#PRIO_USER
 2

	)

56 
	#_STK_LIM
 (8*1024*1024)

	)

62 
	~<asm/ªsour˚.h
>

	@/usr/include/linux/securebits.h

1 #i‚de‡
_LINUX_SECUREBITS_H


2 
	#_LINUX_SECUREBITS_H
 1

	)

4 
	#SECUREBITS_DEFAULT
 0x00000000

	)

6 
£cuªbôs
;

14 
	#SECURE_NOROOT
 0

	)

19 
	#SECURE_NO_SETUID_FIXUP
 2

	)

26 
	#is£cuª
(
X
Ë–(1 << (X+1)Ë& 
SECUREBITS_DEFAULT
 ? \

27 (1 << (
X
)Ë& 
SECUREBITS_DEFAULT
 : \

28 (1 << (
X
)Ë& 
£cuªbôs
 )

	)

	@/usr/include/linux/sem.h

1 #i‚de‡
_LINUX_SEM_H


2 
	#_LINUX_SEM_H


	)

4 
	~<löux/ùc.h
>

5 
	~<asm/©omic.h
>

8 
	#SEM_UNDO
 0x1000

	)

11 
	#GETPID
 11

	)

12 
	#GETVAL
 12

	)

13 
	#GETALL
 13

	)

14 
	#GETNCNT
 14

	)

15 
	#GETZCNT
 15

	)

16 
	#SETVAL
 16

	)

17 
	#SETALL
 17

	)

20 
	#SEM_STAT
 18

	)

21 
	#SEM_INFO
 19

	)

24 
	s£mid_ds
 {

25 
ùc_≥rm
 
	m£m_≥rm
;

26 
__kî√l_time_t
 
	m£m_Ÿime
;

27 
__kî√l_time_t
 
	m£m_˘ime
;

28 
£m
 *
	m£m_ba£
;

29 
£m_queue
 *
	m£m_≥ndög
;

30 
£m_queue
 **
	m£m_≥ndög_œ°
;

31 
£m_undo
 *
	mundo
;

32 
	m£m_n£ms
;

36 
	~<asm/£mbuf.h
>

39 
	s£mbuf
 {

40 
	m£m_num
;

41 
	m£m_›
;

42 
	m£m_Êg
;

46 
	u£mun
 {

47 
	mvÆ
;

48 
£mid_ds
 *
	mbuf
;

49 *
	m¨øy
;

50 
£möfo
 *
	m__buf
;

51 *
	m__∑d
;

54 
	s£möfo
 {

55 
	m£mm≠
;

56 
	m£mmni
;

57 
	m£mmns
;

58 
	m£mmnu
;

59 
	m£mm¶
;

60 
	m£m›m
;

61 
	m£mume
;

62 
	m£musz
;

63 
	m£mvmx
;

64 
	m£m´m
;

67 
	#SEMMNI
 128

	)

68 
	#SEMMSL
 250

	)

69 
	#SEMMNS
 (
SEMMNI
*
SEMMSL
Ë

	)

70 
	#SEMOPM
 32

	)

71 
	#SEMVMX
 32767

	)

72 
	#SEMAEM
 
SEMVMX


	)

75 
	#SEMUME
 
SEMOPM


	)

76 
	#SEMMNU
 
SEMMNS


	)

77 
	#SEMMAP
 
SEMMNS


	)

78 
	#SEMUSZ
 20

	)

80 #ifde‡
__KERNEL__


83 
	s£m
 {

84 
	m£mvÆ
;

85 
	m£mpid
;

89 
	s£m_¨øy
 {

90 
kîn_ùc_≥rm
 
	m£m_≥rm
;

91 
time_t
 
	m£m_Ÿime
;

92 
time_t
 
	m£m_˘ime
;

93 
£m
 *
	m£m_ba£
;

94 
£m_queue
 *
	m£m_≥ndög
;

95 
£m_queue
 **
	m£m_≥ndög_œ°
;

96 
£m_undo
 *
	mundo
;

97 
	m£m_n£ms
;

101 
	s£m_queue
 {

102 
£m_queue
 * 
	m√xt
;

103 
£m_queue
 ** 
	m¥ev
;

104 
èsk_°ru˘
* 
	m¶ì≥r
;

105 
£m_undo
 * 
	mundo
;

106 
	mpid
;

107 
	m°©us
;

108 
£m_¨øy
 * 
	msma
;

109 
	mid
;

110 
£mbuf
 * 
	ms›s
;

111 
	mns›s
;

117 
	s£m_undo
 {

118 
£m_undo
 * 
	m¥oc_√xt
;

119 
£m_undo
 * 
	mid_√xt
;

120 
	m£mid
;

121 * 
	m£madj
;

127 
	s£m_undo_li°
 {

128 
©omic_t
 
	mªf˙t
;

129 
•ölock_t
 
	mlock
;

130 
£m_undo
 *
	m¥oc_li°
;

133 
	ssysv_£m
 {

134 
£m_undo_li°
 *
	mundo_li°
;

137 
asmlökage
 
sys_£mgë
 (
key_t
 
key
, 
n£ms
, 
£mÊg
);

138 
asmlökage
 
sys_£m›
 (
£mid
, 
£mbuf
 
__u£r
 *
s›s
, 
ns›s
);

139 
asmlökage
 
sys_£m˘l
 (
£mid
, 
£mnum
, 
cmd
, 
£mun
 
¨g
);

140 
asmlökage
 
sys_£mtimed›
(
£mid
, 
£mbuf
 
__u£r
 *
s›s
,

141 
ns›s
, c⁄° 
time•ec
 
__u£r
 *
timeout
);

143 
exô_£m
(
èsk_°ru˘
 *
p
);

	@/usr/include/linux/signal.h

1 #i‚de‡
_LINUX_SIGNAL_H


2 
	#_LINUX_SIGNAL_H


	)

4 
	~<löux/li°.h
>

5 
	~<löux/•ölock.h
>

6 
	~<asm/sig«l.h
>

7 
	~<asm/sigöfo.h
>

9 #ifde‡
__KERNEL__


14 
	ssigqueue
 {

15 
li°_hód
 
	mli°
;

16 
•ölock_t
 *
	mlock
;

17 
	mÊags
;

18 
sigöfo_t
 
	möfo
;

22 
	#SIGQUEUE_PREALLOC
 1

	)

24 
	ssig≥ndög
 {

25 
li°_hód
 
	mli°
;

26 
sig£t_t
 
	msig«l
;

33 #i‚de‡
__HAVE_ARCH_SIG_BITOPS


34 
	~<löux/bô›s.h
>

38 
ölöe
 
	$sigadd£t
(
sig£t_t
 *
£t
, 
_sig
)

40 
sig
 = 
_sig
 - 1;

41 i‡(
_NSIG_WORDS
 == 1)

42 
£t
->
sig
[0] |= 1UL << sig;

44 
£t
->
sig
[sig / 
_NSIG_BPW
] |= 1UL << (sig % _NSIG_BPW);

45 
	}
}

47 
ölöe
 
	$sigdñ£t
(
sig£t_t
 *
£t
, 
_sig
)

49 
sig
 = 
_sig
 - 1;

50 i‡(
_NSIG_WORDS
 == 1)

51 
£t
->
sig
[0] &= ~(1UL << sig);

53 
£t
->
sig
[sig / 
_NSIG_BPW
] &= ~(1UL << (sig % _NSIG_BPW));

54 
	}
}

56 
ölöe
 
	$sigismembî
(
sig£t_t
 *
£t
, 
_sig
)

58 
sig
 = 
_sig
 - 1;

59 i‡(
_NSIG_WORDS
 == 1)

60  1 & (
£t
->
sig
[0] >> sig);

62  1 & (
£t
->
sig
[sig / 
_NSIG_BPW
] >> (sig % _NSIG_BPW));

63 
	}
}

65 
ölöe
 
	$sigfödöw‹d
(
w‹d
)

67  
	`ffz
(~
w‹d
);

68 
	}
}

72 
	#sigmask
(
sig
Ë(1UL << ((sigË- 1))

	)

74 #i‚de‡
__HAVE_ARCH_SIG_SETOPS


75 
	~<löux/°rög.h
>

77 
	#_SIG_SET_BINOP
(
«me
, 
›
) \

78 
ölöe
 
	`«me
(
sig£t_t
 *
r
, c⁄° sig£t_à*
a
, c⁄° sig£t_à*
b
) \

80 
	`_NSIG_WORDS_is_unsuµ‹ãd_size
(); \

81 
a0
, 
a1
, 
a2
, 
a3
, 
b0
, 
b1
, 
b2
, 
b3
; \

83 
_NSIG_WORDS
) { \

85 
a3
 = 
a
->
sig
[3]; 
a2
 =á->sig[2]; \

86 
b3
 = 
b
->
sig
[3]; 
b2
 = b->sig[2]; \

87 
r
->
sig
[3] = 
	`›
(
a3
, 
b3
); \

88 
r
->
sig
[2] = 
	`›
(
a2
, 
b2
); \

90 
a1
 = 
a
->
sig
[1]; 
b1
 = 
b
->sig[1]; \

91 
r
->
sig
[1] = 
	`›
(
a1
, 
b1
); \

93 
a0
 = 
a
->
sig
[0]; 
b0
 = 
b
->sig[0]; \

94 
r
->
sig
[0] = 
	`›
(
a0
, 
b0
); \

97 
	`_NSIG_WORDS_is_unsuµ‹ãd_size
(); \

99 }

	)

101 
	#_sig_‹
(
x
,
y
Ë((xË| (y))

	)

102 
	$_SIG_SET_BINOP
(
sig‹£ts
, 
_sig_‹
)

104 
	#_sig_™d
(
x
,
y
Ë((xË& (y))

	)

105 
	$_SIG_SET_BINOP
(
sig™d£ts
, 
_sig_™d
)

107 
	#_sig_«nd
(
x
,
y
Ë((xË& ~(y))

	)

108 
	$_SIG_SET_BINOP
(
sig«nd£ts
, 
_sig_«nd
)

110 #unde‡
_SIG_SET_BINOP


111 #unde‡
_sig_‹


112 #unde‡
_sig_™d


113 #unde‡
_sig_«nd


115 
	#_SIG_SET_OP
(
«me
, 
›
) \

116 
ölöe
 
	`«me
(
sig£t_t
 *
£t
) \

118 
	`_NSIG_WORDS_is_unsuµ‹ãd_size
(); \

120 
_NSIG_WORDS
) { \

121 4: 
£t
->
sig
[3] = 
	`›
(set->sig[3]); \

122 
£t
->
sig
[2] = 
	`›
(set->sig[2]); \

123 2: 
£t
->
sig
[1] = 
	`›
(set->sig[1]); \

124 1: 
£t
->
sig
[0] = 
	`›
(set->sig[0]); \

127 
	`_NSIG_WORDS_is_unsuµ‹ãd_size
(); \

129 
	}

	)
}

131 
	#_sig_nŸ
(
x
Ë(~(x))

	)

132 
	$_SIG_SET_OP
(
signŸ£t
, 
_sig_nŸ
)

134 #unde‡
_SIG_SET_OP


135 #unde‡
_sig_nŸ


137 
ölöe
 
	$sigem±y£t
(
sig£t_t
 *
£t
)

139 
_NSIG_WORDS
) {

141 
	`mem£t
(
£t
, 0, (
sig£t_t
));

143 2: 
£t
->
sig
[1] = 0;

144 1: 
£t
->
sig
[0] = 0;

147 
	}
}

149 
ölöe
 
	$sigfûl£t
(
sig£t_t
 *
£t
)

151 
_NSIG_WORDS
) {

153 
	`mem£t
(
£t
, -1, (
sig£t_t
));

155 2: 
£t
->
sig
[1] = -1;

156 1: 
£t
->
sig
[0] = -1;

159 
	}
}

163 
ölöe
 
	$sigadd£tmask
(
sig£t_t
 *
£t
, 
mask
)

165 
£t
->
sig
[0] |
mask
;

166 
	}
}

168 
ölöe
 
	$sigdñ£tmask
(
sig£t_t
 *
£t
, 
mask
)

170 
£t
->
sig
[0] &~
mask
;

171 
	}
}

173 
ölöe
 
	$sigã°£tmask
(
sig£t_t
 *
£t
, 
mask
)

175  (
£t
->
sig
[0] & 
mask
) != 0;

176 
	}
}

178 
ölöe
 
	$sigöô£t
(
sig£t_t
 *
£t
, 
mask
)

180 
£t
->
sig
[0] = 
mask
;

181 
_NSIG_WORDS
) {

183 
	`mem£t
(&
£t
->
sig
[1], 0, ()*(
_NSIG_WORDS
-1));

185 2: 
£t
->
sig
[1] = 0;

188 
	}
}

190 
ölöe
 
	$sigöô£töv
(
sig£t_t
 *
£t
, 
mask
)

192 
£t
->
sig
[0] = ~
mask
;

193 
_NSIG_WORDS
) {

195 
	`mem£t
(&
£t
->
sig
[1], -1, ()*(
_NSIG_WORDS
-1));

197 2: 
£t
->
sig
[1] = -1;

200 
	}
}

204 
ölöe
 
	$öô_sig≥ndög
(
sig≥ndög
 *
sig
)

206 
	`sigem±y£t
(&
sig
->
sig«l
);

207 
	`INIT_LIST_HEAD
(&
sig
->
li°
);

208 
	}
}

210 
do_sig≥ndög
(
__u£r
 *, );

211 
sig¥ocmask
(, 
sig£t_t
 *, sigset_t *);

213 #i‚de‡
HAVE_ARCH_GET_SIGNAL_TO_DELIVER


214 
	g±_ªgs
;

215 
gë_sig«l_to_dñivî
(
sigöfo_t
 *
öfo
, 
±_ªgs
 *
ªgs
, *
cookõ
);

217 
	#FOLD_NANO_SLEEP_INTO_CLOCK_NANO_SLEEP


	)

	@/usr/include/asm/apic.h

1 #i‚de‡
__ASM_APIC_H


2 
	#__ASM_APIC_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<löux/pm.h
>

6 
	~<asm/fixm≠.h
>

7 
	~<asm/≠icdef.h
>

8 
	~<asm/sy°em.h
>

10 
	#APIC_DEBUG
 0

	)

12 #i‡
APIC_DEBUG


13 
	#D¥ötk
(
x
...Ë
	`¥ötk
(x)

	)

15 
	#D¥ötk
(
x
...)

	)

18 #ifde‡
CONFIG_X86_LOCAL_APIC


24 
__ölöe
 
	$≠ic_wrôe
(
ªg
, 
v
)

26 *((vﬁ©ûê*)(
APIC_BASE
+
ªg
)Ë
v
;

27 
	}
}

29 
__ölöe
 
	$≠ic_wrôe_©omic
(
ªg
, 
v
)

31 
	`xchg
((vﬁ©ûê*)(
APIC_BASE
+
ªg
), 
v
);

32 
	}
}

34 
__ölöe
 
	$≠ic_ªad
(
ªg
)

36  *((vﬁ©ûê*)(
APIC_BASE
+
ªg
));

37 
	}
}

39 
__ölöe__
 
	$≠ic_waô_i¸_idÀ
()

41 dÿ{ }  
	`≠ic_ªad
–
APIC_ICR
 ) & 
APIC_ICR_BUSY
 );

42 
	}
}

44 #ifde‡
CONFIG_X86_GOOD_APIC


45 
	#FORCE_READ_AROUND_WRITE
 0

	)

46 
	#≠ic_ªad_¨ound
(
x
)

	)

47 
	#≠ic_wrôe_¨ound
(
x
,
y
Ë
	`≠ic_wrôe
((x),(y))

	)

49 
	#FORCE_READ_AROUND_WRITE
 1

	)

50 
	#≠ic_ªad_¨ound
(
x
Ë
	`≠ic_ªad
(x)

	)

51 
	#≠ic_wrôe_¨ound
(
x
,
y
Ë
	`≠ic_wrôe_©omic
((x),(y))

	)

54 
ölöe
 
	$ack_APIC_úq
()

64 
	`≠ic_wrôe_¨ound
(
APIC_EOI
, 0);

65 
	}
}

67 (*
waô_timî_tick
)();

69 
	`gë_maxlvt
();

70 
	`˛ór_loˇl_APIC
();

71 
	`c⁄√˘_b•_APIC
 ();

72 
	`disc⁄√˘_b•_APIC
 ();

73 
	`dißbÀ_loˇl_APIC
 ();

74 
	`vîify_loˇl_APIC
 ();

75 
	`ˇche_APIC_ªgi°îs
 ();

76 
	`sync_Arb_IDs
 ();

77 
	`öô_b•_APIC
 ();

78 
	`£tup_loˇl_APIC
 ();

79 
	`öô_≠ic_m≠pögs
 ();

80 
	`smp_loˇl_timî_öãºu±
 (
±_ªgs
 * 
ªgs
);

81 
	`£tup_boŸ_APIC_˛ock
 ();

82 
	`£tup_£c⁄d¨y_APIC_˛ock
 ();

83 
	`£tup_≠ic_nmi_w©chdog
 ();

84 
	`dißbÀ_œpic_nmi_w©chdog
();

85 
	`íabÀ_œpic_nmi_w©chdog
();

86 
	`dißbÀ_timî_nmi_w©chdog
();

87 
	`íabÀ_timî_nmi_w©chdog
();

88 
ölöe
 
	`nmi_w©chdog_tick
 (
±_ªgs
 * 
ªgs
);

89 
	`APIC_öô_unùro˚ss‹
 ();

90 
	`dißbÀ_APIC_timî
();

91 
	`íabÀ_APIC_timî
();

93 
	`check_nmi_w©chdog
 ();

94 
	`íabÀ_NMI_through_LVT0
 (* 
dummy
);

96 
nmi_w©chdog
;

97 
	#NMI_NONE
 0

	)

98 
	#NMI_IO_APIC
 1

	)

99 
	#NMI_LOCAL_APIC
 2

	)

100 
	#NMI_INVALID
 3

	)

	@/usr/include/asm/fixmap.h

13 #i‚de‡
_ASM_FIXMAP_H


14 
	#_ASM_FIXMAP_H


	)

16 
	~<löux/c⁄fig.h
>

17 
	~<löux/kî√l.h
>

18 
	~<asm/a˝i.h
>

19 
	~<asm/≠icdef.h
>

20 
	~<asm/∑ge.h
>

21 #ifde‡
CONFIG_HIGHMEM


22 
	~<löux/thªads.h
>

23 
	~<asm/km≠_ty≥s.h
>

44 
	efixed_addªs£s
 {

45 
	mFIX_HOLE
,

46 
	mFIX_VSYSCALL
,

47 #ifde‡
CONFIG_X86_LOCAL_APIC


48 
	mFIX_APIC_BASE
,

50 #ifde‡
CONFIG_X86_IO_APIC


51 
	mFIX_IO_APIC_BASE_0
,

52 
	mFIX_IO_APIC_BASE_END
 = 
FIX_IO_APIC_BASE_0
 + 
MAX_IO_APICS
-1,

54 #ifde‡
CONFIG_X86_VISWS_APIC


55 
	mFIX_CO_CPU
,

56 
	mFIX_CO_APIC
,

57 
	mFIX_LI_PCIA
,

58 
	mFIX_LI_PCIB
,

60 #ifde‡
CONFIG_X86_F00F_BUG


61 
	mFIX_F00F_IDT
,

63 #ifde‡
CONFIG_X86_CYCLONE_TIMER


64 
	mFIX_CYCLONE_TIMER
,

66 #ifde‡
CONFIG_HIGHMEM


67 
	mFIX_KMAP_BEGIN
,

68 
	mFIX_KMAP_END
 = 
FIX_KMAP_BEGIN
+(
KM_TYPE_NR
*
NR_CPUS
)-1,

70 #ifde‡
CONFIG_ACPI_BOOT


71 
	mFIX_ACPI_BEGIN
,

72 
	mFIX_ACPI_END
 = 
FIX_ACPI_BEGIN
 + 
FIX_ACPI_PAGES
 - 1,

74 
	m__íd_of_≥rm™ít_fixed_addªs£s
,

76 
	#NR_FIX_BTMAPS
 16

	)

77 
	mFIX_BTMAP_END
 = 
__íd_of_≥rm™ít_fixed_addªs£s
,

78 
	mFIX_BTMAP_BEGIN
 = 
FIX_BTMAP_END
 + 
NR_FIX_BTMAPS
 - 1,

79 
	mFIX_WP_TEST
,

80 
	m__íd_of_fixed_addªs£s


83 
__£t_fixm≠
 (
fixed_addªs£s
 
idx
,

84 
phys
, 
pg¥Ÿ_t
 
Êags
);

86 
	#£t_fixm≠
(
idx
, 
phys
) \

87 
	`__£t_fixm≠
(
idx
, 
phys
, 
PAGE_KERNEL
)

	)

91 
	#£t_fixm≠_noˇche
(
idx
, 
phys
) \

92 
	`__£t_fixm≠
(
idx
, 
phys
, 
PAGE_KERNEL_NOCACHE
)

	)

94 
	#˛ór_fixm≠
(
idx
) \

95 
	`__£t_fixm≠
(
idx
, 0, 
	`__pg¥Ÿ
(0))

	)

103 
	#FIXADDR_TOP
 (0xfffff000UL)

	)

104 
	#__FIXADDR_SIZE
 (
__íd_of_≥rm™ít_fixed_addªs£s
 << 
PAGE_SHIFT
)

	)

105 
	#FIXADDR_START
 (
FIXADDR_TOP
 - 
__FIXADDR_SIZE
)

	)

107 
	#__fix_to_vút
(
x
Ë(
FIXADDR_TOP
 - ((xË<< 
PAGE_SHIFT
))

	)

108 
	#__vút_to_fix
(
x
Ë((
FIXADDR_TOP
 - ((x)&
PAGE_MASK
)Ë>> 
PAGE_SHIFT
)

	)

114 
	#FIXADDR_USER_START
 (
	`__fix_to_vút
(
FIX_VSYSCALL
))

	)

115 
	#FIXADDR_USER_END
 (
FIXADDR_USER_START
 + 
PAGE_SIZE
)

	)

118 
__this_fixm≠_d€s_nŸ_exi°
();

125 
ölöe
 
	$fix_to_vút
(c⁄° 
idx
)

136 i‡(
idx
 >
__íd_of_fixed_addªs£s
)

137 
	`__this_fixm≠_d€s_nŸ_exi°
();

139  
	`__fix_to_vút
(
idx
);

140 
	}
}

142 
ölöe
 
	$vút_to_fix
(c⁄° 
vaddr
)

144 
	`BUG_ON
(
vaddr
 >
FIXADDR_TOP
 || vadd∏< 
FIXADDR_START
);

145  
	`__vút_to_fix
(
vaddr
);

146 
	}
}

	@/usr/include/asm/io_apic.h

1 #i‚de‡
__ASM_IO_APIC_H


2 
	#__ASM_IO_APIC_H


	)

4 
	~<löux/c⁄fig.h
>

5 
	~<asm/ty≥s.h
>

6 
	~<asm/mp•ec.h
>

14 #ifde‡
CONFIG_X86_IO_APIC


16 
	#APIC_MISMATCH_DEBUG


	)

18 
	#IO_APIC_BASE
(
idx
) \

19 ((vﬁ©ûê*)(
	`__fix_to_vút
(
FIX_IO_APIC_BASE_0
 + 
idx
) \

20 + (
mp_iﬂpics
[
idx
].
mpc_≠iˇddr
 & ~
PAGE_MASK
)))

	)

25 
	uIO_APIC_ªg_00
 {

26 
u32
 
	møw
;

28 
u32
 
	m__ª£rved_2
 : 14,

29 
	mLTS
 : 1,

30 
	mdñivîy_ty≥
 : 1,

31 
	m__ª£rved_1
 : 8,

32 
	mID
 : 8;

33 } 
__©åibuã__
 ((
∑cked
)Ë
	mbôs
;

36 
	uIO_APIC_ªg_01
 {

37 
u32
 
	møw
;

39 
u32
 
	mvîsi⁄
 : 8,

40 
	m__ª£rved_2
 : 7,

41 
	mPRQ
 : 1,

42 
	míåõs
 : 8,

43 
	m__ª£rved_1
 : 8;

44 } 
__©åibuã__
 ((
∑cked
)Ë
	mbôs
;

47 
	uIO_APIC_ªg_02
 {

48 
u32
 
	møw
;

50 
u32
 
	m__ª£rved_2
 : 24,

51 
	m¨bôøti⁄
 : 4,

52 
	m__ª£rved_1
 : 4;

53 } 
__©åibuã__
 ((
∑cked
)Ë
	mbôs
;

56 
	uIO_APIC_ªg_03
 {

57 
u32
 
	møw
;

59 
u32
 
	mboŸ_DT
 : 1,

60 
	m__ª£rved_1
 : 31;

61 } 
__©åibuã__
 ((
∑cked
)Ë
	mbôs
;

67 
ƒ_iﬂpics
;

68 
ƒ_iﬂpic_ªgi°îs
[
MAX_IO_APICS
];

70 
	eiﬂpic_úq_de°ö©i⁄_ty≥s
 {

71 
	mde°_Fixed
 = 0,

72 
	mde°_Lowe°Prio
 = 1,

73 
	mde°_SMI
 = 2,

74 
	mde°__ª£rved_1
 = 3,

75 
	mde°_NMI
 = 4,

76 
	mde°_INIT
 = 5,

77 
	mde°__ª£rved_2
 = 6,

78 
	mde°_ExtINT
 = 7

81 
	sIO_APIC_rouã_íåy
 {

82 
__u32
 
	mve˘‹
 : 8,

83 
	mdñivîy_mode
 : 3,

87 
	mde°_mode
 : 1,

88 
	mdñivîy_°©us
 : 1,

89 
	mpﬁ¨ôy
 : 1,

90 
	múr
 : 1,

91 
	måiggî
 : 1,

92 
	mmask
 : 1,

93 
	m__ª£rved_2
 : 15;

95 uni⁄ { såu˘ { 
__u32


96 
	m__ª£rved_1
 : 24,

97 
	mphysiˇl_de°
 : 4,

98 
	m__ª£rved_2
 : 4;

99 } 
	mphysiˇl
;

101 °ru˘ { 
__u32


102 
	m__ª£rved_1
 : 24,

103 
	mlogiˇl_de°
 : 8;

104 } 
	mlogiˇl
;

105 } 
	mde°
;

107 } 
__©åibuã__
 ((
∑cked
));

114 
mpc_c⁄fig_iﬂpic
 
mp_iﬂpics
[
MAX_IO_APICS
];

117 
mp_úq_íåõs
;

120 
mpc_c⁄fig_öt§c
 
mp_úqs
[
MAX_IRQ_SOURCES
];

123 
mpc_deÁu…_ty≥
;

125 
ölöe
 
	$io_≠ic_ªad
(
≠ic
, 
ªg
)

127 *
	`IO_APIC_BASE
(
≠ic
Ë
ªg
;

128  *(
	`IO_APIC_BASE
(
≠ic
)+4);

129 
	}
}

131 
ölöe
 
	$io_≠ic_wrôe
(
≠ic
, 
ªg
, 
vÆue
)

133 *
	`IO_APIC_BASE
(
≠ic
Ë
ªg
;

134 *(
	`IO_APIC_BASE
(
≠ic
)+4Ë
vÆue
;

135 
	}
}

143 
sis_≠ic_bug
;

144 
ölöe
 
	$io_≠ic_modify
(
≠ic
, 
ªg
, 
vÆue
)

146 i‡(
sis_≠ic_bug
)

147 *
	`IO_APIC_BASE
(
≠ic
Ë
ªg
;

148 *(
	`IO_APIC_BASE
(
≠ic
)+4Ë
vÆue
;

149 
	}
}

155 
ölöe
 
	$io_≠ic_sync
(
≠ic
)

157 (Ë*(
	`IO_APIC_BASE
(
≠ic
)+4);

158 
	}
}

161 
skù_iﬂpic_£tup
;

167 
	#io_≠ic_assign_pci_úqs
 (
mp_úq_íåõs
 && !
skù_iﬂpic_£tup
)

	)

169 #ifde‡
CONFIG_ACPI_BOOT


170 
io_≠ic_gë_unique_id
 (
iﬂpic
, 
≠ic_id
);

171 
io_≠ic_gë_vîsi⁄
 (
iﬂpic
);

172 
io_≠ic_gë_ªdú_íåõs
 (
iﬂpic
);

173 
io_≠ic_£t_pci_routög
 (
iﬂpic
, 
pö
, 
úq
, 
edge_Àvñ
, 
a˘ive_high_low
);

177 
	#io_≠ic_assign_pci_úqs
 0

	)

	@/usr/include/asm/mpspec.h

1 #i‚de‡
__ASM_MPSPEC_H


2 
	#__ASM_MPSPEC_H


	)

4 
	~<löux/˝umask.h
>

5 
	~<asm/mp•ec_def.h
>

6 
	~<mach_mp•ec.h
>

8 
mp_bus_id_to_ty≥
 [
MAX_MP_BUSSES
];

9 
mp_bus_id_to_node
 [
MAX_MP_BUSSES
];

10 
mp_bus_id_to_loˇl
 [
MAX_MP_BUSSES
];

11 
quad_loˇl_to_mp_bus_id
 [
NR_CPUS
/4][4];

12 
mp_bus_id_to_pci_bus
 [
MAX_MP_BUSSES
];

14 
boŸ_˝u_physiˇl_≠icid
;

15 
smp_found_c⁄fig
;

16 
föd_smp_c⁄fig
 ();

17 
gë_smp_c⁄fig
 ();

18 
ƒ_iﬂpics
;

19 
≠ic_vîsi⁄
 [
MAX_APICS
];

20 
mp_bus_id_to_ty≥
 [
MAX_MP_BUSSES
];

21 
mp_úq_íåõs
;

22 
mpc_c⁄fig_öt§c
 
mp_úqs
 [
MAX_IRQ_SOURCES
];

23 
mpc_deÁu…_ty≥
;

24 
mp_bus_id_to_pci_bus
 [
MAX_MP_BUSSES
];

25 
mp_cuºít_pci_id
;

26 
mp_œpic_addr
;

27 
pic_mode
;

28 
usög_≠ic_timî
;

30 #ifde‡
CONFIG_X86_SUMMIT


31 
£tup_summô
 ();

34 #ifde‡
CONFIG_ACPI_BOOT


35 
mp_ªgi°î_œpic
 (
u8
 
id
, u8 
íabÀd
);

36 
mp_ªgi°î_œpic_addªss
 (
u64
 
addªss
);

37 
mp_ªgi°î_iﬂpic
 (
u8
 
id
, 
u32
 
addªss
, u32 
úq_ba£
);

38 
mp_ovîride_Àgacy_úq
 (
u8
 
bus_úq
, u8 
pﬁ¨ôy
, u8 
åiggî
, 
u32
 
globÆ_úq
);

39 
mp_c⁄fig_a˝i_Àgacy_úqs
 ();

40 
mp_∑r£_¥t
 ();

42 #ifde‡
CONFIG_X86_IO_APIC


43 
mp_c⁄fig_iﬂpic_f‹_sci
(
úq
);

45 
ölöe
 
	$mp_c⁄fig_iﬂpic_f‹_sci
(
úq
)

46 { 
	}
}

50 
	#PHYSID_ARRAY_SIZE
 
	`BITS_TO_LONGS
(
MAX_APICS
)

	)

52 
	sphysid_mask


54 
	mmask
[
PHYSID_ARRAY_SIZE
];

57 
physid_mask
 
	tphysid_mask_t
;

59 
	#physid_£t
(
physid
, 
m≠
Ë
	`£t_bô
’hysid, (m≠).
mask
)

	)

60 
	#physid_˛ór
(
physid
, 
m≠
Ë
	`˛ór_bô
’hysid, (m≠).
mask
)

	)

61 
	#physid_is£t
(
physid
, 
m≠
Ë
	`ã°_bô
’hysid, (m≠).
mask
)

	)

62 
	#physid_ã°_™d_£t
(
physid
, 
m≠
Ë
	`ã°_™d_£t_bô
’hysid, (m≠).
mask
)

	)

64 
	#physids_™d
(
d°
, 
§c1
, 
§c2
Ë
	`bôm≠_™d
((d°).
mask
, (§c1).mask, (§c2).mask, 
MAX_APICS
)

	)

65 
	#physids_‹
(
d°
, 
§c1
, 
§c2
Ë
	`bôm≠_‹
((d°).
mask
, (§c1).mask, (§c2).mask, 
MAX_APICS
)

	)

66 
	#physids_˛ór
(
m≠
Ë
	`bôm≠_˛ór
((m≠).
mask
, 
MAX_APICS
)

	)

67 
	#physids_com∂emít
(
m≠
Ë
	`bôm≠_com∂emít
((m≠).
mask
, 
MAX_APICS
)

	)

68 
	#physids_em±y
(
m≠
Ë
	`bôm≠_em±y
((m≠).
mask
, 
MAX_APICS
)

	)

69 
	#physids_equÆ
(
m≠1
, 
m≠2
Ë
	`bôm≠_equÆ
((m≠1).
mask
, (m≠2).mask, 
MAX_APICS
)

	)

70 
	#physids_weight
(
m≠
Ë
	`bôm≠_weight
((m≠).
mask
, 
MAX_APICS
)

	)

71 
	#physids_shi·_right
(
d
, 
s
, 
n
Ë
	`bôm≠_shi·_right
((d).
mask
, (s).mask,Ç, 
MAX_APICS
)

	)

72 
	#physids_shi·_À·
(
d
, 
s
, 
n
Ë
	`bôm≠_shi·_À·
((d).
mask
, (s).mask,Ç, 
MAX_APICS
)

	)

73 
	#physids_c€r˚
(
m≠
Ë((m≠).
mask
[0])

	)

75 
	#physids_¥omŸe
(
physids
) \

77 
physid_mask_t
 
__physid_mask
 = 
PHYSID_MASK_NONE
; \

78 
__physid_mask
.
mask
[0] = 
physids
; \

79 
__physid_mask
; \

80 })

	)

82 
	#physid_mask_of_physid
(
physid
) \

84 
physid_mask_t
 
__physid_mask
 = 
PHYSID_MASK_NONE
; \

85 
	`physid_£t
(
physid
, 
__physid_mask
); \

86 
__physid_mask
; \

87 })

	)

89 
	#PHYSID_MASK_ALL
 { {[0 ... 
PHYSID_ARRAY_SIZE
-1] = ~0UL} }

	)

90 
	#PHYSID_MASK_NONE
 { {[0 ... 
PHYSID_ARRAY_SIZE
-1] = 0UL} }

	)

92 
physid_mask_t
 
phys_˝u_¥e£¡_m≠
;

	@/usr/include/asm/resource.h

1 #i‚de‡
_I386_RESOURCE_H


2 
	#_I386_RESOURCE_H


	)

8 
	#RLIMIT_CPU
 0

	)

9 
	#RLIMIT_FSIZE
 1

	)

10 
	#RLIMIT_DATA
 2

	)

11 
	#RLIMIT_STACK
 3

	)

12 
	#RLIMIT_CORE
 4

	)

13 
	#RLIMIT_RSS
 5

	)

14 
	#RLIMIT_NPROC
 6

	)

15 
	#RLIMIT_NOFILE
 7

	)

16 
	#RLIMIT_MEMLOCK
 8

	)

17 
	#RLIMIT_AS
 9

	)

18 
	#RLIMIT_LOCKS
 10

	)

20 
	#RLIM_NLIMITS
 11

	)

26 
	#RLIM_INFINITY
 (~0UL)

	)

28 #ifde‡
__KERNEL__


30 
	#INIT_RLIMITS
 \

32 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

33 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

34 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

35 { 
_STK_LIM
, 
RLIM_INFINITY
 }, \

36 { 0, 
RLIM_INFINITY
 }, \

37 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

39 { 
INR_OPEN
, INR_OPEN }, \

40 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

41 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

42 { 
RLIM_INFINITY
, RLIM_INFINITY }, \

43 }

	)

	@/usr/include/asm/sembuf.h

1 #i‚de‡
_I386_SEMBUF_H


2 
	#_I386_SEMBUF_H


	)

14 
	s£mid64_ds
 {

15 
ùc64_≥rm
 
	m£m_≥rm
;

16 
__kî√l_time_t
 
	m£m_Ÿime
;

17 
	m__unu£d1
;

18 
__kî√l_time_t
 
	m£m_˘ime
;

19 
	m__unu£d2
;

20 
	m£m_n£ms
;

21 
	m__unu£d3
;

22 
	m__unu£d4
;

	@/usr/include/asm/siginfo.h

1 #i‚de‡
_I386_SIGINFO_H


2 
	#_I386_SIGINFO_H


	)

4 
	~<asm-gíîic/sigöfo.h
>

	@/usr/include/asm/signal.h

1 #i‚de‡
_ASMi386_SIGNAL_H


2 
	#_ASMi386_SIGNAL_H


	)

4 
	~<löux/ty≥s.h
>

5 
	~<löux/lökage.h
>

6 
	~<löux/time.h
>

9 
	gsigöfo
;

11 #ifde‡
__KERNEL__


15 
	#_NSIG
 64

	)

16 
	#_NSIG_BPW
 32

	)

17 
	#_NSIG_WORDS
 (
_NSIG
 / 
_NSIG_BPW
)

	)

19 
	tﬁd_sig£t_t
;

22 
	msig
[
_NSIG_WORDS
];

23 } 
	tsig£t_t
;

28 
	#NSIG
 32

	)

29 
	tsig£t_t
;

33 
	#SIGHUP
 1

	)

34 
	#SIGINT
 2

	)

35 
	#SIGQUIT
 3

	)

36 
	#SIGILL
 4

	)

37 
	#SIGTRAP
 5

	)

38 
	#SIGABRT
 6

	)

39 
	#SIGIOT
 6

	)

40 
	#SIGBUS
 7

	)

41 
	#SIGFPE
 8

	)

42 
	#SIGKILL
 9

	)

43 
	#SIGUSR1
 10

	)

44 
	#SIGSEGV
 11

	)

45 
	#SIGUSR2
 12

	)

46 
	#SIGPIPE
 13

	)

47 
	#SIGALRM
 14

	)

48 
	#SIGTERM
 15

	)

49 
	#SIGSTKFLT
 16

	)

50 
	#SIGCHLD
 17

	)

51 
	#SIGCONT
 18

	)

52 
	#SIGSTOP
 19

	)

53 
	#SIGTSTP
 20

	)

54 
	#SIGTTIN
 21

	)

55 
	#SIGTTOU
 22

	)

56 
	#SIGURG
 23

	)

57 
	#SIGXCPU
 24

	)

58 
	#SIGXFSZ
 25

	)

59 
	#SIGVTALRM
 26

	)

60 
	#SIGPROF
 27

	)

61 
	#SIGWINCH
 28

	)

62 
	#SIGIO
 29

	)

63 
	#SIGPOLL
 
SIGIO


	)

67 
	#SIGPWR
 30

	)

68 
	#SIGSYS
 31

	)

69 
	#SIGUNUSED
 31

	)

72 
	#SIGRTMIN
 32

	)

73 
	#SIGRTMAX
 
_NSIG


	)

89 
	#SA_NOCLDSTOP
 0x00000001u

	)

90 
	#SA_NOCLDWAIT
 0x00000002u

	)

91 
	#SA_SIGINFO
 0x00000004u

	)

92 
	#SA_ONSTACK
 0x08000000u

	)

93 
	#SA_RESTART
 0x10000000u

	)

94 
	#SA_NODEFER
 0x40000000u

	)

95 
	#SA_RESETHAND
 0x80000000u

	)

97 
	#SA_NOMASK
 
SA_NODEFER


	)

98 
	#SA_ONESHOT
 
SA_RESETHAND


	)

99 
	#SA_INTERRUPT
 0x20000000

	)

101 
	#SA_RESTORER
 0x04000000

	)

106 
	#SS_ONSTACK
 1

	)

107 
	#SS_DISABLE
 2

	)

109 
	#MINSIGSTKSZ
 2048

	)

110 
	#SIGSTKSZ
 8192

	)

112 #ifde‡
__KERNEL__


121 
	#SA_PROBE
 
SA_ONESHOT


	)

122 
	#SA_SAMPLE_RANDOM
 
SA_RESTART


	)

123 
	#SA_SHIRQ
 0x04000000

	)

126 
	#SIG_BLOCK
 0

	)

127 
	#SIG_UNBLOCK
 1

	)

128 
	#SIG_SETMASK
 2

	)

131 (*
	t__sigh™dÀr_t
)();

133 
	#SIG_DFL
 ((
__sigh™dÀr_t
)0Ë

	)

134 
	#SIG_IGN
 ((
__sigh™dÀr_t
)1Ë

	)

135 
	#SIG_ERR
 ((
__sigh™dÀr_t
)-1Ë

	)

137 #ifde‡
__KERNEL__


138 
	sﬁd_siga˘i⁄
 {

139 
__sigh™dÀr_t
 
ß_h™dÀr
;

140 
ﬁd_sig£t_t
 
ß_mask
;

141 
ß_Êags
;

142 (*
ß_ª°‹î
)();

145 
	ssiga˘i⁄
 {

146 
__sigh™dÀr_t
 
ß_h™dÀr
;

147 
ß_Êags
;

148 (*
ß_ª°‹î
)();

149 
sig£t_t
 
ß_mask
;

152 
	sk_siga˘i⁄
 {

153 
siga˘i⁄
 
ß
;

158 
	ssiga˘i⁄
 {

160 
__sigh™dÀr_t
 
_ß_h™dÀr
;

161 (*
_ß_siga˘i⁄
)(, 
sigöfo
 *, *);

162 } 
_u
;

163 
sig£t_t
 
ß_mask
;

164 
ß_Êags
;

165 (*
ß_ª°‹î
)();

168 
	#ß_h™dÀr
 
_u
.
_ß_h™dÀr


	)

169 
	#ß_siga˘i⁄
 
_u
.
_ß_siga˘i⁄


	)

173 
	ssigÆt°ack
 {

174 *
ss_•
;

175 
ss_Êags
;

176 
size_t
 
ss_size
;

177 } 
	t°ack_t
;

179 #ifde‡
__KERNEL__


180 
	~<asm/sigc⁄ãxt.h
>

182 
	#__HAVE_ARCH_SIG_BITOPS


	)

184 
__ölöe__
 
	$sigadd£t
(
sig£t_t
 *
£t
, 
_sig
)

186 
	`__asm__
("bt¶ %1,%0" : "=m"(*
£t
Ë: "Ir"(
_sig
 - 1) : "cc");

187 
	}
}

189 
__ölöe__
 
	$sigdñ£t
(
sig£t_t
 *
£t
, 
_sig
)

191 
	`__asm__
("bå»%1,%0" : "=m"(*
£t
Ë: "Ir"(
_sig
 - 1) : "cc");

192 
	}
}

194 
__ölöe__
 
	$__c⁄°_sigismembî
(
sig£t_t
 *
£t
, 
_sig
)

196 
sig
 = 
_sig
 - 1;

197  1 & (
£t
->
sig
[sig / 
_NSIG_BPW
] >> (sig % _NSIG_BPW));

198 
	}
}

200 
__ölöe__
 
	$__gí_sigismembî
(
sig£t_t
 *
£t
, 
_sig
)

202 
ªt
;

203 
	`__asm__
("btl %2,%1\n\tsbbl %0,%0"

204 : "Ù"(
ªt
Ë: "m"(*
£t
), "Ir"(
_sig
-1) : "cc");

205  
ªt
;

206 
	}
}

208 
	#sigismembî
(
£t
,
sig
) \

209 (
	`__buûtö_c⁄°™t_p
(
sig
) ? \

210 
	`__c⁄°_sigismembî
((
£t
),(
sig
)) : \

211 
	`__gí_sigismembî
((
£t
),(
sig
)))

	)

213 
__ölöe__
 
	$sigfödöw‹d
(
w‹d
)

215 
	`__asm__
("bsÊ %1,%0" : "Ù"(
w‹d
) : "rm"(word) : "cc");

216  
w‹d
;

217 
	}
}

219 
	g±_ªgs
;

220 
FASTCALL
(
do_sig«l
(
±_ªgs
 *
ªgs
, 
sig£t_t
 *
ﬁd£t
));

221 
	#±ø˚_sig«l_dñivî
(
ªgs
, 
cookõ
Ëdÿ{ } 0)

	)

	@/usr/include/asm/user.h

1 #i‚de‡
_I386_USER_H


2 
	#_I386_USER_H


	)

4 
	~<asm/∑ge.h
>

44 
	su£r_i387_°ru˘
 {

45 
	mcwd
;

46 
	mswd
;

47 
	mtwd
;

48 
	mfù
;

49 
	mfcs
;

50 
	mfoo
;

51 
	mfos
;

52 
	m°_•a˚
[20];

55 
	su£r_fx§_°ru˘
 {

56 
	mcwd
;

57 
	mswd
;

58 
	mtwd
;

59 
	mf›
;

60 
	mfù
;

61 
	mfcs
;

62 
	mfoo
;

63 
	mfos
;

64 
	mmxc§
;

65 
	mª£rved
;

66 
	m°_•a˚
[32];

67 
	mxmm_•a˚
[32];

68 
	m∑ddög
[56];

77 
	su£r_ªgs_°ru˘
 {

78 
	mebx
, 
	mecx
, 
	medx
, 
	mesi
, 
	medi
, 
	mebp
, 
	móx
;

79 
	mds
, 
	m__ds
, 
	mes
, 
	m__es
;

80 
	mfs
, 
	m__fs
, 
	mgs
, 
	m__gs
;

81 
	m‹ig_óx
, 
	meù
;

82 
	mcs
, 
	m__cs
;

83 
	meÊags
, 
	me•
;

84 
	mss
, 
	m__ss
;

90 
	su£r
{

93 
u£r_ªgs_°ru˘
 
	mªgs
;

95 
	mu_ÂvÆid
;

97 
u£r_i387_°ru˘
 
	mi387
;

99 
	mu_tsize
;

100 
	mu_dsize
;

101 
	mu_ssize
;

102 
	m°¨t_code
;

103 
	m°¨t_°ack
;

107 
	msig«l
;

108 
	mª£rved
;

109 
u£r_±_ªgs
 * 
	mu_¨0
;

111 
u£r_i387_°ru˘
* 
	mu_Â°©e
;

112 
	mmagic
;

113 
	mu_comm
[32];

114 
	mu_debugªg
[8];

116 
	#NBPG
 
PAGE_SIZE


	)

117 
	#UPAGES
 1

	)

118 
	#HOST_TEXT_START_ADDR
 (
u
.
°¨t_code
)

	)

119 
	#HOST_STACK_END_ADDR
 (
u
.
°¨t_°ack
 + u.
u_ssize
 * 
NBPG
)

	)

	@/usr/include/linux/aio_abi.h

27 #i‚de‡
__LINUX__AIO_ABI_H


28 
	#__LINUX__AIO_ABI_H


	)

30 
	~<asm/byã‹dî.h
>

32 
	taio_c⁄ãxt_t
;

35 
	mIOCB_CMD_PREAD
 = 0,

36 
	mIOCB_CMD_PWRITE
 = 1,

37 
	mIOCB_CMD_FSYNC
 = 2,

38 
	mIOCB_CMD_FDSYNC
 = 3,

43 
	mIOCB_CMD_NOOP
 = 6,

47 
	sio_evít
 {

48 
__u64
 
	md©a
;

49 
__u64
 
	mobj
;

50 
__s64
 
	mªs
;

51 
__s64
 
	mªs2
;

54 #i‡
deföed
(
__LITTLE_ENDIAN
)

55 
	#PADDED
(
x
,
y
Ëx, 
	)
y

56 #ñi‡
deföed
(
__BIG_ENDIAN
)

57 
	#PADDED
(
x
,
y
Ëy, 
	)
x

59 #îr‹ 
edô
 
your
 
odd
 
byã‹dî
.

68 
	siocb
 {

70 
__u64
 
	maio_d©a
;

71 
__u32
 
PADDED
(
aio_key
, 
aio_ª£rved1
);

75 
__u16
 
	maio_lio_›code
;

76 
__s16
 
	maio_ªq¥io
;

77 
__u32
 
	maio_fûdes
;

79 
__u64
 
	maio_buf
;

80 
__u64
 
	maio_nbyãs
;

81 
__s64
 
	maio_off£t
;

84 
__u64
 
	maio_ª£rved2
;

85 
__u64
 
	maio_ª£rved3
;

88 #unde‡
IFBIG


89 #unde‡
IFLITTLE


	@/usr/include/linux/ipc.h

1 #i‚de‡
_LINUX_IPC_H


2 
	#_LINUX_IPC_H


	)

4 
	~<löux/ty≥s.h
>

6 
	#IPC_PRIVATE
 ((
__kî√l_key_t
Ë0)

	)

9 
	sùc_≥rm


11 
__kî√l_key_t
 
	mkey
;

12 
__kî√l_uid_t
 
	muid
;

13 
__kî√l_gid_t
 
	mgid
;

14 
__kî√l_uid_t
 
	mcuid
;

15 
__kî√l_gid_t
 
	mcgid
;

16 
__kî√l_mode_t
 
	mmode
;

17 
	m£q
;

21 
	~<asm/ùcbuf.h
>

24 
	#IPC_CREAT
 00001000

	)

25 
	#IPC_EXCL
 00002000

	)

26 
	#IPC_NOWAIT
 00004000

	)

31 
	#IPC_DIPC
 00010000

	)

32 
	#IPC_OWN
 00020000

	)

38 
	#IPC_RMID
 0

	)

39 
	#IPC_SET
 1

	)

40 
	#IPC_STAT
 2

	)

41 
	#IPC_INFO
 3

	)

47 
	#IPC_OLD
 0

	)

49 
	#IPC_64
 0x0100

	)

52 #ifde‡
__KERNEL__


54 
	#IPCMNI
 32768

	)

57 
	skîn_ùc_≥rm


59 
•ölock_t
 
	mlock
;

60 
	mdñëed
;

61 
key_t
 
	mkey
;

62 
uid_t
 
	muid
;

63 
gid_t
 
	mgid
;

64 
uid_t
 
	mcuid
;

65 
gid_t
 
	mcgid
;

66 
mode_t
 
	mmode
;

67 
	m£q
;

68 *
	m£curôy
;

	@/usr/include/linux/mmzone.h

1 #i‚de‡
_LINUX_MMZONE_H


2 
	#_LINUX_MMZONE_H


	)

4 #ifde‡
__KERNEL__


5 #i‚de‡
__ASSEMBLY__


7 
	~<löux/c⁄fig.h
>

8 
	~<löux/•ölock.h
>

9 
	~<löux/li°.h
>

10 
	~<löux/waô.h
>

11 
	~<löux/ˇche.h
>

12 
	~<löux/thªads.h
>

13 
	~<löux/numa.h
>

14 
	~<asm/©omic.h
>

17 #i‚de‡
CONFIG_FORCE_MAX_ZONEORDER


18 
	#MAX_ORDER
 11

	)

20 
	#MAX_ORDER
 
CONFIG_FORCE_MAX_ZONEORDER


	)

23 
	s‰ì_¨ó
 {

24 
li°_hód
 
	m‰ì_li°
;

25 *
	mm≠
;

28 
	gpgli°_d©a
;

36 #i‡
deföed
(
CONFIG_SMP
)

37 
	sz⁄e_∑ddög
 {

38 
	mx
;

39 } 
	g____ˇchñöe_maxÆig√d_ö_smp
;

40 
	#ZONE_PADDING
(
«me
Ë
z⁄e_∑ddög
Çame;

	)

42 
	#ZONE_PADDING
(
«me
)

	)

45 
	s≥r_˝u_∑ges
 {

46 
	mcou¡
;

47 
	mlow
;

48 
	mhigh
;

49 
	mb©ch
;

50 
li°_hód
 
	mli°
;

53 
	s≥r_˝u_∑ge£t
 {

54 
≥r_˝u_∑ges
 
	mp˝
[2];

55 } 
	g____ˇchñöe_Æig√d_ö_smp
;

66 
	sz⁄e
 {

70 
•ölock_t
 
	mlock
;

71 
	m‰ì_∑ges
;

72 
	m∑ges_mö
, 
	m∑ges_low
, 
	m∑ges_high
;

74 
ZONE_PADDING
(
_∑d1_
)

76 
•ölock_t
 
	mÃu_lock
;

77 
li°_hód
 
	ma˘ive_li°
;

78 
li°_hód
 
	möa˘ive_li°
;

79 
©omic_t
 
	mªfûl_cou¡î
;

80 
	mƒ_a˘ive
;

81 
	mƒ_öa˘ive
;

82 
	mÆl_uƒe˛aimabÀ
;

83 
	m∑ges_sˇ¬ed
;

85 
ZONE_PADDING
(
_∑d2_
)

103 
	mãmp_¥i‹ôy
;

104 
	m¥ev_¥i‹ôy
;

109 
‰ì_¨ó
 
	m‰ì_¨ó
[
MAX_ORDER
];

135 
waô_queue_hód_t
 * 
	mwaô_èbÀ
;

136 
	mwaô_èbÀ_size
;

137 
	mwaô_èbÀ_bôs
;

139 
ZONE_PADDING
(
_∑d3_
)

141 
≥r_˝u_∑ge£t
 
	m∑ge£t
[
NR_CPUS
];

146 
pgli°_d©a
 *
	mz⁄e_pgd©
;

147 
∑ge
 *
	mz⁄e_mem_m≠
;

149 
	mz⁄e_°¨t_p‚
;

154 *
	m«me
;

155 
	m•™√d_∑ges
;

156 
	m¥e£¡_∑ges
;

157 } 
	g____ˇchñöe_maxÆig√d_ö_smp
;

159 
	#ZONE_DMA
 0

	)

160 
	#ZONE_NORMAL
 1

	)

161 
	#ZONE_HIGHMEM
 2

	)

162 
	#MAX_NR_ZONES
 3

	)

163 
	#GFP_ZONEMASK
 0x03

	)

176 
	sz⁄ñi°
 {

177 
z⁄e
 *
	mz⁄es
[
MAX_NUMNODES
 * 
MAX_NR_ZONES
 + 1];

192 
	gboŸmem_d©a
;

193 
	spgli°_d©a
 {

194 
z⁄e
 
	mnode_z⁄es
[
MAX_NR_ZONES
];

195 
z⁄ñi°
 
	mnode_z⁄ñi°s
[
MAX_NR_ZONES
];

196 
	mƒ_z⁄es
;

197 
∑ge
 *
	mnode_mem_m≠
;

198 *
	mvÆid_addr_bôm≠
;

199 
boŸmem_d©a
 *
	mbd©a
;

200 
	mnode_°¨t_p‚
;

201 
	mnode_¥e£¡_∑ges
;

202 
	mnode_•™√d_∑ges
;

204 
	mnode_id
;

205 
pgli°_d©a
 *
	mpgd©_√xt
;

206 
waô_queue_hód_t
 
	mksw≠d_waô
;

207 } 
	tpg_d©a_t
;

209 
	#node_¥e£¡_∑ges
(
nid
Ë(
	`NODE_DATA
“id)->
node_¥e£¡_∑ges
)

	)

210 
	#node_•™√d_∑ges
(
nid
Ë(
	`NODE_DATA
“id)->
node_•™√d_∑ges
)

	)

212 
numnodes
;

213 
pgli°_d©a
 *
pgd©_li°
;

215 
gë_z⁄e_cou¡s
(*
a˘ive
, *
öa˘ive
,

216 *
‰ì
);

217 
buûd_Æl_z⁄ñi°s
();

218 
wakeup_ksw≠d
(
z⁄e
 *zone);

231 
	#f‹_óch_pgd©
(
pgd©
) \

232 
pgd©
 = 
pgd©_li°
;Ögd©;Ögd© =Ögd©->
pgd©_√xt
)

	)

238 
ölöe
 
z⁄e
 *
	$√xt_z⁄e
(
z⁄e
 *zone)

240 
pg_d©a_t
 *
pgd©
 = 
z⁄e
->
z⁄e_pgd©
;

242 i‡(
z⁄e
 - 
pgd©
->
node_z⁄es
 < 
MAX_NR_ZONES
 - 1)

243 
z⁄e
++;

244 i‡(
pgd©
->
pgd©_√xt
) {

245 
pgd©
 =Ögd©->
pgd©_√xt
;

246 
z⁄e
 = 
pgd©
->
node_z⁄es
;

248 
z⁄e
 = 
NULL
;

250  
z⁄e
;

251 
	}
}

268 
	#f‹_óch_z⁄e
(
z⁄e
) \

269 
z⁄e
 = 
pgd©_li°
->
node_z⁄es
; z⁄e; z⁄ê
	`√xt_z⁄e
(z⁄e))

	)

277 
ölöe
 
	$is_highmem
(
z⁄e
 *zone)

279  (
z⁄e
 - z⁄e->
z⁄e_pgd©
->
node_z⁄es
 =
ZONE_HIGHMEM
);

280 
	}
}

283 
	g˘l_èbÀ
;

284 
	gfûe
;

285 
mö_‰ì_kbyãs_sys˘l_h™dÀr
(
˘l_èbÀ
 *, , 
fûe
 *,

286 *, 
size_t
 *);

287 
£tup_≥r_z⁄e_∑ges_mö
();

290 #ifde‡
CONFIG_NUMA


291 
	#MAX_NR_MEMBLKS
 
BITS_PER_LONG


	)

293 
	#MAX_NR_MEMBLKS
 1

	)

296 
	~<löux/t›ﬁogy.h
>

298 
	#numa_node_id
(Ë(
	`˝u_to_node
(
	`smp_¥o˚ss‹_id
()))

	)

300 #i‚de‡
CONFIG_DISCONTIGMEM


302 
pgli°_d©a
 
c⁄tig_∑ge_d©a
;

303 
	#NODE_DATA
(
nid
Ë(&
c⁄tig_∑ge_d©a
)

	)

304 
	#NODE_MEM_MAP
(
nid
Ë
mem_m≠


	)

305 
	#MAX_NODES_SHIFT
 0

	)

309 
	~<asm/mmz⁄e.h
>

311 #i‡
BITS_PER_LONG
 == 32

316 
	#MAX_NODES_SHIFT
 6

	)

317 #ñi‡
BITS_PER_LONG
 == 64

321 
	#MAX_NODES_SHIFT
 10

	)

326 #i‡
NODES_SHIFT
 > 
MAX_NODES_SHIFT


327 #îr‹ 
NODES_SHIFT
 > 
MAX_NODES_SHIFT


330 
DECLARE_BITMAP
(
node_⁄löe_m≠
, 
MAX_NUMNODES
);

331 
DECLARE_BITMAP
(
memblk_⁄löe_m≠
, 
MAX_NR_MEMBLKS
);

333 #i‡
deföed
(
CONFIG_DISCONTIGMEM
Ë|| deföed(
CONFIG_NUMA
)

335 
	#node_⁄löe
(
node
Ë
	`ã°_bô
“ode, 
node_⁄löe_m≠
)

	)

336 
	#node_£t_⁄löe
(
node
Ë
	`£t_bô
“ode, 
node_⁄löe_m≠
)

	)

337 
	#node_£t_ofÊöe
(
node
Ë
	`˛ór_bô
“ode, 
node_⁄löe_m≠
)

	)

338 
ölöe
 
	$num_⁄löe_nodes
()

340 
i
, 
num
 = 0;

342 
i
 = 0; i < 
MAX_NUMNODES
; i++){

343 i‡(
	`node_⁄löe
(
i
))

344 
num
++;

346  
num
;

347 
	}
}

349 
	#memblk_⁄löe
(
memblk
Ë
	`ã°_bô
(memblk, 
memblk_⁄löe_m≠
)

	)

350 
	#memblk_£t_⁄löe
(
memblk
Ë
	`£t_bô
(memblk, 
memblk_⁄löe_m≠
)

	)

351 
	#memblk_£t_ofÊöe
(
memblk
Ë
	`˛ór_bô
(memblk, 
memblk_⁄löe_m≠
)

	)

352 
ölöe
 
	$num_⁄löe_memblks
()

354 
i
, 
num
 = 0;

356 
i
 = 0; i < 
MAX_NR_MEMBLKS
; i++){

357 i‡(
	`memblk_⁄löe
(
i
))

358 
num
++;

360  
num
;

361 
	}
}

365 
	#node_⁄löe
(
node
) \

366 ({ 
	`BUG_ON
((
node
Ë!0); 
	`ã°_bô
“ode, 
node_⁄löe_m≠
); })

	)

367 
	#node_£t_⁄löe
(
node
) \

368 ({ 
	`BUG_ON
((
node
Ë!0); 
	`£t_bô
“ode, 
node_⁄löe_m≠
); })

	)

369 
	#node_£t_ofÊöe
(
node
) \

370 ({ 
	`BUG_ON
((
node
Ë!0); 
	`˛ór_bô
“ode, 
node_⁄löe_m≠
); })

	)

371 
	#num_⁄löe_nodes
(Ë1

	)

373 
	#memblk_⁄löe
(
memblk
) \

374 ({ 
	`BUG_ON
((
memblk
Ë!0); 
	`ã°_bô
(memblk, 
memblk_⁄löe_m≠
); })

	)

375 
	#memblk_£t_⁄löe
(
memblk
) \

376 ({ 
	`BUG_ON
((
memblk
Ë!0); 
	`£t_bô
(memblk, 
memblk_⁄löe_m≠
); })

	)

377 
	#memblk_£t_ofÊöe
(
memblk
) \

378 ({ 
	`BUG_ON
((
memblk
Ë!0); 
	`˛ór_bô
(memblk, 
memblk_⁄löe_m≠
); })

	)

379 
	#num_⁄löe_memblks
(Ë1

	)

	@/usr/include/linux/utsname.h

1 #i‚de‡
_LINUX_UTSNAME_H


2 
	#_LINUX_UTSNAME_H


	)

4 
	#__OLD_UTS_LEN
 8

	)

6 
	sﬁdﬁd_ut¢ame
 {

7 
	msy¢ame
[9];

8 
	mnodíame
[9];

9 
	mªÀa£
[9];

10 
	mvîsi⁄
[9];

11 
	mmachöe
[9];

14 
	#__NEW_UTS_LEN
 64

	)

16 
	sﬁd_ut¢ame
 {

17 
	msy¢ame
[65];

18 
	mnodíame
[65];

19 
	mªÀa£
[65];

20 
	mvîsi⁄
[65];

21 
	mmachöe
[65];

24 
	s√w_ut¢ame
 {

25 
	msy¢ame
[65];

26 
	mnodíame
[65];

27 
	mªÀa£
[65];

28 
	mvîsi⁄
[65];

29 
	mmachöe
[65];

30 
	mdomaö«me
[65];

33 
√w_ut¢ame
 
sy°em_ut¢ame
;

35 
rw_£m≠h‹e
 
uts_£m
;

	@/usr/include/asm-generic/siginfo.h

1 #i‚de‡
_ASM_GENERIC_SIGINFO_H


2 
	#_ASM_GENERIC_SIGINFO_H


	)

4 
	~<löux/compûî.h
>

5 
	~<löux/ty≥s.h
>

7 
	usigvÆ
 {

8 
	msivÆ_öt
;

9 *
	msivÆ_±r
;

10 } 
	tsigvÆ_t
;

16 #i‚de‡
__ARCH_SI_PREAMBLE_SIZE


17 
	#__ARCH_SI_PREAMBLE_SIZE
 (3 * ())

	)

20 
	#SI_MAX_SIZE
 128

	)

21 #i‚de‡
SI_PAD_SIZE


22 
	#SI_PAD_SIZE
 ((
SI_MAX_SIZE
 - 
__ARCH_SI_PREAMBLE_SIZE
Ë/ ())

	)

25 #i‚de‡
__ARCH_SI_UID_T


26 
	#__ARCH_SI_UID_T
 
uid_t


	)

29 #i‚de‡
__ARCH_SI_BAND_T


30 
	#__ARCH_SI_BAND_T
 

	)

33 #i‚de‡
HAVE_ARCH_SIGINFO_T


35 
	ssigöfo
 {

36 
	msi_signo
;

37 
	msi_î∫o
;

38 
	msi_code
;

41 
	m_∑d
[
SI_PAD_SIZE
];

45 
pid_t
 
	m_pid
;

46 
__ARCH_SI_UID_T
 
	m_uid
;

47 } 
	m_kûl
;

51 
timî_t
 
	m_tid
;

52 
	m_ovîrun
;

53 
	m_∑d
[–
__ARCH_SI_UID_T
) - ()];

54 
sigvÆ_t
 
	m_sigvÆ
;

55 
	m_sys_¥iv©e
;

56 } 
	m_timî
;

60 
pid_t
 
	m_pid
;

61 
__ARCH_SI_UID_T
 
	m_uid
;

62 
sigvÆ_t
 
	m_sigvÆ
;

63 } 
	m_π
;

67 
pid_t
 
	m_pid
;

68 
__ARCH_SI_UID_T
 
	m_uid
;

69 
	m_°©us
;

70 
˛ock_t
 
	m_utime
;

71 
˛ock_t
 
	m_°ime
;

72 } 
	m_sigchld
;

76 *
	m_addr
;

77 #ifde‡
__ARCH_SI_TRAPNO


78 
	m_å≠no
;

80 } 
	m_sigÁu…
;

84 
__ARCH_SI_BAND_T
 
	m_b™d
;

85 
	m_fd
;

86 } 
	m_sigpﬁl
;

87 } 
	m_sifõlds
;

88 } 
	tsigöfo_t
;

95 
	#si_pid
 
_sifõlds
.
_kûl
.
_pid


	)

96 
	#si_uid
 
_sifõlds
.
_kûl
.
_uid


	)

97 
	#si_tid
 
_sifõlds
.
_timî
.
_tid


	)

98 
	#si_ovîrun
 
_sifõlds
.
_timî
.
_ovîrun


	)

99 
	#si_sys_¥iv©e
 
_sifõlds
.
_timî
.
_sys_¥iv©e


	)

100 
	#si_°©us
 
_sifõlds
.
_sigchld
.
_°©us


	)

101 
	#si_utime
 
_sifõlds
.
_sigchld
.
_utime


	)

102 
	#si_°ime
 
_sifõlds
.
_sigchld
.
_°ime


	)

103 
	#si_vÆue
 
_sifõlds
.
_π
.
_sigvÆ


	)

104 
	#si_öt
 
_sifõlds
.
_π
.
_sigvÆ
.
sivÆ_öt


	)

105 
	#si_±r
 
_sifõlds
.
_π
.
_sigvÆ
.
sivÆ_±r


	)

106 
	#si_addr
 
_sifõlds
.
_sigÁu…
.
_addr


	)

107 #ifde‡
__ARCH_SI_TRAPNO


108 
	#si_å≠no
 
_sifõlds
.
_sigÁu…
.
_å≠no


	)

110 
	#si_b™d
 
_sifõlds
.
_sigpﬁl
.
_b™d


	)

111 
	#si_fd
 
_sifõlds
.
_sigpﬁl
.
_fd


	)

113 #ifde‡
__KERNEL__


114 
	#__SI_MASK
 0xffff0000u

	)

115 
	#__SI_KILL
 (0 << 16)

	)

116 
	#__SI_TIMER
 (1 << 16)

	)

117 
	#__SI_POLL
 (2 << 16)

	)

118 
	#__SI_FAULT
 (3 << 16)

	)

119 
	#__SI_CHLD
 (4 << 16)

	)

120 
	#__SI_RT
 (5 << 16)

	)

121 
	#__SI_CODE
(
T
,
N
Ë((TË| ((NË& 0xffff))

	)

123 
	#__SI_KILL
 0

	)

124 
	#__SI_TIMER
 0

	)

125 
	#__SI_POLL
 0

	)

126 
	#__SI_FAULT
 0

	)

127 
	#__SI_CHLD
 0

	)

128 
	#__SI_RT
 0

	)

129 
	#__SI_CODE
(
T
,
N
Ë(N)

	)

136 
	#SI_USER
 0

	)

137 
	#SI_KERNEL
 0x80

	)

138 
	#SI_QUEUE
 -1

	)

139 
	#SI_TIMER
 
	`__SI_CODE
(
__SI_TIMER
,-2Ë

	)

140 
	#SI_MESGQ
 -3

	)

141 
	#SI_ASYNCIO
 -4

	)

142 
	#SI_SIGIO
 -5

	)

143 
	#SI_TKILL
 -6

	)

144 
	#SI_DETHREAD
 -7

	)

146 
	#SI_FROMUSER
(
sùå
Ë((sùå)->
si_code
 <0)

	)

147 
	#SI_FROMKERNEL
(
sùå
Ë((sùå)->
si_code
 > 0)

	)

149 #i‚de‡
HAVE_ARCH_SI_CODES


153 
	#ILL_ILLOPC
 (
__SI_FAULT
|1Ë

	)

154 
	#ILL_ILLOPN
 (
__SI_FAULT
|2Ë

	)

155 
	#ILL_ILLADR
 (
__SI_FAULT
|3Ë

	)

156 
	#ILL_ILLTRP
 (
__SI_FAULT
|4Ë

	)

157 
	#ILL_PRVOPC
 (
__SI_FAULT
|5Ë

	)

158 
	#ILL_PRVREG
 (
__SI_FAULT
|6Ë

	)

159 
	#ILL_COPROC
 (
__SI_FAULT
|7Ë

	)

160 
	#ILL_BADSTK
 (
__SI_FAULT
|8Ë

	)

161 
	#NSIGILL
 8

	)

166 
	#FPE_INTDIV
 (
__SI_FAULT
|1Ë

	)

167 
	#FPE_INTOVF
 (
__SI_FAULT
|2Ë

	)

168 
	#FPE_FLTDIV
 (
__SI_FAULT
|3Ë

	)

169 
	#FPE_FLTOVF
 (
__SI_FAULT
|4Ë

	)

170 
	#FPE_FLTUND
 (
__SI_FAULT
|5Ë

	)

171 
	#FPE_FLTRES
 (
__SI_FAULT
|6Ë

	)

172 
	#FPE_FLTINV
 (
__SI_FAULT
|7Ë

	)

173 
	#FPE_FLTSUB
 (
__SI_FAULT
|8Ë

	)

174 
	#NSIGFPE
 8

	)

179 
	#SEGV_MAPERR
 (
__SI_FAULT
|1Ë

	)

180 
	#SEGV_ACCERR
 (
__SI_FAULT
|2Ë

	)

181 
	#NSIGSEGV
 2

	)

186 
	#BUS_ADRALN
 (
__SI_FAULT
|1Ë

	)

187 
	#BUS_ADRERR
 (
__SI_FAULT
|2Ë

	)

188 
	#BUS_OBJERR
 (
__SI_FAULT
|3Ë

	)

189 
	#NSIGBUS
 3

	)

194 
	#TRAP_BRKPT
 (
__SI_FAULT
|1Ë

	)

195 
	#TRAP_TRACE
 (
__SI_FAULT
|2Ë

	)

196 
	#NSIGTRAP
 2

	)

201 
	#CLD_EXITED
 (
__SI_CHLD
|1Ë

	)

202 
	#CLD_KILLED
 (
__SI_CHLD
|2Ë

	)

203 
	#CLD_DUMPED
 (
__SI_CHLD
|3Ë

	)

204 
	#CLD_TRAPPED
 (
__SI_CHLD
|4Ë

	)

205 
	#CLD_STOPPED
 (
__SI_CHLD
|5Ë

	)

206 
	#CLD_CONTINUED
 (
__SI_CHLD
|6Ë

	)

207 
	#NSIGCHLD
 6

	)

212 
	#POLL_IN
 (
__SI_POLL
|1Ë

	)

213 
	#POLL_OUT
 (
__SI_POLL
|2Ë

	)

214 
	#POLL_MSG
 (
__SI_POLL
|3Ë

	)

215 
	#POLL_ERR
 (
__SI_POLL
|4Ë

	)

216 
	#POLL_PRI
 (
__SI_POLL
|5Ë

	)

217 
	#POLL_HUP
 (
__SI_POLL
|6Ë

	)

218 
	#NSIGPOLL
 6

	)

230 
	#SIGEV_SIGNAL
 0

	)

231 
	#SIGEV_NONE
 1

	)

232 
	#SIGEV_THREAD
 2

	)

233 
	#SIGEV_THREAD_ID
 4

	)

235 
	#SIGEV_MAX_SIZE
 64

	)

236 #i‚de‡
SIGEV_PAD_SIZE


237 
	#SIGEV_PAD_SIZE
 ((
SIGEV_MAX_SIZE
/()Ë- 3)

	)

240 #i‚de‡
HAVE_ARCH_SIGEVENT_T


242 
	ssigevít
 {

243 
sigvÆ_t
 
	msigev_vÆue
;

244 
	msigev_signo
;

245 
	msigev_nŸify
;

247 
	m_∑d
[
SIGEV_PAD_SIZE
];

248 
	m_tid
;

251 (*
	m_fun˘i⁄
)(
	msigvÆ_t
);

252 *
	m_©åibuã
;

253 } 
	m_sigev_thªad
;

254 } 
	m_sigev_un
;

255 } 
	tsigevít_t
;

259 
	#sigev_nŸify_fun˘i⁄
 
_sigev_un
.
_sigev_thªad
.
_fun˘i⁄


	)

260 
	#sigev_nŸify_©åibuãs
 
_sigev_un
.
_sigev_thªad
.
_©åibuã


	)

261 
	#sigev_nŸify_thªad_id
 
_sigev_un
.
_tid


	)

263 #ifde‡
__KERNEL__


265 
	gsigöfo
;

266 
do_scheduÀ_√xt_timî
(
sigöfo
 *
öfo
);

268 #i‚de‡
HAVE_ARCH_COPY_SIGINFO


270 
	~<löux/°rög.h
>

272 
ölöe
 
	$c›y_sigöfo
(
sigöfo
 *
to
, sigöfÿ*
‰om
)

274 i‡(
‰om
->
si_code
 < 0)

275 
	`mem˝y
(
to
, 
‰om
, (*to));

278 
	`mem˝y
(
to
, 
‰om
, 
__ARCH_SI_PREAMBLE_SIZE
 + (‰om->
_sifõlds
.
_sigchld
));

279 
	}
}

283 
c›y_sigöfo_to_u£r
(
sigöfo
 
__u£r
 *
to
, sigöfÿ*
‰om
);

	@/usr/include/asm/acpi.h

26 #i‚de‡
_ASM_ACPI_H


27 
	#_ASM_ACPI_H


	)

29 #ifde‡
__KERNEL__


31 
	#COMPILER_DEPENDENT_INT64
 

	)

32 
	#COMPILER_DEPENDENT_UINT64
 

	)

42 
	#ACPI_SYSTEM_XFACE


	)

43 
	#ACPI_EXTERNAL_XFACE


	)

44 
	#ACPI_INTERNAL_XFACE


	)

45 
	#ACPI_INTERNAL_VAR_XFACE


	)

49 
	#ACPI_ASM_MACROS


	)

50 
	#BREAKPOINT3


	)

51 
	#ACPI_DISABLE_IRQS
(Ë
	`loˇl_úq_dißbÀ
()

	)

52 
	#ACPI_ENABLE_IRQS
(Ë
	`loˇl_úq_íabÀ
()

	)

53 
	#ACPI_FLUSH_CPU_CACHE
(Ë
	`wbövd
()

	)

64 
	#ACPI_ACQUIRE_GLOBAL_LOCK
(
GL±r
, 
Acq
) \

66 
dummy
; \

67 
	`asm
("1: movl (%1),%%eax;" \

76 :"˜"(
Acq
),"=c"(
dummy
):"c"(
GL±r
),"i"(~1L):"dx"); \

77 } 0)

	)

79 
	#ACPI_RELEASE_GLOBAL_LOCK
(
GL±r
, 
Acq
) \

81 
dummy
; \

82 
	`asm
("1: movl (%1),%%eax;" \

88 :"˜"(
Acq
),"=c"(
dummy
):"c"(
GL±r
),"i"(~3L):"dx"); \

89 } 0)

	)

95 
	#ACPI_DIV_64_BY_32
(
n_hi
, 
n_lo
, 
d32
, 
q32
, 
r32
) \

96 
	`asm
("divl %2;" \

97 :"˜"(
q32
), "=d"(
r32
) \

98 :"r"(
d32
), \

99 "0"(
n_lo
), "1"(
n_hi
))

	)

102 
	#ACPI_SHIFT_RIGHT_64
(
n_hi
, 
n_lo
) \

103 
	`asm
("shrl $1,%2;" \

105 :"Ù"(
n_hi
), "Ù"(
n_lo
) \

106 :"0"(
n_hi
), "1"(
n_lo
))

	)

109 #ifde‡
CONFIG_ACPI_BOOT


110 
a˝i_œpic
;

111 
a˝i_iﬂpic
;

115 
	#FIX_ACPI_PAGES
 4

	)

117 #ifde‡
CONFIG_X86_IO_APIC


118 
skù_iﬂpic_£tup
;

120 
ölöe
 
	$dißbÀ_iﬂpic_£tup
()

122 
skù_iﬂpic_£tup
 = 1;

123 
	}
}

125 
ölöe
 
	$iﬂpic_£tup_dißbÀd
()

127  
skù_iﬂpic_£tup
;

128 
	}
}

131 
ölöe
 
	$dißbÀ_iﬂpic_£tup
()

132 { 
	}
}

137 
	#a˝i_œpic
 0

	)

138 
	#a˝i_iﬂpic
 0

	)

142 #ifde‡
CONFIG_ACPI_SLEEP


145 
a˝i_ßve_°©e_mem
();

146 
a˝i_ßve_°©e_disk
();

147 
a˝i_ª°‹e_°©e_mem
();

149 
a˝i_wakeup_addªss
;

152 
a˝i_ª£rve_boŸmem
();

	@/usr/include/asm/apicdef.h

1 #i‚de‡
__ASM_APICDEF_H


2 
	#__ASM_APICDEF_H


	)

11 
	#APIC_DEFAULT_PHYS_BASE
 0x„e00000

	)

13 
	#APIC_ID
 0x20

	)

14 
	#APIC_LVR
 0x30

	)

15 
	#APIC_LVR_MASK
 0xFF00FF

	)

16 
	#GET_APIC_VERSION
(
x
Ë((x)&0xFF)

	)

17 
	#GET_APIC_MAXLVT
(
x
Ë(((x)>>16)&0xFF)

	)

18 
	#APIC_INTEGRATED
(
x
Ë((x)&0xF0)

	)

19 
	#APIC_TASKPRI
 0x80

	)

20 
	#APIC_TPRI_MASK
 0xFF

	)

21 
	#APIC_ARBPRI
 0x90

	)

22 
	#APIC_ARBPRI_MASK
 0xFF

	)

23 
	#APIC_PROCPRI
 0xA0

	)

24 
	#APIC_EOI
 0xB0

	)

25 
	#APIC_EIO_ACK
 0x0

	)

26 
	#APIC_RRR
 0xC0

	)

27 
	#APIC_LDR
 0xD0

	)

28 
	#APIC_LDR_MASK
 (0xFF<<24)

	)

29 
	#GET_APIC_LOGICAL_ID
(
x
Ë(((x)>>24)&0xFF)

	)

30 
	#SET_APIC_LOGICAL_ID
(
x
Ë(((x)<<24))

	)

31 
	#APIC_ALL_CPUS
 0xFF

	)

32 
	#APIC_DFR
 0xE0

	)

33 
	#APIC_DFR_CLUSTER
 0x0FFFFFFFul

	)

34 
	#APIC_DFR_FLAT
 0xFFFFFFFFul

	)

35 
	#APIC_SPIV
 0xF0

	)

36 
	#APIC_SPIV_FOCUS_DISABLED
 (1<<9)

	)

37 
	#APIC_SPIV_APIC_ENABLED
 (1<<8)

	)

38 
	#APIC_ISR
 0x100

	)

39 
	#APIC_TMR
 0x180

	)

40 
	#APIC_IRR
 0x200

	)

41 
	#APIC_ESR
 0x280

	)

42 
	#APIC_ESR_SEND_CS
 0x00001

	)

43 
	#APIC_ESR_RECV_CS
 0x00002

	)

44 
	#APIC_ESR_SEND_ACC
 0x00004

	)

45 
	#APIC_ESR_RECV_ACC
 0x00008

	)

46 
	#APIC_ESR_SENDILL
 0x00020

	)

47 
	#APIC_ESR_RECVILL
 0x00040

	)

48 
	#APIC_ESR_ILLREGA
 0x00080

	)

49 
	#APIC_ICR
 0x300

	)

50 
	#APIC_DEST_SELF
 0x40000

	)

51 
	#APIC_DEST_ALLINC
 0x80000

	)

52 
	#APIC_DEST_ALLBUT
 0xC0000

	)

53 
	#APIC_ICR_RR_MASK
 0x30000

	)

54 
	#APIC_ICR_RR_INVALID
 0x00000

	)

55 
	#APIC_ICR_RR_INPROG
 0x10000

	)

56 
	#APIC_ICR_RR_VALID
 0x20000

	)

57 
	#APIC_INT_LEVELTRIG
 0x08000

	)

58 
	#APIC_INT_ASSERT
 0x04000

	)

59 
	#APIC_ICR_BUSY
 0x01000

	)

60 
	#APIC_DEST_LOGICAL
 0x00800

	)

61 
	#APIC_DM_FIXED
 0x00000

	)

62 
	#APIC_DM_LOWEST
 0x00100

	)

63 
	#APIC_DM_SMI
 0x00200

	)

64 
	#APIC_DM_REMRD
 0x00300

	)

65 
	#APIC_DM_NMI
 0x00400

	)

66 
	#APIC_DM_INIT
 0x00500

	)

67 
	#APIC_DM_STARTUP
 0x00600

	)

68 
	#APIC_DM_EXTINT
 0x00700

	)

69 
	#APIC_VECTOR_MASK
 0x000FF

	)

70 
	#APIC_ICR2
 0x310

	)

71 
	#GET_APIC_DEST_FIELD
(
x
Ë(((x)>>24)&0xFF)

	)

72 
	#SET_APIC_DEST_FIELD
(
x
Ë((x)<<24)

	)

73 
	#APIC_LVTT
 0x320

	)

74 
	#APIC_LVTTHMR
 0x330

	)

75 
	#APIC_LVTPC
 0x340

	)

76 
	#APIC_LVT0
 0x350

	)

77 
	#APIC_LVT_TIMER_BASE_MASK
 (0x3<<18)

	)

78 
	#GET_APIC_TIMER_BASE
(
x
Ë(((x)>>18)&0x3)

	)

79 
	#SET_APIC_TIMER_BASE
(
x
Ë(((x)<<18))

	)

80 
	#APIC_TIMER_BASE_CLKIN
 0x0

	)

81 
	#APIC_TIMER_BASE_TMBASE
 0x1

	)

82 
	#APIC_TIMER_BASE_DIV
 0x2

	)

83 
	#APIC_LVT_TIMER_PERIODIC
 (1<<17)

	)

84 
	#APIC_LVT_MASKED
 (1<<16)

	)

85 
	#APIC_LVT_LEVEL_TRIGGER
 (1<<15)

	)

86 
	#APIC_LVT_REMOTE_IRR
 (1<<14)

	)

87 
	#APIC_INPUT_POLARITY
 (1<<13)

	)

88 
	#APIC_SEND_PENDING
 (1<<12)

	)

89 
	#GET_APIC_DELIVERY_MODE
(
x
Ë(((x)>>8)&0x7)

	)

90 
	#SET_APIC_DELIVERY_MODE
(
x
,
y
Ë(((x)&~0x700)|((y)<<8))

	)

91 
	#APIC_MODE_FIXED
 0x0

	)

92 
	#APIC_MODE_NMI
 0x4

	)

93 
	#APIC_MODE_EXINT
 0x7

	)

94 
	#APIC_LVT1
 0x360

	)

95 
	#APIC_LVTERR
 0x370

	)

96 
	#APIC_TMICT
 0x380

	)

97 
	#APIC_TMCCT
 0x390

	)

98 
	#APIC_TDCR
 0x3E0

	)

99 
	#APIC_TDR_DIV_TMBASE
 (1<<2)

	)

100 
	#APIC_TDR_DIV_1
 0xB

	)

101 
	#APIC_TDR_DIV_2
 0x0

	)

102 
	#APIC_TDR_DIV_4
 0x1

	)

103 
	#APIC_TDR_DIV_8
 0x2

	)

104 
	#APIC_TDR_DIV_16
 0x3

	)

105 
	#APIC_TDR_DIV_32
 0x8

	)

106 
	#APIC_TDR_DIV_64
 0x9

	)

107 
	#APIC_TDR_DIV_128
 0xA

	)

109 
	#APIC_BASE
 (
	`fix_to_vút
(
FIX_APIC_BASE
))

	)

111 #ifde‡
CONFIG_NUMA


112 
	#MAX_IO_APICS
 32

	)

114 
	#MAX_IO_APICS
 8

	)

123 
	#u32
 

	)

125 
	#œpic
 ((vﬁ©ûê
loˇl_≠ic
 *)
APIC_BASE
)

	)

127 
	sloˇl_≠ic
 {

129  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_01
;

131  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_02
;

134 
u32
 
	m__ª£rved_1
 : 24,

135 
	mphys_≠ic_id
 : 4,

136 
	m__ª£rved_2
 : 4;

137 
u32
 
	m__ª£rved
[3];

138 } 
	mid
;

142 
u32
 
	mvîsi⁄
 : 8,

143 
	m__ª£rved_1
 : 8,

144 
	mmax_lvt
 : 8,

145 
	m__ª£rved_2
 : 8;

146 
u32
 
	m__ª£rved
[3];

147 } 
	mvîsi⁄
;

149  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_03
;

151  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_04
;

153  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_05
;

155  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_06
;

158 
u32
 
	m¥i‹ôy
 : 8,

159 
	m__ª£rved_1
 : 24;

160 
u32
 
	m__ª£rved_2
[3];

161 } 
	mçr
;

165 
u32
 
	m¥i‹ôy
 : 8,

166 
	m__ª£rved_1
 : 24;

167 
u32
 
	m__ª£rved_2
[3];

168 } 
	m≠r
;

172 
u32
 
	m¥i‹ôy
 : 8,

173 
	m__ª£rved_1
 : 24;

174 
u32
 
	m__ª£rved_2
[3];

175 } 
	mµr
;

178 
u32
 
	meoi
;

179 
u32
 
	m__ª£rved
[3];

180 } 
	meoi
;

182  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_07
;

185 
u32
 
	m__ª£rved_1
 : 24,

186 
	mlogiˇl_de°
 : 8;

187 
u32
 
	m__ª£rved_2
[3];

188 } 
	mldr
;

191 
u32
 
	m__ª£rved_1
 : 28,

192 
	mmodñ
 : 4;

193 
u32
 
	m__ª£rved_2
[3];

194 } 
	md‰
;

197 
u32
 
	m•urious_ve˘‹
 : 8,

198 
	m≠ic_íabÀd
 : 1,

199 
	mfocus_˝u
 : 1,

200 
	m__ª£rved_2
 : 22;

201 
u32
 
	m__ª£rved_3
[3];

202 } 
	msvr
;

205  
u32
 
	mbôfõld
;

206 
u32
 
	m__ª£rved
[3];

207 } 
	mi§
 [8];

210  
u32
 
	mbôfõld
;

211 
u32
 
	m__ª£rved
[3];

212 } 
	mtmr
 [8];

215  
u32
 
	mbôfõld
;

216 
u32
 
	m__ª£rved
[3];

217 } 
	múr
 [8];

221 
u32
 
	m£nd_cs_îr‹
 : 1,

222 
	mª˚ive_cs_îr‹
 : 1,

223 
	m£nd_ac˚±_îr‹
 : 1,

224 
	mª˚ive_ac˚±_îr‹
 : 1,

225 
	m__ª£rved_1
 : 1,

226 
	m£nd_ûÀgÆ_ve˘‹
 : 1,

227 
	mª˚ive_ûÀgÆ_ve˘‹
 : 1,

228 
	mûÀgÆ_ªgi°î_addªss
 : 1,

229 
	m__ª£rved_2
 : 24;

230 
u32
 
	m__ª£rved_3
[3];

231 } 
	mîr‹_bôs
;

233 
u32
 
	mîr‹s
;

234 
u32
 
	m__ª£rved_3
[3];

235 } 
	mÆl_îr‹s
;

236 } 
	me§
;

238  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_08
;

240  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_09
;

242  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_10
;

244  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_11
;

246  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_12
;

248  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_13
;

250  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_14
;

253 
u32
 
	mve˘‹
 : 8,

254 
	mdñivîy_mode
 : 3,

255 
	mde°ö©i⁄_mode
 : 1,

256 
	mdñivîy_°©us
 : 1,

257 
	m__ª£rved_1
 : 1,

258 
	mÀvñ
 : 1,

259 
	måiggî
 : 1,

260 
	m__ª£rved_2
 : 2,

261 
	msh‹th™d
 : 2,

262 
	m__ª£rved_3
 : 12;

263 
u32
 
	m__ª£rved_4
[3];

264 } 
	mi¸1
;

268 
u32
 
	m__ª£rved_1
 : 24,

269 
	mphys_de°
 : 4,

270 
	m__ª£rved_2
 : 4;

271 
u32
 
	m__ª£rved_3
 : 24,

272 
	mlogiˇl_de°
 : 8;

273 } 
	mde°
;

274 
u32
 
	m__ª£rved_4
[3];

275 } 
	mi¸2
;

278 
u32
 
	mve˘‹
 : 8,

279 
	m__ª£rved_1
 : 4,

280 
	mdñivîy_°©us
 : 1,

281 
	m__ª£rved_2
 : 3,

282 
	mmask
 : 1,

283 
	mtimî_mode
 : 1,

284 
	m__ª£rved_3
 : 14;

285 
u32
 
	m__ª£rved_4
[3];

286 } 
	mlvt_timî
;

289 
u32
 
	mve˘‹
 : 8,

290 
	mdñivîy_mode
 : 3,

291 
	m__ª£rved_1
 : 1,

292 
	mdñivîy_°©us
 : 1,

293 
	m__ª£rved_2
 : 3,

294 
	mmask
 : 1,

295 
	m__ª£rved_3
 : 15;

296 
u32
 
	m__ª£rved_4
[3];

297 } 
	mlvt_thîmÆ
;

300 
u32
 
	mve˘‹
 : 8,

301 
	mdñivîy_mode
 : 3,

302 
	m__ª£rved_1
 : 1,

303 
	mdñivîy_°©us
 : 1,

304 
	m__ª£rved_2
 : 3,

305 
	mmask
 : 1,

306 
	m__ª£rved_3
 : 15;

307 
u32
 
	m__ª£rved_4
[3];

308 } 
	mlvt_pc
;

311 
u32
 
	mve˘‹
 : 8,

312 
	mdñivîy_mode
 : 3,

313 
	m__ª£rved_1
 : 1,

314 
	mdñivîy_°©us
 : 1,

315 
	mpﬁ¨ôy
 : 1,

316 
	mªmŸe_úr
 : 1,

317 
	måiggî
 : 1,

318 
	mmask
 : 1,

319 
	m__ª£rved_2
 : 15;

320 
u32
 
	m__ª£rved_3
[3];

321 } 
	mlvt_löt0
;

324 
u32
 
	mve˘‹
 : 8,

325 
	mdñivîy_mode
 : 3,

326 
	m__ª£rved_1
 : 1,

327 
	mdñivîy_°©us
 : 1,

328 
	mpﬁ¨ôy
 : 1,

329 
	mªmŸe_úr
 : 1,

330 
	måiggî
 : 1,

331 
	mmask
 : 1,

332 
	m__ª£rved_2
 : 15;

333 
u32
 
	m__ª£rved_3
[3];

334 } 
	mlvt_löt1
;

337 
u32
 
	mve˘‹
 : 8,

338 
	m__ª£rved_1
 : 4,

339 
	mdñivîy_°©us
 : 1,

340 
	m__ª£rved_2
 : 3,

341 
	mmask
 : 1,

342 
	m__ª£rved_3
 : 15;

343 
u32
 
	m__ª£rved_4
[3];

344 } 
	mlvt_îr‹
;

347 
u32
 
	möôül_cou¡
;

348 
u32
 
	m__ª£rved_2
[3];

349 } 
	mtimî_i¸
;

353 
u32
 
	mcuº_cou¡
;

354 
u32
 
	m__ª£rved_2
[3];

355 } 
	mtimî_c¸
;

357  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_16
;

359  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_17
;

361  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_18
;

363  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_19
;

366 
u32
 
	mdivis‹
 : 4,

367 
	m__ª£rved_1
 : 28;

368 
u32
 
	m__ª£rved_2
[3];

369 } 
	mtimî_d¸
;

371  såu˘ { 
u32
 
	m__ª£rved
[4]; } 
	m__ª£rved_20
;

373 } 
__©åibuã__
 ((
∑cked
));

375 #unde‡
u32


	@/usr/include/asm/ipcbuf.h

1 #i‚de‡
__i386_IPCBUF_H__


2 
	#__i386_IPCBUF_H__


	)

14 
	sùc64_≥rm


16 
__kî√l_key_t
 
	mkey
;

17 
__kî√l_uid32_t
 
	muid
;

18 
__kî√l_gid32_t
 
	mgid
;

19 
__kî√l_uid32_t
 
	mcuid
;

20 
__kî√l_gid32_t
 
	mcgid
;

21 
__kî√l_mode_t
 
	mmode
;

22 
	m__∑d1
;

23 
	m£q
;

24 
	m__∑d2
;

25 
	m__unu£d1
;

26 
	m__unu£d2
;

	@/usr/include/asm/kmap_types.h

1 #i‚de‡
_ASM_KMAP_TYPES_H


2 
	#_ASM_KMAP_TYPES_H


	)

4 
	~<löux/c⁄fig.h
>

6 #ifde‡
CONFIG_DEBUG_HIGHMEM


7 
	#D
(
n
Ë
__KM_FENCE_
##¿,

	)

9 
	#D
(
n
)

	)

12 
	ekm_ty≥
 {

13 
D
(0Ë
	mKM_BOUNCE_READ
,

14 
D
(1Ë
	mKM_SKB_SUNRPC_DATA
,

15 
D
(2Ë
	mKM_SKB_DATA_SOFTIRQ
,

16 
D
(3Ë
	mKM_USER0
,

17 
D
(4Ë
	mKM_USER1
,

18 
D
(5Ë
	mKM_BIO_SRC_IRQ
,

19 
D
(6Ë
	mKM_BIO_DST_IRQ
,

20 
D
(7Ë
	mKM_PTE0
,

21 
D
(8Ë
	mKM_PTE1
,

22 
D
(9Ë
	mKM_PTE2
,

23 
D
(10Ë
	mKM_IRQ0
,

24 
D
(11Ë
	mKM_IRQ1
,

25 
D
(12Ë
	mKM_SOFTIRQ0
,

26 
D
(13Ë
	mKM_SOFTIRQ1
,

27 
D
(14Ë
	mKM_TYPE_NR


30 #unde‡
D


	@/usr/include/asm/mmzone.h

6 #i‚de‡
_ASM_MMZONE_H_


7 
	#_ASM_MMZONE_H_


	)

9 
	~<asm/smp.h
>

11 #ifde‡
CONFIG_DISCONTIGMEM


13 
pgli°_d©a
 *
node_d©a
[];

18 
	#ª£rve_boŸmem
(
addr
, 
size
) \

19 
	`ª£rve_boŸmem_node
(
	`NODE_DATA
(0), (
addr
), (
size
))

	)

20 
	#Æloc_boŸmem
(
x
) \

21 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
SMP_CACHE_BYTES
, 
	`__∑
(
MAX_DMA_ADDRESS
))

	)

22 
	#Æloc_boŸmem_low
(
x
) \

23 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
SMP_CACHE_BYTES
, 0)

	)

24 
	#Æloc_boŸmem_∑ges
(
x
) \

25 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
PAGE_SIZE
, 
	`__∑
(
MAX_DMA_ADDRESS
))

	)

26 
	#Æloc_boŸmem_low_∑ges
(
x
) \

27 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
PAGE_SIZE
, 0)

	)

28 
	#Æloc_boŸmem_node
(
ign‹e
, 
x
) \

29 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
SMP_CACHE_BYTES
, 
	`__∑
(
MAX_DMA_ADDRESS
))

	)

30 
	#Æloc_boŸmem_∑ges_node
(
ign‹e
, 
x
) \

31 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
PAGE_SIZE
, 
	`__∑
(
MAX_DMA_ADDRESS
))

	)

32 
	#Æloc_boŸmem_low_∑ges_node
(
ign‹e
, 
x
) \

33 
	`__Æloc_boŸmem_node
(
	`NODE_DATA
(0), (
x
), 
PAGE_SIZE
, 0)

	)

35 
	#node_loˇ r
(
p‚
, 
nid
Ë(’‚Ë- 
node_d©a
[nid]->
node_°¨t_p‚
)

	)

44 
	#kvaddr_to_nid
(
kaddr
Ë
	`p‚_to_nid
(
	`__∑
(kaddrË>> 
PAGE_SHIFT
)

	)

49 
	#NODE_DATA
(
nid
Ë(
node_d©a
[nid])

	)

51 
	#node_mem_m≠
(
nid
Ë(
	`NODE_DATA
“id)->
node_mem_m≠
)

	)

52 
	#node_°¨t_p‚
(
nid
Ë(
	`NODE_DATA
“id)->
node_°¨t_p‚
)

	)

53 
	#node_íd_p‚
(
nid
) \

55 
pg_d©a_t
 *
__pgd©
 = 
	`NODE_DATA
(
nid
); \

56 
__pgd©
->
node_°¨t_p‚
 + __pgd©->
node_•™√d_∑ges
; \

57 })

	)

59 
	#loˇl_m≠ƒ
(
kvaddr
) \

61 
__p‚
 = 
	`__∑
(
kvaddr
Ë>> 
PAGE_SHIFT
; \

62 (
__p‚
 - 
	`node_°¨t_p‚
(
	`p‚_to_nid
(__pfn))); \

63 })

	)

65 
	#kîn_addr_vÆid
(
kaddr
) \

67 
__kaddr
 = ()(
kaddr
); \

68 
pg_d©a_t
 *
__pgd©
 = 
	`NODE_DATA
(
	`kvaddr_to_nid
(
__kaddr
)); \

69 
	`ã°_bô
(
	`loˇl_m≠ƒ
(
__kaddr
), 
__pgd©
->
vÆid_addr_bôm≠
); \

70 })

	)

72 
	#p‚_to_∑ge
(
p‚
) \

74 
__p‚
 = 
p‚
; \

75 
__node
 = 
	`p‚_to_nid
(
__p‚
); \

76 &
	`node_mem_m≠
(
__node
)[
	`node_loˇ r
(
__p‚
,__node)]; \

77 })

	)

79 
	#∑ge_to_p‚
(
pg
) \

81 
∑ge
 *
__∑ge
 = 
pg
; \

82 
z⁄e
 *
__z⁄e
 = 
	`∑ge_z⁄e
(
__∑ge
); \

83 ()(
__∑ge
 - 
__z⁄e
->
z⁄e_mem_m≠
) \

84 + 
__z⁄e
->
z⁄e_°¨t_p‚
; \

85 })

	)

86 
	#pmd_∑ge
(
pmd
Ë(
	`p‚_to_∑ge
(
	`pmd_vÆ
’mdË>> 
PAGE_SHIFT
))

	)

94 
	#p‚_vÆid
(
p‚
Ë(’‚Ë< 
num_phy•ages
)

	)

105 
	#MAX_NR_PAGES
 16777216

	)

106 
	#MAX_ELEMENTS
 256

	)

107 
	#PAGES_PER_ELEMENT
 (
MAX_NR_PAGES
/
MAX_ELEMENTS
)

	)

109 
u8
 
phy¢ode_m≠
[];

111 
ölöe
 
	$p‚_to_nid
(
p‚
)

113 (
phy¢ode_m≠
[(
p‚
Ë/ 
PAGES_PER_ELEMENT
]);

114 
	}
}

115 
ölöe
 
pgli°_d©a
 *
	$p‚_to_pgd©
(
p‚
)

117 (
	`NODE_DATA
(
	`p‚_to_nid
(
p‚
)));

118 
	}
}

120 #ifde‡
CONFIG_X86_NUMAQ


121 
	~<asm/numaq.h
>

122 #ñi‡
CONFIG_ACPI_SRAT


123 
	~<asm/§©.h
>

124 #ñi‡
CONFIG_X86_PC


125 
	#gë_zhﬁes_size
(
n
Ë(0)

	)

127 
	#p‚_to_nid
(
p‚
Ë(0)

	)

130 
gë_memcfg_numa_Ê©
();

136 
ölöe
 
	$gë_memcfg_numa
()

138 #ifde‡
CONFIG_X86_NUMAQ


139 i‡(
	`gë_memcfg_numaq
())

141 #ñi‡
CONFIG_ACPI_SRAT


142 i‡(
	`gë_memcfg_‰om_§©
())

146 
	`gë_memcfg_numa_Ê©
();

147 
	}
}

	@/usr/include/asm/mpspec_def.h

1 #i‚de‡
__ASM_MPSPEC_DEF_H


2 
	#__ASM_MPSPEC_DEF_H


	)

14 
	#SMP_MAGIC_IDENT
 (('_'<<24)|('P'<<16)|('M'<<8)|'_')

	)

16 
	#MAX_MPC_ENTRY
 1024

	)

18 
	söãl_mp_Êﬂtög


20 
	mmpf_sig«tuª
[4];

21 
	mmpf_phy•å
;

22 
	mmpf_Àngth
;

23 
	mmpf_•ecifiˇti⁄
;

24 
	mmpf_checksum
;

25 
	mmpf_„©uª1
;

26 
	mmpf_„©uª2
;

27 
	mmpf_„©uª3
;

28 
	mmpf_„©uª4
;

29 
	mmpf_„©uª5
;

32 
	smp_c⁄fig_èbÀ


34 
	mmpc_sig«tuª
[4];

35 
	#MPC_SIGNATURE
 "PCMP"

	)

36 
	mmpc_Àngth
;

37 
	mmpc_•ec
;

38 
	mmpc_checksum
;

39 
	mmpc_€m
[8];

40 
	mmpc_¥odu˘id
[12];

41 
	mmpc_€m±r
;

42 
	mmpc_€msize
;

43 
	mmpc_€mcou¡
;

44 
	mmpc_œpic
;

45 
	mª£rved
;

50 
	#MP_PROCESSOR
 0

	)

51 
	#MP_BUS
 1

	)

52 
	#MP_IOAPIC
 2

	)

53 
	#MP_INTSRC
 3

	)

54 
	#MP_LINTSRC
 4

	)

55 
	#MP_TRANSLATION
 192

	)

57 
	smpc_c⁄fig_¥o˚ss‹


59 
	mmpc_ty≥
;

60 
	mmpc_≠icid
;

61 
	mmpc_≠icvî
;

62 
	mmpc_˝uÊag
;

63 
	#CPU_ENABLED
 1

	)

64 
	#CPU_BOOTPROCESSOR
 2

	)

65 
	mmpc_˝u„©uª
;

66 
	#CPU_STEPPING_MASK
 0x0F

	)

67 
	#CPU_MODEL_MASK
 0xF0

	)

68 
	#CPU_FAMILY_MASK
 0xF00

	)

69 
	mmpc_„©uªÊag
;

70 
	mmpc_ª£rved
[2];

73 
	smpc_c⁄fig_bus


75 
	mmpc_ty≥
;

76 
	mmpc_busid
;

77 
	mmpc_bu°y≥
[6] 
__©åibuã
((
∑cked
));

81 
	#BUSTYPE_EISA
 "EISA"

	)

82 
	#BUSTYPE_ISA
 "ISA"

	)

83 
	#BUSTYPE_INTERN
 "INTERN"

	)

84 
	#BUSTYPE_MCA
 "MCA"

	)

85 
	#BUSTYPE_VL
 "VL"

	)

86 
	#BUSTYPE_PCI
 "PCI"

	)

87 
	#BUSTYPE_PCMCIA
 "PCMCIA"

	)

88 
	#BUSTYPE_CBUS
 "CBUS"

	)

89 
	#BUSTYPE_CBUSII
 "CBUSII"

	)

90 
	#BUSTYPE_FUTURE
 "FUTURE"

	)

91 
	#BUSTYPE_MBI
 "MBI"

	)

92 
	#BUSTYPE_MBII
 "MBII"

	)

93 
	#BUSTYPE_MPI
 "MPI"

	)

94 
	#BUSTYPE_MPSA
 "MPSA"

	)

95 
	#BUSTYPE_NUBUS
 "NUBUS"

	)

96 
	#BUSTYPE_TC
 "TC"

	)

97 
	#BUSTYPE_VME
 "VME"

	)

98 
	#BUSTYPE_XPRESS
 "XPRESS"

	)

99 
	#BUSTYPE_NEC98
 "NEC98"

	)

101 
	smpc_c⁄fig_iﬂpic


103 
	mmpc_ty≥
;

104 
	mmpc_≠icid
;

105 
	mmpc_≠icvî
;

106 
	mmpc_Êags
;

107 
	#MPC_APIC_USABLE
 0x01

	)

108 
	mmpc_≠iˇddr
;

111 
	smpc_c⁄fig_öt§c


113 
	mmpc_ty≥
;

114 
	mmpc_úqty≥
;

115 
	mmpc_úqÊag
;

116 
	mmpc_§cbus
;

117 
	mmpc_§cbusúq
;

118 
	mmpc_d°≠ic
;

119 
	mmpc_d°úq
;

122 
	emp_úq_sour˚_ty≥s
 {

123 
	mmp_INT
 = 0,

124 
	mmp_NMI
 = 1,

125 
	mmp_SMI
 = 2,

126 
	mmp_ExtINT
 = 3

129 
	#MP_IRQDIR_DEFAULT
 0

	)

130 
	#MP_IRQDIR_HIGH
 1

	)

131 
	#MP_IRQDIR_LOW
 3

	)

134 
	smpc_c⁄fig_löt§c


136 
	mmpc_ty≥
;

137 
	mmpc_úqty≥
;

138 
	mmpc_úqÊag
;

139 
	mmpc_§cbusid
;

140 
	mmpc_§cbusúq
;

141 
	mmpc_de°≠ic
;

142 
	#MP_APIC_ALL
 0xFF

	)

143 
	mmpc_de°≠i˛öt
;

146 
	smp_c⁄fig_€mèbÀ


148 
	m€m_sig«tuª
[4];

149 
	#MPC_OEM_SIGNATURE
 "_OEM"

	)

150 
	m€m_Àngth
;

151 
	m€m_ªv
;

152 
	m€m_checksum
;

153 
	mmpc_€m
[8];

156 
	smpc_c⁄fig_å™¶©i⁄


158 
	mmpc_ty≥
;

159 
	må™s_Àn
;

160 
	må™s_ty≥
;

161 
	må™s_quad
;

162 
	må™s_globÆ
;

163 
	må™s_loˇl
;

164 
	må™s_ª£rved
;

179 
	emp_bu°y≥
 {

180 
	mMP_BUS_ISA
 = 1,

181 
	mMP_BUS_EISA
,

182 
	mMP_BUS_PCI
,

183 
	mMP_BUS_MCA
,

184 
	mMP_BUS_NEC98


	@/usr/include/linux/numa.h

1 #i‚de‡
_LINUX_NUMA_H


2 
	#_LINUX_NUMA_H


	)

4 
	~<löux/c⁄fig.h
>

6 #ifde‡
CONFIG_DISCONTIGMEM


7 
	~<asm/numnodes.h
>

10 #i‚de‡
NODES_SHIFT


11 
	#NODES_SHIFT
 0

	)

14 
	#MAX_NUMNODES
 (1 << 
NODES_SHIFT
)

	)

	@/usr/include/linux/pm.h

21 #i‚de‡
_LINUX_PM_H


22 
	#_LINUX_PM_H


	)

24 #ifde‡
__KERNEL__


26 
	~<löux/c⁄fig.h
>

27 
	~<löux/li°.h
>

28 
	~<asm/©omic.h
>

35 
	mPM_SUSPEND
,

36 
	mPM_RESUME
,

38 
	mPM_SAVE_STATE
,

41 
	mPM_SET_WAKEUP
,

44 
	mPM_GET_RESOURCES
,

45 
	mPM_SET_RESOURCES
,

48 
	mPM_EJECT
,

49 
	mPM_LOCK
,

52 
	tpm_ªque°_t
;

59 
	mPM_UNKNOWN_DEV
 = 0,

60 
	mPM_SYS_DEV
,

61 
	mPM_PCI_DEV
,

62 
	mPM_USB_DEV
,

63 
	mPM_SCSI_DEV
,

64 
	mPM_ISA_DEV
,

65 
	mPM_MTD_DEV
,

68 
	tpm_dev_t
;

75 
	mPM_SYS_UNKNOWN
 = 0x00000000,

76 
	mPM_SYS_KBC
 = 0x41d00303,

77 
	mPM_SYS_COM
 = 0x41d00500,

78 
	mPM_SYS_IRDA
 = 0x41d00510,

79 
	mPM_SYS_FDC
 = 0x41d00700,

80 
	mPM_SYS_VGA
 = 0x41d00900,

81 
	mPM_SYS_PCMCIA
 = 0x41d00e00,

87 
	#PM_PCI_ID
(
dev
Ë((dev)->
bus
->
numbî
 << 16 | (dev)->
dev‚
)

	)

92 
	gpm_dev
;

94 (*
	tpm_ˇŒback
)(
	tpm_dev
 *
	tdev
, 
	tpm_ªque°_t
 
	trq°
, *
	td©a
);

99 
	spm_dev


101 
pm_dev_t
 
ty≥
;

102 
id
;

103 
pm_ˇŒback
 
ˇŒback
;

104 *
d©a
;

106 
Êags
;

107 
°©e
;

108 
¥ev_°©e
;

110 
li°_hód
 
íåy
;

113 #ifde‡
CONFIG_PM


115 
pm_a˘ive
;

117 
	#PM_IS_ACTIVE
(Ë(
pm_a˘ive
 !0)

	)

122 
pm_dev
 *
	`pm_ªgi°î
(
pm_dev_t
 
ty≥
,

123 
id
,

124 
pm_ˇŒback
 
ˇŒback
);

129 
	`pm_uƒegi°î
(
pm_dev
 *
dev
);

134 
	`pm_uƒegi°î_Æl
(
pm_ˇŒback
 
ˇŒback
);

139 
	`pm_£nd
(
pm_dev
 *
dev
, 
pm_ªque°_t
 
rq°
, *
d©a
);

144 
	`pm_£nd_Æl
(
pm_ªque°_t
 
rq°
, *
d©a
);

149 
pm_dev
 *
	`pm_föd
(
pm_dev_t
 
ty≥
, pm_dev *
‰om
);

151 
ölöe
 
	$pm_ac˚ss
(
pm_dev
 *
dev
Ë{
	}
}

152 
ölöe
 
	$pm_dev_idÀ
(
pm_dev
 *
dev
Ë{
	}
}

156 
	#PM_IS_ACTIVE
(Ë0

	)

158 
ölöe
 
pm_dev
 *
	$pm_ªgi°î
(
pm_dev_t
 
ty≥
,

159 
id
,

160 
pm_ˇŒback
 
ˇŒback
)

163 
	}
}

165 
ölöe
 
	$pm_uƒegi°î
(
pm_dev
 *
dev
Ë{
	}
}

167 
ölöe
 
	$pm_uƒegi°î_Æl
(
pm_ˇŒback
 
ˇŒback
Ë{
	}
}

169 
ölöe
 
	$pm_£nd
(
pm_dev
 *
dev
, 
pm_ªque°_t
 
rq°
, *
d©a
)

172 
	}
}

174 
ölöe
 
	$pm_£nd_Æl
(
pm_ªque°_t
 
rq°
, *
d©a
)

177 
	}
}

179 
ölöe
 
pm_dev
 *
	$pm_föd
(
pm_dev_t
 
ty≥
, 
pm_dev
 *
‰om
)

182 
	}
}

184 
ölöe
 
	$pm_ac˚ss
(
pm_dev
 *
dev
Ë{
	}
}

185 
ölöe
 
	$pm_dev_idÀ
(
pm_dev
 *
dev
Ë{
	}
}

193 (*
pm_idÀ
)();

194 (*
pm_powî_off
)();

197 
PM_SUSPEND_ON
,

198 
PM_SUSPEND_STANDBY
,

199 
PM_SUSPEND_MEM
,

200 
PM_SUSPEND_DISK
,

201 
PM_SUSPEND_MAX
,

205 
PM_DISK_FIRMWARE
 = 1,

206 
PM_DISK_PLATFORM
,

207 
PM_DISK_SHUTDOWN
,

208 
PM_DISK_REBOOT
,

209 
PM_DISK_MAX
,

213 
	spm_›s
 {

214 
u32
 
pm_disk_mode
;

215 (*
¥ï¨e
)(
u32
 
°©e
);

216 (*
íãr
)(
u32
 
°©e
);

217 (*
föish
)(
u32
 
°©e
);

220 
	`pm_£t_›s
(
pm_›s
 *);

222 
	`pm_su•íd
(
u32
 
°©e
);

229 
devi˚
;

231 
	sdev_pm_öfo
 {

232 #ifdef 
CONFIG_PM


233 
u32
 
powî_°©e
;

234 
u8
 * 
ßved_°©e
;

235 
©omic_t
 
pm_u£rs
;

236 
devi˚
 * 
pm_∑ª¡
;

237 
li°_hód
 
íåy
;

241 
	`devi˚_pm_£t_∑ª¡
(
devi˚
 * 
dev
, devi˚ * 
∑ª¡
);

243 
	`devi˚_su•íd
(
u32
 
°©e
);

244 
	`devi˚_powî_down
(
u32
 
°©e
);

245 
	`devi˚_powî_up
();

246 
	`devi˚_ªsume
();

	@/usr/include/linux/topology.h

27 #i‚de‡
_LINUX_TOPOLOGY_H


28 
	#_LINUX_TOPOLOGY_H


	)

30 
	~<löux/˝umask.h
>

31 
	~<löux/bô›s.h
>

32 
	~<löux/mmz⁄e.h
>

33 
	~<löux/smp.h
>

35 
	~<asm/t›ﬁogy.h
>

37 #i‚de‡
ƒ_˝us_node


38 
	#ƒ_˝us_node
(
node
) \

40 
˝umask_t
 
__tmp__
; \

41 
__tmp__
 = 
	`node_to_˝umask
(
node
); \

42 
	`˝us_weight
(
__tmp__
); \

43 })

	)

46 
ölöe
 
	$__√xt_node_wôh_˝us
(
node
)

49 ++
node
;

50 
node
 < 
numnodes
 && !
	`ƒ_˝us_node
(node));

51  
node
;

52 
	}
}

54 
	#f‹_óch_node_wôh_˝us
(
node
) \

55 
node
 = 0;Çodê< 
numnodes
;Çodê
	`__√xt_node_wôh_˝us
“ode))

	)

	@/usr/include/asm/numaq.h

26 #i‚de‡
NUMAQ_H


27 
	#NUMAQ_H


	)

29 #ifde‡
CONFIG_X86_NUMAQ


31 
gë_memcfg_numaq
();

36 
	#SYS_CFG_DATA_PRIV_ADDR
 0x0009d000

	)

44 
	sóchquadmem
 {

45 
	m¥iv_mem_°¨t
;

49 
	m¥iv_mem_size
;

52 
	mlow_shrd_mem_°Ω_°¨t
;

56 
	mlow_shrd_mem_°¨t
;

60 
	mlow_shrd_mem_size
;

63 
	mlmmio_c›b_°¨t
;

68 
	mlmmio_c›b_size
;

72 
	mlmmio_n›b_°¨t
;

77 
	mlmmio_n›b_size
;

81 
	mio_≠ic_0_°¨t
;

83 
	mio_≠ic_0_sz
;

84 
	mio_≠ic_1_°¨t
;

86 
	mio_≠ic_1_sz
;

87 
	mhi_shrd_mem_°¨t
;

90 
	mhi_shrd_mem_size
;

93 
	mmps_èbÀ_addr
;

96 
	ml˛_MDC_pio_addr
;

98 
	mrmt_MDC_mmpio_addr
;

100 
	mmm_p‹t_io_°¨t
;

103 
	mmm_p‹t_io_size
;

105 
	mmm_rmt_io_≠ic_°¨t
;

108 
	mmm_rmt_io_≠ic_size
;

111 
	mmm_iß_°¨t
;

115 
	mmm_iß_size
;

118 
	mrmt_qmi_addr
;

119 
	ml˛_qmi_addr
;

126 
	ssys_cfg_d©a
 {

127 
	mquad_id
;

128 
	mb•_¥oc_id
;

129 
	mscd_vîsi⁄
;

130 
	mfú°_quad_id
;

131 
	mquads_¥e£¡31_0
;

132 
	mquads_¥e£¡63_32
;

133 
	mc⁄fig_Êags
;

134 
	mboŸ_Êags
;

135 
	mc§_°¨t_addr
;

136 
	mc§_size
;

137 
	ml˛_≠ic_°¨t_addr
;

138 
	ml˛_≠ic_size
;

139 
	mlow_shrd_mem_ba£
;

140 
	mlow_shrd_mem_quad_off£t
;

142 
	m•lô_mem_íbl
;

143 
	mmmio_sz
;

145 
	mquad_•ö_lock
;

147 
	mn⁄zîo55
;

148 
	mn⁄zîﬂa
;

149 
	mscd_magic_numbî
;

150 
	msy°em_ty≥
;

151 
	mchecksum
;

155 
óchquadmem
 
	meq
[
MAX_NUMNODES
];

158 
ölöe
 *
	$gë_zhﬁes_size
(
nid
)

160  
NULL
;

161 
	}
}

	@/usr/include/asm/numnodes.h

1 #i‚de‡
_ASM_MAX_NUMNODES_H


2 
	#_ASM_MAX_NUMNODES_H


	)

4 
	~<löux/c⁄fig.h
>

6 #ifde‡
CONFIG_X86_NUMAQ


9 
	#NODES_SHIFT
 4

	)

11 #ñi‡
deföed
(
CONFIG_ACPI_SRAT
)

14 
	#NODES_SHIFT
 3

	)

	@/usr/include/asm/srat.h

27 #i‚de‡
_ASM_SRAT_H_


28 
	#_ASM_SRAT_H_


	)

30 #i‚de‡
CONFIG_ACPI_SRAT


31 #îr‹ 
CONFIG_ACPI_SRAT
 
nŸ
 
deföed
, 
™d
 
§©
.
h
 
hódî
 
has
 
bìn
 
ö˛uded


34 
gë_memcfg_‰om_§©
();

35 *
gë_zhﬁes_size
();

	@/usr/include/asm/topology.h

27 #i‚de‡
_ASM_I386_TOPOLOGY_H


28 
	#_ASM_I386_TOPOLOGY_H


	)

30 #ifde‡
CONFIG_NUMA


32 
	~<asm/mp•ec.h
>

34 
	~<löux/˝umask.h
>

37 
˝umask_t
 
node_2_˝u_mask
[];

38 
˝u_2_node
[];

41 
ölöe
 
	$˝u_to_node
(
˝u
)

43  
˝u_2_node
[
˝u
];

44 
	}
}

47 
	#memblk_to_node
(
memblk
Ë(memblk)

	)

51 
	#∑ª¡_node
(
node
Ë“ode)

	)

54 
ölöe
 
˝umask_t
 
	$node_to_˝umask
(
node
)

56  
node_2_˝u_mask
[
node
];

57 
	}
}

60 
ölöe
 
	$node_to_fú°_˝u
(
node
)

62 
˝umask_t
 
mask
 = 
	`node_to_˝umask
(
node
);

63  
	`fú°_˝u
(
mask
);

64 
	}
}

67 
	#node_to_memblk
(
node
Ë“ode)

	)

70 
ölöe
 
˝umask_t
 
	$pcibus_to_˝umask
(
bus
)

72  
	`node_to_˝umask
(
mp_bus_id_to_node
[
bus
]);

73 
	}
}

76 
	#NODE_BALANCE_RATE
 100

	)

84 
	~<asm-gíîic/t›ﬁogy.h
>

	@/usr/include/asm-generic/topology.h

27 #i‚de‡
_ASM_GENERIC_TOPOLOGY_H


28 
	#_ASM_GENERIC_TOPOLOGY_H


	)

32 #i‚de‡
˝u_to_node


33 
	#˝u_to_node
(
˝u
Ë(0)

	)

35 #i‚de‡
memblk_to_node


36 
	#memblk_to_node
(
memblk
Ë(0)

	)

38 #i‚de‡
∑ª¡_node


39 
	#∑ª¡_node
(
node
Ë(0)

	)

41 #i‚de‡
node_to_˝umask


42 
	#node_to_˝umask
(
node
Ë(
˝u_⁄löe_m≠
)

	)

44 #i‚de‡
node_to_fú°_˝u


45 
	#node_to_fú°_˝u
(
node
Ë(0)

	)

47 #i‚de‡
node_to_memblk


48 
	#node_to_memblk
(
node
Ë(0)

	)

50 #i‚de‡
pcibus_to_˝umask


51 
	#pcibus_to_˝umask
(
bus
Ë(
˝u_⁄löe_m≠
)

	)

55 #i‚de‡
NODE_BALANCE_RATE


56 
	#NODE_BALANCE_RATE
 10

	)

	@
1
.
1
/usr/include
669
15817
contrib/GPL/tpcal/tpcal.c
contrib/GPL/tpcal/transform.c
contrib/GPL/tpcal/transform.h
contrib/ntimers.c
contrib/ntimers.h
contrib/speedtst/speed.c
demos/mwin/assert.c
demos/mwin/malpha.c
demos/mwin/mdemo.c
demos/mwin/mdemo.stretch.c
demos/mwin/mine.c
demos/mwin/mstretch.c
demos/mwin/mterm.c
demos/mwin/mtest.c
demos/mwin/mtest2.c
demos/mwin/muserfd.c
demos/mwobjects/mwo-test.cc
demos/nanowm/actions.c
demos/nanowm/assert.c
demos/nanowm/clients.c
demos/nanowm/events.c
demos/nanowm/nanowm.c
demos/nanowm/nanowm.h
demos/nanowm/wlist.c
demos/nanox/arcdemo.c
demos/nanox/bmpdemo.c
demos/nanox/convpbm.c
demos/nanox/dashdemo.c
demos/nanox/demo.c
demos/nanox/demo2.c
demos/nanox/demo4.c
demos/nanox/demo5.c
demos/nanox/demo6.c
demos/nanox/fontdemo.c
demos/nanox/ftdemo.c
demos/nanox/getselection.c
demos/nanox/grabdemo.c
demos/nanox/info.c
demos/nanox/ipcclient.c
demos/nanox/ipcserver.c
demos/nanox/landmine.c
demos/nanox/launcher.c
demos/nanox/launcher.h
demos/nanox/logfont.c
demos/nanox/move.c
demos/nanox/npanel.c
demos/nanox/nsaver.c
demos/nanox/nsaver.h
demos/nanox/nterm.c
demos/nanox/ntetris.c
demos/nanox/ntetris.h
demos/nanox/nxcal.c
demos/nanox/nxclock.c
demos/nanox/nxev.c
demos/nanox/nxeyes.c
demos/nanox/nxeyes.h
demos/nanox/nxlsclients.c
demos/nanox/nxmag.c
demos/nanox/nxterm.c
demos/nanox/nxterm.h
demos/nanox/nxview.c
demos/nanox/oneshot.c
demos/nanox/pcfdemo.c
demos/nanox/periodic.c
demos/nanox/polydemo.c
demos/nanox/pressure.c
demos/nanox/rgndemo.c
demos/nanox/setportrait.c
demos/nanox/setselection.c
demos/nanox/slider.c
demos/nanox/snap_jpg.c
demos/nanox/snap_ppm.c
demos/nanox/t1demo.c
demos/nanox/tsdemo.c
demos/nanox/tux.c
demos/nanox/tuxmask.h
demos/nanox/wait.c
demos/nanox/world.c
demos/nbreaker/animate.c
demos/nbreaker/ball.c
demos/nbreaker/bat.c
demos/nbreaker/brick.c
demos/nbreaker/cheat.c
demos/nbreaker/draw.c
demos/nbreaker/dump.c
demos/nbreaker/event.c
demos/nbreaker/game.c
demos/nbreaker/init.c
demos/nbreaker/levels.c
demos/nbreaker/loader.c
demos/nbreaker/misc.c
demos/nbreaker/nbreaker.c
demos/nbreaker/nbreaker.h
demos/nbreaker/powers.c
demos/nbreaker/scores.c
demos/nbreaker/sprite.c
demos/nxkbd/keyctrl.c
demos/nxkbd/keynorm.c
demos/nxkbd/keynum.c
demos/nxkbd/keyshft.c
demos/nxkbd/nxkbd.c
demos/nxkbd/srvconn.c
demos/nxroach/nxroach.c
demos/nxroach/roachmap.h
demos/nxscribble/bitvector.c
demos/nxscribble/bitvector.h
demos/nxscribble/hre.h
demos/nxscribble/hre_api.c
demos/nxscribble/hre_api.h
demos/nxscribble/hre_api_internal.h
demos/nxscribble/hre_internal.h
demos/nxscribble/li_recognizer.c
demos/nxscribble/li_recognizer.h
demos/nxscribble/li_recognizer_internal.h
demos/nxscribble/matrix.c
demos/nxscribble/matrix.h
demos/nxscribble/nxscribble.c
demos/nxscribble/sc.c
demos/nxscribble/sc.h
demos/nxscribble/scrib.h
demos/nxscribble/scribwidget.c
demos/nxscribble/util.c
demos/nxscribble/util.h
demos/nxscribble/zdebug.h
demos/test/test.c
demos/tuxchess/board.c
demos/tuxchess/data.c
demos/tuxchess/data.h
demos/tuxchess/defs.h
demos/tuxchess/eval.c
demos/tuxchess/images.c
demos/tuxchess/main.c
demos/tuxchess/protos.h
demos/tuxchess/search.c
demos/vnc/include/rfbproto.h
demos/vnc/include/vncauth.h
demos/vnc/libvncauth/d3des.c
demos/vnc/libvncauth/d3des.h
demos/vnc/libvncauth/vncauth.c
demos/vnc/vncviewer/args.c
demos/vnc/vncviewer/listen.c
demos/vnc/vncviewer/nanox.c
demos/vnc/vncviewer/rfbproto.c
demos/vnc/vncviewer/sockets.c
demos/vnc/vncviewer/vncviewer.c
demos/vnc/vncviewer/vncviewer.h
drivers/SubRepl.h
drivers/asm.h
drivers/asmmsc.h
drivers/dynacal.c
drivers/elkplan4.c
drivers/elksutil.c
drivers/fb.c
drivers/fb.h
drivers/fblin1.c
drivers/fblin12.c
drivers/fblin16.c
drivers/fblin1rev.c
drivers/fblin2.c
drivers/fblin24.c
drivers/fblin2rev.c
drivers/fblin32.c
drivers/fblin32alpha.c
drivers/fblin4.c
drivers/fblin4hp.c
drivers/fblin4orion.c
drivers/fblin4rev.c
drivers/fblin4sa1100.c
drivers/fblin4sh3.c
drivers/fblin8.c
drivers/fbportrait_down.c
drivers/fbportrait_left.c
drivers/fbportrait_right.c
drivers/genfont.c
drivers/genfont.h
drivers/genmem.c
drivers/genmem.h
drivers/int10_pc.c
drivers/kbd_bios.c
drivers/kbd_djgr.c
drivers/kbd_fbsd.c
drivers/kbd_ipaq.c
drivers/kbd_lirc.c
drivers/kbd_null.c
drivers/kbd_pac.c
drivers/kbd_pipe.c
drivers/kbd_rtems.c
drivers/kbd_tc.c
drivers/kbd_tty.c
drivers/kbd_ttyscan.c
drivers/kbd_x11.c
drivers/keymap_standard.h
drivers/keymap_zaurus.h
drivers/memplan4.c
drivers/mou_dos.c
drivers/mou_dynapro.c
drivers/mou_fbsd.c
drivers/mou_gpm.c
drivers/mou_harrier.c
drivers/mou_mt.c
drivers/mou_null.c
drivers/mou_ps5.c
drivers/mou_rtems.c
drivers/mou_ser.c
drivers/mou_sun.c
drivers/mou_touchscreen.c
drivers/mou_vrlinux.c
drivers/mou_x11.c
drivers/mou_yopy.c
drivers/mwlirc.c
drivers/mwlirc.h
drivers/nofont.c
drivers/obsolete.c
drivers/old/mou_ads.c
drivers/old/mou_ipaq.c
drivers/old/mou_tp.c
drivers/old/mou_tp.h
drivers/old/mou_ucb1x00.c
drivers/romfont.c
drivers/romfont.h
drivers/scr_bios.c
drivers/scr_debug.c
drivers/scr_djgr.c
drivers/scr_ecos.c
drivers/scr_em84xx.c
drivers/scr_fb.c
drivers/scr_fbsd.c
drivers/scr_herc.c
drivers/scr_prsm.c
drivers/scr_pspfb.c
drivers/scr_rtems.c
drivers/scr_svga.c
drivers/scr_tc.c
drivers/scr_x11.c
drivers/touchscreen_ads.h
drivers/touchscreen_ads7846.h
drivers/touchscreen_ipaq.h
drivers/touchscreen_ucb1x00.h
drivers/touchscreen_zaurus.h
drivers/vgainit.c
drivers/vgaplan4.c
drivers/vgaplan4.h
drivers/vtswitch.c
ecos/ecos_app.c
ecos/ecos_init.c
ecos/landmine_thread.c
ecos/nanowm_thread.c
ecos/nanox_thread.c
ecos/ntetris_thread.c
ecos/nxkbd_thread.c
ecos/nxscribble_thread.c
ecos/world_thread.c
engine/devarc.c
engine/devclip.c
engine/devclip1.c
engine/devclip2.c
engine/devdraw.c
engine/devfont.c
engine/devfont.h
engine/devimage.c
engine/devimage_stretch.c
engine/devkbd.c
engine/devlist.c
engine/devmouse.c
engine/devopen.c
engine/devpal1.c
engine/devpal2.c
engine/devpal4.c
engine/devpal8.c
engine/devpalgray4.c
engine/devpoly.c
engine/devrgn.c
engine/devrgn2.c
engine/devstipple.c
engine/devtimer.c
engine/error.c
engine/font_dbcs.c
engine/font_eucjp.c
engine/font_fnt.c
engine/font_freetype.c
engine/font_freetype.cache.c
engine/font_freetype2.c
engine/font_hzk.c
engine/font_pcf.c
engine/font_t1lib.c
engine/image_bmp.c
engine/image_gif.c
engine/image_jpeg.c
engine/image_png.c
engine/image_pnm.c
engine/image_tiff.c
engine/image_xpm.c
engine/obsolete.c
engine/selfont.c
fonts/convbdf.c
fonts/obsolete.c
fonts/rom8x16.c
fonts/rom8x8.c
fonts/tools/convfnt.c
fonts/tools/convrom.c
fonts/winFreeSansSerif11x13.c
fonts/winFreeSystem14x16.c
include/XtoNX.h
include/device.h
include/graph3d.h
include/lock.h
include/mwobjects.h
include/mwsystem.h
include/mwtypes.h
include/nano-X.h
include/nxcolors.h
include/nxdraw.h
include/swap.h
include/winctl.h
include/windef.h
include/windows.h
include/windowsx.h
include/winfont.h
include/wingdi.h
include/winkbd.h
include/wintern.h
include/wintools.h
include/winuser.h
mwin/bmp/convbmp.c
mwin/bmp/makebmp.c
mwin/mwobjects/mwobjects.cc
mwin/winclip.c
mwin/winclip1.c
mwin/winclip2.c
mwin/windefw.c
mwin/winevent.c
mwin/winexpos.c
mwin/winfont.c
mwin/wingdi.c
mwin/winlib/button.c
mwin/winlib/caret.c
mwin/winlib/combobox.c
mwin/winlib/draw3d.c
mwin/winlib/edit.c
mwin/winlib/fastfill.c
mwin/winlib/graph3d.c
mwin/winlib/insetr.c
mwin/winlib/listbox.c
mwin/winlib/medit.c
mwin/winlib/mwuser.c
mwin/winlib/obsolete.c
mwin/winlib/progbar.c
mwin/winlib/ptinsid.c
mwin/winlib/scrlbar.c
mwin/winlib/static.c
mwin/winmain.c
mwin/winrgn.c
mwin/winsbar.c
mwin/winuser.c
nanox/client.c
nanox/clientfb.c
nanox/error.c
nanox/nxdraw.c
nanox/nxproto.c
nanox/nxproto.h
nanox/nxtransform.c
nanox/nxutil.c
nanox/serv.h
nanox/srvclip.c
nanox/srvclip1.c
nanox/srvclip2.c
nanox/srvevent.c
nanox/srvfunc.c
nanox/srvmain.c
nanox/srvnet.c
nanox/srvutil.c
rtems/mw_uid_test.c
rtems/net_cfg.h
rtems/rtems_init.c
rtems/rtemscfg.h
/usr/include/arpa/inet.h
/usr/include/asm/io.h
/usr/include/asm/page.h
/usr/include/assert.h
/usr/include/byteswap.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/getopt.h
/usr/include/limits.h
/usr/include/linux/fb.h
/usr/include/linux/kd.h
/usr/include/linux/keyboard.h
/usr/include/linux/vt.h
/usr/include/locale.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netinet/tcp.h
/usr/include/pthread.h
/usr/include/pwd.h
/usr/include/setjmp.h
/usr/include/sgtty.h
/usr/include/signal.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/sys/io.h
/usr/include/sys/ioctl.h
/usr/include/sys/ipc.h
/usr/include/sys/mman.h
/usr/include/sys/select.h
/usr/include/sys/shm.h
/usr/include/sys/socket.h
/usr/include/sys/stat.h
/usr/include/sys/termios.h
/usr/include/sys/time.h
/usr/include/sys/timeb.h
/usr/include/sys/times.h
/usr/include/sys/types.h
/usr/include/sys/uio.h
/usr/include/sys/un.h
/usr/include/sys/utsname.h
/usr/include/sys/wait.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/utmp.h
/usr/include/values.h
/usr/include/alloca.h
/usr/include/asm/mmx.h
/usr/include/asm/types.h
/usr/include/bits/byteswap.h
/usr/include/bits/confname.h
/usr/include/bits/dirent.h
/usr/include/bits/endian.h
/usr/include/bits/environments.h
/usr/include/bits/errno.h
/usr/include/bits/fcntl.h
/usr/include/bits/huge_val.h
/usr/include/bits/in.h
/usr/include/bits/initspin.h
/usr/include/bits/ioctl-types.h
/usr/include/bits/ioctls.h
/usr/include/bits/ipc.h
/usr/include/bits/ipctypes.h
/usr/include/bits/locale.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/mman.h
/usr/include/bits/nan.h
/usr/include/bits/netdb.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/posix_opt.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/select.h
/usr/include/bits/setjmp.h
/usr/include/bits/shm.h
/usr/include/bits/sigaction.h
/usr/include/bits/sigcontext.h
/usr/include/bits/siginfo.h
/usr/include/bits/signum.h
/usr/include/bits/sigset.h
/usr/include/bits/sigstack.h
/usr/include/bits/sigthread.h
/usr/include/bits/sockaddr.h
/usr/include/bits/socket.h
/usr/include/bits/stat.h
/usr/include/bits/stdio.h
/usr/include/bits/stdio_lim.h
/usr/include/bits/string.h
/usr/include/bits/string2.h
/usr/include/bits/sys_errlist.h
/usr/include/bits/termios.h
/usr/include/bits/time.h
/usr/include/bits/types.h
/usr/include/bits/uio.h
/usr/include/bits/utmp.h
/usr/include/bits/utsname.h
/usr/include/bits/waitflags.h
/usr/include/bits/waitstatus.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/features.h
/usr/include/libio.h
/usr/include/linux/config.h
/usr/include/linux/fs.h
/usr/include/linux/init.h
/usr/include/linux/input.h
/usr/include/linux/tty.h
/usr/include/linux/types.h
/usr/include/linux/vmalloc.h
/usr/include/linux/wait.h
/usr/include/linux/workqueue.h
/usr/include/rpc/netdb.h
/usr/include/sched.h
/usr/include/stdint.h
/usr/include/sys/cdefs.h
/usr/include/sys/resource.h
/usr/include/sys/sysmacros.h
/usr/include/sys/ttydefaults.h
/usr/include/sys/ucontext.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/asm/atomic.h
/usr/include/asm/byteorder.h
/usr/include/asm/ioctls.h
/usr/include/asm/semaphore.h
/usr/include/asm/sigcontext.h
/usr/include/asm/socket.h
/usr/include/asm/system.h
/usr/include/bits/local_lim.h
/usr/include/bits/resource.h
/usr/include/bits/sched.h
/usr/include/bits/stdio-lock.h
/usr/include/bits/typesizes.h
/usr/include/bits/wchar.h
/usr/include/gnu/stubs.h
/usr/include/linux/autoconf.h
/usr/include/linux/cache.h
/usr/include/linux/dcache.h
/usr/include/linux/err.h
/usr/include/linux/errno.h
/usr/include/linux/fcntl.h
/usr/include/linux/ioctl.h
/usr/include/linux/kdev_t.h
/usr/include/linux/kobject.h
/usr/include/linux/limits.h
/usr/include/linux/linkage.h
/usr/include/linux/list.h
/usr/include/linux/major.h
/usr/include/linux/nfs_fs_i.h
/usr/include/linux/posix_types.h
/usr/include/linux/quota.h
/usr/include/linux/radix-tree.h
/usr/include/linux/seqlock.h
/usr/include/linux/spinlock.h
/usr/include/linux/stat.h
/usr/include/linux/stddef.h
/usr/include/linux/termios.h
/usr/include/linux/time.h
/usr/include/linux/timer.h
/usr/include/linux/tty_driver.h
/usr/include/linux/tty_ldisc.h
/usr/include/paths.h
/usr/include/asm/bug.h
/usr/include/asm/cache.h
/usr/include/asm/cpufeature.h
/usr/include/asm/div64.h
/usr/include/asm/errno.h
/usr/include/asm/fcntl.h
/usr/include/asm/ioctl.h
/usr/include/asm/linkage.h
/usr/include/asm/param.h
/usr/include/asm/posix_types.h
/usr/include/asm/processor.h
/usr/include/asm/segment.h
/usr/include/asm/sockios.h
/usr/include/asm/spinlock.h
/usr/include/asm/stat.h
/usr/include/asm/termios.h
/usr/include/bits/libc-lock.h
/usr/include/gconv.h
/usr/include/linux/bitops.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/cdev.h
/usr/include/linux/compiler.h
/usr/include/linux/dqblk_v1.h
/usr/include/linux/dqblk_v2.h
/usr/include/linux/dqblk_xfs.h
/usr/include/linux/kernel.h
/usr/include/linux/nfs.h
/usr/include/linux/preempt.h
/usr/include/linux/prefetch.h
/usr/include/linux/rcupdate.h
/usr/include/linux/rwsem.h
/usr/include/linux/stringify.h
/usr/include/linux/sysfs.h
/usr/include/linux/thread_info.h
/usr/include/linux/timex.h
/usr/include/wchar.h
/usr/include/asm-generic/errno.h
/usr/include/asm/bitops.h
/usr/include/asm/math_emu.h
/usr/include/asm/msr.h
/usr/include/asm/rwlock.h
/usr/include/asm/rwsem.h
/usr/include/asm/termbits.h
/usr/include/asm/thread_info.h
/usr/include/asm/timex.h
/usr/include/asm/vm86.h
/usr/include/linux/byteorder/generic.h
/usr/include/linux/byteorder/swab.h
/usr/include/linux/compiler-gcc+.h
/usr/include/linux/compiler-gcc2.h
/usr/include/linux/compiler-gcc3.h
/usr/include/linux/compiler-intel.h
/usr/include/linux/cpumask.h
/usr/include/linux/module.h
/usr/include/linux/percpu.h
/usr/include/linux/rwsem-spinlock.h
/usr/include/linux/sunrpc/msg_prot.h
/usr/include/linux/threads.h
/usr/include/wctype.h
/usr/include/asm-generic/cpumask_arith.h
/usr/include/asm-generic/cpumask_array.h
/usr/include/asm-generic/cpumask_const_reference.h
/usr/include/asm-generic/cpumask_const_value.h
/usr/include/asm-generic/cpumask_up.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm/local.h
/usr/include/asm/module.h
/usr/include/asm/percpu.h
/usr/include/linux/bitmap.h
/usr/include/linux/compiler-gcc.h
/usr/include/linux/elf.h
/usr/include/linux/kmod.h
/usr/include/linux/sched.h
/usr/include/linux/slab.h
/usr/include/linux/smp.h
/usr/include/linux/string.h
/usr/include/asm-generic/percpu.h
/usr/include/asm/current.h
/usr/include/asm/elf.h
/usr/include/asm/mmu.h
/usr/include/asm/ptrace.h
/usr/include/asm/smp.h
/usr/include/asm/string.h
/usr/include/linux/aio.h
/usr/include/linux/capability.h
/usr/include/linux/completion.h
/usr/include/linux/fs_struct.h
/usr/include/linux/gfp.h
/usr/include/linux/jiffies.h
/usr/include/linux/param.h
/usr/include/linux/pid.h
/usr/include/linux/rbtree.h
/usr/include/linux/resource.h
/usr/include/linux/securebits.h
/usr/include/linux/sem.h
/usr/include/linux/signal.h
/usr/include/asm/apic.h
/usr/include/asm/fixmap.h
/usr/include/asm/io_apic.h
/usr/include/asm/mpspec.h
/usr/include/asm/resource.h
/usr/include/asm/sembuf.h
/usr/include/asm/siginfo.h
/usr/include/asm/signal.h
/usr/include/asm/user.h
/usr/include/linux/aio_abi.h
/usr/include/linux/ipc.h
/usr/include/linux/mmzone.h
/usr/include/linux/utsname.h
/usr/include/asm-generic/siginfo.h
/usr/include/asm/acpi.h
/usr/include/asm/apicdef.h
/usr/include/asm/ipcbuf.h
/usr/include/asm/kmap_types.h
/usr/include/asm/mmzone.h
/usr/include/asm/mpspec_def.h
/usr/include/linux/numa.h
/usr/include/linux/pm.h
/usr/include/linux/topology.h
/usr/include/asm/numaq.h
/usr/include/asm/numnodes.h
/usr/include/asm/srat.h
/usr/include/asm/topology.h
/usr/include/asm-generic/topology.h
